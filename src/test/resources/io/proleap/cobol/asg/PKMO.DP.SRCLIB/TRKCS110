000100 IDENTIFICATION DIVISION.                                         06/15/95
000200 PROGRAM-ID.    TRKCS110.                                         TRKCS110
000300 AUTHOR.        TOM RUSKA. G&R.                                      LV002
000400 INSTALLATION.  KOHLS DEPARTMENT STORES.                          TRKCS110
000500 DATE-WRITTEN.  11-05-93.                                         TRKCS110
000600 DATE-COMPILED.                                                   TRKCS110
000700*----------------------------------------------------------------*TRKCS110
000800*    Y110 - YARD MANAGEMENT CRITERIA SPEC                        *TRKCS110
000900*                                                                *TRKCS110
001000*    THIS PROGRAM ALLOWS THE USER TO ENTER DATA TO BE USED BY    *TRKCS110
001100*    SUBSEQUENT PROGRAMS TO CREATE A LIST OR TO BRING UP A       *TRKCS110
001200*    DETAIL SCREEN. ALL OTHER EDITS ARE DONE IN THE DESTINATION  *TRKCS110
001300*    PROGRAMS WHEN THE 'GO-TO' TYPE FUNCTION IS USED.            *TRKCS110
001400*----------------------------------------------------------------*TRKCS110
263697* CHANGED 11/08/2021    BY JIM HUNTER      WR: CHG0263697                 
263697* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE             
263697* MAKING THE CALL DYNAMIC VS STATIC.                                      
263697*---------------------------------------------------------------*         
CICS  * CHANGED 11/21/2022    BY JIM HUNTER      WR: CHG0278495                 
CICS  * ADD COPYBOOK DPWS930 AND MAKE THE CICS ARCHITECTURE CALL                
CICS  * DYNAMIC INSTEAD OF STATIC BY CALLING DP930-CICS-ARCH-API.               
CICS  *-----------------------------------------------------------------        
001500                                                                  TRKCS110
001600 ENVIRONMENT DIVISION.                                            TRKCS110
001700 DATA DIVISION.                                                   TRKCS110
001800/                                                                 TRKCS110
001900 WORKING-STORAGE SECTION.                                         TRKCS110
002000                                                                  TRKCS110
002100 01  DK-DB2-KEYS.                                                 TRKCS110
002200     05  DK-OPER-UNT-ID               PIC S9(04) VALUE +0         TRKCS110
002300                                                 COMP.            TRKCS110
002400     05  DK-FCLTY-ID                  PIC S9(04) VALUE +0         TRKCS110
002500                                                 COMP.            TRKCS110
002600     05  DK-FCLTY-AREA-ID             PIC  X(06) VALUE SPACES.    TRKCS110
002700     05  DK-FCLTY-LOC-TYP-CDE         PIC  X(02) VALUE SPACES.    TRKCS110
002800     05  DK-SCAC-CDE                  PIC  X(04) VALUE SPACES.    TRKCS110
002900     05  DK-SHIPT-STATUS-CDE          PIC  X(02) VALUE SPACES.    TRKCS110
003000                                                                  TRKCS110
003100 01  PC-PROGRAM-CONSTANTS.                                        TRKCS110
003200     05  PC-CURRENT-MAP-NAME       PIC  X(08)  VALUE  'TR110A  '. TRKCS110
003300     05  PC-CURRENT-MAPSET-NAME    PIC  X(08)  VALUE  'TRKM110 '. TRKCS110
003400     05  PC-CURRENT-PROGRAM-NAME   PIC  X(08)  VALUE  'TRKCS110'. TRKCS110
003500     05  PC-MAX-RETRIES            PIC  9(01)  VALUE  3.          TRKCS110
003600     05  PC-DPKUT500               PIC  X(08)  VALUE  'DPKUT500'. TRKCS110
003700     05  PC-TSYMSG-NUMBERS.                                       TRKCS110
003800         10  PC-TSYMSG-00005       PIC  9(05)  VALUE  00005.      TRKCS110
003900         10  PC-TSYMSG-00007       PIC  9(05)  VALUE  00007.      TRKCS110
004000         10  PC-TSYMSG-00008       PIC  9(05)  VALUE  00008.      TRKCS110
004100         10  PC-TSYMSG-00009       PIC  9(05)  VALUE  00009.      TRKCS110
004200         10  PC-TSYMSG-00098       PIC  9(05)  VALUE  00098.      TRKCS110
004300         10  PC-TSYMSG-00143       PIC  9(05)  VALUE  00143.      TRKCS110
004400         10  PC-TSYMSG-00148       PIC  9(05)  VALUE  00148.      TRKCS110
004500         10  PC-TSYMSG-00587       PIC  9(05)  VALUE  00587.      TRKCS110
004600         10  PC-TSYMSG-00639       PIC  9(05)  VALUE  00639.      TRKCS110
004700         10  PC-TSYMSG-00640       PIC  9(05)  VALUE  00640.      TRKCS110
004800         10  PC-TSYMSG-00788       PIC  9(05)  VALUE  00788.      TRKCS110
004900         10  PC-TSYMSG-00789       PIC  9(05)  VALUE  00789.      TRKCS110
005000                                                                  TRKCS110
005100 01  PV-PROGRAM-VARIABLES.                                        TRKCS110
005200     05  PV-RETRY-COUNTER          PIC  9(03)  VALUE  0           TRKCS110
005300                                               COMP-3.            TRKCS110
005400     05  PV-DB2-COUNT              PIC S9(09)  VALUE +0           TRKCS110
005500                                               COMP-3.            TRKCS110
005600     05  PV-LOCATION.                                             TRKCS110
005700         10  FILLER                PIC  X(01)  VALUE '0'.         TRKCS110
005800         10  PV-DP020-LOCATION     PIC  X(03)  VALUE '000'.       TRKCS110
005900                                                                  TRKCS110
006000     05  PV-HOUR                   PIC  X(02).                    TRKCS110
006100     05  PV-HOUR-N REDEFINES PV-HOUR                              TRKCS110
006200                                   PIC  9(02).                    TRKCS110
006300     05  PV-MINUTE                 PIC  X(02).                    TRKCS110
006400     05  PV-MINUTE-N REDEFINES PV-MINUTE                          TRKCS110
006500                                   PIC  9(02).                    TRKCS110
006600     05  PV-FCLTY-NME              PIC  X(24).                    TRKCS110
006700                                                                  TRKCS110
006800/                                                                 TRKCS110
006900*----------------------------------------------------------------*TRKCS110
007000*    WORKING STORAGE AREA FOR THE RIGHT JUSTIFICATION ROUTINE    *TRKCS110
007100*----------------------------------------------------------------*TRKCS110
007200     COPY TRWS011.                                                TRKCS110
007300                                                                  TRKCS110
007400 01  PS-PROGRAM-SWITCHES.                                         TRKCS110
007500     05  PS-ERROR-SW               PIC  X(01)  VALUE  'N'.        TRKCS110
007600         88  PS-ERROR                          VALUE  'Y'.        TRKCS110
007700         88  PS-NO-ERROR                       VALUE  'N'.        TRKCS110
007800                                                                  TRKCS110
007900*----------------------------------------------------------------*TRKCS110
008000*    MAP LAYOUT                                                  *TRKCS110
008100*----------------------------------------------------------------*TRKCS110
008200     COPY TRKM110.                                                TRKCS110
008300                                                                  TRKCS110
008400/                                                                 TRKCS110
008500*----------------------------------------------------------------*TRKCS110
008600*    ATTRIBUTE SETTINGS COPYBOOK.                                *TRKCS110
008700*----------------------------------------------------------------*TRKCS110
008800     COPY DPWS015.                                                TRKCS110
008900                                                                  TRKCS110
009000                                                                     CL**2
009100*****************************************************************    CL**2
009200*    COPY BOOKS FOR THE VALIDATION ROUTINE FOR THE FREIGHT BILL      CL**2
009300*    BILL OF LADING, AND VEHICLE NUMBER                              CL**2
009400*****************************************************************    CL**2
009500     COPY RCWS023.                                                   CL**2
009600                                                                     CL**2
009700/                                                                 TRKCS110
009800*----------------------------------------------------------------*TRKCS110
009900*    FUNCTION KEYS COPYBOOK                                      *TRKCS110
010000*----------------------------------------------------------------*TRKCS110
010100     COPY DPWS016.                                                TRKCS110
010200                                                                  TRKCS110
010300/                                                                 TRKCS110
010400******************************************************************TRKCS110
010500** THE CALLING PARAMETER LIST (DPWS010) FOR THE NUMERIC EDIT    **TRKCS110
010600** SUB-ROUTINE (DPKUT100).                                      **TRKCS110
010700******************************************************************TRKCS110
010800     COPY DPWS010I.                                               TRKCS110
010900                                                                  TRKCS110
011000/                                                                 TRKCS110
011100*----------------------------------------------------------------*TRKCS110
011200*  WORK AREA PASSED IN CALL TO DPKUT500                          *TRKCS110
011300*----------------------------------------------------------------*TRKCS110
011400     COPY DPWS500.                                                TRKCS110
011500                                                                  TRKCS110
011600/                                                                 TRKCS110
011700******************************************************************TRKCS110
011800** THE CALLING PARAMETER LIST (DPWS030) FOR THE CICS            **TRKCS110
011900** ARCHITECTURE API (BLACK BOX) SUB-ROUTINE.                    **TRKCS110
012000******************************************************************TRKCS110
012100     COPY DPWS030.                                                TRKCS110
CICS       COPY DPWS930.                                                TRKCS110
012300/                                                                 TRKCS110
012400***************************************************************** TRKCS110
012500*    STANDARD COMMAREA.                                           TRKCS110
012600***************************************************************** TRKCS110
012700                                                                  TRKCS110
012800     COPY DPWS020.                                                TRKCS110
012900     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                TRKCS110
013000                                                                  TRKCS110
013100***************************************************************** TRKCS110
013200*    INTER-APPLICATION COMMAREA.                                  TRKCS110
013300***************************************************************** TRKCS110
013400                                                                  TRKCS110
013500         10  INTER-APPL-COMM-AREA PIC X(200).                     TRKCS110
013600     COPY TRWS005.                                                TRKCS110
013700***************************************************************** TRKCS110
013800*    SPECIFIC COMMMAREA FOR TRKCS110.                             TRKCS110
013900***************************************************************** TRKCS110
014000         10  ASC-SPECIFIC-COMMAREA.                               TRKCS110
014100             15  ASC-OPER-UNT-ID           PIC X(04).             TRKCS110
014200             15  ASC-OPER-UNT-ID-N REDEFINES ASC-OPER-UNT-ID      TRKCS110
014300                                           PIC 9(04).             TRKCS110
014400             15  ASC-FCLTY-ID              PIC X(04).             TRKCS110
014500             15  ASC-FCLTY-ID-N    REDEFINES ASC-FCLTY-ID         TRKCS110
014600                                           PIC 9(04).             TRKCS110
014700             15  ASC-FCLTY-NME             PIC X(24).             TRKCS110
014800             15  ASC-DEST-OPER-UNT-ID      PIC X(04).             TRKCS110
014900             15  ASC-DEST-OPER-UNT-ID-N REDEFINES                 TRKCS110
015000                                        ASC-DEST-OPER-UNT-ID      TRKCS110
015100                                           PIC 9(04).             TRKCS110
015200             15  ASC-DEST-FCLTY-ID         PIC X(04).             TRKCS110
015300             15  ASC-DEST-FCLTY-ID-N REDEFINES ASC-DEST-FCLTY-ID  TRKCS110
015400                                           PIC 9(04).             TRKCS110
015500             15  ASC-CURR-YARD-LOC-ID      PIC X(06).             TRKCS110
015600             15  ASC-CURR-SPACE-LOC-ID     PIC X(06).             TRKCS110
015700             15  ASC-CURR-DOCK-AREA        PIC X(06).             TRKCS110
015800             15  ASC-CURR-DOCK-DOOR        PIC X(06).             TRKCS110
015900             15  ASC-STATUS-IND-1          PIC X(02).             TRKCS110
016000             15  ASC-STATUS-IND-2          PIC X(02).             TRKCS110
016100             15  ASC-STATUS-IND-3          PIC X(02).             TRKCS110
016200             15  ASC-STATUS-IND-4          PIC X(02).             TRKCS110
016300             15  ASC-STATUS-IND-5          PIC X(02).             TRKCS110
016400             15  ASC-USAGE-IND-1           PIC X(03).             TRKCS110
016500             15  ASC-USAGE-IND-2           PIC X(03).             TRKCS110
016600             15  ASC-USAGE-IND-3           PIC X(03).             TRKCS110
016700             15  ASC-DELIVERY-SCAC-CDE     PIC X(04).             TRKCS110
016800             15  ASC-TRLR-NBR              PIC X(10).             TRKCS110
016900             15  ASC-TRLR-STAT-FROM-DTE.                          TRKCS110
017000                 20  ASC-TRLR-STAT-FR-DTE-MM   PIC X(02).         TRKCS110
017100                 20  ASC-TRLR-STAT-FR-DTE-DD   PIC X(02).         TRKCS110
017200                 20  ASC-TRLR-STAT-FR-DTE-CCYY PIC X(04).         TRKCS110
017300             15  ASC-TRLR-STAT-FROM-DTE-ISO    PIC X(10).         TRKCS110
017400             15  ASC-TRLR-STAT-TO-DTE.                            TRKCS110
017500                 20  ASC-TRLR-STAT-TO-DTE-MM   PIC X(02).         TRKCS110
017600                 20  ASC-TRLR-STAT-TO-DTE-DD   PIC X(02).         TRKCS110
017700                 20  ASC-TRLR-STAT-TO-DTE-CCYY PIC X(04).         TRKCS110
017800             15  ASC-TRLR-STAT-TO-DTE-ISO      PIC X(10).         TRKCS110
017900             15  ASC-PRO-NBR-SCAC-CDE      PIC X(04).             TRKCS110
018000             15  ASC-PRO-NBR               PIC X(16).             TRKCS110
018100             15  ASC-BILL-OF-LADING        PIC X(16).             TRKCS110
020000                                                                  TRKCS110
020100/                                                                 TRKCS110
020200*----------------------------------------------------------------*TRKCS110
020300*    ABEND PROCESSING COPYBOOK.                                  *TRKCS110
020400*----------------------------------------------------------------*TRKCS110
020500     COPY DPWS013.                                                TRKCS110
020600                                                                  TRKCS110
020700/                                                                 TRKCS110
020800*----------------------------------------------------------------*TRKCS110
020900*    DB2 AREA FOR THE FACILITY TABLE                             *TRKCS110
021000*----------------------------------------------------------------*TRKCS110
021100                                                                  TRKCS110
021200     EXEC SQL                                                     TRKCS110
021300         INCLUDE TFACLTY                                          TRKCS110
021400     END-EXEC.                                                    TRKCS110
021500                                                                  TRKCS110
021600/                                                                 TRKCS110
021700*----------------------------------------------------------------*TRKCS110
021800*    DB2 AREA FOR THE FACILITY AREA TABLE                        *TRKCS110
021900*----------------------------------------------------------------*TRKCS110
022000                                                                  TRKCS110
022100     EXEC SQL                                                     TRKCS110
022200         INCLUDE TFLAREA                                          TRKCS110
022300     END-EXEC.                                                    TRKCS110
022400                                                                  TRKCS110
022500/                                                                 TRKCS110
022600*----------------------------------------------------------------*TRKCS110
022700*    DB2 AREA FOR THE EXTERNAL ENTERPRISE TABLE                  *TRKCS110
022800*----------------------------------------------------------------*TRKCS110
022900                                                                  TRKCS110
023000     EXEC SQL                                                     TRKCS110
023100         INCLUDE TEXTENT                                          TRKCS110
023200     END-EXEC.                                                    TRKCS110
023300                                                                  TRKCS110
023400/                                                                 TRKCS110
023500*----------------------------------------------------------------*TRKCS110
023600*    DB2 AREA FOR THE SHIPMENT STATUS CODE TABLE                 *TRKCS110
023700*----------------------------------------------------------------*TRKCS110
023800                                                                  TRKCS110
023900     EXEC SQL                                                     TRKCS110
024000         INCLUDE TSHSTYP                                          TRKCS110
024100     END-EXEC.                                                    TRKCS110
024200                                                                  TRKCS110
024300/                                                                 TRKCS110
024400*----------------------------------------------------------------*TRKCS110
024500*    DB2 AREA FOR COMMUNICATIONS                                 *TRKCS110
024600*----------------------------------------------------------------*TRKCS110
024700                                                                  TRKCS110
024800     EXEC SQL                                                     TRKCS110
024900         INCLUDE SQLCA                                            TRKCS110
025000     END-EXEC.                                                    TRKCS110
025100                                                                  TRKCS110
025200/                                                                 TRKCS110
025300 LINKAGE SECTION.                                                 TRKCS110
025400                                                                  TRKCS110
025500 01  DFHCOMMAREA.                                                 TRKCS110
025600     05  FILLER                         OCCURS  1 TO 4072 TIMES   TRKCS110
025700                                        DEPENDING ON EIBCALEN.    TRKCS110
025800         10  FILLER                     PIC X.                    TRKCS110
025900                                                                  TRKCS110
026000/                                                                 TRKCS110
026100 PROCEDURE DIVISION.                                              TRKCS110
026200                                                                  TRKCS110
026300***************************************************************** TRKCS110
026400** THIS MODULE CONTROLS THE OVERALL PROCESSING IN THE PROGRAM. ** TRKCS110
026500** THE SETUP AND PERFORM OF PARAGRAPH 0001-CALL-CICS-ARCH-API  ** TRKCS110
026600** MUST BE THE FIRST CODE EXECUTED IN THIS PROGRAM.            ** TRKCS110
026700**                                                             ** TRKCS110
026800** THE SECOND OR 'EXIT' PERFORM OF THIS PARAGRAPH MUST BE THE  ** TRKCS110
026900** LAST CODE EXECUTED ON EACH ITERATION OF THIS PROGRAM.       ** TRKCS110
027000***************************************************************** TRKCS110
027100                                                                  TRKCS110
027200 0000-MAIN-MODULE.                                                TRKCS110
027300                                                                  TRKCS110
027400     INITIALIZE DP030-CICS-API-FIELDS.                            TRKCS110
027500     MOVE +1                     TO DP030-NUMBER-OF-MAPS.         TRKCS110
027600     MOVE PC-CURRENT-MAPSET-NAME TO DP030-MAPSET-NAME.            TRKCS110
027700     MOVE PC-CURRENT-MAP-NAME    TO DP030-MAP-NAME (1).           TRKCS110
027800     SET DP030-RECEIVE-APPL-MAP  TO TRUE.                         TRKCS110
027900     MOVE LENGTH OF TR110AI      TO DP030-MAP-LENGTH (1).         TRKCS110
028000     MOVE 'PROGRAM ENTRY CALL'   TO DP013-MESSAGE-TEXT (1).       TRKCS110
028100                                                                  TRKCS110
028200     PERFORM 0001-CALL-CICS-ARCH-API.                             TRKCS110
028300     PERFORM 1000-CONTROL-PROCESSING                              TRKCS110
028400                                                                  TRKCS110
028500     MOVE 'PROGRAM EXIT CALL'    TO DP013-MESSAGE-TEXT (1).       TRKCS110
028600     PERFORM 0001-CALL-CICS-ARCH-API.                             TRKCS110
028700                                                                  TRKCS110
028800                                                                  TRKCS110
028900 0001-CALL-CICS-ARCH-API.                                         TRKCS110
029000                                                                  TRKCS110
CICS       CALL DP930-CICS-ARCH-API USING DFHEIBLK                              
029200                                    DFHCOMMAREA                           
029300                                    DP030-CICS-API-FIELDS                 
029400                                    DP020-STANDARD-COMMAREA               
029500                                    TR110AI.                              
029600                                                                  TRKCS110
029700     IF  DP030-RC-CALL-SUCCESSFUL                                 TRKCS110
029800         CONTINUE                                                 TRKCS110
029900     ELSE                                                         TRKCS110
030000         SET DP013-NO-ROLLBACK                                    TRKCS110
030100             DP013-XCTL-DISPLAY-RESTART                           TRKCS110
030200             DP013-CICS-ABEND    TO TRUE                          TRKCS110
030300         MOVE 'BEFORE 0000-MAIN-MODULE'                           TRKCS110
030400                                 TO DP013-PARAGRAPH               TRKCS110
CICS           MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O        
CICS  -             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)              
030700         MOVE DP030-RETURN-CODE  TO DP013-MESSAGE-TEXT (3)        TRKCS110
030800         PERFORM DP013-0000-PROCESS-ABEND                         TRKCS110
030900     END-IF.                                                      TRKCS110
031000                                                                  TRKCS110
031100/                                                                 TRKCS110
031200*----------------------------------------------------------------*TRKCS110
031300*    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT   *TRKCS110
031400*    COURSE OF ACTION IS FOR THIS TRANSACTION.                   *TRKCS110
031500*----------------------------------------------------------------*TRKCS110
031600                                                                  TRKCS110
031700 1000-CONTROL-PROCESSING.                                         TRKCS110
031800                                                                  TRKCS110
031900     EVALUATE TRUE                                                TRKCS110
032000         WHEN DP020-NEXT-ACT-INITIAL                              TRKCS110
032100             INITIALIZE ASC-SPECIFIC-COMMAREA                     TRKCS110
032200             MOVE DP020-LOCATION TO PV-DP020-LOCATION             TRKCS110
032300             MOVE PV-LOCATION    TO ASC-DEST-OPER-UNT-ID          TRKCS110
032400             MOVE 1              TO ASC-DEST-FCLTY-ID-N           TRKCS110
032500*            MOVE PV-LOCATION    TO ASC-OPER-UNT-ID               TRKCS110
032600*            MOVE 1              TO ASC-FCLTY-ID-N                TRKCS110
032700             PERFORM 4000-BUILD-INITIAL-PANEL                     TRKCS110
032800                                                                  TRKCS110
032900         WHEN DP020-NEXT-ACT-READ-MAP                             TRKCS110
033000             PERFORM 2000-FKEY-PROCESSING                         TRKCS110
033100                                                                  TRKCS110
033200         WHEN DP020-NEXT-ACT-RETURN                               TRKCS110
033300             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 TRKCS110
033400             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   TRKCS110
033500                                                                  TRKCS110
033600         WHEN OTHER                                               TRKCS110
033700             SET DP013-LOGIC-ABEND                                TRKCS110
033800                 DP013-NO-ROLLBACK                                TRKCS110
033900                                 TO TRUE                          TRKCS110
034000             MOVE '1000-CONTROL-PROCESSING'                       TRKCS110
034100                                 TO  DP013-PARAGRAPH              TRKCS110
034200             MOVE 'INVALID NEXT ACTIVITY RETURNED TO APPL PGM:'   TRKCS110
034300                                 TO  DP013-MESSAGE-TEXT(1)        TRKCS110
034400             MOVE DP020-NEXT-APPL-ACTIVITY                        TRKCS110
034500                                 TO DP013-MESSAGE-TEXT(2)         TRKCS110
034600             PERFORM DP013-0000-PROCESS-ABEND                     TRKCS110
034700     END-EVALUATE.                                                TRKCS110
034800                                                                  TRKCS110
034900/                                                                 TRKCS110
035000*----------------------------------------------------------------*TRKCS110
035100* FURTHER DETERMINE PROCESSING PATH BASED ON FUNCTION KEY ACTIONS*TRKCS110
035200* SPECIFIC FUNCTION KEYS LISTED HERE ARE ACTED UPON REGARDLESS OF*TRKCS110
035300* EDITS.                                                         *TRKCS110
035400*----------------------------------------------------------------*TRKCS110
035500                                                                  TRKCS110
035600 2000-FKEY-PROCESSING.                                            TRKCS110
035700                                                                  TRKCS110
035800     EVALUATE TRUE                                                TRKCS110
035900                                                                  TRKCS110
036000         WHEN DP020-SRC-AID = DP016-CLEAR                         TRKCS110
036100             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   TRKCS110
036200             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 TRKCS110
036300                                                                  TRKCS110
036400         WHEN DP020-FK-REFRESH(DP020-SRC-AID)                     TRKCS110
036500             INITIALIZE ASC-SPECIFIC-COMMAREA                     TRKCS110
036600             MOVE DP020-LOCATION TO PV-DP020-LOCATION             TRKCS110
036700             MOVE PV-LOCATION    TO ASC-DEST-OPER-UNT-ID          TRKCS110
036800             MOVE 1              TO ASC-DEST-FCLTY-ID-N           TRKCS110
036900             PERFORM 4000-BUILD-INITIAL-PANEL                     TRKCS110
037000             PERFORM 3100-RESET-ATTRIBUTES                        TRKCS110
037100                                                                  TRKCS110
037200         WHEN OTHER                                               TRKCS110
037300             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 TRKCS110
037400             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   TRKCS110
037500             IF  PS-NO-ERROR                                      TRKCS110
037600                 SET DP030-CONTINUE-GO                            TRKCS110
037700                                 TO TRUE                          TRKCS110
037800                 PERFORM 2100-CHECK-FUNCTION-KEY                  TRKCS110
037900             ELSE                                                 TRKCS110
038000                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             TRKCS110
038100                 SET DP030-OVERRIDE-GO                            TRKCS110
038200                                 TO TRUE                          TRKCS110
038300             END-IF                                               TRKCS110
038400     END-EVALUATE.                                                TRKCS110
038500                                                                  TRKCS110
038600/                                                                 TRKCS110
038700******************************************************************TRKCS110
038800** ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED     **TRKCS110
038900** FIRST.  NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED **TRKCS110
039000** FROM THE CICS ARCHITECTURE API.                              **TRKCS110
039100******************************************************************TRKCS110
039200                                                                  TRKCS110
039300 2100-CHECK-FUNCTION-KEY.                                         TRKCS110
039400                                                                  TRKCS110
039500     EVALUATE TRUE                                                TRKCS110
039600         WHEN DP020-FK-LOCAL-GOTO (DP020-SRC-AID)                 TRKCS110
039700             PERFORM 2110-PREPARE-INTER-APPL-COMM                 TRKCS110
039800                                                                  TRKCS110
039900         WHEN DP020-SRC-AID = DP016-ENTER                         TRKCS110
040000             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 TRKCS110
040100                                                                  TRKCS110
040200         WHEN OTHER                                               TRKCS110
040300             SET DP013-NO-ROLLBACK                                TRKCS110
040400                 DP013-XCTL-DISPLAY-RESTART                       TRKCS110
040500                 DP013-CICS-ABEND                                 TRKCS110
040600                                 TO TRUE                          TRKCS110
040700             MOVE '2100-CHECK-FUNCTION-KEY'                       TRKCS110
040800                                 TO DP013-PARAGRAPH               TRKCS110
040900             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      TRKCS110
041000                                 TO DP013-MESSAGE-TEXT (1)        TRKCS110
041100             PERFORM DP013-0000-PROCESS-ABEND                     TRKCS110
041200     END-EVALUATE.                                                TRKCS110
041300                                                                  TRKCS110
041400/                                                                 TRKCS110
041500******************************************************************TRKCS110
041600** MOVE DATA NECESSARY TO THE DESTINATION PROGRAM(S) INTO THE   **TRKCS110
041700** INTER-APPLICATION COMMAREA.                                  **TRKCS110
041800******************************************************************TRKCS110
041900                                                                  TRKCS110
042000 2110-PREPARE-INTER-APPL-COMM.                                    TRKCS110
042100                                                                  TRKCS110
042200     INITIALIZE TR005-INTER-APPL-COMMAREA.                        TRKCS110
042300                                                                  TRKCS110
042400     MOVE ASC-OPER-UNT-ID-N      TO TR005-OPER-UNT-ID.            TRKCS110
042500     MOVE ASC-FCLTY-ID-N         TO TR005-FCLTY-ID.               TRKCS110
042600     MOVE ASC-DEST-OPER-UNT-ID-N TO TR005-DEST-OPER-UNT-ID.       TRKCS110
042700     MOVE ASC-DEST-FCLTY-ID-N    TO TR005-DEST-FCLTY-ID.          TRKCS110
042800     MOVE ASC-CURR-YARD-LOC-ID   TO TR005-CURR-YARD-LOC-ID.       TRKCS110
042900     MOVE ASC-CURR-SPACE-LOC-ID  TO TR005-CURR-SPACE-LOC-ID.      TRKCS110
043000     MOVE ASC-CURR-DOCK-AREA     TO TR005-CURR-DOCK-AREA.         TRKCS110
043100     MOVE ASC-CURR-DOCK-DOOR     TO TR005-CURR-DOCK-DOOR.         TRKCS110
043200     MOVE ASC-STATUS-IND-1       TO TR005-STATUS-IND-1.           TRKCS110
043300     MOVE ASC-STATUS-IND-2       TO TR005-STATUS-IND-2.           TRKCS110
043400     MOVE ASC-STATUS-IND-3       TO TR005-STATUS-IND-3.           TRKCS110
043500     MOVE ASC-STATUS-IND-4       TO TR005-STATUS-IND-4.           TRKCS110
043600     MOVE ASC-STATUS-IND-5       TO TR005-STATUS-IND-5.           TRKCS110
043700     MOVE ASC-USAGE-IND-1        TO TR005-USAGE-IND-1.            TRKCS110
043800     MOVE ASC-USAGE-IND-2        TO TR005-USAGE-IND-2.            TRKCS110
043900     MOVE ASC-USAGE-IND-3        TO TR005-USAGE-IND-3.            TRKCS110
044000     MOVE ASC-DELIVERY-SCAC-CDE  TO TR005-DELIVERY-SCAC-CDE.      TRKCS110
044100     MOVE ASC-TRLR-NBR           TO TR005-TRLR-NBR.               TRKCS110
044200     MOVE ASC-TRLR-STAT-FROM-DTE-ISO                              TRKCS110
044300                                 TO TR005-TRLR-STAT-FROM-DTE.     TRKCS110
044400     MOVE ASC-TRLR-STAT-TO-DTE-ISO                                TRKCS110
044500                                 TO TR005-TRLR-STAT-TO-DTE.       TRKCS110
044600     MOVE ASC-PRO-NBR-SCAC-CDE   TO TR005-PRO-NBR-SCAC-CDE.       TRKCS110
044700     MOVE ASC-PRO-NBR            TO TR005-PRO-NBR.                TRKCS110
044800     MOVE ASC-BILL-OF-LADING     TO TR005-BILL-OF-LADING.         TRKCS110
044900     MOVE SPACES                 TO TR005-SCHD-DOCK-AREA          TRKCS110
045000                                    TR005-SCHD-DOCK-DOOR          TRKCS110
045100                                    TR005-SCHD-FROM-DTE           TRKCS110
045200                                    TR005-SCHD-TO-DTE             TRKCS110
045700                                    TR005-SCHD-FROM-TME                   
046700                                    TR005-SCHD-TO-TME.                    
046900                                                                  TRKCS110
047000/                                                                 TRKCS110
047100*----------------------------------------------------------------*TRKCS110
047200* MOVE DATA ENTERED ON THE SCREEN INTO THEIR RESPECTIVE FIELDS IN*TRKCS110
047300* THE APPLICATION-SPECIFIC COMMAREA.  ALL EDITS ARE DONE IN THE  *TRKCS110
047400* APPLICATION-SPECIFIC COMMAREA, NOT ON THE SCREEN.              *TRKCS110
047500*----------------------------------------------------------------*TRKCS110
047600                                                                  TRKCS110
047700 2200-MOVE-SCREEN-TO-COMMAREA.                                    TRKCS110
047800                                                                  TRKCS110
047900     IF  AOPERL > ZERO                                            TRKCS110
048000         MOVE AOPERI               TO ASC-OPER-UNT-ID             TRKCS110
048100     ELSE                                                         TRKCS110
048200         IF  AOPERF = DP015-ERASE-EOF                             TRKCS110
048300             MOVE SPACE            TO ASC-OPER-UNT-ID             TRKCS110
048400         END-IF                                                   TRKCS110
048500     END-IF.                                                      TRKCS110
048600                                                                  TRKCS110
048700     IF  AFCLTYL > ZERO                                           TRKCS110
048800         MOVE AFCLTYI              TO ASC-FCLTY-ID                TRKCS110
048900     ELSE                                                         TRKCS110
049000         IF  AFCLTYF = DP015-ERASE-EOF                            TRKCS110
049100             MOVE SPACE            TO ASC-FCLTY-ID                TRKCS110
049200                                      ASC-FCLTY-NME               TRKCS110
049300                                      AFDESCO                     TRKCS110
049400         END-IF                                                   TRKCS110
049500     END-IF.                                                      TRKCS110
049600                                                                  TRKCS110
049700     IF  ADOPERL > ZERO                                           TRKCS110
049800         MOVE ADOPERI              TO ASC-DEST-OPER-UNT-ID        TRKCS110
049900     ELSE                                                         TRKCS110
050000         IF  ADOPERF = DP015-ERASE-EOF                            TRKCS110
050100             MOVE SPACE            TO ASC-DEST-OPER-UNT-ID        TRKCS110
050200         END-IF                                                   TRKCS110
050300     END-IF.                                                      TRKCS110
050400                                                                  TRKCS110
050500     IF  ADFCLTYL > ZERO                                          TRKCS110
050600         MOVE ADFCLTYI             TO ASC-DEST-FCLTY-ID           TRKCS110
050700     ELSE                                                         TRKCS110
050800         IF  ADFCLTYF = DP015-ERASE-EOF                           TRKCS110
050900             MOVE SPACE            TO ASC-DEST-FCLTY-ID           TRKCS110
051000                                      ADFDESCO                    TRKCS110
051100         END-IF                                                   TRKCS110
051200     END-IF.                                                      TRKCS110
051300                                                                  TRKCS110
051400     IF  AYARDL > ZERO                                            TRKCS110
051500         MOVE AYARDI               TO ASC-CURR-YARD-LOC-ID        TRKCS110
051600     ELSE                                                         TRKCS110
051700         IF  AYARDF = DP015-ERASE-EOF                             TRKCS110
051800             MOVE SPACE            TO ASC-CURR-YARD-LOC-ID        TRKCS110
051900         END-IF                                                   TRKCS110
052000     END-IF.                                                      TRKCS110
052100                                                                  TRKCS110
052200     IF  ASPACEL > ZERO                                           TRKCS110
052300         MOVE ASPACEI              TO ASC-CURR-SPACE-LOC-ID       TRKCS110
052400     ELSE                                                         TRKCS110
052500         IF  ASPACEF = DP015-ERASE-EOF                            TRKCS110
052600             MOVE SPACE            TO ASC-CURR-SPACE-LOC-ID       TRKCS110
052700         END-IF                                                   TRKCS110
052800     END-IF.                                                      TRKCS110
052900                                                                  TRKCS110
053000     IF  ADOCKL > ZERO                                            TRKCS110
053100         MOVE ADOCKI               TO ASC-CURR-DOCK-AREA          TRKCS110
053200     ELSE                                                         TRKCS110
053300         IF  ADOCKF = DP015-ERASE-EOF                             TRKCS110
053400             MOVE SPACE            TO ASC-CURR-DOCK-AREA          TRKCS110
053500         END-IF                                                   TRKCS110
053600     END-IF.                                                      TRKCS110
053700                                                                  TRKCS110
053800     IF  ADOORL > ZERO                                            TRKCS110
053900         MOVE ADOORI               TO ASC-CURR-DOCK-DOOR          TRKCS110
054000     ELSE                                                         TRKCS110
054100         IF  ADOORF = DP015-ERASE-EOF                             TRKCS110
054200             MOVE SPACE            TO ASC-CURR-DOCK-DOOR          TRKCS110
054300         END-IF                                                   TRKCS110
054400     END-IF.                                                      TRKCS110
054500                                                                  TRKCS110
054600     IF  ASTAT1L > ZERO                                           TRKCS110
054700         MOVE ASTAT1I              TO ASC-STATUS-IND-1            TRKCS110
054800     ELSE                                                         TRKCS110
054900         IF  ASTAT1F = DP015-ERASE-EOF                            TRKCS110
055000             MOVE SPACE            TO ASC-STATUS-IND-1            TRKCS110
055100         END-IF                                                   TRKCS110
055200     END-IF.                                                      TRKCS110
055300                                                                  TRKCS110
055400     IF  ASTAT2L > ZERO                                           TRKCS110
055500         MOVE ASTAT2I              TO ASC-STATUS-IND-2            TRKCS110
055600     ELSE                                                         TRKCS110
055700         IF  ASTAT2F = DP015-ERASE-EOF                            TRKCS110
055800             MOVE SPACE            TO ASC-STATUS-IND-2            TRKCS110
055900         END-IF                                                   TRKCS110
056000     END-IF.                                                      TRKCS110
056100                                                                  TRKCS110
056200     IF  ASTAT3L > ZERO                                           TRKCS110
056300         MOVE ASTAT3I              TO ASC-STATUS-IND-3            TRKCS110
056400     ELSE                                                         TRKCS110
056500         IF  ASTAT3F = DP015-ERASE-EOF                            TRKCS110
056600             MOVE SPACE            TO ASC-STATUS-IND-3            TRKCS110
056700         END-IF                                                   TRKCS110
056800     END-IF.                                                      TRKCS110
056900                                                                  TRKCS110
057000     IF  ASTAT4L > ZERO                                           TRKCS110
057100         MOVE ASTAT4I              TO ASC-STATUS-IND-4            TRKCS110
057200     ELSE                                                         TRKCS110
057300         IF  ASTAT4F = DP015-ERASE-EOF                            TRKCS110
057400             MOVE SPACE            TO ASC-STATUS-IND-4            TRKCS110
057500         END-IF                                                   TRKCS110
057600     END-IF.                                                      TRKCS110
057700                                                                  TRKCS110
057800     IF  ASTAT5L > ZERO                                           TRKCS110
057900         MOVE ASTAT5I              TO ASC-STATUS-IND-5            TRKCS110
058000     ELSE                                                         TRKCS110
058100         IF  ASTAT5F = DP015-ERASE-EOF                            TRKCS110
058200             MOVE SPACE            TO ASC-STATUS-IND-5            TRKCS110
058300         END-IF                                                   TRKCS110
058400     END-IF.                                                      TRKCS110
058500                                                                  TRKCS110
058600     IF  AUSE1L > ZERO                                            TRKCS110
058700         MOVE AUSE1I               TO ASC-USAGE-IND-1             TRKCS110
058800     ELSE                                                         TRKCS110
058900         IF  AUSE1F = DP015-ERASE-EOF                             TRKCS110
059000             MOVE SPACE            TO ASC-USAGE-IND-1             TRKCS110
059100         END-IF                                                   TRKCS110
059200     END-IF.                                                      TRKCS110
059300                                                                  TRKCS110
059400     IF  AUSE2L > ZERO                                            TRKCS110
059500         MOVE AUSE2I               TO ASC-USAGE-IND-2             TRKCS110
059600     ELSE                                                         TRKCS110
059700         IF  AUSE2F = DP015-ERASE-EOF                             TRKCS110
059800             MOVE SPACE            TO ASC-USAGE-IND-2             TRKCS110
059900         END-IF                                                   TRKCS110
060000     END-IF.                                                      TRKCS110
060100                                                                  TRKCS110
060200     IF  AUSE3L > ZERO                                            TRKCS110
060300         MOVE AUSE3I               TO ASC-USAGE-IND-3             TRKCS110
060400     ELSE                                                         TRKCS110
060500         IF  AUSE3F = DP015-ERASE-EOF                             TRKCS110
060600             MOVE SPACE            TO ASC-USAGE-IND-3             TRKCS110
060700         END-IF                                                   TRKCS110
060800     END-IF.                                                      TRKCS110
060900                                                                  TRKCS110
061000     IF  ADSCACL > ZERO                                           TRKCS110
061100         MOVE ADSCACI              TO ASC-DELIVERY-SCAC-CDE       TRKCS110
061200     ELSE                                                         TRKCS110
061300         IF  ADSCACF = DP015-ERASE-EOF                            TRKCS110
061400             MOVE SPACE            TO ASC-DELIVERY-SCAC-CDE       TRKCS110
061500         END-IF                                                   TRKCS110
061600     END-IF.                                                      TRKCS110
061700                                                                  TRKCS110
061800     IF  ATRLRL > ZERO                                            TRKCS110
061900         MOVE ATRLRI               TO ASC-TRLR-NBR                TRKCS110
062000     ELSE                                                         TRKCS110
062100         IF  ATRLRF = DP015-ERASE-EOF                             TRKCS110
062200             MOVE SPACE            TO ASC-TRLR-NBR                TRKCS110
062300         END-IF                                                   TRKCS110
062400     END-IF.                                                      TRKCS110
062500                                                                  TRKCS110
062600     IF  ATSFRMML > ZERO                                          TRKCS110
062700         MOVE ATSFRMMI             TO ASC-TRLR-STAT-FR-DTE-MM     TRKCS110
062800         IF ATSFRMMI = SPACES                                     TRKCS110
062900             MOVE SPACE            TO ASC-TRLR-STAT-FROM-DTE-ISO  TRKCS110
063000         END-IF                                                   TRKCS110
063100     ELSE                                                         TRKCS110
063200         IF  ATSFRMMF = DP015-ERASE-EOF                           TRKCS110
063300             MOVE SPACE            TO ASC-TRLR-STAT-FR-DTE-MM     TRKCS110
063400                                      ASC-TRLR-STAT-FROM-DTE-ISO  TRKCS110
063500         END-IF                                                   TRKCS110
063600     END-IF.                                                      TRKCS110
063700                                                                  TRKCS110
063800     IF  ATSFRDDL > ZERO                                          TRKCS110
063900         MOVE ATSFRDDI             TO ASC-TRLR-STAT-FR-DTE-DD     TRKCS110
064000         IF ATSFRDDI = SPACES                                     TRKCS110
064100             MOVE SPACE            TO ASC-TRLR-STAT-FROM-DTE-ISO  TRKCS110
064200         END-IF                                                   TRKCS110
064300     ELSE                                                         TRKCS110
064400         IF  ATSFRDDF = DP015-ERASE-EOF                           TRKCS110
064500             MOVE SPACE            TO ASC-TRLR-STAT-FR-DTE-DD     TRKCS110
064600                                      ASC-TRLR-STAT-FROM-DTE-ISO  TRKCS110
064700         END-IF                                                   TRKCS110
064800     END-IF.                                                      TRKCS110
064900                                                                  TRKCS110
065000     IF  ATSFRYYL > ZERO                                          TRKCS110
065100         MOVE ATSFRYYI             TO ASC-TRLR-STAT-FR-DTE-CCYY   TRKCS110
065200         IF ATSFRYYI = SPACES                                     TRKCS110
065300             MOVE SPACE            TO ASC-TRLR-STAT-FROM-DTE-ISO  TRKCS110
065400         END-IF                                                   TRKCS110
065500     ELSE                                                         TRKCS110
065600         IF  ATSFRYYF = DP015-ERASE-EOF                           TRKCS110
065700             MOVE SPACE            TO ASC-TRLR-STAT-FR-DTE-CCYY   TRKCS110
065800                                      ASC-TRLR-STAT-FROM-DTE-ISO  TRKCS110
065900         END-IF                                                   TRKCS110
066000     END-IF.                                                      TRKCS110
066100                                                                  TRKCS110
066200     IF  ATSTOMML > ZERO                                          TRKCS110
066300         MOVE ATSTOMMI             TO ASC-TRLR-STAT-TO-DTE-MM     TRKCS110
066400         IF ATSTOMMI = SPACES                                     TRKCS110
066500             MOVE SPACE            TO ASC-TRLR-STAT-TO-DTE-ISO    TRKCS110
066600         END-IF                                                   TRKCS110
066700     ELSE                                                         TRKCS110
066800         IF  ATSTOMMF = DP015-ERASE-EOF                           TRKCS110
066900             MOVE SPACE            TO ASC-TRLR-STAT-TO-DTE-MM     TRKCS110
067000                                      ASC-TRLR-STAT-TO-DTE-ISO    TRKCS110
067100         END-IF                                                   TRKCS110
067200     END-IF.                                                      TRKCS110
067300                                                                  TRKCS110
067400     IF  ATSTODDL > ZERO                                          TRKCS110
067500         MOVE ATSTODDI             TO ASC-TRLR-STAT-TO-DTE-DD     TRKCS110
067600         IF ATSTODDI = SPACES                                     TRKCS110
067700             MOVE SPACE            TO ASC-TRLR-STAT-TO-DTE-ISO    TRKCS110
067800         END-IF                                                   TRKCS110
067900     ELSE                                                         TRKCS110
068000         IF  ATSTODDF = DP015-ERASE-EOF                           TRKCS110
068100             MOVE SPACE            TO ASC-TRLR-STAT-TO-DTE-DD     TRKCS110
068200                                      ASC-TRLR-STAT-TO-DTE-ISO    TRKCS110
068300         END-IF                                                   TRKCS110
068400     END-IF.                                                      TRKCS110
068500                                                                  TRKCS110
068600     IF  ATSTOYYL > ZERO                                          TRKCS110
068700         MOVE ATSTOYYI             TO ASC-TRLR-STAT-TO-DTE-CCYY   TRKCS110
068800         IF ATSTOYYI = SPACES                                     TRKCS110
068900             MOVE SPACE            TO ASC-TRLR-STAT-TO-DTE-ISO    TRKCS110
069000         END-IF                                                   TRKCS110
069100     ELSE                                                         TRKCS110
069200         IF  ATSTOYYF = DP015-ERASE-EOF                           TRKCS110
069300             MOVE SPACE            TO ASC-TRLR-STAT-TO-DTE-CCYY   TRKCS110
069400                                      ASC-TRLR-STAT-TO-DTE-ISO    TRKCS110
069500         END-IF                                                   TRKCS110
069600     END-IF.                                                      TRKCS110
069700                                                                  TRKCS110
069800     IF  APSCACL > ZERO                                           TRKCS110
069900         MOVE APSCACI              TO ASC-PRO-NBR-SCAC-CDE        TRKCS110
070000     ELSE                                                         TRKCS110
070100         IF  APSCACF = DP015-ERASE-EOF                            TRKCS110
070200             MOVE SPACE            TO ASC-PRO-NBR-SCAC-CDE        TRKCS110
070300         END-IF                                                   TRKCS110
070400     END-IF.                                                      TRKCS110
070500                                                                  TRKCS110
070600     IF  APRONBRL > ZERO                                          TRKCS110
070700         MOVE APRONBRI             TO ASC-PRO-NBR                 TRKCS110
070800     ELSE                                                         TRKCS110
070900         IF  APRONBRF = DP015-ERASE-EOF                           TRKCS110
071000             MOVE SPACE            TO ASC-PRO-NBR                 TRKCS110
071100         END-IF                                                   TRKCS110
071200     END-IF.                                                      TRKCS110
071300                                                                  TRKCS110
071400     IF  ABILLL > ZERO                                            TRKCS110
071500         MOVE ABILLI               TO ASC-BILL-OF-LADING          TRKCS110
071600     ELSE                                                         TRKCS110
071700         IF  ABILLF = DP015-ERASE-EOF                             TRKCS110
071800             MOVE SPACE            TO ASC-BILL-OF-LADING          TRKCS110
071900         END-IF                                                   TRKCS110
072000     END-IF.                                                      TRKCS110
073700                                                                  TRKCS110
084200/                                                                 TRKCS110
084300*----------------------------------------------------------------*TRKCS110
084400* ENSURE THE DATA IS CORRECT.  NOTE THAT IN A CRITERIA SPECIFI-  *TRKCS110
084500* CATION SCREEN ONLY MINIMAL EDITS ARE DONE.  EDITS RELATED TO   *TRKCS110
084600* A SPECIFIC SCREEN THAT THE USER IS GOING TO (LOCAL-GO) ARE DONE*TRKCS110
084700* IN THE DESTINATION PROGRAM, NOT HERE.                          *TRKCS110
084800*----------------------------------------------------------------*TRKCS110
084900                                                                  TRKCS110
085000 3000-EDIT-DATA-IN-COMMAREA.                                      TRKCS110
085100                                                                  TRKCS110
085200     PERFORM 3100-RESET-ATTRIBUTES.                               TRKCS110
108700                                                                  TRKCS110
108800** CHECK THE DESTINATION OPERATING UNIT/FACILITY NUMBER **        TRKCS110
108900                                                                  TRKCS110
109000     IF  ASC-DEST-OPER-UNT-ID = SPACES                            TRKCS110
109100         MOVE ZEROS              TO ASC-DEST-OPER-UNT-ID-N        TRKCS110
109200                                    DK-OPER-UNT-ID                TRKCS110
109300     END-IF.                                                      TRKCS110
109400                                                                  TRKCS110
109500     MOVE ASC-DEST-OPER-UNT-ID TO DP010I-UNEDITED-FIELD.          TRKCS110
109600     MOVE LENGTH OF ASC-DEST-OPER-UNT-ID                          TRKCS110
109700                             TO DP010I-MAXIMUM-DIGITS.            TRKCS110
109800     MOVE ZERO               TO DP010I-MAXIMUM-DECIMALS.          TRKCS110
109900     SET DP010I-NEGATIVE-NOT-ALLOWED                              TRKCS110
110000                             TO TRUE                              TRKCS110
263697     CALL DP010I-NUMERIC-EDIT-ROUTINE                                     
263697          USING DP010I-NUMERIC-EDIT-AREA.                                 
110200                                                                  TRKCS110
110300     IF  DP010I-ERROR-DETECTED                                    TRKCS110
110400         SET PS-ERROR                                             TRKCS110
110500             DP020-MSG-FATAL TO TRUE                              TRKCS110
110600         MOVE PC-TSYMSG-00788                                     TRKCS110
110700                             TO DP020-MSG-NUMBER                  TRKCS110
110800         MOVE DP015-UNP-ALP-BRT-OFF                               TRKCS110
110900                             TO ADOPERA                           TRKCS110
111000         MOVE DP015-RED      TO ADOPERC                           TRKCS110
111100         MOVE DP015-REVERSE  TO ADOPERH                           TRKCS110
111200         MOVE -1             TO ADOPERL                           TRKCS110
111300         SET DP030-SET-CURSOR-APPL-1                              TRKCS110
111400                             TO TRUE                              TRKCS110
111500     ELSE                                                         TRKCS110
111600         MOVE DP010I-NUMERIC-FIELD                                TRKCS110
111700                             TO ASC-DEST-OPER-UNT-ID-N            TRKCS110
111800                                DK-OPER-UNT-ID                    TRKCS110
111900         MOVE ASC-DEST-OPER-UNT-ID TO ADOPERO                     TRKCS110
112000     END-IF.                                                      TRKCS110
112100     IF  NOT PS-ERROR                                             TRKCS110
112200         IF  ASC-DEST-FCLTY-ID = ZEROS                            TRKCS110
112300             IF ASC-DEST-OPER-UNT-ID-N = ZEROS                    TRKCS110
112400                 MOVE ZEROS          TO ASC-DEST-FCLTY-ID-N       TRKCS110
112500                                        DK-FCLTY-ID               TRKCS110
112600             ELSE                                                 TRKCS110
112700                 MOVE 1              TO ASC-DEST-FCLTY-ID-N       TRKCS110
112800                                        DK-FCLTY-ID               TRKCS110
112900             END-IF                                               TRKCS110
113000         ELSE                                                     TRKCS110
113100             MOVE ASC-DEST-FCLTY-ID-N                             TRKCS110
113200                                     TO DK-FCLTY-ID               TRKCS110
113300         END-IF                                                   TRKCS110
113400     END-IF.                                                      TRKCS110
113500                                                                  TRKCS110
113600     MOVE ASC-DEST-FCLTY-ID  TO DP010I-UNEDITED-FIELD.            TRKCS110
113700     MOVE LENGTH OF ASC-DEST-FCLTY-ID                             TRKCS110
113800                             TO DP010I-MAXIMUM-DIGITS.            TRKCS110
113900     MOVE ZERO               TO DP010I-MAXIMUM-DECIMALS.          TRKCS110
114000     SET DP010I-NEGATIVE-NOT-ALLOWED                              TRKCS110
114100                             TO TRUE.                             TRKCS110
263697     CALL DP010I-NUMERIC-EDIT-ROUTINE                                     
263697          USING DP010I-NUMERIC-EDIT-AREA.                                 
114300                                                                  TRKCS110
114400     IF  DP010I-ERROR-DETECTED                                    TRKCS110
114500         SET PS-ERROR                                             TRKCS110
114600             DP020-MSG-FATAL TO TRUE                              TRKCS110
114700         MOVE PC-TSYMSG-00788                                     TRKCS110
114800                             TO DP020-MSG-NUMBER                  TRKCS110
114900         MOVE DP015-UNP-ALP-BRT-OFF                               TRKCS110
115000                             TO ADFCLTYA                          TRKCS110
115100         MOVE DP015-RED      TO ADFCLTYC                          TRKCS110
115200         MOVE DP015-REVERSE  TO ADFCLTYH                          TRKCS110
115300         MOVE -1             TO ADFCLTYL                          TRKCS110
115400         SET DP030-SET-CURSOR-APPL-1                              TRKCS110
115500                             TO TRUE                              TRKCS110
115600     ELSE                                                         TRKCS110
115700         MOVE DP010I-NUMERIC-FIELD                                TRKCS110
115800                             TO ASC-DEST-FCLTY-ID-N               TRKCS110
115900                                DK-FCLTY-ID                       TRKCS110
116000         MOVE ASC-DEST-FCLTY-ID TO ADFCLTYO                       TRKCS110
116100     END-IF.                                                      TRKCS110
116200                                                                  TRKCS110
116300     IF NOT PS-ERROR                                              TRKCS110
116400         PERFORM 3020-VALIDATE-FCLTY-ID                           TRKCS110
116500         IF SQLCODE = +0                                          TRKCS110
116600             MOVE FACLTY-FCLTY-NME TO ADFDESCO                    TRKCS110
116700         ELSE                                                     TRKCS110
116800             IF SQLCODE = +100                                    TRKCS110
116900                 SET PS-ERROR                                     TRKCS110
117000                     DP020-MSG-FATAL     TO TRUE                  TRKCS110
117100                 MOVE PC-TSYMSG-00788    TO DP020-MSG-NUMBER      TRKCS110
117200                 MOVE DP015-UNP-ALP-BRT-OFF                       TRKCS110
117300                                         TO ADFCLTYA              TRKCS110
117400                 MOVE DP015-RED          TO ADFCLTYC              TRKCS110
117500                 MOVE DP015-REVERSE      TO ADFCLTYH              TRKCS110
117600                 MOVE -1                 TO ADFCLTYL              TRKCS110
117700                 SET DP030-SET-CURSOR-APPL-1                      TRKCS110
117800                                         TO TRUE                  TRKCS110
117900             END-IF                                               TRKCS110
118000         END-IF                                                   TRKCS110
118100     END-IF.                                                      TRKCS110
118200** END OF DESTINATION CHECK **                                    TRKCS110
118300                                                                  TRKCS110
122400     IF  ASC-TRLR-STAT-TO-DTE-MM > SPACES                         TRKCS110
122500     OR  ASC-TRLR-STAT-TO-DTE-DD > SPACES                         TRKCS110
122600     OR  ASC-TRLR-STAT-TO-DTE-CCYY > SPACES                       TRKCS110
122700        INITIALIZE DPG51 DPG52 DPG53                              TRKCS110
122800                   DPG54 DPG55 DPG56                              TRKCS110
122900         STRING ASC-TRLR-STAT-TO-DTE-MM        DELIMITED BY SIZE  TRKCS110
123000                ASC-TRLR-STAT-TO-DTE-DD        DELIMITED BY SIZE  TRKCS110
123100                ASC-TRLR-STAT-TO-DTE-CCYY      DELIMITED BY SIZE  TRKCS110
123200                               INTO DPG52-LK-DATE-INPUT           TRKCS110
123300        SET DPG51-ACTUAL-CALENDAR-ONLY                            TRKCS110
123400            DPG51-DO-NOT-INCR-DECR-DATE                           TRKCS110
123500            DPG52-LK-DTE-GREG-CC TO TRUE                          TRKCS110
123600        CALL DP500-KOHLS-CALENDAR-ROUTINE                         TRKCS110
123700            USING DPG51 DPG52 DPG53 DPG54 DPG55 DPG56             TRKCS110
123800        IF (DPG54-DATE-INVALID                                    TRKCS110
123900        OR  DPG54-SEVERE-ERROR)                                   TRKCS110
124000            SET PS-ERROR                                          TRKCS110
124100                DP020-MSG-FATAL   TO TRUE                         TRKCS110
124200            MOVE PC-TSYMSG-00009  TO DP020-MSG-NUMBER             TRKCS110
124300            MOVE DP015-UNP-ALP-BRT-MDT                            TRKCS110
124400                                  TO ATSTOMMA                     TRKCS110
124500                                     ATSTODDA                     TRKCS110
124600                                     ATSTOYYA                     TRKCS110
124700            MOVE DP015-RED        TO ATSTOMMC                     TRKCS110
124800                                     ATSTODDC                     TRKCS110
124900                                     ATSTOYYC                     TRKCS110
125000            MOVE DP015-REVERSE    TO ATSTOMMH                     TRKCS110
125100                                     ATSTODDH                     TRKCS110
125200                                     ATSTOYYH                     TRKCS110
125300            MOVE -1               TO ATSTOMML                     TRKCS110
125400            SET DP030-SET-CURSOR-APPL-1                           TRKCS110
125500                                  TO TRUE                         TRKCS110
125600        ELSE                                                      TRKCS110
125700            MOVE DPG55-DB2-ISO-DATE-FMT                           TRKCS110
125800                                  TO ASC-TRLR-STAT-TO-DTE-ISO     TRKCS110
125900        END-IF                                                    TRKCS110
126000     END-IF.                                                      TRKCS110
126100                                                                  TRKCS110
126200     IF  ASC-TRLR-STAT-FR-DTE-MM > SPACES                         TRKCS110
126300     OR  ASC-TRLR-STAT-FR-DTE-DD > SPACES                         TRKCS110
126400     OR  ASC-TRLR-STAT-FR-DTE-CCYY > SPACES                       TRKCS110
126500        INITIALIZE DPG51 DPG52 DPG53                              TRKCS110
126600                   DPG54 DPG55 DPG56                              TRKCS110
126700         STRING ASC-TRLR-STAT-FR-DTE-MM        DELIMITED BY SIZE  TRKCS110
126800                ASC-TRLR-STAT-FR-DTE-DD        DELIMITED BY SIZE  TRKCS110
126900                ASC-TRLR-STAT-FR-DTE-CCYY      DELIMITED BY SIZE  TRKCS110
127000                               INTO DPG52-LK-DATE-INPUT           TRKCS110
127100        SET DPG51-ACTUAL-CALENDAR-ONLY                            TRKCS110
127200            DPG51-DO-NOT-INCR-DECR-DATE                           TRKCS110
127300            DPG52-LK-DTE-GREG-CC TO TRUE                          TRKCS110
127400        CALL DP500-KOHLS-CALENDAR-ROUTINE                         TRKCS110
127500            USING DPG51 DPG52 DPG53 DPG54 DPG55 DPG56             TRKCS110
127600        IF (DPG54-DATE-INVALID                                    TRKCS110
127700        OR  DPG54-SEVERE-ERROR)                                   TRKCS110
127800            SET PS-ERROR                                          TRKCS110
127900                DP020-MSG-FATAL   TO TRUE                         TRKCS110
128000            MOVE PC-TSYMSG-00009  TO DP020-MSG-NUMBER             TRKCS110
128100            MOVE DP015-UNP-ALP-BRT-MDT                            TRKCS110
128200                                  TO ATSFRMMA                     TRKCS110
128300                                     ATSFRDDA                     TRKCS110
128400                                     ATSFRYYA                     TRKCS110
128500            MOVE DP015-RED        TO ATSFRMMC                     TRKCS110
128600                                     ATSFRDDC                     TRKCS110
128700                                     ATSFRYYC                     TRKCS110
128800            MOVE DP015-REVERSE    TO ATSFRMMH                     TRKCS110
128900                                     ATSFRDDH                     TRKCS110
129000                                     ATSFRYYH                     TRKCS110
129100            MOVE -1               TO ATSFRMML                     TRKCS110
129200            SET DP030-SET-CURSOR-APPL-1                           TRKCS110
129300                                  TO TRUE                         TRKCS110
129400        ELSE                                                      TRKCS110
129500            MOVE DPG55-DB2-ISO-DATE-FMT                           TRKCS110
129600                                  TO ASC-TRLR-STAT-FROM-DTE-ISO   TRKCS110
129700        END-IF                                                    TRKCS110
129800     END-IF.                                                      TRKCS110
129900                                                                  TRKCS110
130000     IF  ASC-PRO-NBR-SCAC-CDE > SPACES                            TRKCS110
130100         MOVE ASC-PRO-NBR-SCAC-CDE                                TRKCS110
130200                                  TO DK-SCAC-CDE                  TRKCS110
130300         PERFORM 3040-VALIDATE-SCAC-CDE                           TRKCS110
130400         IF  SQLCODE = +100                                       TRKCS110
130500             SET PS-ERROR                                         TRKCS110
130600                 DP020-MSG-FATAL  TO TRUE                         TRKCS110
130700             MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER             TRKCS110
130800             MOVE DP015-UNP-ALP-BRT-OFF                           TRKCS110
130900                                  TO APSCACA                      TRKCS110
131000             MOVE DP015-RED       TO APSCACC                      TRKCS110
131100             MOVE DP015-REVERSE   TO APSCACH                      TRKCS110
131200             MOVE -1              TO APSCACL                      TRKCS110
131300             SET DP030-SET-CURSOR-APPL-1                          TRKCS110
131400                                  TO TRUE                         TRKCS110
131500         END-IF                                                   TRKCS110
131600     END-IF.                                                      TRKCS110
131700                                                                  TRKCS110
131800     IF  ASC-DELIVERY-SCAC-CDE > SPACES                           TRKCS110
131900         MOVE ASC-DELIVERY-SCAC-CDE                               TRKCS110
132000                                  TO DK-SCAC-CDE                  TRKCS110
132100         PERFORM 3040-VALIDATE-SCAC-CDE                           TRKCS110
132200         IF  SQLCODE = +100                                       TRKCS110
132300             SET PS-ERROR                                         TRKCS110
132400                 DP020-MSG-FATAL  TO TRUE                         TRKCS110
132500             MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER             TRKCS110
132600             MOVE DP015-UNP-ALP-BRT-OFF                           TRKCS110
132700                                  TO ADSCACA                      TRKCS110
132800             MOVE DP015-RED       TO ADSCACC                      TRKCS110
132900             MOVE DP015-REVERSE   TO ADSCACH                      TRKCS110
133000             MOVE -1              TO ADSCACL                      TRKCS110
133100             SET DP030-SET-CURSOR-APPL-1                          TRKCS110
133200                                  TO TRUE                         TRKCS110
133300         END-IF                                                   TRKCS110
133400     END-IF.                                                      TRKCS110
133500                                                                  TRKCS110
133600     IF  ASC-USAGE-IND-3 = '   ' OR 'RCV' OR 'STG' OR 'SHP'       TRKCS110
133700         CONTINUE                                                 TRKCS110
133800     ELSE                                                         TRKCS110
133900         SET PS-ERROR            TO TRUE                          TRKCS110
134000         SET DP020-MSG-FATAL     TO TRUE                          TRKCS110
134100         MOVE PC-TSYMSG-00005    TO DP020-MSG-NUMBER              TRKCS110
134200         MOVE DP015-UNP-ALP-BRT-OFF                               TRKCS110
134300                                 TO AUSE3A                        TRKCS110
134400         MOVE DP015-RED          TO AUSE3C                        TRKCS110
134500         MOVE DP015-REVERSE      TO AUSE3H                        TRKCS110
134600         MOVE -1                 TO AUSE3L                        TRKCS110
134700         SET DP030-SET-CURSOR-APPL-1                              TRKCS110
134800                                 TO TRUE                          TRKCS110
134900     END-IF.                                                      TRKCS110
135000                                                                  TRKCS110
135100     IF  ASC-USAGE-IND-2 = '   ' OR 'RCV' OR 'STG' OR 'SHP'       TRKCS110
135200         CONTINUE                                                 TRKCS110
135300     ELSE                                                         TRKCS110
135400         SET PS-ERROR            TO TRUE                          TRKCS110
135500         SET DP020-MSG-FATAL     TO TRUE                          TRKCS110
135600         MOVE PC-TSYMSG-00005    TO DP020-MSG-NUMBER              TRKCS110
135700         MOVE DP015-UNP-ALP-BRT-OFF                               TRKCS110
135800                                 TO AUSE2A                        TRKCS110
135900         MOVE DP015-RED          TO AUSE2C                        TRKCS110
136000         MOVE DP015-REVERSE      TO AUSE2H                        TRKCS110
136100         MOVE -1                 TO AUSE2L                        TRKCS110
136200         SET DP030-SET-CURSOR-APPL-1                              TRKCS110
136300                                 TO TRUE                          TRKCS110
136400     END-IF.                                                      TRKCS110
136500                                                                  TRKCS110
136600     IF  ASC-USAGE-IND-1 = '   ' OR 'RCV' OR 'STG' OR 'SHP'       TRKCS110
136700         CONTINUE                                                 TRKCS110
136800     ELSE                                                         TRKCS110
136900         SET PS-ERROR            TO TRUE                          TRKCS110
137000         SET DP020-MSG-FATAL     TO TRUE                          TRKCS110
137100         MOVE PC-TSYMSG-00005    TO DP020-MSG-NUMBER              TRKCS110
137200         MOVE DP015-UNP-ALP-BRT-OFF                               TRKCS110
137300                                 TO AUSE1A                        TRKCS110
137400         MOVE DP015-RED          TO AUSE1C                        TRKCS110
137500         MOVE DP015-REVERSE      TO AUSE1H                        TRKCS110
137600         MOVE -1                 TO AUSE1L                        TRKCS110
137700         SET DP030-SET-CURSOR-APPL-1                              TRKCS110
137800                                 TO TRUE                          TRKCS110
137900     END-IF.                                                      TRKCS110
138000                                                                  TRKCS110
138100     IF  ASC-STATUS-IND-5 > SPACES                                TRKCS110
138200         MOVE ASC-STATUS-IND-5   TO DK-SHIPT-STATUS-CDE           TRKCS110
138300         PERFORM 3050-VALIDATE-STATUS-CDE                         TRKCS110
138400         IF  SQLCODE = +100                                       TRKCS110
138500             SET PS-ERROR         TO TRUE                         TRKCS110
138600             SET DP020-MSG-FATAL  TO TRUE                         TRKCS110
138700             MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER             TRKCS110
138800             MOVE DP015-UNP-ALP-BRT-OFF                           TRKCS110
138900                                  TO ASTAT5A                      TRKCS110
139000             MOVE DP015-RED       TO ASTAT5C                      TRKCS110
139100             MOVE DP015-REVERSE   TO ASTAT5H                      TRKCS110
139200             MOVE -1              TO ASTAT5L                      TRKCS110
139300             SET DP030-SET-CURSOR-APPL-1                          TRKCS110
139400                                  TO TRUE                         TRKCS110
139500     END-IF.                                                      TRKCS110
139600                                                                  TRKCS110
139700     IF  ASC-STATUS-IND-4 > SPACES                                TRKCS110
139800         MOVE ASC-STATUS-IND-4   TO DK-SHIPT-STATUS-CDE           TRKCS110
139900         PERFORM 3050-VALIDATE-STATUS-CDE                         TRKCS110
140000         IF  SQLCODE = +100                                       TRKCS110
140100             SET PS-ERROR         TO TRUE                         TRKCS110
140200             SET DP020-MSG-FATAL  TO TRUE                         TRKCS110
140300             MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER             TRKCS110
140400             MOVE DP015-UNP-ALP-BRT-OFF                           TRKCS110
140500                                  TO ASTAT4A                      TRKCS110
140600             MOVE DP015-RED       TO ASTAT4C                      TRKCS110
140700             MOVE DP015-REVERSE   TO ASTAT4H                      TRKCS110
140800             MOVE -1              TO ASTAT4L                      TRKCS110
140900             SET DP030-SET-CURSOR-APPL-1                          TRKCS110
141000                                  TO TRUE                         TRKCS110
141100     END-IF.                                                      TRKCS110
141200                                                                  TRKCS110
141300     IF  ASC-STATUS-IND-3 > SPACES                                TRKCS110
141400         MOVE ASC-STATUS-IND-3   TO DK-SHIPT-STATUS-CDE           TRKCS110
141500         PERFORM 3050-VALIDATE-STATUS-CDE                         TRKCS110
141600         IF  SQLCODE = +100                                       TRKCS110
141700             SET PS-ERROR         TO TRUE                         TRKCS110
141800             SET DP020-MSG-FATAL  TO TRUE                         TRKCS110
141900             MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER             TRKCS110
142000             MOVE DP015-UNP-ALP-BRT-OFF                           TRKCS110
142100                                  TO ASTAT3A                      TRKCS110
142200             MOVE DP015-RED       TO ASTAT3C                      TRKCS110
142300             MOVE DP015-REVERSE   TO ASTAT3H                      TRKCS110
142400             MOVE -1              TO ASTAT3L                      TRKCS110
142500             SET DP030-SET-CURSOR-APPL-1                          TRKCS110
142600                                  TO TRUE                         TRKCS110
142700     END-IF.                                                      TRKCS110
142800                                                                  TRKCS110
142900     IF  ASC-STATUS-IND-2 > SPACES                                TRKCS110
143000         MOVE ASC-STATUS-IND-2   TO DK-SHIPT-STATUS-CDE           TRKCS110
143100         PERFORM 3050-VALIDATE-STATUS-CDE                         TRKCS110
143200         IF  SQLCODE = +100                                       TRKCS110
143300             SET PS-ERROR         TO TRUE                         TRKCS110
143400             SET DP020-MSG-FATAL  TO TRUE                         TRKCS110
143500             MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER             TRKCS110
143600             MOVE DP015-UNP-ALP-BRT-OFF                           TRKCS110
143700                                  TO ASTAT2A                      TRKCS110
143800             MOVE DP015-RED       TO ASTAT2C                      TRKCS110
143900             MOVE DP015-REVERSE   TO ASTAT2H                      TRKCS110
144000             MOVE -1              TO ASTAT2L                      TRKCS110
144100             SET DP030-SET-CURSOR-APPL-1                          TRKCS110
144200                                  TO TRUE                         TRKCS110
144300     END-IF.                                                      TRKCS110
144400                                                                  TRKCS110
144500     IF  ASC-STATUS-IND-1 > SPACES                                TRKCS110
144600         MOVE ASC-STATUS-IND-1   TO DK-SHIPT-STATUS-CDE           TRKCS110
144700         PERFORM 3050-VALIDATE-STATUS-CDE                         TRKCS110
144800         IF  SQLCODE = +100                                       TRKCS110
144900             SET PS-ERROR         TO TRUE                         TRKCS110
145000             SET DP020-MSG-FATAL  TO TRUE                         TRKCS110
145100             MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER             TRKCS110
145200             MOVE DP015-UNP-ALP-BRT-OFF                           TRKCS110
145300                                  TO ASTAT1A                      TRKCS110
145400             MOVE DP015-RED       TO ASTAT1C                      TRKCS110
145500             MOVE DP015-REVERSE   TO ASTAT1H                      TRKCS110
145600             MOVE -1              TO ASTAT1L                      TRKCS110
145700             SET DP030-SET-CURSOR-APPL-1                          TRKCS110
145800                                  TO TRUE                         TRKCS110
145900     END-IF.                                                      TRKCS110
146000                                                                  TRKCS110
146100     IF  NOT PS-ERROR                                             TRKCS110
146200         PERFORM 3010-VALIDATE-OPER-UNT-ID                        TRKCS110
146300         IF SQLCODE = +100                                        TRKCS110
146400             SET PS-ERROR                                         TRKCS110
146500                 DP020-MSG-FATAL     TO TRUE                      TRKCS110
146600             MOVE PC-TSYMSG-00788    TO DP020-MSG-NUMBER          TRKCS110
146700             MOVE DP015-UNP-ALP-BRT-OFF                           TRKCS110
146800                                     TO ADOPERA                   TRKCS110
146900             MOVE DP015-RED          TO ADOPERC                   TRKCS110
147000             MOVE DP015-REVERSE      TO ADOPERH                   TRKCS110
147100             MOVE -1                 TO ADOPERL                   TRKCS110
147200             SET DP030-SET-CURSOR-APPL-1                          TRKCS110
147300                                     TO TRUE                      TRKCS110
147400         END-IF                                                   TRKCS110
147500     END-IF.                                                      TRKCS110
147600                                                                  TRKCS110
147700                                                                  TRKCS110
147800** CHECK THE CURRENT LOCATION OPER UNIT/FACILITY NUMBER **        TRKCS110
147900                                                                  TRKCS110
148000     IF  ASC-OPER-UNT-ID = SPACES                                 TRKCS110
148100         MOVE ZEROS              TO ASC-OPER-UNT-ID-N             TRKCS110
148200                                    DK-OPER-UNT-ID                TRKCS110
148300     END-IF.                                                      TRKCS110
148400                                                                  TRKCS110
148500     MOVE ASC-OPER-UNT-ID TO DP010I-UNEDITED-FIELD.               TRKCS110
148600     MOVE LENGTH OF ASC-OPER-UNT-ID                               TRKCS110
148700                             TO DP010I-MAXIMUM-DIGITS.            TRKCS110
148800     MOVE ZERO               TO DP010I-MAXIMUM-DECIMALS.          TRKCS110
148900     SET DP010I-NEGATIVE-NOT-ALLOWED                              TRKCS110
149000                             TO TRUE                              TRKCS110
263697     CALL DP010I-NUMERIC-EDIT-ROUTINE                                     
263697          USING DP010I-NUMERIC-EDIT-AREA                                  
149200                                                                  TRKCS110
149300     IF  DP010I-ERROR-DETECTED                                    TRKCS110
149400         SET PS-ERROR                                             TRKCS110
149500             DP020-MSG-FATAL TO TRUE                              TRKCS110
149600         MOVE PC-TSYMSG-00789                                     TRKCS110
149700                             TO DP020-MSG-NUMBER                  TRKCS110
149800         MOVE DP015-UNP-ALP-BRT-OFF                               TRKCS110
149900                             TO AOPERA                            TRKCS110
150000         MOVE DP015-RED      TO AOPERC                            TRKCS110
150100         MOVE DP015-REVERSE  TO AOPERH                            TRKCS110
150200         MOVE -1             TO AOPERL                            TRKCS110
150300         SET DP030-SET-CURSOR-APPL-1                              TRKCS110
150400                             TO TRUE                              TRKCS110
150500     ELSE                                                         TRKCS110
150600         MOVE DP010I-NUMERIC-FIELD                                TRKCS110
150700                             TO ASC-OPER-UNT-ID-N                 TRKCS110
150800                                DK-OPER-UNT-ID                    TRKCS110
150900         MOVE ASC-OPER-UNT-ID TO AOPERO                           TRKCS110
151000     END-IF.                                                      TRKCS110
151100                                                                  TRKCS110
151200     IF  NOT PS-ERROR                                             TRKCS110
151300         PERFORM 3010-VALIDATE-OPER-UNT-ID                        TRKCS110
151400         IF SQLCODE = +100                                        TRKCS110
151500             SET PS-ERROR                                         TRKCS110
151600                 DP020-MSG-FATAL     TO TRUE                      TRKCS110
151700             MOVE PC-TSYMSG-00789    TO DP020-MSG-NUMBER          TRKCS110
151800             MOVE DP015-UNP-ALP-BRT-OFF                           TRKCS110
151900                                     TO AOPERA                    TRKCS110
152000             MOVE DP015-RED          TO AOPERC                    TRKCS110
152100             MOVE DP015-REVERSE      TO AOPERH                    TRKCS110
152200             MOVE -1                 TO AOPERL                    TRKCS110
152300             SET DP030-SET-CURSOR-APPL-1                          TRKCS110
152400                                     TO TRUE                      TRKCS110
152500         END-IF                                                   TRKCS110
152600     END-IF.                                                      TRKCS110
152700                                                                  TRKCS110
152800     IF  NOT PS-ERROR                                             TRKCS110
152900         IF  ASC-FCLTY-ID = ZEROS OR SPACES                       TRKCS110
153000             IF ASC-OPER-UNT-ID-N = ZEROS                         TRKCS110
153100                 MOVE ZEROS          TO ASC-FCLTY-ID-N            TRKCS110
153200                                        DK-FCLTY-ID               TRKCS110
153300             ELSE                                                 TRKCS110
153400                 MOVE 1              TO ASC-FCLTY-ID-N            TRKCS110
153500                                        DK-FCLTY-ID               TRKCS110
153600             END-IF                                               TRKCS110
153700         ELSE                                                     TRKCS110
153800             MOVE ASC-FCLTY-ID-N                                  TRKCS110
153900                                     TO DK-FCLTY-ID               TRKCS110
154000         END-IF                                                   TRKCS110
154100     END-IF.                                                      TRKCS110
154200                                                                  TRKCS110
154300     MOVE ASC-FCLTY-ID       TO DP010I-UNEDITED-FIELD.            TRKCS110
154400     MOVE LENGTH OF ASC-FCLTY-ID                                  TRKCS110
154500                             TO DP010I-MAXIMUM-DIGITS.            TRKCS110
154600     MOVE ZERO               TO DP010I-MAXIMUM-DECIMALS.          TRKCS110
154700     SET DP010I-NEGATIVE-NOT-ALLOWED                              TRKCS110
154800                             TO TRUE.                             TRKCS110
263697     CALL DP010I-NUMERIC-EDIT-ROUTINE                                     
263697          USING DP010I-NUMERIC-EDIT-AREA.                                 
155000                                                                  TRKCS110
155100     IF  DP010I-ERROR-DETECTED                                    TRKCS110
155200         SET PS-ERROR                                             TRKCS110
155300             DP020-MSG-FATAL TO TRUE                              TRKCS110
155400         MOVE PC-TSYMSG-00789                                     TRKCS110
155500                             TO DP020-MSG-NUMBER                  TRKCS110
155600         MOVE DP015-UNP-ALP-BRT-OFF                               TRKCS110
155700                             TO AFCLTYA                           TRKCS110
155800         MOVE DP015-RED      TO AFCLTYC                           TRKCS110
155900         MOVE DP015-REVERSE  TO AFCLTYH                           TRKCS110
156000         MOVE -1             TO AFCLTYL                           TRKCS110
156100         SET DP030-SET-CURSOR-APPL-1                              TRKCS110
156200                             TO TRUE                              TRKCS110
156300     ELSE                                                         TRKCS110
156400         MOVE DP010I-NUMERIC-FIELD                                TRKCS110
156500                             TO ASC-FCLTY-ID-N                    TRKCS110
156600                                DK-FCLTY-ID                       TRKCS110
156700         MOVE ASC-FCLTY-ID TO AFCLTYO                             TRKCS110
156800     END-IF.                                                      TRKCS110
156900                                                                  TRKCS110
157000     IF NOT PS-ERROR                                              TRKCS110
157100         PERFORM 3020-VALIDATE-FCLTY-ID                           TRKCS110
157200         IF SQLCODE = +0                                          TRKCS110
157300             MOVE FACLTY-FCLTY-NME TO AFDESCO                     TRKCS110
157400         ELSE                                                     TRKCS110
157500             IF SQLCODE = +100                                    TRKCS110
157600                 SET PS-ERROR                                     TRKCS110
157700                     DP020-MSG-FATAL     TO TRUE                  TRKCS110
157800                 MOVE PC-TSYMSG-00789    TO DP020-MSG-NUMBER      TRKCS110
157900                 MOVE DP015-UNP-ALP-BRT-OFF                       TRKCS110
158000                                         TO AFCLTYA               TRKCS110
158100                 MOVE DP015-RED          TO AFCLTYC               TRKCS110
158200                 MOVE DP015-REVERSE      TO AFCLTYH               TRKCS110
158300                 MOVE -1                 TO AFCLTYL               TRKCS110
158400                 SET DP030-SET-CURSOR-APPL-1                      TRKCS110
158500                                         TO TRUE                  TRKCS110
158600             END-IF                                               TRKCS110
158700         END-IF                                                   TRKCS110
158800     END-IF.                                                      TRKCS110
158900** END OF CURRENT LOCATION CHECK **                               TRKCS110
159000                                                                  TRKCS110
159100     IF  ASC-CURR-DOCK-DOOR > SPACES                              TRKCS110
159200         MOVE ASC-CURR-DOCK-DOOR     TO PV-ALPHA-6                TRKCS110
159300         PERFORM 3080-RIGHT-JUSTIFY                               TRKCS110
159400         MOVE PV-ALPHA-6 TO ASC-CURR-DOCK-DOOR                    TRKCS110
159500         MOVE ASC-CURR-DOCK-DOOR TO DK-FCLTY-AREA-ID              TRKCS110
159600         MOVE 'DD'               TO DK-FCLTY-LOC-TYP-CDE          TRKCS110
159700         PERFORM 3030-VALIDATE-FCLTY-AREA-ID                      TRKCS110
159800         IF  SQLCODE = +100                                       TRKCS110
159900             SET PS-ERROR                                         TRKCS110
160000                 DP020-MSG-FATAL  TO TRUE                         TRKCS110
160100             MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER             TRKCS110
160200             MOVE DP015-UNP-ALP-BRT-OFF                           TRKCS110
160300                                  TO ADOORA                       TRKCS110
160400             MOVE DP015-RED       TO ADOORC                       TRKCS110
160500             MOVE DP015-REVERSE   TO ADOORH                       TRKCS110
160600             MOVE -1              TO ADOORL                       TRKCS110
160700             SET DP030-SET-CURSOR-APPL-1                          TRKCS110
160800                                  TO TRUE                         TRKCS110
160900         END-IF                                                   TRKCS110
161000     END-IF.                                                      TRKCS110
161100                                                                  TRKCS110
161200     IF  ASC-CURR-DOCK-AREA > SPACES                              TRKCS110
161300         MOVE ASC-CURR-DOCK-AREA TO DK-FCLTY-AREA-ID              TRKCS110
161400         MOVE 'DA'               TO DK-FCLTY-LOC-TYP-CDE          TRKCS110
161500         PERFORM 3030-VALIDATE-FCLTY-AREA-ID                      TRKCS110
161600         IF  SQLCODE = +100                                       TRKCS110
161700             SET PS-ERROR                                         TRKCS110
161800                 DP020-MSG-FATAL  TO TRUE                         TRKCS110
161900             MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER             TRKCS110
162000             MOVE DP015-UNP-ALP-BRT-OFF                           TRKCS110
162100                                  TO ADOCKA                       TRKCS110
162200             MOVE DP015-RED       TO ADOCKC                       TRKCS110
162300             MOVE DP015-REVERSE   TO ADOCKH                       TRKCS110
162400             MOVE -1              TO ADOCKL                       TRKCS110
162500             SET DP030-SET-CURSOR-APPL-1                          TRKCS110
162600                                  TO TRUE                         TRKCS110
162700         END-IF                                                   TRKCS110
162800     END-IF.                                                      TRKCS110
162900                                                                  TRKCS110
163000     IF  ASC-CURR-SPACE-LOC-ID > SPACES                           TRKCS110
163100         MOVE ASC-CURR-SPACE-LOC-ID  TO PV-ALPHA-6                TRKCS110
163200         PERFORM 3080-RIGHT-JUSTIFY                               TRKCS110
163300         MOVE PV-ALPHA-6 TO ASC-CURR-SPACE-LOC-ID                 TRKCS110
163400         MOVE ASC-CURR-SPACE-LOC-ID                               TRKCS110
163500                                 TO DK-FCLTY-AREA-ID              TRKCS110
163600         MOVE 'PS'               TO DK-FCLTY-LOC-TYP-CDE          TRKCS110
163700         PERFORM 3030-VALIDATE-FCLTY-AREA-ID                      TRKCS110
163800         IF  SQLCODE = +100                                       TRKCS110
163900             SET PS-ERROR                                         TRKCS110
164000                 DP020-MSG-FATAL  TO TRUE                         TRKCS110
164100             MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER             TRKCS110
164200             MOVE DP015-UNP-ALP-BRT-OFF                           TRKCS110
164300                                  TO ASPACEA                      TRKCS110
164400             MOVE DP015-RED       TO ASPACEC                      TRKCS110
164500             MOVE DP015-REVERSE   TO ASPACEH                      TRKCS110
164600             MOVE -1              TO ASPACEL                      TRKCS110
164700             SET DP030-SET-CURSOR-APPL-1                          TRKCS110
164800                                  TO TRUE                         TRKCS110
164900         END-IF                                                   TRKCS110
165000     END-IF.                                                      TRKCS110
165100                                                                  TRKCS110
165200     IF  ASC-CURR-YARD-LOC-ID > SPACES                            TRKCS110
165300         MOVE ASC-CURR-YARD-LOC-ID                                TRKCS110
165400                                 TO DK-FCLTY-AREA-ID              TRKCS110
165500         MOVE 'YD'               TO DK-FCLTY-LOC-TYP-CDE          TRKCS110
165600         PERFORM 3030-VALIDATE-FCLTY-AREA-ID                      TRKCS110
165700         IF  SQLCODE = +100                                       TRKCS110
165800             SET PS-ERROR                                         TRKCS110
165900                 DP020-MSG-FATAL  TO TRUE                         TRKCS110
166000             MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER             TRKCS110
166100             MOVE DP015-UNP-ALP-BRT-OFF                           TRKCS110
166200                                  TO AYARDA                       TRKCS110
166300             MOVE DP015-RED       TO AYARDC                       TRKCS110
166400             MOVE DP015-REVERSE   TO AYARDH                       TRKCS110
166500             MOVE -1              TO AYARDL                       TRKCS110
166600             SET DP030-SET-CURSOR-APPL-1                          TRKCS110
166700                                  TO TRUE                         TRKCS110
166800         END-IF                                                   TRKCS110
166900     END-IF.                                                      TRKCS110
167000                                                                  TRKCS110
167100     IF  ASC-TRLR-NBR > SPACES                                    TRKCS110
167200     AND ASC-DELIVERY-SCAC-CDE = SPACES                           TRKCS110
167300         SET PS-ERROR                                             TRKCS110
167400             DP020-MSG-FATAL     TO TRUE                          TRKCS110
167500         MOVE PC-TSYMSG-00007    TO DP020-MSG-NUMBER              TRKCS110
167600         MOVE DP015-UNP-ALP-BRT-OFF                               TRKCS110
167700                                 TO ADSCACA                       TRKCS110
167800         MOVE DP015-RED          TO ADSCACC                       TRKCS110
167900         MOVE DP015-REVERSE      TO ADSCACH                       TRKCS110
168000         MOVE -1                 TO ADSCACL                       TRKCS110
168100         SET DP030-SET-CURSOR-APPL-1                              TRKCS110
168200                                 TO TRUE                          TRKCS110
168300     END-IF.                                                      TRKCS110
168400                                                                  TRKCS110
168500     IF  ASC-TRLR-NBR > SPACES                                    TRKCS110
168600         MOVE ASC-TRLR-NBR      TO RC023-VEHICLE                  TRKCS110
168700         CALL RC023-FB-BOL-VEH-FORMAT                             TRKCS110
168800                          USING RC023-FORMAT-DATA-AREA            TRKCS110
168900         MOVE RC023-VEHICLE     TO ASC-TRLR-NBR                   TRKCS110
169000                                   ATRLRO                         TRKCS110
169100     END-IF.                                                      TRKCS110
169200                                                                  TRKCS110
169300                                                                  TRKCS110
169400     IF  ASC-PRO-NBR > SPACES                                     TRKCS110
169500     AND ASC-PRO-NBR-SCAC-CDE = SPACES                            TRKCS110
169600         SET PS-ERROR                                             TRKCS110
169700             DP020-MSG-FATAL     TO TRUE                          TRKCS110
169800         MOVE PC-TSYMSG-00007    TO DP020-MSG-NUMBER              TRKCS110
169900         MOVE DP015-UNP-ALP-BRT-OFF                               TRKCS110
170000                                 TO APSCACA                       TRKCS110
170100         MOVE DP015-RED          TO APSCACC                       TRKCS110
170200         MOVE DP015-REVERSE      TO APSCACH                       TRKCS110
170300         MOVE -1                 TO APSCACL                       TRKCS110
170400         SET DP030-SET-CURSOR-APPL-1                              TRKCS110
170500                                 TO TRUE                          TRKCS110
170600     END-IF.                                                      TRKCS110
170700                                                                  TRKCS110
170800     IF  PS-NO-ERROR                                              TRKCS110
170900         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                     TRKCS110
171000         MOVE -1                 TO ADOPERL                       TRKCS110
171100         SET DP030-SET-CURSOR-APPL-1                              TRKCS110
171200                                 TO TRUE                          TRKCS110
171300     END-IF.                                                      TRKCS110
171400                                                                  TRKCS110
171500/                                                                 TRKCS110
171600*----------------------------------------------------------------*TRKCS110
171700*  CHECK THE OPER UNIT TABLE TO VERIFY THE OPER UNIT             *TRKCS110
171800*  ENTERED ON THE MAP IS VALID.                                  *TRKCS110
171900*----------------------------------------------------------------*TRKCS110
172000                                                                  TRKCS110
172100 3010-VALIDATE-OPER-UNT-ID.                                       TRKCS110
172200                                                                  TRKCS110
172300     PERFORM                                                      TRKCS110
172400         WITH TEST AFTER                                          TRKCS110
172500         VARYING PV-RETRY-COUNTER                                 TRKCS110
172600         FROM 1 BY 1                                              TRKCS110
172700         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               TRKCS110
172800                   OR (SQLCODE = +0)                              TRKCS110
172900                   OR (SQLCODE = +100)                            TRKCS110
173000                   OR (SQLCODE = -811))                           TRKCS110
173100                                                                  TRKCS110
173200         EXEC SQL                                                 TRKCS110
173300            SELECT  OPER_UNT_ID                                   TRKCS110
173400              INTO :FACLTY-OPER-UNT-ID                            TRKCS110
173500              FROM  TFACLTY                                       TRKCS110
173600             WHERE  OPER_UNT_ID = :DK-OPER-UNT-ID                 TRKCS110
173700         END-EXEC                                                 TRKCS110
173800                                                                  TRKCS110
173900         EVALUATE TRUE                                            TRKCS110
174000             WHEN SQLCODE = +0                                    TRKCS110
174100             WHEN SQLCODE = +100                                  TRKCS110
174200             WHEN SQLCODE = -811                                  TRKCS110
174300             WHEN SQLCODE = -904                                  TRKCS110
174400             WHEN SQLCODE = -913                                  TRKCS110
174500                 CONTINUE                                         TRKCS110
174600             WHEN SQLWARN0 NOT = SPACES                           TRKCS110
174700             WHEN SQLCODE < +0                                    TRKCS110
174800             WHEN SQLCODE > +0                                    TRKCS110
174900                 MOVE '3010-VALIDATE-FCLTY-ID'                    TRKCS110
175000                                 TO DP013-PARAGRAPH               TRKCS110
175100                 MOVE 'SELECT STORE NUMBER'                       TRKCS110
175200                                 TO DP013-MESSAGE-TEXT (1)        TRKCS110
175300                 MOVE SQLCA      TO DP013-SQLCA                   TRKCS110
175400                 MOVE 'TFACLTY'  TO DP013-DB2-TABLE-NAME (1)      TRKCS110
175500                 SET DP013-DB2-ABEND                              TRKCS110
175600                                 TO TRUE                          TRKCS110
175700                 SET DP013-XCTL-DISPLAY-RESTART                   TRKCS110
175800                                 TO TRUE                          TRKCS110
175900                 PERFORM DP013-0000-PROCESS-ABEND                 TRKCS110
176000         END-EVALUATE                                             TRKCS110
176100     END-PERFORM.                                                 TRKCS110
176200                                                                  TRKCS110
176300     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        TRKCS110
176400         MOVE '3010-VALIDATE-FCLTY-ID'                            TRKCS110
176500                                 TO DP013-PARAGRAPH               TRKCS110
176600         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     TRKCS110
176700                                 TO DP013-MESSAGE-TEXT (1)        TRKCS110
176800         MOVE 'STORE NUMBER  '   TO DP013-MESSAGE-TEXT (2)        TRKCS110
176900         MOVE SQLCA              TO DP013-SQLCA                   TRKCS110
177000         MOVE 'TFACLTY'          TO DP013-DB2-TABLE-NAME (1)      TRKCS110
177100         SET DP013-DB2-ABEND     TO TRUE                          TRKCS110
177200         SET DP013-XCTL-DISPLAY-RESTART                           TRKCS110
177300                                 TO TRUE                          TRKCS110
177400         PERFORM DP013-0000-PROCESS-ABEND                         TRKCS110
177500     END-IF.                                                      TRKCS110
177600                                                                  TRKCS110
177700                                                                  TRKCS110
177800/                                                                 TRKCS110
177900*----------------------------------------------------------------*TRKCS110
178000*  CHECK THE FACILITY TABLE TO VERIFY THAT THE FACILITY          *TRKCS110
178100*  ENTERED ON THE MAP IS VALID.                                  *TRKCS110
178200*----------------------------------------------------------------*TRKCS110
178300                                                                  TRKCS110
178400 3020-VALIDATE-FCLTY-ID.                                          TRKCS110
178500                                                                  TRKCS110
178600     PERFORM                                                      TRKCS110
178700         WITH TEST AFTER                                          TRKCS110
178800         VARYING PV-RETRY-COUNTER                                 TRKCS110
178900         FROM 1 BY 1                                              TRKCS110
179000         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               TRKCS110
179100                   OR (SQLCODE = +0)                              TRKCS110
179200                   OR (SQLCODE = +100))                           TRKCS110
179300                                                                  TRKCS110
179400         EXEC SQL                                                 TRKCS110
179500            SELECT  FCLTY_ID                                      TRKCS110
179600                   ,FCLTY_NME                                     TRKCS110
179700              INTO :FACLTY-FCLTY-ID                               TRKCS110
179800                  ,:FACLTY-FCLTY-NME                              TRKCS110
179900              FROM  TFACLTY                                       TRKCS110
180000             WHERE  OPER_UNT_ID = :DK-OPER-UNT-ID                 TRKCS110
180100               AND  FCLTY_ID    = :DK-FCLTY-ID                    TRKCS110
180200         END-EXEC                                                 TRKCS110
180300                                                                  TRKCS110
180400         EVALUATE TRUE                                            TRKCS110
180500             WHEN SQLCODE = +0                                    TRKCS110
180600             WHEN SQLCODE = +100                                  TRKCS110
180700             WHEN SQLCODE = -904                                  TRKCS110
180800             WHEN SQLCODE = -913                                  TRKCS110
180900                 CONTINUE                                         TRKCS110
181000                                                                  TRKCS110
181100             WHEN SQLWARN0 NOT = SPACES                           TRKCS110
181200             WHEN SQLCODE < +0                                    TRKCS110
181300             WHEN SQLCODE > +0                                    TRKCS110
181400                 MOVE '3020-VALIDATE-FCLTY-ID'                    TRKCS110
181500                                 TO DP013-PARAGRAPH               TRKCS110
181600                 MOVE 'SELECT FACILITY ID '                       TRKCS110
181700                                 TO DP013-MESSAGE-TEXT (1)        TRKCS110
181800                 MOVE SQLCA      TO DP013-SQLCA                   TRKCS110
181900                 MOVE 'TFACLTY'  TO DP013-DB2-TABLE-NAME (1)      TRKCS110
182000                 SET DP013-DB2-ABEND                              TRKCS110
182100                                 TO TRUE                          TRKCS110
182200                 SET DP013-XCTL-DISPLAY-RESTART                   TRKCS110
182300                                 TO TRUE                          TRKCS110
182400                 PERFORM DP013-0000-PROCESS-ABEND                 TRKCS110
182500         END-EVALUATE                                             TRKCS110
182600     END-PERFORM.                                                 TRKCS110
182700                                                                  TRKCS110
182800     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        TRKCS110
182900         MOVE '3020-VALIDATE-FCLTY-ID'                            TRKCS110
183000                                 TO DP013-PARAGRAPH               TRKCS110
183100         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     TRKCS110
183200                                 TO DP013-MESSAGE-TEXT (1)        TRKCS110
183300         MOVE 'FACILITY ID   '   TO DP013-MESSAGE-TEXT (2)        TRKCS110
183400         MOVE SQLCA              TO DP013-SQLCA                   TRKCS110
183500         MOVE 'TFACLTY'          TO DP013-DB2-TABLE-NAME (1)      TRKCS110
183600         SET DP013-DB2-ABEND     TO TRUE                          TRKCS110
183700         SET DP013-XCTL-DISPLAY-RESTART                           TRKCS110
183800                                 TO TRUE                          TRKCS110
183900         PERFORM DP013-0000-PROCESS-ABEND                         TRKCS110
184000     END-IF.                                                      TRKCS110
184100                                                                  TRKCS110
184200                                                                  TRKCS110
184300/                                                                 TRKCS110
184400*----------------------------------------------------------------*TRKCS110
184500*  CHECK THE FACILITY AREA TABLE TO VERIFY THAT THE FACILITY    * TRKCS110
184600*  AREA ENTERED IS VALID.                                        *TRKCS110
184700*----------------------------------------------------------------*TRKCS110
184800                                                                  TRKCS110
184900 3030-VALIDATE-FCLTY-AREA-ID.                                     TRKCS110
185000                                                                  TRKCS110
185100     PERFORM                                                      TRKCS110
185200         WITH TEST AFTER                                          TRKCS110
185300         VARYING PV-RETRY-COUNTER                                 TRKCS110
185400         FROM 1 BY 1                                              TRKCS110
185500         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               TRKCS110
185600                   OR (SQLCODE = +0)                              TRKCS110
185700                   OR (SQLCODE = +100))                           TRKCS110
185800                                                                  TRKCS110
185900         EXEC SQL                                                 TRKCS110
186000            SELECT  FCLTY_AREA_ID                                 TRKCS110
186100              INTO :FLAREA-FCLTY-AREA-ID                          TRKCS110
186200              FROM  TFLAREA                                       TRKCS110
186300             WHERE  OPER_UNT_ID       = :DK-OPER-UNT-ID           TRKCS110
186400               AND  FCLTY_ID          = :DK-FCLTY-ID              TRKCS110
186500               AND  FCLTY_AREA_ID     = :DK-FCLTY-AREA-ID         TRKCS110
186600               AND  FCLTY_LOC_TYP_CDE = :DK-FCLTY-LOC-TYP-CDE     TRKCS110
186700         END-EXEC                                                 TRKCS110
186800                                                                  TRKCS110
186900         EVALUATE TRUE                                            TRKCS110
187000             WHEN SQLCODE = +0                                    TRKCS110
187100             WHEN SQLCODE = +100                                  TRKCS110
187200             WHEN SQLCODE = -904                                  TRKCS110
187300             WHEN SQLCODE = -913                                  TRKCS110
187400                 CONTINUE                                         TRKCS110
187500                                                                  TRKCS110
187600             WHEN SQLWARN0 NOT = SPACES                           TRKCS110
187700             WHEN SQLCODE < +0                                    TRKCS110
187800             WHEN SQLCODE > +0                                    TRKCS110
187900                 MOVE '3030-VALIDATE-FCLTY-AREA-ID'               TRKCS110
188000                                 TO DP013-PARAGRAPH               TRKCS110
188100                 MOVE 'SELECT FACILITY AREA ID'                   TRKCS110
188200                                 TO DP013-MESSAGE-TEXT (1)        TRKCS110
188300                 MOVE SQLCA      TO DP013-SQLCA                   TRKCS110
188400                 MOVE 'TFLAREA'  TO DP013-DB2-TABLE-NAME (1)      TRKCS110
188500                 SET DP013-DB2-ABEND                              TRKCS110
188600                                 TO TRUE                          TRKCS110
188700                 SET DP013-XCTL-DISPLAY-RESTART                   TRKCS110
188800                                 TO TRUE                          TRKCS110
188900                 PERFORM DP013-0000-PROCESS-ABEND                 TRKCS110
189000         END-EVALUATE                                             TRKCS110
189100     END-PERFORM.                                                 TRKCS110
189200                                                                  TRKCS110
189300     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        TRKCS110
189400         MOVE '3030-VALIDATE-FCLTY-AREA-ID'                       TRKCS110
189500                                 TO DP013-PARAGRAPH               TRKCS110
189600         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     TRKCS110
189700                                 TO DP013-MESSAGE-TEXT (1)        TRKCS110
189800         MOVE 'FACILITY AREA ID' TO DP013-MESSAGE-TEXT (2)        TRKCS110
189900         MOVE SQLCA              TO DP013-SQLCA                   TRKCS110
190000         MOVE 'TFLAREA'          TO DP013-DB2-TABLE-NAME (1)      TRKCS110
190100         SET DP013-DB2-ABEND     TO TRUE                          TRKCS110
190200         SET DP013-XCTL-DISPLAY-RESTART                           TRKCS110
190300                                 TO TRUE                          TRKCS110
190400         PERFORM DP013-0000-PROCESS-ABEND                         TRKCS110
190500     END-IF.                                                      TRKCS110
190600                                                                  TRKCS110
190700/                                                                 TRKCS110
190800*----------------------------------------------------------------*TRKCS110
190900*  CHECK THE EXTERNAL ENTERPRISE TABLE TO VERIFY THE SCAC CODE   *TRKCS110
191000*  ENTERED IS VALID.                                             *TRKCS110
191100*----------------------------------------------------------------*TRKCS110
191200                                                                  TRKCS110
191300 3040-VALIDATE-SCAC-CDE.                                          TRKCS110
191400                                                                  TRKCS110
191500     PERFORM                                                      TRKCS110
191600         WITH TEST AFTER                                          TRKCS110
191700         VARYING PV-RETRY-COUNTER                                 TRKCS110
191800         FROM 1 BY 1                                              TRKCS110
191900         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               TRKCS110
192000                   OR (SQLCODE = +0)                              TRKCS110
192100                   OR (SQLCODE = +100)                            TRKCS110
192200                   OR (SQLCODE = -811))                           TRKCS110
192300                                                                  TRKCS110
192400         EXEC SQL                                                 TRKCS110
192500            SELECT  SCAC_CDE                                      TRKCS110
192600              INTO :EXTENT-SCAC-CDE                               TRKCS110
192700              FROM  TEXTENT                                       TRKCS110
192800             WHERE  SCAC_CDE    = :DK-SCAC-CDE                    TRKCS110
192900               AND  CARRIER_IND = 'Y'                             TRKCS110
193000         END-EXEC                                                 TRKCS110
193100                                                                  TRKCS110
193200         EVALUATE TRUE                                            TRKCS110
193300             WHEN SQLCODE = +0                                    TRKCS110
193400             WHEN SQLCODE = +100                                  TRKCS110
193500             WHEN SQLCODE = -811                                  TRKCS110
193600             WHEN SQLCODE = -904                                  TRKCS110
193700             WHEN SQLCODE = -913                                  TRKCS110
193800                 CONTINUE                                         TRKCS110
193900                                                                  TRKCS110
194000             WHEN SQLWARN0 NOT = SPACES                           TRKCS110
194100             WHEN SQLCODE < +0                                    TRKCS110
194200             WHEN SQLCODE > +0                                    TRKCS110
194300                 MOVE '3040-VALIDATE-SCAC-CDE'                    TRKCS110
194400                                 TO DP013-PARAGRAPH               TRKCS110
194500                 MOVE 'SELECT SCAC CODE'                          TRKCS110
194600                                 TO DP013-MESSAGE-TEXT (1)        TRKCS110
194700                 MOVE SQLCA      TO DP013-SQLCA                   TRKCS110
194800                 MOVE 'TEXTENT'  TO DP013-DB2-TABLE-NAME (1)      TRKCS110
194900                 SET DP013-DB2-ABEND                              TRKCS110
195000                                 TO TRUE                          TRKCS110
195100                 SET DP013-XCTL-DISPLAY-RESTART                   TRKCS110
195200                                 TO TRUE                          TRKCS110
195300                 PERFORM DP013-0000-PROCESS-ABEND                 TRKCS110
195400         END-EVALUATE                                             TRKCS110
195500     END-PERFORM.                                                 TRKCS110
195600                                                                  TRKCS110
195700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        TRKCS110
195800         MOVE '3040-VALIDATE-SCAC-CDE'                            TRKCS110
195900                                 TO DP013-PARAGRAPH               TRKCS110
196000         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     TRKCS110
196100                                 TO DP013-MESSAGE-TEXT (1)        TRKCS110
196200         MOVE 'SCAC CODE       ' TO DP013-MESSAGE-TEXT (2)        TRKCS110
196300         MOVE SQLCA              TO DP013-SQLCA                   TRKCS110
196400         MOVE 'TEXTENT'          TO DP013-DB2-TABLE-NAME (1)      TRKCS110
196500         SET DP013-DB2-ABEND     TO TRUE                          TRKCS110
196600         SET DP013-XCTL-DISPLAY-RESTART                           TRKCS110
196700                                 TO TRUE                          TRKCS110
196800         PERFORM DP013-0000-PROCESS-ABEND                         TRKCS110
196900     END-IF.                                                      TRKCS110
197000                                                                  TRKCS110
197100/                                                                 TRKCS110
197200*----------------------------------------------------------------*TRKCS110
197300*  CHECK THE SHIPT STATUS CODE TABLE TO VERIFY THE VEHICLE STATUS*TRKCS110
197400*  ENTERED IS VALID.                                             *TRKCS110
197500*----------------------------------------------------------------*TRKCS110
197600                                                                  TRKCS110
197700 3050-VALIDATE-STATUS-CDE.                                        TRKCS110
197800                                                                  TRKCS110
197900     PERFORM                                                      TRKCS110
198000         WITH TEST AFTER                                          TRKCS110
198100         VARYING PV-RETRY-COUNTER                                 TRKCS110
198200         FROM 1 BY 1                                              TRKCS110
198300         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               TRKCS110
198400                   OR (SQLCODE = +0)                              TRKCS110
198500                   OR (SQLCODE = +100))                           TRKCS110
198600                                                                  TRKCS110
198700         EXEC SQL                                                 TRKCS110
198800            SELECT  SHIPT_STATUS_CDE                              TRKCS110
198900              INTO :SHSTYP-SHIPT-STATUS-CDE                       TRKCS110
199000              FROM  TSHSTYP                                       TRKCS110
199100             WHERE  SHIPT_STATUS_CDE = :DK-SHIPT-STATUS-CDE       TRKCS110
199200         END-EXEC                                                 TRKCS110
199300                                                                  TRKCS110
199400         EVALUATE TRUE                                            TRKCS110
199500             WHEN SQLCODE = +0                                    TRKCS110
199600             WHEN SQLCODE = +100                                  TRKCS110
199700             WHEN SQLCODE = -904                                  TRKCS110
199800             WHEN SQLCODE = -913                                  TRKCS110
199900                 CONTINUE                                         TRKCS110
200000                                                                  TRKCS110
200100             WHEN SQLWARN0 NOT = SPACES                           TRKCS110
200200             WHEN SQLCODE < +0                                    TRKCS110
200300             WHEN SQLCODE > +0                                    TRKCS110
200400                 MOVE '3050-VALIDATE-STATUS-CDE'                  TRKCS110
200500                                 TO DP013-PARAGRAPH               TRKCS110
200600                 MOVE 'SELECT SHIPMENT STATUS CODE'               TRKCS110
200700                                 TO DP013-MESSAGE-TEXT (1)        TRKCS110
200800                 MOVE SQLCA      TO DP013-SQLCA                   TRKCS110
200900                 MOVE 'TSHSTYP'  TO DP013-DB2-TABLE-NAME (1)      TRKCS110
201000                 SET DP013-DB2-ABEND                              TRKCS110
201100                                 TO TRUE                          TRKCS110
201200                 SET DP013-XCTL-DISPLAY-RESTART                   TRKCS110
201300                                 TO TRUE                          TRKCS110
201400                 PERFORM DP013-0000-PROCESS-ABEND                 TRKCS110
201500         END-EVALUATE                                             TRKCS110
201600     END-PERFORM.                                                 TRKCS110
201700                                                                  TRKCS110
201800     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        TRKCS110
201900         MOVE '3050-VALIDATE-STATUS-CDE'                          TRKCS110
202000                                 TO DP013-PARAGRAPH               TRKCS110
202100         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     TRKCS110
202200                                 TO DP013-MESSAGE-TEXT (1)        TRKCS110
202300         MOVE 'SHIPMENT STATUS CODE'                              TRKCS110
202400                                 TO DP013-MESSAGE-TEXT (2)        TRKCS110
202500         MOVE SQLCA              TO DP013-SQLCA                   TRKCS110
202600         MOVE 'TSHSTYP'          TO DP013-DB2-TABLE-NAME (1)      TRKCS110
202700         SET DP013-DB2-ABEND     TO TRUE                          TRKCS110
202800         SET DP013-XCTL-DISPLAY-RESTART                           TRKCS110
202900                                 TO TRUE                          TRKCS110
203000         PERFORM DP013-0000-PROCESS-ABEND                         TRKCS110
203100     END-IF.                                                      TRKCS110
203200                                                                  TRKCS110
203300/                                                                 TRKCS110
203400*----------------------------------------------------------------*TRKCS110
203500*  MOVE THE DEFAULT ATTRIBUTES TO ALL OF THE OPEN FIELDS ON THE  *TRKCS110
203600*  MAP.                                                          *TRKCS110
203700*----------------------------------------------------------------*TRKCS110
203800                                                                  TRKCS110
203900 3100-RESET-ATTRIBUTES.                                           TRKCS110
204000                                                                  TRKCS110
204100     MOVE DP015-UNP-ALP-NOR-OFF    TO AOPERA                      TRKCS110
204200                                      AFCLTYA                     TRKCS110
204300                                      ADOPERA                     TRKCS110
204400                                      ADFCLTYA                    TRKCS110
204500                                      AYARDA                      TRKCS110
204600                                      ASPACEA                     TRKCS110
204700                                      ADOCKA                      TRKCS110
204800                                      ADOORA                      TRKCS110
204900                                      ASTAT1A                     TRKCS110
205000                                      ASTAT2A                     TRKCS110
205100                                      ASTAT3A                     TRKCS110
205200                                      ASTAT4A                     TRKCS110
205300                                      ASTAT5A                     TRKCS110
205400                                      AUSE1A                      TRKCS110
205500                                      AUSE2A                      TRKCS110
205600                                      AUSE3A                      TRKCS110
205700                                      ADSCACA                     TRKCS110
205800                                      ATRLRA                      TRKCS110
205900                                      ATSFRMMA                    TRKCS110
206000                                      ATSFRDDA                    TRKCS110
206100                                      ATSFRYYA                    TRKCS110
206200                                      ATSTOMMA                    TRKCS110
206300                                      ATSTODDA                    TRKCS110
206400                                      ATSTOYYA                    TRKCS110
206500                                      APSCACA                     TRKCS110
206600                                      APRONBRA                    TRKCS110
206700                                      ABILLA.                     TRKCS110
208000                                                                  TRKCS110
208100     MOVE DP015-GREEN              TO AOPERC                      TRKCS110
208200                                      AFCLTYC                     TRKCS110
208300                                      ADOPERC                     TRKCS110
208400                                      ADFCLTYC                    TRKCS110
208500                                      AYARDC                      TRKCS110
208600                                      ASPACEC                     TRKCS110
208700                                      ADOCKC                      TRKCS110
208800                                      ADOORC                      TRKCS110
208900                                      ASTAT1C                     TRKCS110
209000                                      ASTAT2C                     TRKCS110
209100                                      ASTAT3C                     TRKCS110
209200                                      ASTAT4C                     TRKCS110
209300                                      ASTAT5C                     TRKCS110
209400                                      AUSE1C                      TRKCS110
209500                                      AUSE2C                      TRKCS110
209600                                      AUSE3C                      TRKCS110
209700                                      ADSCACC                     TRKCS110
209800                                      ATRLRC                      TRKCS110
209900                                      ATSFRMMC                    TRKCS110
210000                                      ATSFRDDC                    TRKCS110
210100                                      ATSFRYYC                    TRKCS110
210200                                      ATSTOMMC                    TRKCS110
210300                                      ATSTODDC                    TRKCS110
210400                                      ATSTOYYC                    TRKCS110
210500                                      APSCACC                     TRKCS110
210600                                      APRONBRC                    TRKCS110
210700                                      ABILLC.                     TRKCS110
212000                                                                  TRKCS110
212100     MOVE DP015-UNDERLINE          TO AOPERH                      TRKCS110
212200                                      AFCLTYH                     TRKCS110
212300                                      ADOPERH                     TRKCS110
212400                                      ADFCLTYH                    TRKCS110
212500                                      AYARDH                      TRKCS110
212600                                      ASPACEH                     TRKCS110
212700                                      ADOCKH                      TRKCS110
212800                                      ADOORH                      TRKCS110
212900                                      ASTAT1H                     TRKCS110
213000                                      ASTAT2H                     TRKCS110
213100                                      ASTAT3H                     TRKCS110
213200                                      ASTAT4H                     TRKCS110
213300                                      ASTAT5H                     TRKCS110
213400                                      AUSE1H                      TRKCS110
213500                                      AUSE2H                      TRKCS110
213600                                      AUSE3H                      TRKCS110
213700                                      ADSCACH                     TRKCS110
213800                                      ATRLRH                      TRKCS110
213900                                      ATSFRMMH                    TRKCS110
214000                                      ATSFRDDH                    TRKCS110
214100                                      ATSFRYYH                    TRKCS110
214200                                      ATSTOMMH                    TRKCS110
214300                                      ATSTODDH                    TRKCS110
214400                                      ATSTOYYH                    TRKCS110
214500                                      APSCACH                     TRKCS110
214600                                      APRONBRH                    TRKCS110
214700                                      ABILLH.                     TRKCS110
216000                                                                  TRKCS110
216100/                                                                 TRKCS110
216200*----------------------------------------------------------------*TRKCS110
216300*  POSITION THE CURSOR AT THE APPROPRIATE FIELD.                 *TRKCS110
216400*  IF THERE IS ANY DATA TO MOVE TO THE SCREEN ON INITIAL, MOVE   *TRKCS110
216500*  IT HERE.                                                      *TRKCS110
216600*----------------------------------------------------------------*TRKCS110
216700                                                                  TRKCS110
216800 4000-BUILD-INITIAL-PANEL.                                        TRKCS110
216900                                                                  TRKCS110
217000     SET DP030-SET-CURSOR-APPL-1 TO TRUE                          TRKCS110
217100     MOVE -1                     TO ADSCACL.                      TRKCS110
217200                                                                  TRKCS110
217300     MOVE ASC-DEST-OPER-UNT-ID-N TO DK-OPER-UNT-ID.               TRKCS110
217400     MOVE ASC-DEST-FCLTY-ID-N    TO DK-FCLTY-ID.                  TRKCS110
217500                                                                  TRKCS110
217600     PERFORM 4010-GET-FCLTY-NAME.                                 TRKCS110
217700     MOVE PV-FCLTY-NME           TO ADFDESCO.                     TRKCS110
217800*                                   ASC-DEST-FCLTY-NME.           TRKCS110
217900                                                                  TRKCS110
218000     MOVE ASC-OPER-UNT-ID-N      TO DK-OPER-UNT-ID.               TRKCS110
218100     MOVE ASC-FCLTY-ID-N         TO DK-FCLTY-ID.                  TRKCS110
218200     PERFORM 4010-GET-FCLTY-NAME.                                 TRKCS110
218300     MOVE PV-FCLTY-NME           TO AFDESCO.                      TRKCS110
218400*                                   ASC-FCLTY-NME.                TRKCS110
218500                                                                  TRKCS110
218600     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        TRKCS110
218700                                                                  TRKCS110
218800/                                                                 TRKCS110
218900*----------------------------------------------------------------*TRKCS110
219000*    GET THE FACILITY NAME                                       *TRKCS110
219100*----------------------------------------------------------------*TRKCS110
219200 4010-GET-FCLTY-NAME.                                             TRKCS110
219300                                                                  TRKCS110
219400     PERFORM                                                      TRKCS110
219500         WITH TEST AFTER                                          TRKCS110
219600         VARYING PV-RETRY-COUNTER                                 TRKCS110
219700         FROM 1 BY 1                                              TRKCS110
219800         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               TRKCS110
219900             OR (SQLCODE = +0)                                    TRKCS110
220000             OR (SQLCODE = +100))                                 TRKCS110
220100                                                                  TRKCS110
220200         EXEC SQL                                                 TRKCS110
220300              SELECT FCLTY_NME                                    TRKCS110
220400                INTO :FACLTY-FCLTY-NME                            TRKCS110
220500                FROM TFACLTY                                      TRKCS110
220600               WHERE OPER_UNT_ID = :DK-OPER-UNT-ID                TRKCS110
220700                 AND FCLTY_ID    = :DK-FCLTY-ID                   TRKCS110
220800         END-EXEC                                                 TRKCS110
220900                                                                  TRKCS110
221000         EVALUATE TRUE                                            TRKCS110
221100             WHEN SQLCODE = +0                                    TRKCS110
221200                  MOVE FACLTY-FCLTY-NME                           TRKCS110
221300                                  TO PV-FCLTY-NME                 TRKCS110
221400*                                 TO ASC-FCLTY-NME                TRKCS110
221500                                                                  TRKCS110
221600             WHEN SQLCODE = +100                                  TRKCS110
221700                  MOVE SPACES     TO PV-FCLTY-NME                 TRKCS110
221800*                 MOVE SPACES     TO ASC-FCLTY-NME                TRKCS110
221900                                                                  TRKCS110
222000             WHEN SQLCODE = -904                                  TRKCS110
222100             WHEN SQLCODE = -913                                  TRKCS110
222200                  CONTINUE                                        TRKCS110
222300                                                                  TRKCS110
222400             WHEN SQLWARN0 NOT = SPACES                           TRKCS110
222500             WHEN SQLCODE < +0                                    TRKCS110
222600             WHEN SQLCODE > +0                                    TRKCS110
222700                  MOVE '4010-GET-FCLTY-NAME'                      TRKCS110
222800                                  TO DP013-PARAGRAPH              TRKCS110
222900                  MOVE 'UNSUCCESSFUL SELECT ON FACILITY TABLE'    TRKCS110
223000                                  TO DP013-MESSAGE-TEXT (1)       TRKCS110
223100                  MOVE SQLCA      TO DP013-SQLCA                  TRKCS110
223200                  MOVE 'TFACLTY ' TO DP013-DB2-TABLE-NAME (1)     TRKCS110
223300                  SET DP013-DB2-ABEND                             TRKCS110
223400                      DP013-XCTL-DISPLAY-RESTART                  TRKCS110
223500                                  TO TRUE                         TRKCS110
223600                  PERFORM DP013-0000-PROCESS-ABEND                TRKCS110
223700         END-EVALUATE                                             TRKCS110
223800     END-PERFORM.                                                 TRKCS110
223900                                                                  TRKCS110
224000     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        TRKCS110
224100         MOVE '4010-GET-FCLTY-NAME'                               TRKCS110
224200                                  TO DP013-PARAGRAPH              TRKCS110
224300         MOVE 'MAX RETRIES EXCEEDED ON SELECT FACILITY TABLE'     TRKCS110
224400                                  TO DP013-MESSAGE-TEXT (1)       TRKCS110
224500         MOVE SQLCA               TO DP013-SQLCA                  TRKCS110
224600         MOVE 'TFACLTY'           TO DP013-DB2-TABLE-NAME (1)     TRKCS110
224700         SET DP013-DB2-ABEND                                      TRKCS110
224800             DP013-XCTL-DISPLAY-RESTART                           TRKCS110
224900                                  TO TRUE                         TRKCS110
225000         PERFORM DP013-0000-PROCESS-ABEND                         TRKCS110
225100     END-IF.                                                      TRKCS110
225200                                                                  TRKCS110
225300/                                                                 TRKCS110
225400*----------------------------------------------------------------*TRKCS110
225500*    RESTORE THE DATA ON THE SCREEN FROM THE COMM AREA.          *TRKCS110
225600*----------------------------------------------------------------*TRKCS110
225700                                                                  TRKCS110
225800 4400-MOVE-COMMAREA-TO-SCREEN.                                    TRKCS110
225900                                                                  TRKCS110
226000     MOVE ASC-OPER-UNT-ID        TO AOPERO.                       TRKCS110
226100     MOVE ASC-FCLTY-ID           TO AFCLTYO.                      TRKCS110
226200     MOVE ASC-DEST-OPER-UNT-ID   TO ADOPERO.                      TRKCS110
226300     MOVE ASC-DEST-FCLTY-ID      TO ADFCLTYO.                     TRKCS110
226400*    MOVE ASC-FCLTY-NME          TO AFDESCO.                      TRKCS110
226500     MOVE ASC-CURR-YARD-LOC-ID   TO AYARDO.                       TRKCS110
226600     MOVE ASC-CURR-SPACE-LOC-ID  TO ASPACEO.                      TRKCS110
226700     MOVE ASC-CURR-DOCK-AREA     TO ADOCKO.                       TRKCS110
226800     MOVE ASC-CURR-DOCK-DOOR     TO ADOORO.                       TRKCS110
226900     MOVE ASC-STATUS-IND-1       TO ASTAT1O.                      TRKCS110
227000     MOVE ASC-STATUS-IND-2       TO ASTAT2O.                      TRKCS110
227100     MOVE ASC-STATUS-IND-3       TO ASTAT3O.                      TRKCS110
227200     MOVE ASC-STATUS-IND-4       TO ASTAT4O.                      TRKCS110
227300     MOVE ASC-STATUS-IND-5       TO ASTAT5O.                      TRKCS110
227400     MOVE ASC-USAGE-IND-1        TO AUSE1O.                       TRKCS110
227500     MOVE ASC-USAGE-IND-2        TO AUSE2O.                       TRKCS110
227600     MOVE ASC-USAGE-IND-3        TO AUSE3O.                       TRKCS110
227700     MOVE ASC-DELIVERY-SCAC-CDE  TO ADSCACO.                      TRKCS110
227800     MOVE ASC-TRLR-NBR           TO ATRLRO.                       TRKCS110
227900     MOVE ASC-TRLR-STAT-FR-DTE-MM                                 TRKCS110
228000                                 TO ATSFRMMO.                     TRKCS110
228100     MOVE ASC-TRLR-STAT-FR-DTE-DD                                 TRKCS110
228200                                 TO ATSFRDDO.                     TRKCS110
228300     MOVE ASC-TRLR-STAT-FR-DTE-CCYY                               TRKCS110
228400                                 TO ATSFRYYO.                     TRKCS110
228500     MOVE ASC-TRLR-STAT-TO-DTE-MM                                 TRKCS110
228600                                 TO ATSTOMMO.                     TRKCS110
228700     MOVE ASC-TRLR-STAT-TO-DTE-DD                                 TRKCS110
228800                                 TO ATSTODDO.                     TRKCS110
228900     MOVE ASC-TRLR-STAT-TO-DTE-CCYY                               TRKCS110
229000                                 TO ATSTOYYO.                     TRKCS110
229100     MOVE ASC-PRO-NBR-SCAC-CDE   TO APSCACO.                      TRKCS110
229200     MOVE ASC-PRO-NBR            TO APRONBRO.                     TRKCS110
229300     MOVE ASC-BILL-OF-LADING     TO ABILLO.                       TRKCS110
230600                                                                  TRKCS110
230700/                                                                 TRKCS110
230800*----------------------------------------------------------------*TRKCS110
230900*    ABEND PROCESSOR MODULE                                      *TRKCS110
231000*----------------------------------------------------------------*TRKCS110
231100                                                                  TRKCS110
231200     COPY DPPD013.                                                TRKCS110
231300/                                                                 TRKCS110
231400*----------------------------------------------------------------*TRKCS110
231500*    ROUTINE TO RIGHT JUSTIFY A 6 BYTE ALPHA FIELD               *TRKCS110
231600*----------------------------------------------------------------*TRKCS110
231700                                                                  TRKCS110
231800     COPY TRWS012.                                                TRKCS110
