000100 IDENTIFICATION DIVISION.                                         00010000
000200 TITLE 'MANIFESTING - MESSAGE SCREEN FOR CARTON FUNCTIONS'.       00020000
000300                                                                  00030000
000400 PROGRAM-ID.             PCKRF852.                                00040000
000500 AUTHOR.                 DENNIS STEFFEN.                          00050000
000600 INSTALLATION.           KOHLS.                                   00060000
000700 DATE-WRITTEN            SEPTEMBER, 2000.                         00070000
000800 DATE-COMPILED.                                                   00080000
000900                                                                  00090000
001000******************************************************************00100000
001100* THIS PROGRAM HAS 3 FUNCTIONS:                                   00110000
001200* 1 -  DISPLAY A FULL-SCREEN MESSAGE TO THE USER.                 00120000
001300                                                                  00130000
001400* 2 -  GRACEFULLY HANDLE A DB2 ABEND BY DISPLAYING A READABLE     00140000
001500*      MESSAGE ON THE LRT AND PRINTING DIAGNOSTICS TO THE CICS LOG00150000
001600                                                                  00160000
001700* 3 -  ALLOW USER TO CHOOSE HOW THEY WANT TO ENTER QUANTITIES.    00170000
001800*      EITHER THEY CAN SCAN EACH ITEM INDIVIDUALLY WITH A QTY     00180000
001900*      OF 1 OR SCAN THE UPC ONCE AND ENTER A MULTIPLIER QTY.      00190000
002000*      PC033-NEXT-PROGRAM IS USED TO XCTL TO THE PROGRAM USED     00200000
002100*      FOR THE DATA ENTRY.                                        00210000
002200                                                                  00220000
002300                                                                  00230000
002400******************************************************************00240000
002500                                                                  00250000
002600 ENVIRONMENT DIVISION.                                            00260000
002700 DATA DIVISION.                                                   00270000
002800                                                                  00280000
002900 WORKING-STORAGE SECTION.                                         00290000
003000                                                                  00300000
003100 01  DK-DB2-KEYS.                                                 00310000
003200     05  DK-ADJ-USR-ID                PIC  X(08) VALUE SPACES.    00320000
003300                                                                  00330000
003400 01  PV-PROGRAM-VARIABLES.                                        00340000
003500     05  PV-COMMAREA-LENGTH           PIC S9(04)  VALUE ZERO      00350000
003600                                                     COMP SYNC.   00360000
003610     05  PV-TEXT-LENGTH               PIC S9(04)  VALUE ZERO      00361000
003620                                                     COMP SYNC.   00362000
003630     05  PV-MESSAGE-AREA              PIC X(19)  VALUE SPACE.     00363000
003640     05  PV-CICS-RESPONSE             PIC S9(08) VALUE ZEROS      00364000
003650                                                     COMP SYNC.   00365000
003660     05  PV-TRANSFER-PROGRAM          PIC X(08) VALUE SPACES.     00366000
003670                                                                  00367000
003680 01  PC-PROGRAM-CONSTANTS.                                        00368000
003690     05  PC-CURRENT-TRANID            PIC X(04)  VALUE 'E852'.    00369000
003700     05  PC-CURRENT-PROGRAM-NAME      PIC X(08)  VALUE 'PCKRF852'.00370000
003800     05  PC-MASTER-CONTAINER-PGM      PIC X(08)  VALUE 'PCKRF864'.00380000
003900     05  PC-BARCODE-ENTRY-PGM         PIC X(08)  VALUE 'PCKRF865'.00390000
004100     05  PC-ADDL-SML-PGM              PIC X(08)  VALUE 'PCKRF856'.00410000
004200*    PC-NEW-LINE IS HEX '15'                                      00420000
004300     05  PC-NEW-LINE                  PIC X(01)  VALUE X'15'.     00430000
004400                                                                  00440000
004500 01  PV-TEXT.                                                     00450000
004600     05  PV-TEXT-LINE-1.                                          00460000
004700         10  FILLER              PIC X(06)   VALUE 'PGM:  '.      00470000
004800         10  PV-TEXT-HEADER      PIC X(08)   VALUE 'PCKRF852'.    00480018
004900         10  FILLER              PIC X(05)   VALUE SPACES.        00490000
005000         10  PV-NEW-LINE-1       PIC X(01)   VALUE SPACES.        00500000
005010     05  PV-TEXT-LINE-2.                                          00501000
005020         10  FILLER              PIC X(06)   VALUE 'MSG:  '.      00502000
005030         10  PV-TEXT-MSG-NBR     PIC 9(03)   VALUE ZEROES.        00503000
005040         10  FILLER              PIC X(10)   VALUE SPACES.        00504000
005050         10  PV-NEW-LINE-2       PIC X(01)   VALUE SPACES.        00505000
005060     05  PV-TEXT-LINE-3.                                          00506000
005070         10  FILLER              PIC X(06)   VALUE 'LAST: '.      00507000
005080         10  PV-TEXT-LAST-PGM    PIC X(08)   VALUE SPACES.        00508000
005090         10  FILLER              PIC X(05)   VALUE SPACES.        00509000
005091         10  PV-NEW-LINE-3       PIC X(01)   VALUE SPACES.        00509100
005092     05  PV-TEXT-LINE-4.                                          00509200
005093         10  FILLER              PIC X(06)   VALUE 'ROOT: '.      00509300
005094         10  PV-TEXT-ROOT-PGM    PIC X(08)   VALUE SPACES.        00509400
005095         10  FILLER              PIC X(05)   VALUE SPACES.        00509500
005096         10  PV-NEW-LINE-4       PIC X(01)   VALUE SPACES.        00509600
005097     05  PV-TEXT-LINE-5.                                          00509700
005098         10  FILLER              PIC X(06)   VALUE 'MENU: '.      00509800
005099         10  PV-TEXT-MENU-PGM    PIC X(08)   VALUE SPACES.        00509900
005100         10  FILLER              PIC X(05)   VALUE SPACES.        00510000
005101         10  PV-NEW-LINE-5       PIC X(01)   VALUE SPACES.        00510100
005102     05  PV-TEXT-LINE-6.                                          00510200
005103         10  FILLER              PIC X(06)   VALUE 'NEXT: '.      00510300
005104         10  PV-NEXT-MENU-PGM    PIC X(08)   VALUE SPACES.        00510400
005105         10  FILLER              PIC X(05)   VALUE SPACES.        00510500
005106         10  PV-NEW-LINE-6       PIC X(01)   VALUE SPACES.        00510600
005107     05  PV-TEXT-LINE-7.                                          00510700
005108         10  FILLER              PIC X(19)   VALUE SPACES.        00510800
005109         10  PV-NEW-LINE-7       PIC X(01)   VALUE SPACES.        00510900
005110     05  PV-TEXT-LINE-8          PIC X(20)   VALUE                00511000
005111         ' ENTER TO CONTINUE  '.                                  00511100
005112                                                                  00511200
005113/                                                                 00511300
005114     COPY DFHAID.                                                 00511400
005115     COPY DPWS013.                                                00511500
005116                                                                  00511600
005117     COPY PCKM852.                                                00511700
005118                                                                  00511800
005119                                                                  00511900
005120                                                                  00512000
005130*  COMMAREA TO/FROM HOST PROGRAM                                  00513000
005140 01  CA-COMMAREA.                                                 00514000
005150     COPY PCWS033.                                                00515000
005160                                                                  00516000
005170*  COPY BOOK CONTAINING THE SYSTEM LINE MESSAGES                  00517000
005180     COPY PCWS034.                                                00518000
005190                                                                  00519000
005200*  COPY BOOK CONTAINING THE SYSTEM SCREEN MESSAGES                00520000
005300     COPY PCWS035.                                                00530000
005400                                                                  00540000
005500* HELP SCREEN COMMAREA                                            00550000
005600     COPY PCWS192.                                                00560000
005700* HELP SCREEN WORK AREA                                           00570000
005800     COPY PCWS188.                                                00580000
005900                                                                  00590000
006000**   LAYOUT FOR TEMP-STORAGE QUEUE INFORMATION.                   00600000
006100*                                                                 00610000
006200     COPY DPWS026.                                                00620000
006300*                                                                 00630000
006400**   HEX CONVERSION ROUTINE PARAMETER LIST                        00640000
006500*                                                                 00650000
006600     COPY DPWS012.                                                00660000
006700*                                                                 00670000
006800/                                                                 00680000
006900 01  LT-LOG-LINE-TABLE.                                           00690000
007000     05  LT-LOG-LINE             OCCURS 52 TIMES                  00700000
007100                                 INDEXED BY LT-IDX.               00710000
007200         10  LT-ERROR-MESSAGE    PIC  X(79).                      00720000
007300                                                                  00730000
007400 01  PV-ABEND-STUFF.                                              00740000
007500     05  PV-LOG-LINE.                                             00750000
007600         10  FILLER              PIC  X(22)  VALUE                00760000
007700             '*** ERROR ON TERMINAL '.                            00770000
007800         10  PV-LOG-TERMINAL     PIC  X(04)  VALUE SPACE.         00780000
007900         10  FILLER              PIC  X(06)  VALUE ' ===> '.      00790000
008000         10  PV-LOG-DATA         PIC  X(79)  VALUE SPACE.         00800000
008100     05 DL1-DB2-LINE-1.                                           00810000
008200         10 FILLER               PIC  X(16)  VALUE SPACE.         00820000
008300         10 FILLER               PIC  X(47)  VALUE                00830000
008400             'THERE WAS AN ERROR ENCOUNTERED IN A DB2 COMMAND'.   00840000
008500         10 FILLER               PIC  X(16)  VALUE SPACE.         00850000
008600     05 DL2-DB2-LINE-2.                                           00860000
008700         10 FILLER               PIC  X(43)  VALUE                00870000
008800             'THE FOLLOWING DB2 TABLE(S) MAY BE INVOLVED:'.       00880000
008900         10 FILLER               PIC  X(36)  VALUE SPACE.         00890000
009000                                                                  00900000
009100     05  TS-INFO-QUEUE-NAME.                                      00910000
009200         10  TS-INFO-QUEUE-TERMINAL                               00920000
009300                                 PIC X(04)   VALUE SPACE.         00930000
009400         10  FILLER              PIC X(04)   VALUE 'INFO'.        00940000
009500                                                                  00950000
009600     05  PC-LOG-QUEUE-RESOURCE   PIC  X(04)  VALUE 'CSSL'.        00960000
009700     05  PV-NUMBER-LOG-LINES     PIC S9(04)  VALUE +0             00970000
009800                                              COMP SYNC.          00980000
009900     05  PC-LOG-QUEUE            PIC  X(04)  VALUE 'CSSL'.        00990000
010000     05  PS-LOG-OVERFLOW-SW      PIC  X(01)  VALUE 'N'.           01000000
010100         88  PS-LOG-OVERFLOW                 VALUE 'Y'.           01010000
010200     05  PC-LOGON-TRAN           PIC  X(04)  VALUE 'Z028'.        01020000
010300     05  PV-SYSID                PIC  X(04)  VALUE SPACES.        01030000
010400     05  PV-TS-ITEM              PIC S9(04)  VALUE +1             01040000
010500                                              COMP SYNC.          01050000
010600     05  PV-MSG-SUB              PIC S9(04)  VALUE +0             01060000
010700                                              COMP SYNC.          01070000
010800     05  PC-LOG-TABLE-MAX        PIC S9(04)  VALUE +52            01080000
010900                                             COMP.                01090000
011000     05  PV-STRING-POINTER       PIC S9(04)  VALUE +1             01100000
011100                                              COMP SYNC.          01110000
011200     05  PC-STRING-POINTER-MAX   PIC S9(04)  VALUE +60            01120000
011300                                             COMP.                01130000
011400 01  FDB-FORMAT-DB2-ERROR-FIELDS.                                 01140000
011500     05  FDB-MAX-MESSAGE-LINES     PIC S9(04)  VALUE +12          01150000
011600                                               COMP SYNC.         01160000
011700     05  FDB-ERROR-LINE-LENGTH     PIC S9(09)  VALUE +75          01170000
011800                                               COMP SYNC.         01180000
011900     05  FDB-FORMATTED-MESSAGE.                                   01190000
012000         10  FILLER                PIC S9(04)  VALUE +900         01200000
012100                                               COMP SYNC.         01210000
012200         10  FDB-MESSAGE-LINE      OCCURS 12 TIMES                01220000
012300                                   INDEXED BY FDB-MSG-IDX         01230000
012400                                   PIC  X(75).                    01240000
012500*                                                                 01250000
012600                                                                  01260000
012700*                                                                 01270000
012800 01  AL1-ABEND-LINE-1.                                            01280000
012900     05  FILLER                  PIC  X(12)  VALUE 'PROGRAM...: '.01290000
013000     05  AL1-PROGRAM             PIC  X(08)  VALUE SPACE.         01300000
013100     05  FILLER                  PIC  X(04)  VALUE SPACE.         01310000
013200     05  FILLER                  PIC  X(11)  VALUE 'PARAGRAPH: '. 01320000
013300     05  AL1-PARAGRAPH           PIC  X(30)  VALUE SPACE.         01330000
013400     05  FILLER                  PIC  X(14)  VALUE SPACE.         01340000
013500 01  AL2-ABEND-LINE-2.                                            01350000
013600     05  FILLER                  PIC  X(12)  VALUE 'USERID....: '.01360000
013700     05  AL2-USERID              PIC  X(08)  VALUE SPACE.         01370000
013800     05  FILLER                  PIC  X(06)  VALUE SPACE.         01380000
013900     05  FILLER                  PIC  X(09)  VALUE 'NETNAME: '.   01390000
014000     05  AL2-NETNAME             PIC  X(08)  VALUE SPACE.         01400000
014100     05  FILLER                  PIC  X(02)  VALUE SPACE.         01410000
014200     05  FILLER                  PIC  X(10)  VALUE 'LOCATION: '.  01420000
014300     05  AL2-LOCATION            PIC  X(04)  VALUE SPACE.         01430000
014400     05  FILLER                  PIC  X(20)  VALUE SPACE.         01440000
014500 01  AL3-ABEND-LINE-3.                                            01450000
014600     05  FILLER                  PIC  X(12)  VALUE                01460000
014700                                             'ABEND TYPE: '.      01470000
014800     05  AL3-ABEND-TYPE          PIC  X(01)  VALUE SPACE.         01480000
014900     05  FILLER                  PIC  X(07)  VALUE SPACE.         01490000
015000     05  FILLER                  PIC  X(15)  VALUE                01500000
015100                                             'ABEND CONTROL: '.   01510000
015200     05  AL3-ABEND-CONTROL       PIC  X(01)  VALUE SPACE.         01520000
015300     05  FILLER                  PIC  X(09)  VALUE SPACE.         01530000
015400     05  FILLER                  PIC  X(10)  VALUE                01540000
015500                                             'ROLLBACK: '.        01550000
015600     05  AL3-ROLLBACK            PIC  X(01)  VALUE SPACE.         01560000
015700     05  FILLER                  PIC  X(23)  VALUE SPACE.         01570000
015800                                                                  01580000
015900 01  AL4-ABEND-LINE-4.                                            01590000
016000     05  FILLER                  PIC  X(11)  VALUE                01600000
016100                                             'MESSAGE...:'.       01610000
016200     05  FILLER                  PIC  X(68)  VALUE SPACE.         01620000
016300*                                                                 01630000
016400*                                                                 01640000
016500**   PREFORMATTED LINES FOR THE EIB AREA                          01650000
016600*                                                                 01660000
016700 01  EL1-EIB-LINE-1.                                              01670000
016800     05  FILLER                  PIC  X(28)  VALUE                01680000
016900         'EIB INFORMATION FOLLOWS:'.                              01690000
017000     05  FILLER                  PIC  X(51)  VALUE SPACE.         01700000
017100 01  EL2-EIB-LINE-2.                                              01710000
017200     05  FILLER                  PIC  X(02)  VALUE SPACE.         01720000
017300     05  FILLER                  PIC  X(10)  VALUE 'EIBTIME.: '.  01730000
017400     05  EL2-EIBTIME             PIC  9(07)+ VALUE ZERO.          01740000
017500     05  FILLER                  PIC  X(20)  VALUE SPACE.         01750000
017600     05  FILLER                  PIC  X(10)  VALUE 'EIBDATE.: '.  01760000
017700     05  EL2-EIBDATE             PIC  9(07)+ VALUE ZERO.          01770000
017800     05  FILLER                  PIC  X(21)  VALUE SPACE.         01780000
017900 01  EL3-EIB-LINE-3.                                              01790000
018000     05  FILLER                  PIC  X(02)  VALUE SPACE.         01800000
018100     05  FILLER                  PIC  X(10)  VALUE 'EIBTRNID: '.  01810000
018200     05  EL3-EIBTRNID            PIC  X(04)  VALUE SPACE.         01820000
018300     05  FILLER                  PIC  X(24)  VALUE SPACE.         01830000
018400     05  FILLER                  PIC  X(10)  VALUE 'EIBTASKN: '.  01840000
018500     05  EL3-EIBTASKN            PIC  9(07)+ VALUE ZERO.          01850000
018600     05  FILLER                  PIC  X(21)  VALUE SPACE.         01860000
018700 01  EL4-EIB-LINE-4.                                              01870000
018800     05  FILLER                  PIC  X(02)  VALUE SPACE.         01880000
018900     05  FILLER                  PIC  X(10)  VALUE 'EIBTRMID: '.  01890000
019000     05  EL4-EIBTRMID            PIC  X(04)  VALUE SPACE.         01900000
019100     05  FILLER                  PIC  X(24)  VALUE SPACE.         01910000
019200     05  FILLER                  PIC  X(10)  VALUE 'EIBCPOSN: '.  01920000
019300     05  EL4-EIBCPOSN            PIC  9(04)+ VALUE ZERO.          01930000
019400     05  FILLER                  PIC  X(24)  VALUE SPACE.         01940000
019500 01  EL5-EIB-LINE-5.                                              01950000
019600     05  FILLER                  PIC  X(02)  VALUE SPACE.         01960000
019700     05  FILLER                  PIC  X(10)  VALUE 'EIBCALEN: '.  01970000
019800     05  EL5-EIBCALEN            PIC  9(05)  VALUE ZERO.          01980000
019900     05  FILLER                  PIC  X(23)  VALUE SPACE.         01990000
020000     05  FILLER                  PIC  X(10)  VALUE 'EIBAID..: '.  02000000
020100     05  EL5-EIBAID              PIC  X(01)  VALUE SPACE.         02010000
020200     05  FILLER                  PIC  X(02)  VALUE ' ('.          02020000
020300     05  EL5-EIBAID-DESCRIPTION  PIC  X(05)  VALUE SPACE.         02030000
020400     05  FILLER                  PIC  X(01)  VALUE ')'.           02040000
020500     05  FILLER                  PIC  X(30)  VALUE SPACE.         02050000
020600 01  EL6-EIB-LINE-6.                                              02060000
020700     05  FILLER                  PIC  X(02)  VALUE SPACE.         02070000
020800     05  FILLER                  PIC  X(12)  VALUE                02080000
020900                                             'EIBFN...: X'''.     02090000
021000     05  EL6-EIBFN-HEX           PIC  X(04)  VALUE SPACE.         02100000
021100     05  FILLER                  PIC  X(01)  VALUE ''''.          02110000
021200     05  FILLER                  PIC  X(21)  VALUE SPACE.         02120000
021300     05  FILLER                  PIC  X(11)  VALUE                02130000
021400                                             'EIBRCODE:X'''.      02140000
021500     05  EL6-EIBRCODE-HEX        PIC  X(12)  VALUE SPACE.         02150000
021600     05  FILLER                  PIC  X(01)  VALUE ''''.          02160000
021700     05  FILLER                  PIC  X(15)  VALUE SPACE.         02170000
021800 01  EL7-EIB-LINE-7.                                              02180000
021900     05  FILLER                  PIC  X(02)  VALUE SPACE.         02190000
022000     05  FILLER                  PIC  X(10)  VALUE 'EIBRESP.: '.  02200000
022100     05  EL7-EIBRESP             PIC  9(08)  VALUE ZERO.          02210000
022200     05  FILLER                  PIC  X(02)  VALUE ' ('.          02220000
022300     05  EL7-EIBRESP-DESCRIPTION PIC  X(12)  VALUE SPACE.         02230000
022400     05  FILLER                  PIC  X(01)  VALUE ')'.           02240000
022500     05  FILLER                  PIC  X(05)  VALUE SPACE.         02250000
022600     05  FILLER                  PIC  X(10)  VALUE 'EIBRESP2: '.  02260000
022700     05  EL7-EIBRESP2            PIC  9(08)+ VALUE ZERO.          02270000
022800     05  FILLER                  PIC  X(20)  VALUE SPACE.         02280000
022900 01  EL8-EIB-LINE-8.                                              02290000
023000     05  FILLER                  PIC  X(02)  VALUE SPACE.         02300000
023100     05  FILLER                  PIC  X(10)  VALUE 'EIBDS...: '.  02310000
023200     05  EL8-EIBDS               PIC  X(08)  VALUE SPACE.         02320000
023300     05  FILLER                  PIC  X(20)  VALUE SPACE.         02330000
023400     05  FILLER                  PIC  X(10)  VALUE 'EIBREQID: '.  02340000
023500     05  EL8-EIBREQID-HEX        PIC  X(08)  VALUE SPACE.         02350000
023600     05  FILLER                  PIC  X(21)  VALUE SPACE.         02360000
023700 01  EL9-EIB-LINE-9.                                              02370000
023800     05  FILLER                  PIC  X(02)  VALUE SPACE.         02380000
023900     05  FILLER                  PIC  X(12)  VALUE                02390000
024000                                             'EIBRSRCE: X'''.     02400000
024100     05  EL9-EIBRSRCE-HEX        PIC  X(16)  VALUE SPACE.         02410000
024200     05  FILLER                  PIC  X(01)  VALUE ''''.          02420000
024300     05  FILLER                  PIC  X(09)  VALUE SPACE.         02430000
024400     05  FILLER                  PIC  X(12)  VALUE                02440000
024500                                             'EIBEOC..: X'''.     02450000
024600     05  EL9-EIBEOC-HEX          PIC  X(02)  VALUE SPACE.         02460000
024700     05  FILLER                  PIC  X(01)  VALUE ''''.          02470000
024800     05  FILLER                  PIC  X(24)  VALUE SPACE.         02480000
024900 01  EL10-EIB-LINE-10.                                            02490000
025000     05  FILLER                  PIC  X(02)  VALUE SPACE.         02500000
025100     05  FILLER                  PIC  X(12)  VALUE                02510000
025200                                             'EIBFREE.: X'''.     02520000
025300     05  EL10-EIBFREE-HEX        PIC  X(02)  VALUE SPACE.         02530000
025400     05  FILLER                  PIC  X(01)  VALUE ''''.          02540000
025500     05  FILLER                  PIC  X(23)  VALUE SPACE.         02550000
025600     05  FILLER                  PIC  X(12)  VALUE                02560000
025700                                             'EIBRECV.: X'''.     02570000
025800     05  EL10-EIBRECV-HEX        PIC  X(02)  VALUE SPACE.         02580000
025900     05  FILLER                  PIC  X(01)  VALUE ''''.          02590000
026000     05  FILLER                  PIC  X(24)  VALUE SPACE.         02600000
026100 01  EL11-EIB-LINE-11.                                            02610000
026200     05  FILLER                  PIC  X(02)  VALUE SPACE.         02620000
026300     05  FILLER                  PIC  X(12)  VALUE                02630000
026400                                             'EIBATT..: X'''.     02640000
026500     05  EL11-EIBATT-HEX         PIC  X(02)  VALUE SPACE.         02650000
026600     05  FILLER                  PIC  X(01)  VALUE ''''.          02660000
026700     05  FILLER                  PIC  X(23)  VALUE SPACE.         02670000
026800     05  FILLER                  PIC  X(12)  VALUE                02680000
026900                                             'EIBSYNC.: X'''.     02690000
027000     05  EL11-EIBSYNC-HEX        PIC  X(02)  VALUE SPACE.         02700000
027100     05  FILLER                  PIC  X(01)  VALUE ''''.          02710000
027200     05  FILLER                  PIC  X(24)  VALUE SPACE.         02720000
027300 01  EL12-EIB-LINE-12.                                            02730000
027400     05  FILLER                  PIC  X(02)  VALUE SPACE.         02740000
027500     05  FILLER                  PIC  X(12)  VALUE                02750000
027600                                             'EIBFMH..: X'''.     02760000
027700     05  EL12-EIBFMH-HEX         PIC  X(02)  VALUE SPACE.         02770000
027800     05  FILLER                  PIC  X(01)  VALUE ''''.          02780000
027900     05  FILLER                  PIC  X(23)  VALUE SPACE.         02790000
028000     05  FILLER                  PIC  X(12)  VALUE                02800000
028100                                             'EIBCOMPL: X'''.     02810000
028200     05  EL12-EIBCOMPL-HEX       PIC  X(02)  VALUE SPACE.         02820000
028300     05  FILLER                  PIC  X(01)  VALUE ''''.          02830000
028400     05  FILLER                  PIC  X(24)  VALUE SPACE.         02840000
028500 01  EL13-EIB-LINE-13.                                            02850000
028600     05  FILLER                  PIC  X(02)  VALUE SPACE.         02860000
028700     05  FILLER                  PIC  X(12)  VALUE                02870000
028800                                             'EIBSIG..: X'''.     02880000
028900     05  EL13-EIBSIG-HEX         PIC  X(02)  VALUE SPACE.         02890000
029000     05  FILLER                  PIC  X(01)  VALUE ''''.          02900000
029100     05  FILLER                  PIC  X(23)  VALUE SPACE.         02910000
029200     05  FILLER                  PIC  X(12)  VALUE                02920000
029300                                             'EIBCONF.: X'''.     02930000
029400     05  EL13-EIBCONF-HEX        PIC  X(02)  VALUE SPACE.         02940000
029500     05  FILLER                  PIC  X(01)  VALUE ''''.          02950000
029600     05  FILLER                  PIC  X(24)  VALUE SPACE.         02960000
029700 01  EL14-EIB-LINE-14.                                            02970000
029800     05  FILLER                  PIC  X(02)  VALUE SPACE.         02980000
029900     05  FILLER                  PIC  X(12)  VALUE                02990000
030000                                             'EIBERR..: X'''.     03000000
030100     05  EL14-EIBERR-HEX         PIC  X(02)  VALUE SPACE.         03010000
030200     05  FILLER                  PIC  X(01)  VALUE ''''.          03020000
030300     05  FILLER                  PIC  X(23)  VALUE SPACE.         03030000
030400     05  FILLER                  PIC  X(12)  VALUE                03040000
030500                                             'EIBERRCD: X'''.     03050000
030600     05  EL14-EIBERRCD-HEX       PIC  X(08)  VALUE SPACE.         03060000
030700     05  FILLER                  PIC  X(01)  VALUE ''''.          03070000
030800     05  FILLER                  PIC  X(18)  VALUE SPACE.         03080000
030900 01  EL15-EIB-LINE-15.                                            03090000
031000     05  FILLER                  PIC  X(02)  VALUE SPACE.         03100000
031100     05  FILLER                  PIC  X(12)  VALUE                03110000
031200                                             'EIBSYNRB: X'''.     03120000
031300     05  EL15-EIBSYNRB-HEX       PIC  X(02)  VALUE SPACE.         03130000
031400     05  FILLER                  PIC  X(01)  VALUE ''''.          03140000
031500     05  FILLER                  PIC  X(23)  VALUE SPACE.         03150000
031600     05  FILLER                  PIC  X(12)  VALUE                03160000
031700                                             'EIBNODAT: X'''.     03170000
031800     05  EL15-EIBNODAT-HEX       PIC  X(02)  VALUE SPACE.         03180000
031900     05  FILLER                  PIC  X(01)  VALUE ''''.          03190000
032000     05  FILLER                  PIC  X(24)  VALUE SPACE.         03200000
032100*                                                                 03210000
032200*                                                                 03220000
032300**   FOLLOWING IS THE LAYOUT FOR THE EXEC INTERFACE BLOCK         03230000
032400**   USED IN PROCESSING A THE EIB AREA PASSED BY THE CALLING      03240000
032500**   PROGRAM.                                                     03250000
032600*                                                                 03260000
032700 01  EIBM-EIBLK-MASK.                                             03270000
032800     05  EIBM-TIME         PIC S9(07)  VALUE ZERO                 03280000
032900                                       COMP-3.                    03290000
033000     05  EIBM-DATE         PIC S9(07)  VALUE ZERO                 03300000
033100                                       COMP-3.                    03310000
033200     05  EIBM-TRNID        PIC  X(04)  VALUE SPACE.               03320000
033300     05  EIBM-TASKN        PIC S9(07)  VALUE ZERO                 03330000
033400                                       COMP-3.                    03340000
033500     05  EIBM-TRMID        PIC  X(04)  VALUE SPACE.               03350000
033600     05  FILLER            PIC S9(04)  VALUE ZERO                 03360000
033700                                       COMP.                      03370000
033800     05  EIBM-CPOSN        PIC S9(04)  VALUE ZERO                 03380000
033900                                       COMP.                      03390000
034000     05  EIBM-CALEN        PIC S9(04)  VALUE ZERO                 03400000
034100                                       COMP.                      03410000
034200     05  EIBM-AID          PIC  X(01)  VALUE SPACE.               03420000
034300     05  EIBM-FN           PIC  X(02)  VALUE SPACE.               03430000
034400     05  EIBM-RCODE        PIC  X(06)  VALUE SPACE.               03440000
034500     05  EIBM-DS           PIC  X(08)  VALUE SPACE.               03450000
034600     05  EIBM-REQID        PIC  X(08)  VALUE SPACE.               03460000
034700     05  EIBM-RSRCE        PIC  X(08)  VALUE SPACE.               03470000
034800     05  EIBM-SYNC         PIC  X(01)  VALUE SPACE.               03480000
034900     05  EIBM-FREE         PIC  X(01)  VALUE SPACE.               03490000
035000     05  EIBM-RECV         PIC  X(01)  VALUE SPACE.               03500000
035100     05  EIBM-SEND         PIC  X(01)  VALUE SPACE.               03510000
035200     05  EIBM-ATT          PIC  X(01)  VALUE SPACE.               03520000
035300     05  EIBM-EOC          PIC  X(01)  VALUE SPACE.               03530000
035400     05  EIBM-FMH          PIC  X(01)  VALUE SPACE.               03540000
035500     05  EIBM-COMPL        PIC  X(01)  VALUE SPACE.               03550000
035600     05  EIBM-SIG          PIC  X(01)  VALUE SPACE.               03560000
035700     05  EIBM-CONF         PIC  X(01)  VALUE SPACE.               03570000
035800     05  EIBM-ERR          PIC  X(01)  VALUE SPACE.               03580000
035900     05  EIBM-ERRCD        PIC  X(04)  VALUE SPACE.               03590000
036000     05  EIBM-SYNRB        PIC  X(01)  VALUE SPACE.               03600000
036100     05  EIBM-NODAT        PIC  X(01)  VALUE SPACE.               03610000
036200     05  EIBM-RESP         PIC S9(08)  VALUE ZERO                 03620000
036300                                       COMP.                      03630000
036400     05  EIBM-RESP2        PIC S9(08)  VALUE ZERO                 03640000
036500                                       COMP.                      03650000
036600     05  EIBM-RLDBK        PIC  X(01)  VALUE SPACE.               03660000
036700*                                                                 03670000
036800 01  AC-AID-CONVERSION-TABLE.                                     03680000
036900     05  AC-ATTENTION-ID-ENTRIES.                                 03690000
037000         10  FILLER              PIC  X(06)  VALUE ' NULL '.      03700000
037100         10  FILLER              PIC  X(06)  VALUE '''ENTER'.     03710000
037200         10  FILLER              PIC  X(06)  VALUE '_CLEAR'.      03720000
037300         10  FILLER              PIC  X(06)  VALUE 'ºCLRP '.      03730000
037400         10  FILLER              PIC  X(06)  VALUE '=PEN  '.      03740000
037500         10  FILLER              PIC  X(06)  VALUE 'WOPID '.      03750000
037600         10  FILLER              PIC  X(06)  VALUE 'XMSRE '.      03760000
037700         10  FILLER              PIC  X(06)  VALUE 'HSTRF '.      03770000
037800         10  FILLER              PIC  X(06)  VALUE '"TRIG '.      03780000
037900         10  FILLER              PIC  X(06)  VALUE '%PA1  '.      03790000
038000         10  FILLER              PIC  X(06)  VALUE '>PA2  '.      03800000
038100         10  FILLER              PIC  X(06)  VALUE ',PA3  '.      03810000
038200         10  FILLER              PIC  X(06)  VALUE '1PF1  '.      03820000
038300         10  FILLER              PIC  X(06)  VALUE '2PF2  '.      03830000
038400         10  FILLER              PIC  X(06)  VALUE '3PF3  '.      03840000
038500         10  FILLER              PIC  X(06)  VALUE '4PF4  '.      03850000
038600         10  FILLER              PIC  X(06)  VALUE '5PF5  '.      03860000
038700         10  FILLER              PIC  X(06)  VALUE '6PF6  '.      03870000
038800         10  FILLER              PIC  X(06)  VALUE '7PF7  '.      03880000
038900         10  FILLER              PIC  X(06)  VALUE '8PF8  '.      03890000
039000         10  FILLER              PIC  X(06)  VALUE '9PF9  '.      03900000
039100         10  FILLER              PIC  X(06)  VALUE ':PF10 '.      03910000
039200         10  FILLER              PIC  X(06)  VALUE '#PF11 '.      03920000
039300         10  FILLER              PIC  X(06)  VALUE '@PF12 '.      03930000
039400         10  FILLER              PIC  X(06)  VALUE 'APF13 '.      03940000
039500         10  FILLER              PIC  X(06)  VALUE 'BPF14 '.      03950000
039600         10  FILLER              PIC  X(06)  VALUE 'CPF15 '.      03960000
039700         10  FILLER              PIC  X(06)  VALUE 'DPF16 '.      03970000
039800         10  FILLER              PIC  X(06)  VALUE 'EPF17 '.      03980000
039900         10  FILLER              PIC  X(06)  VALUE 'FPF18 '.      03990000
040000         10  FILLER              PIC  X(06)  VALUE 'GPF19 '.      04000000
040100         10  FILLER              PIC  X(06)  VALUE 'HPF20 '.      04010000
040200         10  FILLER              PIC  X(06)  VALUE 'IPF21 '.      04020000
040300         10  FILLER              PIC  X(06)  VALUE '›PF22 '.      04030000
040400         10  FILLER              PIC  X(06)  VALUE '.PF23 '.      04040000
040500         10  FILLER              PIC  X(06)  VALUE '<PF24 '.      04050000
040600     05  AC-ATTENTION-ID-ENTRY   REDEFINES                        04060000
040700                                 AC-ATTENTION-ID-ENTRIES          04070000
040800                                 OCCURS 36 TIMES                  04080000
040900                                 INDEXED BY AC-AID-IDX.           04090000
041000         10  AC-EIBAID           PIC  X(01).                      04100000
041100         10  AC-AID-NAME         PIC  X(05).                      04110000
041200*                                                                 04120000
041300** EIBRESP DESCRIPTION TABLE                                      04130000
041400*                                                                 04140000
041500 01  EC-EIBRESP-CONVERSION-TABLE.                                 04150000
041600     05  EC-EIBRESP-ENTRIES.                                      04160000
041700         10  FILLER              PIC S9(08)  VALUE +00            04170000
041800                                             COMP.                04180000
041900         10  FILLER              PIC  X(12)  VALUE 'NORMAL'.      04190000
042000         10  FILLER              PIC S9(08)  VALUE +01            04200000
042100                                             COMP.                04210000
042200         10  FILLER              PIC  X(12)  VALUE 'ERROR'.       04220000
042300         10  FILLER              PIC S9(08)  VALUE +02            04230000
042400                                             COMP.                04240000
042500         10  FILLER              PIC  X(12)  VALUE 'RDATT'.       04250000
042600         10  FILLER              PIC S9(08)  VALUE +03            04260000
042700                                             COMP.                04270000
042800         10  FILLER              PIC  X(12)  VALUE 'WRBRK'.       04280000
042900         10  FILLER              PIC S9(08)  VALUE +04            04290000
043000                                             COMP.                04300000
043100         10  FILLER              PIC  X(12)  VALUE 'EOF'.         04310000
043200         10  FILLER              PIC S9(08)  VALUE +05            04320000
043300                                             COMP.                04330000
043400         10  FILLER              PIC  X(12)  VALUE 'EODS'.        04340000
043500         10  FILLER              PIC S9(08)  VALUE +06            04350000
043600                                             COMP.                04360000
043700         10  FILLER              PIC  X(12)  VALUE 'EOC'.         04370000
043800         10  FILLER              PIC S9(08)  VALUE +07            04380000
043900                                             COMP.                04390000
044000         10  FILLER              PIC  X(12)  VALUE 'INBFMH'.      04400000
044100         10  FILLER              PIC S9(08)  VALUE +08            04410000
044200                                             COMP.                04420000
044300         10  FILLER              PIC  X(12)  VALUE 'ENDINPT'.     04430000
044400         10  FILLER              PIC S9(08)  VALUE +09            04440000
044500                                             COMP.                04450000
044600         10  FILLER              PIC  X(12)  VALUE 'NONVAL'.      04460000
044700         10  FILLER              PIC S9(08)  VALUE +10            04470000
044800                                             COMP.                04480000
044900         10  FILLER              PIC  X(12)  VALUE 'NOSTART'.     04490000
045000         10  FILLER              PIC S9(08)  VALUE +11            04500000
045100                                             COMP.                04510000
045200         10  FILLER              PIC  X(12)  VALUE 'TERMIDERR'.   04520000
045300         10  FILLER              PIC S9(08)  VALUE +12            04530000
045400                                             COMP.                04540000
045500         10  FILLER              PIC  X(12)  VALUE 'DSIDERR'.     04550000
045600         10  FILLER              PIC S9(08)  VALUE +13            04560000
045700                                             COMP.                04570000
045800         10  FILLER              PIC  X(12)  VALUE 'NOTFND'.      04580000
045900         10  FILLER              PIC S9(08)  VALUE +14            04590000
046000                                             COMP.                04600000
046100         10  FILLER              PIC  X(12)  VALUE 'DUPREC'.      04610000
046200         10  FILLER              PIC S9(08)  VALUE +15            04620000
046300                                             COMP.                04630000
046400         10  FILLER              PIC  X(12)  VALUE 'DUPKEY'.      04640000
046500         10  FILLER              PIC S9(08)  VALUE +16            04650000
046600                                             COMP.                04660000
046700         10  FILLER              PIC  X(12)  VALUE 'INVREQ'.      04670000
046800         10  FILLER              PIC S9(08)  VALUE +17            04680000
046900                                             COMP.                04690000
047000         10  FILLER              PIC  X(12)  VALUE 'IOERR'.       04700000
047100         10  FILLER              PIC S9(08)  VALUE +18            04710000
047200                                             COMP.                04720000
047300         10  FILLER              PIC  X(12)  VALUE 'NOSPACE'.     04730000
047400         10  FILLER              PIC S9(08)  VALUE +19            04740000
047500                                             COMP.                04750000
047600         10  FILLER              PIC  X(12)  VALUE 'NOTOPEN'.     04760000
047700         10  FILLER              PIC S9(08)  VALUE +20            04770000
047800                                             COMP.                04780000
047900         10  FILLER              PIC  X(12)  VALUE 'ENDFILE'.     04790000
048000         10  FILLER              PIC S9(08)  VALUE +21            04800000
048100                                             COMP.                04810000
048200         10  FILLER              PIC  X(12)  VALUE 'ILLOGIC'.     04820000
048300         10  FILLER              PIC S9(08)  VALUE +22            04830000
048400                                             COMP.                04840000
048500         10  FILLER              PIC  X(12)  VALUE 'LENGERR'.     04850000
048600         10  FILLER              PIC S9(08)  VALUE +23            04860000
048700                                             COMP.                04870000
048800         10  FILLER              PIC  X(12)  VALUE 'QZERO'.       04880000
048900         10  FILLER              PIC S9(08)  VALUE +24            04890000
049000                                             COMP.                04900000
049100         10  FILLER              PIC  X(12)  VALUE 'SIGNAL'.      04910000
049200         10  FILLER              PIC S9(08)  VALUE +25            04920000
049300                                             COMP.                04930000
049400         10  FILLER              PIC  X(12)  VALUE 'QBUSY'.       04940000
049500         10  FILLER              PIC S9(08)  VALUE +26            04950000
049600                                             COMP.                04960000
049700         10  FILLER              PIC  X(12)  VALUE 'ITEMERR'.     04970000
049800         10  FILLER              PIC S9(08)  VALUE +27            04980000
049900                                             COMP.                04990000
050000         10  FILLER              PIC  X(12)  VALUE 'PGMIDERR'.    05000000
050100         10  FILLER              PIC S9(08)  VALUE +28            05010000
050200                                             COMP.                05020000
050300         10  FILLER              PIC  X(12)  VALUE 'TRANSIDERR'.  05030000
050400         10  FILLER              PIC S9(08)  VALUE +29            05040000
050500                                             COMP.                05050000
050600         10  FILLER              PIC  X(12)  VALUE 'ENDDATA'.     05060000
050700         10  FILLER              PIC S9(08)  VALUE +30            05070000
050800                                             COMP.                05080000
050900         10  FILLER              PIC  X(12)  VALUE 'INVTSREQ'.    05090000
051000         10  FILLER              PIC S9(08)  VALUE +31            05100000
051100                                             COMP.                05110000
051200         10  FILLER              PIC  X(12)  VALUE 'EXPIRED'.     05120000
051300         10  FILLER              PIC S9(08)  VALUE +32            05130000
051400                                             COMP.                05140000
051500         10  FILLER              PIC  X(12)  VALUE 'RETPAGE'.     05150000
051600         10  FILLER              PIC S9(08)  VALUE +33            05160000
051700                                             COMP.                05170000
051800         10  FILLER              PIC  X(12)  VALUE 'RTEFAIL'.     05180000
051900         10  FILLER              PIC S9(08)  VALUE +34            05190000
052000                                             COMP.                05200000
052100         10  FILLER              PIC  X(12)  VALUE 'RTESOME'.     05210000
052200         10  FILLER              PIC S9(08)  VALUE +35            05220000
052300                                             COMP.                05230000
052400         10  FILLER              PIC  X(12)  VALUE 'TSIOERR'.     05240000
052500         10  FILLER              PIC S9(08)  VALUE +36            05250000
052600                                             COMP.                05260000
052700         10  FILLER              PIC  X(12)  VALUE 'MAPFAIL'.     05270000
052800         10  FILLER              PIC S9(08)  VALUE +37            05280000
052900                                             COMP.                05290000
053000         10  FILLER              PIC  X(12)  VALUE 'INVERRTERM'.  05300000
053100         10  FILLER              PIC S9(08)  VALUE +38            05310000
053200                                             COMP.                05320000
053300         10  FILLER              PIC  X(12)  VALUE 'INVMPSZ'.     05330000
053400         10  FILLER              PIC S9(08)  VALUE +39            05340000
053500                                             COMP.                05350000
053600         10  FILLER              PIC  X(12)  VALUE 'IGREQID'.     05360000
053700         10  FILLER              PIC S9(08)  VALUE +40            05370000
053800                                             COMP.                05380000
053900         10  FILLER              PIC  X(12)  VALUE 'OVERFLOW'.    05390000
054000         10  FILLER              PIC S9(08)  VALUE +41            05400000
054100                                             COMP.                05410000
054200         10  FILLER              PIC  X(12)  VALUE 'INVLDC'.      05420000
054300         10  FILLER              PIC S9(08)  VALUE +42            05430000
054400                                             COMP.                05440000
054500         10  FILLER              PIC  X(12)  VALUE 'NOSTG'.       05450000
054600         10  FILLER              PIC S9(08)  VALUE +43            05460000
054700                                             COMP.                05470000
054800         10  FILLER              PIC  X(12)  VALUE 'JIDERR'.      05480000
054900         10  FILLER              PIC S9(08)  VALUE +44            05490000
055000                                             COMP.                05500000
055100         10  FILLER              PIC  X(12)  VALUE 'QIDERR'.      05510000
055200         10  FILLER              PIC S9(08)  VALUE +45            05520000
055300                                             COMP.                05530000
055400         10  FILLER              PIC  X(12)  VALUE 'NOJBUFSP'.    05540000
055500         10  FILLER              PIC S9(08)  VALUE +46            05550000
055600                                             COMP.                05560000
055700         10  FILLER              PIC  X(12)  VALUE 'DSSTAT'.      05570000
055800         10  FILLER              PIC S9(08)  VALUE +47            05580000
055900                                             COMP.                05590000
056000         10  FILLER              PIC  X(12)  VALUE 'SELNERR'.     05600000
056100         10  FILLER              PIC S9(08)  VALUE +48            05610000
056200                                             COMP.                05620000
056300         10  FILLER              PIC  X(12)  VALUE 'FUNCERR'.     05630000
056400         10  FILLER              PIC S9(08)  VALUE +49            05640000
056500                                             COMP.                05650000
056600         10  FILLER              PIC  X(12)  VALUE 'UNEXPIN'.     05660000
056700         10  FILLER              PIC S9(08)  VALUE +50            05670000
056800                                             COMP.                05680000
056900         10  FILLER              PIC  X(12)  VALUE 'NOPASSBKRD'.  05690000
057000         10  FILLER              PIC S9(08)  VALUE +51            05700000
057100                                             COMP.                05710000
057200         10  FILLER              PIC  X(12)  VALUE 'NOPASSBKWR'.  05720000
057300         10  FILLER              PIC S9(08)  VALUE +53            05730000
057400                                             COMP.                05740000
057500         10  FILLER              PIC  X(12)  VALUE 'SYSIDERR'.    05750000
057600         10  FILLER              PIC S9(08)  VALUE +54            05760000
057700                                             COMP.                05770000
057800         10  FILLER              PIC  X(12)  VALUE 'ISCINVREQ'.   05780000
057900         10  FILLER              PIC S9(08)  VALUE +55            05790000
058000                                             COMP.                05800000
058100         10  FILLER              PIC  X(12)  VALUE 'ENQBUSY'.     05810000
058200         10  FILLER              PIC S9(08)  VALUE +56            05820000
058300                                             COMP.                05830000
058400         10  FILLER              PIC  X(12)  VALUE 'ENVDEFERR'.   05840000
058500         10  FILLER              PIC S9(08)  VALUE +57            05850000
058600                                             COMP.                05860000
058700         10  FILLER              PIC  X(12)  VALUE 'IGREQCD'.     05870000
058800         10  FILLER              PIC S9(08)  VALUE +58            05880000
058900                                             COMP.                05890000
059000         10  FILLER              PIC  X(12)  VALUE 'SESSIONERR'.  05900000
059100         10  FILLER              PIC S9(08)  VALUE +59            05910000
059200                                             COMP.                05920000
059300         10  FILLER              PIC  X(12)  VALUE 'SYSBUSY'.     05930000
059400         10  FILLER              PIC S9(08)  VALUE +60            05940000
059500                                             COMP.                05950000
059600         10  FILLER              PIC  X(12)  VALUE 'SESSBUSY'.    05960000
059700         10  FILLER              PIC S9(08)  VALUE +61            05970000
059800                                             COMP.                05980000
059900         10  FILLER              PIC  X(12)  VALUE 'NOTALLOC'.    05990000
060000         10  FILLER              PIC S9(08)  VALUE +62            06000000
060100                                             COMP.                06010000
060200         10  FILLER              PIC  X(12)  VALUE 'CBIDERR'.     06020000
060300         10  FILLER              PIC S9(08)  VALUE +64            06030000
060400                                             COMP.                06040000
060500         10  FILLER              PIC  X(12)  VALUE 'INVPARTNSET '.06050000
060600         10  FILLER              PIC S9(08)  VALUE +65            06060000
060700                                             COMP.                06070000
060800         10  FILLER              PIC  X(12)  VALUE 'INVPARTN    '.06080000
060900         10  FILLER              PIC S9(08)  VALUE +66            06090000
061000                                             COMP.                06100000
061100         10  FILLER              PIC  X(12)  VALUE 'PARTNFAIL   '.06110000
061200         10  FILLER              PIC S9(08)  VALUE +70            06120000
061300                                             COMP.                06130000
061400         10  FILLER              PIC  X(12)  VALUE 'NOTAUTH'.     06140000
061500         10  FILLER              PIC S9(08)  VALUE +80            06150000
061600                                             COMP.                06160000
061700         10  FILLER              PIC  X(12)  VALUE 'NOSPOOL'.     06170000
061800         10  FILLER              PIC S9(08)  VALUE +81            06180000
061900                                             COMP.                06190000
062000         10  FILLER              PIC  X(12)  VALUE 'TERMERR'.     06200000
062100         10  FILLER              PIC S9(08)  VALUE +82            06210000
062200                                             COMP.                06220000
062300         10  FILLER              PIC  X(12)  VALUE 'ROLLEDBACK  '.06230000
062400         10  FILLER              PIC S9(08)  VALUE +83            06240000
062500                                             COMP.                06250000
062600         10  FILLER              PIC  X(12)  VALUE 'END'.         06260000
062700         10  FILLER              PIC S9(08)  VALUE +84            06270000
062800                                             COMP.                06280000
062900         10  FILLER              PIC  X(12)  VALUE 'DISABLED    '.06290000
063000         10  FILLER              PIC S9(08)  VALUE +85            06300000
063100                                             COMP.                06310000
063200         10  FILLER              PIC  X(12)  VALUE 'ALLOCERR    '.06320000
063300         10  FILLER              PIC S9(08)  VALUE +86            06330000
063400                                             COMP.                06340000
063500         10  FILLER              PIC  X(12)  VALUE 'STRELERR    '.06350000
063600         10  FILLER              PIC S9(08)  VALUE +87            06360000
063700                                             COMP.                06370000
063800         10  FILLER              PIC  X(12)  VALUE 'OPENERR'.     06380000
063900         10  FILLER              PIC S9(08)  VALUE +88            06390000
064000                                             COMP.                06400000
064100         10  FILLER              PIC  X(12)  VALUE 'SPOLBUSY    '.06410000
064200         10  FILLER              PIC S9(08)  VALUE +89            06420000
064300                                             COMP.                06430000
064400         10  FILLER              PIC  X(12)  VALUE 'SPOLERR'.     06440000
064500         10  FILLER              PIC S9(08)  VALUE +90            06450000
064600                                             COMP.                06460000
064700         10  FILLER              PIC  X(12)  VALUE 'NODEIDER    '.06470000
064800     05  EC-EIBRESP-ENTRY        REDEFINES EC-EIBRESP-ENTRIES     06480000
064900                                 OCCURS 77 TIMES                  06490000
065000                                 ASCENDING KEY EC-EIBRESP         06500000
065100                                 INDEXED BY EC-RESP-IDX.          06510000
065200         10  EC-EIBRESP          PIC S9(08)  COMP.                06520000
065300         10  EC-CONDITION-NAME   PIC  X(12).                      06530000
065400*                                                                 06540000
065500*                                                                 06550000
065600     EXEC SQL                                                     06560000
065700          INCLUDE TCOCNTL                                         06570000
065800     END-EXEC.                                                    06580000
065900                                                                  06590000
066000* COMMUNICATIONS AREA FOR DB2                                     06600000
066100     EXEC SQL                                                     06610000
066200         INCLUDE SQLCA                                            06620000
066300     END-EXEC.                                                    06630000
066400*                                                                 06640000
066500******************************************************************06650000
066600 LINKAGE SECTION.                                                 06660000
066700******************************************************************06670000
066800 01  DFHCOMMAREA.                                                 06680000
066900     05  FILLER                         OCCURS  1 TO 4072 TIMES   06690000
067000                                        DEPENDING ON EIBCALEN.    06700000
067100         10  FILLER                     PIC X.                    06710000
067200                                                                  06720000
067300******************************************************************06730000
067400 PROCEDURE DIVISION.                                              06740000
067500******************************************************************06750000
067600 0000-PROGRAM-MAINLINE.                                           06760000
067700     MOVE DFHCOMMAREA                TO CA-COMMAREA.              06770000
067800     MOVE LOW-VALUES                 TO PC852AI.                  06780000
067900     MOVE PC034-PRESS-ENTER-MSG      TO AMSG8O                    06790000
068000                                                                  06800000
068100     EVALUATE TRUE                                                06810000
068200         WHEN PC033-XCTL                                          06820000
068300             PERFORM 2200-XCTL-TO-MAIN-MENU                       06830000
068400                                                                  06840000
068500         WHEN PC033-ABEND                                         06850000
068600             PERFORM 3000-ABEND-SCREEN                            06860000
068700             PERFORM 3500-LOG-ABEND-INFO                          06870000
068800             MOVE 7                   TO PC033-PGM-MSG-NBR        06880000
068900             MOVE PC033-TRAN-ID       TO PC035-ERROR-TRANID       06890000
069000             MOVE PC033-ERROR-NBR     TO PC035-ERROR-NBR          06900000
069100             PERFORM 1000-SETUP-SCREEN                            06910000
069200                                                                  06920000
069300             PERFORM 8400-ROLLBACK                                06930000
069400             SET PC033-XCTL           TO TRUE                     06940000
069500             PERFORM 8000-SEND-MAP                                06950000
069600             PERFORM 8200-RETURN-TRANID                           06960000
069700                                                                  06970000
069800         WHEN EIBCALEN = ZERO                                     06980000
069900         WHEN EIBAID = DFHCLEAR                                   06990000
070000         WHEN PC033-INITIALIZE-SCREEN                             07000000
070100         WHEN PC033-WAIT-FOR-CONFIRM                              07010000
070200             SET PC033-PROCESS-SCREEN  TO  TRUE                   07020000
070300             PERFORM 1000-SETUP-SCREEN                            07030000
070400                                                                  07040000
070500             PERFORM 8000-SEND-MAP                                07050000
070600             PERFORM 8200-RETURN-TRANID                           07060000
070700                                                                  07070000
070800         WHEN EIBTRNID = 'Z278'                                   07080000
070900*        GENERIC HELP SCREEN                                      07090000
071000             MOVE DFHCOMMAREA          TO PC192-COMMAREA          07100000
071100             MOVE PC192-HOST-SAVE-AREA TO CA-COMMAREA             07110000
071200             MOVE PC192-HOST-SAVE-MAP  TO PC852AO                 07120000
071300             SET PC033-PROCESS-SCREEN  TO  TRUE                   07130000
071400             PERFORM 8000-SEND-MAP                                07140000
071500             PERFORM 8200-RETURN-TRANID                           07150000
071600                                                                  07160000
071700         WHEN EIBAID = DFHPF2                                     07170000
071800*LMM BEG                                                          07180000
071900             IF PC033-LAST-PROGRAM = PC-BARCODE-ENTRY-PGM         07190000
072000                SET PC033-INITIALIZE-SCREEN                       07200000
072100                                         TO TRUE                  07210000
072200                SET PC033-F2-KEY         TO TRUE                  07220000
072300                MOVE PC033-LAST-PROGRAM  TO PC033-ROOT-PROGRAM    07230000
072400                MOVE PC-CURRENT-PROGRAM-NAME TO                   07240000
072500                                            PC033-LAST-PROGRAM    07250000
072600                PERFORM 2400-XCTL-TO-ROOT-SCREEN                  07260000
072700*LMM END                                                          07270000
072800             ELSE                                                 07280000
072900                SET PC033-INITIALIZE-SCREEN                       07290000
073000                                         TO TRUE                  07300000
073100                PERFORM 2100-XCTL-TO-SELECTED-PROGRAM             07310000
073200             END-IF                                               07320000
073300                                                                  07330000
073400         WHEN EIBAID = DFHPF3                                     07340000
073500*LMM BEG                                                          07350000
073600             IF PC033-LAST-PROGRAM = PC-MASTER-CONTAINER-PGM OR   07360000
073700                                     PC-BARCODE-ENTRY-PGM OR      07370000
073800                                     PC-ADDL-SML-PGM              07380000
073900                MOVE PC033-LAST-PROGRAM TO PC033-ROOT-PROGRAM     07390000
074000                IF PC033-LAST-PROGRAM = PC-ADDL-SML-PGM           07400000
074100                    SET PC033-INITIALIZE-SCREEN                   07410000
074200                                            TO TRUE               07420000
074300                END-IF                                            07430000
074400                PERFORM 2400-XCTL-TO-ROOT-SCREEN                  07440000
074500             ELSE                                                 07450000
074600                SET PC033-INITIALIZE-SCREEN                       07460000
074700                                        TO TRUE                   07470000
074800                PERFORM 2400-XCTL-TO-ROOT-SCREEN                  07480000
074900             END-IF                                               07490000
075000*LMM END                                                          07500000
075100                                                                  07510000
075200*LMM BEG                                                          07520000
075300         WHEN EIBAID = DFHPF4                                     07530000
075400            EVALUATE TRUE                                         07540000
075500               WHEN PC033-LAST-PROGRAM = PC-BARCODE-ENTRY-PGM     07550000
075600                   SET PC033-INITIALIZE-SCREEN                    07560000
075700                                            TO TRUE               07570000
075800                   SET PC033-F4-KEY         TO TRUE               07580000
075900                   MOVE PC033-LAST-PROGRAM  TO PC033-ROOT-PROGRAM 07590000
076000                   MOVE PC-CURRENT-PROGRAM-NAME TO                07600000
076100                                               PC033-LAST-PROGRAM 07610000
076200                   PERFORM 2400-XCTL-TO-ROOT-SCREEN               07620000
076300                                                                  07630000
076400               WHEN PC033-LAST-PROGRAM = PC-MASTER-CONTAINER-PGM  07640000
076500                   SET PC033-INITIALIZE-SCREEN                    07650000
076600                                            TO TRUE               07660000
076700                   SET PC033-F4-KEY         TO TRUE               07670000
076800                   MOVE PC033-LAST-PROGRAM  TO PC033-ROOT-PROGRAM 07680000
076900                   MOVE PC-CURRENT-PROGRAM-NAME TO                07690000
077000                                               PC033-LAST-PROGRAM 07700000
077100                   PERFORM 2400-XCTL-TO-ROOT-SCREEN               07710000
077200                                                                  07720000
077300               WHEN OTHER                                         07730000
077400                   SET PC033-INITIALIZE-SCREEN                    07740000
077500                                            TO TRUE               07750000
077600                   PERFORM 2400-XCTL-TO-ROOT-SCREEN               07760000
077700            END-EVALUATE                                          07770000
077800*LMM END                                                          07780000
077900         WHEN EIBAID = DFHPF6                                     07790000
078000             SET PC033-INITIALIZE-SCREEN                          07800000
078100                 PC033-SINGLE-ENTRY   TO TRUE                     07810000
078200             PERFORM 2300-XCTL-TO-NEXT-SCREEN                     07820000
078300                                                                  07830000
078400         WHEN EIBAID = DFHPF7                                     07840000
078500             SET PC033-INITIALIZE-SCREEN                          07850000
078600                 PC033-MULTIPLE-ENTRY TO TRUE                     07860000
078700             PERFORM 2300-XCTL-TO-NEXT-SCREEN                     07870000
078800                                                                  07880000
078900         WHEN EIBAID = DFHENTER                                   07890000
079000*        THESE MESSAGES REQUIRE WE BYPASS ANY UPDATES IN THE      07900000
079100*        CALLING PROGRAM                                          07910000
079200             IF PC033-LABEL-NOT-FOUND OR PC033-PGM-MSG-NBR =      07920000
079300             8 OR 20 OR 22 OR 24 OR 25 OR 28 OR 29 OR 31          07930000
079400                 CONTINUE                                         07940000
079500             ELSE                                                 07950000
079600                 SET PC033-UPDATE-CONFIRMED                       07960000
079700                                      TO  TRUE                    07970000
079800             END-IF                                               07980000
079900*LMM BEG                                                          07990000
080000             IF PC033-LAST-PROGRAM = PC-MASTER-CONTAINER-PGM      08000000
080100                OR PC-BARCODE-ENTRY-PGM                           08010000
080200                MOVE PC-CURRENT-PROGRAM-NAME TO                   08020000
080300                     PC033-ROOT-PROGRAM                           08030000
080400             END-IF                                               08040000
080500*LMM END                                                          08050000
080600             IF PC033-PGM-MSG-NBR = 4 OR 1                        08060000
080700*                SOFT ABORT LOGIC                                 08070000
080800                 SET PC033-INITIALIZE-SCREEN                      08080000
080900                                      TO TRUE                     08090000
081000             END-IF                                               08100000
081100             IF PC033-PGM-MSG-NBR = 8                             08110000
081200*                ENTRY MODE PASS-THRU                             08120000
081300                 CONTINUE                                         08130000
081400             END-IF                                               08140000
081500             IF PC033-PGM-MSG-NBR = 27 OR 29 OR 30                08150000
081600*                MASTER CARTON ERROR FROM PCKRF730 AND PCKRF738   08160000
081700                 SET PC033-INITIALIZE-SCREEN                      08170000
081800                                      TO TRUE                     08180000
081900             END-IF                                               08190000
082000                                                                  08200000
082100             IF PC033-PGM-MSG-NBR = 8                             08210000
082200*        THE ONLY VALID KEYS FOR THE PASS-THRU FUNCTION ARE       08220000
082300*        F6 AND F7                                                08230000
082400                 MOVE '    F3 = RETURN    '                       08240000
082500                                      TO AMSG8O                   08250000
082600                 CONTINUE                                         08260000
082700             ELSE                                                 08270000
082800                 PERFORM 2100-XCTL-TO-SELECTED-PROGRAM            08280000
082900             END-IF                                               08290000
083000                                                                  08300000
083100         WHEN EIBAID = DFHPF1                                     08310000
083200             MOVE PC033-PGM-MSG-NBR   TO PV-TEXT-MSG-NBR          08320000
083300             MOVE PC033-LAST-PROGRAM  TO PV-TEXT-LAST-PGM         08330000
083400             MOVE PC033-ROOT-PROGRAM  TO PV-TEXT-ROOT-PGM         08340000
083500             MOVE PC033-MENU-PROGRAM  TO PV-TEXT-MENU-PGM         08350000
083600             MOVE PC033-NEXT-PROGRAM  TO PV-NEXT-MENU-PGM         08360000
083700             MOVE PC-NEW-LINE         TO PV-NEW-LINE-1            08370000
083800                                         PV-NEW-LINE-2            08380000
083900                                         PV-NEW-LINE-3            08390000
084000                                         PV-NEW-LINE-4            08400000
084100                                         PV-NEW-LINE-5            08410000
084200                                         PV-NEW-LINE-6            08420000
084300                                         PV-NEW-LINE-7            08430000
084400             PERFORM 8030-SEND-TEXT                               08440000
084500             PERFORM 8200-RETURN-TRANID                           08450000
084600                                                                  08460000
084700         WHEN OTHER                                               08470000
084800              PERFORM 8020-RECEIVE-MAP                            08480000
084900             MOVE PC034-UNRECOGNIZED-PF-KEY-MSG                   08490000
085000                                      TO AMSG8O                   08500000
085100     END-EVALUATE.                                                08510000
085200                                                                  08520000
085300     PERFORM 8100-SEND-DATA-ONLY.                                 08530000
085400     PERFORM 8200-RETURN-TRANID.                                  08540000
085500                                                                  08550000
085600     GOBACK.                                                      08560000
085700****************************************************************  08570000
085800* 1000-SETUP-SCREEN                                               08580000
085900*    INITIAL SETUP OF AUDIT NUMBER AND STATUS                     08590000
086000****************************************************************  08600000
086100 1000-SETUP-SCREEN.                                               08610000
086200                                                                  08620000
086300*    MOVE APPROPRIATE MESSAGE TO THE SCREEN                       08630000
086400     SET PC035-IDX                    TO PC033-PGM-MSG-NBR.       08640000
086500     MOVE PC033-PO-NBR                TO PC035-PO-NBR             08650000
086600     MOVE PC033-RCVR-SEQ-NBR          TO PC035-RCVR-SEQ-NBR       08660000
086700     MOVE PC033-CARTON                TO PC035-CARTON             08670000
086800                                         PC035-CARTON-27          08680000
086900                                         PC035-CARTON-29          08690000
087000                                         PC035-CARTON-30          08700000
087100                                         PC035-CARTON-XFER        08710000
087200                                         PC035-BARCODE            08720000
087210                                         PC035-MSG34-BARCODE      08721019
087300*LMM BEG                                                          08730000
087400     MOVE PC033-OWNER-SCAC-ID         TO PC035-OWNER-SCAC-ID1     08740000
087500                                         PC035-OWNER-SCAC-ID2     08750000
087600     MOVE PC033-VEH-NBR               TO PC035-VEH-NBR1           08760000
087700                                         PC035-VEH-NBR2           08770000
087800*LMM END                                                          08780000
087900                                                                  08790000
088000*    MOVE PC033-SQLCODE               TO PC035-SQLCODE            08800000
088100*    MOVE PC033-PARAGRAPH             TO PC035-PARAGRAPH          08810000
088200*    MOVE PC033-LAST-PROGRAM          TO PC035-PROGRAM            08820000
088300                                                                  08830000
088400                                                                  08840000
088500     EVALUATE TRUE                                                08850000
088600     WHEN PC033-MULTI-LINE                                        08860000
088700         MOVE 'MULT'                  TO PC035-PO-LINE-NBR-X      08870000
088800     WHEN PC033-NO-LINE                                           08880000
088900         MOVE 'NOLN'                  TO PC035-PO-LINE-NBR-X      08890000
089000     WHEN OTHER                                                   08900000
089100         MOVE PC033-PO-LINE-NBR       TO PC035-PO-LINE-NBR        08910000
089200     END-EVALUATE                                                 08920000
089300                                                                  08930000
089400     MOVE PC033-STR-NBR               TO PC035-STR-NBR            08940000
089500* PK HAZMAT BEGIN                                                 08950000
089600     MOVE PC033-MESSAGE-TEXT(1)       TO PC035-HAZ-ALERT          08960000
089700* PK HAZMAT END                                                   08970000
089800                                                                  08980000
089900     MOVE PC035-LINE-1 (PC035-IDX)    TO AMSG1O.                  08990000
090000     MOVE PC035-LINE-2 (PC035-IDX)    TO AMSG2O.                  09000000
090100     MOVE PC035-LINE-3 (PC035-IDX)    TO AMSG3O.                  09010000
090200     MOVE PC035-LINE-4 (PC035-IDX)    TO AMSG4O.                  09020000
090300     MOVE PC035-LINE-5 (PC035-IDX)    TO AMSG5O.                  09030000
090400     MOVE PC035-LINE-6 (PC035-IDX)    TO AMSG6O.                  09040000
090500     MOVE PC035-LINE-7 (PC035-IDX)    TO AMSG7O.                  09050000
090600     MOVE PC035-LINE-8 (PC035-IDX)    TO AMSG8O.                  09060000
090700                                                                  09070000
090800 1200-HELP-SCREEN.                                                09080000
090900     MOVE 'DPKRF278'                  TO PV-TRANSFER-PROGRAM      09090000
091000     MOVE 'PCKRF852'                  TO PC192-PROGRAM-NAME       09100000
091100     COPY PCPD188.                                                09110000
091200     MOVE PC188-DISPLAY-DATE          TO PC192-DISPLAY-DATE.      09120000
091300     MOVE CA-COMMAREA                 TO PC192-HOST-SAVE-AREA     09130000
091400     PERFORM 8300-XCTL-TO-HELP.                                   09140000
091500                                                                  09150000
091600 2100-XCTL-TO-SELECTED-PROGRAM.                                   09160000
091700                                                                  09170000
091800     MOVE LENGTH OF CA-COMMAREA       TO PV-COMMAREA-LENGTH.      09180000
091900                                                                  09190000
092000     EXEC CICS                                                    09200000
092100         XCTL                                                     09210000
092200             PROGRAM   (PC033-LAST-PROGRAM)                       09220000
092300             COMMAREA  (CA-COMMAREA)                              09230000
092400             LENGTH    (PV-COMMAREA-LENGTH)                       09240000
092500             RESP      (PV-CICS-RESPONSE)                         09250000
092600     END-EXEC.                                                    09260000
092700                                                                  09270000
092800     EVALUATE TRUE                                                09280000
092900         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 09290000
093000              CONTINUE                                            09300000
093100         WHEN OTHER                                               09310000
093200              MOVE '2100-XCTL-TO-SELECTED-PROGRAM'                09320000
093300                                      TO DP013-PARAGRAPH          09330000
093400              MOVE 'UNABLE TO XCTL THE FOLLOWING PROGRAM: '       09340000
093500                                      TO DP013-MESSAGE-TEXT (1)   09350000
093600              MOVE PC033-LAST-PROGRAM TO DP013-MESSAGE-TEXT (2)   09360000
093700              SET DP013-CICS-ABEND    TO TRUE                     09370000
093800              SET DP013-NO-ROLLBACK   TO TRUE                     09380000
093900              PERFORM 9999-WRITE-CICS-LOG-MSG                     09390000
094000              MOVE PC034-TRANS-NOT-AVAILABLE-MSG                  09400000
094100                                      TO AMSG8O                   09410000
094200              SET PC033-PROCESS-SCREEN TO TRUE                    09420000
094300              PERFORM 8100-SEND-DATA-ONLY                         09430000
094400              PERFORM 8200-RETURN-TRANID                          09440000
094500     END-EVALUATE.                                                09450000
094600                                                                  09460000
094700 2200-XCTL-TO-MAIN-MENU.                                          09470000
094800                                                                  09480000
094900     EXEC CICS                                                    09490000
095000         XCTL                                                     09500000
095100             PROGRAM   ('MPKCS027')                               09510000
095200             RESP      (PV-CICS-RESPONSE)                         09520000
095300     END-EXEC.                                                    09530000
095400                                                                  09540000
095500     EVALUATE TRUE                                                09550000
095600         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 09560000
095700              CONTINUE                                            09570000
095800         WHEN OTHER                                               09580000
095900              MOVE '2200-XCTL-TO-MAIN-MENU'                       09590000
096000                                      TO DP013-PARAGRAPH          09600000
096100              MOVE 'UNABLE TO XCTL THE FOLLOWING PROGRAM: '       09610000
096200                                      TO DP013-MESSAGE-TEXT (1)   09620000
096300              MOVE 'MPKCS027'         TO DP013-MESSAGE-TEXT (2)   09630000
096400              SET DP013-CICS-ABEND    TO TRUE                     09640000
096500              SET DP013-NO-ROLLBACK   TO TRUE                     09650000
096600              PERFORM 9999-WRITE-CICS-LOG-MSG                     09660000
096700              MOVE PC034-TRANS-NOT-AVAILABLE-MSG                  09670000
096800                                      TO AMSG8O                   09680000
096900              SET PC033-PROCESS-SCREEN TO TRUE                    09690000
097000              PERFORM 8100-SEND-DATA-ONLY                         09700000
097100              PERFORM 8200-RETURN-TRANID                          09710000
097200     END-EVALUATE.                                                09720000
097300                                                                  09730000
097400 2300-XCTL-TO-NEXT-SCREEN.                                        09740000
097500                                                                  09750000
097600     MOVE LENGTH OF CA-COMMAREA       TO PV-COMMAREA-LENGTH.      09760000
097700     MOVE 'PCKRF852'                  TO PC033-LAST-PROGRAM       09770000
097800                                                                  09780000
097900     EXEC CICS                                                    09790000
098000         XCTL                                                     09800000
098100             PROGRAM   (PC033-NEXT-PROGRAM)                       09810000
098200             COMMAREA  (CA-COMMAREA)                              09820000
098300             LENGTH    (PV-COMMAREA-LENGTH)                       09830000
098400             RESP      (PV-CICS-RESPONSE)                         09840000
098500     END-EXEC.                                                    09850000
098600                                                                  09860000
098700     EVALUATE TRUE                                                09870000
098800         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 09880000
098900              CONTINUE                                            09890000
099000         WHEN OTHER                                               09900000
099100              MOVE '2300-XCTL-TO-NEXT-SCREEN'                     09910000
099200                                      TO DP013-PARAGRAPH          09920000
099300              MOVE 'UNABLE TO XCTL THE FOLLOWING PROGRAM: '       09930000
099400                                      TO DP013-MESSAGE-TEXT (1)   09940000
099500              MOVE PC033-NEXT-PROGRAM TO DP013-MESSAGE-TEXT (2)   09950000
099600              SET DP013-CICS-ABEND    TO TRUE                     09960000
099700              SET DP013-NO-ROLLBACK   TO TRUE                     09970000
099800              PERFORM 9999-WRITE-CICS-LOG-MSG                     09980000
099900              MOVE PC034-TRANS-NOT-AVAILABLE-MSG                  09990000
100000                                      TO AMSG8O                   10000000
100100              SET PC033-PROCESS-SCREEN TO TRUE                    10010000
100200              PERFORM 8100-SEND-DATA-ONLY                         10020000
100300              PERFORM 8200-RETURN-TRANID                          10030000
100400     END-EVALUATE.                                                10040000
100500                                                                  10050000
100600 2400-XCTL-TO-ROOT-SCREEN.                                        10060000
100700                                                                  10070000
100800     MOVE LENGTH OF CA-COMMAREA       TO PV-COMMAREA-LENGTH.      10080000
100900                                                                  10090000
101000     EXEC CICS                                                    10100000
101100         XCTL                                                     10110000
101200             PROGRAM   (PC033-ROOT-PROGRAM)                       10120000
101300             COMMAREA  (CA-COMMAREA)                              10130000
101400             LENGTH    (PV-COMMAREA-LENGTH)                       10140000
101500             RESP      (PV-CICS-RESPONSE)                         10150000
101600     END-EXEC.                                                    10160000
101700                                                                  10170000
101800     EVALUATE TRUE                                                10180000
101900         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 10190000
102000              CONTINUE                                            10200000
102100         WHEN OTHER                                               10210000
102200              MOVE '2400-XCTL-TO-ROOT-SCREEN'                     10220000
102300                                      TO DP013-PARAGRAPH          10230000
102400              MOVE 'UNABLE TO XCTL THE FOLLOWING PROGRAM: '       10240000
102500                                      TO DP013-MESSAGE-TEXT (1)   10250000
102600              MOVE PC033-ROOT-PROGRAM TO DP013-MESSAGE-TEXT (2)   10260000
102700              SET DP013-CICS-ABEND    TO TRUE                     10270000
102800              SET DP013-NO-ROLLBACK   TO TRUE                     10280000
102900              PERFORM 9999-WRITE-CICS-LOG-MSG                     10290000
103000              MOVE PC034-TRANS-NOT-AVAILABLE-MSG                  10300000
103100                                      TO AMSG8O                   10310000
103200              SET PC033-PROCESS-SCREEN TO TRUE                    10320000
103300              PERFORM 8100-SEND-DATA-ONLY                         10330000
103400              PERFORM 8200-RETURN-TRANID                          10340000
103500     END-EVALUATE.                                                10350000
103600/                                                                 10360000
103700 3000-ABEND-SCREEN.                                               10370000
103800     PERFORM 3100-FORMAT-ABEND-INFO.                              10380000
103900                                                                  10390000
104000 3100-FORMAT-ABEND-INFO.                                          10400000
104100     INITIALIZE LT-LOG-LINE-TABLE.                                10410000
104200     MOVE EIBTRMID TO PV-LOG-TERMINAL.                            10420000
104300                                                                  10430000
104400     SET LT-IDX TO 1.                                             10440000
104500     PERFORM 3200-FORMAT-DB2.                                     10450000
104600                                                                  10460000
104700     MOVE PC033-DFHEIBLK           TO EIBM-EIBLK-MASK.            10470000
104800     PERFORM 3300-FORMAT-EIB.                                     10480000
104900*                                                                 10490000
105000 3200-FORMAT-DB2.                                                 10500000
105100     MOVE DL1-DB2-LINE-1      TO LT-ERROR-MESSAGE (LT-IDX).       10510000
105200     PERFORM 3210-FORMAT-COMMON-INFO.                             10520000
105300*                                                                 10530000
105400     PERFORM 5110-SET-LINE-INDEX.                                 10540000
105500     MOVE DL2-DB2-LINE-2      TO LT-ERROR-MESSAGE (LT-IDX).       10550000
105600     PERFORM 5110-SET-LINE-INDEX.                                 10560000
105700     STRING  PC033-DB2-TABLE-NAME (1) DELIMITED BY SPACE          10570000
105800             SPACE                    DELIMITED BY SIZE           10580000
105900             PC033-DB2-TABLE-NAME (2) DELIMITED BY SPACE          10590000
106000             SPACE                    DELIMITED BY SIZE           10600000
106100             PC033-DB2-TABLE-NAME (3) DELIMITED BY SPACE          10610000
106200             SPACE                    DELIMITED BY SIZE           10620000
106300             PC033-DB2-TABLE-NAME (4) DELIMITED BY SPACE          10630000
106400     INTO    LT-ERROR-MESSAGE (LT-IDX)                            10640000
106500     POINTER PV-STRING-POINTER.                                   10650000
106600*                                                                 10660000
106700     IF  PV-STRING-POINTER > PC-STRING-POINTER-MAX                10670000
106800         IF  PC033-DB2-TABLE-NAME (5) > SPACE                     10680000
106900             PERFORM 5110-SET-LINE-INDEX                          10690000
107000             MOVE PC033-DB2-TABLE-NAME (5)                        10700000
107100                              TO LT-ERROR-MESSAGE (LT-IDX)        10710000
107200         END-IF                                                   10720000
107300     ELSE                                                         10730000
107400         STRING  SPACE                    DELIMITED BY SIZE       10740000
107500                 PC033-DB2-TABLE-NAME (5) DELIMITED BY SPACE      10750000
107600         INTO    LT-ERROR-MESSAGE (LT-IDX)                        10760000
107700         POINTER PV-STRING-POINTER                                10770000
107800     END-IF.                                                      10780000
107900     PERFORM 3210-FORMAT-SQLCA.                                   10790000
108000*                                                                 10800000
108100*                                                                 10810000
108200 3210-FORMAT-SQLCA.                                               10820000
108300*                                                                 10830000
108400**   DISPLAY SQLCA INFORMATION IN A READABLE FORMAT               10840000
108500*                                                                 10850000
108600     CALL 'DSNTIAR' USING PC033-SQLCA                             10860000
108700                          FDB-FORMATTED-MESSAGE                   10870000
108800                          FDB-ERROR-LINE-LENGTH.                  10880000
108900*                                                                 10890000
109000     PERFORM                                                      10900000
109100         VARYING FDB-MSG-IDX                                      10910000
109200         FROM 1 BY 1                                              10920000
109300         UNTIL FDB-MSG-IDX > FDB-MAX-MESSAGE-LINES                10930000
109400             IF  FDB-MESSAGE-LINE (FDB-MSG-IDX) > SPACE           10940000
109500                 PERFORM 5110-SET-LINE-INDEX                      10950000
109600                 MOVE FDB-MESSAGE-LINE (FDB-MSG-IDX)              10960000
109700                                 TO LT-ERROR-MESSAGE (LT-IDX)     10970000
109800             END-IF                                               10980000
109900     END-PERFORM.                                                 10990000
110000*                                                                 11000000
110100 3210-FORMAT-COMMON-INFO.                                         11010000
110200     MOVE PC033-LAST-PROGRAM      TO AL1-PROGRAM.                 11020000
110300     MOVE PC033-PARAGRAPH         TO AL1-PARAGRAPH.               11030000
110400     SET LT-IDX UP BY 1.                                          11040000
110500     MOVE AL1-ABEND-LINE-1        TO LT-ERROR-MESSAGE (LT-IDX).   11050000
110600*                                                                 11060000
110700** EIBTRMID WILL BE LOW-VALUES FOR NON-TERMINALLY ATTACHED        11070000
110800** APPLICATIONS  SO DON'T TRY TO READ THE 'INFO' TS QUEUE.        11080000
110900*                                                                 11090000
111000     IF  EIBTRMID > SPACE                                         11100000
111100         PERFORM 3211-GET-USER-FROM-TS                            11110000
111200         MOVE DP026-USERID        TO AL2-USERID                   11120000
111300         MOVE DP026-NETNAME       TO AL2-NETNAME                  11130000
111400         MOVE DP026-LOCATION-NBR  TO AL2-LOCATION                 11140000
111500         SET LT-IDX UP BY 1                                       11150000
111600         MOVE AL2-ABEND-LINE-2    TO LT-ERROR-MESSAGE (LT-IDX)    11160000
111700     END-IF.                                                      11170000
111800*                                                                 11180000
111900     MOVE 'D'                     TO AL3-ABEND-TYPE.              11190000
112000     MOVE SPACE                   TO AL3-ABEND-CONTROL.           11200000
112100     MOVE SPACE                   TO AL3-ROLLBACK.                11210000
112200     SET LT-IDX UP BY 1.                                          11220000
112300     MOVE AL3-ABEND-LINE-3        TO LT-ERROR-MESSAGE (LT-IDX).   11230000
112400*                                                                 11240000
112500     IF  PC033-MESSAGE-TABLE = SPACE                              11250000
112600         CONTINUE                                                 11260000
112700     ELSE                                                         11270000
112800         SET LT-IDX UP BY 1                                       11280000
112900         MOVE AL4-ABEND-LINE-4    TO LT-ERROR-MESSAGE (LT-IDX)    11290000
113000         PERFORM                                                  11300000
113100             VARYING PV-MSG-SUB                                   11310000
113200             FROM 1 BY 1                                          11320000
113300             UNTIL PV-MSG-SUB > 4                                 11330000
113400                 IF  PC033-MESSAGE-TEXT (PV-MSG-SUB) > SPACE      11340000
113500                     SET LT-IDX UP BY 1                           11350000
113600                     MOVE PC033-MESSAGE-TEXT (PV-MSG-SUB)         11360000
113700                              TO LT-ERROR-MESSAGE (LT-IDX)        11370000
113800                 END-IF                                           11380000
113900         END-PERFORM                                              11390000
114000     END-IF.                                                      11400000
114100*                                                                 11410000
114200*                                                                 11420000
114300 3211-GET-USER-FROM-TS.                                           11430000
114400     MOVE EIBTRMID             TO TS-INFO-QUEUE-TERMINAL.         11440000
114500     MOVE SPACE                TO PV-SYSID.                       11450000
114600     EXEC CICS                                                    11460000
114700         INQUIRE                                                  11470000
114800             TRANSACTION  (PC-LOGON-TRAN)                         11480000
114900             REMOTESYSTEM (PV-SYSID)                              11490000
115000     END-EXEC.                                                    11500000
115100*                                                                 11510000
115200     IF  PV-SYSID = SPACE                                         11520000
115300         EXEC CICS                                                11530000
115400             READQ TS                                             11540000
115500                 QUEUE (TS-INFO-QUEUE-NAME)                       11550000
115600                 INTO  (DP026-SIGN-ON-INFO)                       11560000
115700                 ITEM  (PV-TS-ITEM)                               11570000
115800                 RESP  (PV-CICS-RESPONSE)                         11580000
115900         END-EXEC                                                 11590000
116000     ELSE                                                         11600000
116100         EXEC CICS                                                11610000
116200             READQ TS                                             11620000
116300                 QUEUE (TS-INFO-QUEUE-NAME)                       11630000
116400                 INTO  (DP026-SIGN-ON-INFO)                       11640000
116500                 ITEM  (PV-TS-ITEM)                               11650000
116600                 SYSID (PV-SYSID)                                 11660000
116700                 LENGTH(LENGTH OF DP026-SIGN-ON-INFO)             11670000
116800                 RESP  (PV-CICS-RESPONSE)                         11680000
116900         END-EXEC                                                 11690000
117000     END-IF.                                                      11700000
117100*                                                                 11710000
117200     IF  PV-CICS-RESPONSE = DFHRESP(NORMAL)                       11720000
117300         CONTINUE                                                 11730000
117400     ELSE                                                         11740000
117500         MOVE ALL '?'   TO DP026-USERID                           11750000
117600                           DP026-NETNAME                          11760000
117700         MOVE 9999      TO DP026-LOCATION-NBR                     11770000
117800     END-IF.                                                      11780000
117900*                                                                 11790000
118000*                                                                 11800000
118100 3300-FORMAT-EIB.                                                 11810000
118200     PERFORM 5110-SET-LINE-INDEX.                                 11820000
118300     MOVE EL1-EIB-LINE-1  TO LT-ERROR-MESSAGE (LT-IDX).           11830000
118400*                                                                 11840000
118500     MOVE EIBM-TIME       TO EL2-EIBTIME.                         11850000
118600     MOVE EIBM-DATE       TO EL2-EIBDATE.                         11860000
118700     PERFORM 5110-SET-LINE-INDEX.                                 11870000
118800     MOVE EL2-EIB-LINE-2  TO LT-ERROR-MESSAGE (LT-IDX).           11880000
118900*                                                                 11890000
119000     MOVE EIBM-TRNID      TO EL3-EIBTRNID.                        11900000
119100     MOVE EIBM-TASKN      TO EL3-EIBTASKN.                        11910000
119200     PERFORM 5110-SET-LINE-INDEX.                                 11920000
119300     MOVE EL3-EIB-LINE-3  TO LT-ERROR-MESSAGE (LT-IDX).           11930000
119400*                                                                 11940000
119500     MOVE EIBM-TRMID      TO EL4-EIBTRMID.                        11950000
119600     MOVE EIBM-CPOSN      TO EL4-EIBCPOSN.                        11960000
119700     PERFORM 5110-SET-LINE-INDEX.                                 11970000
119800     MOVE EL4-EIB-LINE-4  TO LT-ERROR-MESSAGE (LT-IDX).           11980000
119900*                                                                 11990000
120000     MOVE EIBM-CALEN      TO EL5-EIBCALEN.                        12000000
120100     MOVE EIBM-AID        TO EL5-EIBAID.                          12010000
120200     SET AC-AID-IDX TO 1.                                         12020000
120300     SEARCH AC-ATTENTION-ID-ENTRY                                 12030000
120400         AT END                                                   12040000
120500             MOVE ALL '?'            TO EL5-EIBAID-DESCRIPTION    12050000
120600         WHEN AC-EIBAID (AC-AID-IDX) = EIBM-AID                   12060000
120700             MOVE AC-AID-NAME (AC-AID-IDX)                        12070000
120800                                     TO EL5-EIBAID-DESCRIPTION    12080000
120900     END-SEARCH.                                                  12090000
121000     PERFORM 5110-SET-LINE-INDEX.                                 12100000
121100     MOVE EL5-EIB-LINE-5  TO LT-ERROR-MESSAGE (LT-IDX).           12110000
121200*                                                                 12120000
121300     MOVE EIBM-FN                    TO DP012-CONVERSION-FIELD.   12130000
121400     MOVE LENGTH OF EIBM-FN          TO DP012-LENGTH.             12140000
121500     CALL 'DPKUT012' USING DP012-HEX-PARAMETER-LIST.              12150000
121600     IF  DP012-CALL-SUCCESSFUL                                    12160000
121700         MOVE DP012-CONVERTED-FIELD  TO EL6-EIBFN-HEX             12170000
121800     ELSE                                                         12180000
121900         MOVE ALL '?'                TO EL6-EIBFN-HEX             12190000
122000     END-IF.                                                      12200000
122100     MOVE EIBM-RCODE                 TO DP012-CONVERSION-FIELD.   12210000
122200     MOVE LENGTH OF EIBM-RCODE       TO DP012-LENGTH.             12220000
122300     CALL 'DPKUT012' USING DP012-HEX-PARAMETER-LIST.              12230000
122400     IF  DP012-CALL-SUCCESSFUL                                    12240000
122500         MOVE DP012-CONVERTED-FIELD  TO EL6-EIBRCODE-HEX          12250000
122600     ELSE                                                         12260000
122700         MOVE ALL '?'                TO EL6-EIBRCODE-HEX          12270000
122800     END-IF.                                                      12280000
122900     PERFORM 5110-SET-LINE-INDEX.                                 12290000
123000     MOVE EL6-EIB-LINE-6             TO LT-ERROR-MESSAGE (LT-IDX).12300000
123100*                                                                 12310000
123200     MOVE EIBM-RESP                  TO EL7-EIBRESP.              12320000
123300     SET EC-RESP-IDX TO 1.                                        12330000
123400     SEARCH EC-EIBRESP-ENTRY                                      12340000
123500         AT END                                                   12350000
123600             MOVE ALL '?'            TO EL7-EIBRESP-DESCRIPTION   12360000
123700         WHEN EC-EIBRESP (EC-RESP-IDX) = EIBM-RESP                12370000
123800             MOVE EC-CONDITION-NAME (EC-RESP-IDX)                 12380000
123900                                     TO EL7-EIBRESP-DESCRIPTION   12390000
124000     END-SEARCH.                                                  12400000
124100     MOVE EIBM-RESP2                 TO EL7-EIBRESP2.             12410000
124200     PERFORM 5110-SET-LINE-INDEX.                                 12420000
124300     MOVE EL7-EIB-LINE-7             TO LT-ERROR-MESSAGE (LT-IDX).12430000
124400*                                                                 12440000
124500     MOVE EIBM-DS                    TO EL8-EIBDS.                12450000
124600*                                                                 12460000
124700     MOVE EIBM-REQID                 TO DP012-CONVERSION-FIELD.   12470000
124800     MOVE LENGTH OF EIBM-REQID       TO DP012-LENGTH.             12480000
124900     CALL 'DPKUT012' USING DP012-HEX-PARAMETER-LIST.              12490000
125000     IF  DP012-CALL-SUCCESSFUL                                    12500000
125100         MOVE DP012-CONVERTED-FIELD  TO EL8-EIBREQID-HEX          12510000
125200     ELSE                                                         12520000
125300         MOVE ALL '?'                TO EL8-EIBREQID-HEX          12530000
125400     END-IF.                                                      12540000
125500     PERFORM 5110-SET-LINE-INDEX.                                 12550000
125600     MOVE EL8-EIB-LINE-8             TO LT-ERROR-MESSAGE (LT-IDX).12560000
125700*                                                                 12570000
125800     MOVE EIBM-RSRCE                 TO DP012-CONVERSION-FIELD.   12580000
125900     MOVE LENGTH OF EIBM-RSRCE       TO DP012-LENGTH.             12590000
126000     CALL 'DPKUT012' USING DP012-HEX-PARAMETER-LIST.              12600000
126100     IF  DP012-CALL-SUCCESSFUL                                    12610000
126200         MOVE DP012-CONVERTED-FIELD  TO EL9-EIBRSRCE-HEX          12620000
126300     ELSE                                                         12630000
126400         MOVE ALL '?'                TO EL9-EIBRSRCE-HEX          12640000
126500     END-IF.                                                      12650000
126600*                                                                 12660000
126700     MOVE EIBM-EOC                   TO DP012-CONVERSION-FIELD.   12670000
126800     MOVE LENGTH OF EIBM-EOC         TO DP012-LENGTH.             12680000
126900     CALL 'DPKUT012' USING DP012-HEX-PARAMETER-LIST.              12690000
127000     IF  DP012-CALL-SUCCESSFUL                                    12700000
127100         MOVE DP012-CONVERTED-FIELD  TO EL9-EIBEOC-HEX            12710000
127200     ELSE                                                         12720000
127300         MOVE ALL '?'                TO EL9-EIBEOC-HEX            12730000
127400     END-IF.                                                      12740000
127500     PERFORM 5110-SET-LINE-INDEX.                                 12750000
127600     MOVE EL9-EIB-LINE-9             TO LT-ERROR-MESSAGE (LT-IDX).12760000
127700*                                                                 12770000
127800     MOVE EIBM-FREE                  TO DP012-CONVERSION-FIELD.   12780000
127900     MOVE LENGTH OF EIBM-FREE        TO DP012-LENGTH.             12790000
128000     CALL 'DPKUT012' USING DP012-HEX-PARAMETER-LIST.              12800000
128100     IF  DP012-CALL-SUCCESSFUL                                    12810000
128200         MOVE DP012-CONVERTED-FIELD  TO EL10-EIBFREE-HEX          12820000
128300     ELSE                                                         12830000
128400         MOVE ALL '?'                TO EL10-EIBFREE-HEX          12840000
128500     END-IF.                                                      12850000
128600     MOVE EIBM-RECV                  TO DP012-CONVERSION-FIELD.   12860000
128700     MOVE LENGTH OF EIBM-RECV        TO DP012-LENGTH.             12870000
128800     CALL 'DPKUT012' USING DP012-HEX-PARAMETER-LIST.              12880000
128900     IF  DP012-CALL-SUCCESSFUL                                    12890000
129000         MOVE DP012-CONVERTED-FIELD  TO EL10-EIBRECV-HEX          12900000
129100     ELSE                                                         12910000
129200         MOVE ALL '?'                TO EL10-EIBRECV-HEX          12920000
129300     END-IF.                                                      12930000
129400     PERFORM 5110-SET-LINE-INDEX.                                 12940000
129500     MOVE EL10-EIB-LINE-10           TO LT-ERROR-MESSAGE (LT-IDX).12950000
129600*                                                                 12960000
129700     MOVE EIBM-ATT                   TO DP012-CONVERSION-FIELD.   12970000
129800     MOVE LENGTH OF EIBM-ATT         TO DP012-LENGTH.             12980000
129900     CALL 'DPKUT012' USING DP012-HEX-PARAMETER-LIST.              12990000
130000     IF  DP012-CALL-SUCCESSFUL                                    13000000
130100         MOVE DP012-CONVERTED-FIELD  TO EL11-EIBATT-HEX           13010000
130200     ELSE                                                         13020000
130300         MOVE ALL '?'                TO EL11-EIBATT-HEX           13030000
130400     END-IF.                                                      13040000
130500     MOVE EIBM-SYNC                  TO DP012-CONVERSION-FIELD.   13050000
130600     MOVE LENGTH OF EIBM-SYNC        TO DP012-LENGTH.             13060000
130700     CALL 'DPKUT012' USING DP012-HEX-PARAMETER-LIST.              13070000
130800     IF  DP012-CALL-SUCCESSFUL                                    13080000
130900         MOVE DP012-CONVERTED-FIELD  TO EL11-EIBSYNC-HEX          13090000
131000     ELSE                                                         13100000
131100         MOVE ALL '?'                TO EL11-EIBSYNC-HEX          13110000
131200     END-IF.                                                      13120000
131300     PERFORM 5110-SET-LINE-INDEX.                                 13130000
131400     MOVE EL11-EIB-LINE-11           TO LT-ERROR-MESSAGE (LT-IDX).13140000
131500*                                                                 13150000
131600     MOVE EIBM-FMH                   TO DP012-CONVERSION-FIELD.   13160000
131700     MOVE LENGTH OF EIBM-FMH         TO DP012-LENGTH.             13170000
131800     CALL 'DPKUT012' USING DP012-HEX-PARAMETER-LIST.              13180000
131900     IF  DP012-CALL-SUCCESSFUL                                    13190000
132000         MOVE DP012-CONVERTED-FIELD  TO EL12-EIBFMH-HEX           13200000
132100     ELSE                                                         13210000
132200         MOVE ALL '?'                TO EL12-EIBFMH-HEX           13220000
132300     END-IF.                                                      13230000
132400     MOVE EIBM-COMPL                 TO DP012-CONVERSION-FIELD.   13240000
132500     MOVE LENGTH OF EIBM-COMPL       TO DP012-LENGTH.             13250000
132600     CALL 'DPKUT012' USING DP012-HEX-PARAMETER-LIST.              13260000
132700     IF  DP012-CALL-SUCCESSFUL                                    13270000
132800         MOVE DP012-CONVERTED-FIELD  TO EL12-EIBCOMPL-HEX         13280000
132900     ELSE                                                         13290000
133000         MOVE ALL '?'                TO EL12-EIBCOMPL-HEX         13300000
133100     END-IF.                                                      13310000
133200     PERFORM 5110-SET-LINE-INDEX.                                 13320000
133300     MOVE EL12-EIB-LINE-12           TO LT-ERROR-MESSAGE (LT-IDX).13330000
133400*                                                                 13340000
133500     MOVE EIBM-SIG                   TO DP012-CONVERSION-FIELD.   13350000
133600     MOVE LENGTH OF EIBM-SIG         TO DP012-LENGTH.             13360000
133700     CALL 'DPKUT012' USING DP012-HEX-PARAMETER-LIST.              13370000
133800     IF  DP012-CALL-SUCCESSFUL                                    13380000
133900         MOVE DP012-CONVERTED-FIELD  TO EL13-EIBSIG-HEX           13390000
134000     ELSE                                                         13400000
134100         MOVE ALL '?'                TO EL13-EIBSIG-HEX           13410000
134200     END-IF.                                                      13420000
134300     MOVE EIBM-CONF                  TO DP012-CONVERSION-FIELD.   13430000
134400     MOVE LENGTH OF EIBM-CONF        TO DP012-LENGTH.             13440000
134500     CALL 'DPKUT012' USING DP012-HEX-PARAMETER-LIST.              13450000
134600     IF  DP012-CALL-SUCCESSFUL                                    13460000
134700         MOVE DP012-CONVERTED-FIELD  TO EL13-EIBCONF-HEX          13470000
134800     ELSE                                                         13480000
134900         MOVE ALL '?'                TO EL13-EIBCONF-HEX          13490000
135000     END-IF.                                                      13500000
135100     PERFORM 5110-SET-LINE-INDEX.                                 13510000
135200     MOVE EL13-EIB-LINE-13           TO LT-ERROR-MESSAGE (LT-IDX).13520000
135300*                                                                 13530000
135400     MOVE EIBM-ERR                   TO DP012-CONVERSION-FIELD.   13540000
135500     MOVE LENGTH OF EIBM-ERR         TO DP012-LENGTH.             13550000
135600     CALL 'DPKUT012' USING DP012-HEX-PARAMETER-LIST.              13560000
135700     IF  DP012-CALL-SUCCESSFUL                                    13570000
135800         MOVE DP012-CONVERTED-FIELD  TO EL14-EIBERR-HEX           13580000
135900     ELSE                                                         13590000
136000         MOVE ALL '?'                TO EL14-EIBERR-HEX           13600000
136100     END-IF.                                                      13610000
136200     MOVE EIBM-ERRCD                 TO DP012-CONVERSION-FIELD.   13620000
136300     MOVE LENGTH OF EIBM-ERRCD       TO DP012-LENGTH.             13630000
136400     CALL 'DPKUT012' USING DP012-HEX-PARAMETER-LIST.              13640000
136500     IF  DP012-CALL-SUCCESSFUL                                    13650000
136600         MOVE DP012-CONVERTED-FIELD  TO EL14-EIBERRCD-HEX         13660000
136700     ELSE                                                         13670000
136800         MOVE ALL '?'                TO EL14-EIBERRCD-HEX         13680000
136900     END-IF.                                                      13690000
137000     PERFORM 5110-SET-LINE-INDEX.                                 13700000
137100     MOVE EL14-EIB-LINE-14           TO LT-ERROR-MESSAGE (LT-IDX).13710000
137200*                                                                 13720000
137300     MOVE EIBM-SYNRB                 TO DP012-CONVERSION-FIELD.   13730000
137400     MOVE LENGTH OF EIBM-SYNRB       TO DP012-LENGTH.             13740000
137500     CALL 'DPKUT012' USING DP012-HEX-PARAMETER-LIST.              13750000
137600     IF  DP012-CALL-SUCCESSFUL                                    13760000
137700         MOVE DP012-CONVERTED-FIELD  TO EL15-EIBSYNRB-HEX         13770000
137800     ELSE                                                         13780000
137900         MOVE ALL '?'                TO EL15-EIBSYNRB-HEX         13790000
138000     END-IF.                                                      13800000
138100     MOVE EIBM-NODAT                 TO DP012-CONVERSION-FIELD.   13810000
138200     MOVE LENGTH OF EIBM-NODAT       TO DP012-LENGTH.             13820000
138300     CALL 'DPKUT012' USING DP012-HEX-PARAMETER-LIST.              13830000
138400     IF  DP012-CALL-SUCCESSFUL                                    13840000
138500         MOVE DP012-CONVERTED-FIELD  TO EL15-EIBNODAT-HEX         13850000
138600     ELSE                                                         13860000
138700         MOVE ALL '?'                TO EL15-EIBNODAT-HEX         13870000
138800     END-IF.                                                      13880000
138900     PERFORM 5110-SET-LINE-INDEX.                                 13890000
139000     MOVE EL15-EIB-LINE-15           TO LT-ERROR-MESSAGE (LT-IDX).13900000
139100*                                                                 13910000
139200*                                                                 13920000
139300 3500-LOG-ABEND-INFO.                                             13930000
139400     EXEC CICS                                                    13940000
139500         ENQ                                                      13950000
139600             RESOURCE (PC-LOG-QUEUE-RESOURCE)                     13960000
139700     END-EXEC.                                                    13970000
139800*                                                                 13980000
139900     SET PV-NUMBER-LOG-LINES TO LT-IDX.                           13990000
140000     PERFORM                                                      14000000
140100         VARYING LT-IDX                                           14010000
140200         FROM 1 BY 1                                              14020000
140300         UNTIL LT-IDX > PV-NUMBER-LOG-LINES                       14030000
140400             MOVE LT-LOG-LINE (LT-IDX) TO PV-LOG-DATA             14040000
140500             PERFORM 3510-WRITEQ-TD                               14050000
140600     END-PERFORM.                                                 14060000
140700*                                                                 14070000
140800     EXEC CICS                                                    14080000
140900         DEQ                                                      14090000
141000             RESOURCE (PC-LOG-QUEUE-RESOURCE)                     14100000
141100     END-EXEC.                                                    14110000
141200*    PERFORM 3520-DISPLAY-OPER-MSG.                               14120000
141300*                                                                 14130000
141400*                                                                 14140000
141500 3510-WRITEQ-TD.                                                  14150000
141600     EXEC CICS                                                    14160000
141700         WRITEQ TD                                                14170000
141800             QUEUE (PC-LOG-QUEUE)                                 14180000
141900             FROM  (PV-LOG-LINE)                                  14190000
142000             RESP  (PV-CICS-RESPONSE)                             14200000
142100     END-EXEC.                                                    14210000
142200*                                                                 14220000
142300     IF  PV-CICS-RESPONSE = DFHRESP(NORMAL)                       14230000
142400         CONTINUE                                                 14240000
142500     ELSE                                                         14250000
142600         EXEC CICS                                                14260000
142700             ABEND                                                14270000
142800                 ABCODE (EIBTRMID)                                14280000
142900         END-EXEC                                                 14290000
143000     END-IF.                                                      14300000
143100 5110-SET-LINE-INDEX.                                             14310000
143200     IF  LT-IDX > PC-LOG-TABLE-MAX                                14320000
143300         SET PS-LOG-OVERFLOW TO TRUE                              14330000
143400     ELSE                                                         14340000
143500         SET LT-IDX UP BY 1                                       14350000
143600     END-IF.                                                      14360000
143700                                                                  14370000
143800                                                                  14380000
143900 8000-SEND-MAP.                                                   14390000
144000     EXEC CICS                                                    14400000
144100         SEND                                                     14410000
144200             MAP     ('PC852A')                                   14420000
144300             MAPSET  ('PCKM852')                                  14430000
144400             ERASE                                                14440000
144500             RESP    (PV-CICS-RESPONSE)                           14450000
144600     END-EXEC.                                                    14460000
144700                                                                  14470000
144800     EVALUATE TRUE                                                14480000
144900         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 14490000
145000             CONTINUE                                             14500000
145100         WHEN OTHER                                               14510000
145200             MOVE '8000-SEND-MAP'     TO DP013-PARAGRAPH          14520000
145300             MOVE 'UNABLE TO SEND MAP'                            14530000
145400                                      TO DP013-MESSAGE-TEXT (1)   14540000
145500             SET DP013-CICS-ABEND     TO TRUE                     14550000
145600             SET DP013-NO-ROLLBACK    TO TRUE                     14560000
145700             PERFORM 9999-WRITE-CICS-LOG-MSG                      14570000
145800     END-EVALUATE.                                                14580000
145900*                                                                 14590000
146000 8020-RECEIVE-MAP.                                                14600000
146100                                                                  14610000
146200     EXEC CICS                                                    14620000
146300         RECEIVE MAP    ('PC852A')                                14630000
146400                 MAPSET ('PCKM852')                               14640000
146500                 RESP   (PV-CICS-RESPONSE)                        14650000
146600     END-EXEC.                                                    14660000
146700                                                                  14670000
146800     EVALUATE TRUE                                                14680000
146900         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 14690000
147000             CONTINUE                                             14700000
147100         WHEN PV-CICS-RESPONSE = DFHRESP (MAPFAIL)                14710000
147200             CONTINUE                                             14720000
147300         WHEN OTHER                                               14730000
147400             MOVE '8020-RECEIVE-MAP'  TO DP013-PARAGRAPH          14740000
147500             MOVE 'PCKRF852 - UNABLE TO RECEIVE MAP'              14750000
147600                                      TO DP013-MESSAGE-TEXT (1)   14760000
147700             SET DP013-LOGIC-ABEND    TO TRUE                     14770000
147800             SET DP013-NO-ROLLBACK    TO TRUE                     14780000
147900             PERFORM 9999-WRITE-CICS-LOG-MSG                      14790000
148000     END-EVALUATE.                                                14800000
148100                                                                  14810000
148200 8030-SEND-TEXT.                                                  14820000
148300                                                                  14830000
148400     MOVE LENGTH OF PV-TEXT TO PV-TEXT-LENGTH                     14840000
148500                                                                  14850000
148600     EXEC CICS                                                    14860000
148700         SEND TEXT                                                14870000
148800             FROM (PV-TEXT)                                       14880000
148900             LENGTH (PV-TEXT-LENGTH)                              14890000
149000             ERASE                                                14900000
149100             RESP   (PV-CICS-RESPONSE)                            14910000
149200     END-EXEC.                                                    14920000
149210                                                                  14921000
149211     EVALUATE TRUE                                                14921100
149212         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 14921200
149213             CONTINUE                                             14921300
149214         WHEN PV-CICS-RESPONSE = DFHRESP (MAPFAIL)                14921400
149215             CONTINUE                                             14921500
149216         WHEN OTHER                                               14921600
149217             MOVE '8030-SEND-TEXT'    TO DP013-PARAGRAPH          14921700
149218             MOVE 'PCKRF852 - UNABLE TO SEND TEXT'                14921818
149219                                      TO DP013-MESSAGE-TEXT (1)   14921900
149220             SET DP013-LOGIC-ABEND    TO TRUE                     14922000
149221             SET DP013-NO-ROLLBACK    TO TRUE                     14922100
149222             PERFORM 9999-WRITE-CICS-LOG-MSG                      14922200
149223     END-EVALUATE.                                                14922300
149224                                                                  14922400
149225 8100-SEND-DATA-ONLY.                                             14922500
149226                                                                  14922600
149227     EXEC CICS                                                    14922700
149228         SEND                                                     14922800
149229             MAP       ('PC852A')                                 14922900
149230             MAPSET    ('PCKM852')                                14923000
149240             CURSOR                                               14924000
149250             DATAONLY                                             14925000
149260             RESP      (PV-CICS-RESPONSE)                         14926000
149270     END-EXEC.                                                    14927000
149280                                                                  14928000
149290     EVALUATE TRUE                                                14929000
149300         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 14930000
149400             CONTINUE                                             14940000
149500         WHEN OTHER                                               14950000
149600             MOVE '8100-SEND-DATA-ONLY'                           14960000
149700                                      TO DP013-PARAGRAPH          14970000
149800             MOVE 'UNABLE TO SEND DATA'                           14980000
149900                                      TO DP013-MESSAGE-TEXT (1)   14990000
150000             SET DP013-CICS-ABEND     TO TRUE                     15000000
150100             SET DP013-NO-ROLLBACK    TO TRUE                     15010000
150200             PERFORM 9999-WRITE-CICS-LOG-MSG                      15020000
150300     END-EVALUATE.                                                15030000
150400*                                                                 15040000
150500 8200-RETURN-TRANID.                                              15050000
150600     MOVE LENGTH OF CA-COMMAREA       TO PV-COMMAREA-LENGTH.      15060000
150700                                                                  15070000
150800     EXEC CICS                                                    15080000
150900         RETURN                                                   15090000
151000             TRANSID   (PC-CURRENT-TRANID)                        15100000
151100             COMMAREA  (CA-COMMAREA)                              15110000
151200             LENGTH    (PV-COMMAREA-LENGTH)                       15120000
151300             RESP      (PV-CICS-RESPONSE)                         15130000
151400     END-EXEC.                                                    15140000
151500                                                                  15150000
151600     EVALUATE TRUE                                                15160000
151700         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 15170000
151800             CONTINUE                                             15180000
151900         WHEN OTHER                                               15190000
152000             MOVE '8200-RETURN-TRANID'                            15200000
152100                                      TO DP013-PARAGRAPH          15210000
152200             MOVE 'UNABLE TO RETURN   TO TRANID'                  15220000
152300                                      TO DP013-MESSAGE-TEXT (1)   15230000
152400             SET DP013-CICS-ABEND     TO TRUE                     15240000
152500             SET DP013-NO-ROLLBACK    TO TRUE                     15250000
152600             PERFORM 9999-WRITE-CICS-LOG-MSG                      15260000
152700     END-EVALUATE.                                                15270000
152800*                                                                 15280000
152900 8300-XCTL-TO-HELP.                                               15290000
153000                                                                  15300000
153100     MOVE LENGTH OF PC192-COMMAREA    TO PV-COMMAREA-LENGTH       15310000
153200                                                                  15320000
153300     EXEC CICS                                                    15330000
153400         XCTL                                                     15340000
153500             PROGRAM   (PV-TRANSFER-PROGRAM)                      15350000
153600             COMMAREA  (PC192-COMMAREA)                           15360000
153700             LENGTH    (PV-COMMAREA-LENGTH)                       15370000
153800             RESP      (PV-CICS-RESPONSE)                         15380000
153900     END-EXEC.                                                    15390000
154000                                                                  15400000
154100     EVALUATE TRUE                                                15410000
154200         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 15420000
154300             CONTINUE                                             15430000
154400         WHEN OTHER                                               15440000
154500             MOVE '8300-XCTL-TO-HELP'                             15450000
154600                                      TO DP013-PARAGRAPH          15460000
154700             MOVE 'UNABLE TO RETURN   TO TRANID'                  15470000
154800                                      TO DP013-MESSAGE-TEXT (1)   15480000
154900             SET DP013-CICS-ABEND     TO TRUE                     15490000
155000             SET DP013-NO-ROLLBACK    TO TRUE                     15500000
155100             PERFORM 9999-WRITE-CICS-LOG-MSG                      15510000
155200     END-EVALUATE.                                                15520000
155300*                                                                 15530000
155400 8400-ROLLBACK.                                                   15540000
155500                                                                  15550000
155600     EXEC CICS                                                    15560000
155700         SYNCPOINT                                                15570000
155800         ROLLBACK                                                 15580000
155900     END-EXEC.                                                    15590000
156000                                                                  15600000
156100*                                                                 15610000
156200 9999-WRITE-CICS-LOG-MSG.                                         15620000
156300     MOVE PC-CURRENT-PROGRAM-NAME     TO DP013-PROGRAM.           15630000
156400     MOVE DFHEIBLK                    TO DP013-DFHEIBLK.          15640000
156500     INITIALIZE DP013-SRC-TASK-NUMBER                             15650000
156600                DP013-STACK.                                      15660000
156700     SET DP013-LINK-RETURN            TO TRUE.                    15670000
156800                                                                  15680000
156900     EXEC CICS                                                    15690000
157000         LINK                                                     15700000
157100             PROGRAM   (DP013-NAME)                               15710000
157200             COMMAREA  (DP013-PARAMETERS)                         15720000
157300             LENGTH    (DP013-LENGTH)                             15730000
157400     END-EXEC.                                                    15740000
157500                                                                  15750000
157600*----------------------------------------------------------------*15760000
157700*    ABEND PROCESSOR MODULE                                      *15770000
157800*----------------------------------------------------------------*15780000
157900                                                                  15790000
158000     COPY DPPD014.                                                15800000
158100                                                                  15810000
