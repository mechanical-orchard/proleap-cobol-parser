000100 IDENTIFICATION DIVISION.                                         00010001
000200 PROGRAM-ID.     APKUT388.                                        00020002
000300 AUTHOR.         NANCY EILBES.                                    00030001
000400 DATE-WRITTEN.   DECEMBER 2020.                                   00040001
000500 DATE-COMPILED.                                                   00050001
000600******************************************************************00060001
000700*    COBOL 2                                                     *00070001
000800*     REFORMATS APRD042 RECORD TO TEXT FORMAT                    *00080001
000801*                                                                *00080101
000810*     THE PURPOSE OF THIS PROGRAM IS TO CREATE A TEXT FILE       *00081001
000820*     USING SELECT FIELDS ON THE UNJOURNALIZED RECEIPT EXTRACT.  *00082001
000830*     FILE WILL BE TRANSFERRED TO THE FINANCE SHARED DRIVE TO BE *00083001
000840*     USED IN THEIR PO BY PO ANALYSIS OF UNJOURNALIZED RECEIPTS  *00084001
000850*     AND THE BALANCE IN THE 20110 ACCOUNT.                      *00085001
000900*                                                                *00090001
001000* INPUT:                                                         *00100001
001100*  1. UNJOURNALIZED RECEIPT EXTRACT     COPYBOOK APRD042         *00110001
001200*                                                                *00120001
001300* OUTPUT:                                                        *00130001
001400*  1. TEXT FILE                                                  *00140001
001500*                                                                *00150001
001510*----------------------------------------------------------------*00151006
001520* CHANGE LOG:                                                    *00152006
001530* DATE  05/20/2022                                               *00153006
001540*     CHANGE MADE: INITIAL IMPLEMENTATION.                       *00154006
001550*     MADE BY: NANCY EILBES            WR/IR #: CHG0270320       *00155006
001600******************************************************************00160001
001700   EJECT                                                          00170001
001800 ENVIRONMENT DIVISION.                                            00180001
001900 CONFIGURATION SECTION.                                           00190001
002000 SOURCE-COMPUTER.    IBM-3090.                                    00200001
002100 OBJECT-COMPUTER.    IBM-3090.                                    00210001
002200                                                                  00220001
002300 INPUT-OUTPUT SECTION.                                            00230001
002400 FILE-CONTROL.                                                    00240001
002500     SELECT IN-FILE       ASSIGN TO UT-S-INP01.                   00250001
002600     SELECT OUT-FILE      ASSIGN TO UT-S-OUT01.                   00260001
002700                                                                  00270001
002800 DATA DIVISION.                                                   00280001
002900 FILE SECTION.                                                    00290001
003000                                                                  00300001
003100 FD  IN-FILE                                                      00310001
003200     RECORDING MODE IS F                                          00320001
003300     LABEL RECORDS ARE STANDARD                                   00330001
003400     BLOCK CONTAINS 0 RECORDS                                     00340001
003500     DATA RECORD IS UNJRNLD-IN-REC.                               00350001
003600 01  IN-REC.                                                      00360001
003700     05  FILLER                       PIC  X(120).                00370001
003800                                                                  00380001
003900 FD  OUT-FILE                                                     00390001
004000     RECORDING MODE IS F                                          00400001
004100     LABEL RECORDS ARE STANDARD                                   00410001
004200     BLOCK CONTAINS 0 RECORDS                                     00420001
004300     DATA RECORD IS UNJRNLD-OUT-REC.                              00430001
004400 01  OUT-REC.                                                     00440001
004500     05  FILLER                       PIC  X(120).                00450001
004600                                                                  00460001
004700 EJECT                                                            00470001
004800 WORKING-STORAGE SECTION.                                         00480001
004900                                                                  00490001
005000 01  EOF-SW                           PIC X     VALUE 'N'.        00500001
005100     88  IN-EOF                                 VALUE 'Y'.        00510001
005110                                                                  00511001
005200 01  TEXT-RECORD.                                                 00520001
005630     05  OUT-VENDOR-NBR               PIC X(09).                  00563003
005631     05  FILLER                       PIC X     VALUE ','.        00563103
005632     05  OUT-VENDOR-NAME              PIC X(30).                  00563203
005633     05  FILLER                       PIC X     VALUE ','.        00563303
005634     05  OUT-PO-NBR                   PIC X(09).                  00563403
005635     05  FILLER                       PIC X     VALUE ','.        00563503
005636     05  OUT-DEPT-NBR                 PIC X(3).                   00563603
005639     05  FILLER                       PIC X     VALUE ','.        00563903
005640     05  OUT-PO-VRFD-QTY              PIC 999999.                 00564004
005641     05  FILLER                       PIC X     VALUE ','.        00564104
005642     05  OUT-CALCD-VRFD-COST-AMT      PIC -----------.99.         00564204
005643     05  FILLER                       PIC X     VALUE ','.        00564304
005644     05  OUT-CALCD-VRFD-RTL-AMT       PIC -----------.99.         00564405
005671                                                                  00567104
005672 01  TEXT-HEADERS.                                                00567204
005673     05  FILLER                       PIC X(09) VALUE             00567304
005674                                      'VENDOR ID'.                00567404
005675     05  FILLER                       PIC X     VALUE ','.        00567504
005676     05  FILLER                       PIC X(11) VALUE             00567604
005677                                      'VENDOR NAME'.              00567704
005678     05  FILLER                       PIC X     VALUE ','.        00567804
005679     05  FILLER                       PIC X(09) VALUE             00567904
005680                                      'PO NUMBER'.                00568004
005681     05  FILLER                       PIC X     VALUE ','.        00568104
005682     05  FILLER                       PIC X(4) VALUE              00568204
005683                                      'DEPT'.                     00568304
005684     05  FILLER                       PIC X     VALUE ','.        00568404
005687     05  FILLER                       PIC X(09) VALUE             00568704
005688                                      'TOTAL QTY'.                00568804
005689     05  FILLER                       PIC X     VALUE ','.        00568904
005690     05  FILLER                       PIC X(10) VALUE             00569004
005691                                      'TOTAL COST'.               00569104
005692     05  FILLER                       PIC X     VALUE ','.        00569204
005693     05  FILLER                       PIC X(12) VALUE             00569304
005694                                      'TOTAL RETAIL'.             00569404
005695                                                                  00569504
005696     COPY APRD042.                                                00569604
005700                                                                  00570001
005800 EJECT                                                            00580001
005900 PROCEDURE DIVISION.                                              00590001
006000 A100-MAIN.                                                       00600001
006100                                                                  00610001
006200     PERFORM B100-INITIALIZE.                                     00620001
006300                                                                  00630001
006400     PERFORM B200-PROCESS                                         00640001
006500         UNTIL IN-EOF.                                            00650001
006600                                                                  00660001
006700     GOBACK.                                                      00670001
006800 EJECT                                                            00680001
006900*----------------------------------------------------------------*00690001
007000*    INITIALIZATION PROCESSING                                   *00700001
007200*----------------------------------------------------------------*00720001
007300 B100-INITIALIZE.                                                 00730001
007400                                                                  00740001
007500     OPEN INPUT  IN-FILE                                          00750001
007600          OUTPUT OUT-FILE.                                        00760001
007700                                                                  00770001
007710     WRITE OUT-REC FROM TEXT-HEADERS.                             00771004
007720                                                                  00772004
007800     PERFORM R100-READ-INPUT.                                     00780001
007900                                                                  00790001
008000 B200-PROCESS.                                                    00800001
008100                                                                  00810001
008200     MOVE AP042-VND-NBR             TO OUT-VENDOR-NBR.            00820003
008400     MOVE AP042-ENT-NM-DESC         TO OUT-VENDOR-NAME.           00840003
008410     MOVE AP042-DEPT-NBR            TO OUT-DEPT-NBR.              00841003
008510     MOVE AP042-PO-NBR              TO OUT-PO-NBR.                00851003
008520     MOVE AP042-PO-VRFD-QTY         TO OUT-PO-VRFD-QTY.           00852003
008600     MOVE AP042-CALCD-VRFD-COST-AMT TO OUT-CALCD-VRFD-COST-AMT.   00860001
008920     MOVE AP042-CALCD-VRFD-RTL-AMT  TO OUT-CALCD-VRFD-RTL-AMT.    00892003
009100                                                                  00910001
009900     PERFORM W100-WRITE-OUTPUT.                                   00990001
010000                                                                  01000001
010100     PERFORM R100-READ-INPUT.                                     01010001
010200                                                                  01020001
010300 R100-READ-INPUT.                                                 01030001
010500                                                                  01050001
010600     READ IN-FILE INTO AP042-EXTRACT-FILE                         01060001
010700         AT END SET IN-EOF TO TRUE.                               01070001
010900                                                                  01090001
011000 W100-WRITE-OUTPUT.                                               01100001
011100                                                                  01110001
011200     WRITE OUT-REC FROM TEXT-RECORD.                              01120001
011300                                                                  01130001
