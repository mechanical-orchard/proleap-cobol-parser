000200 IDENTIFICATION DIVISION.                                         00020001
000400 PROGRAM-ID.      WSKRP002.                                       00030001
000500 AUTHOR.          JEAN KURKOWSKI.                                 00040001
000600 DATE-WRITTEN.    07/30/07.                                       00050001
006787 ENVIRONMENT DIVISION.                                            00060001
006788 CONFIGURATION SECTION.                                           00070001
006789 SOURCE-COMPUTER. IBM-3090.                                       00080001
006790 OBJECT-COMPUTER. IBM-3090.                                       00090001
006800                                                                  00100001
006900 INPUT-OUTPUT SECTION.                                            00110001
007000 FILE-CONTROL.                                                    00120001
007100                                                                  00130001
007500     SELECT ERROR-FILE ASSIGN TO INP01.                           00140001
007600     SELECT ERROR-RPT  ASSIGN TO RPT01.                           00150002
007700                                                                  00160001
008200 DATA DIVISION.                                                   00170001
008400 FILE SECTION.                                                    00180001
009300                                                                  00190001
009400 FD  ERROR-FILE                                                   00200001
009500     RECORDING MODE F                                             00210001
009600     BLOCK CONTAINS 0 RECORDS                                     00220001
009700     LABEL RECORDS ARE OMITTED.                                   00230008
010000 01  ERROR-REC                        PIC X(1055).                00240007
010010                                                                  00250001
010020 FD  ERROR-RPT                                                    00260001
010030     RECORDING MODE F                                             00270001
010040     BLOCK CONTAINS 0 RECORDS                                     00280001
010050     RECORD CONTAINS 132 CHARACTERS.                              00290001
010080 01  ERROR-RPT-REC                    PIC X(132).                 00300001
010100                                                                  00310001
010308 WORKING-STORAGE SECTION.                                         00320001
000292                                                                  00320116
000285*  COMMUNICATIONS AREA FOR DB2                                    00322016
000287     EXEC SQL                                                     00324016
000288          INCLUDE SQLCA                                           00325016
000289     END-EXEC.                                                    00326016
000290                                                                  00327016
000291     COPY SQLCA2.                                                 00328016
000292                                                                  00330016
000294*  WORK AREA FOR SQL ERROR ROUTINE 'DSNTIAR'.                     00332016
000296     COPY DPWS004.                                                00334016
000292                                                                  00335016
000298*  DB2 TABLE XLT_LOC                                              00352016
000301     EXEC SQL                                                     00355016
000302          INCLUDE XLT00010                                        00356016
000303     END-EXEC.                                                    00357016
000304                                                                  00358016
000298*  DB2 TABLE WST_SHPMT_XREF_HDR                                   00358123
000301     EXEC SQL                                                     00358223
000302          INCLUDE WST00001                                        00358323
000303     END-EXEC.                                                    00358423
000304                                                                  00358523
010360*  STANDARD HEADER LINE - KOHLS 132 COL                           00359016
010370*                                                                 00359116
010380     COPY DPWS132O.                                               00360001
010390                                                                  00370001
010400 01  HEADING-LINE1.                                               00380001
010510     05  FILLER                       PIC X(46)   VALUE SPACES.   00390001
010600     05  FILLER                       PIC X(30)   VALUE           00400001
010700         'NON-MANIFESTED CASES FROM WMOS'.                        00410001
010800     05  FILLER                       PIC X(56)   VALUE SPACES.   00440001
010900 01  HEADING-LINE2.                                               00450001
011000     05  FILLER                       PIC X(1)    VALUE SPACES.   00460001
011100     05  FILLER                       PIC X(16)   VALUE           00470001
011200         'DC ...........:'.                                       00480001
011410     05  HD2-DC-NBR                   PIC ZZZZ9.                  00490001
011410     05  FILLER                       PIC X(02)   VALUE SPACES.   00491001
011410     05  HD2-DC-NAME                  PIC X(40).                  00491120
011410     05  FILLER                       PIC X(110)  VALUE SPACES.   00492001
010900 01  HEADING-LINE3.                                               00493001
011000     05  FILLER                       PIC X(1)    VALUE SPACES.   00494001
011100     05  FILLER                       PIC X(12)   VALUE           00495001
011200         'PO/RECEIVER '.                                          00496001
011410     05  FILLER                       PIC X(02)   VALUE SPACES.   00497001
011410     05  FILLER                       PIC X(08)   VALUE           00498001
011200         ' SKU NBR'.                                              00498101
011410     05  FILLER                       PIC X(02)   VALUE SPACES.   00498201
011410     05  FILLER                       PIC X(04)   VALUE           00498310
011200         'LINE'.                                                  00498410
011410     05  FILLER                       PIC X(02)   VALUE SPACES.   00498501
011410     05  FILLER                       PIC X(05)   VALUE           00498901
011200         'QTY  '.                                                 00499001
011410     05  FILLER                       PIC X(01)   VALUE SPACES.   00499101
011410     05  FILLER                       PIC X(20)   VALUE           00499210
011200         'CASE NUMBER'.                                           00499301
011410     05  FILLER                       PIC X(01)   VALUE SPACES.   00499401
011410     05  FILLER                       PIC X(04)   VALUE           00499501
011200         'SCAC'.                                                  00499601
011410     05  FILLER                       PIC X(02)   VALUE SPACES.   00499701
011410     05  FILLER                       PIC X(10)   VALUE           00499801
011200         'VEHICLE'.                                               00499903
011410     05  FILLER                       PIC X(01)   VALUE SPACES.   00500023
011410     05  FILLER                       PIC X(02)   VALUE           00500123
011200         'TY'.                                                    00500223
011410     05  FILLER                       PIC X(02)   VALUE SPACES.   00500301
011410     05  FILLER                       PIC X(16)   VALUE           00500423
011200         'WMOS SHIPMENT'.                                         00500523
011410     05  FILLER                       PIC X(01)   VALUE SPACES.   00500623
011410     05  FILLER                       PIC X(16)   VALUE           00500701
011200         'SCANNED TIME'.                                          00500801
011410     05  FILLER                       PIC X(02)   VALUE SPACES.   00500923
011410     05  FILLER                       PIC X(15)   VALUE           00501023
011200         'ASSOC. NAME'.                                           00501123
010900 01  HEADING-LINE4.                                               00501201
011000     05  FILLER                       PIC X(1)    VALUE SPACES.   00501301
011100     05  FILLER                       PIC X(12)   VALUE           00501401
011200         '------------'.                                          00501501
011410     05  FILLER                       PIC X(02)   VALUE SPACES.   00501601
011410     05  FILLER                       PIC X(08)   VALUE           00501701
011200         '--------'.                                              00501801
011410     05  FILLER                       PIC X(02)   VALUE SPACES.   00501901
011410     05  FILLER                       PIC X(04)   VALUE           00502010
011200         '----'.                                                  00502110
011410     05  FILLER                       PIC X(02)   VALUE SPACES.   00502201
011410     05  FILLER                       PIC X(05)   VALUE           00502301
011200         '-----'.                                                 00502401
011410     05  FILLER                       PIC X(01)   VALUE SPACES.   00502501
011410     05  FILLER                       PIC X(20)   VALUE           00502610
011200         '--------------------'.                                  00502710
011410     05  FILLER                       PIC X(01)   VALUE SPACES.   00502801
011410     05  FILLER                       PIC X(04)   VALUE           00502901
011200         '----'.                                                  00503001
011410     05  FILLER                       PIC X(02)   VALUE SPACES.   00503101
011410     05  FILLER                       PIC X(10)   VALUE           00503201
011200         '----------'.                                            00503301
011410     05  FILLER                       PIC X(01)   VALUE SPACES.   00503423
011410     05  FILLER                       PIC X(02)   VALUE           00503523
011200         '--'.                                                    00503623
011410     05  FILLER                       PIC X(02)   VALUE SPACES.   00503701
011410     05  FILLER                       PIC X(16)   VALUE           00503823
011200         '----------------'.                                      00503923
011410     05  FILLER                       PIC X(01)   VALUE SPACES.   00504023
011410     05  FILLER                       PIC X(16)   VALUE           00504101
011200         '----------------'.                                      00504201
011410     05  FILLER                       PIC X(02)   VALUE SPACES.   00504323
011410     05  FILLER                       PIC X(15)   VALUE           00504423
011200         '---------------'.                                       00504523
011500                                                                  00505001
011600 01  DETAIL-LINE-1.                                               00510001
011700     05  FILLER                       PIC X(01)   VALUE SPACES.   00520001
011910     05  DT1-PO                       PIC X(08).                  00560001
011921     05  FILLER                       PIC X(01)   VALUE '-'.      00570001
011930     05  DT1-RECEIVER                 PIC 999.                    00580012
011921     05  FILLER                       PIC X(02)   VALUE SPACES.   00581001
011930     05  DT1-SKU-NBR                  PIC X(08).                  00582001
011941     05  FILLER                       PIC X(02)   VALUE SPACES.   00590001
011930     05  DT1-LINE                     PIC ZZZ9.                   00591001
011941     05  FILLER                       PIC X(02)   VALUE SPACES.   00592001
011930     05  DT1-QTY                      PIC ZZ999.                  00593001
011941     05  FILLER                       PIC X(01)   VALUE SPACES.   00594001
011930     05  DT1-CASE-NBR                 PIC X(20).                  00595010
011941     05  FILLER                       PIC X(01)   VALUE SPACES.   00596001
011930     05  DT1-SCAC                     PIC X(04).                  00597001
011941     05  FILLER                       PIC X(02)   VALUE SPACES.   00598001
011930     05  DT1-VEHICLE                  PIC X(10).                  00598110
011941     05  FILLER                       PIC X(01)   VALUE SPACES.   00598223
011930     05  DT1-TYPE                     PIC X(02).                  00598323
011941     05  FILLER                       PIC X(02)   VALUE SPACES.   00598423
011930     05  DT1-WMS-SHPMT                PIC X(16).                  00599023
011941     05  FILLER                       PIC X(01)   VALUE SPACES.   00599123
011930     05  DT1-SCAN-TIME                PIC X(16).                  00599201
011941     05  FILLER                       PIC X(02)   VALUE SPACES.   00599323
011930     05  DT1-ASSOC-NAME               PIC X(15).                  00599423
012100                                                                  00600001
012230                                                                  00610001
012300 01  END-OF-REPORT-LINE.                                          00620001
012400     05  FILLER                       PIC X(55)   VALUE SPACES.   00630015
012410     05  FILLER                       PIC X(25)   VALUE           00640015
012500         '***** END OF REPORT *****'.                             00650015
012510     05  FILLER                       PIC X(52)   VALUE SPACES.   00660015
012511                                                                  00670001
012520 01  TOTAL-LINE-1.                                                00680001
012530     05  FILLER                       PIC X(08)   VALUE SPACES.   00690001
012540     05  FILLER                       PIC X(31)   VALUE           00700001
012550         'TOTAL ERROR CASES RECEIVED:'.                           00710004
012540     05  TL1-CASE-CNT                 PIC ZZZ,ZZ9.                00711001
012560     05  FILLER                       PIC X(86)   VALUE SPACES.   00720001
012600                                                                  00730001
000298*  COPYBOOK FOR RECEIPT PIX RECORD                                00731023
012700     COPY WSRD014.                                                00740002
000298*  COPYBOOK FOR ERROR RECORD                                      00740123
012700     COPY WSRD027.                                                00741002
000298*  COPYBOOK FOR XLKUT067                                          00741123
012700     COPY XLWS067.                                                00742023
013410                                                                  00750001
013500 01  CD-CPU-DATE.                                                 00760001
013600     05  CD-CPU-DATE-YY               PIC 9(02)      VALUE 0.     00770001
013700     05  CD-CPU-DATE-MM               PIC 9(02)      VALUE 0.     00780001
013800     05  CD-CPU-DATE-DD               PIC 9(02)      VALUE 0.     00790001
013900                                                                  00800001
014000 01  CT-CPU-TIME.                                                 00810001
014100     05  CT-CPU-TIME-HH               PIC 9(02)      VALUE 0.     00820001
014200     05  CT-CPU-TIME-MM               PIC 9(02)      VALUE 0.     00830001
014300     05  CT-CPU-TIME-SS               PIC 9(02)      VALUE 0.     00840001
014400     05  CT-CPU-TIME-HS               PIC 9(02)      VALUE 0.     00850001
014410                                                                  00860001
014500 01  PV-CD-TIME.                                                  00870001
014600     05  PV-CD-SS                     PIC 9(02)      VALUE 0.     00880001
014700     05  PV-CD-HS                     PIC 9(02)      VALUE 0.     00890001
014800                                                                  00900001
015500 01  PV-PROGRAM-VARIABLES.                                        00900105
090324     05  PV-HOLD-DC-LOCATION          PIC 9(04)      VALUE 0.     00901005
090325     05  PV-ABEND-CODE                PIC S9(04)     VALUE +0.    00901118
090325     05  PV-USER-NAME                 PIC X(15).                  00901223
090325     05  PV-SHPMT-TYPE                PIC X(01).                  00901323
014800                                                                  00902005
015500 01  PA-PROGRAM-ACCUMULATORS.                                     00910001
015700     05  PA-LINE-CNT                  PIC 9(03)      VALUE 99.    00930001
015900     05  PA-PAGE-CNT                  PIC 9(03)      VALUE 0.     00940001
015900     05  PA-CASE-CNT                  PIC 9(06)      VALUE 0.     00941001
016600                                                                  00950001
016700 01  PC-PROGRAM-CONTROLS.                                         00960001
017200     05  PC-MAX-LINES                 PIC 9(03)      VALUE 55.    00970001
017210                                                                  00980001
016700 01  DK-PROGRAM-KEYS.                                             00981018
017200     05  DK-DC-LOCATION               PIC S9(04) COMP.            00982018
017200     05  DK-EXT-SHP-ID                PIC X(20).                  00982123
017210                                                                  00983018
017220 01  PS-SWITCHES.                                                 00990001
017230     05  PS-EOF-SW                    PIC X(1)       VALUE 'N'.   01000001
017240         88  PS-INPUT-FILE-EOF                       VALUE 'Y'.   01010001
017250         88  PS-INPUT-FILE-NOT-EOF                   VALUE 'N'.   01020001
017300                                                                  01060001
089500 PROCEDURE DIVISION.                                              01070001
089700                                                                  01080001
090300 0000-MAINLINE.                                                   01090001
090301                                                                  01100001
090310     OPEN INPUT  ERROR-FILE                                       01110001
090320          OUTPUT ERROR-RPT.                                       01120001
090322                                                                  01130001
090323     PERFORM 0100-ACCEPT-CURR-DATE-TIME.                          01140016
090324     PERFORM 0200-READ-INPUT-FILE.                                01150016
090324     MOVE WS014-DC-LOCATION TO PV-HOLD-DC-LOCATION.               01151005
090325     PERFORM 0800-GET-DC-NAME.                                    01160016
090327                                                                  01161016
090328     IF PS-INPUT-FILE-EOF                                         01170001
552900        PERFORM 0600-PROCESS-HEADING-LINES                        01180016
090335     ELSE                                                         01190001
090355        PERFORM 0300-FILL-WRITE-DETAIL-LINE                       01200016
090356           UNTIL PS-INPUT-FILE-EOF                                01210001
090360     END-IF.                                                      01220001
090370                                                                  01230001
552900     PERFORM 0700-PROCESS-TOTAL-LINES.                            01230116
090334     PERFORM 0400-WRITE-EOF-RPT.                                  01231016
090370                                                                  01232002
091200     CLOSE ERROR-FILE                                             01240001
091300           ERROR-RPT.                                             01250001
091400                                                                  01260001
091420*    MOVE 4095 TO RETURN-CODE.                                    01280002
091440                                                                  01300001
091500     STOP RUN.                                                    01310001
096000                                                                  01320001
097200***************************************************************** 01330001
097300*     ACCEPT-CURR-DATE-TIME                                     * 01340001
097500***************************************************************** 01350001
097600 0100-ACCEPT-CURR-DATE-TIME.                                      01360016
098000                                                                  01370001
098100     ACCEPT CT-CPU-TIME FROM TIME.                                01380001
098110                                                                  01390001
098200     MOVE CT-CPU-TIME-HH         TO DP132O-RUN-HOUR.              01400001
098300     MOVE CT-CPU-TIME-MM         TO DP132O-RUN-MINUTE.            01410001
098400                                                                  01420001
098500     ACCEPT CD-CPU-DATE FROM DATE.                                01430001
098600     MOVE CD-CPU-DATE-MM         TO DP132O-RUN-MONTH.             01440001
098700     MOVE CD-CPU-DATE-DD         TO DP132O-RUN-DAY.               01450001
098800     MOVE CD-CPU-DATE-YY         TO DP132O-RUN-YEAR.              01460001
098900                                                                  01470001
548400****************************************************************  01480001
548700* READ INPUT ERROR FILE                                           01490001
548800****************************************************************  01500001
548900 0200-READ-INPUT-FILE.                                            01510016
548901                                                                  01520001
548910     READ ERROR-FILE INTO WS027-RECEIPT-PIX-ERROR-REC             01530002
548911        AT END                                                    01540001
548912           SET PS-INPUT-FILE-EOF      TO TRUE.                    01550021
548920                                                                  01560001
548920     MOVE WS027-FORMAT-RECORD(40:203) TO WS014-RECEIPT-PIX-RECORD.01561021
548920     ADD 1                            TO PA-CASE-CNT.             01561121
548920                                                                  01562002
549000****************************************************************  01570001
549100* FILL & WRITE DETAIL LINE                                        01580001
549200****************************************************************  01590001
549201                                                                  01600001
549210 0300-FILL-WRITE-DETAIL-LINE.                                     01610016
549211                                                                  01620001
548920     IF WS014-DC-LOCATION NOT = PV-HOLD-DC-LOCATION               01621009
090324         MOVE WS014-DC-LOCATION TO PV-HOLD-DC-LOCATION            01622009
552900         PERFORM 0700-PROCESS-TOTAL-LINES                         01623016
090325         PERFORM 0800-GET-DC-NAME                                 01623116
548920     END-IF.                                                      01624009
548920                                                                  01625009
549212     MOVE WS014-PO-NUMBER        TO DT1-PO.                       01630002
549213     MOVE WS014-REC-SEQ-NUMBER   TO DT1-RECEIVER.                 01640002
549213     MOVE WS014-SKU-NUMBER       TO DT1-SKU-NBR.                  01641002
549213     MOVE WS014-PO-LINE-NUMBER   TO DT1-LINE.                     01642002
549213     MOVE WS014-SKU-QTY          TO DT1-QTY.                      01643002
549213     MOVE WS014-CASE-NUMBER      TO DT1-CASE-NBR.                 01644002
549213     MOVE WS014-SCAC             TO DT1-SCAC.                     01645002
549213     MOVE WS014-VEHICLE          TO DT1-VEHICLE.                  01645110
549213     MOVE WS014-RCVD-SHPMT-NBR   TO DT1-WMS-SHPMT.                01646022
549213     STRING WS014-CRE-TMST(1:4)                                   01648010
549213            '/'                                                   01649010
549213            WS014-CRE-TMST(6:2)                                   01649110
549213            '/'                                                   01649210
549213            WS014-CRE-TMST(9:2)                                   01649310
549213            ' '                                                   01649410
549213            WS014-CRE-TMST(12:2)                                  01649510
549213            ':'                                                   01649610
549213            WS014-CRE-TMST(15:2)                                  01649712
549235                             DELIMITED BY SIZE                    01650011
549213                               INTO DT1-SCAN-TIME.                01650110
549235                                                                  01650223
549235* JAK - TEMP FIX FOR INVALID TRANS FROM EFC4                      01650332
549213*    PERFORM 0900-GET-USER-NAME.                                  01650432
549213*    MOVE PV-USER-NAME           TO DT1-ASSOC-NAME.               01650532
549213     IF WS014-CRE-USER-ID = ' '                                   01650632
000729        MOVE WS014-CRE-USER-ID     TO PV-USER-NAME                01650732
549213        MOVE 'UNKNOWN'             TO DT1-ASSOC-NAME              01650832
549213     ELSE                                                         01650932
549213        PERFORM 0900-GET-USER-NAME                                01651032
549213        MOVE PV-USER-NAME          TO DT1-ASSOC-NAME              01651132
549213     END-IF.                                                      01651232
549235* JAK - END                                                       01651332
549235                                                                  01651410
549213     PERFORM 1000-GET-SHPMT-TYPE.                                 01651523
549213     MOVE PV-SHPMT-TYPE          TO DT1-TYPE.                     01651623
549235                                                                  01652010
549236     PERFORM 0500-WRITE-REPORT-LINE.                              01660016
549237                                                                  01670001
090324     PERFORM 0200-READ-INPUT-FILE.                                01701016
549241                                                                  01710001
549252                                                                  01820001
549253****************************************************************  01830001
549254* WRITE EOF RPT                                                   01840001
549255****************************************************************  01850001
549260                                                                  01860001
549270 0400-WRITE-EOF-RPT.                                              01870016
549300                                                                  01880001
549562     WRITE ERROR-RPT-REC FROM END-OF-REPORT-LINE                  01970002
549563        AFTER ADVANCING 2 LINES.                                  01980002
549564                                                                  01990001
550420****************************************************************  02200001
550430* WRITE THE REPORT LINE AFTER ADVANCING ONE LINE                  02210001
550440****************************************************************  02220001
550450 0500-WRITE-REPORT-LINE.                                          02230016
550460                                                                  02240001
550470     IF PA-LINE-CNT > PC-MAX-LINES                                02250001
550480        PERFORM 0600-PROCESS-HEADING-LINES                        02260016
550490     END-IF.                                                      02270001
550491                                                                  02280001
550492     WRITE ERROR-RPT-REC FROM DETAIL-LINE-1                       02290002
550493         AFTER ADVANCING 1 LINE.                                  02300002
550494                                                                  02310001
550495     ADD 2 TO PA-LINE-CNT.                                        02320001
550496                                                                  02330001
552400****************************************************************  02360001
552700* CONTROL THE LOADING AND PRINTING OF THE HEADING LINES           02370001
552800****************************************************************  02380001
552900 0600-PROCESS-HEADING-LINES.                                      02390016
553300                                                                  02400001
553400     MOVE 'WSKRP002'             TO DP132O-PROGRAM-NAME.          02410002
553500     MOVE 1                      TO DP132O-REPORT-NUMBER.         02420001
553700     ADD 1                       TO PA-PAGE-CNT.                  02430001
553800     MOVE PA-PAGE-CNT            TO DP132O-PAGE-NUMBER.           02440001
553900                                                                  02450001
554000     WRITE ERROR-RPT-REC FROM DP132O-STANDRD-HEADER-132-COLS      02460002
554200        AFTER ADVANCING PAGE.                                     02470001
554300                                                                  02480001
554500     WRITE ERROR-RPT-REC FROM HEADING-LINE1                       02490002
554700        AFTER ADVANCING 2 LINES.                                  02500001
554710                                                                  02510001
011410     MOVE WS014-DC-LOCATION        TO HD2-DC-NBR.                 02511002
011410     MOVE XLT00010-LOC-NM          TO HD2-DC-NAME.                02513019
554720     WRITE ERROR-RPT-REC FROM HEADING-LINE2                       02520002
554730        AFTER ADVANCING 2 LINES.                                  02530002
554740                                                                  02540001
554720     WRITE ERROR-RPT-REC FROM HEADING-LINE3                       02541002
554730        AFTER ADVANCING 2 LINES.                                  02542002
554740                                                                  02543002
554720     WRITE ERROR-RPT-REC FROM HEADING-LINE4                       02544002
554730        AFTER ADVANCING 1 LINE.                                   02545002
554740                                                                  02546002
554800     MOVE SPACES TO ERROR-RPT-REC.                                02550002
554810                                                                  02560001
554900     WRITE ERROR-RPT-REC                                          02570002
555000         AFTER ADVANCING 1 LINE.                                  02580001
555100                                                                  02590001
555300     MOVE 9 TO PA-LINE-CNT.                                       02600002
555100                                                                  02601002
552400****************************************************************  02610002
552700* CONTROL THE LOADING AND PRINTING OF THE TOTAL LINES             02620002
552800****************************************************************  02630002
552900 0700-PROCESS-TOTAL-LINES.                                        02640016
553300                                                                  02650002
550470     IF PA-LINE-CNT > PC-MAX-LINES                                02651019
550480        PERFORM 0600-PROCESS-HEADING-LINES                        02652019
550490     END-IF.                                                      02653019
550491                                                                  02654019
553300     SUBTRACT 1                  FROM PA-CASE-CNT.                02660014
553800     MOVE PA-CASE-CNT            TO TL1-CASE-CNT.                 02690002
553900                                                                  02700002
554500     WRITE ERROR-RPT-REC FROM TOTAL-LINE-1                        02740003
554700        AFTER ADVANCING 2 LINES.                                  02750002
554710                                                                  02760002
554710     MOVE 1                      TO PA-CASE-CNT.                  02770013
554710     MOVE 70                     TO PA-LINE-CNT.                  02780002
554710                                                                  02781016
554710                                                                  02782016
552400****************************************************************  02790016
552700* GET THE NAME OF THE DC                                          02800016
552800****************************************************************  02810016
552900 0800-GET-DC-NAME.                                                02820016
553300                                                                  02830016
553300     MOVE WS014-DC-LOCATION      TO DK-DC-LOCATION.               02831018
553300                                                                  02832018
553300     EXEC SQL                                                     02840016
553300        SELECT  LOC_NM                                            02850016
553300         INTO  :XLT00010-LOC-NM                                   02870016
553300         FROM   XLT_LOC                                           02890016
553300        WHERE   LOC_NBR        = :DK-DC-LOCATION                  02900018
553300     END-EXEC.                                                    02920016
553300                                                                  02940016
000693     EVALUATE TRUE                                                02941016
000694         WHEN SQLCODE = 0                                         02942016
000694             CONTINUE                                             02943016
000694         WHEN SQLCODE = +100                                      02945016
000696             MOVE 'UNKNOWN'    TO XLT00010-LOC-NM                 02946016
000727                                                                  02949216
000728         WHEN OTHER                                               02949316
000729             MOVE SQLCODE TO SQLCODE2                             02949416
000730             DISPLAY '******************************************' 02949516
000731             DISPLAY '* ABEND                                   ' 02949616
000732             DISPLAY '* PROGRAM = WSKRP002                      ' 02949716
000733             DISPLAY '* PARAGRAPH = 0800-GET-DC-NAME'             02949816
000735             DISPLAY '** SQLCODE   = ' SQLCODE2                   02950016
000736             DISPLAY '******************************************' 02950116
000737             PERFORM 9100-SQL-ABEND                               02950216
000738     END-EVALUATE.                                                02950316
553300                                                                  02951016
553300                                                                  02952016
552400****************************************************************  02952423
552700* GET THE NAME OF THE CLIENT                                      02952523
552800****************************************************************  02952623
552900 0900-GET-USER-NAME.                                              02952723
553300                                                                  02952823
553300     INITIALIZE XL067-USER-COMMAREA.                              02952923
TEMP       DISPLAY WS014-CRE-USER-ID.                                   02953030
553300     MOVE WS014-CRE-USER-ID      TO XL067-KEY-USER-ID.            02953125
553300     SET XL067-BY-USER-ID        TO TRUE.                         02953225
553300     SET XL067-SELECT-KOHLS-USER TO TRUE.                         02953323
553300     MOVE 'WSKRP002'             TO XL067-ORIG-CALLING-PGM-NM.    02953428
553300                                                                  02953523
553300     CALL XL067-USER-PGM USING XL067-USER-COMMAREA.               02953630
553300                                                                  02953723
553300     EVALUATE TRUE                                                02954229
553300         WHEN XL067-SUCCESSFUL                                    02954329
553300             IF XL067-USER-NOT-FOUND                              02954429
000729                 MOVE WS014-CRE-USER-ID     TO PV-USER-NAME       02954529
000729             ELSE                                                 02954629
553300                 MOVE XL067-COMBINED-NAME-3 TO PV-USER-NAME       02954729
000729             END-IF                                               02954829
TEST               DISPLAY XL067-USER-FOUND-CODE ' '                    02954929
TEST                       XL067-COMBINED-NAME-3                        02955029
553300         WHEN OTHER                                               02955129
549235* JAK - TEMP FIX FOR INVALID TRANS FROM EFC4                      02955232
553300             IF XL067-USER-NOT-FOUND                              02955331
000729                 MOVE WS014-CRE-USER-ID     TO PV-USER-NAME       02955431
000729             ELSE                                                 02955531
000729             MOVE WS014-CRE-USER-ID     TO PV-USER-NAME           02955629
000730             DISPLAY '******************************************' 02955729
000731             DISPLAY '* ABEND                                   ' 02955829
000732             DISPLAY '* PROGRAM = WSKRP002                      ' 02955929
000733             DISPLAY '* PARAGRAPH = 0900-GET-USER-NAME'           02956029
000734             DISPLAY '* INVALID RETURN FROM XLKUT067'             02956129
000735             DISPLAY '** RETURN CODE = ' XL067-RETURN-CODE        02956229
000736             DISPLAY '******************************************' 02956329
000737             PERFORM 9100-SQL-ABEND                               02956429
000729             END-IF                                               02956531
000738     END-EVALUATE.                                                02956629
000738                                                                  02956729
000738                                                                  02956829
552400****************************************************************  02956929
552700* GET THE SHIPMENT TYPE CODE                                      02957029
552800****************************************************************  02957129
552900 1000-GET-SHPMT-TYPE.                                             02957229
553300                                                                  02957329
553300     MOVE WS014-RCVD-SHPMT-NBR   TO DK-EXT-SHP-ID.                02957429
553300                                                                  02957529
553300     EXEC SQL                                                     02957629
553300        SELECT  SOR_CDE                                           02957729
553300         INTO  :WST00001-SOR-CDE                                  02957829
553300         FROM   WST_SHPMT_XREF_HDR                                02957929
553300        WHERE   EXT_SHP_ID     = :DK-EXT-SHP-ID                   02958029
553300     END-EXEC.                                                    02958129
553300                                                                  02958229
000693     EVALUATE TRUE                                                02958329
000694         WHEN SQLCODE = 0                                         02958429
000694             EVALUATE TRUE                                        02958529
000694                 WHEN WST00001-SOR-CDE = 'SH'                     02958629
000694                     MOVE 'M'   TO PV-SHPMT-TYPE                  02958729
000694                 WHEN WST00001-SOR-CDE = 'RC'                     02958829
000694                     MOVE 'P'   TO PV-SHPMT-TYPE                  02958929
000694                 WHEN OTHER                                       02959029
000694                     MOVE ' '   TO PV-SHPMT-TYPE                  02959129
000694             END-EVALUATE                                         02959229
000694         WHEN SQLCODE = +100                                      02959329
000696             MOVE ' '           TO PV-SHPMT-TYPE                  02959429
000727                                                                  02959529
000728         WHEN OTHER                                               02959629
000729             MOVE SQLCODE TO SQLCODE2                             02959729
000730             DISPLAY '******************************************' 02959829
000731             DISPLAY '* ABEND                                   ' 02959929
000732             DISPLAY '* PROGRAM = WSKRP002                      ' 02960029
000733             DISPLAY '* PARAGRAPH = 1000-GET-SHPMT-TYPE'          02960129
000735             DISPLAY '** SQLCODE   = ' SQLCODE2                   02960229
000736             DISPLAY '******************************************' 02960329
000737             PERFORM 9100-SQL-ABEND                               02960429
000738     END-EVALUATE.                                                02960529
553300                                                                  02960629
553300                                                                  02960729
000777******************************************************************02960829
000778* 9100-SQL-ABEND - PERFORMS THE ABEND FOR THE PROGRAM IN THE      02960929
000779* EVENT THAT AN SQL ERROR OR WARNING CODE OCCURS.                 02961029
000780******************************************************************02961129
000781 9100-SQL-ABEND.                                                  02961229
000782                                                                  02961329
000783* THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION STATE-    02961429
000784* MENTS THAT ARE REQUIRED TO UTILIZE THE DB2 ABEND MODULE         02962016
000785* 'DSNTIAR' AND CONVERT THE SQLCA INFORMATION INTO A READABLE     02970016
000786* FORMAT                                                          02980016
000787     COPY DPPD004.                                                02990016
000788                                                                  03000016
000789     MOVE +4013               TO PV-ABEND-CODE.                   03010017
000790     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         03020016
000791                                                                  03030016
