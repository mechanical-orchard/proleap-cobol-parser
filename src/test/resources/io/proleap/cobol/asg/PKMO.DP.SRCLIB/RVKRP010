00001 ******************************************************************01/03/96
00002  IDENTIFICATION DIVISION.                                         RVKRP010
00003 ******************************************************************   LV002
00004                                                                   RVKRP010
00005  PROGRAM-ID.             RVKRP010.                                RVKRP010
00006  AUTHOR.                 MICHAEL WALTERS.                         RVKRP010
00007  INSTALLATION.           KOHLS.                                   RVKRP010
00008  DATE-WRITTEN            AUGUST, 1995.                            RVKRP010
00009  DATE-COMPILED.                                                   RVKRP010
00010                                                                   RVKRP010
00011 ******************************************************************RVKRP010
00012 *  THIS PROGRAM WILL SUMMARIZE ALL THE "SHIPPED" DEFECTIVE ITEMS  RVKRP010
00013 *  AND CREATE THE VENDOR SUMMARY REPORT.                          RVKRP010
00014 ******************************************************************RVKRP010
00015                                                                   RVKRP010
00016 ******************************************************************RVKRP010
00017  ENVIRONMENT DIVISION.                                            RVKRP010
00018 ******************************************************************RVKRP010
00019                                                                   RVKRP010
00020  CONFIGURATION SECTION.                                           RVKRP010
00021                                                                   RVKRP010
00022  SOURCE-COMPUTER.        IBM-3090.                                RVKRP010
00023  OBJECT-COMPUTER.        IBM-3090.                                RVKRP010
00024                                                                   RVKRP010
00025  INPUT-OUTPUT SECTION.                                            RVKRP010
00026                                                                   RVKRP010
00027  FILE-CONTROL.                                                    RVKRP010
00028                                                                   RVKRP010
00029      SELECT RTV-REPORT-EXTRACT                                    RVKRP010
00030          ASSIGN TO IN01.                                          RVKRP010
00031                                                                   RVKRP010
00032      SELECT DI-DEFECT-ITEM-REPORT                                 RVKRP010
00033          ASSIGN TO RPT01.                                         RVKRP010
00034                                                                   RVKRP010
00035 ******************************************************************RVKRP010
00036  DATA DIVISION.                                                   RVKRP010
00037 ******************************************************************RVKRP010
00038                                                                   RVKRP010
00039  FILE SECTION.                                                    RVKRP010
00040                                                                   RVKRP010
00041  FD  RTV-REPORT-EXTRACT                                           RVKRP010
00042      RECORDING MODE IS F                                          RVKRP010
00043      LABEL RECORDS ARE STANDARD                                   RVKRP010
00044      BLOCK CONTAINS 0 RECORDS.                                    RVKRP010
00045                                                                   RVKRP010
00046  01  RTV-REPORT-EXTRACT-RECORD       PIC  X(200).                 RVKRP010
00047                                                                   RVKRP010
00048  FD  DI-DEFECT-ITEM-REPORT                                        RVKRP010
00049      RECORDING MODE IS F                                          RVKRP010
00050      LABEL RECORDS ARE STANDARD                                   RVKRP010
00051      BLOCK CONTAINS 0 RECORDS.                                    RVKRP010
00052                                                                   RVKRP010
00053  01  DI-DEFECT-ITEM-LINE             PIC  X(132).                 RVKRP010
00054                                                                   RVKRP010
00055 ******************************************************************RVKRP010
00056  WORKING-STORAGE SECTION.                                         RVKRP010
00057 ******************************************************************RVKRP010
00058                                                                   RVKRP010
00059 *                                                                 RVKRP010
00060 *  STANDARD REPORT HEADER FOR A 132 COLUMN REPORT.                RVKRP010
00061 *                                                                 RVKRP010
00062      COPY DPWS132O.                                               RVKRP010
00063 *                                                                 RVKRP010
00064 *  WORK AREA FOR SQL ERROR ROUTINE 'DSNTIAR'                      RVKRP010
00065 *                                                                 RVKRP010
00066      COPY DPWS004.                                                RVKRP010
00067                                                                   RVKRP010
00068 *                                                                 RVKRP010
00069 *  RECORD LAYOUT OF THE RTV EXTRACT FILE.                         RVKRP010
00070 *                                                                 RVKRP010
00071      COPY RVWS010.                                                RVKRP010
00072                                                                   RVKRP010
00073                                                                   RVKRP010
00074  01  ABEND-CODE                          PIC S9(04) VALUE +0      RVKRP010
00075                                                      COMP SYNC.   RVKRP010
00076  01  PH2-PAGE-HEADING-MONTHLY.                                    RVKRP010
00077      05  FILLER                          PIC  X(43)  VALUE SPACE. RVKRP010
00078      05  FILLER                          PIC  X(45)  VALUE        RVKRP010
00079          'RETURN-TO-VENDOR VENDOR MONTLY SUMMARY REPORT'.         RVKRP010
00080                                                                   RVKRP010
00081  01  PH2-PAGE-HEADING-YTD.                                        RVKRP010
00082      05  FILLER                          PIC  X(41)  VALUE SPACE. RVKRP010
00083      05  FILLER                          PIC  X(51)  VALUE        RVKRP010
00084          'RETURN-TO-VENDOR VENDOR YEAR TO DATE SUMMARY REPORT'.   RVKRP010
                                                                                
00076  01  PH2-PAGE-HEADING-WEEKLY.                                     RVKRP010
00077      05  FILLER                          PIC  X(43)  VALUE SPACE. RVKRP010
00078      05  FILLER                          PIC  X(45)  VALUE        RVKRP010
00079          'RETURN-TO-VENDOR VENDOR WEEKLY SUMMARY REPORT'.         RVKRP010
00080                                                                   RVKRP010
00085                                                                   RVKRP010
00086  01  PH3-PAGE-HEADING-3.                                          RVKRP010
00087      05  FILLER                          PIC  X(44)  VALUE SPACE. RVKRP010
00088      05  FILLER                          PIC  X(12)  VALUE        RVKRP010
00089          'BEGIN DATE: '.                                          RVKRP010
00090      05  PH3-START-DATE                  PIC  X(10)  VALUE SPACE. RVKRP010
00091      05  FILLER                          PIC  X(13)  VALUE        RVKRP010
00092          ' - END DATE: '.                                         RVKRP010
00093      05  PH3-END-DATE                    PIC  X(10)  VALUE SPACE. RVKRP010
00094      05  FILLER                          PIC  X(42)  VALUE SPACE. RVKRP010
00095                                                                   RVKRP010
00096  01  DH1-DETAIL-HEADING-1.                                        RVKRP010
00097      05  FILLER                          PIC  X(07)  VALUE SPACES.   CL**2
00098      05  FILLER                          PIC  X(15)  VALUE SPACES.   CL**2
00099      05  FILLER                          PIC  X(01)  VALUE SPACES.RVKRP010
00100      05  FILLER                          PIC  X(09)  VALUE        RVKRP010
00101          'DUNS     '.                                             RVKRP010
00102      05  FILLER                          PIC  X(02)  VALUE SPACES.RVKRP010
00103      05  FILLER                          PIC  X(03)  VALUE        RVKRP010
00104          'DPT'.                                                   RVKRP010
00105      05  FILLER                          PIC  X(02)  VALUE SPACES.RVKRP010
00106      05  FILLER                          PIC  X(15)  VALUE SPACES.RVKRP010
00107      05  FILLER                          PIC  X(02)  VALUE SPACES.RVKRP010
00108      05  FILLER                          PIC  X(20)  VALUE        RVKRP010
00109          ' DEBITED & RETURNED '.                                  RVKRP010
00110      05  FILLER                          PIC  X(03)  VALUE SPACES.RVKRP010
00111      05  FILLER                          PIC  X(20)  VALUE        RVKRP010
00112          ' DEBITED & DESTROYED'.                                  RVKRP010
00113      05  FILLER                          PIC  X(03)  VALUE SPACES.RVKRP010
00114      05  FILLER                          PIC  X(20)  VALUE        RVKRP010
00115          ' MARKED OUT OF STOCK'.                                  RVKRP010
00116                                                                   RVKRP010
00117  01  DH2-DETAIL-HEADING-2.                                        RVKRP010
00118      05  FILLER                          PIC  X(07)  VALUE SPACES.   CL**2
00119      05  FILLER                          PIC  X(15)  VALUE           CL**2
00120          'VENDOR NAME    '.                                       RVKRP010
00121      05  FILLER                          PIC  X(01)  VALUE SPACES.RVKRP010
00122      05  FILLER                          PIC  X(09)  VALUE        RVKRP010
00123          'NUMBER   '.                                             RVKRP010
00124      05  FILLER                          PIC  X(02)  VALUE SPACES.RVKRP010
00125      05  FILLER                          PIC  X(03)  VALUE        RVKRP010
00126          'NBR'.                                                   RVKRP010
00127      05  FILLER                          PIC  X(01)  VALUE SPACES.RVKRP010
00128      05  FILLER                          PIC  X(15)  VALUE        RVKRP010
00129          'DPT DESCRIPTION'.                                       RVKRP010
00130      05  FILLER                          PIC  X(02)  VALUE SPACES.RVKRP010
00131      05  FILLER                          PIC  X(07)  VALUE        RVKRP010
00132          '    QTY'.                                               RVKRP010
00133      05  FILLER                          PIC  X(01)  VALUE        RVKRP010
00134          ' '.                                                     RVKRP010
00135      05  FILLER                          PIC  X(12)  VALUE        RVKRP010
00136          '       COST '.                                          RVKRP010
00137      05  FILLER                          PIC  X(03)  VALUE SPACES.RVKRP010
00138      05  FILLER                          PIC  X(07)  VALUE        RVKRP010
00139          '    QTY'.                                               RVKRP010
00140      05  FILLER                          PIC  X(01)  VALUE        RVKRP010
00141          ' '.                                                     RVKRP010
00142      05  FILLER                          PIC  X(12)  VALUE        RVKRP010
00143          '       COST '.                                          RVKRP010
00144      05  FILLER                          PIC  X(03)  VALUE SPACES.RVKRP010
00145      05  FILLER                          PIC  X(07)  VALUE        RVKRP010
00146          '    QTY'.                                               RVKRP010
00147      05  FILLER                          PIC  X(01)  VALUE        RVKRP010
00148          ' '.                                                     RVKRP010
00149      05  FILLER                          PIC  X(12)  VALUE        RVKRP010
00150          '       COST '.                                          RVKRP010
00151                                                                   RVKRP010
00152  01  DHD-DETAIL-HEADING-DASHES.                                   RVKRP010
00153      05  FILLER                          PIC  X(07)  VALUE SPACES.   CL**2
00154      05  FILLER                          PIC  X(15)  VALUE           CL**2
00155          '_______________'.                                       RVKRP010
00156      05  FILLER                          PIC  X(01)  VALUE SPACES.RVKRP010
00157      05  FILLER                          PIC  X(09)  VALUE        RVKRP010
00158          '_________'.                                             RVKRP010
00159      05  FILLER                          PIC  X(02)  VALUE SPACES.RVKRP010
00160      05  FILLER                          PIC  X(03)  VALUE        RVKRP010
00161          '___'.                                                   RVKRP010
00162      05  FILLER                          PIC  X(01)  VALUE SPACES.RVKRP010
00163      05  FILLER                          PIC  X(15)  VALUE        RVKRP010
00164          '_______________'.                                       RVKRP010
00165      05  FILLER                          PIC  X(02)  VALUE SPACES.RVKRP010
00166      05  FILLER                          PIC  X(07)  VALUE        RVKRP010
00167          '_______'.                                               RVKRP010
00168      05  FILLER                          PIC  X(01)  VALUE        RVKRP010
00169          ' '.                                                     RVKRP010
00170      05  FILLER                          PIC  X(13)  VALUE        RVKRP010
00171          '_____________'.                                         RVKRP010
00172      05  FILLER                          PIC  X(02)  VALUE SPACES.RVKRP010
00173      05  FILLER                          PIC  X(07)  VALUE        RVKRP010
00174          '_______'.                                               RVKRP010
00175      05  FILLER                          PIC  X(01)  VALUE        RVKRP010
00176          ' '.                                                     RVKRP010
00177      05  FILLER                          PIC  X(13)  VALUE        RVKRP010
00178          '_____________'.                                         RVKRP010
00179      05  FILLER                          PIC  X(02)  VALUE SPACES.RVKRP010
00180      05  FILLER                          PIC  X(07)  VALUE        RVKRP010
00181          '_______'.                                               RVKRP010
00182      05  FILLER                          PIC  X(01)  VALUE        RVKRP010
00183          ' '.                                                     RVKRP010
00184      05  FILLER                          PIC  X(13)  VALUE        RVKRP010
00185          '_____________'.                                         RVKRP010
00186                                                                   RVKRP010
00187                                                                   RVKRP010
00188  01  DL-DETAIL-LINE.                                              RVKRP010
00189      05  FILLER                          PIC  X(07)  VALUE SPACES.   CL**2
00190      05  DL-VND-NAME                     PIC  X(15).              RVKRP010
00191      05  FILLER                          PIC  X(01)  VALUE SPACES.RVKRP010
00192      05  DL-DUNS-NBR                     PIC  X(09).              RVKRP010
00193      05  FILLER                          PIC  X(02)  VALUE SPACES.RVKRP010
00194      05  DL-DPT-NBR                      PIC  X(03).              RVKRP010
00195      05  FILLER                          PIC  X(01)  VALUE SPACES.RVKRP010
00196      05  DL-DPT-DESC                     PIC  X(15).              RVKRP010
00197      05  FILLER                          PIC  X(02)  VALUE SPACES.RVKRP010
00198      05  DL-DR-QTY                       PIC  ZZZ,ZZ9.            RVKRP010
00199      05  FILLER                          PIC  X(01)  VALUE SPACES.RVKRP010
00200      05  DL-DR-COST                      PIC  ZZ,ZZZ,ZZ9.99.      RVKRP010
00201      05  FILLER                          PIC  X(02)  VALUE SPACES.RVKRP010
00202      05  DL-DD-QTY                       PIC  ZZZ,ZZ9.            RVKRP010
00203      05  FILLER                          PIC  X(01)  VALUE SPACES.RVKRP010
00204      05  DL-DD-COST                      PIC  ZZ,ZZZ,ZZ9.99.      RVKRP010
00205      05  FILLER                          PIC  X(02)  VALUE SPACES.RVKRP010
00206      05  DL-MO-QTY                       PIC  ZZZ,ZZ9.            RVKRP010
00207      05  FILLER                          PIC  X(01)  VALUE SPACES.RVKRP010
00208      05  DL-MO-COST                      PIC  ZZ,ZZZ,ZZ9.99.      RVKRP010
00209                                                                   RVKRP010
00210  01  TL-TOTAL-LINE-DASHES.                                        RVKRP010
00211      05  FILLER                          PIC  X(07)  VALUE SPACES.   CL**2
00212      05  FILLER                          PIC  X(15)  VALUE SPACES.   CL**2
00213      05  FILLER                          PIC  X(01)  VALUE SPACES.RVKRP010
00214      05  FILLER                          PIC  X(09)  VALUE SPACES.RVKRP010
00215      05  FILLER                          PIC  X(02)  VALUE SPACES.RVKRP010
00216      05  FILLER                          PIC  X(03)  VALUE SPACES.RVKRP010
00217      05  FILLER                          PIC  X(01)  VALUE SPACES.RVKRP010
00218      05  FILLER                          PIC  X(15)  VALUE SPACES.RVKRP010
00219      05  FILLER                          PIC  X(02)  VALUE SPACES.RVKRP010
00220      05  FILLER                          PIC  X(07)  VALUE        RVKRP010
00221          '_______'.                                               RVKRP010
00222      05  FILLER                          PIC  X(01)  VALUE        RVKRP010
00223          ' '.                                                     RVKRP010
00224      05  FILLER                          PIC  X(13)  VALUE        RVKRP010
00225          '_____________'.                                         RVKRP010
00226      05  FILLER                          PIC  X(02)  VALUE SPACES.RVKRP010
00227      05  FILLER                          PIC  X(07)  VALUE        RVKRP010
00228          '_______'.                                               RVKRP010
00229      05  FILLER                          PIC  X(01)  VALUE        RVKRP010
00230          ' '.                                                     RVKRP010
00231      05  FILLER                          PIC  X(13)  VALUE        RVKRP010
00232          '_____________'.                                         RVKRP010
00233      05  FILLER                          PIC  X(02)  VALUE SPACES.RVKRP010
00234      05  FILLER                          PIC  X(07)  VALUE        RVKRP010
00235          '_______'.                                               RVKRP010
00236      05  FILLER                          PIC  X(01)  VALUE        RVKRP010
00237          ' '.                                                     RVKRP010
00238      05  FILLER                          PIC  X(13)  VALUE        RVKRP010
00239          '_____________'.                                         RVKRP010
00240                                                                   RVKRP010
00241                                                                   RVKRP010
00242                                                                   RVKRP010
00243  01  TL-TOTAL-LINE.                                               RVKRP010
00244      05  FILLER                          PIC  X(05)  VALUE SPACES.   CL**2
00245      05  FILLER                          PIC  X(01)  VALUE SPACES.RVKRP010
00246      05  FILLER                          PIC  X(07)  VALUE SPACES.RVKRP010
00247      05  TL-TOTAL-DESCRIPTION            PIC  X(30)  VALUE SPACES.RVKRP010
00248      05  FILLER                          PIC  X(08)  VALUE        RVKRP010
00249          ' TOTAL: '.                                              RVKRP010
00250      05  FILLER                          PIC  X(04)  VALUE SPACES.RVKRP010
00251      05  TL-DR-QTY                       PIC  ZZZ,ZZ9.            RVKRP010
00252      05  FILLER                          PIC  X(01)  VALUE SPACES.RVKRP010
00253      05  TL-DR-COST                      PIC  ZZ,ZZZ,ZZ9.99.      RVKRP010
00254      05  FILLER                          PIC  X(02)  VALUE SPACES.RVKRP010
00255      05  TL-DD-QTY                       PIC  ZZZ,ZZ9.            RVKRP010
00256      05  FILLER                          PIC  X(01)  VALUE SPACES.RVKRP010
00257      05  TL-DD-COST                      PIC  ZZ,ZZZ,ZZ9.99.      RVKRP010
00258      05  FILLER                          PIC  X(02)  VALUE SPACES.RVKRP010
00259      05  TL-MO-QTY                       PIC  ZZZ,ZZ9.            RVKRP010
00260      05  FILLER                          PIC  X(01)  VALUE SPACES.RVKRP010
00261      05  TL-MO-COST                      PIC  ZZ,ZZZ,ZZ9.99.      RVKRP010
00262                                                                   RVKRP010
00263  01  BLANK-LINE.                                                  RVKRP010
00264      05  FILLER                          PIC  X(132) VALUE SPACE. RVKRP010
00265                                                                   RVKRP010
00266  01  END-OF-REPORT-LINE.                                          RVKRP010
00267      05  FILLER                          PIC  X(88)  VALUE SPACE. RVKRP010
00268      05  FILLER                          PIC  X(25)  VALUE        RVKRP010
00269          '***** END OF REPORT *****'.                             RVKRP010
00270      05  FILLER                          PIC  X(87)  VALUE SPACE. RVKRP010
00271                                                                   RVKRP010
00272  01  ER-EMPTY-REPORT-LINE.                                        RVKRP010
00273      05  FILLER                          PIC  X(42)  VALUE SPACE. RVKRP010
00274      05  FILLER                          PIC  X(48)  VALUE        RVKRP010
00275          '*** NO DATA SATISFIES THE SELECTION CRITERIA ***'.      RVKRP010
00276      05  FILLER                          PIC  X(42)  VALUE SPACE. RVKRP010
00277                                                                   RVKRP010
00278  01  PA-PROGRAM-ACCUMULATORS.                                     RVKRP010
00279      05  PA-VND-TOTALS.                                           RVKRP010
00280          10 PA-DR-VND-QTY                PIC S9(06)  VALUE +0     RVKRP010
00281                                                      COMP-3.      RVKRP010
00282          10 PA-DR-VND-COST               PIC S9(08)V99            RVKRP010
00283                                                      VALUE +0     RVKRP010
00284                                                      COMP-3.      RVKRP010
00285                                                                   RVKRP010
00286          10 PA-DD-VND-QTY                PIC S9(06)  VALUE +0     RVKRP010
00287                                                      COMP-3.      RVKRP010
00288          10 PA-DD-VND-COST               PIC S9(08)V99            RVKRP010
00289                                                      VALUE +0     RVKRP010
00290                                                      COMP-3.      RVKRP010
00291                                                                   RVKRP010
00292          10 PA-MO-VND-QTY                PIC S9(06)  VALUE +0     RVKRP010
00293                                                      COMP-3.      RVKRP010
00294          10 PA-MO-VND-COST               PIC S9(08)V99            RVKRP010
00295                                                      VALUE +0     RVKRP010
00296                                                      COMP-3.      RVKRP010
00297      05  PA-DPT-TOTALS.                                           RVKRP010
00298          10 PA-DR-DPT-QTY                PIC S9(06)  VALUE +0     RVKRP010
00299                                                      COMP-3.      RVKRP010
00300          10 PA-DR-DPT-COST               PIC S9(08)V99            RVKRP010
00301                                                      VALUE +0     RVKRP010
00302                                                      COMP-3.      RVKRP010
00303                                                                   RVKRP010
00304          10 PA-DD-DPT-QTY                PIC S9(06)  VALUE +0     RVKRP010
00305                                                      COMP-3.      RVKRP010
00306          10 PA-DD-DPT-COST               PIC S9(08)V99            RVKRP010
00307                                                      VALUE +0     RVKRP010
00308                                                      COMP-3.      RVKRP010
00309                                                                   RVKRP010
00310          10 PA-MO-DPT-QTY                PIC S9(06)  VALUE +0     RVKRP010
00311                                                      COMP-3.      RVKRP010
00312          10 PA-MO-DPT-COST               PIC S9(08)V99            RVKRP010
00313                                                      VALUE +0     RVKRP010
00314                                                      COMP-3.      RVKRP010
00315      05  PA-GRAND-TOTALS.                                         RVKRP010
00316          10 PA-DR-GRAND-QTY              PIC S9(06)  VALUE +0     RVKRP010
00317                                                      COMP-3.      RVKRP010
00318          10 PA-DR-GRAND-COST             PIC S9(08)V99            RVKRP010
00319                                                      VALUE +0     RVKRP010
00320                                                      COMP-3.      RVKRP010
00321          10 PA-DD-GRAND-QTY              PIC S9(06)  VALUE +0     RVKRP010
00322                                                      COMP-3.      RVKRP010
00323          10 PA-DD-GRAND-COST             PIC S9(08)V99            RVKRP010
00324                                                      VALUE +0     RVKRP010
00325                                                      COMP-3.      RVKRP010
00326          10 PA-MO-GRAND-QTY              PIC S9(06)  VALUE +0     RVKRP010
00327                                                      COMP-3.      RVKRP010
00328          10 PA-MO-GRAND-COST             PIC S9(08)V99            RVKRP010
00329                                                      VALUE +0     RVKRP010
00330                                                      COMP-3.      RVKRP010
00331                                                                   RVKRP010
00332  01  PC-CONSTANTS.                                                RVKRP010
00333      05  PC-COMMIT-INTERVAL              PIC  9(02)  VALUE 10.    RVKRP010
00334      05  PC-MAX-REFERRAL-CODES           PIC S9(04)  VALUE +7     RVKRP010
00335                                                      COMP SYNC.   RVKRP010
00336 * 6 LPI -- 14 X 8.5 PAPER (6 * 8.5 = 51)                          RVKRP010
00337      05  PC-MAX-REPORT-LINES             PIC S9(04)  VALUE +55    RVKRP010
00338                                                      COMP SYNC.   RVKRP010
00339      05  PC-ROW-NOT-FOUND                PIC S9(04)  VALUE +100   RVKRP010
00340                                                      COMP SYNC.   RVKRP010
00341      05  PC-ZERO                         PIC  9(01)  VALUE 0.     RVKRP010
00342      05  PC-ONE                          PIC  9(01)  VALUE 1.     RVKRP010
00343      05  PC-TWO                          PIC  9(01)  VALUE 2.     RVKRP010
00344      05  PC-THREE                        PIC  9(01)  VALUE 3.     RVKRP010
00345      05  PC-FOUR                         PIC  9(01)  VALUE 4.     RVKRP010
00346      05  PC-EIGHT                        PIC  9(01)  VALUE 8.     RVKRP010
00347      05  PC-NINE                         PIC  9(01)  VALUE 9.     RVKRP010
00348      05  PC-KOHLS-OPERATING-COMPANY      PIC  X(02)  VALUE '03'.  RVKRP010
00349      05  PC-CURRENT-PROGRAM-NAME         PIC  X(08)  VALUE        RVKRP010
00350          'RVKRP010'.                                              RVKRP010
00351      05  PC-CURRENT-JOB-NAME             PIC  X(08)  VALUE        RVKRP010
00352          'RVK505  '.                                              RVKRP010
00353      05  PC-SKU-DESC-ZERO                PIC  X(15)  VALUE        RVKRP010
00354          'V E N D O R    '.                                       RVKRP010
00357      05  PC-MBS-SYSTEM-CODE-RV           PIC  X(02)  VALUE 'RV'.  RVKRP010
00358      05  PC-MBS-OP-CO-03                 PIC  X(02)  VALUE '03'.  RVKRP010
00359      05  PC-PGM-DPKUT039                 PIC  X(08)               RVKRP010
00360                                          VALUE 'DPKUT039'.        RVKRP010
00361                                                                   RVKRP010
00362  01  PS-PROGRAM-SWITCHES.                                         RVKRP010
00363                                                                   RVKRP010
00364      05  PS-END-OF-EXTRACT-FILE-IND      PIC  X(01)  VALUE 'N'.   RVKRP010
00365          88  PS-END-OF-EXTRACT-FILE                  VALUE 'Y'.   RVKRP010
00366          88  PS-NOT-END-OF-EXTRACT-FILE              VALUE 'N'.   RVKRP010
00367                                                                   RVKRP010
00368      05  PS-NO-DATA-IND                  PIC  X(01)  VALUE 'N'.   RVKRP010
00369          88  PS-NO-DATA                              VALUE 'N'.   RVKRP010
00370          88  PS-DATA                                 VALUE 'Y'.   RVKRP010
00371                                                                   RVKRP010
00372      05  PS-TOTAL-TYPE-PRINT-IND         PIC  X(01)  VALUE ' '.   RVKRP010
00373          88  PS-PRINT-DPT-TOTAL                      VALUE '1'.   RVKRP010
00374          88  PS-PRINT-VND-TOTAL                      VALUE '2'.   RVKRP010
00375          88  PS-PRINT-FCLTY-TOTAL                    VALUE '3'.   RVKRP010
00376          88  PS-PRINT-GRAND-TOTAL                    VALUE '4'.   RVKRP010
00377                                                                   RVKRP010
00378  01  PV-PROGRAM-VARIABLES.                                        RVKRP010
00379      05  PV-PAGE-COUNT                   PIC S9(04)  VALUE +0     RVKRP010
00380                                                      COMP SYNC.   RVKRP010
00381      05  PV-LINE-COUNT                   PIC S9(04)  VALUE +0     RVKRP010
00382                                                      COMP SYNC.   RVKRP010
00383                                                                   RVKRP010
00384      05  PV-CHAR-COUNT                   PIC S9(02)  VALUE +0     RVKRP010
00385                                                      COMP SYNC.   RVKRP010
00386      05  PV-HOLD-DUNS-NBR                PIC  X(09).              RVKRP010
00387      05  PV-HOLD-VND-NAME                PIC  X(30) USAGE DISPLAY.RVKRP010
00388      05  PV-HOLD-DPT-NBR                 PIC  X(03).              RVKRP010
00389      05  PV-HOLD-DPT-DESC                PIC  X(25).              RVKRP010
00390      05  PV-HOLD-OPER-UNT-ID             PIC S9(04) COMP.         RVKRP010
00391      05  PV-RPT-TYPE                     PIC  X(1).               RVKRP010
00392          88  PV-MONTHLY-REPORT           VALUE 'M'.               RVKRP010
00393          88  PV-YEAR-TO-DATE-REPORT      VALUE 'Y'.               RVKRP010
00393          88  PV-WEEKLY-REPORT            VALUE 'W'.               RVKRP010
00394 *                                                                 RVKRP010
00395      05  PV-START-DATE.                                           RVKRP010
00396          10  PV-START-MONTH              PIC  9(02).              RVKRP010
00397          10  FILLER                      PIC  X(01) VALUE '/'.    RVKRP010
00398          10  PV-START-DAY                PIC  9(02).              RVKRP010
00399          10  FILLER                      PIC  X(01) VALUE '/'.    RVKRP010
00400          10  PV-START-CENTURY            PIC  9(02).              RVKRP010
00401          10  PV-START-YEAR               PIC  9(02).              RVKRP010
00402      05  PV-END-DATE.                                             RVKRP010
00403          10  PV-END-MONTH                PIC  9(02).              RVKRP010
00404          10  FILLER                      PIC  X(01) VALUE '/'.    RVKRP010
00405          10  PV-END-DAY                  PIC  9(02).              RVKRP010
00406          10  FILLER                      PIC  X(01) VALUE '/'.    RVKRP010
00407          10  PV-END-CENTURY              PIC  9(02).              RVKRP010
00408          10  PV-END-YEAR                 PIC  9(02).              RVKRP010
00409      05  PV-REPORT-LINE                 PIC X(132).               RVKRP010
00410      05  PV-TOTAL-DESCRIPTION           PIC X(30) VALUE SPACES    RVKRP010
00411                                                   JUST RIGHT.     RVKRP010
00412      05  PV-VENDOR-TOTAL-DESC.                                    RVKRP010
00413          10 FILLER                       PIC  X(01)               RVKRP010
00414             OCCURS 30 TIMES DEPENDING ON PV-CHAR-COUNT.           RVKRP010
00415                                                                   RVKRP010
00416                                                                   RVKRP010
00417  01  ST-SYSTEM-TIME.                                              RVKRP010
00418      05  ST-SYSTEM-HOUR                  PIC  9(02)  VALUE ZEROS. RVKRP010
00419      05  ST-SYSTEM-MINUTE                PIC  9(02)  VALUE ZEROS. RVKRP010
00420                                                                   RVKRP010
00421 *                                                                 RVKRP010
00422 ******************************************************************RVKRP010
00423 *  WORK FIELDS FOR THE MBS SUBROUTINE                             RVKRP010
00424 ******************************************************************RVKRP010
00425      COPY DPWS003.                                                RVKRP010
00426                                                                   RVKRP010
00427 * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * RVKRP010
00428  PROCEDURE DIVISION.                                              RVKRP010
00429 * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * RVKRP010
00430                                                                   RVKRP010
00431 ******************************************************************RVKRP010
00432 *  0000-MAINLINE - CONTROLS THE MAIN PROCESSING OF THE PROGRAM    RVKRP010
00433 ******************************************************************RVKRP010
00434  0000-PROGRAM-MAINLINE.                                           RVKRP010
00435                                                                   RVKRP010
00436      PERFORM 1000-INITIALIZE.                                     RVKRP010
00437                                                                   RVKRP010
00438      PERFORM 2000-CREATE-REPORT.                                  RVKRP010
00439                                                                   RVKRP010
00440      PERFORM 9000-EOJ-ROUTINE.                                    RVKRP010
00441      STOP RUN.                                                    RVKRP010
00442 *0000-EXIT.                                                       RVKRP010
00443                                                                   RVKRP010
00444 ******************************************************************RVKRP010
00445 *  1000-INITIALIZE -  OPENS ALL THE REPORT FILE, ACCEPTS, EDITS,  RVKRP010
00446 *  AND DISPLAYS CONTROL CARD INFORMATION, OPENS AND FETCHES FIRST RVKRP010
00447 *  OCCURANCE OF DB2 CURSOR, PRINTS INITIAL PAGE HEADING TO REPORT RVKRP010
00448 *  FILE.                                                          RVKRP010
00449 ******************************************************************RVKRP010
00450  1000-INITIALIZE.                                                 RVKRP010
00451                                                                   RVKRP010
00452      OPEN OUTPUT DI-DEFECT-ITEM-REPORT                            RVKRP010
00453           INPUT  RTV-REPORT-EXTRACT.                              RVKRP010
00454                                                                   RVKRP010
00455      SET PS-NOT-END-OF-EXTRACT-FILE TO TRUE.                      RVKRP010
00456                                                                   RVKRP010
00457      PERFORM 7000-READ-EXTRACT-FILE.                              RVKRP010
00458                                                                   RVKRP010
00459      IF PS-END-OF-EXTRACT-FILE                                    RVKRP010
00460          SET PS-NO-DATA          TO TRUE                          RVKRP010
00461      ELSE                                                         RVKRP010
00462          IF RV010-DETAIL-REC                                      RVKRP010
00463              DISPLAY '** ABEND **'                                RVKRP010
00464              DISPLAY '** PROGRAM = RVKRP010 **'                   RVKRP010
00465              DISPLAY '** PARAGRAPH = 1000-INITIALIZE.     **'     RVKRP010
00466              DISPLAY '** FIRST RECORD NOT THE DATE RECORD **'     RVKRP010
00467              MOVE +4003 TO ABEND-CODE                             RVKRP010
00468              CALL 'ILBOABN0' USING ABEND-CODE                     RVKRP010
00469          ELSE                                                     RVKRP010
00470              SET PS-DATA           TO TRUE                        RVKRP010
00471                                                                   RVKRP010
00472              MOVE RV010-RPT-TYPE   TO PV-RPT-TYPE                 RVKRP010
00473                                                                   RVKRP010
00474              MOVE RV010-END-MM     TO PV-END-MONTH                RVKRP010
00475              MOVE RV010-END-DD     TO PV-END-DAY                  RVKRP010
00476              MOVE RV010-END-CC     TO PV-END-CENTURY              RVKRP010
00477              MOVE RV010-END-YY     TO PV-END-YEAR                 RVKRP010
00478                                                                   RVKRP010
00479              MOVE RV010-BEGIN-MM   TO PV-START-MONTH              RVKRP010
00480              MOVE RV010-BEGIN-DD   TO PV-START-DAY                RVKRP010
00481              MOVE RV010-BEGIN-CC   TO PV-START-CENTURY            RVKRP010
00482              MOVE RV010-BEGIN-YY   TO PV-START-YEAR               RVKRP010
00483                                                                   RVKRP010
00484              MOVE PV-START-DATE    TO PH3-START-DATE              RVKRP010
00485              MOVE PV-END-DATE      TO PH3-END-DATE                RVKRP010
00486                                                                   RVKRP010
00487              MOVE RV010-CURR-YY    TO DP132O-RUN-YEAR             RVKRP010
00488              MOVE RV010-CURR-MM    TO DP132O-RUN-MONTH            RVKRP010
00489              MOVE RV010-CURR-DD    TO DP132O-RUN-DAY              RVKRP010
00490                                                                   RVKRP010
00491              ACCEPT ST-SYSTEM-TIME FROM TIME                      RVKRP010
00492              MOVE ST-SYSTEM-HOUR   TO DP132O-RUN-HOUR             RVKRP010
00493              MOVE ST-SYSTEM-MINUTE TO DP132O-RUN-MINUTE           RVKRP010
00494                                                                   RVKRP010
00495              MOVE 'RVKRP010'       TO DP132O-PROGRAM-NAME         RVKRP010
                                                                                
00496              EVALUATE TRUE                                        RVKRP010
00497                WHEN PV-MONTHLY-REPORT                             RVKRP010
00498                  MOVE 1            TO DP132O-REPORT-NUMBER        RVKRP010
00499                WHEN PV-YEAR-TO-DATE-REPORT                        RVKRP010
00500                  MOVE 2            TO DP132O-REPORT-NUMBER        RVKRP010
00497                WHEN PV-WEEKLY-REPORT                              RVKRP010
00498                  MOVE 3            TO DP132O-REPORT-NUMBER        RVKRP010
00501              END-EVALUATE                                         RVKRP010
00502                                                                   RVKRP010
00503              MOVE PC-MAX-REPORT-LINES                             RVKRP010
00504                                    TO PV-LINE-COUNT               RVKRP010
00505              MOVE +0               TO PV-PAGE-COUNT               RVKRP010
00506                                                                   RVKRP010
00507              INITIALIZE DL-DETAIL-LINE                            RVKRP010
00508                         PA-PROGRAM-ACCUMULATORS                   RVKRP010
00509              PERFORM 7000-READ-EXTRACT-FILE                       RVKRP010
00510          END-IF                                                   RVKRP010
00511      END-IF.                                                      RVKRP010
00512                                                                   RVKRP010
00513                                                                   RVKRP010
00514 *1000-EXIT.                                                       RVKRP010
00515                                                                   RVKRP010
00516 ******************************************************************RVKRP010
00517 * 2000-CREATE-REPORT                                              RVKRP010
00518 * PROCESS:  THIS PARAGRAPH WILL SET UP THE WORKING STORAGE INTERNARVKRP010
00519 * SORT FILE.                                                      RVKRP010
00520 ******************************************************************RVKRP010
00521  2000-CREATE-REPORT.                                              RVKRP010
00522                                                                   RVKRP010
00523      IF PS-END-OF-EXTRACT-FILE                                    RVKRP010
00524          MOVE ER-EMPTY-REPORT-LINE  TO PV-REPORT-LINE             RVKRP010
00525          PERFORM 8000-PRINT-REPORT-LINE                           RVKRP010
00526      ELSE                                                         RVKRP010
00527          MOVE RV010-DUNS-NBR      TO PV-HOLD-DUNS-NBR             RVKRP010
00528          MOVE RV010-VND-NAME      TO PV-HOLD-VND-NAME             RVKRP010
00529          MOVE RV010-DPT-NBR       TO PV-HOLD-DPT-NBR              RVKRP010
00530          MOVE RV010-DPT-DESC      TO PV-HOLD-DPT-DESC             RVKRP010
00531          MOVE RV010-OPER-UNT-ID   TO PV-HOLD-OPER-UNT-ID          RVKRP010
00532 *                                                                 RVKRP010
00533          PERFORM UNTIL PS-END-OF-EXTRACT-FILE                     RVKRP010
00534              IF RV010-DUNS-NBR = PV-HOLD-DUNS-NBR                 RVKRP010
00535                  IF RV010-DPT-NBR = PV-HOLD-DPT-NBR               RVKRP010
00536                      PERFORM 2100-ACCUMULATE-TOTALS                  CL**2
00537                  ELSE                                             RVKRP010
00538                      PERFORM 2300-DPT-BREAK                       RVKRP010
00539                  END-IF                                           RVKRP010
00540              ELSE                                                 RVKRP010
00541                  PERFORM 2400-VND-BREAK                           RVKRP010
00542              END-IF                                               RVKRP010
00543                                                                   RVKRP010
00544              PERFORM 7000-READ-EXTRACT-FILE                       RVKRP010
00545                                                                   RVKRP010
00546          END-PERFORM                                              RVKRP010
00547      END-IF.                                                      RVKRP010
00548                                                                   RVKRP010
00549 ******************************************************************RVKRP010
00550 * 2100-ACCUMULATE-TOTALS                                          RVKRP010
00551 * PROCESS:  THIS PARAGRAPH WILL ACCUMULATE TOTALS AT THE          RVKRP010
00552 *  DEPT/FACILITY LEVEL.                                           RVKRP010
00553 ******************************************************************RVKRP010
00554  2100-ACCUMULATE-TOTALS.                                          RVKRP010
00555                                                                   RVKRP010
00556      EVALUATE TRUE                                                RVKRP010
00557          WHEN RV010-RTV-TYPE                                      RVKRP010
00558              ADD RV010-UNIT-COST-AMT TO PA-DR-DPT-COST               CL**2
00559              ADD +1                  TO PA-DR-DPT-QTY                CL**2
00560                                                                   RVKRP010
00561          WHEN RV010-DD-TYPE                                       RVKRP010
00562              ADD RV010-UNIT-COST-AMT TO PA-DD-DPT-COST               CL**2
00563              ADD +1                  TO PA-DD-DPT-QTY                CL**2
00564                                                                   RVKRP010
00565          WHEN RV010-MO-TYPE                                       RVKRP010
00566              ADD RV010-UNIT-COST-AMT TO PA-MO-DPT-COST               CL**2
00567              ADD +1                  TO PA-MO-DPT-QTY                CL**2
00568      END-EVALUATE.                                                RVKRP010
00569                                                                   RVKRP010
00570 ******************************************************************RVKRP010
00571 * 2300-DPT-BREAK                                                  RVKRP010
00572 * PROCESS:  THIS PARAGRAPH WILL PERFORM THE LOGIC FOR A CHANGE IN RVKRP010
00573 *  THE DPT:                                                       RVKRP010
00574 *     1) PRINT DEPARTMENT TOTAL LINE                                 CL**2
00575 *     2) RESET THE "HOLD" DPT VALUE                                  CL**2
00576 *     3) ADD "OLD" DPT TOTALS TO VND TOTALS                          CL**2
00577 *     4) INITIALIZE DPT TOTALS FOR NEW DPT                           CL**2
00578 ******************************************************************RVKRP010
00579  2300-DPT-BREAK.                                                  RVKRP010
00580 *                                                                 RVKRP010
00581      PERFORM 8000-PRINT-REPORT-LINE.                                 CL**2
00582 *                                                                 RVKRP010
00583      MOVE RV010-DPT-NBR       TO DL-DPT-NBR                       RVKRP010
00584                                  PV-HOLD-DPT-NBR.                 RVKRP010
00585      MOVE RV010-DPT-DESC      TO DL-DPT-DESC                      RVKRP010
00586                                  PV-HOLD-DPT-DESC.                RVKRP010
00587 *                                                                 RVKRP010
00588      ADD PA-DR-DPT-QTY        TO PA-DR-VND-QTY.                   RVKRP010
00589      ADD PA-DR-DPT-COST       TO PA-DR-VND-COST.                  RVKRP010
00590                                                                   RVKRP010
00591      ADD PA-DD-DPT-QTY        TO PA-DD-VND-QTY.                   RVKRP010
00592      ADD PA-DD-DPT-COST       TO PA-DD-VND-COST.                  RVKRP010
00593                                                                   RVKRP010
00594      ADD PA-MO-DPT-QTY        TO PA-MO-VND-QTY.                   RVKRP010
00595      ADD PA-MO-DPT-COST       TO PA-MO-VND-COST.                  RVKRP010
00596 *                                                                 RVKRP010
00597      INITIALIZE PA-DPT-TOTALS.                                    RVKRP010
00598                                                                   RVKRP010
00599      PERFORM 2100-ACCUMULATE-TOTALS.                                 CL**2
00600 *                                                                 RVKRP010
00601 ******************************************************************RVKRP010
00602 * 2400-VND-BREAK                                                  RVKRP010
00603 * PROCESS:  THIS PARAGRAPH WILL PERFORM THE LOGIC FOR A CHANGE IN RVKRP010
00604 *  THE VENDOR:                                                    RVKRP010
00605 *     1) PERFORM DEPARTMENT BREAK LOGIC                           RVKRP010
00606 *     2) PRINT VENDOR TOTAL LINE                                  RVKRP010
00607 *     3) RESET THE "HOLD" VENDOR VALUES                           RVKRP010
00608 *     4) ADD "OLD" VENDOR TOTALS TO GRAND TOTALS                  RVKRP010
00609 *     5) INITIALIZE VENDOR TOTALS FOR NEW VENDOR                  RVKRP010
00610 ******************************************************************RVKRP010
00611  2400-VND-BREAK.                                                  RVKRP010
00612                                                                   RVKRP010
00613      PERFORM 2300-DPT-BREAK.                                      RVKRP010
00614 *                                                                 RVKRP010
00615      SET PS-PRINT-VND-TOTAL   TO TRUE.                            RVKRP010
00616      PERFORM 8100-PRINT-TOTAL-LINE.                               RVKRP010
00617 *                                                                 RVKRP010
00618      MOVE RV010-DUNS-NBR      TO DL-DUNS-NBR                      RVKRP010
00619                                  PV-HOLD-DUNS-NBR.                RVKRP010
00620      MOVE RV010-VND-NAME      TO DL-VND-NAME                      RVKRP010
00621                                  PV-HOLD-VND-NAME.                RVKRP010
00622 *                                                                 RVKRP010
00623      ADD PA-DR-VND-QTY        TO PA-DR-GRAND-QTY.                 RVKRP010
00624      ADD PA-DR-VND-COST       TO PA-DR-GRAND-COST.                RVKRP010
00625                                                                   RVKRP010
00626      ADD PA-DD-VND-QTY        TO PA-DD-GRAND-QTY.                 RVKRP010
00627      ADD PA-DD-VND-COST       TO PA-DD-GRAND-COST.                RVKRP010
00628                                                                   RVKRP010
00629      ADD PA-MO-VND-QTY        TO PA-MO-GRAND-QTY.                 RVKRP010
00630      ADD PA-MO-VND-COST       TO PA-MO-GRAND-COST.                RVKRP010
00631 *                                                                 RVKRP010
00632      INITIALIZE PA-VND-TOTALS.                                    RVKRP010
00633                                                                   RVKRP010
00634 *                                                                 RVKRP010
00635 *                                                                 RVKRP010
00636 ******************************************************************RVKRP010
00637 * 2500-GRAND-TOTAL                                                RVKRP010
00638 * PROCESS:  THIS PARAGRAPH WILL PERFORM THE LOGIC FOR THE GRAND   RVKRP010
00639 *  TOTAL:                                                         RVKRP010
00640 *     1) PERFORM DPT BREAK LOGIC                                  RVKRP010
00641 *     2) PRINT GRAND TOTAL LINE                                   RVKRP010
00642 ******************************************************************RVKRP010
00643  2500-GRAND-TOTAL.                                                RVKRP010
00644                                                                   RVKRP010
00645      PERFORM 2400-VND-BREAK.                                      RVKRP010
00646 *                                                                 RVKRP010
00647      SET PS-PRINT-GRAND-TOTAL TO TRUE.                            RVKRP010
00648      PERFORM 8100-PRINT-TOTAL-LINE.                               RVKRP010
00649 *                                                                 RVKRP010
00650 *                                                                 RVKRP010
00651 ******************************************************************RVKRP010
00652 * 7000-READ-EXTRACT-FILE.                                        *RVKRP010
00653 *  THIS PROCEDURE WILL READ ONE EXTRACT RECORD FROM THE EXTRACT  *RVKRP010
00654 *  FLAT FILE.                                                    *RVKRP010
00655 ******************************************************************RVKRP010
00656  7000-READ-EXTRACT-FILE.                                          RVKRP010
00657 *                                                                 RVKRP010
00658      READ RTV-REPORT-EXTRACT                                      RVKRP010
00659          INTO RV010-EXTRACT-RECORD                                RVKRP010
00660          AT END SET PS-END-OF-EXTRACT-FILE TO TRUE.               RVKRP010
00661                                                                   RVKRP010
00662 ******************************************************************RVKRP010
00663 * 8000-PRINT-REPORT-LINE - CHECKS IF THE PAGE SIZE HAS BEEN EX-   RVKRP010
00664 * CEEDED.  IF SO, THE HEADING LINES ARE WRITTEN AND THE LINE COUNTRVKRP010
00665 * INITIALIZED.  THE DETAIL LINE IS THEN WRITTEN.                  RVKRP010
00666 ******************************************************************RVKRP010
00667  8000-PRINT-REPORT-LINE.                                          RVKRP010
00668                                                                   RVKRP010
00669      ADD +1 TO PV-LINE-COUNT.                                     RVKRP010
00670                                                                   RVKRP010
00671      IF PV-LINE-COUNT >= PC-MAX-REPORT-LINES                      RVKRP010
00672          PERFORM 8300-WRITE-PAGE-HEADING                          RVKRP010
00673          PERFORM 8400-WRITE-COLUMN-HEADING                        RVKRP010
00674      END-IF.                                                      RVKRP010
00675                                                                   RVKRP010
00676      MOVE PV-HOLD-DPT-NBR          TO DL-DPT-NBR.                    CL**2
00677      MOVE PV-HOLD-DPT-DESC         TO DL-DPT-DESC.                   CL**2
00678      MOVE PA-DR-DPT-QTY            TO DL-DR-QTY.                     CL**2
00679      MOVE PA-DR-DPT-COST           TO DL-DR-COST.                    CL**2
00680      MOVE PA-DD-DPT-QTY            TO DL-DD-QTY.                     CL**2
00681      MOVE PA-DD-DPT-COST           TO DL-DD-COST.                    CL**2
00682      MOVE PA-MO-DPT-QTY            TO DL-MO-QTY.                     CL**2
00683      MOVE PA-MO-DPT-COST           TO DL-MO-COST.                    CL**2
00684                                                                   RVKRP010
00685      WRITE DI-DEFECT-ITEM-LINE                                    RVKRP010
00686          FROM DL-DETAIL-LINE                                      RVKRP010
00687          AFTER ADVANCING 1 LINES.                                 RVKRP010
00688                                                                   RVKRP010
00689      MOVE SPACES                   TO DL-DUNS-NBR                    CL**2
00690                                       DL-VND-NAME.                RVKRP010
00691                                                                   RVKRP010
00692 *8000-EXIT.                                                       RVKRP010
00693                                                                   RVKRP010
00694 ******************************************************************RVKRP010
00695 * 8100-PRINT-TOTAL-LINE - WRITE THE CONTROL BREAK TOTAL LINES     RVKRP010
00696 ******************************************************************RVKRP010
00697  8100-PRINT-TOTAL-LINE.                                           RVKRP010
00698                                                                   RVKRP010
00699      EVALUATE TRUE                                                RVKRP010
00700          WHEN PS-PRINT-VND-TOTAL                                  RVKRP010
00701                                                                   RVKRP010
00702              MOVE +0 TO PV-CHAR-COUNT                             RVKRP010
00703                                                                   RVKRP010
00704              INSPECT PV-HOLD-VND-NAME TALLYING PV-CHAR-COUNT      RVKRP010
00705                  FOR CHARACTERS BEFORE '  '                       RVKRP010
00706                                                                   RVKRP010
00707              MOVE PV-HOLD-VND-NAME    TO PV-VENDOR-TOTAL-DESC     RVKRP010
00708                                                                   RVKRP010
00709              MOVE PV-VENDOR-TOTAL-DESC                            RVKRP010
00710                                       TO PV-TOTAL-DESCRIPTION     RVKRP010
00711              MOVE PV-TOTAL-DESCRIPTION                            RVKRP010
00712                                       TO TL-TOTAL-DESCRIPTION     RVKRP010
00713                                                                   RVKRP010
00714              MOVE PA-DR-VND-QTY       TO TL-DR-QTY                RVKRP010
00715              MOVE PA-DR-VND-COST      TO TL-DR-COST               RVKRP010
00716              MOVE PA-DD-VND-QTY       TO TL-DD-QTY                RVKRP010
00717              MOVE PA-DD-VND-COST      TO TL-DD-COST               RVKRP010
00718              MOVE PA-MO-VND-QTY       TO TL-MO-QTY                RVKRP010
00719              MOVE PA-MO-VND-COST      TO TL-MO-COST               RVKRP010
00720                                                                   RVKRP010
00721              WRITE DI-DEFECT-ITEM-LINE                            RVKRP010
00722                  FROM TL-TOTAL-LINE-DASHES                        RVKRP010
00723                  AFTER ADVANCING 0 LINES                          RVKRP010
00724                                                                   RVKRP010
00725              WRITE DI-DEFECT-ITEM-LINE                            RVKRP010
00726                  FROM TL-TOTAL-LINE                               RVKRP010
00727                  AFTER ADVANCING 1 LINES                          RVKRP010
00728                                                                   RVKRP010
00729              ADD +1           TO PV-LINE-COUNT                    RVKRP010
00730                                                                   RVKRP010
00731              PERFORM  8200-WRITE-BLANK-LINE                       RVKRP010
00732                                                                   RVKRP010
00733          WHEN PS-PRINT-GRAND-TOTAL                                RVKRP010
00734              MOVE '                        GRAND '                RVKRP010
00735                                       TO TL-TOTAL-DESCRIPTION     RVKRP010
00736              MOVE PA-DR-GRAND-QTY     TO TL-DR-QTY                RVKRP010
00737              MOVE PA-DR-GRAND-COST    TO TL-DR-COST               RVKRP010
00738              MOVE PA-DD-GRAND-QTY     TO TL-DD-QTY                RVKRP010
00739              MOVE PA-DD-GRAND-COST    TO TL-DD-COST               RVKRP010
00740              MOVE PA-MO-GRAND-QTY     TO TL-MO-QTY                RVKRP010
00741              MOVE PA-MO-GRAND-COST    TO TL-MO-COST               RVKRP010
00742                                                                   RVKRP010
00743              WRITE DI-DEFECT-ITEM-LINE                            RVKRP010
00744                  FROM TL-TOTAL-LINE-DASHES                        RVKRP010
00745                  AFTER ADVANCING 0 LINES                          RVKRP010
00746                                                                   RVKRP010
00747              WRITE DI-DEFECT-ITEM-LINE                            RVKRP010
00748                  FROM TL-TOTAL-LINE                               RVKRP010
00749                  AFTER ADVANCING 1 LINES                          RVKRP010
00750                                                                   RVKRP010
00751              PERFORM  8200-WRITE-BLANK-LINE                       RVKRP010
00752                                                                   RVKRP010
00753      END-EVALUATE.                                                RVKRP010
00754                                                                   RVKRP010
00755 *8100-EXIT.                                                       RVKRP010
00756                                                                   RVKRP010
00757 ******************************************************************RVKRP010
00758 * 8200-WRITE-BLANK-LINE - WRITES A BLANK LINE TO THE REPORT.      RVKRP010
00759 ******************************************************************RVKRP010
00760  8200-WRITE-BLANK-LINE.                                           RVKRP010
00761                                                                   RVKRP010
00762      WRITE DI-DEFECT-ITEM-LINE                                    RVKRP010
00763          FROM BLANK-LINE                                          RVKRP010
00764          AFTER ADVANCING 1 LINES.                                 RVKRP010
00765                                                                   RVKRP010
00766      ADD +1                        TO PV-LINE-COUNT.              RVKRP010
00767                                                                   RVKRP010
00768                                                                   RVKRP010
00769 *8200-EXIT.                                                       RVKRP010
00770 ******************************************************************RVKRP010
00771 * 8300-WRITE-PAGE-HEADING - WRITE THE PAGE AND DETAIL HEADINGS FORRVKRP010
00772 * THE DEFECTIVE ITEM REPORT.                                      RVKRP010
00773 ******************************************************************RVKRP010
00774  8300-WRITE-PAGE-HEADING.                                         RVKRP010
00775                                                                   RVKRP010
00776      ADD +1 TO PV-PAGE-COUNT.                                     RVKRP010
00777      MOVE PV-PAGE-COUNT TO DP132O-PAGE-NUMBER.                    RVKRP010
00778                                                                   RVKRP010
00779      WRITE DI-DEFECT-ITEM-LINE                                    RVKRP010
00780          FROM DP132O-STANDRD-HEADER-132-COLS                      RVKRP010
00781          AFTER ADVANCING PAGE.                                    RVKRP010
00782                                                                   RVKRP010
00783      EVALUATE TRUE                                                RVKRP010
00784        WHEN PV-MONTHLY-REPORT                                     RVKRP010
00785          WRITE DI-DEFECT-ITEM-LINE                                RVKRP010
00786              FROM PH2-PAGE-HEADING-MONTHLY                        RVKRP010
00787              AFTER ADVANCING 1 LINES                              RVKRP010
00784        WHEN PV-YEAR-TO-DATE-REPORT                                RVKRP010
00789          WRITE DI-DEFECT-ITEM-LINE                                RVKRP010
00790              FROM PH2-PAGE-HEADING-YTD                            RVKRP010
00791              AFTER ADVANCING 1 LINES                              RVKRP010
00784        WHEN PV-WEEKLY-REPORT                                      RVKRP010
00785          WRITE DI-DEFECT-ITEM-LINE                                RVKRP010
00786              FROM PH2-PAGE-HEADING-WEEKLY                         RVKRP010
00787              AFTER ADVANCING 1 LINES                              RVKRP010
00792      END-EVALUATE.                                                RVKRP010
00793                                                                   RVKRP010
00794      WRITE DI-DEFECT-ITEM-LINE                                    RVKRP010
00795          FROM PH3-PAGE-HEADING-3                                  RVKRP010
00796          AFTER ADVANCING 1 LINES.                                 RVKRP010
00797                                                                   RVKRP010
00798      MOVE +3     TO PV-LINE-COUNT.                                RVKRP010
00799                                                                   RVKRP010
00800      MOVE PV-HOLD-DUNS-NBR    TO DL-DUNS-NBR.                     RVKRP010
00801      MOVE PV-HOLD-VND-NAME    TO DL-VND-NAME.                     RVKRP010
00802      MOVE PV-HOLD-DPT-NBR     TO DL-DPT-NBR.                      RVKRP010
00803      MOVE PV-HOLD-DPT-DESC    TO DL-DPT-DESC.                     RVKRP010
00804                                                                   RVKRP010
00805 *8300-EXIT.                                                       RVKRP010
00806                                                                   RVKRP010
00807 ******************************************************************RVKRP010
00808 * 8400-WRITE-COLUMN-HEADING - WRITE THE COLUMN HEADINGS FOR       RVKRP010
00809 * THE DEFECTIVE ITEM REPORT.                                      RVKRP010
00810 ******************************************************************RVKRP010
00811  8400-WRITE-COLUMN-HEADING.                                       RVKRP010
00812                                                                   RVKRP010
00813      WRITE DI-DEFECT-ITEM-LINE                                    RVKRP010
00814          FROM DH1-DETAIL-HEADING-1                                RVKRP010
00815          AFTER ADVANCING 2 LINES.                                 RVKRP010
00816                                                                   RVKRP010
00817      WRITE DI-DEFECT-ITEM-LINE                                    RVKRP010
00818          FROM DH2-DETAIL-HEADING-2                                RVKRP010
00819          AFTER ADVANCING 1 LINES.                                 RVKRP010
00820                                                                   RVKRP010
00821      WRITE DI-DEFECT-ITEM-LINE                                    RVKRP010
00822          FROM DHD-DETAIL-HEADING-DASHES                           RVKRP010
00823          AFTER ADVANCING 0 LINES.                                 RVKRP010
00824                                                                   RVKRP010
00825      ADD +4       TO PV-LINE-COUNT.                               RVKRP010
00826 *8400-EXIT.                                                       RVKRP010
00827                                                                   RVKRP010
00828 ******************************************************************RVKRP010
00829 * 9000-EOJ-ROUTINE - PRINTS A GRAND TOTAL, AND CLOSES THE DRIVER  RVKRP010
00830 * CURSOR AND THE REPORT FILE.                                     RVKRP010
00831 ******************************************************************RVKRP010
00832  9000-EOJ-ROUTINE.                                                RVKRP010
00833                                                                   RVKRP010
00834      IF PS-NO-DATA                                                RVKRP010
00835          CONTINUE                                                 RVKRP010
00836      ELSE                                                         RVKRP010
00837          PERFORM 2500-GRAND-TOTAL                                 RVKRP010
00838      END-IF.                                                      RVKRP010
00839                                                                   RVKRP010
00840      WRITE DI-DEFECT-ITEM-LINE                                    RVKRP010
00841          FROM END-OF-REPORT-LINE                                  RVKRP010
00842          AFTER ADVANCING 1 LINES.                                 RVKRP010
00843                                                                   RVKRP010
00844      CLOSE DI-DEFECT-ITEM-REPORT                                  RVKRP010
00845            RTV-REPORT-EXTRACT.                                    RVKRP010
00846                                                                   RVKRP010
00847 ******************************************************************RVKRP010
00848 *********************** END OF RVKRP010 **************************RVKRP010
00849 ******************************************************************RVKRP010
