      ******************************************************************        
      ******************************************************************        
       IDENTIFICATION DIVISION.                                                 
      ******************************************************************        
      ******************************************************************        
                                                                                
       PROGRAM-ID.     BPKUT620.                                                
       AUTHOR.         DANIEL ANDERSON                                          
       INSTALLATION.   KOHLS DEPARTMENT STORES.                                 
       DATE-WRITTEN.   03/26/01.                                                
       DATE-COMPILED.                                                           
                                                                                
      ******************************************************************        
      *                                                                         
      *                                                                         
      *                                                                         
      ******************************************************************        
                                                                                
      ******************************************************************        
      ******************************************************************        
       ENVIRONMENT DIVISION.                                                    
      ******************************************************************        
      ******************************************************************        
                                                                                
      ******************************************************************        
       CONFIGURATION SECTION.                                                   
      ******************************************************************        
                                                                                
       SOURCE-COMPUTER.        IBM-3090.                                        
       OBJECT-COMPUTER.        IBM-3090.                                        
                                                                                
      ******************************************************************        
       INPUT-OUTPUT SECTION.                                                    
      ******************************************************************        
                                                                                
       FILE-CONTROL.                                                            
                                                                                
           SELECT COMMA-FILE                                                    
               ASSIGN TO INP01.                                                 
                                                                                
           SELECT FIXED-WIDTH-FILE                                              
               ASSIGN TO OUT01.                                                 
                                                                                
      ******************************************************************        
      ******************************************************************        
       DATA DIVISION.                                                           
      ******************************************************************        
      ******************************************************************        
                                                                                
      ******************************************************************        
       FILE SECTION.                                                            
      ******************************************************************        
                                                                                
       FD  COMMA-FILE                                                           
           RECORDING MODE IS F                                                  
           LABEL RECORDS ARE STANDARD                                           
           BLOCK CONTAINS 0 RECORDS.                                            
                                                                                
       01  COMMA-FMT-REC           PIC X(400).                                  
                                                                                
       FD  FIXED-WIDTH-FILE                                                     
           RECORDING MODE IS F                                                  
           LABEL RECORDS ARE STANDARD                                           
           BLOCK CONTAINS 0 RECORDS.                                            
                                                                                
       01  FIXED-WIDTH-FMT-REC     PIC X(080).                                  
                                                                                
                                                                                
      ******************************************************************        
       WORKING-STORAGE SECTION.                                                 
      ******************************************************************        
                                                                                
       01  PS-PROGRAM-SWITCHES.                                                 
           05  PS-END-OF-COMMA-DATA-SW      PIC X(01)  VALUE 'N'.               
               88  PS-END-OF-COMMA-DATA                VALUE 'Y'.               
                                                                                
                                                                                
       01  PV-PROGRAM-VARIABLES.                                                
           05  PV-COMMA-DATA              PIC X(400).                           
           05  PV-NUMERIC-VALUE           PIC 9(18) VALUE ZEROS.                
                                                                                
                                                                                
       01  FW-FIXED-WIDTH-OUTPUT.                                               
           05  FW-PRODUCT                 PIC X(18).                            
           05  FW-LOCATION                PIC X(18).                            
           05  FW-CHANNEL                 PIC X(18).                            
           05  FW-ELEMENT                 PIC X(18).                            
           05  FW-COMPONENT               PIC X(18).                            
           05  FW-VALUE-1                 PIC 9(18) VALUE ZEROS.                
           05  FW-VALUE-2                 PIC 9(18) VALUE ZEROS.                
           05  FW-VALUE-3                 PIC 9(18) VALUE ZEROS.                
                                                                                
       01  FW-RIGHT-JUST-OUTPUT.                                                
           05  OUTPUT-PRODUCT             PIC X(03).                            
           05  FILLER                     PIC X(04)  VALUE SPACES.              
           05  OUTPUT-VALUE               PIC Z(05)9 VALUE ZEROS.               
      ******************************************************************        
      ******************************************************************        
       PROCEDURE DIVISION.                                                      
      ******************************************************************        
      ******************************************************************        
                                                                                
       0000-MAINLINE.                                                           
                                                                                
           PERFORM 1000-INITIALIZE.                                             
                                                                                
           PERFORM 2000-UNSTRING                                                
                   UNTIL PS-END-OF-COMMA-DATA.                                  
                                                                                
           PERFORM 3000-END-OF-JOB.                                             
                                                                                
           STOP RUN.                                                            
                                                                                
                                                                                
      ******************************************************************        
      *  OPEN INPUT/OUTPUT FILES AND READ IN FILE                      *        
      ******************************************************************        
       1000-INITIALIZE.                                                         
                                                                                
           OPEN INPUT  COMMA-FILE.                                              
           OPEN OUTPUT FIXED-WIDTH-FILE.                                        
                                                                                
           PERFORM 8000-READ-COMMA-RECORD.                                      
                                                                                
                                                                                
      ******************************************************************        
      *  UNSTRING THE INPUT FILE, MOVE VALUES TO OUTPUT FIELDS AND     *        
      *  WRITE RECORD TO OUTPUT FILE.                                  *        
      ******************************************************************        
       2000-UNSTRING.                                                           
                                                                                
           UNSTRING PV-COMMA-DATA DELIMITED BY ","                              
               INTO FW-PRODUCT                                                  
                    FW-LOCATION                                                 
                    FW-CHANNEL                                                  
                    FW-ELEMENT                                                  
                    FW-COMPONENT                                                
                    FW-VALUE-1                                                  
                    FW-VALUE-2                                                  
                    FW-VALUE-3.                                                 
                                                                                
           MOVE FW-PRODUCT(4:3) TO OUTPUT-PRODUCT.                              
           MOVE FW-VALUE-1 TO OUTPUT-VALUE.                                     
                                                                                
           WRITE FIXED-WIDTH-FMT-REC FROM FW-RIGHT-JUST-OUTPUT.                 
                                                                                
           PERFORM 8000-READ-COMMA-RECORD.                                      
                                                                                
                                                                                
      ******************************************************************        
      * CLOSE INPUT/OUTPUT FILES                                       *        
      ******************************************************************        
       3000-END-OF-JOB.                                                         
           CLOSE COMMA-FILE                                                     
                 FIXED-WIDTH-FILE.                                              
                                                                                
                                                                                
      ******************************************************************        
      * READ INPUT FILE UNTIL REACH END OF FILE                        *        
      ******************************************************************        
       8000-READ-COMMA-RECORD.                                                  
           READ COMMA-FILE INTO PV-COMMA-DATA                                   
             AT END SET PS-END-OF-COMMA-DATA TO TRUE.                           
                                                                                
                                                                                
