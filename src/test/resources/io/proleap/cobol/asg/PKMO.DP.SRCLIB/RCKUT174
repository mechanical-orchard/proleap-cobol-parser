000100******************************************************************00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300******************************************************************00030000
000400 PROGRAM-ID.    RCKUT174.                                         00040000
000500 AUTHOR.        GERMAN BANDA.                                     00050000
000600 INSTALLATION.  KOHLS.                                            00060000
000700 DATE-WRITTEN   MAY, 2021.                                        00070000
000800 DATE-COMPILED.                                                   00080000
000900******************************************************************00090000
001000*  THIS PROGRAM WILL READ THE INPUT FILE CREATED BY RCKUT173      00100000
001300*  TO WILL RETRIEVE PO/SKU/UPC/QTY DATA                           00130015
001800******************************************************************00180000
001900******************************************************************00190000
002000*  CHANGE LOG                                                     00200000
002100*  DATE       CHANGED BY    DESC                                  00210000
002200*  ---------- ------------- --------------------------------------00220000
002300*  07-07-2021 GERMAN BANDA  SKU SORT,INITIAL IMPLEMENTATION       00230019
003100******************************************************************00310000
003200 ENVIRONMENT DIVISION.                                            00320000
003300 CONFIGURATION SECTION.                                           00330000
003400                                                                  00340000
003500 SOURCE-COMPUTER.        IBM-3090.                                00350000
003600 OBJECT-COMPUTER.        IBM-3090.                                00360000
003700                                                                  00370000
003800 INPUT-OUTPUT SECTION.                                            00380000
003900 FILE-CONTROL.                                                    00390000
004000                                                                  00400000
004100     SELECT SKU-SORT-FILE-IN                                      00410006
004200         ASSIGN TO INP01.                                         00420008
004300                                                                  00430000
004400     SELECT SKU-SORT-DETAIL-FILE                                  00440001
004500         ASSIGN TO OUT01.                                         00450000
004900                                                                  00490000
005000******************************************************************00500000
005100 DATA DIVISION.                                                   00510000
005200 FILE SECTION.                                                    00520000
005300                                                                  00530000
005400 FD  SKU-SORT-FILE-IN                                             00540001
005500     RECORDING MODE IS F                                          00550000
005600     LABEL RECORDS ARE STANDARD                                   00560000
005700     BLOCK CONTAINS 0 RECORDS.                                    00570000
005800                                                                  00580000
005900 01  SKU-SORT-RECORD         PIC  X(100).                         00590001
006000*                                                                 00600000
006100 FD  SKU-SORT-DETAIL-FILE                                         00610001
006200     RECORDING MODE IS F                                          00620000
006300     LABEL RECORDS ARE STANDARD                                   00630000
006400     BLOCK CONTAINS 0 RECORDS.                                    00640000
006500                                                                  00650000
006600 01  SKU-SORT-DETAIL-RECORD  PIC  X(100).                         00660001
006700*                                                                 00670000
007400*                                                                 00740000
007500******************************************************************00750000
007600 WORKING-STORAGE SECTION.                                         00760000
007700******************************************************************00770000
007800******************************************************************00780000
007900*  SKU SORT FILE LAYOUT                                           00790001
008000******************************************************************00800000
008100     COPY RCRD103.                                                00810001
008200                                                                  00820000
008300*                                                                 00830000
008400******************************************************************00840003
008500*  SKU SORT OUTPUT FILE                                           00850003
008600******************************************************************00860003
008700     COPY RCRD104.                                                00870003
008800                                                                  00880003
008900*                                                                 00890003
009500******************************************************************00950000
009600*  DB2 FORMATTED MESSAGE AREA                                     00960000
009700******************************************************************00970000
009800     COPY DPWS004.                                                00980000
009900*                                                                 00990000
010000******************************************************************01000000
010100*  COMMUNICATIONS AREA FOR DB2                                    01010000
010200******************************************************************01020000
010300     EXEC SQL                                                     01030000
010400          INCLUDE SQLCA                                           01040000
010500     END-EXEC.                                                    01050000
010600*                                                                 01060000
010700******************************************************************01070000
010800*    TALLPLN PACKSLIP TABLE                                       01080011
010900******************************************************************01090000
011000     EXEC SQL                                                     01100000
011100          INCLUDE TALLPLN                                         01110011
011200     END-EXEC.                                                    01120000
011300                                                                  01130000
011400******************************************************************01140000
012100******************************************************************01210000
012200*    XLT_UPC  TABLE                                               01220000
012300******************************************************************01230000
012400     EXEC SQL                                                     01240000
012500          INCLUDE XLT00006                                        01250000
012600     END-EXEC.                                                    01260000
012700                                                                  01270000
012800******************************************************************01280000
012900*    XLT_SKU  TABLE                                               01290000
013000******************************************************************01300000
013100     EXEC SQL                                                     01310000
013200          INCLUDE XLT00003                                        01320000
013300     END-EXEC.                                                    01330000
013400                                                                  01340000
013500******************************************************************01350000
013600*     TPURITM  PO ITEM  TABLE                                     01360001
013700******************************************************************01370000
013800     EXEC SQL                                                     01380000
013900          INCLUDE TPURITM                                         01390001
014000     END-EXEC.                                                    01400000
014100                                                                  01410000
018500******************************************************************01850000
018600 01  ABEND-CODE                      PIC S9(04)    VALUE +0       01860000
018700                                                   COMP SYNC.     01870000
018800                                                                  01880000
018900 01  PS-PROGRAM-SWITCHES.                                         01890000
019000     05  PS-END-OF-FILE-SW           PIC  X(01)    VALUE 'N'.     01900000
019100         88  PS-END-OF-FILE                        VALUE 'Y'.     01910000
019200         88  PS-NOT-END-OF-FILE                    VALUE 'N'.     01920000
019300     05  PS-END-OF-PO-DC-DTL-CSR-SW PIC   X(01)    VALUE 'N'.     01930010
019400         88  PS-END-OF-PO-DC-DTL-CSR               VALUE 'Y'.     01940010
019500         88  PS-NOT-END-OF-PO-DC-DTL-CSR           VALUE 'N'.     01950010
019600     05  PS-END-OF-UPC-CSR-SW        PIC  X(01)    VALUE 'N'.     01960001
019700         88  PS-END-OF-UPC-CSR                     VALUE 'Y'.     01970001
019800         88  PS-NOT-END-OF-UPC-CSR                 VALUE 'N'.     01980001
020500                                                                  02050000
020600 01  PC-PROGRAM-CONSTANTS.                                        02060000
020800     05  PC-CURRENT-PROGRAM-NAME     PIC  X(08) VALUE 'RCKUT174'. 02080000
020900     05  PC-CURRENT-TIMESTAMP        PIC  X(26)    VALUE SPACES.  02090000
021000                                                                  02100000
021100 01  PV-PROGRAM-VARIABLES.                                        02110000
021200     05  PV-PARAGRAPH-NAME           PIC  X(30)    VALUE SPACES.  02120000
021300     05  PV-DB2-OPERATION-ATTEMPTED  PIC  X(30)    VALUE SPACES.  02130000
021400     05  PV-PO-NBR                   PIC S9(9) COMP VALUE ZEROES. 02140000
021600     05  PV-DISPLAY-COUNT            PIC ZZZ,ZZZ,ZZ9.             02160000
022110 01  DK-DB2-KEYS.                                                 02211002
022111     05  DK-PO-NBR                   PIC S9(9) COMP VALUE ZEROES. 02211102
022113     05  DK-DC-NBR                   PIC S9(4) COMP VALUE ZEROES. 02211310
022200                                                                  02220000
022300 01  COUNTERS.                                                    02230000
022400     05  PV-READ-COUNTER             PIC  S9(9) COMP-3.           02240000
022600     05  PV-WRITE-COUNT              PIC  S9(9) COMP-3.           02260004
022800                                                                  02280000
022900*---------------------------------------------------------------* 02290000
023000*    SCAN-CTN CURSOR                                              02300000
023100*---------------------------------------------------------------* 02310000
023200     EXEC SQL                                                     02320001
023300         DECLARE PO-DC-DTL-CSR CURSOR FOR                         02330010
023400           SELECT  A.PO_NBR                                       02340010
023500                 , A.APP_PO_LNE_NBR                               02350010
023600                 , B.CURR_SPLIT_QTY                               02360010
023700                 , B.DEST_NBR                                     02370010
023800                 , C.SKU_NBR                                      02380010
023900                 , C.INTR_UPC_ID                                  02390010
023910                                                                  02391010
023920            FROM  TPURITM A                                       02392010
023930               ,  TALLPLN B                                       02393010
023940               ,  XLT_SKU C                                       02394010
023960            WHERE A.PO_NBR          = :DK-PO-NBR                  02396010
023970             AND  A.VER_STATUS_CDE  ='A'                          02397010
023980             AND  A.PO_NBR          = B.PO_NBR                    02398010
023990             AND  A.APP_PO_LNE_NBR  = B.PO_LNE_NBR                02399010
023991             AND  A.RMS_PO_SKU_NBR  = C.SKU_NBR                   02399113
023992             AND  B.DEST_NBR        = :DK-DC-NBR                  02399210
023994     UNION                                                        02399401
023995           SELECT  T.PO_NBR                                       02399510
023996                 , T.APP_PO_LNE_NBR                               02399610
023997                 , 0                                              02399714
023998                 , :DK-DC-NBR                                     02399810
023999                 , U.SKU_NBR                                      02399910
024000                 , U.INTR_UPC_ID                                  02400010
024001                                                                  02400110
024002            FROM  TPURITM  T                                      02400210
024003               ,  XLT_SKU  U                                      02400310
024005            WHERE T.PO_NBR         = :DK-PO-NBR                   02400510
024006             AND  T.VER_STATUS_CDE ='A'                           02400610
024007             AND  T.RMS_PO_SKU_NBR = U.SKU_NBR                    02400710
024008             AND NOT EXISTS                                       02400810
024009                (SELECT *                                         02400910
024010                 FROM TALLPLN V                                   02401010
024011                 WHERE V.PO_NBR           = :DK-PO-NBR            02401114
024012                  AND V.DEST_NBR       = :DK-DC-NBR               02401214
024013                  AND T.APP_PO_LNE_NBR = V.PO_LNE_NBR )           02401314
024020          WITH UR                                                 02402001
024100     END-EXEC.                                                    02410000
024200                                                                  02420000
024300*---------------------------------------------------------------* 02430000
024400*    PO-RCVR CURSOR                                               02440000
024500*---------------------------------------------------------------* 02450000
024600     EXEC SQL                                                     02460000
024700         DECLARE UPC-CSR CURSOR FOR                               02470001
024800         SELECT A.UPC_NBR                                         02480001
025600          FROM  XLT_UPC A                                         02560001
026100         WHERE  A.INTR_UPC_ID   =  :XLT00003-INTR-UPC-ID          02610002
026200         ORDER BY UPC_TYP_CDE DESC                                02620021
026600          WITH UR                                                 02660000
026700     END-EXEC.                                                    02670000
026800                                                                  02680000
026900******************************************************************02690000
027000 PROCEDURE DIVISION.                                              02700000
027100******************************************************************02710000
027200******************************************************************02720000
027300* 0000-PROGRAM-MAINLINE - CONTROLS THE MAIN PROCESSING OF THE     02730000
027400*      PROGRAM.                                                   02740000
027500******************************************************************02750000
027600 0000-PROGRAM-MAINLINE.                                           02760000
027700                                                                  02770000
027800     DISPLAY '***** RCKUT174 STARTED *****'.                      02780000
027900                                                                  02790000
028000     PERFORM 1000-INITIALIZE.                                     02800000
028100     IF PS-NOT-END-OF-FILE                                        02810000
028200         PERFORM 2000-PROCESS-SKU-SORT-FILE-IN                    02820001
028300            UNTIL PS-END-OF-FILE                                  02830000
028400     END-IF.                                                      02840000
028500     PERFORM 9000-EOJ-ROUTINE.                                    02850000
028600                                                                  02860000
028700     STOP RUN.                                                    02870000
028800                                                                  02880000
028900******************************************************************02890000
029000*  DO FIRST TIME PROGRAM INITIALIZATION TASKS.                    02900000
029100*    -- OPEN INPUT FILE                                           02910000
029200*    -- OPEN OUTPUT FILE                                          02920000
029300*    -- READ INPUT FILE                                           02930000
029400******************************************************************02940000
029500 1000-INITIALIZE.                                                 02950000
029600                                                                  02960000
029700     INITIALIZE COUNTERS.                                         02970000
029800     OPEN INPUT  SKU-SORT-FILE-IN.                                02980001
029900     OPEN OUTPUT SKU-SORT-DETAIL-FILE.                            02990001
030100                                                                  03010000
030200     PERFORM 7000-READ-SKU-SORT-FILE-IN.                          03020001
030300                                                                  03030000
030400******************************************************************03040000
030500*  BEGIN RETRIEVING THE NECESSARY DATA                            03050000
030600******************************************************************03060000
030700 2000-PROCESS-SKU-SORT-FILE-IN.                                   03070001
031200                                                                  03120000
031300     SET PS-NOT-END-OF-PO-DC-DTL-CSR TO TRUE.                     03130010
031400     PERFORM 2100-OPEN-PO-DC-DTL-CSR.                             03140010
031500     PERFORM 2200-FETCH-PO-DC-DTL-CSR.                            03150010
031600     PERFORM 2300-PROCESS-PO-DC-DTL-CSR UNTIL                     03160010
031700             PS-END-OF-PO-DC-DTL-CSR.                             03170010
031800     PERFORM 2400-CLOSE-PO-DC-DTL-CSR.                            03180010
031900                                                                  03190000
032000     PERFORM 7000-READ-SKU-SORT-FILE-IN.                          03200001
032100                                                                  03210000
032200                                                                  03220000
032300******************************************************************03230000
032400*  OPEN PACKSLIP DETAIL CURSOR.                                   03240004
032500******************************************************************03250000
032600 2100-OPEN-PO-DC-DTL-CSR.                                         03260010
032700                                                                  03270000
032810     MOVE RC103-KOHLS-ORD-NBR   TO   DK-PO-NBR.                   03281004
032820     MOVE RC103-DC-NBR          TO   DK-DC-NBR.                   03282010
032900                                                                  03290000
033000     EXEC SQL                                                     03300000
033100         OPEN PO-DC-DTL-CSR                                       03310010
033200     END-EXEC.                                                    03320000
033300                                                                  03330000
033400     EVALUATE TRUE                                                03340000
033500         WHEN SQLCODE = ZERO                                      03350000
033600             CONTINUE                                             03360000
033700         WHEN SQLWARN0 NOT = SPACES                               03370000
033800         WHEN SQLCODE < ZERO                                      03380000
033900         WHEN SQLCODE > ZERO                                      03390000
034000             MOVE '2100-OPEN-PO-DC-DTL-CSR ' TO  PV-PARAGRAPH-NAME03400010
034100             MOVE 'SELECT TPKSLIP           '                     03410002
034200                                    TO PV-DB2-OPERATION-ATTEMPTED 03420000
034300             PERFORM 9100-SQL-ABEND                               03430000
034400     END-EVALUATE.                                                03440000
034500                                                                  03450000
034600                                                                  03460000
034700******************************************************************03470000
034800*  FETCH SCANNED PKSLIP DETAIL CURSOR ROW.                        03480002
034900******************************************************************03490000
035000 2200-FETCH-PO-DC-DTL-CSR.                                        03500010
035100     EXEC SQL                                                     03510000
035200        FETCH PO-DC-DTL-CSR                                       03520010
035300         INTO  :PURITM-PO-NBR                                     03530010
035400             , :PURITM-APP-PO-LNE-NBR                             03540010
035500             , :ALLPLN-CURR-SPLIT-QTY                             03550010
035510             , :ALLPLN-DEST-NBR                                   03551010
035520             , :XLT00003-SKU-NBR                                  03552010
035600             , :XLT00003-INTR-UPC-ID                              03560002
035800     END-EXEC.                                                    03580000
035900                                                                  03590000
036000     EVALUATE TRUE                                                03600000
036100         WHEN SQLCODE = ZERO                                      03610000
036110             CONTINUE                                             03611004
036600         WHEN SQLCODE = +100                                      03660000
036700             SET PS-END-OF-PO-DC-DTL-CSR   TO  TRUE               03670010
036800         WHEN SQLWARN0 NOT = SPACES                               03680000
036900         WHEN SQLCODE < ZERO                                      03690000
037000         WHEN SQLCODE > ZERO                                      03700000
037100             MOVE '2200-FETCH-PO-DC-DTL-CSR' TO  PV-PARAGRAPH-NAME03710010
037200             MOVE 'SELECT SUT_OTBND_STR_SCN '                     03720000
037300                                   TO PV-DB2-OPERATION-ATTEMPTED  03730000
037400             PERFORM 9100-SQL-ABEND                               03740000
037500     END-EVALUATE.                                                03750000
037600                                                                  03760000
037700******************************************************************03770000
037900*  SELECT AND WRITE ALL THE UPCS ASSOCIATED TO THE INTERNAL UPC ID03790003
038200******************************************************************03820000
038300 2300-PROCESS-PO-DC-DTL-CSR.                                      03830010
038400                                                                  03840000
038900                                                                  03890000
039600         SET PS-NOT-END-OF-UPC-CSR TO TRUE                        03960001
039700         PERFORM 5100-OPEN-UPC-CSR                                03970001
039800         PERFORM 5250-FETCH-UPC-CSR                               03980001
040400         PERFORM 5200-PROCESS-UPC-CSR UNTIL                       04040003
040500                 PS-END-OF-UPC-CSR                                04050003
040700         PERFORM 5300-CLOSE-UPC-CSR                               04070001
040900                                                                  04090000
041000     PERFORM 2200-FETCH-PO-DC-DTL-CSR.                            04100010
041100                                                                  04110000
041200                                                                  04120000
055200******************************************************************05520000
055300*  CLOSE PACKSLIP DETAIL CURSOR.                                  05530004
055400******************************************************************05540000
055500 2400-CLOSE-PO-DC-DTL-CSR.                                        05550010
055600     EXEC SQL                                                     05560000
055700        CLOSE PO-DC-DTL-CSR                                       05570010
055800     END-EXEC.                                                    05580000
055900                                                                  05590000
056000     EVALUATE TRUE                                                05600000
056100         WHEN SQLCODE = ZERO                                      05610000
056200             CONTINUE                                             05620000
056300         WHEN SQLWARN0 NOT = SPACES                               05630000
056400         WHEN SQLCODE < ZERO                                      05640000
056500         WHEN SQLCODE > ZERO                                      05650000
056600             MOVE '2400-CLOSE-PO-DC-DTL-CSR' TO  PV-PARAGRAPH-NAME05660010
056700             MOVE 'SELECT SUT_OTBND_STR_SCN'                      05670000
056800                                   TO PV-DB2-OPERATION-ATTEMPTED  05680000
056900             PERFORM 9100-SQL-ABEND                               05690000
057000     END-EVALUATE.                                                05700000
057100                                                                  05710000
057200                                                                  05720000
057300*----------------------------------------------------------------*05730000
057400* OPEN UPC CURSOR                                                 05740004
057500*----------------------------------------------------------------*05750000
057600 5100-OPEN-UPC-CSR.                                               05760001
057700                                                                  05770005
057800     EXEC SQL                                                     05780000
057900         OPEN UPC-CSR                                             05790001
058000     END-EXEC.                                                    05800000
058100                                                                  05810000
058200     EVALUATE TRUE                                                05820000
058300         WHEN SQLCODE = ZERO                                      05830000
058400             CONTINUE                                             05840000
058500         WHEN SQLWARN0 NOT = SPACES                               05850000
058600         WHEN SQLCODE < ZERO                                      05860000
058700         WHEN SQLCODE > ZERO                                      05870000
058800             MOVE '5100-OPEN-UPC-CSR' TO PV-PARAGRAPH-NAME        05880001
058900             MOVE 'SELECT XLT_UPC       '                         05890002
059000                                    TO PV-DB2-OPERATION-ATTEMPTED 05900000
059100             PERFORM 9100-SQL-ABEND                               05910000
059200     END-EVALUATE.                                                05920000
059300                                                                  05930000
059400*----------------------------------------------------------------*05940000
059500* PROCESS SKU SORT DETAILS                                        05950004
059510* 6/30 WAS DECIDED THAT RC104-SEQ-NBR WILL NOT BE USED AT THIS    05951019
059520* TIME IN THE SKU SORT APP. WILL LEAVE FOR FUTURE USE AND POPULATE05952019
059530* WITH DC NUMBER.                                                 05953019
059600*----------------------------------------------------------------*05960000
059700 5200-PROCESS-UPC-CSR.                                            05970001
059710                                                                  05971003
059800     INITIALIZE  RC104-SKU-SORT-DTL-REC.                          05980003
059900                                                                  05990018
060000     MOVE RC103-KOHLS-ORD-NBR         TO RC104-KOHLS-ORD-NBR.     06000003
060100     MOVE RC103-VEND-ORD-NBR          TO RC104-VENDR-ORD-NBR.     06010018
060200     MOVE RC103-DC-NBR                TO RC104-DC-NBR             06020010
060300                                         RC104-SEQ-NBR.           06030012
060310     MOVE RC103-DEPT-NBR              TO RC104-DEPT-NBR.          06031020
060400     MOVE XLT00003-SKU-NBR            TO RC104-SKU-NBR.           06040003
060500     MOVE XLT00006-UPC-NBR            TO RC104-UPC-NBR.           06050003
060600     MOVE ALLPLN-CURR-SPLIT-QTY       TO RC104-SHIP-QTY.          06060010
060700                                                                  06070003
060800     PERFORM 8000-WRITE-OUTPUT.                                   06080003
060900                                                                  06090003
063200     PERFORM 5250-FETCH-UPC-CSR.                                  06320001
063300                                                                  06330000
063400*----------------------------------------------------------------*06340000
063500* FETCH UPC CURSOR                                                06350004
063600*----------------------------------------------------------------*06360000
063700 5250-FETCH-UPC-CSR.                                              06370001
063800     EXEC SQL                                                     06380000
063900        FETCH UPC-CSR                                             06390001
064000         INTO   :XLT00006-UPC-NBR                                 06400002
064800     END-EXEC.                                                    06480000
064900                                                                  06490000
065000     EVALUATE TRUE                                                06500000
065100         WHEN SQLCODE = ZERO                                      06510000
065200             CONTINUE                                             06520004
066200         WHEN SQLCODE = +100                                      06620000
066800             SET PS-END-OF-UPC-CSR         TO  TRUE               06680001
066900         WHEN SQLWARN0 NOT = SPACES                               06690000
067000         WHEN SQLCODE < ZERO                                      06700000
067100         WHEN SQLCODE > ZERO                                      06710000
067200             MOVE '5200-FETCH-UPC-CSR' TO PV-PARAGRAPH-NAME       06720001
067300             MOVE 'SELECT XLT_UPC      '                          06730002
067400                                   TO PV-DB2-OPERATION-ATTEMPTED  06740000
067500             PERFORM 9100-SQL-ABEND                               06750000
067600     END-EVALUATE.                                                06760000
067700                                                                  06770000
067800*----------------------------------------------------------------*06780000
067900* CLOSE UPC CURSOR                                                06790004
068000*----------------------------------------------------------------*06800000
068100 5300-CLOSE-UPC-CSR.                                              06810001
068200     EXEC SQL                                                     06820000
068300        CLOSE UPC-CSR                                             06830001
068400     END-EXEC.                                                    06840000
068500                                                                  06850000
068600     EVALUATE TRUE                                                06860000
068700         WHEN SQLCODE = ZERO                                      06870000
068800             CONTINUE                                             06880000
068900         WHEN SQLWARN0 NOT = SPACES                               06890000
069000         WHEN SQLCODE < ZERO                                      06900000
069100         WHEN SQLCODE > ZERO                                      06910000
069200             MOVE '5300-CLOSE-UPC-CSR' TO PV-PARAGRAPH-NAME       06920001
069300             MOVE 'SELECT SUT_OTBND_UPC'                          06930000
069400                                   TO PV-DB2-OPERATION-ATTEMPTED  06940000
069500             PERFORM 9100-SQL-ABEND                               06950000
069600     END-EVALUATE.                                                06960000
069700                                                                  06970000
072900*----------------------------------------------------------------*07290000
075300******************************************************************07530000
075400*  READ INPUT FILE.                                               07540000
075500******************************************************************07550000
075600 7000-READ-SKU-SORT-FILE-IN.                                      07560001
075700                                                                  07570000
075800      INITIALIZE RC103-ASN-SKU-SORT-REC.                          07580002
075900                                                                  07590000
076000      READ SKU-SORT-FILE-IN INTO                                  07600001
076100          RC103-ASN-SKU-SORT-REC                                  07610002
076200            AT END SET PS-END-OF-FILE TO TRUE.                    07620000
076300                                                                  07630000
076400      IF PS-END-OF-FILE                                           07640000
076500         CONTINUE                                                 07650000
076600      ELSE                                                        07660000
076700         ADD +1 TO PV-READ-COUNTER                                07670000
076800      END-IF.                                                     07680000
076900                                                                  07690000
077000******************************************************************07700000
077100*  WRITE OUTPUT FILE.                                             07710000
077200******************************************************************07720000
077300 8000-WRITE-OUTPUT.                                               07730000
077400                                                                  07740000
078200                                                                  07820000
078300     WRITE  SKU-SORT-DETAIL-RECORD                                07830001
078400      FROM  RC104-SKU-SORT-DTL-REC.                               07840003
078500     ADD    +1   TO PV-WRITE-COUNT.                               07850004
078600                                                                  07860000
078700                                                                  07870000
078800******************************************************************07880000
079600******************************************************************07960000
079700*  CLOSE INPUT FILE.  DISPLAY COUNTERS.                           07970000
079800******************************************************************07980000
079900 9000-EOJ-ROUTINE.                                                07990000
080000     CLOSE SKU-SORT-FILE-IN                                       08000001
080100           SKU-SORT-DETAIL-FILE.                                  08010001
080300                                                                  08030000
080400     MOVE PV-READ-COUNTER TO PV-DISPLAY-COUNT.                    08040000
080500     DISPLAY 'TOTAL RECORDS READ.: '  PV-DISPLAY-COUNT.           08050000
080600     MOVE PV-WRITE-COUNT  TO PV-DISPLAY-COUNT.                    08060005
080700     DISPLAY 'TOTAL RECORDS OUT..: '  PV-DISPLAY-COUNT.           08070000
081300                                                                  08130000
081400     DISPLAY '*****  RCKUT174 ENDED  *****'.                      08140000
081500                                                                  08150000
081600******************************************************************08160000
081700*  PERFORMS THE ABEND FOR THE PROGRAM IN THE EVENT THAT AN SQL    08170000
081800*  ERROR OR WARNING CODE OCCURS.                                  08180000
081900******************************************************************08190000
082000 9100-SQL-ABEND.                                                  08200000
082100     DISPLAY '9100-SQL-ABEND'.                                    08210000
082200     DISPLAY '** ABEND     **'.                                   08220000
082300     DISPLAY '** PROGRAM   ** = ' PC-CURRENT-PROGRAM-NAME.        08230000
082400     DISPLAY '** PARAGRAPH ** = ' PV-PARAGRAPH-NAME.              08240000
082500     DISPLAY '** OPERATION ** = ' PV-DB2-OPERATION-ATTEMPTED.     08250000
082700                                                                  08270000
082800******************************************************************08280000
082900* THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION STATE-    08290000
083000* MENTS THAT ARE REQUIRED TO UTILIZE THE DB2 ABEND MODULE         08300000
083100* 'DSNTIAR' AND CONVERT THE SQLCA INFORMATION INTO A READABLE     08310000
083200* FORMAT.                                                         08320000
083300******************************************************************08330000
083400     COPY DPPD004.                                                08340000
083500                                                                  08350000
083600     MOVE +4013                  TO ABEND-CODE.                   08360000
083700     CALL 'ILBOABN0' USING ABEND-CODE.                            08370000
083800                                                                  08380000
