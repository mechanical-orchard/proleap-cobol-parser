000100******************************************************************00010099
000200 IDENTIFICATION DIVISION.                                         00020009
000300******************************************************************00030009
000400                                                                  00040009
000500 PROGRAM-ID.             SUKRF531.                                00050009
000600 AUTHOR.                 LYNN MCADAMS.                            00060009
000700 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00070009
000800 DATE-WRITTEN.           SEPTEMBER, 2000.                         00080009
000900 DATE-COMPILED.                                                   00090009
001000                                                                  00100009
001100*----------------------------------------------------------------*00110009
001200* THIS PROGRAM DISPLAYS THE PO REPORT REQUEST SCREEN FROM THE LRT 00120009
001300* (LASER RADIO TERMINAL).  IT WILL ACCEPT PO NUMBER(S) OR CAN BE  00130009
001400* LEFT BLANK IF THE ASSOCIATE WISHES TO PRINT PO REPORTS FOR AN   00140009
001500* ENTIRE TRIP ID.  THIS SCREEN APPEARS WHEN EITHER #2 "PRINT      00150009
001600* REPORTS" OR #3 (REQUEST IND RPTS IS SELECTED FROM THE TRAILER   00160009
001700* STOP SCREEN (SUKRF503).                                         00170009
001800*                                                                 00180009
001900* IF THE USER SELECTS #2 "PRINT REPORTS", THE PO REPORT REQUEST   00190009
002000* SCREEN (SUKRF531) WILL APPEAR.  THEN THE TRAILER STOP SCREEN    00200009
002100* (SUKRF503) WILL APPEAR AGAIN WITH A MESSAGE INDICATING THAT     00210009
002200* REPORTS WERE SENT AND GIVES THE PRINTER DEST.                   00220009
002300*                                                                 00230009
002400* IF THE USER SELECTS #3 "REQUEST IND RPTS", THE PO REPORT REQUEST00240009
002500* SCREEN (SUKRF531) WILL APPEAR.  THEN THE CHECK-IN RPTS SCREEN   00250009
002600* (SUKRF525) WILL APPEAR OFFERING THE ASSOCIATE A LIST OF REPORTS 00260009
002700* TO SELECT FROM.  FROM THERE THE TRAILER STOP SCREEN (SUKRF503)  00270009
002800* WILL APPEAR AGAIN WITH A MESSAGE INDICATING THAT REPORTS WERE   00280009
002900* SENT AND GIVES THE PRINTER DEST.                                00290009
003000*----------------------------------------------------------------*00300009
000597* 09/26/14    CHERI PARMLEY  CHG0094571     TKID: TKMAF76        *00311099
000598*             CHANGED MAP PO# FROM 7 TO 8 DIGITS RECOMPILE PROG   00312099
263968*---------------------------------------------------------------* 00313099
263968* CHANGED 11/16/2021    BY JIM HUNTER      WR: CHG0263968         00314099
263968* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00315099
263968* MAKING THE CALL DYNAMIC VS STATIC.                              00316099
263968*---------------------------------------------------------------* 00317099
003200******************************************************************00320009
003300 ENVIRONMENT DIVISION.                                            00330009
003400******************************************************************00340009
003500                                                                  00350009
003600******************************************************************00360009
003700 DATA DIVISION.                                                   00370009
003800******************************************************************00380009
003900                                                                  00390009
004000******************************************************************00400009
004100 WORKING-STORAGE SECTION.                                         00410009
004200******************************************************************00420009
004300                                                                  00430035
004400 01  DK-DB2-KEYS.                                                 00440044
004500     05  DK-USER-ID                     PIC  X(08).               00450044
004600     05  DK-RQST-TMST                   PIC  X(26).               00460044
004700     05  DK-TRIP-ID                     PIC S9(09) COMP.          00470044
004800     05  DK-ALL-PO-IND                  PIC  X(01).               00480044
004900         88  DK-ALL-PO-NBRS             VALUE 'Y'.                00490044
005000         88  DK-NOT-ALL-PO-NBRS         VALUE 'N'.                00500044
005100     05  DK-PO-NBR                      PIC  S9(9) COMP.          00510044
005200*                                                                 00520099
005300*                                                                 00530099
005400*----------------------------------------------------------------*00540009
005500*  COMMAREA LAYOUT SUWS001 - 360 BYTES.                           00550099
005600*----------------------------------------------------------------*00560009
005700 01  CA-COMMAREA.                                                 00570036
005800     COPY SUWS001.                                                00580099
005900                                                                  00590036
006000*----------------------------------------------------------------*00600009
006100*  PROGRAM CONSTANTS                                             *00610009
006200*----------------------------------------------------------------*00620009
006300 01  PC-PROGRAM-CONSTANTS.                                        00630009
006400     05  PC-TRANID                       PIC  X(04)  VALUE 'S531'.00640009
006500     05  PC-MAX-RETRIES                  PIC S9(04)  VALUE +3     00650009
006600                                                     COMP SYNC.   00660009
006700     05  PC-ROW-NOT-FOUND                PIC S9(04)  VALUE +100   00670009
006800                                                     COMP SYNC.   00680009
006900     05  PV-COMMAREA-LENGTH              PIC S9(04)  VALUE +0     00690053
007000                                                     COMP SYNC.   00700009
007100     05  PC-RECEIVE-LENGTH               PIC S9(04)  VALUE +1     00710009
007200                                                     COMP SYNC.   00720009
007300     05  PC-01                           PIC  X(02)  VALUE '01'.  00730009
007400     05  PC-49                           PIC  X(02)  VALUE '49'.  00740009
007500     05  PC-50                           PIC  X(02)  VALUE '50'.  00750009
007600     05  PC-95                           PIC  X(02)  VALUE '95'.  00760009
007700     05  PC-A                            PIC  X(01)  VALUE 'A'.   00770009
007800     05  PC-MGMX                         PIC  X(04)  VALUE 'MGMX'.00780009
007900     05  PC-UG                           PIC  X(02)  VALUE 'UG'.  00790009
008000     05  PC-90                           PIC  X(02)  VALUE '90'.  00800009
008100     05  PC-CORPORATE                    PIC S9(04)  VALUE 90     00810009
008200                                                     COMP.        00820009
008300     05  PC-REPORT-SENT-MSG.                                      00830009
008400         10  FILLER                      PIC  X(10)  VALUE        00840009
008500             'RPTS SENT '.                                        00850009
008600         10  PC-MSG-PRTR-ID              PIC  X(08)  VALUE SPACE. 00860009
008700                                                                  00870009
008800     05  PC-CURRENT-PROGRAM-NAME    PIC X(08) VALUE 'SUKRF531'.   00880009
008900     05  PC-SU-MENU-PGM             PIC X(08) VALUE 'SUKRF500'.   00890009
009000     05  PC-TRAILER-START-PGM       PIC X(08) VALUE 'SUKRF501'.   00900009
009100     05  PC-TRIP-ENTRY-PGM          PIC X(08) VALUE 'SUKRF529'.   00910009
009200     05  PC-TRAILER-STOP-PGM        PIC X(08) VALUE 'SUKRF503'.   00920009
009300     05  PC-CHECK-IN-RPTS-PGM       PIC X(08) VALUE 'SUKRF525'.   00930009
009400                                                                  00940009
009500*----------------------------------------------------------------*00950009
009600*   ERROR MESSAGES                                                00960009
009700*----------------------------------------------------------------*00970009
009800     05  PC-UNRECOGNIZED-PF-KEY-MSG      PIC  X(19)  VALUE        00980009
009900         'UNRECOGNIZED PF KEY'.                                   00990009
010000     05  PC-ENTER-THROUGH-MENU-MSG       PIC  X(19)  VALUE        01000009
010100         'ENTER THROUGH MENU '.                                   01010009
010200     05  PC-TRANS-UNAVAILABLE-MSG        PIC  X(19)  VALUE        01020009
010300         'TRANS NOT AVAILABLE'.                                   01030009
010400     05  PC-PLS-ENT-FLD-MSG              PIC  X(19)  VALUE        01040009
010500         'PLEASE ENTER FIELD '.                                   01050009
010600     05  PC-MUST-BE-NUM-MSG              PIC  X(19)  VALUE        01060009
010700         'MUST BE NUMERIC    '.                                   01070009
010800     05  PC-MUST-BE-GT-0-MSG             PIC  X(19)  VALUE        01080009
010900         'MUST BE > ZERO     '.                                   01090009
011000     05  PC-INVALID-PO-MSG               PIC  X(19)  VALUE        01100029
011100         'INVALID PO NUMBER  '.                                   01110009
011200     05  PC-PO-NOT-NUMERIC-MSG           PIC  X(19)  VALUE        01120029
011300         'PO NOT NUMERIC     '.                                   01130009
011400                                                                  01140009
011500*----------------------------------------------------------------*01150009
011600* SCREEN FUNCTION KEYS                                           *01160009
011700*----------------------------------------------------------------*01170009
011800 01  F4-KEY.                                                      01180009
011900     05  PC-F4-KEY                       PIC  X(09)  VALUE        01190009
012000                                                     'F4 TO PRT'. 01200009
012100     05  PC-PRINTER-DEST                 PIC  X(05)  VALUE SPACE. 01210009
012200 01  F2-KEY.                                                      01220009
012300     05  PC-F2-KEY                       PIC  X(07)  VALUE        01230009
012400                                                     'F2-CONT'.   01240009
012500                                                                  01250009
012600*----------------------------------------------------------------*01260009
012700* PROGRAM SWITCHES                                               *01270009
012800*----------------------------------------------------------------*01280009
012900 01  PS-PROGRAM-SWITCHES.                                         01290009
013000     05  PS-VALID-INPUT-SW               PIC  X(01)  VALUE 'Y'.   01300099
013100         88  PS-VALID-INPUT                          VALUE 'Y'.   01310009
013200         88  PS-INVALID-INPUT                        VALUE 'N'.   01320009
013300     05  PS-VALID-PO-SW                  PIC  X(01)  VALUE 'Y'.   01330099
013400         88  PS-VALID-PO-NBR                         VALUE 'Y'.   01340099
013500         88  PS-INVALID-PO-NBR                       VALUE 'N'.   01350099
013600     05  PS-VALIDATE-IND-PO1-SW          PIC  X(01)  VALUE 'Y'.   01360099
013700         88  PS-VALID-PO1                            VALUE 'Y'.   01370099
013800         88  PS-INVALID-PO1                          VALUE 'N'.   01380099
013900     05  PS-VALIDATE-IND-PO2-SW          PIC  X(01)  VALUE 'Y'.   01390099
014000         88  PS-VALID-PO2                            VALUE 'Y'.   01400099
014100         88  PS-INVALID-PO2                          VALUE 'N'.   01410099
014200     05  PS-VALIDATE-IND-PO3-SW          PIC  X(01)  VALUE 'Y'.   01420099
014300         88  PS-VALID-PO3                            VALUE 'Y'.   01430099
014400         88  PS-INVALID-PO3                          VALUE 'N'.   01440099
014500     05  PS-VALIDATE-IND-PO4-SW          PIC  X(01)  VALUE 'Y'.   01450099
014600         88  PS-VALID-PO4                            VALUE 'Y'.   01460099
014700         88  PS-INVALID-PO4                          VALUE 'N'.   01470099
014800     05  PS-VALIDATE-IND-PO5-SW          PIC  X(01)  VALUE 'Y'.   01480099
014900         88  PS-VALID-PO5                            VALUE 'Y'.   01490099
015000         88  PS-INVALID-PO5                          VALUE 'N'.   01500099
015100     05  PS-VALIDATE-IND-PO6-SW          PIC  X(01)  VALUE 'Y'.   01510099
015200         88  PS-VALID-PO6                            VALUE 'Y'.   01520099
015300         88  PS-INVALID-PO6                          VALUE 'N'.   01530099
015400     05  PS-VALIDATE-IND-PO7-SW          PIC  X(01)  VALUE 'Y'.   01540099
015500         88  PS-VALID-PO7                            VALUE 'Y'.   01550099
015600         88  PS-INVALID-PO7                          VALUE 'N'.   01560099
015700     05  PS-VALIDATE-IND-PO8-SW          PIC  X(01)  VALUE 'Y'.   01570099
015800         88  PS-VALID-PO8                            VALUE 'Y'.   01580099
015900         88  PS-INVALID-PO8                          VALUE 'N'.   01590099
016000     05  PS-REPORTS-REQUESTED-SW         PIC  X(01)  VALUE 'Y'.   01600099
016100         88  PS-ALL-RPTS-REQUESTED                   VALUE 'Y'.   01610099
016200         88  PS-NOT-ALL-RPTS-REQUESTED               VALUE 'N'.   01620099
016300                                                                  01630099
016400*----------------------------------------------------------------*01640099
016500* PROGRAM DATA                                                   *01650099
016600*----------------------------------------------------------------*01660099
016700 01  PV-PROGRAM-DATA.                                             01670099
016800     05  PV-PO1                       PIC  X(09).                 01680099
016900     05  PV-PO1-R REDEFINES PV-PO1.                               01690099
017000         10  PV-PO1-N                 PIC  9(09).                 01700099
017100     05  PV-PO2                       PIC  X(09).                 01710099
017200     05  PV-PO2-R REDEFINES PV-PO2.                               01720099
017300         10  PV-PO2-N                 PIC  9(09).                 01730099
017400     05  PV-PO3                       PIC  X(09).                 01740099
017500     05  PV-PO3-R REDEFINES PV-PO3.                               01750099
017600         10  PV-PO3-N                 PIC  9(09).                 01760099
017700     05  PV-PO4                       PIC  X(09).                 01770099
017800     05  PV-PO4-R REDEFINES PV-PO4.                               01780099
017900         10  PV-PO4-N                 PIC  9(09).                 01790099
018000     05  PV-PO5                       PIC  X(09).                 01800099
018100     05  PV-PO5-R REDEFINES PV-PO5.                               01810099
018200         10  PV-PO5-N                 PIC  9(09).                 01820099
018300     05  PV-PO6                       PIC  X(09).                 01830099
018400     05  PV-PO6-R REDEFINES PV-PO6.                               01840099
018500         10  PV-PO6-N                 PIC  9(09).                 01850099
018600     05  PV-PO7                       PIC  X(09).                 01860099
018700     05  PV-PO7-R REDEFINES PV-PO7.                               01870099
018800         10  PV-PO7-N                 PIC  9(09).                 01880099
018900     05  PV-PO8                       PIC  X(09).                 01890099
019000     05  PV-PO8-R REDEFINES PV-PO8.                               01900099
019100         10  PV-PO8-N                 PIC  9(09).                 01910099
019200                                                                  01920099
019300*----------------------------------------------------------------*01930099
019400* PROGRAM VARIABLES                                              *01940099
019500*----------------------------------------------------------------*01950099
019600 01  PV-PROGRAM-VARIABLES.                                        01960099
019700     05  PV-SYSTEM-ID.                                            01970099
019800         10  FILLER                      PIC  X(04) VALUE SPACE.  01980099
019900         10  PV-REGION-IND               PIC  X(01).              01990099
020000             88  PV-TEST-CICS                 VALUE 'T'.          02000099
020100             88  PV-QA-CICS                   VALUE 'Q'.          02010099
020200             88  PV-PROD-CICS                 VALUE 'P'.          02020099
020300             88  PV-LEARN-CICS                VALUE 'L'.          02030099
020400         10  FILLER                      PIC X(03)  VALUE SPACE.  02040099
020500                                                                  02050099
020600* DB2 TIMESTAMP FORMAT = CCYY-MM-DD-HH.MM.SS.999999               02060099
020700     05 PV-DB2-CURRENT-TMST       PIC  X(26).                     02070099
020800     05 FILLER REDEFINES PV-DB2-CURRENT-TMST.                     02080099
020900         10 PV-DB2-CURRENT-DATE   PIC  X(10).                     02090099
021000         10 PV-DB2-CURRENT-TIME   PIC  X(16).                     02100099
021100                                                                  02110099
021200     05  PV-CICS-MSG-AREA.                                        02120099
021300         10  PV-CICS-MSG-AREA1           PIC  X(80)  VALUE SPACE. 02130099
021400         10  PV-CICS-MSG-AREA2           PIC  X(80)  VALUE SPACE. 02140099
021500         10  PV-CICS-MSG-AREA3           PIC  X(80)  VALUE SPACE. 02150099
021600         10  PV-CICS-MSG-AREA4           PIC  X(80)  VALUE SPACE. 02160099
021700         10  PV-CICS-MSG-AREA5           PIC  X(80)  VALUE SPACE. 02170099
021800         10  PV-CICS-MSG-AREA6           PIC  X(80)  VALUE SPACE. 02180099
021900     05  PV-MESSAGE-AREA                 PIC  X(19)  VALUE SPACE. 02190099
022000     05  PV-RECEIVE-DATA                 PIC  X(01)  VALUE SPACE. 02200099
022100     05  PV-CICS-RESPONSE                PIC S9(09)  VALUE ZERO   02210099
022200                                                     COMP SYNC.   02220099
022300     05  PV-TRANSFER-PROGRAM             PIC  X(08)  VALUE SPACE. 02230099
022400     05  PV-RECORD-COUNT                 PIC S9(09)  VALUE ZERO   02240099
022500                                                     COMP SYNC.   02250099
022600     05  PV-COUNT-IND                    PIC S9(04)  VALUE ZERO   02260099
022700                                                     COMP SYNC.   02270099
022800     05  PV-SELECT-COUNTER               PIC S9(04)  VALUE ZERO   02280099
022900                                                     COMP SYNC.   02290099
023000     05  PV-WRITE-LENGTH                 PIC  9(04)  VALUE  80    02300099
023100                                                     COMP SYNC.   02310099
023200*                                                                 02320099
023300     05  PV-OPER-UNIT                    PIC S9(09)  VALUE ZERO.  02330099
023400     05  PV-PO-NBR1                      PIC S9(09)  VALUE +0     02340099
023500                                                     COMP SYNC.   02350099
023600     05  PV-PO-NBR2                      PIC S9(09)  VALUE +0     02360099
023700                                                     COMP SYNC.   02370099
023800     05  PV-PO-NBR3                      PIC S9(09)  VALUE +0     02380099
023900                                                     COMP SYNC.   02390099
024000     05  PV-PO-NBR4                      PIC S9(09)  VALUE +0     02400099
024100                                                     COMP SYNC.   02410099
024200     05  PV-PO-NBR5                      PIC S9(09)  VALUE +0     02420099
024300                                                     COMP SYNC.   02430099
024400     05  PV-PO-NBR6                      PIC S9(09)  VALUE +0     02440099
024500                                                     COMP SYNC.   02450099
024600     05  PV-PO-NBR7                      PIC S9(09)  VALUE +0     02460099
024700                                                     COMP SYNC.   02470099
024800     05  PV-PO-NBR8                      PIC S9(09)  VALUE +0     02480099
024900                                                     COMP SYNC.   02490099
025000*                                                                 02500099
025100*----------------------------------------------------------------*02510099
025200*  GENERATED DSECT FOR THE SUKM531 MAPSET                         02520099
025300*----------------------------------------------------------------*02530099
025400     COPY SUKM531.                                                02540099
025500                                                                  02550099
025600*----------------------------------------------------------------*02560099
025700*  SENDING/RECEIVING AREA FOR THE NUMERIC EDIT ROUTINE (DPKUT100) 02570099
025800*----------------------------------------------------------------*02580099
025900     COPY DPWS010I.                                               02590099
026000                                                                  02600099
026100*----------------------------------------------------------------*02610099
026200*  LAYOUT FOR THE ABEND MODULE COMMUNICATIONS AREA.               02620099
026300*----------------------------------------------------------------*02630099
026400     COPY DPWS013.                                                02640099
026500                                                                  02650099
026600*----------------------------------------------------------------*02660099
026700*  KOHL'S STANDARD ATTRIBUTE AND PRINTER CONTROL CHARACTER LIST   02670099
026800*----------------------------------------------------------------*02680099
026900     COPY DPWS015.                                                02690099
027000                                                                  02700099
027100*----------------------------------------------------------------*02710099
027200*  WORKING STORAGE AREA FOR NON-ARCHITECTURE PROGRAMS             02720099
027300*----------------------------------------------------------------*02730099
027400     COPY DPWS026.                                                02740099
027500                                                                  02750099
027600*----------------------------------------------------------------*02760099
027700*  KOHL'S STANDARD ATTENTION IDENTIFIER LIST                      02770099
027800*----------------------------------------------------------------*02780099
027900     COPY DFHAID.                                                 02790099
028000                                                                  02800099
028100*---------------------------------------------------------------* 02810099
028200*    DB2 AREA FOR THE SHIPPING UNIT LOCATION TABLE              * 02820099
028300*---------------------------------------------------------------* 02830099
028400     EXEC SQL                                                     02840099
028500          INCLUDE TSHUNLO                                         02850099
028600     END-EXEC.                                                    02860099
028700                                                                  02870099
028800*---------------------------------------------------------------* 02880099
028900*    DB2 AREA FOR THE SHIPPING UNIT UPC ASSOCIATION TABLE       * 02890099
029000*---------------------------------------------------------------* 02900099
029100     EXEC SQL                                                     02910099
029200          INCLUDE TSHUUPC                                         02920099
029300     END-EXEC.                                                    02930099
029400                                                                  02940099
029500*---------------------------------------------------------------* 02950099
029600*  COBOL DECLARATION AND DCLGEN MEMBER FOR THE SU REPORT REQUEST  02960099
029700*  TABLE                                                          02970099
029800*---------------------------------------------------------------* 02980099
029900     EXEC SQL                                                     02990099
030000          INCLUDE TSURPRQ                                         03000099
030100     END-EXEC.                                                    03010099
030200*                                                                 03020099
030300*---------------------------------------------------------------* 03030099
030400*  COBOL DECLARATION AND DCLGEN MEMBER FOR THE TRIP TABLE         03040099
030500*---------------------------------------------------------------* 03050099
030600     EXEC SQL                                                     03060099
030700          INCLUDE TVHTRIP                                         03070099
030800     END-EXEC.                                                    03080099
030900*                                                                 03090099
031000*---------------------------------------------------------------* 03100099
031100*  COBOL DECLARATION AND DCLGEN MEMBER FOR THE SHIPMENT PO TABLE  03110099
031200*---------------------------------------------------------------* 03120099
031300     EXEC SQL                                                     03130099
031400          INCLUDE TSHPTPO                                         03140099
031500     END-EXEC.                                                    03150099
031600*                                                                 03160099
031700*                                                                 03170099
031800*---------------------------------------------------------------* 03180099
031900*  COBOL DECLARATION AND DCLGEN MEMBER FOR THE SHIPMENT TABLE     03190099
032000*---------------------------------------------------------------* 03200099
032100     EXEC SQL                                                     03210099
032200          INCLUDE TSHIPMT                                         03220099
032300     END-EXEC.                                                    03230099
032400*                                                                 03240099
032500*---------------------------------------------------------------* 03250099
032600*  COMMUNICATIONS AREA FOR DB2                                    03260099
032700*---------------------------------------------------------------* 03270099
032800     EXEC SQL                                                     03280099
032900         INCLUDE SQLCA                                            03290099
033000     END-EXEC.                                                    03300099
033100                                                                  03310099
033200***************************************************************** 03320099
033300 LINKAGE SECTION.                                                 03330099
033400******************************************************************03340099
033500*01  DFHCOMMAREA                   PIC  X(300).                   03350099
033600 01  DFHCOMMAREA.                                                 03360099
033700     05  FILLER                       OCCURS 1 TO 4072 TIMES      03370099
033800                                      DEPENDING ON EIBCALEN.      03380099
033900         10  FILLER                   PIC X.                      03390099
034000                                                                  03400099
034100******************************************************************03410099
034200 PROCEDURE DIVISION.                                              03420099
034300******************************************************************03430099
034400 0000-PROGRAM-MAINLINE.                                           03440099
034500     MOVE DFHCOMMAREA TO CA-COMMAREA.                             03450099
034600                                                                  03460099
034700     PERFORM 7100-GET-CURRENT-TIMESTAMP.                          03470099
034800                                                                  03480099
034900     EXEC CICS                                                    03490099
035000         ASSIGN USERID (SU001-USER-ID)                            03500099
035100                RESP   (PV-CICS-RESPONSE)                         03510099
035200                FACILITY(PV-OPER-UNIT)                            03520099
035300     END-EXEC.                                                    03530099
035400                                                                  03540099
035500     EVALUATE TRUE                                                03550099
035600         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 03560099
035700             CONTINUE                                             03570099
035800         WHEN OTHER                                               03580099
035900            MOVE '0000-PROGRAM-MAINLINE' TO DP013-PARAGRAPH       03590099
036000            MOVE 'UNABLE TO ASSIGN USER-ID'                       03600099
036100              TO DP013-MESSAGE-TEXT (1)                           03610099
036200            SET DP013-LOGIC-ABEND        TO TRUE                  03620099
036300            SET DP013-NO-ROLLBACK        TO TRUE                  03630099
036400            PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG                03640099
036500     END-EVALUATE.                                                03650099
036600                                                                  03660099
036700     PERFORM DP026-0000-GET-LOGON-INFO.                           03670099
036800     MOVE DP026-LOCATION-NBR  TO  SU001-CURR-OPER-UNT-ID.         03680099
036900                                                                  03690099
037000     EVALUATE TRUE                                                03700099
037100         WHEN EIBCALEN = ZERO                                     03710099
037200             MOVE PC-ENTER-THROUGH-MENU-MSG TO PV-MESSAGE-AREA    03720099
037300             PERFORM 8300-RETURN                                  03730099
037400                                                                  03740099
037500         WHEN EIBAID = DFHPF2                                     03750099
037600             IF SU001-F4-PROCESSING                               03760099
037700                MOVE PC-UNRECOGNIZED-PF-KEY-MSG TO AMSGLNO        03770099
037800                MOVE -1                     TO APONBR1L           03780099
037900                PERFORM 8100-SEND-DATA-ONLY                       03790099
038000                PERFORM 8200-RETURN-TRANID                        03800099
038100             ELSE                                                 03810099
038200                SET SU001-NO-SUBMIT TO TRUE                       03820099
038300                PERFORM 2000-PROCESS-SCREEN-FIELDS                03830099
038400                IF  PS-VALID-PO-NBR AND                           03840099
038500                    PS-VALID-PO1 AND                              03850099
038600                    PS-VALID-PO2 AND                              03860099
038700                    PS-VALID-PO3 AND                              03870099
038800                    PS-VALID-PO4 AND                              03880099
038900                    PS-VALID-PO5 AND                              03890099
039000                    PS-VALID-PO6 AND                              03900099
039100                    PS-VALID-PO7 AND                              03910099
039200                    PS-VALID-PO8                                  03920099
039300                    SET  SU001-INITIALIZE-SCREEN TO TRUE          03930099
039400                    SET  SU001-RPT-REQUESTED     TO TRUE          03940099
039500                    MOVE PC-CHECK-IN-RPTS-PGM                     03950099
039600                                  TO PV-TRANSFER-PROGRAM          03960099
039700                    PERFORM 4000-XCTL-LRT-MENU                    03970099
039800                ELSE                                              03980099
039900                    MOVE PC-INVALID-PO-MSG      TO AMSGLNO        03990099
040000                    PERFORM 8100-SEND-DATA-ONLY                   04000099
040100                    PERFORM 8200-RETURN-TRANID                    04010099
040200                END-IF                                            04020099
040300             END-IF                                               04030099
040400                                                                  04040099
040500         WHEN EIBAID = DFHPF3                                     04050099
040600              SET  SU001-NO-RPT-REQUESTED     TO TRUE             04060099
040700              SET  SU001-NO-SUBMIT            TO TRUE             04070099
040800              MOVE PC-TRAILER-STOP-PGM                            04080099
040900                                   TO PV-TRANSFER-PROGRAM         04090099
041000              PERFORM 4000-XCTL-LRT-MENU                          04100099
041100                                                                  04110099
041200         WHEN EIBAID = DFHPF4                                     04120099
041300             IF SU001-F2-PROCESSING                               04130099
041400                MOVE -1                     TO APONBR1L           04140099
041500                MOVE PC-UNRECOGNIZED-PF-KEY-MSG TO AMSGLNO        04150099
041600                PERFORM 8100-SEND-DATA-ONLY                       04160099
041700                PERFORM 8200-RETURN-TRANID                        04170099
041800             ELSE                                                 04180099
041900                PERFORM 2000-PROCESS-SCREEN-FIELDS                04190099
042000                IF  PS-VALID-PO-NBR AND                           04200099
042100                    PS-VALID-PO1 AND                              04210099
042200                    PS-VALID-PO2 AND                              04220099
042300                    PS-VALID-PO3 AND                              04230099
042400                    PS-VALID-PO4 AND                              04240099
042500                    PS-VALID-PO5 AND                              04250099
042600                    PS-VALID-PO6 AND                              04260099
042700                    PS-VALID-PO7 AND                              04270099
042800                    PS-VALID-PO8                                  04280099
042900                    SET  SU001-INITIALIZE-SCREEN TO TRUE          04290099
043000                    SET  SU001-RPT-REQUESTED     TO TRUE          04300099
043100                    SET  SU001-SUBMIT-JOB TO TRUE                 04310099
043200                    MOVE PC-TRAILER-STOP-PGM                      04320099
043300                                  TO PV-TRANSFER-PROGRAM          04330099
043400                    PERFORM 4000-XCTL-LRT-MENU                    04340099
043500                ELSE                                              04350099
043600                    MOVE PC-INVALID-PO-MSG      TO AMSGLNO        04360099
043700                    PERFORM 8100-SEND-DATA-ONLY                   04370099
043800                    PERFORM 8200-RETURN-TRANID                    04380099
043900                END-IF                                            04390099
044000             END-IF                                               04400099
044100                                                                  04410099
044200                                                                  04420099
044300         WHEN SU001-INITIALIZE-SCREEN                             04430099
044400         WHEN EIBAID = DFHCLEAR                                   04440099
044500              SET SU001-PROCESS-SCREEN TO TRUE                    04450099
044600              PERFORM 1000-INITIALIZE                             04460099
044700              MOVE PC-CURRENT-PROGRAM-NAME TO SU001-LAST-PROGRAM  04470099
044800              PERFORM 8000-SEND-MAP                               04480099
044900              PERFORM 8200-RETURN-TRANID                          04490099
045000                                                                  04500099
045100         WHEN EIBAID = DFHENTER                                   04510099
045200              PERFORM 2000-PROCESS-SCREEN-FIELDS                  04520099
045300              PERFORM 8100-SEND-DATA-ONLY                         04530099
045400              PERFORM 8200-RETURN-TRANID                          04540099
045500              MOVE -1           TO APONBR1L                       04550099
045600                                                                  04560099
045700         WHEN OTHER                                               04570099
045800              MOVE PC-UNRECOGNIZED-PF-KEY-MSG TO AMSGLNO          04580099
045900              PERFORM 8100-SEND-DATA-ONLY                         04590099
046000              PERFORM 8200-RETURN-TRANID                          04600099
046100     END-EVALUATE.                                                04610099
046200                                                                  04620099
046300     GOBACK.                                                      04630099
046400*                                                                 04640099
046500*                                                                 04650099
046600 1000-INITIALIZE.                                                 04660099
046700                                                                  04670099
046800     INITIALIZE PV-PROGRAM-DATA.                                  04680099
046900     MOVE SPACE             TO  APONBR1O.                         04690099
047000     MOVE -1                TO  APONBR1L.                         04700099
047100*                                                                 04710099
047200     MOVE SU001-LAST-PROGRAM      TO PC-CURRENT-PROGRAM-NAME.     04720099
047300*                                                                 04730099
047400                                                                  04740099
047500     IF CA-525-STATISTICS-RPT-IND  = 'Y' AND                      04750099
047600        CA-525-WORKSHEET-RPT-IND   = 'Y' AND                      04760099
047700        SU001-525-CARTONS-RPT-IND  = 'Y' AND                      04770099
047800        CA-525-FREE-ASTRAY-RPT-IND = 'Y' AND                      04780099
047900        CA-525-MISDIRECT-RPT-IND   = 'Y' AND                      04790099
048000        CA-525-DUPLICATE-RPT-IND   = 'Y' AND                      04800099
048100        SU001-525-SCAN-RPT-IND     = 'Y' AND                      04810099
048200        SU001-525-UNUSED-RPT-IND   = 'Y'                          04820099
048300            MOVE F4-KEY TO AFKEYO                                 04830099
048400            SET PS-ALL-RPTS-REQUESTED TO TRUE                     04840099
048500            MOVE SU001-PRINTER-ID     TO PC-PRINTER-DEST          04850099
048600            MOVE PC-PRINTER-DEST      TO APRTIDO                  04860099
048700            SET SU001-F4-PROCESSING   TO TRUE                     04870099
048800     ELSE                                                         04880099
048900            MOVE F2-KEY TO AFKEYO                                 04890099
049000            SET PS-NOT-ALL-RPTS-REQUESTED TO TRUE                 04900099
049100            MOVE SU001-PRINTER-ID     TO PC-PRINTER-DEST          04910099
049200            MOVE PC-PRINTER-DEST      TO APRTIDO                  04920099
049300            SET SU001-F2-PROCESSING   TO TRUE                     04930099
049400     END-IF.                                                      04940099
049500*                                                                 04950099
049600*                                                                 04960099
049700 2000-PROCESS-SCREEN-FIELDS.                                      04970099
049800                                                                  04980099
049900     PERFORM 2100-RECEIVE-MAP.                                    04990099
050000                                                                  05000099
050100        IF APONBR1L > ZERO OR                                     05010099
050200           APONBR2L > ZERO OR                                     05020099
050300           APONBR3L > ZERO OR                                     05030099
050400           APONBR4L > ZERO OR                                     05040099
050500           APONBR5L > ZERO OR                                     05050099
050600           APONBR6L > ZERO OR                                     05060099
050700           APONBR7L > ZERO OR                                     05070099
050800           APONBR8L > ZERO                                        05080099
050900           SET SU001-NOT-ALL-PO-NBRS TO TRUE                      05090099
051000           PERFORM 2200-EDIT-INPUT                                05100099
051100        ELSE                                                      05110099
051200           SET SU001-ALL-PO-NBRS     TO TRUE                      05120099
051300           SET PS-VALID-PO-NBR       TO TRUE                      05130099
051400           PERFORM 7000-GET-USER-ID                               05140099
051500           PERFORM 7500-INSERT-TRIP-ID                            05150099
051600        END-IF.                                                   05160099
051700*                                                                 05170099
051800*                                                                 05180099
051900 2100-RECEIVE-MAP.                                                05190099
052000                                                                  05200099
052100     EXEC CICS                                                    05210099
052200         RECEIVE MAP    ('SUKM531')                               05220099
052300                 MAPSET ('SUKM531')                               05230099
052400                 RESP   (PV-CICS-RESPONSE)                        05240099
052500     END-EXEC.                                                    05250099
052600                                                                  05260099
052700     EVALUATE TRUE                                                05270099
052800         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 05280099
052900             PERFORM 2110-RECEIVE-SCREEN-FIELDS                   05290099
053000         WHEN PV-CICS-RESPONSE = DFHRESP (MAPFAIL)                05300099
053100             CONTINUE                                             05310099
053200         WHEN OTHER                                               05320099
053300            MOVE '2100-RECEIVE-MAP'      TO DP013-PARAGRAPH       05330099
053400            MOVE 'UNABLE TO RECEIVE MAP' TO DP013-MESSAGE-TEXT (1)05340099
053500            SET DP013-LOGIC-ABEND        TO TRUE                  05350099
053600            SET DP013-NO-ROLLBACK        TO TRUE                  05360099
053700            PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG                05370099
053800     END-EVALUATE.                                                05380099
053900*                                                                 05390099
054000*                                                                 05400099
054100 2110-RECEIVE-SCREEN-FIELDS.                                      05410099
054200                                                                  05420099
054300     IF  APONBR1L > ZERO                                          05430099
054400         MOVE APONBR1I TO PV-PO1                                  05440099
054500                          SU001-PO                                05450099
054600     ELSE                                                         05460099
054700             MOVE ZEROS TO SU001-PO                               05470099
054800     END-IF.                                                      05480099
054900                                                                  05490099
055000     IF  APONBR2L > ZERO                                          05500099
055100         MOVE APONBR2I TO PV-PO2                                  05510099
055200                          SU001-PO2                               05520099
055300     ELSE                                                         05530099
055400             MOVE ZEROS TO SU001-PO2                              05540099
055500     END-IF.                                                      05550099
055600                                                                  05560099
055700     IF  APONBR3L > ZERO                                          05570099
055800         MOVE APONBR3I TO PV-PO3                                  05580099
055900                          SU001-PO3                               05590099
056000     ELSE                                                         05600099
056100             MOVE ZEROS TO SU001-PO3                              05610099
056200     END-IF.                                                      05620099
056300                                                                  05630099
056400     IF  APONBR4L > ZERO                                          05640099
056500         MOVE APONBR4I TO PV-PO4                                  05650099
056600                          SU001-PO4                               05660099
056700     ELSE                                                         05670099
056800             MOVE ZEROS TO SU001-PO4                              05680099
056900     END-IF.                                                      05690099
057000                                                                  05700099
057100     IF  APONBR5L > ZERO                                          05710099
057200         MOVE APONBR5I TO PV-PO5                                  05720099
057300                          SU001-PO5                               05730099
057400     ELSE                                                         05740099
057500             MOVE ZEROS TO SU001-PO5                              05750099
057600     END-IF.                                                      05760099
057700                                                                  05770099
057800     IF  APONBR6L > ZERO                                          05780099
057900         MOVE APONBR6I TO PV-PO6                                  05790099
058000                          SU001-PO6                               05800099
058100     ELSE                                                         05810099
058200             MOVE ZEROS TO SU001-PO6                              05820099
058300     END-IF.                                                      05830099
058400                                                                  05840099
058500     IF  APONBR7L > ZERO                                          05850099
058600         MOVE APONBR7I TO PV-PO7                                  05860099
058700                          SU001-PO7                               05870099
058800     ELSE                                                         05880099
058900             MOVE ZEROS TO SU001-PO7                              05890099
059000     END-IF.                                                      05900099
059100                                                                  05910099
059200     IF  APONBR8L > ZERO                                          05920099
059300         MOVE APONBR8I TO PV-PO8                                  05930099
059400                          SU001-PO8                               05940099
059500     ELSE                                                         05950099
059600             MOVE ZEROS TO SU001-PO8                              05960099
059700     END-IF.                                                      05970099
059800*                                                                 05980099
059900*                                                                 05990099
060000*WHEN INDIVIDUAL PO'S SELECTED PERFORM PO EDITS.                  06000099
060100 2200-EDIT-INPUT.                                                 06010099
060200                                                                  06020099
060300     SET PS-VALID-INPUT TO TRUE.                                  06030099
060400     MOVE SPACES TO AMSGLNO.                                      06040099
060500     PERFORM 7000-GET-USER-ID                                     06050099
060600                                                                  06060099
060700     IF SU001-PO  > ZERO                                          06070099
060800        SET PS-VALID-PO-NBR TO TRUE                               06080099
060900        PERFORM 2250-EDIT-PO-NBR1                                 06090099
061000        IF PS-VALID-PO-NBR                                        06100099
061100           PERFORM 7510-INSERT-PO-NBRS                            06110099
061200        ELSE                                                      06120099
061300           SET PS-INVALID-INPUT TO TRUE                           06130099
061400        END-IF                                                    06140099
061500     ELSE                                                         06150099
061600        MOVE DP015-UNP-ALP-NOR-MDT  TO APONBR1A                   06160099
061700     END-IF                                                       06170099
061800                                                                  06180099
061900     IF SU001-PO2 > ZERO                                          06190099
062000        SET PS-VALID-PO-NBR TO TRUE                               06200099
062100        PERFORM 2250-EDIT-PO-NBR2                                 06210099
062200        IF PS-VALID-PO-NBR                                        06220099
062300           PERFORM 7510-INSERT-PO-NBRS                            06230099
062400        ELSE                                                      06240099
062500           SET PS-INVALID-INPUT TO TRUE                           06250099
062600        END-IF                                                    06260099
062700     ELSE                                                         06270099
062800        MOVE DP015-UNP-ALP-NOR-MDT  TO APONBR2A                   06280099
062900     END-IF                                                       06290099
063000                                                                  06300099
063100     IF SU001-PO3 > ZERO                                          06310099
063200        SET PS-VALID-PO-NBR TO TRUE                               06320099
063300        PERFORM 2250-EDIT-PO-NBR3                                 06330099
063400        IF PS-VALID-PO-NBR                                        06340099
063500           PERFORM 7510-INSERT-PO-NBRS                            06350099
063600        ELSE                                                      06360099
063700           SET PS-INVALID-INPUT TO TRUE                           06370099
063800        END-IF                                                    06380099
063900     ELSE                                                         06390099
064000        MOVE DP015-UNP-ALP-NOR-MDT  TO APONBR3A                   06400099
064100     END-IF                                                       06410099
064200                                                                  06420099
064300     IF SU001-PO4 > ZERO                                          06430099
064400        SET PS-VALID-PO-NBR TO TRUE                               06440099
064500        PERFORM 2250-EDIT-PO-NBR4                                 06450099
064600        IF PS-VALID-PO-NBR                                        06460099
064700           PERFORM 7510-INSERT-PO-NBRS                            06470099
064800        ELSE                                                      06480099
064900           SET PS-INVALID-INPUT TO TRUE                           06490099
065000        END-IF                                                    06500099
065100     ELSE                                                         06510099
065200        MOVE DP015-UNP-ALP-NOR-MDT  TO APONBR4A                   06520099
065300     END-IF                                                       06530099
065400                                                                  06540099
065500     IF SU001-PO5 > ZERO                                          06550099
065600        SET PS-VALID-PO-NBR TO TRUE                               06560099
065700        PERFORM 2250-EDIT-PO-NBR5                                 06570099
065800        IF PS-VALID-PO-NBR                                        06580099
065900           PERFORM 7510-INSERT-PO-NBRS                            06590099
066000        ELSE                                                      06600099
066100           SET PS-INVALID-INPUT TO TRUE                           06610099
066200        END-IF                                                    06620099
066300     ELSE                                                         06630099
066400        MOVE DP015-UNP-ALP-NOR-MDT  TO APONBR5A                   06640099
066500     END-IF                                                       06650099
066600                                                                  06660099
066700     IF SU001-PO6 > ZERO                                          06670099
066800        SET PS-VALID-PO-NBR TO TRUE                               06680099
066900        PERFORM 2250-EDIT-PO-NBR6                                 06690099
067000        IF PS-VALID-PO-NBR                                        06700099
067100           PERFORM 7510-INSERT-PO-NBRS                            06710099
067200        ELSE                                                      06720099
067300           SET PS-INVALID-INPUT TO TRUE                           06730099
067400        END-IF                                                    06740099
067500     ELSE                                                         06750099
067600        MOVE DP015-UNP-ALP-NOR-MDT  TO APONBR6A                   06760099
067700     END-IF                                                       06770099
067800                                                                  06780099
067900     IF SU001-PO7 > ZERO                                          06790099
068000        SET PS-VALID-PO-NBR TO TRUE                               06800099
068100        PERFORM 2250-EDIT-PO-NBR7                                 06810099
068200        IF PS-VALID-PO-NBR                                        06820099
068300           PERFORM 7510-INSERT-PO-NBRS                            06830099
068400        ELSE                                                      06840099
068500           SET PS-INVALID-INPUT TO TRUE                           06850099
068600        END-IF                                                    06860099
068700     ELSE                                                         06870099
068800        MOVE DP015-UNP-ALP-NOR-MDT  TO APONBR7A                   06880099
068900     END-IF                                                       06890099
069000                                                                  06900099
069100     IF SU001-PO8 > ZERO                                          06910099
069200        SET PS-VALID-PO-NBR TO TRUE                               06920099
069300        PERFORM 2250-EDIT-PO-NBR8                                 06930099
069400        IF PS-VALID-PO-NBR                                        06940099
069500           PERFORM 7510-INSERT-PO-NBRS                            06950099
069600        ELSE                                                      06960099
069700           SET PS-INVALID-INPUT TO TRUE                           06970099
069800        END-IF                                                    06980099
069900     ELSE                                                         06990099
070000        MOVE DP015-UNP-ALP-NOR-MDT  TO APONBR8A                   07000099
070100     END-IF.                                                      07010099
070200*                                                                 07020099
070300     IF PS-VALID-INPUT                                            07030099
070400        MOVE -1                     TO APONBR1L                   07040099
070500     END-IF.                                                      07050099
070600*                                                                 07060099
070700 2250-EDIT-PO-NBR1.                                               07070099
070800     MOVE SU001-PO             TO PV-PO1                          07080099
070900     MOVE PV-PO1               TO DP010I-UNEDITED-FIELD           07090099
071000     MOVE LENGTH OF PV-PO1     TO DP010I-MAXIMUM-DIGITS.          07100099
071100     MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS.        07110099
071200     SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE.                     07120099
263968     CALL DP010I-NUMERIC-EDIT-ROUTINE                             07131099
263968          USING DP010I-NUMERIC-EDIT-AREA.                         07132099
071400                                                                  07140099
071500     IF  DP010I-ERROR-DETECTED                                    07150099
071600         SET PS-INVALID-INPUT         TO TRUE                     07160099
071700*        EVALUATE TRUE                                            07170099
071800*             WHEN APONBR1L > ZERO                                07180099
071900                 MOVE DP015-UNP-ALP-BRT-MDT  TO APONBR1A          07190099
072000                 MOVE -1                     TO APONBR1L          07200099
072100                 MOVE PC-PO-NOT-NUMERIC-MSG  TO AMSGLNO           07210099
072200*        END-EVALUATE                                             07220099
072300     ELSE                                                         07230099
072400*        SET PS-VALID-INPUT           TO TRUE                     07240099
072500*        IF SU001-PO  > ZERO                                      07250099
072600            MOVE DP010I-NUMERIC-FIELD TO PV-PO-NBR1               07260099
072700            MOVE PV-PO-NBR1           TO DK-PO-NBR                07270099
072800*        END-IF                                                   07280099
072900*                                                                 07290099
073000         PERFORM 3000-VALIDATE-PO-NBR                             07300099
073100         IF PS-VALID-PO-NBR                                       07310099
073200            SET PS-VALID-PO1 TO TRUE                              07320099
073300            MOVE DP015-UNP-ALP-NOR-MDT  TO APONBR1A               07330099
073400            MOVE ZEROS                  TO APONBR1L               07340099
073500         ELSE                                                     07350099
073600            IF PS-INVALID-PO-NBR                                  07360099
073700               SET PS-INVALID-PO1 TO TRUE                         07370099
073800               MOVE DP015-UNP-ALP-BRT-MDT  TO APONBR1A            07380099
073900               MOVE PC-INVALID-PO-MSG      TO AMSGLNO             07390099
074000               MOVE -1                     TO APONBR1L            07400099
074100            END-IF                                                07410099
074200         END-IF                                                   07420099
074300     END-IF.                                                      07430099
074400                                                                  07440099
074500 2250-EDIT-PO-NBR2.                                               07450099
074600     MOVE SU001-PO2            TO PV-PO2                          07460099
074700     MOVE PV-PO2               TO DP010I-UNEDITED-FIELD           07470099
074800     MOVE LENGTH OF PV-PO2     TO DP010I-MAXIMUM-DIGITS.          07480099
074900     MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS.        07490099
075000     SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE.                     07500099
263968     CALL DP010I-NUMERIC-EDIT-ROUTINE                             07511099
263968          USING DP010I-NUMERIC-EDIT-AREA.                         07512099
075200                                                                  07520099
075300     IF  DP010I-ERROR-DETECTED                                    07530099
075400         SET PS-INVALID-INPUT           TO TRUE                   07540099
075500*        EVALUATE TRUE                                            07550099
075600*             WHEN APONBR2L > ZERO                                07560099
075700                 MOVE DP015-UNP-ALP-BRT-MDT  TO APONBR2A          07570099
075800                 MOVE -1                     TO APONBR2L          07580099
075900                 MOVE PC-PO-NOT-NUMERIC-MSG  TO AMSGLNO           07590099
076000*        END-EVALUATE                                             07600099
076100     ELSE                                                         07610099
076200*        SET PS-VALID-INPUT           TO TRUE                     07620099
076300*        IF SU001-PO2 > ZERO                                      07630099
076400            MOVE DP010I-NUMERIC-FIELD TO PV-PO-NBR2               07640099
076500            MOVE PV-PO-NBR2           TO DK-PO-NBR                07650099
076600*        END-IF                                                   07660099
076700*                                                                 07670099
076800         PERFORM 3000-VALIDATE-PO-NBR                             07680099
076900         IF PS-VALID-PO-NBR                                       07690099
077000            SET PS-VALID-PO2 TO TRUE                              07700099
077100            MOVE DP015-UNP-ALP-NOR-MDT  TO APONBR2A               07710099
077200            MOVE ZEROS                  TO APONBR2L               07720099
077300         ELSE                                                     07730099
077400            IF PS-INVALID-PO-NBR                                  07740099
077500               SET PS-INVALID-PO2 TO TRUE                         07750099
077600               MOVE DP015-UNP-ALP-BRT-MDT  TO APONBR2A            07760099
077700               MOVE PC-INVALID-PO-MSG      TO AMSGLNO             07770099
077800               MOVE -1                     TO APONBR2L            07780099
077900            END-IF                                                07790099
078000         END-IF                                                   07800099
078100     END-IF.                                                      07810099
078200                                                                  07820099
078300 2250-EDIT-PO-NBR3.                                               07830099
078400     MOVE SU001-PO3            TO PV-PO3                          07840099
078500     MOVE PV-PO3               TO DP010I-UNEDITED-FIELD           07850099
078600     MOVE LENGTH OF PV-PO3     TO DP010I-MAXIMUM-DIGITS.          07860099
078700     MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS.        07870099
078800     SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE.                     07880099
263968     CALL DP010I-NUMERIC-EDIT-ROUTINE                             07891099
263968          USING DP010I-NUMERIC-EDIT-AREA.                         07892099
079000                                                                  07900099
079100     IF  DP010I-ERROR-DETECTED                                    07910099
079200         SET PS-INVALID-INPUT           TO TRUE                   07920099
079300*        EVALUATE TRUE                                            07930099
079400*             WHEN APONBR3L > ZERO                                07940099
079500                 MOVE DP015-UNP-ALP-BRT-MDT  TO APONBR3A          07950099
079600                 MOVE -1                     TO APONBR3L          07960099
079700                 MOVE PC-PO-NOT-NUMERIC-MSG  TO AMSGLNO           07970099
079800*        END-EVALUATE                                             07980099
079900     ELSE                                                         07990099
080000*        SET PS-VALID-INPUT           TO TRUE                     08000099
080100*        IF SU001-PO3 > ZERO                                      08010099
080200            MOVE DP010I-NUMERIC-FIELD TO PV-PO-NBR3               08020099
080300            MOVE PV-PO-NBR3           TO DK-PO-NBR                08030099
080400*        END-IF                                                   08040099
080500*                                                                 08050099
080600         PERFORM 3000-VALIDATE-PO-NBR                             08060099
080700         IF PS-VALID-PO-NBR                                       08070099
080800            SET PS-VALID-PO3 TO TRUE                              08080099
080900            MOVE DP015-UNP-ALP-NOR-MDT  TO APONBR3A               08090099
081000            MOVE ZEROS                  TO APONBR3L               08100099
081100         ELSE                                                     08110099
081200            IF PS-INVALID-PO-NBR                                  08120099
081300               SET PS-INVALID-PO3 TO TRUE                         08130099
081400               MOVE DP015-UNP-ALP-BRT-MDT  TO APONBR3A            08140099
081500               MOVE PC-INVALID-PO-MSG      TO AMSGLNO             08150099
081600               MOVE -1                     TO APONBR3L            08160099
081700            END-IF                                                08170099
081800         END-IF                                                   08180099
081900     END-IF.                                                      08190099
082000                                                                  08200099
082100 2250-EDIT-PO-NBR4.                                               08210099
082200     MOVE SU001-PO4            TO PV-PO4                          08220099
082300     MOVE PV-PO4               TO DP010I-UNEDITED-FIELD           08230099
082400     MOVE LENGTH OF PV-PO4     TO DP010I-MAXIMUM-DIGITS.          08240099
082500     MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS.        08250099
082600     SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE.                     08260099
263968     CALL DP010I-NUMERIC-EDIT-ROUTINE                             08271099
263968          USING DP010I-NUMERIC-EDIT-AREA.                         08272099
082800                                                                  08280099
082900     IF  DP010I-ERROR-DETECTED                                    08290099
083000         SET PS-INVALID-INPUT           TO TRUE                   08300099
083100*        EVALUATE TRUE                                            08310099
083200*             WHEN APONBR4L > ZERO                                08320099
083300                 MOVE DP015-UNP-ALP-BRT-MDT  TO APONBR4A          08330099
083400                 MOVE -1                     TO APONBR4L          08340099
083500                 MOVE PC-PO-NOT-NUMERIC-MSG  TO AMSGLNO           08350099
083600*        END-EVALUATE                                             08360099
083700     ELSE                                                         08370099
083800*        SET PS-VALID-INPUT           TO TRUE                     08380099
083900*        IF SU001-PO4 > ZERO                                      08390099
084000            MOVE DP010I-NUMERIC-FIELD TO PV-PO-NBR4               08400099
084100            MOVE PV-PO-NBR4           TO DK-PO-NBR                08410099
084200*        END-IF                                                   08420099
084300*                                                                 08430099
084400         PERFORM 3000-VALIDATE-PO-NBR                             08440099
084500         IF PS-VALID-PO-NBR                                       08450099
084600            SET PS-VALID-PO4 TO TRUE                              08460099
084700            MOVE DP015-UNP-ALP-NOR-MDT  TO APONBR4A               08470099
084800            MOVE ZEROS                  TO APONBR4L               08480099
084900         ELSE                                                     08490099
085000            IF PS-INVALID-PO-NBR                                  08500099
085100               SET PS-INVALID-PO4 TO TRUE                         08510099
085200               MOVE DP015-UNP-ALP-BRT-MDT  TO APONBR4A            08520099
085300               MOVE PC-INVALID-PO-MSG      TO AMSGLNO             08530099
085400               MOVE -1                     TO APONBR4L            08540099
085500            END-IF                                                08550099
085600         END-IF                                                   08560099
085700     END-IF.                                                      08570099
085800                                                                  08580099
085900 2250-EDIT-PO-NBR5.                                               08590099
086000     MOVE SU001-PO5            TO PV-PO5                          08600099
086100     MOVE PV-PO5               TO DP010I-UNEDITED-FIELD           08610099
086200     MOVE LENGTH OF PV-PO5     TO DP010I-MAXIMUM-DIGITS.          08620099
086300     MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS.        08630099
086400     SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE.                     08640099
263968     CALL DP010I-NUMERIC-EDIT-ROUTINE                             08651099
263968          USING DP010I-NUMERIC-EDIT-AREA.                         08652099
086600                                                                  08660099
086700     IF  DP010I-ERROR-DETECTED                                    08670099
086800         SET PS-INVALID-INPUT           TO TRUE                   08680099
086900*        EVALUATE TRUE                                            08690099
087000*             WHEN APONBR5L > ZERO                                08700099
087100                 MOVE DP015-UNP-ALP-BRT-MDT  TO APONBR5A          08710099
087200                 MOVE -1                     TO APONBR5L          08720099
087300                 MOVE PC-PO-NOT-NUMERIC-MSG  TO AMSGLNO           08730099
087400*        END-EVALUATE                                             08740099
087500     ELSE                                                         08750099
087600*        SET PS-VALID-INPUT           TO TRUE                     08760099
087700*        IF SU001-PO5 > ZERO                                      08770099
087800            MOVE DP010I-NUMERIC-FIELD TO PV-PO-NBR5               08780099
087900            MOVE PV-PO-NBR5           TO DK-PO-NBR                08790099
088000*        END-IF                                                   08800099
088100*                                                                 08810099
088200         PERFORM 3000-VALIDATE-PO-NBR                             08820099
088300         IF PS-VALID-PO-NBR                                       08830099
088400            SET PS-VALID-PO5 TO TRUE                              08840099
088500            MOVE DP015-UNP-ALP-NOR-MDT  TO APONBR5A               08850099
088600            MOVE ZEROS                  TO APONBR5L               08860099
088700         ELSE                                                     08870099
088800            IF PS-INVALID-PO-NBR                                  08880099
088900               SET PS-INVALID-PO5 TO TRUE                         08890099
089000               MOVE DP015-UNP-ALP-BRT-MDT  TO APONBR5A            08900099
089100               MOVE PC-INVALID-PO-MSG      TO AMSGLNO             08910099
089200               MOVE -1                     TO APONBR5L            08920099
089300            END-IF                                                08930099
089400         END-IF                                                   08940099
089500     END-IF.                                                      08950099
089600                                                                  08960099
089700 2250-EDIT-PO-NBR6.                                               08970099
089800     MOVE SU001-PO6            TO PV-PO6                          08980099
089900     MOVE PV-PO6               TO DP010I-UNEDITED-FIELD           08990099
090000     MOVE LENGTH OF PV-PO6     TO DP010I-MAXIMUM-DIGITS.          09000099
090100     MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS.        09010099
090200     SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE.                     09020099
263968     CALL DP010I-NUMERIC-EDIT-ROUTINE                             09031099
263968          USING DP010I-NUMERIC-EDIT-AREA.                         09032099
090400                                                                  09040099
090500     IF  DP010I-ERROR-DETECTED                                    09050099
090600         SET PS-INVALID-INPUT           TO TRUE                   09060099
090700*        EVALUATE TRUE                                            09070099
090800*             WHEN APONBR6L > ZERO                                09080099
090900                 MOVE DP015-UNP-ALP-BRT-MDT  TO APONBR6A          09090099
091000                 MOVE -1                     TO APONBR6L          09100099
091100                 MOVE PC-PO-NOT-NUMERIC-MSG  TO AMSGLNO           09110099
091200*        END-EVALUATE                                             09120099
091300     ELSE                                                         09130099
091400*        SET PS-VALID-INPUT           TO TRUE                     09140099
091500*        IF SU001-PO6 > ZERO                                      09150099
091600            MOVE DP010I-NUMERIC-FIELD TO PV-PO-NBR6               09160099
091700            MOVE PV-PO-NBR6           TO DK-PO-NBR                09170099
091800*        END-IF                                                   09180099
091900*                                                                 09190099
092000         PERFORM 3000-VALIDATE-PO-NBR                             09200099
092100         IF PS-VALID-PO-NBR                                       09210099
092200            SET PS-VALID-PO6 TO TRUE                              09220099
092300            MOVE DP015-UNP-ALP-NOR-MDT  TO APONBR6A               09230099
092400            MOVE ZEROS                  TO APONBR6L               09240099
092500         ELSE                                                     09250099
092600            IF PS-INVALID-PO-NBR                                  09260099
092700               SET PS-INVALID-PO6 TO TRUE                         09270099
092800               MOVE DP015-UNP-ALP-BRT-MDT  TO APONBR6A            09280099
092900               MOVE PC-INVALID-PO-MSG      TO AMSGLNO             09290099
093000               MOVE -1                     TO APONBR6L            09300099
093100            END-IF                                                09310099
093200         END-IF                                                   09320099
093300     END-IF.                                                      09330099
093400                                                                  09340099
093500 2250-EDIT-PO-NBR7.                                               09350099
093600     MOVE SU001-PO7            TO PV-PO7                          09360099
093700     MOVE PV-PO7               TO DP010I-UNEDITED-FIELD           09370099
093800     MOVE LENGTH OF PV-PO7     TO DP010I-MAXIMUM-DIGITS.          09380099
093900     MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS.        09390099
094000     SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE.                     09400099
263968     CALL DP010I-NUMERIC-EDIT-ROUTINE                             09411099
263968          USING DP010I-NUMERIC-EDIT-AREA.                         09412099
094200                                                                  09420099
094300     IF  DP010I-ERROR-DETECTED                                    09430099
094400         SET PS-INVALID-INPUT           TO TRUE                   09440099
094500*        EVALUATE TRUE                                            09450099
094600*             WHEN APONBR7L > ZERO                                09460099
094700                 MOVE DP015-UNP-ALP-BRT-MDT  TO APONBR7A          09470099
094800                 MOVE -1                     TO APONBR7L          09480099
094900                 MOVE PC-PO-NOT-NUMERIC-MSG  TO AMSGLNO           09490099
095000*        END-EVALUATE                                             09500099
095100     ELSE                                                         09510099
095200*        SET PS-VALID-INPUT           TO TRUE                     09520099
095300*        IF SU001-PO7 > ZERO                                      09530099
095400            MOVE DP010I-NUMERIC-FIELD TO PV-PO-NBR7               09540099
095500            MOVE PV-PO-NBR7           TO DK-PO-NBR                09550099
095600*        END-IF                                                   09560099
095700*                                                                 09570099
095800         PERFORM 3000-VALIDATE-PO-NBR                             09580099
095900         IF PS-VALID-PO-NBR                                       09590099
096000            SET PS-VALID-PO7 TO TRUE                              09600099
096100            MOVE DP015-UNP-ALP-NOR-MDT  TO APONBR7A               09610099
096200            MOVE ZEROS                  TO APONBR7L               09620099
096300         ELSE                                                     09630099
096400            IF PS-INVALID-PO-NBR                                  09640099
096500               SET PS-INVALID-PO7 TO TRUE                         09650099
096600               MOVE DP015-UNP-ALP-BRT-MDT  TO APONBR7A            09660099
096700               MOVE PC-INVALID-PO-MSG      TO AMSGLNO             09670099
096800               MOVE -1                     TO APONBR7L            09680099
096900            END-IF                                                09690099
097000         END-IF                                                   09700099
097100     END-IF.                                                      09710099
097200                                                                  09720099
097300 2250-EDIT-PO-NBR8.                                               09730099
097400     MOVE SU001-PO8            TO PV-PO8                          09740099
097500     MOVE PV-PO8               TO DP010I-UNEDITED-FIELD           09750099
097600     MOVE LENGTH OF PV-PO8     TO DP010I-MAXIMUM-DIGITS.          09760099
097700     MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS.        09770099
097800     SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE.                     09780099
263968     CALL DP010I-NUMERIC-EDIT-ROUTINE                             09791099
263968          USING DP010I-NUMERIC-EDIT-AREA.                         09792099
098000                                                                  09800099
098100     IF  DP010I-ERROR-DETECTED                                    09810099
098200         SET PS-INVALID-INPUT           TO TRUE                   09820099
098300*        EVALUATE TRUE                                            09830099
098400*             WHEN APONBR8L > ZERO                                09840099
098500                 MOVE DP015-UNP-ALP-BRT-MDT  TO APONBR8A          09850099
098600                 MOVE -1                     TO APONBR8L          09860099
098700                 MOVE PC-PO-NOT-NUMERIC-MSG  TO AMSGLNO           09870099
098800*        END-EVALUATE                                             09880099
098900     ELSE                                                         09890099
099000*        SET PS-VALID-INPUT           TO TRUE                     09900099
099100*        IF SU001-PO8 > ZERO                                      09910099
099200            MOVE DP010I-NUMERIC-FIELD TO PV-PO-NBR8               09920099
099300            MOVE PV-PO-NBR8           TO DK-PO-NBR                09930099
099400*        END-IF                                                   09940099
099500*                                                                 09950099
099600         PERFORM 3000-VALIDATE-PO-NBR                             09960099
099700         IF PS-VALID-PO-NBR                                       09970099
099800            SET PS-VALID-PO8 TO TRUE                              09980099
099900            MOVE DP015-UNP-ALP-NOR-MDT  TO APONBR8A               09990099
100000            MOVE ZEROS                  TO APONBR8L               10000099
100100         ELSE                                                     10010099
100200            IF PS-INVALID-PO-NBR                                  10020099
100300               SET PS-INVALID-PO8 TO TRUE                         10030099
100400               MOVE DP015-UNP-ALP-BRT-MDT  TO APONBR8A            10040099
100500               MOVE PC-INVALID-PO-MSG      TO AMSGLNO             10050099
100600               MOVE -1                     TO APONBR8L            10060099
100700            END-IF                                                10070099
100800         END-IF                                                   10080099
100900     END-IF.                                                      10090099
101000*                                                                 10100099
101100*                                                                 10110099
101200******************************************************************10120099
101300* USER ENTERS PO NUMBER.  2110-RECEIVE-SCREEN-FIELDS SENDS PO    *10130099
101400* NUMBER TO THE SCREEN.  THIS PARAGRAPH VALIDATES THE PO NUMBER  *10140099
101500* BY CHECKING IF CARTONS ON THE PO ARE CHECKED IN (TSHUNLO).     *10150099
101600******************************************************************10160099
101700 3000-VALIDATE-PO-NBR.                                            10170099
101800     MOVE SU001-MANIFEST     TO DK-TRIP-ID                        10180099
101900                                                                  10190099
102000     EXEC SQL                                                     10200099
102100        SELECT  A.SHIPT_UNT_ID                                    10210099
102200          INTO  :SHUNLO-SHIPT-UNT-ID                              10220099
102300          FROM  TSHUNLO A                                         10230099
102400              , TSHUUPC B                                         10240099
102500         WHERE  A.TRIP_ID        = :DK-TRIP-ID                    10250099
102600           AND  A.SHIPT_UNT_ID   = B.SHIPT_UNT_ID                 10260099
102700           AND  B.TRN_NBR        = :DK-PO-NBR                     10270099
102710           AND  A.SCN_LOC_ID     = 'RECV'                         10271099
102720           AND  A.ACTV_CDE       = 'A'                            10272099
102800     END-EXEC                                                     10280099
102900                                                                  10290099
103000     EVALUATE TRUE                                                10300099
103100         WHEN SQLCODE = +0                                        10310099
103200         WHEN SQLCODE = -811                                      10320099
103300             SET PS-VALID-PO-NBR   TO TRUE                        10330099
103400         WHEN SQLCODE = +100                                      10340099
103500             PERFORM 3010-CHECK-IF-ON-TRIP                        10350099
103600         WHEN SQLWARN0 NOT = SPACES                               10360099
103700         WHEN SQLCODE NOT EQUAL ZERO                              10370099
103800             MOVE '3000-VALIDATE-PO'                              10380099
103900                             TO DP013-PARAGRAPH                   10390099
104000             MOVE 'VALIDATE PO NBR'                               10400099
104100                             TO DP013-MESSAGE-TEXT(1)             10410099
104200             MOVE DK-PO-NBR                                       10420099
104300                             TO DP013-MESSAGE-TEXT(2)             10430099
104400             MOVE SQLCA      TO DP013-SQLCA                       10440099
104500             MOVE 'TSHUNLO'  TO DP013-DB2-TABLE-NAME(1)           10450099
104600             SET DP013-DB2-ABEND                                  10460099
104700                             TO TRUE                              10470099
104800             SET DP013-NO-ROLLBACK                                10480099
104900                             TO TRUE                              10490099
105000             SET DP013-XCTL-DISPLAY-RESTART                       10500099
105100                             TO TRUE                              10510099
105200             PERFORM DP014-0000-PROCESS-ABEND                     10520099
105300     END-EVALUATE.                                                10530099
105400*                                                                 10540099
105500*                                                                 10550099
105600******************************************************************10560099
105700* THIS PARAGRAPH CHECKS TO SEE IF PO'S THAT HAVE CARTONS THAT    *10570099
105800* ARE NOT CHECKED IN ARE EXPECTED ON THE TRIP.                   *10580099
105900******************************************************************10590099
106000 3010-CHECK-IF-ON-TRIP.                                           10600099
106100                                                                  10610099
106200     EXEC SQL                                                     10620099
106300            SELECT C.PO_NBR                                       10630099
106400            INTO  :SHPTPO-PO-NBR                                  10640099
106500            FROM  TVHTRIP A                                       10650099
106600                , TSHIPMT B                                       10660099
106700                , TSHPTPO C                                       10670099
106800            WHERE A.TRIP_ID           = :DK-TRIP-ID               10680099
106900              AND A.TRIP_ID           = B.TRIP_ID                 10690099
107000              AND C.SHIPT_ID          = B.SHIPT_ID                10700099
107100              AND C.PO_NBR            = :DK-PO-NBR                10710099
107200     END-EXEC                                                     10720099
107300                                                                  10730099
107400     EVALUATE TRUE                                                10740099
107500         WHEN SQLCODE = +0                                        10750099
107600         WHEN SQLCODE = -811                                      10760099
107700             SET PS-VALID-PO-NBR   TO TRUE                        10770099
107800         WHEN SQLCODE = +100                                      10780099
107900             SET PS-INVALID-PO-NBR TO TRUE                        10790099
108000                                                                  10800099
108100         WHEN SQLWARN0 NOT = SPACES                               10810099
108200         WHEN SQLCODE NOT EQUAL ZERO                              10820099
108300             MOVE '3000-VALIDATE-PO'                              10830099
108400                             TO DP013-PARAGRAPH                   10840099
108500             MOVE 'VALIDATE PO NBR'                               10850099
108600                             TO DP013-MESSAGE-TEXT(1)             10860099
108700             MOVE DK-PO-NBR                                       10870099
108800                             TO DP013-MESSAGE-TEXT(2)             10880099
108900             MOVE SQLCA      TO DP013-SQLCA                       10890099
109000             MOVE 'TSHUNLO'  TO DP013-DB2-TABLE-NAME(1)           10900099
109100             SET DP013-DB2-ABEND                                  10910099
109200                             TO TRUE                              10920099
109300             SET DP013-NO-ROLLBACK                                10930099
109400                             TO TRUE                              10940099
109500             SET DP013-XCTL-DISPLAY-RESTART                       10950099
109600                             TO TRUE                              10960099
109700             PERFORM DP014-0000-PROCESS-ABEND                     10970099
109800     END-EVALUATE.                                                10980099
109900*                                                                 10990099
110000                                                                  11000099
110100                                                                  11010099
110200 4000-XCTL-LRT-MENU.                                              11020099
110300     SET SU001-INITIALIZE-SCREEN     TO TRUE.                     11030099
110400     MOVE PC-CURRENT-PROGRAM-NAME TO SU001-LAST-PROGRAM.          11040099
110500                                                                  11050099
110600     MOVE LENGTH OF CA-COMMAREA   TO PV-COMMAREA-LENGTH           11060099
110700     EXEC CICS                                                    11070099
110800         XCTL  PROGRAM   (PV-TRANSFER-PROGRAM)                    11080099
110900               COMMAREA  (CA-COMMAREA)                            11090099
111000               LENGTH    (PV-COMMAREA-LENGTH)                     11100099
111100               RESP      (PV-CICS-RESPONSE)                       11110099
111200     END-EXEC.                                                    11120099
111300                                                                  11130099
111400     EVALUATE TRUE                                                11140099
111500         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 11150099
111600             CONTINUE                                             11160099
111700         WHEN OTHER                                               11170099
111800             MOVE '4000-XCTL-TO-LRT-MENU'                         11180099
111900                 TO DP013-PARAGRAPH                               11190099
112000             MOVE 'UNABLE TO XCTL TO PROGRAM: '                   11200099
112100                 TO DP013-MESSAGE-TEXT (1)                        11210099
112200             MOVE PV-TRANSFER-PROGRAM                             11220099
112300                 TO DP013-MESSAGE-TEXT (2)                        11230099
112400             SET DP013-CICS-ABEND  TO TRUE                        11240099
112500             SET DP013-NO-ROLLBACK TO TRUE                        11250099
112600             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               11260099
112700             MOVE PC-TRANS-UNAVAILABLE-MSG TO AMSGLNO             11270099
112800             SET SU001-PROCESS-SCREEN TO TRUE                     11280099
112900             PERFORM 8000-SEND-MAP                                11290099
113000             PERFORM 8200-RETURN-TRANID                           11300099
113100     END-EVALUATE.                                                11310099
113200*                                                                 11320099
113300*                                                                 11330099
113400 5050-RECEIVE.                                                    11340099
113500     EXEC CICS                                                    11350099
113600      RECEIVE INTO    (PV-RECEIVE-DATA)                           11360099
113700              LENGTH  (PC-RECEIVE-LENGTH)                         11370099
113800              RESP    (PV-CICS-RESPONSE)                          11380099
113900     END-EXEC.                                                    11390099
114000                                                                  11400099
114100     EVALUATE TRUE                                                11410099
114200         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 11420099
114300         WHEN PV-CICS-RESPONSE = DFHRESP (EOC)                    11430099
114400             CONTINUE                                             11440099
114500         WHEN OTHER                                               11450099
114600             MOVE '5050-RECEIVE         ' TO DP013-PARAGRAPH      11460099
114700             MOVE 'BAD RECEIVE        ' TO DP013-MESSAGE-TEXT (1) 11470099
114800             SET DP013-CICS-ABEND       TO TRUE                   11480099
114900             SET DP013-NO-ROLLBACK      TO TRUE                   11490099
115000             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               11500099
115100     END-EVALUATE.                                                11510099
115200*                                                                 11520099
115300*                                                                 11530099
115400*----------------------------------------------------------------*11540099
115500*  GETS USER ID FROM SYSTEM.                                      11550099
115600*----------------------------------------------------------------*11560099
115700 7000-GET-USER-ID.                                                11570099
115800                                                                  11580099
115900     EXEC CICS ASSIGN                                             11590099
116000               APPLID(PV-SYSTEM-ID)                               11600099
116100               USERID(SU001-USER-ID)                              11610099
116200     END-EXEC.                                                    11620099
116300*                                                                 11630099
116400*                                                                 11640099
116500*----------------------------------------------------------------*11650099
116600*  GETS CURRENT DB2 TIMESTAMP.                                    11660099
116700*----------------------------------------------------------------*11670099
116800 7100-GET-CURRENT-TIMESTAMP.                                      11680099
116900         EXEC SQL                                                 11690099
117000             SET :PV-DB2-CURRENT-TMST = CURRENT TIMESTAMP         11700099
117100         END-EXEC.                                                11710099
117200*                                                                 11720099
117300*----------------------------------------------------------------*11730099
117400*  WHEN USER SELECTS THE ENTIRE TRIP IN THE PO REQUEST SCREEN,   *11740099
117500*  THE ENTIRE TRIP IS INSERTED INTO THE SURPRQ TABLE.            *11750099
117600*----------------------------------------------------------------*11760099
117700 7500-INSERT-TRIP-ID.                                             11770099
117800     MOVE SU001-USER-ID              TO DK-USER-ID.               11780099
117900     MOVE DK-USER-ID                 TO SURPRQ-WRKR-USR-ID.       11790099
118000     MOVE SU001-MANIFEST             TO SURPRQ-TRIP-ID.           11800099
118100     MOVE ZEROS                      TO SURPRQ-PO-NBR.            11810099
118200     MOVE PV-DB2-CURRENT-TMST        TO SURPRQ-RQST-TMST.         11820099
118300     MOVE SU001-ALL-PO-IND           TO SURPRQ-ALL-PO-IND.        11830099
118400                                                                  11840099
118500     EXEC SQL                                                     11850099
118600         INSERT INTO TSURPRQ                                      11860099
118700               (WRKR_USR_ID                                       11870099
118800              , TRIP_ID                                           11880099
118900              , PO_NBR                                            11890099
119000              , RQST_TMST                                         11900099
119100              , ALL_PO_IND                                        11910099
119200               )                                                  11920099
119300         VALUES (:SURPRQ-WRKR-USR-ID                              11930099
119400               , :SURPRQ-TRIP-ID                                  11940099
119500               , :SURPRQ-PO-NBR                                   11950099
119600               , :SURPRQ-RQST-TMST                                11960099
119700               , :SURPRQ-ALL-PO-IND                               11970099
119800                )                                                 11980099
119900     END-EXEC.                                                    11990099
120000                                                                  12000099
120100     EVALUATE TRUE                                                12010099
120200         WHEN SQLCODE = ZERO                                      12020099
120300             MOVE SURPRQ-WRKR-USR-ID TO SU001-USER-ID             12030099
120400             MOVE SURPRQ-TRIP-ID     TO SU001-MANIFEST            12040099
120500             MOVE SURPRQ-RQST-TMST   TO SU001-RQST-TMST           12050099
120600             MOVE SURPRQ-ALL-PO-IND  TO SU001-ALL-PO-IND          12060099
120700         WHEN SQLWARN0 NOT = SPACE                                12070099
120800         WHEN SQLCODE NOT EQUAL ZERO                              12080099
120900             MOVE '7500-INSERT-TSURPRQ'                           12090099
121000                             TO DP013-PARAGRAPH                   12100099
121100             MOVE 'SUKRF531 - INSERT SU TRIP ID'                  12110099
121200                             TO DP013-MESSAGE-TEXT(1)             12120099
121300             MOVE SURPRQ-TRIP-ID                                  12130099
121400                             TO DP013-MESSAGE-TEXT(2)             12140099
121500             MOVE SQLCA      TO DP013-SQLCA                       12150099
121600             MOVE 'TSURPRQ'  TO DP013-DB2-TABLE-NAME(1)           12160099
121700             SET DP013-DB2-ABEND                                  12170099
121800                             TO TRUE                              12180099
121900             SET DP013-ROLLBACK                                   12190099
122000                             TO TRUE                              12200099
122100             SET DP013-XCTL-DISPLAY-RESTART                       12210099
122200                             TO TRUE                              12220099
122300             PERFORM DP014-0000-PROCESS-ABEND                     12230099
122400     END-EVALUATE.                                                12240099
122500                                                                  12250099
122600*----------------------------------------------------------------*12260099
122700*  WHEN USER SELECTS INDIVIDUAL PO NUMBERS IN THE PO REQUEST     *12270099
122800*  SCREEN, THOSE PO'S ARE INSERTED INTO THE SURPRQ TABLE.        *12280099
122900*----------------------------------------------------------------*12290099
123000 7510-INSERT-PO-NBRS.                                             12300099
123100                                                                  12310099
123200     MOVE SU001-USER-ID              TO DK-USER-ID.               12320099
123300     MOVE DK-USER-ID                 TO SURPRQ-WRKR-USR-ID.       12330099
123400     MOVE SU001-MANIFEST             TO SURPRQ-TRIP-ID.           12340099
123500     MOVE DK-PO-NBR                  TO SURPRQ-PO-NBR.            12350099
123600     MOVE PV-DB2-CURRENT-TMST        TO SURPRQ-RQST-TMST.         12360099
123700     MOVE SU001-ALL-PO-IND           TO SURPRQ-ALL-PO-IND.        12370099
123800                                                                  12380099
123900     EXEC SQL                                                     12390099
124000         INSERT INTO TSURPRQ                                      12400099
124100               (WRKR_USR_ID                                       12410099
124200              , TRIP_ID                                           12420099
124300              , PO_NBR                                            12430099
124400              , RQST_TMST                                         12440099
124500              , ALL_PO_IND                                        12450099
124600               )                                                  12460099
124700         VALUES (:SURPRQ-WRKR-USR-ID                              12470099
124800               , :SURPRQ-TRIP-ID                                  12480099
124900               , :SURPRQ-PO-NBR                                   12490099
125000               , :SURPRQ-RQST-TMST                                12500099
125100               , :SURPRQ-ALL-PO-IND                               12510099
125200                )                                                 12520099
125300     END-EXEC.                                                    12530099
125400                                                                  12540099
125500     EVALUATE TRUE                                                12550099
125600         WHEN SQLCODE = ZERO                                      12560099
125700         WHEN SQLCODE = -803                                      12570099
125800             MOVE SURPRQ-WRKR-USR-ID TO SU001-USER-ID             12580099
125900             MOVE SURPRQ-TRIP-ID     TO SU001-MANIFEST            12590099
126000             MOVE SURPRQ-RQST-TMST   TO SU001-RQST-TMST           12600099
126100             MOVE SURPRQ-ALL-PO-IND  TO SU001-ALL-PO-IND          12610099
126200         WHEN SQLWARN0 NOT = SPACE                                12620099
126300         WHEN SQLCODE NOT EQUAL ZERO                              12630099
126400             MOVE '7510-INSERT-PO-NBRS'                           12640099
126500                             TO DP013-PARAGRAPH                   12650099
126600             MOVE 'SUKRF531 - INSERT PO NBRS'                     12660099
126700                             TO DP013-MESSAGE-TEXT(1)             12670099
126800             MOVE SURPRQ-PO-NBR                                   12680099
126900                             TO DP013-MESSAGE-TEXT(2)             12690099
127000             MOVE SQLCA      TO DP013-SQLCA                       12700099
127100             MOVE 'TSURPRQ'  TO DP013-DB2-TABLE-NAME(1)           12710099
127200             SET DP013-DB2-ABEND                                  12720099
127300                             TO TRUE                              12730099
127400             SET DP013-ROLLBACK                                   12740099
127500                             TO TRUE                              12750099
127600             SET DP013-XCTL-DISPLAY-RESTART                       12760099
127700                             TO TRUE                              12770099
127800             PERFORM DP014-0000-PROCESS-ABEND                     12780099
127900     END-EVALUATE.                                                12790099
128000*                                                                 12800099
128100*                                                                 12810099
128200 8000-SEND-MAP.                                                   12820099
128300                                                                  12830099
128400     EXEC CICS                                                    12840099
128500         SEND MAP       ('SUKM531')                               12850099
128600              MAPSET    ('SUKM531')                               12860099
128700              ERASE                                               12870099
128800              CURSOR                                              12880099
128900              RESP      (PV-CICS-RESPONSE)                        12890099
129000     END-EXEC.                                                    12900099
129100                                                                  12910099
129200     EVALUATE TRUE                                                12920099
129300         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 12930099
129400             CONTINUE                                             12940099
129500         WHEN OTHER                                               12950099
129600             MOVE '8000-SEND-MAP'      TO DP013-PARAGRAPH         12960099
129700             MOVE 'UNABLE TO SEND MAP' TO DP013-MESSAGE-TEXT (1)  12970099
129800             SET DP013-CICS-ABEND      TO TRUE                    12980099
129900             SET DP013-NO-ROLLBACK     TO TRUE                    12990099
130000             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               13000099
130100     END-EVALUATE.                                                13010099
130200*                                                                 13020099
130300*                                                                 13030099
130400 8100-SEND-DATA-ONLY.                                             13040099
130500                                                                  13050099
130600     EXEC CICS                                                    13060099
130700         SEND MAP       ('SUKM531')                               13070099
130800              MAPSET    ('SUKM531')                               13080099
130900              CURSOR                                              13090099
131000              DATAONLY                                            13100099
131100              RESP      (PV-CICS-RESPONSE)                        13110099
131200     END-EXEC.                                                    13120099
131300                                                                  13130099
131400     EVALUATE TRUE                                                13140099
131500         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 13150099
131600             CONTINUE                                             13160099
131700         WHEN OTHER                                               13170099
131800             MOVE '8100-SEND-DATA-ONLY' TO DP013-PARAGRAPH        13180099
131900             MOVE 'UNABLE TO SEND DATA' TO DP013-MESSAGE-TEXT (1) 13190099
132000             SET DP013-CICS-ABEND       TO TRUE                   13200099
132100             SET DP013-NO-ROLLBACK      TO TRUE                   13210099
132200             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               13220099
132300     END-EVALUATE.                                                13230099
132400*                                                                 13240099
132500*                                                                 13250099
132600 8200-RETURN-TRANID.                                              13260099
132700                                                                  13270099
132800     MOVE LENGTH OF CA-COMMAREA  TO PV-COMMAREA-LENGTH            13280099
132900     EXEC CICS                                                    13290099
133000         RETURN TRANSID  (PC-TRANID)                              13300099
133100                COMMAREA (CA-COMMAREA)                            13310099
133200                LENGTH   (PV-COMMAREA-LENGTH)                     13320099
133300                RESP     (PV-CICS-RESPONSE)                       13330099
133400     END-EXEC.                                                    13340099
133500                                                                  13350099
133600     EVALUATE TRUE                                                13360099
133700         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 13370099
133800             CONTINUE                                             13380099
133900         WHEN OTHER                                               13390099
134000             MOVE '8200-RETURN-TRANIND' TO DP013-PARAGRAPH        13400099
134100             MOVE 'UNABLE TO RETURN TO TRANID'                    13410099
134200                 TO DP013-MESSAGE-TEXT (1)                        13420099
134300             SET DP013-CICS-ABEND       TO TRUE                   13430099
134400             SET DP013-NO-ROLLBACK      TO TRUE                   13440099
134500             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               13450099
134600     END-EVALUATE.                                                13460099
134700*                                                                 13470099
134800*                                                                 13480099
134900 8300-RETURN.                                                     13490099
135000                                                                  13500099
135100     EXEC CICS                                                    13510099
135200         SEND FROM (PV-MESSAGE-AREA)                              13520099
135300              LENGTH (19)                                         13530099
135400              ERASE                                               13540099
135500     END-EXEC.                                                    13550099
135600                                                                  13560099
135700     EXEC CICS                                                    13570099
135800         RETURN                                                   13580099
135900     END-EXEC.                                                    13590099
136000*                                                                 13600099
136100*                                                                 13610099
136200 9999-WRITE-MESSAGE-TO-CICS-LOG.                                  13620099
136300                                                                  13630099
136400     MOVE PC-CURRENT-PROGRAM-NAME  TO DP013-PROGRAM.              13640099
136500     MOVE DFHEIBLK                 TO DP013-DFHEIBLK.             13650099
136600     INITIALIZE DP013-SRC-TASK-NUMBER                             13660099
136700                DP013-STACK.                                      13670099
136800     SET DP013-LINK-RETURN TO TRUE.                               13680099
136900                                                                  13690099
137000     EXEC CICS                                                    13700099
137100         LINK                                                     13710099
137200             PROGRAM   (DP013-NAME)                               13720099
137300             COMMAREA  (DP013-PARAMETERS)                         13730099
137400             LENGTH    (DP013-LENGTH)                             13740099
137500     END-EXEC.                                                    13750099
137600*                                                                 13760099
137700*                                                                 13770099
137800*----------------------------------------------------------------*13780099
137900*    GET LOGON INFORMATION FOR NON-ARCHITECTURE PROGRAMS         *13790099
138000*----------------------------------------------------------------*13800099
138100                                                                  13810099
138200     COPY DPPD026.                                                13820099
138300*                                                                 13830099
138400*                                                                 13840099
138500*----------------------------------------------------------------*13850099
138600*    ABEND PROCESSOR MODULE                                      *13860099
138700*----------------------------------------------------------------*13870099
138800                                                                  13880099
138900     COPY DPPD014.                                                13890099
139000                                                                  13900099
139100                                                                  13910099
139200                                                                  13920099
