000100******************************************************************00010007
000200 IDENTIFICATION DIVISION.                                         00020007
000300******************************************************************00030007
000400                                                                  00040007
000500 PROGRAM-ID.    SUKUT005.                                         00050007
000600 AUTHOR.        LARRY SCHLEICHER - STRATAGEM                      00060007
000700 INSTALLATION.  KOHLS.                                            00070007
000800 DATE-WRITTEN   SEPTEMBER, 1996.                                  00080007
000900 DATE-COMPILED.                                                   00090007
001000                                                                  00100007
001100******************************************************************00110007
001200*  THIS PROGRAM CREATES AN EXTRACT FILE OF DATA FROM THE SHIPMENT 00120007
001300*  UNIT LOCATION TABLE (TSHUNLO).                                 00130007
001400******************************************************************00140007
001500                                                                  00150007
001600******************************************************************00160007
001700 ENVIRONMENT DIVISION.                                            00170007
001800******************************************************************00180007
001900                                                                  00190007
002000 CONFIGURATION SECTION.                                           00200007
002100                                                                  00210007
002200 SOURCE-COMPUTER.        IBM-3090.                                00220007
002300 OBJECT-COMPUTER.        IBM-3090.                                00230007
002400                                                                  00240007
002500 INPUT-OUTPUT SECTION.                                            00250007
002600                                                                  00260007
002700 FILE-CONTROL.                                                    00270007
002800                                                                  00280007
002900                                                                  00290007
003000     SELECT TIMESTAMP-FILE                                        00300007
003100         ASSIGN TO INP01.                                         00310007
003200                                                                  00320007
003300     SELECT SHIPMENT-LOC-FILE                                     00330007
003400         ASSIGN TO OUT02.                                         00340007
003500                                                                  00350007
003600     SELECT DELETE-FILE                                           00360007
003700         ASSIGN TO OUT03.                                         00370007
003800******************************************************************00380007
003900 DATA DIVISION.                                                   00390007
004000******************************************************************00400007
004100                                                                  00410007
004200 FILE SECTION.                                                    00420007
004300                                                                  00430007
004400 FD  TIMESTAMP-FILE                                               00440007
004500     RECORDING MODE IS F                                          00450007
004600     LABEL RECORDS ARE STANDARD                                   00460007
004700     BLOCK CONTAINS 0 RECORDS.                                    00470007
004800                                                                  00480007
004900 01  TIMESTAMP-RECORD           PIC  X(50).                       00490007
005000                                                                  00500007
005100 FD  SHIPMENT-LOC-FILE                                            00510007
005200     RECORDING MODE IS F                                          00520007
005300     LABEL RECORDS ARE STANDARD                                   00530007
005400     BLOCK CONTAINS 0 RECORDS.                                    00540007
005500                                                                  00550007
005600 01  SHIPMENT-LOC-REC           PIC  X(056).                      00560007
005700*                                                                 00570007
005800 FD  DELETE-FILE                                                  00580007
005900     RECORDING MODE IS F                                          00590007
006000     LABEL RECORDS ARE STANDARD                                   00600007
006100     BLOCK CONTAINS 0 RECORDS.                                    00610007
006200                                                                  00620007
006300 01  DELETE-RECORD              PIC  X(056).                      00630007
006400*                                                                 00640007
006500******************************************************************00650007
006600 WORKING-STORAGE SECTION.                                         00660007
006700******************************************************************00670007
006800*                                                                 00680007
006900*                                                                 00690007
007000*                                                                 00700007
007100*                                                                 00710007
007200******************************************************************00720007
007300*  RECORD LAYOUT FOR THE TIMESTAMP FILE.                          00730007
007400******************************************************************00740007
007500     COPY RCRD011.                                                00750007
007600*                                                                 00760007
007700*                                                                 00770007
007800*                                                                 00780007
007900******************************************************************00790007
008000*  DB2 FORMATTED MESSAGE AREA                                     00800007
008100******************************************************************00810007
008200     COPY DPWS004.                                                00820013
008300*                                                                 00830007
008400*                                                                 00840007
008500*                                                                 00850007
008600******************************************************************00860007
008700*  COMMUNICATIONS AREA FOR DB2                                    00870007
008800******************************************************************00880007
008900     EXEC SQL                                                     00890007
009000          INCLUDE SQLCA                                           00900007
009100     END-EXEC.                                                    00910007
009200*                                                                 00920007
009300*                                                                 00930007
009400******************************************************************00940007
009500*  COBOL DECLARATION AND DCLGEN MEMBER FOR THE ?????????????????  00950007
009600*  TABLE                                                          00960007
009700******************************************************************00970007
009800     EXEC SQL                                                     00980007
009900          INCLUDE TCOCNTL                                         00990007
010000     END-EXEC.                                                    01000007
010100                                                                  01010007
010200******************************************************************01020007
010300*  COBOL DECLARATION AND DCLGEN MEMBER FOR THE SHIPMENT UNIT      01030007
010400*  LOCATION TABLE                                                 01040007
010500******************************************************************01050007
010600     EXEC SQL                                                     01060007
010700          INCLUDE TSHUNLO                                         01070007
010800     END-EXEC.                                                    01080007
010900*                                                                 01090007
011000******************************************************************01100007
011100*  COBOL DECLARATION AND DCLGEN MEMBER FOR THE SHIPMENT UNIT      01110007
011200*  AUDIT TRANSACTION TABLE                                        01120007
011300******************************************************************01130007
011400     EXEC SQL                                                     01140007
011500          INCLUDE TSUATRN                                         01150007
011600     END-EXEC.                                                    01160007
011700*                                                                 01170007
011800 01  ABEND-CODE                      PIC S9(04)    VALUE +0       01180007
011900                                                   COMP SYNC.     01190007
012000                                                                  01200007
012100 01  PS-PROGRAM-SWITCHES.                                         01210007
012200     05  PS-EOF-SHIPMENT-LOC-CSR-SW  PIC  X(01)    VALUE 'N'.     01220007
012300         88  PS-EOF-SHIPMENT-LOC-CSR               VALUE 'Y'.     01230007
012400         88  PS-MORE-SHIPMENT-LOC-CSR              VALUE 'N'.     01240007
012500     05  PS-FOUND-ON-AUDIT-SW        PIC  X(01)    VALUE 'N'.     01250007
012600         88  FOUND-ON-AUDIT                        VALUE 'Y'.     01260007
012700         88  NOT-FOUND-ON-AUDIT                    VALUE 'N'.     01270007
012800                                                                  01280007
012900                                                                  01290007
013000 01  PC-PROGRAM-CONSTANTS.                                        01300007
013100     05  PC-ROW-NOT-FOUND            PIC S9(04)    VALUE +100     01310007
013200                                                   COMP SYNC.     01320007
013300     05  PC-CURRENT-PROGRAM-NAME     PIC  X(08)    VALUE          01330007
013400         'SUKUT005'.                                              01340007
013500     05  PC-CURRENT-OPERATING-COMPANY                             01350007
013600                                     PIC  X(02)    VALUE '03'.    01360007
013700     05  PC-MAX-RETRIES              PIC S9(04)    VALUE +3       01370007
013800                                                   COMP SYNC.     01380007
013900     05  PC-CURRENT-TIMESTAMP        PIC  X(26)    VALUE SPACES.  01390007
014000                                                                  01400007
014100 01  PV-PROGRAM-VARIABLES.                                        01410007
014200     05  PV-ITEM-NBR                 PIC  9(15)    VALUE ZERO.    01420007
014300     05  PV-PARAGRAPH-NAME           PIC  X(30)    VALUE SPACES.  01430007
014400     05  PV-DB2-OPERATION-ATTEMPTED  PIC  X(30)    VALUE SPACES.  01440007
014500     05  PV-OPEN-COUNTER             PIC S9(04)    VALUE ZERO     01450007
014600                                                   COMP SYNC.     01460007
014700     05  PV-CLOSE-COUNTER            PIC S9(04)    VALUE ZERO     01470007
014800                                                   COMP SYNC.     01480007
014900     05  PV-FETCH-COUNTER            PIC S9(04)    VALUE ZERO     01490007
015000                                                   COMP SYNC.     01500007
015100     05  PV-WRITE-COUNTER            PIC S9(09)    VALUE ZERO     01510007
015200                                                   COMP SYNC.     01520007
015300     05  PV-WRITE2-COUNTER           PIC S9(09)    VALUE ZERO     01530007
015400                                                   COMP SYNC.     01540007
015500     05  PV-DISPLAY-COUNT            PIC ZZZ,ZZZ,ZZ9.             01550007
015600                                                                  01560007
015700     05  PV-DB2-COUNT                PIC S9(09)    VALUE ZERO     01570007
015800                                                   COMP-3.        01580007
015900                                                                  01590007
016000                                                                  01600007
016100 01  SD-SYSTEM-DATE.                                              01610007
016200     05  SD-SYSTEM-DATE-YY           PIC  9(02)      VALUE ZERO.  01620007
016300     05  SD-SYSTEM-DATE-MM           PIC  9(02)      VALUE ZERO.  01630007
016400     05  SD-SYSTEM-DATE-DD           PIC  9(02)      VALUE ZERO.  01640007
016500                                                                  01650007
016600*                                                                 01660007
016700*  CURSOR DECLARATION FOR ALL EXCEPTION ACTIVITY ON THE           01670007
016800*  SHIPMENT UNIT LOCATION TABLE                                   01680007
016900*                                                                 01690007
017000                                                                  01700007
017100     EXEC SQL                                                     01710007
017200          DECLARE SHIPMT_LOC_CURSOR CURSOR FOR                    01720007
017300           SELECT                                                 01730007
017400                 A.SHIPT_UNT_ID                                   01740007
017500               , A.OPER_UNT_ID                                    01750007
017600               , A.FCLTY_ID                                       01760007
017700               , A.SCN_LOC_ID                                     01770007
017800               , A.CRE_USR_ID                                     01780007
017900               , A.CRE_TMST                                       01790007
018000               , A.TRIP_ID                                        01800007
018100             FROM TSHUNLO A                                       01810007
018200            WHERE A.CRE_TMST       < :PC-CURRENT-TIMESTAMP        01820007
P41441*             AND A.SCN_LOC_ID   IN ('RECV','NSCN')               01821018
P41441              AND A.SCN_LOC_ID   IN ('RECV','NSCN','WRCV')        01821118
018220              AND A.ACTV_CDE         = 'A'                        01822009
018300            ORDER BY SHIPT_UNT_ID                                 01830007
018400                                                                  01840007
018500     END-EXEC.                                                    01850007
018600                                                                  01860007
018700                                                                  01870007
018800******************************************************************01880007
018900 PROCEDURE DIVISION.                                              01890007
019000******************************************************************01900007
019100                                                                  01910007
019200 0000-PROGRAM-MAINLINE.                                           01920007
019300******************************************************************01930007
019400* 0000-PROGRAM-MAINLINE - CONTROLS THE MAIN PROCESSING OF THE     01940007
019500*      PROGRAM.                                                   01950007
019600******************************************************************01960007
019700                                                                  01970007
019800     PERFORM 1000-INITIALIZE.                                     01980007
019900     IF PS-MORE-SHIPMENT-LOC-CSR                                  01990007
020000         PERFORM 2000-PROCESS-SHIPMENT-LOC                        02000007
020100            UNTIL PS-EOF-SHIPMENT-LOC-CSR                         02010007
020200     END-IF.                                                      02020007
020300     PERFORM 9000-EOJ-ROUTINE.                                    02030007
020400                                                                  02040007
020500     STOP RUN.                                                    02050007
020600                                                                  02060007
020700 1000-INITIALIZE.                                                 02070007
020800******************************************************************02080007
020900*  DO FIRST TIME PROGRAM INITIALIZATION TASKS.                    02090007
021000*    -- OPEN OUTPUT FILE                                          02100007
021100*    -- OPEN CURSOR                                               02110007
021200*    -- FETCH CURSOR                                              02120007
021300******************************************************************02130007
021400                                                                  02140007
021500     ACCEPT SD-SYSTEM-DATE FROM DATE.                             02150007
021600                                                                  02160007
021700     OPEN OUTPUT SHIPMENT-LOC-FILE                                02170007
021800                 DELETE-FILE                                      02180007
021900          INPUT  TIMESTAMP-FILE.                                  02190007
022000                                                                  02200007
022100     PERFORM 1100-READ-TIMESTAMP-FILE.                            02210007
022200     PERFORM 7000-OPEN-SHIPMENT-LOC-CURSOR.                       02220007
022300     PERFORM 7100-FETCH-SHIPMENT-LOC-CURSOR.                      02230007
022400                                                                  02240007
022500 1100-READ-TIMESTAMP-FILE.                                        02250007
022600      READ TIMESTAMP-FILE INTO                                    02260007
022700          RC011-CONTROL-RECORD.                                   02270007
022800      MOVE RC011-CONTROL-TMST TO PC-CURRENT-TIMESTAMP.            02280018
022900     DISPLAY 'SUKUT005 CONTROL CARD -- ' RC011-CONTROL-TMST.      02290007
023000                                                                  02300007
023100 2000-PROCESS-SHIPMENT-LOC.                                       02310007
023200******************************************************************02320007
023300*  PROCESS THE CERTIFICATION REQUESTS (LOOP THROUGH THE RESULTS   02330007
023400*  TABLE).  FORMAT THE OUTPUT RECORD.  WRITE THE RECORDS THAT     02340007
023500*  MEET THE CRITERIA.   CHECK TO SEE IF THE CARTON RECORD IS      02350007
023600*  INCLUDED IN AN AUDIT.  IF THE CARTON IS NOT INCLUDED IN AN     02360007
023700*  AUDIT, THEN IT CAN BE WRITTEN TO THE DELETE FILE.              02370007
023800******************************************************************02380007
023900                                                                  02390007
024000     PERFORM 8000-WRITE-SHIPMENT-LOC-RECORD.                      02400007
024100                                                                  02410007
024200     PERFORM 7200-CHECK-AUDIT-DATABASE.                           02420007
024300     IF FOUND-ON-AUDIT                                            02430007
024400        CONTINUE                                                  02440007
024500     ELSE                                                         02450007
024600        PERFORM 8200-WRITE-DELETE-RECORD                          02460007
024700     END-IF.                                                      02470007
024800                                                                  02480007
024900     PERFORM 7100-FETCH-SHIPMENT-LOC-CURSOR.                      02490007
025000                                                                  02500007
025100 7000-OPEN-SHIPMENT-LOC-CURSOR.                                   02510007
025200******************************************************************02520007
025300*  OPEN THE CURSOR.                                               02530007
025400******************************************************************02540007
025500     PERFORM WITH TEST AFTER                                      02550007
025600       VARYING PV-OPEN-COUNTER FROM 1 BY 1                        02560007
025700         UNTIL (PV-OPEN-COUNTER > PC-MAX-RETRIES                  02570007
025800                OR                                                02580007
025900                SQLCODE = ZERO)                                   02590007
026000                                                                  02600007
026100         EXEC SQL                                                 02610007
026200              OPEN SHIPMT_LOC_CURSOR                              02620007
026300         END-EXEC                                                 02630007
026400                                                                  02640007
026500         EVALUATE TRUE                                            02650007
026600             WHEN SQLCODE = -904                                  02660007
026700             WHEN SQLCODE = -911                                  02670007
026800                 CONTINUE                                         02680007
026900             WHEN SQLWARN0 NOT = SPACES                           02690007
027000             WHEN SQLCODE < ZERO                                  02700007
027100             WHEN SQLCODE > ZERO                                  02710007
027200                 MOVE '7000-OPEN-SHIPMENT-LOC-CURSOR    '         02720007
027300                                 TO PV-PARAGRAPH-NAME             02730007
027400                 MOVE 'OPEN THE SHIPMT_LOC_CURSOR    '            02740007
027500                                 TO PV-DB2-OPERATION-ATTEMPTED    02750007
027600                 PERFORM 9100-SQL-ABEND                           02760007
027700             WHEN SQLCODE = ZERO                                  02770007
027800                 CONTINUE                                         02780007
027900         END-EVALUATE                                             02790007
028000     END-PERFORM.                                                 02800007
028100                                                                  02810007
028200     IF PV-OPEN-COUNTER > PC-MAX-RETRIES                          02820007
028300         MOVE '7000-OPEN-SHIPMENT-LOC-CURSOR   '                  02830007
028400                                 TO PV-PARAGRAPH-NAME             02840007
028500         MOVE 'OPEN MAX RETRIES EXCEEDED     '                    02850007
028600                                 TO PV-DB2-OPERATION-ATTEMPTED    02860007
028700         PERFORM 9100-SQL-ABEND                                   02870007
028800     END-IF.                                                      02880007
028900                                                                  02890007
029000 7100-FETCH-SHIPMENT-LOC-CURSOR.                                  02900007
029100******************************************************************02910007
029200*  FETCH THE ROW FROM THE RESULTS TABLE USING THE CURSOR.         02920007
029300******************************************************************02930007
029400     EXEC SQL                                                     02940007
029500          FETCH SHIPMT_LOC_CURSOR                                 02950007
029600           INTO :SHUNLO-SHIPT-UNT-ID                              02960007
029700              , :SHUNLO-OPER-UNT-ID                               02970007
029800              , :SHUNLO-FCLTY-ID                                  02980007
029900              , :SHUNLO-SCN-LOC-ID                                02990007
030000              , :SHUNLO-CRE-USR-ID                                03000007
030100              , :SHUNLO-CRE-TMST                                  03010007
030200              , :SHUNLO-TRIP-ID                                   03020007
030300     END-EXEC.                                                    03030007
030400                                                                  03040007
030500     EVALUATE TRUE                                                03050007
030600         WHEN SQLCODE = ZERO                                      03060007
030700             CONTINUE                                             03070007
030800         WHEN SQLCODE = +100                                      03080007
030900             SET PS-EOF-SHIPMENT-LOC-CSR                          03090007
031000                                 TO TRUE                          03100007
031100         WHEN SQLWARN0 NOT = SPACES                               03110007
031200         WHEN SQLCODE < ZERO                                      03120007
031300         WHEN SQLCODE > ZERO                                      03130007
031400             MOVE '7100-FETCH-SHIPMENT-LOC-CURSOR  '              03140007
031500                                 TO PV-PARAGRAPH-NAME             03150007
031600             MOVE 'FETCH THE SHIPMENT-LOC-CURSOR   '              03160007
031700                                 TO PV-DB2-OPERATION-ATTEMPTED    03170007
031800             PERFORM 9100-SQL-ABEND                               03180007
031900     END-EVALUATE.                                                03190007
032000                                                                  03200007
032100 7200-CHECK-AUDIT-DATABASE.                                       03210007
032200******************************************************************03220007
032300*  PERFORM A SELECT AGAINST THE AUDIT DATABASE TO SEE IF THE CARTO03230007
032400*  IS INCLUDED IN AN AUDIT.  IF IT IS A RECORD WILL BE WRITTEN TO 03240007
032500*  THE SHIPUNIT INACTIVE FILE.                                    03250007
032600******************************************************************03260007
032700                                                                  03270007
032800     EXEC SQL                                                     03280007
032900          SELECT AUD_CNTL_NBR                                     03290007
033000            INTO :SUATRN-AUD-CNTL-NBR                             03300007
033100            FROM TSUATRN                                          03310007
033200           WHERE SHIPT_UNT_ID = :SHUNLO-SHIPT-UNT-ID              03320007
033210             AND DEST_FCLTY_ID >= 0                               03321007
033300     END-EXEC.                                                    03330007
033400                                                                  03340007
033500     EVALUATE TRUE                                                03350007
033600         WHEN SQLCODE = ZERO                                      03360007
033700         WHEN SQLCODE = -811                                      03370007
033800             SET FOUND-ON-AUDIT TO TRUE                           03380007
033900         WHEN SQLCODE = +100                                      03390007
034000             SET NOT-FOUND-ON-AUDIT                               03400007
034100                                 TO TRUE                          03410007
034200         WHEN SQLWARN0 NOT = SPACES                               03420007
034300         WHEN SQLCODE < ZERO                                      03430007
034400         WHEN SQLCODE > ZERO                                      03440007
034500             MOVE '7200-CHECK-AUDIT-DATABASE      '               03450007
034600                                 TO PV-PARAGRAPH-NAME             03460007
034700             DISPLAY 'SHIP UNIT ID BEING PROCESSED '              03470007
034800                SHUNLO-SHIPT-UNT-ID                               03480007
034900             PERFORM 9100-SQL-ABEND                               03490007
035000     END-EVALUATE.                                                03500007
035100                                                                  03510007
035200 8000-WRITE-SHIPMENT-LOC-RECORD.                                  03520007
035300******************************************************************03530007
035400*  WRITE THE SHIPMENT-LOC-REC                                     03540007
035500******************************************************************03550007
035600     INITIALIZE SHIPMENT-LOC-REC.                                 03560007
035700     WRITE SHIPMENT-LOC-REC                                       03570007
035800         FROM DCLTSHUNLO.                                         03580007
035900     ADD +1 TO PV-WRITE-COUNTER.                                  03590007
036000                                                                  03600007
036100 8100-WRITE-TIMESTAMP-RECORD.                                     03610012
036200******************************************************************03620007
036300*  WRITE THE TIMESTAMP RECORD                                     03630007
036400******************************************************************03640007
036500     WRITE TIMESTAMP-RECORD                                       03650012
036600         FROM RC011-CONTROL-RECORD.                               03660012
036700                                                                  03670007
036800 8200-WRITE-DELETE-RECORD.                                        03680007
036900******************************************************************03690007
037000*  WRITE THE SHIPMENT-LOC-REC                                     03700007
037100******************************************************************03710007
037200     INITIALIZE DELETE-RECORD.                                    03720007
037300     WRITE DELETE-RECORD                                          03730007
037400         FROM DCLTSHUNLO.                                         03740007
037500     ADD +1 TO PV-WRITE2-COUNTER.                                 03750007
037600                                                                  03760007
037700                                                                  03770007
037800 9000-EOJ-ROUTINE.                                                03780007
037900******************************************************************03790007
038000*  CLOSE OUTPUT FILE.  CLOSE THE CURSOR.                          03800007
038100******************************************************************03810007
038200     CLOSE SHIPMENT-LOC-FILE                                      03820007
038300           DELETE-FILE                                            03830007
038400           TIMESTAMP-FILE.                                        03840007
038500                                                                  03850007
038600     MOVE PV-WRITE-COUNTER TO PV-DISPLAY-COUNT.                   03860007
038700     DISPLAY 'TOTAL EXTRACT RECORDS WRITTEN    ' PV-DISPLAY-COUNT.03870007
038800     MOVE PV-WRITE2-COUNTER TO PV-DISPLAY-COUNT.                  03880007
038900     DISPLAY 'TOTAL DELETE RECORDS WRITTEN     ' PV-DISPLAY-COUNT.03890007
039000                                                                  03900007
039100     PERFORM WITH TEST AFTER                                      03910007
039200       VARYING PV-CLOSE-COUNTER FROM 1 BY 1                       03920007
039300         UNTIL (PV-CLOSE-COUNTER > PC-MAX-RETRIES                 03930007
039400                OR                                                03940007
039500                SQLCODE = ZERO)                                   03950007
039600                                                                  03960007
039700         EXEC SQL                                                 03970007
039800              CLOSE SHIPMT_LOC_CURSOR                             03980007
039900         END-EXEC                                                 03990007
040000                                                                  04000007
040100         EVALUATE TRUE                                            04010007
040200             WHEN SQLCODE = -904                                  04020007
040300             WHEN SQLCODE = -911                                  04030007
040400                 CONTINUE                                         04040007
040500             WHEN SQLWARN0 NOT = SPACES                           04050007
040600             WHEN SQLCODE < ZERO                                  04060007
040700             WHEN SQLCODE > ZERO                                  04070007
040800                 MOVE '9000-EOJ-ROUTINE               '           04080007
040900                                 TO PV-PARAGRAPH-NAME             04090007
041000                 MOVE 'CLOSE THE SHIPMT_LOC_CURSOR    '           04100007
041100                                 TO PV-DB2-OPERATION-ATTEMPTED    04110007
041200                 PERFORM 9100-SQL-ABEND                           04120007
041300             WHEN SQLCODE = ZERO                                  04130007
041400                 CONTINUE                                         04140007
041500         END-EVALUATE                                             04150007
041600     END-PERFORM.                                                 04160007
041700                                                                  04170007
041800     IF PV-CLOSE-COUNTER > PC-MAX-RETRIES                         04180007
041900         MOVE '9000-EOJ-ROUTINE               '                   04190007
042000                                 TO PV-PARAGRAPH-NAME             04200007
042100         MOVE 'CLOSE MAX RETRIES EXCEEDED     '                   04210007
042200                                 TO PV-DB2-OPERATION-ATTEMPTED    04220007
042300         PERFORM 9100-SQL-ABEND                                   04230007
042400     END-IF.                                                      04240007
042500                                                                  04250007
042600 9100-SQL-ABEND.                                                  04260007
042700******************************************************************04270007
042800*  PERFORMS THE ABEND FOR THE PROGRAM IN THE EVENT THAT AN SQL    04280007
042900*  ERROR OR WARNING CODE OCCURS.                                  04290007
043000******************************************************************04300007
043100     DISPLAY '9100-SQL-ABEND'.                                    04310007
043200     DISPLAY '** ABEND     **'.                                   04320007
043300     DISPLAY '** PROGRAM   ** = ' PC-CURRENT-PROGRAM-NAME.        04330007
043400     DISPLAY '** PARAGRAPH ** = ' PV-PARAGRAPH-NAME.              04340007
043500     DISPLAY '** OPERATION ** = ' PV-DB2-OPERATION-ATTEMPTED.     04350007
043600                                                                  04360007
043700******************************************************************04370007
043800* THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION STATE-    04380007
043900* MENTS THAT ARE REQUIRED TO UTILIZE THE DB2 ABEND MODULE         04390007
044000* 'DSNTIAR' AND CONVERT THE SQLCA INFORMATION INTO A READABLE     04400007
044100* FORMAT.                                                         04410007
044200******************************************************************04420007
044300     COPY DPPD004.                                                04430007
044400                                                                  04440007
044500     MOVE +4013                  TO ABEND-CODE.                   04450007
044600     CALL 'ILBOABN0' USING ABEND-CODE.                            04460007
