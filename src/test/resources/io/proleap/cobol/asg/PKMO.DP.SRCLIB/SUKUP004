000100 IDENTIFICATION DIVISION.                                         00010000
000200 TITLE 'PROCESS RDM BOL UPLOAD DATA'.                             00020000
000300                                                                  00030000
000400 PROGRAM-ID.             SUKUP004.                                00040000
000500 AUTHOR.                 DENNIS STEFFEN.                          00050000
000600 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00060000
000700 DATE-WRITTEN            OCTOBER 2000.                            00070000
000800 DATE-COMPILED.                                                   00080000
000900                                                                  00090000
001000                                                                  00100000
001100                                                                  00110000
001200 ENVIRONMENT DIVISION.                                            00120000
001300                                                                  00130000
001400 CONFIGURATION SECTION.                                           00140000
001500                                                                  00150000
001600 SOURCE-COMPUTER.        IBM-3090.                                00160000
001700 OBJECT-COMPUTER.        IBM-3090.                                00170000
001800                                                                  00180000
001900 INPUT-OUTPUT SECTION.                                            00190000
002000                                                                  00200000
002100 FILE-CONTROL.                                                    00210000
002200                                                                  00220000
002300     SELECT SU-MANIFEST-BOL-FILE                                  00230000
002400         ASSIGN TO INP01.                                         00240000
002500                                                                  00250000
002600 DATA DIVISION.                                                   00260000
002700 FILE SECTION.                                                    00270000
002800                                                                  00280000
002900                                                                  00290000
003000 FD  SU-MANIFEST-BOL-FILE                                         00300000
003100     RECORDING MODE IS F                                          00310000
003200     LABEL RECORDS ARE STANDARD                                   00320000
003300     RECORD CONTAINS 130 CHARACTERS                               00330000
003400     BLOCK CONTAINS 0  RECORDS.                                   00340000
003500 01  SU-MANIFEST-BOL-REC              PIC X(130).                 00350000
003600                                                                  00360000
003700 WORKING-STORAGE SECTION.                                         00370000
003800 01  PS-SWITCHES.                                                 00380000
003900     05  PS-EOF-MANIFEST-SW           PIC X(01) VALUE 'N'.        00390000
004000         88  PS-EOF-MANIFEST                    VALUE 'Y'.        00400000
004100     05  PS-OTBND-CART-FOUND-SW       PIC X(01) VALUE 'N'.        00410000
004200         88  PS-OTBND-CART-FOUND-YES            VALUE 'Y'.        00420000
004300         88  PS-OTBND-CART-FOUND-NO             VALUE 'N'.        00430000
004400     05  PS-ORIG-FOUND-SW             PIC X(01) VALUE 'N'.        00440000
004500         88  PS-ORIG-FOUND-YES                  VALUE 'Y'.        00450000
004600         88  PS-ORIG-FOUND-NO                   VALUE 'N'.        00460000
004700     05  PS-COMMIT-SW                 PIC X(01) VALUE SPACE.      00470000
004800         88  PS-COMMIT-NOW                      VALUE 'Y'.        00480000
004900         88  PS-AINT-TIME-YET-TO-COMMIT         VALUE 'N'.        00490000
005000                                                                  00500000
005100 01  PV-COUNTERS.                                                 00510000
005200     05  PV-RETRY-COUNTER             PIC S9(03) COMP-3           00520000
005300                                          VALUE ZERO.             00530000
005400     05  PV-MANIFEST-COUNT            PIC S9(07) COMP-3           00540000
005500                                          VALUE ZERO.             00550000
005600     05  PV-WRITE-COUNT               PIC S9(07) COMP-3           00560000
005700                                          VALUE ZERO.             00570000
005800     05  PV-OTBND-CART-INSERT-COUNT   PIC S9(07) COMP-3           00580000
005900                                          VALUE ZERO.             00590000
006000     05  PV-OTBND-CART-DUP-COUNT      PIC S9(07) COMP-3           00600000
006100                                          VALUE ZERO.             00610000
006600     05  PV-OTBND-UPC-INSERT-COUNT    PIC S9(07) COMP-3           00660000
006700                                          VALUE ZERO.             00670000
006800     05  PV-OTBND-UPC-DUP-COUNT       PIC S9(07) COMP-3           00680000
006900                                          VALUE ZERO.             00690000
007000     05  PV-COMMIT-COUNT              PIC S9(07) COMP-3           00700000
007100                                          VALUE ZERO.             00710000
007200 01  PV-OTHER-STUFF.                                              00720000
007300     05  PV-TMST                      PIC X(26).                  00730000
007400     05  PV-HOLD-TMST                 PIC X(26).                  00740000
007500     05  PC-PROGRAM-NAME              PIC X(08) VALUE 'SUKUP004'. 00750000
007600     05  PC-MAX-RETRIES               PIC S9(04)    VALUE  +3     00760000
007700                                                   COMP.          00770000
007800     05  DK-SHIPT-UNT-ID              PIC S9(18)V COMP-3          00780000
007900                                          VALUE ZERO.             00790000
008000     05  DK-BRCDE-NBR                 PIC X(22) VALUE SPACES.     00800000
008100                                                                  00810000
008200     05  PV-CONTAINER-ID.                                         00820000
008300         10  FILLER                   PIC X(02).                  00830000
008400         10  PV-SHIPT-UNT-ID          PIC 9(18).                  00840000
008500     05  PV-DISTRIBUTION-NBR.                                     00850000
008600         10  PV-TRN-NBR               PIC 9(5) VALUE ZEROES.      00860000
008700         10  PV-TRN-LNE-NBR           PIC 9(4) VALUE ZEROES.      00870000
008800                                                                  00880000
008900     05  PV-DISP-NBR                  PIC Z,ZZZ,ZZ9.              00890000
009000     05  PV-ABEND-CODE                PIC S9(04) COMP SYNC        00900000
009100                                                 VALUE ZERO.      00910000
009200 01  PV-ABEND-FIELDS.                                             00920000
009300     05  PV-ABEND-PROGRAM             PIC X(8)   VALUE 'SUKUP004'.00930000
009400     05  PV-ABEND-PARAGRAPH           PIC X(50)  VALUE SPACES.    00940000
009500     05  PV-ABEND-OPERATION           PIC X(50)  VALUE SPACES.    00950000
009600     05  PV-ABEND-STRUCTURE-1         PIC X(8)   VALUE SPACES.    00960000
009700     05  PV-ABEND-STRUCTURE-2         PIC X(8)   VALUE SPACES.    00970000
009800     05  PV-ABEND-STRUCTURE-3         PIC X(8)   VALUE SPACES.    00980000
009900     05  PV-ABEND-STATUS              PIC XX     VALUE SPACES.    00990000
010000     05  PV-DB2-OPERATION-MESSAGE-1   PIC  X(79) VALUE SPACES.    01000000
010100     05  PV-DB2-OPERATION-MESSAGE-2   PIC  X(79) VALUE SPACES.    01010000
010200     05  PV-DB2-OPERATION-MESSAGE-3   PIC  X(79) VALUE SPACES.    01020000
010300     05  PV-DB2-OPERATION-MESSAGE-4   PIC  X(79) VALUE SPACES.    01030000
010400     05  PV-SQLCODE                   PIC 9(9)  VALUE ZERO.       01040000
010500/                                                                 01050000
010600     COPY SURD011.                                                01060000
010700/                                                                 01070000
010800*  USED FOR DB2 ERROR MESSAGE BUILDING                            01080000
010900     COPY DPWS004.                                                01090026
011000                                                                  01100000
011100*   DB2 SQL COMMUNICATION AREA                                    01110000
011200     EXEC SQL                                                     01120000
011300          INCLUDE SQLCA                                           01130000
011400     END-EXEC.                                                    01140000
011500     COPY SQLCA2.                                                 01150000
011600/                                                                 01160000
011700     EXEC SQL                                                     01170000
011800          INCLUDE SUT00024                                        01180000
011900     END-EXEC.                                                    01190000
012000                                                                  01200000
012100     EXEC SQL                                                     01210000
012200          INCLUDE SUT00028                                        01220000
012300     END-EXEC.                                                    01230000
012400                                                                  01240000
012500     EXEC SQL                                                     01250000
012600          INCLUDE TCEPLIT                                         01260000
012700     END-EXEC.                                                    01270000
012800                                                                  01280000
013200                                                                  01320000
013700*  CHECKPOINT CONTROL TABLE                                       01370000
013800     EXEC SQL                                                     01380000
013900          INCLUDE TCKRSTCN                                        01390000
014000     END-EXEC.                                                    01400000
014001*                                                                 01400123
014002******************************************************************01400224
014003*   REMOVED REFERENCES TO                             WR # 21361 *01400325
014004*   ADDED INCLUDE STATEMENTS TO XLV_UPC AND XLV_SKU              *01400424
014005******************************************************************01400524
014006*                                                                 01400624
014010*  XLV_SKU VIEW                                                   01401000
014020     EXEC SQL                                                     01402000
014030          INCLUDE XLV00000                                        01403000
014040     END-EXEC.                                                    01404000
014050*  XLV_UPC VIEW                                                   01405000
014060     EXEC SQL                                                     01406000
014070          INCLUDE XLV00003                                        01407000
014080     END-EXEC.                                                    01408000
014090******************************************************************01409023
014091*  CHANGES MADE FOR WR # 21361 ENDS HERE                         *01409123
014092******************************************************************01409223
014100/                                                                 01410000
014200 PROCEDURE DIVISION.                                              01420000
014300     PERFORM 1000-INITIALIZE.                                     01430000
014400     PERFORM 2000-PROCESS UNTIL PS-EOF-MANIFEST.                  01440000
014500     PERFORM 9000-EOJ.                                            01450000
014600     GOBACK.                                                      01460000
014700                                                                  01470000
014800 1000-INITIALIZE.                                                 01480000
014900                                                                  01490000
015000     OPEN INPUT SU-MANIFEST-BOL-FILE                              01500000
015100     PERFORM 8000-READ-MANIFEST-FILE.                             01510000
015200     IF PS-EOF-MANIFEST                                           01520000
015300         DISPLAY ALL '*'                                          01530000
015400         DISPLAY '**  INP01 MANIFEST FILE IS EMPTY **'            01540000
015500         DISPLAY ALL '*'                                          01550000
015600     ELSE                                                         01560000
015700         PERFORM 7300-SET-CHECKPOINT-TIME                         01570000
015800         SET PS-AINT-TIME-YET-TO-COMMIT                           01580000
015900                                      TO TRUE                     01590000
016000     END-IF.                                                      01600000
016100                                                                  01610000
016200 2000-PROCESS.                                                    01620000
016300                                                                  01630000
016400     MOVE SU011-CONTAINER-ID          TO PV-CONTAINER-ID.         01640000
016500     MOVE PV-CONTAINER-ID             TO DK-BRCDE-NBR.            01650000
016600     MOVE PV-SHIPT-UNT-ID             TO SUT00024-SHIPT-UNT-ID    01660000
016800                                         DK-SHIPT-UNT-ID          01680000
016900                                                                  01690000
017000     PERFORM 7000-SELECT-OTBND-CART.                              01700000
017300     IF PS-OTBND-CART-FOUND-YES                                   01730000
017400         PERFORM 7210-FIND-UPC-NBR                                01740000
017500         IF SQLCODE = 0 OR SQLCODE = -811                         01750000
017600         PERFORM 7250-INSERT-OTBND-UPC                            01760000
017700         END-IF                                                   01770000
018500     ELSE                                                         01850000
018510         PERFORM 7005-SELECT-OTBND-CART                           01851000
018600         IF  PS-ORIG-FOUND-YES                                    01860000
018700             PERFORM 7200-INSERT-OTBND-CART                       01870000
018800             PERFORM 7210-FIND-UPC-NBR                            01880000
018900             IF SQLCODE = 0 OR SQLCODE = -811                     01890000
019000             PERFORM 7250-INSERT-OTBND-UPC                        01900000
019100             END-IF                                               01910000
019200         ELSE                                                     01920000
019300             PERFORM 2200-CREATE-CONTAINER-ENTRIES                01930000
019400         END-IF                                                   01940000
019410     END-IF.                                                      01941000
019500                                                                  01950000
019600     PERFORM 3000-DECIDE-TO-COMMIT.                               01960000
019700     IF PS-COMMIT-NOW                                             01970000
019800         PERFORM 7350-COMMIT                                      01980000
019900         PERFORM 7300-SET-CHECKPOINT-TIME                         01990000
020000         SET PS-AINT-TIME-YET-TO-COMMIT                           02000000
020100                                      TO TRUE                     02010000
020200     END-IF                                                       02020000
020300                                                                  02030000
020400     PERFORM 8000-READ-MANIFEST-FILE.                             02040000
020500                                                                  02050000
020600 2200-CREATE-CONTAINER-ENTRIES.                                   02060000
020700     PERFORM 7200-INSERT-OTBND-CART                               02070000
020900     PERFORM 7210-FIND-UPC-NBR                                    02090000
021000         IF SQLCODE = 0 OR SQLCODE = -811                         02100000
021100     PERFORM 7250-INSERT-OTBND-UPC                                02110000
021200         END-IF.                                                  02120000
021300/                                                                 02130000
021400 3000-DECIDE-TO-COMMIT.                                           02140000
021500     EXEC SQL                                                     02150000
021600       SET :PV-TMST = CURRENT TIMESTAMP                           02160000
021700     END-EXEC.                                                    02170000
021800                                                                  02180000
021900     EVALUATE TRUE                                                02190000
022000         WHEN SQLCODE = ZERO                                      02200000
022100             IF PV-TMST > PV-HOLD-TMST                            02210000
022200                 SET PS-COMMIT-NOW    TO TRUE                     02220000
022300             END-IF                                               02230000
022400         WHEN SQLWARN0 NOT EQUAL SPACE                            02240000
022500         WHEN SQLCODE NOT EQUAL ZERO                              02250000
022600             MOVE '3000-DECIDE-TO-COMMIT'                         02260000
022700                                      TO PV-ABEND-PARAGRAPH       02270000
022800             MOVE 'SELECT'            TO PV-ABEND-OPERATION       02280000
022900             MOVE 'TCKRSTCNTL'        TO PV-ABEND-STRUCTURE-1     02290000
023000             PERFORM 9900-SQL-ERROR                               02300000
023100     END-EVALUATE.                                                02310000
023200/                                                                 02320000
023300 7000-SELECT-OTBND-CART.                                          02330000
023400                                                                  02340000
023500     EXEC SQL                                                     02350000
023600         SELECT                                                   02360000
023700             SHIPT_UNT_ID                                         02370000
023800           INTO                                                   02380000
023900             :SUT00024-SHIPT-UNT-ID                               02390000
024000           FROM SUT_OTBND_CART                                    02400000
024100         WHERE                                                    02410000
024200             SHIPT_UNT_ID = :DK-SHIPT-UNT-ID                      02420000
024300     END-EXEC.                                                    02430000
024400                                                                  02440000
024500     EVALUATE TRUE                                                02450000
024600         WHEN SQLCODE = ZERO                                      02460000
024700              SET PS-OTBND-CART-FOUND-YES TO TRUE                 02470000
024800         WHEN SQLCODE = +100                                      02480000
024900              SET PS-OTBND-CART-FOUND-NO TO TRUE                  02490000
025000         WHEN SQLWARN0 NOT = SPACE                                02500000
025100         WHEN SQLCODE  NOT = ZERO                                 02510000
025200              MOVE '7000-SELECT-OTBND-CART'                       02520000
025300                                   TO PV-ABEND-PARAGRAPH          02530000
025400              MOVE 'SELECT'        TO PV-ABEND-OPERATION          02540000
025500              MOVE 'SUT00024'      TO PV-ABEND-STRUCTURE-1        02550000
025600              PERFORM 9900-SQL-ERROR                              02560000
025700     END-EVALUATE.                                                02570000
025800/                                                                 02580000
025900 7005-SELECT-OTBND-CART.                                          02590000
026000                                                                  02600000
026010     EXEC SQL                                                     02601000
026020         SELECT                                                   02602000
026030             SHIPT_UNT_ID                                         02603000
026040           INTO                                                   02604000
026050             :SUT00024-SHIPT-UNT-ID                               02605000
026060           FROM SUT_OTBND_CART                                    02606000
026070         WHERE                                                    02607000
026080             ORIG_CART_ID = :DK-SHIPT-UNT-ID                      02608000
026090     END-EXEC.                                                    02609000
027000                                                                  02700000
027100     EVALUATE TRUE                                                02710000
027200         WHEN SQLCODE = ZERO                                      02720000
027300              SET PS-ORIG-FOUND-YES TO TRUE                       02730000
027400         WHEN SQLCODE = -811                                      02740000
027500              SET PS-ORIG-FOUND-YES TO TRUE                       02750000
027600         WHEN SQLCODE = +100                                      02760000
027700              SET PS-ORIG-FOUND-NO    TO TRUE                     02770000
027800         WHEN SQLWARN0 NOT = SPACE                                02780000
027900         WHEN SQLCODE  NOT = ZERO                                 02790000
028000              MOVE '7005-SELECT-TSULBXF'                          02800000
028100                                   TO PV-ABEND-PARAGRAPH          02810000
028200              MOVE 'SELECT'        TO PV-ABEND-OPERATION          02820000
028300              MOVE 'TSULBXF'       TO PV-ABEND-STRUCTURE-1        02830000
028400              PERFORM 9900-SQL-ERROR                              02840000
028500     END-EVALUATE.                                                02850000
028600/                                                                 02860000
028700 7200-INSERT-OTBND-CART.                                          02870000
028800                                                                  02880000
028900     MOVE '7200-INSERT-OTBND-CART' TO PV-ABEND-PARAGRAPH.         02890000
029000                                                                  02900000
029100     MOVE SU011-OPER-UNT-ID           TO SUT00024-ORGN-LOC-NBR    02910000
029200     MOVE SU011-DEST-OPER-UNT-ID      TO SUT00024-DEST-LOC-NBR    02920000
029300     MOVE 'RDM'                       TO SUT00024-CART-SRC-CDE    02930000
029400     MOVE 'N'                         TO SUT00024-MSTR-CART-IND   02940000
029500     MOVE ZERO                        TO SUT00024-ORIG-CART-ID    02950000
029600     MOVE 'Y'                         TO SUT00024-ACTV-IND        02960000
029700     MOVE SPACES                      TO SUT00024-CRE-USR-ID      02970000
029800     MOVE 'SUKUP004'                  TO SUT00024-CRE-PGM-NM      02980000
029900     MOVE ZERO                        TO SUT00024-CART-RVSN-NBR   02990000
030000                                                                  03000000
030100                                                                  03010000
030200                                                                  03020000
030300     PERFORM                                                      03030000
030400         WITH TEST AFTER                                          03040000
030500         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     03050000
030600         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES) OR            03060000
030700                (SQLCODE = ZERO) OR (SQLCODE = -803))             03070000
030800                                                                  03080000
030900     EXEC SQL                                                     03090000
031000         INSERT INTO SUT_OTBND_CART                               03100000
031100             (SHIPT_UNT_ID                                        03110000
031200         ,    ORGN_LOC_NBR                                        03120000
031400         ,    DEST_LOC_NBR                                        03140000
031600         ,    CART_SRC_CDE                                        03160000
031700         ,    MSTR_CART_IND                                       03170000
031800         ,    PRNT_CART_ID                                        03180000
031900         ,    ORIG_CART_ID                                        03190000
032000         ,    ACTV_IND                                            03200000
032100         ,    CRE_DTE                                             03210000
032200         ,    CRE_TM                                              03220000
032300         ,    CRE_USR_ID                                          03230000
032400         ,    CRE_PGM_NM                                          03240000
032500         ,    CART_RVSN_NBR                                       03250000
032510         ,    CART_TYP_CDE                                        03251000
032600         )                                                        03260000
032700             VALUES                                               03270000
032800            (:DK-SHIPT-UNT-ID                                     03280000
032900         ,   :SUT00024-ORGN-LOC-NBR                               03290000
033100         ,   :SUT00024-DEST-LOC-NBR                               03310000
033300         ,   :SUT00024-CART-SRC-CDE                               03330000
033400         ,   :SUT00024-MSTR-CART-IND                              03340000
033500         ,   :DK-SHIPT-UNT-ID                                     03350000
033600         ,   :SUT00024-ORIG-CART-ID                               03360000
033700         ,   'Y'                                                  03370000
033800         ,   :SU011-ETA-DATE                                      03380000
033900         ,   :SU011-ETA-TIME                                      03390000
034000         ,   :SUT00024-CRE-USR-ID                                 03400000
034100         ,   'SUKUP004'                                           03410000
034200         ,   :SUT00024-CART-RVSN-NBR                              03420000
034210         ,    'S'                                                 03421000
034300         )                                                        03430000
034400         END-EXEC                                                 03440000
034500                                                                  03450000
034600         EVALUATE TRUE                                            03460000
034700             WHEN SQLCODE = ZERO                                  03470000
034710                 DISPLAY ' SHIPT UNT ID = ' PV-SHIPT-UNT-ID       03471024
034800                 ADD 1              TO PV-OTBND-CART-INSERT-COUNT 03480000
034900             WHEN SQLCODE = -803                                  03490000
035000                 ADD 1                TO PV-OTBND-CART-DUP-COUNT  03500000
035500                                                                  03550000
035600             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')              03560000
035700                 DISPLAY '**************************************' 03570000
035800                 DISPLAY 'WARNING ISSD ON INST OF SUT_OTBND_CART' 03580000
035900                 DISPLAY 'SUT00024-SHIPT-UNT-ID =  '              03590000
036000                          DK-SHIPT-UNT-ID                         03600000
036100                 DISPLAY '**********************************'     03610000
036200                 PERFORM 9800-SQL-WARNING                         03620000
036300                                                                  03630000
036400             WHEN SQLCODE < ZERO                                  03640000
036500                 DISPLAY '**************************************' 03650000
036600                 DISPLAY 'ERROR ISSD ON INST OF SUT_OTBND_CART   '03660000
036700                 DISPLAY 'SUT00024-SHIPT-UNT-ID =  '              03670000
036800                          DK-SHIPT-UNT-ID                         03680000
036900                 DISPLAY '**************************************' 03690000
037000                 PERFORM 9900-SQL-ERROR                           03700000
037100                                                                  03710000
037200         END-EVALUATE                                             03720000
037300     END-PERFORM                                                  03730000
037400                                                                  03740000
037500     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    03750000
037600         SQLCODE NOT = ZERO                                       03760000
037700         DISPLAY '**************************************'         03770000
037800         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '         03780000
037900         DISPLAY 'INSERT TO SUT_OTBND_CART                     '  03790000
038000         DISPLAY 'SUT00024-SHIPT-UNT-ID =  '                      03800000
038100                  SUT00024-SHIPT-UNT-ID                           03810000
038200         DISPLAY '**************************************'         03820000
038300         PERFORM 9900-SQL-ERROR                                   03830000
038400     END-IF.                                                      03840000
038500                                                                  03850000
046300                                                                  04630000
046400/                                                                 04640000
046401******************************************************************04640123
046410* MODIFIED THE SELECT STATEMENT TO USE XLV_SKU        WR # 21361 *04641023
046420* AND XLV_UPC VIEWS BY REPLACING                                  04642025
046421******************************************************************04642123
046430*                                                                 04643000
046500 7210-FIND-UPC-NBR.                                               04650000
046600     MOVE '7210-FIND-UPC-NBR'         TO PV-ABEND-PARAGRAPH.      04660000
046700                                                                  04670000
046800     MOVE SU011-DISTRIBUTION-NBR      TO PV-DISTRIBUTION-NBR      04680000
046900     MOVE PV-TRN-NBR                  TO SUT00028-TRN-NBR         04690000
047000     MOVE PV-TRN-LNE-NBR              TO SUT00028-TRN-LNE-NBR     04700000
047100     MOVE SU011-UNIT-QTY              TO SUT00028-SHPD-UNT-QTY    04710000
047200                                                                  04720000
047230                                                                  04723000
047300     PERFORM                                                      04730000
047400         WITH TEST AFTER                                          04740000
047500         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     04750000
047600         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES) OR            04760000
047700                (SQLCODE = 100) OR                                04770000
047800                (SQLCODE = ZERO) OR (SQLCODE = -811))             04780000
047900                                                                  04790000
049101*                                                                 04910100
049102         EXEC SQL                                                 04910200
049103         SELECT                                                   04910300
049104             UPC.UPC_NBR                                          04910400
049105         INTO                                                     04910500
049106             :XLV00003-UPC-NBR                                    04910600
049107         FROM TCEPLIT ITM                                         04910700
049108         ,    XLV_SKU SKU                                         04910800
049109         ,    XLV_UPC UPC                                         04910900
049110             WHERE ITM.CNSTK_REQ_PL_NBR = :SUT00028-TRN-NBR       04911000
049111               AND ITM.PL_LNE_NBR       = :SUT00028-TRN-LNE-NBR   04911100
049112               AND ITM.ITM_NBR          = SKU.ITM_NBR             04911200
049113               AND SKU.INTR_UPC_ID      = UPC.INTR_UPC_ID         04911300
049114               AND UPC.EDI_ORD_IND      = 'Y'                     04911400
049115         END-EXEC                                                 04911500
049250                                                                  04925000
049300         EVALUATE TRUE                                            04930000
049400             WHEN SQLCODE = ZERO                                  04940000
049500             WHEN SQLCODE = -811                                  04950000
049600                 CONTINUE                                         04960000
050100             WHEN SQLCODE = +100                                  05010000
050101                 DISPLAY ' +100  7210-FIND-UPC-NBR'               05010124
050102                 DISPLAY ' TRAN NUMBER = ' PV-TRN-NBR             05010224
050103                 DISPLAY ' LINE NUMBER = ' PV-TRN-LNE-NBR         05010324
050104                 PERFORM 7220-FIND-UPC-NBR                        05010427
050300                                                                  05030000
050400             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')              05040000
050500                 DISPLAY '**************************************' 05050000
050600                 DISPLAY 'WARNING ISSUED ON SELECT              ' 05060025
050700                 DISPLAY 'TRN-NBR =  '     PV-TRN-NBR             05070000
050800                 DISPLAY 'LNE-NBR =  '     PV-TRN-LNE-NBR         05080000
050900                 DISPLAY '**********************************'     05090000
051000                 PERFORM 9800-SQL-WARNING                         05100000
051100                                                                  05110000
051200             WHEN SQLCODE < ZERO                                  05120000
051300                 DISPLAY '**************************************' 05130000
051400                 DISPLAY 'ERROR ISSUED ON SELECT OF XLV_UPC/SKU'  05140023
051500                 DISPLAY 'TRN-NBR =  '     PV-TRN-NBR             05150000
051600                 DISPLAY 'LNE-NBR =  '     PV-TRN-LNE-NBR         05160000
051700                 DISPLAY '**************************************' 05170000
051800                 PERFORM 9900-SQL-ERROR                           05180000
051900                                                                  05190000
052000         END-EVALUATE                                             05200000
052100     END-PERFORM                                                  05210000
052200                                                                  05220000
052300     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    05230000
052400         SQLCODE NOT = ZERO                                       05240000
052500         DISPLAY '**************************************'         05250000
052600         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO '            05260000
052700                 'SELECT XLV_UPC/XLV_SKU/TCEPLIT'                 05270023
052800                 DISPLAY 'TRN-NBR =  '     PV-TRN-NBR             05280000
052900                 DISPLAY 'LNE-NBR =  '     PV-TRN-LNE-NBR         05290000
053000         DISPLAY '**************************************'         05300000
053100         PERFORM 9900-SQL-ERROR                                   05310000
053200     END-IF.                                                      05320000
053210******************************************************************05321023
053220*  CHANGES MADE FOR WR # 21361 ENDS HERE                         *05322023
053230******************************************************************05323023
053240*                                                                 05324028
053250 7220-FIND-UPC-NBR.                                               05325026
053260     MOVE '7220-FIND-UPC-NBR'         TO PV-ABEND-PARAGRAPH.      05326026
053270                                                                  05327026
053280     MOVE SU011-DISTRIBUTION-NBR      TO PV-DISTRIBUTION-NBR      05328026
053290     MOVE PV-TRN-NBR                  TO SUT00028-TRN-NBR         05329026
053291     MOVE PV-TRN-LNE-NBR              TO SUT00028-TRN-LNE-NBR     05329126
053292     MOVE SU011-UNIT-QTY              TO SUT00028-SHPD-UNT-QTY    05329226
053294                                                                  05329426
053295     PERFORM                                                      05329526
053296         WITH TEST AFTER                                          05329626
053297         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     05329726
053298         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES) OR            05329826
053299                (SQLCODE = 100) OR                                05329926
053300                (SQLCODE = ZERO) OR (SQLCODE = -811))             05330026
053310                                                                  05331026
053320*                                                                 05332026
053330         EXEC SQL                                                 05333026
053340         SELECT                                                   05334026
053350             UPC.UPC_NBR                                          05335026
053360         INTO                                                     05336026
053370             :XLV00003-UPC-NBR                                    05337026
053380         FROM TCEPLIT ITM                                         05338026
053390         ,    XLV_SKU SKU                                         05339026
053391         ,    XLV_UPC UPC                                         05339126
053392             WHERE ITM.CNSTK_REQ_PL_NBR = :SUT00028-TRN-NBR       05339226
053393               AND ITM.PL_LNE_NBR       = :SUT00028-TRN-LNE-NBR   05339326
053394               AND ITM.ITM_NBR          = SKU.ITM_NBR             05339426
053395               AND SKU.INTR_UPC_ID      = UPC.INTR_UPC_ID         05339526
053396               AND UPC.UPC_TYP_CDE      = 'V'                     05339626
053397         END-EXEC                                                 05339726
053398                                                                  05339826
053399         EVALUATE TRUE                                            05339926
053400             WHEN SQLCODE = ZERO                                  05340026
053401             WHEN SQLCODE = -811                                  05340126
053402                 CONTINUE                                         05340226
053403             WHEN SQLCODE = +100                                  05340326
053404                 DISPLAY ' +100  7220-FIND-UPC-NBR'               05340426
053405                 DISPLAY ' TRAN NUMBER = ' PV-TRN-NBR             05340526
053406                 DISPLAY ' LINE NUMBER = ' PV-TRN-LNE-NBR         05340626
053407                 PERFORM 7230-FIND-UPC-NBR                        05340726
053409                                                                  05340926
053410             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')              05341026
053411                 DISPLAY '**************************************' 05341126
053412                 DISPLAY 'WARNING ISSUED ON SELECT              ' 05341226
053413                 DISPLAY 'TRN-NBR =  '     PV-TRN-NBR             05341326
053414                 DISPLAY 'LNE-NBR =  '     PV-TRN-LNE-NBR         05341426
053415                 DISPLAY '**********************************'     05341526
053416                 PERFORM 9800-SQL-WARNING                         05341626
053417                                                                  05341726
053418             WHEN SQLCODE < ZERO                                  05341826
053419                 DISPLAY '**************************************' 05341926
053420                 DISPLAY 'ERROR ISSUED ON SELECT OF XLV_UPC/SKU'  05342026
053421                 DISPLAY 'TRN-NBR =  '     PV-TRN-NBR             05342126
053422                 DISPLAY 'LNE-NBR =  '     PV-TRN-LNE-NBR         05342226
053423                 DISPLAY '**************************************' 05342326
053424                 PERFORM 9900-SQL-ERROR                           05342426
053425                                                                  05342526
053426         END-EVALUATE                                             05342626
053427     END-PERFORM                                                  05342726
053428                                                                  05342826
053429     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    05342926
053430         SQLCODE NOT = ZERO                                       05343026
053431         DISPLAY '**************************************'         05343126
053432         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO '            05343226
053433                 'SELECT XLV_UPC/XLV_SKU/TCEPLIT'                 05343326
053434                 DISPLAY 'TRN-NBR =  '     PV-TRN-NBR             05343426
053435                 DISPLAY 'LNE-NBR =  '     PV-TRN-LNE-NBR         05343526
053436         DISPLAY '**************************************'         05343626
053437         PERFORM 9900-SQL-ERROR                                   05343726
053438     END-IF.                                                      05343826
053439*                                                                 05343926
053440 7230-FIND-UPC-NBR.                                               05344026
053441     MOVE '7230-FIND-UPC-NBR'         TO PV-ABEND-PARAGRAPH.      05344126
053442                                                                  05344226
053443     MOVE SU011-DISTRIBUTION-NBR      TO PV-DISTRIBUTION-NBR      05344326
053444     MOVE PV-TRN-NBR                  TO SUT00028-TRN-NBR         05344426
053445     MOVE PV-TRN-LNE-NBR              TO SUT00028-TRN-LNE-NBR     05344526
053446     MOVE SU011-UNIT-QTY              TO SUT00028-SHPD-UNT-QTY    05344626
053447                                                                  05344726
053448     PERFORM                                                      05344826
053449         WITH TEST AFTER                                          05344926
053450         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     05345026
053451         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES) OR            05345126
053452                (SQLCODE = 100) OR                                05345226
053453                (SQLCODE = ZERO) OR (SQLCODE = -811))             05345326
053455*                                                                 05345526
053456         EXEC SQL                                                 05345626
053457         SELECT                                                   05345726
053458             UPC.UPC_NBR                                          05345826
053459         INTO                                                     05345926
053460             :XLV00003-UPC-NBR                                    05346026
053461         FROM TCEPLIT ITM                                         05346126
053462         ,    XLV_SKU SKU                                         05346226
053463         ,    XLV_UPC UPC                                         05346326
053464             WHERE ITM.CNSTK_REQ_PL_NBR = :SUT00028-TRN-NBR       05346426
053465               AND ITM.PL_LNE_NBR       = :SUT00028-TRN-LNE-NBR   05346526
053466               AND ITM.ITM_NBR          = SKU.ITM_NBR             05346626
053467               AND SKU.INTR_UPC_ID      = UPC.INTR_UPC_ID         05346726
053469         END-EXEC                                                 05346926
053470                                                                  05347026
053471         EVALUATE TRUE                                            05347126
053472             WHEN SQLCODE = ZERO                                  05347226
053473             WHEN SQLCODE = -811                                  05347326
053474                 CONTINUE                                         05347426
053475             WHEN SQLCODE = +100                                  05347526
053476                 DISPLAY ' +100  7230-FIND-UPC-NBR'               05347626
053477                 DISPLAY ' TRAN NUMBER = ' PV-TRN-NBR             05347726
053478                 DISPLAY ' LINE NUMBER = ' PV-TRN-LNE-NBR         05347826
053481                                                                  05348126
053482             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')              05348226
053483                 DISPLAY '**************************************' 05348326
053484                 DISPLAY 'WARNING ISSUED ON SELECT              ' 05348426
053485                 DISPLAY 'TRN-NBR =  '     PV-TRN-NBR             05348526
053486                 DISPLAY 'LNE-NBR =  '     PV-TRN-LNE-NBR         05348626
053487                 DISPLAY '**********************************'     05348726
053488                 PERFORM 9800-SQL-WARNING                         05348826
053489                                                                  05348926
053490             WHEN SQLCODE < ZERO                                  05349026
053491                 DISPLAY '**************************************' 05349126
053492                 DISPLAY 'ERROR ISSUED ON SELECT OF XLV_UPC/SKU'  05349226
053493                 DISPLAY 'TRN-NBR =  '     PV-TRN-NBR             05349326
053494                 DISPLAY 'LNE-NBR =  '     PV-TRN-LNE-NBR         05349426
053495                 DISPLAY '**************************************' 05349526
053496                 PERFORM 9900-SQL-ERROR                           05349626
053497                                                                  05349726
053498         END-EVALUATE                                             05349826
053499     END-PERFORM                                                  05349926
053500                                                                  05350026
053501     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    05350126
053502         SQLCODE NOT = ZERO                                       05350226
053503         DISPLAY '**************************************'         05350326
053504         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO '            05350426
053505                 'SELECT XLV_UPC/XLV_SKU/TCEPLIT'                 05350526
053506                 DISPLAY 'TRN-NBR =  '     PV-TRN-NBR             05350626
053507                 DISPLAY 'LNE-NBR =  '     PV-TRN-LNE-NBR         05350726
053508         DISPLAY '**************************************'         05350826
053509         PERFORM 9900-SQL-ERROR                                   05350926
053510     END-IF.                                                      05351026
053511/                                                                 05351100
053512******************************************************************05351223
053513* INSERTED UPC NUMBER FROM XLV_UPC VIEW.              WR # 21361 *05351323
053514******************************************************************05351423
053515 7250-INSERT-OTBND-UPC.                                           05351500
053520                                                                  05352000
053600     MOVE '7250-INSERT-OTBND-UPC'     TO PV-ABEND-PARAGRAPH.      05360000
053700                                                                  05370000
053800     MOVE SU011-DISTRIBUTION-NBR      TO PV-DISTRIBUTION-NBR      05380000
053900     MOVE PV-TRN-NBR                  TO SUT00028-TRN-NBR         05390000
054000     MOVE PV-TRN-LNE-NBR              TO SUT00028-TRN-LNE-NBR     05400000
054100     MOVE SU011-UNIT-QTY              TO SUT00028-SHPD-UNT-QTY    05410000
054200                                                                  05420000
054300     PERFORM                                                      05430000
054400         WITH TEST AFTER                                          05440000
054500         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     05450000
054600         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES) OR            05460000
054700                (SQLCODE = ZERO) OR (SQLCODE = -803))             05470000
054800                                                                  05480000
054900     EXEC SQL                                                     05490000
055000         INSERT INTO SUT_OTBND_UPC                                05500000
055100             (                                                    05510000
055200                 SHIPT_UNT_ID                                     05520000
055300             ,   TRN_NBR                                          05530000
055400             ,   TRN_LNE_NBR                                      05540000
055500             ,   TRN_TYP_CDE                                      05550000
055600             ,   UPC_NBR                                          05560000
055700             ,   SHPD_UNT_QTY                                     05570000
055800             ,   RCVR_SEQ_NBR                                     05580000
055900             )                                                    05590000
056000             VALUES                                               05600000
056100             (                                                    05610000
056200                 :DK-SHIPT-UNT-ID                                 05620000
056300             ,   :SUT00028-TRN-NBR                                05630000
056400             ,   :SUT00028-TRN-LNE-NBR                            05640000
056500             ,   'CS'                                             05650000
056600             ,   :XLV00003-UPC-NBR                                05660000
056700             ,   :SUT00028-SHPD-UNT-QTY                           05670000
056800             ,   0                                                05680000
056900             )                                                    05690000
057000         END-EXEC                                                 05700000
057100                                                                  05710000
057200         EVALUATE TRUE                                            05720000
057300             WHEN SQLCODE = ZERO                                  05730000
057400                 ADD 1                TO PV-OTBND-UPC-INSERT-COUNT05740000
057500             WHEN SQLCODE = -803                                  05750000
057600                 ADD 1                TO PV-OTBND-UPC-DUP-COUNT   05760000
058100                                                                  05810000
058200             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')              05820000
058300                 DISPLAY '**************************************' 05830000
058400                 DISPLAY 'WARNING ISSUED ON INSERT OF TSHPUPC   ' 05840000
058500                 DISPLAY 'SUT00028-SHIPT-UNT-ID =  '              05850000
058600                          DK-SHIPT-UNT-ID                         05860000
058700                 DISPLAY '**********************************'     05870000
058800                 PERFORM 9800-SQL-WARNING                         05880000
058900                                                                  05890000
059000             WHEN SQLCODE < ZERO                                  05900000
059100                 DISPLAY '**************************************' 05910000
059200                 DISPLAY 'ERROR ISS ON INSERT OF SUT_OTBND_UPC'   05920000
059300                 DISPLAY 'SUT00028-SHIPT-UNT-ID =  '              05930000
059400                          DK-SHIPT-UNT-ID                         05940000
059500                 DISPLAY '**************************************' 05950000
059600                 PERFORM 9900-SQL-ERROR                           05960000
059700                                                                  05970000
059800         END-EVALUATE                                             05980000
059900     END-PERFORM                                                  05990000
060000                                                                  06000000
060100     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    06010000
060200         SQLCODE NOT = ZERO                                       06020000
060300         DISPLAY '**************************************'         06030000
060400         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '         06040000
060500         DISPLAY 'INSERT TO SUT_OTBND_UPC               '         06050000
060600         DISPLAY 'SUT00028-SHIPT-UNT-ID =  '                      06060000
060700                  SUT00024-SHIPT-UNT-ID                           06070000
060800         DISPLAY '**************************************'         06080000
060900         PERFORM 9900-SQL-ERROR                                   06090000
061000     END-IF.                                                      06100000
061010******************************************************************06101023
061020*  CHANGES MADE FOR WR # 21361 ENDS HERE                         *06102023
061030******************************************************************06103023
061100/                                                                 06110000
061200 7300-SET-CHECKPOINT-TIME.                                        06120000
061300                                                                  06130000
061400      EXEC SQL                                                    06140000
061500          SELECT (CURRENT TIMESTAMP + CKPT_FRQNCY_QTY SECONDS)    06150000
061600          INTO :PV-HOLD-TMST                                      06160000
061700          FROM TCKRSTCNTL                                         06170000
061800          WHERE PLAN_NAME = :PC-PROGRAM-NAME                      06180000
061900      END-EXEC.                                                   06190000
062000                                                                  06200000
062100     EVALUATE TRUE                                                06210000
062200         WHEN SQLWARN0 NOT EQUAL SPACE                            06220000
062300         WHEN SQLCODE NOT EQUAL ZERO                              06230000
062400             MOVE '7300-SET-CHECKPOINT-TIME'                      06240000
062500                                      TO PV-ABEND-PARAGRAPH       06250000
062600             MOVE 'SELECT'            TO PV-ABEND-OPERATION       06260000
062700             MOVE 'TCKRSTCNTL'        TO PV-ABEND-STRUCTURE-1     06270000
062800             PERFORM 9900-SQL-ERROR                               06280000
062900     END-EVALUATE.                                                06290000
063000                                                                  06300000
063100 7350-COMMIT.                                                     06310000
063200                                                                  06320000
063300     EXEC SQL                                                     06330000
063400         COMMIT                                                   06340000
063500     END-EXEC.                                                    06350000
063600                                                                  06360000
063700     EVALUATE TRUE                                                06370000
063800         WHEN SQLCODE = ZERO                                      06380000
063900             DISPLAY  PV-TMST (6:2) '/' PV-TMST (9:2)             06390000
064000                     '/' PV-TMST (3:2)17710099                    06400000
064100                     '  ' PV-TMST (12:2) ':'                      06410000
064200                     PV-TMST (15:2) ':' PV-TMST (18:2)            06420000
064300             ADD 1                    TO PV-COMMIT-COUNT          06430000
064400         WHEN SQLWARN0 NOT EQUAL SPACE                            06440000
064500         WHEN SQLCODE NOT EQUAL ZERO                              06450000
064600             MOVE '7350-COMMIT'       TO PV-ABEND-PARAGRAPH       06460000
064700             MOVE 'COMMIT'            TO PV-ABEND-OPERATION       06470000
064800             MOVE 'SUT00024  '        TO PV-ABEND-STRUCTURE-1     06480000
064900             MOVE 'SUT00028  '        TO PV-ABEND-STRUCTURE-2     06490000
065000             PERFORM 9900-SQL-ERROR                               06500000
065100     END-EVALUATE.                                                06510000
065200 8000-READ-MANIFEST-FILE.                                         06520000
065300     READ SU-MANIFEST-BOL-FILE                                    06530000
065400         INTO SU011-BOL-MANIFEST-RECORD                           06540000
065500     AT END                                                       06550000
065600         SET PS-EOF-MANIFEST          TO TRUE                     06560000
065700     NOT AT END                                                   06570000
065800         ADD 1                        TO PV-MANIFEST-COUNT        06580000
065900     END-READ.                                                    06590000
066000/                                                                 06600000
066100 9000-EOJ.                                                        06610000
066200                                                                  06620000
066300     CLOSE SU-MANIFEST-BOL-FILE.                                  06630000
066400     MOVE PV-MANIFEST-COUNT           TO PV-DISP-NBR              06640000
066500     DISPLAY 'BOL EXTRACTS READ             = ' PV-DISP-NBR       06650000
066600                                                                  06660000
066700     MOVE PV-OTBND-CART-INSERT-COUNT  TO PV-DISP-NBR              06670000
066800     DISPLAY 'SHPUNT ROWS INSERTED          = ' PV-DISP-NBR.      06680000
066900     MOVE PV-OTBND-CART-DUP-COUNT     TO PV-DISP-NBR              06690000
067000     DISPLAY 'DUPLICATE SHPUNT ROWS IGNORED = ' PV-DISP-NBR.      06700000
067100                                                                  06710000
067700     MOVE PV-OTBND-UPC-INSERT-COUNT    TO PV-DISP-NBR             06770000
067800     DISPLAY 'SHUUPC ROWS INSERTED          = ' PV-DISP-NBR.      06780000
067900     MOVE PV-OTBND-UPC-DUP-COUNT      TO PV-DISP-NBR              06790000
068000     DISPLAY 'DUPLICATE SHUUPC ROWS IGNORED = ' PV-DISP-NBR.      06800000
068100                                                                  06810000
068200     MOVE PV-COMMIT-COUNT             TO PV-DISP-NBR              06820000
068300     DISPLAY 'COMMITS TAKEN                 = ' PV-DISP-NBR.      06830000
068400                                                                  06840000
068500 9800-SQL-WARNING.                                                06850000
068600                                                                  06860000
068700      MOVE SQLCODE               TO SQLCODE2.                     06870000
068800      MOVE SQLERRD(3)            TO SQLERRD3.                     06880000
068900      DISPLAY '** ABEND **       ** = SQLWARNING'.                06890000
069000      DISPLAY '** PROGRAM        ** = ' PC-PROGRAM-NAME.          06900000
069100      DISPLAY '** PARAGRAPH      ** = ' PV-ABEND-PARAGRAPH.       06910000
069200      DISPLAY '** SQLCODE        ** = ' SQLCODE2.                 06920000
069300      DISPLAY '** ROWS PROCESSED ** = ' SQLERRD3.                 06930000
069400      DISPLAY '** SQLWARN0       ** = ' SQLWARN0.                 06940000
069500      DISPLAY '** SQLWARN1       ** = ' SQLWARN1.                 06950000
069600      DISPLAY '** SQLWARN2       ** = ' SQLWARN2.                 06960000
069700      DISPLAY '** SQLWARN3       ** = ' SQLWARN3.                 06970000
069800      DISPLAY '** SQLWARN4       ** = ' SQLWARN4.                 06980000
069900      DISPLAY '** SQLWARN5       ** = ' SQLWARN5.                 06990000
070000      DISPLAY '** SQLWARN6       ** = ' SQLWARN6.                 07000000
070100      DISPLAY '** SQLWARN7       ** = ' SQLWARN7.                 07010000
070200                                                                  07020000
070300      MOVE 4013                  TO PV-ABEND-CODE                 07030000
070400      CALL 'ILBOABN0' USING PV-ABEND-CODE.                        07040000
070500                                                                  07050000
070600 9900-SQL-ERROR.                                                  07060000
070700                                                                  07070000
070800      MOVE SQLCODE               TO SQLCODE2.                     07080000
070900      MOVE SQLERRD(3)            TO SQLERRD3.                     07090000
071000      DISPLAY '** ABEND **       ** = SQLERROR'.                  07100000
071100      DISPLAY '** PROGRAM        ** = ' PC-PROGRAM-NAME.          07110000
071200      DISPLAY '** PARAGRAPH      ** = ' PV-ABEND-PARAGRAPH.       07120000
071300      DISPLAY '** SQLCODE        ** = ' SQLCODE2.                 07130000
071400      DISPLAY '** ROWS PROCESSED ** = ' SQLERRD3.                 07140000
071500      DISPLAY '** SQLERRM        ** = ' SQLERRM.                  07150000
071600      DISPLAY '** SQLERRMC       ** = ' SQLERRMC.                 07160000
071700                                                                  07170000
071800      MOVE 4013                  TO PV-ABEND-CODE                 07180000
071900      CALL 'ILBOABN0' USING PV-ABEND-CODE.                        07190000
