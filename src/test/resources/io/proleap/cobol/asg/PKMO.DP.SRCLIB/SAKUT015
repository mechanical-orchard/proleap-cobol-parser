000100*----------------------------------------------------------       00010099
000200 IDENTIFICATION DIVISION.                                         00020099
000300*----------------------------------------------------------       00030099
000400 PROGRAM-ID.    SAKUT015.                                         00040099
000500 AUTHOR.        SCOTT BARTELT                                     00050099
000600 DATE-WRITTEN.  APRIL, 2000.                                      00060099
000700                                                                  00070099
000800*----------------------------------------------------------       00080099
000900* THIS CREATES THE MISSED MARKUP AND MARKDOWN FILES WHICH         00090099
001000* WILL BE USED FOR LEDGER AND DATA WHAREHOUSE.                    00100099
001300*----------------------------------------------------------       00110099
001400*----------------------------------------------------------       00120099
001410* HISTORY LOG:                                                    00130099
001420*                                                                 00140099
021811* DATE: 02/18/11                                                  00150099
021811* WR/IR#: WR# 39586                                               00160099
021811* PROGRAMMER: CHERI PARMLEY                                       00170099
021811* DESCRIPTION: INCREASE OUPUT FILE SIZE TO 115.                   00180099
003194*----------------------------------------------------------       00190099
021811* DATE: 03/15/11                                                  00191099
021811* WR/IR#: WR# 39586                                               00192099
021811* PROGRAMMER: CHERI PARMLEY                                       00193099
021811* DESCRIPTION: COMPILE ONLY FOR NEW FIELD IN SAWS039              00193199
003194*----------------------------------------------------------       00193299
010008*  CHANGED 04/20/12 BY : ROB SWAGER                              *00194199
010009*  WR/IR#:24719                                                  *00194299
010010*  DESC:RECOMPILE ONLY TO PULL IN CHGD COPYBOOK MLRD017          *00194399
003194*----------------------------------------------------------       00195099
003195 ENVIRONMENT DIVISION.                                            00200099
003196*----------------------------------------------------------       00210099
003197 CONFIGURATION SECTION.                                           00220099
003198 SOURCE-COMPUTER. IBM-3090.                                       00230099
003199 OBJECT-COMPUTER. IBM-3090.                                       00240099
003200                                                                  00250099
003300 INPUT-OUTPUT SECTION.                                            00260099
003400                                                                  00270099
003500 FILE-CONTROL.                                                    00280099
003600                                                                  00290099
003700     SELECT POS-SRTD-EVEN-EXCHG-FILE                              00300099
003800       FILE STATUS IS SC-SRTD-EVEN-EXCHG-FILE-STATUS              00310099
003900       ASSIGN TO INP01.                                           00320099
004000                                                                  00330099
004010     SELECT POS-DATE-FILE                                         00340099
004020       FILE STATUS IS SC-POS-DATE-FILE-STATUS                     00350099
004030       ASSIGN TO INP02.                                           00360099
004040                                                                  00370099
004100     SELECT PS-EVEN-EX-MARKDWN-FILE                               00380099
004200       FILE STATUS IS SC-PS-MKDWN-FILE-STATUS                     00390099
004300       ASSIGN TO OUT01.                                           00400099
004310                                                                  00410099
004400     SELECT PS-EVEN-EX-MARKUP-FILE                                00420099
004500       FILE STATUS IS SC-PS-MKUP-FILE-STATUS                      00430099
004600       ASSIGN TO OUT02.                                           00440099
004610                                                                  00450099
004700     SELECT MW-EVEN-EX-MARKDWN-FILE                               00460099
004800       FILE STATUS IS SC-MW-MKDWN-FILE-STATUS                     00470099
004810       ASSIGN TO OUT03.                                           00480099
004811                                                                  00481099
004820     SELECT MW-EVEN-EX-MARKUP-FILE                                00482099
004830       FILE STATUS IS SC-MW-MKUP-FILE-STATUS                      00483099
004840       ASSIGN TO OUT04.                                           00484099
004850                                                                  00485099
004851     SELECT PS-EVEN-EX-MARKDWN-CUTOFF-FILE                        00485199
004852       FILE STATUS IS SC-PS-MKDWN-CUTOFF-FILE-STATUS              00485299
004853       ASSIGN TO OUT05.                                           00485399
004854                                                                  00485499
004855     SELECT PS-EVEN-EX-MARKUP-CUTOFF-FILE                         00485599
004856       FILE STATUS IS SC-PS-MKUP-CUTOFF-FILE-STATUS               00485699
004857       ASSIGN TO OUT06.                                           00485799
004858                                                                  00485899
004859     SELECT MW-EVEN-EX-MARKDWN-CUTOFF-FILE                        00485999
004860       FILE STATUS IS SC-MW-MKDWN-CUTOFF-FILE-STATUS              00486099
004861       ASSIGN TO OUT07.                                           00486199
004862                                                                  00486299
004863     SELECT MW-EVEN-EX-MARKUP-CUTOFF-FILE                         00486399
004864       FILE STATUS IS SC-MW-MKUP-CUTOFF-FILE-STATUS               00486499
004865       ASSIGN TO OUT08.                                           00486599
004866                                                                  00486699
004867     SELECT MISSED-EVEN-EXCHG-SALES-FILE                          00486799
004870       FILE STATUS IS SC-MISSED-EX-SALES-FILE-STATUS              00486899
004880       ASSIGN TO OUT09.                                           00486999
004890                                                                  00487099
004900     SELECT MISSED-EVEN-EXCHG-RTRNS-FILE                          00488099
004910       FILE STATUS IS SC-MISSED-EX-RTRNS-FILE-STATUS              00489099
004920       ASSIGN TO OUT10.                                           00490099
004930                                                                  00491099
005000*----------------------------------------------------------       00492099
005100 DATA DIVISION.                                                   00493099
005200*----------------------------------------------------------       00494099
005300 FILE SECTION.                                                    00495099
005400                                                                  00496099
005700 FD  POS-SRTD-EVEN-EXCHG-FILE                                     00497099
005800     RECORDING MODE IS F                                          00498099
005900     LABEL RECORDS ARE STANDARD                                   00499099
006000     BLOCK CONTAINS 0 RECORDS.                                    00500099
021811 01  POS-SRTD-EVEN-EXCHG-RECORD             PIC  X(115).          00510099
006800                                                                  00520099
006801 FD  POS-DATE-FILE                                                00530099
006802     RECORDING MODE IS F                                          00540099
006803     LABEL RECORDS ARE STANDARD                                   00550099
006804     RECORD CONTAINS 80 CHARACTERS                                00560099
006805     DATA RECORD IS POS-DATE-RECORD.                              00570099
006806 01  POS-DATE-RECORD                        PIC  X(080).          00580099
006807                                                                  00590099
006808 FD  PS-EVEN-EX-MARKDWN-FILE                                      00600099
006809     RECORDING MODE IS F                                          00610099
006810     BLOCK CONTAINS 0 RECORDS                                     00620099
006811     LABEL RECORDS ARE STANDARD.                                  00630099
006820 01  PS-EVEN-EX-MARKDWN-REC                 PIC  X(200).          00640099
006840                                                                  00650099
006841 FD  PS-EVEN-EX-MARKUP-FILE                                       00660099
006842     RECORDING MODE IS F                                          00670099
006843     BLOCK CONTAINS 0 RECORDS                                     00680099
006844     LABEL RECORDS ARE STANDARD.                                  00681099
006845 01  PS-EVEN-EX-MARKUP-REC                  PIC  X(200).          00682099
006846                                                                  00683099
006847 FD  MW-EVEN-EX-MARKDWN-FILE                                      00684099
006848     RECORDING MODE IS F                                          00684199
006849     BLOCK CONTAINS 0 RECORDS                                     00684299
006850     LABEL RECORDS ARE STANDARD.                                  00684399
006860 01  MW-EVEN-EX-MARKDWN-REC                 PIC  X(200).          00684499
006870                                                                  00684599
006880 FD  MW-EVEN-EX-MARKUP-FILE                                       00684699
006890     RECORDING MODE IS F                                          00684799
006891     BLOCK CONTAINS 0 RECORDS                                     00684899
006892     LABEL RECORDS ARE STANDARD.                                  00684999
006893 01  MW-EVEN-EX-MARKUP-REC                  PIC  X(200).          00685099
006894                                                                  00686099
006895 FD  PS-EVEN-EX-MARKDWN-CUTOFF-FILE                               00687099
006896     RECORDING MODE IS F                                          00688099
006897     BLOCK CONTAINS 0 RECORDS                                     00689099
006898     LABEL RECORDS ARE STANDARD.                                  00689199
006899 01  PS-EVEN-EX-MARKDWN-CUTOFF-REC          PIC  X(200).          00689299
006900                                                                  00689399
006901 FD  PS-EVEN-EX-MARKUP-CUTOFF-FILE                                00689499
006902     RECORDING MODE IS F                                          00689599
006903     BLOCK CONTAINS 0 RECORDS                                     00689699
006904     LABEL RECORDS ARE STANDARD.                                  00689799
006905 01  PS-EVEN-EX-MARKUP-CUTOFF-REC           PIC  X(200).          00689899
006906                                                                  00689999
006907 FD  MW-EVEN-EX-MARKDWN-CUTOFF-FILE                               00690099
006908     RECORDING MODE IS F                                          00690199
006909     BLOCK CONTAINS 0 RECORDS                                     00690299
006910     LABEL RECORDS ARE STANDARD.                                  00690399
006911 01  MW-EVEN-EX-MARKDWN-CUTOFF-REC          PIC  X(200).          00690499
006912                                                                  00690599
006913 FD  MW-EVEN-EX-MARKUP-CUTOFF-FILE                                00690699
006914     RECORDING MODE IS F                                          00690799
006915     BLOCK CONTAINS 0 RECORDS                                     00690899
006916     LABEL RECORDS ARE STANDARD.                                  00690999
006917 01  MW-EVEN-EX-MARKUP-CUTOFF-REC           PIC  X(200).          00691099
006918                                                                  00691199
006919 FD  MISSED-EVEN-EXCHG-SALES-FILE                                 00691299
006920     RECORDING MODE IS F                                          00691399
006921     BLOCK CONTAINS 0 RECORDS                                     00691499
006922     LABEL RECORDS ARE STANDARD.                                  00691599
006930 01  PV-EVEN-EXCHG-SALES-REC                PIC  X(080).          00691699
006940                                                                  00691799
007000 FD  MISSED-EVEN-EXCHG-RTRNS-FILE                                 00691899
007100     RECORDING MODE IS F                                          00691999
007200     BLOCK CONTAINS 0 RECORDS                                     00692099
007300     LABEL RECORDS ARE STANDARD.                                  00693099
007310 01  PV-EVEN-EXCHG-RTRNS-REC                PIC  X(080).          00694099
007500                                                                  00695099
008307*----------------------------------------------------------       00696099
008400 WORKING-STORAGE SECTION.                                         00697099
008401*----------------------------------------------------------       00698099
008403 01  ABEND-CODE                             PIC S9(004)           00699099
008404                                             VALUE +0             00700099
008405                                             COMP.                00710099
008407                                                                  00720099
008408*---------------------------------------------                    00730099
008409* RECORD LAYOUT FOR INPUT DATE CARD                               00740099
008410* (POS DATE)                                                      00750099
008420*---------------------------------------------                    00760099
008430 01  CC-POS-DATE-CARD.                                            00770099
008440   05  CC-POS-DATE-CARD-DISPLAY.                                  00780099
008450     10  CC-CONTROL-NAME                    PIC  X(014)           00790099
008460                                             VALUE SPACES.        00800099
008470       88  CC-VALID-CONTROL-NAME                                  00810099
008480             VALUE 'P.O.S. DATE = '.                              00820099
008490     10  CC-POS-DATE-MMDDYY                 PIC  9(006)           00830099
008500                                             VALUE ZEROES.        00840099
008501     10  FILLER                                                   00850099
008502        REDEFINES CC-POS-DATE-MMDDYY.                             00850199
008503       15  CC-POS-DATE-MM                   PIC  9(002).          00850299
008504       15  CC-POS-DATE-DD                   PIC  9(002).          00850399
008505       15  CC-POS-DATE-YY                   PIC  9(002).          00850499
008506   05  FILLER                               PIC  X(060)           00850599
008507                                             VALUE SPACES.        00850699
008508                                                                  00850799
008510*---------------------------------------------                    00850899
008520* PC- PROGRAM CONSTANTS                                           00850999
008530*---------------------------------------------                    00851099
008531 01  PC-PROGRAM-CONSTANTS.                                        00852099
008532   05  PC-PROGRAM-NAME                      PIC  X(008)           00853099
008533        VALUE 'SAKUT015'.                                         00853199
008534   05  PC-DECIMAL-SHIFT-RIGHT               PIC S9(002)           00853299
008535                                             VALUE +10.           00853399
008538   05  PC-SKU-QUANTITY                      PIC  9(004)           00853499
008539                                             VALUE 1.             00853599
008542   05  PC-DOCUMENT-QUANTITY                 PIC  X(005)           00853699
008543                                             VALUE '00001'.       00853799
008546   05  PC-VENDOR-INHSE-NMBR                 PIC  X(003)           00853899
008547                                             VALUE SPACES.        00853999
008552                                                                  00854099
008553*---------------------------------------------                    00855099
008554* PS- PROGRAM SWITCHES VARIABLES                                  00855199
008555*---------------------------------------------                    00855299
008556 01  PS-PROGRAM-SWITCHES.                                         00855399
008557   05  PS-RETURN-OR-SALE-SW                 PIC  X(001).          00855499
008558     88  PS-RETURN-SIDE                      VALUE 'R'.           00855599
008559     88  PS-SALE-SIDE                        VALUE 'S'.           00855699
008562                                                                  00855799
008563*---------------------------------------------                    00855899
008564* PV- PROGRAM WORKING VARIABLES                                   00855999
008565*---------------------------------------------                    00856099
008566 01  PV-PROGRAM-VARIABLES.                                        00856199
008567   05 PV-RFMT-STORE.                                              00856299
008568      10  FILLER                            PIC  X VALUE '0'.     00856399
008569      10  PV-RFMT-STORE-4                   PIC  X(4).            00856499
008570   05  PV-CC-FISCAL-ACCT-MONTH              PIC  9(002).          00856599
008571   05  PV-TRANSACTION-DATE-YMD              PIC S9(007)           00856699
008572                                             VALUE ZEROES.        00856799
008573   05  FILLER                                                     00856899
008574      REDEFINES PV-TRANSACTION-DATE-YMD.                          00856999
008575                                                                  00857099
008576     10  PV-TRANSACTION-DATE-YEAR           PIC  9(002).          00857199
008577     10  PV-TRANSACTION-DATE-MONTH          PIC  9(002).          00857299
008578     10  PV-TRANSACTION-DATE-DAY            PIC  9(002).          00857399
008579     10  FILLER                             PIC  9(001).          00857499
008580   05  FILLER                                                     00857599
008581      REDEFINES PV-TRANSACTION-DATE-YMD.                          00857699
008582     10  FILLER                             PIC  9(004).          00857799
008583     10  PV-TRANSACTION-DATE-DAY-X          PIC  X(002).          00857899
008584     10  FILLER                             PIC  9(001).          00857999
008585   05  FILLER                                                     00858099
008586      REDEFINES PV-TRANSACTION-DATE-YMD.                          00858199
008587     10  FILLER                             PIC  9(002).          00858299
008588     10  PV-TRANSACTION-DATE-MONTH-DAY      PIC  X(004).          00858399
008589     10  FILLER                             PIC  9(001).          00858499
008590   05  PV-KOHLS-ACCT-MONTH                  PIC S9(003)           00858599
008591                                             VALUE ZEROES.        00858699
008592   05  FILLER                                                     00858799
008593      REDEFINES PV-KOHLS-ACCT-MONTH.                              00858899
008594     10  PV-KOHLS-ACCT-MONTH-X              PIC  X(002).          00858999
008595     10  FILLER                             PIC  9(001).          00859099
008596   05  PV-RETAIL                            PIC S9(005)V99        00859199
008597                                             VALUE ZEROES.        00859299
008602   05  PV-7-DIGIT-DOCUMENT-NMBR.                                  00859399
008603     10  PV-CATEGORY-IND                    PIC  X(002)           00859499
008604                                             VALUE '00'.          00859599
008605     10  PV-DOCUMENT-NMBR.                                        00859699
008606       15  PV-DEPT-NMBR                     PIC  X(003)           00859799
008607                                             VALUE '000'.         00859899
008608       15  PV-DATE-DAY                      PIC  X(002)           00859999
008609                                             VALUE '00'.          00860099
008610   05  PV-EXT-MISSED-RETURN-MD-AMT          PIC S9(007)V99        00861099
008611                                             VALUE ZEROES         00861199
008612                                             COMP-3.              00861299
008613   05  PV-EXT-MISSED-RETURN-MDC-AMT         PIC S9(007)V99        00861399
008614                                             VALUE ZEROES         00861499
008615                                             COMP-3.              00861599
008616   05  PV-EXT-MISSED-SALE-MU-AMT            PIC S9(007)V99        00861699
008617                                             VALUE ZEROES         00861799
008618                                             COMP-3.              00861899
008619   05  PV-EXT-MISSED-SALE-MD-AMT            PIC S9(007)V99        00861999
008620                                             VALUE ZEROES         00862099
008630                                             COMP-3.              00863099
008643   05  PV-LINE-MISSED-AMT                   PIC S9(009)V99        00864099
008644                                             VALUE ZEROES         00864199
008645                                             COMP-3.              00864299
008646   05  PV-TOTAL-MISSED-MD-AMT               PIC S9(009)V99        00864399
008647                                             VALUE ZEROES         00864499
008648                                             COMP-3.              00864599
008649   05  PV-TOTAL-MISSED-MDC-AMT              PIC S9(009)V99        00864699
008650                                             VALUE ZEROES         00864799
008651                                             COMP-3.              00864899
008652   05  PV-TOTAL-MISSED-MU-AMT               PIC S9(009)V99        00864999
008653                                             VALUE ZEROES         00865099
008654                                             COMP-3.              00865199
008655   05  PV-TOTAL-NET-AMT                     PIC S9(009)V99        00865299
008656                                             VALUE ZEROES         00865399
008657                                             COMP-3.              00865499
008666                                                                  00865599
008667   05  PV-SALES-OR-RETURNS-LAYOUT.                                00865699
008668     10  PV-POS-DATE-YMD                    PIC S9(007)           00865799
008669                                             COMP-3.              00865899
008670     10  PV-ACCT-MONTH                      PIC  9(002).          00865999
008671     10  PV-STORE-NUMBER                    PIC  X(004).          00866099
008672     10  PV-TERMINAL-NUMBER                 PIC  9(004).          00867099
008673     10  PV-TRANSACTION-NUMBER              PIC  9(004).          00867199
008680     10  PV-ITEM-SEQUENCE                   PIC S9(005)           00867299
008690                                             COMP-3.              00867399
008700     10  PV-SKU                             PIC  X(008).          00867499
008742     10  PV-STATUS-CODE                     PIC S9(003)           00867599
008743                                             COMP-3.              00867699
008744     10  PV-UNIT-QTY                        PIC S9(005)           00867799
008745                                             COMP-3.              00867899
008746     10  PV-UNIT-CUST-CHARGED-AMT           PIC S9(005)V99        00867999
008747                                             COMP-3.              00868099
008748     10  PV-UNIT-NET-AMT-CHARGED            PIC S9(005)V99        00869099
008749                                             COMP-3.              00870099
008750     10  PV-UNIT-RETAIL-AMT                 PIC S9(005)V99        00871099
008751                                              COMP-3.             00872099
008752     10  PV-UNIT-OWNED-RETAIL-AMT           PIC S9(005)V99        00873099
008753                                             COMP-3.              00874099
008754     10  PV-UNIT-EXT-MISSED-RI-MD-AMT       PIC S9(007)V99        00875099
008755                                             VALUE ZEROES         00875199
008756                                             COMP-3.              00875299
008757     10  PV-UNIT-EXT-MISSED-RI-MDC-AMT      PIC S9(007)V99        00875399
008758                                             VALUE ZEROES         00875499
008759                                             COMP-3.              00875599
008760     10  PV-UNIT-EXT-MISSED-SI-MU-AMT       PIC S9(007)V99        00875699
008761                                             VALUE ZEROES         00875799
008762                                             COMP-3.              00875899
008763     10  PV-UNIT-EXT-MISSED-SI-MD-AMT       PIC S9(007)V99        00875999
008764                                             VALUE ZEROES         00876099
008765                                             COMP-3.              00876199
008766     10  PV-SKU-DTA-ATTRIB.                                       00876299
008767         15  PV-DEPT-CLASS             PIC  X(05).                00876399
008768         15  PV-DEPT-CLASS-NUM        REDEFINES                   00876499
008769             PV-DEPT-CLASS.                                       00876599
008770             20  PV-DEPT-NBR           PIC  9(03).                00876699
008771             20  PV-CLASS-NBR          PIC  9(02).                00876799
008772         15  PV-MAJ-CLASS              PIC  X(04).                00876899
008773     10  FILLER                        PIC  X(01) VALUE SPACES.   00876999
008774                                                                  00877099
008775*---------------------------------------------                    00877199
008776* SC- FILE STATUSES                                               00877299
008777*---------------------------------------------                    00877399
008778 01  SC-FILE-STATUS-CODES.                                        00877499
008779   05  SC-SRTD-EVEN-EXCHG-FILE-STATUS       PIC  X(002)           00877599
008780                                             VALUE SPACES.        00877699
008781     88  SC-SRTD-EVEN-EXCHG-FILE-OK          VALUE '00'.          00877799
008782     88  SC-SRTD-EVEN-EXCHG-FILE-EOF         VALUE '10'.          00877899
008783   05  SC-POS-DATE-FILE-STATUS              PIC  X(002)           00877999
008784                                             VALUE SPACES.        00878099
008785     88  SC-POS-DATE-STATUS-OK               VALUE '00'.          00878199
008786   05  SC-PS-MKDWN-FILE-STATUS              PIC  X(002)           00878299
008787                                             VALUE SPACES.        00878399
008788     88  SC-PS-MKDWN-FILE-OK                 VALUE '00'.          00878499
008789   05  SC-PS-MKUP-FILE-STATUS               PIC  X(002)           00878599
008790                                             VALUE SPACES.        00878699
008791     88  SC-PS-MKUP-FILE-OK                  VALUE '00'.          00878799
008792   05  SC-MW-MKDWN-FILE-STATUS              PIC  X(002)           00878899
008793                                             VALUE SPACES.        00878999
008794     88  SC-MW-MKDWN-FILE-OK                 VALUE '00'.          00879099
008795   05  SC-MW-MKUP-FILE-STATUS               PIC  X(002)           00879199
008796                                             VALUE SPACES.        00879299
008797     88  SC-MW-MKUP-FILE-OK                  VALUE '00'.          00879399
008798   05  SC-PS-MKDWN-CUTOFF-FILE-STATUS       PIC  X(002)           00879499
008799                                             VALUE SPACES.        00879599
008800     88  SC-PS-MKDWN-CUTOFF-FILE-OK          VALUE '00'.          00879699
008801   05  SC-PS-MKUP-CUTOFF-FILE-STATUS        PIC  X(002)           00879799
008802                                             VALUE SPACES.        00879899
008803     88  SC-PS-MKUP-CUTOFF-FILE-OK           VALUE '00'.          00879999
008804   05  SC-MW-MKDWN-CUTOFF-FILE-STATUS       PIC  X(002)           00880099
008805                                             VALUE SPACES.        00880199
008806     88  SC-MW-MKDWN-CUTOFF-FILE-OK          VALUE '00'.          00880299
008807   05  SC-MW-MKUP-CUTOFF-FILE-STATUS        PIC  X(002)           00880399
008808                                             VALUE SPACES.        00880499
008809     88  SC-MW-MKUP-CUTOFF-FILE-OK           VALUE '00'.          00880599
008810   05  SC-MISSED-EX-SALES-FILE-STATUS       PIC  X(002)           00880699
008811                                             VALUE SPACES.        00880799
008812     88  SC-MISSED-EX-SALES-FILE-OK          VALUE '00'.          00880899
008813   05  SC-MISSED-EX-RTRNS-FILE-STATUS       PIC  X(002)           00880999
008814                                             VALUE SPACES.        00881099
008815     88  SC-MISSED-EX-RTRNS-FILE-OK          VALUE '00'.          00881199
008816                                                                  00881299
008817*---------------------------------------------                    00881399
008818* MERCHANDISE LEDGER MARKDOWN/MARKON RECORD                       00881499
008819* LAYOUT.                                                         00881599
008820*---------------------------------------------                    00881699
008830     COPY MLRD017.                                                00881799
008900                                                                  00881899
009000*---------------------------------------------                    00881999
009100* WORKING STORAGE FOR DPKUT500 INTERFACE                          00882099
009200*---------------------------------------------                    00883099
009300     COPY DPWS500.                                                00884099
009400                                                                  00885099
009500*---------------------------------------------                    00886099
009600* EVEN EXCHANGE EXTRACTION RECORD LAYOUT                          00887099
009700*---------------------------------------------                    00888099
009800     COPY SAWS039.                                                00889099
009900                                                                  00890099
042900*----------------------------------------------------------       00900099
043000 PROCEDURE DIVISION.                                              00910099
043100*----------------------------------------------------------       00920099
043200 0000-MAINLINE.                                                   00930099
043300                                                                  00940099
043301     PERFORM 1000-INITIALIZE.                                     00950099
043302                                                                  00960099
043303     PERFORM 2000-CREATE-MKUP-MKDWN-RECS                          00970099
043304       UNTIL SC-SRTD-EVEN-EXCHG-FILE-EOF.                         00980099
043305                                                                  00990099
043306     PERFORM 9999-CLOSE-FILES.                                    01000099
043307                                                                  01010099
044100     GOBACK.                                                      01020099
044200                                                                  01030099
044300*0000-EXIT.                                                       01040099
044400 EJECT                                                            01050099
044401                                                                  01060099
044402*----------------------------------------------------------       01070099
044403* 1000-INITIALIZE.                                                01080099
044406*----------------------------------------------------------       01090099
044407 1000-INITIALIZE.                                                 01100099
044408                                                                  01110099
044430     OPEN INPUT  POS-SRTD-EVEN-EXCHG-FILE                         01120099
044431                 POS-DATE-FILE                                    01130099
044440          OUTPUT PS-EVEN-EX-MARKDWN-FILE                          01140099
044450                 PS-EVEN-EX-MARKUP-FILE                           01150099
044460                 MW-EVEN-EX-MARKDWN-FILE                          01160099
044461                 MW-EVEN-EX-MARKUP-FILE                           01170099
044462                 PS-EVEN-EX-MARKDWN-CUTOFF-FILE                   01180099
044463                 PS-EVEN-EX-MARKUP-CUTOFF-FILE                    01190099
044464                 MW-EVEN-EX-MARKDWN-CUTOFF-FILE                   01200099
044465                 MW-EVEN-EX-MARKUP-CUTOFF-FILE                    01210099
044466                 MISSED-EVEN-EXCHG-SALES-FILE                     01220099
044467                 MISSED-EVEN-EXCHG-RTRNS-FILE.                    01230099
044479                                                                  01240099
044480     IF NOT SC-SRTD-EVEN-EXCHG-FILE-OK                            01250099
044481       DISPLAY ' '                                                01260099
044482       DISPLAY '** ABEND     **'                                  01270099
044483       DISPLAY '** PROGRAM   **  = ' PC-PROGRAM-NAME              01280099
044484       DISPLAY '** PARAGRAPH **'                                  01290099
044485        '= 1000-INITIALIZE'                                       01300099
044486       DISPLAY '** SORTED EVEN EXCHANGE OPEN ERROR'               01310099
044487       DISPLAY '** FILE STATUS IS = '                             01320099
044488        SC-SRTD-EVEN-EXCHG-FILE-STATUS                            01330099
044489       MOVE +4005 TO ABEND-CODE                                   01340099
044490       CALL 'ILBOABN0' USING ABEND-CODE                           01350099
044491     END-IF.                                                      01360099
044492     IF NOT SC-PS-MKDWN-FILE-OK                                   01370099
044493       DISPLAY ' '                                                01380099
044494       DISPLAY '** ABEND     **'                                  01390099
044495       DISPLAY '** PROGRAM   **  = ' PC-PROGRAM-NAME              01400099
044496       DISPLAY '** PARAGRAPH **'                                  01410099
044497        '= 1000-INITIALIZE'                                       01420099
044498       DISPLAY '** MISSED PS MARKDOWN FILE OPEN ERROR'            01430099
044499       DISPLAY '** FILE STATUS IS = '                             01440099
044500        SC-PS-MKDWN-FILE-STATUS                                   01450099
044501       MOVE +4005 TO ABEND-CODE                                   01460099
044502       CALL 'ILBOABN0' USING ABEND-CODE                           01470099
044503     END-IF.                                                      01480099
044504     IF NOT SC-PS-MKUP-FILE-OK                                    01490099
044505       DISPLAY ' '                                                01500099
044506       DISPLAY '** ABEND     **'                                  01510099
044507       DISPLAY '** PROGRAM   **  = ' PC-PROGRAM-NAME              01520099
044508       DISPLAY '** PARAGRAPH **'                                  01530099
044509        '= 1000-INITIALIZE'                                       01540099
044510       DISPLAY '** MISSED PS MARKUP FILE OPEN ERROR'              01550099
044511       DISPLAY '** FILE STATUS IS = '                             01560099
044512        SC-PS-MKUP-FILE-STATUS                                    01570099
044513       MOVE +4005 TO ABEND-CODE                                   01580099
044514       CALL 'ILBOABN0' USING ABEND-CODE                           01590099
044515     END-IF.                                                      01600099
044516     IF NOT SC-MW-MKDWN-FILE-OK                                   01610099
044517       DISPLAY ' '                                                01620099
044518       DISPLAY '** ABEND     **'                                  01630099
044519       DISPLAY '** PROGRAM   **  = ' PC-PROGRAM-NAME              01640099
044520       DISPLAY '** PARAGRAPH **'                                  01650099
044521        '= 1000-INITIALIZE'                                       01660099
044522       DISPLAY '** MISSED MW MARKDOWN FILE OPEN ERROR'            01670099
044523       DISPLAY '** FILE STATUS IS = '                             01680099
044524        SC-MW-MKDWN-FILE-STATUS                                   01690099
044525       MOVE +4005 TO ABEND-CODE                                   01700099
044526       CALL 'ILBOABN0' USING ABEND-CODE                           01710099
044527     END-IF.                                                      01720099
044528     IF NOT SC-MW-MKUP-FILE-OK                                    01730099
044529       DISPLAY ' '                                                01740099
044530       DISPLAY '** ABEND     **'                                  01750099
044531       DISPLAY '** PROGRAM   **  = ' PC-PROGRAM-NAME              01760099
044532       DISPLAY '** PARAGRAPH **'                                  01770099
044533        '= 1000-INITIALIZE'                                       01780099
044534       DISPLAY '** MISSED MW MARKUP FILE OPEN ERROR'              01790099
044535       DISPLAY '** FILE STATUS IS = '                             01800099
044536        SC-MW-MKUP-FILE-STATUS                                    01810099
044537       MOVE +4005 TO ABEND-CODE                                   01820099
044538       CALL 'ILBOABN0' USING ABEND-CODE                           01830099
044539     END-IF.                                                      01840099
044540     IF NOT SC-PS-MKDWN-CUTOFF-FILE-OK                            01850099
044541       DISPLAY ' '                                                01860099
044542       DISPLAY '** ABEND     **'                                  01870099
044543       DISPLAY '** PROGRAM   **  = ' PC-PROGRAM-NAME              01880099
044544       DISPLAY '** PARAGRAPH **'                                  01890099
044545        '= 1000-INITIALIZE'                                       01900099
044546       DISPLAY '** MISSED PS MARKDOWN CUTOFF '                    01910099
044547        'FILE OPEN ERROR'                                         01920099
044548       DISPLAY '** FILE STATUS IS = '                             01930099
044549        SC-PS-MKDWN-CUTOFF-FILE-STATUS                            01940099
044550       MOVE +4005 TO ABEND-CODE                                   01950099
044551       CALL 'ILBOABN0' USING ABEND-CODE                           01960099
044552     END-IF.                                                      01970099
044553     IF NOT SC-PS-MKUP-CUTOFF-FILE-OK                             01980099
044554       DISPLAY ' '                                                01990099
044555       DISPLAY '** ABEND     **'                                  02000099
044556       DISPLAY '** PROGRAM   **  = ' PC-PROGRAM-NAME              02010099
044557       DISPLAY '** PARAGRAPH **'                                  02020099
044558        '= 1000-INITIALIZE'                                       02030099
044559       DISPLAY '** MISSED PS MARKUP CUTOFF FILE OPEN ERROR'       02040099
044560       DISPLAY '** FILE STATUS IS = '                             02050099
044561        SC-PS-MKUP-CUTOFF-FILE-STATUS                             02060099
044562       MOVE +4005 TO ABEND-CODE                                   02070099
044563       CALL 'ILBOABN0' USING ABEND-CODE                           02080099
044564     END-IF.                                                      02090099
044565     IF NOT SC-MW-MKDWN-CUTOFF-FILE-OK                            02100099
044566       DISPLAY ' '                                                02110099
044567       DISPLAY '** ABEND     **'                                  02120099
044568       DISPLAY '** PROGRAM   **  = ' PC-PROGRAM-NAME              02130099
044569       DISPLAY '** PARAGRAPH **'                                  02140099
044570        '= 1000-INITIALIZE'                                       02150099
044571       DISPLAY '** MISSED MW MARKDOWN CUTOFF '                    02160099
044572        'FILE OPEN ERROR'                                         02170099
044573       DISPLAY '** FILE STATUS IS = '                             02180099
044574        SC-MW-MKDWN-CUTOFF-FILE-STATUS                            02190099
044575       MOVE +4005 TO ABEND-CODE                                   02200099
044576       CALL 'ILBOABN0' USING ABEND-CODE                           02210099
044577     END-IF.                                                      02220099
044578     IF NOT SC-MW-MKUP-CUTOFF-FILE-OK                             02230099
044579       DISPLAY ' '                                                02240099
044580       DISPLAY '** ABEND     **'                                  02250099
044581       DISPLAY '** PROGRAM   **  = ' PC-PROGRAM-NAME              02260099
044582       DISPLAY '** PARAGRAPH **'                                  02270099
044583        '= 1000-INITIALIZE'                                       02280099
044584       DISPLAY '** MISSED MW MARKUP CUTOFF FILE OPEN ERROR'       02290099
044585       DISPLAY '** FILE STATUS IS = '                             02300099
044586        SC-MW-MKUP-CUTOFF-FILE-STATUS                             02310099
044587       MOVE +4005 TO ABEND-CODE                                   02320099
044588       CALL 'ILBOABN0' USING ABEND-CODE                           02330099
044589     END-IF.                                                      02340099
044590     IF NOT SC-MISSED-EX-SALES-FILE-OK                            02350099
044591       DISPLAY ' '                                                02360099
044592       DISPLAY '** ABEND     **'                                  02370099
044593       DISPLAY '** PROGRAM   **  = ' PC-PROGRAM-NAME              02380099
044594       DISPLAY '** PARAGRAPH **'                                  02390099
044595        '= 1000-INITIALIZE'                                       02400099
044596       DISPLAY '** TEMP MISSED SALES FILE OPEN ERROR'             02410099
044597       DISPLAY '** FILE STATUS IS = '                             02420099
044598        SC-MISSED-EX-SALES-FILE-STATUS                            02430099
044599       MOVE +4005 TO ABEND-CODE                                   02440099
044600       CALL 'ILBOABN0' USING ABEND-CODE                           02450099
044601     END-IF.                                                      02460099
044602     IF NOT SC-MISSED-EX-RTRNS-FILE-OK                            02470099
044603       DISPLAY ' '                                                02480099
044604       DISPLAY '** ABEND     **'                                  02490099
044605       DISPLAY '** PROGRAM   **  = ' PC-PROGRAM-NAME              02500099
044606       DISPLAY '** PARAGRAPH **'                                  02510099
044607        '= 1000-INITIALIZE'                                       02520099
044608       DISPLAY '** TEMP MISSED RETURNS FILE OPEN ERROR'           02530099
044609       DISPLAY '** FILE STATUS IS = '                             02540099
044610        SC-MISSED-EX-RTRNS-FILE-STATUS                            02550099
044611       MOVE +4005 TO ABEND-CODE                                   02560099
044612       CALL 'ILBOABN0' USING ABEND-CODE                           02570099
044613     END-IF.                                                      02580099
044614                                                                  02590099
044615     PERFORM 1100-RET-CURR-FISCAL-MONTH.                          02600099
044616                                                                  02610099
044617     PERFORM 8010-READ-EVEN-EX-FILE.                              02620099
044618                                                                  02630099
044619     INITIALIZE ML017-PRICE-CHANGE-RECORD.                        02640099
044620                                                                  02650099
044621*1000-EXIT.                                                       02660099
044622 EJECT                                                            02670099
044623                                                                  02680099
044624*----------------------------------------------------------       02690099
044625* 1100-RET-CURR-FISCAL-MONTH.                                     02700099
044626*----------------------------------------------------------       02710099
044627 1100-RET-CURR-FISCAL-MONTH.                                      02720099
044628                                                                  02730099
044629     READ POS-DATE-FILE                                           02740099
044630       INTO CC-POS-DATE-CARD                                      02750099
044631         AT END                                                   02760099
044632           DISPLAY ' '                                            02770099
044633           DISPLAY '** ABEND     **'                              02780099
044634           DISPLAY '** PROGRAM   **  = ' PC-PROGRAM-NAME          02790099
044635           DISPLAY '** PARAGRAPH **'                              02800099
044636            '= 1100-RET-CURR-FISCAL-MONTH'                        02810099
044638           DISPLAY '** CONTROL CARD DATE RECORD IS MISSING'       02820099
044639           MOVE +4003 TO ABEND-CODE                               02830099
044640           CALL 'ILBOABN0' USING ABEND-CODE                       02840099
044641     END-READ.                                                    02850099
044642                                                                  02860099
044644     INITIALIZE DPG51, DPG52, DPG53, DPG54, DPG55, DPG56.         02870099
044645                                                                  02880099
044646     SET DPG51-FISCAL-454-CALENDAR TO TRUE.                       02890099
044647     SET DPG52-LK-DTE-GREG         TO TRUE.                       02900099
044648                                                                  02910099
044649     MOVE CC-POS-DATE-MMDDYY TO DPG52-LK-DATE-INPUT.              02920099
044650                                                                  02930099
044651     CALL DP500-KOHLS-CALENDAR-ROUTINE                            02940099
044652       USING DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.                 02950099
044653                                                                  02960099
044654     EVALUATE TRUE                                                02970099
044655       WHEN DPG54-NO-ERROR                                        02980099
044656         CONTINUE                                                 02990099
044657       WHEN OTHER                                                 03000099
044658         DISPLAY ' '                                              03010099
044659         DISPLAY '** ABEND     **'                                03020099
044660         DISPLAY '** PROGRAM   **  = ' PC-PROGRAM-NAME            03030099
044661         DISPLAY '** PARAGRAPH **'                                03040099
044662          '= 1100-RET-CURR-FISCAL-MONTH'                          03050099
044664         DISPLAY '** ERROR MESSAGE = ' DPG54-ERROR-MESSAGE        03060099
044665         MOVE +4019 TO ABEND-CODE                                 03070099
044666         CALL 'ILBOABN0' USING ABEND-CODE                         03080099
044667     END-EVALUATE.                                                03090099
044668                                                                  03100099
044669     MOVE DPG56-FISCAL-PERIOD-NBR TO PV-CC-FISCAL-ACCT-MONTH.     03110099
044671                                                                  03120099
044672*1100-EXIT.                                                       03130099
044673 EJECT                                                            03140099
044674                                                                  03150099
044675*----------------------------------------------------------       03160099
044676* 2000-CREATE-MKUP-MKDWN-RECS.                                    03170099
044677*----------------------------------------------------------       03180099
044678 2000-CREATE-MKUP-MKDWN-RECS.                                     03190099
044679                                                                  03200099
044680     PERFORM 3010-PROC-GENERAL-TRANS-DATA.                        03210099
044681                                                                  03220099
044682     IF SA039-RI-SKU = ZEROES                                     03230099
044683       PERFORM 3030-PROC-SALE-TRANS-DATA                          03240099
044684     ELSE                                                         03250099
044685       IF SA039-RI-UNIT-CUST-CHARGED-AMT =                        03260099
044686         SA039-RI-UNIT-OWNED-RETAIL-AMT                           03270099
044687           PERFORM 3030-PROC-SALE-TRANS-DATA                      03280099
044688       ELSE                                                       03290099
044689           PERFORM 3020-RETURN-ITEM-TRANS-DATA                    03300099
044690           PERFORM 3030-PROC-SALE-TRANS-DATA                      03310099
044691       END-IF                                                     03320099
044692     END-IF.                                                      03330099
044693                                                                  03340099
044694     PERFORM 8010-READ-EVEN-EX-FILE.                              03350099
044695                                                                  03360099
044696*2000-EXIT.                                                       03370099
044697 EJECT                                                            03380099
044698                                                                  03390099
044699*----------------------------------------------------------       03400099
044700* 3010-PROC-GENERAL-TRANS-DATA.                                   03410099
044701*----------------------------------------------------------       03420099
044702 3010-PROC-GENERAL-TRANS-DATA.                                    03430099
044703                                                                  03440099
044704     COMPUTE PV-TRANSACTION-DATE-YMD =                            03450099
044705               SA039-POS-DATE-YMD * PC-DECIMAL-SHIFT-RIGHT.       03460099
044706                                                                  03470099
044707     COMPUTE PV-KOHLS-ACCT-MONTH =                                03480099
044708               SA039-KOHLS-ACCT-MONTH * PC-DECIMAL-SHIFT-RIGHT.   03490099
044709                                                                  03500099
044710*3010-EXIT.                                                       03510099
044711 EJECT                                                            03520099
044712                                                                  03530099
044713*----------------------------------------------------------       03540099
044714* 3020-RETURN-ITEM-TRANS-DATA.                                    03550099
044715*----------------------------------------------------------       03560099
044716 3020-RETURN-ITEM-TRANS-DATA.                                     03570099
044717                                                                  03580099
044718     MOVE ZEROES TO PV-EXT-MISSED-SALE-MU-AMT                     03590099
044719                    PV-EXT-MISSED-SALE-MD-AMT.                    03600099
044720                                                                  03610099
044721     COMPUTE PV-EXT-MISSED-RETURN-MDC-AMT =                       03620099
044722               ((SA039-RI-UNIT-CUST-CHARGED-AMT -                 03630099
044723                  SA039-RI-UNIT-OWNED-RETAIL-AMT) *               03640099
044724                    SA039-RI-UNIT-QTY).                           03650099
044725                                                                  03660099
044726     IF PV-EXT-MISSED-RETURN-MDC-AMT >= ZERO                      03670099
044727       MOVE ZEROES TO PV-EXT-MISSED-RETURN-MD-AMT                 03680099
044728     ELSE                                                         03690099
044729       COMPUTE PV-EXT-MISSED-RETURN-MD-AMT =                      03700099
044730                 PV-EXT-MISSED-RETURN-MDC-AMT * -1                03710099
044731       MOVE ZEROES TO PV-EXT-MISSED-RETURN-MDC-AMT                03720099
044732     END-IF.                                                      03730099
044733                                                                  03740099
044734     SET ML017-BN-OWN-ADJ-CRCT          TO TRUE.                  03750099
044735     SET ML017-RC-MISCELLANEOUS         TO TRUE.                  03760099
044736     MOVE PV-TRANSACTION-DATE-MONTH-DAY TO ML017-PC-DTE.          03770099
044737     MOVE PV-KOHLS-ACCT-MONTH-X         TO ML017-PC-KOHLS-MM.     03780099
044738     MOVE SA039-RI-SKU                  TO ML017-PC-SKU.          03790099
044739     MOVE SA039-RI-DEPT-CLASS           TO ML017-PC-DEPT-CLASS.   03800099
044740     MOVE SA039-RI-MAJ-CLASS            TO ML017-PC-MAJ-CLASS.    03810099
044741     MOVE SA039-TERMINAL-NUMBER         TO ML017-RGST-ID.         03820099
044742     MOVE SA039-TRANSACTION-NUMBER      TO ML017-TRN-NBR.         03830099
044743     MOVE SA039-ITEM-SEQUENCE           TO ML017-LNE-ITM-SEQ-NBR. 03840099
044744     MOVE PC-SKU-QUANTITY               TO ML017-PC-QTY.          03850099
044745                                                                  03860099
044746     COMPUTE ML017-PC-DIFFER-AMT =                                03870099
044747               ((SA039-RI-UNIT-CUST-CHARGED-AMT -                 03880099
044748                  SA039-RI-UNIT-OWNED-RETAIL-AMT) *               03890099
044749                    SA039-RI-UNIT-QTY * (-1)).                    03900099
044750                                                                  03910099
044751     SET ML017-REGISTER-MKDN-MKON   TO TRUE.                      03920099
044752     MOVE PC-DOCUMENT-QUANTITY      TO ML017-PC-TOT-DOC-QTY.      03930099
044753     MOVE SA039-STORE-NUMBER        TO PV-RFMT-STORE-4.           03940099
044754     MOVE PV-RFMT-STORE             TO ML017-PC-STORE-NBR.        03950099
044755     MOVE PC-VENDOR-INHSE-NMBR      TO ML017-PC-VENDOR-INHSE-NMBR.03960099
044756     MOVE SA039-RI-DEPT-NBR         TO PV-DEPT-NMBR.              03970099
044757     MOVE PV-TRANSACTION-DATE-DAY-X TO PV-DATE-DAY.               03980099
044758     MOVE PV-7-DIGIT-DOCUMENT-NMBR                                03990099
044759       TO ML017-PC-DOC-7-NBR.                                     04000099
044760     MOVE PV-DOCUMENT-NMBR TO ML017-PC-DOC-5-NBR.                 04010099
044761                                                                  04020099
044762     IF PV-EXT-MISSED-RETURN-MD-AMT = ZEROES                      04030099
044763       SET ML017-MKDOWN                 TO TRUE                   04040099
044764       SET ML017-MARKDOWN-CANCEL TO TRUE                          04050099
044765       MOVE ZEROES    TO PV-RETAIL                                04060099
044766       MOVE PV-RETAIL TO ML017-PC-OLD-PR-AMT                      04070099
044767                                                                  04080099
044768       COMPUTE PV-RETAIL =                                        04090099
044769                 (ML017-PC-DIFFER-AMT *                           04100099
044770                    (-1))                                         04110099
044771       MOVE PV-RETAIL TO ML017-PC-NEW-PR-AMT                      04120099
044772                                                                  04130099
044773       PERFORM 8020-WRITE-PS-MARKDWN-REC                          04140099
044774                                                                  04150099
044775       MOVE SA039-RI-UNIT-QTY TO ML017-PC-QTY                     04160099
044776       PERFORM 8030-WRITE-MW-MARKDWN-REC                          04170099
044777                                                                  04180099
044778       SET PS-RETURN-SIDE TO TRUE                                 04190099
044779       PERFORM 4020-CREATE-EVEN-EXCHG-REC                         04200099
044780     ELSE                                                         04210099
044781       SET ML017-MKDOWN TO TRUE                                   04220099
044782       SET ML017-MARKDOWN           TO TRUE                       04230099
044783                                                                  04240099
044784       COMPUTE PV-RETAIL =                                        04250099
044785                 (SA039-RI-UNIT-CUST-CHARGED-AMT *                04260099
044786                    SA039-RI-UNIT-QTY *                           04270099
044787                    (-1))                                         04280099
044788       MOVE PV-RETAIL TO ML017-PC-OLD-PR-AMT                      04290099
044789                                                                  04300099
044790       COMPUTE PV-RETAIL =                                        04310099
044791                 (SA039-RI-UNIT-OWNED-RETAIL-AMT *                04320099
044792                    SA039-RI-UNIT-QTY *                           04330099
044793                    (-1))                                         04340099
044794       MOVE PV-RETAIL TO ML017-PC-NEW-PR-AMT                      04350099
044795                                                                  04360099
044796       PERFORM 8020-WRITE-PS-MARKDWN-REC                          04370099
044797                                                                  04380099
044798       MOVE SA039-RI-UNIT-QTY TO ML017-PC-QTY                     04390099
044799       PERFORM 8030-WRITE-MW-MARKDWN-REC                          04400099
044800                                                                  04410099
044801       SET PS-RETURN-SIDE TO TRUE                                 04420099
044802       PERFORM 4020-CREATE-EVEN-EXCHG-REC                         04430099
044803     END-IF.                                                      04440099
044804                                                                  04450099
044805     PERFORM 4010-COMPUTE-TOTALS.                                 04460099
044806                                                                  04470099
044807*3020-EXIT.                                                       04480099
044808 EJECT                                                            04480199
044809                                                                  04480299
044810*----------------------------------------------------------       04480399
044811* 3030-PROC-SALE-TRANS-DATA.                                      04480499
044812*----------------------------------------------------------       04480599
044813 3030-PROC-SALE-TRANS-DATA.                                       04480699
044814                                                                  04480799
044815     IF (SA039-SI-SKU NOT = ZEROES)                               04480899
044816      AND (SA039-SI-UNIT-CUST-CHARGED-AMT NOT =                   04480999
044817            SA039-SI-UNIT-OWNED-RETAIL-AMT)                       04481099
044818                                                                  04481199
044819       MOVE ZEROES TO PV-EXT-MISSED-RETURN-MD-AMT                 04481299
044820                      PV-EXT-MISSED-RETURN-MDC-AMT                04481399
044821                                                                  04481499
044822       COMPUTE PV-EXT-MISSED-SALE-MU-AMT =                        04481599
044823                 ((SA039-SI-UNIT-CUST-CHARGED-AMT -               04481699
044824                     SA039-SI-UNIT-OWNED-RETAIL-AMT) *            04481799
044825                        SA039-SI-UNIT-QTY)                        04481899
044826                                                                  04481999
044827       IF PV-EXT-MISSED-SALE-MU-AMT >= ZEROES                     04482099
044828         MOVE ZEROES TO PV-EXT-MISSED-SALE-MD-AMT                 04482199
044829       ELSE                                                       04482299
044830         COMPUTE PV-EXT-MISSED-SALE-MD-AMT =                      04482399
044831           PV-EXT-MISSED-SALE-MU-AMT * -1                         04482499
044832         MOVE ZEROES TO PV-EXT-MISSED-SALE-MU-AMT                 04482599
044833       END-IF                                                     04482699
044834                                                                  04482799
044835       MOVE ZEROES TO PV-EXT-MISSED-RETURN-MDC-AMT                04482899
044836                      PV-EXT-MISSED-RETURN-MD-AMT                 04482999
044837                                                                  04483099
044838       SET ML017-RC-MISCELLANEOUS         TO TRUE                 04483199
044839       SET ML017-BN-OWN-ADJ-CRCT          TO TRUE                 04483299
044840       MOVE PV-TRANSACTION-DATE-MONTH-DAY TO ML017-PC-DTE         04483399
044841       MOVE PV-KOHLS-ACCT-MONTH-X         TO ML017-PC-KOHLS-MM    04483499
044842       MOVE SA039-SI-SKU                  TO ML017-PC-SKU         04483599
044843       MOVE SA039-SI-DEPT-CLASS           TO ML017-PC-DEPT-CLASS  04483699
044844       MOVE SA039-SI-MAJ-CLASS            TO ML017-PC-MAJ-CLASS   04483799
044845       MOVE SA039-TERMINAL-NUMBER         TO ML017-RGST-ID        04483899
044846       MOVE SA039-TRANSACTION-NUMBER      TO ML017-TRN-NBR        04483999
044847       MOVE SA039-ITEM-SEQUENCE          TO ML017-LNE-ITM-SEQ-NBR 04484099
044848       MOVE PC-SKU-QUANTITY               TO ML017-PC-QTY         04484199
044849                                                                  04484299
044850       COMPUTE ML017-PC-DIFFER-AMT =                              04484399
044851                 ((SA039-SI-UNIT-CUST-CHARGED-AMT -               04484499
044852                     SA039-SI-UNIT-OWNED-RETAIL-AMT) *            04484599
044853                        SA039-SI-UNIT-QTY * (-1))                 04484699
044854                                                                  04484799
044855       MOVE PC-DOCUMENT-QUANTITY      TO ML017-PC-TOT-DOC-QTY     04484899
044856       MOVE SA039-STORE-NUMBER        TO PV-RFMT-STORE-4          04484999
044857       MOVE PV-RFMT-STORE             TO ML017-PC-STORE-NBR       04485099
044858       SET ML017-REGISTER-MKDN-MKON   TO TRUE                     04485199
044859       MOVE PC-VENDOR-INHSE-NMBR      TO                          04485299
044860                                     ML017-PC-VENDOR-INHSE-NMBR   04485399
044861       MOVE SA039-SI-DEPT-NBR         TO PV-DEPT-NMBR             04485499
044862       MOVE PV-TRANSACTION-DATE-DAY-X TO PV-DATE-DAY              04485599
044863       MOVE PV-7-DIGIT-DOCUMENT-NMBR                              04485699
044864         TO ML017-PC-DOC-7-NBR                                    04485799
044865       MOVE PV-DOCUMENT-NMBR TO ML017-PC-DOC-5-NBR                04485899
044866                                                                  04485999
044867       IF PV-EXT-MISSED-SALE-MU-AMT = ZEROES                      04486099
044868         SET ML017-MKDOWN TO TRUE                                 04486199
044869         SET ML017-MARKDOWN           TO TRUE                     04486299
044870                                                                  04486399
044871         COMPUTE PV-RETAIL =                                      04486499
044872                   (SA039-SI-UNIT-OWNED-RETAIL-AMT *              04486599
044873                      SA039-SI-UNIT-QTY)                          04486699
044874         MOVE PV-RETAIL TO ML017-PC-OLD-PR-AMT                    04486799
044875                                                                  04486899
044876         COMPUTE PV-RETAIL =                                      04486999
044877                   (SA039-SI-UNIT-CUST-CHARGED-AMT *              04487099
044878                      SA039-SI-UNIT-QTY)                          04487199
044879         MOVE PV-RETAIL TO ML017-PC-NEW-PR-AMT                    04487299
044880                                                                  04487399
044881         PERFORM 8020-WRITE-PS-MARKDWN-REC                        04487499
044882                                                                  04487599
044883         MOVE SA039-SI-UNIT-QTY TO ML017-PC-QTY                   04487699
044884         PERFORM 8030-WRITE-MW-MARKDWN-REC                        04487799
044885                                                                  04487899
044886         SET PS-SALE-SIDE TO TRUE                                 04487999
044887         PERFORM 4020-CREATE-EVEN-EXCHG-REC                       04488099
044888       ELSE                                                       04488199
044889         SET ML017-MKUP TO TRUE                                   04488299
044890         SET ML017-MARKUP           TO TRUE                       04488399
044891                                                                  04488499
044892         COMPUTE PV-RETAIL =                                      04488599
044893                   (SA039-SI-UNIT-OWNED-RETAIL-AMT *              04488699
044894                      SA039-SI-UNIT-QTY *                         04488799
044895                      (-1))                                       04488899
044896         MOVE PV-RETAIL TO ML017-PC-OLD-PR-AMT                    04488999
044897                                                                  04489099
044898         COMPUTE PV-RETAIL =                                      04489199
044899                   (SA039-SI-UNIT-CUST-CHARGED-AMT *              04489299
044900                      SA039-SI-UNIT-QTY *                         04489399
044901                      (-1))                                       04489499
044902         MOVE PV-RETAIL TO ML017-PC-NEW-PR-AMT                    04489599
044903                                                                  04489699
044904         PERFORM 8040-WRITE-PS-MARKUP-REC                         04489799
044905                                                                  04489899
044906         MOVE SA039-SI-UNIT-QTY TO ML017-PC-QTY                   04489999
044907         PERFORM 8050-WRITE-MW-MARKUP-REC                         04490099
044908                                                                  04490199
044909         SET PS-SALE-SIDE TO TRUE                                 04490299
044910         PERFORM 4020-CREATE-EVEN-EXCHG-REC                       04490399
044934       END-IF                                                     04490499
044935                                                                  04490599
044936       PERFORM 4010-COMPUTE-TOTALS                                04490699
044937     END-IF.                                                      04490799
044938                                                                  04490899
044939*3030-EXIT.                                                       04490999
044940 EJECT                                                            04491099
044941                                                                  04492099
044976*----------------------------------------------------------       04493099
044977* 4010-COMPUTE-TOTALS.                                            04494099
044978*----------------------------------------------------------       04495099
044979 4010-COMPUTE-TOTALS.                                             04496099
044980                                                                  04497099
044981     IF ML017-MKDOWN AND ML017-MARKDOWN                           04498099
044982       COMPUTE PV-LINE-MISSED-AMT =                               04498199
044983                 (ML017-PC-OLD-PR-AMT - ML017-PC-NEW-PR-AMT)      04498299
044984                    * ML017-PC-TOT-DOC-QTY                        04498399
044985       COMPUTE PV-TOTAL-MISSED-MD-AMT =                           04498499
044986                 PV-TOTAL-MISSED-MD-AMT + PV-LINE-MISSED-AMT      04498599
044987     END-IF.                                                      04498699
044988                                                                  04498799
044989     IF ML017-MKDOWN AND ML017-MARKDOWN-CANCEL                    04498899
044990       COMPUTE PV-LINE-MISSED-AMT =                               04498999
044991                 (ML017-PC-OLD-PR-AMT - ML017-PC-NEW-PR-AMT)      04499099
044992                    * ML017-PC-TOT-DOC-QTY                        04499199
044993       COMPUTE PV-TOTAL-MISSED-MDC-AMT =                          04499299
044994                 PV-TOTAL-MISSED-MDC-AMT + PV-LINE-MISSED-AMT     04499399
044995     END-IF.                                                      04499499
044996                                                                  04499599
044997     IF ML017-MKUP AND ML017-MARKUP                               04499699
044998       COMPUTE PV-LINE-MISSED-AMT =                               04499799
044999                 (ML017-PC-OLD-PR-AMT - ML017-PC-NEW-PR-AMT)      04499899
045000                    * ML017-PC-TOT-DOC-QTY                        04499999
045001       COMPUTE PV-TOTAL-MISSED-MU-AMT =                           04500099
045002                 PV-TOTAL-MISSED-MU-AMT + PV-LINE-MISSED-AMT      04500199
045003     END-IF.                                                      04500299
045004                                                                  04500399
045005     COMPUTE PV-TOTAL-NET-AMT =                                   04500499
045006               PV-TOTAL-MISSED-MD-AMT + PV-TOTAL-MISSED-MDC-AMT + 04500599
045007                 PV-TOTAL-MISSED-MU-AMT.                          04500699
045008                                                                  04500799
045009*4010-EXIT.                                                       04500899
045010 EJECT                                                            04500999
045011                                                                  04501099
045012*----------------------------------------------------------       04501199
045013* 4020-CREATE-EVEN-EXCHG-REC.                                     04501299
045014*----------------------------------------------------------       04501399
045015 4020-CREATE-EVEN-EXCHG-REC.                                      04501499
045016                                                                  04501599
045018     MOVE SA039-POS-DATE-YMD       TO PV-POS-DATE-YMD.            04501699
045019     MOVE SA039-STORE-NUMBER       TO PV-STORE-NUMBER.            04501799
045020     MOVE SA039-KOHLS-ACCT-MONTH   TO PV-ACCT-MONTH.              04501899
045021     MOVE SA039-TERMINAL-NUMBER    TO PV-TERMINAL-NUMBER.         04501999
045022     MOVE SA039-TRANSACTION-NUMBER TO PV-TRANSACTION-NUMBER.      04502099
045023     MOVE SA039-ITEM-SEQUENCE      TO PV-ITEM-SEQUENCE.           04502199
045024     MOVE PV-EXT-MISSED-RETURN-MD-AMT                             04502299
045025      TO PV-UNIT-EXT-MISSED-RI-MD-AMT.                            04502399
045026     MOVE PV-EXT-MISSED-RETURN-MDC-AMT                            04502499
045027      TO PV-UNIT-EXT-MISSED-RI-MDC-AMT.                           04502599
045028     MOVE PV-EXT-MISSED-SALE-MD-AMT                               04502699
045029      TO PV-UNIT-EXT-MISSED-SI-MD-AMT.                            04502799
045030     MOVE PV-EXT-MISSED-SALE-MU-AMT                               04502899
045031      TO PV-UNIT-EXT-MISSED-SI-MU-AMT.                            04502999
045044                                                                  04503099
045045     IF PS-SALE-SIDE                                              04504099
045046       MOVE SA039-SI-SKU             TO PV-SKU                    04504199
045047                                                                  04504299
045051       MOVE SA039-SI-DEPT-NBR        TO PV-DEPT-NBR               04504399
045052       MOVE SA039-SI-CLASS-NBR       TO PV-CLASS-NBR              04504499
045053       MOVE SA039-SI-MAJ-CLASS       TO PV-MAJ-CLASS              04504599
045058                                                                  04504699
045059       MOVE SA039-SI-STATUS-CODE     TO PV-STATUS-CODE            04504799
045060       MOVE SA039-SI-UNIT-QTY        TO PV-UNIT-QTY               04504899
045061       MOVE SA039-SI-UNIT-RETAIL-AMT TO PV-UNIT-RETAIL-AMT        04504999
045062                                                                  04505099
045063       MOVE SA039-SI-UNIT-CUST-CHARGED-AMT                        04506099
045064        TO PV-UNIT-CUST-CHARGED-AMT                               04506199
045065                                                                  04506299
045066       MOVE SA039-SI-UNIT-NET-AMT-CHARGED                         04506399
045067        TO PV-UNIT-NET-AMT-CHARGED                                04506499
045068                                                                  04506599
045069       MOVE SA039-SI-UNIT-OWNED-RETAIL-AMT                        04506699
045070        TO PV-UNIT-OWNED-RETAIL-AMT                               04506799
045071     END-IF.                                                      04506899
045072                                                                  04506999
045073     IF PS-RETURN-SIDE                                            04507099
045074       MOVE SA039-RI-SKU             TO PV-SKU                    04507199
045075                                                                  04507299
045076       MOVE SA039-RI-DEPT-NBR        TO PV-DEPT-NBR               04507399
045077       MOVE SA039-RI-CLASS-NBR       TO PV-CLASS-NBR              04507499
045078       MOVE SA039-RI-MAJ-CLASS       TO PV-MAJ-CLASS              04507599
045082                                                                  04507699
045083       MOVE SA039-RI-STATUS-CODE     TO PV-STATUS-CODE            04507799
045084       MOVE SA039-RI-UNIT-QTY        TO PV-UNIT-QTY               04507899
045085       MOVE SA039-RI-UNIT-RETAIL-AMT TO PV-UNIT-RETAIL-AMT        04507999
045086                                                                  04508099
045087       MOVE SA039-RI-UNIT-CUST-CHARGED-AMT                        04508199
045088        TO PV-UNIT-CUST-CHARGED-AMT                               04508299
045089                                                                  04508399
045090       MOVE SA039-RI-UNIT-NET-AMT-CHARGED                         04508499
045091        TO PV-UNIT-NET-AMT-CHARGED                                04508599
045092                                                                  04508699
045093       MOVE SA039-RI-UNIT-OWNED-RETAIL-AMT                        04508799
045094        TO PV-UNIT-OWNED-RETAIL-AMT                               04508899
045095     END-IF.                                                      04508999
045096                                                                  04509099
045097     PERFORM 8060-WRITE-EVEN-EXCHG-REC.                           04509199
045098                                                                  04509299
045099*4020-EXIT.                                                       04509399
045100 EJECT                                                            04509499
045101                                                                  04509599
045102*----------------------------------------------------------       04509699
045103* 8010-READ-EVEN-EX-FILE.                                         04509799
045104*----------------------------------------------------------       04509899
045105 8010-READ-EVEN-EX-FILE.                                          04509999
045106                                                                  04510099
045107     READ POS-SRTD-EVEN-EXCHG-FILE                                04510199
045108       INTO SA039-EVEN-EXCHNG-EXTR-RECORD.                        04510299
045109                                                                  04510399
045110     IF NOT SC-SRTD-EVEN-EXCHG-FILE-OK                            04510499
045111      AND NOT SC-SRTD-EVEN-EXCHG-FILE-EOF                         04510599
045112       DISPLAY ' '                                                04510699
045113       DISPLAY '** ABEND     **'                                  04510799
045114       DISPLAY '** PROGRAM   **  = ' PC-PROGRAM-NAME              04510899
045115       DISPLAY '** PARAGRAPH **'                                  04510999
045116        '= 8010-READ-EVEN-EX-FILE'                                04511099
045117       DISPLAY '** SORTED EVEN EXCHANGE OPEN ERROR'               04511199
045118       DISPLAY '** FILE STATUS IS = '                             04511299
045119        SC-SRTD-EVEN-EXCHG-FILE-STATUS                            04511399
045120       MOVE +4002 TO ABEND-CODE                                   04511499
045121       CALL 'ILBOABN0' USING ABEND-CODE                           04511599
045122     END-IF.                                                      04511699
045123                                                                  04511799
045124*8010-EXIT.                                                       04511899
045125 EJECT                                                            04511999
045126                                                                  04512099
045127*----------------------------------------------------------       04512199
045128* 8020-WRITE-PS-MARKDWN-REC.                                      04512299
045129*----------------------------------------------------------       04512399
045130 8020-WRITE-PS-MARKDWN-REC.                                       04512499
045131                                                                  04512599
045132     IF PV-KOHLS-ACCT-MONTH-X = PV-CC-FISCAL-ACCT-MONTH           04512699
045133       MOVE ML017-PRICE-CHANGE-RECORD                             04512799
045134         TO PS-EVEN-EX-MARKDWN-REC                                04512899
045135                                                                  04512999
045136       WRITE PS-EVEN-EX-MARKDWN-REC                               04513099
045137                                                                  04513199
045138       IF NOT SC-PS-MKDWN-FILE-OK                                 04513299
045139         DISPLAY ' '                                              04513399
045140         DISPLAY '** ABEND     **'                                04513499
045141         DISPLAY '** PROGRAM   **  = ' PC-PROGRAM-NAME            04513599
045142         DISPLAY '** PARAGRAPH **'                                04513699
045143          '= 8020-WRITE-PS-MARKDWN-REC'                           04513799
045144         DISPLAY '** INVALID WRITE ON PS MARKDOWN FILE'           04513899
045145         DISPLAY '** FILE STATUS IS = '                           04513999
045146          SC-PS-MKDWN-FILE-STATUS                                 04514099
045147         MOVE +4001 TO ABEND-CODE                                 04514199
045148         CALL 'ILBOABN0' USING ABEND-CODE                         04514299
045149       END-IF                                                     04514399
045150     END-IF.                                                      04514499
045151                                                                  04514599
045152     IF PV-KOHLS-ACCT-MONTH-X < PV-CC-FISCAL-ACCT-MONTH           04514699
045153       MOVE ML017-PRICE-CHANGE-RECORD                             04514799
045154         TO PS-EVEN-EX-MARKDWN-CUTOFF-REC                         04514899
045155                                                                  04514999
045156       WRITE PS-EVEN-EX-MARKDWN-CUTOFF-REC                        04515099
045157                                                                  04515199
045158       IF NOT SC-PS-MKDWN-CUTOFF-FILE-OK                          04515299
045159         DISPLAY ' '                                              04515399
045160         DISPLAY '** ABEND     **'                                04515499
045161         DISPLAY '** PROGRAM   **  = ' PC-PROGRAM-NAME            04515599
045162         DISPLAY '** PARAGRAPH **'                                04515699
045163          '= 8020-WRITE-PS-MARKDWN-REC'                           04515799
045164         DISPLAY '** INVALID WRITE ON PS MARKDOWN CUTOFF FILE'    04515899
045165         DISPLAY '** FILE STATUS IS = '                           04515999
045166          SC-PS-MKDWN-CUTOFF-FILE-STATUS                          04516099
045167         MOVE +4001 TO ABEND-CODE                                 04516199
045168         CALL 'ILBOABN0' USING ABEND-CODE                         04516299
045169       END-IF                                                     04516399
045170     END-IF.                                                      04516499
045171                                                                  04516599
045172*8020-EXIT.                                                       04516699
045173 EJECT                                                            04516799
045174                                                                  04516899
045175*----------------------------------------------------------       04516999
045176* 8030-WRITE-MW-MARKDWN-REC.                                      04517099
045177*----------------------------------------------------------       04517199
045178 8030-WRITE-MW-MARKDWN-REC.                                       04517299
045179                                                                  04517399
045180     IF PV-KOHLS-ACCT-MONTH-X = PV-CC-FISCAL-ACCT-MONTH           04517499
045181       MOVE ML017-PRICE-CHANGE-RECORD                             04517599
045182         TO MW-EVEN-EX-MARKDWN-REC                                04517699
045183                                                                  04517799
045184       WRITE MW-EVEN-EX-MARKDWN-REC                               04517899
045185                                                                  04517999
045186       IF NOT SC-MW-MKDWN-FILE-OK                                 04518099
045187         DISPLAY ' '                                              04518199
045188         DISPLAY '** ABEND     **'                                04518299
045189         DISPLAY '** PROGRAM   **  = ' PC-PROGRAM-NAME            04518399
045190         DISPLAY '** PARAGRAPH **'                                04518499
045191          '= 8030-WRITE-MW-MARKDWN-REC'                           04518599
045192         DISPLAY '** INVALID WRITE ON MW MARKDOWN FILE'           04518699
045193         DISPLAY '** FILE STATUS IS = '                           04518799
045194          SC-MW-MKDWN-FILE-STATUS                                 04518899
045195         MOVE +4001 TO ABEND-CODE                                 04518999
045196         CALL 'ILBOABN0' USING ABEND-CODE                         04519099
045197       END-IF                                                     04519199
045198     END-IF.                                                      04519299
045199                                                                  04519399
045200     IF PV-KOHLS-ACCT-MONTH-X < PV-CC-FISCAL-ACCT-MONTH           04519499
045201       MOVE ML017-PRICE-CHANGE-RECORD                             04519599
045202         TO MW-EVEN-EX-MARKDWN-CUTOFF-REC                         04519699
045203                                                                  04519799
045204       WRITE MW-EVEN-EX-MARKDWN-CUTOFF-REC                        04519899
045205                                                                  04519999
045206       IF NOT SC-MW-MKDWN-CUTOFF-FILE-OK                          04520099
045207         DISPLAY ' '                                              04520199
045208         DISPLAY '** ABEND     **'                                04520299
045209         DISPLAY '** PROGRAM   **  = ' PC-PROGRAM-NAME            04520399
045210         DISPLAY '** PARAGRAPH **'                                04520499
045211          '= 8030-WRITE-MW-MARKDWN-REC'                           04520599
045212         DISPLAY '** INVALID WRITE ON MW MARKDOWN CUTOFF FILE'    04520699
045213         DISPLAY '** FILE STATUS IS = '                           04520799
045214          SC-MW-MKDWN-CUTOFF-FILE-STATUS                          04520899
045215         MOVE +4001 TO ABEND-CODE                                 04520999
045216         CALL 'ILBOABN0' USING ABEND-CODE                         04521099
045217       END-IF                                                     04521199
045218     END-IF.                                                      04521299
045219                                                                  04521399
045220*8030-EXIT.                                                       04521499
045221 EJECT                                                            04521599
045222                                                                  04521699
045223*----------------------------------------------------------       04521799
045224* 8040-WRITE-PS-MARKUP-REC.                                       04521899
045225*----------------------------------------------------------       04521999
045226 8040-WRITE-PS-MARKUP-REC.                                        04522099
045227                                                                  04522199
045228     IF PV-KOHLS-ACCT-MONTH-X = PV-CC-FISCAL-ACCT-MONTH           04522299
045229       MOVE ML017-PRICE-CHANGE-RECORD                             04522399
045230         TO PS-EVEN-EX-MARKUP-REC                                 04522499
045231                                                                  04522599
045232       WRITE PS-EVEN-EX-MARKUP-REC                                04522699
045233                                                                  04522799
045234       IF NOT SC-PS-MKUP-FILE-OK                                  04522899
045235         DISPLAY ' '                                              04522999
045236         DISPLAY '** ABEND     **'                                04523099
045237         DISPLAY '** PROGRAM   **  = ' PC-PROGRAM-NAME            04523199
045238         DISPLAY '** PARAGRAPH **'                                04523299
045239          '= 8040-WRITE-PS-MARKUP-REC'                            04523399
045240         DISPLAY '** INVALID WRITE ON PS MARKUP FILE'             04523499
045241         DISPLAY '** FILE STATUS IS = '                           04523599
045242          SC-PS-MKUP-FILE-STATUS                                  04523699
045243         MOVE +4001 TO ABEND-CODE                                 04523799
045244         CALL 'ILBOABN0' USING ABEND-CODE                         04523899
045245       END-IF                                                     04523999
045246     END-IF.                                                      04524099
045247                                                                  04524199
045248     IF PV-KOHLS-ACCT-MONTH-X < PV-CC-FISCAL-ACCT-MONTH           04524299
045249       MOVE ML017-PRICE-CHANGE-RECORD                             04524399
045250         TO PS-EVEN-EX-MARKUP-CUTOFF-REC                          04524499
045251                                                                  04524599
045252       WRITE PS-EVEN-EX-MARKUP-CUTOFF-REC                         04524699
045253                                                                  04524799
045254       IF NOT SC-PS-MKUP-CUTOFF-FILE-OK                           04524899
045255         DISPLAY ' '                                              04524999
045256         DISPLAY '** ABEND     **'                                04525099
045257         DISPLAY '** PROGRAM   **  = ' PC-PROGRAM-NAME            04525199
045258         DISPLAY '** PARAGRAPH **'                                04525299
045259          '= 8040-WRITE-PS-MARKUP-REC'                            04525399
045260         DISPLAY '** INVALID WRITE ON PS MARKUP CUTOFF FILE'      04525499
045261         DISPLAY '** FILE STATUS IS = '                           04525599
045262          SC-PS-MKUP-CUTOFF-FILE-STATUS                           04525699
045263         MOVE +4001 TO ABEND-CODE                                 04525799
045264         CALL 'ILBOABN0' USING ABEND-CODE                         04525899
045265       END-IF                                                     04525999
045266     END-IF.                                                      04526099
045267                                                                  04526199
045268*8040-EXIT.                                                       04526299
045269 EJECT                                                            04526399
045270                                                                  04526499
045271*----------------------------------------------------------       04526599
045272* 8050-WRITE-MW-MARKUP-REC.                                       04526699
045273*----------------------------------------------------------       04526799
045274 8050-WRITE-MW-MARKUP-REC.                                        04526899
045275                                                                  04526999
045276     IF PV-KOHLS-ACCT-MONTH-X = PV-CC-FISCAL-ACCT-MONTH           04527099
045277       MOVE ML017-PRICE-CHANGE-RECORD                             04527199
045278         TO MW-EVEN-EX-MARKUP-REC                                 04527299
045279                                                                  04527399
045280       WRITE MW-EVEN-EX-MARKUP-REC                                04527499
045281                                                                  04527599
045282       IF NOT SC-MW-MKUP-FILE-OK                                  04527699
045283         DISPLAY ' '                                              04527799
045284         DISPLAY '** ABEND     **'                                04527899
045285         DISPLAY '** PROGRAM   **  = ' PC-PROGRAM-NAME            04527999
045286         DISPLAY '** PARAGRAPH **'                                04528099
045287          '= 8050-WRITE-MW-MARKUP-REC'                            04528199
045288         DISPLAY '** INVALID WRITE ON MW MARKUP FILE'             04528299
045289         DISPLAY '** FILE STATUS IS = '                           04528399
045290          SC-MW-MKUP-FILE-STATUS                                  04528499
045291         MOVE +4001 TO ABEND-CODE                                 04528599
045292         CALL 'ILBOABN0' USING ABEND-CODE                         04528699
045293       END-IF                                                     04528799
045294     END-IF.                                                      04528899
045295                                                                  04528999
045296     IF PV-KOHLS-ACCT-MONTH-X < PV-CC-FISCAL-ACCT-MONTH           04529099
045297       MOVE ML017-PRICE-CHANGE-RECORD                             04529199
045298         TO MW-EVEN-EX-MARKUP-CUTOFF-REC                          04529299
045299                                                                  04529399
045300       WRITE MW-EVEN-EX-MARKUP-CUTOFF-REC                         04529499
045301                                                                  04529599
045302       IF NOT SC-MW-MKUP-CUTOFF-FILE-OK                           04529699
045303         DISPLAY ' '                                              04529799
045304         DISPLAY '** ABEND     **'                                04529899
045305         DISPLAY '** PROGRAM   **  = ' PC-PROGRAM-NAME            04529999
045306         DISPLAY '** PARAGRAPH **'                                04530099
045307          '= 8050-WRITE-MW-MARKUP-REC'                            04530199
045308         DISPLAY '** INVALID WRITE ON MW MARKUP CUTOFF FILE'      04530299
045309         DISPLAY '** FILE STATUS IS = '                           04530399
045310          SC-MW-MKUP-CUTOFF-FILE-STATUS                           04530499
045311         MOVE +4001 TO ABEND-CODE                                 04530599
045312         CALL 'ILBOABN0' USING ABEND-CODE                         04530699
045313       END-IF                                                     04530799
045314     END-IF.                                                      04530899
045315                                                                  04530999
045316*8050-EXIT.                                                       04531099
045317 EJECT                                                            04531199
045318                                                                  04531299
045319*----------------------------------------------------------       04531399
045320* 8060-WRITE-EVEN-EXCHG-REC.                                      04531499
045321*----------------------------------------------------------       04531599
045322 8060-WRITE-EVEN-EXCHG-REC.                                       04531699
045323                                                                  04531799
045324     IF PS-SALE-SIDE                                              04531899
045325       MOVE PV-SALES-OR-RETURNS-LAYOUT                            04531999
045326        TO PV-EVEN-EXCHG-SALES-REC                                04532099
045327       WRITE PV-EVEN-EXCHG-SALES-REC                              04532199
045328     ELSE                                                         04532299
045329       MOVE PV-SALES-OR-RETURNS-LAYOUT                            04532399
045330        TO PV-EVEN-EXCHG-RTRNS-REC                                04532499
045331       WRITE PV-EVEN-EXCHG-RTRNS-REC                              04532599
045332     END-IF.                                                      04532699
045333                                                                  04532799
045334     IF NOT SC-MISSED-EX-SALES-FILE-OK                            04532899
045335      OR NOT SC-MISSED-EX-RTRNS-FILE-OK                           04532999
045336        DISPLAY ' '                                               04533099
045337        DISPLAY '** ABEND     **'                                 04533199
045338        DISPLAY '** PROGRAM   **  = ' PC-PROGRAM-NAME             04533299
045339        DISPLAY '** PARAGRAPH **'                                 04533399
045340         '= 8060-WRITE-EVEN-EXCHG-REC'                            04533499
045341        DISPLAY '** INVALID WRITE ON EVEN EXCHG REC'              04533599
045342        IF PS-SALE-SIDE                                           04533699
045343          DISPLAY '** FILE STATUS IS = '                          04533799
045344           SC-MISSED-EX-SALES-FILE-STATUS                         04533899
045345        ELSE                                                      04533999
045346          DISPLAY '** FILE STATUS IS = '                          04534099
045347           SC-MISSED-EX-RTRNS-FILE-STATUS                         04534199
045348        END-IF                                                    04534299
045349        MOVE +4001 TO ABEND-CODE                                  04534399
045350        CALL 'ILBOABN0' USING ABEND-CODE                          04534499
045351     END-IF.                                                      04534599
045352                                                                  04534699
045353*8060-EXIT.                                                       04534799
045354 EJECT                                                            04534899
045355                                                                  04534999
045356*----------------------------------------------------------       04535099
045357* 9999-CLOSE-FILES.                                               04535199
045358*----------------------------------------------------------       04535299
045359 9999-CLOSE-FILES.                                                04535399
045360                                                                  04535499
045361     CLOSE POS-SRTD-EVEN-EXCHG-FILE                               04535599
045362           POS-DATE-FILE                                          04535699
045363           PS-EVEN-EX-MARKDWN-FILE                                04535799
045364           PS-EVEN-EX-MARKUP-FILE                                 04535899
045365           MW-EVEN-EX-MARKDWN-FILE                                04535999
045366           MW-EVEN-EX-MARKUP-FILE                                 04536099
045367           PS-EVEN-EX-MARKDWN-CUTOFF-FILE                         04536199
045368           PS-EVEN-EX-MARKUP-CUTOFF-FILE                          04536299
045369           MW-EVEN-EX-MARKDWN-CUTOFF-FILE                         04536399
045370           MW-EVEN-EX-MARKUP-CUTOFF-FILE                          04536499
045371           MISSED-EVEN-EXCHG-SALES-FILE                           04536599
045380           MISSED-EVEN-EXCHG-RTRNS-FILE.                          04536699
045400                                                                  04536799
045700*9999-EXIT.                                                       04536899
045800 EJECT                                                            04536999
