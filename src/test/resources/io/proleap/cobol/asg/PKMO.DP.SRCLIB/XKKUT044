      ******************************************************************        
       IDENTIFICATION DIVISION.                                                 
       PROGRAM-ID.             XKKUT044.                                        
       AUTHOR.                 COLLEEN CUMMINGS.                                
       INSTALLATION.           KOHLS DEPARTMENT STORES.                         
       DATE-WRITTEN.           JANUARY 2005.                                    
       DATE-COMPILED.                                                           
      ******************************************************************        
      *                                                                *        
      *    XKKUT044 -                                                  *        
      *                                                                *        
      *    THIS PROGRAM TURNS RI BACK ON AFTER CERTAIN XK TABLES ARE   *        
      *    RELOADED (SPECIFICALLY WRITTEN TO WAIT UNTIL XKT_SUB_CL     *        
      *    IS RELOADED).                                               *        
      *    THIS WAS NEEDED BECAUSE XKKUT031 TURNS RI OFF, TRUNCATES    *        
      *    ALL TABLES BEING RELOADED, AND USED TO TURN RI BACK ON      *        
      *    AGAIN AFTER THE TRUNCATES WERE DONE.                        *        
      *    BUT WITH XK MESSAGING PUT IN FOR XKT_VND_STYL, XKT_SKU,     *        
      *    XKT_SKU_LOC, XKT_UPC - THESE TABLES AREN'T RELOADED         *        
      *    ANYMORE - SO THE RI TURN ON WOULD FAIL BECAUSE THESE TABLES *        
      *    WON'T HAVE PARENTS WHEN XKT_SUB_CL IS TRUNCATED, ETC.       *        
      *    THEREFORE, THIS PROGRAM WILL TURN RI BACK ON AFTER          *        
      *    XKT_SUB_CL IS RELOADED INSTEAD.                             *        
      ******************************************************************        
      **   CHANGE LOG:                                                 *        
      ******************************************************************        
      *    XX/XX/XXXX - XXXXXXXXXXXXXXXX - WRXXXXX                     *        
      *                                                                *        
      ******************************************************************        
      ******************************************************************        
       ENVIRONMENT DIVISION.                                                    
       CONFIGURATION SECTION.                                                   
       SOURCE-COMPUTER. IBM-3090.                                               
       OBJECT-COMPUTER. IBM-3090.                                               
                                                                                
       INPUT-OUTPUT SECTION.                                                    
       FILE-CONTROL.                                                            
                                                                                
       DATA DIVISION.                                                           
                                                                                
       FILE SECTION.                                                            
                                                                                
       WORKING-STORAGE SECTION.                                                 
                                                                                
       01  ABEND-CODE                       PIC S9(04)   COMP VALUE +0.         
           88  ABEND-4001-WRITE-ERROR                    VALUE +4001.           
           88  ABEND-4002-READ-ERROR                     VALUE +4002.           
           88  ABEND-4003-CTRL-CARD-ERROR                VALUE +4003.           
           88  ABEND-4004-TABLE-ERROR                    VALUE +4004.           
           88  ABEND-4005-OPEN-ERROR                     VALUE +4005.           
           88  ABEND-4006-CLOSE-ERROR                    VALUE +4006.           
           88  ABEND-4007-SEQUENCE-ERROR                 VALUE +4007.           
           88  ABEND-4008-DATA-ERROR                     VALUE +4008.           
           88  ABEND-4009-KEY-DATA-ERROR                 VALUE +4009.           
           88  ABEND-4013-DB2-ERROR                      VALUE +4013.           
           88  ABEND-4014-ORACLE-LOGON-ERROR             VALUE +4014.           
           88  ABEND-4019-DATE-ROUTINE-ERROR             VALUE +4019.           
           88  ABEND-4444-FORCED-ABEND                   VALUE +4444.           
                                                                                
       01  PS-PROGRAM-SWITCHES.                                                 
           05  PS-END-OF-INPUT-FILE-SW      PIC X(01)   VALUE 'N'.              
               88  PS-END-OF-INPUT-FILE                 VALUE 'Y'.              
               88  PS-NOT-END-OF-INPUT-FILE             VALUE 'N'.              
                                                                                
       01  PC-PROGRAM-CONSTANTS.                                                
           05  PC-CURRENT-PROGRAM-NAME      PIC  X(08)  VALUE                   
                                                           'XKKUT044'.          
                                                                                
       01  PV-PROGRAM-VARIABLES.                                                
           05  PV-SQL                       PIC S9(04)  VALUE ZEROS.            
           05  PV-TABLE-NAME                PIC  X(12)  VALUE SPACES.           
           05  PV-OPERATION-MSG             PIC  X(60)  VALUE SPACES.           
           05  PV-OPERATION-MSG-1           PIC  X(40)  VALUE SPACES.           
           05  PV-PARAGRAPH-NAME            PIC  X(30)  VALUE SPACES.           
                                                                                
       01  PA-PROGRAM-ACCUMULATORS.                                             
           05  PA-RECORDS-READ            PIC 9(09)   VALUE ZEROS.              
           05  PA-RECORDS-INSERTED        PIC 9(09)   VALUE ZEROS.              
                                                                                
      ******************************************************************        
      *    COPYBOOK FOR THE HIERARCHY                                           
      ******************************************************************        
           COPY HMRD014.                                                        
                                                                                
      *****************************************************************         
      *                      O  R  A  C  L  E                                   
      *================================================================         
      * ORACLE DECLARE SECTION                                                  
      * ORACLE USED AND RETURNED VARIABLES                                      
      *****************************************************************         
           EXEC SQL BEGIN DECLARE SECTION END-EXEC.                             
                                                                                
      *---------------------------------------------------------------*         
      * ORACLE LOGON WORKING STORAGE COPYBOOK                                   
      *---------------------------------------------------------------*         
       01      PC-ENT01-TYPE-CDE          PIC X(02)      VALUE '01'.            
       01      PV-ORACLE-ID               PIC X(1)       VALUE '/'.             
                                                                                
       01      USERNAME                   PIC X(10)      VARYING.               
       01      PASSWD                     PIC X(10)      VARYING.               
                                                                                
       01      ORACLE-RETURN              PIC X(200)     VALUE SPACES.          
                                                                                
           EXEC SQL END DECLARE SECTION END-EXEC.                               
           EXEC SQL INCLUDE SQLCACOB    END-EXEC.                               
                                                                                
      ********************                                                      
       EJECT                                                                    
      ********************                                                      
       PROCEDURE DIVISION.                                                      
      ********************                                                      
      *****************************************************************         
      * A100-MAINLINE.                                                *         
      * ==> PROCESSES:                                                *         
      *  - SET UP ORACLE                                              *         
      *  - CLOSE FILES                                                *         
      * ==> PERFORMED FROM: START                                     *         
      *****************************************************************         
       A100-MAINLINE.                                                           
                                                                                
           PERFORM PM700-A000-ORACLE-SETUP.                                     
                                                                                
           DISPLAY 'RESTORING RI.'                                              
           PERFORM B200-RESTORE-RI.                                             
                                                                                
           DISPLAY 'DONE RESTORING RI.'                                         
                                                                                
           STOP RUN.                                                            
                                                                                
      *****************************************************************         
      * B200-RESTORE-RI                                               *         
      * ==> PROCESSES:                                                *         
      *  - RESTORE RI ON ALL XK TABLES                                *         
      * ==> SQLCODE:                                                  *         
      *  - 0 = ENABLE WAS SUCCESSFUL                                  *         
      * ==> PERFORMED FROM: A100-MAINLINE                             *         
      *****************************************************************         
       B200-RESTORE-RI.                                                         
                                                                                
           EXEC SQL EXECUTE                                                     
             BEGIN                                                              
               XKSP_RI('ENABLE');                                               
             END;                                                               
           END-EXEC.                                                            
                                                                                
           EVALUATE TRUE                                                        
             WHEN SQLCODE = ZERO                                                
                CONTINUE                                                        
             WHEN OTHER                                                         
               MOVE SQLCODE               TO PV-SQL                             
               MOVE 'XK TABLES'           TO PV-TABLE-NAME                      
               MOVE 'B200-RESTORE-RI'     TO PV-PARAGRAPH-NAME                  
               PERFORM Z100-ABEND                                               
           END-EVALUATE.                                                        
                                                                                
      ******************************************************************        
      * THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION THAT     *        
      * LOGONS TO ORACLE.                                              *        
      ******************************************************************        
           COPY XKPD700.                                                        
                                                                                
      *****************************************************************         
      * Z100-ABEND.                                                   *         
      *  - PERFORM AN ABEND THAT OCCURED RELATED TO ORACLE            *         
      *****************************************************************         
       Z100-ABEND.                                                              
                                                                                
           DISPLAY '                       '.                                   
           DISPLAY '** ABEND **       ** = SQLERROR'.                           
           DISPLAY '** PROGRAM        ** = ' PC-CURRENT-PROGRAM-NAME.           
           DISPLAY '** SQLCODE        ** = ' SQLCODE.                           
           DISPLAY '** ABEND CODE     ** = ' ABEND-CODE.                        
           DISPLAY '** SQLERRM        ** = ' SQLERRM.                           
           DISPLAY '** SQLERRMC       ** = ' SQLERRMC.                          
           DISPLAY '** SQLERRD(5)     ** = ' SQLERRD(5).                        
           DISPLAY '** PARAGRAPH      ** = ' PV-PARAGRAPH-NAME.                 
           DISPLAY '** TABLE          ** = ' PV-TABLE-NAME.                     
           DISPLAY '** OPERATION      ** = ' PV-OPERATION-MSG.                  
           DISPLAY '                       '.                                   
                                                                                
           CALL 'ILBOABN0' USING ABEND-CODE.                                    
                                                                                
      ******************************************************************        
      * Z910-ABEND - PERFORMS A NON-SQL-ABEND                          *        
      ******************************************************************        
       Z910-ABEND.                                                              
                                                                                
           DISPLAY '** ABEND           **'.                                     
           DISPLAY '** PROGRAM         ** = ' PC-CURRENT-PROGRAM-NAME.          
           DISPLAY '** PARAGRAPH       ** = ' PV-PARAGRAPH-NAME.                
           DISPLAY '** OPERATION       ** = ' PV-OPERATION-MSG.                 
           DISPLAY '**                 ** = ' PV-OPERATION-MSG-1.               
                                                                                
           CALL 'ILBOABN0' USING ABEND-CODE.                                    
