000100 IDENTIFICATION DIVISION.                                         00010002
000200                                                                  00020002
000300 PROGRAM-ID.      SVKUP086.                                       00030035
000400 AUTHOR.          JOE GARDETTO.                                   00040024
000500 INSTALLATION.    KOHLS DEPARTMENT STORES.                        00050002
000600 DATE-WRITTEN.    03/17/14.                                       00060041
000700 DATE-COMPILED.                                                   00070002
000800                                                                  00080002
000900******************************************************************00090002
001000*  MODULE TYPE:   COBOL2 DB2 BATCH.                               00100002
001100*                                                                 00110002
001100*  THIS PROGRAM WILL UPDATE SVT_KOHLS_CRD_TXN USING THE           00120042
001100*  FILE CREATED BY SVKUT102.                                      00130043
001100*                                                                 00132022
001500*========================== CHANGE LOG ===========================00150002
001600*  AUTH        BY            DATE                 DESCRIPTION     00160002
001700*=================================================================00170002
002000* CHG0077708 JOE GARDETTO 03-17-14   WR42471 - NEW PROGRAM.       00181041
260107* CHG0260107 JIM HUNTER   08-19-21   ADD COPYBOOK DPWS991 TO      00182047
260107*                                    MAKE DPKUT901 CALL DYNAMIC.  00183047
002000******************************************************************00200002
002100                                                                  00210002
002200 ENVIRONMENT DIVISION.                                            00220002
002300 CONFIGURATION SECTION.                                           00230002
002400                                                                  00240002
002500 SOURCE-COMPUTER.    IBM-3090.                                    00250002
002600 OBJECT-COMPUTER.    IBM-3090.                                    00260002
002700                                                                  00270002
002800 INPUT-OUTPUT SECTION.                                            00280002
002900 FILE-CONTROL.                                                    00290002
003000                                                                  00300002
003100 DATA DIVISION.                                                   00310002
003200 FILE SECTION.                                                    00320002
003300                                                                  00330002
003400                                                                  00340002
003500***************************************************************** 00350002
003600*                       WORKING STORAGE                           00360002
003700***************************************************************** 00370002
003800 WORKING-STORAGE SECTION.                                         00380002
003900                                                                  00390002
004000 01  W-START                          PIC  X(40)                  00400002
004100     VALUE 'SVKUP086 - WORKING STORAGE BEGINS HERE'.              00410035
004300                                                                  00430002
004400***************************************************************** 00440002
004500*                         SWITCHES                                00450002
004600***************************************************************** 00460002
004700 01  PROGRAM-SWITCHES.                                            00470002
004800     05  PS-RESTART-REQUIRED-SW       PIC  X(01) VALUE 'N'.       00480002
004900         88  PS-RESTART-REQUIRED                 VALUE 'Y'.       00490002
005000         88  PS-RESTART-NOT-REQUIRED             VALUE 'N'.       00500002
005100                                                                  00510002
005200******************************************************************00520002
005300*                       ACCUMULATORS                              00530002
005400******************************************************************00540002
005500 01  PROGRAM-ACCUM.                                               00550002
005600     05  PA-READ                      PIC  9(11) VALUE ZEROS.     00560002
005700     05  PA-CKPT                      PIC  9(11) VALUE ZEROS.     00570002
005800                                                                  00580002
005900******************************************************************00590002
006000*                           CONSTANTS                             00600002
006100******************************************************************00610002
006200 01  PROGRAM-CONSTANTS.                                           00620002
006300     05  PC-MAX-RETRIES               PIC S9(04) VALUE +3         00630002
006400                                                 COMP SYNC.       00640002
006500     05  PC-MAX-DEADLOCKS             PIC S9(04) VALUE +3         00650002
006600                                                 COMP SYNC.       00660002
006700                                                                  00670002
006800     05  PC-CKPT-JOB-NAME             PIC  X(08) VALUE 'SVK904  '.00680036
006900     05  PC-CKPT-PLAN-NAME            PIC  X(08) VALUE 'SVKUP086'.00690035
007000     05  PC-PROGRAM-NAME              PIC  X(08) VALUE 'SVKUP086'.00700035
007100                                                                  00710002
007200     05  PC-TRAN-PRES-FUNC-CODES.                                 00720002
007300         10  PC-TRAN-PRES-FUNC-OPEN   PIC  X(05) VALUE 'OPEN '.   00730002
007400         10  PC-TRAN-PRES-FUNC-TRANS  PIC  X(05) VALUE 'TRANS'.   00740002
007500         10  PC-TRAN-PRES-FUNC-RSTRT  PIC  X(05) VALUE 'RSTRT'.   00750002
007600         10  PC-TRAN-PRES-FUNC-CLOSE  PIC  X(05) VALUE 'CLOSE'.   00760002
007700                                                                  00770002
007800     05  PC-MINUS-ONE                 PIC S9(01) VALUE -1.        00780002
007900     05  PC-SYSTEM                    PIC  X(08) VALUE 'SYSTEM  '.00790002
009100     05  PC-ACTVY-STAT-VERIFIED       PIC  S9(1)V COMP-3 VALUE 3. 00791044
009100     05  PC-APVL-USR-ID               PIC   X(6) VALUE 'TNDRFX'.  00793046
008000                                                                  00800002
008100******************************************************************00810002
008200*                          VARIABLES                              00820002
008300******************************************************************00830002
008400 01  PROGRAM-VARIABLES.                                           00840002
008500     05  PV-SQL-SUB                   PIC  9(03) VALUE ZERO.      00850002
008600     05  PV-DEADLOCK-COUNTER          PIC  9(03) VALUE ZERO.      00860002
008700     05  PV-RETRY-CNT                 PIC  9(03) VALUE ZERO.      00870003
008800     05  PV-PARAGRAPH-NAME            PIC  X(30) VALUE SPACE.     00880002
008900     05  PV-DB2-OPER-ATTEMPTED        PIC  X(30) VALUE SPACE.     00890002
009000     05  PV-OPERATION-MSG             PIC  X(35) VALUE SPACE.     00900002
009100     05  PV-RET-CODE                  PIC  9(04) VALUE ZEROS.     00910002
009300******************************************************************00930002
009400*               SYSTEM TIME AND DATE VARIABLES                    00940002
009500******************************************************************00950002
009600 01  SYS-DATE-TIME.                                               00960002
009700     05  SYS-DATE                     PIC  X(08) VALUE SPACES.    00970002
009800     05  SYS-TIME                     PIC  X(08) VALUE SPACES.    00980002
009900                                                                  00990002
010000 01  ST-BEG-TIME.                                                 01000002
010100     05  ST-BEG-HR                    PIC  9(02) VALUE ZEROS.     01010002
010200     05  FILLER                       PIC  X(01) VALUE ':'.       01020002
010300     05  ST-BEG-MN                    PIC  9(02) VALUE ZEROS.     01030002
010400                                                                  01040002
010500 01  ST-END-TIME.                                                 01050002
010600     05  ST-END-HR                    PIC  9(02) VALUE ZEROS.     01060002
010700     05  FILLER                       PIC  X(01) VALUE ':'.       01070002
010800     05  ST-END-MN                    PIC  9(02) VALUE ZEROS.     01080002
010900                                                                  01090002
011000 01  SD-EDIT-DATE.                                                01100002
011100     05  SD-MONTH                     PIC  9(02) VALUE ZEROS.     01110002
011200     05  FILLER                       PIC  X(01) VALUE '-'.       01120002
011300     05  SD-DAY                       PIC  9(02) VALUE ZEROS.     01130002
011400     05  FILLER                       PIC  X(01) VALUE '-'.       01140002
011500     05  SD-CENT                      PIC  9(02) VALUE ZEROS.     01150002
011600     05  SD-YEAR                      PIC  9(02) VALUE ZEROS.     01160002
011700                                                                  01170002
011800******************************************************************01180002
011900*                        ERROR HANDLING                           01190002
012000******************************************************************01200002
012100 01  ABEND-CODE                       PIC S9(04) VALUE ZEROS      01210002
012200                                                 COMP SYNC.       01220002
012400     88  ABEND-4013-DB2-ERROR                    VALUE +4013.     01240002
015000     88  ABEND-4444-FORCED-ABEND                 VALUE +4444.     01241022
012600                                                                  01260002
012700                                                                  01270002
012800******************************************************************01280002
012900*  SV CARD EXTRACT OUTPUT RECORD                                  01290037
013000******************************************************************01300002
018500     COPY SVRD074.                                                01312037
013200                                                                  01320002
013300******************************************************************01330002
013400*  DB2 FORMATTED ERROR MESSAGE                                    01340002
013500******************************************************************01350002
013600     COPY DPWS004.                                                01360002
013700                                                                  01370002
013800******************************************************************01380002
013900*  SQL COMMUNICATIONS WORK AREA                                   01390002
014000******************************************************************01400002
014100     COPY SQLCA2.                                                 01410002
014200                                                                  01420002
014300******************************************************************01430002
014400*  COMMUNICATIONS AREA FOR DB2                                    01440002
014500******************************************************************01450002
014600     EXEC SQL                                                     01460002
014700         INCLUDE SQLCA                                            01470002
014800     END-EXEC.                                                    01480002
014900                                                                  01490002
043500******************************************************************01555038
043600*    RD-KOHL'S STORED VALUE CARD ACTIVITY TABLE                  *01556038
043700******************************************************************01557038
043800     EXEC SQL                                                     01558038
043900         INCLUDE SVT00002                                         01559038
044000     END-EXEC.                                                    01559138
015600                                                                  01560002
015700                                                                  01570002
015800******************************************************************01580002
015900*  TRANSACTION PREPARATION MODULE COMMUNICATIONS AREA             01590002
016000******************************************************************01600002
260107     COPY DPWS991.                                                01610047
016100                                                                  01611047
016100     COPY DPLS001.                                                01612047
016200     05  WORK-STORAGE-PASSED.                                     01620002
016300******************************************************************01630002
016400*PA - PROGRAM ACCUMULATORS                                        01640002
016500******************************************************************01650002
016600         10  PROGRAM-ACCUMULATORS.                                01660002
016700             15  PA-ROWS-DELETE   PIC S9(11)           VALUE ZERO 01670002
016800                                                       COMP-3.    01680002
016700             15  PA-ROWS-DUPL     PIC S9(11)           VALUE ZERO 01681007
016800                                                       COMP-3.    01682007
016900                                                                  01690002
017000 01  FILLER                          PIC X(4096)  VALUE SPACE.    01700002
017100                                                                  01710002
017200                                                                  01720002
017300                                                                  01730002
017400 PROCEDURE DIVISION.                                              01740002
017500******************************************************************01750002
017600* MAINLINE-PROCESSING                                             01760002
017700******************************************************************01770002
017800                                                                  01780002
017900     PERFORM A100-INITIALIZE.                                     01790002
018000                                                                  01800002
018100     PERFORM B100-PROCESS-RECORDS                                 01810002
018200       UNTIL DP001-PREP-TRANS-EOF.                                01820002
018300                                                                  01830002
018400     PERFORM Z990-EOJ-ROUTINE.                                    01840002
018500                                                                  01850002
018600     GOBACK.                                                      01860002
018700                                                                  01870002
018800                                                                  01880002
018900******************************************************************01890002
019000* PREFORMS TASK INITIATION                                        01900002
019100******************************************************************01910002
019200 A100-INITIALIZE.                                                 01920002
019300                                                                  01930002
019400     MOVE FUNCTION CURRENT-DATE TO SYS-DATE-TIME.                 01940002
019500                                                                  01950002
019600     MOVE SYS-TIME (1:2) TO ST-BEG-HR.                            01960002
019700     MOVE SYS-TIME (3:2) TO ST-BEG-MN.                            01970002
019800                                                                  01980002
019900     MOVE SYS-DATE (1:2) TO SD-CENT.                              01990002
020000     MOVE SYS-DATE (3:2) TO SD-YEAR.                              02000002
020100     MOVE SYS-DATE (5:2) TO SD-MONTH.                             02010002
020200     MOVE SYS-DATE (7:2) TO SD-DAY.                               02020002
020300                                                                  02030002
020600     MOVE PC-TRAN-PRES-FUNC-OPEN TO DP001-FUNC-CODE.              02060002
020700                                                                  02070002
020800     PERFORM X100-BUILD-COMM-AREA-TRAN-PRES.                      02080002
020900                                                                  02090002
021000                                                                  02100002
025400******************************************************************02540002
025500* PROCESS RECORDS                                                 02550002
025600******************************************************************02560002
025700 B100-PROCESS-RECORDS.                                            02570002
025800                                                                  02580002
025900     SET PS-RESTART-NOT-REQUIRED TO TRUE.                         02590002
026000                                                                  02600002
026100     PERFORM C100-UPDATE-RECS.                                    02610038
026200                                                                  02620002
026300*----------------------------------------------------------------*02630002
026400*  IF A RESTART IS REQUIRED, ISSUE A RESTART CALL RATHER THAN A  *02640002
026500*  TRANS CALL.  THIS WILL ALLOW PROCESSING TO RESUME WITH THE    *02650002
026600*  FIRST TRANSACTION AFTER THE LAST COMMIT.                      *02660002
026700*----------------------------------------------------------------*02670002
026800     IF  PS-RESTART-REQUIRED                                      02680002
026900         MOVE PC-TRAN-PRES-FUNC-RSTRT TO DP001-FUNC-CODE          02690002
027000     ELSE                                                         02700002
027100         MOVE PC-TRAN-PRES-FUNC-TRANS TO DP001-FUNC-CODE          02710002
027200     END-IF.                                                      02720002
027300                                                                  02730002
027400     PERFORM X100-BUILD-COMM-AREA-TRAN-PRES.                      02740002
027500                                                                  02750002
027600     ADD 1 TO PA-READ.                                            02760002
027700                                                                  02770002
027800                                                                  02780002
027900******************************************************************02911038
028000* UPDATE RECORDS                                                  02912038
028100******************************************************************02913038
028200 C100-UPDATE-RECS.                                                02914038
028300                                                                  02915038
           MOVE SVRD074-CRD-NBR        TO SVT00002-CRD-NBR.             02918146
           MOVE SVRD074-TRN-AUTH-TMST  TO SVT00002-TRN-AUTH-TMST.       02918246
           MOVE PC-ACTVY-STAT-VERIFIED TO SVT00002-ACTVY-TYP-CDE.       02918346
           MOVE PC-APVL-USR-ID         TO SVT00002-APVL-USR-ID.         02918446
           MOVE SVRD074-ACTVY-STAT-CDE TO SVT00002-APVL-USR-ID(7:1).    02918546
028800                                                                  02919038
028900     PERFORM C200-UPDATE.                                         02919139
029000                                                                  02919238
029100                                                                  02919338
029200******************************************************************03651039
029300* UPDATE SVT_KOHLS_CRD_TXN                                        03652040
029400******************************************************************03653039
029500 C200-UPDATE.                                                     03654039
029600                                                                  03655039
029700     PERFORM WITH TEST AFTER                                      03656039
029800         VARYING PV-SQL-SUB                                       03657039
029900         FROM 1 BY 1                                              03658039
030000         UNTIL (PV-SQL-SUB > PC-MAX-RETRIES                       03659039
030100                OR SQLCODE = +100                                 03659139
030200                OR SQLCODE = 0)                                   03659239
030300                                                                  03659339
030400         EXEC SQL                                                 03659439
                   UPDATE SVT_KOHLS_CRD_TXN                             03660140
                     SET ACTVY_STAT_CDE = :SVT00002-ACTVY-TYP-CDE       03660245
                       , APVL_USR_ID    = :SVT00002-APVL-USR-ID         03660345
                       , TRN_PSTD_TMST  = CURRENT TIMESTAMP             03660444
                   WHERE CRD_NBR       = :SVT00002-CRD-NBR              03660540
                     AND TRN_AUTH_TMST = :SVT00002-TRN-AUTH-TMST        03660640
031300         END-EXEC                                                 03661439
031400                                                                  03661539
031500         EVALUATE TRUE                                            03661639
031600             WHEN SQLCODE = 0                                     03661739
031700                 ADD SQLERRD(3) TO PA-ROWS-DELETE                 03661839
031800                                                                  03661939
031800             WHEN SQLCODE = +100                                  03662039
031700                 ADD +1 TO PA-ROWS-DUPL                           03662139
031800                                                                  03662239
031900             WHEN SQLCODE = -904                                  03662339
032000             WHEN SQLCODE = -911                                  03662439
032100                 ADD +1 TO PV-DEADLOCK-COUNTER                    03662539
032200                                                                  03662639
032300                 DISPLAY '                   '                    03662739
032400                 DISPLAY 'DEADLOCK INCOUNTERED -911'              03662839
032500                 DISPLAY 'DEADLOCK-COUNTER = ' PV-DEADLOCK-COUNTER03662939
032600                                                                  03663039
032700                 IF PV-DEADLOCK-COUNTER > PC-MAX-DEADLOCKS        03663139
032800                     MOVE 'C200-UPDATE'                           03663240
032900                                      TO PV-PARAGRAPH-NAME        03663339
033000                     MOVE 'MAXIMUM DEADLOCKS EXCEEDED    '        03663439
033100                                      TO PV-DB2-OPER-ATTEMPTED    03663539
033200                     PERFORM Z200-SQL-ABEND                       03663639
033300                                                                  03663739
033400                 ELSE                                             03663839
033500                     SET PS-RESTART-REQUIRED TO TRUE              03663939
033600                 END-IF                                           03664039
033700                                                                  03664139
033800             WHEN OTHER                                           03664239
033900                 DISPLAY '                   '                    03664339
034000                 DISPLAY 'SQLCODE = ' SQLCODE                     03664439
034100                 DISPLAY 'DP001-FUNC-CODE = ' DP001-FUNC-CODE     03664539
034200                 DISPLAY 'DP001-RET-CODE  = ' DP001-RET-CODE      03664639
034300                 DISPLAY '                   '                    03664739
034400                 DISPLAY 'UPDATE ABENDED ON: '                    03664840
034500                 DISPLAY 'CRD_NBR       = ' SVT00002-CRD-NBR      03664940
034600                 DISPLAY 'TRN_AUTH_TMST = ' SVT00002-TRN-AUTH-TMST03665040
035000                 MOVE 'C200-UPDATE'                               03665440
035100                                        TO PV-PARAGRAPH-NAME      03665539
035200                 MOVE 'SVT_KOHLS_CRD_TXN UPDATE'                  03665640
035300                                        TO PV-DB2-OPER-ATTEMPTED  03665739
035400                                                                  03665839
035500                 PERFORM Z200-SQL-ABEND                           03665939
035600         END-EVALUATE                                             03666039
035700     END-PERFORM.                                                 03666139
035800                                                                  03666239
035900     IF PV-SQL-SUB > PC-MAX-RETRIES                               03666339
036000         MOVE 'C200-UPDATE'            TO PV-PARAGRAPH-NAME       03666440
036100         MOVE 'VERIFY RETRIES EXCEEDED' TO PV-DB2-OPER-ATTEMPTED  03666539
036200         PERFORM Z200-SQL-ABEND                                   03666639
036300     END-IF.                                                      03666739
036400                                                                  03666839
036500                                                                  03666940
036600******************************************************************03667039
036700* BUILD THE COMMUNICATION AREA FOR A CALL TO THE TRANSACTION      03670002
036800* PRESENTATION MODULE                                             03680002
036900******************************************************************03690002
037000 X100-BUILD-COMM-AREA-TRAN-PRES.                                  03700002
037100                                                                  03710002
037200     MOVE LENGTH OF                                               03720002
037300          WORK-STORAGE-PASSED TO DP001-WORK-STRG-LENGTH.          03730002
037400     MOVE PC-CKPT-JOB-NAME    TO DP001-JOB-NAME.                  03740002
037500     MOVE PC-CKPT-PLAN-NAME   TO DP001-PLAN-NAME.                 03750002
037600                                                                  03760002
037700     PERFORM X200-CALL-TRANS-PRES-MODULE.                         03770002
037800                                                                  03780002
037900     MOVE DP001-TRANS-RECORD  TO SVRD074-SVCRD-REC.               03790040
038000                                                                  03800002
038100     IF  DP001-CKPT-TAKEN                                         03810002
038200         ADD 1 TO PA-CKPT                                         03820002
038300                                                                  03830002
038400         INITIALIZE PV-DEADLOCK-COUNTER                           03840002
038500     END-IF.                                                      03850002
038600                                                                  03860002
038700                                                                  03870002
038800******************************************************************03880002
038900* VERIFY THE RETURN CODE ON THE CALLED MODULE                     03890002
039000******************************************************************03900002
039100 X200-CALL-TRANS-PRES-MODULE.                                     03910002
039200                                                                  03920002
039300     PERFORM Z900-CALL-TRANS-PRES-MODULE.                         03930002
039400                                                                  03940002
039500     IF  DP001-GOOD-RET-CODE                                      03950002
039600     OR  DP001-CKPT-TAKEN                                         03960002
039700     OR  DP001-RESTART                                            03970002
039800         CONTINUE                                                 03980002
039900                                                                  03990002
040000     ELSE                                                         04000002
040100         MOVE 'X200-CALL-TRANS-PRES-MODULE' TO PV-PARAGRAPH-NAME  04010002
040200         MOVE '** BAD CALL TO TRANS PREP MODULE **'               04020002
040300                                            TO PV-OPERATION-MSG   04030002
040400         MOVE DP001-RET-CODE                TO PV-RET-CODE        04040002
040500                                                                  04050002
040600         SET ABEND-4444-FORCED-ABEND TO TRUE                      04060022
040700                                                                  04070002
040800         PERFORM Z100-ABEND                                       04080002
040900     END-IF.                                                      04090002
041000                                                                  04100002
041100                                                                  04110002
041200******************************************************************04120002
041300* NON-DB2 ABEND                                                   04130002
041400******************************************************************04140002
041500 Z100-ABEND.                                                      04150002
041600                                                                  04160002
041700     PERFORM Z999-CONTROLS.                                       04170002
041800                                                                  04180002
041900     DISPLAY '                     '.                             04190002
042000     DISPLAY '** ABEND           **'.                             04200002
042100     DISPLAY '** PROGRAM         ** = ' PC-PROGRAM-NAME.          04210002
042200     DISPLAY '** PARAGRAPH       ** = ' PV-PARAGRAPH-NAME.        04220002
042300     DISPLAY '** OPERATION       ** = ' PV-OPERATION-MSG.         04230002
042400     DISPLAY '** RETURN CODE     ** = ' PV-RET-CODE.              04240002
042500                                                                  04250002
042600     CALL 'ILBOABN0' USING ABEND-CODE.                            04260002
042700                                                                  04270002
042800                                                                  04280002
042900******************************************************************04290002
043000* ABEND THE PROGRAM IN THE EVENT THAT A SQL ERROR OR WARNING      04300002
043100* CODE OCCURS.                                                    04310002
043200******************************************************************04320002
043300 Z200-SQL-ABEND.                                                  04330002
043400                                                                  04340002
043500     PERFORM Z999-CONTROLS.                                       04350002
043600                                                                  04360002
043700     DISPLAY '** ABEND     **'.                                   04370002
043800     DISPLAY '** PROGRAM   ** = ' PC-PROGRAM-NAME.                04380002
043900     DISPLAY '** PARAGRAPH ** = ' PV-PARAGRAPH-NAME.              04390002
044000     DISPLAY '** OPERATION ** = ' PV-DB2-OPER-ATTEMPTED.          04400002
044100                                                                  04410002
044200******************************************************************04420002
044300* THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION STATE-    04430002
044400* MENTS THAT ARE REQUIRED TO UTILIZE THE DB2 ABEND MODULE         04440002
044500* 'DSNTIAR' AND CONVERT THE SQLCA INFORMATION INTO A READABLE     04450002
044600* FORMAT.                                                         04460002
044700******************************************************************04470002
044800     COPY DPPD004.                                                04480002
044900                                                                  04490002
045000     SET ABEND-4013-DB2-ERROR TO TRUE.                            04500002
045100                                                                  04510002
045200     CALL 'ILBOABN0' USING ABEND-CODE.                            04520002
045300                                                                  04530002
045400                                                                  04540002
045500******************************************************************04550002
045600* PREFORMS TASK TERMINATION PROCESSING                            04560002
045700******************************************************************04570002
045800 Z990-EOJ-ROUTINE.                                                04580002
045900                                                                  04590002
046000     MOVE PC-TRAN-PRES-FUNC-CLOSE TO DP001-FUNC-CODE.             04600002
046100                                                                  04610002
046200     PERFORM X100-BUILD-COMM-AREA-TRAN-PRES.                      04620002
046300                                                                  04630002
046400     PERFORM Z999-CONTROLS.                                       04640002
046500                                                                  04650002
046600                                                                  04660002
046700******************************************************************04670002
046800* DISPLAY CONTROLS FROM THE PROGRAM                               04680002
046900******************************************************************04690002
047000 Z999-CONTROLS.                                                   04700002
047100                                                                  04710002
047200     MOVE FUNCTION CURRENT-DATE TO SYS-DATE-TIME.                 04720002
047300                                                                  04730002
047400     MOVE SYS-TIME (1:2) TO ST-END-HR.                            04740002
047500     MOVE SYS-TIME (3:2) TO ST-END-MN.                            04750002
047600                                                                  04760002
047700     DISPLAY '                    '.                              04770002
047800     DISPLAY '**********************'.                            04780002
047900     DISPLAY '   SVKUP086 CONTROLS  '.                            04790035
048000     DISPLAY '**********************'.                            04800002
048100     DISPLAY 'RUN DATE  = ' SD-EDIT-DATE.                         04810002
048200     DISPLAY 'BEG TIME  = ' ST-BEG-TIME.                          04820002
048300     DISPLAY 'END TIME  = ' ST-END-TIME.                          04830002
048400     DISPLAY '======================'.                            04840002
048500     DISPLAY 'RECORDS READ   = ' PA-READ.                         04850002
048600     DISPLAY 'CHECKPOINTS    = ' PA-CKPT.                         04860002
048700     DISPLAY '                '.                                  04870002
048800     DISPLAY 'DELETED ROWS   = ' PA-ROWS-DELETE.                  04880007
048800     DISPLAY 'DUPLICATE ROWS = ' PA-ROWS-DUPL.                    04881007
048900     DISPLAY '                '.                                  04890002
049000                                                                  04900002
049100******************************************************************04910002
049200* THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION STATE-    04920002
049300* MENTS THAT ARE REQUIRED TO INVOKE THE TRANSACTION PRESENTATION  04930002
049400* MODULE (DPKUT901) OF THE DB2 CHECKPOINT RESTART SYSTEM.         04940002
049500******************************************************************04950002
049600     COPY DPPD001.                                                04960002
049700                                                                  04970002
049800                                                                  04980002
