000100 IDENTIFICATION DIVISION.                                         00010000
000200******************************************************************00020000
000300*                                                                *00030000
000400* NOTE:  THERE IS A BATCH VERSION OF THIS PROGRAM CALLED         *00040000
000500*        DLKUT410.  ANY CHANGES MADE TO THIS PROGRAM SHOULD      *00050000
000600*        ALSO BE MADE IN THE BATCH VERSION.                      *00060000
000700*                                                                *00070000
000800* DISTRIBUTION LABOR MODULE USED TO DETERMINE IF AN ASSIGNMENT   *00080000
000900* EXISTS FOR A DC/WORK TYPE/WORK AREA.  WILL CONTROL THE         *00090000
001000* PROCESSING TO CHECK FOR THE ASSIGNMENT, MANAGE CREATING A NEW  *00100000
001100* ASSIGNMENT IF NEEDED AND THEN CONTROL THE PROCESSING FOR THE   *00110000
001200* USER ID TO ASSIGN THE USER TO THE ASSIGNMENT IN QUESTION.      *00120000
001300*                                                                *00130000
001400* THIS MODULE USES THE FOLLOWING MODULES TO COMPLETE THE         *00140000
001500* PROCESSING:                                                    *00150000
001600*     DLKUT001 - DETERMINE IF USER ID IS ACTIVE ON AN ASSIGNMENT *00160000
001700*     DLKUT002 - DETERMINE IF THERE IS AN ACTIVE ASSIGNMENT FOR  *00170000
001800*                THE DC/WORK TYPE/WORK AREA                      *00180000
001900*     DLKUP002 - ADD/END A USER TO AN ASSIGNMENT                 *00190000
002000*     DLKUP003 - CREATE A NEW ASSIGNMENT                         *00200000
002100*     XLKUT067 - USER ID MODULE (VALIDATE/RETURN TYPE AND NAME)  *00210000
002200*     XLKUP033 - MODULE TO WRITE TO EAI BUSINESS EVENT EXPORT    *00220000
002300*                TABLES (LOG A SYSTEM MOVE OF AN ASSOCIATE)      *00230000
002400*                                                                *00240000
002500*   NOTE:  THERE IS A BATCH VERSION OF THIS PROGRAM CALLED       *00250000
002600*          DLKUT410.  ANY CHANGES MADE TO THIS PROGRAM SHOULD    *00260000
002700*          ALSO BE MADE IN THE BATCH VERSION.                    *00270000
002800*                                                                *00280000
002900******************************************************************00290000
003000                                                                  00300000
003100 PROGRAM-ID.    DLKCS410.                                         00310000
003200 AUTHOR.        RON KRIER.                                        00320000
003300 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00330000
003400 DATE-WRITTEN   JANUARY 2004                                      00340000
003500 DATE-COMPILED.                                                   00350000
003600                                                                  00360000
003700 ENVIRONMENT DIVISION.                                            00370000
003800 CONFIGURATION SECTION.                                           00380000
003900 SOURCE-COMPUTER.        IBM-3090.                                00390000
004000 OBJECT-COMPUTER.        IBM-3090.                                00400000
004100                                                                  00410000
004200 DATA DIVISION.                                                   00420000
004300 WORKING-STORAGE SECTION.                                         00430000
004400                                                                  00440000
004500*----------------------------------------------------------------*00450000
004600*   PROGRAM SWITCHES                                             *00460000
004700*----------------------------------------------------------------*00470000
004800 01  PS-PROGRAM-SWITCHES.                                         00480000
004900                                                                  00490000
005000     05  PS-ERROR-SW                  PIC X(01) VALUE 'N'.        00500000
005100         88  PS-NO-ERROR                        VALUE 'N'.        00510000
005200         88  PS-ERROR                           VALUE 'Y'.        00520000
005300     05  PS-CALLED-MODULE-ERROR-SW    PIC X(01) VALUE 'N'.        00530000
005400         88  PS-NO-CALLED-MODULE-ERROR          VALUE 'N'.        00540000
005500         88  PS-CALLED-MODULE-ERROR             VALUE 'Y'.        00550000
005600     05  PS-CREATE-NEW-ASGMT-SW       PIC X(01) VALUE 'N'.        00560000
005700         88  PS-CREATE-NEW-ASGMT                VALUE 'N'.        00570000
005800         88  PS-DO-NOT-CREATE-NEW-ASGMT         VALUE 'Y'.        00580000
005900     05  PS-ASGMTS-MATCH-SW           PIC X(01) VALUE 'N'.        00590000
006000         88  PS-ASGMTS-DO-NOT-MATCH             VALUE 'N'.        00600000
006100         88  PS-ASGMTS-MATCH                    VALUE 'Y'.        00610000
006200     05  PS-CREATE-NEW-USER-SW        PIC X(01) VALUE 'N'.        00620000
006300         88  PS-CREATE-NEW-USER-NO              VALUE 'N'.        00630000
006400         88  PS-CREATE-NEW-USER-YES             VALUE 'Y'.        00640000
006500     05  PS-XLKUT067-CALLED-SW        PIC X(01) VALUE 'N'.        00650000
006600         88  PS-XLKUT067-CALLED-NO              VALUE 'N'.        00660000
006700         88  PS-XLKUT067-CALLED-YES             VALUE 'Y'.        00670000
006800     05  PS-CHECKING-MULT-ASGMT-SW    PIC X(01) VALUE 'N'.        00680000
006900         88  PS-NOT-CHECKING-MULT-ASGMT         VALUE 'N'.        00690000
007000         88  PS-CHECKING-MULT-ASGMT             VALUE 'Y'.        00700000
007100                                                                  00710000
007200*----------------------------------------------------------------*00720000
007300*   PROGRAM CONSTANTS                                            *00730000
007400*----------------------------------------------------------------*00740000
007500 01  PC-PROGRAM-CONSTANTS.                                        00750000
007600                                                                  00760000
007700     05  PC-CURRENT-PROGRAM-NAME     PIC  X(08)  VALUE 'DLKCS410'.00770000
007800                                                                  00780000
007900*----------------------------------------------------------------*00790000
008000*   PROGRAM VARIABLES                                            *00800000
008100*----------------------------------------------------------------*00810000
008200 01  PV-VARIABLES.                                                00820000
008300     05  PV-LOC-NBR                  PIC S9(04)  VALUE ZERO       00830000
008400                                                  COMP.           00840000
008500                                                                  00850000
008600     05  PV-HOLD-USR-ID              PIC  X(08)  VALUE SPACES.    00860000
008700     05  PV-HOLD-USR-TYP-CDE         PIC  X(01)  VALUE SPACES.    00870000
008800                                                                  00880000
008900     05  PV-LABOR-CURRENT-DATE       PIC  X(10).                  00890000
009000     05  PV-LABOR-CURRENT-TIME       PIC  X(08).                  00900000
009100     05  PV-LABOR-CURRENT-TIMESTAMP  PIC  X(26).                  00910000
009200     05  PV-HOLD-TIMESTAMP           PIC  X(26).                  00920000
009300                                                                  00930000
009400     05  PV-HOLD-ASGMT-START-DTE     PIC  X(10)  VALUE SPACES.    00940000
009500     05  PV-HOLD-ASGMT-NBR-TXT       PIC  X(10)  VALUE SPACES.    00950000
009600     05  PV-HOLD-ASGMT-NBR-SEQ-NBR   PIC S9(09)  COMP             00960000
009700                                                 VALUE ZEROS.     00970000
009800     05  PV-HOLD-TEM-ASGMT-SEQ-NBR   PIC S9(09)  COMP             00980000
009900                                                 VALUE ZEROS.     00990000
010000                                                                  01000000
010100     05  PV-DISPLAY-DC-NBR           PIC  99999  VALUE ZEROS.     01010000
010200     05  PV-DISPLAY-QTY-5            PIC  99999  VALUE ZEROS.     01020000
010300     05  PV-DISPLAY-TEXT             PIC  XXXXX  VALUE ZEROS.     01030000
010400                                                                  01040000
010500     05  PV-CURRENT-DATE             PIC  X(10)  VALUE SPACES.    01050000
010600     05  PV-CURRENT-DATE-R REDEFINES PV-CURRENT-DATE.             01060000
010700         10 PV-CURRENT-CC            PIC  9(02).                  01070000
010800         10 PV-CURRENT-YY            PIC  9(02).                  01080000
010900         10 FILLER                   PIC  X(01).                  01090000
011000         10 PV-CURRENT-MM            PIC  9(02).                  01100000
011100         10 FILLER                   PIC  X(01).                  01110000
011200         10 PV-CURRENT-DD            PIC  9(02).                  01120000
011300     05  PV-CURRENT-TIME             PIC  X(08)  VALUE SPACES.    01130000
011400     05  PV-CURRENT-TIME-R REDEFINES PV-CURRENT-TIME.             01140000
011500         10 PV-CURRENT-HR            PIC  9(02).                  01150000
011600         10 FILLER                   PIC  X(01).                  01160000
011700         10 PV-CURRENT-MN            PIC  9(02).                  01170000
011800         10 FILLER                   PIC  X(03).                  01180000
011900                                                                  01190000
012000     05  PV-MODULE-FAIL-MSG.                                      01200000
012100         10  FILLER                     PIC  X(12)  VALUE         01210000
012200                                        ' PARAGRAPH: '.           01220000
012300         10  PV-MODULE-PARAGRPAH        PIC  X(30)  VALUE SPACE.  01230000
012400                                                                  01240000
012500     05  PV-CICS-RESP                   PIC S9(04)  VALUE +0      01250000
012600                                                    COMP SYNC.    01260000
012700     05  PV-CICS-MSG-AREA                PIC  X(80)  VALUE SPACE. 01270000
012800     05  PV-CICS-MSG-AREA2               PIC  X(100) VALUE SPACE. 01280000
012900     05  PV-CICS-MSG-HOLD.                                        01290000
013000         10  FILLER                      PIC  X(01)  VALUE SPACE. 01300000
013100         10  PV-CICS-MSG-DATA            PIC  X(79)  VALUE SPACE. 01310000
013200                                                                  01320000
013300     05  PV-COMMAREA-LENGTH              PIC S9(04) COMP          01330000
013400                                                    VALUE +0.     01340000
013500     05  PV-DISPLAY-OPER                 PIC  9(04).              01350000
013600     05  PV-DISPLAY-SQLCODE              PIC  -999.               01360000
013700     05  PV-ASGMT-COUNT                  PIC S9(09)  COMP.        01370000
013800                                                                  01380000
013900*----------------------------------------------------------------*01390000
014000*    COMMAREA PASSED FROM CALLING PROGRAM FOR USE IN THIS        *01400000
014100*    PROGRAM                                                     *01410000
014200*----------------------------------------------------------------*01420000
014300     COPY DLWS016.                                                01430000
014400                                                                  01440000
014500*----------------------------------------------------------------*01450000
014600*    COMMAREA TO BE PASSED TO DLKUT001                            01460000
014700*----------------------------------------------------------------*01470000
014800     COPY DLWS003.                                                01480000
014900                                                                  01490000
015000*----------------------------------------------------------------*01500000
015100*    COMMAREA TO BE PASSED TO DLKUT002                            01510000
015200*----------------------------------------------------------------*01520000
015300     COPY DLWS004.                                                01530000
015400                                                                  01540000
015500*----------------------------------------------------------------*01550000
015600*    COMMAREA TO BE PASSED TO DLKUP002                            01560000
015700*----------------------------------------------------------------*01570000
015800     COPY DLWS005.                                                01580000
015900                                                                  01590000
016000*----------------------------------------------------------------*01600000
016100*    COMMAREA TO BE PASSED TO DLKUP003                            01610000
016200*----------------------------------------------------------------*01620000
016300     COPY DLWS007.                                                01630000
016400                                                                  01640000
016500*----------------------------------------------------------------*01650000
016600*    COPYBOOK USED TO ENSURE THAT ASSIGNMENT NUMBERS AND WORK     01660000
016700*    TYPES AND AREAS ARE DEFINED IN A CONSISTENT MANNER.          01670000
016800*----------------------------------------------------------------*01680000
016900     COPY DLWS011.                                                01690000
017000                                                                  01700000
017100*----------------------------------------------------------------*01710000
017200*    COMMAREA TO BE PASSED TO XLKUT067                            01720000
017300*----------------------------------------------------------------*01730000
017400     COPY XLWS067.                                                01740000
017500                                                                  01750000
017600*----------------------------------------------------------------*01760000
017700*    COMMAREA TO BE PASSED TO XLKUP033                            01770000
017800*----------------------------------------------------------------*01780000
017900     COPY XLWS072.                                                01790000
018000                                                                  01800000
018100*----------------------------------------------------------------*01810000
018200*    COMMAREA TO BE PASSED TO DLKUT028                            01820000
018300*----------------------------------------------------------------*01830000
018400     COPY DLWS024.                                                01840000
018500                                                                  01850000
018600*----------------------------------------------------------------*01860000
018700*    COMMAREA TO BE PASSED TO DLKUT030                            01870000
018800*----------------------------------------------------------------*01880000
018900     COPY DLWS026.                                                01890000
019000                                                                  01900000
019100/    TERMINAL SIGNON INFO                                         01910000
019200     COPY DPWS026.                                                01920000
019300                                                                  01930000
019400*    STANDARD ABEND STUFF                                         01940000
019500     COPY DPWS013.                                                01950000
019600                                                                  01960000
019700*----------------------------------------------------------------*01970000
019800*   DLT_RDPR_USR_LSTG  TABLE                                      01980000
019900*----------------------------------------------------------------*01990000
020000     EXEC SQL                                                     02000000
020100         INCLUDE DLT00009                                         02010000
020200     END-EXEC.                                                    02020000
020300                                                                  02030000
020400*----------------------------------------------------------------*02040000
020500*   DLT_ASGMT - LABOR ASSIGNMENT TABLE                            02050000
020600*----------------------------------------------------------------*02060000
020700     EXEC SQL                                                     02070000
020800         INCLUDE DLT00004                                         02080000
020900     END-EXEC.                                                    02090000
021000                                                                  02100000
021100*----------------------------------------------------------------*02110000
021200*   DLT_TEM_ASGMT - LABOR TEAM ASSIGNMENT TABLE                   02120000
021300*----------------------------------------------------------------*02130000
021400     EXEC SQL                                                     02140000
021500         INCLUDE DLT00003                                         02150000
021600     END-EXEC.                                                    02160000
021700                                                                  02170000
021800*----------------------------------------------------------------*02180000
021900*   TKRPRPM - PARMAMETER TABLE                                    02190000
022000*----------------------------------------------------------------*02200000
022100     EXEC SQL                                                     02210000
022200         INCLUDE TKRPRPM                                          02220000
022300     END-EXEC.                                                    02230000
022400                                                                  02240000
022500*----------------------------------------------------------------*02250000
022600*   TUPLDER - UPLOAD ERROR TABLE                                  02260000
022700*----------------------------------------------------------------*02270000
022800     EXEC SQL                                                     02280000
022900         INCLUDE TUPLDER                                          02290000
023000     END-EXEC.                                                    02300000
023100                                                                  02310000
023200*---------------------------------------------------------------* 02320000
023300*    DB2 AREA FOR COMMUNICATIONS                                * 02330000
023400*---------------------------------------------------------------* 02340000
023500     EXEC SQL                                                     02350000
023600          INCLUDE SQLCA                                           02360000
023700     END-EXEC.                                                    02370000
023800                                                                  02380000
023900                                                                  02390000
024000 LINKAGE SECTION.                                                 02400000
024100                                                                  02410000
024200 01  DFHCOMMAREA.                                                 02420000
024300     05  FILLER                         OCCURS  1 TO 4072 TIMES   02430000
024400                                        DEPENDING ON EIBCALEN.    02440000
024500         10  FILLER                   PIC X.                      02450000
024600                                                                  02460000
024700                                                                  02470000
024800*----------------------------------------------------------------*02480000
024900*                                                                *02490000
025000*----------------------------------------------------------------*02500000
025100 PROCEDURE DIVISION.                                              02510000
025200                                                                  02520000
025300 0000-PROGRAM-MAINLINE.                                           02530000
025400                                                                  02540000
025500***  MOVE SPACES TO PV-CICS-MSG-AREA2                             02550000
025600***  MOVE ' DLKCS410 - 0000-PROGRAM-MAINLINE'                     02560000
025700***    TO PV-CICS-MSG-AREA2                                       02570000
025800***  MOVE LENGTH OF PV-CICS-MSG-AREA2                             02580000
025900***    TO PV-COMMAREA-LENGTH                                      02590000
026000***  PERFORM 9200-WRITE-TO-CSSL                                   02600000
026100                                                                  02610000
026200*** DMH - BEGIN - 6/17/10                                         02620000
026300*** REPLACE INITIALIZE STATEMENTS WITH SET/MOVE STATEMENTS        02630000
026400*** INITIALIZE DOES NOT CLEAR OUT THE DATA CONSISTENTLY           02640000
026500***                                                               02650000
026600***  INITIALIZE  PS-PROGRAM-SWITCHES                              02660000
026700***              PV-VARIABLES                                     02670000
026800     INITIALIZE  DCLDLT00009.                                     02680000
026900                                                                  02690000
027000***                                                               02700000
027100***   SET SWITCHES                                                02710000
027200***                                                               02720000
027300     SET  PS-NO-ERROR                                             02730000
027400          PS-NO-CALLED-MODULE-ERROR                               02740000
027500          PS-CREATE-NEW-ASGMT                                     02750000
027600          PS-ASGMTS-DO-NOT-MATCH                                  02760000
027700          PS-CREATE-NEW-USER-NO                                   02770000
027800          PS-XLKUT067-CALLED-NO                                   02780000
027900***       PS-USER-TABLES-CHECKED-NO                               02790000
028000          PS-NOT-CHECKING-MULT-ASGMT  TO  TRUE.                   02800000
028100                                                                  02810000
028200***  MOVE SPACES                      TO  PS-USER-FOUND-SW.       02820000
028300                                                                  02830000
028400***                                                               02840000
028500***   SET PROGRAM VARIABLES                                       02850000
028600***                                                               02860000
028700     MOVE SPACES                 TO  PV-HOLD-USR-ID               02870000
028800                                     PV-HOLD-USR-TYP-CDE          02880000
028900                                     PV-LABOR-CURRENT-DATE        02890000
029000                                     PV-LABOR-CURRENT-TIME        02900000
029100                                     PV-LABOR-CURRENT-TIMESTAMP   02910000
029200                                     PV-HOLD-TIMESTAMP            02920000
029300                                     PV-HOLD-ASGMT-START-DTE      02930000
029400                                     PV-HOLD-ASGMT-NBR-TXT        02940000
029500                                     PV-CURRENT-DATE              02950000
029600                                     PV-CURRENT-TIME.             02960000
029700     MOVE  ZEROES                TO  PV-LOC-NBR                   02970000
029800                                     PV-HOLD-ASGMT-NBR-SEQ-NBR    02980000
029900                                     PV-HOLD-TEM-ASGMT-SEQ-NBR    02990000
030000                                     PV-DISPLAY-DC-NBR            03000000
030100                                     PV-DISPLAY-QTY-5             03010000
030200                                     PV-DISPLAY-TEXT              03020000
030300                                     PV-COMMAREA-LENGTH           03030000
030400                                     PV-DISPLAY-OPER              03040000
030500                                     PV-DISPLAY-SQLCODE           03050000
030600                                     PV-ASGMT-COUNT.              03060000
030800***                                                               03080000
030900*** DMH - END - 6/17/10                                           03090000
031000***                                                               03100000
031100                                                                  03110000
031200     MOVE DFHCOMMAREA                 TO DL016-PGM-COMMAREA.      03120000
031300     SET DL016-SUCCESSFUL             TO TRUE.                    03130000
031400                                                                  03140000
031500     SET PS-NO-ERROR TO TRUE.                                     03150000
031600     PERFORM 1000-VALIDATE-DATA.                                  03160000
031700                                                                  03170000
031800* DMH - 12/10/08 - BEGIN                                          03180000
031900     IF  PS-ERROR                                                 03190000
032000         CONTINUE                                                 03200000
032100     ELSE                                                         03210000
032200         SET  PS-NOT-CHECKING-MULT-ASGMT  TO  TRUE                03220000
032300         PERFORM 4000-SELECT-TKRPRPM                              03230000
032400         IF  PS-CHECKING-MULT-ASGMT                               03240000
032500             PERFORM 4100-CHECK-MULT-ASGMT                        03250000
032600         END-IF                                                   03260000
032700     END-IF.                                                      03270000
032800* DMH - 12/10/08 - BEGIN                                          03280000
032900                                                                  03290000
033000     IF  PS-ERROR                                                 03300000
033100         CONTINUE                                                 03310000
033200     ELSE                                                         03320000
033300         IF  DL016-ESTABLISH-ASGMT                                03330000
033400             PERFORM 2000-ESTABLISH-ASGMT                         03340000
033500         ELSE                                                     03350000
033600             IF  DL016-ESTABLISH-TEAM                             03360000
033700                 SET DL016-INVALID-ACCESS TO TRUE                 03370000
033800                 SET PS-ERROR TO TRUE                             03380000
033900             ELSE                                                 03390000
034000                 SET DL016-INVALID-ACCESS TO TRUE                 03400000
034100                 SET PS-ERROR TO TRUE                             03410000
034200             END-IF                                               03420000
034300         END-IF                                                   03430000
034400     END-IF.                                                      03440000
034500                                                                  03450000
034600     IF  PS-ERROR                                                 03460000
034700         CONTINUE                                                 03470000
034800     ELSE                                                         03480000
034900         SET DL016-SUCCESSFUL TO TRUE                             03490000
035000     END-IF.                                                      03500000
035100                                                                  03510000
035200     PERFORM 9000-RETURN-CALL.                                    03520000
035300                                                                  03530000
035400                                                                  03540000
035500*----------------------------------------------------------------*03550000
035600*  THIS WILL PERFORM ALL OF THE VALIDATION OF THE DATA PASSED    *03560000
035700*  FROM THE CALLING PROGRAM                                      *03570000
035800*----------------------------------------------------------------*03580000
035900 1000-VALIDATE-DATA.                                              03590000
036000                                                                  03600000
036100***  MOVE SPACES TO PV-CICS-MSG-AREA2                             03610000
036200***  MOVE ' DLKCS410 - 1000-VALIDATE-DATA   '                     03620000
036300***    TO PV-CICS-MSG-AREA2                                       03630000
036400***  MOVE LENGTH OF PV-CICS-MSG-AREA2                             03640000
036500***    TO PV-COMMAREA-LENGTH                                      03650000
036600***  PERFORM 9200-WRITE-TO-CSSL                                   03660000
036700                                                                  03670000
036800     PERFORM 1020-CHECK-DATA-EXISTS.                              03680000
036900                                                                  03690000
037000     IF  PS-ERROR                                                 03700000
037100         CONTINUE                                                 03710000
037200     ELSE                                                         03720000
037300         PERFORM 1080-CHECK-USER-IDS                              03730000
037400     END-IF.                                                      03740000
037500                                                                  03750000
037600                                                                  03760000
037700*-----------------------------------------------------------------03770000
037800*  THIS WILL VALIDATE THAT ALL OF THE REQUIRED FIELDS HAVE BEEN  *03780000
037900*  PASSED FROM THE CALLING PROGRAM                               *03790000
038000*-----------------------------------------------------------------03800000
038100 1020-CHECK-DATA-EXISTS.                                          03810000
038200                                                                  03820000
038300***  MOVE SPACES TO PV-CICS-MSG-AREA2                             03830000
038400***  MOVE ' DLKCS410 - 1020-CHECK-DATA-EXISTS '                   03840000
038500***    TO PV-CICS-MSG-AREA2                                       03850000
038600***  MOVE LENGTH OF PV-CICS-MSG-AREA2                             03860000
038700***    TO PV-COMMAREA-LENGTH                                      03870000
038800***  PERFORM 9200-WRITE-TO-CSSL                                   03880000
038900                                                                  03890000
039000     IF  DL016-VALID-PROCESS-CDE                                  03900000
039100         CONTINUE                                                 03910000
039200     ELSE                                                         03920000
039300         SET PS-ERROR TO TRUE                                     03930000
039400         SET DL016-PROCESS-CODE-INVALID TO TRUE                   03940000
039500     END-IF.                                                      03950000
039600                                                                  03960000
039700     IF  PS-ERROR                                                 03970000
039800         CONTINUE                                                 03980000
039900     ELSE                                                         03990000
040000         IF  DL016-VALID-COMMIT-CDE                               04000000
040100             CONTINUE                                             04010000
040200         ELSE                                                     04020000
040300             SET PS-ERROR TO TRUE                                 04030000
040400             SET DL016-COMMIT-CODE-INVALID TO TRUE                04040000
040500         END-IF                                                   04050000
040600     END-IF.                                                      04060000
040700                                                                  04070000
040800     IF  PS-ERROR                                                 04080000
040900         CONTINUE                                                 04090000
041000     ELSE                                                         04100000
041100         IF  DL016-NO-CALLING-PGM                                 04110000
041200             SET PS-ERROR TO TRUE                                 04120000
041300             SET DL016-MISSING-CALL-PROGRAM TO TRUE               04130000
041400         END-IF                                                   04140000
041500     END-IF.                                                      04150000
041600                                                                  04160000
041700     IF  PS-ERROR                                                 04170000
041800         CONTINUE                                                 04180000
041900     ELSE                                                         04190000
042000         IF  DL016-NO-SIGN-ON-USR                                 04200000
042100             SET PS-ERROR TO TRUE                                 04210000
042200             SET DL016-MISSING-SIGN-ON-USR TO TRUE                04220000
042300         END-IF                                                   04230000
042400     END-IF.                                                      04240000
042500                                                                  04250000
042600     IF  PS-ERROR                                                 04260000
042700         CONTINUE                                                 04270000
042800     ELSE                                                         04280000
042900         IF  DL016-NO-ASGMT-NBR-WRK-TYP                           04290000
043000             SET PS-ERROR TO TRUE                                 04300000
043100             SET DL016-MISSING-ASGMT-WRK-TYP TO TRUE              04310000
043200         END-IF                                                   04320000
043300     END-IF.                                                      04330000
043400                                                                  04340000
043500     IF  PS-ERROR                                                 04350000
043600         CONTINUE                                                 04360000
043700     ELSE                                                         04370000
043800         IF  DL016-ESTABLISH-ASGMT                                04380000
043900             PERFORM 1040-VALIDATE-EAI-FIELDS                     04390000
044000         ELSE                                                     04400000
044100             PERFORM 1060-VALIDATE-ETI-FIELDS                     04410000
044200         END-IF                                                   04420000
044300     END-IF.                                                      04430000
044400                                                                  04440000
044500                                                                  04450000
044600 1040-VALIDATE-EAI-FIELDS.                                        04460000
044700                                                                  04470000
044800***  MOVE SPACES TO PV-CICS-MSG-AREA2                             04480000
044900***  MOVE ' DLKCS410 - 1040-VALIDATE-EAI-FIELDS'                  04490000
045000***    TO PV-CICS-MSG-AREA2                                       04500000
045100***  MOVE LENGTH OF PV-CICS-MSG-AREA2                             04510000
045200***    TO PV-COMMAREA-LENGTH                                      04520000
045300***  PERFORM 9200-WRITE-TO-CSSL                                   04530000
045400                                                                  04540000
045500     IF  DL016-EAI-NO-WK-TYP                                      04550000
045600     OR  DL016-EAI-NO-WK-AREA                                     04560000
045700     OR  DL016-EAI-NO-DC-NBR                                      04570000
045800     OR  DL016-EAI-NO-CRE-USR                                     04580000
045900         SET PS-ERROR TO TRUE                                     04590000
046000         SET DL016-MISSING-EAI-FIELDS TO TRUE                     04600000
046100     ELSE                                                         04610000
046200         CONTINUE                                                 04620000
046300     END-IF.                                                      04630000
046400                                                                  04640000
046500     IF  PS-ERROR                                                 04650000
046600         CONTINUE                                                 04660000
046700     ELSE                                                         04670000
046800         IF  DL016-VALID-EAI-USR-TYP                              04680000
046900             CONTINUE                                             04690000
047000         ELSE                                                     04700000
047100             SET PS-ERROR TO TRUE                                 04710000
047200             SET DL016-MISSING-EAI-FIELDS TO TRUE                 04720000
047300         END-IF                                                   04730000
047400     END-IF.                                                      04740000
047500                                                                  04750000
047600                                                                  04760000
047700 1060-VALIDATE-ETI-FIELDS.                                        04770000
047800                                                                  04780000
047900***  MOVE SPACES TO PV-CICS-MSG-AREA2                             04790000
048000***  MOVE ' DLKCS410 - 1060-VALIDATE-ETI-FIELDS'                  04800000
048100***    TO PV-CICS-MSG-AREA2                                       04810000
048200***  MOVE LENGTH OF PV-CICS-MSG-AREA2                             04820000
048300***    TO PV-COMMAREA-LENGTH                                      04830000
048400***  PERFORM 9200-WRITE-TO-CSSL                                   04840000
048500                                                                  04850000
048600     IF  DL016-ETI-ASGMT-NO-STY                                   04860000
048700     OR  DL016-ETI-ASGMT-NO-STM                                   04870000
048800     OR  DL016-ETI-ASGMT-NO-STD                                   04880000
048900     OR  DL016-ETI-ASGMT-NO-NBR-TXT                               04890000
049000     OR  DL016-ETI-ASGMT-NO-SEQ-NBR                               04900000
049100     OR  DL016-ETI-NO-USR                                         04910000
049200         SET PS-ERROR TO TRUE                                     04920000
049300         SET DL016-MISSING-ETI-FIELDS TO TRUE                     04930000
049400     ELSE                                                         04940000
049500         CONTINUE                                                 04950000
049600     END-IF.                                                      04960000
049700                                                                  04970000
049800     IF  PS-ERROR                                                 04980000
049900         CONTINUE                                                 04990000
050000     ELSE                                                         05000000
050100         IF  DL016-VALID-ETI-USR-TYP                              05010000
050200             CONTINUE                                             05020000
050300         ELSE                                                     05030000
050400             SET PS-ERROR TO TRUE                                 05040000
050500             SET DL016-MISSING-ETI-FIELDS TO TRUE                 05050000
050600         END-IF                                                   05060000
050700     END-IF.                                                      05070000
050800                                                                  05080000
050900 1080-CHECK-USER-IDS.                                             05090000
051000                                                                  05100000
051100***  MOVE SPACES TO PV-CICS-MSG-AREA2                             05110000
051200***  MOVE ' DLKCS410 - 1080-CHECK-USER-IDS     '                  05120000
051300***    TO PV-CICS-MSG-AREA2                                       05130000
051400***  MOVE LENGTH OF PV-CICS-MSG-AREA2                             05140000
051500***    TO PV-COMMAREA-LENGTH                                      05150000
051600***  PERFORM 9200-WRITE-TO-CSSL                                   05160000
051700                                                                  05170000
051800     IF  DL016-ESTABLISH-ASGMT                                    05180000
051900         MOVE DL016-EAI-CRE-BY-USR-ID TO                          05190000
052000              PV-HOLD-USR-ID                                      05200000
052100         IF  DL016-EAI-USR-IS-UNKNOWN                             05210000
052200             SET PS-NO-CALLED-MODULE-ERROR TO TRUE                05220000
052300             SET PS-XLKUT067-CALLED-YES TO TRUE                   05230000
052400             PERFORM 6000-CALL-XLKUT067                           05240000
052500         ELSE                                                     05250000
052600             MOVE DL016-EAI-USR-TYP-CDE TO                        05260000
052700                  PV-HOLD-USR-TYP-CDE                             05270000
052800         END-IF                                                   05280000
052900     END-IF.                                                      05290000
053000                                                                  05300000
053100     IF  DL016-ESTABLISH-TEAM                                     05310000
053200         MOVE DL016-ETI-USR-ID TO                                 05320000
053300              PV-HOLD-USR-ID                                      05330000
053400         IF  DL016-ETI-USR-IS-UNKNOWN                             05340000
053500             SET PS-NO-CALLED-MODULE-ERROR TO TRUE                05350000
053600             SET PS-XLKUT067-CALLED-YES TO TRUE                   05360000
053700             PERFORM 6000-CALL-XLKUT067                           05370000
053800         ELSE                                                     05380000
053900             MOVE DL016-ETI-USR-TYP-CDE TO                        05390000
054000                  PV-HOLD-USR-TYP-CDE                             05400000
054100         END-IF                                                   05410000
054200     END-IF.                                                      05420000
054300                                                                  05430000
054400     IF  PS-CALLED-MODULE-ERROR                                   05440000
054500         SET PS-ERROR TO TRUE                                     05450000
054600         MOVE 'XLKUT067' TO DL016-CALL-MOD-FAIL-NM                05460000
054700         MOVE XL067-RETURN-CODE TO DL016-CALL-MOD-FAIL-ERR-CDE    05470000
054800         SET DL016-CALLED-MODULE-FAILURE TO TRUE                  05480000
054900         IF  XL067-SQL-ERROR                                      05490000
055000             PERFORM 1100-LOAD-XLKUT067-SQL-ERROR                 05500000
055100         END-IF                                                   05510000
055200     ELSE                                                         05520000
055300         IF  DL016-ESTABLISH-ASGMT                                05530000
055400             MOVE PV-HOLD-USR-TYP-CDE TO                          05540000
055500                  DL016-EAI-USR-TYP-CDE                           05550000
055600         ELSE                                                     05560000
055700             MOVE PV-HOLD-USR-TYP-CDE TO                          05570000
055800                  DL016-ETI-USR-TYP-CDE                           05580000
055900         END-IF                                                   05590000
056000     END-IF.                                                      05600000
056100                                                                  05610000
056200     IF PS-CALLED-MODULE-ERROR                                    05620000
056300         CONTINUE                                                 05630000
056400     ELSE                                                         05640000
056500         IF DL016-EAI-USR-IS-KOHLS                                05650000
056600             PERFORM 1081-CHECK-IF-NEW-USER                       05660000
056700         END-IF                                                   05670000
056800     END-IF.                                                      05680000
056900                                                                  05690000
057000 1081-CHECK-IF-NEW-USER.                                          05700000
057100                                                                  05710000
057200***  MOVE SPACES TO PV-CICS-MSG-AREA2                             05720000
057300***  MOVE ' DLKCS410 - 1081-CHECK-IF-NEW-USER  '                  05730000
057400***    TO PV-CICS-MSG-AREA2                                       05740000
057500***  MOVE LENGTH OF PV-CICS-MSG-AREA2                             05750000
057600***    TO PV-COMMAREA-LENGTH                                      05760000
057700***  PERFORM 9200-WRITE-TO-CSSL                                   05770000
057800                                                                  05780000
057900     SET PS-CREATE-NEW-USER-YES       TO TRUE                     05790000
058000                                                                  05800000
058100     IF  DL016-EAI-DC-NBR = 0                                     05810000
058200         PERFORM DP026-0000-GET-LOGON-INFO                        05820000
058300         MOVE DP026-LOCATION-NBR  TO PV-LOC-NBR                   05830000
058400     ELSE                                                         05840000
058500         MOVE DL016-EAI-DC-NBR    TO PV-LOC-NBR                   05850000
058600     END-IF                                                       05860000
058700     PERFORM 7000-SELECT-RDPR-USR                                 05870000
058800                                                                  05880000
058900     IF DL016-SUCCESSFUL                                          05890000
059000       IF PS-CREATE-NEW-USER-YES                                  05900000
059100*        THE SWITCH COULD BE TURNED OFF IN PARA 7000              05910000
059200             INITIALIZE XL072-EAI-EXPORT-COMMAREA                 05920000
059300                                                                  05930000
059400         SET XL072-PC-APP-ID      TO TRUE                         05940000
059500         MOVE 'DC LABOR'          TO XL072-EVNT-OBJ-TXT           05950000
059600         MOVE 'ASSOCIATE ADD'     TO XL072-EVNT-OBJ-ACTN-TXT      05960000
059700         MOVE DL016-EAI-CRE-BY-USR-ID                             05970000
059800                                  TO XL072-CRE-BY-USR-ID          05980000
059900         MOVE 'DLKCS410'          TO XL072-CRE-PGM-NM             05990000
060000         MOVE 'N/A'               TO XL072-DTL-COPYBOOK-NM        06000000
060100                                                                  06010000
060200         IF  DL016-EAI-DC-NBR = 0                                 06020000
060300             PERFORM DP026-0000-GET-LOGON-INFO                    06030000
060400             MOVE DP026-LOCATION-NBR  TO XL072-EVNT-KY-1-NBR      06040000
060500         ELSE                                                     06050000
060600             MOVE DL016-EAI-DC-NBR    TO XL072-EVNT-KY-1-NBR      06060000
060700         END-IF                                                   06070000
060800                                                                  06080000
060900         MOVE PV-HOLD-USR-ID      TO XL072-EVNT-KY-1-TXT          06090000
061000                                                                  06100000
061100         IF  PS-XLKUT067-CALLED-YES                               06110000
061200             MOVE XL067-LAST-NAME     TO XL072-EVNT-KY-2-TXT      06120000
061300             MOVE XL067-FIRST-NAME    TO XL072-EVNT-KY-3-TXT      06130000
061400         ELSE                                                     06140000
061500             SET PS-NO-CALLED-MODULE-ERROR TO TRUE                06150000
061600             PERFORM 6000-CALL-XLKUT067                           06160000
061700             IF  PS-CALLED-MODULE-ERROR                           06170000
061800                 SET PS-ERROR TO TRUE                             06180000
061900                 MOVE 'XLKUT067' TO DL016-CALL-MOD-FAIL-NM        06190000
062000                 MOVE XL067-RETURN-CODE TO                        06200000
062100                      DL016-CALL-MOD-FAIL-ERR-CDE                 06210000
062200                 SET DL016-CALLED-MODULE-FAILURE TO TRUE          06220000
062300                 IF  XL067-SQL-ERROR                              06230000
062400                     PERFORM 1100-LOAD-XLKUT067-SQL-ERROR         06240000
062500                 END-IF                                           06250000
062600                 PERFORM 9000-RETURN-CALL                         06260000
062700             ELSE                                                 06270000
062800                 MOVE XL067-LAST-NAME     TO XL072-EVNT-KY-2-TXT  06280000
062900                 MOVE XL067-FIRST-NAME    TO XL072-EVNT-KY-3-TXT  06290000
063000             END-IF                                               06300000
063100         END-IF                                                   06310000
063200                                                                  06320000
063300         SET XL072-COMMIT-UPDATE  TO TRUE                         06330000
063400         MOVE 'DLKCS410'          TO XL072-ORIG-CALLING-PGM-NM    06340000
063500                                                                  06350000
063600         PERFORM 6500-CALL-XLKUP033                               06360000
063700                                                                  06370000
063800         IF  PS-CALLED-MODULE-ERROR                               06380000
063900             SET PS-ERROR TO TRUE                                 06390000
064000             MOVE 'XLKUP033' TO DL016-CALL-MOD-FAIL-NM            06400000
064100             MOVE XL072-RETURN-CODE TO DL016-CALL-MOD-FAIL-ERR-CDE06410000
064200             SET DL016-CALLED-MODULE-FAILURE TO TRUE              06420000
064300             IF  XL072-SQL-ERROR                                  06430000
064400                 MOVE XL072-EAI-DB-SQLCODE TO                     06440000
064500                      DL016-CALL-MOD-FAIL-SQL-CDE                 06450000
064600                 MOVE XL072-SQL-ERROR-PARA TO                     06460000
064700                      DL016-CALL-MOD-FAIL-SQL-PARA                06470000
064800             END-IF                                               06480000
064900             PERFORM 9000-RETURN-CALL                             06490000
065000         END-IF                                                   06500000
065100                                                                  06510000
065200       END-IF                                                     06520000
065300     END-IF.                                                      06530000
065400                                                                  06540000
065500 1100-LOAD-XLKUT067-SQL-ERROR.                                    06550000
065600                                                                  06560000
065700***  MOVE SPACES TO PV-CICS-MSG-AREA2                             06570000
065800***  MOVE ' DLKCS410 - 1100-LOAD-XLKUT067-SQL-ERROR '             06580000
065900***    TO PV-CICS-MSG-AREA2                                       06590000
066000***  MOVE LENGTH OF PV-CICS-MSG-AREA2                             06600000
066100***    TO PV-COMMAREA-LENGTH                                      06610000
066200***  PERFORM 9200-WRITE-TO-CSSL                                   06620000
066300                                                                  06630000
066400     IF  XL067-KOHLS-SQLCODE > 0                                  06640000
066500         MOVE XL067-KOHLS-SQLCODE TO                              06650000
066600              DL016-CALL-MOD-FAIL-SQL-CDE                         06660000
066700         IF  XL067-KOHLS-NOT-FOUND                                06670000
066800             MOVE XL067-KOHLS-NOT-FOUND-NBR TO                    06680000
066900                  DL016-CALL-MOD-FAIL-SQL-PARA                    06690000
067000         ELSE                                                     06700000
067100             IF  XL067-KOHLS-CONTENTION                           06710000
067200                 MOVE XL067-KOHLS-CONTENTION-NBR TO               06720000
067300                      DL016-CALL-MOD-FAIL-SQL-PARA                06730000
067400             ELSE                                                 06740000
067500                 MOVE XL067-KOHLS-ERROR-NBR TO                    06750000
067600                      DL016-CALL-MOD-FAIL-SQL-PARA                06760000
067700             END-IF                                               06770000
067800         END-IF                                                   06780000
067900     END-IF.                                                      06790000
068000                                                                  06800000
068100     IF  XL067-TEMP-SQLCODE > 0                                   06810000
068200         MOVE XL067-TEMP-SQLCODE TO                               06820000
068300              DL016-CALL-MOD-FAIL-SQL-CDE                         06830000
068400         IF  XL067-TEMP-NOT-FOUND                                 06840000
068500             MOVE XL067-TEMP-NOT-FOUND-NBR TO                     06850000
068600                  DL016-CALL-MOD-FAIL-SQL-PARA                    06860000
068700         ELSE                                                     06870000
068800             IF  XL067-TEMP-CONTENTION                            06880000
068900                 MOVE XL067-TEMP-CONTENTION-NBR TO                06890000
069000                      DL016-CALL-MOD-FAIL-SQL-PARA                06900000
069100             ELSE                                                 06910000
069200                 MOVE XL067-TEMP-ERROR-NBR TO                     06920000
069300                      DL016-CALL-MOD-FAIL-SQL-PARA                06930000
069400             END-IF                                               06940000
069500         END-IF                                                   06950000
069600     END-IF.                                                      06960000
069700                                                                  06970000
069800*-----------------------------------------------------------------06980000
069900*  THIS WILL CONTROL THE PROCESS TO CREATE AN ASSIGNMENT IF      *06990000
070000*  NEEDED AND ALSO ATTACH THE ASSOCIATE TO AN ASSIGNMENT         *07000000
070100*-----------------------------------------------------------------07010000
070200 2000-ESTABLISH-ASGMT.                                            07020000
070300                                                                  07030000
070400***  MOVE SPACES TO PV-CICS-MSG-AREA2                             07040000
070500***  MOVE ' DLKCS410 - 2000-ESTABLISH-ASGMT         '             07050000
070600***    TO PV-CICS-MSG-AREA2                                       07060000
070700***  MOVE LENGTH OF PV-CICS-MSG-AREA2                             07070000
070800***    TO PV-COMMAREA-LENGTH                                      07080000
070900***  PERFORM 9200-WRITE-TO-CSSL                                   07090000
071000                                                                  07100000
071100     PERFORM 2200-CHECK-FOR-ASGMT.                                07110000
071200                                                                  07120000
071300     PERFORM 2400-CHECK-FOR-USR-ON-ASGMT.                         07130000
071400                                                                  07140000
071500     IF  DL004-ASGMT-FOUND                                        07150000
071600     AND DL003-ASGMT-FOUND                                        07160000
071700         SET PS-ASGMTS-DO-NOT-MATCH  TO TRUE                      07170000
071800         PERFORM 2020-COMPARE-ASGMTS                              07180000
071900         IF  PS-ASGMTS-MATCH                                      07190000
072000             SET DL016-SUCCESSFUL TO TRUE                         07200000
072100             SET DL016-ESO-EXIST-ASGMT-FOUND TO TRUE              07210000
072200             SET DL016-ESO-EMP-EXIST-ON-ASGMT TO TRUE             07220000
072300             MOVE DL003-ASGMT-START-DTE TO                        07230000
072400                  DL016-ESO-ASGMT-START-DTE                       07240000
072500             MOVE DL003-ASGMT-NBR-TXT TO                          07250000
072600                  DL016-ESO-ASGMT-NBR-TXT                         07260000
072700             MOVE DL003-ASGMT-NBR-SEQ-NBR TO                      07270000
072800                  DL016-ESO-ASGMT-NBR-SEQ-NBR                     07280000
072900             PERFORM 9000-RETURN-CALL                             07290000
073000         ELSE                                                     07300000
073100             MOVE DL003-ASGMT-START-DTE TO                        07310000
073200                  PV-HOLD-ASGMT-START-DTE                         07320000
073300             MOVE DL003-ASGMT-NBR-TXT TO                          07330000
073400                  PV-HOLD-ASGMT-NBR-TXT                           07340000
073500             MOVE DL003-ASGMT-NBR-SEQ-NBR TO                      07350000
073600                  PV-HOLD-ASGMT-NBR-SEQ-NBR                       07360000
073700             MOVE DL003-TEM-ASGMT-SEQ-NBR TO                      07370000
073800                  PV-HOLD-TEM-ASGMT-SEQ-NBR                       07380000
073900             PERFORM 2600-END-FROM-ASGMT                          07390000
074000             IF  DL005-ASSOC-FOUND                                07400000
074100                 PERFORM 3200-GENERATE-S-MOVE                     07410000
074200             END-IF                                               07420000
074300             MOVE DL004-ASGMT-START-DTE TO                        07430000
074400                  PV-HOLD-ASGMT-START-DTE                         07440000
074500             MOVE DL004-ASGMT-NBR-TXT TO                          07450000
074600                  PV-HOLD-ASGMT-NBR-TXT                           07460000
074700             MOVE DL004-ASGMT-NBR-SEQ-NBR TO                      07470000
074800                  PV-HOLD-ASGMT-NBR-SEQ-NBR                       07480000
074900             PERFORM 2800-ADD-TO-ASGMT                            07490000
075000             SET DL016-SUCCESSFUL TO TRUE                         07500000
075100             SET DL016-ESO-EXIST-ASGMT-FOUND TO TRUE              07510000
075200             SET DL016-ESO-EMP-ENDADD-ASGMT TO TRUE               07520000
075300             MOVE DL004-ASGMT-START-DTE TO                        07530000
075400                  DL016-ESO-ASGMT-START-DTE                       07540000
075500             MOVE DL004-ASGMT-NBR-TXT TO                          07550000
075600                  DL016-ESO-ASGMT-NBR-TXT                         07560000
075700             MOVE DL004-ASGMT-NBR-SEQ-NBR TO                      07570000
075800                  DL016-ESO-ASGMT-NBR-SEQ-NBR                     07580000
075900             PERFORM 9000-RETURN-CALL                             07590000
076000         END-IF                                                   07600000
076100     ELSE                                                         07610000
076200         IF  DL004-ASGMT-FOUND                                    07620000
076300             MOVE DL004-ASGMT-START-DTE TO                        07630000
076400                  PV-HOLD-ASGMT-START-DTE                         07640000
076500             MOVE DL004-ASGMT-NBR-TXT TO                          07650000
076600                  PV-HOLD-ASGMT-NBR-TXT                           07660000
076700             MOVE DL004-ASGMT-NBR-SEQ-NBR TO                      07670000
076800                  PV-HOLD-ASGMT-NBR-SEQ-NBR                       07680000
076900             PERFORM 2800-ADD-TO-ASGMT                            07690000
077000             SET DL016-SUCCESSFUL TO TRUE                         07700000
077100             SET DL016-ESO-EXIST-ASGMT-FOUND TO TRUE              07710000
077200             SET DL016-ESO-EMP-NEW-TO-ASGMT TO TRUE               07720000
077300             MOVE DL004-ASGMT-START-DTE TO                        07730000
077400                  DL016-ESO-ASGMT-START-DTE                       07740000
077500             MOVE DL004-ASGMT-NBR-TXT TO                          07750000
077600                  DL016-ESO-ASGMT-NBR-TXT                         07760000
077700             MOVE DL004-ASGMT-NBR-SEQ-NBR TO                      07770000
077800                  DL016-ESO-ASGMT-NBR-SEQ-NBR                     07780000
077900             PERFORM 9000-RETURN-CALL                             07790000
078000         ELSE                                                     07800000
078100             IF  DL003-ASGMT-FOUND                                07810000
078200                 MOVE DL003-ASGMT-START-DTE TO                    07820000
078300                      PV-HOLD-ASGMT-START-DTE                     07830000
078400                 MOVE DL003-ASGMT-NBR-TXT TO                      07840000
078500                      PV-HOLD-ASGMT-NBR-TXT                       07850000
078600                 MOVE DL003-ASGMT-NBR-SEQ-NBR TO                  07860000
078700                      PV-HOLD-ASGMT-NBR-SEQ-NBR                   07870000
078800                 MOVE DL003-TEM-ASGMT-SEQ-NBR TO                  07880000
078900                      PV-HOLD-TEM-ASGMT-SEQ-NBR                   07890000
079000                 PERFORM 2600-END-FROM-ASGMT                      07900000
079100                 IF  DL005-ASSOC-FOUND                            07910000
079200                     PERFORM 3200-GENERATE-S-MOVE                 07920000
079300                 END-IF                                           07930000
079400                 PERFORM 3000-CREATE-NEW-ASGMT                    07940000
079500                 SET DL016-SUCCESSFUL TO TRUE                     07950000
079600                 SET DL016-ESO-NEW-ASGMT-CREATE TO TRUE           07960000
079700                 SET DL016-ESO-EMP-ENDADD-ASGMT TO TRUE           07970000
079800                 MOVE DL007-NEW-START-DTE TO                      07980000
079900                      DL016-ESO-ASGMT-START-DTE                   07990000
080000                 MOVE DL007-NEW-NBR-TXT TO                        08000000
080100                      DL016-ESO-ASGMT-NBR-TXT                     08010000
080200                 MOVE DL007-NEW-ASGMT-NBR-SEQ-NBR TO              08020000
080300                      DL016-ESO-ASGMT-NBR-SEQ-NBR                 08030000
080400                 PERFORM 9000-RETURN-CALL                         08040000
080500             ELSE                                                 08050000
080600                 PERFORM 3000-CREATE-NEW-ASGMT                    08060000
080700                 SET DL016-SUCCESSFUL TO TRUE                     08070000
080800                 SET DL016-ESO-NEW-ASGMT-CREATE TO TRUE           08080000
080900                 SET DL016-ESO-EMP-NEW-TO-ASGMT TO TRUE           08090000
081000                 MOVE DL007-NEW-START-DTE TO                      08100000
081100                      DL016-ESO-ASGMT-START-DTE                   08110000
081200                 MOVE DL007-NEW-NBR-TXT TO                        08120000
081300                      DL016-ESO-ASGMT-NBR-TXT                     08130000
081400                 MOVE DL007-NEW-ASGMT-NBR-SEQ-NBR TO              08140000
081500                      DL016-ESO-ASGMT-NBR-SEQ-NBR                 08150000
081600                 PERFORM 9000-RETURN-CALL                         08160000
081700             END-IF                                               08170000
081800         END-IF                                                   08180000
081900     END-IF.                                                      08190000
082000                                                                  08200000
082100                                                                  08210000
082200 2020-COMPARE-ASGMTS.                                             08220000
082300                                                                  08230000
082400***  MOVE SPACES TO PV-CICS-MSG-AREA2                             08240000
082500***  MOVE ' DLKCS410 - 2020-COMPARE-ASGMTS          '             08250000
082600***    TO PV-CICS-MSG-AREA2                                       08260000
082700***  MOVE LENGTH OF PV-CICS-MSG-AREA2                             08270000
082800***    TO PV-COMMAREA-LENGTH                                      08280000
082900***  PERFORM 9200-WRITE-TO-CSSL                                   08290000
083000                                                                  08300000
083100     IF  (DL003-ASGMT-START-DTE IS EQUAL TO                       08310000
083200          DL004-ASGMT-START-DTE)                                  08320000
083300     AND (DL003-ASGMT-NBR-TXT IS EQUAL TO                         08330000
083400          DL004-ASGMT-NBR-TXT)                                    08340000
083500     AND (DL003-ASGMT-NBR-SEQ-NBR IS EQUAL TO                     08350000
083600          DL004-ASGMT-NBR-SEQ-NBR)                                08360000
083700          SET PS-ASGMTS-MATCH TO TRUE                             08370000
083800     END-IF.                                                      08380000
083900                                                                  08390000
084000* THE FOLLOWING IS TO PROCES THE CALL TO DLKUT002                 08400000
084100 2200-CHECK-FOR-ASGMT.                                            08410000
084200                                                                  08420000
084300***  MOVE SPACES TO PV-CICS-MSG-AREA2                             08430000
084400***  MOVE ' DLKCS410 - 2200-CHECK-FOR-ASGMT         '             08440000
084500***    TO PV-CICS-MSG-AREA2                                       08450000
084600***  MOVE LENGTH OF PV-CICS-MSG-AREA2                             08460000
084700***    TO PV-COMMAREA-LENGTH                                      08470000
084800***  PERFORM 9200-WRITE-TO-CSSL                                   08480000
084900                                                                  08490000
084910*                                                                 08491002
084920*** DMH - 11/13/14 BEGIN --- REPLACE INITIALIZE WITH SPACE/ZERO   08492002
084930*                                                                 08493002
085000***  INITIALIZE  DL004-ASGMT-COMMAREA.                            08500002
085001                                                                  08500102
085002     MOVE  SPACES  TO  DL004-ACCESS-METHOD                        08500204
085003                       DL004-KEY-WK-TYP                           08500304
085004                       DL004-KEY-WK-AREA                          08500402
085005                       DL004-RETURN-CODE                          08500502
085006                       DL004-ORIG-CALLING-PGM-NM                  08500602
085007                       DL004-SQL-ERROR-PARA                       08500702
085008                       DL004-CALL-MOD-FAIL-NM                     08500802
085009                       DL004-CALL-MOD-FAIL-ERR-CDE                08500902
085011                       DL004-ASGMT-FOUND-CODE                     08501102
085012                       DL004-ASGMT-START-DTE                      08501202
085013                       DL004-ASGMT-NBR-TXT                        08501302
085014                       DL004-ASGMT-STRT-TM                        08501402
085015                       DL004-ASGMT-CRE-BY-USR-ID                  08501502
085016                       DL004-ASGMT-CRE-BY-PGM-NM                  08501604
085017                       DL004-SQLCA                                08501704
085018                       DL004-COMMAREA.                            08501804
085019                                                                  08501902
085020     MOVE  ZEROES  TO  DL004-KEY-DC-NBR                           08502002
085030                       DL004-ASGMT-SQLCODE                        08503002
085036                       DL004-ASGMT-FOUND-QTY                      08503602
085044                       DL004-ASGMT-NBR-SEQ-NBR                    08504402
085053                       DL004-ASGMT-LAST-USD-SEQ-NBR               08505302
085054                       DL004-ASGMT-ACTV-USR-QTY.                  08505402
085056                                                                  08505602
085061*                                                                 08506102
085062*** DMH - 11/13/14 END                                            08506202
085070*                                                                 08507002
085100                                                                  08510000
085200     MOVE DL016-CALLING-PGM-NM TO                                 08520000
085300          DL004-ORIG-CALLING-PGM-NM.                              08530000
085400                                                                  08540000
085500     MOVE DL016-ASGMT-NBR-WRK-TYP     TO DL004-KEY-WK-TYP         08550000
085600     MOVE DL016-EAI-WK-AREA-DESC      TO DL004-KEY-WK-AREA        08560000
085700     MOVE DL016-EAI-DC-NBR            TO DL004-KEY-DC-NBR         08570000
085800                                                                  08580000
085900     SET DL004-BY-WK-TYP-AREA-KEY TO TRUE.                        08590000
086000     SET PS-NO-CALLED-MODULE-ERROR TO TRUE.                       08600000
086100                                                                  08610000
086200     PERFORM 6100-CALL-DLKUT002.                                  08620000
086300                                                                  08630000
086400     IF  PS-CALLED-MODULE-ERROR                                   08640000
086500         SET PS-ERROR TO TRUE                                     08650000
086600         MOVE 'DLKUT002' TO DL016-CALL-MOD-FAIL-NM                08660000
086700         MOVE DL004-RETURN-CODE TO DL016-CALL-MOD-FAIL-ERR-CDE    08670000
086800         SET DL016-CALLED-MODULE-FAILURE TO TRUE                  08680000
086900         IF  DL004-SQL-ERROR                                      08690000
087000             MOVE DL004-ASGMT-SQLCODE TO                          08700000
087100                  DL016-CALL-MOD-FAIL-SQL-CDE                     08710000
087200             MOVE DL004-SQL-ERROR-PARA TO                         08720000
087300                  DL016-CALL-MOD-FAIL-SQL-PARA                    08730000
087400         END-IF                                                   08740000
087500         PERFORM 9000-RETURN-CALL                                 08750000
087600     ELSE                                                         08760000
087700                                                                  08770000
087800*** DMH - 12/07/2009 - BEGIN                                      08780000
087900         IF  DL004-ASGMT-MULT-FOUND                               08790000
088000             PERFORM 4500-CALL-DLKUT030                           08800000
088100         END-IF                                                   08810000
088200*** DMH - 12/07/2009 - END                                        08820000
088300                                                                  08830000
088400     END-IF.                                                      08840000
088500                                                                  08850000
088600     IF  DL004-ASGMT-NOT-FOUND                                    08860000
088700         SET PS-CREATE-NEW-ASGMT TO TRUE                          08870000
088800     END-IF.                                                      08880000
088900                                                                  08890000
089000                                                                  08900000
089100* THE FOLLOWING IS TO PROCES THE CALL TO DLKUT001                 08910000
089200 2400-CHECK-FOR-USR-ON-ASGMT.                                     08920000
089300                                                                  08930000
089400***  MOVE SPACES TO PV-CICS-MSG-AREA2                             08940000
089500***  MOVE ' DLKCS410 - 2400-CHECK-FOR-USR-ON-ASGMT  '             08950000
089600***    TO PV-CICS-MSG-AREA2                                       08960000
089700***  MOVE LENGTH OF PV-CICS-MSG-AREA2                             08970000
089800***    TO PV-COMMAREA-LENGTH                                      08980000
089900***  PERFORM 9200-WRITE-TO-CSSL                                   08990000
090000                                                                  09000000
090100     INITIALIZE  DL003-ASGMT-COMMAREA.                            09010000
090200                                                                  09020000
090300     MOVE PV-HOLD-USR-ID TO                                       09030000
090400          DL003-KEY-USER-ID.                                      09040000
090500     MOVE DL016-CALLING-PGM-NM TO                                 09050000
090600          DL003-ORIG-CALLING-PGM-NM.                              09060000
090700                                                                  09070000
090800     SET DL003-BY-USER-KEY TO TRUE.                               09080000
090900     SET PS-NO-CALLED-MODULE-ERROR TO TRUE.                       09090000
091000                                                                  09100000
091100     PERFORM 6200-CALL-DLKUT001.                                  09110000
091200                                                                  09120000
091300     IF  PS-CALLED-MODULE-ERROR                                   09130000
091400         SET PS-ERROR TO TRUE                                     09140000
091500         MOVE 'DLKUT001' TO DL016-CALL-MOD-FAIL-NM                09150000
091600         MOVE DL003-RETURN-CODE TO DL016-CALL-MOD-FAIL-ERR-CDE    09160000
091700         SET DL016-CALLED-MODULE-FAILURE TO TRUE                  09170000
091800         IF  DL003-SQL-ERROR                                      09180000
091900             MOVE DL003-ASGMT-SQLCODE TO                          09190000
092000                  DL016-CALL-MOD-FAIL-SQL-CDE                     09200000
092100             MOVE DL003-SQL-ERROR-PARA TO                         09210000
092200                  DL016-CALL-MOD-FAIL-SQL-PARA                    09220000
092300         END-IF                                                   09230000
092400         PERFORM 9000-RETURN-CALL                                 09240000
092500     ELSE                                                         09250000
092600         IF  DL003-ASGMT-MULT-FOUND                               09260000
092700             SET PS-ERROR TO TRUE                                 09270000
092800             MOVE 'DLKUT001' TO DL016-CALL-MOD-FAIL-NM            09280000
092900             MOVE DL003-RETURN-CODE TO                            09290000
093000                  DL016-CALL-MOD-FAIL-ERR-CDE                     09300000
093100             SET DL016-CALLED-MODULE-FAILURE TO TRUE              09310000
093200             MOVE SPACES TO PV-CICS-MSG-AREA2                     09320000
093300             STRING ' DLKCS410 - '           DELIMITED BY SIZE    09330000
093400                    'CALLED MODULE SUCCESS'  DELIMITED BY SIZE    09340000
093500                                           INTO PV-CICS-MSG-AREA2 09350000
093600             MOVE LENGTH OF PV-CICS-MSG-AREA2                     09360000
093700               TO PV-COMMAREA-LENGTH                              09370000
093800             PERFORM 9200-WRITE-TO-CSSL                           09380000
093900             MOVE SPACES TO PV-CICS-MSG-AREA2                     09390000
094000             MOVE '6200-CALL-DLKUT001' TO PV-MODULE-PARAGRPAH     09400000
094100             STRING ' DLKCS410 - '           DELIMITED BY SIZE    09410000
094200                    PV-MODULE-FAIL-MSG       DELIMITED BY SIZE    09420000
094300                    ' WITH RETURN CODE - '   DELIMITED BY SIZE    09430000
094400                    DL003-RETURN-CODE        DELIMITED BY SIZE    09440000
094500                    ' BUT HAD MULT ASGMTS'   DELIMITED BY SIZE    09450000
094600                                           INTO PV-CICS-MSG-AREA2 09460000
094700             MOVE LENGTH OF PV-CICS-MSG-AREA2                     09470000
094800               TO PV-COMMAREA-LENGTH                              09480000
094900             PERFORM 9200-WRITE-TO-CSSL                           09490000
095000             MOVE SPACES TO PV-CICS-MSG-AREA2                     09500000
095100             MOVE DL003-ASGMT-FOUND-QTY TO                        09510000
095200                  PV-DISPLAY-QTY-5                                09520000
095300             STRING ' DLKCS410 - '           DELIMITED BY SIZE    09530000
095400                    'HAD MULT ASGMT FOR '    DELIMITED BY SIZE    09540000
095500                    'USER ID '               DELIMITED BY SIZE    09550000
095600                    DL003-KEY-USER-ID        DELIMITED BY SIZE    09560000
095700                    ' NBR ASGMTS FOUND IS '  DELIMITED BY SIZE    09570000
095800                    PV-DISPLAY-QTY-5         DELIMITED BY SIZE    09580000
095900                                           INTO PV-CICS-MSG-AREA2 09590000
096000             MOVE LENGTH OF PV-CICS-MSG-AREA2                     09600000
096100               TO PV-COMMAREA-LENGTH                              09610000
096200             PERFORM 9200-WRITE-TO-CSSL                           09620000
096300             PERFORM 9000-RETURN-CALL                             09630000
096400         END-IF                                                   09640000
096500     END-IF.                                                      09650000
096600                                                                  09660000
096700* THE FOLLOWING IS TO PROCES THE CALL TO DLKUP002 TO              09670000
096800* END ASSOCIATE FROM AN ASSIGNMENT                                09680000
096900 2600-END-FROM-ASGMT.                                             09690000
097000                                                                  09700000
097100***  MOVE SPACES TO PV-CICS-MSG-AREA2                             09710000
097200***  MOVE ' DLKCS410 - 2600-END-FROM-ASGMT          '             09720000
097300***    TO PV-CICS-MSG-AREA2                                       09730000
097400***  MOVE LENGTH OF PV-CICS-MSG-AREA2                             09740000
097500***    TO PV-COMMAREA-LENGTH                                      09750000
097600***  PERFORM 9200-WRITE-TO-CSSL                                   09760000
097700                                                                  09770000
097800     INITIALIZE DL005-ASGMT-COMMAREA.                             09780000
097900                                                                  09790000
098000     MOVE PV-HOLD-ASGMT-START-DTE TO                              09800000
098100          DL005-KEY-START-DTE.                                    09810000
098200     MOVE PV-HOLD-ASGMT-NBR-TXT TO                                09820000
098300          DL005-KEY-NBR-TXT.                                      09830000
098400     MOVE PV-HOLD-ASGMT-NBR-SEQ-NBR TO                            09840000
098500          DL005-KEY-NBR-SEQ-NBR.                                  09850000
098600     MOVE PV-HOLD-TEM-ASGMT-SEQ-NBR TO                            09860000
098700          DL005-KEY-TEM-ASGMT-SEQ-NBR.                            09870000
098800     MOVE PV-HOLD-USR-ID TO                                       09880000
098900          DL005-KEY-ADD-BY-USER-ID                                09890000
099000          DL005-KEY-USER-ID.                                      09900000
099100     MOVE PV-HOLD-USR-TYP-CDE TO                                  09910000
099200          DL005-KEY-USR-TYPE-CDE.                                 09920000
099300     MOVE PC-CURRENT-PROGRAM-NAME TO                              09930000
099400          DL005-KEY-LVE-PGM-NM.                                   09940000
099500     MOVE DL016-CALLING-PGM-NM TO                                 09950000
099600          DL005-ORIG-CALLING-PGM-NM.                              09960000
099700                                                                  09970000
099800     SET DL005-BY-ASGMT-NBR TO TRUE.                              09980000
099900     SET DL005-END-FROM-ASGMT TO TRUE.                            09990000
100000     SET DL005-COMMIT-UPDATE TO TRUE.                             10000000
100100     SET DL005-KEY-LVE-RSN-SMOVE TO TRUE.                         10010000
100200     SET PS-NO-CALLED-MODULE-ERROR TO TRUE.                       10020000
100300     MOVE ' END ' TO PV-DISPLAY-TEXT.                             10030000
100400                                                                  10040000
100500     PERFORM 6300-CALL-DLKUP002.                                  10050000
100600                                                                  10060000
100700     IF  PS-CALLED-MODULE-ERROR                                   10070000
100800         SET PS-ERROR TO TRUE                                     10080000
100900         MOVE 'DLKUP002' TO DL016-CALL-MOD-FAIL-NM                10090000
101000         MOVE DL005-RETURN-CODE TO DL016-CALL-MOD-FAIL-ERR-CDE    10100000
101100         SET DL016-CALLED-MODULE-FAILURE TO TRUE                  10110000
101200         IF  DL005-SQL-ERROR                                      10120000
101300             MOVE DL005-ASGMT-SQLCODE TO                          10130000
101400                  DL016-CALL-MOD-FAIL-SQL-CDE                     10140000
101500             MOVE DL005-SQL-ERROR-PARA TO                         10150000
101600                  DL016-CALL-MOD-FAIL-SQL-PARA                    10160000
101700         END-IF                                                   10170000
101800         PERFORM 9000-RETURN-CALL                                 10180000
101900     END-IF.                                                      10190000
102000                                                                  10200000
102100                                                                  10210000
102200* THE FOLLOWING IS TO PROCES THE CALL TO DLKUP002 TO              10220000
102300* ADD ASSOCIATE TO AN ASSIGNMENT                                  10230000
102400 2800-ADD-TO-ASGMT.                                               10240000
102500                                                                  10250000
102600***  MOVE SPACES TO PV-CICS-MSG-AREA2                             10260000
102700***  MOVE ' DLKCS410 - 2800-ADD-TO-ASGMT            '             10270000
102800***    TO PV-CICS-MSG-AREA2                                       10280000
102900***  MOVE LENGTH OF PV-CICS-MSG-AREA2                             10290000
103000***    TO PV-COMMAREA-LENGTH                                      10300000
103100***  PERFORM 9200-WRITE-TO-CSSL                                   10310000
103200                                                                  10320000
103300     INITIALIZE DL005-ASGMT-COMMAREA.                             10330000
103400                                                                  10340000
103500     MOVE PV-HOLD-ASGMT-START-DTE TO                              10350000
103600          DL005-KEY-START-DTE.                                    10360000
103700     MOVE PV-HOLD-ASGMT-NBR-TXT TO                                10370000
103800          DL005-KEY-NBR-TXT.                                      10380000
103900     MOVE PV-HOLD-ASGMT-NBR-SEQ-NBR TO                            10390000
104000          DL005-KEY-NBR-SEQ-NBR.                                  10400000
104100     MOVE PV-HOLD-USR-ID TO                                       10410000
104200          DL005-KEY-ADD-BY-USER-ID                                10420000
104300          DL005-KEY-USER-ID.                                      10430000
104400     MOVE PV-HOLD-USR-TYP-CDE TO                                  10440000
104500          DL005-KEY-USR-TYPE-CDE.                                 10450000
104600     MOVE PC-CURRENT-PROGRAM-NAME TO                              10460000
104700          DL005-KEY-LVE-PGM-NM.                                   10470000
104800     MOVE DL016-CALLING-PGM-NM TO                                 10480000
104900          DL005-ORIG-CALLING-PGM-NM.                              10490000
105000                                                                  10500000
105100     SET DL005-BY-ASGMT-NBR TO TRUE.                              10510000
105200     SET DL005-ADD-TO-ASGMT TO TRUE.                              10520000
105300     SET DL005-COMMIT-UPDATE TO TRUE.                             10530000
105400     SET PS-NO-CALLED-MODULE-ERROR TO TRUE.                       10540000
105500     MOVE ' ADD ' TO PV-DISPLAY-TEXT.                             10550000
105600                                                                  10560000
105700     PERFORM 6300-CALL-DLKUP002.                                  10570000
105800                                                                  10580000
105900     IF  PS-CALLED-MODULE-ERROR                                   10590000
106000         SET PS-ERROR TO TRUE                                     10600000
106100         MOVE 'DLKUP002' TO DL016-CALL-MOD-FAIL-NM                10610000
106200         MOVE DL005-RETURN-CODE TO DL016-CALL-MOD-FAIL-ERR-CDE    10620000
106300         SET DL016-CALLED-MODULE-FAILURE TO TRUE                  10630000
106400         IF  DL005-SQL-ERROR                                      10640000
106500             MOVE DL005-ASGMT-SQLCODE TO                          10650000
106600                  DL016-CALL-MOD-FAIL-SQL-CDE                     10660000
106700             MOVE DL005-SQL-ERROR-PARA TO                         10670000
106800                  DL016-CALL-MOD-FAIL-SQL-PARA                    10680000
106900         END-IF                                                   10690000
107000         PERFORM 9000-RETURN-CALL                                 10700000
107100     END-IF.                                                      10710000
107200                                                                  10720000
107300* THE FOLLOWING IS TO PROCES THE CALL TO DLKUP003 TO              10730000
107400* CREATE A NEW ASSIGNMENT                                         10740000
107500 3000-CREATE-NEW-ASGMT.                                           10750000
107600                                                                  10760000
107700***  MOVE SPACES TO PV-CICS-MSG-AREA2                             10770000
107800***  MOVE ' DLKCS410 - 2800-ADD-TO-ASGMT            '             10780000
107900***    TO PV-CICS-MSG-AREA2                                       10790000
108000***  MOVE LENGTH OF PV-CICS-MSG-AREA2                             10800000
108100***    TO PV-COMMAREA-LENGTH                                      10810000
108200***  PERFORM 9200-WRITE-TO-CSSL                                   10820000
108300                                                                  10830000
108400     PERFORM 3020-GET-DATE-TIME.                                  10840000
108500                                                                  10850000
108600     MOVE PV-LABOR-CURRENT-DATE TO                                10860000
108700          DL007-NA-FLD-START-DTE.                                 10870000
108800     MOVE PV-LABOR-CURRENT-TIME TO                                10880000
108900          DL007-NA-FLD-START-TM.                                  10890000
109000     MOVE DL016-EAI-DC-NBR TO                                     10900000
109100          DL011-KEY-ASGMT-NBR-DC                                  10910000
109200          DL007-NA-FLD-DC-NBR.                                    10920000
109300     MOVE DL016-ASGMT-NBR-WRK-TYP TO                              10930000
109400          DL011-KEY-ASGMT-NBR-WRK-TYP.                            10940000
109500     MOVE DL011-KEY-ASGMT-NBR-TXT TO                              10950000
109600          DL007-NA-FLD-NBR-TXT.                                   10960000
109700     MOVE PV-HOLD-USR-ID TO                                       10970000
109800          DL007-NA-FLD-CRE-BY-USR-ID.                             10980000
109900     MOVE PV-HOLD-USR-TYP-CDE TO                                  10990000
110000          DL007-NA-FLD-USR-TYP-CDE.                               11000000
110100     MOVE DL016-CALLING-PGM-NM TO                                 11010000
110200          DL007-ORIG-CALLING-PGM-NM                               11020000
110300          DL007-NA-FLD-CRE-PGM-NM.                                11030000
110400     MOVE DL016-EAI-WK-TYP-DESC TO                                11040000
110500          DL007-NA-FLD-WK-TYP-DESC.                               11050000
110600     MOVE DL016-EAI-WK-AREA-DESC TO                               11060000
110700          DL007-NA-FLD-WK-AREA-DESC.                              11070000
110800                                                                  11080000
110900     SET DL007-CREATE-NEW-ASGMT-WTEAM TO TRUE.                    11090000
111000     SET DL007-COMMIT-UPDATE TO TRUE.                             11100000
111100     SET DL007-NO-LOG-TO-EAI-EXPORT TO TRUE.                      11110000
111200                                                                  11120000
111300     PERFORM 6400-CALL-DLKUP003.                                  11130000
111400                                                                  11140000
111500     IF  PS-CALLED-MODULE-ERROR                                   11150000
111600         SET PS-ERROR TO TRUE                                     11160000
111700         MOVE 'DLKUP003' TO DL016-CALL-MOD-FAIL-NM                11170000
111800         MOVE DL007-RETURN-CODE TO DL016-CALL-MOD-FAIL-ERR-CDE    11180000
111900         MOVE DL007-SQLCA       TO DL016-SQLCA                    11190000
112000         SET DL016-CALLED-MODULE-FAILURE TO TRUE                  11200000
112100         IF  DL007-SQL-ERROR                                      11210000
112200             MOVE DL007-ASGMT-SQLCODE TO                          11220000
112300                  DL016-CALL-MOD-FAIL-SQL-CDE                     11230000
112400             MOVE DL007-SQL-ERROR-PARA TO                         11240000
112500                  DL016-CALL-MOD-FAIL-SQL-PARA                    11250000
112600         END-IF                                                   11260000
112700         PERFORM 9000-RETURN-CALL                                 11270000
112800     END-IF.                                                      11280000
112900                                                                  11290000
113000                                                                  11300000
113100 3020-GET-DATE-TIME.                                              11310000
113200                                                                  11320000
113300***  MOVE SPACES TO PV-CICS-MSG-AREA2                             11330000
113400***  MOVE ' DLKCS410 - 3020-GET-DATE-TIME           '             11340000
113500***    TO PV-CICS-MSG-AREA2                                       11350000
113600***  MOVE LENGTH OF PV-CICS-MSG-AREA2                             11360000
113700***    TO PV-COMMAREA-LENGTH                                      11370000
113800***  PERFORM 9200-WRITE-TO-CSSL                                   11380000
113900                                                                  11390000
114000     EXEC SQL                                                     11400000
114100          SET  :PV-LABOR-CURRENT-DATE  =  CURRENT_DATE            11410000
114200              ,:PV-LABOR-CURRENT-TIME  =  CURRENT_TIME            11420000
114300     END-EXEC.                                                    11430000
114400                                                                  11440000
114500                                                                  11450000
114600* THE FOLLOWING IS TO PROCESS THE CALL TO XLKUP033 TO LOG AN      11460000
114700* INDIRECT CODE OF AN S (SYSTEM) MOVE FOR THE ASSOCIATE           11470000
114800 3200-GENERATE-S-MOVE.                                            11480000
114900                                                                  11490000
115000***  MOVE SPACES TO PV-CICS-MSG-AREA2                             11500000
115100***  MOVE ' DLKCS410 - 3200-GENERATE-S-MOVE         '             11510000
115200***    TO PV-CICS-MSG-AREA2                                       11520000
115300***  MOVE LENGTH OF PV-CICS-MSG-AREA2                             11530000
115400***    TO PV-COMMAREA-LENGTH                                      11540000
115500***  PERFORM 9200-WRITE-TO-CSSL                                   11550000
115600                                                                  11560000
115700     INITIALIZE XL072-EAI-EXPORT-COMMAREA.                        11570000
115800                                                                  11580000
115900     SET XL072-PC-APP-ID                                          11590000
116000         XL072-COMMIT-UPDATE TO TRUE.                             11600000
116100                                                                  11610000
116200     MOVE PC-CURRENT-PROGRAM-NAME TO XL072-CRE-PGM-NM.            11620000
116300                                                                  11630000
116400     MOVE ZEROES                  TO XL072-EVNT-KY-1-NBR          11640000
116500                                     XL072-EVNT-KY-2-NBR          11650000
116600                                     XL072-EVNT-KY-3-NBR          11660000
116700                                     XL072-EVNT-KY-4-NBR          11670000
116800                                     XL072-EVNT-KY-5-NBR.         11680000
116900                                                                  11690000
117000     MOVE SPACES                  TO XL072-EVNT-KY-1-TXT          11700000
117100                                     XL072-EVNT-KY-2-TXT          11710000
117200                                     XL072-EVNT-KY-3-TXT          11720000
117300                                     XL072-EVNT-KY-4-TXT          11730000
117400                                     XL072-EVNT-KY-5-TXT          11740000
117500                                     XL072-EVNT-KY-1-TMST         11750000
117600                                     XL072-EVNT-KY-2-TMST         11760000
117700                                     XL072-EVNT-KY-3-TMST         11770000
117800                                     XL072-EVNT-KY-4-TMST         11780000
117900                                     XL072-EVNT-KY-5-TMST.        11790000
118000                                                                  11800000
118100     MOVE 'DC LABOR'          TO XL072-EVNT-OBJ-TXT.              11810000
118200     MOVE 'INDIRECT LABOR'    TO XL072-EVNT-OBJ-ACTN-TXT.         11820000
118300     MOVE PV-HOLD-USR-ID      TO XL072-CRE-BY-USR-ID.             11830000
118400     MOVE DL016-EAI-DC-NBR    TO XL072-EVNT-KY-1-NBR.             11840000
118500***  MOVE 'SMOVE'             TO XL072-EVNT-KY-1-TXT.             11850000
118600     IF DL003-ASGMT-WK-TYP-DESC = 'RECV'                          11860000
118700         MOVE 'SRMOVE'                TO XL072-EVNT-KY-1-TXT      11870000
118800     END-IF.                                                      11880000
118900     IF DL003-ASGMT-WK-TYP-DESC = 'SHIP'                          11890000
119000         MOVE 'SSMOVE'                TO XL072-EVNT-KY-1-TXT      11900000
119100     END-IF.                                                      11910000
119200     IF DL003-ASGMT-WK-TYP-DESC = 'P2L'                           11920000
119300         MOVE 'SPMOVE'                TO XL072-EVNT-KY-1-TXT      11930000
119400     END-IF.                                                      11940000
119500     IF DL003-ASGMT-WK-TYP-DESC = 'FLAT'                          11950000
119600         MOVE 'SFMOVE'                TO XL072-EVNT-KY-1-TXT      11960000
119700     END-IF.                                                      11970000
119800     IF DL003-ASGMT-WK-TYP-DESC = 'RLABL'                         11980000
119900         MOVE 'SLMOVE'                TO XL072-EVNT-KY-1-TXT      11990000
120000     END-IF.                                                      12000000
120100     IF DL003-ASGMT-WK-TYP-DESC = 'MASTCON'                       12010000
120200         MOVE 'SMMOVE'                TO XL072-EVNT-KY-1-TXT      12020000
120300     END-IF.                                                      12030000
120400                                                                  12040000
120500     MOVE DL005-ASSOC-TMST    TO PV-HOLD-TIMESTAMP.               12050000
120600     PERFORM 3220-GET-TIMESTAMP.                                  12060000
120700     MOVE PV-LABOR-CURRENT-TIMESTAMP TO XL072-EVNT-KY-1-TMST.     12070000
120800                                                                  12080000
120900     SET XL072-COPYBOOK-NOT-USED TO TRUE.                         12090000
121000                                                                  12100000
121100     PERFORM 6500-CALL-XLKUP033.                                  12110000
121200                                                                  12120000
121300     IF  PS-CALLED-MODULE-ERROR                                   12130000
121400         SET PS-ERROR TO TRUE                                     12140000
121500         MOVE 'XLKUP033' TO DL016-CALL-MOD-FAIL-NM                12150000
121600         MOVE XL072-RETURN-CODE TO DL016-CALL-MOD-FAIL-ERR-CDE    12160000
121700         SET DL016-CALLED-MODULE-FAILURE TO TRUE                  12170000
121800         IF  XL072-SQL-ERROR                                      12180000
121900             MOVE XL072-EAI-DB-SQLCODE TO                         12190000
122000                  DL016-CALL-MOD-FAIL-SQL-CDE                     12200000
122100             MOVE XL072-SQL-ERROR-PARA TO                         12210000
122200                  DL016-CALL-MOD-FAIL-SQL-PARA                    12220000
122300         END-IF                                                   12230000
122400         PERFORM 9000-RETURN-CALL                                 12240000
122500     END-IF.                                                      12250000
122600                                                                  12260000
122700 3220-GET-TIMESTAMP.                                              12270000
122800                                                                  12280000
122900***  MOVE SPACES TO PV-CICS-MSG-AREA2                             12290000
123000***  MOVE ' DLKCS410 - 3220-GET-TIMESTAMP           '             12300000
123100***    TO PV-CICS-MSG-AREA2                                       12310000
123200***  MOVE LENGTH OF PV-CICS-MSG-AREA2                             12320000
123300***    TO PV-COMMAREA-LENGTH                                      12330000
123400***  PERFORM 9200-WRITE-TO-CSSL                                   12340000
123500                                                                  12350000
123600     EXEC SQL                                                     12360000
123700          SET  :PV-LABOR-CURRENT-TIMESTAMP =                      12370000
123800               (TIMESTAMP(:PV-HOLD-TIMESTAMP) - 1 SECOND)         12380000
123900     END-EXEC.                                                    12390000
124000                                                                  12400000
124100*----------------------------------------------------------------*12410000
124200*  PARM USED TO DETERMINE IF DC IS CHECKING IF AN ASSOIATE IS ON *12420000
124300*  MULTIPLE ACTIVE ASSIGNMENTS                                   *12430000
124400*  DMH ADDED - 12-10-2008                                        *12440000
124500*----------------------------------------------------------------*12450000
124600 4000-SELECT-TKRPRPM.                                             12460000
124700                                                                  12470000
124800***  MOVE SPACES TO PV-CICS-MSG-AREA2                             12480000
124900***  MOVE ' DLKCS410 - 4000-SELECT-TKRPRPM          '             12490000
125000***    TO PV-CICS-MSG-AREA2                                       12500000
125100***  MOVE LENGTH OF PV-CICS-MSG-AREA2                             12510000
125200***    TO PV-COMMAREA-LENGTH                                      12520000
125300***  PERFORM 9200-WRITE-TO-CSSL                                   12530000
125400                                                                  12540000
125500     MOVE  DL016-EAI-DC-NBR  TO  KRPRPM-LOC-ID.                   12550000
125600                                                                  12560000
125700     EXEC SQL                                                     12570000
125800         SELECT                                                   12580000
125900                FUNC_TXT                                          12590000
126000          INTO                                                    12600000
126100                :KRPRPM-FUNC-TXT                                  12610000
126200          FROM  TKRPRPM                                           12620000
126300         WHERE  LOC_ID            = :DL016-EAI-DC-NBR             12630000
126400           AND  INTFC_SYS_CDE     = 'KHL'                         12640000
126500           AND  SYS_PRC_FUNC_CDE  = 'DLMLTA'                      12650000
126600           AND  FUNC_PRC_STAT_CDE = 'AC'                          12660000
126700           AND  FUNC_BEG_TMST    <= CURRENT TIMESTAMP             12670000
126800           AND  FUNC_END_TMST    >= CURRENT TIMESTAMP             12680000
126900           AND  FUNC_TXT          = 'Y'                           12690000
127000     END-EXEC.                                                    12700000
127100                                                                  12710000
127200     EVALUATE TRUE                                                12720000
127300         WHEN SQLCODE = ZERO                                      12730000
127400              SET PS-CHECKING-MULT-ASGMT  TO TRUE                 12740000
127500                                                                  12750000
127600         WHEN SQLCODE = +100                                      12760000
127700              SET PS-NOT-CHECKING-MULT-ASGMT  TO TRUE             12770000
127800                                                                  12780000
127900         WHEN SQLWARN0 NOT = SPACES                               12790000
128000         WHEN SQLCODE NOT = ZERO                                  12800000
128100              MOVE SPACES TO PV-CICS-MSG-AREA2                    12810000
128200              MOVE DL016-EAI-DC-NBR   TO  PV-DISPLAY-OPER         12820000
128300              STRING ' DLKCS410 -'                                12830000
128400                     PV-DISPLAY-OPER         '-'                  12840000
128500                     DL016-EAI-WK-TYP-DESC   '-'                  12850000
128600                     DL016-EAI-WK-AREA-DESC  '-'                  12860000
128700                     DL016-EAI-CRE-BY-USR-ID                      12870000
128800                                              DELIMITED BY SIZE   12880000
128900                                         INTO PV-CICS-MSG-AREA2   12890000
129000              MOVE LENGTH OF PV-CICS-MSG-AREA2                    12900000
129100                TO PV-COMMAREA-LENGTH                             12910000
129200              PERFORM 9200-WRITE-TO-CSSL                          12920000
129300                                                                  12930000
129400              MOVE SPACES TO PV-CICS-MSG-AREA2                    12940000
129500              MOVE SQLCODE          TO  PV-DISPLAY-SQLCODE        12950000
129600              STRING ' DLKCS410 -'                                12960000
129700                    ' PARA: 4000 - '                              12970000
129800                    ' SQLCODE: '        PV-DISPLAY-SQLCODE        12980000
129900                    ' TKRPRPM SELECT FOR DLMLTA'                  12990000
130000                                       DELIMITED BY SIZE          13000000
130100                                  INTO PV-CICS-MSG-AREA2          13010000
130200              MOVE LENGTH OF PV-CICS-MSG-AREA2                    13020000
130300                TO PV-COMMAREA-LENGTH                             13030000
130400              PERFORM 9200-WRITE-TO-CSSL                          13040000
130500               SET PS-NOT-CHECKING-MULT-ASGMT  TO TRUE            13050000
130600     END-EVALUATE.                                                13060000
130700                                                                  13070000
130800*----------------------------------------------------------------*13080000
130900* THIS SQL WILL CHECK IF AN ASSOCIATE IS ON MULTIPLE ACTIVE      *13090000
131000* ASSIGNMENTS.  IF THE ASSOCIATE IS, NEW MODULE DLKUT028 WILL BE *13100000
131100* CALLED TO END THE ASSOCIATE ON ALL OF THE ACTIVE ASSIGNMENTS   *13110000
131200* DMH ADDED - 12-10-2008                                         *13120000
131300*----------------------------------------------------------------*13130000
131400 4100-CHECK-MULT-ASGMT.                                           13140000
131500                                                                  13150000
131600***  MOVE SPACES TO PV-CICS-MSG-AREA2                             13160000
131700***  MOVE ' DLKCS410 - 4100-CHECK-MULT-ASGMT        '             13170000
131800***    TO PV-CICS-MSG-AREA2                                       13180000
131900***  MOVE LENGTH OF PV-CICS-MSG-AREA2                             13190000
132000***    TO PV-COMMAREA-LENGTH                                      13200000
132100***  PERFORM 9200-WRITE-TO-CSSL                                   13210000
132200                                                                  13220000
132300     IF  DL016-EAI-USR-IS-KOHLS                                   13230000
132400                                                                  13240000
132500       EXEC SQL                                                   13250000
132600            SELECT  COUNT(*)                                      13260000
132700              INTO  :PV-ASGMT-COUNT                               13270000
132800              FROM  DLT_TEM_ASGMT   A                             13280000
132900                   ,DLT_ASGMT       B                             13290000
133000             WHERE  A.KOHLS_USR_ID      = :DL016-EAI-CRE-BY-USR-ID13300000
133100               AND  A.LVE_RSN_CDE       = 'N'                     13310000
133200               AND  B.ASGMT_STRT_DTE    = A.ASGMT_STRT_DTE        13320000
133300               AND  B.ASGMT_NBR_TXT     = A.ASGMT_NBR_TXT         13330000
133400               AND  B.ASGMT_NBR_SEQ_NBR = A.ASGMT_NBR_SEQ_NBR     13340000
133500               AND  B.ASGMT_STP_RSN_CDE = 'N'                     13350000
133600       END-EXEC                                                   13360000
133700                                                                  13370000
133800     ELSE                                                         13380000
133900                                                                  13390000
134000       EXEC SQL                                                   13400000
134100            SELECT  COUNT(*)                                      13410000
134200              INTO  :PV-ASGMT-COUNT                               13420000
134300              FROM  DLT_TEM_ASGMT   A                             13430000
134400                   ,DLT_ASGMT       B                             13440000
134500             WHERE  A.TMP_USR_ID        = :DL016-EAI-CRE-BY-USR-ID13450000
134600               AND  A.LVE_RSN_CDE       = 'N'                     13460000
134700               AND  B.ASGMT_STRT_DTE    = A.ASGMT_STRT_DTE        13470000
134800               AND  B.ASGMT_NBR_TXT     = A.ASGMT_NBR_TXT         13480000
134900               AND  B.ASGMT_NBR_SEQ_NBR = A.ASGMT_NBR_SEQ_NBR     13490000
135000               AND  B.ASGMT_STP_RSN_CDE = 'N'                     13500000
135100       END-EXEC                                                   13510000
135200     END-IF.                                                      13520000
135300                                                                  13530000
135400     EVALUATE TRUE                                                13540000
135500         WHEN SQLCODE = ZERO                                      13550000
135600              IF  PV-ASGMT-COUNT  >  1                            13560000
135700                  PERFORM 4200-CALL-DLKUT028                      13570000
135800              END-IF                                              13580000
135900                                                                  13590000
136000         WHEN SQLCODE = -911                                      13600000
136100         WHEN SQLCODE = -913                                      13610000
136200         WHEN SQLCODE = -904                                      13620000
136300             SET PS-ERROR                                         13630000
136400                 DL016-SQL-ERROR                                  13640000
136500                 DL016-ASGMT-CONTENTION   TO TRUE                 13650000
136600             MOVE SQLCA                   TO DL016-SQLCA          13660000
136700             MOVE SQLCODE                 TO DL016-ASGMT-SQLCODE  13670000
136800                                                                  13680000
136900              MOVE SPACES TO PV-CICS-MSG-AREA2                    13690000
137000              MOVE DL016-EAI-DC-NBR   TO  PV-DISPLAY-OPER         13700000
137100              STRING ' DLKCS410 -'                                13710000
137200                     PV-DISPLAY-OPER         '-'                  13720000
137300                     DL016-EAI-WK-TYP-DESC   '-'                  13730000
137400                     DL016-EAI-WK-AREA-DESC  '-'                  13740000
137500                     DL016-EAI-CRE-BY-USR-ID                      13750000
137600                                              DELIMITED BY SIZE   13760000
137700                                         INTO PV-CICS-MSG-AREA2   13770000
137800              MOVE LENGTH OF PV-CICS-MSG-AREA2                    13780000
137900                TO PV-COMMAREA-LENGTH                             13790000
138000              PERFORM 9200-WRITE-TO-CSSL                          13800000
138100                                                                  13810000
138200              MOVE SPACES TO PV-CICS-MSG-AREA2                    13820000
138300              MOVE SQLCODE          TO  PV-DISPLAY-SQLCODE        13830000
138400              STRING ' DLKCS410 -'                                13840000
138500                    ' PARA: 4100 - '                              13850000
138600                    ' SQLCODE: '        PV-DISPLAY-SQLCODE        13860000
138700                    ' COUNT NUMBER OF ASSIGNMENTS FOR ASSOCIATE'  13870000
138800                                       DELIMITED BY SIZE          13880000
138900                                  INTO PV-CICS-MSG-AREA2          13890000
139000              MOVE LENGTH OF PV-CICS-MSG-AREA2                    13900000
139100                TO PV-COMMAREA-LENGTH                             13910000
139200              PERFORM 9200-WRITE-TO-CSSL                          13920000
139300                                                                  13930000
139400         WHEN SQLWARN0 NOT = SPACES                               13940000
139500         WHEN SQLCODE NOT = ZERO                                  13950000
139600              SET PS-ERROR                                        13960000
139700                  DL016-SQL-ERROR          TO TRUE                13970000
139800              MOVE SQLCA                   TO DL016-SQLCA         13980000
139900              MOVE SQLCODE                 TO DL016-ASGMT-SQLCODE 13990000
140000                                                                  14000000
140100              MOVE SPACES TO PV-CICS-MSG-AREA2                    14010000
140200              MOVE DL016-EAI-DC-NBR   TO  PV-DISPLAY-OPER         14020000
140300              STRING ' DLKCS410 -'                                14030000
140400                     PV-DISPLAY-OPER         '-'                  14040000
140500                     DL016-EAI-WK-TYP-DESC   '-'                  14050000
140600                     DL016-EAI-WK-AREA-DESC  '-'                  14060000
140700                     DL016-EAI-CRE-BY-USR-ID                      14070000
140800                                              DELIMITED BY SIZE   14080000
140900                                         INTO PV-CICS-MSG-AREA2   14090000
141000              MOVE LENGTH OF PV-CICS-MSG-AREA2                    14100000
141100                TO PV-COMMAREA-LENGTH                             14110000
141200              PERFORM 9200-WRITE-TO-CSSL                          14120000
141300                                                                  14130000
141400              MOVE SPACES TO PV-CICS-MSG-AREA2                    14140000
141500              MOVE SQLCODE          TO  PV-DISPLAY-SQLCODE        14150000
141600              STRING ' DLKCS410 -'                                14160000
141700                    ' PARA: 4100 - '                              14170000
141800                    ' SQLCODE: '        PV-DISPLAY-SQLCODE        14180000
141900                    ' COUNT NUMBER OF ASSIGNMENTS FOR ASSOCIATE'  14190000
142000                                       DELIMITED BY SIZE          14200000
142100                                  INTO PV-CICS-MSG-AREA2          14210000
142200              MOVE LENGTH OF PV-CICS-MSG-AREA2                    14220000
142300                TO PV-COMMAREA-LENGTH                             14230000
142400              PERFORM 9200-WRITE-TO-CSSL                          14240000
142500                                                                  14250000
142600     END-EVALUATE.                                                14260000
142700                                                                  14270000
142800*----------------------------------------------------------------*14280000
142900* CALL MODULE DLKUT028 TO END ASSOCIATE OFF OF THE MULTIPLE      *14290000
143000* ASSIGNMENTS THAT THEY ARE CURRENTLY ON.                        *14300000
143100* DMH ADDED - 12-10-2008                                         *14310000
143200*----------------------------------------------------------------*14320000
143300 4200-CALL-DLKUT028.                                              14330000
143400                                                                  14340000
143500***  MOVE SPACES TO PV-CICS-MSG-AREA2                             14350000
143600***  MOVE ' DLKCS410 - 4200-CALL-DLKUT028           '             14360000
143700***    TO PV-CICS-MSG-AREA2                                       14370000
143800***  MOVE LENGTH OF PV-CICS-MSG-AREA2                             14380000
143900***    TO PV-COMMAREA-LENGTH                                      14390000
144000***  PERFORM 9200-WRITE-TO-CSSL                                   14400000
144100                                                                  14410000
144200     INITIALIZE  DL024-ASGMT-COMMAREA.                            14420000
144300                                                                  14430000
144400     MOVE PV-HOLD-USR-ID         TO  DL024-KEY-USER-ID.           14440000
144500     MOVE DL016-CALLING-PGM-NM   TO  DL024-ORIG-CALLING-PGM-NM.   14450000
144600     MOVE DL016-EAI-WK-TYP-DESC  TO  DL024-KEY-WK-TYP.            14460000
144700     MOVE DL016-EAI-WK-AREA-DESC TO  DL024-KEY-WK-AREA.           14470000
144800     MOVE DL016-EAI-DC-NBR       TO  DL024-KEY-DC-NBR.            14480000
144900                                                                  14490000
145000     SET PS-NO-CALLED-MODULE-ERROR TO TRUE.                       14500000
145100                                                                  14510000
145200     CALL DL024-MULT-ASGMT-PGM USING DFHEIBLK                     14520000
145300                                     DL024-COMMAREA               14530000
145400                                     DL024-ASGMT-COMMAREA.        14540000
145500                                                                  14550000
145600     EVALUATE TRUE                                                14560000
145700         WHEN DL024-SUCCESSFUL                                    14570000
145800             CONTINUE                                             14580000
145900         WHEN OTHER                                               14590000
146000             SET PS-CALLED-MODULE-ERROR TO TRUE                   14600000
146100                                                                  14610000
146200             MOVE SPACES TO PV-CICS-MSG-AREA2                     14620000
146300             STRING ' DLKCS410 - '                                14630000
146400                    'CALLED MODULE DLKUT028 FAILED'               14640000
146500                                             DELIMITED BY SIZE    14650000
146600                                           INTO PV-CICS-MSG-AREA2 14660000
146700             MOVE LENGTH OF PV-CICS-MSG-AREA2                     14670000
146800               TO PV-COMMAREA-LENGTH                              14680000
146900             PERFORM 9200-WRITE-TO-CSSL                           14690000
147000                                                                  14700000
147100             MOVE SPACES TO PV-CICS-MSG-AREA2                     14710000
147200             MOVE '4200-CALL-DLKUT028' TO PV-MODULE-PARAGRPAH     14720000
147300             STRING ' DLKCS410 - '                                14730000
147400                    PV-MODULE-FAIL-MSG                            14740000
147500                    ' WITH RETURN CODE - '                        14750000
147600                    DL003-RETURN-CODE        DELIMITED BY SIZE    14760000
147700                                           INTO PV-CICS-MSG-AREA2 14770000
147800             MOVE LENGTH OF PV-CICS-MSG-AREA2                     14780000
147900               TO PV-COMMAREA-LENGTH                              14790000
148000             PERFORM 9200-WRITE-TO-CSSL                           14800000
148100     END-EVALUATE.                                                14810000
148200                                                                  14820000
148300                                                                  14830000
148400*-----------------------------------------------------------------14840000
148500*  INSERT ROW INTO TUPLDER (UPLOAD ERROR) TABLE - TOO KEEP TRACK *14850000
148600*  OF WHEN MULTIPLE ASSIGNMENTS ARE OPEN FOR THE SAME WORK AREA  *14860000
148700*-----------------------------------------------------------------14870000
148800 4400-INSERT-TUPLDER.                                             14880000
148900                                                                  14890000
149000***  MOVE SPACES TO PV-CICS-MSG-AREA2                             14900000
149100***  MOVE ' DLKCS410 - 4400-INSERT-TUPLDER          '             14910000
149200***    TO PV-CICS-MSG-AREA2                                       14920000
149300***  MOVE LENGTH OF PV-CICS-MSG-AREA2                             14930000
149400***    TO PV-COMMAREA-LENGTH                                      14940000
149500***  PERFORM 9200-WRITE-TO-CSSL                                   14950000
149600                                                                  14960000
149700     MOVE DL016-EAI-DC-NBR             TO UPLDER-OPER-UNT-ID.     14970000
149800     MOVE 'F'                          TO UPLDER-UPLD-TRN-CDE.    14980000
149900     MOVE '102'                        TO UPLDER-ERR-CDE.         14990000
150000     MOVE  0                           TO UPLDER-UPLD-SEQ-NBR.    15000000
150100                                                                  15010000
150200     INITIALIZE  UPLDER-PKT-TXT.                                  15020000
150300     MOVE DL016-EAI-DC-NBR TO  PV-DISPLAY-OPER                    15030000
150400     STRING   PV-DISPLAY-OPER         ' '                         15040000
150500              PV-HOLD-USR-ID          ' '                         15050000
150600              DL016-EAI-WK-TYP-DESC   ' '                         15060000
150700              DL016-EAI-WK-AREA-DESC      DELIMITED BY SIZE       15070000
150800                                     INTO UPLDER-PKT-TXT.         15080000
150900                                                                  15090000
151000     EXEC SQL                                                     15100000
151100         INSERT                                                   15110000
151200           INTO TUPLDER                                           15120000
151300             ( OPER_UNT_ID                                        15130000
151400             , UPLD_TRN_CDE                                       15140000
151500             , ERR_CDE                                            15150000
151600             , PRC_TMST                                           15160000
151700             , UPLD_SEQ_NBR                                       15170000
151800             , PKT_TXT                                            15180000
151900             )                                                    15190000
152000             VALUES                                               15200000
152100             ( :UPLDER-OPER-UNT-ID                                15210000
152200             , :UPLDER-UPLD-TRN-CDE                               15220000
152300             , :UPLDER-ERR-CDE                                    15230000
152400             ,  CURRENT TIMESTAMP                                 15240000
152500             , :UPLDER-UPLD-SEQ-NBR                               15250000
152600             , :UPLDER-PKT-TXT                                    15260000
152700             )                                                    15270000
152800     END-EXEC.                                                    15280000
152900                                                                  15290000
153000     EVALUATE TRUE                                                15300000
153100         WHEN SQLCODE = ZERO                                      15310000
153200             CONTINUE                                             15320000
153300                                                                  15330000
153400         WHEN SQLWARN0 NOT = SPACES                               15340000
153500         WHEN SQLCODE  NOT = ZERO                                 15350000
153600                                                                  15360000
153700             MOVE SPACES TO PV-CICS-MSG-AREA2                     15370000
153800             MOVE DL024-KEY-DC-NBR  TO  PV-DISPLAY-OPER           15380000
153900             STRING ' DLKCS410 -'                                 15390000
154000                    UPLDER-PKT-TXT           DELIMITED BY SIZE    15400000
154100                                        INTO PV-CICS-MSG-AREA2    15410000
154200             MOVE LENGTH OF PV-CICS-MSG-AREA2                     15420000
154300               TO PV-COMMAREA-LENGTH                              15430000
154400             PERFORM 9200-WRITE-TO-CSSL                           15440000
154500                                                                  15450000
154600             MOVE SPACES TO PV-CICS-MSG-AREA2                     15460000
154700             MOVE SQLCODE           TO  PV-DISPLAY-SQLCODE        15470000
154800             STRING ' DLKCS410 -'                                 15480000
154900                   ' PARA: 4400-INSERT-TUPLDER'                   15490000
155000                   ' SQLCODE: '        PV-DISPLAY-SQLCODE         15500000
155100                                       DELIMITED BY SIZE          15510000
155200                                  INTO PV-CICS-MSG-AREA2          15520000
155300             MOVE LENGTH OF PV-CICS-MSG-AREA2                     15530000
155400               TO PV-COMMAREA-LENGTH                              15540000
155500             PERFORM 9200-WRITE-TO-CSSL                           15550000
155600                                                                  15560000
155700     END-EVALUATE.                                                15570000
155800                                                                  15580000
155900                                                                  15590000
156000*----------------------------------------------------------------*15600000
156100* CALL MODULE DLKUT030 TO END MULTIPLE ASGMTS FOR DC/TYPE/AREA   *15610000
156200* DMH ADDED - 12-07-2009                                         *15620000
156300*----------------------------------------------------------------*15630000
156400 4500-CALL-DLKUT030.                                              15640000
156500                                                                  15650000
156600***  MOVE SPACES TO PV-CICS-MSG-AREA2                             15660000
156700***  MOVE ' DLKCS410 - 4500-CALL-DLKUT030           '             15670000
156800***    TO PV-CICS-MSG-AREA2                                       15680000
156900***  MOVE LENGTH OF PV-CICS-MSG-AREA2                             15690000
157000***    TO PV-COMMAREA-LENGTH                                      15700000
157100***  PERFORM 9200-WRITE-TO-CSSL                                   15710000
157200                                                                  15720000
157300***  DMH TEST ONLY                                                15730000
157400         DISPLAY ' 4500-CALL-DLKUT031 - PARA'.                    15740000
157500***  DMH TEST ONLY                                                15750000
157600                                                                  15760000
157700     INITIALIZE  DL026-ASGMT-COMMAREA.                            15770000
157800                                                                  15780000
157900     MOVE DL016-CALLING-PGM-NM   TO  DL026-ORIG-CALLING-PGM-NM.   15790000
158000     MOVE DL016-EAI-WK-TYP-DESC  TO  DL026-KEY-WK-TYP.            15800000
158100     MOVE DL016-EAI-WK-AREA-DESC TO  DL026-KEY-WK-AREA.           15810000
158200     MOVE DL016-EAI-DC-NBR       TO  DL026-KEY-DC-NBR.            15820000
158300                                                                  15830000
158400     SET PS-NO-CALLED-MODULE-ERROR TO TRUE.                       15840000
158500                                                                  15850000
158600     CALL DL026-DC-MULT-ASGMT-PGM                                 15860000
158700          USING DFHEIBLK                                          15870000
158800                DL026-COMMAREA                                    15880000
158900                DL026-ASGMT-COMMAREA.                             15890000
159000                                                                  15900000
159100     EVALUATE TRUE                                                15910000
159200         WHEN DL026-SUCCESSFUL                                    15920000
159300             PERFORM 4600-CHECK-FOR-ASGMT-2ND-TIME                15930000
159400         WHEN OTHER                                               15940000
159500             SET PS-CALLED-MODULE-ERROR TO TRUE                   15950000
159600                                                                  15960000
159700             DISPLAY ' DLKCS410 - '                               15970000
159800                    'CALLED MODULE DLKUT030 FAILED'               15980000
159900                                                                  15990000
160000             MOVE '4500-CALL-DLKUT030' TO PV-MODULE-PARAGRPAH     16000000
160100             DISPLAY ' DLKCS410 - '                               16010000
160200                    PV-MODULE-FAIL-MSG                            16020000
160300                    ' WITH RETURN CODE - '                        16030000
160400                    DL003-RETURN-CODE                             16040000
160500     END-EVALUATE.                                                16050000
160600                                                                  16060000
160700                                                                  16070000
160800*-----------------------------------------------------------------16080000
160900* IF INTIALLY IT WAS FOUND THAT THERE WERE MULTIPLE ASSIGNMENTS  *16090000
161000* OPEN FOR A GIVEN DC/TYPE/AREA, DLKUT031 WAS CALLED (PARA 4500) *16100000
161100* WHEN THAT MODULE IS SUCCESSFUL - THIS PARAGRAPH IS CALL JUST   *16110000
161200* TO CHECK IF THERE IS AN ASSIGNMENT THAT MIGHT HAVE BEEN OPENED *16120000
161300* IN THE INTERUM FOR THE SAME DC/TYPE/AREA.                      *16130000
161400*-----------------------------------------------------------------16140000
161500 4600-CHECK-FOR-ASGMT-2ND-TIME.                                   16150000
161600                                                                  16160000
161700***  MOVE SPACES TO PV-CICS-MSG-AREA2                             16170000
161800***  MOVE ' DLKCS410 - 4600-CHECK-FOR-ASGMT-2ND-TIME'             16180000
161900***    TO PV-CICS-MSG-AREA2                                       16190000
162000***  MOVE LENGTH OF PV-CICS-MSG-AREA2                             16200000
162100***    TO PV-COMMAREA-LENGTH                                      16210000
162200***  PERFORM 9200-WRITE-TO-CSSL                                   16220000
162300                                                                  16230000
162400***  DMH TEST ONLY                                                16240000
162500         DISPLAY ' DLKUT410 START 4600- PARA '.                   16250000
162600***  DMH TEST ONLY                                                16260000
162700                                                                  16270000
162800     INITIALIZE  DL004-ASGMT-COMMAREA.                            16280000
162900                                                                  16290000
163000     MOVE DL016-CALLING-PGM-NM        TO                          16300000
163100                                      DL004-ORIG-CALLING-PGM-NM.  16310000
163200                                                                  16320000
163300     MOVE DL016-ASGMT-NBR-WRK-TYP     TO DL004-KEY-WK-TYP         16330000
163400     MOVE DL016-EAI-WK-AREA-DESC      TO DL004-KEY-WK-AREA        16340000
163500     MOVE DL016-EAI-DC-NBR            TO DL004-KEY-DC-NBR         16350000
163600                                                                  16360000
163700     SET DL004-BY-WK-TYP-AREA-KEY     TO TRUE.                    16370000
163800     SET PS-NO-CALLED-MODULE-ERROR    TO TRUE.                    16380000
163900                                                                  16390000
164000     PERFORM 6100-CALL-DLKUT002.                                  16400000
164100                                                                  16410000
164200     IF  PS-CALLED-MODULE-ERROR                                   16420000
164300         SET PS-ERROR TO TRUE                                     16430000
164400         MOVE 'DLKUT002' TO DL016-CALL-MOD-FAIL-NM                16440000
164500         MOVE DL004-SQL-ERROR-PARA                                16450000
164600                                TO DL016-CALL-MOD-FAIL-SQL-PARA   16460000
164700         MOVE DL004-RETURN-CODE TO DL016-CALL-MOD-FAIL-ERR-CDE    16470000
164800         SET DL016-CALLED-MODULE-FAILURE TO TRUE                  16480000
164900         IF  DL004-SQL-ERROR                                      16490000
165000             MOVE DL004-ASGMT-SQLCODE TO                          16500000
165100                  DL016-CALL-MOD-FAIL-SQL-CDE                     16510000
165200             MOVE DL004-SQL-ERROR-PARA TO                         16520000
165300                  DL016-CALL-MOD-FAIL-SQL-PARA                    16530000
165400         END-IF                                                   16540000
165500         PERFORM 9000-RETURN-CALL                                 16550000
165600     ELSE                                                         16560000
165700         IF  DL004-ASGMT-MULT-FOUND                               16570000
165800             SET PS-ERROR TO TRUE                                 16580000
165900             MOVE 'DLKUT002' TO DL016-CALL-MOD-FAIL-NM            16590000
166000             MOVE DL004-SQL-ERROR-PARA                            16600000
166100                                TO DL016-CALL-MOD-FAIL-SQL-PARA   16610000
166200             MOVE DL004-RETURN-CODE TO                            16620000
166300                  DL016-CALL-MOD-FAIL-ERR-CDE                     16630000
166400             SET DL016-CALLED-MODULE-FAILURE TO TRUE              16640000
166500             MOVE SPACES TO PV-CICS-MSG-AREA2                     16650000
166600             STRING ' DLKUT410 - '           DELIMITED BY SIZE    16660000
166700                    'CALLED MODULE SUCCESS'  DELIMITED BY SIZE    16670000
166800                                           INTO PV-CICS-MSG-AREA2 16680000
166900             PERFORM 9200-WRITE-TO-CSSL                           16690000
167000             MOVE SPACES TO PV-CICS-MSG-AREA2                     16700000
167100             MOVE '6100-CALL-DLKUT002' TO PV-MODULE-PARAGRPAH     16710000
167200             STRING ' DLKUT410 - '           DELIMITED BY SIZE    16720000
167300                    PV-MODULE-FAIL-MSG       DELIMITED BY SIZE    16730000
167400                    ' WITH RETURN CODE - '   DELIMITED BY SIZE    16740000
167500                    DL004-RETURN-CODE        DELIMITED BY SIZE    16750000
167600                    ' BUT HAD MULT ASGMTS'   DELIMITED BY SIZE    16760000
167700                                      INTO PV-CICS-MSG-AREA2      16770000
167800             PERFORM 9200-WRITE-TO-CSSL                           16780000
167900             MOVE SPACES TO PV-CICS-MSG-AREA2                     16790000
168000             MOVE DL004-KEY-DC-NBR TO                             16800000
168100                  PV-DISPLAY-DC-NBR                               16810000
168200             MOVE DL004-ASGMT-FOUND-QTY TO                        16820000
168300                  PV-DISPLAY-QTY-5                                16830000
168400             STRING ' DLKUT410 - '           DELIMITED BY SIZE    16840000
168500                    'HAD MULT ASGMT FOR DC ' DELIMITED BY SIZE    16850000
168600                    PV-DISPLAY-DC-NBR        DELIMITED BY SIZE    16860000
168700                    ' FOR WORK TYPE OF '     DELIMITED BY SIZE    16870000
168800                    DL004-KEY-WK-TYP         DELIMITED BY SIZE    16880000
168900                    ' FOR WORK AREA OF '     DELIMITED BY SIZE    16890000
169000                    DL004-KEY-WK-AREA        DELIMITED BY SIZE    16900000
169100                                      INTO PV-CICS-MSG-AREA2      16910000
169200             PERFORM 9200-WRITE-TO-CSSL                           16920000
169300             PERFORM 4400-INSERT-TUPLDER                          16930000
169400             PERFORM 9000-RETURN-CALL                             16940000
169500         ELSE                                                     16950000
169600             IF  DL004-ASGMT-NOT-FOUND                            16960000
169700                 SET PS-CREATE-NEW-ASGMT TO TRUE                  16970000
169800             END-IF                                               16980000
169900         END-IF                                                   16990000
170000     END-IF.                                                      17000000
170100                                                                  17010000
170200                                                                  17020000
170300*-----------------------------------------------------------------17030000
170400*  CALL XLKUT067 TO DETERMINE THE USER TYPE (KOHLS VERSUS        *17040000
170500*  TEMPORARY ASSOCIATE)                                          *17050000
170600*-----------------------------------------------------------------17060000
170700 6000-CALL-XLKUT067.                                              17070000
170800                                                                  17080000
170900***  MOVE SPACES TO PV-CICS-MSG-AREA2                             17090000
171000***  MOVE ' DLKCS410 - 6000-CALL-XLKUT067           '             17100000
171100***    TO PV-CICS-MSG-AREA2                                       17110000
171200***  MOVE LENGTH OF PV-CICS-MSG-AREA2                             17120000
171300***    TO PV-COMMAREA-LENGTH                                      17130000
171400***  PERFORM 9200-WRITE-TO-CSSL                                   17140000
171500                                                                  17150000
171600     INITIALIZE XL067-USER-COMMAREA.                              17160000
171700     SET XL067-BY-USER-ID TO TRUE.                                17170000
171800     SET XL067-SELECT-BOTH-USERS TO TRUE.                         17180000
171900                                                                  17190000
172000     MOVE PV-HOLD-USR-ID TO XL067-KEY-USER-ID.                    17200000
172100     MOVE DL016-CALLING-PGM-NM TO XL067-ORIG-CALLING-PGM-NM.      17210000
172200                                                                  17220000
172300     CALL XL067-USER-PGM USING DFHEIBLK                           17230000
172400                               XL067-COMMAREA                     17240000
172500                               XL067-USER-COMMAREA.               17250000
172600                                                                  17260000
172700     EVALUATE TRUE                                                17270000
172800         WHEN XL067-SUCCESSFUL                                    17280000
172900              MOVE XL067-USER-FOUND-CODE TO                       17290000
173000                   PV-HOLD-USR-TYP-CDE                            17300000
173100         WHEN OTHER                                               17310000
173200             SET PS-CALLED-MODULE-ERROR TO TRUE                   17320000
173300             MOVE SPACES TO PV-CICS-MSG-AREA2                     17330000
173400             STRING ' DLKCS410 - '           DELIMITED BY SIZE    17340000
173500                    'CALLED MODULE FAILED'   DELIMITED BY SIZE    17350000
173600                                           INTO PV-CICS-MSG-AREA2 17360000
173700             MOVE LENGTH OF PV-CICS-MSG-AREA2                     17370000
173800               TO PV-COMMAREA-LENGTH                              17380000
173900             PERFORM 9200-WRITE-TO-CSSL                           17390000
174000             MOVE SPACES TO PV-CICS-MSG-AREA2                     17400000
174100             MOVE '6000-CALL-XLKUT067' TO PV-MODULE-PARAGRPAH     17410000
174200             STRING ' DLKCS410 - '           DELIMITED BY SIZE    17420000
174300                    PV-MODULE-FAIL-MSG       DELIMITED BY SIZE    17430000
174400                    ' WITH RETURN CODE - '   DELIMITED BY SIZE    17440000
174500                    XL067-RETURN-CODE        DELIMITED BY SIZE    17450000
174600                                           INTO PV-CICS-MSG-AREA2 17460000
174700             MOVE LENGTH OF PV-CICS-MSG-AREA2                     17470000
174800               TO PV-COMMAREA-LENGTH                              17480000
174900             PERFORM 9200-WRITE-TO-CSSL                           17490000
175000     END-EVALUATE.                                                17500000
175100                                                                  17510000
175200*-----------------------------------------------------------------17520000
175300*  CALL DLKUT002 TO DETERMINE IF THERE IS AN OPEN ASSIGNMENT     *17530000
175400*  FOR THE REQUESTED DC NUMBER/WORK TYPE/WORK AREA.              *17540000
175500*-----------------------------------------------------------------17550000
175600 6100-CALL-DLKUT002.                                              17560000
175700                                                                  17570000
175800***  MOVE SPACES TO PV-CICS-MSG-AREA2                             17580000
175900***  MOVE ' DLKCS410 - 6100-CALL-DLKUT002           '             17590000
176000***    TO PV-CICS-MSG-AREA2                                       17600000
176100***  MOVE LENGTH OF PV-CICS-MSG-AREA2                             17610000
176200***    TO PV-COMMAREA-LENGTH                                      17620000
176300***  PERFORM 9200-WRITE-TO-CSSL                                   17630000
176400                                                                  17640000
176500     CALL DL004-USER-PGM USING DFHEIBLK                           17650000
176600                               DL004-COMMAREA                     17660000
176700                               DL004-ASGMT-COMMAREA.              17670000
176800                                                                  17680000
176900     EVALUATE TRUE                                                17690000
177000         WHEN DL004-SUCCESSFUL                                    17700000
177100             CONTINUE                                             17710000
177200         WHEN OTHER                                               17720000
177300             SET PS-CALLED-MODULE-ERROR TO TRUE                   17730000
177400             MOVE SPACES TO PV-CICS-MSG-AREA2                     17740000
177500             STRING ' DLKCS410 - '           DELIMITED BY SIZE    17750000
177600                    'CALLED MODULE FAILED'   DELIMITED BY SIZE    17760000
177700                                           INTO PV-CICS-MSG-AREA2 17770000
177800             MOVE LENGTH OF PV-CICS-MSG-AREA2                     17780000
177900               TO PV-COMMAREA-LENGTH                              17790000
178000             PERFORM 9200-WRITE-TO-CSSL                           17800000
178100             MOVE SPACES TO PV-CICS-MSG-AREA2                     17810000
178200             MOVE '6100-CALL-DLKUT002' TO PV-MODULE-PARAGRPAH     17820000
178300             STRING ' DLKCS410 - '           DELIMITED BY SIZE    17830000
178400                    PV-MODULE-FAIL-MSG       DELIMITED BY SIZE    17840000
178500                    ' WITH RETURN CODE - '   DELIMITED BY SIZE    17850000
178600                    DL004-RETURN-CODE        DELIMITED BY SIZE    17860000
178700                                           INTO PV-CICS-MSG-AREA2 17870000
178800             MOVE LENGTH OF PV-CICS-MSG-AREA2                     17880000
178900               TO PV-COMMAREA-LENGTH                              17890000
179000             PERFORM 9200-WRITE-TO-CSSL                           17900000
179100     END-EVALUATE.                                                17910000
179200                                                                  17920000
179300                                                                  17930000
179400*-----------------------------------------------------------------17940000
179500*  CALL DLKUT001 TO DETERMINE IF THE REQUESTED ASSOCIATE IS      *17950000
179600*  CURRENTLY ACTIVE ON AN ACTIVE ASSIGNMENT.                     *17960000
179700*-----------------------------------------------------------------17970000
179800 6200-CALL-DLKUT001.                                              17980000
179900                                                                  17990000
180000***  MOVE SPACES TO PV-CICS-MSG-AREA2                             18000000
180100***  MOVE ' DLKCS410 - 6200-CALL-DLKUT001           '             18010000
180200***    TO PV-CICS-MSG-AREA2                                       18020000
180300***  MOVE LENGTH OF PV-CICS-MSG-AREA2                             18030000
180400***    TO PV-COMMAREA-LENGTH                                      18040000
180500***  PERFORM 9200-WRITE-TO-CSSL                                   18050000
180600                                                                  18060000
180700     CALL DL003-USER-PGM USING DFHEIBLK                           18070000
180800                               DL003-COMMAREA                     18080000
180900                               DL003-ASGMT-COMMAREA.              18090000
181000                                                                  18100000
181100     EVALUATE TRUE                                                18110000
181200         WHEN DL003-SUCCESSFUL                                    18120000
181300             CONTINUE                                             18130000
181400         WHEN OTHER                                               18140000
181500             SET PS-CALLED-MODULE-ERROR TO TRUE                   18150000
181600             MOVE SPACES TO PV-CICS-MSG-AREA2                     18160000
181700             STRING ' DLKCS410 - '           DELIMITED BY SIZE    18170000
181800                    'CALLED MODULE FAILED'   DELIMITED BY SIZE    18180000
181900                                           INTO PV-CICS-MSG-AREA2 18190000
182000             MOVE LENGTH OF PV-CICS-MSG-AREA2                     18200000
182100               TO PV-COMMAREA-LENGTH                              18210000
182200             PERFORM 9200-WRITE-TO-CSSL                           18220000
182300             MOVE SPACES TO PV-CICS-MSG-AREA2                     18230000
182400             MOVE '6100-CALL-DLKUT002' TO PV-MODULE-PARAGRPAH     18240000
182500             STRING ' DLKCS410 - '           DELIMITED BY SIZE    18250000
182600                    PV-MODULE-FAIL-MSG       DELIMITED BY SIZE    18260000
182700                    ' WITH RETURN CODE - '   DELIMITED BY SIZE    18270000
182800                    DL003-RETURN-CODE        DELIMITED BY SIZE    18280000
182900                                           INTO PV-CICS-MSG-AREA2 18290000
183000             MOVE LENGTH OF PV-CICS-MSG-AREA2                     18300000
183100               TO PV-COMMAREA-LENGTH                              18310000
183200             PERFORM 9200-WRITE-TO-CSSL                           18320000
183300     END-EVALUATE.                                                18330000
183400                                                                  18340000
183500                                                                  18350000
183600*-----------------------------------------------------------------18360000
183700*  CALL DLKUP002 TO EITHER END THE ASSOCIATE FORM AN ASSIGNMENT  *18370000
183800*  OR ADD THE ASSOCIATE TO AN ASSIGNMENT.                        *18380000
183900*-----------------------------------------------------------------18390000
184000 6300-CALL-DLKUP002.                                              18400000
184100                                                                  18410000
184200***  MOVE SPACES TO PV-CICS-MSG-AREA2                             18420000
184300***  MOVE ' DLKCS410 - 6300-CALL-DLKUP002           '             18430000
184400***    TO PV-CICS-MSG-AREA2                                       18440000
184500***  MOVE LENGTH OF PV-CICS-MSG-AREA2                             18450000
184600***    TO PV-COMMAREA-LENGTH                                      18460000
184700***  PERFORM 9200-WRITE-TO-CSSL                                   18470000
184800                                                                  18480000
184900     CALL DL005-USER-PGM USING DFHEIBLK                           18490000
185000                               DL005-COMMAREA                     18500000
185100                               DL005-ASGMT-COMMAREA.              18510000
185200                                                                  18520000
185300     EVALUATE TRUE                                                18530000
185400         WHEN DL005-SUCCESSFUL                                    18540000
185500             CONTINUE                                             18550000
185600                                                                  18560000
185700* ADDED 10/18/2007 - DMH BEGIN                                    18570000
185800         WHEN DL005-ASGMT-NOT-ACTIVE                              18580000
185900             PERFORM 6600-ESTABLISH-ASGMT-2                       18590000
186000* ADDED 10/18/2007 - DMH END                                      18600000
186100                                                                  18610000
186200         WHEN OTHER                                               18620000
186300             SET PS-CALLED-MODULE-ERROR TO TRUE                   18630000
186400             MOVE SPACES TO PV-CICS-MSG-AREA2                     18640000
186500             STRING ' DLKCS410 - '           DELIMITED BY SIZE    18650000
186600                    'CALLED MODULE FAILED'   DELIMITED BY SIZE    18660000
186700                                           INTO PV-CICS-MSG-AREA2 18670000
186800             MOVE LENGTH OF PV-CICS-MSG-AREA2                     18680000
186900               TO PV-COMMAREA-LENGTH                              18690000
187000             PERFORM 9200-WRITE-TO-CSSL                           18700000
187100             MOVE SPACES TO PV-CICS-MSG-AREA2                     18710000
187200             MOVE '6300-CALL-DLKUP002' TO PV-MODULE-PARAGRPAH     18720000
187300             STRING ' DLKCS410 - '           DELIMITED BY SIZE    18730000
187400                    PV-MODULE-FAIL-MSG       DELIMITED BY SIZE    18740000
187500                    ' TO '                   DELIMITED BY SIZE    18750000
187600                    PV-DISPLAY-TEXT          DELIMITED BY SIZE    18760000
187700                    ' ASSIGNMENT'            DELIMITED BY SIZE    18770000
187800                    ' WITH RETURN CODE - '   DELIMITED BY SIZE    18780000
187900                    DL005-RETURN-CODE        DELIMITED BY SIZE    18790000
188000                                           INTO PV-CICS-MSG-AREA2 18800000
188100             MOVE LENGTH OF PV-CICS-MSG-AREA2                     18810000
188200               TO PV-COMMAREA-LENGTH                              18820000
188300             PERFORM 9200-WRITE-TO-CSSL                           18830000
188400     END-EVALUATE.                                                18840000
188500                                                                  18850000
188600                                                                  18860000
188700*-----------------------------------------------------------------18870000
188800*  CALL DLKUP003 TO CREATE A NEW ASSIGNMENT AND ATTACH THE       *18880000
188900*  ASSOCIATE TO THE ASSIGNMENT.                                  *18890000
189000*-----------------------------------------------------------------18900000
189100 6400-CALL-DLKUP003.                                              18910000
189200                                                                  18920000
189300***  MOVE SPACES TO PV-CICS-MSG-AREA2                             18930000
189400***  MOVE ' DLKCS410 - 6400-CALL-DLKUP003           '             18940000
189500***    TO PV-CICS-MSG-AREA2                                       18950000
189600***  MOVE LENGTH OF PV-CICS-MSG-AREA2                             18960000
189700***    TO PV-COMMAREA-LENGTH                                      18970000
189800***  PERFORM 9200-WRITE-TO-CSSL                                   18980000
189900                                                                  18990000
190000     CALL DL007-USER-PGM USING DFHEIBLK                           19000000
190100                               DL007-COMMAREA                     19010000
190200                               DL007-ASGMT-COMMAREA.              19020000
190300                                                                  19030000
190400     EVALUATE TRUE                                                19040000
190500         WHEN DL007-SUCCESSFUL                                    19050000
190600             CONTINUE                                             19060000
190700         WHEN OTHER                                               19070000
190800             SET PS-CALLED-MODULE-ERROR TO TRUE                   19080000
190900             MOVE SPACES TO PV-CICS-MSG-AREA2                     19090000
191000             STRING ' DLKCS410 - '           DELIMITED BY SIZE    19100000
191100                    'CALLED MODULE FAILED'   DELIMITED BY SIZE    19110000
191200                                           INTO PV-CICS-MSG-AREA2 19120000
191300             MOVE LENGTH OF PV-CICS-MSG-AREA2                     19130000
191400               TO PV-COMMAREA-LENGTH                              19140000
191500             PERFORM 9200-WRITE-TO-CSSL                           19150000
191600             MOVE SPACES TO PV-CICS-MSG-AREA2                     19160000
191700             MOVE '6400-CALL-DLKUP003' TO PV-MODULE-PARAGRPAH     19170000
191800             STRING ' DLKCS410 - '           DELIMITED BY SIZE    19180000
191900                    PV-MODULE-FAIL-MSG       DELIMITED BY SIZE    19190000
192000                    ' WITH RETURN CODE - '   DELIMITED BY SIZE    19200000
192100                    DL007-RETURN-CODE        DELIMITED BY SIZE    19210000
192200                                           INTO PV-CICS-MSG-AREA2 19220000
192300             MOVE LENGTH OF PV-CICS-MSG-AREA2                     19230000
192400               TO PV-COMMAREA-LENGTH                              19240000
192500             PERFORM 9200-WRITE-TO-CSSL                           19250000
192600     END-EVALUATE.                                                19260000
192700                                                                  19270000
192800                                                                  19280000
192900*-----------------------------------------------------------------19290000
193000*  CALL XLKUP033 TO LOG AN INDIRECT SYSTEM MOVE TO THE EAI       *19300000
193100*  BUSINESS EVENT TABLES.                                        *19310000
193200*-----------------------------------------------------------------19320000
193300 6500-CALL-XLKUP033.                                              19330000
193400                                                                  19340000
193500***  MOVE SPACES TO PV-CICS-MSG-AREA2                             19350000
193600***  MOVE ' DLKCS410 - 6500-CALL-XLKUP033           '             19360000
193700***    TO PV-CICS-MSG-AREA2                                       19370000
193800***  MOVE LENGTH OF PV-CICS-MSG-AREA2                             19380000
193900***    TO PV-COMMAREA-LENGTH                                      19390000
194000***  PERFORM 9200-WRITE-TO-CSSL                                   19400000
194100                                                                  19410000
194200     CALL XL072-USER-PGM USING DFHEIBLK                           19420000
194300                              XL072-COMMAREA                      19430000
194400                              XL072-EAI-EXPORT-COMMAREA.          19440000
194500                                                                  19450000
194600     EVALUATE TRUE                                                19460000
194700         WHEN XL072-SUCCESSFUL                                    19470000
194800             CONTINUE                                             19480000
194900         WHEN OTHER                                               19490000
195000             SET PS-CALLED-MODULE-ERROR TO TRUE                   19500000
195100             MOVE SPACES TO PV-CICS-MSG-AREA2                     19510000
195200             STRING ' DLKCS410 - '           DELIMITED BY SIZE    19520000
195300                    'CALLED MODULE FAILED'   DELIMITED BY SIZE    19530000
195400                                           INTO PV-CICS-MSG-AREA2 19540000
195500             MOVE LENGTH OF PV-CICS-MSG-AREA2                     19550000
195600               TO PV-COMMAREA-LENGTH                              19560000
195700             PERFORM 9200-WRITE-TO-CSSL                           19570000
195800             MOVE SPACES TO PV-CICS-MSG-AREA2                     19580000
195900             MOVE '6500-CALL-XLKUP033' TO PV-MODULE-PARAGRPAH     19590000
196000             STRING ' DLKCS410 - '           DELIMITED BY SIZE    19600000
196100                    PV-MODULE-FAIL-MSG       DELIMITED BY SIZE    19610000
196200                    ' WITH RETURN CODE - '   DELIMITED BY SIZE    19620000
196300                    XL072-RETURN-CODE        DELIMITED BY SIZE    19630000
196400                                           INTO PV-CICS-MSG-AREA2 19640000
196500             MOVE LENGTH OF PV-CICS-MSG-AREA2                     19650000
196600               TO PV-COMMAREA-LENGTH                              19660000
196700             PERFORM 9200-WRITE-TO-CSSL                           19670000
196800     END-EVALUATE.                                                19680000
196900                                                                  19690000
197000                                                                  19700000
197100*-----------------------------------------------------------------19710000
197200*  THIS WILL CONTROL THE PROCESS TO CREATE AN ASSIGNMENT IF      *19720000
197300*  NEEDED AND ALSO ATTACH THE ASSOCIATE TO AN ASSIGNMENT         *19730000
197400*  THIS IS ONLY DONE IF ASSIGNMENT WAS CLOSED AFTER AQUIRING IT  *19740000
197500*  IN PARAGRAPH 2000.                                            *19750000
197600* ADDED PARAGRAPH 10/18/2007 - DMH                                19760000
197700*-----------------------------------------------------------------19770000
197800 6600-ESTABLISH-ASGMT-2.                                          19780000
197900                                                                  19790000
198000***  MOVE SPACES TO PV-CICS-MSG-AREA2                             19800000
198100***  MOVE ' DLKCS410 - 6600-ESTABLISH-ASGMT-2       '             19810000
198200***    TO PV-CICS-MSG-AREA2                                       19820000
198300***  MOVE LENGTH OF PV-CICS-MSG-AREA2                             19830000
198400***    TO PV-COMMAREA-LENGTH                                      19840000
198500***  PERFORM 9200-WRITE-TO-CSSL                                   19850000
198600                                                                  19860000
198700     PERFORM 2200-CHECK-FOR-ASGMT.                                19870000
198800                                                                  19880000
198900     PERFORM 2400-CHECK-FOR-USR-ON-ASGMT.                         19890000
199000                                                                  19900000
199100     IF  DL004-ASGMT-FOUND                                        19910000
199200     AND DL003-ASGMT-FOUND                                        19920000
199300         SET PS-ASGMTS-DO-NOT-MATCH  TO TRUE                      19930000
199400         PERFORM 2020-COMPARE-ASGMTS                              19940000
199500         IF  PS-ASGMTS-MATCH                                      19950000
199600             SET DL016-SUCCESSFUL TO TRUE                         19960000
199700             SET DL016-ESO-EXIST-ASGMT-FOUND TO TRUE              19970000
199800             SET DL016-ESO-EMP-EXIST-ON-ASGMT TO TRUE             19980000
199900             MOVE DL003-ASGMT-START-DTE TO                        19990000
200000                  DL016-ESO-ASGMT-START-DTE                       20000000
200100             MOVE DL003-ASGMT-NBR-TXT TO                          20010000
200200                  DL016-ESO-ASGMT-NBR-TXT                         20020000
200300             MOVE DL003-ASGMT-NBR-SEQ-NBR TO                      20030000
200400                  DL016-ESO-ASGMT-NBR-SEQ-NBR                     20040000
200500             PERFORM 9000-RETURN-CALL                             20050000
200600         ELSE                                                     20060000
200700             MOVE DL003-ASGMT-START-DTE TO                        20070000
200800                  PV-HOLD-ASGMT-START-DTE                         20080000
200900             MOVE DL003-ASGMT-NBR-TXT TO                          20090000
201000                  PV-HOLD-ASGMT-NBR-TXT                           20100000
201100             MOVE DL003-ASGMT-NBR-SEQ-NBR TO                      20110000
201200                  PV-HOLD-ASGMT-NBR-SEQ-NBR                       20120000
201300             MOVE DL003-TEM-ASGMT-SEQ-NBR TO                      20130000
201400                  PV-HOLD-TEM-ASGMT-SEQ-NBR                       20140000
201500             PERFORM 6610-END-FROM-ASGMT                          20150000
201600             IF  DL005-ASSOC-FOUND                                20160000
201700                 PERFORM 3200-GENERATE-S-MOVE                     20170000
201800             END-IF                                               20180000
201900             MOVE DL004-ASGMT-START-DTE TO                        20190000
202000                  PV-HOLD-ASGMT-START-DTE                         20200000
202100             MOVE DL004-ASGMT-NBR-TXT TO                          20210000
202200                  PV-HOLD-ASGMT-NBR-TXT                           20220000
202300             MOVE DL004-ASGMT-NBR-SEQ-NBR TO                      20230000
202400                  PV-HOLD-ASGMT-NBR-SEQ-NBR                       20240000
202500             PERFORM 6620-ADD-TO-ASGMT                            20250000
202600             SET DL016-SUCCESSFUL TO TRUE                         20260000
202700             SET DL016-ESO-EXIST-ASGMT-FOUND TO TRUE              20270000
202800             SET DL016-ESO-EMP-ENDADD-ASGMT TO TRUE               20280000
202900             MOVE DL004-ASGMT-START-DTE TO                        20290000
203000                  DL016-ESO-ASGMT-START-DTE                       20300000
203100             MOVE DL004-ASGMT-NBR-TXT TO                          20310000
203200                  DL016-ESO-ASGMT-NBR-TXT                         20320000
203300             MOVE DL004-ASGMT-NBR-SEQ-NBR TO                      20330000
203400                  DL016-ESO-ASGMT-NBR-SEQ-NBR                     20340000
203500             PERFORM 9000-RETURN-CALL                             20350000
203600         END-IF                                                   20360000
203700     ELSE                                                         20370000
203800         IF  DL004-ASGMT-FOUND                                    20380000
203900             MOVE DL004-ASGMT-START-DTE TO                        20390000
204000                  PV-HOLD-ASGMT-START-DTE                         20400000
204100             MOVE DL004-ASGMT-NBR-TXT TO                          20410000
204200                  PV-HOLD-ASGMT-NBR-TXT                           20420000
204300             MOVE DL004-ASGMT-NBR-SEQ-NBR TO                      20430000
204400                  PV-HOLD-ASGMT-NBR-SEQ-NBR                       20440000
204500             PERFORM 6620-ADD-TO-ASGMT                            20450000
204600             SET DL016-SUCCESSFUL TO TRUE                         20460000
204700             SET DL016-ESO-EXIST-ASGMT-FOUND TO TRUE              20470000
204800             SET DL016-ESO-EMP-NEW-TO-ASGMT TO TRUE               20480000
204900             MOVE DL004-ASGMT-START-DTE TO                        20490000
205000                  DL016-ESO-ASGMT-START-DTE                       20500000
205100             MOVE DL004-ASGMT-NBR-TXT TO                          20510000
205200                  DL016-ESO-ASGMT-NBR-TXT                         20520000
205300             MOVE DL004-ASGMT-NBR-SEQ-NBR TO                      20530000
205400                  DL016-ESO-ASGMT-NBR-SEQ-NBR                     20540000
205500             PERFORM 9000-RETURN-CALL                             20550000
205600         ELSE                                                     20560000
205700             IF  DL003-ASGMT-FOUND                                20570000
205800                 MOVE DL003-ASGMT-START-DTE TO                    20580000
205900                      PV-HOLD-ASGMT-START-DTE                     20590000
206000                 MOVE DL003-ASGMT-NBR-TXT TO                      20600000
206100                      PV-HOLD-ASGMT-NBR-TXT                       20610000
206200                 MOVE DL003-ASGMT-NBR-SEQ-NBR TO                  20620000
206300                      PV-HOLD-ASGMT-NBR-SEQ-NBR                   20630000
206400                 MOVE DL003-TEM-ASGMT-SEQ-NBR TO                  20640000
206500                      PV-HOLD-TEM-ASGMT-SEQ-NBR                   20650000
206600                 PERFORM 6610-END-FROM-ASGMT                      20660000
206700                 IF  DL005-ASSOC-FOUND                            20670000
206800                     PERFORM 3200-GENERATE-S-MOVE                 20680000
206900                 END-IF                                           20690000
207000                 PERFORM 3000-CREATE-NEW-ASGMT                    20700000
207100                 SET DL016-SUCCESSFUL TO TRUE                     20710000
207200                 SET DL016-ESO-NEW-ASGMT-CREATE TO TRUE           20720000
207300                 SET DL016-ESO-EMP-ENDADD-ASGMT TO TRUE           20730000
207400                 MOVE DL007-NEW-START-DTE TO                      20740000
207500                      DL016-ESO-ASGMT-START-DTE                   20750000
207600                 MOVE DL007-NEW-NBR-TXT TO                        20760000
207700                      DL016-ESO-ASGMT-NBR-TXT                     20770000
207800                 MOVE DL007-NEW-ASGMT-NBR-SEQ-NBR TO              20780000
207900                      DL016-ESO-ASGMT-NBR-SEQ-NBR                 20790000
208000                 PERFORM 9000-RETURN-CALL                         20800000
208100             ELSE                                                 20810000
208200                 PERFORM 3000-CREATE-NEW-ASGMT                    20820000
208300                 SET DL016-SUCCESSFUL TO TRUE                     20830000
208400                 SET DL016-ESO-NEW-ASGMT-CREATE TO TRUE           20840000
208500                 SET DL016-ESO-EMP-NEW-TO-ASGMT TO TRUE           20850000
208600                 MOVE DL007-NEW-START-DTE TO                      20860000
208700                      DL016-ESO-ASGMT-START-DTE                   20870000
208800                 MOVE DL007-NEW-NBR-TXT TO                        20880000
208900                      DL016-ESO-ASGMT-NBR-TXT                     20890000
209000                 MOVE DL007-NEW-ASGMT-NBR-SEQ-NBR TO              20900000
209100                      DL016-ESO-ASGMT-NBR-SEQ-NBR                 20910000
209200                 PERFORM 9000-RETURN-CALL                         20920000
209300             END-IF                                               20930000
209400         END-IF                                                   20940000
209500     END-IF.                                                      20950000
209600                                                                  20960000
209700                                                                  20970000
209800*---------------------------------------------------------------- 20980000
209900* THE FOLLOWING IS TO PROCES THE CALL TO DLKUP002 TO              20990000
210000* END ASSOCIATE FROM AN ASSIGNMENT                                21000000
210100*  THIS IS ONLY DONE IF ASSIGNMENT WAS CLOSED AFTER AQUIRING IT  *21010000
210200*  IN PARAGRAPH 2000.                                            *21020000
210300* ADDED PARAGRAPH 10/18/2007 - DMH                                21030000
210400*---------------------------------------------------------------- 21040000
210500 6610-END-FROM-ASGMT.                                             21050000
210600                                                                  21060000
210700***  MOVE SPACES TO PV-CICS-MSG-AREA2                             21070000
210800***  MOVE ' DLKCS410 - 6610-END-FROM-ASGMT          '             21080000
210900***    TO PV-CICS-MSG-AREA2                                       21090000
211000***  MOVE LENGTH OF PV-CICS-MSG-AREA2                             21100000
211100***    TO PV-COMMAREA-LENGTH                                      21110000
211200***  PERFORM 9200-WRITE-TO-CSSL                                   21120000
211300                                                                  21130000
211400     INITIALIZE DL005-ASGMT-COMMAREA.                             21140000
211500                                                                  21150000
211600     MOVE PV-HOLD-ASGMT-START-DTE TO                              21160000
211700          DL005-KEY-START-DTE.                                    21170000
211800     MOVE PV-HOLD-ASGMT-NBR-TXT TO                                21180000
211900          DL005-KEY-NBR-TXT.                                      21190000
212000     MOVE PV-HOLD-ASGMT-NBR-SEQ-NBR TO                            21200000
212100          DL005-KEY-NBR-SEQ-NBR.                                  21210000
212200     MOVE PV-HOLD-TEM-ASGMT-SEQ-NBR TO                            21220000
212300          DL005-KEY-TEM-ASGMT-SEQ-NBR.                            21230000
212400     MOVE PV-HOLD-USR-ID TO                                       21240000
212500          DL005-KEY-ADD-BY-USER-ID                                21250000
212600          DL005-KEY-USER-ID.                                      21260000
212700     MOVE PV-HOLD-USR-TYP-CDE TO                                  21270000
212800          DL005-KEY-USR-TYPE-CDE.                                 21280000
212900     MOVE PC-CURRENT-PROGRAM-NAME TO                              21290000
213000          DL005-KEY-LVE-PGM-NM.                                   21300000
213100     MOVE DL016-CALLING-PGM-NM TO                                 21310000
213200          DL005-ORIG-CALLING-PGM-NM.                              21320000
213300                                                                  21330000
213400     SET DL005-BY-ASGMT-NBR TO TRUE.                              21340000
213500     SET DL005-END-FROM-ASGMT TO TRUE.                            21350000
213600     SET DL005-COMMIT-UPDATE TO TRUE.                             21360000
213700     SET DL005-KEY-LVE-RSN-SMOVE TO TRUE.                         21370000
213800     SET PS-NO-CALLED-MODULE-ERROR TO TRUE.                       21380000
213900     MOVE ' END ' TO PV-DISPLAY-TEXT.                             21390000
214000                                                                  21400000
214100     PERFORM 6650-CALL-DLKUP002.                                  21410000
214200                                                                  21420000
214300     IF  PS-CALLED-MODULE-ERROR                                   21430000
214400         SET PS-ERROR TO TRUE                                     21440000
214500         MOVE 'DLKUP002' TO DL016-CALL-MOD-FAIL-NM                21450000
214600         MOVE DL005-RETURN-CODE TO DL016-CALL-MOD-FAIL-ERR-CDE    21460000
214700         SET DL016-CALLED-MODULE-FAILURE TO TRUE                  21470000
214800         IF  DL005-SQL-ERROR                                      21480000
214900             MOVE DL005-ASGMT-SQLCODE TO                          21490000
215000                  DL016-CALL-MOD-FAIL-SQL-CDE                     21500000
215100             MOVE DL005-SQL-ERROR-PARA TO                         21510000
215200                  DL016-CALL-MOD-FAIL-SQL-PARA                    21520000
215300         END-IF                                                   21530000
215400         PERFORM 9000-RETURN-CALL                                 21540000
215500     END-IF.                                                      21550000
215600                                                                  21560000
215700                                                                  21570000
215800*---------------------------------------------------------------- 21580000
215900*   THE FOLLOWING IS TO PROCESS THE CALL TO DLKUP002 TO           21590000
216000*   ADD ASSOCIATE TO AN ASSIGNMENT                                21600000
216100*  THIS IS ONLY DONE IF ASSIGNMENT WAS CLOSED AFTER AQUIRING IT  *21610000
216200*  IN PARAGRAPH 2000.                                            *21620000
216300* ADDED PARAGRAPH 10/18/2007 - DMH                                21630000
216400*---------------------------------------------------------------- 21640000
216500 6620-ADD-TO-ASGMT.                                               21650000
216600                                                                  21660000
216700***  MOVE SPACES TO PV-CICS-MSG-AREA2                             21670000
216800***  MOVE ' DLKCS410 - 6620-ADD-TO-ASGMT            '             21680000
216900***    TO PV-CICS-MSG-AREA2                                       21690000
217000***  MOVE LENGTH OF PV-CICS-MSG-AREA2                             21700000
217100***    TO PV-COMMAREA-LENGTH                                      21710000
217200***  PERFORM 9200-WRITE-TO-CSSL                                   21720000
217300                                                                  21730000
217400     INITIALIZE DL005-ASGMT-COMMAREA.                             21740000
217500                                                                  21750000
217600     MOVE PV-HOLD-ASGMT-START-DTE TO                              21760000
217700          DL005-KEY-START-DTE.                                    21770000
217800     MOVE PV-HOLD-ASGMT-NBR-TXT TO                                21780000
217900          DL005-KEY-NBR-TXT.                                      21790000
218000     MOVE PV-HOLD-ASGMT-NBR-SEQ-NBR TO                            21800000
218100          DL005-KEY-NBR-SEQ-NBR.                                  21810000
218200     MOVE PV-HOLD-USR-ID TO                                       21820000
218300          DL005-KEY-ADD-BY-USER-ID                                21830000
218400          DL005-KEY-USER-ID.                                      21840000
218500     MOVE PV-HOLD-USR-TYP-CDE TO                                  21850000
218600          DL005-KEY-USR-TYPE-CDE.                                 21860000
218700     MOVE PC-CURRENT-PROGRAM-NAME TO                              21870000
218800          DL005-KEY-LVE-PGM-NM.                                   21880000
218900     MOVE DL016-CALLING-PGM-NM TO                                 21890000
219000          DL005-ORIG-CALLING-PGM-NM.                              21900000
219100                                                                  21910000
219200     SET DL005-BY-ASGMT-NBR TO TRUE.                              21920000
219300     SET DL005-ADD-TO-ASGMT TO TRUE.                              21930000
219400     SET DL005-COMMIT-UPDATE TO TRUE.                             21940000
219500     SET PS-NO-CALLED-MODULE-ERROR TO TRUE.                       21950000
219600     MOVE ' ADD ' TO PV-DISPLAY-TEXT.                             21960000
219700                                                                  21970000
219800     PERFORM 6650-CALL-DLKUP002.                                  21980000
219900                                                                  21990000
220000     IF  PS-CALLED-MODULE-ERROR                                   22000000
220100         SET PS-ERROR TO TRUE                                     22010000
220200         MOVE 'DLKUP002' TO DL016-CALL-MOD-FAIL-NM                22020000
220300         MOVE DL005-RETURN-CODE TO DL016-CALL-MOD-FAIL-ERR-CDE    22030000
220400         SET DL016-CALLED-MODULE-FAILURE TO TRUE                  22040000
220500         IF  DL005-SQL-ERROR                                      22050000
220600             MOVE DL005-ASGMT-SQLCODE TO                          22060000
220700                  DL016-CALL-MOD-FAIL-SQL-CDE                     22070000
220800             MOVE DL005-SQL-ERROR-PARA TO                         22080000
220900                  DL016-CALL-MOD-FAIL-SQL-PARA                    22090000
221000         END-IF                                                   22100000
221100         PERFORM 9000-RETURN-CALL                                 22110000
221200     END-IF.                                                      22120000
221300                                                                  22130000
221400                                                                  22140000
221500*-----------------------------------------------------------------22150000
221600*  CALL DLKUP002 TO EITHER END THE ASSOCIATE FORM AN ASSIGNMENT  *22160000
221700*  OR ADD THE ASSOCIATE TO AN ASSIGNMENT.                        *22170000
221800*  THIS IS ONLY DONE IF ASSIGNMENT WAS CLOSED AFTER AQUIRING IT  *22180000
221900*  IN PARAGRAPH 2000.                                            *22190000
222000* ADDED PARAGRAPH 10/18/2007 - DMH                                22200000
222100*-----------------------------------------------------------------22210000
222200 6650-CALL-DLKUP002.                                              22220000
222300                                                                  22230000
222400***  MOVE SPACES TO PV-CICS-MSG-AREA2                             22240000
222500***  MOVE ' DLKCS410 - 6620-ADD-TO-ASGMT            '             22250000
222600***    TO PV-CICS-MSG-AREA2                                       22260000
222700***  MOVE LENGTH OF PV-CICS-MSG-AREA2                             22270000
222800***    TO PV-COMMAREA-LENGTH                                      22280000
222900***  PERFORM 9200-WRITE-TO-CSSL                                   22290000
223000                                                                  22300000
223100     CALL DL005-USER-PGM USING DFHEIBLK                           22310000
223200                               DL005-COMMAREA                     22320000
223300                               DL005-ASGMT-COMMAREA.              22330000
223400                                                                  22340000
223500     EVALUATE TRUE                                                22350000
223600         WHEN DL005-SUCCESSFUL                                    22360000
223700             CONTINUE                                             22370000
223800                                                                  22380000
223900         WHEN OTHER                                               22390000
224000             SET PS-CALLED-MODULE-ERROR TO TRUE                   22400000
224100             MOVE SPACES TO PV-CICS-MSG-AREA2                     22410000
224200             STRING ' DLKCS410 - '           DELIMITED BY SIZE    22420000
224300                    'CALLED MODULE FAILED'   DELIMITED BY SIZE    22430000
224400                                           INTO PV-CICS-MSG-AREA2 22440000
224500             MOVE LENGTH OF PV-CICS-MSG-AREA2                     22450000
224600               TO PV-COMMAREA-LENGTH                              22460000
224700             PERFORM 9200-WRITE-TO-CSSL                           22470000
224800             MOVE SPACES TO PV-CICS-MSG-AREA2                     22480000
224900             MOVE '6650-CALL-DLKUP002' TO PV-MODULE-PARAGRPAH     22490000
225000             STRING ' DLKCS410 - '           DELIMITED BY SIZE    22500000
225100                    PV-MODULE-FAIL-MSG       DELIMITED BY SIZE    22510000
225200                    ' TO '                   DELIMITED BY SIZE    22520000
225300                    PV-DISPLAY-TEXT          DELIMITED BY SIZE    22530000
225400                    ' ASSIGNMENT'            DELIMITED BY SIZE    22540000
225500                    ' WITH RETURN CODE - '   DELIMITED BY SIZE    22550000
225600                    DL005-RETURN-CODE        DELIMITED BY SIZE    22560000
225700                                           INTO PV-CICS-MSG-AREA2 22570000
225800             MOVE LENGTH OF PV-CICS-MSG-AREA2                     22580000
225900               TO PV-COMMAREA-LENGTH                              22590000
226000             PERFORM 9200-WRITE-TO-CSSL                           22600000
226100     END-EVALUATE.                                                22610000
226200                                                                  22620000
226300                                                                  22630000
226400 7000-SELECT-RDPR-USR.                                            22640000
226500                                                                  22650000
226600***  MOVE SPACES TO PV-CICS-MSG-AREA2                             22660000
226700***  MOVE ' DLKCS410 - 7000-SELECT-RDPR-USR         '             22670000
226800***    TO PV-CICS-MSG-AREA2                                       22680000
226900***  MOVE LENGTH OF PV-CICS-MSG-AREA2                             22690000
227000***    TO PV-COMMAREA-LENGTH                                      22700000
227100***  PERFORM 9200-WRITE-TO-CSSL                                   22710000
227200                                                                  22720000
227300*    IF THE USER HAS NEVER BEEN A PART OF AN ASSIGNMENT,HE IS NEW 22730000
227400                                                                  22740000
227500     EXEC SQL                                                     22750000
227600     SELECT 'N'                                                   22760000
227700     INTO :PS-CREATE-NEW-USER-SW                                  22770000
227800     FROM                                                         22780000
227900         DLT_RDPR_USR_LSTG                                        22790000
228000     WHERE                                                        22800000
228100               USR_ID = :DL016-EAI-CRE-BY-USR-ID                  22810000
228200          AND LOC_NBR = :PV-LOC-NBR                               22820000
228300         FETCH FIRST 1 ROW ONLY                                   22830000
228400     END-EXEC.                                                    22840000
228500                                                                  22850000
228600     EVALUATE TRUE                                                22860000
228700     WHEN SQLCODE = ZERO                                          22870000
228800     WHEN SQLCODE = +100                                          22880000
228900     WHEN SQLCODE = -811                                          22890000
229000         SET DL016-SUCCESSFUL         TO TRUE                     22900000
229100     WHEN SQLCODE = -911                                          22910000
229200     WHEN SQLCODE = -913                                          22920000
229300     WHEN SQLCODE = -904                                          22930000
229400         SET PS-ERROR                                             22940000
229500             DL016-SQL-ERROR                                      22950000
229600             DL016-ASGMT-CONTENTION   TO TRUE                     22960000
229700         MOVE SQLCA                   TO DL016-SQLCA              22970000
229800         MOVE SQLCODE                 TO DL016-ASGMT-SQLCODE      22980000
229900     WHEN OTHER                                                   22990000
230000         SET PS-ERROR                                             23000000
230100             DL016-SQL-ERROR          TO TRUE                     23010000
230200         MOVE SQLCA                   TO DL016-SQLCA              23020000
230300         MOVE SQLCODE                 TO DL016-ASGMT-SQLCODE      23030000
230400     END-EVALUATE.                                                23040000
230500/                                                                 23050000
230600*----------------------------------------------------------------*23060000
230700*  PREPARES INFO TO BE RETURNED TO THE 'CALLING' PROGRAM.        *23070000
230800*----------------------------------------------------------------*23080000
230900 9000-RETURN-CALL.                                                23090000
231000                                                                  23100000
231100***                                                               23110000
231200***  MOVE SPACES TO PV-CICS-MSG-AREA2                             23120000
231300***  MOVE ' DLKCS410 - 9000-RETURN-CALL             '             23130000
231400***    TO PV-CICS-MSG-AREA2                                       23140000
231500***  MOVE LENGTH OF PV-CICS-MSG-AREA2                             23150000
231600***    TO PV-COMMAREA-LENGTH                                      23160000
231700***  PERFORM 9200-WRITE-TO-CSSL                                   23170000
231800                                                                  23180000
231900     MOVE LENGTH OF DL016-PGM-COMMAREA TO PV-COMMAREA-LENGTH      23190000
232000     MOVE DL016-PGM-COMMAREA TO DFHCOMMAREA.                      23200000
232100                                                                  23210000
232200     EXEC CICS                                                    23220000
232300         RETURN                                                   23230000
232400*        COMMAREA (DL016-PGM-COMMAREA)                            23240000
232500*        LENGTH (PV-COMMAREA-LENGTH)                              23250000
232600     END-EXEC.                                                    23260000
232700                                                                  23270000
232800                                                                  23280000
232900 9200-WRITE-TO-CSSL.                                              23290000
233000                                                                  23300000
233100     EXEC CICS                                                    23310000
233200          WRITEQ TD                                               23320000
233300           QUEUE  ('CSSL')                                        23330000
233400            FROM  (PV-CICS-MSG-AREA2)                             23340000
233500          LENGTH  (PV-COMMAREA-LENGTH)                            23350000
233600            RESP  (PV-CICS-RESP)                                  23360000
233700     END-EXEC.                                                    23370000
233800/                                                                 23380000
233900     COPY DPPD026.                                                23390000
