000510******************************************************************00010002
000520 IDENTIFICATION DIVISION.                                         00020002
000530******************************************************************00030002
000540                                                                  00040002
000550 PROGRAM-ID.    PCKUT117.                                         00050010
000560 AUTHOR.        JIM ARENDT.                                       00060010
000570 INSTALLATION.  KOHLS.                                            00070002
000580 DATE-WRITTEN   FEBRUARY 2018.                                    00080010
000590 DATE-COMPILED.                                                   00090002
000591                                                                  00100002
000592******************************************************************00110002
000593* THIS PROGRAM READS THE FILE CREATED IN PCKUT115 AND PCKUT116    00120039
000595* AND CREATES A COMMA DELIMITED .CSV OUTPUT FILE SO IT CAN BE     00130039
000595* MFT'D TO THE S:/SHARE DRIVE.                                    00140039
000599******************************************************************00150002
000600                                                                  00160002
000601******************************************************************00170002
000602 ENVIRONMENT DIVISION.                                            00180002
000603******************************************************************00190002
000604                                                                  00200002
000605 CONFIGURATION SECTION.                                           00210002
000606                                                                  00220002
000607 SOURCE-COMPUTER.        IBM-3090.                                00230002
000608 OBJECT-COMPUTER.        IBM-3090.                                00240002
000609                                                                  00250002
000610 INPUT-OUTPUT SECTION.                                            00260002
000611                                                                  00270002
000612 FILE-CONTROL.                                                    00280002
000613                                                                  00290002
000614     SELECT INPUT-FILE                                            00300002
000615         ASSIGN TO INP01.                                         00310028
000616                                                                  00320002
000617     SELECT OUTPUT-FILE                                           00330002
000618         ASSIGN TO OUT01.                                         00340028
000619                                                                  00350002
000620******************************************************************00360002
000621 DATA DIVISION.                                                   00370002
000622******************************************************************00380002
000623                                                                  00390002
000624 FILE SECTION.                                                    00400002
000625                                                                  00410002
000626 FD  INPUT-FILE                                                   00420002
000627     RECORDING MODE IS F                                          00430002
000628     LABEL RECORDS ARE STANDARD                                   00440002
000629     RECORD CONTAINS 170                                          00450010
000630     BLOCK CONTAINS 0 RECORDS                                     00460002
000631     DATA RECORD IS INPUT-RECORD.                                 00470002
000632                                                                  00480002
000633 01  INPUT-RECORD              PIC  X(170).                       00490010
000634                                                                  00500002
000635 FD  OUTPUT-FILE                                                  00510002
000636     RECORDING MODE IS F                                          00520002
000637     LABEL RECORDS ARE STANDARD                                   00530002
000638     RECORD CONTAINS 189                                          00540040
000639     BLOCK CONTAINS 0 RECORDS                                     00550002
000640     DATA RECORD IS OUTPUT-RECORD.                                00560002
000641                                                                  00570002
000642 01  OUTPUT-RECORD             PIC  X(189).                       00580040
000643                                                                  00590002
000644******************************************************************00600002
000645 WORKING-STORAGE SECTION.                                         00610002
000646******************************************************************00620002
000661 01  PC-PROGRAM-CONSTANTS.                                        00630002
000662     05 PC-PROGRAM-NAME               PIC  X(08) VALUE 'PCKUT117'.00640011
000662     05 PC-NO-DATA-FOUND              PIC  X(25) VALUE            00650059
000662        'NO DATA FOUND            '.                              00660059
000662     05 PC-MORE-THAN-3DAY             PIC  X(25) VALUE            00670059
000662        '>3 DAYS TOTALS           '.                              00680059
000662     05 PC-DC-TOTAL                   PIC  X(25) VALUE            00690033
000662        'DC TOTALS                '.                              00700033
000662     05 PC-GRAND-TOTAL-VALUE          PIC  X(25) VALUE            00710033
000662        'GRAND TOTALS             '.                              00720033
000689                                                                  00730003
000690 01  PV-PROGRAM-VARIABLES.                                        00740002
000691     05 PV-SAVE-OPER                  PIC  9(04)  VALUE ZERO.     00750011
000691     05 PV-RECORDS-READ               PIC  9(09)  VALUE ZERO.     00760011
000700     05 PV-DTL-RECS-WROTE             PIC  9(09)  VALUE ZERO.     00770028
000700     05 PV-TOT-RECS-WROTE             PIC  9(09)  VALUE ZERO.     00780028
064440     05 PV-DISP-DEC                   PIC  Z,ZZZ,ZZ9.             00790011
004820     05 PV-OPEN-TO-BUY.                                           00800019
004820        10 PV-OTB-WK                  PIC  X(02).                 00810023
004820        10 PV-OTB-WEEK                PIC  Z.                     00820021
064440     05 PV-CALC-PRCNT                 PIC  999V99 VALUE ZERO.     00830051
004820     05 PV-CALC-OUTPUT.                                           00840040
004820        10 PV-PRCNT-EDITED            PIC  ZZ9.                   00850043
004820        10 FILLER                     PIC  X(01)  VALUE '%'.      00860041
000751                                                                  00870002
000690 01  PA-MORE3-DAYS-TOTAL-ACCUM.                                   00880011
001800     05 PAMT3-ACTUAL-CART-CNT         PIC  9(07)  VALUE ZEROS.    00890055
001800     05 PAMT3-EXPECT-UNIT-CNT         PIC  9(07)  VALUE ZEROS.    00900012
001800     05 PAMT3-EXPECT-CART-CNT         PIC  9(07)  VALUE ZEROS.    00910012
004820     05 PAMT3-UNITS-ON-HOLD           PIC  9(06)  VALUE ZEROS.    00920055
004820     05 PAMT3-CARTONS-ON-HOLD         PIC  9(06)  VALUE ZEROS.    00930012
000751                                                                  00940011
000690 01  PA-DC-TOTAL-ACCUM.                                           00950011
001800     05 PADCT-ACTUAL-CART-CNT         PIC  9(07)  VALUE ZEROS.    00960055
001800     05 PADCT-EXPECT-UNIT-CNT         PIC  9(07)  VALUE ZEROS.    00970011
001800     05 PADCT-EXPECT-CART-CNT         PIC  9(07)  VALUE ZEROS.    00980055
004820     05 PADCT-UNITS-ON-HOLD           PIC  9(07)  VALUE ZEROS.    00990012
004820     05 PADCT-CARTONS-ON-HOLD         PIC  9(07)  VALUE ZEROS.    01000012
000751                                                                  01010011
000690 01  PA-GRAND-TOTAL-ACCUM.                                        01020011
001800     05 PAGT-ACTUAL-CART-CNT          PIC  9(08)  VALUE ZEROS.    01030055
001800     05 PAGT-EXPECT-UNIT-CNT          PIC  9(08)  VALUE ZEROS.    01040055
001800     05 PAGT-EXPECT-CART-CNT          PIC  9(08)  VALUE ZEROS.    01050055
004820     05 PAGT-UNITS-ON-HOLD            PIC  9(08)  VALUE ZEROS.    01060012
004820     05 PAGT-CARTONS-ON-HOLD          PIC  9(08)  VALUE ZEROS.    01070012
000751                                                                  01080011
000647 01  PS-PROGRAM-SWITCHES.                                         01090011
020900     05  PS-FIRST-READ-SW             PIC  X(01)  VALUE 'Y'.      01100011
021000         88  PS-FIRST-READ-Y                      VALUE 'Y'.      01110011
021100         88  PS-FIRST-READ-N                      VALUE 'N'.      01120011
000648     05  PS-EOF-INPUT-SW              PIC  X(01)  VALUE 'N'.      01130011
000649         88  PS-EOF-INPUT                         VALUE 'Y'.      01140011
000650         88  PS-NOT-EOF-INPUT                     VALUE 'N'.      01150011
000660                                                                  01160011
000784******************************************************************01170002
000785*  INPUT COPYBOOK PCRD081                                         01180023
000786******************************************************************01190002
000787     COPY PCRD081.                                                01200010
000888                                                                  01210010
000784******************************************************************01220011
000785*  DETAIL COPYBOOK PCRD082                                        01230037
000786******************************************************************01240011
000787     COPY PCRD082.                                                01250011
000888                                                                  01260011
000784******************************************************************01270032
000785*  HEADING COPYBOOK PCRD083                                       01280037
000786******************************************************************01290032
000787     COPY PCRD083.                                                01300032
000888                                                                  01310032
000889******************************************************************01320002
000890 PROCEDURE DIVISION.                                              01330002
000891******************************************************************01340002
000893 0000-PROGRAM-MAINLINE.                                           01350002
047100                                                                  01360015
001120     PERFORM 1000-INITIALIZE-ROUTINE.                             01370037
047100                                                                  01380037
001122     PERFORM 2000-PROCESS-RECORDS                                 01390003
001123        UNTIL PS-EOF-INPUT.                                       01400003
001130                                                                  01410003
001120     PERFORM 9000-EXIT-ROUTINE.                                   01420012
001151                                                                  01430003
001152     STOP RUN.                                                    01440003
001153                                                                  01450003
001160******************************************************************01460037
001120 1000-INITIALIZE-ROUTINE.                                         01470037
001153                                                                  01480037
107500     DISPLAY ' '.                                                 01490037
107500     DISPLAY ' **************************************'.           01500037
107500     DISPLAY '     '   PC-PROGRAM-NAME.                           01510037
107500     DISPLAY ' **************************************'.           01520037
000900                                                                  01530037
001000     OPEN INPUT  INPUT-FILE                                       01540037
001100          OUTPUT OUTPUT-FILE                                      01550037
001110                                                                  01560037
001120     PERFORM 1500-READ-RECORD.                                    01570037
001121                                                                  01580037
001160******************************************************************01590003
001170 1500-READ-RECORD.                                                01600037
001192                                                                  01610003
033500     READ INPUT-FILE                                              01620011
033500        INTO PC081-RECEIVER-EXT-RECORD                            01630011
033600          AT END                                                  01640011
001196             SET PS-EOF-INPUT        TO TRUE                      01650027
033800          NOT AT END                                              01660027
033900             ADD 1                   TO PV-RECORDS-READ           01670027
034400     END-READ.                                                    01680011
034500                                                                  01690011
033500     IF PS-FIRST-READ-Y                                           01700011
033500        IF PS-EOF-INPUT                                           01710011
033500            DISPLAY ' '                                           01720011
033500            DISPLAY '---> INPUT FILE EMPTY <---'                  01730058
033500            DISPLAY ' '                                           01740011
059800        ELSE                                                      01750030
033900            SET PS-FIRST-READ-N      TO TRUE                      01760030
059800            MOVE PC081-CURRENT-OPER  TO PV-SAVE-OPER              01770030
059800            PERFORM 3600-WRITE-HEADINGS                           01780032
034400        END-IF                                                    01790030
034400     END-IF.                                                      01800027
033400                                                                  01810011
001800******************************************************************01820003
001900 2000-PROCESS-RECORDS.                                            01830003
002300                                                                  01840003
002400     IF PC081-CURRENT-OPER = PV-SAVE-OPER                         01850011
002500        PERFORM 2200-MOVE-DETAIL-RTN                              01860037
002600     ELSE                                                         01870011
002500        PERFORM 2800-TOTAL-ROUTINE                                01880028
002500        PERFORM 2200-MOVE-DETAIL-RTN                              01890037
002600     END-IF.                                                      01900003
002700                                                                  01910003
002800     PERFORM 3000-WRITE-DETAIL-RECORD.                            01920031
002700                                                                  01930010
002900     PERFORM 1500-READ-RECORD.                                    01940037
003000                                                                  01950003
003200******************************************************************01960011
002500 2200-MOVE-DETAIL-RTN.                                            01970037
003000                                                                  01980011
004500     PERFORM 4000-INITIALIZE-OUTPUT-REC.                          01990016
001300     MOVE PC081-STATUS-CDE           TO PC082-STATUS-CDE.         02000011
001400     MOVE PC081-PROCESS-AREA         TO PC082-PROCESS-AREA.       02010011
001500     MOVE PC081-PO-NBR               TO PC082-PO-NBR.             02020011
001600     MOVE PC081-REC-SEQ-NBR          TO PC082-REC-SEQ-NBR.        02030011
001900     MOVE PC081-VNDR-NME             TO PC082-VNDR-NME.           02040011
002000     MOVE PC081-DEPT-NBR             TO PC082-DEPT-NBR.           02050011
002400     MOVE PC081-CURRENT-OPER         TO PC082-CURRENT-OPER.       02060026
003000                                                                  02070029
002400     EVALUATE TRUE                                                02080026
002400        WHEN PC081-PROCESS-CODE = 'A'                             02090026
002400        WHEN PC081-PROCESS-CODE = 'B'                             02100026
002400            MOVE 'XDOCK'             TO PC082-XDOCK-OR-P2L        02110026
004200                                                                  02120024
002400        WHEN PC081-PROCESS-CODE = 'C'                             02130026
002400            MOVE '  P2L'             TO PC082-XDOCK-OR-P2L        02140026
004200                                                                  02150026
002400        WHEN PC081-PROCESS-CODE = 'D'                             02160026
002400            MOVE ' BOTH'             TO PC082-XDOCK-OR-P2L        02170026
004200                                                                  02180026
002400        WHEN OTHER                                                02190038
002400            MOVE SPACES              TO PC082-XDOCK-OR-P2L        02200026
002400     END-EVALUATE.                                                02210026
004200                                                                  02220026
002400     EVALUATE TRUE                                                02230037
004200        WHEN PC081-BULK                                           02240037
004200            MOVE 'BULK'              TO PC082-PKGNG-CDE           02250037
004200        WHEN PC081-PREPACK                                        02260037
004200            MOVE 'PRPK'              TO PC082-PKGNG-CDE           02270038
004200        WHEN OTHER                                                02280037
004200            MOVE ' PBS'              TO PC082-PKGNG-CDE           02290038
002400     END-EVALUATE.                                                02300037
004800                                                                  02310037
004800     MOVE PC081-SEASET-NM            TO PC082-SEASET-NM.          02320037
004810     MOVE PC081-OPEN-TO-BUY-PERIOD   TO PC082-OPEN-TO-BUY-PERIOD. 02330011
004820     IF PC081-OPEN-TO-BUY-WEEK-NBR > ZERO                         02340022
004820        MOVE 'WK'                    TO PV-OTB-WK                 02350023
004820        MOVE PC081-OPEN-TO-BUY-WEEK-NBR                           02360022
004820                                     TO PV-OTB-WEEK               02370022
004820        MOVE PV-OPEN-TO-BUY          TO PC082-OPEN-TO-BUY-WEEK-NBR02380022
004820     END-IF.                                                      02390022
004820                                                                  02400029
004820     MOVE PC081-TRIP-ID              TO PC082-TRIP-ID.            02410011
004820     MOVE PC081-SCAC                 TO PC082-SCAC.               02420011
004820     MOVE PC081-TRAILER              TO PC082-TRAILER.            02430011
004820     MOVE PC081-TRLR-ARRIVAL-DTE     TO PC082-TRLR-ARRIVAL-DTE.   02440011
070500     MOVE PC081-AGED-IND             TO PC082-AGED-IND.           02450011
070500     MOVE PC081-FIRST-SCAN-DATE      TO PC082-FIRST-SCAN-DATE.    02460011
070500     MOVE PC081-AUDIT-STATUS         TO PC082-AUDIT-STATUS.       02470011
001800     MOVE PC081-EXPECT-UNIT-CNT      TO PC082-EXPECT-UNIT-CNT.    02480017
004820     MOVE PC081-UNITS-ON-HOLD        TO PC082-UNITS-ON-HOLD.      02490017
001800     MOVE PC081-EXPECT-CART-CNT      TO PC082-EXPECT-CART-CNT.    02500017
001800     MOVE PC081-ACTUAL-CART-CNT      TO PC082-ACTUAL-CART-CNT.    02510055
004820     MOVE PC081-CARTONS-ON-HOLD      TO PC082-CARTONS-ON-HOLD.    02520017
004820                                                                  02530043
001800     IF PC081-EXPECT-UNIT-CNT = 0                                 02540056
004820        MOVE ZERO                    TO PV-PRCNT-EDITED           02550056
004820        MOVE PV-CALC-OUTPUT          TO PC082-PCT-ON-HOLD         02560056
004820     ELSE                                                         02570056
004820        COMPUTE PV-CALC-PRCNT ROUNDED = (PC081-UNITS-ON-HOLD      02580056
001800                                      /  PC081-EXPECT-UNIT-CNT)   02590056
004820        COMPUTE  PV-CALC-PRCNT = PV-CALC-PRCNT * 100              02600056
004820        MOVE PV-CALC-PRCNT           TO PV-PRCNT-EDITED           02610056
004820        MOVE PV-CALC-OUTPUT          TO PC082-PCT-ON-HOLD         02620056
004820     END-IF.                                                      02630056
004820                                                                  02640029
070500     IF PC081-AGED-IND = 'Y'                                      02650011
070500**     ADD TO 'MORE THAN 3 DAYS' ACCUMS                           02660037
001800        ADD PC081-EXPECT-UNIT-CNT    TO PAMT3-EXPECT-UNIT-CNT     02670012
004820        ADD PC081-UNITS-ON-HOLD      TO PAMT3-UNITS-ON-HOLD       02680012
001800        ADD PC081-EXPECT-CART-CNT    TO PAMT3-EXPECT-CART-CNT     02690012
001800        ADD PC081-ACTUAL-CART-CNT    TO PAMT3-ACTUAL-CART-CNT     02700055
004820        ADD PC081-CARTONS-ON-HOLD    TO PAMT3-CARTONS-ON-HOLD     02710012
070500     END-IF.                                                      02720012
070500                                                                  02730012
070500**  ADD TO 'DC TOTAL' ACCUMS                                      02740037
001800     ADD PC081-EXPECT-UNIT-CNT       TO PADCT-EXPECT-UNIT-CNT.    02750013
004820     ADD PC081-UNITS-ON-HOLD         TO PADCT-UNITS-ON-HOLD.      02760013
001800     ADD PC081-EXPECT-CART-CNT       TO PADCT-EXPECT-CART-CNT.    02770013
001800     ADD PC081-ACTUAL-CART-CNT       TO PADCT-ACTUAL-CART-CNT.    02780055
004820     ADD PC081-CARTONS-ON-HOLD       TO PADCT-CARTONS-ON-HOLD.    02790013
070500                                                                  02800018
070500**  ADD TO 'GRAND TOTAL' ACCUMS                                   02810037
001800     ADD PC081-EXPECT-UNIT-CNT       TO PAGT-EXPECT-UNIT-CNT.     02820018
004820     ADD PC081-UNITS-ON-HOLD         TO PAGT-UNITS-ON-HOLD.       02830018
001800     ADD PC081-EXPECT-CART-CNT       TO PAGT-EXPECT-CART-CNT.     02840018
001800     ADD PC081-ACTUAL-CART-CNT       TO PAGT-ACTUAL-CART-CNT.     02850055
004820     ADD PC081-CARTONS-ON-HOLD       TO PAGT-CARTONS-ON-HOLD.     02860018
004900                                                                  02870011
003200******************************************************************02880011
002500 2800-TOTAL-ROUTINE.                                              02890028
002600                                                                  02900034
004500     PERFORM 4000-INITIALIZE-OUTPUT-REC.                          02910016
059800     MOVE PV-SAVE-OPER               TO PC082-CURRENT-OPER.       02920013
001800     MOVE PAMT3-EXPECT-UNIT-CNT      TO PC082-EXPECT-UNIT-CNT.    02930013
004820     MOVE PAMT3-UNITS-ON-HOLD        TO PC082-UNITS-ON-HOLD.      02940013
001800     MOVE PAMT3-EXPECT-CART-CNT      TO PC082-EXPECT-CART-CNT.    02950013
001800     MOVE PAMT3-ACTUAL-CART-CNT      TO PC082-ACTUAL-CART-CNT.    02960055
004820     MOVE PAMT3-CARTONS-ON-HOLD      TO PC082-CARTONS-ON-HOLD.    02970013
001900     MOVE PC-MORE-THAN-3DAY          TO PC082-VNDR-NME.           02980033
000751** WRITE THE 'MORE THAN 3 DAYS' TOTAL RECORD                      02990037
002800     PERFORM 3200-WRITE-TOTAL-RECORD.                             03000031
002500                                                                  03010013
004500     PERFORM 4000-INITIALIZE-OUTPUT-REC.                          03020016
059800     MOVE PV-SAVE-OPER               TO PC082-CURRENT-OPER.       03030013
001800     MOVE PADCT-EXPECT-UNIT-CNT      TO PC082-EXPECT-UNIT-CNT.    03040013
004820     MOVE PADCT-UNITS-ON-HOLD        TO PC082-UNITS-ON-HOLD.      03050013
001800     MOVE PADCT-EXPECT-CART-CNT      TO PC082-EXPECT-CART-CNT.    03060013
001800     MOVE PADCT-ACTUAL-CART-CNT      TO PC082-ACTUAL-CART-CNT.    03070055
004820     MOVE PADCT-CARTONS-ON-HOLD      TO PC082-CARTONS-ON-HOLD.    03080013
001900     MOVE PC-DC-TOTAL                TO PC082-VNDR-NME.           03090033
000751** WRITE THE 'DC TOTAL' RECORD                                    03100037
002800     PERFORM 3200-WRITE-TOTAL-RECORD.                             03110031
002500                                                                  03120013
000751** ZERO OUT THE 'MORE THAN 3 DAYS' AND 'DC TOTAL' ACCUMS          03130037
001800     MOVE ZEROES                     TO PADCT-EXPECT-UNIT-CNT     03140013
004820                                        PADCT-UNITS-ON-HOLD       03150013
001800                                        PADCT-EXPECT-CART-CNT     03160013
001800                                        PADCT-ACTUAL-CART-CNT     03170055
004820                                        PADCT-CARTONS-ON-HOLD     03180013
001800                                        PAMT3-EXPECT-UNIT-CNT     03190013
004820                                        PAMT3-UNITS-ON-HOLD       03200013
001800                                        PAMT3-EXPECT-CART-CNT     03210013
001800                                        PAMT3-ACTUAL-CART-CNT     03220055
004820                                        PAMT3-CARTONS-ON-HOLD.    03230013
000751                                                                  03240013
002400     MOVE PC081-CURRENT-OPER         TO PV-SAVE-OPER.             03250013
000751                                                                  03260013
003200******************************************************************03270003
003300 3000-WRITE-DETAIL-RECORD.                                        03280031
003700                                                                  03290003
003800     WRITE OUTPUT-RECORD                                          03300003
003900        FROM PC082-RECEIVER-EXT-RECORD.                           03310012
003700                                                                  03320028
004000     ADD +1                          TO PV-DTL-RECS-WROTE.        03330028
004200                                                                  03340012
004100     PERFORM 4000-INITIALIZE-OUTPUT-REC.                          03350012
000751                                                                  03360031
003200******************************************************************03370031
003300 3200-WRITE-TOTAL-RECORD.                                         03380031
003700                                                                  03390031
003800     WRITE OUTPUT-RECORD                                          03400031
003900        FROM PC082-RECEIVER-EXT-RECORD.                           03410031
003700                                                                  03420031
004000     ADD +1                          TO PV-TOT-RECS-WROTE.        03430031
004200                                                                  03440031
004100     PERFORM 4000-INITIALIZE-OUTPUT-REC.                          03450031
004200                                                                  03460031
004400******************************************************************03470032
059800 3600-WRITE-HEADINGS.                                             03480032
004200                                                                  03490032
003800     WRITE OUTPUT-RECORD                                          03500032
003900        FROM PC083-HEADING-RECORD1.                               03510032
004200                                                                  03520032
003800     WRITE OUTPUT-RECORD                                          03530032
003900        FROM PC083-HEADING-RECORD2.                               03540032
003700                                                                  03550032
004000     ADD +2                          TO PV-TOT-RECS-WROTE.        03560032
004200                                                                  03570032
004400******************************************************************03580003
004500 4000-INITIALIZE-OUTPUT-REC.                                      03590012
004900                                                                  03600003
004910     INITIALIZE PC082-RECEIVER-EXT-RECORD.                        03610012
004920     MOVE ','       TO   PC082-COMMA-1                            03620012
004930                         PC082-COMMA-2                            03630012
004940                         PC082-COMMA-3                            03640012
004950                         PC082-COMMA-4                            03650012
004960                         PC082-COMMA-5                            03660012
004970                         PC082-COMMA-6                            03670012
004980                         PC082-COMMA-7                            03680012
004990                         PC082-COMMA-8                            03690012
004991                         PC082-COMMA-9                            03700012
004992                         PC082-COMMA-10                           03710012
004993                         PC082-COMMA-11                           03720012
004994                         PC082-COMMA-12                           03730012
004995                         PC082-COMMA-13                           03740012
004996                         PC082-COMMA-14                           03750012
004997                         PC082-COMMA-15                           03760012
004998                         PC082-COMMA-16                           03770012
004999                         PC082-COMMA-17                           03780012
005000                         PC082-COMMA-18                           03790012
005001                         PC082-COMMA-19                           03800012
005002                         PC082-COMMA-20                           03810012
005003                         PC082-COMMA-21                           03820012
005004                         PC082-COMMA-22                           03830012
005005                         PC082-COMMA-23                           03840019
005005                         PC082-COMMA-24                           03850040
005005                         PC082-COMMA-25.                          03860040
005100                                                                  03870003
003200******************************************************************03880013
002500 5000-WRITE-FINAL-TOTAL-LINES.                                    03890037
002600                                                                  03900013
004500     PERFORM 4000-INITIALIZE-OUTPUT-REC.                          03910016
059800     MOVE PV-SAVE-OPER               TO PC082-CURRENT-OPER.       03920013
001800     MOVE PAMT3-EXPECT-UNIT-CNT      TO PC082-EXPECT-UNIT-CNT.    03930013
004820     MOVE PAMT3-UNITS-ON-HOLD        TO PC082-UNITS-ON-HOLD.      03940013
001800     MOVE PAMT3-EXPECT-CART-CNT      TO PC082-EXPECT-CART-CNT.    03950013
001800     MOVE PAMT3-ACTUAL-CART-CNT      TO PC082-ACTUAL-CART-CNT.    03960055
004820     MOVE PAMT3-CARTONS-ON-HOLD      TO PC082-CARTONS-ON-HOLD.    03970013
001900     MOVE PC-MORE-THAN-3DAY          TO PC082-VNDR-NME.           03980033
000751** WRITE THE 'MORE THAN 3 DAYS' TOTAL RECORD                      03990037
002800     PERFORM 3200-WRITE-TOTAL-RECORD.                             04000031
002500                                                                  04010013
004500     PERFORM 4000-INITIALIZE-OUTPUT-REC.                          04020016
059800     MOVE PV-SAVE-OPER               TO PC082-CURRENT-OPER.       04030013
001800     MOVE PADCT-EXPECT-UNIT-CNT      TO PC082-EXPECT-UNIT-CNT.    04040013
004820     MOVE PADCT-UNITS-ON-HOLD        TO PC082-UNITS-ON-HOLD.      04050013
001800     MOVE PADCT-EXPECT-CART-CNT      TO PC082-EXPECT-CART-CNT.    04060013
001800     MOVE PADCT-ACTUAL-CART-CNT      TO PC082-ACTUAL-CART-CNT.    04070055
004820     MOVE PADCT-CARTONS-ON-HOLD      TO PC082-CARTONS-ON-HOLD.    04080013
001900     MOVE PC-DC-TOTAL                TO PC082-VNDR-NME.           04090033
000751** WRITE THE 'DC TOTAL' RECORD                                    04100037
002800     PERFORM 3200-WRITE-TOTAL-RECORD.                             04110031
002500                                                                  04120013
004500     PERFORM 4000-INITIALIZE-OUTPUT-REC.                          04130016
001800     MOVE PAGT-EXPECT-UNIT-CNT       TO PC082-EXPECT-UNIT-CNT.    04140013
004820     MOVE PAGT-UNITS-ON-HOLD         TO PC082-UNITS-ON-HOLD.      04150013
001800     MOVE PAGT-EXPECT-CART-CNT       TO PC082-EXPECT-CART-CNT.    04160013
001800     MOVE PAGT-ACTUAL-CART-CNT       TO PC082-ACTUAL-CART-CNT.    04170055
004820     MOVE PAGT-CARTONS-ON-HOLD       TO PC082-CARTONS-ON-HOLD.    04180013
001900     MOVE PC-GRAND-TOTAL-VALUE       TO PC082-VNDR-NME.           04190033
000751** WRITE THE 'GRAND TOTAL' RECORD                                 04200037
002800     PERFORM 3200-WRITE-TOTAL-RECORD.                             04210031
002500                                                                  04220013
003200******************************************************************04230012
003200*  IF EMPTY INPUT FILE, WRITE HEADING LINES AND 'NO DATA' LINE    04240060
003200*     OTHERWISE WRITE THE FINAL TOTAL LINES.                      04250060
003200*  DISPLAY PROGRAM COUNTS.                                        04260060
003200*  CLOSE INPUT AND OUTPUT FILES.                                  04270060
003200******************************************************************04280037
003300 9000-EXIT-ROUTINE.                                               04290012
273300                                                                  04300012
033500     IF PS-FIRST-READ-Y                                           04310058
059800        PERFORM 3600-WRITE-HEADINGS                               04320058
004500        PERFORM 4000-INITIALIZE-OUTPUT-REC                        04330059
000662        MOVE PC-NO-DATA-FOUND        TO PC082-VNDR-NME            04340059
003300        PERFORM 3000-WRITE-DETAIL-RECORD                          04350059
033500     ELSE                                                         04360059
002500        PERFORM 5000-WRITE-FINAL-TOTAL-LINES                      04370058
033500     END-IF.                                                      04380059
273300                                                                  04390014
057320     DISPLAY ' '.                                                 04400012
057320     DISPLAY '    ** PROGRAM TOTALS **'.                          04410012
273300                                                                  04420012
057320     MOVE PV-RECORDS-READ                     TO PV-DISP-DEC.     04430012
057320     DISPLAY ' INPUT RECORDS READ = '            PV-DISP-DEC.     04440028
057320     MOVE PV-DTL-RECS-WROTE                   TO PV-DISP-DEC.     04450028
057320     DISPLAY ' DETAIL RECORDS WROTE =  '         PV-DISP-DEC.     04460028
057320     MOVE PV-TOT-RECS-WROTE                   TO PV-DISP-DEC.     04470028
057320     DISPLAY '  TOTAL RECORDS WROTE =  '         PV-DISP-DEC.     04480028
057320     DISPLAY ' '.                                                 04490012
049300                                                                  04500012
001140     CLOSE INPUT-FILE                                             04510012
001150           OUTPUT-FILE.                                           04520012
049300                                                                  04530012
