000100 TITLE 'STORE TRAILER BUSINESS AREA SUMMARY'.                     00010002
000200 IDENTIFICATION DIVISION.                                         00020002
000300 PROGRAM-ID.    SUKCS571.                                         00030002
000400 AUTHOR.        DENNIS STEFFEN.                                   00040002
000500 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00050002
000600 DATE-WRITTEN.  SPRING 2002.                                      00060002
000700 DATE-COMPILED.                                                   00070002
263968*---------------------------------------------------------------* 00080040
263968* CHANGED 11/15/2021    BY JIM HUNTER      WR: CHG0263968         00090040
263968* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00100040
263968* MAKING THE CALL DYNAMIC VS STATIC.                              00110040
001130*                                                                 00120041
001110* CHANGED 01/09/2023    BY JEAN KURK       WR: CHG0278099         00130041
001120* CHANGE CALL OF DPKCS030 TO BE DYNAMIC                           00140041
001130*                                                                 00141046
001110* CHANGED 11/02/2023    BY BOB MCASEY      WR: CHG0298260         00142047
001120* CHANGE AREA AND UNIT SEQUENCE CURSORS TO RETURN ALL AREAS NOT   00143046
001120* JUST THE AREAS WITH UNITS/SKU COUNT.                            00144047
263968*---------------------------------------------------------------* 00150040
000800 ENVIRONMENT DIVISION.                                            00160002
000900 DATA DIVISION.                                                   00170002
001000                                                                  00180002
001100 WORKING-STORAGE SECTION.                                         00190002
001200                                                                  00200002
001300 01  DK-DB2-KEYS.                                                 00210002
001400     05  DK-TRIP-OCRNC-ID             PIC S9(9) COMP VALUE ZERO.  00220002
001500     05  DK-OTBND-TRIP-ID             PIC S9(9) COMP VALUE ZERO.  00230002
001600     05  DK-STATUS-CODE-1             PIC X(02) VALUE SPACE.      00240002
001700     05  DK-STATUS-CODE-2             PIC X(02) VALUE SPACE.      00250002
001800     05  DK-STATUS-CODE-3             PIC X(02) VALUE SPACE.      00260002
001900     05  DK-STATUS-CODE-4             PIC X(02) VALUE SPACE.      00270002
002000     05  DK-FROM-DATE                 PIC X(10) VALUE SPACE.      00280002
002100     05  DK-TO-DATE                   PIC X(10) VALUE SPACE.      00290002
002110     05  DK-BUS-AREA-ID               PIC S9(4) COMP-3.           00300012
002130     05  DK-PRINTER-DEST.                                         00310034
002140         10 DK-PRINTER-DEST-1          PIC X(01) VALUE SPACE.     00320034
002150         10 DK-PRINTER-DEST-7          PIC X(07) VALUE SPACE.     00330034
002200                                                                  00340002
002300 01  PC-PROGRAM-CONSTANTS.                                        00350002
002400     05  PC-INTER-APPL-CODES.                                     00360002
002500         10  PC-INTER-APPL-CRIT-SPEC    PIC  X(01)  VALUE '1'.    00370002
002600         10  PC-INTER-APPL-LIST         PIC  X(01)  VALUE '2'.    00380002
002700     05  PC-CURRENT-MAP-NAME            PIC  X(08)  VALUE         00390002
002800                                                    'SU571A  '.   00400002
002900     05  PC-CURRENT-MAPSET-NAME         PIC  X(08)  VALUE         00410002
003000                                                    'SUKM571 '.   00420002
003100     05  PC-CURRENT-PROGRAM-NAME        PIC  X(08)  VALUE         00430002
003200                                                    'SUKCS571'.   00440002
003210     05  PC-DPKCS060                    PIC  X(08)  VALUE         00450026
003220                                                    'DPKCS060'.   00460026
003300     05  PC-LIST-QUEUE-SEQ              PIC  9(01)  VALUE 1.      00470002
003400     05  PC-SEL-QUEUE-SEQ               PIC  9(01)  VALUE 2.      00480002
003500     05  PC-CRIT-SPEC-FORMAT            PIC  X(01)  VALUE '1'.    00490002
003600     05  PC-ITEMS-PER-PANEL             PIC S9(04)  VALUE +10     00500002
003700                                                    COMP SYNC.    00510002
003800     05  PC-MAX-BLOCKS-IN-ARRAY         PIC S9(04)  VALUE +2      00520002
003900                                                    COMP SYNC.    00530002
004000     05  PC-MAX-ITEMS                   PIC S9(09)  VALUE         00540002
004100                                                    +1000000      00550002
004200                                                    COMP-3.       00560002
004300     05  PC-MSG-NUMBER-LENGTH           PIC S9(04)  VALUE +5      00570002
004400                                                    COMP SYNC.    00580002
004500     05  PC-PERCENT                     PIC  X(01)  VALUE '%'.    00590002
004600     05  PC-INQ                         PIC  X(03)  VALUE 'INQ'.  00600002
004700     05  PC-UPD                         PIC  X(03)  VALUE 'UPD'.  00610002
004800     05  PC-DEL                         PIC  X(03)  VALUE 'DEL'.  00620002
004900     05  PC-ERR                         PIC  X(03)  VALUE 'ERR'.  00630002
005000*                                                                 00640002
005100     05  PC-TSYMSG-NUMBERS.                                       00650002
005200         10  PC-TSYMSG-00005            PIC  9(05)  VALUE 00005.  00660002
005210         10  PC-TSYMSG-00007            PIC  9(05)  VALUE 00007.  00670025
005300         10  PC-TSYMSG-00008            PIC  9(05)  VALUE 00008.  00680002
005400         10  PC-TSYMSG-00050            PIC  9(05)  VALUE 00050.  00690002
005500         10  PC-TSYMSG-00051            PIC  9(05)  VALUE 00051.  00700002
005600         10  PC-TSYMSG-00052            PIC  9(05)  VALUE 00052.  00710002
005700         10  PC-TSYMSG-00053            PIC  9(05)  VALUE 00053.  00720002
005800         10  PC-TSYMSG-00054            PIC  9(05)  VALUE 00054.  00730002
005900         10  PC-TSYMSG-00055            PIC  9(05)  VALUE 00055.  00740002
006000         10  PC-TSYMSG-00057            PIC  9(05)  VALUE 00057.  00750002
006100         10  PC-TSYMSG-00069            PIC  9(05)  VALUE 00069.  00760002
006200         10  PC-TSYMSG-00070            PIC  9(05)  VALUE 00070.  00770002
006210         10  PC-TSYMSG-00098            PIC  9(05)  VALUE 00098.  00780021
006300         10  PC-TSYMSG-00101            PIC  9(05)  VALUE 00101.  00790002
006400         10  PC-TSYMSG-00134            PIC  9(05)  VALUE 00134.  00800037
006410         10  PC-TSYMSG-00148            PIC  9(05)  VALUE 00148.  00810037
006500         10  PC-TSYMSG-00279            PIC  9(05)  VALUE 00279.  00820002
006600         10  PC-TSYMSG-00551            PIC  9(05)  VALUE 00551.  00830002
006610         10  PC-TSYMSG-00746            PIC  9(05)  VALUE 00746.  00840033
006700         10  PC-TSYMSG-99901            PIC  9(05)  VALUE 99901.  00850002
006800*                                                                 00860002
006900 01  PS-PROGRAM-SWITCHES.                                         00870002
007000     05  PS-ERROR-SW                    PIC  X(01)  VALUE 'N'.    00880002
007100         88  PS-NO-ERROR                            VALUE 'N'.    00890002
007200         88  PS-ERROR                               VALUE 'Y'.    00900002
007300     05  PS-COMMAREA-SW                 PIC  X(01)  VALUE 'N'.    00910002
007400         88  PS-COMMAREA-VALID                      VALUE 'Y'.    00920002
007500         88  PS-COMMAREA-NOT-VALID                  VALUE 'N'.    00930002
007600     05  PS-DONE-SW                     PIC  X(01)  VALUE 'N'.    00940002
007700         88  PS-DONE                                VALUE 'Y'.    00950002
007800         88  PS-NOT-DONE                            VALUE 'N'.    00960002
007900     05  PS-NEXT-SCREEN-SW            PIC  X    VALUE 'N'.        00970002
008000         88  PS-NO-NEXT-SCREEN                  VALUE 'N'.        00980002
008100         88  PS-NEXT-SCREEN                     VALUE 'Y'.        00990002
008300     05  PS-LIST-END-SW               PIC X(01)  VALUE 'N'.       01000000
008400         88  PS-LIST-END                         VALUE 'Y'.       01010000
008500         88  PS-NO-LIST-END                      VALUE 'N'.       01020000
008600*                                                                 01030002
008700 01  PV-PROGRAM-VARIABLES.                                        01040002
008800     05  PV-SUB                         PIC S9(04)  VALUE +0      01050002
008900                                                    COMP SYNC.    01060002
009000     05  PV-REMAINDER                   PIC S9(04)  VALUE +0      01070002
009100                                                    COMP SYNC.    01080002
009200     05  PV-READ-COUNT                  PIC S9(09)  VALUE +0      01090002
009300                                                    COMP-3.       01100002
009400     05  PV-ITEMS-PROCESSED             PIC S9(09)  VALUE +0      01110002
009500                                                    COMP-3.       01120002
009600     05  PV-HOLD-SELECTED-ITEMS         PIC S9(09)  VALUE +0      01130002
009700                                                    COMP-3.       01140002
009800     05  PV-ITEM-IN-USE                 PIC S9(09)  VALUE +0      01150002
009900                                                    COMP-3.       01160002
010000     05  PV-TOP-ITEM                    PIC S9(09)  VALUE +0      01170002
010100                                                    COMP-3.       01180002
010200     05  PV-BOTTOM-ITEM                 PIC S9(09)  VALUE +0      01190002
010300                                                    COMP-3.       01200002
010400     05  PV-TEMP-BLOCK-NUMBER           PIC S9(09)  VALUE +0      01210002
010500                                                    COMP-3.       01220002
010600     05  PV-BLOCK-NUMBER                PIC S9(04)  VALUE +0      01230002
010700                                                    COMP SYNC.    01240002
010800     05  PV-CICS-RESP                   PIC S9(04)  VALUE +0      01250002
010900                                                    COMP SYNC.    01260002
011000     05  PV-ITEM                        PIC S9(04)  VALUE +0      01270002
011100                                                    COMP SYNC.    01280002
011200     05  PV-SEL-QUEUE-ITEM              PIC S9(04)  VALUE +0      01290002
011300                                                    COMP SYNC.    01300002
011400     05  PV-SAVE-ITEM                   PIC S9(04)  VALUE +0      01310002
011500                                                    COMP SYNC.    01320002
011600     05  PV-HIGHEST-BLOCK-WRITTEN       PIC S9(04)  VALUE +0      01330002
011700                                                    COMP SYNC.    01340002
011800     05  PV-LIST-ITEM-NUMBER            PIC S9(04)  VALUE +0      01350002
011900                                                    COMP SYNC.    01360002
012000     05  PV-FIRST-BLOCK-IN-ARRAY        PIC S9(04)  VALUE +0      01370002
012100                                                    COMP SYNC.    01380002
012200     05  PV-NEXT-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      01390002
012300                                                    COMP SYNC.    01400002
012400     05  PV-PREV-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      01410002
012500                                                    COMP SYNC.    01420002
012600     05  PV-FIRST-BLOCK-IN-RANGE        PIC S9(04)  VALUE +0      01430002
012700                                                    COMP SYNC.    01440002
012800     05  PV-LAST-BLOCK-IN-RANGE         PIC S9(04)  VALUE +0      01450002
012900                                                    COMP SYNC.    01460002
013000     05  PV-START-OF-SELECTED-RANGE     PIC S9(04)  VALUE +0      01470002
013100                                                    COMP SYNC.    01480002
013200     05  PV-END-OF-SELECTED-RANGE       PIC S9(04)  VALUE +0      01490002
013300                                                    COMP SYNC.    01500002
013400     05  PV-SQL-SUB                     PIC S9(04)  VALUE +0      01510002
013500                                                    COMP SYNC.    01520002
013600     05  PV-DB2-DATE.                                             01530002
013700         10  PV-DB2-MM                PIC XX VALUE ZERO.          01540002
013800         10  FILLER                   PIC X VALUE '/'.            01550002
013900         10  PV-DB2-DD                PIC XX VALUE ZERO.          01560002
014000         10  FILLER                   PIC X VALUE '/'.            01570002
014100         10  PV-DB2-YY                PIC XX VALUE ZERO.          01580002
014200     05  PV-DATE                      PIC X(10) VALUE SPACES.     01590002
014300     05  PV-TIME                      PIC X(08) VALUE SPACES.     01600002
014400     05  PV-DB2-COUNT                 PIC S9(8) COMP VALUE ZERO.  01610002
014410     05  PV-COMMAREA-LENGTH           PIC S9(04) VALUE ZERO       01620022
014420                                                 COMP SYNC.       01630022
014500                                                                  01640002
014600******************************************************************01650002
014700**  THIS IS THE LAYOUT FOR THE LIST ITEMS TEMP STORAGE QUEUE.   **01660002
014800**  THIS MUST BE THE EXACT SAME FORMAT A BLOCK IN THE           **01670002
014900**  APPLICATION-SPECIFIC COMMAREA.                              **01680002
015000******************************************************************01690002
015100 01  LQW-LIST-QUEUE-WORK-AREA.                                    01700002
015200     05  LQW-BLOCK-MODIFIED             PIC  X(01)  VALUE SPACE.  01710002
015300     05  LQW-ITEM-ENTRIES               OCCURS 10 TIMES           01720002
015400                                        INDEXED BY LQW-IDX.       01730002
015500         10  LQW-LIST-ITEM-NUMBER       PIC S9(09)  COMP-3.       01740002
015600         10  LQW-TEMP-SELECTED-SW       PIC  X(01).               01750002
015700         10  LQW-SELECTED-SW          PIC  X(01).                 01760002
015800             88  LQW-SELECT                         VALUE 'S'.    01770002
015900             88  LQW-DESELECT                       VALUE ' '.    01780002
016000         10  LQW-ACTION               PIC X(03).                  01790002
016100         10  LQW-AREA                 PIC 9(03).                  01800002
016200         10  LQW-AREA-DESC            PIC X(25).                  01810002
016300         10  LQW-CARTONS              PIC S9(07) COMP-3.          01820002
016400         10  LQW-UNITS                PIC S9(07) COMP-3.          01830002
016500         10  LQW-SKU-COUNT            PIC S9(07) COMP-3.          01840002
016600         10  LQW-AD                   PIC X(01).                  01850002
016700                                                                  01860002
016800/                                                                 01870002
016900*---------------------------------------------------------------* 01880002
017000*  RECORD LAYOUT FOR THE MESSAGE SELECTION TEMP STORAGE QUEUE.  * 01890002
017100*---------------------------------------------------------------* 01900002
017300     COPY SUWS013.                                                01910016
017400                                                                  01920002
017500/                                                                 01930002
017501*---------------------------------------------------------------* 01940025
017510*    COMMAREA TO LINK TO DPKCS060 - PRINT DEST VALIDATION         01950025
017511*---------------------------------------------------------------* 01960025
017520     COPY DPWS072.                                                01970025
017530/                                                                 01980025
017600*---------------------------------------------------------------* 01990002
017700*    MAP LAYOUT                                                 * 02000002
017800*---------------------------------------------------------------* 02010002
017900                                                                  02020002
018000     COPY SUKM571.                                                02030002
018100*                                                                 02040002
018200 01  MR-OCCURS-LAYOUT                   REDEFINES  SU571AO.       02050002
018300*    05  FILLER                         PIC X(248).               02060022
018310     05  FILLER                         PIC X(261).               02070023
018400     05  MR-SCROLL-AREA                 OCCURS 10 TIMES.          02080002
018500         10  MR-SELECTL                 PIC S9(04) COMP.          02090002
018600         10  MR-SELECTA                 PIC  X(01).               02100002
018700         10  MR-SELECTC                 PIC  X(01).               02110002
018800         10  MR-SELECTH                 PIC  X(01).               02120002
018900         10  MR-SELECTI                 PIC  X(01).               02130002
019000                                                                  02140002
019100         10  MR-ACTIONL                 PIC S9(04) COMP.          02150002
019200         10  MR-ACTIONA                 PIC  X(01).               02160002
019300         10  MR-ACTIONC                 PIC  X(01).               02170002
019400         10  MR-ACTIONH                 PIC  X(01).               02180002
019500         10  MR-ACTION                  PIC  X(03).               02190002
019600                                                                  02200002
019700         10  MR-AREA-L                  PIC S9(04) COMP.          02210002
019800         10  MR-AREA-A                  PIC  X(01).               02220002
019900         10  MR-AREA-C                  PIC  X(01).               02230002
020000         10  MR-AREA-H                  PIC  X(01).               02240002
020100         10  MR-AREA                    PIC  X(03).               02250002
020200                                                                  02260002
020300         10  MR-AREA-DESC-L             PIC S9(04) COMP.          02270002
020400         10  MR-AREA-DESC-A             PIC  X(01).               02280002
020500         10  MR-AREA-DESC-C             PIC  X(01).               02290002
020600         10  MR-AREA-DESC-H             PIC  X(01).               02300002
020700         10  MR-AREA-DESC               PIC  X(25).               02310002
020800                                                                  02320002
020900         10  MR-CARTONS-L               PIC S9(04) COMP.          02330002
021000         10  MR-CARTONS-A               PIC  X(01).               02340002
021100         10  MR-CARTONS-C               PIC  X(01).               02350002
021200         10  MR-CARTONS-H               PIC  X(01).               02360002
021300         10  MR-CARTONS                 PIC  ZZZ,ZZZ.             02370002
021400                                                                  02380002
021500         10  MR-UNITS-L                 PIC S9(04) COMP.          02390002
021600         10  MR-UNITS-A                 PIC  X(01).               02400002
021700         10  MR-UNITS-C                 PIC  X(01).               02410002
021800         10  MR-UNITS-H                 PIC  X(01).               02420002
021900         10  MR-UNITS                   PIC  ZZZ,ZZZ.             02430002
022000                                                                  02440002
022100         10  MR-SKU-COUNT-L             PIC S9(04) COMP.          02450002
022200         10  MR-SKU-COUNT-A             PIC  X(01).               02460002
022300         10  MR-SKU-COUNT-C             PIC  X(01).               02470002
022400         10  MR-SKU-COUNT-H             PIC  X(01).               02480002
022500         10  MR-SKU-COUNT               PIC  ZZZ,ZZZ.             02490002
022600                                                                  02500002
022700         10  MR-AD-L                    PIC S9(04) COMP.          02510002
022800         10  MR-AD-A                    PIC  X(01).               02520002
022900         10  MR-AD-C                    PIC  X(01).               02530002
023000         10  MR-AD-H                    PIC  X(01).               02540002
023100         10  MR-AD                      PIC  X(01).               02550002
023200     05  FILLER                         PIC X(023).               02560002
023300/                                                                 02570002
023400*---------------------------------------------------------------* 02580002
023500*    ATTRIBUTE SETTINGS                                           02590002
023600*---------------------------------------------------------------* 02600002
023700                                                                  02610002
023800     COPY DPWS015.                                                02620016
023900                                                                  02630002
024000*---------------------------------------------------------------* 02640002
024100*    FUNCTION KEYS                                                02650002
024200*---------------------------------------------------------------* 02660002
024300                                                                  02670002
024400     COPY DPWS016.                                                02680016
024500                                                                  02690002
024600*---------------------------------------------------------------* 02700002
024700*    NUMERIC EDIT LAYOUT.                                       * 02710002
024800*---------------------------------------------------------------* 02720002
024900                                                                  02730002
025000     COPY DPWS010I.                                               02740016
025100/                                                                 02750002
025200*---------------------------------------------------------------* 02760002
025300*    PARAMETERS FOR CALLING CICS ARCHITECTURE API               * 02770041
025400*---------------------------------------------------------------* 02780002
025500                                                                  02790002
025600     COPY DPWS030.                                                02800016
025600     COPY DPWS930.                                                02810041
025700/                                                                 02820002
025800*---------------------------------------------------------------* 02830002
025900*    STANDARD COMMAREA.                                         * 02840002
026000*---------------------------------------------------------------* 02850002
026100                                                                  02860002
026200     COPY DPWS020.                                                02870016
026300     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                02880002
026400                                                                  02890002
026500*---------------------------------------------------------------* 02900002
026600* INTER-APPLICATION COMMAREA.                                   * 02910002
026700*   DPWS054 - IS THE INPUT LAYOUT WHEN COMING FROM THE CRIT.    * 02920002
026800*             SPEC SCREEN.                                      * 02930002
026900*   DPWS056 - IS THE OUTPUT LAYOUT THAT WILL BE PASSED FROM     * 02940002
027000*             THIS LIST PROGRAMMING FOR A LOCAL-GO FUNCTION.    * 02950002
027100*---------------------------------------------------------------* 02960002
027200                                                                  02970002
027300         10  INTER-APPL-COMM-AREA       PIC X(200).               02980002
027400                                                                  02990002
027500*  INPUT FROM CRIT SPEC SCREEN, SUKCS566                          03000002
027600     COPY SUWS011.                                                03010002
027700                                                                  03020002
027800*  OUTPUT TO LIST SCREEN, SUKCS568                                03030002
027900     COPY SUWS012.                                                03040002
027901                                                                  03050021
028000*---------------------------------------------------------------* 03060002
028100*  THIS IS THE APPLICATION-SPECIFIC COMMAREA.                   * 03070002
028200*---------------------------------------------------------------* 03080002
028300         10  ASC-SPECIFIC-COMMAREA.                               03090002
028400             15  ASC-INT-APPL-FORMAT-IND    PIC  X(01).           03100002
028500             15  ASC-LIST-KEYS.                                   03110002
028600                 20  ASC-KEY-TRIP-ID        PIC S9(09) COMP.      03120002
028700             15  ASC-BLOCK-ENTRIES OCCURS 2 TIMES.                03130002
028800                 20  ASC-BLOCK-MODIFIED-SW           PIC  X(01).  03140002
028900                     88  ASC-BLOCK-NOT-MODIFIED      VALUE 'N'.   03150002
029000                     88  ASC-BLOCK-MODIFIED          VALUE 'Y'.   03160002
029100                                                                  03170002
029200                 20  ASC-ITEM-ARRAY.                              03180002
029300                     25  ASC-ITEM-ENTRIES OCCURS 10 TIMES.        03190002
029400                         30  ASC-LIST-ITEM-NUMBER                 03200002
029500                                                     PIC S9(09)   03210002
029600                                                     COMP-3.      03220002
029700                         30  ASC-TEMP-SELECTED-SW    PIC  X(01).  03230002
029800                             88  ASC-VALID-SELECT    VALUE ' '    03240002
029900                                                           'S'    03250002
030000                                                           'B'    03260002
030100                                                           'E'.   03270002
030200                             88  ASC-TEMP-NO-SELECT  VALUE ' '.   03280002
030300                             88  ASC-TEMP-SELECT     VALUE 'S'.   03290002
030400                             88  ASC-TEMP-BEGIN      VALUE 'B'.   03300002
030500                             88  ASC-TEMP-END        VALUE 'E'.   03310002
030600                         30  ASC-SELECTED-SW         PIC  X(01).  03320002
030700                             88  ASC-NO-SELECT       VALUE ' '.   03330002
030800                             88  ASC-SELECT          VALUE 'S'.   03340002
030900                             88  ASC-BEGIN           VALUE 'B'.   03350002
031000                             88  ASC-END             VALUE 'E'.   03360002
031100                         30  ASC-ACTION              PIC  X(03).  03370002
031200                         30  ASC-AREA      PIC 9(03).             03380002
031300                         30  ASC-AREA-DESC PIC X(25).             03390002
031400                         30  ASC-CART-QTY  PIC S9(07) COMP-3.     03400002
031500                         30  ASC-UNT-QTY   PIC S9(07) COMP-3.     03410002
031600                         30  ASC-SKU-COUNT PIC S9(07) COMP-3.     03420002
031700                         30  ASC-AD        PIC X(01).             03430002
031800                                                                  03440002
031900                                                                  03450002
032000             15  ASC-BLK-SUB          PIC S9(04) COMP SYNC.       03460002
032100             15  ASC-ITEM-SUB         PIC S9(04) COMP SYNC.       03470002
032200             15  ASC-NUMBER-OF-ITEMS-READ      PIC S9(09) COMP-3. 03480002
032300             15  ASC-NUMBER-OF-SELECTED-ITEMS  PIC S9(09) COMP-3. 03490002
032400             15  ASC-ITEMS-DISPLAYED           PIC S9(03) COMP-3. 03500002
032500             15  ASC-ITEM-AT-TOP-OF-PANEL      PIC S9(09) COMP-3. 03510002
032600             15  ASC-ITEM-AT-BOT-OF-PANEL      PIC S9(09) COMP-3. 03520002
032700             15  ASC-HIGHEST-BLOCK-WRITTEN     PIC S9(04) COMP    03530002
032800                                                          SYNC.   03540002
032900             15  ASC-START-OF-SELECTED-RANGE         PIC S9(09)   03550002
033000                                                          COMP-3. 03560002
033100             15  ASC-END-OF-SELECTED-RANGE           PIC S9(09)   03570002
033200                                                          COMP-3. 03580002
033300             15  ASC-ITEMS-LEFT-INDICATOR            PIC  X(01).  03590002
033400                 88  ASC-ITEMS-LEFT-ON-DB            VALUE 'Y'.   03600002
033500                 88  ASC-NO-ITEMS-LEFT-ON-DB         VALUE 'N'.   03610002
033600             15  ASC-TEMP-QUEUE-UPDATE-SW            PIC  X(01).  03620002
033700                 88  ASC-UPDATE-TSQ                  VALUE 'Y'.   03630002
033800                 88  ASC-NO-TSQ-UPDATE               VALUE ' '.   03640002
033900             15  ASC-LIST-QUEUE-NAME.                             03650002
034000                 20  ASC-LIST-TERM-ID                PIC  X(04).  03660002
034100                 20  ASC-LIST-TASK-NUMBER            PIC S9(05)   03670002
034200                                                          COMP-3. 03680002
034300                 20  ASC-LIST-SEQ                    PIC  9(01).  03690002
034400             15  ASC-SEL-QUEUE-NAME-IN.                           03700002
034500                 20  ASC-SEL-TERM-ID-IN              PIC  X(04).  03710002
034600                 20  ASC-SEL-TASK-NUMBER-IN          PIC S9(05)   03720002
034700                                                          COMP-3. 03730002
034800                 20  ASC-SEL-SEQ-IN                  PIC  9(01).  03740002
034900             15  ASC-SEL-QUEUE-NAME-OUT.                          03750002
035000                 20  ASC-SEL-TERM-ID-OUT             PIC  X(04).  03760002
035100                 20  ASC-SEL-TASK-NUMBER-OUT         PIC S9(05)   03770002
035200                                                          COMP-3. 03780002
035300                 20  ASC-SEL-SEQ-OUT                 PIC  9(01).  03790002
035400                                                                  03800002
035500             15  ASC-USE-SELECTION-QUEUE-IND                      03810002
035600                                                 PIC  X(01).      03820002
035700                 88  ASC-USE-SELECTION-QUEUE           VALUE 'Y'. 03830002
035800             15  ASC-NUMBER-OF-TS-ITEMS    PIC S9(05)  COMP-3.    03840002
035900             15  ASC-SEL-SUB               PIC S9(04)  COMP.      03850002
036000             15  ASC-SEL-ITEM              PIC S9(04)  COMP.      03860002
036100             15  ASC-START-ITEM-REQUEST.                          03870002
036200                 20  ASC-START-ITEM-REQUEST-N        PIC  9(05).  03880002
036300                                                                  03890002
036400                                                                  03900002
036500             15  ASC-CURR-OPER-UNT-ID PIC S9(04) COMP.            03910002
036600             15  ASC-SERVICE-DC-NAME  PIC X(20).                  03920002
036700             15  ASC-STR-NAME         PIC X(25).                  03930002
036800             15  ASC-STR-NBR          PIC S9(04) COMP.            03940002
036900             15  ASC-TRLR-SRL-NBR     PIC S9(09) COMP.            03950002
037000             15  ASC-TRIP-OCRNC-ID    PIC S9(09) COMP.            03960002
037100             15  ASC-SCAC             PIC X(04).                  03970002
037200             15  ASC-TRLR-ID          PIC X(12).                  03980002
037300             15  ASC-TRIP-STAT-DESC   PIC X(10).                  03990002
037400             15  ASC-TOTAL-CARTONS    PIC S9(07) COMP-3.          04000002
037500             15  ASC-TOTAL-UNITS      PIC S9(07) COMP-3.          04010002
037510             15  ASC-PRINTER-DEST     PIC X(08).                  04020027
037600             15  ASC-SUMMARY-DATE     PIC X(10).                  04030002
037700             15  ASC-SUMMARY-TIME     PIC X(08).                  04040002
037800             15  ASC-SCREEN-SEQUENCE  PIC X(01).                  04050002
037900                 88  ASC-DEPT-SEQ                VALUE 'D'.       04060002
038000                 88  ASC-UNIT-SEQ                VALUE 'U'.       04070002
038100             15  ASC-SEQ-DESC         PIC X(20).                  04080002
038200/                                                                 04090002
038210******************************************************************04100027
038300*    ABEND PROCESSING                                             04110002
038400                                                                  04120002
038500     COPY DPWS013.                                                04130016
038600/                                                                 04140002
038601******************************************************************04150027
038610*  OUTPUT TO REPORT PGM , SUKCS546                                04160027
038620     COPY SUWS083.                                                04170027
038630/                                                                 04180027
038640******************************************************************04190027
038700     EXEC SQL                                                     04200002
038800          INCLUDE TSUOBTR                                         04210002
038900     END-EXEC.                                                    04220002
039000                                                                  04230002
039500*    BUSINESS GROUP SUMMARY                                       04240002
039600     EXEC SQL                                                     04250002
039700          INCLUDE SUT00008                                        04260002
039800     END-EXEC.                                                    04270002
039900                                                                  04280002
040000*    MAJOR CLASS SUMMARY                                          04290002
040100     EXEC SQL                                                     04300002
040200          INCLUDE SUT00010                                        04310002
040300     END-EXEC.                                                    04320002
040400                                                                  04330002
040500*    MAJOR CLASS AD DATE                                          04340002
040600     EXEC SQL                                                     04350002
040700          INCLUDE SUT00011                                        04360002
040800     END-EXEC.                                                    04370002
040900                                                                  04380016
041000*    DOMAIN BUSINESS AREA                                         04390002
041100     EXEC SQL                                                     04400002
041200          INCLUDE XLT00000                                        04410002
041300     END-EXEC.                                                    04420002
041400                                                                  04430002
041500*    DOMAIN BUSINESS GROUP                                        04440002
041600     EXEC SQL                                                     04450002
041700          INCLUDE XLT00001                                        04460002
041800     END-EXEC.                                                    04470002
041810                                                                  04480016
041820*    DOMAIN LOCATION TABLE                                        04490016
041830     EXEC SQL                                                     04500016
041840          INCLUDE XLT00010                                        04510016
041850     END-EXEC.                                                    04520016
041900/                                                                 04530002
042000     EXEC SQL                                                     04540002
042100         DECLARE GROUP-CSR CURSOR FOR                             04550002
1123RM          SELECT T1.BUS_AREA_ID                                   04560042
1123RM               , IFNULL (T2.UNT_QTY,0)                            04570045
1123RM               , IFNULL (T2.SKU_QTY,0)                            04580045
1123RM               , IFNULL( T2.CART_QTY,0)                           04590045
1123RM               , T1.BUS_AREA_DESC                                 04600042
1123RM          FROM                                                    04610042
1123RM          (                                                       04620042
1123RM         SELECT A.BUS_AREA_ID                                     04630042
1123RM              , A.BUS_AREA_DESC                                   04640042
1123RM          FROM                                                    04650042
1123RM             XLT_BUS_AREA A                                       04660045
1123RM         ) AS T1                                                  04670042
1123RM         LEFT OUTER JOIN                                          04680042
1123RM         (                                                        04690042
1123RM         SELECT S.TRIP_OCRNC_ID                                   04700042
1123RM                , S.BUS_AREA_ID                                   04710042
1123RM                , S.UNT_QTY                                       04720042
1123RM                , S.SKU_QTY                                       04730042
1123RM                , S.CART_QTY                                      04740042
1123RM                , A.BUS_AREA_DESC                                 04750042
1123RM          FROM SUT_BUS_AREA_SUM S                                 04760045
1123RM             , XLT_BUS_AREA A                                     04770045
1123RM          WHERE                                                   04780042
1123RM               S.TRIP_OCRNC_ID = :DK-TRIP-OCRNC-ID                04790042
1123RM         AND   S.BUS_AREA_ID   = A.BUS_AREA_ID                    04800042
1123RM         ) AS T2                                                  04810042
1123RM           ON T2.BUS_AREA_ID = T1.BUS_AREA_ID                     04820042
1123RM                                                                  04830042
1123RM         ORDER BY T1.BUS_AREA_DESC                                04840042
1123RM                , T1.BUS_AREA_ID                                  04850042
1123RM         WITH UR                                                  04860042
           END-EXEC.                                                    05010042
043300                                                                  05020002
043400     EXEC SQL                                                     05030002
043500         DECLARE UNIT-CSR CURSOR FOR                              05040002
1123RM          SELECT T1.BUS_AREA_ID                                   05050042
1123RM               , IFNULL (T2.UNT_QTY,0) AS UNIT_QTY                05060046
1123RM               , IFNULL (T2.SKU_QTY,0)                            05070045
1123RM               , IFNULL (T2.CART_QTY,0)                           05080045
1123RM               , T1.BUS_AREA_DESC                                 05090042
1123RM          FROM                                                    05100042
1123RM          (                                                       05110042
1123RM             SELECT A.BUS_AREA_ID                                 05120046
1123RM                  , A.BUS_AREA_DESC                               05130046
1123RM              FROM                                                05140046
1123RM                 XLT_BUS_AREA A                                   05150046
1123RM         ) AS T1                                                  05160042
1123RM         LEFT OUTER JOIN                                          05170042
1123RM         (                                                        05180042
1123RM         SELECT S.TRIP_OCRNC_ID                                   05190042
1123RM                , S.BUS_AREA_ID                                   05200042
1123RM                , S.UNT_QTY                                       05210042
1123RM                , S.SKU_QTY                                       05220042
1123RM                , S.CART_QTY                                      05230042
1123RM                , A.BUS_AREA_DESC                                 05240042
1123RM          FROM SUT_BUS_AREA_SUM S                                 05250045
1123RM             , XLT_BUS_AREA A                                     05260045
1123RM          WHERE                                                   05270042
1123RM               S.TRIP_OCRNC_ID = :DK-TRIP-OCRNC-ID                05280042
1123RM         AND   S.BUS_AREA_ID   = A.BUS_AREA_ID                    05290042
1123RM         ) AS T2                                                  05300042
1123RM           ON T2.BUS_AREA_ID = T1.BUS_AREA_ID                     05310042
1123RM                                                                  05320042
1123RM         ORDER BY UNIT_QTY DESC                                   05330046
1123RM                , T1.BUS_AREA_DESC                                05340042
1123RM         WITH UR                                                  05350042
044700     END-EXEC.                                                    05500002
044800                                                                  05510002
044900/                                                                 05520002
045000*---------------------------------------------------------------* 05530002
045100*    DB2 AREA FOR COMMUNICATIONS                                * 05540002
045200*---------------------------------------------------------------* 05550002
045300     EXEC SQL                                                     05560002
045400          INCLUDE SQLCA                                           05570002
045500     END-EXEC.                                                    05580002
045600                                                                  05590002
045700/                                                                 05600002
045800 LINKAGE SECTION.                                                 05610002
045900                                                                  05620002
046000 01  DFHCOMMAREA.                                                 05630002
046100     05  FILLER                         OCCURS  1 TO 4072 TIMES   05640002
046200                                        DEPENDING ON EIBCALEN.    05650002
046300         10  FILLER                     PIC X.                    05660002
046400                                                                  05670002
046500 EJECT                                                            05680002
046600 PROCEDURE DIVISION.                                              05690002
046700******************************************************************05700002
046800**  THIS MODULE IS THE HIGHEST PROCESSING LEVEL IN THE PROGRAM. **05710002
046900**  FIRST, CALL THE CICS ARCHITECTURE API, PERFORM THE PROGRAM  **05720002
047000**  PROCESSING AND THEN CALL THE CICS ARCHITECTURE API TO EXIT. **05730002
047100******************************************************************05740002
047200 0000-MAIN-MODULE.                                                05750002
047300     INITIALIZE DP030-CICS-API-FIELDS.                            05760002
047400     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       05770002
047500     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          05780002
047600     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         05790002
047700     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       05800002
047800     MOVE LENGTH OF SU571AI        TO DP030-MAP-LENGTH (1).       05810002
047900     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     05820002
048000     PERFORM 0001-CALL-CICS-ARCH-API.                             05830002
048100*                                                                 05840002
048200     PERFORM 1000-CONTROL-PROCESSING                              05850002
048300*                                                                 05860002
048400     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     05870002
048500     PERFORM 0001-CALL-CICS-ARCH-API.                             05880002
048600                                                                  05890002
048700******************************************************************05900002
048800**  THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE   **05910002
048900**  AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.         **05920002
049000******************************************************************05930002
049100 0001-CALL-CICS-ARCH-API.                                         05940002
049200*    CALL 'DPKCS030' USING DFHEIBLK                               05950041
049200     CALL DP930-CICS-ARCH-API USING DFHEIBLK                      05960041
049300                           DFHCOMMAREA                            05970002
049400                           DP030-CICS-API-FIELDS                  05980002
049500                           DP020-STANDARD-COMMAREA                05990002
049600                           SU571AI.                               06000002
049700*                                                                 06010002
049800     IF  DP030-RC-CALL-SUCCESSFUL                                 06020002
049900         CONTINUE                                                 06030002
050000     ELSE                                                         06040002
050100         SET DP013-NO-ROLLBACK                                    06050002
050200             DP013-XCTL-DISPLAY-RESTART                           06060002
050300             DP013-CICS-ABEND      TO TRUE                        06070002
050400         MOVE '0001-CALL-CICS-ARCH-API'                           06080002
050500                                   TO DP013-PARAGRAPH             06090002
050600*        MOVE 'CALL TO DPKCS030 NOT SUCCESSFUL, RETURN-CODE ON NEX06100041
050700*             'T LINE'             TO DP013-MESSAGE-TEXT (2)      06110041
050600         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL. RETURN-CODE O06120041
050700-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      06130041
050800         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      06140002
050900         PERFORM DP013-0000-PROCESS-ABEND                         06150002
051000     END-IF.                                                      06160002
051100*----------------------------------------------------------------*06170002
051200* PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT      *06180002
051300* COURSE OF ACTION IS FOR THIS TRANSACTION.                      *06190002
051400*                                                                *06200002
051500* NOTE:  PV-TOP-ITEM IS THE ITEM THAT IS REQUESTED TO BE AT THE  *06210002
051600*  TOP OF THE PANEL.  MOVING ASC-ITEM-AT-TOP-OF-PANEL TO THIS    *06220002
051700*  MEANS THAT POSITION WITHIN THE LIST WILL NOT CHANGE -- THIS   *06230002
051800*  IS THE DEFAULT WHICH WILL BE OVERRIDDEN BY SCROLLING ACTIONS. *06240002
051900*----------------------------------------------------------------*06250002
052000                                                                  06260002
052100 1000-CONTROL-PROCESSING.                                         06270002
052200                                                                  06280002
052300     EVALUATE TRUE                                                06290002
052400         WHEN DP020-NEXT-ACT-INITIAL                              06300002
052500             INITIALIZE ASC-SPECIFIC-COMMAREA                     06310002
052600             MOVE EIBTRMID         TO ASC-LIST-TERM-ID            06320002
052700                                      ASC-SEL-TERM-ID-OUT         06330002
052800             MOVE DP020-SRC-TASK-NUMBER                           06340002
052900                                   TO ASC-LIST-TASK-NUMBER        06350002
053000                                      ASC-SEL-TASK-NUMBER-OUT     06360002
053100             MOVE PC-LIST-QUEUE-SEQ                               06370002
053200                                   TO ASC-LIST-SEQ                06380002
053300             MOVE PC-SEL-QUEUE-SEQ TO ASC-SEL-SEQ-OUT             06390002
053400             SET PS-COMMAREA-VALID TO TRUE                        06400002
053500                                                                  06410002
053600             PERFORM 1100-PROCESS-INTER-APPL-COMM                 06420002
053700                                                                  06430002
053800             IF  PS-ERROR                                         06440002
053900                 CONTINUE                                         06450002
054000             ELSE                                                 06460002
054100                 PERFORM 4000-BUILD-INITIAL-PANEL                 06470002
054300             END-IF                                               06480002
054400                                                                  06490002
054500***-----$TEMPLATE NOTE$-------------------------------------------06500002
054600*** IF THE DATA EXPECTED IS NOT RECEIVED FROM CALLING APPLICATION,06510002
054700*** SETUP APPROPRIATE MESSAGE AND SEVERITY AND SET APPL-ERROR TO  06520002
054800*** TRUE, THIS WILL RETURN TO CALLING APPLICATION WHEN API CALLED.06530002
054900***---------------------------------------------------------------06540002
055000             IF  PS-COMMAREA-NOT-VALID                            06550002
055100***              MOVE PC-TSYMSG-99901                             06560002
055200***                                TO DP020-MSG-NUMBER            06570002
055300***              SET DP020-MSG-FATAL                              06580002
055400***                                TO TRUE                        06590002
055500                 SET DP020-NEXT-ACT-APPL-ERROR                    06600002
055600                                   TO TRUE                        06610002
055700***          ELSE                                                 06620006
055800***              PERFORM 4000-BUILD-INITIAL-PANEL                 06630006
055900             END-IF                                               06640002
056000                                                                  06650002
056100         WHEN DP020-NEXT-ACT-READ-MAP                             06660002
056200             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        06670028
056300                                   TO PV-TOP-ITEM                 06680028
056400             PERFORM 2000-PROCESS-PANEL                           06690028
056500                                                                  06700002
056600         WHEN DP020-NEXT-ACT-RETURN                               06710002
056700             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        06720002
056800                                   TO PV-TOP-ITEM                 06730002
056900             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    06740002
057000             PERFORM 6000-REFRESH-PANEL-FROM-TEMP                 06750002
057100             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 06760002
057200*            PERFORM 3000-EDIT-DATA-IN-COMMAREA                   06770002
057300                                                                  06780002
057400*            MOVE ASC-CURR-OPER-UNT-ID TO SU011-CURR-OPER-UNT-ID  06790002
057500*            PERFORM 2050-DELETE-LIST-QUEUE                       06800002
057600*            PERFORM 4000-BUILD-INITIAL-PANEL                     06810002
057700                                                                  06820002
057800                                                                  06830002
057900         WHEN OTHER                                               06840002
058000             SET DP013-LOGIC-ABEND TO TRUE                        06850002
058100             SET DP013-NO-ROLLBACK TO TRUE                        06860002
058200             MOVE '1000-CONTROL-PROCESSING'                       06870002
058300                                   TO DP013-PARAGRAPH             06880002
058400             MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    06890002
058500                                   TO DP013-MESSAGE-TEXT(1)       06900002
058600             PERFORM DP013-0000-PROCESS-ABEND                     06910002
058700     END-EVALUATE.                                                06920002
058800                                                                  06930002
058900 EJECT                                                            06940002
059000*----------------------------------------------------------------*06950002
059100* DETERMINE IF DATA WAS PASSED THROUGH INTER-APPL COMMAREA OR    *06960002
059200* IF THERE IS DATA TO BE USED IN THE NAV-KEY FIELD.              *06970002
059300*----------------------------------------------------------------*06980002
059400                                                                  06990002
059500 1100-PROCESS-INTER-APPL-COMM.                                    07000002
059600                                                                  07010002
059700     SET PS-COMMAREA-VALID         TO TRUE.                       07020002
059800     MOVE SPACE                    TO ASC-START-ITEM-REQUEST.     07030002
059900     MOVE DP020-INT-APPL-FORMAT-IND TO ASC-INT-APPL-FORMAT-IND    07040002
060000     EVALUATE DP020-INT-APPL-FORMAT-IND                           07050002
060100                                                                  07060002
060200         WHEN PC-INTER-APPL-LIST                                  07070002
060300             SET ASC-USE-SELECTION-QUEUE TO TRUE                  07080002
060400             MOVE SU012-NUMBER-OF-SELECTED-ITEMS                  07090002
060500                                   TO ASC-NUMBER-OF-SELECTED-ITEMS07100002
060600             MOVE SU012-NUMBER-OF-TS-ITEMS                        07110002
060700                                    TO ASC-NUMBER-OF-TS-ITEMS     07120002
060800             MOVE SU012-SEL-QUEUE-NAME                            07130002
060900                                    TO ASC-SEL-QUEUE-NAME-IN      07140002
061000             MOVE SU012-STR-NBR   TO ASC-STR-NBR                  07150002
061100             MOVE SU012-STR-NAME  TO ASC-STR-NAME                 07160002
061110             INITIALIZE SU012-SCREEN-SEQUENCE                     07170032
061120             SET SU012-DEPT-SEQ    TO TRUE                        07180032
061200             PERFORM 1101-SCREEN-SEQUENCE                         07190002
061300                                                                  07200002
061400             PERFORM 1120-PREPARE-LIST-ENTRY                      07210002
061500                                                                  07220002
061600         WHEN OTHER                                               07230002
061700             MOVE PC-TSYMSG-00148                                 07240002
061800                                     TO DP020-MSG-NUMBER          07250002
061900             SET DP020-MSG-FATAL                                  07260002
062000                 DP020-NEXT-ACT-APPL-ERROR                        07270002
062100                                     TO TRUE                      07280002
062200     END-EVALUATE.                                                07290002
062300 1101-SCREEN-SEQUENCE.                                            07300002
062400     EVALUATE TRUE                                                07310002
062500         WHEN SU012-DEPT-SEQ                                      07320002
062600             MOVE 'AREA SEQUENCE'       TO ASC-SEQ-DESC           07330002
062700                                                                  07340002
062800         WHEN SU012-UNIT-SEQ                                      07350002
062900             MOVE 'UNIT SEQUENCE'       TO ASC-SEQ-DESC           07360002
063000     END-EVALUATE.                                                07370002
063100     MOVE SU012-SCREEN-SEQUENCE    TO ASC-SCREEN-SEQUENCE.        07380002
063200/                                                                 07390002
063300 1120-PREPARE-LIST-ENTRY.                                         07400002
063400     MOVE SU013-MAX-ITEMS          TO ASC-SEL-SUB.                07410002
063500     MOVE ZERO                     TO ASC-SEL-ITEM.               07420002
063600     PERFORM 2110-GET-NEXT-MESSAGE.                               07430002
063700/                                                                 07440002
063800 2110-GET-NEXT-MESSAGE.                                           07450002
063900     ADD +1                        TO ASC-SEL-SUB.                07460002
064000     IF  ASC-SEL-SUB > SU013-MAX-ITEMS                            07470002
064100         ADD +1                    TO ASC-SEL-ITEM                07480002
064200         MOVE +1                   TO ASC-SEL-SUB                 07490002
064300     END-IF.                                                      07500002
064400     IF  ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                07510002
064500         PERFORM 9100-READ-SEL-QUEUE                              07520002
064600         IF  SU013-ITEM (ASC-SEL-SUB) > ZERO                      07530002
064700             MOVE SU013-TRIP-OCRNC-ID (ASC-SEL-SUB)               07540002
064800                                   TO ASC-TRIP-OCRNC-ID           07550002
064900             MOVE SU013-TRLR-SRL-NBR (ASC-SEL-SUB)                07560002
065000                                   TO ASC-TRLR-SRL-NBR            07570002
065100             MOVE SU013-SCAC (ASC-SEL-SUB)                        07580002
065200                                   TO ASC-SCAC                    07590002
065300             MOVE SU013-TRLR-ID (ASC-SEL-SUB)                     07600002
065400                                   TO ASC-TRLR-ID                 07610002
065500                                                                  07620002
065600             MOVE SU013-TRIP-ID (ASC-SEL-SUB)                     07630002
065700                                   TO DK-OTBND-TRIP-ID            07640002
065800                                                                  07650002
065900             MOVE SU013-TRIP-OCRNC-ID (ASC-SEL-SUB)               07660002
066000                                   TO DK-TRIP-OCRNC-ID            07670002
066100                                      ASC-TRIP-OCRNC-ID           07680002
066200                                                                  07690002
066300             MOVE SU013-TRIP-STAT-DESC (ASC-SEL-SUB)              07700002
066400                                   TO ASC-TRIP-STAT-DESC          07710002
066500             MOVE SU013-CARTON-CNT (ASC-SEL-SUB)                  07720002
066600                                   TO ASC-TOTAL-CARTONS           07730002
066700             MOVE SU013-UNIT-COUNT (ASC-SEL-SUB)                  07740002
066800                                   TO ASC-TOTAL-UNITS             07750002
066900                                                                  07760002
067000             PERFORM 7000-SELECT-SERVICING-DC                     07770002
067100             MOVE ASC-SERVICE-DC-NAME TO AOPERO                   07780002
067200                                                                  07790002
067300             PERFORM 7001-CONVERT-DATES                           07800002
067400             MOVE ASC-SUMMARY-DATE TO ASUMDTEO                    07810002
067500             MOVE ASC-SUMMARY-TIME TO ASUMTMEO                    07820002
067600                                                                  07830002
067700             SET SU013-INQ (ASC-SEL-SUB)                          07840002
067800                                   TO TRUE                        07850002
067900             PERFORM 9200-REWRITE-LIST-QUEUE                      07860002
068000         ELSE                                                     07870002
068100             SUBTRACT +1 FROM ASC-SEL-SUB                         07880002
068200*            --- BOTTOM OF LIST ---                               07890002
068300             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            07900002
068400             SET DP020-MSG-INFORMATIONAL                          07910002
068500                 PS-LIST-END       TO TRUE                        07920002
068600         END-IF                                                   07930002
068700     ELSE                                                         07940002
068800         SUBTRACT +1 FROM ASC-SEL-ITEM                            07950002
068900         MOVE SU013-MAX-ITEMS      TO ASC-SEL-SUB                 07960002
069000         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            07970002
069100         SET DP020-MSG-INFORMATIONAL                              07980002
069200             PS-LIST-END           TO TRUE                        07990002
069300     END-IF.                                                      08000002
101600                                                                  08010000
101700 2120-GET-PREV-MESSAGE.                                           08020000
101800     SUBTRACT +1                   FROM ASC-SEL-SUB.              08030000
101900     IF  ASC-SEL-SUB < 1                                          08040000
102000         SUBTRACT 1                FROM ASC-SEL-ITEM              08050000
102100         MOVE SU013-MAX-ITEMS      TO ASC-SEL-SUB                 08060000
102200     END-IF.                                                      08070000
102300     IF  ASC-SEL-ITEM  > ZERO                                     08080000
102400         PERFORM 9100-READ-SEL-QUEUE                              08090000
102500         IF  SU013-ITEM (ASC-SEL-SUB) > ZERO                      08100000
102600             MOVE SU013-TRIP-OCRNC-ID (ASC-SEL-SUB)               08110002
102700                                   TO ASC-TRIP-OCRNC-ID           08120002
102800             MOVE SU013-TRLR-SRL-NBR (ASC-SEL-SUB)                08130002
102900                                   TO ASC-TRLR-SRL-NBR            08140002
103000             MOVE SU013-SCAC (ASC-SEL-SUB)                        08150002
103100                                   TO ASC-SCAC                    08160002
103200             MOVE SU013-TRLR-ID (ASC-SEL-SUB)                     08170002
103300                                   TO ASC-TRLR-ID                 08180002
103400                                                                  08190002
103500             MOVE SU013-TRIP-ID (ASC-SEL-SUB)                     08200002
103600                                   TO DK-OTBND-TRIP-ID            08210002
103700                                                                  08220002
103800             MOVE SU013-TRIP-OCRNC-ID (ASC-SEL-SUB)               08230002
103900                                   TO DK-TRIP-OCRNC-ID            08240002
104000                                      ASC-TRIP-OCRNC-ID           08250002
104100                                                                  08260002
104200             MOVE SU013-TRIP-STAT-DESC (ASC-SEL-SUB)              08270002
104300                                   TO ASC-TRIP-STAT-DESC          08280002
104400             MOVE SU013-CARTON-CNT (ASC-SEL-SUB)                  08290002
104500                                   TO ASC-TOTAL-CARTONS           08300002
104600             MOVE SU013-UNIT-COUNT (ASC-SEL-SUB)                  08310002
104700                                   TO ASC-TOTAL-UNITS             08320002
104800                                                                  08330002
104900             PERFORM 7000-SELECT-SERVICING-DC                     08340002
105000             MOVE ASC-SERVICE-DC-NAME TO AOPERO                   08350002
105100                                                                  08360002
105200             PERFORM 7001-CONVERT-DATES                           08370002
105300             MOVE ASC-SUMMARY-DATE TO ASUMDTEO                    08380002
105400             MOVE ASC-SUMMARY-TIME TO ASUMTMEO                    08390002
105500                                                                  08400002
105600             SET SU013-INQ (ASC-SEL-SUB)                          08410002
105700                                   TO TRUE                        08420002
105800             PERFORM 9200-REWRITE-LIST-QUEUE                      08430002
106300         ELSE                                                     08440000
106400             MOVE +1               TO ASC-SEL-ITEM                08450000
106500                                      ASC-SEL-SUB                 08460000
106600*            --- TOP OF LIST ---                                  08470000
106700             MOVE PC-TSYMSG-00069  TO DP020-MSG-NUMBER            08480000
106800             SET DP020-MSG-INFORMATIONAL                          08490000
106900                 PS-LIST-END       TO TRUE                        08500002
107000         END-IF                                                   08510000
107001     ELSE                                                         08520002
107002             MOVE +1               TO ASC-SEL-ITEM                08530000
107003                                      ASC-SEL-SUB                 08540000
107004*            --- TOP OF LIST ---                                  08550000
107005             MOVE PC-TSYMSG-00069  TO DP020-MSG-NUMBER            08560000
107006             SET DP020-MSG-INFORMATIONAL                          08570000
107007                 PS-LIST-END       TO TRUE                        08580002
107008     END-IF.                                                      08590000
107009*----------------------------------------------------------------*08600002
107010* DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *08610002
107020* ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *08620002
107030* USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *08630002
107040* OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *08640002
107050* FUNCTION KEYS CAN GET THIS FAR.                                *08650002
107060*----------------------------------------------------------------*08660002
107070                                                                  08670002
107080 2000-PROCESS-PANEL.                                              08680002
107090     SET PS-NEXT-SCREEN TO TRUE.                                  08690002
107100     EVALUATE TRUE                                                08700002
107200         WHEN DP020-SRC-AID = DP016-CLEAR                         08710002
107300             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    08720002
107400             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   08730002
107500             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 08740002
107600                                                                  08750002
107700         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    08760002
107710             MOVE SPACES TO ASC-PRINTER-DEST                      08770033
107800             PERFORM 2050-DELETE-LIST-QUEUE                       08780002
107900             PERFORM 4000-BUILD-INITIAL-PANEL                     08790002
108000                                                                  08800002
108100         WHEN DP020-FK-DESELECT(DP020-SRC-AID)                    08810002
108200             PERFORM 2140-DESELECT-ALL-ITEMS                      08820002
108300             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 08830002
108400                                                                  08840002
108500         WHEN DP020-FK-SELECT-ALL(DP020-SRC-AID)                  08850002
108600             PERFORM 2150-SELECT-ALL-ITEMS                        08860002
108700             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 08870002
108800                                                                  08880002
108900         WHEN OTHER                                               08890002
109000             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 08900002
109100             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   08910002
109200             IF  PS-NO-ERROR                                      08920002
109300                 SET DP030-CONTINUE-GO                            08930002
109400                                 TO TRUE                          08940002
109500                 PERFORM 2100-CHECK-FUNCTION-KEY                  08950002
109600             ELSE                                                 08960002
109700                 SET DP030-OVERRIDE-GO                            08970002
109800                                 TO TRUE                          08980002
109900             END-IF                                               08990002
110000     END-EVALUATE.                                                09000002
110100 EJECT                                                            09010002
110200*----------------------------------------------------------------*09020002
110300*  DELETE THE LIST ITEMS TEMP STORAGE QUEUE.                     *09030002
110400*----------------------------------------------------------------*09040002
110500 2050-DELETE-LIST-QUEUE.                                          09050002
110600                                                                  09060002
110700     EXEC CICS                                                    09070002
110800         DELETEQ TS                                               09080002
110900             QUEUE (ASC-LIST-QUEUE-NAME)                          09090002
111000             RESP  (PV-CICS-RESP)                                 09100002
111100     END-EXEC.                                                    09110002
111200                                                                  09120002
111300     IF (PV-CICS-RESP = DFHRESP(NORMAL)) OR                       09130002
111400        (PV-CICS-RESP = DFHRESP(QIDERR))                          09140002
111500         CONTINUE                                                 09150002
111600     ELSE                                                         09160002
111700         SET DP013-CICS-ABEND      TO TRUE                        09170002
111800         SET DP013-NO-ROLLBACK     TO TRUE                        09180002
111900                                                                  09190002
112000         MOVE '2050-DELETE-LIST-QUEUE'                            09200002
112100                                   TO DP013-PARAGRAPH             09210002
112200         MOVE 'ERROR TRYING TO DELETE LIST TEMP STORAGE QUEUE'    09220002
112300                                   TO DP013-MESSAGE-TEXT (1)      09230002
112400         PERFORM DP013-0000-PROCESS-ABEND                         09240002
112500     END-IF.                                                      09250002
112600                                                                  09260002
112700     MOVE +0                       TO ASC-HIGHEST-BLOCK-WRITTEN.  09270002
112800/                                                                 09280002
112900*----------------------------------------------------------------*09290002
113000* ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED FIRST.*09300002
113100* NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED FROM THE  *09310002
113200* CICS ARCHITECTURE API.                                         *09320002
113300*----------------------------------------------------------------*09330002
113400 2100-CHECK-FUNCTION-KEY.                                         09340002
113500     SET PS-NEXT-SCREEN TO TRUE.                                  09350002
113600     EVALUATE TRUE                                                09360002
113700         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              09370002
113800             PERFORM 2050-DELETE-LIST-QUEUE                       09380002
113900             SET ASC-UNIT-SEQ                                     09390002
114000                 SU012-UNIT-SEQ TO TRUE                           09400002
114100             PERFORM 1101-SCREEN-SEQUENCE                         09410002
114200             PERFORM 4000-BUILD-INITIAL-PANEL                     09420002
114300                                                                  09430002
114400         WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)              09440002
114500             PERFORM 2050-DELETE-LIST-QUEUE                       09450002
114600             SET ASC-DEPT-SEQ                                     09460002
114700                 SU012-DEPT-SEQ TO TRUE                           09470002
114800             PERFORM 1101-SCREEN-SEQUENCE                         09480002
114900             PERFORM 4000-BUILD-INITIAL-PANEL                     09490002
115000                                                                  09500002
115010         WHEN DP020-FK-LOCAL-FUNC-05 (DP020-SRC-AID)              09510025
115011             IF  ASC-NUMBER-OF-ITEMS-READ > ZERO                  09520038
115020                 PERFORM 2400-CHECK-PRINTER-ID                    09530037
115021                 IF PS-NO-ERROR                                   09540037
115022                    PERFORM 2300-PREPARE-INTER-APPL-COMM          09550037
115030                    PERFORM 7100-START-TRANID-S546                09560037
115040                    MOVE PC-TSYMSG-00098 TO DP020-MSG-NUMBER      09570037
115050                    SET DP020-MSG-INFORMATIONAL TO TRUE           09580037
115051                 END-IF                                           09590037
115052             ELSE                                                 09600038
115053                 SET DP030-OVERRIDE-GO TO TRUE                    09610038
115054                 MOVE PC-TSYMSG-00134  TO DP020-MSG-NUMBER        09620038
115055                 SET DP020-MSG-WARNING TO TRUE                    09630038
115056                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             09640038
115060             END-IF                                               09650037
115070                                                                  09660037
115100         WHEN DP020-FK-LOCAL-GOTO(DP020-SRC-AID)                  09670002
115200         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              09680002
115210         WHEN DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)              09690019
115300             IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              09700002
115400                 INITIALIZE SU012-INTER-APPL-COMMAREA             09710002
115500                 MOVE ASC-NUMBER-OF-SELECTED-ITEMS                09720002
115600                                TO SU012-NUMBER-OF-SELECTED-ITEMS 09730002
115700                 MOVE ASC-STR-NBR  TO SU012-STR-NBR               09740002
115800                 MOVE ASC-STR-NAME TO SU012-STR-NAME              09750002
115900                 MOVE ASC-SERVICE-DC-NAME TO SU012-SERVICING-DC   09760002
116000                 PERFORM 5000-PREPARE-SEL-QUEUE                   09770002
116100             ELSE                                                 09780002
116200                 SET DP030-OVERRIDE-GO                            09790002
116300                                   TO TRUE                        09800002
116400                 MOVE PC-TSYMSG-00057                             09810002
116500                                   TO DP020-MSG-NUMBER            09820002
116600                 SET DP020-MSG-WARNING                            09830002
116700                                   TO TRUE                        09840002
116710                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             09850011
116800             END-IF                                               09860002
116900                                                                  09870002
117000         WHEN DP020-FK-PREV-SELECTION(DP020-SRC-AID)              09880002
117001                                                                  09890002
117002             IF ASC-USE-SELECTION-QUEUE                           09900000
117003                 PERFORM 2120-GET-PREV-MESSAGE                    09910000
117004                 IF PS-LIST-END                                   09920000
117005                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         09930000
117006                     SET PS-NO-LIST-END TO TRUE                   09940000
117007                 ELSE                                             09950000
117008                     PERFORM 2050-DELETE-LIST-QUEUE               09960000
117009                     PERFORM 3200-RESET-ATTRIBUTES                09970000
117010                     PERFORM 4000-BUILD-INITIAL-PANEL             09980000
117011                 END-IF                                           09990000
117012             ELSE                                                 10000000
117013*                    --- TOP OF LIST ---                          10010000
117014                 MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER    10020000
117015                 SET DP020-MSG-INFORMATIONAL                      10030000
136000                     DP030-SET-CURSOR-APPL-1                      10040000
136100                     PS-LIST-END   TO TRUE                        10050000
203600                 MOVE -1       TO MR-SELECTL (1)                  10060000
203601             END-IF                                               10070002
203602                                                                  10080000
203603         WHEN DP020-FK-NEXT-SELECTION(DP020-SRC-AID)              10090002
203604*            PERFORM 2120-BROWSE-FORWARD                          10100035
203605*            PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 10110035
203606                                                                  10120002
203607             IF ASC-USE-SELECTION-QUEUE                           10130000
203608                 PERFORM 2110-GET-NEXT-MESSAGE                    10140000
203609                 IF PS-LIST-END                                   10150000
203610                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         10160000
203611                     SET PS-NO-LIST-END TO TRUE                   10170000
203612                 ELSE                                             10180000
203613                     PERFORM 2050-DELETE-LIST-QUEUE               10190000
203614                     PERFORM 3200-RESET-ATTRIBUTES                10200000
203615                     PERFORM 4000-BUILD-INITIAL-PANEL             10210000
203616                 END-IF                                           10220000
203617               ELSE                                               10230000
203618*            --- BOTTOM OF LIST ---                               10240000
203619                 MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER         10250000
203620                 SET DP020-MSG-INFORMATIONAL                      10260000
203621                     PS-LIST-END      TO TRUE                     10270000
203622             END-IF                                               10280000
203623                                                                  10290000
203624         WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                  10300002
203625             MOVE +1               TO PV-TOP-ITEM                 10310002
203626             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 10320002
203627                                                                  10330002
203628         WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                   10340002
203629             PERFORM 2110-BROWSE-BACKWARD                         10350002
203630             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 10360002
203640                                                                  10370002
203650         WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                   10380002
203660             PERFORM 2120-BROWSE-FORWARD                          10390002
203670             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 10400002
203680                                                                  10410002
203690         WHEN DP020-SRC-AID = DP016-ENTER                         10420002
203700             PERFORM 2130-CHECK-FOR-JUMP-BROWSE                   10430002
203800             IF  PS-ERROR                                         10440002
203900                 CONTINUE                                         10450002
204000             ELSE                                                 10460002
204100                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             10470002
204200             END-IF                                               10480002
204300                                                                  10490002
204400         WHEN OTHER                                               10500002
204500             SET DP013-NO-ROLLBACK                                10510002
204600                 DP013-XCTL-DISPLAY-RESTART                       10520002
204700                 DP013-CICS-ABEND  TO TRUE                        10530002
204800             MOVE '2100-CHECK-FUNCTION-KEY'                       10540002
204900                                   TO DP013-PARAGRAPH             10550002
205000             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      10560002
205100                                   TO DP013-MESSAGE-TEXT (1)      10570002
205200             PERFORM DP013-0000-PROCESS-ABEND                     10580002
205300     END-EVALUATE.                                                10590002
205400*                                                                 10600002
205500*----------------------------------------------------------------*10610002
205600*    IF THE USER HITS THE PAGE BACKWARD KEY, COMPUTE THE TOP     *10620002
205700*    ITEM NUMBER FOR THE NEW PAGE.  IF IT IS ABOVE THE TOP,      *10630002
205800*    SET THE TOP ITEM NUMBER TO +1 AND DISPLAY THE TOP OF LIST   *10640002
205900*    MESSAGE.                                                    *10650002
206000*----------------------------------------------------------------*10660002
206100                                                                  10670002
206200 2110-BROWSE-BACKWARD.                                            10680002
206300     SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    10690002
206400         GIVING PV-TOP-ITEM.                                      10700002
206500*                                                                 10710002
206600     IF  ((PV-TOP-ITEM < +1)                                      10720002
206700       OR (PV-TOP-ITEM = +1))                                     10730002
206800         MOVE +1                   TO PV-TOP-ITEM                 10740002
206900*        -- TOP OF LIST --                                        10750002
207000         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            10760002
207001         SET DP020-MSG-INFORMATIONAL                              10770002
207002             PS-LIST-END           TO TRUE                        10780000
207003     END-IF.                                                      10790002
207004                                                                  10800002
207005 EJECT                                                            10810002
207006*----------------------------------------------------------------*10820002
207007*    IF THE USER HITS THE PAGE FORWARD KEY, COMPUTE THE TOP      *10830002
207008*    ITEM NUMBER FOR THE NEW PAGE.  IF THE USER ATTEMPTS TO GO   *10840002
207009*    PAST THE END, ISSUE THE BOTTOM OF LIST MESSAGE.             *10850002
207010*----------------------------------------------------------------*10860002
207020                                                                  10870002
207030 2120-BROWSE-FORWARD.                                             10880002
207040                                                                  10890002
207050     ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              10900002
207060         GIVING PV-TOP-ITEM.                                      10910002
207070     IF  PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                   10920002
207080         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            10930002
207090                                   TO PV-TOP-ITEM                 10940002
207100*        -- BOTTOM OF LIST --                                     10950002
207200         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            10960002
207300         SET DP020-MSG-INFORMATIONAL                              10970002
207400             PS-LIST-END           TO TRUE                        10980002
207500     ELSE                                                         10990002
207600         COMPUTE PV-BOTTOM-ITEM =                                 11000002
207700             PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 11010002
207800         IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ            11020002
207900*            -- BOTTOM OF LIST --                                 11030002
208000             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            11040002
208100             SET DP020-MSG-INFORMATIONAL                          11050002
208200                 PS-LIST-END           TO TRUE                    11060002
208300         END-IF                                                   11070002
208400     END-IF.                                                      11080002
208500 EJECT                                                            11090002
208600*----------------------------------------------------------------*11100002
208700*    THE USER CAN CHANGE THE CURRENT BEGINNING LIST NUMBER SO    *11110002
208800*    THAT THE TRANSACTION WILL JUMP TO THAT POINT IN THE LIST.   *11120002
208900*    THIS IS A FASTER WAY TO GET TO A CERTAIN POINT IN THE LIST  *11130002
209000*    RATHER THAN HITTING NEXT-PAGE TO GET TO THAT POINT.         *11140002
209100*    THE NEW LIST NUMBER ENTERED IS EDITED TO MAKE SURE THAT     *11150002
209200*    IT IS NUMERIC AND FALLS BETWEEN A SPECIFIED RANGE.          *11160002
209300*----------------------------------------------------------------*11170002
209400                                                                  11180002
209500 2130-CHECK-FOR-JUMP-BROWSE.                                      11190002
209600     SET PS-NO-ERROR               TO TRUE.                       11200002
209700     IF (ASC-START-ITEM-REQUEST = SPACE)                          11210002
209800         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            11220002
209900                                   TO PV-TOP-ITEM                 11230002
210000     ELSE                                                         11240002
210100         MOVE ASC-START-ITEM-REQUEST                              11250002
210200                                   TO DP010I-UNEDITED-FIELD       11260002
210300         MOVE PC-MSG-NUMBER-LENGTH TO DP010I-MAXIMUM-DIGITS       11270002
210400         MOVE +0                   TO DP010I-MAXIMUM-DECIMALS     11280002
210500         SET DP010I-NEGATIVE-NOT-ALLOWED                          11290002
210600                                   TO TRUE                        11300002
263968         CALL DP010I-NUMERIC-EDIT-ROUTINE                         11310040
263968              USING DP010I-NUMERIC-EDIT-AREA                      11320040
210800                                                                  11330002
210900         IF  NOT DP010I-ERROR-DETECTED                            11340002
211000             MOVE DP010I-NUMERIC-FIELD                            11350002
211100                                   TO  ASC-START-ITEM-REQUEST-N   11360002
211200             IF  ASC-START-ITEM-REQUEST-N > ZERO                  11370002
211300                 IF  ASC-START-ITEM-REQUEST-N >                   11380002
211400                                          ASC-NUMBER-OF-ITEMS-READ11390002
211500                     MOVE SPACE TO ASC-START-ITEM-REQUEST         11400002
211600                     COMPUTE PV-TOP-ITEM =                        11410002
211700                             ASC-NUMBER-OF-ITEMS-READ             11420002
211800                             - PC-ITEMS-PER-PANEL + 1             11430002
211900                     IF  PV-TOP-ITEM < +1                         11440002
212000                         MOVE +1   TO PV-TOP-ITEM                 11450002
212100                         MOVE PC-TSYMSG-00070                     11460002
212200                                   TO DP020-MSG-NUMBER            11470002
212300                         SET DP020-MSG-INFORMATIONAL              11480002
212400                             PS-LIST-END                          11490002
212500                                   TO TRUE                        11500002
212600                     END-IF                                       11510002
212700                 ELSE                                             11520002
212800                     MOVE ASC-START-ITEM-REQUEST-N                11530002
212900                                   TO PV-TOP-ITEM                 11540002
213000                     MOVE SPACE    TO ASC-START-ITEM-REQUEST      11550002
213100                     COMPUTE PV-BOTTOM-ITEM =                     11560002
213200                         PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1     11570002
213300                     IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ11580002
213400*                        -- BOTTOM OF LIST --                     11590002
213500                         MOVE PC-TSYMSG-00070                     11600002
213600                                   TO DP020-MSG-NUMBER            11610002
213700                         SET DP020-MSG-INFORMATIONAL              11620002
213800                             PS-LIST-END                          11630002
213900                                   TO TRUE                        11640002
214000                     END-IF                                       11650002
214100                 END-IF                                           11660002
214200             ELSE                                                 11670002
214300*                --- VALUE OUT OF RANGE ----                      11680002
214400                 MOVE PC-TSYMSG-00101                             11690002
214500                                   TO DP020-MSG-NUMBER            11700002
214600                 MOVE -1           TO ASTRTITL                    11710002
214700                 SET DP030-SET-CURSOR-APPL-1                      11720002
214800                                   TO TRUE                        11730002
214900                 MOVE DP015-REVERSE                               11740002
215000                                   TO ASTRTITH                    11750002
215100                 MOVE DP015-RED    TO ASTRTITC                    11760002
215200                 MOVE DP015-UNP-NUM-BRT-MDT                       11770002
215300                                   TO ASTRTITA                    11780002
215400                 SET DP020-MSG-FATAL                              11790002
215500                                   TO TRUE                        11800002
215600                 SET PS-ERROR      TO TRUE                        11810002
215700             END-IF                                               11820002
215800                                                                  11830002
215900         ELSE                                                     11840002
216000             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            11850002
216100             MOVE -1               TO ASTRTITL                    11860002
216200             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  11870002
216300             MOVE DP015-REVERSE    TO ASTRTITH                    11880002
216400             MOVE DP015-RED        TO ASTRTITC                    11890002
216500             MOVE DP015-UNP-NUM-BRT-MDT                           11900002
216600                                   TO ASTRTITA                    11910002
216700             SET DP020-MSG-FATAL   TO TRUE                        11920002
216800             SET PS-ERROR          TO TRUE                        11930002
216900         END-IF                                                   11940002
217000     END-IF.                                                      11950002
217100 EJECT                                                            11960002
217200*----------------------------------------------------------------*11970002
217300*    IF THE USER HITS THE DESELECT KEY, CLEAR THE SELECTION      *11980002
217400*    SWITCH FOR ALL ITEMS THAT WERE PREVIOUSLY SELECTED.         *11990002
217500*----------------------------------------------------------------*12000002
217600 2140-DESELECT-ALL-ITEMS.                                         12010002
217700     MOVE +1                       TO ASC-BLK-SUB.                12020002
217800                                                                  12030002
217900     PERFORM 2141-CLEAR-SELECTED-INDS                             12040002
218000         VARYING ASC-ITEM-SUB                                     12050002
218100         FROM 1 BY 1                                              12060002
218200         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 12070002
218300                                                                  12080002
218400     ADD +1                        TO ASC-BLK-SUB.                12090002
218500                                                                  12100002
218600     PERFORM 2141-CLEAR-SELECTED-INDS                             12110002
218700         VARYING ASC-ITEM-SUB                                     12120002
218800         FROM 1 BY 1                                              12130002
218900         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 12140002
219000                                                                  12150002
219100     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               12160002
219200                                   TO PV-LIST-ITEM-NUMBER.        12170002
219300                                                                  12180002
219400     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            12190002
219500         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    12200002
219600                                                                  12210002
219700     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     12220002
219800        (ASC-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)      12230002
219900         MOVE +1                   TO ASC-BLK-SUB                 12240002
220000                                                                  12250002
220100         PERFORM 5100-WRITE-TEMP-STORAGE                          12260002
220200                                                                  12270002
220300         MOVE +1                   TO PV-BLOCK-NUMBER             12280002
220400                                                                  12290002
220500         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         12300002
220600             PV-FIRST-BLOCK-IN-ARRAY - 1                          12310002
220700                                                                  12320002
220800         PERFORM                                                  12330002
220900             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       12340002
221000                                                                  12350002
221100             PERFORM 4410-READ-TEMP-STORAGE                       12360002
221200                                                                  12370002
221300             PERFORM 2141-CLEAR-SELECTED-INDS                     12380002
221400                 VARYING ASC-ITEM-SUB FROM 1 BY 1                 12390002
221500                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          12400002
221600                                                                  12410002
221700             PERFORM 5100-WRITE-TEMP-STORAGE                      12420002
221800                                                                  12430002
221900             ADD +1                TO PV-BLOCK-NUMBER             12440002
222000                                                                  12450002
222100         END-PERFORM                                              12460002
222200                                                                  12470002
222300         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         12480002
222400             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     12490002
222500                                                                  12500002
222600         PERFORM                                                  12510002
222700             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       12520002
222800                   ASC-HIGHEST-BLOCK-WRITTEN                      12530002
222900                                                                  12540002
223000             MOVE PV-NEXT-BLOCK-IN-ARRAY                          12550002
223100                                   TO PV-BLOCK-NUMBER             12560002
223200                                                                  12570002
223300             PERFORM 4410-READ-TEMP-STORAGE                       12580002
223400                                                                  12590002
223500             PERFORM 2141-CLEAR-SELECTED-INDS                     12600002
223600                 VARYING ASC-ITEM-SUB                             12610002
223700                 FROM 1 BY 1                                      12620002
223800                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          12630002
223900                                                                  12640002
224000             PERFORM 5100-WRITE-TEMP-STORAGE                      12650002
224100                                                                  12660002
224200             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      12670002
224300                                                                  12680002
224400         END-PERFORM                                              12690002
224500                                                                  12700002
224600         MOVE PV-FIRST-BLOCK-IN-ARRAY                             12710002
224700                                   TO PV-BLOCK-NUMBER             12720002
224800                                                                  12730002
224900         PERFORM 4410-READ-TEMP-STORAGE                           12740002
225000     END-IF.                                                      12750002
225100                                                                  12760002
225200                                                                  12770002
225300     MOVE +0                     TO ASC-NUMBER-OF-SELECTED-ITEMS. 12780002
225400     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE.12790002
225500     MOVE +0                       TO ASC-END-OF-SELECTED-RANGE.  12800002
225600                                                                  12810002
225700     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        12820002
225800                                                                  12830002
225900 EJECT                                                            12840002
226000*----------------------------------------------------------------*12850002
226100*    MARK EACH ITEM AS BEING NOT SELECTED.                       *12860002
226200*----------------------------------------------------------------*12870002
226300                                                                  12880002
226400 2141-CLEAR-SELECTED-INDS.                                        12890002
226500                                                                  12900002
226600     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           12910002
226700             NOT EQUAL ZERO                                       12920002
226800         IF  NOT ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          12930002
226900             SET ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          12940002
227000                 ASC-TEMP-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)    12950002
227100                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  12960002
227200                                   TO TRUE                        12970002
227300         END-IF                                                   12980002
227400     END-IF.                                                      12990002
227500                                                                  13000002
227600/                                                                 13010002
227700*----------------------------------------------------------------*13020002
227800*  IF THE USER HITS THE SELECT-ALL KEY, SET THE SELECTIO SWITCH  *13030002
227900*  FOR ALL ITEMS.                                                *13040002
228000*----------------------------------------------------------------*13050002
228100                                                                  13060002
228200 2150-SELECT-ALL-ITEMS.                                           13070002
228300                                                                  13080002
228400     MOVE +1                       TO ASC-BLK-SUB.                13090002
228500                                                                  13100002
228600     PERFORM 2151-SET-SELECTED-INDS                               13110002
228700         VARYING ASC-ITEM-SUB                                     13120002
228800         FROM 1 BY 1                                              13130002
228900         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 13140002
229000                                                                  13150002
229100     ADD +1                        TO ASC-BLK-SUB.                13160002
229200                                                                  13170002
229300     PERFORM 2151-SET-SELECTED-INDS                               13180002
229400         VARYING ASC-ITEM-SUB                                     13190002
229500         FROM 1 BY 1                                              13200002
229600         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 13210002
229700                                                                  13220002
229800     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               13230002
229900                                   TO PV-LIST-ITEM-NUMBER.        13240002
230000                                                                  13250002
230100     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            13260002
230200         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    13270002
230300                                                                  13280002
230400     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     13290002
230500        (ASC-HIGHEST-BLOCK-WRITTEN >   PC-MAX-BLOCKS-IN-ARRAY)    13300002
230600         MOVE +1                   TO ASC-BLK-SUB                 13310002
230700                                                                  13320002
230800         PERFORM 5100-WRITE-TEMP-STORAGE                          13330002
230900                                                                  13340002
231000         MOVE +1                   TO PV-BLOCK-NUMBER             13350002
231100                                                                  13360002
231200         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         13370002
231300             PV-FIRST-BLOCK-IN-ARRAY - 1                          13380002
231400                                                                  13390002
231500         PERFORM                                                  13400002
231600             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       13410002
231700                                                                  13420002
231800             PERFORM 4410-READ-TEMP-STORAGE                       13430002
231900                                                                  13440002
232000             PERFORM 2151-SET-SELECTED-INDS                       13450002
232100                 VARYING ASC-ITEM-SUB                             13460002
232200                 FROM 1 BY 1                                      13470002
232300                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          13480002
232400                                                                  13490002
232500             PERFORM 5100-WRITE-TEMP-STORAGE                      13500002
232600                                                                  13510002
232700             ADD +1                TO PV-BLOCK-NUMBER             13520002
232800                                                                  13530002
232900         END-PERFORM                                              13540002
233000                                                                  13550002
233100         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         13560002
233200             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     13570002
233300                                                                  13580002
233400         PERFORM                                                  13590002
233500             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       13600002
233600                   ASC-HIGHEST-BLOCK-WRITTEN                      13610002
233700                                                                  13620002
233800             MOVE PV-NEXT-BLOCK-IN-ARRAY                          13630002
233900                                   TO PV-BLOCK-NUMBER             13640002
234000                                                                  13650002
234100             PERFORM 4410-READ-TEMP-STORAGE                       13660002
234200                                                                  13670002
234300             PERFORM 2151-SET-SELECTED-INDS                       13680002
234400                 VARYING ASC-ITEM-SUB                             13690002
234500                 FROM 1 BY 1                                      13700002
234600                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          13710002
234700                                                                  13720002
234800             PERFORM 5100-WRITE-TEMP-STORAGE                      13730002
234900                                                                  13740002
235000             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      13750002
235100                                                                  13760002
235200         END-PERFORM                                              13770002
235300                                                                  13780002
235400         MOVE PV-FIRST-BLOCK-IN-ARRAY                             13790002
235500                                   TO PV-BLOCK-NUMBER             13800002
235600                                                                  13810002
235700         PERFORM 4410-READ-TEMP-STORAGE                           13820002
235800     END-IF.                                                      13830002
235900                                                                  13840002
236000                                                                  13850002
236100     MOVE ASC-NUMBER-OF-ITEMS-READ TO                             13860002
236200                       ASC-NUMBER-OF-SELECTED-ITEMS.              13870002
236300                                                                  13880002
236400     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        13890002
236500                                                                  13900002
236600 EJECT                                                            13910002
236700*----------------------------------------------------------------*13920002
236800*    MARK EACH ITEM AS BEING SELECTED.                           *13930002
236900*----------------------------------------------------------------*13940002
237000                                                                  13950002
237100 2151-SET-SELECTED-INDS.                                          13960002
237200                                                                  13970002
237300     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           13980002
237400             NOT EQUAL ZERO                                       13990002
237500         IF  NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             14000002
237600             SET ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             14010002
237700                 ASC-TEMP-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)        14020002
237800                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  14030002
237900                               TO  TRUE                           14040002
238000         END-IF                                                   14050002
238100     END-IF.                                                      14060002
238200******************************************************************14070002
238300** MOVE ALL OF THE FIELDS THAT WERE ENTERED / CHANGED ON THE    **14080002
238400** SCREEN INTO THE COMMAREA.  ALL EDITTING IS DONE IN THE COMM. **14090002
238500******************************************************************14100002
238600 2200-MOVE-SCREEN-TO-COMMAREA.                                    14110002
238700                                                                  14120002
238800     MOVE PV-TOP-ITEM              TO PV-ITEM-IN-USE.             14130002
238900     MOVE +1                       TO PV-SUB.                     14140002
239000*                                                                 14150002
239100     PERFORM 3100-SET-SUBSCRIPTS.                                 14160002
239200     IF  ASTRTITL > ZERO                                          14170002
239300         MOVE ASTRTITI         TO ASC-START-ITEM-REQUEST          14180002
239400     ELSE                                                         14190002
239500         IF  ASTRTITF = DP015-ERASE-EOF                           14200002
239600             INITIALIZE ASC-START-ITEM-REQUEST                    14210002
239700         END-IF                                                   14220002
239800     END-IF.                                                      14230002
239801     IF  APRTIDL > ZERO                                           14240038
239802         MOVE APRTIDI          TO ASC-PRINTER-DEST                14250038
239803     ELSE                                                         14260038
239804         IF  APRTIDF = DP015-ERASE-EOF                            14270038
239805             MOVE  SPACES      TO ASC-PRINTER-DEST                14280038
239806         END-IF                                                   14290038
239807     END-IF.                                                      14300038
239808                                                                  14310022
239900     PERFORM 2210-MOVE-LINES-TO-COMMAREA                          14320002
240000         VARYING PV-SUB                                           14330002
240100         FROM 1 BY 1                                              14340002
240200         UNTIL PV-SUB > ASC-ITEMS-DISPLAYED.                      14350002
240300******************************************************************14360002
240400** MOVE THE ENTERABLE FIELDS ON EACH LIST LINE INTO THE COMMAREA**14370002
240500******************************************************************14380002
240600 2210-MOVE-LINES-TO-COMMAREA.                                     14390002
240700     IF  MR-SELECTL (PV-SUB) > ZERO                               14400002
240800         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE             14410002
240900         MOVE MR-SELECTI (PV-SUB)                                 14420002
241000                                   TO ASC-TEMP-SELECTED-SW        14430002
241100                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      14440002
241200     ELSE                                                         14450002
241300         IF  MR-SELECTA (PV-SUB) = DP015-ERASE-EOF                14460002
241400                 SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE     14470002
241500                 MOVE SPACE        TO ASC-TEMP-SELECTED-SW        14480002
241600                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      14490002
241700         END-IF                                                   14500002
241800     END-IF.                                                      14510002
241900     ADD +1                        TO ASC-ITEM-SUB.               14520002
242000     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        14530002
242100         ADD +1                    TO ASC-BLK-SUB                 14540002
242200         MOVE +1                   TO ASC-ITEM-SUB                14550002
242300     END-IF.                                                      14560002
242310******************************************************************14570021
242320** MOVE DATA NECESSARY TO THE DESTINATION PROGRAM(S) INTO THE   **14580021
242330** INTER-APPLICATION COMMAREA.                                  **14590021
242340******************************************************************14600021
242350 2300-PREPARE-INTER-APPL-COMM.                                    14610021
242380     MOVE DK-PRINTER-DEST       TO SU083-PRINTER-ID.              14620027
242391     MOVE ASC-TRIP-OCRNC-ID     TO SU083-TRIP-OCRNC-ID.           14630025
242392     MOVE ASC-STR-NBR           TO SU083-STR-NBR.                 14640029
242394                                                                  14650021
242395     MOVE ASC-STR-NAME          TO SU083-STR-NAME.                14660021
242396     MOVE ASC-SEQ-DESC          TO SU083-SCREEN-SEQUENCE.         14670021
242397     MOVE ASC-SCAC              TO SU083-SCAC.                    14680021
242398     MOVE ASC-TRLR-SRL-NBR      TO SU083-TRLR-SRL-NBR.            14690021
242399     MOVE ASC-TRLR-ID           TO SU083-TRLR-ID.                 14700021
242400     MOVE ASC-TRIP-STAT-DESC    TO SU083-TRLR-STATUS.             14710021
242401     MOVE ASC-TOTAL-CARTONS     TO SU083-TOTAL-CTNS.              14720021
242402     MOVE ASC-TOTAL-UNITS       TO SU083-TOTAL-UNITS.             14730021
242403     MOVE ASC-SERVICE-DC-NAME   TO SU083-SERVICING-DC.            14740021
242404     MOVE ASC-SUMMARY-DATE      TO SU083-SUMMARY-DATE.            14750021
242405     MOVE ASC-SUMMARY-TIME      TO SU083-SUMMARY-TIME.            14760021
242407                                                                  14770021
242408******************************************************************14780025
242409 2400-CHECK-PRINTER-ID.                                           14790025
242410                                                                  14800021
242411     IF  APRTIDL > ZERO                                           14810025
242412         MOVE APRTIDI              TO ASC-PRINTER-DEST            14820025
242413                                      DK-PRINTER-DEST             14830027
242414     ELSE                                                         14840025
242415         IF  APRTIDF = DP015-ERASE-EOF                            14850025
242416             MOVE SPACE            TO ASC-PRINTER-DEST            14860025
242417                                      DK-PRINTER-DEST             14870027
242418         END-IF                                                   14880025
242419     END-IF.                                                      14890025
242420                                                                  14900025
242421     EVALUATE TRUE                                                14910025
242422         WHEN DK-PRINTER-DEST    = SPACES                         14920027
242423             SET PS-ERROR                                         14930025
242424                 DP020-MSG-FATAL  TO TRUE                         14940025
242425             MOVE PC-TSYMSG-00007 TO DP020-MSG-NUMBER             14950025
242426             MOVE DP015-UNP-ALP-BRT-MDT                           14960025
242427                                  TO APRTIDA                      14970025
242428             MOVE DP015-RED       TO APRTIDC                      14980025
242429             MOVE DP015-REVERSE   TO APRTIDH                      14990025
242430             MOVE -1              TO APRTIDL                      15000025
242431             SET DP030-SET-CURSOR-APPL-1                          15010025
242432                                  TO TRUE                         15020025
242433         WHEN DK-PRINTER-DEST   > SPACES                          15030027
242471             IF (DK-PRINTER-DEST-1 = 'U' AND                      15040039
242472                 DP020-LOCATION-NBR = 090) OR                     15050039
242473                 DK-PRINTER-DEST-1  = 'S'                         15060039
242474                   CONTINUE                                       15070039
242475             ELSE                                                 15080039
242476                IF DK-PRINTER-DEST-1 = 'U'                        15090039
242477                  PERFORM 2500-VALIDATE-PRINTER                   15100039
242478                  IF DP072-PRTR-PRTR-TRK-STAT-CDE  EQUAL 'A'      15110039
242479                      CONTINUE                                    15120039
242480                  ELSE                                            15130039
242481                    SET PS-ERROR                                  15140039
242482                        DP020-MSG-FATAL  TO TRUE                  15150039
242483                        MOVE PC-TSYMSG-00746 TO DP020-MSG-NUMBER  15160039
242484                        MOVE DP015-UNP-ALP-BRT-MDT                15170039
242485                                             TO APRTIDA           15180039
242486                        MOVE DP015-RED       TO APRTIDC           15190039
242487                        MOVE DP015-REVERSE   TO APRTIDH           15200039
242488                        MOVE -1              TO APRTIDL           15210039
242489                        MOVE SPACE           TO ASC-PRINTER-DEST  15220039
242490                        SET DP030-SET-CURSOR-APPL-1               15230039
242491                                           TO TRUE                15240039
242492                  END-IF                                          15250039
242493                ELSE                                              15260039
242494                  SET PS-ERROR                                    15270039
242495                      DP020-MSG-FATAL  TO TRUE                    15280039
242496                  MOVE PC-TSYMSG-00746 TO DP020-MSG-NUMBER        15290039
242497                  MOVE DP015-UNP-ALP-BRT-MDT                      15300039
242498                                       TO APRTIDA                 15310039
242499                  MOVE DP015-RED       TO APRTIDC                 15320039
242500                  MOVE DP015-REVERSE   TO APRTIDH                 15330039
242501                  MOVE -1              TO APRTIDL                 15340039
242502                  SET DP030-SET-CURSOR-APPL-1                     15350039
242503                                       TO TRUE                    15360039
242504                END-IF                                            15370039
242505             END-IF                                               15380039
242506         WHEN OTHER                                               15390039
242507                  SET PS-ERROR                                    15400039
242508                      DP020-MSG-FATAL  TO TRUE                    15410039
242509                  MOVE PC-TSYMSG-00746 TO DP020-MSG-NUMBER        15420039
242510                  MOVE DP015-UNP-ALP-BRT-MDT                      15430039
242511                                       TO APRTIDA                 15440039
242512                  MOVE DP015-RED       TO APRTIDC                 15450039
242513                  MOVE DP015-REVERSE   TO APRTIDH                 15460039
242514                  MOVE -1              TO APRTIDL                 15470039
242515                  SET DP030-SET-CURSOR-APPL-1                     15480039
242516                                       TO TRUE                    15490039
242517     END-EVALUATE.                                                15500033
242518******************************************************************15510033
242519*  VALIDATE USING DPKCS060                                        15520033
242520******************************************************************15530033
242521 2500-VALIDATE-PRINTER.                                           15540033
242522                                                                  15550033
242523     MOVE DK-PRINTER-DEST                                         15560033
242524                             TO DP072-PRINTER-ID                  15570033
242525     MOVE 'SUKRP016'         TO DP072-RPT-PGM-NME                 15580034
242526     MOVE '01'               TO DP072-RPT-PGM-TYP-ID              15590033
242527     MOVE DP020-LOCATION-NBR TO DP072-ORIGIN-OPER-UNT-ID          15600033
242528     MOVE DP020-LOCATION-NBR                                      15610033
242529                             TO DP072-OPER-UNT-ID                 15620033
242530     MOVE '01'               TO DP072-ORIGIN-FCLTY-ID             15630033
242531     MOVE '01'               TO DP072-FCLTY-ID                    15640033
242532                                                                  15650033
242533     SET DP072-VALIDATE     TO TRUE                               15660033
242534                                                                  15670033
242535     EXEC CICS                                                    15680033
242536         LINK PROGRAM  (PC-DPKCS060)                              15690033
242537              COMMAREA (DP072-COMM-AREA)                          15700033
242538              RESP     (PV-CICS-RESP)                             15710033
242539     END-EXEC                                                     15720033
242540                                                                  15730033
242541     EVALUATE TRUE                                                15740033
242542         WHEN PV-CICS-RESP = DFHRESP (NORMAL)                     15750033
242543             CONTINUE                                             15760033
242544         WHEN OTHER                                               15770033
242545               MOVE '2400-CHECK-PRINTER-ID     '                  15780033
242546                                    TO DP013-PARAGRAPH            15790033
242547               MOVE PV-CICS-RESP                                  15800033
242548                    TO DP013-MESSAGE-TEXT(1)                      15810033
242549               MOVE SQLCA           TO DP013-SQLCA                15820033
242550               SET DP013-LINK-RETURN                              15830033
242551                   DP013-CICS-ABEND                               15840033
242552                   DP013-NO-ROLLBACK TO TRUE                      15850033
242553               PERFORM DP013-0000-PROCESS-ABEND                   15860033
242554     END-EVALUATE.                                                15870033
242555                                                                  15880033
242556*                                                                 15890025
242557*    IF  PS-NO-ERROR                                              15900025
242558*        MOVE -1                   TO APRTIDL                     15910025
242559*        SET DP030-SET-CURSOR-APPL-1                              15920025
242560*                                  TO TRUE                        15930025
242561*    END-IF.                                                      15940025
242562/                                                                 15950025
242563******************************************************************15960021
242570** EDIT ALL OF THE DATA ON THE SCREEN AS IT RESIDES IN THE      **15970002
242600** COMMAREA (EDITTING IS NOT DONE AGAINST THE SCREEN DIRECTLY). **15980002
242700******************************************************************15990002
242800 3000-EDIT-DATA-IN-COMMAREA.                                      16000002
242900     SET PS-NO-ERROR               TO TRUE.                       16010002
243000     PERFORM 3200-RESET-ATTRIBUTES.                               16020002
243100     MOVE ASC-ITEMS-DISPLAYED      TO PV-SUB.                     16030002
243200**                                                                16040002
243300* CALCULATE THE POSITION OF THE LAST ITEM DISPLAYED.              16050002
243400* EDITTING IS DONE FROM THE BOTTOM UP.                            16060002
243500**                                                                16070002
243600     COMPUTE PV-ITEM-IN-USE = PV-TOP-ITEM +                       16080002
243700         ASC-ITEMS-DISPLAYED - 1.                                 16090002
243800     PERFORM 3100-SET-SUBSCRIPTS.                                 16100002
243900     PERFORM 3300-EDIT-SELECTIONS                                 16110002
244000         VARYING PV-SUB                                           16120002
244100         FROM PV-SUB BY -1                                        16130002
244200         UNTIL PV-SUB < +1                                        16140002
244300*                                                                 16150002
244400     IF  PS-NO-ERROR                                              16160002
244500         PERFORM 3400-CHECK-RANGE-SEQUENCE                        16170002
244600     END-IF.                                                      16180002
244700*                                                                 16190002
244800     IF  ((PS-NO-ERROR)                                           16200002
244900       AND (ASC-START-OF-SELECTED-RANGE > ZERO)                   16210002
245000       AND (ASC-END-OF-SELECTED-RANGE > ZERO))                    16220002
245100             PERFORM 3500-MARK-RANGE-AS-SELECTED                  16230002
245200     END-IF.                                                      16240002
245300 EJECT                                                            16250002
245400*----------------------------------------------------------------*16260002
245500*    DETERMINE THE VALUE OF THE ITEM SUBSCRIPT BASED ON THE ITEM *16270002
245600*    CURRENTLY IN USE AND THE FIRST ITEM IN THE ARRAY.  THIS WILL*16280002
245700*    POSITION US IN THE 1ST BLOCK OF THE ARRAY.                  *16290002
245800*                                                                *16300002
245900*    IF THE ITEM SUBSCRIPT EXCEEDS THE MAXIMUM NUMBER OF ITEMS   *16310002
246000*    IN A BLOCK, RECALCULATE THE SUBSCRIPT BY SUBTRACTING OUT    *16320002
246100*    THE MAXIMUM NUMBER OF ITEMS.  THIS WILL CORRECTLY POSITION  *16330002
246200*    US IN THE 2ND BLOCK OF THE ARRAY.                           *16340002
246300*----------------------------------------------------------------*16350002
246400                                                                  16360002
246500 3100-SET-SUBSCRIPTS.                                             16370002
246600                                                                  16380002
246700     COMPUTE ASC-ITEM-SUB =                                       16390002
246800         (PV-ITEM-IN-USE - ASC-LIST-ITEM-NUMBER(1 1)) + 1.        16400002
246900                                                                  16410002
247000     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         16420002
247100         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            16430002
247200                                                                  16440002
247300         MOVE PC-MAX-BLOCKS-IN-ARRAY TO ASC-BLK-SUB               16450002
247400     ELSE                                                         16460002
247500         MOVE +1                     TO ASC-BLK-SUB               16470002
247600     END-IF.                                                      16480002
247700******************************************************************16490002
247800** RESET THE ATTRIBUTES OF ALL ENTERABLE FIELDS ON THE MAP.     **16500002
247900******************************************************************16510002
248000                                                                  16520002
248100 3200-RESET-ATTRIBUTES.                                           16530002
248200     MOVE DP015-UNP-ALP-NOR-OFF    TO ASTRTITA.                   16540002
248300     MOVE DP015-GREEN              TO ASTRTITC.                   16550002
248400     MOVE DP015-UNDERLINE          TO ASTRTITH.                   16560002
248500*                                                                 16570002
248600     PERFORM                                                      16580002
248700         VARYING PV-SUB                                           16590002
248800         FROM 1 BY 1                                              16600002
248900         UNTIL PV-SUB > PC-ITEMS-PER-PANEL                        16610002
249000         MOVE DP015-UNP-ALP-NOR-OFF                               16620002
249100                                   TO MR-SELECTA (PV-SUB)         16630002
249200         MOVE DP015-ASK-NOR-OFF    TO MR-AREA-A (PV-SUB)          16640002
249300                                      MR-AREA-DESC-A (PV-SUB)     16650002
249400                                      MR-CARTONS-A (PV-SUB)       16660002
249500                                      MR-UNITS-A (PV-SUB)         16670002
249600                                      MR-SKU-COUNT-A (PV-SUB)     16680002
249700                                      MR-AD-A (PV-SUB)            16690002
249800         MOVE DP015-GREEN          TO MR-SELECTC (PV-SUB)         16700002
249900         MOVE DP015-UNDERLINE      TO MR-SELECTH (PV-SUB)         16710002
250000     END-PERFORM.                                                 16720002
250100******************************************************************16730002
250200** EDIT THE SELECTIONS MADE.  NOTE THAT THE 'SELECTED-SW' IS    **16740002
250300** WHAT WAS PREVIOUSLY CHECKED AND CORRECT 'TEMP-SELECTED-SW'   **16750002
250400** IS WHAT HAS JUST BEEN ENTERED AND HAS NOT BEEN EDITTED OR    **16760002
250500** WAS ENTERED EARLIER, BUT DID NOT PASS THE EDITS.             **16770002
250600******************************************************************16780002
250700 3300-EDIT-SELECTIONS.                                            16790002
250800     EVALUATE TRUE                                                16800002
250900         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     16810002
251000             = ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)         16820002
251100                 CONTINUE                                         16830002
251200         WHEN ASC-TEMP-SELECT  (ASC-BLK-SUB ASC-ITEM-SUB)         16840002
251300             IF  NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)        16850002
251400                 ADD +1         TO ASC-NUMBER-OF-SELECTED-ITEMS   16860002
251500                 MOVE ASC-TEMP-SELECTED-SW                        16870002
251600                                      (ASC-BLK-SUB ASC-ITEM-SUB)  16880002
251700                                TO ASC-SELECTED-SW                16890002
251800                                      (ASC-BLK-SUB ASC-ITEM-SUB)  16900002
251900             END-IF                                               16910002
252000         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     16920002
252100                 = SPACE                                          16930002
252200             EVALUATE TRUE                                        16940002
252300                 WHEN ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)       16950002
252400                     SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS16960002
252500                     MOVE SPACE TO ASC-SELECTED-SW                16970002
252600                                      (ASC-BLK-SUB ASC-ITEM-SUB)  16980002
252700                 WHEN ASC-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)        16990002
252800                     MOVE ZERO  TO ASC-START-OF-SELECTED-RANGE    17000002
252900                     MOVE SPACE TO ASC-SELECTED-SW                17010002
253000                                      (ASC-BLK-SUB ASC-ITEM-SUB)  17020002
253100                 WHEN ASC-END (ASC-BLK-SUB ASC-ITEM-SUB)          17030002
253200                     MOVE ZERO  TO ASC-END-OF-SELECTED-RANGE      17040002
253300                     MOVE SPACE TO ASC-SELECTED-SW                17050002
253400                                      (ASC-BLK-SUB ASC-ITEM-SUB)  17060002
253500             END-EVALUATE                                         17070002
253600         WHEN ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)           17080002
253700             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            17090002
253800                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    17100002
253900             END-IF                                               17110002
254000             PERFORM 3310-EDIT-RANGE                              17120002
254100         WHEN ASC-TEMP-END (ASC-BLK-SUB ASC-ITEM-SUB)             17130002
254200             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            17140002
254300                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    17150002
254400             END-IF                                               17160002
254500             PERFORM 3310-EDIT-RANGE                              17170002
254600         WHEN OTHER                                               17180002
254700             MOVE PC-TSYMSG-00005   TO DP020-MSG-NUMBER           17190002
254800             SET DP020-MSG-FATAL    TO TRUE                       17200002
254900             MOVE -1                TO MR-SELECTL (PV-SUB)        17210002
255000             SET DP030-SET-CURSOR-APPL-1                          17220002
255100                                    TO TRUE                       17230002
255200             MOVE DP015-RED         TO MR-SELECTC (PV-SUB)        17240002
255300             MOVE DP015-REVERSE     TO MR-SELECTH (PV-SUB)        17250002
255400             SET PS-ERROR TO TRUE                                 17260002
255500             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            17270002
255600                 SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS     17280002
255700                 MOVE SPACE         TO ASC-SELECTED-SW            17290002
255800                                        (ASC-BLK-SUB ASC-ITEM-SUB)17300002
255900             END-IF                                               17310002
256000     END-EVALUATE.                                                17320002
256100                                                                  17330002
256200     SUBTRACT +1             FROM PV-ITEM-IN-USE.                 17340002
256300     SUBTRACT +1 FROM ASC-ITEM-SUB.                               17350002
256400     IF  ASC-ITEM-SUB < 1                                         17360002
256500         SUBTRACT +1 FROM ASC-BLK-SUB                             17370002
256600         MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB                17380002
256700     END-IF.                                                      17390002
256800                                                                  17400002
256900******************************************************************17410002
257000** IF A BEGINNING AND END OF RANGE WAS ENTERED TO SELECT A      **17420002
257100** RANGE OF LINES, MAKE SURE THERE IS ONLY 1 BEGINNING AND 1    **17430002
257200** ENDING AND MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN)**17440002
257300** THE ENDING.                                                  **17450002
257400******************************************************************17460002
257500 3310-EDIT-RANGE.                                                 17470002
257600     IF  ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)                17480002
257700         IF  ASC-START-OF-SELECTED-RANGE = ZERO                   17490002
257800             MOVE ASC-TEMP-SELECTED-SW  (ASC-BLK-SUB ASC-ITEM-SUB)17500002
257900                                   TO ASC-SELECTED-SW             17510002
258000                                        (ASC-BLK-SUB ASC-ITEM-SUB)17520002
258100             MOVE PV-ITEM-IN-USE   TO ASC-START-OF-SELECTED-RANGE 17530002
258200         ELSE                                                     17540002
258300             IF  ASC-START-OF-SELECTED-RANGE = PV-ITEM-IN-USE     17550002
258400                 CONTINUE                                         17560002
258500             ELSE                                                 17570002
258600*                -- ONLY ONE BEGINNING-OF-RANGE-ALLOWED --        17580002
258700                 MOVE PC-TSYMSG-00054                             17590002
258800                                   TO DP020-MSG-NUMBER            17600002
258900                 SET DP020-MSG-FATAL                              17610002
259000                                   TO TRUE                        17620002
259100                 MOVE -1           TO MR-SELECTL (PV-SUB)         17630002
259200                 SET DP030-SET-CURSOR-APPL-1                      17640002
259300                                   TO TRUE                        17650002
259400                 MOVE DP015-RED    TO MR-SELECTC (PV-SUB)         17660002
259500                 MOVE DP015-UNDERLINE                             17670002
259600                                   TO MR-SELECTH (PV-SUB)         17680002
259700                 SET PS-ERROR      TO TRUE                        17690002
259800             END-IF                                               17700002
259900         END-IF                                                   17710002
260000     ELSE                                                         17720002
260100         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     17730002
260200             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 17740002
260300                                   TO ASC-SELECTED-SW             17750002
260400                                     (ASC-BLK-SUB ASC-ITEM-SUB)   17760002
260500             MOVE PV-ITEM-IN-USE   TO ASC-END-OF-SELECTED-RANGE   17770002
260600         ELSE                                                     17780002
260700             IF  ASC-END-OF-SELECTED-RANGE = PV-ITEM-IN-USE       17790002
260800                 CONTINUE                                         17800002
260900             ELSE                                                 17810002
261000*                -- ONLY ONE END-OF-RANGE ALLOWED --              17820002
261100                 MOVE PC-TSYMSG-00055                             17830002
261200                                   TO DP020-MSG-NUMBER            17840002
261300                 SET DP020-MSG-FATAL                              17850002
261400                                   TO TRUE                        17860002
261500                 MOVE -1           TO MR-SELECTL (PV-SUB)         17870002
261600                 SET DP030-SET-CURSOR-APPL-1                      17880002
261700                                   TO TRUE                        17890002
261800                 SET PS-ERROR      TO TRUE                        17900002
261900             END-IF                                               17910002
262000         END-IF                                                   17920002
262100     END-IF.                                                      17930002
262200*                                                                 17940002
262300******************************************************************17950002
262400** IF BOTH A BEGINNING AND END OF RANGE HAVE BEEN SPECIFIED,    **17960002
262500** MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN) THE END.  **17970002
262600******************************************************************17980002
262700 3400-CHECK-RANGE-SEQUENCE.                                       17990002
262800     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       18000002
262900       AND  ASC-END-OF-SELECTED-RANGE > ZERO                      18010002
263000       AND  ASC-START-OF-SELECTED-RANGE >                         18020002
263100                                         ASC-END-OF-SELECTED-RANGE18030002
263200*        -- END-OF-RANGE BEFORE BEGINNING-OF-RANGE                18040002
263300         MOVE PC-TSYMSG-00052 TO DP020-MSG-NUMBER                 18050002
263400         SET DP020-MSG-FATAL TO TRUE                              18060002
263500         SET PS-ERROR TO TRUE                                     18070002
263600         PERFORM 3410-POSITION-AT-ERROR                           18080002
263700     END-IF.                                                      18090002
263800******************************************************************18100002
263900** BECAUSE RANGES CAN SPAN ACROSS MULTIPLE PAGES, A SEPARATE    **18110002
264000** PARAGRAPH (THIS ONE) IS NEEDED TO DETERMINE WHERE THE CURSOR **18120002
264100** SHOULD BE POSITIONED ON A RANGE ERROR.                       **18130002
264200******************************************************************18140002
264300 3410-POSITION-AT-ERROR.                                          18150002
264400     SET DP030-SET-CURSOR-APPL-1                                  18160002
264500                                   TO TRUE.                       18170002
264600     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 18180002
264700                    - PV-TOP-ITEM + 1.                            18190002
264800     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      18200002
264900         CONTINUE                                                 18210002
265000     ELSE                                                         18220002
265100         MOVE -1                   TO MR-SELECTL (PV-SUB)         18230002
265200         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         18240002
265300         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         18250002
265400     END-IF.                                                      18260002
265500*                                                                 18270002
265600     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   18280002
265700                    - PV-TOP-ITEM + 1.                            18290002
265800     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      18300002
265900         CONTINUE                                                 18310002
266000     ELSE                                                         18320002
266100         MOVE -1                   TO MR-SELECTL (PV-SUB)         18330002
266200         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         18340002
266300         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         18350002
266400     END-IF.                                                      18360002
266500 EJECT                                                            18370002
266600*----------------------------------------------------------------*18380002
266700*    WHENEVER THE USER SELECTS AN ITEM AS THE BEGINNING RANGE    *18390002
266800*    AND ONE AS THE ENDING RANGE, MARK THESE ITEMS AS WELL AS    *18400002
266900*    THOSE THAT FALL IN THE RANGE AS BEING SELECTED.             *18410002
267000*----------------------------------------------------------------*18420002
267100                                                                  18430002
267200 3500-MARK-RANGE-AS-SELECTED.                                     18440002
267300     MOVE +1                       TO  ASC-BLK-SUB.               18450002
267400     PERFORM 3510-MARK-SELECTED-INDS                              18460002
267500         VARYING ASC-ITEM-SUB                                     18470002
267600         FROM 1 BY 1                                              18480002
267700         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 18490002
267800                                                                  18500002
267900     ADD +1                        TO ASC-BLK-SUB.                18510002
268000     PERFORM 3510-MARK-SELECTED-INDS                              18520002
268100         VARYING ASC-ITEM-SUB                                     18530002
268200         FROM 1 BY 1                                              18540002
268300         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 18550002
268400                                                                  18560002
268500     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               18570002
268600                                   TO  PV-LIST-ITEM-NUMBER.       18580002
268700     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            18590002
268800         1 + ((PV-LIST-ITEM-NUMBER - 1) /                         18600002
268900               PC-ITEMS-PER-PANEL).                               18610002
269000                                                                  18620002
269100     MOVE ASC-START-OF-SELECTED-RANGE                             18630002
269200                                   TO PV-START-OF-SELECTED-RANGE. 18640002
269300     COMPUTE PV-FIRST-BLOCK-IN-RANGE =                            18650002
269400         1 + ((PV-START-OF-SELECTED-RANGE - 1) /                  18660002
269500               PC-ITEMS-PER-PANEL).                               18670002
269600                                                                  18680002
269700     MOVE ASC-END-OF-SELECTED-RANGE                               18690002
269800                                   TO  PV-END-OF-SELECTED-RANGE.  18700002
269900     COMPUTE PV-LAST-BLOCK-IN-RANGE =                             18710002
270000         1 + ((PV-END-OF-SELECTED-RANGE - 1) /                    18720002
270100               PC-ITEMS-PER-PANEL).                               18730002
270200     COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                             18740002
270300         PV-FIRST-BLOCK-IN-ARRAY + 1.                             18750002
270400                                                                  18760002
270500     IF (PV-FIRST-BLOCK-IN-RANGE < PV-FIRST-BLOCK-IN-ARRAY) OR    18770002
270600        (PV-LAST-BLOCK-IN-RANGE  > PV-NEXT-BLOCK-IN-ARRAY)        18780002
270700         MOVE +1                   TO ASC-BLK-SUB                 18790002
270800         PERFORM 5100-WRITE-TEMP-STORAGE                          18800002
270900         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         18810002
271000             PV-FIRST-BLOCK-IN-ARRAY - 1                          18820002
271100                                                                  18830002
271200         PERFORM                                                  18840002
271300             UNTIL PV-FIRST-BLOCK-IN-RANGE >                      18850002
271400                   PV-PREV-BLOCK-IN-ARRAY                         18860002
271500             MOVE PV-FIRST-BLOCK-IN-RANGE                         18870002
271600                                   TO PV-BLOCK-NUMBER             18880002
271700             PERFORM 4410-READ-TEMP-STORAGE                       18890002
271800             PERFORM 3510-MARK-SELECTED-INDS                      18900002
271900                 VARYING ASC-ITEM-SUB                             18910002
272000                 FROM 1 BY 1                                      18920002
272100                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          18930002
272200             PERFORM 5100-WRITE-TEMP-STORAGE                      18940002
272300             ADD +1                TO PV-FIRST-BLOCK-IN-RANGE     18950002
272400         END-PERFORM                                              18960002
272500                                                                  18970002
272600         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         18980002
272700             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     18990002
272800         PERFORM                                                  19000002
272900             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       19010002
273000                   PV-LAST-BLOCK-IN-RANGE                         19020002
273100             MOVE PV-NEXT-BLOCK-IN-ARRAY                          19030002
273200                                   TO PV-BLOCK-NUMBER             19040002
273300             PERFORM 4410-READ-TEMP-STORAGE                       19050002
273400             PERFORM 3510-MARK-SELECTED-INDS                      19060002
273500                 VARYING ASC-ITEM-SUB                             19070002
273600                 FROM 1 BY 1                                      19080002
273700                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          19090002
273800             PERFORM 5100-WRITE-TEMP-STORAGE                      19100002
273900             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      19110002
274000         END-PERFORM                                              19120002
274100                                                                  19130002
274200         MOVE PV-FIRST-BLOCK-IN-ARRAY                             19140002
274300                                   TO PV-BLOCK-NUMBER             19150002
274400         PERFORM 4410-READ-TEMP-STORAGE                           19160002
274500     END-IF.                                                      19170002
274600                                                                  19180002
274700     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE 19190002
274800                                      ASC-END-OF-SELECTED-RANGE.  19200002
274900                                                                  19210002
275000/                                                                 19220002
275100*----------------------------------------------------------------*19230002
275200* SET THE SELECTION INDICATOR TO 'S' WITHIN THE RANGE.           *19240002
275300*----------------------------------------------------------------*19250002
275400                                                                  19260002
275500 3510-MARK-SELECTED-INDS.                                         19270002
275600                                                                  19280002
275700     IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         19290002
275800                                ASC-ITEM-SUB) >                   19300002
275900         ASC-START-OF-SELECTED-RANGE)                             19310002
276000     OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         19320002
276100                                ASC-ITEM-SUB) =                   19330002
276200         ASC-START-OF-SELECTED-RANGE)                             19340002
276300                                                                  19350002
276400         IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     19360002
276500                                    ASC-ITEM-SUB) <               19370002
276600             ASC-END-OF-SELECTED-RANGE)                           19380002
276700         OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     19390002
276800                                    ASC-ITEM-SUB) =               19400002
276900             ASC-END-OF-SELECTED-RANGE)                           19410002
277000                                                                  19420002
277100             IF NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          19430002
277200                 SET ASC-SELECT     (ASC-BLK-SUB  ASC-ITEM-SUB)   19440002
277300                     ASC-TEMP-SELECT(ASC-BLK-SUB  ASC-ITEM-SUB)   19450002
277400                               TO TRUE                            19460002
277500                 SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB)              19470002
277600                               TO TRUE                            19480002
277700                 ADD +1        TO ASC-NUMBER-OF-SELECTED-ITEMS    19490002
277800             END-IF                                               19500002
277900         END-IF                                                   19510002
278000     END-IF.                                                      19520002
278100                                                                  19530002
278200 EJECT                                                            19540002
278300*----------------------------------------------------------------*19550002
278400*    INITIALIZE BOTH BLOCKS IN THE ARRAY.                        *19560002
278500*    INITIALIZE ALL COUNTERS AND FLAGS.                          *19570002
278600*    READ THE DATA BASE FOR THE 1ST TIME AND FILL UP THE ARRAY.  *19580002
278700*    DISPLAY THE PANEL TO USER.                                  *19590002
278800*----------------------------------------------------------------*19600002
278900                                                                  19610002
279000 4000-BUILD-INITIAL-PANEL.                                        19620002
279100                                                                  19630002
279200     INITIALIZE                  ASC-BLOCK-ENTRIES (1)            19640002
279300                                 ASC-BLOCK-ENTRIES (2).           19650002
279400     MOVE +1                 TO ASC-BLK-SUB.                      19660002
279500     SET ASC-ITEMS-LEFT-ON-DB                                     19670002
279600                             TO TRUE.                             19680002
279700                                                                  19690002
279800     MOVE ZERO               TO ASC-ITEM-SUB                      19700002
279900                                ASC-NUMBER-OF-ITEMS-READ          19710002
280000                                ASC-NUMBER-OF-SELECTED-ITEMS      19720002
280100                                ASC-HIGHEST-BLOCK-WRITTEN         19730002
280200                                ASC-START-OF-SELECTED-RANGE       19740002
280300                                ASC-END-OF-SELECTED-RANGE         19750002
280400                                ASC-ITEM-AT-TOP-OF-PANEL.         19760002
280500                                                                  19770002
280600     MOVE SU012-STR-NBR          TO ASC-STR-NBR                   19780002
280700                                                                  19790002
280800     PERFORM 4100-PREPARE-CURSOR                                  19800002
280900                                                                  19810002
281000     PERFORM 4010-OPEN-CURSOR.                                    19820002
281100                                                                  19830002
281200     PERFORM 4300-READ-ITEMS-FROM-DB.                             19840002
281300                                                                  19850002
281400     PERFORM 4020-CLOSE-CURSOR.                                   19860002
281500                                                                  19870002
281600     MOVE +1                   TO  PV-TOP-ITEM.                   19880002
281700     IF  ASC-NUMBER-OF-ITEMS-READ = ZERO                          19890002
281800*        SET DP020-NEXT-ACT-APPL-ERROR TO TRUE                    19900035
281900*        SET DP020-MSG-FATAL   TO  TRUE                           19910035
282010         SET DP020-MSG-WARNING TO  TRUE                           19920035
282020         MOVE PC-TSYMSG-00050  TO  DP020-MSG-NUMBER               19930035
282030         PERFORM 2050-DELETE-LIST-QUEUE                           19940035
282040         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                     19950035
282100     ELSE                                                         19960002
282200         MOVE -1               TO MR-SELECTL (1)                  19970002
282300         SET DP030-SET-CURSOR-APPL-1                              19980002
282400                               TO TRUE                            19990002
282500         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                     20000002
282600     END-IF.                                                      20010002
282700/                                                                 20020002
282800 4010-OPEN-CURSOR.                                                20030002
282900                                                                  20040002
283000     EVALUATE TRUE                                                20050002
283100         WHEN ASC-DEPT-SEQ                                        20060002
283200             MOVE 'CURSOR:  DEPT CSR'                             20070002
283300                                   TO DP013-MESSAGE-TEXT (2)      20080002
283400             EXEC SQL                                             20090002
283500                 OPEN GROUP-CSR                                   20100002
283600             END-EXEC                                             20110002
283700                                                                  20120002
283800         WHEN ASC-UNIT-SEQ                                        20130002
283900             MOVE 'CURSOR:  UNIT CSR'                             20140002
284000                                   TO DP013-MESSAGE-TEXT (2)      20150002
284100             EXEC SQL                                             20160002
284200                 OPEN UNIT-CSR                                    20170002
284300             END-EXEC                                             20180002
284400                                                                  20190002
284500     END-EVALUATE                                                 20200002
284600                                                                  20210002
284700     EVALUATE TRUE                                                20220002
284800         WHEN SQLCODE = ZERO                                      20230002
284900             CONTINUE                                             20240002
285000         WHEN SQLCODE = -904                                      20250002
285100         WHEN SQLCODE = -911                                      20260002
285200         WHEN SQLCODE = -913                                      20270002
285300             PERFORM 9900-SOFT-ABORT                              20280002
285400         WHEN SQLWARN0 NOT = SPACES                               20290002
285500         WHEN SQLCODE < ZERO                                      20300002
285600         WHEN SQLCODE > ZERO                                      20310002
285700             MOVE '4010-OPEN-CURSOR'                              20320002
285800                                   TO DP013-PARAGRAPH             20330002
285900             MOVE 'OPEN TRAILER STATUS CURSOR - '                 20340002
286000                                   TO DP013-MESSAGE-TEXT (1)      20350002
286100             MOVE SQLCA        TO DP013-SQLCA                     20360002
286200             MOVE 'TSUOBTR '   TO DP013-DB2-TABLE-NAME (1)        20370002
286300             MOVE 'TSUOBTS '   TO DP013-DB2-TABLE-NAME (2)        20380002
286400             SET DP013-DB2-ABEND                                  20390002
286500                 DP013-XCTL-DISPLAY-RESTART TO TRUE               20400002
286600             PERFORM DP013-0000-PROCESS-ABEND                     20410002
286700     END-EVALUATE.                                                20420002
286800/                                                                 20430002
286900 4020-CLOSE-CURSOR.                                               20440002
287000     EVALUATE TRUE                                                20450002
287100         WHEN ASC-DEPT-SEQ                                        20460002
287200             EXEC SQL                                             20470002
287300                 CLOSE GROUP-CSR                                  20480002
287400             END-EXEC                                             20490002
287500         WHEN ASC-UNIT-SEQ                                        20500002
287600             EXEC SQL                                             20510002
287700                 CLOSE UNIT-CSR                                   20520002
287800             END-EXEC                                             20530002
287900     END-EVALUATE.                                                20540002
288000*                                                                 20550002
288100     EVALUATE TRUE                                                20560002
288200         WHEN SQLCODE = ZERO                                      20570002
288300             CONTINUE                                             20580002
288400         WHEN SQLCODE = -904                                      20590002
288500         WHEN SQLCODE = -911                                      20600002
288600         WHEN SQLCODE = -913                                      20610002
288700             PERFORM 9900-SOFT-ABORT                              20620002
288800         WHEN SQLWARN0 NOT = SPACES                               20630002
288900         WHEN SQLCODE < ZERO                                      20640002
289000         WHEN SQLCODE > ZERO                                      20650002
289100             MOVE '4020-CLOSE-CURSOR'                             20660002
289200                               TO DP013-PARAGRAPH                 20670002
289300             MOVE 'CLOSE CURSOR '                                 20680002
289400                               TO DP013-MESSAGE-TEXT (1)          20690002
289500             MOVE SQLCA        TO DP013-SQLCA                     20700002
289600             MOVE 'TSYMSG  '   TO DP013-DB2-TABLE-NAME (1)        20710002
289700             SET DP013-DB2-ABEND                                  20720002
289800                 DP013-XCTL-DISPLAY-RESTART TO TRUE               20730002
289900             PERFORM DP013-0000-PROCESS-ABEND                     20740002
290000     END-EVALUATE.                                                20750002
290100                                                                  20760002
290200 EJECT                                                            20770002
290300*----------------------------------------------------------------*20780002
290400*    SET UP THE HOST VARIABLES.                                  *20790002
290500*----------------------------------------------------------------*20800002
290600                                                                  20810002
290700 4100-PREPARE-CURSOR.                                             20820002
290800                                                                  20830002
290900     MOVE ASC-TRIP-OCRNC-ID  TO DK-TRIP-OCRNC-ID                  20840002
291000                                                                  20850002
291100     EVALUATE TRUE                                                20860002
291200         WHEN SU012-DEPT-SEQ                                      20870002
291300             SET ASC-DEPT-SEQ         TO TRUE                     20880002
291400         WHEN SU012-UNIT-SEQ                                      20890002
291500             SET ASC-UNIT-SEQ         TO TRUE                     20900002
291600     END-EVALUATE.                                                20910002
291700                                                                  20920002
291800/                                                                 20930002
291900*----------------------------------------------------------------*20940002
292000*    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE    *20950002
292100*    BLOCKS IN THE ARRAY.  WHENEVER BOTH BLOCKS BECOME FULL,     *20960002
292200*    WRITE OUT THE 1ST BLOCK TO TEMPORARY STORAGE, MOVE THE 2ND  *20970002
292300*    BLOCK IN THE ARRAY TO THE 1ST BLOCK, AND INITIALIZE THE     *20980002
292400*    2ND BLOCK MAKING IT AVAILABLE TO BE USED.                   *20990002
292500*                                                                *21000002
292600*    DUE TO THE SIZE OF THE TABLE, AND THE ORDER IN WHICH THE    *21010002
292700*    ROWS ARE SORTED, THE ENTIRE TABLE IS READ INTO THE PROGRAM  *21020002
292800*    UPON INITIALIZATION.                                        *21030002
292900*----------------------------------------------------------------*21040002
293000                                                                  21050002
293100 4300-READ-ITEMS-FROM-DB.                                         21060002
293200                                                                  21070002
293300     PERFORM                                                      21080002
293400         VARYING PV-READ-COUNT                                    21090002
293500         FROM 1 BY 1                                              21100002
293600         UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                    21110002
293700            OR (ASC-NO-ITEMS-LEFT-ON-DB))                         21120002
293800                                                                  21130002
293900         PERFORM 4310-FETCH                                       21140002
294000                                                                  21150002
294100         IF  ASC-ITEMS-LEFT-ON-DB                                 21160002
294200             IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                21170002
294300                 ADD +1            TO ASC-ITEM-SUB                21180002
294400             ELSE                                                 21190002
294500                 ADD +1            TO ASC-BLK-SUB                 21200002
294600                 MOVE +1           TO ASC-ITEM-SUB                21210002
294700                                                                  21220002
294800                 IF  ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY         21230002
294900                     MOVE +1       TO ASC-BLK-SUB                 21240002
295000                     SET ASC-BLOCK-MODIFIED (1)                   21250002
295100                                   TO TRUE                        21260002
295200                     PERFORM 5100-WRITE-TEMP-STORAGE              21270002
295300                     MOVE ASC-BLOCK-ENTRIES                       21280002
295400                               (PC-MAX-BLOCKS-IN-ARRAY)           21290002
295500                                TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB) 21300002
295600                     ADD +1        TO ASC-BLK-SUB                 21310002
295700                     INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)   21320002
295800                     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)      21330002
295900                                   TO TRUE                        21340002
296000                 END-IF                                           21350002
296100             END-IF                                               21360002
296200             ADD +1                TO ASC-NUMBER-OF-ITEMS-READ    21370002
296300             PERFORM 4300A-MOVE-TO-COMMAREA                       21380002
296400         END-IF                                                   21390002
296500     END-PERFORM.                                                 21400002
296600                                                                  21410002
296700     IF  ASC-NUMBER-OF-ITEMS-READ > ZERO                          21420002
296800         MOVE +1               TO ASC-BLK-SUB                     21430002
296900         PERFORM 5100-WRITE-TEMP-STORAGE                          21440002
297000         ADD +1                TO ASC-BLK-SUB                     21450002
297100         PERFORM 5100-WRITE-TEMP-STORAGE                          21460002
297200                                                                  21470002
297300         MOVE 1                TO ASC-BLK-SUB                     21480002
297400                                  PV-BLOCK-NUMBER                 21490002
297500         PERFORM 4410-READ-TEMP-STORAGE                           21500002
297600         IF  ASC-HIGHEST-BLOCK-WRITTEN GREATER THAN 1             21510002
297700             MOVE 2            TO ASC-BLK-SUB                     21520002
297800                                  PV-BLOCK-NUMBER                 21530002
297900             PERFORM 4410-READ-TEMP-STORAGE                       21540002
298000         END-IF                                                   21550002
298100     END-IF.                                                      21560002
298200/                                                                 21570002
298300 4300A-MOVE-TO-COMMAREA.                                          21580002
298400                                                                  21590002
298500     MOVE ASC-NUMBER-OF-ITEMS-READ    TO ASC-LIST-ITEM-NUMBER     21600002
298600                                        (ASC-BLK-SUB ASC-ITEM-SUB)21610002
298700                                                                  21620002
298800     MOVE SUT00008-BUS-AREA-ID        TO ASC-AREA                 21630012
298900                                        (ASC-BLK-SUB ASC-ITEM-SUB)21640002
299000                                                                  21650002
299100*    PERFORM 4300D-BUS-AREA-NAME.                                 21660018
299200     MOVE XLT00000-BUS-AREA-DESC TO ASC-AREA-DESC                 21670002
299300                                        (ASC-BLK-SUB ASC-ITEM-SUB)21680002
299400                                                                  21690002
299500     MOVE SUT00008-UNT-QTY            TO ASC-UNT-QTY              21700002
299600                                        (ASC-BLK-SUB ASC-ITEM-SUB)21710002
299700     MOVE SUT00008-SKU-QTY            TO ASC-SKU-COUNT            21720002
299800                                        (ASC-BLK-SUB ASC-ITEM-SUB)21730002
299900     MOVE SUT00008-CART-QTY           TO ASC-CART-QTY             21740002
300000                                        (ASC-BLK-SUB ASC-ITEM-SUB)21750002
300100                                                                  21760002
300200     PERFORM 4300C-AD-DATES.                                      21770002
300300     IF PV-DB2-COUNT > ZERO                                       21780002
300400         MOVE 'Y'           TO ASC-AD (ASC-BLK-SUB ASC-ITEM-SUB)  21790002
300500     END-IF.                                                      21800002
300600                                                                  21810002
300700 4300C-AD-DATES.                                                  21820002
300800                                                                  21830002
300820     MOVE SUT00008-BUS-AREA-ID        TO DK-BUS-AREA-ID.          21840012
300900                                                                  21850002
301000     EXEC SQL                                                     21860002
301100         SELECT COUNT (*)                                         21870002
301200         INTO                                                     21880002
301300           :PV-DB2-COUNT                                          21890002
301400         FROM                                                     21900002
301500           SUT_MAJ_CL_AD_DTE A                                    21910002
301600         WHERE                                                    21920002
301700           A.TRIP_OCRNC_ID       = :DK-TRIP-OCRNC-ID              21930002
301800         AND                                                      21940002
301801           A.BUS_AREA_ID         = :DK-BUS-AREA-ID                21950014
301810         AND                                                      21960008
301900           (DATE(A.AD_EVNT_DTE) >= (CURRENT DATE - 5 DAYS))       21970008
302000           AND                                                    21980008
302100           (DATE(A.AD_EVNT_DTE) <= (CURRENT DATE + 5 DAYS))       21990008
302200     END-EXEC.                                                    22000008
302300                                                                  22010008
302400     EVALUATE TRUE                                                22020008
302500         WHEN SQLCODE = ZERO                                      22030008
302600         WHEN SQLCODE = +100                                      22040008
302700              CONTINUE                                            22050008
302800         WHEN SQLCODE = -904                                      22060008
302900         WHEN SQLCODE = -911                                      22070008
303000         WHEN SQLCODE = -913                                      22080008
303100             PERFORM 9900-SOFT-ABORT                              22090008
303200         WHEN SQLWARN0 NOT = SPACE                                22100008
303300         WHEN SQLCODE NOT = ZERO                                  22110008
303400              MOVE '4300C-AD-DATES'                               22120008
303500                               TO DP013-PARAGRAPH                 22130008
303600              MOVE 'SELECT '                                      22140008
303700                               TO DP013-MESSAGE-TEXT (1)          22150008
303800              MOVE SQLCA       TO DP013-SQLCA                     22160008
303900              SET DP013-DB2-ABEND                                 22170008
304000                               TO TRUE                            22180008
304100              PERFORM DP013-0000-PROCESS-ABEND                    22190008
304200     END-EVALUATE.                                                22200008
304300                                                                  22210008
304400 4300D-BUS-AREA-NAME.                                             22220008
304500     MOVE SUT00008-BUS-AREA-ID   TO XLT00001-BUS-GP-NBR           22230013
304600     EXEC SQL                                                     22240008
304700     SELECT                                                       22250008
304800         AREA.BUS_AREA_DESC                                       22260008
304900     INTO                                                         22270008
305000         :XLT00000-BUS-AREA-DESC                                  22280008
305100     FROM                                                         22290008
305300         XLT_BUS_AREA AREA                                        22300008
305400                                                                  22310008
305500     WHERE                                                        22320008
305700         AREA.BUS_AREA_ID    = :XLT00001-BUS-GP-NBR               22330013
305800     END-EXEC.                                                    22340008
305900                                                                  22350008
306000     EVALUATE TRUE                                                22360008
306100         WHEN SQLCODE = ZERO                                      22370008
306200              CONTINUE                                            22380008
306300         WHEN SQLCODE = +100                                      22390008
306400              MOVE 'UNKNOWN'  TO XLT00000-BUS-AREA-DESC           22400008
306500         WHEN SQLCODE = -904                                      22410008
306600         WHEN SQLCODE = -911                                      22420008
306700         WHEN SQLCODE = -913                                      22430008
306800             PERFORM 9900-SOFT-ABORT                              22440008
306900         WHEN SQLWARN0 NOT = SPACE                                22450008
307000         WHEN SQLCODE NOT = ZERO                                  22460008
307100              MOVE '4300D-BUS-AREA-NAME'                          22470008
307200                               TO DP013-PARAGRAPH                 22480008
307300              MOVE 'SELECT '                                      22490008
307400                               TO DP013-MESSAGE-TEXT (1)          22500008
307500              MOVE SQLCA       TO DP013-SQLCA                     22510008
307600              SET DP013-DB2-ABEND                                 22520008
307700                               TO TRUE                            22530008
307800              PERFORM DP013-0000-PROCESS-ABEND                    22540008
307900     END-EVALUATE.                                                22550008
308000*----------------------------------------------------------------*22560008
308100*    FETCH THE MESSAGE CURSOR.                                   *22570008
308200*----------------------------------------------------------------*22580008
308300                                                                  22590008
308400 4310-FETCH.                                                      22600008
308500                                                                  22610008
308600     EVALUATE TRUE                                                22620008
308700         WHEN ASC-DEPT-SEQ                                        22630008
308800              EXEC SQL                                            22640008
308900              FETCH GROUP-CSR                                     22650008
309000              INTO                                                22660008
309100                 :SUT00008-BUS-AREA-ID                            22670012
309200               , :SUT00008-UNT-QTY                                22680008
309300               , :SUT00008-SKU-QTY                                22690008
309400               , :SUT00008-CART-QTY                               22700008
309410               , :XLT00000-BUS-AREA-DESC                          22710018
309500              END-EXEC                                            22720008
309600         WHEN ASC-UNIT-SEQ                                        22730008
309700              EXEC SQL                                            22740008
309800              FETCH UNIT-CSR                                      22750008
309900              INTO                                                22760008
310000                 :SUT00008-BUS-AREA-ID                            22770012
310100               , :SUT00008-UNT-QTY                                22780008
310200               , :SUT00008-SKU-QTY                                22790008
310300               , :SUT00008-CART-QTY                               22800008
310310               , :XLT00000-BUS-AREA-DESC                          22810020
310400              END-EXEC                                            22820008
310500                                                                  22830008
310600     END-EVALUATE.                                                22840008
310700                                                                  22850008
310800     EVALUATE TRUE                                                22860008
310900         WHEN SQLCODE = ZERO                                      22870008
311000         WHEN SQLCODE = +100                                      22880008
311100              CONTINUE                                            22890008
311200         WHEN SQLCODE = -904                                      22900008
311300         WHEN SQLCODE = -911                                      22910008
311400         WHEN SQLCODE = -913                                      22920008
311500             PERFORM 9900-SOFT-ABORT                              22930008
311600         WHEN SQLWARN0 NOT = SPACE                                22940008
311700         WHEN SQLCODE NOT = ZERO                                  22950008
311800              MOVE '4310-FETCH-CURSOR'                            22960008
311900                               TO DP013-PARAGRAPH                 22970008
312000              MOVE 'FETCH MESSAGE CURSOR'                         22980008
312100                               TO DP013-MESSAGE-TEXT (1)          22990008
312200              MOVE SQLCA       TO DP013-SQLCA                     23000008
312300              SET DP013-DB2-ABEND                                 23010008
312400                               TO TRUE                            23020008
312500              PERFORM DP013-0000-PROCESS-ABEND                    23030008
312600     END-EVALUATE.                                                23040008
312700                                                                  23050008
312800     IF  SQLCODE EQUAL +100                                       23060008
312900         SET ASC-NO-ITEMS-LEFT-ON-DB                              23070008
313000                                   TO TRUE                        23080008
313100     END-IF.                                                      23090008
313200                                                                  23100008
313300 EJECT                                                            23110008
313400*----------------------------------------------------------------*23120008
313500* MOVE THE DISPLAYED FIELDS FROM THE COMMAREA TO THE SCREEN.     *23130008
313600*----------------------------------------------------------------*23140008
313700                                                                  23150008
313800 4400-MOVE-COMMAREA-TO-SCREEN.                                    23160008
313900     IF  (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1))             23170008
314000         AND (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1)))          23180008
314100         OR  (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)))          23190008
314200             MOVE +1    TO ASC-BLK-SUB                            23200008
314300             PERFORM 5100-WRITE-TEMP-STORAGE                      23210008
314400             ADD +1     TO ASC-BLK-SUB                            23220008
314500             PERFORM 5100-WRITE-TEMP-STORAGE                      23230008
314600             DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             23240008
314700                 GIVING PV-BLOCK-NUMBER                           23250008
314800                 REMAINDER PV-REMAINDER                           23260008
314900             IF  PV-REMAINDER > ZERO                              23270008
315000                 ADD +1 TO PV-BLOCK-NUMBER                        23280008
315100             END-IF                                               23290008
315200             MOVE +1    TO ASC-BLK-SUB                            23300008
315300             PERFORM 4410-READ-TEMP-STORAGE                       23310008
315400             ADD +1     TO ASC-BLK-SUB                            23320008
315500                           PV-BLOCK-NUMBER                        23330008
315600             PERFORM 4410-READ-TEMP-STORAGE                       23340008
315700     END-IF.                                                      23350008
315800     MOVE +1            TO ASC-BLK-SUB.                           23360008
315900     COMPUTE ASC-ITEM-SUB =                                       23370008
316000         ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              23380008
316100         + PC-ITEMS-PER-PANEL).                                   23390008
316200*                                                                 23400008
316300     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        23410008
316400         ADD +1         TO ASC-BLK-SUB                            23420008
316500         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            23430008
316600     END-IF.                                                      23440008
316700*                                                                 23450008
316800     COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           23460008
316900         ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                23470008
317000     PERFORM 4430-CHECK-FOR-BEGIN-AND-END.                        23480008
317100     PERFORM 4420-FORMAT-LIST-LINES                               23490008
317200         VARYING PV-SUB                                           23500008
317300         FROM PC-ITEMS-PER-PANEL BY -1                            23510008
317400         UNTIL PV-SUB < +1.                                       23520008
317500*                                                                 23530008
317600     COMPUTE ASC-ITEMS-DISPLAYED =                                23540008
317700         ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).          23550008
317800     MOVE PV-TOP-ITEM              TO ASC-ITEM-AT-TOP-OF-PANEL    23560008
317900                                      ASTRTITO.                   23570008
318000     MOVE ASC-ITEM-AT-BOT-OF-PANEL TO AENDITO.                    23580008
318100     MOVE ASC-NUMBER-OF-ITEMS-READ TO ATOTITO.                    23590008
318200     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            23600008
318300                                   TO ASELITO.                    23610008
318400*                                                                 23620008
318500     IF  DP020-MSG-NUMBER-X = SPACE                               23630008
318600         IF  ASC-ITEM-AT-BOT-OF-PANEL < ASC-NUMBER-OF-ITEMS-READ  23640008
318700*            --- MORE ITEMS TO DISPLAY ----                       23650008
318800             MOVE PC-TSYMSG-00279  TO DP020-MSG-NUMBER            23660008
318900             SET DP020-MSG-INFORMATIONAL TO TRUE                  23670008
319000         END-IF                                                   23680008
319100     END-IF.                                                      23690008
319200                                                                  23700008
319300     MOVE ASC-STR-NBR                 TO ASTOREO                  23710008
319400     MOVE ASC-STR-NAME                TO ASTNMEO.                 23720008
319500     MOVE ASC-SEQ-DESC                TO ASEQO.                   23730008
319600     MOVE ASC-SCAC                    TO ASCACO.                  23740008
319700     MOVE ASC-TRLR-SRL-NBR            TO ASERIALO                 23750008
319800     MOVE ASC-TRLR-ID                 TO ATRLRO.                  23760008
319900     MOVE ASC-TRIP-STAT-DESC          TO ASTATUSO.                23770008
320000     MOVE ASC-TOTAL-CARTONS           TO ACTNSO.                  23780008
320100     MOVE ASC-TOTAL-UNITS             TO AUNITSO.                 23790008
320110     MOVE ASC-PRINTER-DEST            TO APRTIDO.                 23800033
320200     MOVE ASC-SERVICE-DC-NAME         TO AOPERO                   23810008
320300     MOVE ASC-SUMMARY-DATE            TO ASUMDTEO.                23820008
320400     MOVE ASC-SUMMARY-TIME            TO ASUMTMEO.                23830008
320500                                                                  23840008
320600*----------------------------------------------------------------*23850008
320700*    READ A BLOCK FROM TEMPORARY STORAGE INTO THE ARRAY.         *23860008
320800*----------------------------------------------------------------*23870008
320900                                                                  23880008
321000 4410-READ-TEMP-STORAGE.                                          23890008
321100                                                                  23900008
321200     EXEC CICS                                                    23910008
321300         READQ TS                                                 23920008
321400             QUEUE (ASC-LIST-QUEUE-NAME)                          23930008
321500             INTO  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               23940008
321600             ITEM  (PV-BLOCK-NUMBER)                              23950008
321700             RESP  (PV-CICS-RESP)                                 23960008
321800     END-EXEC.                                                    23970008
321900                                                                  23980008
322000     IF  ((PV-CICS-RESP = DFHRESP (NORMAL))                       23990008
322100       OR (PV-CICS-RESP = DFHRESP (ITEMERR)))                     24000008
322200         CONTINUE                                                 24010008
322300     ELSE                                                         24020008
322400         SET DP013-CICS-ABEND     TO TRUE                         24030008
322500         SET DP013-NO-ROLLBACK    TO TRUE                         24040008
322600         MOVE '4410-READ-TEMP-STORAGE'                            24050008
322700                                  TO DP013-PARAGRAPH              24060008
322800         MOVE 'ERROR TRYING TO READ FROM TEMP STORAGE QUEUE'      24070008
322900                                  TO DP013-MESSAGE-TEXT(1)        24080008
323000         PERFORM DP013-0000-PROCESS-ABEND                         24090008
323100     END-IF.                                                      24100008
323200                                                                  24110008
323300     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             24120008
323400*                                                                 24130008
323500     IF  PV-CICS-RESP = DFHRESP (ITEMERR)                         24140008
323600         INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               24150008
323700     END-IF.                                                      24160008
323800 EJECT                                                            24170008
323900*----------------------------------------------------------------*24180008
324000*    PROCESS THE ITEMS IN THE ARRAY AND MOVE THEM TO THE MAP.    *24190008
324100*----------------------------------------------------------------*24200008
324200                                                                  24210008
324300 4420-FORMAT-LIST-LINES.                                          24220008
324400     IF  ASC-ITEM-AT-BOT-OF-PANEL > ASC-NUMBER-OF-ITEMS-READ      24230008
324500         SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                24240008
324600         MOVE DP015-ASK-DRK-OFF  TO MR-SELECTA (PV-SUB)           24250008
324700                                    MR-AREA-A (PV-SUB)            24260008
324800                                    MR-AREA-DESC-A (PV-SUB)       24270008
324900                                    MR-CARTONS-A (PV-SUB)         24280008
325000                                    MR-UNITS-A (PV-SUB)           24290008
325100                                    MR-SKU-COUNT-A (PV-SUB)       24300008
325200                                    MR-AD-A (PV-SUB)              24310008
325300         MOVE DP015-HL-OFF       TO MR-SELECTH (PV-SUB)           24320008
325400         MOVE SPACE              TO MR-SELECTI (PV-SUB)           24330008
325500                                    MR-ACTION (PV-SUB)            24340008
325600     ELSE                                                         24350008
325700         PERFORM 4420A-FILL-SCREEN                                24360008
325800*                                                                 24370008
325900         IF  DP030-SET-CURSOR-TRAILER                             24380008
326000             IF  ((ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)24390008
326100                 > SPACE)                                         24400008
326200               OR (PV-SUB = 1))                                   24410008
326300                SET DP030-SET-CURSOR-APPL-1 TO TRUE               24420008
326400                MOVE -1          TO MR-SELECTL (PV-SUB)           24430008
326500             END-IF                                               24440008
326600         END-IF                                                   24450008
326700*                                                                 24460008
326800         IF  PV-TOP-ITEM NOT = ASC-ITEM-AT-TOP-OF-PANEL           24470008
326900             MOVE ASC-ACTION (ASC-BLK-SUB ASC-ITEM-SUB)           24480008
327000                                 TO MR-ACTION (PV-SUB)            24490008
327100         END-IF                                                   24500008
327200     END-IF.                                                      24510008
327300     SUBTRACT +1 FROM ASC-ITEM-SUB                                24520008
327400     IF  ASC-ITEM-SUB < + 1                                       24530008
327500         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  24540008
327600         MOVE +1                 TO ASC-BLK-SUB                   24550008
327700     END-IF.                                                      24560008
327800                                                                  24570008
327900 4420A-FILL-SCREEN.                                               24580008
328000     IF  ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)          24590008
328100                                                   > SPACE        24600008
328200         MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     24610008
328300                                 TO MR-SELECTI (PV-SUB)           24620008
328400     ELSE                                                         24630008
328500         MOVE ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)          24640008
328600                                 TO MR-SELECTI (PV-SUB)           24650008
328700     END-IF                                                       24660008
328800                                                                  24670008
328900                                                                  24680008
329000     MOVE ASC-AREA(ASC-BLK-SUB ASC-ITEM-SUB)                      24690008
329100                                      TO MR-AREA (PV-SUB)         24700008
329200     MOVE ASC-AREA-DESC(ASC-BLK-SUB ASC-ITEM-SUB)                 24710008
329300                                      TO MR-AREA-DESC (PV-SUB)    24720008
329400                                                                  24730008
329500     MOVE ASC-CART-QTY(ASC-BLK-SUB ASC-ITEM-SUB)                  24740008
329600                                      TO MR-CARTONS(PV-SUB).      24750008
329700     MOVE ASC-UNT-QTY(ASC-BLK-SUB ASC-ITEM-SUB)                   24760008
329800                                      TO MR-UNITS(PV-SUB).        24770008
329900     MOVE ASC-SKU-COUNT(ASC-BLK-SUB ASC-ITEM-SUB)                 24780008
330000                                      TO MR-SKU-COUNT(PV-SUB).    24790008
330100     MOVE ASC-AD(ASC-BLK-SUB ASC-ITEM-SUB)                        24800008
330200                                      TO MR-AD(PV-SUB).           24810008
330300                                                                  24820008
330400                                                                  24830008
330500                                                                  24840008
330600******************************************************************24850008
330700** IF A BEGINNING OF RANGE WAS SPECIFIED, MAKE SURE AN END OF   **24860008
330800** RANGE WAS SPECIFIED AND VICE-VERSA.  IF ONE IS MISSING,      **24870008
330900** ISSUE A WARNING.                                             **24880008
331000******************************************************************24890008
331100 4430-CHECK-FOR-BEGIN-AND-END.                                    24900008
331200     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       24910008
331300         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     24920008
331400*            -- NO END-OF-RANGE SPECFIED ---                      24930008
331500             MOVE PC-TSYMSG-00051  TO DP020-MSG-NUMBER            24940008
331600             SET DP020-MSG-WARNING TO TRUE                        24950008
331700             PERFORM 4431-POSITION-AT-WARNING                     24960008
331800         END-IF                                                   24970008
331900     ELSE                                                         24980008
332000         IF  ASC-END-OF-SELECTED-RANGE > ZERO                     24990008
332100*            -- NO BEGINNING-OF-RANGE SPECFIED ---                25000008
332200             MOVE PC-TSYMSG-00053  TO DP020-MSG-NUMBER            25010008
332300             SET DP020-MSG-WARNING TO TRUE                        25020008
332400             PERFORM 4431-POSITION-AT-WARNING                     25030008
332500         END-IF                                                   25040008
332600     END-IF.                                                      25050008
332700******************************************************************25060008
332800** ONCE IT HAS BEEN DETERMINED THAT A WARNING IS TO BE ISSUED,  **25070008
332900** DETERMINE IF EITHER THE BEGINNING OF RANGE OR END OF RANGE   **25080008
333000** IS ON THE CURRENT SCREEN.  IF IT IS, HIGHLIGHT IT AND        **25090008
333100** POSITION THE CURSOR THERE.                                   **25100008
333200******************************************************************25110008
333300 4431-POSITION-AT-WARNING.                                        25120008
333400     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 25130008
333500                    - PV-TOP-ITEM + 1.                            25140008
333600     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      25150008
333700         CONTINUE                                                 25160008
333800     ELSE                                                         25170008
333900         SET DP030-SET-CURSOR-APPL-1                              25180008
334000                                   TO TRUE                        25190008
334100         MOVE -1                   TO MR-SELECTL (PV-SUB)         25200008
334200         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         25210008
334300         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         25220008
334400     END-IF.                                                      25230008
334500*                                                                 25240008
334600     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   25250008
334700                    - PV-TOP-ITEM + 1.                            25260008
334800     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      25270008
334900         CONTINUE                                                 25280008
335000     ELSE                                                         25290008
335100         SET DP030-SET-CURSOR-APPL-1                              25300008
335200                                   TO TRUE                        25310008
335300         MOVE -1                   TO MR-SELECTL (PV-SUB)         25320008
335400         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         25330008
335500         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         25340008
335600     END-IF.                                                      25350008
335700 EJECT                                                            25360008
335800*----------------------------------------------------------------*25370008
335900* PREPARE THE SELECTED ITEMS TEMP STORAGE QUEUE.  MOVE ALL SEL-  *25380008
336000* ECTED ITEMS FROM THE LIST TEMP STORAGE QUEUE TO THE LAYOUT     *25390008
336100* FOR THE SELECTED ITEMS QUEUE.                                  *25400008
336200*                                                                *25410008
336300* FIRST, DELETE THE SELECTION QUEUE, NEXT LOAD THE SELECTION     *25420008
336400* QUEUE RECORD.  FINALLY, WRITE THE SELECTION QUEUE ITEM WHEN    *25430008
336500* THE ARRAY IS FULL.                                             *25440008
336600*----------------------------------------------------------------*25450008
336700                                                                  25460008
336800 5000-PREPARE-SEL-QUEUE.                                          25470008
336900                                                                  25480008
337000     MOVE +1                   TO  ASC-BLK-SUB.                   25490008
337100     PERFORM 5100-WRITE-TEMP-STORAGE.                             25500008
337200     ADD +1                    TO  ASC-BLK-SUB.                   25510008
337300     PERFORM 5100-WRITE-TEMP-STORAGE.                             25520008
337400                                                                  25530008
337500     MOVE ASC-SEL-QUEUE-NAME-OUT   TO  SU012-SEL-QUEUE-NAME.      25540008
337600     PERFORM 6010-DELETE-SEL-QUEUE.                               25550008
337700                                                                  25560008
337800     SET ASC-UPDATE-TSQ        TO  TRUE.                          25570008
337900                                                                  25580008
338000     SET SU013-IDX             TO  1.                             25590008
338100     MOVE ZERO                 TO SU012-NUMBER-OF-TS-ITEMS.       25600008
338200     INITIALIZE SU013-SELECTED-ITEM-ARRAY.                        25610008
338300                                                                  25620008
338400     PERFORM 5200-FILL-SEL-QUEUE-RECORD                           25630008
338500             VARYING PV-ITEM                                      25640008
338600             FROM 1 BY 1                                          25650008
338700             UNTIL PV-ITEM GREATER ASC-HIGHEST-BLOCK-WRITTEN.     25660008
338800                                                                  25670008
338900     IF  SU013-IDX > 1                                            25680008
339000         PERFORM 5205-WRITE-SEL-QUEUE                             25690008
339100         ADD +1                TO SU012-NUMBER-OF-TS-ITEMS        25700008
339200     END-IF.                                                      25710008
339300 EJECT                                                            25720008
339400*----------------------------------------------------------------*25730008
339500*    WRITE A NEW BLOCK FROM THE ARRAY TO TEMPORARY STORAGE.      *25740008
339600*    REWRITE AN EXISITING BLOCK ONLY IF IT HAS BEEN MODIFIED.    *25750008
339700*----------------------------------------------------------------*25760008
339800                                                                  25770008
339900 5100-WRITE-TEMP-STORAGE.                                         25780008
340000     MOVE ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1)                     25790008
340100                                   TO PV-LIST-ITEM-NUMBER.        25800008
340200     COMPUTE PV-BLOCK-NUMBER =                                    25810008
340300         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    25820008
340400                                                                  25830008
340500     IF (PV-BLOCK-NUMBER < ASC-HIGHEST-BLOCK-WRITTEN)             25840008
340600     OR (PV-BLOCK-NUMBER = ASC-HIGHEST-BLOCK-WRITTEN)             25850008
340700         IF  ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                      25860008
340800             PERFORM 5105-REWRITE-ASC-LISTQ                       25870008
340900         END-IF                                                   25880008
341000     ELSE                                                         25890008
341100         COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                       25900008
341200         ASC-HIGHEST-BLOCK-WRITTEN + 1                            25910008
341300         PERFORM 5110-WRITE-ASC-LISTQ                             25920008
341400         ADD +1                    TO ASC-HIGHEST-BLOCK-WRITTEN   25930008
341500     END-IF.                                                      25940008
341600                                                                  25950008
341700     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             25960008
341800******************************************************************25970008
341900** REWRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-    **25980008
342000** SPECIFIC COMMAREA.                                           **25990008
342100******************************************************************26000008
342200 5105-REWRITE-ASC-LISTQ.                                          26010008
342300     EXEC CICS                                                    26020008
342400         WRITEQ TS                                                26030008
342500             QUEUE (ASC-LIST-QUEUE-NAME)                          26040008
342600             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               26050008
342700             ITEM  (PV-BLOCK-NUMBER)                              26060008
342800             REWRITE                                              26070008
342900             RESP  (PV-CICS-RESP)                                 26080008
343000     END-EXEC.                                                    26090008
343100                                                                  26100008
343200     IF  PV-CICS-RESP = DFHRESP(NORMAL)                           26110008
343300         CONTINUE                                                 26120008
343400     ELSE                                                         26130008
343500         SET DP013-CICS-ABEND            TO TRUE                  26140008
343600         SET DP013-NO-ROLLBACK           TO TRUE                  26150008
343700         MOVE '5105-REWRITE-ASC-LISTQ'   TO DP013-PARAGRAPH       26160008
343800         MOVE 'ATTEMPTING TO REWRITE LIST TEMP STORAGE QUEUE'     26170008
343900                                         TO DP013-MESSAGE-TEXT(1) 26180008
344000         PERFORM DP013-0000-PROCESS-ABEND                         26190008
344100     END-IF.                                                      26200008
344200                                                                  26210008
344300******************************************************************26220008
344400** WRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-      **26230008
344500** SPECIFIC COMMAREA.                                           **26240008
344600******************************************************************26250008
344700 5110-WRITE-ASC-LISTQ.                                            26260008
344800     EXEC CICS                                                    26270008
344900         WRITEQ TS                                                26280008
345000             QUEUE (ASC-LIST-QUEUE-NAME)                          26290008
345100             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               26300008
345200             ITEM  (PV-BLOCK-NUMBER)                              26310008
345300             RESP  (PV-CICS-RESP)                                 26320008
345400     END-EXEC.                                                    26330008
345500     IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      26340008
345600         SET DP013-CICS-ABEND      TO TRUE                        26350008
345700         SET DP013-NO-ROLLBACK     TO TRUE                        26360008
345800         MOVE '5110-WRITE-ASC-LISTQ'                              26370008
345900                                   TO DP013-PARAGRAPH             26380008
346000         MOVE 'ATTEMPTING TO DELETE TEMP STORAGE QUEUE'           26390008
346100                                   TO DP013-MESSAGE-TEXT(1)       26400008
346200         PERFORM DP013-0000-PROCESS-ABEND                         26410008
346300     END-IF.                                                      26420008
346400 EJECT                                                            26430008
346500*----------------------------------------------------------------*26440008
346600* READ A LIST QUEUE RECORD AND MOVE THE KEYS OF SELECTED OBJECTS *26450008
346700* TO THE SELECTED ITEMS TEMP STORAGE QUEUE RECORD.               *26460008
346800*----------------------------------------------------------------*26470008
346900                                                                  26480008
347000 5200-FILL-SEL-QUEUE-RECORD.                                      26490008
347100                                                                  26500008
347200     PERFORM 6112-READ-LIST-QUEUE.                                26510008
347300                                                                  26520008
347400     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       26530008
347500         PERFORM                                                  26540008
347600         VARYING LQW-IDX                                          26550008
347700         FROM 1 BY 1                                              26560008
347800         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            26570008
347900           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          26580008
348000                                                                  26590008
348100             IF  LQW-SELECT (LQW-IDX)                             26600008
348200                 MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)              26610008
348300                                   TO SU013-ITEM (SU013-IDX)      26620008
348400                 MOVE SPACE        TO SU013-ACTION-SW (SU013-IDX) 26630008
348500*              LOAD SELECTIONS TO SEL-QUEUE                       26640008
348600                 MOVE ASC-TRIP-OCRNC-ID  TO SU013-TRIP-OCRNC-ID   26650008
348700                                            (SU013-IDX)           26660008
348800                 MOVE LQW-AREA (LQW-IDX)                          26670008
348900                                      TO SU013-BUS-GP-NBR         26680013
349000                                         (SU013-IDX)              26690008
349100                 MOVE LQW-AD(LQW-IDX)                             26700008
349200                                      TO SU013-AD-MDSE-IND        26710008
349300                                         (SU013-IDX)              26720008
349400                 MOVE ASC-SCAC                                    26730008
349500                                      TO SU013-SCAC               26740008
349600                                         (SU013-IDX)              26750008
349700                 MOVE ASC-TRLR-ID                                 26760008
349800                                      TO SU013-TRLR-ID            26770008
349900                                         (SU013-IDX)              26780008
350000                 MOVE ASC-TOTAL-CARTONS                           26790008
350100                                      TO SU013-CARTON-CNT         26800008
350200                                         (SU013-IDX)              26810008
350300                 MOVE ASC-TOTAL-UNITS                             26820008
350400                                      TO SU013-UNIT-COUNT         26830008
350500                                         (SU013-IDX)              26840008
350600                 MOVE ASC-TRLR-SRL-NBR                            26850008
350700                                      TO SU013-TRLR-SRL-NBR       26860008
350800                                         (SU013-IDX)              26870008
350900                 MOVE ASC-SUMMARY-DATE                            26880008
351000                                      TO SU013-SUMMARY-DATE       26890008
351100                                         (SU013-IDX)              26900008
351200                 MOVE ASC-SUMMARY-TIME                            26910008
351300                                      TO SU013-SUMMARY-TIME       26920008
351400                                         (SU013-IDX)              26930008
351500                 MOVE ASC-TRIP-STAT-DESC                          26940008
351600                                      TO SU013-TRIP-STAT-DESC     26950008
351700                                         (SU013-IDX)              26960008
351800                                                                  26970008
351900                 SET SU013-IDX UP BY 1                            26980008
352000                 IF  SU013-IDX > SU013-MAX-ITEMS                  26990008
352100                     PERFORM 5205-WRITE-SEL-QUEUE                 27000008
352200                     ADD +1        TO SU012-NUMBER-OF-TS-ITEMS    27010008
352300                     INITIALIZE SU013-SELECTED-ITEM-ARRAY         27020008
352400                     SET SU013-IDX TO  1                          27030008
352500                 END-IF                                           27040008
352600             END-IF                                               27050008
352700         END-PERFORM                                              27060008
352800     END-IF.                                                      27070008
352900                                                                  27080008
353000*----------------------------------------------------------------*27090008
353100*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE.                *27100008
353200*----------------------------------------------------------------*27110008
353300                                                                  27120008
353400 5205-WRITE-SEL-QUEUE.                                            27130008
353500                                                                  27140008
353600     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            27150008
353700                                   TO SU013-SELECTED-ITEMS.       27160008
353800                                                                  27170008
353900     EXEC CICS                                                    27180008
354000          WRITEQ TS                                               27190008
354100              QUEUE (ASC-SEL-QUEUE-NAME-OUT)                      27200008
354200              FROM  (SU013-SELECT-RECORD)                         27210008
354300              ITEM  (PV-SEL-QUEUE-ITEM)                           27220008
354400              RESP  (PV-CICS-RESP)                                27230008
354500     END-EXEC.                                                    27240008
354600                                                                  27250008
354700     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          27260008
354800         CONTINUE                                                 27270008
354900     ELSE                                                         27280008
355000         SET DP013-CICS-ABEND      TO TRUE                        27290008
355100         SET DP013-NO-ROLLBACK     TO TRUE                        27300008
355200         MOVE '5205-WRITE-SEL-QUEUE'                              27310008
355300                                   TO DP013-PARAGRAPH             27320008
355400         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          27330008
355500                                   TO DP013-MESSAGE-TEXT(1)       27340008
355600         PERFORM DP013-0000-PROCESS-ABEND                         27350008
355700     END-IF.                                                      27360008
355800 EJECT                                                            27370008
355900******************************************************************27380008
356000** WHEN RETURNING TO THIS TRANSACTION FROM ANOTHER TRANSACTION, **27390008
356100** SETUP THE ARRAY AS IT WAS WHEN WE HAD LEFT PREVIOUSLY.  EDIT **27400008
356200** THE SELECTIONS MADE AT THAT TIME AND DISPLAY THE PANEL TO    **27410008
356300** THE USER.                                                    **27420008
356400******************************************************************27430008
356500 6000-REFRESH-PANEL-FROM-TEMP.                                    27440008
356600     IF  ASC-UPDATE-TSQ                                           27450008
356700         SET ASC-NO-TSQ-UPDATE TO TRUE                            27460008
356800         MOVE ZERO                 TO PV-SAVE-ITEM                27470008
356900                                      PV-SEL-QUEUE-ITEM           27480008
357000         MOVE ASC-NUMBER-OF-SELECTED-ITEMS                        27490008
357100                                   TO PV-HOLD-SELECTED-ITEMS      27500008
357200         MOVE +1                   TO PV-ITEMS-PROCESSED          27510008
357300         PERFORM 6100-UPDATE-TSQ                                  27520008
357400             UNTIL PV-ITEMS-PROCESSED >                           27530008
357500                                     PV-HOLD-SELECTED-ITEMS       27540008
357600         PERFORM 6010-DELETE-SEL-QUEUE                            27550008
357700         INITIALIZE ASC-BLOCK-ENTRIES (1)                         27560008
357800                    ASC-BLOCK-ENTRIES (2)                         27570008
357900     END-IF.                                                      27580008
358000                                                                  27590008
358100*----------------------------------------------------------------*27600008
358200*    DELETE THE SELECTED ITEMS TEMP STORAGE QUEUE.               *27610008
358300*----------------------------------------------------------------*27620008
358400 6010-DELETE-SEL-QUEUE.                                           27630008
358500                                                                  27640008
358600     EXEC CICS                                                    27650008
358700         DELETEQ TS                                               27660008
358800             QUEUE (ASC-SEL-QUEUE-NAME-OUT)                       27670008
358900             RESP  (PV-CICS-RESP)                                 27680008
359000     END-EXEC.                                                    27690008
359100*                                                                 27700008
359200     IF ((PV-CICS-RESP = DFHRESP(NORMAL)) OR                      27710008
359300        (PV-CICS-RESP = DFHRESP(QIDERR)))                         27720008
359400         CONTINUE                                                 27730008
359500     ELSE                                                         27740008
359600         SET DP013-CICS-ABEND TO TRUE                             27750008
359700         SET DP013-NO-ROLLBACK TO TRUE                            27760008
359800         MOVE '6010-DELETE-SEL-QUEUE'                             27770008
359900                        TO DP013-PARAGRAPH                        27780008
360000         MOVE 'ERROR TRYING TO DELETE SELECTION TS QUEUE'         27790008
360100                        TO DP013-MESSAGE-TEXT (1)                 27800008
360200         PERFORM DP013-0000-PROCESS-ABEND                         27810008
360300     END-IF.                                                      27820008
360400                                                                  27830008
360500*----------------------------------------------------------------*27840008
360600*    INCREMENT THE TSQ ITEM NUMBER AND READ THE LIST QUEUE.      *27850008
360700*    LOOP THROUGH THE LIST QUEUE TO OBTAIN THE LINE ITEM NUMBER  *27860008
360800*    TO BE USED TO UPDATE (DESELECT) THE CORRECT LINE ITEM IN    *27870008
360900*    THE TEMP QUEUE.                                             *27880008
361000*----------------------------------------------------------------*27890008
361100                                                                  27900008
361200 6100-UPDATE-TSQ.                                                 27910008
361300                                                                  27920008
361400     ADD 1                     TO  PV-SEL-QUEUE-ITEM.             27930008
361500     PERFORM 6105-READ-SEL-QUEUE.                                 27940008
361600     PERFORM                                                      27950008
361700         VARYING SU013-IDX                                        27960008
361800         FROM 1 BY 1                                              27970008
361900         UNTIL ((PV-ITEMS-PROCESSED >                             27980008
362000                              PV-HOLD-SELECTED-ITEMS)             27990008
362100         OR (SU013-IDX GREATER THAN SU013-MAX-ITEMS))             28000008
362200         IF  SU013-ACTION-SW (SU013-IDX) > SPACE                  28010008
362300             PERFORM 6110-PROCESS-ITEMS                           28020008
362400         END-IF                                                   28030008
362500         ADD +1                TO PV-ITEMS-PROCESSED              28040008
362600     END-PERFORM.                                                 28050008
362700     PERFORM 6111-WRITE-LIST-QUEUE.                               28060008
362800*----------------------------------------------------------------*28070008
362900*    READ THE LIST QUEUE RECORD.                                 *28080008
363000*----------------------------------------------------------------*28090008
363100                                                                  28100008
363200 6105-READ-SEL-QUEUE.                                             28110008
363300                                                                  28120008
363400     EXEC CICS                                                    28130008
363500          READQ TS                                                28140008
363600              QUEUE (ASC-SEL-QUEUE-NAME-OUT)                      28150008
363700              INTO  (SU013-SELECT-RECORD)                         28160008
363800              ITEM  (PV-SEL-QUEUE-ITEM)                           28170008
363900              RESP  (PV-CICS-RESP)                                28180008
364000     END-EXEC.                                                    28190008
364100*                                                                 28200008
364200     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          28210008
364300         CONTINUE                                                 28220008
364400     ELSE                                                         28230008
364500         SET DP013-CICS-ABEND      TO  TRUE                       28240008
364600         SET DP013-NO-ROLLBACK     TO  TRUE                       28250008
364700         MOVE '6105-READ-SEL-QUEUE'                               28260008
364800                                   TO  DP013-PARAGRAPH            28270008
364900         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           28280008
365000                                   TO  DP013-MESSAGE-TEXT(1)      28290008
365100         PERFORM DP013-0000-PROCESS-ABEND                         28300008
365200     END-IF.                                                      28310008
365300 EJECT                                                            28320008
365400*----------------------------------------------------------------*28330008
365500*    CALCULATE THE TEMP QUEUE ITEM THAT MUST BE READ AND READ IT.*28340008
365600*    REWRITE THE CURRENT TEMP QUEUE ITEM IF NECESSARY.  CALCULATE*28350008
365700*    THE LINE ITEM OCCURENCE AND UPDATE (DESELECT) IT.           *28360008
365800*----------------------------------------------------------------*28370008
365900                                                                  28380008
366000 6110-PROCESS-ITEMS.                                              28390008
366100                                                                  28400008
366200     COMPUTE PV-ITEM = 1 + ((SU013-ITEM (SU013-IDX) - 1)          28410008
366300                     / PC-ITEMS-PER-PANEL).                       28420008
366400                                                                  28430008
366500     IF  PV-ITEM NOT EQUAL PV-SAVE-ITEM                           28440008
366600         IF  PV-SAVE-ITEM NOT EQUAL ZERO                          28450008
366700             PERFORM 6111-WRITE-LIST-QUEUE                        28460008
366800         END-IF                                                   28470008
366900         MOVE PV-ITEM          TO PV-SAVE-ITEM                    28480008
367000                                                                  28490008
367100         PERFORM 6112-READ-LIST-QUEUE                             28500008
367200         IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)               28510008
367300             CONTINUE                                             28520008
367400         END-IF                                                   28530008
367500     END-IF.                                                      28540008
367600                                                                  28550008
367700     COMPUTE PV-SUB = (SU013-ITEM (SU013-IDX)                     28560008
367800                    - LQW-LIST-ITEM-NUMBER (1)) + 1.              28570008
367900     SET LQW-DESELECT (PV-SUB) TO    TRUE                         28580008
368000     MOVE LQW-SELECTED-SW (PV-SUB)                                28590008
368100                               TO LQW-TEMP-SELECTED-SW (PV-SUB).  28600008
368200     EVALUATE TRUE                                                28610008
368300         WHEN SU013-INQ (SU013-IDX)                               28620008
368400              MOVE PC-INQ      TO LQW-ACTION (PV-SUB)             28630008
368500                                                                  28640008
368600         WHEN SU013-UPD (SU013-IDX)                               28650008
368700              MOVE PC-UPD      TO LQW-ACTION (PV-SUB)             28660008
368800                                                                  28670008
368900         WHEN SU013-DEL (SU013-IDX)                               28680008
369000              MOVE PC-DEL      TO LQW-ACTION (PV-SUB)             28690008
369100                                                                  28700008
369200         WHEN SU013-ERR (SU013-IDX)                               28710008
369300              MOVE PC-ERR      TO LQW-ACTION (PV-SUB)             28720008
369400     END-EVALUATE.                                                28730008
369500                                                                  28740008
369600     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                28750008
369700                                                                  28760008
369800*----------------------------------------------------------------*28770008
369900*    WRITE THE TS QUEUE RECORD JUST UPDATED IN C600.             *28780008
370000*----------------------------------------------------------------*28790008
370100                                                                  28800008
370200 6111-WRITE-LIST-QUEUE.                                           28810008
370300                                                                  28820008
370400     EXEC CICS                                                    28830008
370500         WRITEQ TS                                                28840008
370600             QUEUE (ASC-LIST-QUEUE-NAME)                          28850008
370700             FROM  (LQW-LIST-QUEUE-WORK-AREA)                     28860008
370800             ITEM  (PV-SAVE-ITEM)                                 28870008
370900             REWRITE                                              28880008
371000             RESP  (PV-CICS-RESP)                                 28890008
371100     END-EXEC.                                                    28900008
371200*                                                                 28910008
371300     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          28920008
371400         CONTINUE                                                 28930008
371500     ELSE                                                         28940008
371600         SET DP013-CICS-ABEND  TO  TRUE                           28950008
371700         SET DP013-NO-ROLLBACK TO  TRUE                           28960008
371800         MOVE '6111-WRITE-LIST-QUEUE'                             28970008
371900                               TO  DP013-PARAGRAPH                28980008
372000         MOVE 'ATTEMPTING TO REWRITE LIST QUEUE'                  28990008
372100                               TO  DP013-MESSAGE-TEXT(1)          29000008
372200         PERFORM DP013-0000-PROCESS-ABEND                         29010008
372300     END-IF.                                                      29020008
372400                                                                  29030008
372500 EJECT                                                            29040008
372600*----------------------------------------------------------------*29050008
372700*    READ THE TEMPORARY STORAGE QUEUE INTO A TEMPORARY WORK AREA.*29060008
372800*----------------------------------------------------------------*29070008
372900                                                                  29080008
373000 6112-READ-LIST-QUEUE.                                            29090008
373100                                                                  29100008
373200     EXEC CICS                                                    29110008
373300         READQ TS                                                 29120008
373400             QUEUE (ASC-LIST-QUEUE-NAME)                          29130008
373500             INTO  (LQW-LIST-QUEUE-WORK-AREA)                     29140008
373600             ITEM  (PV-ITEM)                                      29150008
373700             RESP  (PV-CICS-RESP)                                 29160008
373800     END-EXEC.                                                    29170008
373900*                                                                 29180008
374000     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          29190008
374100         CONTINUE                                                 29200008
374200     ELSE                                                         29210008
374300         SET DP013-CICS-ABEND        TO TRUE                      29220008
374400         SET DP013-NO-ROLLBACK       TO TRUE                      29230008
374500         MOVE '6112-READ-LIST-QUEUE' TO DP013-PARAGRAPH           29240008
374600         MOVE 'ATTEMPTING TO READQ LIST QUEUE'                    29250008
374700                                     TO DP013-MESSAGE-TEXT(1)     29260008
374800         PERFORM DP013-0000-PROCESS-ABEND                         29270008
374900     END-IF.                                                      29280008
375000/                                                                 29290008
375100 7000-SELECT-SERVICING-DC.                                        29300008
375200                                                                  29310008
375300     EXEC SQL                                                     29320008
375400         SELECT  STR.LOC_NM                                       29330016
375500             ,   STR.LOC_NBR                                      29340016
375600         INTO                                                     29350008
375700                :XLT00010-LOC-NM                                  29360016
375800             ,  :XLT00010-LOC-NBR                                 29370016
375900         FROM  TSUOBTR OBTR                                       29380008
376000             , XLT_LOC STR                                        29390016
376100         WHERE OBTR.ORGN_OPER_UNT_ID  =   STR.LOC_NBR             29400016
376200         AND   OBTR.OTBND_TRIP_ID     =  :DK-OTBND-TRIP-ID        29410008
376300     END-EXEC.                                                    29420008
376400                                                                  29430008
376500     EVALUATE TRUE                                                29440008
376600         WHEN SQLCODE = ZERO                                      29450008
376700              MOVE XLT00010-LOC-NM    TO  ASC-SERVICE-DC-NAME     29460016
376800         WHEN SQLCODE = +100                                      29470008
376900              MOVE SPACES              TO XLT00010-LOC-NM         29480016
377000                                          ASC-SERVICE-DC-NAME     29490008
377100         WHEN SQLCODE = -904                                      29500008
377200         WHEN SQLCODE = -911                                      29510008
377300         WHEN SQLCODE = -913                                      29520008
377400             PERFORM 9900-SOFT-ABORT                              29530008
377500         WHEN SQLWARN0 NOT = SPACE                                29540008
377600         WHEN SQLCODE NOT = ZERO                                  29550008
377700              MOVE '7000-SELECT-SERVICING-DC'                     29560008
377800                               TO DP013-PARAGRAPH                 29570008
377900              MOVE 'SELECT'    TO DP013-MESSAGE-TEXT (1)          29580008
378000              MOVE SQLCA       TO DP013-SQLCA                     29590008
378100              SET DP013-DB2-ABEND TO TRUE                         29600016
378300              PERFORM DP013-0000-PROCESS-ABEND                    29610008
378400     END-EVALUATE.                                                29620008
378500                                                                  29630008
378600 7001-CONVERT-DATES.                                              29640008
378700                                                                  29650008
378800     MOVE SU013-SUMMARY-TIME (ASC-SEL-SUB)                        29660008
378900                                   TO PV-TIME                     29670008
379000     MOVE SU013-SUMMARY-DATE (ASC-SEL-SUB)                        29680008
379100                                   TO PV-DATE                     29690008
379200                                                                  29700008
379300     EXEC SQL                                                     29710008
379400      SELECT                                                      29720008
379500         CHAR ( DATE (:PV-DATE),USA)                              29730008
379600     ,   CHAR ( TIME (:PV-TIME),JIS)                              29740008
379700      INTO                                                        29750008
379800         :ASC-SUMMARY-DATE                                        29760008
379900     ,   :ASC-SUMMARY-TIME                                        29770008
380000     FROM SYSIBM.SYSDUMMY1                                        29780008
380100     END-EXEC.                                                    29790008
380200                                                                  29800008
380300     EVALUATE TRUE                                                29810008
380400         WHEN SQLCODE = ZERO                                      29820008
380500             CONTINUE                                             29830008
380600         WHEN SQLCODE = -180                                      29840008
380700              MOVE SPACES      TO ASC-SUMMARY-DATE                29850008
380800                                  ASC-SUMMARY-TIME                29860008
380900         WHEN SQLCODE = -904                                      29870008
381000         WHEN SQLCODE = -911                                      29880008
381100         WHEN SQLCODE = -913                                      29890008
381200             PERFORM 9900-SOFT-ABORT                              29900008
381300         WHEN SQLWARN0 NOT = SPACE                                29910008
381400         WHEN SQLCODE NOT = ZERO                                  29920008
381500              MOVE '7001-CONVERT-DATES'                           29930008
381600                               TO DP013-PARAGRAPH                 29940008
381700              MOVE 'SELECT'    TO DP013-MESSAGE-TEXT (1)          29950008
381800              MOVE SQLCA       TO DP013-SQLCA                     29960008
381900              SET DP013-DB2-ABEND                                 29970008
382000                               TO TRUE                            29980008
382100              PERFORM DP013-0000-PROCESS-ABEND                    29990008
382200     END-EVALUATE.                                                30000008
382300/                                                                 30010008
382310*----------------------------------------------------------------*30020021
382320*    START TRANID FOR SUKCS546 REPORT                             30030021
382330*----------------------------------------------------------------*30040021
382340 7100-START-TRANID-S546.                                          30050021
382350                                                                  30060021
382360     MOVE LENGTH OF SU083-COMM-AREA   TO PV-COMMAREA-LENGTH       30070021
382370                                                                  30080021
382380     EXEC CICS                                                    30090021
382390         START TRANSID ('S546')                                   30100021
382391         FROM     (SU083-COMM-AREA)                               30110021
382392         LENGTH   (PV-COMMAREA-LENGTH)                            30120021
382393     END-EXEC.                                                    30130021
382394/                                                                 30140021
382395*----------------------------------------------------------------*30150021
382400 9100-READ-SEL-QUEUE.                                             30160008
382500     EXEC CICS                                                    30170008
382600         READQ TS                                                 30180008
382700             QUEUE (ASC-SEL-QUEUE-NAME-IN)                        30190008
382800             INTO  (SU013-SELECT-RECORD)                          30200008
382900             ITEM  (ASC-SEL-ITEM)                                 30210008
383000             RESP  (PV-CICS-RESP)                                 30220008
383100     END-EXEC.                                                    30230008
383200                                                                  30240008
383300     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       30250008
383400         CONTINUE                                                 30260008
383500     ELSE                                                         30270008
383600         SET DP013-LOGIC-ABEND                                    30280008
383700             DP013-NO-ROLLBACK     TO TRUE                        30290008
383800         MOVE '9100-READ-SEL-QUEUE'                               30300008
383900                                   TO DP013-PARAGRAPH             30310008
384000         MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   30320008
384100                                   TO DP013-MESSAGE-TEXT (1)      30330008
384200         PERFORM DP013-0000-PROCESS-ABEND                         30340008
384300     END-IF.                                                      30350008
384400/                                                                 30360008
384500*-----------------------------------------------------------      30370008
384600* UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE.        30380008
384700*-----------------------------------------------------------      30390008
384800 9200-REWRITE-LIST-QUEUE.                                         30400008
384900           EXEC CICS                                              30410008
385000                WRITEQ TS                                         30420008
385100                    QUEUE  (ASC-SEL-QUEUE-NAME-IN)                30430008
385200                    FROM   (SU013-SELECT-RECORD)                  30440008
385300                    ITEM   (ASC-SEL-ITEM)                         30450008
385400                    RESP   (PV-CICS-RESP)                         30460008
385500                    REWRITE                                       30470008
385600           END-EXEC.                                              30480008
385700                                                                  30490008
385800     IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                   30500008
385900         SET DP013-CICS-ABEND                                     30510008
386000             DP013-NO-ROLLBACK     TO TRUE                        30520008
386100         MOVE '9200-REWRITE-LIST-QUEUE'                           30530008
386200                                         TO DP013-PARAGRAPH       30540008
386300         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   30550008
386400                                         TO DP013-MESSAGE-TEXT (1)30560008
386500         PERFORM DP013-0000-PROCESS-ABEND                         30570008
386600     END-IF.                                                      30580008
386700                                                                  30590008
386800 9900-SOFT-ABORT.                                                 30600008
386900     SET PS-ERROR         TO TRUE.                                30610008
387000     SET DP020-MSG-FATAL  TO TRUE.                                30620008
387100     MOVE 'THROUGH SOFT-ABORT PARA'                               30630008
387200                            TO DP013-MESSAGE-TEXT (1)             30640008
387300     MOVE PC-TSYMSG-00551 TO DP020-MSG-NUMBER.                    30650008
387400     IF PS-NO-NEXT-SCREEN                                         30660008
387500         SET DP020-NEXT-ACT-APPL-ERROR TO TRUE                    30670008
387600     END-IF.                                                      30680008
387700                                                                  30690008
387800     MOVE 'PROGRAM EXIT CALL' TO DP013-MESSAGE-TEXT (1).          30700008
387900     PERFORM 0001-CALL-CICS-ARCH-API.                             30710008
388000                                                                  30720008
388100 EJECT                                                            30730008
388200*----------------------------------------------------------------*30740008
388300*    ABEND PROCESSOR MODULE                                      *30750008
388400*----------------------------------------------------------------*30760008
388500                                                                  30770008
388600     COPY DPPD013.                                                30780016
