000100**  N O T E ***                                                   00010000
000200**  THIS VERSION CONTAINS DC ON CHANGES THAT WE WANT TO WAIT TO   00020000
000300**  MOVE TO QA UNTIL AFTER INITIAL IMPLEMENTATION.  IF CHANGES ARE00030000
000400**  NEEDED FOR DC OFF, RENAME THIS VERSION AND PULL QA VERIONS    00040000
000500**  MAKE CHANGES TO BOTH VERSIONS AND THEN PUT THIS VERSION BACK  00050000
000600**  TO TEST WHEN DONE.                                            00060000
000700**  N O T E ***                                                   00070000
000800 IDENTIFICATION DIVISION.                                         00080000
000900 PROGRAM-ID.    RCKCS297.                                         00090000
001000 AUTHOR.        DENNIS STEFFEN - OMNI RESOURCES.                  00100000
001100 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00110000
001200 DATE-WRITTEN.  JULY  1998.                                       00120000
001300 DATE-COMPILED.                                                   00130000
001400                                                                  00140000
001500*---------------------------------------------------------------* 00150000
001600*    E297 - CONFIRMATION LINE LIST                                00160000
001700*                                                                 00170000
001800*    THIS PROGRAM GENERATES A LIST LINES FOR A GIVEN PO/REVEIVER. 00180000
001900*    THE USER WILL BE ABLE TO CONFIRM THE NUMBER OF UNITS THAT    00190000
002000*    PROCESSED AS FULLCASE.  THEY WILL ALSO BE ABLE TO 'UNCONFIRM'00200000
002100*    THE LINE UNDER CERTAIN CONDITIONS.                           00210000
002101*                                                                 00210136
002110*  CHANGED 10/20/14 BY CHERI PARMLEY       CHG#0094571            00211035
002120*   EXPAND PO FROM 7 TO 8 DIGITS                                  00212035
002200*---------------------------------------------------------------* 00220000
002220* CHANGED 11/11/2021    BY JIM HUNTER      WR: CHG0263784         00222036
002230* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00223036
002240* MAKING THE CALL DYNAMIC VS STATIC.                              00224036
002250*---------------------------------------------------------------* 00225036
002300                                                                  00230000
002400 ENVIRONMENT DIVISION.                                            00240000
002500 DATA DIVISION.                                                   00250000
002600/                                                                 00260000
002700 WORKING-STORAGE SECTION.                                         00270000
002800                                                                  00280000
002900 01  DK-DB2-KEYS.                                                 00290000
003000     05  DK-OPER-UNT-ID               PIC S9(04) COMP.            00300000
003100     05  DK-FCLTY-ID                  PIC S9(04) COMP.            00310000
003200     05  DK-ORD-NBR                   PIC S9(09) COMP.            00320000
003300     05  DK-RCVR-NBR                  PIC S9(09) COMP.            00330000
003400     05  DK-LINE-NBR                  PIC S9(09) COMP.            00340000
003500     05  DK-LINE-LO                   PIC S9(09) COMP.            00350000
003600     05  DK-LINE-HI                   PIC S9(09) COMP.            00360000
003700     05  DK-STR-NBR                   PIC S9(04) COMP.            00370000
003800     05  DK-PREPK-ID                  PIC S9(04) COMP.            00380000
003900     05  DK-PK-SKU-NBR                PIC  S9(8)V COMP-3.         00390000
004000                                                                  00400000
004100 01  PC-PROGRAM-CONSTANTS.                                        00410000
004200     05  PC-CURRENT-MAP-NAME          PIC X(08) VALUE 'RC297A  '. 00420000
004300     05  PC-CURRENT-MAPSET-NAME       PIC X(08) VALUE 'RCKM297 '. 00430000
004400     05  PC-CURRENT-PROGRAM-NAME      PIC X(08) VALUE 'RCKCS297'. 00440000
004500     05  PC-CONFIRM-AT-ZERO           PIC X(08) VALUE 'RCK297V0'. 00450000
004600     05  PC-UNTS-WRKD-PGRM-NAME       PIC X(08) VALUE 'PCKCS756'. 00460000
004700                                                                  00470000
004800     05  PC-VERIFICATION-MODULE       PIC X(08) VALUE 'RCKUT124'. 00480000
004900     05  PC-FKEY-MODULE               PIC X(08) VALUE 'RCKUT126'. 00490000
005000     05  PC-AUTO-VE-MODULE            PIC X(08) VALUE 'RCKUT127'. 00500000
005100     05  PC-FKEY-MODULE-LENGTH        PIC S9(04) VALUE  +400      00510000
005200                                                    COMP SYNC.    00520000
005300     05  PC-LIST-QUEUE-SEQ            PIC 9(01)  VALUE 1.         00530000
005400     05  PC-SEL-QUEUE-SEQ             PIC 9(01)  VALUE 2.         00540000
005500     05  PC-ITEMS-PER-PANEL           PIC S9(04)  VALUE +12       00550000
005600                                                    COMP SYNC.    00560000
005700     05  PC-MAX-BLOCKS-IN-ARRAY       PIC S9(04)  VALUE +2        00570000
005800                                                    COMP SYNC.    00580000
005900     05  PC-MAX-ITEMS                 PIC S9(09)  VALUE           00590000
006000                                                    +1000000      00600000
006100                                                    COMP-3.       00610000
006200     05  PC-MSG-NUMBER-LENGTH         PIC S9(04)  VALUE +7        00620000
006300                                                    COMP SYNC.    00630000
006400     05  PC-COMMAREA-LENGTH           PIC S9(04)  VALUE +0        00640000
006500                                                     COMP SYNC.   00650000
006600     05  PC-INQ                       PIC X(03)  VALUE 'INQ'.     00660000
006700     05  PC-UPD                       PIC X(03)  VALUE 'UPD'.     00670000
006800     05  PC-DEL                       PIC X(03)  VALUE 'DEL'.     00680000
006900     05  PC-ERR                       PIC X(03)  VALUE 'ERR'.     00690000
007000     05  PC-SPACES                    PIC X(22)  VALUE SPACES.    00700000
007100     05  PC-01                        PIC X(02)  VALUE '01'.      00710000
007200     05  PC-M                         PIC X(01)  VALUE 'M'.       00720000
007300     05  PC-N                         PIC X(01)  VALUE 'N'.       00730000
007400     05  PC-DISPLAY-PO                PIC 9(8)   VALUE ZEROS.     00740000
007500     05  PC-DISPLAY-RCVR              PIC 9(8)   VALUE ZEROS.     00750000
007600     05  PC-DISPLAY-LINE              PIC 9(8)   VALUE ZEROS.     00760000
007700     05  PC-DISPLAY-OPER              PIC 9(4)   VALUE ZEROS.     00770000
007800     05  PC-DISPLAY-SQL-CODE          PIC 9999-  VALUE ZEROS.     00780000
007900     05  PC-DISPLAY-CICS-RESP         PIC 999999999-              00790000
008000                                                 VALUE ZEROS.     00800000
008100                                                                  00810000
008200*----------------------------------------------------------------*00820000
008300*  SYSTEM MESSAGES                                               *00830000
008400*----------------------------------------------------------------*00840000
008500*   00005 = INVALID VALUE                                         00850000
008600*   00007 - REQUIRED ENTRY                                        00860000
008700*   00008 = MUST BE NUMERIC                                       00870000
008800*   00050 = NO LIST ITEMS WERE FOUND FOR THE CRITERIA SPECIFIED   00880000
008900*   00051 = NO END OF RANGE HAS BEEN SPECIFIED                    00890000
009000*   00052 = END OF RANGE PRECEDES START OF RANGE                  00900000
009100*   00053 = NO START OF RANGE HAS BEEN SPECIFIED                  00910000
009200*   00054 = ONLY ONE START OF RANGE INDICATOR MAY BE SPECIFIED    00920000
009300*   00055 = ONLY ONE END OF RANGE INDICATOR MAY BE SPECIFIED      00930000
009400*   00057 = A LIST ITEM MUST BE SELECTED FOR THIS FUNCTION        00940000
009500*   00059 = UPDATE(S) SUCCESSFUL                                  00950000
009600*   00069 = TOP OF LIST                                           00960000
009700*   00070 = BOTTOM OF LIST                                        00970000
009800*   00101 = VALUE MUST BE GREATER THAN ZERO AND LESS THAN 1,000,0000980000
009900*   00254 = ERRORS OCCURRED; NO UPDATE PERFORMED                  00990000
010000*   00279 = MORE ITEMS TO DISPLAY                                 01000000
010100*   00551 = WAIT 15 SECONDS;RETRY FUNCTION AGAIN; IF UNSUCCESSFUL 01010000
010200*   00929 = RECEIPT LINE HAS ALREADY BEEN VERIFIED                01020000
010300*   00966 = INVALID FUNCTION FOR RECEIVER/RECEIPT ITEM STATUS     01030000
010400*   00984 = DATABASE IS BUSY, TRY AGAIN IN A FEW MINUTES          01040000
010500*   01110 = YOUR UPDATE REQUEST HAS BEEN SUBMITTED                01050000
010600*   01169 = UPDATE NOT PERFORMED - NO VALUES WERE CHANGED         01060000
010700*   01761 = SELECTED ITEMS WILL BE UNCONFIRMED - F2 TO PERFORM    01070000
010800*   01762 = THERE ARE NO FULLCASE PIECES TO CONFIRM               01080000
010900*   01763 = FULLCASE UNITS MUST BE CONFIRMED TO PERFORM THIS      01090000
011000*   01779 = CONFIRMATION COMPLETED - VERIFY REQUEST HAS BEEN SUB  01100000
011100*   01804 = CONFIRMATION COMPLETED                                01110000
011200*   01806 = UNABLE TO SUBMIT VERIFY DUE TO RCVR LEVEL TROUBLE     01120000
011300*   01809 = LINE HAS ALREADY BEEN CONFIRMED                       01130000
011400*   01810 = VERIFIED ONLY ALLOWED WHEN ALL PROCESSES ARE COMPLETED01140000
011500*   01811 = UNABLE TO VERIFY, P2L PROCESSING HAS NOT BEEN COMPLETE01150000
011600*   01856 = HAVE STORE UNITS BEEN ADJUSTED?  F2 TO CONFIRM OR F22 01160000
011700*   01875 = LINE(S) WILL BE CONFIRMED TO A QUANTITY OF 0 - F2 TO  01170000
011800*   01876 = LINE(S) WILL BE VERIFIED TO A QUANTITY OF 0 - F2 TO   01180000
011900*   02449 = ONLY ONE LINE CAN BE SELECTED FOR PREPACK DTL LIST   *01190000
012000*   02457 = PRE-PACK CONTAINS NON-UPDATED ODD UNITS - F2 TO CONTIN01200000
012100*   02483 = BAD RATIO STATUS, USE VERFICATION SCREENS TO VERIFY TH01210000
012200*   02875 = PROBLEM ENCOUNTED WITH UNITS WORKED PROCESSING - CONTA01220000
012300*   03135 = YOU DO NOT HAVE THE AUTHORITY TO PERFORM MANUAL CONFIR01230000
012400*   03136 = YOU DO NOT HAVE THE AUTHORITY TO PERFORM MANUAL CONFIR01240000
012500*   03137 = YOU DO NOT HAVE THE AUTHORITY TO UPDATE CONFIRMATION U01250000
012600*   03138 = AN ERROR OCCURRED DETERMINING F-KEY ELIGIBILITY - CONT01260000
012700*   03304 = AUTOVE PO - CANNOT CONFIRM @ ZERO                     01270000
012800*   99901 = INVALID COMMAND WAS ENTERED                           01280000
012900*----------------------------------------------------------------*01290000
013000     05  PC-TSYMSG-NUMBERS.                                       01300000
013100         10  PC-TSYMSG-00005          PIC 9(05)  VALUE 00005.     01310000
013200         10  PC-TSYMSG-00007          PIC 9(05)  VALUE 00007.     01320000
013300         10  PC-TSYMSG-00008          PIC 9(05)  VALUE 00008.     01330000
013400         10  PC-TSYMSG-00050          PIC 9(05)  VALUE 00050.     01340000
013500         10  PC-TSYMSG-00051          PIC 9(05)  VALUE 00051.     01350000
013600         10  PC-TSYMSG-00052          PIC 9(05)  VALUE 00052.     01360000
013700         10  PC-TSYMSG-00053          PIC 9(05)  VALUE 00053.     01370000
013800         10  PC-TSYMSG-00054          PIC 9(05)  VALUE 00054.     01380000
013900         10  PC-TSYMSG-00055          PIC 9(05)  VALUE 00055.     01390000
014000         10  PC-TSYMSG-00057          PIC 9(05)  VALUE 00057.     01400000
014100         10  PC-TSYMSG-00059          PIC 9(05)  VALUE 00059.     01410000
014200         10  PC-TSYMSG-00069          PIC 9(05)  VALUE 00069.     01420000
014300         10  PC-TSYMSG-00070          PIC 9(05)  VALUE 00070.     01430000
014400         10  PC-TSYMSG-00101          PIC 9(05)  VALUE 00101.     01440000
014500         10  PC-TSYMSG-00254          PIC 9(05)  VALUE 00254.     01450000
014600         10  PC-TSYMSG-00279          PIC 9(05)  VALUE 00279.     01460000
014700         10  PC-TSYMSG-00551          PIC 9(05)  VALUE 00551.     01470000
014800         10  PC-TSYMSG-00929          PIC 9(05)  VALUE 00929.     01480000
014900         10  PC-TSYMSG-00966          PIC 9(05)  VALUE 00966.     01490000
015000         10  PC-TSYMSG-00984          PIC 9(05)  VALUE 00984.     01500000
015100         10  PC-TSYMSG-01110          PIC 9(05)  VALUE 01110.     01510000
015200         10  PC-TSYMSG-01169          PIC 9(05)  VALUE 01169.     01520000
015300         10  PC-TSYMSG-01298          PIC 9(05)  VALUE 01298.     01530000
015400         10  PC-TSYMSG-01730          PIC 9(05)  VALUE 01730.     01540000
015500         10  PC-TSYMSG-01761          PIC 9(05)  VALUE 01761.     01550000
015600         10  PC-TSYMSG-01762          PIC 9(05)  VALUE 01762.     01560000
015700         10  PC-TSYMSG-01763          PIC 9(05)  VALUE 01763.     01570000
015800         10  PC-TSYMSG-01779          PIC 9(05)  VALUE 01779.     01580000
015900         10  PC-TSYMSG-01804          PIC 9(05)  VALUE 01804.     01590000
016000         10  PC-TSYMSG-01806          PIC 9(05)  VALUE 01806.     01600000
016100         10  PC-TSYMSG-01809          PIC 9(05)  VALUE 01809.     01610000
016200         10  PC-TSYMSG-01810          PIC 9(05)  VALUE 01810.     01620000
016300         10  PC-TSYMSG-01811          PIC 9(05)  VALUE 01811.     01630000
016400         10  PC-TSYMSG-01856          PIC 9(05)  VALUE 01856.     01640000
016500         10  PC-TSYMSG-01875          PIC 9(05)  VALUE 01875.     01650000
016600         10  PC-TSYMSG-01876          PIC 9(05)  VALUE 01876.     01660000
016700         10  PC-TSYMSG-02185          PIC 9(05)  VALUE 02185.     01670000
016800         10  PC-TSYMSG-02449          PIC 9(05)  VALUE 02449.     01680000
016900         10  PC-TSYMSG-02457          PIC 9(05)  VALUE 02457.     01690000
017000         10  PC-TSYMSG-02483          PIC 9(05)  VALUE 02483.     01700000
017100         10  PC-TSYMSG-02875          PIC 9(05)  VALUE 02875.     01710000
017200         10  PC-TSYMSG-03135          PIC 9(05)  VALUE 03135.     01720000
017300         10  PC-TSYMSG-03136          PIC 9(05)  VALUE 03136.     01730000
017400         10  PC-TSYMSG-03137          PIC 9(05)  VALUE 03137.     01740000
017500         10  PC-TSYMSG-03138          PIC 9(05)  VALUE 03138.     01750000
017600         10  PC-TSYMSG-03275          PIC 9(05)  VALUE 03275.     01760000
017700         10  PC-TSYMSG-03304          PIC 9(05)  VALUE 03304.     01770000
017800         10  PC-TSYMSG-99901          PIC 9(05)  VALUE 99901.     01780000
017900     05  PC-DEFAULT-TMST              PIC X(26)  VALUE            01790000
018000                     '9999-09-09-09.09.09.999999'.                01800000
018100     05  PC-DEFAULT-DATE              PIC X(10)  VALUE            01810000
018200                     '09/09/9999'.                                01820000
018300*----------------------------------------------------------------*01830000
018400* INCLUDED PROGRAM CONSTANTS PC-000 AND PC-999.      WR # 21361  *01840000
018500*----------------------------------------------------------------*01850000
018600     05  PC-000                       PIC X(03) VALUE '000'.      01860000
018700     05  PC-999                       PIC X(03) VALUE '999'.      01870000
018800*----------------------------------------------------------------*01880000
018900* CHANGES MADE FOR WR # 21361 ENDS HERE.                         *01890000
019000*----------------------------------------------------------------*01900000
019100                                                                  01910000
019200 01  PS-PROGRAM-SWITCHES.                                         01920000
019300     05  PS-ERROR-SW                  PIC X(01)  VALUE 'Y'.       01930000
019400         88  PS-NO-ERROR                         VALUE 'Y'.       01940000
019500         88  PS-ERROR                            VALUE 'N'.       01950000
019600     05  PS-ARRIVED-SW                PIC X(01)  VALUE 'Y'.       01960000
019700         88  PS-ARRIVED                          VALUE 'Y'.       01970000
019800         88  PS-NOT-ARRIVED                      VALUE 'N'.       01980000
019900     05  PS-COMMAREA-SW               PIC X(01)  VALUE 'N'.       01990000
020000         88  PS-COMMAREA-VALID                   VALUE 'Y'.       02000000
020100         88  PS-COMMAREA-NOT-VALID               VALUE 'N'.       02010000
020200     05  PS-NEXT-SCREEN-SW            PIC X(01)  VALUE 'N'.       02020000
020300         88  PS-NO-NEXT-SCREEN                   VALUE 'N'.       02030000
020400         88  PS-NEXT-SCREEN                      VALUE 'Y'.       02040000
020500     05  PS-EOF-INVPAR-CSR-SW         PIC X(01)  VALUE 'N'.       02050000
020600         88   PS-NOT-EOF-INVPAR-CSR              VALUE 'N'.       02060000
020700         88   PS-EOF-INVPAR-CSR                  VALUE 'Y'.       02070000
020800     05  PS-EOF-TDISTDT-CSR-SW        PIC X(01)  VALUE 'N'.       02080000
020900         88  PS-NOT-EOF-TDISTDT-CSR              VALUE 'N'.       02090000
021000         88  PS-EOF-TDISTDT-CSR                  VALUE 'Y'.       02100000
021100     05  PS-EOF-STR-CSR-SW            PIC X(01)  VALUE 'N'.       02110000
021200         88  PS-NOT-EOF-STR-CSR                  VALUE 'N'.       02120000
021300         88  PS-EOF-STR-CSR                      VALUE 'Y'.       02130000
021400     05  PS-PO-RCVR-FOUND-SW          PIC X(01)  VALUE 'N'.       02140000
021500         88  PS-PO-RCVR-FOUND                    VALUE 'Y'.       02150000
021600         88  PS-PO-RCVR-NOT-FOUND                VALUE 'N'.       02160000
021700     05  PS-PROCESS-QTY-ZERO-SW       PIC X(01)  VALUE 'N'.       02170000
021800         88  PS-PROCESS-QTY-ZERO                 VALUE 'Y'.       02180000
021900         88  PS-PROCESS-QTY-NOT-ZERO             VALUE 'N'.       02190000
022000     05  PS-MORE-RECITM-SW            PIC X(01)  VALUE 'N'.       02200000
022100         88  PS-MORE-RECITM-YES                  VALUE 'Y'.       02210000
022200         88  PS-MORE-RECITM-NO                   VALUE 'N'.       02220000
022300     05  PS-RECITM-ODD-UNITS-SW       PIC X(01)  VALUE 'N'.       02230000
022400         88  PS-RECITM-ODD-UNITS-YES             VALUE 'Y'.       02240000
022500         88  PS-RECITM-ODD-UNITS-NO              VALUE 'N'.       02250000
022600     05  PS-DISTDT-ODD-UNITS-SW       PIC X(01)  VALUE 'N'.       02260000
022700         88  PS-DISTDT-ODD-UNITS-YES             VALUE 'Y'.       02270000
022800         88  PS-DISTDT-ODD-UNITS-NO              VALUE 'N'.       02280000
022900     05  PS-UNITS-WORKED-ERROR-SW     PIC X(01)  VALUE 'N'.       02290000
023000         88  PS-UNITS-WORKED-ERROR               VALUE 'Y'.       02300000
023100         88  PS-NO-UNITS-WORKED-ERROR            VALUE 'N'.       02310000
023200     05  PS-FUNTION-RACF-SW           PIC X(01)  VALUE 'N'.       02320000
023300         88  PS-FUNCTION-RACF-YES                VALUE 'Y'.       02330000
023400         88  PS-FUNCTION-RACF-NO                 VALUE 'N'.       02340000
023410     05  PS-DC-FLUSH-SW              PIC  X(01)  VALUE  'Y'.      02341028
023420         88  PS-DC-FLUSH-YES                     VALUE  'Y'.      02342025
023430         88  PS-DC-FLUSH-NO                      VALUE  'N'.      02343025
023500                                                                  02350000
023600*  LINE LEVEL SWITCHES                                            02360000
023700     05  PS-MATCH-ERROR-SW            PIC X(01)  VALUE 'N'.       02370000
023800         88  PS-NO-MATCH-ERROR                   VALUE 'N'.       02380000
023900         88  PS-MATCH-ERROR                      VALUE 'Y'.       02390000
024000     05  PS-FREIGHT-ERROR-SW          PIC X(01)  VALUE SPACE.     02400000
024100         88  PS-FREIGHT-NOT-CHECKED              VALUE SPACE.     02410000
024200         88  PS-NO-FREIGHT-ERROR                 VALUE 'N'.       02420000
024300         88  PS-FREIGHT-ERROR                    VALUE 'Y'.       02430000
024400     05  PS-TROUBLE-ERROR-SW          PIC X(01)  VALUE SPACE.     02440000
024500         88  PS-TROUBLE-NOT-CHECKED              VALUE SPACE.     02450000
024600         88  PS-NO-TROUBLE-ERROR                 VALUE 'N'.       02460000
024700         88  PS-TROUBLE-ERROR                    VALUE 'Y'.       02470000
024800     05  PS-INVENTORY-ERROR-SW        PIC X(01)  VALUE 'N'.       02480000
024900         88  PS-NO-INVENTORY-ERROR               VALUE 'N'.       02490000
025000         88  PS-INVENTORY-ERROR                  VALUE 'Y'.       02500000
025100     05  PS-VERIFY-MODULE-SW          PIC X(01)  VALUE 'N'.       02510000
025200         88  PS-DONT-SUBMIT-E200                 VALUE 'N'.       02520000
025300         88  PS-DO-SUBMIT-E200                   VALUE 'Y'.       02530000
025400     05  PS-PACK-LNE-VERIFIED-SW      PIC X(01)  VALUE 'N'.       02540010
025500         88  PS-PACK-LNE-VERIFIED-YES            VALUE 'Y'.       02550010
025600         88  PS-PACK-LNE-VERIFIED-NO             VALUE 'N'.       02560010
025700                                                                  02570000
025800*  RECEIVER LEVEL SWITCHES                                        02580000
025900     05  PS-RCVR-MATCH-ERROR-SW       PIC X(01)  VALUE 'N'.       02590000
026000         88  PS-RCVR-NO-MATCH-ERROR              VALUE 'N'.       02600000
026100         88  PS-RCVR-MATCH-ERROR                 VALUE 'Y'.       02610000
026200     05  PS-RCVR-FREIGHT-ERROR-SW     PIC X(01)  VALUE 'N'.       02620000
026300         88  PS-RCVR-NO-FREIGHT-ERROR            VALUE 'N'.       02630000
026400         88  PS-RCVR-FREIGHT-ERROR               VALUE 'Y'.       02640000
026500     05  PS-RCVR-TROUBLE-ERROR-SW     PIC X(01)  VALUE 'N'.       02650000
026600         88  PS-RCVR-NO-TROUBLE-ERROR            VALUE 'N'.       02660000
026700         88  PS-RCVR-TROUBLE-ERROR               VALUE 'Y'.       02670000
026800     05  PS-RCVR-INVENTORY-ERROR-SW   PIC X(01)  VALUE 'N'.       02680000
026900         88  PS-RCVR-NO-INVENTORY-ERROR          VALUE 'N'.       02690000
027000         88  PS-RCVR-INVENTORY-ERROR             VALUE 'Y'.       02700000
027100     05  PS-STORE-INVENTORY-SW        PIC X(01)  VALUE 'N'.       02710000
027200         88  PS-STORE-INVENTORY-POSSIBLE         VALUE 'Y'.       02720000
027300         88  PS-NO-STORE-INVENTORY               VALUE 'N'.       02730000
027400                                                                  02740000
027500*----------------------------------------------------------------*02750000
027600*  INCLUDED PROGRAM SWITCHES FOR XLKUT001       **   WR # 21361  *02760000
027700*----------------------------------------------------------------*02770000
027800     05  PS-CALL-API-SW               PIC  X    VALUE 'N'.        02780000
027900         88  PS-CALL-API-NO                     VALUE 'N'.        02790000
028000         88  PS-CALL-API-YES                    VALUE 'Y'.        02800000
028100*----------------------------------------------------------------*02810000
028200* CHANGES MADE FOR WR # 21361 ENDS HERE.                         *02820000
028300*----------------------------------------------------------------*02830000
028400                                                                  02840000
028500 01  PV-PROGRAM-VARIABLES.                                        02850000
028600     05  PV-SUM-OF-PACKS                 PIC S9(09)  VALUE ZERO   02860000
028700                                                    COMP-3.       02870000
028800     05  PV-ERROR-ORD-NBR                PIC  9(08)  VALUE ZEROS. 02880000
028900     05  PV-ERROR-RCVR-SEQ-NBR           PIC  9(04)  VALUE ZEROS. 02890000
029000     05  PV-ERROR-ORD-LNE-NBR            PIC  9(04)  VALUE ZEROS. 02900000
029100     05  PV-ERROR-ORD-PCK-NBR            PIC  9(04)  VALUE ZEROS. 02910000
029200     05  PV-ERROR-OPER-UNT-ID            PIC  9(04)  VALUE ZEROS. 02920000
029300     05  PV-PREPK-ODD-UNT-QTY            PIC S9(04) VALUE 0 COMP. 02930000
029400     05  PV-DISPLAY-CICS-RESP            PIC  9(04).              02940000
029500     05  PV-DISPLAY-PO                   PIC  9(09).              02950000
029600     05  PV-DISPLAY-RECV                 PIC  9(09).              02960000
029700     05  PV-DISPLAY-LINE                 PIC  9(05).              02970000
029800     05  PV-DISPLAY-STORE                PIC  9(05).              02980000
029810     05  PV-DISPLAY-LOCATION-NBR         PIC  9(05).              02981024
029900     05  PV-DISPLAY-SKU                  PIC  9(08).              02990000
030000     05  PV-SEL-TERM-ID                  PIC  X(04).              03000000
030100     05  PV-SEL-TASK-NUMBER              PIC  9(05).              03010000
030200     05  PV-SEL-SEQ                      PIC  9(01).              03020000
030300     05  PV-CICS-MSG-AREA                PIC  X(100) VALUE SPACE. 03030000
030400     05  PV-CICS-MSG-AREA2               PIC  X(100) VALUE SPACE. 03040000
030500     05  PV-COMMAREA-LENGTH              PIC S9(04)  VALUE +0     03050000
030600                                                     COMP SYNC.   03060000
030700     05  PV-SUB                       PIC S9(04)  VALUE ZERO      03070000
030800                                                    COMP SYNC.    03080000
030900     05  PV-REMAINDER                 PIC S9(04)  VALUE ZERO      03090000
031000                                                    COMP SYNC.    03100000
031100     05  PV-READ-COUNT                PIC S9(09)  VALUE ZERO      03110000
031200                                                    COMP-3.       03120000
031300     05  PV-ITEMS-PROCESSED           PIC S9(09)  VALUE ZERO      03130000
031400                                                    COMP-3.       03140000
031500     05  PV-HOLD-SELECTED-ITEMS       PIC S9(09)  VALUE ZERO      03150000
031600                                                    COMP-3.       03160000
031700     05  PV-ITEM-IN-USE               PIC S9(09)  VALUE ZERO      03170000
031800                                                    COMP-3.       03180000
031900     05  PV-TOP-ITEM                  PIC S9(09)  VALUE ZERO      03190000
032000                                                    COMP-3.       03200000
032100     05  PV-BOTTOM-ITEM               PIC S9(09)  VALUE ZERO      03210000
032200                                                    COMP-3.       03220000
032300     05  PV-BLOCK-NUMBER              PIC S9(04)  VALUE ZERO      03230000
032400                                                    COMP SYNC.    03240000
032500     05  PV-CICS-RESP                 PIC S9(04)  VALUE ZERO      03250000
032600                                                    COMP SYNC.    03260000
032700     05  PV-CICS-RESP-2               PIC S9(04)  VALUE ZERO      03270000
032800                                                    COMP SYNC.    03280000
032900     05  PV-ITEM                      PIC S9(04)  VALUE ZERO      03290000
033000                                                    COMP SYNC.    03300000
033100     05  PV-SEL-QUEUE-ITEM            PIC S9(04)  VALUE ZERO      03310000
033200                                                    COMP SYNC.    03320000
033300     05  PV-SAVE-ITEM                 PIC S9(04)  VALUE ZERO      03330000
033400                                                    COMP SYNC.    03340000
033500     05  PV-HIGHEST-BLOCK-WRITTEN     PIC S9(04)  VALUE ZERO      03350000
033600                                                    COMP SYNC.    03360000
033700     05  PV-LIST-ITEM-NUMBER          PIC S9(04)  VALUE ZERO      03370000
033800                                                    COMP SYNC.    03380000
033900     05  PV-FIRST-BLOCK-IN-ARRAY      PIC S9(04)  VALUE ZERO      03390000
034000                                                    COMP SYNC.    03400000
034100     05  PV-NEXT-BLOCK-IN-ARRAY       PIC S9(04)  VALUE ZERO      03410000
034200                                                    COMP SYNC.    03420000
034300     05  PV-PREV-BLOCK-IN-ARRAY       PIC S9(04)  VALUE ZERO      03430000
034400                                                    COMP SYNC.    03440000
034500     05  PV-FIRST-BLOCK-IN-RANGE      PIC S9(04)  VALUE ZERO      03450000
034600                                                    COMP SYNC.    03460000
034700     05  PV-LAST-BLOCK-IN-RANGE       PIC S9(04)  VALUE ZERO      03470000
034800                                                    COMP SYNC.    03480000
034900     05  PV-START-OF-SELECTED-RANGE   PIC S9(04)  VALUE ZERO      03490000
035000                                                    COMP SYNC.    03500000
035100     05  PV-END-OF-SELECTED-RANGE     PIC S9(04)  VALUE ZERO      03510000
035200                                                    COMP SYNC.    03520000
035300     05  PV-STR-ZN-NULL-IND           PIC S9(04) VALUE ZERO       03530000
035400                                                    COMP SYNC.    03540000
035500     05  PV-GLOBAL-INV-COUNT          PIC S9(09) VALUE ZERO       03550000
035600                                                    COMP SYNC.    03560000
035700     05  PV-VERIFIED-LINE-COUNT       PIC S9(09) VALUE ZERO       03570000
035800                                                    COMP SYNC.    03580000
035900     05  PV-TOTAL-LINE-COUNT          PIC S9(09) VALUE ZERO       03590000
036000                                                    COMP SYNC.    03600000
036100     05  PV-PREPK-BLANK-COUNT         PIC S9(09) VALUE ZERO       03610000
036200                                                    COMP SYNC.    03620000
036300     05  PV-STATUS-COUNTERS.                                      03630000
036400         10 PV-FREIGHT-COUNT          PIC S9(04) VALUE ZERO       03640000
036500                                                    COMP SYNC.    03650000
036600         10 PV-TRBL-LINE-COUNT        PIC S9(04) VALUE ZERO       03660000
036700                                                    COMP SYNC.    03670000
036800         10 PV-TRBL-RCVR-COUNT        PIC S9(04) VALUE ZERO       03680000
036900                                                    COMP SYNC.    03690000
037000         10 PV-INVENTORY-COUNT        PIC S9(04) VALUE ZERO       03700000
037100                                                    COMP SYNC.    03710000
037200         10 PV-VERIFIED-COUNT         PIC S9(04) VALUE ZERO       03720000
037300                                                    COMP SYNC.    03730000
037400         10 PV-RECEIVER-COUNT         PIC S9(04) VALUE ZERO       03740000
037500                                                    COMP SYNC.    03750000
037600         10 PV-SUSPEND-COUNT          PIC S9(04) VALUE ZERO       03760000
037700                                                    COMP SYNC.    03770000
037800         10 PV-STORE-COUNT            PIC S9(04) VALUE ZERO       03780000
037900                                                    COMP SYNC.    03790000
038000     05  PV-NULL-IND                     PIC S9(04)  VALUE ZEROS  03800000
038100                                                     COMP SYNC.   03810000
038200     05  PV-DATE                      PIC X(10)  VALUE SPACES.    03820000
038300     05  PV-TIME                      PIC X(05)  VALUE SPACES.    03830000
038400     05  PV-TMST                      PIC X(26).                  03840000
038500     05  FILLER REDEFINES PV-TMST.                                03850000
038600         10  PV-CCYY                  PIC X(04).                  03860000
038700         10  FILLER                   PIC X(01).                  03870000
038800         10  PV-MM                    PIC X(02).                  03880000
038900         10  FILLER                   PIC X(01).                  03890000
039000         10  PV-DD                    PIC X(02).                  03900000
039100         10  FILLER                   PIC X(01).                  03910000
039200         10  PV-HH                    PIC X(02).                  03920000
039300         10  FILLER                   PIC X(01).                  03930000
039400         10  PV-MIN                   PIC X(02).                  03940000
039500         10  FILLER                   PIC X(01).                  03950000
039600         10  PV-SEC                   PIC X(02).                  03960000
039700         10  FILLER                   PIC X(01).                  03970000
039800         10  FILLER                   PIC X(06).                  03980000
039900     05  PV-FCSE-AREA-ID              PIC X(06).                  03990000
040000     05  PV-FCSE-CNFRMN-TMST          PIC X(26).                  04000000
040100     05  PV-FCSE-CNFRMN-TMST-R REDEFINES PV-FCSE-CNFRMN-TMST.     04010000
040200         10 PV-FCSE-CNFRMN-DATE       PIC X(10).                  04020000
040300         10 FILLER                    PIC X(16).                  04030000
040400     05  PV-CURRENT-TMST              PIC X(26).                  04040000
040500     05  PV-CURRENT-TMST-R REDEFINES PV-CURRENT-TMST.             04050000
040600         10 PV-CURRENT-DATE           PIC X(10).                  04060000
040700         10 FILLER                    PIC X(16).                  04070000
040800     05  PV-NUMBER-OF-UPDATED-ITEMS   PIC S9(09) COMP-3.          04080000
040900     05  PV-WORK-VENDOR-NAME.                                     04090000
040910*CLP 10/20/14 START                                               04091034
041000         10  FILLER                      PIC X(01) VALUE '('.     04100000
041100         10  PV-VENDOR-NAME              PIC X(17).               04110034
041200         10  FILLER                      PIC X(01) VALUE ')'.     04120000
041300     05  PV-FORMAT-PO-RCVR.                                       04130000
041400         10  PV-FORMAT-PO                PIC 9(08).               04140033
041410*CLP 10/20/14 END                                                 04141034
041500         10  FILLER                      PIC X(01) VALUE '-'.     04150000
041600         10  PV-FORMAT-RCVR              PIC 9(04).               04160000
041700*----------------------------------------------------------------*04170000
041800* INCLUDED PROGRAM VARIABLE PV-SKU-NBR.             WR # 21361   *04180000
041900*----------------------------------------------------------------*04190000
042000     05  PV-SKU                          PIC 9(08).               04200000
042100     05  PV-SKU-NBR                      PIC X(08).               04210000
042200*----------------------------------------------------------------*04220000
042300* CHANGES MADE FOR WR # 21361 ENDS HERE.                         *04230000
042400*----------------------------------------------------------------*04240000
042500     05  PV-PREPK-ID                     PIC 9(04).               04250000
042600     05  FILLER REDEFINES PV-PREPK-ID.                            04260000
042700         10  PV-PREPK-1                  PIC 9(01).               04270000
042800         10  PV-PREPK-3                  PIC 9(03).               04280000
042900     05  PV-PREPK-ID-COMP                PIC S9(4) COMP VALUE 0.  04290000
043000                                                                  04300000
043100                                                                  04310000
043200 01  PT-INVPAR-TABLE.                                             04320000
043300     05  PT-INVSTORE-FLAG             PIC X OCCURS 1000 TIMES.    04330000
043400         88  PT-STORE-DOING-INVENTORY     VALUE 'Y'.              04340000
043500     05  PT-STORE-NBR-X.                                          04350000
043600         10  PT-STORE-NBR          PIC 9(04).                     04360000
043700                                                                  04370000
043800     05  PV-PO-NBR                       PIC 9(08).               04380000
043900     05  PV-RCVR-NBR                     PIC 9(04).               04390000
044000     05  PV-OPER-UNT-ID                  PIC 9(04).               04400000
044100     05  PV-FCLTY-ID                     PIC 9(04).               04410000
044200     05  PV-LINE-NBR                     PIC 9(04).               04420000
044300                                                                  04430000
044400*---------------------------------------------------------------* 04440000
044500*   THIS IS THE LAYOUT FOR THE LIST ITEMS TEMP STORAGE QUEUE.   * 04450000
044600*   THIS MUST BE THE EXACT SAME FORMAT A BLOCK IN THE           * 04460000
044700*   APPLICATION-SPECIFIC COMMAREA.                              * 04470000
044800*---------------------------------------------------------------* 04480000
044900 01  LQW-LIST-QUEUE-WORK-AREA.                                    04490000
045000     05  LQW-BLOCK-MODIFIED-SW        PIC X(01)   VALUE SPACE.    04500000
045100         88  LQW-BLOCK-NOT-MODIFIED                VALUE 'N'.     04510000
045200         88  LQW-BLOCK-MODIFIED                    VALUE 'Y'.     04520000
045300     05  LQW-ITEM-ENTRIES               OCCURS 12 TIMES           04530000
045400                                        INDEXED BY LQW-IDX.       04540000
045500         10  LQW-LIST-ITEM-NUMBER     PIC S9(09)  COMP-3.         04550000
045600         10  LQW-TEMP-SELECTED-SW     PIC X(01).                  04560000
045700         10  LQW-SELECTED-SW          PIC X(01).                  04570000
045800             88  LQW-SELECT                         VALUE 'S'.    04580000
045900             88  LQW-DESELECT                       VALUE SPACE.  04590000
046000         10  LQW-ACTION               PIC X(03).                  04600000
046100             88  LQW-NULL-ACTION                    VALUE SPACES. 04610000
046200             88  LQW-ERROR                          VALUE 'ERR'.  04620000
046300             88  LQW-INQUIRE                        VALUE 'INQ'.  04630000
046400             88  LQW-UPDATE                         VALUE 'UPD'.  04640000
046500             88  LQW-SUB                            VALUE 'SUB'.  04650000
046600         10  LQW-PO-LINE              PIC 9(4).                   04660000
046700         10  LQW-SKU-NBR              PIC X(08).                  04670000
046800         10  LQW-PREPK REDEFINES LQW-SKU-NBR.                     04680000
046900             15  LQW-PREPK-F3         PIC X(03).                  04690000
047000             15  LQW-PREPK-L4         PIC 9(04).                  04700000
047100             15  LQW-PREPK-FILLER     PIC X(01).                  04710000
047200         10  LQW-FCSE-AREA            PIC X(06).                  04720000
047300         10  LQW-CARTON-COUNT         PIC 9(04).                  04730000
047400         10  LQW-OUT-PACK-QTY         PIC 9(04).                  04740000
047500         10  LQW-PROCESS-QTY          PIC 9(05).                  04750000
047600         10  FILLER                   PIC X(1).                   04760000
047700         10  LQW-ODD-UNIT-QTY         PIC 9(04).                  04770000
047800         10  LQW-CONF-DATE            PIC X(05).                  04780000
047900         10  LQW-CONF-TIME            PIC X(05).                  04790000
048000         10  LQW-P2L-COUNT            PIC 9(05).                  04800000
048100         10  LQW-P2L-STATUS           PIC X(07).                  04810000
048200         10  LQW-LINE-STATUS          PIC X(05).                  04820000
048300         10  LQW-LINE-ERROR-FLAG      PIC X(01).                  04830000
048400             88  LQW-NO-LINE-ERROR  VALUE 'N', 'C', SPACE.        04840000
048500             88  LQW-LINE-ERROR     VALUE 'Y'.                    04850000
048600             88  LQW-LINE-CAUTION   VALUE 'C'.                    04860000
048700         10  LQW-LINE-PROTECT-FLAG    PIC X(01).                  04870000
048800             88  LQW-NOT-LINE-PROTECT  VALUE 'N', SPACE.          04880000
048900             88  LQW-LINE-PROTECT      VALUE 'Y'.                 04890000
049000         10  LQW-FCSE-AREA-ERROR-FLAG PIC X(01).                  04900000
049100             88  LQW-GOOD-FCSE-PROCESS-AREA   VALUE 'Y' ' '.      04910000
049200             88  LQW-BAD-FCSE-PROCESS-AREA    VALUE 'N'.          04920000
049300         10  LQW-FCSE-AREA-NEED-FLAG  PIC X(01).                  04930000
049400             88  LQW-HAVE-FCSE-PROCESS-AREA    VALUE 'Y'.         04940000
049500             88  LQW-NEED-FCSE-PROCESS-AREA    VALUE 'N'.         04950000
049600         10  LQW-FCSE-AREA-UPD-FLAG  PIC X(01).                   04960000
049700             88  LQW-FCSE-AREA-UPDATEABLE      VALUE 'Y'.         04970000
049800             88  LQW-FCSE-AREA-NO-UPDATE       VALUE 'N'.         04980000
049900         10  LQW-PREPK-RATO-QTY      PIC S9(4).                   04990000
050000                                                                  05000000
050100/                                                                 05010000
050200*---------------------------------------------------------------* 05020000
050300*  RECORD LAYOUT(S) FOR THE LIST SELECTION TEMP STORAGE QUEUE.  * 05030000
050400*---------------------------------------------------------------* 05040000
050500     COPY RCWS013.                                                05050000
050600     COPY RCWS801.                                                05060000
050700                                                                  05070000
050800     COPY RCWS074.                                                05080000
050900                                                                  05090000
051000***************************************************************** 05100000
051100*   RCWS071 - COPYBOOK IS USED FOR THE MODULE TO TRACK DC ASSOC * 05110000
051200*             FUNCTIONS                                        .* 05120000
051300***************************************************************** 05130000
051400     COPY RCWS071.                                                05140000
051500                                                                  05150000
051600***************************************************************** 05160000
051700*   RCWS038 - IS THE LAYOUT THAT IS USED TO PASS INFO TO (VEM)  * 05170000
051800*             THE VERIFICATION ELIGIBILITY MODULE (RCKUT124)    * 05180000
051900***************************************************************** 05190000
052000     COPY RCWS038.                                                05200000
052100                                                                  05210000
052200/                                                                 05220000
052300*---------------------------------------------------------------* 05230000
052400*  RECORD LAYOUT FOR THE COMMAREA BEING USED TO PASS DATA TO    * 05240000
052500*  THE VERIFICATION TRANSACTION (PCKCS200).                     * 05250000
052600*---------------------------------------------------------------* 05260000
052700                                                                  05270000
052800     COPY RCWS289.                                                05280000
052900/                                                                 05290000
053000     COPY RCKM297.                                                05300000
053100                                                                  05310000
053200 01  MR-OCCURS-LAYOUT                   REDEFINES  RC297AO.       05320000
053300     02  MR-HEADER-INFO.                                          05330000
053400     05  FILLER                       PIC X(12).                  05340033
053500                                                                  05350000
053600     05  MR-OPERL                     PIC S9(04) COMP.            05360000
053700     05  MR-OPERA                     PIC X(01).                  05370000
053800     05  MR-OPERC                     PIC X(01).                  05380000
053900     05  MR-OPERH                     PIC X(01).                  05390000
054000     05  MR-OPER                      PIC X(04).                  05400000
054100                                                                  05410000
054200     05  MR-FCLTYL                    PIC S9(04) COMP.            05420000
054300     05  MR-FCLTYA                    PIC X(01).                  05430000
054400     05  MR-FCLTYC                    PIC X(01).                  05440000
054500     05  MR-FCLTYH                    PIC X(01).                  05450000
054600     05  MR-FCLTY                     PIC X(04).                  05460000
054700                                                                  05470000
054800     05  MR-DEPTL                     PIC S9(04) COMP.            05480000
054900     05  MR-DEPTA                     PIC X(01).                  05490000
055000     05  MR-DEPTC                     PIC X(01).                  05500000
055100     05  MR-DEPTH                     PIC X(01).                  05510000
055200     05  MR-DEPT                      PIC X(04).                  05520000
055300                                                                  05530000
055400     05  MR-ZONEL                     PIC S9(04) COMP.            05540000
055500     05  MR-ZONEA                     PIC X(01).                  05550000
055600     05  MR-ZONEC                     PIC X(01).                  05560000
055700     05  MR-ZONEH                     PIC X(01).                  05570000
055800     05  MR-ZONE                      PIC X(07).                  05580000
055900                                                                  05590000
056000     05  MR-RCVR-STATUSL              PIC S9(04) COMP.            05600000
056100     05  MR-RCVR-STATUSA              PIC X(01).                  05610000
056200     05  MR-RCVR-STATUSC              PIC X(01).                  05620000
056300     05  MR-RCVR-STATUSH              PIC X(01).                  05630000
056400     05  MR-RCVR-STATUS               PIC X(02).                  05640000
056500                                                                  05650000
056600     05  MR-PORCVRL                   PIC S9(04) COMP.            05660000
056700     05  MR-PORCVRA                   PIC X(01).                  05670000
056800     05  MR-PORCVRC                   PIC X(01).                  05680000
056900     05  MR-PORCVRH                   PIC X(01).                  05690000
056910*CLP 10/20/14                                                     05691033
057000     05  MR-PORCVR                    PIC X(13).                  05700033
057100                                                                  05710000
057200     05  MR-PACK-DESCL                PIC S9(04) COMP.            05720000
057300     05  MR-PACK-DESCA                PIC X(01).                  05730000
057400     05  MR-PACK-DESCC                PIC X(01).                  05740000
057500     05  MR-PACK-DESCH                PIC X(01).                  05750000
057600     05  MR-PACK-DESC                 PIC X(06).                  05760000
057700                                                                  05770000
057710*CLP 10/20/14                                                     05771033
057800     05  MR-VENDOR-NAMEL              PIC S9(04) COMP.            05780000
057900     05  MR-VENDOR-NAMEA              PIC X(01).                  05790000
058000     05  MR-VENDOR-NAMEC              PIC X(01).                  05800000
058100     05  MR-VENDOR-NAMEH              PIC X(01).                  05810000
058200     05  MR-VENDOR-NAME               PIC X(19).                  05820033
058300                                                                  05830000
058400     05  FILLER                       PIC X(30).                  05840000
058500                                                                  05850000
058600     05  MR-PACK1L                    PIC S9(04) COMP.            05860000
058700     05  MR-PACK1A                    PIC X(01).                  05870000
058800     05  MR-PACK1C                    PIC X(01).                  05880000
058900     05  MR-PACK1H                    PIC X(01).                  05890000
059000     05  MR-PACK1                     PIC X(08).                  05900000
059100                                                                  05910000
059200     05  MR-SKUIDL                    PIC S9(04) COMP.            05920000
059300     05  MR-SKUIDA                    PIC X(01).                  05930000
059400     05  MR-SKUIDC                    PIC X(01).                  05940000
059500     05  MR-SKUIDH                    PIC X(01).                  05950000
059600     05  MR-SKUID                     PIC X(08).                  05960000
059700                                                                  05970000
059800     05  MR-QTYPK1L                   PIC S9(04) COMP.            05980000
059900     05  MR-QTYPK1A                   PIC X(01).                  05990000
060000     05  MR-QTYPK1C                   PIC X(01).                  06000000
060100     05  MR-QTYPK1H                   PIC X(01).                  06010000
060200     05  MR-QTYPK1                    PIC X(03).                  06020000
060300                                                                  06030000
060400     05  MR-QTYPK2L                   PIC S9(04) COMP.            06040000
060500     05  MR-QTYPK2A                   PIC X(01).                  06050000
060600     05  MR-QTYPK2C                   PIC X(01).                  06060000
060700     05  MR-QTYPK2H                   PIC X(01).                  06070000
060800     05  MR-QTYPK2                    PIC X(03).                  06080000
060900                                                                  06090000
061000     02  MR-DETAIL-LINES.                                         06100000
061100     05  MR-SCROLL-AREA                 OCCURS 12 TIMES.          06110000
061200         10  MR-SELECTL               PIC S9(04) COMP.            06120000
061300         10  MR-SELECTA               PIC X(01).                  06130000
061400         10  MR-SELECTC               PIC X(01).                  06140000
061500         10  MR-SELECTH               PIC X(01).                  06150000
061600         10  MR-SELECT                PIC X(01).                  06160000
061700                                                                  06170000
061800         10  MR-ACTIONL               PIC S9(04) COMP.            06180000
061900         10  MR-ACTIONA               PIC X(01).                  06190000
062000         10  MR-ACTIONC               PIC X(01).                  06200000
062100         10  MR-ACTIONH               PIC X(01).                  06210000
062200         10  MR-ACTION                PIC X(03).                  06220000
062300                                                                  06230000
062400         10  MR-PO-LINE-L             PIC S9(04) COMP.            06240000
062500         10  MR-PO-LINE-A             PIC X(01).                  06250000
062600         10  MR-PO-LINE-C             PIC X(01).                  06260000
062700         10  MR-PO-LINE-H             PIC X(01).                  06270000
062800         10  MR-PO-LINE               PIC Z(04).                  06280000
062900                                                                  06290000
063000         10  MR-SKUL                  PIC S9(04) COMP.            06300000
063100         10  MR-SKUA                  PIC X(01).                  06310000
063200         10  MR-SKUC                  PIC X(01).                  06320000
063300         10  MR-SKUH                  PIC X(01).                  06330000
063400         10  MR-SKU-NBR               PIC X(08).                  06340000
063500         10  MR-FCSE-AREA-L           PIC S9(04) COMP.            06350000
063600         10  MR-FCSE-AREA-A           PIC X(01).                  06360000
063700         10  MR-FCSE-AREA-C           PIC X(01).                  06370000
063800         10  MR-FCSE-AREA-H           PIC X(01).                  06380000
063900         10  MR-FCSE-AREA             PIC X(06).                  06390000
064000                                                                  06400000
064100         10  MR-CARTON-COUNTL         PIC S9(04) COMP.            06410000
064200         10  MR-CARTON-COUNTA         PIC X(01).                  06420000
064300         10  MR-CARTON-COUNTC         PIC X(01).                  06430000
064400         10  MR-CARTON-COUNTH         PIC X(01).                  06440000
064500         10  MR-CARTON-COUNT-X.                                   06450000
064600             15 MR-CARTON-COUNT       PIC ZZZ9.                   06460000
064700                                                                  06470000
064800         10  MR-OUT-PACK-QTYL         PIC S9(04) COMP.            06480000
064900         10  MR-OUT-PACK-QTYA         PIC X(01).                  06490000
065000         10  MR-OUT-PACK-QTYC         PIC X(01).                  06500000
065100         10  MR-OUT-PACK-QTYH         PIC X(01).                  06510000
065200         10  MR-OUT-PACK-QTY-X.                                   06520000
065300             15 MR-OUT-PACK-QTY       PIC ZZZ9.                   06530000
065400                                                                  06540000
065500         10  MR-PROCESS-QTYL          PIC S9(04) COMP.            06550000
065600         10  MR-PROCESS-QTYA          PIC X(01).                  06560000
065700         10  MR-PROCESS-QTYC          PIC X(01).                  06570000
065800         10  MR-PROCESS-QTYH          PIC X(01).                  06580000
065900         10  MR-PROCESS-QTY-X.                                    06590000
066000             15 MR-PROCESS-QTY        PIC ZZZZ9.                  06600000
066100                                                                  06610000
066200         10  MR-ODD-UNIT-QTYL         PIC S9(04) COMP.            06620000
066300         10  MR-ODD-UNIT-QTYA         PIC X(01).                  06630000
066400         10  MR-ODD-UNIT-QTYC         PIC X(01).                  06640000
066500         10  MR-ODD-UNIT-QTYH         PIC X(01).                  06650000
066600         10  MR-ODD-UNIT-QTY-X.                                   06660000
066700             15 MR-ODD-UNIT-QTY       PIC ZZZ9.                   06670000
066800                                                                  06680000
066900         10  MR-CONF-DATEL            PIC S9(04) COMP.            06690000
067000         10  MR-CONF-DATEA            PIC X(01).                  06700000
067100         10  MR-CONF-DATEC            PIC X(01).                  06710000
067200         10  MR-CONF-DATEH            PIC X(01).                  06720000
067300         10  MR-CONF-DATE.                                        06730000
067400             15  MR-CONF-MM           PIC 99.                     06740000
067500             15  MR-CONF-DASH1        PIC X.                      06750000
067600             15  MR-CONF-DD           PIC 99.                     06760000
067700                                                                  06770000
067800         10  MR-CONF-TIMEL            PIC S9(04) COMP.            06780000
067900         10  MR-CONF-TIMEA            PIC X(01).                  06790000
068000         10  MR-CONF-TIMEC            PIC X(01).                  06800000
068100         10  MR-CONF-TIMEH            PIC X(01).                  06810000
068200         10  MR-CONF-TIME.                                        06820000
068300             15  MR-CONF-HOUR         PIC 99.                     06830000
068400             15  MR-CONF-COLON        PIC X.                      06840000
068500             15  MR-CONF-MIN          PIC 99.                     06850000
068600                                                                  06860000
068700         10  MR-P2L-COUNTL            PIC S9(04) COMP.            06870000
068800         10  MR-P2L-COUNTA            PIC X(01).                  06880000
068900         10  MR-P2L-COUNTC            PIC X(01).                  06890000
069000         10  MR-P2L-COUNTH            PIC X(01).                  06900000
069100         10  MR-P2L-COUNT-X.                                      06910000
069200             15 MR-P2L-COUNT          PIC ZZZZ9.                  06920000
069300                                                                  06930000
069400         10 MR-P2L-STATUSL            PIC S9(04) COMP.            06940000
069500         10 MR-P2L-STATUSA            PIC X(01).                  06950000
069600         10 MR-P2L-STATUSC            PIC X(01).                  06960000
069700         10 MR-P2L-STATUSH            PIC X(01).                  06970000
069800         10 MR-P2L-STATUS             PIC X(07).                  06980000
069900                                                                  06990000
070000         10 MR-LINE-STATUSL           PIC S9(04) COMP.            07000000
070100         10 MR-LINE-STATUSA           PIC X(01).                  07010000
070200         10 MR-LINE-STATUSC           PIC X(01).                  07020000
070300         10 MR-LINE-STATUSH           PIC X(01).                  07030000
070400         10 MR-LINE-STATUS            PIC X(05).                  07040000
070500                                                                  07050000
070600                                                                  07060000
070700     COPY DPWS015.                                                07070000
070800/                                                                 07080000
070900     COPY DPWS016.                                                07090000
071000/                                                                 07100000
071100     COPY DPWS010I.                                               07110000
071200/                                                                 07120000
071210******************************************************************07121037
071220** THE CALLING PARAMETER LIST (DPWS030/DPWS930) FOR THE CICS    **07122037
071230** ARCHITECTURE API (BLACK BOX) SUB-ROUTINE.                    **07123037
071240******************************************************************07124037
071300     COPY DPWS030.                                                07130000
071310     COPY DPWS930.                                                07131037
071400/                                                                 07140000
071500***************************************************************** 07150000
071600*   RCWS039 - IS THE LAYOUT THAT IS USED TO PASS INFO TO        * 07160000
071700*             THE F-KEY ELIGIBILITY MODULE (RCKUT126).          * 07170000
071800***************************************************************** 07180000
071900     COPY RCWS039.                                                07190000
072000                                                                  07200000
072100***************************************************************** 07210000
072200*   RCWS040 - IS THE LAYOUT THAT IS USED TO PASS INFO TO THE    * 07220000
072300*             AUTOVERIFY (AUTOVE) MODULE (RCKUT127).            * 07230000
072400***************************************************************** 07240000
072500     COPY RCWS040.                                                07250000
072600                                                                  07260000
072700*---------------------------------------------------------------* 07270000
072800*    STANDARD COMMAREA.                                         * 07280000
072900*---------------------------------------------------------------* 07290000
073000     COPY DPWS020.                                                07300000
073100     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                07310000
073200                                                                  07320000
073300*---------------------------------------------------------------* 07330000
073400* INTER-APPLICATION COMMAREA.                                   * 07340000
073500*   CNWS001 - IS THE INPUT LAYOUT WHEN COMING FROM THE CRIT.    * 07350000
073600*             SPEC SCREEN.                                      * 07360000
073700*   CNWS003 - IS THE OUTPUT LAYOUT THAT WILL BE PASSED FROM     * 07370000
073800*             THIS LIST PROGRAM FOR A LOCAL-GO FUNCTION.        * 07380000
073900*   RCWS800 - IS THE OUTPUT LAYOUT THAT WILL BE PASSED FROM     * 07390000
074000*             THIS LIST PROGRAM TO RCKCS801 & RCKCS812.         * 07400000
074100*---------------------------------------------------------------* 07410000
074200                                                                  07420000
074300         10  INTER-APPL-COMM-AREA     PIC X(200).                 07430000
074400     COPY RCWS012.                                                07440000
074500     COPY RCWS015.                                                07450000
074600     COPY RCWS800.                                                07460000
074700*---------------------------------------------------------------* 07470000
074800*  THIS IS THE APPLICATION-SPECIFIC COMMAREA.                   * 07480000
074900*---------------------------------------------------------------* 07490000
075000         10  ASC-SPECIFIC-COMMAREA.                               07500000
075100             15  ASC-LIST-KEYS.                                   07510000
075200*  THESE ARE THE KEYS PASSED FROM THE CRIT SPEC SCREEN            07520000
075300                 20  ASC-KEY-FCLTY-ID PIC S9(04) COMP.            07530000
075400                 20  ASC-KEY-OPER-UNT-ID                          07540000
075500                                      PIC S9(04) COMP.            07550000
075600                 20  ASC-KEY-PO-NBR   PIC S9(09) COMP.            07560000
075700                 20  ASC-KEY-RCVR-NBR PIC S9(09) COMP.            07570000
075800                 20  ASC-KEY-LNE-NBR  PIC S9(09) COMP.            07580000
075900                 20  ASC-LINE-LO      PIC S9(09) COMP.            07590000
076000                 20  ASC-LINE-HI      PIC S9(09) COMP.            07600000
076100             15  ASC-HEADER-FIELDS.                               07610000
076200                 20  ASC-DEPT         PIC X(04).                  07620000
076300                 20  ASC-DEPT-N       PIC 9(04).                  07630000
076310*CLP 10/20/14                                                     07631033
076400                 20  ASC-VENDOR-NAME  PIC X(19).                  07640033
076500                 20  ASC-ZONE         PIC X(07).                  07650000
076600                 20  ASC-RCVR-STATUS  PIC X(02).                  07660000
076700                 20  ASC-PROTECT-SW   PIC X(01).                  07670000
076800                     88  ASC-PROTECT-ALL-LINES VALUE 'Y'.         07680000
076900                 20  ASC-ARRIVED-SW   PIC X(01).                  07690000
077000                     88  ASC-RECEIVER-ARRIVED      VALUE 'Y'.     07700000
077100                     88  ASC-RECEIVER-NOT-ARRIVED  VALUE 'N'.     07710000
077200                                                                  07720000
077300             15  ASC-BLOCK-ENTRIES      OCCURS 2 TIMES.           07730000
077400                 20  ASC-BLOCK-MODIFIED-SW                        07740000
077500                                      PIC  X(01).                 07750000
077600                     88  ASC-BLOCK-NOT-MODIFIED    VALUE 'N'.     07760000
077700                     88  ASC-BLOCK-MODIFIED        VALUE 'Y'.     07770000
077800                                                                  07780000
077900                 20  ASC-ITEM-ARRAY.                              07790000
078000                     25  ASC-ITEM-ENTRIES OCCURS 12 TIMES.        07800000
078100                         30  ASC-LIST-ITEM-NUMBER                 07810000
078200                                      PIC S9(09) COMP-3.          07820000
078300                         30  ASC-TEMP-SELECTED-SW                 07830000
078400                                      PIC X(01).                  07840000
078500                             88  ASC-VALID-SELECT  VALUE ' '      07850000
078600                                                         'S'      07860000
078700                                                         'B'      07870000
078800                                                         'E'.     07880000
078900                             88  ASC-TEMP-NO-SELECT               07890000
079000                                                   VALUE ' '.     07900000
079100                             88  ASC-TEMP-SELECT   VALUE 'S'.     07910000
079200                             88  ASC-TEMP-BEGIN    VALUE 'B'.     07920000
079300                             88  ASC-TEMP-END      VALUE 'E'.     07930000
079400                         30  ASC-SELECTED-SW                      07940000
079500                                      PIC X(01).                  07950000
079600                             88  ASC-NO-SELECT     VALUE ' '.     07960000
079700                             88  ASC-SELECT        VALUE 'S'.     07970000
079800                             88  ASC-BEGIN         VALUE 'B'.     07980000
079900                             88  ASC-END           VALUE 'E'.     07990000
080000                         30  ASC-ACTION          PIC X(03).       08000000
080100                                                                  08010000
080200                         30  ASC-LINE-NBR       PIC 9(4).         08020000
080300                         30  ASC-SKU-NBR        PIC X(08).        08030000
080400                         30  ASC-PREPK REDEFINES ASC-SKU-NBR.     08040000
080500                            35 ASC-PREPK-F3     PIC X(03).        08050000
080600                            35 ASC-PREPK-L4     PIC 9(04).        08060000
080700                            35 ASC-PREPK-FILLER PIC X(01).        08070000
080800                         30  ASC-FCSE-AREA      PIC X(06).        08080000
080900                         30  ASC-CARTON-COUNT   PIC 9(04).        08090000
081000                         30  ASC-OUT-PACK-QTY   PIC 9(04).        08100000
081100                         30  ASC-PROCESS-QTY    PIC 9(05).        08110000
081200                         30  ASC-FILLER         PIC X(01).        08120000
081300                         30  ASC-ODD-UNIT-QTY   PIC 9(04).        08130000
081400                         30  ASC-CONF-DATE      PIC X(05).        08140000
081500                         30  ASC-CONF-TIME      PIC X(05).        08150000
081600                         30  ASC-P2L-QTY        PIC 9(05).        08160000
081700                         30  ASC-P2L-STATUS     PIC X(07).        08170000
081800                         30  ASC-LINE-STATUS    PIC X(05).        08180000
081900                             88  ASC-LINE-STATUS-YELLOW           08190000
082000                                          VALUE 'MLTIS'           08200000
082100                                                'PHYIN'           08210000
082200                                                'MSTRS'           08220000
082300                                                'NOPR#'           08230000
082400                                                'TRBL '           08240000
082500                                                'NARV '           08250000
082600                                                'BRAT '.          08260000
082700                         30  ASC-LINE-ERROR-FLAG      PIC X(01).  08270000
082800                             88  ASC-NO-LINE-ERROR  VALUE 'N'.    08280000
082900                             88  ASC-LINE-ERROR     VALUE 'Y'.    08290000
083000                             88  ASC-LINE-CAUTION   VALUE 'C'.    08300000
083100                         30  ASC-LINE-PROTECT-FLAG  PIC X(01).    08310000
083200                             88  ASC-NOT-LINE-PROTECT             08320000
083300                                                    VALUE 'N' ' '.08330000
083400                             88  ASC-LINE-PROTECT   VALUE 'Y'.    08340000
083500                         30  ASC-FCSE-AREA-ERROR-FLAG PIC X(01).  08350000
083600                             88  ASC-GOOD-FCSE-PROCESS-AREA       08360000
083700                                                    VALUE 'Y' ' '.08370000
083800                             88  ASC-BAD-FCSE-PROCESS-AREA        08380000
083900                                                    VALUE 'N'.    08390000
084000                         30  ASC-FCSE-AREA-NEED-FLAG  PIC X(01).  08400000
084100                             88  ASC-HAVE-FCSE-PROCESS-AREA       08410000
084200                                                    VALUE 'Y' ' '.08420000
084300                             88  ASC-NEED-FCSE-PROCESS-AREA       08430000
084400                                                    VALUE 'N'.    08440000
084500                         30  ASC-FCSE-AREA-UPD-FLAG  PIC X(01).   08450000
084600                             88  ASC-FCSE-AREA-UPDATEABLE         08460000
084700                                                    VALUE 'Y'.    08470000
084800                             88  ASC-FCSE-AREA-NO-UPDATE          08480000
084900                                                    VALUE 'N'.    08490000
085000                         30  ASC-PREPK-RATO-QTY PIC S9(4).        08500000
085100                                                                  08510000
085200                                                                  08520000
085300                                                                  08530000
085400             15  ASC-BLK-SUB          PIC S9(04) COMP SYNC.       08540000
085500             15  ASC-ITEM-SUB         PIC S9(04) COMP SYNC.       08550000
085600             15  ASC-NUMBER-OF-ITEMS-READ                         08560000
085700                                      PIC S9(09) COMP-3.          08570000
085800             15  ASC-NUMBER-OF-SELECTED-ITEMS                     08580000
085900                                      PIC S9(09) COMP-3.          08590000
086000             15  ASC-ITEMS-DISPLAYED  PIC S9(03) COMP-3.          08600000
086100             15  ASC-ITEM-AT-TOP-OF-PANEL                         08610000
086200                                      PIC S9(09) COMP-3.          08620000
086300             15  ASC-ITEM-AT-BOT-OF-PANEL                         08630000
086400                                      PIC S9(09) COMP-3.          08640000
086500             15  ASC-HIGHEST-BLOCK-WRITTEN                        08650000
086600                                      PIC S9(04) COMP SYNC.       08660000
086700             15  ASC-START-OF-SELECTED-RANGE                      08670000
086800                                      PIC S9(09) COMP-3.          08680000
086900             15  ASC-END-OF-SELECTED-RANGE                        08690000
087000                                      PIC S9(09) COMP-3.          08700000
087100             15  ASC-ITEMS-LEFT-INDICATOR                         08710000
087200                                      PIC X(01).                  08720000
087300                 88  ASC-ITEMS-LEFT-ON-DB          VALUE 'Y'.     08730000
087400                 88  ASC-NO-ITEMS-LEFT-ON-DB       VALUE 'N'.     08740000
087500             15  ASC-ITEMS-LEFT-INDICATOR-2                       08750000
087600                                      PIC X(01).                  08760000
087700                 88  ASC-ITEMS-LEFT-ON-DB-2        VALUE 'Y'.     08770000
087800                 88  ASC-NO-ITEMS-LEFT-ON-DB-2     VALUE 'N'.     08780000
087900             15  ASC-TEMP-QUEUE-UPDATE-SW                         08790000
088000                                      PIC X(01).                  08800000
088100                 88  ASC-UPDATE-TSQ                VALUE 'Y'.     08810000
088200                 88  ASC-NO-TSQ-UPDATE             VALUE ' '.     08820000
088300             15  ASC-LIST-QUEUE-NAME.                             08830000
088400                 20  ASC-LIST-TERM-ID PIC X(04).                  08840000
088500                 20  ASC-LIST-TASK-NUMBER                         08850000
088600                                      PIC S9(05) COMP-3.          08860000
088700                 20  ASC-LIST-SEQ     PIC 9(01).                  08870000
088800             15  ASC-SEL-QUEUE-NAME.                              08880000
088900                 20  ASC-SEL-TERM-ID  PIC X(04).                  08890000
089000                 20  ASC-SEL-TASK-NUMBER                          08900000
089100                                      PIC S9(05) COMP-3.          08910000
089200                 20  ASC-SEL-SEQ      PIC 9(01).                  08920000
089300             15  ASC-SEL-QUEUE-NAME-IN.                           08930000
089400                 20  ASC-SEL-TERM-ID-IN  PIC X(04).               08940000
089500                 20  ASC-SEL-TASK-NUMBER-IN                       08950000
089600                                      PIC S9(05) COMP-3.          08960000
089700                 20  ASC-SEL-SEQ-IN      PIC 9(01).               08970000
089800                                                                  08980000
089900             15  ASC-START-ITEM-REQUEST.                          08990000
090000                 20  ASC-START-ITEM-REQUEST-N                     09000000
090100                                      PIC 9(07).                  09010000
090200             15  ASC-OPER-UNT-ID      PIC S9(04) COMP.            09020000
090300             15  ASC-FCLTY-ID         PIC S9(04) COMP.            09030000
090400             15  ASC-ORD-NBR          PIC S9(8) COMP.             09040000
090500             15  ASC-RCVR-NBR         PIC S9(8) COMP.             09050000
090600             15  ASC-TRECEIV-DC       PIC S9(04) COMP.            09060000
090700             15  ASC-CICS-SYSTEM       PIC X(08).                 09070000
090800                 88 ASC-TEST-CICS             VALUE 'CICST1  '.   09080000
090900             15  ASC-USE-SELECTION-QUEUE-IND         PIC X(01).   09090000
091000                 88  ASC-USE-SELECTION-QUEUE         VALUE 'Y'.   09100000
091100             15  ASC-NUMBER-OF-TS-ITEMS              PIC S9(05)   09110000
091200                                                          COMP-3. 09120000
091300             15  ASC-SEL-SUB                         PIC S9(04)   09130000
091400                                                          COMP.   09140000
091500             15  ASC-SEL-ITEM                        PIC S9(04)   09150000
091600                                                          COMP.   09160000
091700             15  ASC-CONFIRM-FLAG         PIC X(01).              09170000
091800                 88  ASC-CONFIRM-NO  VALUE 'N'.                   09180000
091900                 88  ASC-CONFIRM-YES VALUE 'Y'.                   09190000
092000             15  ASC-FUNC01-CONFIRM-FLAG         PIC X(01).       09200000
092100                 88  ASC-FUNC01-CONFIRM-NO  VALUE 'N'.            09210000
092200                 88  ASC-FUNC01-CONFIRM-YES VALUE 'Y'.            09220000
092300             15  ASC-FUNC06-UPDATE-FLAG          PIC X(01).       09230000
092400                 88  ASC-FUNC06-UPDATE-NO  VALUE 'N'.             09240000
092500                 88  ASC-FUNC06-UPDATE-YES VALUE 'Y'.             09250000
092600             15  ASC-FUNC07-CONFIRM-FLAG         PIC X(01).       09260000
092700                 88  ASC-FUNC07-CONFIRM-NO  VALUE 'N'.            09270000
092800                 88  ASC-FUNC07-CONFIRM-YES VALUE 'Y'.            09280000
092900             15  ASC-PKGNG-CDE-DISPLAY        PIC X(01).          09290000
093000             15  ASC-PKGNG-CDE                PIC X(01).          09300000
093100                 88  ASC-BULK                     VALUE 'B'.      09310000
093200                 88  ASC-CASEPACK                 VALUE 'C'.      09320000
093300                 88  ASC-INNER-PREPK              VALUE 'I'.      09330000
093400                 88  ASC-MULTI-SKU-PREPK          VALUE 'M'.      09340000
093500                 88  ASC-SINGLE-SKU-PREPK         VALUE 'S'.      09350000
093600             15  ASC-FUNC08-RETURN-FLAG          PIC X(01).       09360000
093700                 88  ASC-FUNC08-RETURN-NO   VALUE 'N'.            09370000
093800                 88  ASC-FUNC08-RETURN-YES  VALUE 'Y'.            09380000
093900             15  ASC-FUNC09-RETURN-FLAG          PIC X(01).       09390000
094000                 88  ASC-FUNC09-RETURN-NO   VALUE 'N'.            09400000
094100                 88  ASC-FUNC09-RETURN-YES  VALUE 'Y'.            09410000
094200             15  ASC-AUTO-VE-SW                  PIC X(01).       09420000
094300                 88  ASC-AUTO-VE-YES                VALUE 'Y'.    09430000
094400                 88  ASC-AUTO-VE-NO                 VALUE 'N'.    09440000
094500/                                                                 09450000
094600     COPY DPWS013.                                                09460000
094700                                                                  09470000
094800*----------------------------------------------------------------*09480000
094900*                                                **   WR # 21361 *09490000
095000*  RECORD LAYOUT FOR LOGISTICS DOMAIN ITEM ACCESS MODULE         *09500000
095100*----------------------------------------------------------------*09510000
095200     COPY XLWS001.                                                09520000
095300*----------------------------------------------------------------*09530000
095400*   CHANGES MADE FOR WR # 21361 ENDS HERE.                        09540000
095500*----------------------------------------------------------------*09550000
095600                                                                  09560000
095700* COPY BOOK FOR CALLED MODULE PCKCS756                            09570000
095800     COPY PCWS238.                                                09580000
095900/                                                                 09590000
096000     EXEC SQL                                                     09600000
096100          INCLUDE TDISTHD                                         09610000
096200     END-EXEC.                                                    09620000
096300/                                                                 09630000
096400**        SUT_OTBND_PK                                            09640000
096500     EXEC SQL                                                     09650000
096600          INCLUDE SUT00041                                        09660000
096700     END-EXEC.                                                    09670000
096800/                                                                 09680000
096900     EXEC SQL                                                     09690000
097000          INCLUDE TRECEIV                                         09700000
097100     END-EXEC.                                                    09710000
097200/                                                                 09720000
097300     EXEC SQL                                                     09730000
097400          INCLUDE TRECITM                                         09740000
097500     END-EXEC.                                                    09750000
097600/                                                                 09760000
097700     EXEC SQL                                                     09770000
097800          INCLUDE TPOPRPK                                         09780000
097900     END-EXEC.                                                    09790000
098000/                                                                 09800000
098100     EXEC SQL                                                     09810000
098200          INCLUDE TRECDIS                                         09820000
098300     END-EXEC.                                                    09830000
098400/                                                                 09840000
098500     EXEC SQL                                                     09850000
098600          INCLUDE TPURCHS                                         09860000
098700     END-EXEC.                                                    09870000
098800/                                                                 09880000
098900     EXEC SQL                                                     09890000
099000          INCLUDE TPURITM                                         09900000
099100     END-EXEC.                                                    09910000
099200/                                                                 09920000
099300     EXEC SQL                                                     09930000
099400          INCLUDE TDISTDT                                         09940000
099500     END-EXEC.                                                    09950000
099600/                                                                 09960000
099700     EXEC SQL                                                     09970000
099800          INCLUDE TSHIPMT                                         09980000
099900     END-EXEC.                                                    09990000
100000/                                                                 10000000
100100     EXEC SQL                                                     10010000
100200          INCLUDE TSHPTPO                                         10020000
100300     END-EXEC.                                                    10030000
100400/                                                                 10040000
100500     EXEC SQL                                                     10050000
100600          INCLUDE TTRBNTF                                         10060000
100700     END-EXEC.                                                    10070000
100800/                                                                 10080000
100900     EXEC SQL                                                     10090000
101000          INCLUDE TTRBRSN                                         10100000
101100     END-EXEC.                                                    10110000
101200/                                                                 10120000
101300     EXEC SQL                                                     10130000
101400          INCLUDE TMDSEDP                                         10140000
101500     END-EXEC.                                                    10150000
101600/                                                                 10160000
101700     EXEC SQL                                                     10170000
101800          INCLUDE TMDSEAR                                         10180000
101900     END-EXEC.                                                    10190000
102000/                                                                 10200000
102100     EXEC SQL                                                     10210000
102200          INCLUDE XLT00025                                        10220032
102300     END-EXEC.                                                    10230000
102400/                                                                 10240000
102500*---------------------------------------------------------------* 10250000
102600*    DB2 AREA FOR TFLAREA - FACILITY AREA TABLE                 * 10260000
102700*---------------------------------------------------------------* 10270000
102800     EXEC SQL                                                     10280000
102900          INCLUDE TFLAREA                                         10290000
103000     END-EXEC.                                                    10300000
103100                                                                  10310000
103300*---------------------------------------------------------------* 10330000
103400*    DB2 AREA FOR TENTNME - EX-EXTERNAL ENTERPRISE NAME         * 10340000
103500*---------------------------------------------------------------* 10350000
103600     EXEC SQL                                                     10360000
103700          INCLUDE TENTNME                                         10370000
103800     END-EXEC.                                                    10380000
103900                                                                  10390000
103910*---------------------------------------------------------------* 10391026
103920*    DB2 AREA FOR TKRPRPM - PARAMETER TABLE                     * 10392026
103930*---------------------------------------------------------------* 10393026
103940     EXEC SQL                                                     10394026
103950          INCLUDE TKRPRPM                                         10395026
103960     END-EXEC.                                                    10396026
103970                                                                  10397026
104100     EXEC SQL                                                     10410000
104200          INCLUDE SQLCA                                           10420000
104300     END-EXEC.                                                    10430000
104400                                                                  10440000
104500/                                                                 10450000
104600*---------------------------------------------------------------* 10460000
104700*    DRIVING CURSOR                                               10470000
104800*---------------------------------------------------------------* 10480000
104900                                                                  10490000
105000     EXEC SQL                                                     10500000
105100          DECLARE SUSPEND-CSR CURSOR FOR                          10510000
105200           SELECT                                                 10520000
105300                  A.ORD_LNE_NBR                                   10530000
105400                , A.P2L_CART_CNT                                  10540000
105500                , A.FCSE_FCLTY_AREA_ID                            10550000
105600                , A.FCSE_CART_CNT                                 10560000
105700                , A.INPK_CART_CNT                                 10570000
105800                , A.OTPK_UNT_QTY                                  10580000
105900                , A.INPK_UNT_QTY                                  10590000
106000                , A.INPK_CNVYB_IND                                10600000
106100                , A.RSLTS_RCVD_TMST                               10610000
106200                , CHAR(DATE(A.FCSE_CNFRMN_TMST),USA)              10620000
106300                , CHAR(TIME(A.FCSE_CNFRMN_TMST),JIS)              10630000
106400                , A.PRCG_STAT_CDE                                 10640000
106500                , A.SPC_INSTR_DESC                                10650000
106600                , A.SYS_CRE_CDE                                   10660000
106700                , A.TOT_CART_CNT                                  10670000
106800                , A.PRC_AREA_MODU_ID                              10680000
106900                , A.FCSE_CNFRMN_TMST                              10690000
107000                , CURRENT TIMESTAMP                               10700000
107100                , A.PREPK_LNE_PRC_CDE                             10710000
107200             FROM TDISTHD A                                       10720000
107300            WHERE                                                 10730000
107400                  A.ORD_NBR        = :DK-ORD-NBR                  10740000
107500              AND A.RCVR_SEQ_NBR   = :DK-RCVR-NBR                 10750000
107600              AND A.ORD_LNE_NBR    BETWEEN :DK-LINE-LO            10760000
107700                                   AND     :DK-LINE-HI            10770000
107800              AND A.TOT_CART_CNT   > 0                            10780000
107900              ORDER BY                                            10790000
108000                       A.ORD_LNE_NBR                              10800000
108100     END-EXEC.                                                    10810000
108200                                                                  10820000
108300     EXEC SQL                                                     10830000
108400          DECLARE INVPAR-CSR CURSOR FOR                           10840000
108500              SELECT                                              10850000
108600                    A. LOC_NBR                                    10860000
108700              FROM                                                10870000
108800                    XLT_MDSE_INV_PARM A                           10880031
108900              WHERE                                               10890000
109000                   A.DC_CTOFF_DTE >= (CURRENT_DATE - 7 DAYS)      10900000
109100              AND  A.DC_CTOFF_DTE <= (CURRENT_DATE + 7 DAYS)      10910000
109110              AND  A.ACTV_IND         = 'Y'                       10911030
109120              AND  A.LOC_INV_STAT_CDE = 'IN'                      10912027
109200     END-EXEC.                                                    10920000
109300                                                                  10930000
109400/                                                                 10940000
109500*---------------------------------------------------------------* 10950000
109600*    THIS CURSOR CONTAINS ALL STORE NUMBERS ON TDISTDT FOR        10960000
109700*    A PO/RVCR/LINE                                               10970000
109800*---------------------------------------------------------------* 10980000
109900                                                                  10990000
110000     EXEC SQL                                                     11000000
110100          DECLARE TDISTDT-CSR CURSOR FOR                          11010000
110200           SELECT STR_NBR                                         11020000
110300             FROM TDISTDT A                                       11030000
110400           WHERE                                                  11040000
110500                  A.ORD_NBR      = :DK-ORD-NBR                    11050000
110600              AND A.RCVR_SEQ_NBR = :DK-RCVR-NBR                   11060000
110700              AND A.ORD_LNE_NBR  = :DISTHD-ORD-LNE-NBR            11070000
110800              ORDER BY STR_NBR                                    11080000
110900                                                                  11090000
111000     END-EXEC.                                                    11100000
111100                                                                  11110000
111200     EXEC SQL                                                     11120000
111300          DECLARE STR-CSR CURSOR FOR                              11130000
111400           SELECT FCSE_SPLT_UNT_QTY                               11140000
111500                 ,INPK_SPLT_UNT_QTY                               11150000
111600             FROM TDISTDT A                                       11160000
111700           WHERE                                                  11170000
111800                  A.ORD_NBR      = :ASC-KEY-PO-NBR                11180000
111900              AND A.RCVR_SEQ_NBR = :ASC-KEY-RCVR-NBR              11190000
112000              AND A.ORD_LNE_NBR  = :DK-LINE-NBR                   11200000
112100                                                                  11210000
112200     END-EXEC.                                                    11220000
112300                                                                  11230000
112400*----------------------------------------------------------------*11240000
112500* THIS CURSOR WILL BE USED WHEN CONFIRM ZERO (LOCAL FUNC 07) USED*11250000
112600* USED TO UPDATE DISTRO'S TO ZERO                                *11260000
112700*----------------------------------------------------------------*11270000
112800     EXEC SQL                                                     11280000
112900          DECLARE STORE-CSR CURSOR FOR                            11290000
113000           SELECT                                                 11300000
113100                 STR_NBR                                          11310000
113200               , FCSE_ACTL_UNT_QTY                                11320000
113300             FROM TDISTDT A                                       11330000
113400            WHERE                                                 11340000
113500                   A.ORD_NBR       = :DK-ORD-NBR                  11350000
113600              AND  A.RCVR_SEQ_NBR  = :DK-RCVR-NBR                 11360000
113700              AND  A.ORD_LNE_NBR   = :DK-LINE-NBR                 11370000
113800                                                                  11380000
113900              ORDER BY                                            11390000
114000                     STR_NBR                                      11400000
114100                                                                  11410000
114200     END-EXEC.                                                    11420000
114300                                                                  11430000
114400*---------------------------------------------------------------* 11440000
114500*    PREPK ORDER CURSOR                                           11450000
114600*---------------------------------------------------------------* 11460000
114700                                                                  11470000
114800     EXEC SQL                                                     11480000
114900          DECLARE PREPK-CSR CURSOR FOR                            11490000
115000           SELECT                                                 11500000
115100                  A.ORD_LNE_NBR                                   11510000
115200                , A.P2L_CART_CNT                                  11520000
115300                , A.FCSE_FCLTY_AREA_ID                            11530000
115400                , A.FCSE_CART_CNT                                 11540000
115500                , A.INPK_CART_CNT                                 11550000
115600                , A.OTPK_UNT_QTY                                  11560000
115700                , A.INPK_UNT_QTY                                  11570000
115800                , A.INPK_CNVYB_IND                                11580000
115900                , A.RSLTS_RCVD_TMST                               11590000
116000                , CHAR(DATE(A.FCSE_CNFRMN_TMST),USA)              11600000
116100                , CHAR(TIME(A.FCSE_CNFRMN_TMST),JIS)              11610000
116200                , A.PRCG_STAT_CDE                                 11620000
116300                , A.SPC_INSTR_DESC                                11630000
116400                , A.SYS_CRE_CDE                                   11640000
116500                , A.TOT_CART_CNT                                  11650000
116600                , A.PRC_AREA_MODU_ID                              11660000
116700                , A.FCSE_CNFRMN_TMST                              11670000
116800                , CURRENT TIMESTAMP                               11680000
116900                , B.CASE_PACK_QTY                                 11690000
117000                , B.DTL_CK_ITM_QTY                                11700000
117100                , B.PKSL_ITM_QTY                                  11710000
117200                , B.PREPK_ID                                      11720000
117300                , B.PREPK_RATO_QTY                                11730000
117400                , B.PREPK_ODD_UNT_QTY                             11740000
117500                , A.PREPK_LNE_PRC_CDE                             11750000
117600                , C.PK_SKU_NBR                                    11760000
117700             FROM TDISTHD A                                       11770000
117800                , TRECITM B                                       11780000
117900                , TPOPRPK C                                       11790000
118000            WHERE A.ORD_NBR        = :DK-ORD-NBR                  11800000
118100              AND A.RCVR_SEQ_NBR   = :DK-RCVR-NBR                 11810000
118200              AND A.ORD_LNE_NBR    BETWEEN :DK-LINE-LO            11820000
118300                                   AND     :DK-LINE-HI            11830000
118400              AND A.TOT_CART_CNT   > 0                            11840000
118500              AND A.PREPK_LNE_PRC_CDE = 'D'                       11850000
118600              AND B.ORD_NBR        = A.ORD_NBR                    11860000
118700              AND A.ORD_NBR        = C.PO_NBR                     11870000
118800              AND B.REC_SEQ_NBR    = A.RCVR_SEQ_NBR               11880000
118900              AND B.ORD_LNE_NBR    = A.ORD_LNE_NBR                11890000
119000              AND B.PREPK_ID       = C.PO_PREPK_ID                11900000
119100         ORDER BY A.ORD_LNE_NBR                                   11910000
119200     END-EXEC.                                                    11920000
119300                                                                  11930000
119400*---------------------------------------------------------------* 11940000
119500*    RECITM CURSOR USED FOR RETRIEVING ALL LINES OF A PREPK.      11950000
119600*---------------------------------------------------------------* 11960000
119700                                                                  11970000
119800     EXEC SQL                                                     11980000
119900          DECLARE PREPK-SEARCH-CSR CURSOR FOR                     11990000
120000           SELECT A.ORD_LNE_NBR                                   12000000
120100                , A.STATUS_CDE                                    12010000
120200                , A.PREPK_ODD_UNT_QTY                             12020000
120300             FROM TRECITM A                                       12030000
120400            WHERE A.ORD_NBR        = :DK-ORD-NBR                  12040000
120500              AND A.REC_SEQ_NBR    = :DK-RCVR-NBR                 12050000
120600              AND A.PREPK_ID       = :DK-PREPK-ID                 12060000
120700         ORDER BY A.ORD_LNE_NBR                                   12070000
120800     END-EXEC.                                                    12080000
120900                                                                  12090000
121000                                                                  12100000
121100***************************************************************** 12110000
121200***************************************************************** 12120000
121300 LINKAGE SECTION.                                                 12130000
121400                                                                  12140000
121500 01  DFHCOMMAREA.                                                 12150000
121600     05  FILLER                         OCCURS  1 TO 4072 TIMES   12160000
121700                                        DEPENDING ON EIBCALEN.    12170000
121800         10  FILLER                   PIC X.                      12180000
121900                                                                  12190000
122000/                                                                 12200000
122100 PROCEDURE DIVISION.                                              12210000
122200*---------------------------------------------------------------* 12220000
122300*   THIS MODULE IS THE HIGHEST PROCESSING LEVEL IN THE PROGRAM. * 12230000
122400*   FIRST, CALL THE CICS ARCHITECTURE API, PERFORM THE PROGRAM  * 12240000
122500*   PROCESSING AND THEN CALL THE CICS ARCHITECTURE API TO EXIT. * 12250000
122600*---------------------------------------------------------------* 12260000
122700 0000-MAIN-MODULE.                                                12270000
122800                                                                  12280000
122900     INITIALIZE DP030-CICS-API-FIELDS.                            12290000
123000                                                                  12300000
123100     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       12310000
123200     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          12320000
123300     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         12330000
123400                                                                  12340000
123500     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       12350000
123600                                                                  12360000
123700     MOVE LENGTH OF RC297AI        TO DP030-MAP-LENGTH (1).       12370000
123800     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     12380000
123900                                                                  12390000
124000     PERFORM 0001-CALL-CICS-ARCH-API.                             12400000
124100     PERFORM 1000-CONTROL-PROCESSING                              12410000
124200                                                                  12420000
124300     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     12430000
124400     PERFORM 0001-CALL-CICS-ARCH-API.                             12440000
124500                                                                  12450000
124600*---------------------------------------------------------------* 12460000
124700*   THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE   * 12470000
124800*   AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.         * 12480000
124900*---------------------------------------------------------------* 12490000
125000 0001-CALL-CICS-ARCH-API.                                         12500000
125110     CALL DP930-CICS-ARCH-API USING DFHEIBLK                      12511037
125200                                    DFHCOMMAREA                   12520037
125300                                    DP030-CICS-API-FIELDS         12530037
125400                                    DP020-STANDARD-COMMAREA       12540037
125500                                    RC297AI.                      12550037
125600                                                                  12560000
125700     IF  DP030-RC-CALL-SUCCESSFUL                                 12570000
125800         CONTINUE                                                 12580000
125900     ELSE                                                         12590000
126000         SET DP013-NO-ROLLBACK                                    12600000
126100             DP013-XCTL-DISPLAY-RESTART                           12610000
126200             DP013-CICS-ABEND      TO TRUE                        12620000
126300         MOVE '0001-CALL-CICS-ARCH-API'                           12630000
126400                                   TO DP013-PARAGRAPH             12640000
126420         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN CODE O12642037
126430-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      12643037
126700         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      12670000
126800         PERFORM DP013-0000-PROCESS-ABEND                         12680000
126900     END-IF.                                                      12690000
127000                                                                  12700000
127100*----------------------------------------------------------------*12710000
127200* PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT      *12720000
127300* COURSE OF ACTION IS FOR THIS TRANSACTION.                      *12730000
127400*                                                                *12740000
127500* NOTE:  PV-TOP-ITEM IS THE ITEM THAT IS REQUESTED TO BE AT THE  *12750000
127600*  TOP OF THE PANEL.  MOVING ASC-ITEM-AT-TOP-OF-PANEL TO THIS    *12760000
127700*  MEANS THAT POSITION WITHIN THE LIST WILL NOT CHANGE -- THIS   *12770000
127800*  IS THE DEFAULT WHICH WILL BE OVERRIDDEN BY SCROLLING ACTIONS. *12780000
127900*----------------------------------------------------------------*12790000
128000                                                                  12800000
128100 1000-CONTROL-PROCESSING.                                         12810000
128200                                                                  12820000
128300                                                                  12830000
128400     EVALUATE TRUE                                                12840000
128500         WHEN DP020-NEXT-ACT-INITIAL                              12850000
128600             INITIALIZE ASC-SPECIFIC-COMMAREA                     12860000
128700             EXEC CICS                                            12870000
128800                 ASSIGN APPLID (ASC-CICS-SYSTEM)                  12880000
128900             END-EXEC                                             12890000
129000             MOVE EIBTRMID         TO ASC-LIST-TERM-ID            12900000
129100                                      ASC-SEL-TERM-ID             12910000
129200             MOVE DP020-SRC-TASK-NUMBER                           12920000
129300                                   TO ASC-LIST-TASK-NUMBER        12930000
129400                                      ASC-SEL-TASK-NUMBER         12940000
129500             MOVE PC-LIST-QUEUE-SEQ                               12950000
129600                                   TO ASC-LIST-SEQ                12960000
129700             MOVE PC-SEL-QUEUE-SEQ TO ASC-SEL-SEQ                 12970000
129800             PERFORM 1100-PROCESS-INTER-APPL-COMM                 12980000
129900                                                                  12990000
130000***-----$TEMPLATE NOTE$-------------------------------------------13000000
130100*** IF THE DATA EXPECTED IS NOT RECEIVED FROM CALLING APPLICATION,13010000
130200*** SETUP APPROPRIATE MESSAGE AND SEVERITY AND SET APPL-ERROR TO  13020000
130300*** TRUE, THIS WILL RETURN TO CALLING APPLICATION WHEN API CALLED.13030000
130400***---------------------------------------------------------------13040000
130500             IF  PS-COMMAREA-NOT-VALID                            13050000
130600                 MOVE PC-TSYMSG-99901                             13060000
130700                                   TO DP020-MSG-NUMBER            13070000
130800                 SET DP020-MSG-FATAL                              13080000
130900                                   TO TRUE                        13090000
131000                 SET DP020-NEXT-ACT-APPL-ERROR                    13100000
131100                                   TO TRUE                        13110000
131200             ELSE                                                 13120000
131300                 PERFORM 3200-RESET-ATTRIBUTES                    13130000
131400                 PERFORM 4000-BUILD-INITIAL-PANEL                 13140000
131500             END-IF                                               13150000
131600                                                                  13160000
131700         WHEN DP020-NEXT-ACT-READ-MAP                             13170000
131800             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        13180000
131900                                   TO PV-TOP-ITEM                 13190000
132000             PERFORM 2000-PROCESS-PANEL                           13200000
132100                                                                  13210000
132200         WHEN DP020-NEXT-ACT-RETURN                               13220000
132300             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        13230000
132400                                   TO PV-TOP-ITEM                 13240000
132500             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    13250000
132600             PERFORM 6000-REFRESH-PANEL-FROM-TEMP                 13260000
132700             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   13270000
132800             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 13280000
132900                                                                  13290000
133000         WHEN OTHER                                               13300000
133100             SET DP013-LOGIC-ABEND TO TRUE                        13310000
133200             SET DP013-NO-ROLLBACK TO TRUE                        13320000
133300             MOVE '1000-CONTROL-PROCESSING'                       13330000
133400                                   TO DP013-PARAGRAPH             13340000
133500             MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    13350000
133600                                   TO DP013-MESSAGE-TEXT(1)       13360000
133700             PERFORM DP013-0000-PROCESS-ABEND                     13370000
133800     END-EVALUATE.                                                13380000
133900                                                                  13390000
134000/                                                                 13400000
134100*----------------------------------------------------------------*13410000
134200* MOVE DATA PASSED THROUGH THE INTER-APPL COMMAREA               *13420000
134300*----------------------------------------------------------------*13430000
134400                                                                  13440000
134500 1100-PROCESS-INTER-APPL-COMM.                                    13450000
134600                                                                  13460000
134700     SET PS-COMMAREA-VALID         TO TRUE.                       13470000
134800     MOVE SPACE                    TO ASC-START-ITEM-REQUEST.     13480000
134900                                                                  13490000
135000     IF DP020-INT-APPL-FORMAT-IND = '2'                           13500000
135100         MOVE RC015-REC-SEQ-NBR       TO ASC-KEY-RCVR-NBR         13510000
135200         MOVE RC015-PO-NBR            TO ASC-KEY-PO-NBR           13520000
135300         MOVE RC015-SEL-QUEUE-NAME    TO ASC-SEL-QUEUE-NAME-IN    13530000
135400     ELSE                                                         13540000
135500         MOVE RC015-NUMBER-OF-SELECTED-ITEMS                      13550000
135600                        TO ASC-NUMBER-OF-SELECTED-ITEMS           13560000
135700         MOVE RC015-NUMBER-OF-TS-ITEMS                            13570000
135800                        TO ASC-NUMBER-OF-TS-ITEMS                 13580000
135900         MOVE RC015-SEL-QUEUE-NAME                                13590000
136000                        TO ASC-SEL-QUEUE-NAME-IN                  13600000
136100         MOVE RC013-MAX-ITEMS         TO ASC-SEL-SUB              13610000
136200         MOVE ZERO                    TO PV-SEL-QUEUE-ITEM        13620000
136300         PERFORM 2300-GET-NEXT-RECORD                             13630000
136400     END-IF.                                                      13640000
136500                                                                  13650000
136600/                                                                 13660000
136700*----------------------------------------------------------------*13670000
136800* DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *13680000
136900* ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *13690000
137000* USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *13700000
137100* OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *13710000
137200* FUNCTION KEYS CAN GET THIS FAR.                                *13720000
137300*----------------------------------------------------------------*13730000
137400                                                                  13740000
137500 2000-PROCESS-PANEL.                                              13750000
137600     SET PS-NEXT-SCREEN TO TRUE.                                  13760000
137700     EVALUATE TRUE                                                13770000
137800         WHEN DP020-SRC-AID = DP016-CLEAR                         13780000
137900             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    13790000
138000             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   13800000
138100             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 13810000
138200                                                                  13820000
138300         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    13830000
138400             MOVE ASC-KEY-FCLTY-ID    TO DK-FCLTY-ID              13840000
138500             MOVE ASC-KEY-PO-NBR      TO DK-ORD-NBR               13850000
138600             MOVE ASC-KEY-RCVR-NBR    TO DK-RCVR-NBR              13860000
138700***          MOVE ASC-KEY-OPER-UNT-ID TO DK-OPER-UNT-ID           13870000
138800             MOVE ASC-TRECEIV-DC      TO DK-OPER-UNT-ID           13880000
138900             MOVE ASC-KEY-FCLTY-ID    TO DK-FCLTY-ID              13890000
139000             SET ASC-CONFIRM-NO       TO TRUE                     13900000
139100             SET ASC-FUNC01-CONFIRM-NO TO TRUE                    13910000
139200             SET ASC-FUNC06-UPDATE-NO  TO TRUE                    13920000
139300             SET ASC-FUNC07-CONFIRM-NO TO TRUE                    13930000
139400             PERFORM 2050-DELETE-LIST-QUEUE                       13940000
139500             PERFORM 3200-RESET-ATTRIBUTES                        13950000
139600             PERFORM 4000-BUILD-INITIAL-PANEL                     13960000
139700                                                                  13970000
139800         WHEN DP020-FK-DESELECT(DP020-SRC-AID)                    13980000
139900             PERFORM 2140-DESELECT-ALL-ITEMS                      13990000
140000             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 14000000
140100                                                                  14010000
140200         WHEN DP020-FK-SELECT-ALL(DP020-SRC-AID)                  14020000
140300             PERFORM 2150-SELECT-ALL-ITEMS                        14030000
140400             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 14040000
140500                                                                  14050000
140600         WHEN OTHER                                               14060000
140700             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 14070000
140800             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   14080000
140900             IF  PS-NO-ERROR                                      14090000
141000                 SET DP030-CONTINUE-GO TO TRUE                    14100000
141100                 PERFORM 2100-CHECK-FUNCTION-KEY                  14110000
141200***              IF PS-NO-ERROR                                   14120000
141300                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         14130000
141400***              END-IF                                           14140000
141500             ELSE                                                 14150000
141600                 SET DP030-OVERRIDE-GO TO TRUE                    14160000
141700                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             14170000
141800             END-IF                                               14180000
141900     END-EVALUATE.                                                14190000
142000                                                                  14200000
142100/                                                                 14210000
142200*----------------------------------------------------------------*14220000
142300*  DELETE THE LIST ITEMS TEMP STORAGE QUEUE.                     *14230000
142400*----------------------------------------------------------------*14240000
142500 2050-DELETE-LIST-QUEUE.                                          14250000
142600                                                                  14260000
142700     EXEC CICS                                                    14270000
142800         DELETEQ TS                                               14280000
142900           QUEUE (ASC-LIST-QUEUE-NAME)                            14290000
143000            RESP (PV-CICS-RESP)                                   14300000
143100     END-EXEC.                                                    14310000
143200                                                                  14320000
143300                                                                  14330000
143400                                                                  14340000
143500     IF (PV-CICS-RESP = DFHRESP(NORMAL)) OR                       14350000
143600        (PV-CICS-RESP = DFHRESP(QIDERR))                          14360000
143700         CONTINUE                                                 14370000
143800     ELSE                                                         14380000
143900         SET DP013-CICS-ABEND      TO TRUE                        14390000
144000         SET DP013-NO-ROLLBACK     TO TRUE                        14400000
144100                                                                  14410000
144200         MOVE '2050-DELETE-LIST-QUEUE'                            14420000
144300                                   TO DP013-PARAGRAPH             14430000
144400         MOVE 'ERROR TRYING TO DELETE LIST TEMP STORAGE QUEUE'    14440000
144500                                   TO DP013-MESSAGE-TEXT (1)      14450000
144600         PERFORM DP013-0000-PROCESS-ABEND                         14460000
144700     END-IF.                                                      14470000
144800                                                                  14480000
144900     MOVE ZERO                     TO ASC-HIGHEST-BLOCK-WRITTEN.  14490000
145000                                                                  14500000
145100/                                                                 14510000
145200*----------------------------------------------------------------*14520000
145300* ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED FIRST.*14530000
145400* NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED FROM THE  *14540000
145500* CICS ARCHITECTURE API.                                         *14550000
145600*----------------------------------------------------------------*14560000
145700 2100-CHECK-FUNCTION-KEY.                                         14570000
145800                                                                  14580000
145900     SET PS-NEXT-SCREEN TO TRUE.                                  14590000
146000                                                                  14600000
146100     EVALUATE TRUE                                                14610000
146200                                                                  14620000
146300*F16 = CONFIRM                                                    14630000
146400     WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)                  14640000
146500          IF  ASC-AUTO-VE-YES                                     14650000
146600              SET RC039-FUNC-CNFM           TO TRUE               14660000
146700              PERFORM 2108-LINK-FKEY-MODULE                       14670000
146800          END-IF                                                  14680000
146900                                                                  14690000
147000          IF (ASC-AUTO-VE-YES  AND                                14700000
147100              RC039-SUCCESSFUL AND                                14710000
147200              PS-FUNCTION-RACF-YES)  OR                           14720000
147300              ASC-AUTO-VE-NO                                      14730000
147400                                                                  14740000
147500             EVALUATE TRUE                                        14750000
147600             WHEN  ASC-RECEIVER-NOT-ARRIVED                       14760000
147700                   MOVE PC-TSYMSG-01730    TO DP020-MSG-NUMBER    14770000
147800                   SET DP020-MSG-FATAL     TO TRUE                14780000
147900                   MOVE -1                 TO MR-SELECTL (1)      14790000
148000                   SET DP030-SET-CURSOR-APPL-1                    14800000
148100                                           TO TRUE                14810000
148200                   SET PS-ERROR            TO TRUE                14820000
148300                   SET ASC-NO-TSQ-UPDATE   TO TRUE                14830000
148400             WHEN  ASC-NUMBER-OF-SELECTED-ITEMS = ZERO            14840000
148500                   MOVE PC-TSYMSG-00057    TO DP020-MSG-NUMBER    14850000
148600                   SET DP020-MSG-FATAL     TO TRUE                14860000
148700                   MOVE -1                 TO MR-SELECTL (1)      14870000
148800                   SET DP030-SET-CURSOR-APPL-1                    14880000
148900                                           TO TRUE                14890000
149000                   SET PS-ERROR            TO TRUE                14900000
149100                   SET ASC-NO-TSQ-UPDATE   TO TRUE                14910000
149200             WHEN  OTHER                                          14920000
149300                   SET PS-RECITM-ODD-UNITS-NO TO TRUE             14930000
149400                   SET PS-DISTDT-ODD-UNITS-NO TO TRUE             14940000
149500                                                                  14950000
149600                   PERFORM 2101-CONFIRM-PRE-EDIT                  14960000
149700                   VARYING PV-ITEM  FROM 1 BY 1                   14970000
149800                     UNTIL PV-ITEM > ASC-HIGHEST-BLOCK-WRITTEN    14980000
149900                                                                  14990000
150000                   IF  PS-DO-SUBMIT-E200                          15000000
150100                       SET ASC-FUNC01-CONFIRM-YES TO TRUE         15010000
150200                       IF (ASC-PKGNG-CDE = 'I' OR 'M')  AND       15020000
150300                           PS-RECITM-ODD-UNITS-YES      AND       15030000
150400                           PS-DISTDT-ODD-UNITS-NO                 15040000
150500                           MOVE PC-TSYMSG-02457                   15050000
150600                                              TO DP020-MSG-NUMBER 15060000
150700                       ELSE                                       15070000
150800                       IF  PS-PROCESS-QTY-ZERO                    15080000
150900                           MOVE PC-TSYMSG-01875                   15090000
151000                                              TO DP020-MSG-NUMBER 15100000
151100                       ELSE                                       15110000
151200                           MOVE PC-TSYMSG-01856                   15120000
151300                                              TO DP020-MSG-NUMBER 15130000
151400                       END-IF                                     15140000
151500                       END-IF                                     15150000
151600                   SET DP020-MSG-WARNING TO TRUE                  15160000
151700                   END-IF                                         15170000
151800             END-EVALUATE                                         15180000
151900          END-IF                                                  15190000
152000          PERFORM 3200-RESET-ATTRIBUTES                           15200000
152100                                                                  15210000
152200*F17 = UNCONFIRM                                                  15220000
152300     WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)                  15230000
152400          IF  ASC-AUTO-VE-YES                                     15240000
152500              SET RC039-FUNC-UNCNFM           TO TRUE             15250000
152600              PERFORM 2108-LINK-FKEY-MODULE                       15260000
152700          END-IF                                                  15270000
152800                                                                  15280000
152900          IF (ASC-AUTO-VE-YES  AND                                15290000
153000              RC039-SUCCESSFUL AND                                15300000
153100              PS-FUNCTION-RACF-YES)  OR                           15310000
153200              ASC-AUTO-VE-NO                                      15320000
153300              IF  ASC-NUMBER-OF-SELECTED-ITEMS = ZERO             15330000
153400                  MOVE PC-TSYMSG-00057  TO DP020-MSG-NUMBER       15340000
153500                  SET DP020-MSG-FATAL   TO TRUE                   15350000
153600                  MOVE -1               TO MR-SELECTL (1)         15360000
153700                  SET DP030-SET-CURSOR-APPL-1                     15370000
153800                                        TO TRUE                   15380000
153900                  SET PS-ERROR          TO TRUE                   15390000
154000                  SET ASC-NO-TSQ-UPDATE TO TRUE                   15400000
154100              ELSE                                                15410000
154200                  PERFORM 8100-UNCONFIRM                          15420000
154300                  VARYING PV-ITEM  FROM 1 BY 1                    15430000
154400                    UNTIL PV-ITEM >  ASC-HIGHEST-BLOCK-WRITTEN    15440000
154500              END-IF                                              15450000
154600          END-IF                                                  15460000
154700          PERFORM 3200-RESET-ATTRIBUTES                           15470000
154800                                                                  15480000
154900******************************************************************15490000
155000     WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)                  15500000
155100*F18 = TROUBLE LIST                                               15510000
155200         MOVE ASC-KEY-PO-NBR          TO RC012-PO-NBR             15520000
155300         MOVE ASC-KEY-RCVR-NBR        TO RC012-REC-SEQ-NBR        15530000
155400         MOVE ASC-KEY-OPER-UNT-ID     TO RC012-OPER-UNT-ID        15540000
155500         MOVE ASC-KEY-FCLTY-ID        TO RC012-FCLTY-ID           15550000
155600                                                                  15560000
155700     WHEN DP020-FK-LOCAL-FUNC-05 (DP020-SRC-AID)                  15570000
155800*F22=STRLST (RCKCS298 - 'RCLFCSTR')                               15580000
155900         IF ASC-NUMBER-OF-SELECTED-ITEMS = ZERO                   15590000
156000             MOVE PC-TSYMSG-00057  TO DP020-MSG-NUMBER            15600000
156100             MOVE -1               TO MR-SELECTL (1)              15610000
156200             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  15620000
156300             SET PS-ERROR          TO TRUE                        15630000
156400             SET DP030-OVERRIDE-GO TO TRUE                        15640000
156500             SET DP020-MSG-FATAL   TO TRUE                        15650000
156600             SET ASC-NO-TSQ-UPDATE TO TRUE                        15660000
156700         ELSE                                                     15670000
156800             MOVE ASC-NUMBER-OF-SELECTED-ITEMS                    15680000
156900                                   TO RC013-SELECTED-ITEMS        15690000
157000             PERFORM 5000-PREPARE-SEL-QUEUE                       15700000
157100             MOVE ASC-NUMBER-OF-SELECTED-ITEMS                    15710000
157200               TO RC015-NUMBER-OF-SELECTED-ITEMS                  15720000
157300         END-IF                                                   15730000
157400                                                                  15740000
157500     WHEN DP020-FK-CONFIRM (DP020-SRC-AID)                        15750000
157600*F2 = CONFIRMS THE USER'S INTENT TO CONFIRM OR UNCONFIRM A LINE   15760000
157700         IF  ASC-NUMBER-OF-SELECTED-ITEMS = ZERO                  15770000
157800             MOVE PC-TSYMSG-00057      TO DP020-MSG-NUMBER        15780000
157900             SET DP020-MSG-FATAL       TO TRUE                    15790000
158000             MOVE -1                   TO MR-SELECTL (1)          15800000
158100             SET DP030-SET-CURSOR-APPL-1                          15810000
158200                                   TO TRUE                        15820000
158300             SET PS-ERROR              TO TRUE                    15830000
158400             SET ASC-NO-TSQ-UPDATE TO TRUE                        15840000
158500         ELSE                                                     15850000
158600             EVALUATE TRUE                                        15860000
158700                 WHEN ASC-CONFIRM-YES                             15870000
158800                     PERFORM 8110-PROCESS-UNCONFIRM               15880000
158900                     VARYING PV-ITEM  FROM 1 BY 1                 15890000
159000                     UNTIL PV-ITEM >  ASC-HIGHEST-BLOCK-WRITTEN   15900000
159100                 WHEN ASC-FUNC01-CONFIRM-YES                      15910000
159200                     IF ASC-AUTO-VE-YES                           15920000
159300                         PERFORM 4501-UPDATE-CNFRM-UNITS          15930000
159400                     END-IF                                       15940000
159500                     PERFORM 8000-CONFIRM                         15950000
159600                     VARYING PV-ITEM  FROM 1 BY 1                 15960000
159700                     UNTIL PV-ITEM >  ASC-HIGHEST-BLOCK-WRITTEN   15970000
159800                 WHEN ASC-FUNC07-CONFIRM-YES                      15980000
159900                     PERFORM 2105-CONFIRM-ZERO-PRE-EDIT           15990000
160000                        VARYING PV-ITEM  FROM 1 BY 1              16000000
160100                        UNTIL PV-ITEM > ASC-HIGHEST-BLOCK-WRITTEN 16010000
160200                     PERFORM 8000-CONFIRM                         16020000
160300                        VARYING PV-ITEM  FROM 1 BY 1              16030000
160400                        UNTIL PV-ITEM > ASC-HIGHEST-BLOCK-WRITTEN 16040000
160500             END-EVALUATE                                         16050000
160600         END-IF                                                   16060000
160700                                                                  16070000
160800     WHEN DP020-FK-LOCAL-FUNC-06 (DP020-SRC-AID)                  16080000
160900*F15 = UPDATE                                                     16090000
161000         EVALUATE TRUE                                            16100000
161100         WHEN ASC-NUMBER-OF-SELECTED-ITEMS = ZERO                 16110000
161200             MOVE PC-TSYMSG-00057      TO DP020-MSG-NUMBER        16120000
161300             SET DP020-MSG-FATAL       TO TRUE                    16130000
161400             MOVE -1                   TO MR-SELECTL (1)          16140000
161500             SET DP030-SET-CURSOR-APPL-1                          16150000
161600                                   TO TRUE                        16160000
161700             SET PS-ERROR              TO TRUE                    16170000
161800             SET ASC-NO-TSQ-UPDATE TO TRUE                        16180000
161900                                                                  16190000
162000         WHEN OTHER                                               16200000
162100                                                                  16210000
162200             PERFORM 2160-UPDATE-PRE-EDIT                         16220000
162300                 VARYING PV-ITEM  FROM 1 BY 1                     16230000
162400                 UNTIL PV-ITEM >  ASC-HIGHEST-BLOCK-WRITTEN       16240000
162500                                                                  16250000
162600             MOVE  ZEROES  TO  PV-NUMBER-OF-UPDATED-ITEMS         16260000
162700                                                                  16270000
162800             IF  ASC-FUNC06-UPDATE-YES                            16280000
162900                 PERFORM 8310-UPDATE                              16290000
163000                 VARYING PV-ITEM  FROM 1 BY 1                     16300000
163100                 UNTIL PV-ITEM >  ASC-HIGHEST-BLOCK-WRITTEN       16310000
163200                                                                  16320000
163300                 IF  PV-NUMBER-OF-UPDATED-ITEMS  =  0             16330000
163400                     MOVE PC-TSYMSG-01169 TO DP020-MSG-NUMBER     16340000
163500                     SET DP020-MSG-WARNING TO TRUE                16350000
163600                 END-IF                                           16360000
163700                                                                  16370000
163800             END-IF                                               16380000
163900         END-EVALUATE                                             16390000
164000                                                                  16400000
164100*12/21 - BEGIN                                                    16410000
164200*F24 = CONFIRM AT ZERO                                            16420000
164300     WHEN DP020-FK-LOCAL-FUNC-07 (DP020-SRC-AID)                  16430000
164400* DMH                                                             16440000
164500* DMH     IF  ASC-AUTO-VE-YES                                     16450000
164600* DMH         SET RC039-FUNC-CNFM           TO TRUE               16460000
164700* DMH         PERFORM 2108-LINK-FKEY-MODULE                       16470000
164800* DMH     END-IF                                                  16480000
164900                                                                  16490000
165000          IF  ASC-AUTO-VE-YES                                     16500000
165100              MOVE PC-TSYMSG-03304        TO DP020-MSG-NUMBER     16510000
165200              SET DP020-MSG-FATAL         TO TRUE                 16520000
165300              MOVE -1                     TO MR-SELECTL (1)       16530000
165400              SET DP030-SET-CURSOR-APPL-1                         16540000
165500                  PS-ERROR                                        16550000
165600                  ASC-NO-TSQ-UPDATE       TO TRUE                 16560000
165700          ELSE                                                    16570000
165800          IF  ASC-AUTO-VE-NO                                      16580000
165900              EVALUATE TRUE                                       16590000
166000                  WHEN  ASC-RECEIVER-NOT-ARRIVED                  16600000
166100                        MOVE PC-TSYMSG-01730  TO DP020-MSG-NUMBER 16610000
166200                        SET DP020-MSG-FATAL   TO TRUE             16620000
166300                        MOVE -1               TO MR-SELECTL (1)   16630000
166400                        SET DP030-SET-CURSOR-APPL-1               16640000
166500                                              TO TRUE             16650000
166600                        SET PS-ERROR          TO TRUE             16660000
166700                        SET ASC-NO-TSQ-UPDATE TO TRUE             16670000
166800                                                                  16680000
166900                  WHEN  ASC-NUMBER-OF-SELECTED-ITEMS = ZERO       16690000
167000                        MOVE PC-TSYMSG-00057  TO DP020-MSG-NUMBER 16700000
167100                        SET DP020-MSG-FATAL   TO TRUE             16710000
167200                        MOVE -1               TO MR-SELECTL (1)   16720000
167300                        SET DP030-SET-CURSOR-APPL-1               16730000
167400                                              TO TRUE             16740000
167500                        SET PS-ERROR          TO TRUE             16750000
167600                        SET ASC-NO-TSQ-UPDATE TO TRUE             16760000
167700                                                                  16770000
167800                  WHEN  OTHER                                     16780000
167900*                       PERFORM 2105-CONFIRM-ZERO-PRE-EDIT        16790000
168000*                       VARYING PV-ITEM  FROM 1 BY 1              16800000
168100*                       UNTIL PV-ITEM > ASC-HIGHEST-BLOCK-WRITTEN 16810000
168200                                                                  16820000
168300*                       IF  PS-DO-SUBMIT-E200                     16830000
168400                            SET ASC-FUNC07-CONFIRM-YES TO TRUE    16840000
168500                            IF  PS-PROCESS-QTY-ZERO               16850000
168600                                MOVE PC-TSYMSG-01875              16860000
168700                                          TO DP020-MSG-NUMBER     16870000
168800                            ELSE                                  16880000
168900                                MOVE PC-TSYMSG-01856              16890000
169000                                          TO DP020-MSG-NUMBER     16900000
169100                            END-IF                                16910000
169200                            SET DP020-MSG-WARNING TO TRUE         16920000
169300*                       END-IF                                    16930000
169400                                                                  16940000
169500              END-EVALUATE                                        16950000
169600          END-IF                                                  16960000
169700          END-IF                                                  16970000
169800          PERFORM 3200-RESET-ATTRIBUTES                           16980000
169900*12/21 - END                                                      16990000
170000                                                                  17000000
170100*F19=PCKDTLST (RCKCS801 - 'RCMPKDTL')                             17010000
170200     WHEN DP020-FK-LOCAL-FUNC-08 (DP020-SRC-AID)                  17020000
170300         IF NOT (ASC-PKGNG-CDE = 'I' OR 'M')                      17030000
170400             MOVE PC-TSYMSG-02185  TO DP020-MSG-NUMBER            17040000
170500             MOVE -1               TO MR-SELECTL (1)              17050000
170600             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  17060000
170700             SET PS-ERROR          TO TRUE                        17070000
170800             SET DP030-OVERRIDE-GO TO TRUE                        17080000
170900             SET DP020-MSG-FATAL   TO TRUE                        17090000
171000             SET ASC-NO-TSQ-UPDATE TO TRUE                        17100000
171100         ELSE                                                     17110000
171200         IF ASC-NUMBER-OF-SELECTED-ITEMS = ZERO                   17120000
171300             MOVE PC-TSYMSG-00057  TO DP020-MSG-NUMBER            17130000
171400             MOVE -1               TO MR-SELECTL (1)              17140000
171500             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  17150000
171600             SET PS-ERROR          TO TRUE                        17160000
171700             SET DP030-OVERRIDE-GO TO TRUE                        17170000
171800             SET DP020-MSG-FATAL   TO TRUE                        17180000
171900             SET ASC-NO-TSQ-UPDATE TO TRUE                        17190000
172000         ELSE                                                     17200000
172100         IF ASC-NUMBER-OF-SELECTED-ITEMS > +1                     17210000
172200             MOVE PC-TSYMSG-02449  TO DP020-MSG-NUMBER            17220000
172300             MOVE -1               TO MR-SELECTL (1)              17230000
172400             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  17240000
172500             SET PS-ERROR          TO TRUE                        17250000
172600             SET DP030-OVERRIDE-GO TO TRUE                        17260000
172700             SET DP020-MSG-FATAL   TO TRUE                        17270000
172800             SET ASC-NO-TSQ-UPDATE TO TRUE                        17280000
172900         ELSE                                                     17290000
173000             MOVE ASC-KEY-PO-NBR      TO RC800-REC-NBR-N          17300000
173100             MOVE ASC-KEY-RCVR-NBR    TO RC800-REC-SEQ-NBR-N      17310000
173200***          MOVE ASC-KEY-OPER-UNT-ID TO RC800-OPER-UNIT-ID       17320000
173300             MOVE ASC-TRECEIV-DC      TO RC800-OPER-UNIT-ID       17330000
173400             MOVE ASC-KEY-FCLTY-ID    TO RC800-FACILITY-ID        17340000
173500             MOVE ASC-NUMBER-OF-SELECTED-ITEMS                    17350000
173600                                      TO RC801-SELECTED-ITEMS     17360000
173700             PERFORM 5500-PREPARE-SEL-QUEUE                       17370000
173800             MOVE ASC-NUMBER-OF-SELECTED-ITEMS                    17380000
173900               TO RC800-NUMBER-OF-SELECTED-ITEMS                  17390000
174000             SET ASC-FUNC08-RETURN-YES TO TRUE                    17400000
174100         END-IF                                                   17410000
174200         END-IF                                                   17420000
174300         END-IF                                                   17430000
174400                                                                  17440000
174500     WHEN DP020-FK-LOCAL-FUNC-09 (DP020-SRC-AID)                  17450000
174600*F20=EXPAND (RCKCS812 - 'RCLFCPLN')                               17460000
174700         IF NOT (ASC-PKGNG-CDE = 'I' OR 'M')                      17470000
174800             MOVE PC-TSYMSG-02185  TO DP020-MSG-NUMBER            17480000
174900             MOVE -1               TO MR-SELECTL (1)              17490000
175000             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  17500000
175100             SET PS-ERROR          TO TRUE                        17510000
175200             SET DP030-OVERRIDE-GO TO TRUE                        17520000
175300             SET DP020-MSG-FATAL   TO TRUE                        17530000
175400             SET ASC-NO-TSQ-UPDATE TO TRUE                        17540000
175500         ELSE                                                     17550000
175600         IF ASC-NUMBER-OF-SELECTED-ITEMS = ZERO                   17560000
175700             MOVE PC-TSYMSG-00057  TO DP020-MSG-NUMBER            17570000
175800             MOVE -1               TO MR-SELECTL (1)              17580000
175900             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  17590000
176000             SET PS-ERROR          TO TRUE                        17600000
176100             SET DP030-OVERRIDE-GO TO TRUE                        17610000
176200             SET DP020-MSG-FATAL   TO TRUE                        17620000
176300             SET ASC-NO-TSQ-UPDATE TO TRUE                        17630000
176400         ELSE                                                     17640000
176500             MOVE ASC-KEY-PO-NBR      TO RC800-REC-NBR-N          17650000
176600             MOVE ASC-KEY-RCVR-NBR    TO RC800-REC-SEQ-NBR-N      17660000
176700***          MOVE ASC-KEY-OPER-UNT-ID TO RC800-OPER-UNIT-ID       17670000
176800             MOVE ASC-TRECEIV-DC      TO RC800-OPER-UNIT-ID       17680000
176900             MOVE ASC-KEY-FCLTY-ID    TO RC800-FACILITY-ID        17690000
177000             MOVE ASC-NUMBER-OF-SELECTED-ITEMS                    17700000
177100                                      TO RC801-SELECTED-ITEMS     17710000
177200             PERFORM 5500-PREPARE-SEL-QUEUE                       17720000
177300             MOVE ASC-NUMBER-OF-SELECTED-ITEMS                    17730000
177400               TO RC800-NUMBER-OF-SELECTED-ITEMS                  17740000
177500             SET ASC-FUNC09-RETURN-YES TO TRUE                    17750000
177600         END-IF                                                   17760000
177700         END-IF                                                   17770000
177800                                                                  17780000
177900     WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                      17790000
178000             MOVE +1 TO PV-TOP-ITEM                               17800000
178100             PERFORM 3200-RESET-ATTRIBUTES                        17810000
178200             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 17820000
178300                                                                  17830000
178400     WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                       17840000
178500             PERFORM 2110-BROWSE-BACKWARD                         17850000
178600             PERFORM 3200-RESET-ATTRIBUTES                        17860000
178700             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 17870000
178800                                                                  17880000
178900     WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                       17890000
179000             PERFORM 2120-BROWSE-FORWARD                          17900000
179100             PERFORM 3200-RESET-ATTRIBUTES                        17910000
179200             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 17920000
179300                                                                  17930000
179400     WHEN DP020-SRC-AID = DP016-ENTER                             17940000
179500             PERFORM 2130-CHECK-FOR-JUMP-BROWSE                   17950000
179600             EVALUATE TRUE                                        17960000
179700             WHEN ASC-CONFIRM-YES                                 17970000
179800                 MOVE PC-TSYMSG-01761     TO DP020-MSG-NUMBER     17980000
179900                 SET DP020-MSG-WARNING        TO TRUE             17990000
180000             WHEN ASC-FUNC01-CONFIRM-YES                          18000000
180100             WHEN ASC-FUNC07-CONFIRM-YES                          18010000
180200                 MOVE PC-TSYMSG-01856     TO DP020-MSG-NUMBER     18020000
180300                 SET DP020-MSG-WARNING        TO TRUE             18030000
180400             END-EVALUATE                                         18040000
180500             IF PS-NO-ERROR                                       18050000
180600                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             18060000
180700             END-IF                                               18070000
180800                                                                  18080000
180900     WHEN OTHER                                                   18090000
181000         PERFORM 2050-DELETE-LIST-QUEUE                           18100000
181100         PERFORM 4000-BUILD-INITIAL-PANEL                         18110000
181200         PERFORM 3200-RESET-ATTRIBUTES                            18120000
181300         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                     18130000
181400     END-EVALUATE.                                                18140000
181500                                                                  18150000
181600 2101-CONFIRM-PRE-EDIT.                                           18160000
181700     MOVE +1                       TO ASC-BLK-SUB.                18170000
181800     PERFORM 5100-WRITE-TEMP-STORAGE.                             18180000
181900     ADD +1                        TO ASC-BLK-SUB.                18190000
182000     PERFORM 5100-WRITE-TEMP-STORAGE.                             18200000
182100                                                                  18210000
182200     PERFORM 6112-READ-LIST-QUEUE.                                18220000
182300                                                                  18230000
182400     MOVE ASC-KEY-PO-NBR             TO DK-ORD-NBR                18240000
182500     MOVE ASC-KEY-RCVR-NBR           TO DK-RCVR-NBR               18250000
182600     SET  PS-PROCESS-QTY-NOT-ZERO    TO TRUE.                     18260000
182700                                                                  18270000
182800     IF PV-CICS-RESP = DFHRESP (NORMAL)                           18280000
182900         PERFORM                                                  18290000
183000         VARYING LQW-IDX  FROM 1 BY 1                             18300000
183100         UNTIL   LQW-IDX > PC-ITEMS-PER-PANEL OR                  18310000
183200                 LQW-LIST-ITEM-NUMBER (LQW-IDX) = ZERO            18320000
183300                                                                  18330000
183400             IF  LQW-SELECT (LQW-IDX)                             18340000
183500                 IF  LQW-LINE-PROTECT (LQW-IDX)                   18350000
183600                     MOVE PC-TSYMSG-01809                         18360000
183700                                               TO DP020-MSG-NUMBER18370000
183800                     SET DP020-MSG-FATAL       TO TRUE            18380000
183900                     MOVE -1                   TO MR-SELECTL (1)  18390000
184000                     SET DP030-SET-CURSOR-APPL-1                  18400000
184100                                               TO TRUE            18410000
184200                     SET PS-ERROR              TO TRUE            18420000
184300                     SET ASC-NO-TSQ-UPDATE TO TRUE                18430000
184400                 ELSE                                             18440000
184500                     SET PS-DO-SUBMIT-E200 TO TRUE                18450000
184600                     IF ASC-PKGNG-CDE = 'I' OR 'M'                18460000
184700                         PERFORM 2102-CONFIRM-PRE-EDIT-PK         18470000
184800                     ELSE                                         18480000
184900                         MOVE LQW-PO-LINE(LQW-IDX) TO DK-LINE-NBR 18490000
185000                         PERFORM 8010-CONFIRM-EDITS               18500000
185100                     END-IF                                       18510000
185200                 END-IF                                           18520000
185300             END-IF                                               18530000
185400         END-PERFORM                                              18540000
185500     END-IF.                                                      18550000
185600                                                                  18560000
185700*----------------------------------------------------------------*18570000
185800 2102-CONFIRM-PRE-EDIT-PK.                                        18580000
185900                                                                  18590000
186000     SET  PS-MORE-RECITM-YES  TO  TRUE.                           18600000
186100                                                                  18610000
186200     MOVE ASC-KEY-PO-NBR    TO DK-ORD-NBR.                        18620000
186300     MOVE ASC-KEY-RCVR-NBR  TO DK-RCVR-NBR.                       18630000
186400     MOVE LQW-PREPK-L4 (LQW-IDX)                                  18640000
186500                            TO DK-PREPK-ID.                       18650000
186600                                                                  18660000
186700     PERFORM 8331-OPEN-PREPK-SEARCH-CSR.                          18670000
186800                                                                  18680000
186900     PERFORM 2103-PRE-EDIT-PACK                                   18690000
187000       UNTIL PS-MORE-RECITM-NO OR PS-ERROR.                       18700000
187100                                                                  18710000
187200     PERFORM 8335-CLOSE-PREPK-SEARCH-CSR.                         18720000
187300                                                                  18730000
187400*----------------------------------------------------------------*18740000
187500 2103-PRE-EDIT-PACK.                                              18750000
187600                                                                  18760000
187700     PERFORM 8333-FETCH-PREPK-SEARCH-CSR.                         18770000
187800                                                                  18780000
187900     IF PS-MORE-RECITM-YES                                        18790000
188000         IF RECITM-PREPK-ODD-UNT-QTY > ZEROES                     18800000
188100             SET PS-RECITM-ODD-UNITS-YES TO TRUE                  18810000
188200         END-IF                                                   18820000
188300         MOVE RECITM-ORD-LNE-NBR TO DK-LINE-NBR                   18830000
188400         PERFORM 8010-CONFIRM-EDITS                               18840000
188500     END-IF.                                                      18850000
188600                                                                  18860000
188700*----------------------------------------------------------------*18870000
188800*                                                                *18880000
188900*----------------------------------------------------------------*18890000
189000 2105-CONFIRM-ZERO-PRE-EDIT.                                      18900000
189100     MOVE +1                       TO ASC-BLK-SUB.                18910000
189200     PERFORM 5100-WRITE-TEMP-STORAGE.                             18920000
189300     ADD +1                        TO ASC-BLK-SUB.                18930000
189400     PERFORM 5100-WRITE-TEMP-STORAGE.                             18940000
189500                                                                  18950000
189600     PERFORM 6112-READ-LIST-QUEUE.                                18960000
189700                                                                  18970000
189800     MOVE ASC-KEY-PO-NBR             TO DK-ORD-NBR                18980000
189900     MOVE ASC-KEY-RCVR-NBR           TO DK-RCVR-NBR               18990000
190000     SET  PS-PROCESS-QTY-NOT-ZERO    TO TRUE.                     19000000
190100                                                                  19010000
190200     IF PV-CICS-RESP = DFHRESP (NORMAL)                           19020000
190300         PERFORM                                                  19030000
190400         VARYING LQW-IDX  FROM 1 BY 1                             19040000
190500         UNTIL   LQW-IDX > PC-ITEMS-PER-PANEL OR                  19050000
190600                 LQW-LIST-ITEM-NUMBER (LQW-IDX) = ZERO            19060000
190700                                                                  19070000
190800             IF  LQW-SELECT (LQW-IDX)                             19080000
190900                 IF  LQW-LINE-PROTECT (LQW-IDX)                   19090000
191000                     MOVE PC-TSYMSG-01809                         19100000
191100                                               TO DP020-MSG-NUMBER19110000
191200                     SET DP020-MSG-FATAL       TO TRUE            19120000
191300                     MOVE -1                   TO MR-SELECTL (1)  19130000
191400                     SET DP030-SET-CURSOR-APPL-1                  19140000
191500                                               TO TRUE            19150000
191600                     SET PS-ERROR              TO TRUE            19160000
191700                     SET ASC-NO-TSQ-UPDATE TO TRUE                19170000
191800                 ELSE                                             19180000
191900                     SET PS-DO-SUBMIT-E200 TO TRUE                19190000
192000                     IF ASC-PKGNG-CDE = 'I' OR 'M'                19200000
192100                         PERFORM 2106-CONFIRM-ZERO-EDITS-PK       19210000
192200                     ELSE                                         19220000
192300                         MOVE LQW-PO-LINE(LQW-IDX) TO DK-LINE-NBR 19230000
192400                         PERFORM 8015-CONFIRM-ZERO-EDITS          19240000
192500                     END-IF                                       19250000
192600                 END-IF                                           19260000
192700             END-IF                                               19270000
192800         END-PERFORM                                              19280000
192900     END-IF.                                                      19290000
193000                                                                  19300000
193100     MOVE  PV-ITEM  TO  PV-SAVE-ITEM.                             19310000
193200     PERFORM 6111-WRITE-LIST-QUEUE.                               19320000
193300                                                                  19330000
193400*----------------------------------------------------------------*19340000
193500 2106-CONFIRM-ZERO-EDITS-PK.                                      19350000
193600                                                                  19360000
193700     SET  PS-MORE-RECITM-YES  TO  TRUE.                           19370000
193800                                                                  19380000
193900     MOVE ASC-KEY-PO-NBR    TO DK-ORD-NBR.                        19390000
194000     MOVE ASC-KEY-RCVR-NBR  TO DK-RCVR-NBR.                       19400000
194100     MOVE LQW-PREPK-L4 (LQW-IDX)                                  19410000
194200                            TO DK-PREPK-ID.                       19420000
194300                                                                  19430000
194400     PERFORM 8331-OPEN-PREPK-SEARCH-CSR.                          19440000
194500                                                                  19450000
194600     PERFORM 2107-ZERO-EDITS-PACK                                 19460000
194700       UNTIL PS-MORE-RECITM-NO OR PS-ERROR.                       19470000
194800                                                                  19480000
194900     PERFORM 8335-CLOSE-PREPK-SEARCH-CSR.                         19490000
195000                                                                  19500000
195100     IF RECITM-STATUS-CDE = 'VE'                                  19510000
195200         CONTINUE                                                 19520000
195300     ELSE                                                         19530000
195400         INITIALIZE PC238-COMM-AREA                               19540000
195500         MOVE ZEROES             TO PC238-WRKD-UNT-QTY            19550000
195600         MOVE RECITM-ORD-LNE-NBR TO ASC-KEY-LNE-NBR               19560000
195700         MOVE 'C'                TO PC238-TRANS-TYPE-CDE          19570000
195800         PERFORM 7450-SELECT-TDISTHD                              19580000
195900         MOVE DISTHD-OPER-UNT-ID TO PC238-WRKD-OPER-UNT-ID        19590000
196000         PERFORM 7952-UPDATE-UNITS-WRKD                           19600000
196100     END-IF.                                                      19610000
196200                                                                  19620000
196300     IF LQW-NO-LINE-ERROR (LQW-IDX)                               19630000
196400         PERFORM 4560-SYNCPOINT                                   19640000
196500     END-IF.                                                      19650000
196600                                                                  19660000
196700*----------------------------------------------------------------*19670000
196800 2107-ZERO-EDITS-PACK.                                            19680000
196900                                                                  19690000
197000     PERFORM 8333-FETCH-PREPK-SEARCH-CSR.                         19700000
197100                                                                  19710000
197200     IF PS-MORE-RECITM-YES                                        19720000
197300         MOVE RECITM-ORD-LNE-NBR TO DK-LINE-NBR                   19730000
197400         PERFORM 8015-CONFIRM-ZERO-EDITS                          19740000
197500     END-IF.                                                      19750000
197600                                                                  19760000
197700*----------------------------------------------------------------*19770000
197800*    LINK TO F-KEY ELIGIBILITY MODULE (RCKUT126)                 *19780000
197900*----------------------------------------------------------------*19790000
198000 2108-LINK-FKEY-MODULE.                                           19800000
198100                                                                  19810000
198200     MOVE DP020-LOCATION-NBR TO RC039-SIGNON-LOCATION.            19820000
198300     MOVE ASC-OPER-UNT-ID   TO RC039-OPER-UNT-ID                  19830000
198400                               PV-OPER-UNT-ID.                    19840000
198500     MOVE ASC-FCLTY-ID      TO RC039-FCLTY-ID                     19850000
198600                               PV-FCLTY-ID.                       19860000
198700     MOVE ASC-ORD-NBR       TO RC039-PO-NBR                       19870000
198800                               PV-PO-NBR.                         19880000
198900     MOVE ASC-RCVR-NBR      TO RC039-REC-SEQ-NBR                  19890000
199000                               PV-RCVR-NBR.                       19900000
199100     MOVE DK-LINE-NBR       TO RC039-PO-LNE-NBR                   19910000
199200                               PV-LINE-NBR.                       19920000
199300     MOVE DK-PREPK-ID       TO RC039-PREPACK-ID.                  19930000
199400     MOVE DP020-USERID      TO RC039-USER-ID.                     19940000
199500     MOVE 'RCKCS297'        TO RC039-PROGRAM-NAME.                19950000
199600                                                                  19960000
199700     EXEC CICS                                                    19970000
199800          LINK PROGRAM (PC-FKEY-MODULE)                           19980000
199900          COMMAREA (RC039-FIELDS)                                 19990000
200000          LENGTH (PC-FKEY-MODULE-LENGTH)                          20000000
200100          RESP (PV-CICS-RESP)                                     20010000
200200     END-EXEC.                                                    20020000
200300                                                                  20030000
200400     EVALUATE TRUE                                                20040000
200500         WHEN RC039-SUCCESSFUL                                    20050000
200600             IF RC039-FUNCTION-YES                                20060000
200700                 SET  PS-FUNCTION-RACF-YES  TO  TRUE              20070000
200800             ELSE                                                 20080000
200900                 SET  PS-FUNCTION-RACF-NO   TO  TRUE              20090000
201000                 PERFORM 2109-PROCESS-NO-FUNCTION                 20100000
201100             END-IF                                               20110000
201200                                                                  20120000
201300         WHEN RC039-DATABASE-BUSY                                 20130000
201400             MOVE PC-TSYMSG-00984     TO DP020-MSG-NUMBER         20140000
201500             SET DP020-MSG-WARNING    TO TRUE                     20150000
201600                                                                  20160000
201700         WHEN RC039-INVALID-SQL                                   20170000
201800             MOVE PC-TSYMSG-00984     TO DP020-MSG-NUMBER         20180000
201900             SET DP020-MSG-WARNING    TO TRUE                     20190000
202000                                                                  20200000
202100         WHEN OTHER                                               20210000
202200             MOVE '2108-LINK-FKEY-MODULE' TO DP013-PARAGRAPH      20220000
202300             MOVE 'UNSUCCESSFUL CALL TO FKEY ELIGIBILITY MODULE'  20230000
202400                                 TO DP013-MESSAGE-TEXT (1)        20240000
202500             MOVE RC039-SUCCESS-IND TO DP013-MESSAGE-TEXT (2)     20250000
202600             MOVE RC039-CRA-RET-MSG TO DP013-MESSAGE-TEXT (3)     20260000
202610             MOVE DP020-LOCATION-NBR TO PV-DISPLAY-LOCATION-NBR   20261024
202700                 STRING ' LOCATION ='                             20270000
202800                        PV-DISPLAY-LOCATION-NBR                   20280024
202900                        ' USER = '                                20290000
203000                        DP020-USERID                              20300000
203100                        ' PO = '                                  20310000
203200                        PV-PO-NBR                                 20320000
203300                        ' RECV ='                                 20330000
203400                        PV-RCVR-NBR                               20340000
203500                        ' OPER = '                                20350000
203600                        PV-OPER-UNT-ID                            20360000
203700                        ' FCLTY = '                               20370000
203800                        PV-FCLTY-ID                               20380000
203900                        ' PO LINE = '                             20390000
204000                        PV-LINE-NBR                               20400000
204100                        ' PREPACK ID = '                          20410000
204200                        PV-PREPK-ID       DELIMITED BY SIZE       20420000
204300                                 INTO DP013-MESSAGE-TEXT (4)      20430000
204400             MOVE RC039-SQLCA    TO DP013-SQLCA                   20440000
204500             SET DP013-DB2-ABEND                                  20450000
204600                 DP013-XCTL-DISPLAY-RESTART  TO TRUE              20460000
204700             PERFORM DP013-0000-PROCESS-ABEND                     20470000
204800     END-EVALUATE.                                                20480000
204900                                                                  20490000
205000*----------------------------------------------------------------*20500000
205100*    PROCESS NO FUNCTION REASON RETURNED FROM COMMAREA RCWS039   *20510000
205200*    AND SEND ERROR MESSAGE TO SCREEN.                           *20520000
205300*----------------------------------------------------------------*20530000
205400 2109-PROCESS-NO-FUNCTION.                                        20540000
205500                                                                  20550000
205600     EVALUATE TRUE                                                20560000
205700         WHEN RC039-FUNC-CNFM                                     20570000
205800             MOVE PC-TSYMSG-03136     TO DP020-MSG-NUMBER         20580000
205900         WHEN RC039-FUNC-UNCNFM                                   20590000
206000             MOVE PC-TSYMSG-03136     TO DP020-MSG-NUMBER         20600000
206100         WHEN RC039-FUNC-VRFY                                     20610000
206200             MOVE PC-TSYMSG-03135     TO DP020-MSG-NUMBER         20620000
206300         WHEN RC039-FUNC-UNVRFY                                   20630000
206400             MOVE PC-TSYMSG-03135     TO DP020-MSG-NUMBER         20640000
206500     END-EVALUATE.                                                20650000
206600                                                                  20660000
206700     SET DP020-MSG-FATAL     TO TRUE                              20670000
206800     MOVE -1                 TO MR-SELECTL (1)                    20680000
206900     SET DP030-SET-CURSOR-APPL-1                                  20690000
207000         PS-ERROR                                                 20700000
207100         ASC-NO-TSQ-UPDATE   TO TRUE.                             20710000
207200                                                                  20720000
207300*----------------------------------------------------------------*20730000
207400*    IF THE USER HITS THE PAGE BACKWARD KEY, COMPUTE THE TOP     *20740000
207500*    ITEM NUMBER FOR THE NEW PAGE.  IF IT IS ABOVE THE TOP,      *20750000
207600*    SET THE TOP ITEM NUMBER TO +1 AND DISPLAY THE TOP OF LIST   *20760000
207700*    MESSAGE.                                                    *20770000
207800*----------------------------------------------------------------*20780000
207900                                                                  20790000
208000 2110-BROWSE-BACKWARD.                                            20800000
208100                                                                  20810000
208200     SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    20820000
208300         GIVING PV-TOP-ITEM.                                      20830000
208400                                                                  20840000
208500     IF  ((PV-TOP-ITEM < +1)                                      20850000
208600       OR (PV-TOP-ITEM = +1))                                     20860000
208700         MOVE +1                   TO PV-TOP-ITEM                 20870000
208800*        -- TOP OF LIST --                                        20880000
208900         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            20890000
209000         SET DP020-MSG-INFORMATIONAL                              20900000
209100                                   TO TRUE                        20910000
209200     END-IF.                                                      20920000
209300                                                                  20930000
209400/                                                                 20940000
209500*----------------------------------------------------------------*20950000
209600*    IF THE USER HITS THE PAGE FORWARD KEY, COMPUTE THE TOP      *20960000
209700*    ITEM NUMBER FOR THE NEW PAGE.  IF THE USER ATTEMPTS TO GO   *20970000
209800*    PAST THE END, ISSUE THE BOTTOM OF LIST MESSAGE.             *20980000
209900*----------------------------------------------------------------*20990000
210000                                                                  21000000
210100 2120-BROWSE-FORWARD.                                             21010000
210200                                                                  21020000
210300     ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              21030000
210400         GIVING PV-TOP-ITEM.                                      21040000
210500                                                                  21050000
210600     IF  PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                   21060000
210700         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            21070000
210800                                   TO PV-TOP-ITEM                 21080000
210900*        -- BOTTOM OF LIST --                                     21090000
211000         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            21100000
211100         SET DP020-MSG-INFORMATIONAL                              21110000
211200                                   TO TRUE                        21120000
211300     ELSE                                                         21130000
211400         COMPUTE PV-BOTTOM-ITEM =                                 21140000
211500             PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 21150000
211600         IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ            21160000
211700*            -- BOTTOM OF LIST --                                 21170000
211800             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            21180000
211900             SET DP020-MSG-INFORMATIONAL                          21190000
212000                                   TO TRUE                        21200000
212100         END-IF                                                   21210000
212200     END-IF.                                                      21220000
212300                                                                  21230000
212400/                                                                 21240000
212500*----------------------------------------------------------------*21250000
212600*    THE USER CAN CHANGE THE CURRENT BEGINNING LIST NUMBER SO    *21260000
212700*    THAT THE TRANSACTION WILL JUMP TO THAT POINT IN THE LIST.   *21270000
212800*    THIS IS A FASTER WAY TO GET TO A CERTAIN POINT IN THE LIST  *21280000
212900*    RATHER THAN HITTING NEXT-PAGE TO GET TO THAT POINT.         *21290000
213000*    THE NEW LIST NUMBER ENTERED IS EDITED TO MAKE SURE THAT     *21300000
213100*    IT IS NUMERIC AND FALLS BETWEEN A SPECIFIED RANGE.          *21310000
213200*----------------------------------------------------------------*21320000
213300                                                                  21330000
213400 2130-CHECK-FOR-JUMP-BROWSE.                                      21340000
213500                                                                  21350000
213600     SET PS-NO-ERROR               TO TRUE.                       21360000
213700     IF (ASC-START-ITEM-REQUEST = SPACE)                          21370000
213800         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            21380000
213900                                   TO PV-TOP-ITEM                 21390000
214000     ELSE                                                         21400000
214100         MOVE ASC-START-ITEM-REQUEST                              21410000
214200                                   TO DP010I-UNEDITED-FIELD       21420000
214300         MOVE PC-MSG-NUMBER-LENGTH TO DP010I-MAXIMUM-DIGITS       21430000
214400         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     21440000
214500         SET DP010I-NEGATIVE-NOT-ALLOWED                          21450000
214600                                   TO TRUE                        21460000
214710         CALL DP010I-NUMERIC-EDIT-ROUTINE                         21471036
214720              USING DP010I-NUMERIC-EDIT-AREA                      21472036
214800                                                                  21480000
214900         IF  NOT DP010I-ERROR-DETECTED                            21490000
215000             MOVE DP010I-NUMERIC-FIELD                            21500000
215100                                   TO ASC-START-ITEM-REQUEST-N    21510000
215200             IF  ASC-START-ITEM-REQUEST-N > ZERO                  21520000
215300                 IF  ASC-START-ITEM-REQUEST-N >                   21530000
215400                                          ASC-NUMBER-OF-ITEMS-READ21540000
215500                     MOVE SPACE TO ASC-START-ITEM-REQUEST         21550000
215600                     COMPUTE PV-TOP-ITEM =                        21560000
215700                             ASC-NUMBER-OF-ITEMS-READ             21570000
215800                             - PC-ITEMS-PER-PANEL + 1             21580000
215900                     IF  PV-TOP-ITEM < +1                         21590000
216000                         MOVE +1   TO PV-TOP-ITEM                 21600000
216100                         MOVE PC-TSYMSG-00070                     21610000
216200                                   TO DP020-MSG-NUMBER            21620000
216300                         SET DP020-MSG-INFORMATIONAL              21630000
216400                                   TO TRUE                        21640000
216500                     END-IF                                       21650000
216600                 ELSE                                             21660000
216700                     MOVE ASC-START-ITEM-REQUEST-N                21670000
216800                                   TO PV-TOP-ITEM                 21680000
216900                     MOVE SPACE    TO ASC-START-ITEM-REQUEST      21690000
217000                     COMPUTE PV-BOTTOM-ITEM =                     21700000
217100                         PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1     21710000
217200                     IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ21720000
217300*                        -- BOTTOM OF LIST --                     21730000
217400                         MOVE PC-TSYMSG-00070                     21740000
217500                                   TO DP020-MSG-NUMBER            21750000
217600                         SET DP020-MSG-INFORMATIONAL              21760000
217700                                   TO TRUE                        21770000
217800                     END-IF                                       21780000
217900                 END-IF                                           21790000
218000             ELSE                                                 21800000
218100*                --- VALUE OUT OF RANGE ----                      21810000
218200                 MOVE PC-TSYMSG-00101                             21820000
218300                                   TO DP020-MSG-NUMBER            21830000
218400                 MOVE -1           TO ASTRTITL                    21840000
218500                 SET DP030-SET-CURSOR-APPL-1                      21850000
218600                                   TO TRUE                        21860000
218700                 MOVE DP015-REVERSE                               21870000
218800                                   TO ASTRTITH                    21880000
218900                 MOVE DP015-RED    TO ASTRTITC                    21890000
219000                 MOVE DP015-UNP-NUM-BRT-MDT                       21900000
219100                                   TO ASTRTITA                    21910000
219200                 SET DP020-MSG-FATAL                              21920000
219300                                   TO TRUE                        21930000
219400                 SET PS-ERROR      TO TRUE                        21940000
219500             END-IF                                               21950000
219600                                                                  21960000
219700         ELSE                                                     21970000
219800             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            21980000
219900             MOVE -1               TO ASTRTITL                    21990000
220000             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  22000000
220100             MOVE DP015-REVERSE    TO ASTRTITH                    22010000
220200             MOVE DP015-RED        TO ASTRTITC                    22020000
220300             MOVE DP015-UNP-NUM-BRT-MDT                           22030000
220400                                   TO ASTRTITA                    22040000
220500             SET DP020-MSG-FATAL   TO TRUE                        22050000
220600             SET PS-ERROR          TO TRUE                        22060000
220700         END-IF                                                   22070000
220800     END-IF.                                                      22080000
220900                                                                  22090000
221000/                                                                 22100000
221100*----------------------------------------------------------------*22110000
221200*    IF THE USER HITS THE DESELECT KEY, CLEAR THE SELECTION      *22120000
221300*    SWITCH FOR ALL ITEMS THAT WERE PREVIOUSLY SELECTED.         *22130000
221400*----------------------------------------------------------------*22140000
221500 2140-DESELECT-ALL-ITEMS.                                         22150000
221600                                                                  22160000
221700     MOVE +1                       TO ASC-BLK-SUB.                22170000
221800                                                                  22180000
221900     PERFORM 2141-CLEAR-SELECTED-INDS                             22190000
222000         VARYING ASC-ITEM-SUB                                     22200000
222100         FROM 1 BY 1                                              22210000
222200         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 22220000
222300                                                                  22230000
222400     ADD +1                        TO ASC-BLK-SUB.                22240000
222500                                                                  22250000
222600     PERFORM 2141-CLEAR-SELECTED-INDS                             22260000
222700         VARYING ASC-ITEM-SUB                                     22270000
222800         FROM 1 BY 1                                              22280000
222900         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 22290000
223000                                                                  22300000
223100     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               22310000
223200                                   TO PV-LIST-ITEM-NUMBER.        22320000
223300                                                                  22330000
223400     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            22340000
223500         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    22350000
223600                                                                  22360000
223700     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     22370000
223800        (ASC-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)      22380000
223900         MOVE +1                   TO ASC-BLK-SUB                 22390000
224000                                                                  22400000
224100         PERFORM 5100-WRITE-TEMP-STORAGE                          22410000
224200                                                                  22420000
224300         MOVE +1                   TO PV-BLOCK-NUMBER             22430000
224400                                                                  22440000
224500         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         22450000
224600             PV-FIRST-BLOCK-IN-ARRAY - 1                          22460000
224700                                                                  22470000
224800         PERFORM                                                  22480000
224900             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       22490000
225000                                                                  22500000
225100             PERFORM 4410-READ-TEMP-STORAGE                       22510000
225200                                                                  22520000
225300             PERFORM 2141-CLEAR-SELECTED-INDS                     22530000
225400                 VARYING ASC-ITEM-SUB FROM 1 BY 1                 22540000
225500                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          22550000
225600                                                                  22560000
225700             PERFORM 5100-WRITE-TEMP-STORAGE                      22570000
225800                                                                  22580000
225900             ADD +1                TO PV-BLOCK-NUMBER             22590000
226000                                                                  22600000
226100         END-PERFORM                                              22610000
226200                                                                  22620000
226300         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         22630000
226400             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     22640000
226500                                                                  22650000
226600         PERFORM                                                  22660000
226700             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       22670000
226800                   ASC-HIGHEST-BLOCK-WRITTEN                      22680000
226900                                                                  22690000
227000             MOVE PV-NEXT-BLOCK-IN-ARRAY                          22700000
227100                                   TO PV-BLOCK-NUMBER             22710000
227200                                                                  22720000
227300             PERFORM 4410-READ-TEMP-STORAGE                       22730000
227400                                                                  22740000
227500             PERFORM 2141-CLEAR-SELECTED-INDS                     22750000
227600                 VARYING ASC-ITEM-SUB                             22760000
227700                 FROM 1 BY 1                                      22770000
227800                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          22780000
227900                                                                  22790000
228000             PERFORM 5100-WRITE-TEMP-STORAGE                      22800000
228100                                                                  22810000
228200             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      22820000
228300                                                                  22830000
228400         END-PERFORM                                              22840000
228500                                                                  22850000
228600         MOVE PV-FIRST-BLOCK-IN-ARRAY                             22860000
228700                                   TO PV-BLOCK-NUMBER             22870000
228800                                                                  22880000
228900         PERFORM 4410-READ-TEMP-STORAGE                           22890000
229000     END-IF.                                                      22900000
229100                                                                  22910000
229200                                                                  22920000
229300     MOVE ZERO                     TO ASC-NUMBER-OF-SELECTED-ITEMS22930000
229400     MOVE ZERO                     TO ASC-START-OF-SELECTED-RANGE.22940000
229500     MOVE ZERO                     TO ASC-END-OF-SELECTED-RANGE.  22950000
229600                                                                  22960000
229700     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        22970000
229800                                                                  22980000
229900/                                                                 22990000
230000*----------------------------------------------------------------*23000000
230100*    MARK EACH ITEM AS BEING NOT SELECTED.                       *23010000
230200*----------------------------------------------------------------*23020000
230300                                                                  23030000
230400 2141-CLEAR-SELECTED-INDS.                                        23040000
230500                                                                  23050000
230600     IF  ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB)          23060000
230700             NOT EQUAL ZERO                                       23070000
230800         IF  NOT ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          23080000
230900             SET ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          23090000
231000                 ASC-TEMP-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)    23100000
231100                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  23110000
231200                                   TO TRUE                        23120000
231300         END-IF                                                   23130000
231400     END-IF.                                                      23140000
231500                                                                  23150000
231600/                                                                 23160000
231700*----------------------------------------------------------------*23170000
231800*  IF THE USER HITS THE SELECT-ALL KEY, SET THE SELECTIO SWITCH  *23180000
231900*  FOR ALL ITEMS.                                                *23190000
232000*----------------------------------------------------------------*23200000
232100                                                                  23210000
232200 2150-SELECT-ALL-ITEMS.                                           23220000
232300                                                                  23230000
232400     MOVE +1                       TO ASC-BLK-SUB.                23240000
232500                                                                  23250000
232600     PERFORM 2151-SET-SELECTED-INDS                               23260000
232700         VARYING ASC-ITEM-SUB                                     23270000
232800         FROM 1 BY 1                                              23280000
232900         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 23290000
233000                                                                  23300000
233100     ADD +1                        TO ASC-BLK-SUB.                23310000
233200                                                                  23320000
233300     PERFORM 2151-SET-SELECTED-INDS                               23330000
233400         VARYING ASC-ITEM-SUB                                     23340000
233500         FROM 1 BY 1                                              23350000
233600         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 23360000
233700                                                                  23370000
233800     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               23380000
233900                                   TO PV-LIST-ITEM-NUMBER.        23390000
234000                                                                  23400000
234100     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            23410000
234200         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    23420000
234300                                                                  23430000
234400     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     23440000
234500        (ASC-HIGHEST-BLOCK-WRITTEN >   PC-MAX-BLOCKS-IN-ARRAY)    23450000
234600         MOVE +1                   TO ASC-BLK-SUB                 23460000
234700                                                                  23470000
234800         PERFORM 5100-WRITE-TEMP-STORAGE                          23480000
234900                                                                  23490000
235000         MOVE +1                   TO PV-BLOCK-NUMBER             23500000
235100                                                                  23510000
235200         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         23520000
235300             PV-FIRST-BLOCK-IN-ARRAY - 1                          23530000
235400                                                                  23540000
235500         PERFORM                                                  23550000
235600             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       23560000
235700                                                                  23570000
235800             PERFORM 4410-READ-TEMP-STORAGE                       23580000
235900                                                                  23590000
236000             PERFORM 2151-SET-SELECTED-INDS                       23600000
236100                 VARYING ASC-ITEM-SUB                             23610000
236200                 FROM 1 BY 1                                      23620000
236300                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          23630000
236400                                                                  23640000
236500             PERFORM 5100-WRITE-TEMP-STORAGE                      23650000
236600                                                                  23660000
236700             ADD +1                TO PV-BLOCK-NUMBER             23670000
236800         END-PERFORM                                              23680000
236900                                                                  23690000
237000         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         23700000
237100             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     23710000
237200                                                                  23720000
237300         PERFORM                                                  23730000
237400             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       23740000
237500                   ASC-HIGHEST-BLOCK-WRITTEN                      23750000
237600                                                                  23760000
237700             MOVE PV-NEXT-BLOCK-IN-ARRAY                          23770000
237800                                   TO PV-BLOCK-NUMBER             23780000
237900                                                                  23790000
238000             PERFORM 4410-READ-TEMP-STORAGE                       23800000
238100                                                                  23810000
238200             PERFORM 2151-SET-SELECTED-INDS                       23820000
238300                 VARYING ASC-ITEM-SUB                             23830000
238400                 FROM 1 BY 1                                      23840000
238500                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          23850000
238600                                                                  23860000
238700             PERFORM 5100-WRITE-TEMP-STORAGE                      23870000
238800                                                                  23880000
238900             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      23890000
239000         END-PERFORM                                              23900000
239100                                                                  23910000
239200         MOVE PV-FIRST-BLOCK-IN-ARRAY                             23920000
239300                                   TO PV-BLOCK-NUMBER             23930000
239400                                                                  23940000
239500         PERFORM 4410-READ-TEMP-STORAGE                           23950000
239600     END-IF.                                                      23960000
239700                                                                  23970000
239800                                                                  23980000
239900     MOVE ASC-NUMBER-OF-ITEMS-READ TO                             23990000
240000          ASC-NUMBER-OF-SELECTED-ITEMS.                           24000000
240100                                                                  24010000
240200     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        24020000
240300                                                                  24030000
240400/                                                                 24040000
240500*----------------------------------------------------------------*24050000
240600*    MARK EACH ITEM AS BEING SELECTED.                           *24060000
240700*----------------------------------------------------------------*24070000
240800                                                                  24080000
240900 2151-SET-SELECTED-INDS.                                          24090000
241000                                                                  24100000
241100     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           24110000
241200             NOT EQUAL ZERO                                       24120000
241300         IF  NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             24130000
241400             SET ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             24140000
241500                 ASC-TEMP-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)        24150000
241600                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  24160000
241700                                   TO TRUE                        24170000
241800         END-IF                                                   24180000
241900     END-IF.                                                      24190000
242000                                                                  24200000
242100                                                                  24210000
242200*----------------------------------------------------------------*24220000
242300* EDIS FOR UPDATE OF FULLCASE PROCESS AREA                       *24230000
242400*----------------------------------------------------------------*24240000
242500 2160-UPDATE-PRE-EDIT.                                            24250000
242600                                                                  24260000
242700     MOVE +1                       TO ASC-BLK-SUB.                24270000
242800     PERFORM 5100-WRITE-TEMP-STORAGE.                             24280000
242900     ADD +1                        TO ASC-BLK-SUB.                24290000
243000     PERFORM 5100-WRITE-TEMP-STORAGE.                             24300000
243100                                                                  24310000
243200     PERFORM 6112-READ-LIST-QUEUE.                                24320000
243300                                                                  24330000
243400     MOVE ASC-KEY-PO-NBR             TO DK-ORD-NBR                24340000
243500     MOVE ASC-KEY-RCVR-NBR           TO DK-RCVR-NBR               24350000
243600                                                                  24360000
243700     IF PV-CICS-RESP = DFHRESP (NORMAL)                           24370000
243800         PERFORM                                                  24380000
243900         VARYING LQW-IDX  FROM 1 BY 1                             24390000
244000         UNTIL   LQW-IDX > PC-ITEMS-PER-PANEL OR                  24400000
244100                 LQW-LIST-ITEM-NUMBER (LQW-IDX) = ZERO            24410000
244200                                                                  24420000
244300             IF  LQW-SELECT (LQW-IDX)                             24430000
244400                 PERFORM 8300-UPDATE-EDITS                        24440000
244500             END-IF                                               24450000
244600         END-PERFORM                                              24460000
244700     END-IF.                                                      24470000
244800                                                                  24480000
244900                                                                  24490000
245000*----------------------------------------------------------------*24500000
245100*  MOVE ALL OF THE FIELDS THAT WERE ENTERED / CHANGED ON THE     *24510000
245200*  SCREEN INTO THE COMMAREA.  ALL EDITTING IS DONE IN THE COMM.  *24520000
245300*----------------------------------------------------------------*24530000
245400 2200-MOVE-SCREEN-TO-COMMAREA.                                    24540000
245500                                                                  24550000
245600     MOVE PV-TOP-ITEM              TO PV-ITEM-IN-USE.             24560000
245700     MOVE +1                       TO PV-SUB.                     24570000
245800                                                                  24580000
245900     PERFORM 3100-SET-SUBSCRIPTS.                                 24590000
246000                                                                  24600000
246100     IF  ASTRTITL > ZERO                                          24610000
246200         MOVE ASTRTITI             TO ASC-START-ITEM-REQUEST      24620000
246300     ELSE                                                         24630000
246400         IF  ASTRTITF = DP015-ERASE-EOF                           24640000
246500             INITIALIZE ASC-START-ITEM-REQUEST                    24650000
246600         END-IF                                                   24660000
246700     END-IF.                                                      24670000
246800                                                                  24680000
246900     PERFORM 2210-MOVE-LINES-TO-COMMAREA                          24690000
247000         VARYING PV-SUB                                           24700000
247100         FROM 1 BY 1                                              24710000
247200         UNTIL PV-SUB > ASC-ITEMS-DISPLAYED.                      24720000
247300                                                                  24730000
247400/                                                                 24740000
247500*----------------------------------------------------------------*24750000
247600*  MOVE THE ENTERABLE FIELDS ON EACH LIST LINE INTO THE COMMAREA *24760000
247700*----------------------------------------------------------------*24770000
247800 2210-MOVE-LINES-TO-COMMAREA.                                     24780000
247900                                                                  24790000
248000     IF  MR-SELECTL (PV-SUB) > ZERO                               24800000
248100         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                     24810000
248200                                   TO TRUE                        24820000
248300         MOVE MR-SELECT (PV-SUB)   TO ASC-TEMP-SELECTED-SW        24830000
248400                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      24840000
248500     ELSE                                                         24850000
248600         IF  MR-SELECTA (PV-SUB) = DP015-ERASE-EOF                24860000
248700             SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE         24870000
248800             MOVE SPACE            TO ASC-TEMP-SELECTED-SW        24880000
248900                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      24890000
249000         END-IF                                                   24900000
249100     END-IF.                                                      24910000
249200                                                                  24920000
249300     IF  MR-FCSE-AREA-L (PV-SUB) > ZERO                           24930000
249400         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                     24940000
249500                                   TO TRUE                        24950000
249600         MOVE MR-FCSE-AREA (PV-SUB)   TO ASC-FCSE-AREA            24960000
249700                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      24970000
249800     ELSE                                                         24980000
249900         IF  MR-FCSE-AREA-A (PV-SUB) = DP015-ERASE-EOF            24990000
250000             SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE         25000000
250100             MOVE SPACE            TO ASC-FCSE-AREA               25010000
250200                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      25020000
250300         END-IF                                                   25030000
250400     END-IF.                                                      25040000
250500                                                                  25050000
250600     ADD +1                        TO ASC-ITEM-SUB.               25060000
250700                                                                  25070000
250800     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        25080000
250900         ADD +1                    TO ASC-BLK-SUB                 25090000
251000         MOVE +1                   TO ASC-ITEM-SUB                25100000
251100     END-IF.                                                      25110000
251200                                                                  25120000
251300/                                                                 25130000
251400 2300-GET-NEXT-RECORD.                                            25140000
251500     ADD +1                        TO ASC-SEL-SUB.                25150000
251600     IF ASC-SEL-SUB > RC013-MAX-ITEMS                             25160000
251700         ADD +1                    TO PV-SEL-QUEUE-ITEM           25170000
251800         MOVE +1                   TO ASC-SEL-SUB                 25180000
251900     END-IF.                                                      25190000
252000                                                                  25200000
252100     IF PV-SEL-QUEUE-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS            25210000
252200         PERFORM 9100-READ-SEL-QUEUE                              25220000
252300         IF RC013-ITEM (ASC-SEL-SUB) > ZERO                       25230000
252400             INITIALIZE ASC-LIST-KEYS                             25240000
252500             MOVE RC013-PO-NBR (ASC-SEL-SUB)                      25250000
252600                                      TO ASC-KEY-PO-NBR           25260000
252700             MOVE RC013-REC-SEQ-NBR (ASC-SEL-SUB)                 25270000
252800                                      TO ASC-KEY-RCVR-NBR         25280000
252900                                         ASC-RCVR-NBR             25290000
253000                                                                  25300000
253100             MOVE RC013-OPER-UNT-ID (ASC-SEL-SUB)                 25310000
253200                                      TO ASC-KEY-OPER-UNT-ID      25320000
253300                                         ASC-OPER-UNT-ID          25330000
253400             MOVE RC013-FCLTY-ID (ASC-SEL-SUB)                    25340000
253500                                      TO ASC-KEY-FCLTY-ID         25350000
253600                                         ASC-FCLTY-ID             25360000
253700                                                                  25370000
253800             SET RC013-INQ (ASC-SEL-SUB) TO TRUE                  25380000
253900             PERFORM 5120-REWRITE-LIST-QUEUE                      25390000
254000         ELSE                                                     25400000
254100             SUBTRACT +1 FROM ASC-SEL-SUB                         25410000
254200*            --- BOTTOM OF LIST ---                               25420000
254300             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            25430000
254400             SET DP020-MSG-INFORMATIONAL                          25440000
254500                                   TO TRUE                        25450000
254600         END-IF                                                   25460000
254700     ELSE                                                         25470000
254800         SUBTRACT +1 FROM PV-SEL-QUEUE-ITEM                       25480000
254900         MOVE RC013-MAX-ITEMS      TO ASC-SEL-SUB                 25490000
255000         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            25500000
255100         SET DP020-MSG-INFORMATIONAL                              25510000
255200                                   TO TRUE                        25520000
255300     END-IF.                                                      25530000
255400/                                                                 25540000
255500*----------------------------------------------------------------*25550000
255600*  EDIT ALL OF THE DATA ON THE SCREEN AS IT RESIDES IN THE       *25560000
255700*  COMMAREA (EDITTING IS NOT DONE AGAINST THE SCREEN DIRECTLY).  *25570000
255800*----------------------------------------------------------------*25580000
255900 3000-EDIT-DATA-IN-COMMAREA.                                      25590000
256000                                                                  25600000
256100     SET PS-NO-ERROR               TO TRUE.                       25610000
256200                                                                  25620000
256300     PERFORM 3200-RESET-ATTRIBUTES.                               25630000
256400                                                                  25640000
256500     MOVE ASC-ITEMS-DISPLAYED      TO PV-SUB.                     25650000
256600**                                                                25660000
256700* CALCULATE THE POSITION OF THE LAST ITEM DISPLAYED.              25670000
256800* EDITING IS DONE FROM THE BOTTOM UP.                             25680000
256900**                                                                25690000
257000     COMPUTE PV-ITEM-IN-USE = PV-TOP-ITEM +                       25700000
257100         ASC-ITEMS-DISPLAYED - 1.                                 25710000
257200                                                                  25720000
257300     PERFORM 3100-SET-SUBSCRIPTS.                                 25730000
257400                                                                  25740000
257500     PERFORM 3305-CHECK-RCVR-ARRIVED                              25750000
257600         IF  RECEIV-REC-TMST  =  PC-DEFAULT-TMST                  25760000
257700             SET  ASC-RECEIVER-NOT-ARRIVED  TO  TRUE              25770000
257800         ELSE                                                     25780000
257900             SET  ASC-RECEIVER-ARRIVED TO TRUE                    25790000
258000         END-IF.                                                  25800000
258100                                                                  25810000
258200     PERFORM 3300-EDIT-SELECTIONS                                 25820000
258300         VARYING PV-SUB                                           25830000
258400         FROM PV-SUB BY -1                                        25840000
258500         UNTIL PV-SUB < +1                                        25850000
258600                                                                  25860000
258700     MOVE +1                   TO ASC-BLK-SUB.                    25870000
258800     PERFORM 5100-WRITE-TEMP-STORAGE.                             25880000
258900                                                                  25890000
259000     IF  PS-NO-ERROR                                              25900000
259100         PERFORM 3400-CHECK-RANGE-SEQUENCE                        25910000
259200     END-IF.                                                      25920000
259300                                                                  25930000
259400     IF  ((PS-NO-ERROR)                                           25940000
259500       AND (ASC-START-OF-SELECTED-RANGE > ZERO)                   25950000
259600       AND (ASC-END-OF-SELECTED-RANGE > ZERO))                    25960000
259700             PERFORM 3500-MARK-RANGE-AS-SELECTED                  25970000
259800     END-IF.                                                      25980000
259900/                                                                 25990000
260000*----------------------------------------------------------------*26000000
260100*    DETERMINE THE VALUE OF THE ITEM SUBSCRIPT BASED ON THE ITEM *26010000
260200*    CURRENTLY IN USE AND THE FIRST ITEM IN THE ARRAY.  THIS WILL*26020000
260300*    POSITION US IN THE 1ST BLOCK OF THE ARRAY.                  *26030000
260400*                                                                *26040000
260500*    IF THE ITEM SUBSCRIPT EXCEEDS THE MAXIMUM NUMBER OF ITEMS   *26050000
260600*    IN A BLOCK, RECALCULATE THE SUBSCRIPT BY SUBTRACTING OUT    *26060000
260700*    THE MAXIMUM NUMBER OF ITEMS.  THIS WILL CORRECTLY POSITION  *26070000
260800*    US IN THE 2ND BLOCK OF THE ARRAY.                           *26080000
260900*----------------------------------------------------------------*26090000
261000                                                                  26100000
261100 3100-SET-SUBSCRIPTS.                                             26110000
261200                                                                  26120000
261300     COMPUTE ASC-ITEM-SUB =                                       26130000
261400         (PV-ITEM-IN-USE - ASC-LIST-ITEM-NUMBER(1 1)) + 1.        26140000
261500                                                                  26150000
261600     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         26160000
261700         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            26170000
261800                                                                  26180000
261900         MOVE PC-MAX-BLOCKS-IN-ARRAY                              26190000
262000                                   TO ASC-BLK-SUB                 26200000
262100     ELSE                                                         26210000
262200         MOVE +1                   TO ASC-BLK-SUB                 26220000
262300     END-IF.                                                      26230000
262400                                                                  26240000
262500*----------------------------------------------------------------*26250000
262600*  RESET THE ATTRIBUTES OF ALL ENTERABLE FIELDS ON THE MAP.      *26260000
262700*----------------------------------------------------------------*26270000
262800 3200-RESET-ATTRIBUTES.                                           26280000
262900                                                                  26290000
263000     MOVE DP015-UNP-ALP-NOR-OFF    TO ASTRTITA                    26300000
263100     MOVE DP015-GREEN              TO ASTRTITC                    26310000
263200     MOVE DP015-UNDERLINE          TO ASTRTITH.                   26320000
263300                                                                  26330000
263400     PERFORM VARYING PV-SUB  FROM 1 BY 1                          26340000
263500         UNTIL   PV-SUB > PC-ITEMS-PER-PANEL                      26350000
263600         EVALUATE TRUE                                            26360000
263700*            WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)          26370000
263800             WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)          26380000
263900             WHEN DP020-FK-LOCAL-FUNC-07 (DP020-SRC-AID)          26390000
263910                 IF MR-SELECT (PV-SUB) = 'S'                      26391023
263920                     MOVE DP015-PRO-NOR-OFF                       26392023
263930                                 TO MR-FCSE-AREA-A (PV-SUB)       26393023
263940                     MOVE DP015-BLUE                              26394023
263950                                 TO MR-FCSE-AREA-C (PV-SUB)       26395023
263960                     MOVE DP015-HL-OFF                            26396023
263970                                 TO MR-FCSE-AREA-H (PV-SUB)       26397023
263980                 ELSE                                             26398023
263990                     MOVE DP015-UNP-ALP-NOR-OFF                   26399023
264000                                 TO MR-SELECTA (PV-SUB)           26400023
264100                                    MR-FCSE-AREA-A (PV-SUB)       26410023
264200                     MOVE DP015-GREEN                             26420023
264300                                 TO MR-SELECTC (PV-SUB)           26430023
264400                                    MR-FCSE-AREA-C (PV-SUB)       26440023
264500                     MOVE DP015-UNDERLINE                         26450023
264600                                 TO MR-SELECTH (PV-SUB)           26460023
264700                                    MR-FCSE-AREA-H (PV-SUB)       26470023
264701                 END-IF                                           26470123
264702             WHEN OTHER                                           26470200
264703                 MOVE DP015-UNP-ALP-NOR-OFF                       26470300
264704                                 TO MR-SELECTA (PV-SUB)           26470400
264705                                    MR-FCSE-AREA-A (PV-SUB)       26470500
264706                 MOVE DP015-GREEN                                 26470600
264707                                 TO MR-SELECTC (PV-SUB)           26470723
264708                                    MR-FCSE-AREA-C (PV-SUB)       26470823
264709                 MOVE DP015-UNDERLINE                             26470923
264710                                 TO MR-SELECTH (PV-SUB)           26471023
264720                                    MR-FCSE-AREA-H (PV-SUB)       26472023
264730             END-EVALUATE                                         26473023
264740     END-PERFORM.                                                 26474023
264750                                                                  26475023
264760*----------------------------------------------------------------*26476023
264770*  EDIT THE SELECTIONS MADE.  NOTE THAT THE 'SELECTED-SW' IS     *26477023
264780*  WHAT WAS PREVIOUSLY CHECKED AND CORRECT 'TEMP-SELECTED-SW'    *26478023
264790*  IS WHAT HAS JUST BEEN ENTERED AND HAS NOT BEEN EDITTED OR     *26479023
264800*  WAS ENTERED EARLIER, BUT DID NOT PASS THE EDITS.              *26480023
264900*----------------------------------------------------------------*26490023
265000 3300-EDIT-SELECTIONS.                                            26500023
265100                                                                  26510023
265200     EVALUATE TRUE                                                26520023
265300         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     26530023
265400             = ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)         26540023
265500                 CONTINUE                                         26550023
265600                                                                  26560023
265700         WHEN ASC-TEMP-SELECT  (ASC-BLK-SUB ASC-ITEM-SUB)         26570023
265800             IF  NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)        26580023
265900                 ADD +1            TO ASC-NUMBER-OF-SELECTED-ITEMS26590023
266000                 MOVE ASC-TEMP-SELECTED-SW                        26600023
266100                                     (ASC-BLK-SUB ASC-ITEM-SUB)   26610023
266200                                   TO ASC-SELECTED-SW             26620023
266300                                     (ASC-BLK-SUB ASC-ITEM-SUB)   26630023
266400             END-IF                                               26640023
266500                                                                  26650023
266600         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     26660023
266700                 = SPACE                                          26670023
266800             EVALUATE TRUE                                        26680023
266900                 WHEN ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)       26690023
267000                     SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS26700023
267100                     MOVE SPACE    TO ASC-SELECTED-SW             26710023
267200                                     (ASC-BLK-SUB ASC-ITEM-SUB)   26720023
267300                                                                  26730023
267400                 WHEN ASC-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)        26740023
267500                     MOVE ZERO     TO ASC-START-OF-SELECTED-RANGE 26750023
267600                     MOVE SPACE    TO ASC-SELECTED-SW             26760023
267700                                     (ASC-BLK-SUB ASC-ITEM-SUB)   26770023
267800                                                                  26780023
267900                 WHEN ASC-END (ASC-BLK-SUB ASC-ITEM-SUB)          26790023
268000                     MOVE ZERO     TO ASC-END-OF-SELECTED-RANGE   26800023
268100                     MOVE SPACE    TO ASC-SELECTED-SW             26810023
268200                                     (ASC-BLK-SUB ASC-ITEM-SUB)   26820023
268300             END-EVALUATE                                         26830023
268400                                                                  26840023
268500         WHEN ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)           26850023
268600             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            26860023
268700                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    26870023
268800             END-IF                                               26880023
268900             PERFORM 3310-EDIT-RANGE                              26890023
269000                                                                  26900023
269100         WHEN ASC-TEMP-END (ASC-BLK-SUB ASC-ITEM-SUB)             26910023
269200             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            26920023
269300                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    26930023
269400             END-IF                                               26940023
269500             PERFORM 3310-EDIT-RANGE                              26950023
269600                                                                  26960023
269700         WHEN OTHER                                               26970023
269800             MOVE PC-TSYMSG-00005  TO DP020-MSG-NUMBER            26980023
269900             SET DP020-MSG-FATAL   TO TRUE                        26990023
270000             MOVE -1               TO MR-SELECTL (PV-SUB)         27000023
270100             SET DP030-SET-CURSOR-APPL-1                          27010023
270200                                   TO TRUE                        27020023
270300             MOVE DP015-RED        TO MR-SELECTC (PV-SUB)         27030023
270400             MOVE DP015-REVERSE    TO MR-SELECTH (PV-SUB)         27040023
270500             SET PS-ERROR          TO TRUE                        27050023
270600             MOVE PC-ERR           TO ASC-ACTION                  27060023
270700                                     (ASC-BLK-SUB ASC-ITEM-SUB)   27070023
270800                                      MR-ACTION (PV-SUB)          27080023
270900             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            27090023
271000                 SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS     27100023
271100                 MOVE SPACE        TO ASC-SELECTED-SW             27110023
271200                                     (ASC-BLK-SUB ASC-ITEM-SUB)   27120023
271300             END-IF                                               27130023
271400     END-EVALUATE.                                                27140023
271500                                                                  27150023
271600                                                                  27160023
271700     EVALUATE TRUE                                                27170023
271800     WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)                  27180023
271900     WHEN DP020-FK-LOCAL-FUNC-06 (DP020-SRC-AID)                  27190023
272000     WHEN DP020-FK-LOCAL-FUNC-07 (DP020-SRC-AID)                  27200023
272100     WHEN DP020-SRC-AID = DP016-ENTER                             27210023
272200         SET ASC-HAVE-FCSE-PROCESS-AREA                           27220023
272300             (ASC-BLK-SUB ASC-ITEM-SUB)    TO TRUE                27230023
272400         SET ASC-GOOD-FCSE-PROCESS-AREA                           27240023
272500             (ASC-BLK-SUB ASC-ITEM-SUB)    TO TRUE                27250023
272600         SET ASC-FCSE-AREA-NO-UPDATE                              27260023
272700             (ASC-BLK-SUB ASC-ITEM-SUB)    TO TRUE                27270023
272800         SET ASC-BLOCK-MODIFIED                                   27280023
272900             (ASC-BLK-SUB)                 TO TRUE                27290023
273000     END-EVALUATE.                                                27300023
273100                                                                  27310023
273200     EVALUATE TRUE                                                27320023
273300     WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)                  27330023
273400     WHEN DP020-FK-LOCAL-FUNC-06 (DP020-SRC-AID)                  27340023
273500     WHEN DP020-FK-LOCAL-FUNC-07 (DP020-SRC-AID)                  27350023
273600     WHEN DP020-SRC-AID = DP016-ENTER                             27360023
273700          IF  ASC-FCSE-AREA (ASC-BLK-SUB ASC-ITEM-SUB) > SPACES   27370023
273800              SET ASC-HAVE-FCSE-PROCESS-AREA                      27380023
273900                  (ASC-BLK-SUB ASC-ITEM-SUB)    TO TRUE           27390023
274000              PERFORM 3320-CHECK-FCLTY-AREA                       27400023
274100          ELSE                                                    27410023
274200              SET ASC-NEED-FCSE-PROCESS-AREA                      27420023
274300                 (ASC-BLK-SUB ASC-ITEM-SUB)    TO TRUE            27430023
274400          END-IF                                                  27440023
274500          PERFORM 3340-CHECK-CONFIRM-DATE                         27450023
274600          IF  PV-FCSE-CNFRMN-DATE  <  PV-CURRENT-DATE             27460023
274700              SET  ASC-FCSE-AREA-NO-UPDATE                        27470023
274800                   (ASC-BLK-SUB ASC-ITEM-SUB) TO TRUE             27480023
274900          ELSE                                                    27490023
275000              SET ASC-FCSE-AREA-UPDATEABLE                        27500023
275100                   (ASC-BLK-SUB ASC-ITEM-SUB) TO TRUE             27510023
275200          END-IF                                                  27520023
275300     END-EVALUATE.                                                27530023
275400                                                                  27540023
275500     SUBTRACT +1 FROM PV-ITEM-IN-USE.                             27550023
275600     SUBTRACT +1 FROM ASC-ITEM-SUB.                               27560023
275700                                                                  27570023
275800     IF  ASC-ITEM-SUB < 1                                         27580023
275900         SUBTRACT +1 FROM ASC-BLK-SUB                             27590023
276000         MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB                27600023
276100     END-IF.                                                      27610023
276200                                                                  27620023
276300                                                                  27630023
276400*----------------------------------------------------------------*27640023
276500*  CHECK TO SEE IF A RECEIVER HAS BEEN ARRIVED                   *27650023
276600*----------------------------------------------------------------*27660023
276700 3305-CHECK-RCVR-ARRIVED.                                         27670023
276800                                                                  27680023
276900     EXEC SQL                                                     27690023
277000         SELECT REC_TMST                                          27700023
277100           INTO :RECEIV-REC-TMST                                  27710023
277200           FROM TRECEIV                                           27720023
277300          WHERE ORD_NBR      =  :ASC-KEY-PO-NBR                   27730023
277400            AND REC_SEQ_NBR  =  :ASC-KEY-RCVR-NBR                 27740023
277500     END-EXEC                                                     27750023
277600                                                                  27760023
277700     EVALUATE TRUE                                                27770023
277800         WHEN SQLCODE = +0                                        27780023
277900              CONTINUE                                            27790023
278000         WHEN OTHER                                               27800023
278100              MOVE '3305-CHECK-RCVR-ARRIVED'                      27810023
278200                               TO DP013-PARAGRAPH                 27820023
278300              MOVE 'CHECK IF PO/RCVR ARRIVED '                    27830023
278400                               TO DP013-MESSAGE-TEXT (1)          27840023
278500              MOVE SQLCA       TO DP013-SQLCA                     27850023
278600              MOVE 'TRECEIV '  TO DP013-DB2-TABLE-NAME (1)        27860023
278700              SET DP013-DB2-ABEND                                 27870023
278800                  DP013-XCTL-DISPLAY-RESTART                      27880023
278900                                   TO TRUE                        27890023
279000                  PERFORM DP013-0000-PROCESS-ABEND                27900023
279100     END-EVALUATE.                                                27910023
279200                                                                  27920023
279300                                                                  27930023
279400*----------------------------------------------------------------*27940023
279500*  IF A BEGINNING AND END OF RANGE WAS ENTERED TO SELECT A       *27950023
279600*  RANGE OF LINES, MAKE SURE THERE IS ONLY 1 BEGINNING AND 1     *27960023
279700*  ENDING AND MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN) *27970023
279800*  THE ENDING.                                                   *27980023
279900*----------------------------------------------------------------*27990023
280000 3310-EDIT-RANGE.                                                 28000023
280100                                                                  28010023
280200     IF  ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)                28020023
280300         IF  ASC-START-OF-SELECTED-RANGE = ZERO                   28030023
280400             MOVE ASC-TEMP-SELECTED-SW  (ASC-BLK-SUB ASC-ITEM-SUB)28040023
280500                                   TO ASC-SELECTED-SW             28050023
280600                                        (ASC-BLK-SUB ASC-ITEM-SUB)28060023
280700             MOVE PV-ITEM-IN-USE   TO ASC-START-OF-SELECTED-RANGE 28070023
280800         ELSE                                                     28080023
280900             IF  ASC-START-OF-SELECTED-RANGE = PV-ITEM-IN-USE     28090023
281000                 CONTINUE                                         28100023
281100             ELSE                                                 28110023
281200*                -- ONLY ONE BEGINNING-OF-RANGE-ALLOWED --        28120023
281300                 MOVE PC-TSYMSG-00054                             28130023
281400                                   TO DP020-MSG-NUMBER            28140023
281500                 SET DP020-MSG-FATAL                              28150023
281600                                   TO TRUE                        28160023
281700                 MOVE -1           TO MR-SELECTL (PV-SUB)         28170023
281800                 SET DP030-SET-CURSOR-APPL-1                      28180023
281900                                   TO TRUE                        28190023
282000                 MOVE DP015-RED    TO MR-SELECTC (PV-SUB)         28200023
282100                 MOVE DP015-UNDERLINE                             28210023
282200                                   TO MR-SELECTH (PV-SUB)         28220023
282300                 SET PS-ERROR      TO TRUE                        28230023
282400             END-IF                                               28240023
282500         END-IF                                                   28250023
282600     ELSE                                                         28260023
282700         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     28270023
282800             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 28280023
282900                                   TO ASC-SELECTED-SW             28290023
283000                                     (ASC-BLK-SUB ASC-ITEM-SUB)   28300023
283100             MOVE PV-ITEM-IN-USE   TO ASC-END-OF-SELECTED-RANGE   28310023
283200         ELSE                                                     28320023
283300             IF  ASC-END-OF-SELECTED-RANGE = PV-ITEM-IN-USE       28330023
283400                 CONTINUE                                         28340023
283500             ELSE                                                 28350023
283600*                -- ONLY ONE END-OF-RANGE ALLOWED --              28360023
283700                 MOVE PC-TSYMSG-00055                             28370023
283800                                   TO DP020-MSG-NUMBER            28380023
283900                 SET DP020-MSG-FATAL                              28390023
284000                                   TO TRUE                        28400023
284100                 MOVE -1           TO MR-SELECTL (PV-SUB)         28410023
284200                 SET DP030-SET-CURSOR-APPL-1                      28420023
284300                                   TO TRUE                        28430023
284400                 SET PS-ERROR      TO TRUE                        28440023
284500             END-IF                                               28450023
284600         END-IF                                                   28460023
284700     END-IF.                                                      28470023
284800                                                                  28480023
284900                                                                  28490023
285000                                                                  28500023
285100*----------------------------------------------------------------*28510023
285200* VALIDATE FULLCASE PROCESS AREA AGAINST 'TFLAREA' TABLE         *28520023
285300*----------------------------------------------------------------*28530023
285400 3320-CHECK-FCLTY-AREA.                                           28540023
285500                                                                  28550023
285600***  MOVE ASC-OPER-UNT-ID          TO  DK-OPER-UNT-ID.            28560023
285700     MOVE ASC-TRECEIV-DC           TO  DK-OPER-UNT-ID.            28570023
285800     MOVE ASC-FCLTY-ID             TO  DK-FCLTY-ID.               28580023
285900     MOVE ASC-FCSE-AREA (ASC-BLK-SUB ASC-ITEM-SUB)                28590023
286000                                   TO  PV-FCSE-AREA-ID.           28600023
286100                                                                  28610023
286200     EXEC SQL                                                     28620023
286300          SELECT FCLTY_AREA_ID                                    28630023
286400           INTO :FLAREA-FCLTY-AREA-ID                             28640023
286500           FROM  TFLAREA                                          28650023
286600          WHERE  OPER_UNT_ID       = :DK-OPER-UNT-ID              28660023
286700            AND  FCLTY_ID          = :DK-FCLTY-ID                 28670023
286800            AND  FCLTY_LOC_TYP_CDE = 'PA'                         28680023
286900            AND  FCLTY_AREA_ID     = :PV-FCSE-AREA-ID             28690023
287000     END-EXEC.                                                    28700023
287100                                                                  28710023
287200     EVALUATE TRUE                                                28720023
287300         WHEN SQLCODE = +0                                        28730023
287400              SET ASC-GOOD-FCSE-PROCESS-AREA                      28740023
287500                  (ASC-BLK-SUB ASC-ITEM-SUB)           TO  TRUE   28750023
287600         WHEN SQLCODE = +100                                      28760023
287700              SET ASC-BAD-FCSE-PROCESS-AREA                       28770023
287800                  (ASC-BLK-SUB ASC-ITEM-SUB)           TO  TRUE   28780023
287900         WHEN SQLCODE = -904                                      28790023
288000         WHEN SQLCODE = -911                                      28800023
288100         WHEN SQLCODE = -913                                      28810023
288200             MOVE '3320-CHECK-FCLTY-AREA'                         28820023
288300                                   TO DP013-PARAGRAPH             28830023
288400             MOVE SQLCODE            TO PC-DISPLAY-SQL-CODE       28840023
288500             PERFORM 9900-SOFT-ABORT                              28850023
288600         WHEN SQLWARN0 NOT = SPACE                                28860023
288700         WHEN SQLCODE  NOT = ZERO                                 28870023
288800             MOVE '3320-CHECK-FCLTY-AREA'                         28880023
288900                                   TO DP013-PARAGRAPH             28890023
289000             MOVE 'VALIDATE FCSE PROCESS AREA'                    28900023
289100                                   TO DP013-MESSAGE-TEXT (1)      28910023
289200             MOVE SQLCA       TO DP013-SQLCA                      28920023
289300             MOVE 'TFLAREA'   TO DP013-DB2-TABLE-NAME (1)         28930023
289400             MOVE 'TRECITM'   TO DP013-DB2-TABLE-NAME (2)         28940023
289500             SET DP013-DB2-ABEND                                  28950023
289600                                   TO TRUE                        28960023
289700             PERFORM DP013-0000-PROCESS-ABEND                     28970023
289800     END-EVALUATE.                                                28980023
289900                                                                  28990023
290000                                                                  29000023
290100*----------------------------------------------------------------*29010023
290200*                                                                *29020023
290300*----------------------------------------------------------------*29030023
290400 3340-CHECK-CONFIRM-DATE.                                         29040023
290500                                                                  29050023
290600     MOVE ASC-KEY-PO-NBR                          TO DK-ORD-NBR.  29060023
290700     MOVE ASC-KEY-RCVR-NBR                        TO DK-RCVR-NBR. 29070023
290800     MOVE ASC-LINE-NBR(ASC-BLK-SUB ASC-ITEM-SUB)  TO DK-LINE-NBR. 29080023
290900                                                                  29090023
291000     EXEC SQL                                                     29100023
291100     SELECT FCSE_CNFRMN_TMST                                      29110023
291200        ,   CURRENT TIMESTAMP                                     29120023
291300        INTO :PV-FCSE-CNFRMN-TMST                                 29130023
291400        ,    :PV-CURRENT-TMST                                     29140023
291500        FROM  TDISTHD                                             29150023
291600      WHERE ORD_NBR                  = :DK-ORD-NBR                29160023
291700        AND RCVR_SEQ_NBR             = :DK-RCVR-NBR               29170023
291800        AND ORD_LNE_NBR              = :DK-LINE-NBR               29180023
291900     END-EXEC.                                                    29190023
292000                                                                  29200023
292100     EVALUATE TRUE                                                29210023
292200         WHEN SQLCODE = ZERO                                      29220023
292300              CONTINUE                                            29230023
292400         WHEN SQLCODE = -904                                      29240023
292500         WHEN SQLCODE = -911                                      29250023
292600         WHEN SQLCODE = -913                                      29260023
292700             MOVE '3340-CHECK-CONFIRM-DATE'                       29270023
292800                                  TO DP013-PARAGRAPH              29280023
292900             MOVE SQLCODE            TO PC-DISPLAY-SQL-CODE       29290023
293000             PERFORM 9900-SOFT-ABORT                              29300023
293100                                                                  29310023
293200         WHEN SQLWARN0 NOT = SPACES                               29320023
293300         WHEN SQLCODE < ZERO                                      29330023
293400         WHEN SQLCODE > ZERO                                      29340023
293500             MOVE '3340-CHECK-CONFIRM-DATE'                       29350023
293600                                  TO DP013-PARAGRAPH              29360023
293700             MOVE 'UNSUCCESSFUL SELECT TDISTHD '                  29370023
293800                                  TO DP013-MESSAGE-TEXT (1)       29380023
293900             MOVE SQLCA      TO DP013-SQLCA                       29390023
294000             MOVE 'TDISTHD ' TO DP013-DB2-TABLE-NAME (1)          29400023
294100             SET DP013-DB2-ABEND                                  29410023
294200                  DP013-NO-ROLLBACK                               29420023
294300                                  TO TRUE                         29430023
294400             PERFORM DP013-0000-PROCESS-ABEND                     29440023
294500     END-EVALUATE.                                                29450023
294600                                                                  29460023
294700                                                                  29470023
294800*----------------------------------------------------------------*29480023
294900*  IF BOTH A BEGINNING AND END OF RANGE HAVE BEEN SPECIFIED,     *29490023
295000*  MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN) THE END.   *29500023
295100*----------------------------------------------------------------*29510023
295200 3400-CHECK-RANGE-SEQUENCE.                                       29520023
295300                                                                  29530023
295400     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       29540023
295500       AND  ASC-END-OF-SELECTED-RANGE > ZERO                      29550023
295600       AND  ASC-START-OF-SELECTED-RANGE >                         29560023
295700                                         ASC-END-OF-SELECTED-RANGE29570023
295800*        -- END-OF-RANGE BEFORE BEGINNING-OF-RANGE                29580023
295900         MOVE PC-TSYMSG-00052      TO DP020-MSG-NUMBER            29590023
296000         SET DP020-MSG-FATAL       TO TRUE                        29600023
296100         SET PS-ERROR              TO TRUE                        29610023
296200         PERFORM 3410-POSITION-AT-ERROR                           29620023
296300     END-IF.                                                      29630023
296400                                                                  29640023
296500*----------------------------------------------------------------*29650023
296600*  BECAUSE RANGES CAN SPAN ACROSS MULTIPLE PAGES, A SEPARATE     *29660023
296700*  PARAGRAPH (THIS ONE) IS NEEDED TO DETERMINE WHERE THE CURSOR  *29670023
296800*  SHOULD BE POSITIONED ON A RANGE ERROR.                        *29680023
296900*----------------------------------------------------------------*29690023
297000 3410-POSITION-AT-ERROR.                                          29700023
297100                                                                  29710023
297200     SET DP030-SET-CURSOR-APPL-1   TO TRUE.                       29720023
297300                                                                  29730023
297400     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 29740023
297500                    - PV-TOP-ITEM + 1.                            29750023
297600                                                                  29760023
297700     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      29770023
297800         CONTINUE                                                 29780023
297900     ELSE                                                         29790023
298000         MOVE -1                   TO MR-SELECTL (PV-SUB)         29800023
298100         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         29810023
298200         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         29820023
298300     END-IF.                                                      29830023
298400                                                                  29840023
298500     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   29850023
298600                    - PV-TOP-ITEM + 1.                            29860023
298700                                                                  29870023
298800     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      29880023
298900         CONTINUE                                                 29890023
299000     ELSE                                                         29900023
299100         MOVE -1                   TO MR-SELECTL (PV-SUB)         29910023
299200         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         29920023
299300         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         29930023
299400     END-IF.                                                      29940023
299500                                                                  29950023
299600/                                                                 29960023
299700*----------------------------------------------------------------*29970023
299800*    WHENEVER THE USER SELECTS AN ITEM AS THE BEGINNING RANGE    *29980023
299900*    AND ONE AS THE ENDING RANGE, MARK THESE ITEMS AS WELL AS    *29990023
300000*    THOSE THAT FALL IN THE RANGE AS BEING SELECTED.             *30000023
300100*----------------------------------------------------------------*30010023
300200                                                                  30020023
300300 3500-MARK-RANGE-AS-SELECTED.                                     30030023
300400                                                                  30040023
300500     MOVE +1                       TO ASC-BLK-SUB.                30050023
300600                                                                  30060023
300700     PERFORM 3510-MARK-SELECTED-INDS                              30070023
300800         VARYING ASC-ITEM-SUB                                     30080023
300900         FROM 1 BY 1                                              30090023
301000         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 30100023
301100                                                                  30110023
301200     ADD +1                        TO ASC-BLK-SUB.                30120023
301300                                                                  30130023
301400     PERFORM 3510-MARK-SELECTED-INDS                              30140023
301500         VARYING ASC-ITEM-SUB                                     30150023
301600         FROM 1 BY 1                                              30160023
301700         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 30170023
301800                                                                  30180023
301900     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               30190023
302000                                   TO PV-LIST-ITEM-NUMBER.        30200023
302100                                                                  30210023
302200     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            30220023
302300         1 + ((PV-LIST-ITEM-NUMBER - 1) /                         30230023
302400               PC-ITEMS-PER-PANEL).                               30240023
302500                                                                  30250023
302600     MOVE ASC-START-OF-SELECTED-RANGE                             30260023
302700                                   TO PV-START-OF-SELECTED-RANGE. 30270023
302800                                                                  30280023
302900     COMPUTE PV-FIRST-BLOCK-IN-RANGE =                            30290023
303000         1 + ((PV-START-OF-SELECTED-RANGE - 1) /                  30300023
303100               PC-ITEMS-PER-PANEL).                               30310023
303200                                                                  30320023
303300     MOVE ASC-END-OF-SELECTED-RANGE                               30330023
303400                                   TO PV-END-OF-SELECTED-RANGE.   30340023
303500                                                                  30350023
303600     COMPUTE PV-LAST-BLOCK-IN-RANGE =                             30360023
303700         1 + ((PV-END-OF-SELECTED-RANGE - 1) /                    30370023
303800               PC-ITEMS-PER-PANEL).                               30380023
303900                                                                  30390023
304000     COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                             30400023
304100         PV-FIRST-BLOCK-IN-ARRAY + 1.                             30410023
304200                                                                  30420023
304300     IF (PV-FIRST-BLOCK-IN-RANGE < PV-FIRST-BLOCK-IN-ARRAY) OR    30430023
304400        (PV-LAST-BLOCK-IN-RANGE  > PV-NEXT-BLOCK-IN-ARRAY)        30440023
304500         MOVE +1                   TO ASC-BLK-SUB                 30450023
304600         PERFORM 5100-WRITE-TEMP-STORAGE                          30460023
304700         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         30470023
304800             PV-FIRST-BLOCK-IN-ARRAY - 1                          30480023
304900                                                                  30490023
305000         PERFORM                                                  30500023
305100             UNTIL PV-FIRST-BLOCK-IN-RANGE >                      30510023
305200                   PV-PREV-BLOCK-IN-ARRAY                         30520023
305300             MOVE PV-FIRST-BLOCK-IN-RANGE                         30530023
305400                                   TO PV-BLOCK-NUMBER             30540023
305500             PERFORM 4410-READ-TEMP-STORAGE                       30550023
305600             PERFORM 3510-MARK-SELECTED-INDS                      30560023
305700                 VARYING ASC-ITEM-SUB                             30570023
305800                 FROM 1 BY 1                                      30580023
305900                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          30590023
306000             PERFORM 5100-WRITE-TEMP-STORAGE                      30600023
306100             ADD +1                TO PV-FIRST-BLOCK-IN-RANGE     30610023
306200         END-PERFORM                                              30620023
306300                                                                  30630023
306400         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         30640023
306500             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     30650023
306600         PERFORM                                                  30660023
306700             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       30670023
306800                   PV-LAST-BLOCK-IN-RANGE                         30680023
306900             MOVE PV-NEXT-BLOCK-IN-ARRAY                          30690023
307000                                   TO PV-BLOCK-NUMBER             30700023
307100             PERFORM 4410-READ-TEMP-STORAGE                       30710023
307200             PERFORM 3510-MARK-SELECTED-INDS                      30720023
307300                 VARYING ASC-ITEM-SUB                             30730023
307400                 FROM 1 BY 1                                      30740023
307500                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          30750023
307600             PERFORM 5100-WRITE-TEMP-STORAGE                      30760023
307700             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      30770023
307800         END-PERFORM                                              30780023
307900                                                                  30790023
308000         MOVE PV-FIRST-BLOCK-IN-ARRAY                             30800023
308100                                   TO PV-BLOCK-NUMBER             30810023
308200         PERFORM 4410-READ-TEMP-STORAGE                           30820023
308300     END-IF.                                                      30830023
308400                                                                  30840023
308500     MOVE ZERO                     TO ASC-START-OF-SELECTED-RANGE 30850023
308600                                      ASC-END-OF-SELECTED-RANGE.  30860023
308700/                                                                 30870023
308800*----------------------------------------------------------------*30880023
308900* SET THE SELECTION INDICATOR TO 'S' WITHIN THE RANGE.           *30890023
309000*----------------------------------------------------------------*30900023
309100                                                                  30910023
309200 3510-MARK-SELECTED-INDS.                                         30920023
309300                                                                  30930023
309400     IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB) >         30940023
309500         ASC-START-OF-SELECTED-RANGE)                             30950023
309600     OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB) =         30960023
309700         ASC-START-OF-SELECTED-RANGE)                             30970023
309800                                                                  30980023
309900         IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB) <     30990023
310000             ASC-END-OF-SELECTED-RANGE)                           31000023
310100         OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB) =     31010023
310200             ASC-END-OF-SELECTED-RANGE)                           31020023
310300                                                                  31030023
310400             IF NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          31040023
310500                 SET ASC-SELECT     (ASC-BLK-SUB  ASC-ITEM-SUB)   31050023
310600                     ASC-TEMP-SELECT(ASC-BLK-SUB  ASC-ITEM-SUB)   31060023
310700                                   TO TRUE                        31070023
310800                 SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB)              31080023
310900                                   TO TRUE                        31090023
311000                 ADD +1            TO ASC-NUMBER-OF-SELECTED-ITEMS31100023
311100             END-IF                                               31110023
311200         END-IF                                                   31120023
311300     END-IF.                                                      31130023
311400/                                                                 31140023
311500*----------------------------------------------------------------*31150023
311600*    INITIALIZE BOTH BLOCKS IN THE ARRAY.                        *31160023
311700*    INITIALIZE ALL COUNTERS AND FLAGS.                          *31170023
311800*    READ THE DATA BASE FOR THE 1ST TIME AND FILL UP THE ARRAY.  *31180023
311900*    DISPLAY THE PANEL TO USER.                                  *31190023
312000*----------------------------------------------------------------*31200023
312100                                                                  31210023
312200 4000-BUILD-INITIAL-PANEL.                                        31220023
312300                                                                  31230023
312400     INITIALIZE ASC-BLOCK-ENTRIES (1)                             31240023
312500                ASC-BLOCK-ENTRIES (2).                            31250023
312600                                                                  31260023
312700     MOVE +1                       TO ASC-BLK-SUB.                31270023
312800                                                                  31280023
312900     SET ASC-ITEMS-LEFT-ON-DB      TO TRUE.                       31290023
313000                                                                  31300023
313100     MOVE ZERO                     TO ASC-ITEM-SUB                31310023
313200                                      ASC-NUMBER-OF-ITEMS-READ    31320023
313300                                      ASC-NUMBER-OF-SELECTED-ITEMS31330023
313400                                      ASC-HIGHEST-BLOCK-WRITTEN   31340023
313500                                      ASC-START-OF-SELECTED-RANGE 31350023
313600                                      ASC-END-OF-SELECTED-RANGE   31360023
313700                                      ASC-ITEM-AT-TOP-OF-PANEL.   31370023
313800                                                                  31380023
313900                                                                  31390023
314000     PERFORM 4100-PREPARE-CURSOR.                                 31400023
314100                                                                  31410023
314200     PERFORM 8400-CHECK-AUTOVE.                                   31420023
314300                                                                  31430023
314400     PERFORM 7000-GET-DEPT.                                       31440023
314500     MOVE PURCHS-DEPT-NBR             TO ASC-DEPT                 31450023
314600                                                                  31460023
314700     IF  ASC-DEPT  >  SPACES                                      31470023
314800         PERFORM 7005-NUM-EDIT                                    31480023
314900     ELSE                                                         31490023
315000         MOVE ZEROES                  TO ASC-DEPT-N               31500023
315100     END-IF.                                                      31510023
315200                                                                  31520023
315300     PERFORM 7010-GET-VENDOR-NAME.                                31530023
315400     MOVE  PV-WORK-VENDOR-NAME  TO  ASC-VENDOR-NAME.              31540023
315500                                                                  31550023
315600     PERFORM 7150-GET-ZONE-DESC.                                  31560023
315700     MOVE MDSEDP-STR-ZN-ID            TO ASC-ZONE.                31570023
315800                                                                  31580023
315900     SET PS-NO-ERROR           TO  TRUE.                          31590023
316000     SET PS-PO-RCVR-NOT-FOUND  TO  TRUE.                          31600023
316100                                                                  31610023
316200     PERFORM 7200-GET-RCVR-STATUS.                                31620023
316300     MOVE RECEIV-STATUS-CDE           TO ASC-RCVR-STATUS.         31630023
316400     MOVE RECEIV-CURR-OPER-UNT-ID     TO ASC-TRECEIV-DC.          31640023
316500*TO HANDLE ALREADY EXISTING ORDERS (PROCESSED BY LINE), CHECK     31650023
316600*DISTHD-PREPK-LNE-PRC-CDE FOR PACKS & PROCESS OLD WAY IF BLANK.   31660023
316700     IF ASC-PKGNG-CDE = 'I' OR 'M'                                31670023
316800         MOVE +0 TO PV-PREPK-BLANK-COUNT                          31680023
316900         PERFORM 4030-CHECK-DISTHD                                31690023
317000         IF PV-PREPK-BLANK-COUNT > +0                             31700023
317100             MOVE 'X' TO ASC-PKGNG-CDE                            31710023
317200         END-IF                                                   31720023
317300     END-IF.                                                      31730023
317400                                                                  31740023
317500     IF  PS-NO-ERROR                                              31750023
317600         PERFORM 7550-FREIGHT-BILL                                31760023
317700         PERFORM 7560-CHECK-IF-ARRIVED                            31770023
317800                                                                  31780023
317900*        PERFORM 7600-COUNT-RCVR-TROUBLES                         31790023
318000                                                                  31800023
318100         PERFORM 4001A-CHECK4-DC-FLUSH                            31810025
318101         IF PS-DC-FLUSH-YES                                       31810125
318110             PERFORM 4001-BUILD-INVPAR-TABLE                      31811025
318120         END-IF                                                   31812025
318300                                                                  31830023
318400         IF ASC-PKGNG-CDE = 'I' OR 'M'                            31840023
318500             PERFORM 4210-OPEN-PREPK-CSR                          31850023
318600             PERFORM 4300-READ-ITEMS-FROM-DB                      31860023
318700             PERFORM 4220-CLOSE-PREPK-CSR                         31870023
318800         ELSE                                                     31880023
318900             PERFORM 4010-OPEN-CURSOR                             31890023
319000             PERFORM 4300-READ-ITEMS-FROM-DB                      31900023
319100             PERFORM 4020-CLOSE-CURSOR                            31910023
319200         END-IF                                                   31920023
319300                                                                  31930023
319400         MOVE +1                    TO  PV-TOP-ITEM               31940023
319500     END-IF.                                                      31950023
319600                                                                  31960023
319700     IF  PS-NO-ERROR                                              31970023
319800         IF  ASC-NUMBER-OF-ITEMS-READ = ZERO                      31980023
319900             IF DP020-NEXT-ACT-INITIAL                            31990023
320000                 SET DP020-NEXT-ACT-APPL-ERROR                    32000023
320100                                       TO TRUE                    32010023
320200                 SET DP020-MSG-FATAL   TO TRUE                    32020023
320300                 MOVE PC-TSYMSG-00050  TO DP020-MSG-NUMBER        32030023
320400             ELSE                                                 32040023
320500                 SET DP020-MSG-FATAL   TO TRUE                    32050023
320600                 MOVE PC-TSYMSG-00050  TO DP020-MSG-NUMBER        32060023
320700                 SET ASC-BLOCK-MODIFIED (1)                       32070023
320800                     ASC-BLOCK-MODIFIED (2)                       32080023
320900                                       TO TRUE                    32090023
321000                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             32100023
321100             END-IF                                               32110023
321200         ELSE                                                     32120023
321300             MOVE -1                   TO MR-SELECTL (1)          32130023
321400             SET DP030-SET-CURSOR-APPL-1                          32140023
321500                                       TO TRUE                    32150023
321600             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 32160023
321700         END-IF                                                   32170023
321800     END-IF.                                                      32180023
321801                                                                  32180125
321810******************************************************************32181025
321820*  CHECK TKRPRPM TO SEE IF THE DC'S NEED TO BE FLUSHED.           32182025
321830******************************************************************32183025
321841 4001A-CHECK4-DC-FLUSH.                                           32184125
321850                                                                  32185025
321860     EXEC SQL                                                     32186025
321870          SELECT  FUNC_TXT                                        32187025
321880          INTO   :KRPRPM-FUNC-TXT                                 32188025
321890          FROM  TKRPRPM                                           32189025
321891          WHERE LOC_ID            =  90                           32189125
321892            AND SYS_PRC_FUNC_CDE  =  'FLUSH'                      32189225
321893            AND FUNC_PRC_STAT_CDE =  'AC'                         32189325
321894     END-EXEC.                                                    32189425
321895                                                                  32189525
321896     EVALUATE TRUE                                                32189625
321897         WHEN SQLCODE = +0                                        32189725
321898            IF KRPRPM-FUNC-TXT = 'N'                              32189825
321899                SET PS-DC-FLUSH-NO  TO TRUE                       32189925
321900            ELSE                                                  32190025
321901                SET PS-DC-FLUSH-YES TO TRUE                       32190125
321902            END-IF                                                32190225
321903         WHEN OTHER                                               32190325
321904                SET PS-DC-FLUSH-NO  TO TRUE                       32190425
321905     END-EVALUATE.                                                32190525
321910                                                                  32191023
322000 4001-BUILD-INVPAR-TABLE.                                         32200023
322100                                                                  32210023
322200*    THIS SETS A SWITCH FOR EACH STORE THAT HAS AN INVENTORY      32220023
322300*    IN PROCESS.                                                  32230023
322400                                                                  32240023
322500     PERFORM 7400-OPEN-INVPAR-CSR                                 32250023
322600     PERFORM 7401-FETCH-INVPAR-CSR                                32260023
322700     INITIALIZE PT-INVPAR-TABLE.                                  32270023
322800     PERFORM                                                      32280023
322900         UNTIL PS-EOF-INVPAR-CSR                                  32290023
323000             MOVE XLT00025-LOC-NBR      TO PT-STORE-NBR           32300023
323100             SET PT-STORE-DOING-INVENTORY (PT-STORE-NBR)          32310023
323200                                      TO TRUE                     32320023
323300             PERFORM 7401-FETCH-INVPAR-CSR                        32330023
323400     END-PERFORM.                                                 32340023
323500                                                                  32350023
323600     PERFORM 7402-CLOSE-INVPAR-CSR.                               32360023
323700/                                                                 32370023
323800                                                                  32380023
323900 4010-OPEN-CURSOR.                                                32390023
324000                                                                  32400023
324100     EXEC SQL                                                     32410023
324200         OPEN SUSPEND-CSR                                         32420023
324300     END-EXEC                                                     32430023
324400                                                                  32440023
324500     EVALUATE TRUE                                                32450023
324600         WHEN SQLCODE = ZERO                                      32460023
324700              CONTINUE                                            32470023
324800         WHEN SQLCODE = -904                                      32480023
324900         WHEN SQLCODE = -911                                      32490023
325000         WHEN SQLCODE = -913                                      32500023
325100             MOVE '4010-OPEN-CURSOR'                              32510023
325200                                   TO DP013-PARAGRAPH             32520023
325300             MOVE SQLCODE            TO PC-DISPLAY-SQL-CODE       32530023
325400             PERFORM 9900-SOFT-ABORT                              32540023
325500         WHEN SQLWARN0 NOT = SPACE                                32550023
325600         WHEN SQLCODE  NOT = ZERO                                 32560023
325700             MOVE '4010-OPEN-CURSOR'                              32570023
325800                                   TO DP013-PARAGRAPH             32580023
325900             MOVE 'OPEN SUSPEND-CSR CURSOR'                       32590023
326000                                   TO DP013-MESSAGE-TEXT (1)      32600023
326100             MOVE SQLCA       TO DP013-SQLCA                      32610023
326200             MOVE 'TDISTHD'   TO DP013-DB2-TABLE-NAME (1)         32620023
326300             MOVE 'TRECITM'   TO DP013-DB2-TABLE-NAME (2)         32630023
326400             SET DP013-DB2-ABEND                                  32640023
326500                                   TO TRUE                        32650023
326600             PERFORM DP013-0000-PROCESS-ABEND                     32660023
326700     END-EVALUATE.                                                32670023
326800                                                                  32680023
326900/                                                                 32690023
327000*----------------------------------------------------------------*32700023
327100* CLOSE THE FACILITY CURSOR.                                     *32710023
327200*----------------------------------------------------------------*32720023
327300                                                                  32730023
327400 4020-CLOSE-CURSOR.                                               32740023
327500                                                                  32750023
327600     EXEC SQL                                                     32760023
327700         CLOSE SUSPEND-CSR                                        32770023
327800     END-EXEC.                                                    32780023
327900                                                                  32790023
328000     EVALUATE TRUE                                                32800023
328100         WHEN SQLCODE = ZERO                                      32810023
328200              CONTINUE                                            32820023
328300         WHEN SQLWARN0 NOT = SPACE                                32830023
328400         WHEN SQLCODE  NOT = ZERO                                 32840023
328500              MOVE '4020-CLOSE-CURSOR'                            32850023
328600                                   TO DP013-PARAGRAPH             32860023
328700              MOVE 'CLOSE SUSPEND-CSR CURSOR'                     32870023
328800                                   TO DP013-MESSAGE-TEXT (1)      32880023
328900              MOVE SQLCA           TO DP013-SQLCA                 32890023
329000              MOVE 'TDISTHD'       TO DP013-DB2-TABLE-NAME (1)    32900023
329100              MOVE 'TRECITM'       TO DP013-DB2-TABLE-NAME (2)    32910023
329200              SET DP013-DB2-ABEND  TO TRUE                        32920023
329300              PERFORM DP013-0000-PROCESS-ABEND                    32930023
329400     END-EVALUATE.                                                32940023
329500                                                                  32950023
329600*----------------------------------------------------------------*32960023
329700 4030-CHECK-DISTHD.                                               32970023
329800                                                                  32980023
329900     EXEC SQL                                                     32990023
330000         SELECT COUNT (*)                                         33000023
330100           INTO :PV-PREPK-BLANK-COUNT                             33010023
330200           FROM TDISTHD A                                         33020023
330300          WHERE A.ORD_NBR            = :DK-ORD-NBR                33030023
330400            AND A.RCVR_SEQ_NBR       = :DK-RCVR-NBR               33040023
330500            AND A.PREPK_LNE_PRC_CDE  = ' '                        33050023
330600            AND A.DLT_REQ_TMST       = :PC-DEFAULT-TMST           33060023
330700     END-EXEC.                                                    33070023
330800                                                                  33080023
330900     EVALUATE TRUE                                                33090023
331000         WHEN SQLCODE = ZERO                                      33100023
331100             CONTINUE                                             33110023
331200                                                                  33120023
331300         WHEN SQLWARN0 NOT = SPACES                               33130023
331400         WHEN SQLCODE < ZERO                                      33140023
331500         WHEN SQLCODE > ZERO                                      33150023
331600             MOVE '4030-CHECK-TDISTHD' TO DP013-PARAGRAPH         33160023
331700             MOVE 'UNSUCCESSFUL SELECT TDISTHD '                  33170023
331800                                   TO DP013-MESSAGE-TEXT (1)      33180023
331900             MOVE SQLCA            TO DP013-SQLCA                 33190023
332000             MOVE 'TDISTHD '       TO DP013-DB2-TABLE-NAME (1)    33200023
332100             SET DP013-DB2-ABEND                                  33210023
332200                 DP013-NO-ROLLBACK TO TRUE                        33220023
332300             PERFORM DP013-0000-PROCESS-ABEND                     33230023
332400     END-EVALUATE.                                                33240023
332500                                                                  33250023
332600*----------------------------------------------------------------*33260023
332700*    DEPENDING ON WHAT WAS PASSED IN THE COMMAREA, SETUP THE     *33270023
332800*    DB2 KEYS IN PREPARATION FOR THE OPEN CURSOR.                *33280023
332900*----------------------------------------------------------------*33290023
333000                                                                  33300023
333100 4100-PREPARE-CURSOR.                                             33310023
333200                                                                  33320023
333300     MOVE RC015-OPER-UNT-ID         TO DK-OPER-UNT-ID             33330023
333400                                      ASC-KEY-OPER-UNT-ID         33340023
333500                                      ASC-OPER-UNT-ID             33350023
333600                                                                  33360023
333700     MOVE RC015-FCLTY-ID            TO DK-FCLTY-ID                33370023
333800                                      ASC-KEY-FCLTY-ID            33380023
333900                                      ASC-FCLTY-ID                33390023
334000                                                                  33400023
334100     MOVE RC015-PO-LNE-NBR            TO ASC-KEY-LNE-NBR          33410023
334200                                                                  33420023
334300     IF ASC-KEY-LNE-NBR = ZERO                                    33430023
334400         MOVE ZERO                    TO ASC-LINE-LO              33440023
334500                                         DK-LINE-LO               33450023
334600         MOVE 999999999               TO ASC-LINE-HI              33460023
334700                                         DK-LINE-HI               33470023
334800     ELSE                                                         33480023
334900         MOVE ASC-KEY-LNE-NBR         TO ASC-LINE-LO              33490023
335000                                         ASC-LINE-HI              33500023
335100                                         DK-LINE-LO               33510023
335200                                         DK-LINE-HI               33520023
335300     END-IF                                                       33530023
335400                                                                  33540023
335500     MOVE ASC-KEY-RCVR-NBR          TO DK-RCVR-NBR                33550023
335600                                       ASC-RCVR-NBR.              33560023
335700                                                                  33570023
335800     MOVE ASC-KEY-PO-NBR            TO DK-ORD-NBR                 33580023
335900                                       ASC-ORD-NBR.               33590023
336000                                                                  33600023
336100                                                                  33610023
336200                                                                  33620023
336300*        IF RC012-PO-LNE-NBR  = ZERO                              33630023
336400*            MOVE ZERO             TO DK-LINE-LO                  33640023
336500*                                     ASC-LINE-LO                 33650023
336600*            MOVE +999999999       TO DK-LINE-HI                  33660023
336700*                                     ASC-LINE-HI                 33670023
336800*        ELSE                                                     33680023
336900*            MOVE RC012-PO-LNE-NBR TO DK-LINE-LO                  33690023
337000*                                     DK-LINE-HI                  33700023
337100*                                     ASC-LINE-LO                 33710023
337200*                                     ASC-LINE-HI                 33720023
337300*        END-IF                                                   33730023
337400                                                                  33740023
337500*----------------------------------------------------------------*33750023
337600* PRE-PACK ORDER - OPEN CURSOR                                   *33760023
337700*----------------------------------------------------------------*33770023
337800 4210-OPEN-PREPK-CSR.                                             33780023
337900                                                                  33790023
338000     EXEC SQL                                                     33800023
338100         OPEN PREPK-CSR                                           33810023
338200     END-EXEC                                                     33820023
338300                                                                  33830023
338400     EVALUATE TRUE                                                33840023
338500         WHEN SQLCODE = ZERO                                      33850023
338600             CONTINUE                                             33860023
338700                                                                  33870023
338800         WHEN SQLCODE = -904                                      33880023
338900         WHEN SQLCODE = -911                                      33890023
339000         WHEN SQLCODE = -913                                      33900023
339100             MOVE '4210-OPEN-PREPK-CSR' TO DP013-PARAGRAPH        33910023
339200             MOVE SQLCODE            TO PC-DISPLAY-SQL-CODE       33920023
339300             PERFORM 9900-SOFT-ABORT                              33930023
339400                                                                  33940023
339500         WHEN SQLWARN0 NOT = SPACE                                33950023
339600         WHEN SQLCODE  NOT = ZERO                                 33960023
339700             MOVE '4210-OPEN-PREPK-CSR' TO DP013-PARAGRAPH        33970023
339800             MOVE 'OPEN PREPK-CSR CURSOR'                         33980023
339900                                 TO DP013-MESSAGE-TEXT (1)        33990023
340000             MOVE SQLCA          TO DP013-SQLCA                   34000023
340100             MOVE 'TDISTHD'      TO DP013-DB2-TABLE-NAME (1)      34010023
340200             MOVE 'TRECITM'      TO DP013-DB2-TABLE-NAME (2)      34020023
340300             SET DP013-DB2-ABEND TO TRUE                          34030023
340400             PERFORM DP013-0000-PROCESS-ABEND                     34040023
340500     END-EVALUATE.                                                34050023
340600                                                                  34060023
340700                                                                  34070023
340800*----------------------------------------------------------------*34080023
340900* PRE-PACK ORDER - CLOSE CURSOR                                  *34090023
341000*----------------------------------------------------------------*34100023
341100 4220-CLOSE-PREPK-CSR.                                            34110023
341200                                                                  34120023
341300     EXEC SQL                                                     34130023
341400         CLOSE PREPK-CSR                                          34140023
341500     END-EXEC.                                                    34150023
341600                                                                  34160023
341700     EVALUATE TRUE                                                34170023
341800         WHEN SQLCODE = ZERO                                      34180023
341900             CONTINUE                                             34190023
342000                                                                  34200023
342100         WHEN SQLWARN0 NOT = SPACE                                34210023
342200         WHEN SQLCODE  NOT = ZERO                                 34220023
342300             MOVE '4220-CLOSE-PREPK-CSR' TO DP013-PARAGRAPH       34230023
342400             MOVE 'CLOSE PREPK-CSR CURSOR'                        34240023
342500                                  TO DP013-MESSAGE-TEXT (1)       34250023
342600             MOVE SQLCA           TO DP013-SQLCA                  34260023
342700             MOVE 'TDISTHD'       TO DP013-DB2-TABLE-NAME (1)     34270023
342800             MOVE 'TRECITM'       TO DP013-DB2-TABLE-NAME (2)     34280023
342900             SET DP013-DB2-ABEND  TO TRUE                         34290023
343000             PERFORM DP013-0000-PROCESS-ABEND                     34300023
343100     END-EVALUATE.                                                34310023
343200                                                                  34320023
343300*----------------------------------------------------------------*34330023
343400* PRE-PACK ORDER - FETCH CURSOR                                  *34340023
343500*----------------------------------------------------------------*34350023
343600 4230-PREPK-FETCH.                                                34360023
343700                                                                  34370023
343800     EXEC SQL                                                     34380023
343900         FETCH PREPK-CSR                                          34390023
344000          INTO                                                    34400023
344100                  :DISTHD-ORD-LNE-NBR                             34410023
344200                , :DISTHD-P2L-CART-CNT                            34420023
344300                , :DISTHD-FCSE-FCLTY-AREA-ID                      34430023
344400                , :DISTHD-FCSE-CART-CNT                           34440023
344500                , :DISTHD-INPK-CART-CNT                           34450023
344600                , :DISTHD-OTPK-UNT-QTY                            34460023
344700                , :DISTHD-INPK-UNT-QTY                            34470023
344800                , :DISTHD-INPK-CNVYB-IND                          34480023
344900                , :DISTHD-RSLTS-RCVD-TMST                         34490023
345000                , :PV-DATE                                        34500023
345100                , :PV-TIME                                        34510023
345200                , :DISTHD-PRCG-STAT-CDE                           34520023
345300                , :DISTHD-SPC-INSTR-DESC                          34530023
345400                , :DISTHD-SYS-CRE-CDE                             34540023
345500                , :DISTHD-TOT-CART-CNT                            34550023
345600                , :DISTHD-PRC-AREA-MODU-ID                        34560023
345700                , :DISTHD-FCSE-CNFRMN-TMST                        34570023
345800                , :PV-CURRENT-TMST                                34580023
345900                , :RECITM-CASE-PACK-QTY                           34590023
346000                , :RECITM-DTL-CK-ITM-QTY                          34600023
346100                , :RECITM-PKSL-ITM-QTY                            34610023
346200                , :RECITM-PREPK-ID                                34620023
346300                , :RECITM-PREPK-RATO-QTY                          34630023
346400                , :RECITM-PREPK-ODD-UNT-QTY                       34640023
346500                , :DISTHD-PREPK-LNE-PRC-CDE                       34650023
346600                , :POPRPK-PK-SKU-NBR                              34660023
346700     END-EXEC.                                                    34670023
346800                                                                  34680023
346900     EVALUATE TRUE                                                34690023
347000         WHEN SQLCODE = ZERO                                      34700023
347100             CONTINUE                                             34710023
347200                                                                  34720023
347300         WHEN SQLCODE = +100                                      34730023
347400             SET ASC-NO-ITEMS-LEFT-ON-DB TO TRUE                  34740023
347500                                                                  34750023
347600         WHEN SQLCODE = -904                                      34760023
347700         WHEN SQLCODE = -911                                      34770023
347800         WHEN SQLCODE = -913                                      34780023
347900             MOVE '4230-PREPK-FETCH' TO DP013-PARAGRAPH           34790023
348000             MOVE SQLCODE            TO PC-DISPLAY-SQL-CODE       34800023
348100             PERFORM 9900-SOFT-ABORT                              34810023
348200                                                                  34820023
348300         WHEN SQLWARN0 NOT = SPACE                                34830023
348400         WHEN SQLCODE < ZERO                                      34840023
348500         WHEN SQLCODE > ZERO                                      34850023
348600             MOVE '4230-PREPK-FETCH' TO DP013-PARAGRAPH           34860023
348700             MOVE 'FETCH PREPK-CSR CURSOR'                        34870023
348800                                  TO DP013-MESSAGE-TEXT (1)       34880023
348900             MOVE SQLCA           TO DP013-SQLCA                  34890023
349000             MOVE 'TDISTHD'       TO DP013-DB2-TABLE-NAME (1)     34900023
349100             MOVE 'TRECITM'       TO DP013-DB2-TABLE-NAME (2)     34910023
349200             SET DP013-DB2-ABEND  TO TRUE                         34920023
349300             PERFORM DP013-0000-PROCESS-ABEND                     34930023
349400     END-EVALUATE.                                                34940023
349500                                                                  34950023
349600/                                                                 34960023
349700*----------------------------------------------------------------*34970023
349800*    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE    *34980023
349900*    BLOCKS IN THE ARRAY.  WHENEVER BOTH BLOCKS BECOME FULL,     *34990023
350000*    WRITE OUT THE 1ST BLOCK TO TEMPORARY STORAGE, MOVE THE 2ND  *35000023
350100*    BLOCK IN THE ARRAY TO THE 1ST BLOCK, AND INITIALIZE THE     *35010023
350200*    2ND BLOCK MAKING IT AVAILABLE TO BE USED.                   *35020023
350300*                                                                *35030023
350400*    DUE TO THE SIZE OF THE TABLE, AND THE ORDER IN WHICH THE    *35040023
350500*    ROWS ARE SORTED, THE ENTIRE TABLE IS READ INTO THE PROGRAM  *35050023
350600*    UPON INITIALIZATION.                                        *35060023
350700*----------------------------------------------------------------*35070023
350800                                                                  35080023
350900 4300-READ-ITEMS-FROM-DB.                                         35090023
351000                                                                  35100023
351100     PERFORM                                                      35110023
351200         VARYING PV-READ-COUNT                                    35120023
351300         FROM 1 BY 1                                              35130023
351400         UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                    35140023
351500            OR (ASC-NO-ITEMS-LEFT-ON-DB))                         35150023
351600                                                                  35160023
351700         IF ASC-PKGNG-CDE = 'I' OR 'M'                            35170023
351800             PERFORM 4230-PREPK-FETCH                             35180023
351900         ELSE                                                     35190023
352000             PERFORM 4310-FETCH                                   35200023
352100         END-IF                                                   35210023
352200                                                                  35220023
352300* 4300A-BLOCK-SUBSCRIPTS ADVANCES TO A NEW LINE ON THE SCREEN.    35230023
352400         IF  ASC-ITEMS-LEFT-ON-DB                                 35240023
352500             PERFORM 4300A-BLOCK-SUBSCRIPTS                       35250023
352600                                                                  35260023
352700             PERFORM 4306-FILL-SCREEN-LINE                        35270023
352800         END-IF                                                   35280023
352900                                                                  35290023
353000     END-PERFORM.                                                 35300023
353100                                                                  35310023
353200     IF  ASC-NUMBER-OF-ITEMS-READ > ZERO                          35320023
353300         MOVE +1                   TO ASC-BLK-SUB                 35330023
353400         PERFORM 5100-WRITE-TEMP-STORAGE                          35340023
353500         ADD +1                    TO ASC-BLK-SUB                 35350023
353600         PERFORM 5100-WRITE-TEMP-STORAGE                          35360023
353700                                                                  35370023
353800         MOVE 1                    TO ASC-BLK-SUB                 35380023
353900                                      PV-BLOCK-NUMBER             35390023
354000         PERFORM 4410-READ-TEMP-STORAGE                           35400023
354100         IF  ASC-HIGHEST-BLOCK-WRITTEN GREATER THAN 1             35410023
354200             MOVE 2                TO ASC-BLK-SUB                 35420023
354300                                      PV-BLOCK-NUMBER             35430023
354400             PERFORM 4410-READ-TEMP-STORAGE                       35440023
354500         END-IF                                                   35450023
354600     END-IF.                                                      35460023
354700                                                                  35470023
354800 4300A-BLOCK-SUBSCRIPTS.                                          35480023
354900     IF  ASC-ITEMS-LEFT-ON-DB                                     35490023
355000             IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                35500023
355100                 ADD +1            TO ASC-ITEM-SUB                35510023
355200             ELSE                                                 35520023
355300                 ADD +1            TO ASC-BLK-SUB                 35530023
355400                 MOVE +1           TO ASC-ITEM-SUB                35540023
355500                                                                  35550023
355600                 IF  ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY         35560023
355700                     MOVE +1       TO ASC-BLK-SUB                 35570023
355800                     SET ASC-BLOCK-MODIFIED (1)                   35580023
355900                                   TO TRUE                        35590023
356000                     PERFORM 5100-WRITE-TEMP-STORAGE              35600023
356100                     MOVE ASC-BLOCK-ENTRIES                       35610023
356200                               (PC-MAX-BLOCKS-IN-ARRAY)           35620023
356300                                TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB) 35630023
356400                     ADD +1        TO ASC-BLK-SUB                 35640023
356500                     INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)   35650023
356600                     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)      35660023
356700                                   TO TRUE                        35670023
356800                 END-IF                                           35680023
356900             END-IF                                               35690023
357000             ADD +1                TO ASC-NUMBER-OF-ITEMS-READ    35700023
357100             MOVE ASC-NUMBER-OF-ITEMS-READ                        35710023
357200                                   TO ASC-LIST-ITEM-NUMBER        35720023
357300                                      (ASC-BLK-SUB ASC-ITEM-SUB)  35730023
357400     END-IF.                                                      35740023
357500/                                                                 35750023
357600*----------------------------------------------------------------*35760023
357700*                                               **   WR # 21361  *35770023
357800* ADDED CODE TO CHECK DUMMY SKU                                  *35780023
357900* ADDED CODE TO INCLUDE XLKUT001 LOGIC.                          *35790023
358000*----------------------------------------------------------------*35800023
358100 4306-FILL-SCREEN-LINE.                                           35810023
358200                                                                  35820023
358300     MOVE DISTHD-ORD-LNE-NBR       TO ASC-LINE-NBR                35830023
358400                                      (ASC-BLK-SUB ASC-ITEM-SUB)  35840023
358500                                      DK-LINE-NBR.                35850023
358600                                                                  35860023
358700     IF ASC-PKGNG-CDE = 'I' OR 'M'                                35870023
358800         MOVE 'PK-'                   TO ASC-PREPK-F3             35880023
358900                                      (ASC-BLK-SUB ASC-ITEM-SUB)  35890023
359000         MOVE RECITM-PREPK-ID         TO PV-PREPK-ID              35900023
359100         MOVE RECITM-PREPK-ID         TO ASC-PREPK-L4             35910023
359200                                      (ASC-BLK-SUB ASC-ITEM-SUB)  35920023
359300         MOVE SPACES                  TO ASC-PREPK-FILLER         35930023
359400                                      (ASC-BLK-SUB ASC-ITEM-SUB)  35940023
359500         MOVE RECITM-PREPK-RATO-QTY   TO ASC-PREPK-RATO-QTY       35950023
359600                                      (ASC-BLK-SUB ASC-ITEM-SUB)  35960023
359700     ELSE                                                         35970023
359800         PERFORM 7250-GET-SKU                                     35980023
359900         IF PURITM-ITM-NBR < 0                                    35990023
360000            MOVE '7250-GET-SKU'                                   36000023
360100                             TO DP013-PARAGRAPH                   36010023
360200            MOVE 'PURITM-ITM-NBR < 0     '                        36020023
360300                             TO DP013-MESSAGE-TEXT (1)            36030023
360400            MOVE SQLCA       TO DP013-SQLCA                       36040023
360500            MOVE 'TPURITM '  TO DP013-DB2-TABLE-NAME (1)          36050023
360600            SET DP013-DB2-ABEND                                   36060023
360700                DP013-NO-ROLLBACK                                 36070023
360800                             TO TRUE                              36080023
360900            PERFORM DP013-0000-PROCESS-ABEND                      36090023
361000         END-IF                                                   36100023
361100                                                                  36110023
361200         IF PURITM-ITM-NBR = 0                                    36120023
361300            IF PURITM-SKU-SEQ-NBR = PC-000                        36130023
361400               MOVE '00000000' TO PV-SKU-NBR                      36140023
361500            ELSE                                                  36150023
361600               IF PURITM-SKU-SEQ-NBR = PC-999                     36160023
361700                  MOVE '99999999' TO PV-SKU-NBR                   36170023
361800               ELSE                                               36180023
361900                  MOVE '7250-GET-SKU'                             36190023
362000                               TO DP013-PARAGRAPH                 36200023
362100                  MOVE 'PURITM-ITM-NBR = 0     '                  36210023
362200                               TO DP013-MESSAGE-TEXT (1)          36220023
362300                  MOVE SQLCA      TO DP013-SQLCA                  36230023
362400                  MOVE 'TPURITM ' TO DP013-DB2-TABLE-NAME (1)     36240023
362500                  SET DP013-DB2-ABEND                             36250023
362600                      DP013-NO-ROLLBACK                           36260023
362700                               TO TRUE                            36270023
362800                  PERFORM DP013-0000-PROCESS-ABEND                36280023
362900               END-IF                                             36290023
363000            END-IF                                                36300023
363100         END-IF                                                   36310023
363200                                                                  36320023
363300         IF PURITM-ITM-NBR > 0 AND                                36330023
363400            PS-CALL-API-YES    AND                                36340023
363500            ((PURITM-SKU-SEQ-NBR NOT = PC-000) AND                36350023
363600            (PURITM-SKU-SEQ-NBR NOT = PC-999))                    36360023
363700                                                                  36370023
363800            INITIALIZE XL001-ITEM-COMMAREA                        36380023
363900            MOVE PURITM-ITM-NBR   TO XL001-KEY-ITM-NBR            36390023
364000                                                                  36400023
364100            SET  XL001-BY-ITEM                                    36410023
364200                 XL001-SELECT-SKU TO TRUE                         36420023
364300                                                                  36430023
364400            CALL XL001-VSM-PGM USING  DFHEIBLK                    36440023
364500                                      XL001-COMMAREA              36450023
364600                                      XL001-ITEM-COMMAREA         36460023
364700                                                                  36470023
364800            EVALUATE TRUE                                         36480023
364900                                                                  36490023
365000                WHEN XL001-SKU-SQLCODE = +0                       36500023
365100                      MOVE XL001-SKU-NBR                          36510023
365200                                       TO  PV-SKU                 36520023
365300                      MOVE PV-SKU      TO  PV-SKU-NBR             36530023
365400                                                                  36540023
365500                WHEN XL001-SKU-SQLCODE = +100                     36550023
365600                                                                  36560023
365700                      INITIALIZE PV-SKU-NBR                       36570023
365800                                 PV-SKU                           36580023
365900                                                                  36590023
366000                WHEN XL001-SKU-CONTENTION                         36600023
366100                      MOVE '7020-SELECT-SKU-BY-ITM'               36610023
366200                                       TO DP013-PARAGRAPH         36620023
366300                      MOVE 'SKU CONTENTION'                       36630023
366400                                       TO DP013-MESSAGE-TEXT (1)  36640023
366500                      MOVE 'XLV_SKU '  TO DP013-DB2-TABLE-NAME (1)36650023
366600                      MOVE XL001-SQLCA TO DP013-SQLCA             36660023
366700                      SET DP013-DB2-ABEND                         36670023
366800                                       TO TRUE                    36680023
366900                      PERFORM DP013-0000-PROCESS-ABEND            36690023
367000                                                                  36700023
367100                WHEN OTHER                                        36710023
367200                      MOVE '7020-SELECT-SKU-BY-ITM'               36720023
367300                                       TO DP013-PARAGRAPH         36730023
367400                      MOVE 'INVALID RETURN'                       36740023
367500                                       TO DP013-MESSAGE-TEXT (1)  36750023
367600                      MOVE 'XLV_SKU '  TO DP013-DB2-TABLE-NAME (1)36760023
367700                      MOVE XL001-SQLCA TO DP013-SQLCA             36770023
367800                      SET DP013-DB2-ABEND                         36780023
367900                                       TO TRUE                    36790023
368000                      PERFORM DP013-0000-PROCESS-ABEND            36800023
368100            END-EVALUATE                                          36810023
368200         ELSE                                                     36820023
368300            INITIALIZE PV-SKU-NBR                                 36830023
368400                       PV-SKU                                     36840023
368500         END-IF                                                   36850023
368600         MOVE PV-SKU-NBR              TO ASC-SKU-NBR              36860023
368700                                      (ASC-BLK-SUB ASC-ITEM-SUB)  36870023
368800         MOVE ZEROES                  TO ASC-PREPK-RATO-QTY       36880023
368900                                      (ASC-BLK-SUB ASC-ITEM-SUB)  36890023
369000     END-IF.                                                      36900023
369100                                                                  36910023
369200*CASEPACK AREA.                                                   36920023
369300     MOVE DISTHD-FCSE-FCLTY-AREA-ID   TO ASC-FCSE-AREA            36930023
369400                                      (ASC-BLK-SUB ASC-ITEM-SUB). 36940023
369500                                                                  36950023
369600*CARTON COUNT.                                                    36960023
369700     IF ASC-AUTO-VE-YES AND PS-PACK-LNE-VERIFIED-NO               36970023
369800         INITIALIZE RC074-FIELDS                                  36980023
369900         SET RC074-CARTON-COUNT-YES TO TRUE                       36990023
370000         MOVE DISTHD-ORD-LNE-NBR  TO RC074-LINE-NBR               37000023
370100         PERFORM 4350-CALL-RCKUT128                               37010023
370200         MOVE RC074-FCSE-ACTL-OTBND-CNT                           37020023
370300                                      TO ASC-CARTON-COUNT         37030023
370400                                      (ASC-BLK-SUB ASC-ITEM-SUB)  37040023
370500     ELSE                                                         37050023
370600         IF DISTHD-INPK-CNVYB-IND = 'Y'                           37060023
370700             ADD DISTHD-INPK-CART-CNT TO DISTHD-FCSE-CART-CNT     37070023
370800                            GIVING       ASC-CARTON-COUNT         37080023
370900                                      (ASC-BLK-SUB ASC-ITEM-SUB)  37090023
371000         ELSE                                                     37100023
371100             MOVE DISTHD-FCSE-CART-CNT    TO ASC-CARTON-COUNT     37110023
371200                                      (ASC-BLK-SUB ASC-ITEM-SUB)  37120023
371300         END-IF                                                   37130023
371400     END-IF.                                                      37140023
371500                                                                  37150023
371600*OUTER PACK QUANTITY.                                             37160023
371700***  IF ASC-PKGNG-CDE = 'I' OR 'M'                                37170023
371800***      COMPUTE ASC-OUT-PACK-QTY (ASC-BLK-SUB ASC-ITEM-SUB)      37180023
371900***            = RECITM-CASE-PACK-QTY                             37190023
372000***            * RECITM-PREPK-RATO-QTY                            37200023
372100***  ELSE                                                         37210023
372200         MOVE DISTHD-OTPK-UNT-QTY     TO ASC-OUT-PACK-QTY         37220023
372300                                      (ASC-BLK-SUB ASC-ITEM-SUB)  37230023
372400***  END-IF.                                                      37240023
372500                                                                  37250023
372600*PROCESS QUANTITY(/PACK).                                         37260023
372700     PERFORM 7300-SUM-TDISTDT.                                    37270023
372800     IF ASC-PKGNG-CDE = 'I' OR 'M'                                37280023
372900         IF ASC-PREPK-RATO-QTY (ASC-BLK-SUB ASC-ITEM-SUB) NOT = 0 37290023
373000             IF ASC-AUTO-VE-YES AND PS-PACK-LNE-VERIFIED-NO       37300023
373100                 INITIALIZE RC074-FIELDS                          37310023
373200                 SET RC074-PACK-QTY-YES     TO TRUE               37320023
373300                 MOVE ASC-PREPK-L4 (ASC-BLK-SUB ASC-ITEM-SUB)     37330023
373400                                          TO RC074-PACK-ID        37340023
373500                 PERFORM 4350-CALL-RCKUT128                       37350023
373600                 MOVE RC074-FCSE-ACTL-PACK-QTY TO                 37360023
373700                        ASC-PROCESS-QTY (ASC-BLK-SUB ASC-ITEM-SUB)37370023
373800             ELSE                                                 37380023
373900                COMPUTE ASC-PROCESS-QTY (ASC-BLK-SUB ASC-ITEM-SUB)37390023
374000                   = DISTDT-FCSE-ACTL-UNT-QTY                     37400023
374100                   / ASC-PREPK-RATO-QTY(ASC-BLK-SUB ASC-ITEM-SUB) 37410023
374200             END-IF                                               37420023
374300         ELSE                                                     37430023
374400             IF ASC-AUTO-VE-YES AND PS-PACK-LNE-VERIFIED-NO       37440023
374500                 INITIALIZE RC074-FIELDS                          37450023
374600                 SET RC074-UNIT-QTY-YES     TO TRUE               37460023
374700                 MOVE DISTHD-ORD-LNE-NBR  TO RC074-LINE-NBR       37470023
374800                 PERFORM 4350-CALL-RCKUT128                       37480023
374900                 MOVE RC074-TOTAL-ACTL-ITM-QTY TO ASC-PROCESS-QTY 37490023
375000                                 (ASC-BLK-SUB ASC-ITEM-SUB)       37500023
375100             ELSE                                                 37510023
375200                 MOVE DISTDT-FCSE-ACTL-UNT-QTY TO ASC-PROCESS-QTY 37520023
375300                                 (ASC-BLK-SUB ASC-ITEM-SUB)       37530023
375400             END-IF                                               37540023
375500         END-IF                                                   37550023
375600     ELSE                                                         37560023
375700         IF ASC-AUTO-VE-YES AND PS-PACK-LNE-VERIFIED-NO           37570023
375800             INITIALIZE RC074-FIELDS                              37580023
375900             SET RC074-UNIT-QTY-YES     TO TRUE                   37590023
376000             MOVE DISTHD-ORD-LNE-NBR  TO RC074-LINE-NBR           37600023
376100             PERFORM 4350-CALL-RCKUT128                           37610023
376200             MOVE RC074-FCSE-ACTL-ITM-QTY TO ASC-PROCESS-QTY      37620023
376300                                 (ASC-BLK-SUB ASC-ITEM-SUB)       37630023
376400         ELSE                                                     37640023
376500             MOVE DISTDT-FCSE-ACTL-UNT-QTY TO ASC-PROCESS-QTY     37650023
376600                                 (ASC-BLK-SUB ASC-ITEM-SUB)       37660023
376700         END-IF                                                   37670023
376800     END-IF.                                                      37680023
376900                                                                  37690023
377000     PERFORM 7345-GET-TRECITM                                     37700023
377100     IF ASC-PKGNG-CDE = 'I' OR 'M'                                37710023
377200         IF ASC-AUTO-VE-YES AND PS-PACK-LNE-VERIFIED-NO           37720023
377300             MOVE RC074-ACTUAL-ODD-QTY TO ASC-ODD-UNIT-QTY        37730023
377400                                      (ASC-BLK-SUB ASC-ITEM-SUB)  37740023
377500         ELSE                                                     37750023
377600            MOVE 0 TO PV-PREPK-ODD-UNT-QTY                        37760023
377700            MOVE PV-PREPK-ID TO PV-PREPK-ID-COMP                  37770023
377800            PERFORM 4320-SELECT-ODD-UNIT                          37780023
377900            MOVE PV-PREPK-ODD-UNT-QTY TO ASC-ODD-UNIT-QTY         37790023
378000                                      (ASC-BLK-SUB ASC-ITEM-SUB)  37800023
378100     ELSE                                                         37810023
378200        MOVE 0 TO ASC-ODD-UNIT-QTY (ASC-BLK-SUB ASC-ITEM-SUB)     37820023
378300     END-IF.                                                      37830023
378400                                                                  37840023
378500*CONFIRMATION DATE/TIME.                                          37850023
378600     IF PV-DATE = PC-DEFAULT-DATE                                 37860023
378700         MOVE SPACES                  TO ASC-CONF-DATE            37870023
378800                                      (ASC-BLK-SUB ASC-ITEM-SUB)  37880023
378900                                         ASC-CONF-TIME            37890023
379000                                      (ASC-BLK-SUB ASC-ITEM-SUB)  37900023
379100     ELSE                                                         37910023
379200         MOVE PV-DATE                 TO ASC-CONF-DATE            37920023
379300                                      (ASC-BLK-SUB ASC-ITEM-SUB)  37930023
379400         MOVE PV-TIME                 TO ASC-CONF-TIME            37940023
379500                                      (ASC-BLK-SUB ASC-ITEM-SUB)  37950023
379600     END-IF.                                                      37960023
379700                                                                  37970023
379800     IF DISTHD-RSLTS-RCVD-TMST   = PC-DEFAULT-TMST                37980023
379900         IF (ASC-PKGNG-CDE = 'I' OR 'M')                          37990023
380000           AND (ASC-PREPK-RATO-QTY (ASC-BLK-SUB ASC-ITEM-SUB)     38000023
380100                NOT = ZERO)                                       38010023
380200             COMPUTE ASC-P2L-QTY (ASC-BLK-SUB ASC-ITEM-SUB)       38020023
380300                   = DISTDT-P2L-SPLT-UNT-QTY                      38030023
380400                   / ASC-PREPK-RATO-QTY(ASC-BLK-SUB ASC-ITEM-SUB) 38040023
380500         ELSE                                                     38050023
380600             MOVE DISTDT-P2L-SPLT-UNT-QTY TO ASC-P2L-QTY          38060023
380700                                      (ASC-BLK-SUB ASC-ITEM-SUB)  38070023
380800         END-IF                                                   38080023
380900     ELSE                                                         38090023
381000         IF (ASC-PKGNG-CDE = 'I' OR 'M')                          38100023
381100           AND (ASC-PREPK-RATO-QTY (ASC-BLK-SUB ASC-ITEM-SUB)     38110023
381200                NOT = ZERO)                                       38120023
381300             COMPUTE ASC-P2L-QTY (ASC-BLK-SUB ASC-ITEM-SUB)       38130023
381400                   = DISTDT-ACTL-ALLOC-QTY                        38140023
381500                   / ASC-PREPK-RATO-QTY(ASC-BLK-SUB ASC-ITEM-SUB) 38150023
381600         ELSE                                                     38160023
381700             MOVE DISTDT-ACTL-ALLOC-QTY  TO ASC-P2L-QTY           38170023
381800                                      (ASC-BLK-SUB ASC-ITEM-SUB)  38180023
381900         END-IF                                                   38190023
382000     END-IF.                                                      38200023
382100                                                                  38210023
382200     EVALUATE TRUE                                                38220023
382300     WHEN DISTDT-P2L-SPLT-UNT-QTY       = ZERO                    38230023
382400         MOVE 'N/A     '              TO ASC-P2L-STATUS           38240023
382500                                      (ASC-BLK-SUB ASC-ITEM-SUB)  38250023
382600     WHEN DISTHD-RSLTS-RCVD-TMST = PC-DEFAULT-TMST                38260023
382700         MOVE 'DOWNLD '               TO ASC-P2L-STATUS           38270023
382800                                      (ASC-BLK-SUB ASC-ITEM-SUB)  38280023
382900     WHEN OTHER                                                   38290023
383000         MOVE 'COMPLET'               TO ASC-P2L-STATUS           38300023
383100                                      (ASC-BLK-SUB ASC-ITEM-SUB)  38310023
383200     END-EVALUATE                                                 38320023
383300                                                                  38330023
383400     PERFORM 7350-CHECK-LINE-TROUBLE                              38340023
383500                                                                  38350023
383600     PERFORM 4306A-LINE-STATUS.                                   38360023
383700                                                                  38370023
383800     MOVE  DISTHD-FCSE-CNFRMN-TMST  TO  PV-FCSE-CNFRMN-TMST.      38380023
383900     IF  PV-FCSE-CNFRMN-DATE  <  PV-CURRENT-DATE                  38390023
384000         SET  ASC-FCSE-AREA-NO-UPDATE                             38400023
384100              (ASC-BLK-SUB ASC-ITEM-SUB) TO TRUE                  38410023
384200     ELSE                                                         38420023
384300          SET ASC-FCSE-AREA-UPDATEABLE                            38430023
384400               (ASC-BLK-SUB ASC-ITEM-SUB) TO TRUE                 38440023
384500      END-IF.                                                     38450023
384600                                                                  38460023
384700                                                                  38470023
384800*----------------------------------------------------------------*38480023
384900* CHANGES MADE FOR WR # 21361 ENDS HERE.                         *38490023
385000*----------------------------------------------------------------*38500023
385100                                                                  38510023
385200 4306A-LINE-STATUS.                                               38520023
385300**NOTE************************************************************38530023
385400* IF THE 4306A/B PARAGRAPHS ARE CHANGED, THE 4308A/B PARAGRAPHS   38540023
385500* MUST ALSO BE CHANGED.                                           38550023
385600* PARAGRAPHS 4308A/B ARE DUPLICATES OF THE 4306A/B                38560023
385700* THESE PARAGRAPHS WERE ADDED BECAUSE THE CONFIRM, UNCONFIRM, AND 38570023
385800* VERIFY PROCESSES WERE COMPARING THE ASC AND LQW WORK AREAS WITH 38580023
385900* UNMATCHING SUBSCRIPTS.                                          38590023
386000******************************************************************38600023
386100                                                                  38610023
386200     EVALUATE TRUE                                                38620023
386300     WHEN ASC-RCVR-STATUS = 'VE'                                  38630023
386400     WHEN RECITM-STATUS-CDE = 'VE'                                38640023
386500***      MOVE 'VERFYD '               TO ASC-LINE-STATUS          38650023
386600         MOVE 'VRFD '                 TO ASC-LINE-STATUS          38660023
386700                                      (ASC-BLK-SUB ASC-ITEM-SUB)  38670023
386800         SET ASC-LINE-PROTECT(ASC-BLK-SUB ASC-ITEM-SUB)  TO  TRUE 38680023
386900*        SET ASC-PROTECT-ALL-LINES    TO TRUE                     38690023
387000     WHEN DISTHD-PRCG-STAT-CDE = 'P' OR 'V'                       38700023
387100***      MOVE 'PRVRFYD'               TO ASC-LINE-STATUS          38710023
387200         MOVE 'PVFD '                 TO ASC-LINE-STATUS          38720023
387300                                      (ASC-BLK-SUB ASC-ITEM-SUB)  38730023
387400         SET ASC-LINE-PROTECT(ASC-BLK-SUB ASC-ITEM-SUB)  TO  TRUE 38740023
387500*        SET ASC-PROTECT-ALL-LINES    TO TRUE                     38750023
387600     WHEN DISTHD-PRCG-STAT-CDE = 'D'                              38760023
387700         IF  DISTHD-P2L-CART-CNT = ZEROES                         38770023
387800***          MOVE 'FCS RDY'           TO ASC-LINE-STATUS          38780023
387900             MOVE 'FCRD '             TO ASC-LINE-STATUS          38790023
388000                                      (ASC-BLK-SUB ASC-ITEM-SUB)  38800023
388100         ELSE                                                     38810023
388200***          MOVE 'IN PROC'           TO ASC-LINE-STATUS          38820023
388300             MOVE 'INPR '             TO ASC-LINE-STATUS          38830023
388400                                      (ASC-BLK-SUB ASC-ITEM-SUB)  38840023
388500         END-IF                                                   38850023
388600     WHEN DISTHD-PRCG-STAT-CDE = 'B'                              38860023
388700         IF DISTHD-FCSE-CNFRMN-TMST = PC-DEFAULT-TMST             38870023
388800***          MOVE 'CNFM ND'           TO ASC-LINE-STATUS          38880023
388900             MOVE 'FCRD '             TO ASC-LINE-STATUS          38890023
389000                                      (ASC-BLK-SUB ASC-ITEM-SUB)  38900023
389100         ELSE                                                     38910023
389200             IF DISTHD-RSLTS-RCVD-TMST = PC-DEFAULT-TMST          38920023
389300***              MOVE 'P2L ND '       TO ASC-LINE-STATUS          38930023
389400                 MOVE 'NP2L '         TO ASC-LINE-STATUS          38940023
389500                                      (ASC-BLK-SUB ASC-ITEM-SUB)  38950023
389600             END-IF                                               38960023
389700         END-IF                                                   38970023
389800* BAD RATIO (PREPK M & I)                                         38980023
389900     WHEN DISTHD-PRCG-STAT-CDE = 'A'                              38990023
390000          MOVE 'BRAT '                TO ASC-LINE-STATUS          39000023
390100                                      (ASC-BLK-SUB ASC-ITEM-SUB)  39010023
390200* NOT ARRIVED                                                     39020023
390300     WHEN DISTHD-PRCG-STAT-CDE = 'G'                              39030023
390400          IF  PS-NOT-ARRIVED                                      39040023
390500              MOVE 'NARV'          TO ASC-LINE-STATUS             39050023
390600                                      (ASC-BLK-SUB ASC-ITEM-SUB)  39060023
390700          ELSE                                                    39070023
390800              MOVE SPACES          TO ASC-LINE-STATUS             39080023
390900                                      (ASC-BLK-SUB ASC-ITEM-SUB)  39090023
391000          END-IF                                                  39100023
391100     WHEN DISTHD-PRCG-STAT-CDE  =  'H'                            39110023
391200         MOVE  'AUDT'              TO ASC-LINE-STATUS             39120023
391300                                      (ASC-BLK-SUB ASC-ITEM-SUB)  39130023
391400     WHEN DISTHD-PRCG-STAT-CDE  =  'J'                            39140023
391500         MOVE  'NACT '             TO ASC-LINE-STATUS             39150023
391600                                      (ASC-BLK-SUB ASC-ITEM-SUB)  39160023
391700     WHEN DISTHD-PRCG-STAT-CDE  =  'K'                            39170023
391800         MOVE  'CF AU'             TO ASC-LINE-STATUS             39180023
391900                                      (ASC-BLK-SUB ASC-ITEM-SUB)  39190023
392000     WHEN DISTHD-PRCG-STAT-CDE  =  'L'                            39200023
392100         MOVE  'CF TR'             TO ASC-LINE-STATUS             39210023
392200                                      (ASC-BLK-SUB ASC-ITEM-SUB)  39220023
392300     WHEN OTHER                                                   39230023
392400         IF DISTHD-PRCG-STAT-CDE = 'E'                            39240023
392500            MOVE 'ERR'             TO ASC-LINE-STATUS             39250023
392600                                      (ASC-BLK-SUB ASC-ITEM-SUB)  39260023
392700         END-IF                                                   39270023
392800         IF PV-TRBL-LINE-COUNT > ZERO                             39280023
392900             PERFORM 4306A1-YES-TROUBLE                           39290023
393000         ELSE                                                     39300023
393100             PERFORM 4306A2-NO-TROUBLE                            39310023
393200         END-IF                                                   39320023
393300     END-EVALUATE.                                                39330023
393400                                                                  39340023
393500     IF ASC-LINE-STATUS (ASC-BLK-SUB ASC-ITEM-SUB) = SPACES       39350023
393600***      MOVE 'READY  '               TO ASC-LINE-STATUS          39360023
393700         MOVE 'RDY  '                 TO ASC-LINE-STATUS          39370023
393800                                      (ASC-BLK-SUB ASC-ITEM-SUB)  39380023
393900         PERFORM 7600-COUNT-RCVR-TROUBLES                         39390023
394000         IF PV-TRBL-RCVR-COUNT > ZERO                             39400023
394100             SET ASC-LINE-CAUTION (ASC-BLK-SUB ASC-ITEM-SUB)      39410023
394200                                      TO TRUE                     39420023
394300         END-IF                                                   39430023
394400     END-IF.                                                      39440023
394500                                                                  39450023
394600 4306A1-YES-TROUBLE.                                              39460023
394700                                                                  39470023
394800***  MOVE 'TRBL   '            TO ASC-LINE-STATUS                 39480023
394900     MOVE 'TRBL '              TO ASC-LINE-STATUS                 39490023
395000                                      (ASC-BLK-SUB ASC-ITEM-SUB). 39500023
395100                                                                  39510023
395200     EVALUATE DISTHD-PRCG-STAT-CDE                                39520023
395300         WHEN 'E'                                                 39530023
395400         WHEN 'I'                                                 39540023
395500             PERFORM 4306B-DISTDT-VS-TRECDIS                      39550023
395600             IF PS-MATCH-ERROR                                    39560023
395700             OR PS-STORE-INVENTORY-POSSIBLE                       39570023
395800***                  MOVE 'MLT ISU'   TO ASC-LINE-STATUS          39580023
395900                     MOVE 'MLTIS'     TO ASC-LINE-STATUS          39590023
396000                                      (ASC-BLK-SUB ASC-ITEM-SUB)  39600023
396100             END-IF                                               39610023
396200                                                                  39620023
396300         WHEN 'F'                                                 39630023
396400             IF PV-FREIGHT-COUNT = ZERO                           39640023
396500***              MOVE 'MLT ISU'       TO ASC-LINE-STATUS          39650023
396600                 MOVE 'MLTIS'         TO ASC-LINE-STATUS          39660023
396700                                      (ASC-BLK-SUB ASC-ITEM-SUB)  39670023
396800             END-IF                                               39680023
396900     END-EVALUATE.                                                39690023
397000                                                                  39700023
397100 4306A2-NO-TROUBLE.                                               39710023
397200                                                                  39720023
397300     PERFORM 4306B-DISTDT-VS-TRECDIS.                             39730023
397400     EVALUATE DISTHD-PRCG-STAT-CDE                                39740023
397500         WHEN 'E'                                                 39750023
397600         WHEN 'I'                                                 39760023
397700             EVALUATE TRUE                                        39770023
397800                 WHEN PS-MATCH-ERROR                              39780023
397900                  AND PS-STORE-INVENTORY-POSSIBLE                 39790023
398000***                      MOVE 'MLT ISU'                           39800023
398100                         MOVE 'MLTIS'                             39810023
398200                                      TO ASC-LINE-STATUS          39820023
398300                                      (ASC-BLK-SUB ASC-ITEM-SUB)  39830023
398400                                                                  39840023
398500                 WHEN PS-STORE-INVENTORY-POSSIBLE                 39850023
398600***                  MOVE 'PHYINV '   TO ASC-LINE-STATUS          39860023
398700                     MOVE 'PHYIN'     TO ASC-LINE-STATUS          39870023
398800                                      (ASC-BLK-SUB ASC-ITEM-SUB)  39880023
398900                                                                  39890023
399000                 WHEN PS-MATCH-ERROR                              39900023
399100***                  MOVE 'MS STRS'   TO ASC-LINE-STATUS          39910023
399200                     MOVE 'MSTRS'     TO ASC-LINE-STATUS          39920023
399300                                      (ASC-BLK-SUB ASC-ITEM-SUB)  39930023
399400             END-EVALUATE                                         39940023
399500         WHEN 'F'                                                 39950023
399600             PERFORM 7550-FREIGHT-BILL                            39960023
399700***              MOVE 'NO PRO#'       TO ASC-LINE-STATUS          39970023
399800                 MOVE 'NOPR#'         TO ASC-LINE-STATUS          39980023
399900                                      (ASC-BLK-SUB ASC-ITEM-SUB)  39990023
400000         WHEN 'G'                                                 40000023
400100             PERFORM 7560-CHECK-IF-ARRIVED                        40010023
400200             IF  PS-NOT-ARRIVED                                   40020023
400300                 MOVE 'NARV'          TO ASC-LINE-STATUS          40030023
400400                                      (ASC-BLK-SUB ASC-ITEM-SUB)  40040023
400500             ELSE                                                 40050023
400600                 MOVE SPACES          TO ASC-LINE-STATUS          40060023
400700                                      (ASC-BLK-SUB ASC-ITEM-SUB)  40070023
400800             END-IF                                               40080023
400900         WHEN 'H'                                                 40090023
401000             MOVE  'AUDT'             TO ASC-LINE-STATUS          40100023
401100                                      (ASC-BLK-SUB ASC-ITEM-SUB)  40110023
401200     END-EVALUATE.                                                40120023
401300/                                                                 40130023
401400 4306B-DISTDT-VS-TRECDIS.                                         40140023
401500     PERFORM 7410-OPEN-TDISTDT-CSR                                40150023
401600     PERFORM 7411-FETCH-TDISTDT-CSR                               40160023
401700     PERFORM UNTIL PS-EOF-TDISTDT-CSR OR PS-MATCH-ERROR           40170023
401800         IF  PT-STORE-DOING-INVENTORY (DISTDT-STR-NBR)            40180023
401900             SET PS-STORE-INVENTORY-POSSIBLE TO TRUE              40190023
402000         END-IF                                                   40200023
402100         PERFORM 7415-SELECT-TRECDIS                              40210023
402200         IF  SQLCODE = +100                                       40220023
402300             SET PS-MATCH-ERROR       TO TRUE                     40230023
402400         ELSE                                                     40240023
402500             PERFORM 7411-FETCH-TDISTDT-CSR                       40250023
402600         END-IF                                                   40260023
402700     END-PERFORM                                                  40270023
402800                                                                  40280023
402900     PERFORM 7412-CLOSE-TDISTDT-CSR.                              40290023
403000                                                                  40300023
403100 4308A-LINE-STATUS.                                               40310023
403200**NOTE************************************************************40320023
403300* IF THE 4308A/B PARAGRAPHS ARE CHANGED, THE 4306A/B PARAGRAPHS   40330023
403400* MUST ALSO BE CHANGED.                                           40340023
403500* PARAGRAPHS 4308A/B ARE DUPLICATES OF THE 4306A/B                40350023
403600* THESE PARAGRAPHS WERE ADDED BECAUSE THE CONFIRM, UNCONFIRM, AND 40360023
403700* VERIFY PROCESSES WERE COMPARING THE ASC AND LQW WORK AREAS WITH 40370023
403800* UNMATCHING SUBSCRIPTS.                                          40380023
403900******************************************************************40390023
404000                                                                  40400023
404100     EVALUATE TRUE                                                40410023
404200     WHEN ASC-RCVR-STATUS = 'VE'                                  40420023
404300     WHEN RECITM-STATUS-CDE = 'VE'                                40430023
404400         MOVE 'VRFD '                 TO LQW-LINE-STATUS (LQW-IDX)40440023
404500         SET LQW-LINE-PROTECT(LQW-IDX) TO  TRUE                   40450023
404600     WHEN DISTHD-PRCG-STAT-CDE = 'P' OR 'V'                       40460023
404700         MOVE 'PVFD'                  TO LQW-LINE-STATUS (LQW-IDX)40470023
404800         SET LQW-LINE-PROTECT(LQW-IDX) TO  TRUE                   40480023
404900     WHEN DISTHD-PRCG-STAT-CDE = 'D'                              40490023
405000         IF  DISTHD-P2L-CART-CNT = ZEROES                         40500023
405100             MOVE 'FCRD'              TO LQW-LINE-STATUS (LQW-IDX)40510023
405200         ELSE                                                     40520023
405300             MOVE 'INPR '             TO LQW-LINE-STATUS (LQW-IDX)40530023
405400         END-IF                                                   40540023
405500     WHEN DISTHD-PRCG-STAT-CDE = 'B'                              40550023
405600         IF DISTHD-FCSE-CNFRMN-TMST = PC-DEFAULT-TMST             40560023
405700             MOVE 'FCRD '             TO LQW-LINE-STATUS (LQW-IDX)40570023
405800         ELSE                                                     40580023
405900             IF DISTHD-RSLTS-RCVD-TMST = PC-DEFAULT-TMST          40590023
406000                 MOVE 'NP2L '         TO LQW-LINE-STATUS (LQW-IDX)40600023
406100             END-IF                                               40610023
406200         END-IF                                                   40620023
406300* BAD RATIO (PREPK M & I)                                         40630023
406400     WHEN DISTHD-PRCG-STAT-CDE = 'A'                              40640023
406500          MOVE 'BRAT '                TO LQW-LINE-STATUS (LQW-IDX)40650023
406600* NOT ARRIVED                                                     40660023
406700     WHEN DISTHD-PRCG-STAT-CDE = 'G'                              40670023
406800          IF  PS-NOT-ARRIVED                                      40680023
406900              MOVE 'NARV'             TO LQW-LINE-STATUS (LQW-IDX)40690023
407000          ELSE                                                    40700023
407100              MOVE SPACES             TO LQW-LINE-STATUS (LQW-IDX)40710023
407200          END-IF                                                  40720023
407300     WHEN DISTHD-PRCG-STAT-CDE  =  'H'                            40730023
407400         MOVE  'AUDT'                 TO LQW-LINE-STATUS (LQW-IDX)40740023
407500                                                                  40750023
407600     WHEN DISTHD-PRCG-STAT-CDE  =  'J'                            40760023
407700         MOVE  'NACT '                TO LQW-LINE-STATUS (LQW-IDX)40770023
407800                                                                  40780023
407900     WHEN DISTHD-PRCG-STAT-CDE  =  'K'                            40790023
408000         MOVE  'CF AU'             TO LQW-LINE-STATUS             40800023
408100                                      (LQW-IDX)                   40810023
408200     WHEN DISTHD-PRCG-STAT-CDE  =  'L'                            40820023
408300         MOVE  'CF TR'             TO LQW-LINE-STATUS             40830023
408400                                      (LQW-IDX)                   40840023
408500     WHEN OTHER                                                   40850023
408600         IF PV-TRBL-LINE-COUNT > ZERO  OR                         40860023
408700             RC038-LINE-TROUBLE        OR                         40870023
408800             RC038-RECV-TROUBLE                                   40880023
408900             PERFORM 4308A1-YES-TROUBLE                           40890023
409000         ELSE                                                     40900023
409100             PERFORM 4308A2-NO-TROUBLE                            40910023
409200         END-IF                                                   40920023
409300     END-EVALUATE.                                                40930023
409400                                                                  40940023
409500     IF LQW-LINE-STATUS (LQW-IDX) = SPACES                        40950023
409600     OR DISTHD-PRCG-STAT-CDE = 'R'                                40960023
409700***      MOVE 'READY  '               TO LQW-LINE-STATUS (LQW-IDX)40970023
409800         MOVE 'RDY  '                 TO LQW-LINE-STATUS (LQW-IDX)40980023
409900         PERFORM 7600-COUNT-RCVR-TROUBLES                         40990023
410000         IF PV-TRBL-RCVR-COUNT > ZERO                             41000023
410100             SET LQW-LINE-CAUTION (LQW-IDX)                       41010023
410200                                      TO TRUE                     41020023
410300         END-IF                                                   41030023
410400     END-IF.                                                      41040023
410500                                                                  41050023
410600 4308A1-YES-TROUBLE.                                              41060023
410700                                                                  41070023
410800     MOVE 'TRBL '              TO LQW-LINE-STATUS (LQW-IDX).      41080023
410900                                                                  41090023
411000     EVALUATE DISTHD-PRCG-STAT-CDE                                41100023
411100         WHEN 'E'                                                 41110023
411200         WHEN 'I'                                                 41120023
411300             PERFORM 4306B-DISTDT-VS-TRECDIS                      41130023
411400             IF PS-MATCH-ERROR                                    41140023
411500             OR PS-STORE-INVENTORY-POSSIBLE                       41150023
411600                     MOVE 'MLTIS'     TO LQW-LINE-STATUS (LQW-IDX)41160023
411700             END-IF                                               41170023
411800                                                                  41180023
411900         WHEN 'F'                                                 41190023
412000             IF PV-FREIGHT-COUNT = ZERO                           41200023
412100***              MOVE 'MLT ISU'       TO LQW-LINE-STATUS (LQW-IDX)41210023
412200                 MOVE 'MLTIS'         TO LQW-LINE-STATUS (LQW-IDX)41220023
412300             END-IF                                               41230023
412400     END-EVALUATE.                                                41240023
412500                                                                  41250023
412600 4308A2-NO-TROUBLE.                                               41260023
412700                                                                  41270023
412800     PERFORM 4306B-DISTDT-VS-TRECDIS.                             41280023
412900     EVALUATE DISTHD-PRCG-STAT-CDE                                41290023
413000         WHEN 'E'                                                 41300023
413100         WHEN 'I'                                                 41310023
413200             EVALUATE TRUE                                        41320023
413300                 WHEN PS-MATCH-ERROR                              41330023
413400                  AND PS-STORE-INVENTORY-POSSIBLE                 41340023
413500                         MOVE 'MLTIS'                             41350023
413600                                      TO LQW-LINE-STATUS (LQW-IDX)41360023
413700                                                                  41370023
413800                 WHEN PS-STORE-INVENTORY-POSSIBLE                 41380023
413900                     MOVE 'PHYIN'     TO LQW-LINE-STATUS (LQW-IDX)41390023
414000                                                                  41400023
414100                 WHEN PS-MATCH-ERROR                              41410023
414200                     MOVE 'MSTRS'     TO LQW-LINE-STATUS (LQW-IDX)41420023
414300             END-EVALUATE                                         41430023
414400         WHEN 'F'                                                 41440023
414500             PERFORM 7550-FREIGHT-BILL                            41450023
414600                 MOVE 'NOPR#'         TO LQW-LINE-STATUS (LQW-IDX)41460023
414700         WHEN 'G'                                                 41470023
414800             PERFORM 7560-CHECK-IF-ARRIVED                        41480023
414900             IF  PS-NOT-ARRIVED                                   41490023
415000                 MOVE 'NARV'          TO LQW-LINE-STATUS (LQW-IDX)41500023
415100             ELSE                                                 41510023
415200                 MOVE SPACES          TO LQW-LINE-STATUS (LQW-IDX)41520023
415300             END-IF                                               41530023
415400     END-EVALUATE.                                                41540023
415500/                                                                 41550023
415600 4308B-DISTDT-VS-TRECDIS.                                         41560023
415700     PERFORM 7410-OPEN-TDISTDT-CSR                                41570023
415800     PERFORM 7411-FETCH-TDISTDT-CSR                               41580023
415900     PERFORM UNTIL PS-EOF-TDISTDT-CSR OR PS-MATCH-ERROR           41590023
416000         PERFORM 7415-SELECT-TRECDIS                              41600023
416100         IF  SQLCODE = +100                                       41610023
416200             SET PS-MATCH-ERROR       TO TRUE                     41620023
416300         ELSE                                                     41630023
416400             PERFORM 7411-FETCH-TDISTDT-CSR                       41640023
416500         END-IF                                                   41650023
416600     END-PERFORM                                                  41660023
416700                                                                  41670023
416800     PERFORM 7412-CLOSE-TDISTDT-CSR.                              41680023
416900                                                                  41690023
417000 4310-FETCH.                                                      41700023
417100                                                                  41710023
417200     EXEC SQL                                                     41720023
417300         FETCH SUSPEND-CSR                                        41730023
417400          INTO                                                    41740023
417500                  :DISTHD-ORD-LNE-NBR                             41750023
417600                , :DISTHD-P2L-CART-CNT                            41760023
417700                , :DISTHD-FCSE-FCLTY-AREA-ID                      41770023
417800                , :DISTHD-FCSE-CART-CNT                           41780023
417900                , :DISTHD-INPK-CART-CNT                           41790023
418000                , :DISTHD-OTPK-UNT-QTY                            41800023
418100                , :DISTHD-INPK-UNT-QTY                            41810023
418200                , :DISTHD-INPK-CNVYB-IND                          41820023
418300                , :DISTHD-RSLTS-RCVD-TMST                         41830023
418400                , :PV-DATE                                        41840023
418500                , :PV-TIME                                        41850023
418600                , :DISTHD-PRCG-STAT-CDE                           41860023
418700                , :DISTHD-SPC-INSTR-DESC                          41870023
418800                , :DISTHD-SYS-CRE-CDE                             41880023
418900                , :DISTHD-TOT-CART-CNT                            41890023
419000                , :DISTHD-PRC-AREA-MODU-ID                        41900023
419100                , :DISTHD-FCSE-CNFRMN-TMST                        41910023
419200                , :PV-CURRENT-TMST                                41920023
419300                , :DISTHD-PREPK-LNE-PRC-CDE                       41930023
419400     END-EXEC.                                                    41940023
419500                                                                  41950023
419600     EVALUATE TRUE                                                41960023
419700         WHEN SQLCODE = ZERO                                      41970023
419800              CONTINUE                                            41980023
419900         WHEN SQLCODE = +100                                      41990023
420000              SET ASC-NO-ITEMS-LEFT-ON-DB                         42000023
420100                                   TO TRUE                        42010023
420200         WHEN SQLCODE = -904                                      42020023
420300         WHEN SQLCODE = -911                                      42030023
420400         WHEN SQLCODE = -913                                      42040023
420500             MOVE '4310-FETCH'       TO DP013-PARAGRAPH           42050023
420600             MOVE SQLCODE            TO PC-DISPLAY-SQL-CODE       42060023
420700             PERFORM 9900-SOFT-ABORT                              42070023
420800                                                                  42080023
420900         WHEN SQLWARN0 NOT = SPACE                                42090023
421000         WHEN SQLCODE < ZERO                                      42100023
421100         WHEN SQLCODE > ZERO                                      42110023
421200              MOVE '4310-FETCH'       TO DP013-PARAGRAPH          42120023
421300              MOVE 'FETCH SUSPEND CURSOR'                         42130023
421400                                      TO DP013-MESSAGE-TEXT (1)   42140023
421500              MOVE SQLCA              TO DP013-SQLCA              42150023
421600              MOVE 'TDISTHD'          TO DP013-DB2-TABLE-NAME (1) 42160023
421700              SET DP013-DB2-ABEND     TO TRUE                     42170023
421800              PERFORM DP013-0000-PROCESS-ABEND                    42180023
421900     END-EVALUATE.                                                42190023
422000/                                                                 42200023
422100 4320-SELECT-ODD-UNIT.                                            42210023
422200     EXEC SQL                                                     42220023
422300         SELECT SUM (B.PREPK_ODD_UNT_QTY)                         42230023
422400           INTO :PV-PREPK-ODD-UNT-QTY                             42240023
422500           FROM TRECITM   A                                       42250023
422600               ,TDISTDT   B                                       42260023
422700          WHERE A.ORD_NBR      =  :DK-ORD-NBR                     42270023
422800            AND A.REC_SEQ_NBR  =  :DK-RCVR-NBR                    42280023
422900            AND A.PREPK_ID     =  :PV-PREPK-ID-COMP               42290023
423000            AND A.VER_STATUS_CDE = 'A'                            42300023
423100            AND B.ORD_NBR      =  A.ORD_NBR                       42310023
423200            AND B.RCVR_SEQ_NBR =  A.REC_SEQ_NBR                   42320023
423300            AND B.ORD_LNE_NBR  =  A.ORD_LNE_NBR                   42330023
423400     END-EXEC                                                     42340023
423500                                                                  42350023
423600     EVALUATE TRUE                                                42360023
423700         WHEN SQLCODE = +0                                        42370023
423800              CONTINUE                                            42380023
423900         WHEN SQLCODE = -305                                      42390023
424000              MOVE 0 TO PV-PREPK-ODD-UNT-QTY                      42400023
424100         WHEN OTHER                                               42410023
424200              MOVE '4320-SELECT-ODD-UNIT'                         42420023
424300                               TO DP013-PARAGRAPH                 42430023
424400              MOVE 'SUM ODD UNIT QUANITY     '                    42440023
424500                               TO DP013-MESSAGE-TEXT (1)          42450023
424600              MOVE SQLCA       TO DP013-SQLCA                     42460023
424700              MOVE 'TRECITM '  TO DP013-DB2-TABLE-NAME (1)        42470023
424800              MOVE 'TDISTDT '  TO DP013-DB2-TABLE-NAME (2)        42480023
424900              SET DP013-DB2-ABEND                                 42490023
425000                  DP013-XCTL-DISPLAY-RESTART                      42500023
425100                                   TO TRUE                        42510023
425200                  PERFORM DP013-0000-PROCESS-ABEND                42520023
425300     END-EVALUATE.                                                42530023
425400                                                                  42540023
425500                                                                  42550023
425600 4350-CALL-RCKUT128.                                              42560023
425700     MOVE ASC-OPER-UNT-ID     TO RC074-OPER-UNT-ID.               42570023
425800     MOVE ASC-FCLTY-ID        TO RC074-FCLTY-ID.                  42580023
425900     MOVE ASC-ORD-NBR         TO RC074-PO-NBR.                    42590023
426000     MOVE ASC-RCVR-NBR        TO RC074-RCVR-SEQ-NBR.              42600023
426100     MOVE ASC-AUTO-VE-SW      TO RC074-AUTO-VE-SW.                42610023
426200                                                                  42620023
426300     CALL RC074-UNIT-CRTN-CNT-PGM USING  DFHEIBLK                 42630023
426400                                         RC074-COMMAREA           42640023
426500                                         RC074-FIELDS.            42650023
426600                                                                  42660023
426700     EVALUATE TRUE                                                42670023
426800         WHEN RC074-SUCCESSFUL                                    42680023
426900             CONTINUE                                             42690023
427000         WHEN OTHER                                               42700023
427100             MOVE '4350-CALL-RCKUT128'                            42710023
427200                                 TO DP013-PARAGRAPH               42720023
427300             STRING                                               42730023
427400                  'UNSUCCESSFUL CALL TO RCKUT128 '                42740023
427500                  'SUCCESS-IND = '                                42750023
427600                  RC074-SUCCESS-IND                               42760023
427700                               DELIMITED BY SIZE                  42770023
427800                               INTO DP013-MESSAGE-TEXT (1)        42780023
427900             MOVE RC074-CRA-RET-MSG                               42790023
428000                                 TO DP013-MESSAGE-TEXT (2)        42800023
428100             MOVE RC074-SQLCA    TO DP013-SQLCA                   42810023
428200             SET DP013-DB2-ABEND                                  42820023
428300                 DP013-XCTL-DISPLAY-RESTART                       42830023
428400                                 TO TRUE                          42840023
428500             PERFORM DP013-0000-PROCESS-ABEND                     42850023
428600     END-EVALUATE.                                                42860023
428700                                                                  42870023
428800 4400-MOVE-COMMAREA-TO-SCREEN.                                    42880023
428900                                                                  42890023
429000     IF  (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1))             42900023
429100         AND (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1)))          42910023
429200         OR  (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)))          42920023
429300             MOVE +1               TO ASC-BLK-SUB                 42930023
429400                                                                  42940023
429500             PERFORM 5100-WRITE-TEMP-STORAGE                      42950023
429600                                                                  42960023
429700             ADD +1                TO ASC-BLK-SUB                 42970023
429800             PERFORM 5100-WRITE-TEMP-STORAGE                      42980023
429900                                                                  42990023
430000             DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             43000023
430100                 GIVING PV-BLOCK-NUMBER                           43010023
430200                 REMAINDER PV-REMAINDER                           43020023
430300             IF  PV-REMAINDER > ZERO                              43030023
430400                 ADD +1            TO PV-BLOCK-NUMBER             43040023
430500             END-IF                                               43050023
430600                                                                  43060023
430700             MOVE +1               TO ASC-BLK-SUB                 43070023
430800             PERFORM 4410-READ-TEMP-STORAGE                       43080023
430900                                                                  43090023
431000             ADD +1                TO ASC-BLK-SUB                 43100023
431100                                      PV-BLOCK-NUMBER             43110023
431200             PERFORM 4410-READ-TEMP-STORAGE                       43120023
431300     END-IF.                                                      43130023
431400                                                                  43140023
431500     MOVE +1                       TO ASC-BLK-SUB.                43150023
431600                                                                  43160023
431700     COMPUTE ASC-ITEM-SUB =                                       43170023
431800         ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              43180023
431900         + PC-ITEMS-PER-PANEL).                                   43190023
432000                                                                  43200023
432100     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        43210023
432200         ADD +1                    TO ASC-BLK-SUB                 43220023
432300         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            43230023
432400     END-IF.                                                      43240023
432500                                                                  43250023
432600     COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           43260023
432700         ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                43270023
432800                                                                  43280023
432900     PERFORM 4430-CHECK-FOR-BEGIN-AND-END.                        43290023
433000                                                                  43300023
433100     PERFORM 4420-FORMAT-LIST-LINES                               43310023
433200         VARYING PV-SUB                                           43320023
433300         FROM PC-ITEMS-PER-PANEL BY -1                            43330023
433400         UNTIL PV-SUB < +1.                                       43340023
433500                                                                  43350023
433600     COMPUTE ASC-ITEMS-DISPLAYED =                                43360023
433700         ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).          43370023
433800                                                                  43380023
433900     MOVE PV-TOP-ITEM              TO ASC-ITEM-AT-TOP-OF-PANEL    43390023
434000                                      ASTRTITO.                   43400023
434100                                                                  43410023
434200     MOVE ASC-OPER-UNT-ID          TO MR-OPER.                    43420023
434300     MOVE ASC-FCLTY-ID             TO MR-FCLTY.                   43430023
434400     MOVE ASC-DEPT                 TO MR-DEPT.                    43440023
434500     MOVE ASC-ZONE                 TO MR-ZONE.                    43450023
434600     MOVE ASC-ORD-NBR              TO PV-FORMAT-PO.               43460023
434700     MOVE ASC-RCVR-NBR             TO PV-FORMAT-RCVR.             43470023
434800     MOVE PV-FORMAT-PO-RCVR        TO MR-PORCVR.                  43480023
434900     IF ASC-PKGNG-CDE-DISPLAY = 'B'                               43490023
435000         MOVE 'BULK  '             TO MR-PACK-DESC                43500023
435100     ELSE                                                         43510023
435200     IF ASC-PKGNG-CDE-DISPLAY = 'C'                               43520023
435300         MOVE 'CASEPK'             TO MR-PACK-DESC                43530023
435400     ELSE                                                         43540023
435500     IF ASC-PKGNG-CDE-DISPLAY = 'I'                               43550023
435600         MOVE 'INPRPK'             TO MR-PACK-DESC                43560023
435700         MOVE DP015-YELLOW         TO MR-PACK-DESCC               43570023
435800     ELSE                                                         43580023
435900     IF ASC-PKGNG-CDE-DISPLAY = 'M'                               43590023
436000         MOVE 'MLTSKU'             TO MR-PACK-DESC                43600023
436100         MOVE DP015-YELLOW         TO MR-PACK-DESCC               43610023
436200     ELSE                                                         43620023
436300     IF ASC-PKGNG-CDE-DISPLAY = 'S'                               43630023
436400         MOVE 'SGLSKU'             TO MR-PACK-DESC                43640023
436500     ELSE                                                         43650023
436600         MOVE 'UNKNWN'             TO MR-PACK-DESC                43660023
436700     END-IF.                                                      43670023
436800     MOVE ASC-RCVR-STATUS          TO MR-RCVR-STATUS.             43680023
436900     MOVE ASC-VENDOR-NAME          TO MR-VENDOR-NAME.             43690023
437000     IF ASC-PKGNG-CDE = 'I' OR 'M'                                43700023
437100         MOVE ' PACK   '           TO MR-PACK1                    43710023
437200         MOVE '  ID    '           TO MR-SKUID                    43720023
437300         MOVE 'PAK   '             TO MR-QTYPK1                   43730023
437400         MOVE 'PAK   '             TO MR-QTYPK2                   43740023
437500     ELSE                                                         43750023
437600         MOVE SPACES               TO MR-PACK1                    43760023
437700         MOVE '  SKU   '           TO MR-SKUID                    43770023
437800         MOVE 'QTY   '             TO MR-QTYPK1                   43780023
437900         MOVE 'QTY   '             TO MR-QTYPK2                   43790023
438000     END-IF.                                                      43800023
438100                                                                  43810023
438200     MOVE ASC-ITEM-AT-BOT-OF-PANEL TO AENDITO.                    43820023
438300     MOVE ASC-NUMBER-OF-ITEMS-READ TO ATOTITO.                    43830023
438400     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            43840023
438500                                   TO ASELITO.                    43850023
438600                                                                  43860023
438700     IF  DP020-MSG-NUMBER-X = SPACE                               43870023
438800         IF  ASC-ITEM-AT-BOT-OF-PANEL < ASC-NUMBER-OF-ITEMS-READ  43880023
438900*            --- MORE ITEMS TO DISPLAY ----                       43890023
439000             MOVE PC-TSYMSG-00279  TO DP020-MSG-NUMBER            43900023
439100             SET DP020-MSG-INFORMATIONAL                          43910023
439200                                   TO TRUE                        43920023
439300         END-IF                                                   43930023
439400     END-IF.                                                      43940023
439500                                                                  43950023
439600*----------------------------------------------------------------*43960023
439700*    READ A BLOCK FROM TEMPORARY STORAGE INTO THE ARRAY.         *43970023
439800*----------------------------------------------------------------*43980023
439900                                                                  43990023
440000 4410-READ-TEMP-STORAGE.                                          44000023
440100                                                                  44010023
440200     EXEC CICS                                                    44020023
440300         READQ TS                                                 44030023
440400             QUEUE (ASC-LIST-QUEUE-NAME)                          44040023
440500             INTO  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               44050023
440600             ITEM  (PV-BLOCK-NUMBER)                              44060023
440700             RESP  (PV-CICS-RESP)                                 44070023
440800     END-EXEC.                                                    44080023
440900                                                                  44090023
441000     IF  ((PV-CICS-RESP = DFHRESP (NORMAL))                       44100023
441100       OR (PV-CICS-RESP = DFHRESP (ITEMERR)))                     44110023
441200         CONTINUE                                                 44120023
441300     ELSE                                                         44130023
441400         SET DP013-CICS-ABEND      TO TRUE                        44140023
441500         SET DP013-NO-ROLLBACK     TO TRUE                        44150023
441600         MOVE '4410-READ-TEMP-STORAGE'                            44160023
441700                                   TO DP013-PARAGRAPH             44170023
441800         MOVE 'ERROR TRYING TO READ FROM TEMP STORAGE QUEUE'      44180023
441900                                   TO DP013-MESSAGE-TEXT(1)       44190023
442000         PERFORM DP013-0000-PROCESS-ABEND                         44200023
442100     END-IF.                                                      44210023
442200                                                                  44220023
442300     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)                      44230023
442400                                   TO TRUE.                       44240023
442500                                                                  44250023
442600     IF  PV-CICS-RESP = DFHRESP (ITEMERR)                         44260023
442700         INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               44270023
442800     END-IF.                                                      44280023
442900                                                                  44290023
443000/                                                                 44300023
443100*----------------------------------------------------------------*44310023
443200*    PROCESS THE ITEMS IN THE ARRAY AND MOVE THEM TO THE MAP.    *44320023
443300*----------------------------------------------------------------*44330023
443400 4420-FORMAT-LIST-LINES.                                          44340023
443500                                                                  44350023
443600     IF ASC-ITEM-AT-BOT-OF-PANEL > ASC-NUMBER-OF-ITEMS-READ       44360023
443700         SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                44370023
443800         MOVE DP015-ASK-DRK-OFF    TO MR-SELECTA (PV-SUB)         44380023
443900                                      MR-ACTIONA (PV-SUB)         44390023
444000                                      MR-FCSE-AREA-A (PV-SUB)     44400023
444100         MOVE DP015-HL-OFF         TO MR-SELECTH (PV-SUB)         44410023
444200                                      MR-FCSE-AREA-H (PV-SUB)     44420023
444300         MOVE SPACE                TO MR-SELECT  (PV-SUB)         44430023
444400                                      MR-ACTION  (PV-SUB)         44440023
444500                                      MR-SKU-NBR (PV-SUB)         44450023
444600                                      MR-FCSE-AREA (PV-SUB)       44460023
444700                                      MR-CARTON-COUNT-X (PV-SUB)  44470023
444800                                      MR-OUT-PACK-QTY-X (PV-SUB)  44480023
444900                                      MR-PROCESS-QTY-X  (PV-SUB)  44490023
445000                                      MR-ODD-UNIT-QTY-X (PV-SUB)  44500023
445100                                      MR-CONF-DATE  (PV-SUB)      44510023
445200                                      MR-CONF-TIME  (PV-SUB)      44520023
445300                                      MR-P2L-COUNT-X  (PV-SUB)    44530023
445400                                      MR-P2L-STATUS  (PV-SUB)     44540023
445500                                      MR-LINE-STATUS  (PV-SUB)    44550023
445600         MOVE ZEROES               TO MR-PO-LINE (PV-SUB)         44560023
445700     ELSE                                                         44570023
445800         IF ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)       44580023
445900                                                   > SPACE        44590023
446000             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 44600023
446100               TO MR-SELECT (PV-SUB)                              44610023
446200         ELSE                                                     44620023
446300             MOVE ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      44630023
446400               TO MR-SELECT (PV-SUB)                              44640023
446500         END-IF                                                   44650023
446600                                                                  44660023
446700         IF DP030-SET-CURSOR-TRAILER                              44670023
446800             IF ((ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 44680023
446900                  > SPACE)                                        44690023
447000               OR (PV-SUB = 1))                                   44700023
447100                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              44710023
447200                 MOVE -1 TO MR-SELECTL (PV-SUB)                   44720023
447300             END-IF                                               44730023
447400         END-IF                                                   44740023
447500                                                                  44750023
447600         IF DP020-FK-LOCAL-FUNC-07(DP020-SRC-AID)                 44760023
447700             MOVE ASC-LINE-NBR (ASC-BLK-SUB ASC-ITEM-SUB)         44770023
447800               TO DK-LINE-NBR                                     44780023
447900             PERFORM 7300-SUM-TDISTDT                             44790023
448000***          MOVE DISTDT-FCSE-ACTL-UNT-QTY                        44800023
448100***            TO ASC-PROCESS-QTY(ASC-BLK-SUB ASC-ITEM-SUB)       44810023
448200         END-IF                                                   44820023
448300                                                                  44830023
448400         MOVE ASC-ACTION (ASC-BLK-SUB ASC-ITEM-SUB)               44840023
448500           TO MR-ACTION (PV-SUB)                                  44850023
448600         MOVE ASC-LINE-NBR (ASC-BLK-SUB ASC-ITEM-SUB)             44860023
448700           TO MR-PO-LINE (PV-SUB)                                 44870023
448800         IF ASC-PKGNG-CDE = 'I' OR 'M'                            44880023
448900             MOVE ASC-PREPK (ASC-BLK-SUB ASC-ITEM-SUB)            44890023
449000               TO MR-SKU-NBR (PV-SUB)                             44900023
449100             MOVE DP015-YELLOW TO MR-SKUC (PV-SUB)                44910023
449200         ELSE                                                     44920023
449300             MOVE ASC-SKU-NBR (ASC-BLK-SUB ASC-ITEM-SUB)          44930023
449400               TO MR-SKU-NBR (PV-SUB)                             44940023
449500         END-IF                                                   44950023
449600         MOVE ASC-FCSE-AREA (ASC-BLK-SUB ASC-ITEM-SUB)            44960023
449700           TO MR-FCSE-AREA (PV-SUB)                               44970023
449800         MOVE ASC-CARTON-COUNT (ASC-BLK-SUB ASC-ITEM-SUB)         44980023
449900           TO MR-CARTON-COUNT (PV-SUB)                            44990023
450000         MOVE ASC-OUT-PACK-QTY (ASC-BLK-SUB ASC-ITEM-SUB)         45000023
450100           TO MR-OUT-PACK-QTY (PV-SUB)                            45010023
450200         MOVE ASC-PROCESS-QTY (ASC-BLK-SUB ASC-ITEM-SUB)          45020023
450300           TO MR-PROCESS-QTY (PV-SUB)                             45030023
450400         IF ASC-PKGNG-CDE = 'I' OR 'M'                            45040023
450500             MOVE DP015-YELLOW TO MR-PROCESS-QTYC (PV-SUB)        45050023
450600         END-IF                                                   45060023
450700         MOVE ASC-ODD-UNIT-QTY (ASC-BLK-SUB ASC-ITEM-SUB)         45070023
450800           TO MR-ODD-UNIT-QTY (PV-SUB)                            45080023
450900         MOVE ASC-CONF-DATE (ASC-BLK-SUB ASC-ITEM-SUB)            45090023
451000           TO MR-CONF-DATE  (PV-SUB)                              45100023
451100                                                                  45110023
451200         IF MR-CONF-DATE (PV-SUB) = SPACES OR LOW-VALUES          45120023
451300             CONTINUE                                             45130023
451301         ELSE                                                     45130123
451302             MOVE DP015-BLUE          TO MR-FCSE-AREA-C (PV-SUB)  45130200
451303             MOVE DP015-ASK-NOR-OFF   TO MR-FCSE-AREA-A (PV-SUB)  45130300
451304             MOVE DP015-HL-OFF        TO MR-FCSE-AREA-H (PV-SUB)  45130400
451305         END-IF                                                   45130523
451306                                                                  45130623
451307         MOVE ASC-CONF-TIME (ASC-BLK-SUB ASC-ITEM-SUB)            45130723
451308           TO MR-CONF-TIME  (PV-SUB)                              45130823
451309         MOVE ASC-P2L-QTY (ASC-BLK-SUB ASC-ITEM-SUB)              45130923
451310           TO MR-P2L-COUNT (PV-SUB)                               45131023
451320         IF ASC-PKGNG-CDE = 'I' OR 'M'                            45132023
451330             MOVE DP015-YELLOW TO MR-P2L-COUNTC (PV-SUB)          45133023
451340         END-IF                                                   45134023
451350         MOVE ASC-P2L-STATUS (ASC-BLK-SUB ASC-ITEM-SUB)           45135023
451360                                   TO MR-P2L-STATUS  (PV-SUB)     45136023
451370         MOVE ASC-LINE-STATUS (ASC-BLK-SUB ASC-ITEM-SUB)          45137023
451380                                   TO MR-LINE-STATUS  (PV-SUB)    45138023
451390         IF ASC-LINE-STATUS-YELLOW (ASC-BLK-SUB ASC-ITEM-SUB)     45139023
451400           OR ASC-LINE-CAUTION (ASC-BLK-SUB ASC-ITEM-SUB)         45140023
451500             MOVE DP015-YELLOW  TO MR-LINE-STATUSC (PV-SUB)       45150023
451600         ELSE                                                     45160023
451700             MOVE DP015-BLUE    TO MR-LINE-STATUSC (PV-SUB)       45170023
451800         END-IF                                                   45180023
451900         IF ASC-FCSE-AREA-NO-UPDATE(ASC-BLK-SUB ASC-ITEM-SUB)     45190023
452000             MOVE DP015-BLUE        TO MR-FCSE-AREA-C(PV-SUB)     45200023
452100             MOVE DP015-ASK-NOR-OFF TO MR-FCSE-AREA-A(PV-SUB)     45210023
452200             MOVE DP015-HL-OFF      TO MR-FCSE-AREA-H(PV-SUB)     45220023
452300         END-IF                                                   45230023
452400         IF ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)                 45240023
452500             IF ASC-BAD-FCSE-PROCESS-AREA                         45250023
452600                                   (ASC-BLK-SUB ASC-ITEM-SUB)     45260023
452700                 MOVE -1            TO MR-FCSE-AREA-L(PV-SUB)     45270023
452800                 MOVE DP015-RED     TO MR-FCSE-AREA-C(PV-SUB)     45280023
452900                 MOVE DP015-REVERSE TO MR-FCSE-AREA-H(PV-SUB)     45290023
453000             END-IF                                               45300023
453100             IF ASC-NEED-FCSE-PROCESS-AREA                        45310023
453200                                   (ASC-BLK-SUB ASC-ITEM-SUB)     45320023
453300                 MOVE -1            TO MR-FCSE-AREA-L(PV-SUB)     45330023
453400                 MOVE DP015-RED     TO MR-FCSE-AREA-C(PV-SUB)     45340023
453500                 MOVE DP015-REVERSE TO MR-FCSE-AREA-H(PV-SUB)     45350023
453600             END-IF                                               45360023
453700         ELSE                                                     45370023
453800             IF ASC-BAD-FCSE-PROCESS-AREA                         45380023
453900                                   (ASC-BLK-SUB ASC-ITEM-SUB)     45390023
454000                 MOVE -1            TO MR-FCSE-AREA-L(PV-SUB)     45400023
454100                 MOVE DP015-RED     TO MR-FCSE-AREA-C(PV-SUB)     45410023
454200             END-IF                                               45420023
454300             IF  ASC-NEED-FCSE-PROCESS-AREA                       45430023
454400                                   (ASC-BLK-SUB ASC-ITEM-SUB)     45440023
454500                 MOVE -1            TO MR-FCSE-AREA-L(PV-SUB)     45450023
454600                 MOVE DP015-RED     TO MR-FCSE-AREA-C(PV-SUB)     45460023
454700             END-IF                                               45470023
454800         END-IF                                                   45480023
454900     END-IF.                                                      45490023
455000                                                                  45500023
455100     SUBTRACT +1 FROM ASC-ITEM-SUB.                               45510023
455200                                                                  45520023
455300     IF  ASC-ITEM-SUB < + 1                                       45530023
455400         MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB                45540023
455500         MOVE +1                   TO ASC-BLK-SUB                 45550023
455600     END-IF.                                                      45560023
455700                                                                  45570023
455800/                                                                 45580023
455900*----------------------------------------------------------------*45590023
456000*  IF A BEGINNING OF RANGE WAS SPECIFIED, MAKE SURE AN END OF    *45600023
456100*  RANGE WAS SPECIFIED AND VICE-VERSA.  IF ONE IS MISSING,       *45610023
456200*  ISSUE A WARNING.                                              *45620023
456300*----------------------------------------------------------------*45630023
456400 4430-CHECK-FOR-BEGIN-AND-END.                                    45640023
456500                                                                  45650023
456600     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       45660023
456700         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     45670023
456800*            -- NO END-OF-RANGE SPECFIED ---                      45680023
456900             MOVE PC-TSYMSG-00051  TO DP020-MSG-NUMBER            45690023
457000             SET DP020-MSG-WARNING TO TRUE                        45700023
457100             PERFORM 4431-POSITION-AT-WARNING                     45710023
457200         END-IF                                                   45720023
457300     ELSE                                                         45730023
457400         IF  ASC-END-OF-SELECTED-RANGE > ZERO                     45740023
457500*            -- NO BEGINNING-OF-RANGE SPECFIED ---                45750023
457600             MOVE PC-TSYMSG-00053  TO DP020-MSG-NUMBER            45760023
457700             SET DP020-MSG-WARNING TO TRUE                        45770023
457800             PERFORM 4431-POSITION-AT-WARNING                     45780023
457900         END-IF                                                   45790023
458000     END-IF.                                                      45800023
458100                                                                  45810023
458200/                                                                 45820023
458300*----------------------------------------------------------------*45830023
458400*  ONCE IT HAS BEEN DETERMINED THAT A WARNING IS TO BE ISSUED,   *45840023
458500*  DETERMINE IF EITHER THE BEGINNING OF RANGE OR END OF RANGE    *45850023
458600*  IS ON THE CURRENT SCREEN.  IF IT IS, HIGHLIGHT IT AND         *45860023
458700*  POSITION THE CURSOR THERE.                                    *45870023
458800*----------------------------------------------------------------*45880023
458900 4431-POSITION-AT-WARNING.                                        45890023
459000                                                                  45900023
459100     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 45910023
459200                    - PV-TOP-ITEM + 1.                            45920023
459300                                                                  45930023
459400     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      45940023
459500         CONTINUE                                                 45950023
459600     ELSE                                                         45960023
459700         SET DP030-SET-CURSOR-APPL-1                              45970023
459800                                   TO TRUE                        45980023
459900         MOVE -1                   TO MR-SELECTL (PV-SUB)         45990023
460000         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         46000023
460100         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         46010023
460200     END-IF.                                                      46020023
460300                                                                  46030023
460400     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   46040023
460500                    - PV-TOP-ITEM + 1.                            46050023
460600                                                                  46060023
460700     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      46070023
460800         CONTINUE                                                 46080023
460900     ELSE                                                         46090023
461000         SET DP030-SET-CURSOR-APPL-1                              46100023
461100                                   TO TRUE                        46110023
461200         MOVE -1                   TO MR-SELECTL (PV-SUB)         46120023
461300         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         46130023
461400         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         46140023
461500     END-IF.                                                      46150023
461600                                                                  46160023
461700                                                                  46170023
461800*----------------------------------------------------------------*46180023
461900*                                                                *46190023
462000*----------------------------------------------------------------*46200023
462100 4500-SET-DISTRO-ZERO.                                            46210023
462200                                                                  46220023
462300     MOVE ASC-KEY-PO-NBR            TO DK-ORD-NBR.                46230023
462400     MOVE ASC-KEY-RCVR-NBR          TO DK-RCVR-NBR.               46240023
462500***  MOVE LQW-PO-LINE(LQW-IDX)      TO DK-LINE-NBR.               46250023
462600                                                                  46260023
462700     PERFORM 4505-OPEN-CURSOR.                                    46270023
462800                                                                  46280023
462900     SET  ASC-ITEMS-LEFT-ON-DB-2  TO  TRUE.                       46290023
463000                                                                  46300023
463100     PERFORM 4530-READ-ITEMS-FROM-DB.                             46310023
463200                                                                  46320023
463300     PERFORM 4510-CLOSE-CURSOR.                                   46330023
463400                                                                  46340023
463500     IF RECITM-STATUS-CDE = 'VE'                                  46350023
463600         CONTINUE                                                 46360023
463700     ELSE                                                         46370023
463800         INITIALIZE PC238-COMM-AREA                               46380023
463900         MOVE ZEROES              TO PC238-WRKD-UNT-QTY           46390023
464000         MOVE DISTHD-ORD-LNE-NBR  TO ASC-KEY-LNE-NBR              46400023
464100         MOVE 'C'                 TO PC238-TRANS-TYPE-CDE         46410023
464200         PERFORM 7450-SELECT-TDISTHD                              46420023
464300         MOVE DISTHD-OPER-UNT-ID TO PC238-WRKD-OPER-UNT-ID        46430023
464400         PERFORM 7952-UPDATE-UNITS-WRKD                           46440023
464500     END-IF.                                                      46450023
464600                                                                  46460023
464700     IF NOT (ASC-PKGNG-CDE = 'I' OR 'M')                          46470023
464800         PERFORM 4560-SYNCPOINT                                   46480023
464900     END-IF.                                                      46490023
465000                                                                  46500023
465100 4501-UPDATE-CNFRM-UNITS.                                         46510023
465200                                                                  46520023
465300     MOVE ASC-KEY-PO-NBR            TO DK-ORD-NBR.                46530023
465400     MOVE ASC-KEY-RCVR-NBR          TO DK-RCVR-NBR.               46540023
465500***  MOVE LQW-PO-LINE(LQW-IDX)      TO DK-LINE-NBR.               46550023
465600                                                                  46560023
465700     PERFORM 4505-OPEN-CURSOR.                                    46570023
465800                                                                  46580023
465900     SET  ASC-ITEMS-LEFT-ON-DB-2  TO  TRUE.                       46590023
466000                                                                  46600023
466100     PERFORM 4532-READ-ITEMS-FROM-DB.                             46610023
466200                                                                  46620023
466300     PERFORM 4510-CLOSE-CURSOR.                                   46630023
466400                                                                  46640023
466500                                                                  46650023
466600*----------------------------------------------------------------*46660023
466700*                                                                *46670023
466800*----------------------------------------------------------------*46680023
466900 4505-OPEN-CURSOR.                                                46690023
467000                                                                  46700023
467100     EXEC SQL                                                     46710023
467200         OPEN STORE-CSR                                           46720023
467300     END-EXEC                                                     46730023
467400                                                                  46740023
467500     EVALUATE TRUE                                                46750023
467600         WHEN SQLCODE = ZERO                                      46760023
467700              CONTINUE                                            46770023
467800         WHEN SQLCODE = -904                                      46780023
467900         WHEN SQLCODE = -911                                      46790023
468000         WHEN SQLCODE = -913                                      46800023
468100             MOVE '4505-OPEN-CURSOR'                              46810023
468200                                   TO DP013-PARAGRAPH             46820023
468300             MOVE SQLCODE            TO PC-DISPLAY-SQL-CODE       46830023
468400             PERFORM 9900-SOFT-ABORT                              46840023
468500         WHEN SQLWARN0 NOT = SPACE                                46850023
468600         WHEN SQLCODE  NOT = ZERO                                 46860023
468700             MOVE '4505-OPEN-CURSOR'                              46870023
468800                                   TO DP013-PARAGRAPH             46880023
468900             MOVE 'OPEN STORE-CSR CURSOR'                         46890023
469000                                   TO DP013-MESSAGE-TEXT (1)      46900023
469100             MOVE SQLCA       TO DP013-SQLCA                      46910023
469200             MOVE 'TDISTDT'   TO DP013-DB2-TABLE-NAME (1)         46920023
469300             SET DP013-DB2-ABEND                                  46930023
469400                                   TO TRUE                        46940023
469500             PERFORM DP013-0000-PROCESS-ABEND                     46950023
469600     END-EVALUATE.                                                46960023
469700                                                                  46970023
469800                                                                  46980023
469900*----------------------------------------------------------------*46990023
470000*                                                                *47000023
470100*----------------------------------------------------------------*47010023
470200 4510-CLOSE-CURSOR.                                               47020023
470300                                                                  47030023
470400     EXEC SQL                                                     47040023
470500         CLOSE STORE-CSR                                          47050023
470600     END-EXEC.                                                    47060023
470700                                                                  47070023
470800     EVALUATE TRUE                                                47080023
470900         WHEN SQLCODE = ZERO                                      47090023
471000              CONTINUE                                            47100023
471100         WHEN SQLWARN0 NOT = SPACE                                47110023
471200         WHEN SQLCODE  NOT = ZERO                                 47120023
471300              MOVE '4510-CLOSE-CURSOR'                            47130023
471400                                   TO DP013-PARAGRAPH             47140023
471500              MOVE 'CLOSE STORE-CSR CURSOR'                       47150023
471600                                   TO DP013-MESSAGE-TEXT (1)      47160023
471700              MOVE SQLCA           TO DP013-SQLCA                 47170023
471800              MOVE 'TDISTDT'       TO DP013-DB2-TABLE-NAME (1)    47180023
471900              SET DP013-DB2-ABEND  TO TRUE                        47190023
472000              PERFORM DP013-0000-PROCESS-ABEND                    47200023
472100     END-EVALUATE.                                                47210023
472200                                                                  47220023
472300                                                                  47230023
472400*----------------------------------------------------------------*47240023
472500*                                                                *47250023
472600*----------------------------------------------------------------*47260023
472700 4530-READ-ITEMS-FROM-DB.                                         47270023
472800                                                                  47280023
472900     PERFORM                                                      47290023
473000         UNTIL (ASC-NO-ITEMS-LEFT-ON-DB-2)                        47300023
473100                                                                  47310023
473200         PERFORM 4540-FETCH                                       47320023
473300                                                                  47330023
473400         IF  ASC-ITEMS-LEFT-ON-DB-2                               47340023
473500             PERFORM 4550-UPDATE-DISTDT                           47350023
473600         END-IF                                                   47360023
473700                                                                  47370023
473800     END-PERFORM.                                                 47380023
473900                                                                  47390023
474000 4532-READ-ITEMS-FROM-DB.                                         47400023
474100                                                                  47410023
474200     PERFORM                                                      47420023
474300         UNTIL (ASC-NO-ITEMS-LEFT-ON-DB-2)                        47430023
474400                                                                  47440023
474500         PERFORM 4540-FETCH                                       47450023
474600                                                                  47460023
474700         IF  ASC-ITEMS-LEFT-ON-DB-2                               47470023
474800             INITIALIZE RC074-FIELDS                              47480023
474900             SET RC074-CARTON-COUNT-YES TO TRUE                   47490023
475000             MOVE LQW-PO-LINE(LQW-IDX) TO RC074-LINE-NBR          47500023
475100             MOVE DK-STR-NBR           TO RC074-STR-NBR           47510023
475200             PERFORM 4350-CALL-RCKUT128                           47520023
475300             MOVE RC074-FCSE-ACTL-ITM-QTY                         47530023
475400                                 TO DISTDT-FCSE-ACTL-UNT-QTY      47540023
475500             PERFORM 4552-UPDATE-DISTDT                           47550023
475600         END-IF                                                   47560023
475700                                                                  47570023
475800     END-PERFORM.                                                 47580023
475900                                                                  47590023
476000*----------------------------------------------------------------*47600023
476100*                                                                *47610023
476200*----------------------------------------------------------------*47620023
476300 4540-FETCH.                                                      47630023
476400     EXEC SQL                                                     47640023
476500         FETCH STORE-CSR                                          47650023
476600          INTO                                                    47660023
476700                 :DK-STR-NBR                                      47670023
476800               , :DISTDT-FCSE-ACTL-UNT-QTY                        47680023
476900     END-EXEC.                                                    47690023
477000                                                                  47700023
477100     EVALUATE TRUE                                                47710023
477200         WHEN SQLCODE = ZERO                                      47720023
477300              SET ASC-ITEMS-LEFT-ON-DB-2                          47730023
477400                                   TO TRUE                        47740023
477500         WHEN SQLCODE = +100                                      47750023
477600              SET ASC-NO-ITEMS-LEFT-ON-DB-2                       47760023
477700                                   TO TRUE                        47770023
477800         WHEN SQLCODE = -904                                      47780023
477900         WHEN SQLCODE = -911                                      47790023
478000         WHEN SQLCODE = -913                                      47800023
478100              MOVE '4540-FETCH'       TO DP013-PARAGRAPH          47810023
478200             MOVE SQLCODE            TO PC-DISPLAY-SQL-CODE       47820023
478300             PERFORM 9900-SOFT-ABORT                              47830023
478400                                                                  47840023
478500         WHEN SQLWARN0 NOT = SPACE                                47850023
478600         WHEN SQLCODE < ZERO                                      47860023
478700         WHEN SQLCODE > ZERO                                      47870023
478800              MOVE '4540-FETCH'       TO DP013-PARAGRAPH          47880023
478900              MOVE 'FETCH STORE CURSOR'                           47890023
479000                                      TO DP013-MESSAGE-TEXT (1)   47900023
479100              MOVE SQLCA              TO DP013-SQLCA              47910023
479200              MOVE 'TDISTDT'          TO DP013-DB2-TABLE-NAME (1) 47920023
479300              SET DP013-DB2-ABEND     TO TRUE                     47930023
479400              PERFORM DP013-0000-PROCESS-ABEND                    47940023
479500     END-EVALUATE.                                                47950023
479600                                                                  47960023
479700                                                                  47970023
479800*----------------------------------------------------------------*47980023
479900*                                                                *47990023
480000*----------------------------------------------------------------*48000023
480100 4550-UPDATE-DISTDT.                                              48010023
480200     MOVE  ZEROES  TO  DISTDT-FCSE-ACTL-UNT-QTY.                  48020023
480300                                                                  48030023
480400     EXEC SQL                                                     48040023
480500         UPDATE  TDISTDT                                          48050023
480600           SET FCSE_ACTL_UNT_QTY     = :DISTDT-FCSE-ACTL-UNT-QTY  48060023
480700      WHERE ORD_NBR                  = :DK-ORD-NBR                48070023
480800        AND RCVR_SEQ_NBR             = :DK-RCVR-NBR               48080023
480900        AND ORD_LNE_NBR              = :DK-LINE-NBR               48090023
481000        AND STR_NBR                  = :DK-STR-NBR                48100023
481100     END-EXEC.                                                    48110023
481200                                                                  48120023
481300     EVALUATE TRUE                                                48130023
481400         WHEN SQLCODE = ZERO                                      48140023
481500         WHEN SQLCODE = +100                                      48150023
481600              CONTINUE                                            48160023
481700         WHEN SQLCODE = -904                                      48170023
481800         WHEN SQLCODE = -911                                      48180023
481900         WHEN SQLCODE = -913                                      48190023
482000             MOVE '4550-UPDATE-DISTDT'                            48200023
482100                                  TO DP013-PARAGRAPH              48210023
482200             MOVE SQLCODE            TO PC-DISPLAY-SQL-CODE       48220023
482300             PERFORM 9900-SOFT-ABORT                              48230023
482400                                                                  48240023
482500         WHEN SQLWARN0 NOT = SPACES                               48250023
482600         WHEN SQLCODE < ZERO                                      48260023
482700         WHEN SQLCODE > ZERO                                      48270023
482800             MOVE '4550-UPDATE-DISTDT'                            48280023
482900                                  TO DP013-PARAGRAPH              48290023
483000             MOVE 'UNSUCCESSFUL UPDATE OF STORE ROW'              48300023
483100                                  TO DP013-MESSAGE-TEXT (1)       48310023
483200             MOVE SQLCA      TO DP013-SQLCA                       48320023
483300             MOVE 'TDISTDT ' TO DP013-DB2-TABLE-NAME (1)          48330023
483400             SET DP013-DB2-ABEND                                  48340023
483500                  DP013-NO-ROLLBACK                               48350023
483600                                  TO TRUE                         48360023
483700             PERFORM DP013-0000-PROCESS-ABEND                     48370023
483800     END-EVALUATE.                                                48380023
483900                                                                  48390023
484000 4552-UPDATE-DISTDT.                                              48400023
484100                                                                  48410023
484200     EXEC SQL                                                     48420023
484300         UPDATE  TDISTDT                                          48430023
484400           SET FCSE_ACTL_UNT_QTY     = :DISTDT-FCSE-ACTL-UNT-QTY  48440023
484500      WHERE ORD_NBR                  = :DK-ORD-NBR                48450023
484600        AND RCVR_SEQ_NBR             = :DK-RCVR-NBR               48460023
484700        AND ORD_LNE_NBR              = :DK-LINE-NBR               48470023
484800        AND STR_NBR                  = :DK-STR-NBR                48480023
484900     END-EXEC.                                                    48490023
485000                                                                  48500023
485100     EVALUATE TRUE                                                48510023
485200         WHEN SQLCODE = ZERO                                      48520023
485300         WHEN SQLCODE = +100                                      48530023
485400              CONTINUE                                            48540023
485500         WHEN SQLCODE = -904                                      48550023
485600         WHEN SQLCODE = -911                                      48560023
485700         WHEN SQLCODE = -913                                      48570023
485800             MOVE '4552-UPDATE-DISTDT'                            48580023
485900                                  TO DP013-PARAGRAPH              48590023
486000             MOVE SQLCODE            TO PC-DISPLAY-SQL-CODE       48600023
486100             PERFORM 9900-SOFT-ABORT                              48610023
486200                                                                  48620023
486300         WHEN SQLWARN0 NOT = SPACES                               48630023
486400         WHEN SQLCODE < ZERO                                      48640023
486500         WHEN SQLCODE > ZERO                                      48650023
486600             MOVE DK-ORD-NBR      TO PV-DISPLAY-PO                48660023
486700             MOVE DK-RCVR-NBR     TO PV-DISPLAY-RECV              48670023
486800             MOVE DK-LINE-NBR     TO PV-DISPLAY-LINE              48680023
486900             MOVE DK-STR-NBR      TO PV-DISPLAY-STORE             48690023
487000             MOVE '4552-UPDATE-DISTDT'                            48700023
487100                                  TO DP013-PARAGRAPH              48710023
487200             MOVE 'UNSUCCESSFUL UPDATE OF STORE ROW'              48720023
487300                                  TO DP013-MESSAGE-TEXT (1)       48730023
487400             MOVE SQLCA      TO DP013-SQLCA                       48740023
487500             MOVE 'TDISTDT ' TO DP013-DB2-TABLE-NAME (1)          48750023
487600             STRING 'PO = '                                       48760023
487700                    PV-DISPLAY-PO                                 48770023
487800                    '-'                                           48780023
487900                    PV-DISPLAY-RECV                               48790023
488000                    ' LINE - '                                    48800023
488100                    PV-DISPLAY-LINE                               48810023
488200                    ' STORE - '                                   48820023
488300                    PV-DISPLAY-STORE                              48830023
488400                                  DELIMITED BY SIZE               48840023
488500                                INTO DP013-MESSAGE-TEXT (2)       48850023
488600             SET DP013-DB2-ABEND                                  48860023
488700                  DP013-NO-ROLLBACK                               48870023
488800                                  TO TRUE                         48880023
488900             PERFORM DP013-0000-PROCESS-ABEND                     48890023
489000     END-EVALUATE.                                                48900023
489100                                                                  48910023
489200                                                                  48920023
489300 4560-SYNCPOINT.                                                  48930023
489400     EXEC CICS                                                    48940023
489500          SYNCPOINT                                               48950023
489600     END-EXEC.                                                    48960023
489700                                                                  48970023
489800                                                                  48980023
489900*----------------------------------------------------------------*48990023
490000* PREPARE THE SELECTED ITEMS TEMP STORAGE QUEUE.  MOVE ALL SEL-  *49000023
490100* ECTED ITEMS FROM THE LIST TEMP STORAGE QUEUE TO THE LAYOUT     *49010023
490200* FOR THE SELECTED ITEMS QUEUE.                                  *49020023
490300*                                                                *49030023
490400* FIRST, DELETE THE SELECTION QUEUE, NEXT LOAD THE SELECTION     *49040023
490500* QUEUE RECORD.  FINALLY, WRITE THE SELECTION QUEUE ITEM WHEN    *49050023
490600* THE ARRAY IS FULL.                                             *49060023
490700*----------------------------------------------------------------*49070023
490800                                                                  49080023
490900 5000-PREPARE-SEL-QUEUE.                                          49090023
491000                                                                  49100023
491100     MOVE +1                       TO ASC-BLK-SUB.                49110023
491200     PERFORM 5100-WRITE-TEMP-STORAGE.                             49120023
491300     ADD +1                        TO ASC-BLK-SUB.                49130023
491400     PERFORM 5100-WRITE-TEMP-STORAGE.                             49140023
491500                                                                  49150023
491600     MOVE ASC-OPER-UNT-ID      TO  RC015-OPER-UNT-ID.             49160023
491700     MOVE ASC-FCLTY-ID         TO  RC015-FCLTY-ID.                49170023
491800     MOVE ASC-ORD-NBR          TO  RC015-PO-NBR.                  49180023
491900     MOVE ASC-RCVR-NBR         TO  RC015-REC-SEQ-NBR.             49190023
492000     MOVE ASC-SEL-QUEUE-NAME   TO  RC015-SEL-QUEUE-NAME.          49200023
492100     PERFORM 6010-DELETE-SEL-QUEUE.                               49210023
492200                                                                  49220023
492300     IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO                      49230023
492400         SET ASC-UPDATE-TSQ        TO TRUE                        49240023
492500     END-IF.                                                      49250023
492600                                                                  49260023
492700     SET RC013-IDX                 TO 1.                          49270023
492800     MOVE ZERO                     TO RC015-NUMBER-OF-TS-ITEMS.   49280023
492900     INITIALIZE RC013-SELECTED-ITEM-ARRAY.                        49290023
493000                                                                  49300023
493100                                                                  49310023
493200     PERFORM 5200-FILL-SEL-QUEUE-RECORD                           49320023
493300         VARYING PV-ITEM  FROM 1 BY 1                             49330023
493400         UNTIL   PV-ITEM > ASC-HIGHEST-BLOCK-WRITTEN              49340023
493500                                                                  49350023
493600                                                                  49360023
493700                                                                  49370023
493800     IF  RC013-IDX > 1                                            49380023
493900         PERFORM 5205-WRITE-SEL-QUEUE                             49390023
494000         ADD +1                    TO RC015-NUMBER-OF-TS-ITEMS    49400023
494100     END-IF.                                                      49410023
494200                                                                  49420023
494300/                                                                 49430023
494400*----------------------------------------------------------------*49440023
494500*    WRITE A NEW BLOCK FROM THE ARRAY TO TEMPORARY STORAGE.      *49450023
494600*    REWRITE AN EXISITING BLOCK ONLY IF IT HAS BEEN MODIFIED.    *49460023
494700*----------------------------------------------------------------*49470023
494800                                                                  49480023
494900 5100-WRITE-TEMP-STORAGE.                                         49490023
495000                                                                  49500023
495100     MOVE ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1)                     49510023
495200                                   TO PV-LIST-ITEM-NUMBER.        49520023
495300     COMPUTE PV-BLOCK-NUMBER =                                    49530023
495400         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    49540023
495500                                                                  49550023
495600     IF (PV-BLOCK-NUMBER < ASC-HIGHEST-BLOCK-WRITTEN)             49560023
495700     OR (PV-BLOCK-NUMBER = ASC-HIGHEST-BLOCK-WRITTEN)             49570023
495800         IF  ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                      49580023
495900             PERFORM 5105-REWRITE-ASC-LISTQ                       49590023
496000         END-IF                                                   49600023
496100     ELSE                                                         49610023
496200         COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                       49620023
496300         ASC-HIGHEST-BLOCK-WRITTEN + 1                            49630023
496400         PERFORM 5110-WRITE-ASC-LISTQ                             49640023
496500         ADD +1                    TO ASC-HIGHEST-BLOCK-WRITTEN   49650023
496600     END-IF.                                                      49660023
496700                                                                  49670023
496800     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)                      49680023
496900                                   TO TRUE.                       49690023
497000                                                                  49700023
497100/                                                                 49710023
497200*----------------------------------------------------------------*49720023
497300*  REWRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-     *49730023
497400*  SPECIFIC COMMAREA.                                            *49740023
497500*----------------------------------------------------------------*49750023
497600 5105-REWRITE-ASC-LISTQ.                                          49760023
497700                                                                  49770023
497800     EXEC CICS                                                    49780023
497900         WRITEQ TS                                                49790023
498000             QUEUE (ASC-LIST-QUEUE-NAME)                          49800023
498100             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               49810023
498200             ITEM  (PV-BLOCK-NUMBER)                              49820023
498300             REWRITE                                              49830023
498400             RESP  (PV-CICS-RESP)                                 49840023
498500     END-EXEC.                                                    49850023
498600                                                                  49860023
498700                                                                  49870023
498800     IF  PV-CICS-RESP = DFHRESP(NORMAL)                           49880023
498900         CONTINUE                                                 49890023
499000     ELSE                                                         49900023
499100         SET DP013-CICS-ABEND      TO TRUE                        49910023
499200         SET DP013-NO-ROLLBACK     TO TRUE                        49920023
499300         MOVE '5105-REWRITE-ASC-LISTQ'                            49930023
499400                                   TO DP013-PARAGRAPH             49940023
499500         MOVE 'ATTEMPTING TO REWRITE LIST TEMP STORAGE QUEUE'     49950023
499600                                   TO DP013-MESSAGE-TEXT(1)       49960023
499700         PERFORM DP013-0000-PROCESS-ABEND                         49970023
499800     END-IF.                                                      49980023
499900                                                                  49990023
500000/                                                                 50000023
500100*----------------------------------------------------------------*50010023
500200*  WRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-       *50020023
500300*  SPECIFIC COMMAREA.                                            *50030023
500400*----------------------------------------------------------------*50040023
500500 5110-WRITE-ASC-LISTQ.                                            50050023
500600                                                                  50060023
500700     EXEC CICS                                                    50070023
500800         WRITEQ TS                                                50080023
500900             QUEUE (ASC-LIST-QUEUE-NAME)                          50090023
501000             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               50100023
501100             ITEM  (PV-BLOCK-NUMBER)                              50110023
501200             RESP  (PV-CICS-RESP)                                 50120023
501300     END-EXEC.                                                    50130023
501400                                                                  50140023
501500                                                                  50150023
501600     IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      50160023
501700         SET DP013-CICS-ABEND      TO TRUE                        50170023
501800         SET DP013-NO-ROLLBACK     TO TRUE                        50180023
501900         MOVE '5110-WRITE-ASC-LISTQ'                              50190023
502000                                   TO DP013-PARAGRAPH             50200023
502100         MOVE 'ATTEMPTING TO DELETE TEMP STORAGE QUEUE'           50210023
502200                                   TO DP013-MESSAGE-TEXT(1)       50220023
502300         PERFORM DP013-0000-PROCESS-ABEND                         50230023
502400     END-IF.                                                      50240023
502500                                                                  50250023
502600 5120-REWRITE-LIST-QUEUE.                                         50260023
502700     EXEC CICS                                                    50270023
502800          WRITEQ TS                                               50280023
502900              QUEUE   (ASC-SEL-QUEUE-NAME-IN)                     50290023
503000              FROM    (RC013-DC-SELECT-RECORD)                    50300023
503100              ITEM    (PV-SEL-QUEUE-ITEM)                         50310023
503200              RESP    (PV-CICS-RESP)                              50320023
503300              REWRITE                                             50330023
503400     END-EXEC.                                                    50340023
503500                                                                  50350023
503600                                                                  50360023
503700     IF PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                    50370023
503800         SET DP013-CICS-ABEND                                     50380023
503900             DP013-NO-ROLLBACK     TO TRUE                        50390023
504000         MOVE '5120-REWRITE-LIST-QUEUE'                           50400023
504100                                   TO DP013-PARAGRAPH             50410023
504200         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   50420023
504300                                   TO DP013-MESSAGE-TEXT (1)      50430023
504400         PERFORM DP013-0000-PROCESS-ABEND                         50440023
504500     END-IF.                                                      50450023
504600                                                                  50460023
504700/                                                                 50470023
504800*----------------------------------------------------------------*50480023
504900* READ A LIST QUEUE RECORD AND MOVE THE KEYS OF SELECTED OBJECTS *50490023
505000* TO THE SELECTED ITEMS TEMP STORAGE QUEUE RECORD.               *50500023
505100*----------------------------------------------------------------*50510023
505200                                                                  50520023
505300 5200-FILL-SEL-QUEUE-RECORD.                                      50530023
505400                                                                  50540023
505500     PERFORM 6112-READ-LIST-QUEUE.                                50550023
505600                                                                  50560023
505700     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       50570023
505800         PERFORM                                                  50580023
505900         VARYING LQW-IDX                                          50590023
506000         FROM 1 BY 1                                              50600023
506100         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            50610023
506200           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          50620023
506300                                                                  50630023
506400             IF  LQW-SELECT (LQW-IDX)                             50640023
506500                 MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)              50650023
506600                                   TO RC013-ITEM      (RC013-IDX) 50660023
506700                 MOVE SPACE        TO RC013-ACTION-SW (RC013-IDX) 50670023
506800                 MOVE RC015-OPER-UNT-ID                           50680023
506900                                 TO RC013-OPER-UNT-ID(RC013-IDX)  50690023
507000                 MOVE RC015-FCLTY-ID                              50700023
507100                                 TO RC013-FCLTY-ID(RC013-IDX)     50710023
507200                 MOVE RC015-PO-NBR                                50720023
507300                                 TO RC013-PO-NBR(RC013-IDX)       50730023
507400                 MOVE RC015-REC-SEQ-NBR                           50740023
507500                                 TO RC013-REC-SEQ-NBR(RC013-IDX)  50750023
507600                 MOVE LQW-PO-LINE (LQW-IDX)                       50760023
507700                                 TO RC013-PKSL-LNE-NBR-N          50770023
507800                                                     (RC013-IDX)  50780023
507900                                                                  50790023
508000                 SET LQW-DESELECT (LQW-IDX)                       50800023
508100                     LQW-INQUIRE  (LQW-IDX)                       50810023
508200                                   TO  TRUE                       50820023
508300                 SET RC013-IDX UP BY 1                            50830023
508400                 IF  RC013-IDX > RC013-MAX-ITEMS                  50840023
508500                     PERFORM 5205-WRITE-SEL-QUEUE                 50850023
508600                     ADD +1        TO RC015-NUMBER-OF-TS-ITEMS    50860023
508700                     INITIALIZE RC013-SELECTED-ITEM-ARRAY         50870023
508800                     SET RC013-IDX TO 1                           50880023
508900                 END-IF                                           50890023
509000             END-IF                                               50900023
509100         END-PERFORM                                              50910023
509200     END-IF.                                                      50920023
509300                                                                  50930023
509400/                                                                 50940023
509500*----------------------------------------------------------------*50950023
509600*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE.                *50960023
509700*----------------------------------------------------------------*50970023
509800                                                                  50980023
509900 5205-WRITE-SEL-QUEUE.                                            50990023
510000                                                                  51000023
510100     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            51010023
510200                                   TO RC013-SELECTED-ITEMS.       51020023
510300                                                                  51030023
510400     EXEC CICS                                                    51040023
510500          WRITEQ TS                                               51050023
510600              QUEUE (ASC-SEL-QUEUE-NAME)                          51060023
510700              FROM  (RC013-DC-SELECT-RECORD)                      51070023
510800              ITEM  (PV-SEL-QUEUE-ITEM)                           51080023
510900              RESP  (PV-CICS-RESP)                                51090023
511000     END-EXEC.                                                    51100023
511100                                                                  51110023
511200                                                                  51120023
511300     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          51130023
511400         CONTINUE                                                 51140023
511500     ELSE                                                         51150023
511600         SET DP013-CICS-ABEND      TO TRUE                        51160023
511700         SET DP013-NO-ROLLBACK     TO TRUE                        51170023
511800         MOVE '5205-WRITE-SEL-QUEUE'                              51180023
511900                                   TO DP013-PARAGRAPH             51190023
512000         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          51200023
512100                                   TO DP013-MESSAGE-TEXT(1)       51210023
512200         PERFORM DP013-0000-PROCESS-ABEND                         51220023
512300     END-IF.                                                      51230023
512400                                                                  51240023
512500*----------------------------------------------------------------*51250023
512600* PREPARE THE SELECTED ITEMS TEMP STORAGE QUEUE.  MOVE ALL SEL-  *51260023
512700* ECTED ITEMS FROM THE LIST TEMP STORAGE QUEUE TO THE LAYOUT     *51270023
512800* FOR THE SELECTED ITEMS QUEUE.                                  *51280023
512900*                                                                *51290023
513000* FIRST, DELETE THE SELECTION QUEUE, NEXT LOAD THE SELECTION     *51300023
513100* QUEUE RECORD.  FINALLY, WRITE THE SELECTION QUEUE ITEM WHEN    *51310023
513200* THE ARRAY IS FULL.                                             *51320023
513300*----------------------------------------------------------------*51330023
513400 5500-PREPARE-SEL-QUEUE.                                          51340023
513500                                                                  51350023
513600     MOVE +1 TO ASC-BLK-SUB.                                      51360023
513700     PERFORM 5510-WRITE-TEMP-STORAGE.                             51370023
513800     ADD +1  TO ASC-BLK-SUB.                                      51380023
513900     PERFORM 5510-WRITE-TEMP-STORAGE.                             51390023
514000                                                                  51400023
514100     MOVE ASC-SEL-QUEUE-NAME TO RC800-SEL-QUEUE-NAME.             51410023
514200     PERFORM 5520-DELETE-SEL-QUEUE.                               51420023
514300                                                                  51430023
514400     SET ASC-UPDATE-TSQ TO TRUE.                                  51440023
514500     SET RC801-IDX TO 1.                                          51450023
514600     MOVE ZEROES   TO RC800-NUMBER-OF-TS-ITEMS.                   51460023
514700     INITIALIZE RC801-SELECTED-ITEM-ARRAY.                        51470023
514800                                                                  51480023
514900     PERFORM 5530-FILL-SEL-QUEUE-RECORD                           51490023
515000       VARYING PV-ITEM FROM 1 BY 1                                51500023
515100         UNTIL PV-ITEM > ASC-HIGHEST-BLOCK-WRITTEN                51510023
515200                                                                  51520023
515300     IF  RC801-IDX > 1                                            51530023
515400         PERFORM 5540-WRITE-SEL-QUEUE                             51540023
515500         ADD +1    TO RC800-NUMBER-OF-TS-ITEMS                    51550023
515600     END-IF.                                                      51560023
515700                                                                  51570023
515800*----------------------------------------------------------------*51580023
515900*    WRITE A NEW BLOCK FROM THE ARRAY TO TEMPORARY STORAGE.      *51590023
516000*    REWRITE AN EXISITING BLOCK ONLY IF IT HAS BEEN MODIFIED.    *51600023
516100*----------------------------------------------------------------*51610023
516200 5510-WRITE-TEMP-STORAGE.                                         51620023
516300                                                                  51630023
516400     MOVE ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1)                     51640023
516500         TO PV-LIST-ITEM-NUMBER.                                  51650023
516600     COMPUTE PV-BLOCK-NUMBER =                                    51660023
516700         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    51670023
516800                                                                  51680023
516900     IF (PV-BLOCK-NUMBER < ASC-HIGHEST-BLOCK-WRITTEN)             51690023
517000       OR (PV-BLOCK-NUMBER = ASC-HIGHEST-BLOCK-WRITTEN)           51700023
517100         IF ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                       51710023
517200             PERFORM 5515-REWRITE-ASC-LISTQ                       51720023
517300         END-IF                                                   51730023
517400     ELSE                                                         51740023
517500         COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                       51750023
517600                                 ASC-HIGHEST-BLOCK-WRITTEN + 1    51760023
517700         PERFORM 5516-WRITE-ASC-LISTQ                             51770023
517800         ADD +1 TO ASC-HIGHEST-BLOCK-WRITTEN                      51780023
517900     END-IF.                                                      51790023
518000                                                                  51800023
518100     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             51810023
518200                                                                  51820023
518300/                                                                 51830023
518400*----------------------------------------------------------------*51840023
518500*  REWRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-     *51850023
518600*  SPECIFIC COMMAREA.                                            *51860023
518700*----------------------------------------------------------------*51870023
518800 5515-REWRITE-ASC-LISTQ.                                          51880023
518900                                                                  51890023
519000     EXEC CICS                                                    51900023
519100         WRITEQ TS                                                51910023
519200             QUEUE (ASC-LIST-QUEUE-NAME)                          51920023
519300             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               51930023
519400             ITEM  (PV-BLOCK-NUMBER)                              51940023
519500             REWRITE                                              51950023
519600             RESP  (PV-CICS-RESP)                                 51960023
519700     END-EXEC.                                                    51970023
519800                                                                  51980023
519900                                                                  51990023
520000     IF PV-CICS-RESP = DFHRESP(NORMAL)                            52000023
520100         CONTINUE                                                 52010023
520200     ELSE                                                         52020023
520300         SET DP013-CICS-ABEND      TO TRUE                        52030023
520400         SET DP013-NO-ROLLBACK     TO TRUE                        52040023
520500         MOVE '5515-REWRITE-ASC-LISTQ'                            52050023
520600                                   TO DP013-PARAGRAPH             52060023
520700         MOVE 'ATTEMPTING TO REWRITE LIST TEMP STORAGE QUEUE'     52070023
520800                                   TO DP013-MESSAGE-TEXT(1)       52080023
520900         PERFORM DP013-0000-PROCESS-ABEND                         52090023
521000     END-IF.                                                      52100023
521100                                                                  52110023
521200/                                                                 52120023
521300*----------------------------------------------------------------*52130023
521400*  WRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-       *52140023
521500*  SPECIFIC COMMAREA.                                            *52150023
521600*----------------------------------------------------------------*52160023
521700 5516-WRITE-ASC-LISTQ.                                            52170023
521800                                                                  52180023
521900     EXEC CICS                                                    52190023
522000         WRITEQ TS                                                52200023
522100             QUEUE (ASC-LIST-QUEUE-NAME)                          52210023
522200             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               52220023
522300             ITEM  (PV-BLOCK-NUMBER)                              52230023
522400             RESP  (PV-CICS-RESP)                                 52240023
522500     END-EXEC.                                                    52250023
522600                                                                  52260023
522700                                                                  52270023
522800     IF PV-CICS-RESP NOT = DFHRESP (NORMAL)                       52280023
522900         SET DP013-CICS-ABEND      TO TRUE                        52290023
523000         SET DP013-NO-ROLLBACK     TO TRUE                        52300023
523100         MOVE '5516-WRITE-ASC-LISTQ'                              52310023
523200                                   TO DP013-PARAGRAPH             52320023
523300         MOVE 'ATTEMPTING TO DELETE TEMP STORAGE QUEUE'           52330023
523400                                   TO DP013-MESSAGE-TEXT(1)       52340023
523500         PERFORM DP013-0000-PROCESS-ABEND                         52350023
523600     END-IF.                                                      52360023
523700                                                                  52370023
523800*----------------------------------------------------------------*52380023
523900*    DELETE THE SELECTED ITEMS TEMP STORAGE QUEUE.               *52390023
524000*----------------------------------------------------------------*52400023
524100 5520-DELETE-SEL-QUEUE.                                           52410023
524200                                                                  52420023
524300     EXEC CICS                                                    52430023
524400         DELETEQ TS                                               52440023
524500             QUEUE (ASC-SEL-QUEUE-NAME)                           52450023
524600             RESP  (PV-CICS-RESP)                                 52460023
524700     END-EXEC.                                                    52470023
524800                                                                  52480023
524900                                                                  52490023
525000     IF ((PV-CICS-RESP = DFHRESP(NORMAL))                         52500023
525100       OR (PV-CICS-RESP = DFHRESP(QIDERR)))                       52510023
525200         CONTINUE                                                 52520023
525300     ELSE                                                         52530023
525400         SET DP013-CICS-ABEND      TO TRUE                        52540023
525500         SET DP013-NO-ROLLBACK     TO TRUE                        52550023
525600         MOVE '5520-DELETE-SEL-QUEUE'                             52560023
525700                                   TO DP013-PARAGRAPH             52570023
525800         MOVE 'ERROR TRYING TO DELETE SELECTION TS QUEUE'         52580023
525900                                   TO DP013-MESSAGE-TEXT (1)      52590023
526000         PERFORM DP013-0000-PROCESS-ABEND                         52600023
526100     END-IF.                                                      52610023
526200                                                                  52620023
526300*----------------------------------------------------------------*52630023
526400* READ A LIST QUEUE RECORD AND MOVE THE KEYS OF SELECTED OBJECTS *52640023
526500* TO THE SELECTED ITEMS TEMP STORAGE QUEUE RECORD.               *52650023
526600*----------------------------------------------------------------*52660023
526700 5530-FILL-SEL-QUEUE-RECORD.                                      52670023
526800                                                                  52680023
526900     PERFORM 5535-READ-LIST-QUEUE.                                52690023
527000                                                                  52700023
527100     IF PV-CICS-RESP EQUAL DFHRESP(NORMAL)                        52710023
527200         PERFORM                                                  52720023
527300           VARYING LQW-IDX FROM 1 BY 1                            52730023
527400             UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL        52740023
527500             OR LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO         52750023
527600                                                                  52760023
527700             IF LQW-SELECT (LQW-IDX)                              52770023
527800                 MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)              52780023
527900                             TO RC801-ITEM        (RC801-IDX)     52790023
528000                 MOVE SPACES TO RC801-ACTION-SW   (RC801-IDX)     52800023
528100                 MOVE LQW-PO-LINE (LQW-IDX)                       52810023
528200                             TO RC801-REC-LNE-NBR (RC801-IDX)     52820023
528300                 MOVE LQW-PREPK-L4 (LQW-IDX)                      52830023
528400                             TO RC801-PACK-ID     (RC801-IDX)     52840023
528500                                                                  52850023
528600                 SET LQW-DESELECT (LQW-IDX)                       52860023
528700                     LQW-INQUIRE  (LQW-IDX) TO TRUE               52870023
528800                 SET RC801-IDX UP BY 1                            52880023
528900                 IF RC801-IDX > RC801-MAX-ITEMS                   52890023
529000                     PERFORM 5540-WRITE-SEL-QUEUE                 52900023
529100                     ADD +1  TO RC800-NUMBER-OF-TS-ITEMS          52910023
529200                     INITIALIZE RC801-SELECTED-ITEM-ARRAY         52920023
529300                     SET RC801-IDX TO 1                           52930023
529400                 END-IF                                           52940023
529500             END-IF                                               52950023
529600         END-PERFORM                                              52960023
529700     END-IF.                                                      52970023
529800                                                                  52980023
529900*----------------------------------------------------------------*52990023
530000*    READ THE TEMPORARY STORAGE QUEUE INTO A TEMPORARY WORK AREA.*53000023
530100*----------------------------------------------------------------*53010023
530200 5535-READ-LIST-QUEUE.                                            53020023
530300                                                                  53030023
530400     EXEC CICS                                                    53040023
530500         READQ TS                                                 53050023
530600             QUEUE (ASC-LIST-QUEUE-NAME)                          53060023
530700             INTO  (LQW-LIST-QUEUE-WORK-AREA)                     53070023
530800             ITEM  (PV-ITEM)                                      53080023
530900             RESP  (PV-CICS-RESP)                                 53090023
531000     END-EXEC.                                                    53100023
531100                                                                  53110023
531200     IF PV-CICS-RESP = DFHRESP (NORMAL)                           53120023
531300         CONTINUE                                                 53130023
531400     ELSE                                                         53140023
531500         SET DP013-CICS-ABEND  TO TRUE                            53150023
531600         SET DP013-NO-ROLLBACK TO TRUE                            53160023
531700         MOVE '5535-READ-LIST-QUEUE' TO DP013-PARAGRAPH           53170023
531800         MOVE 'ATTEMPTING TO READQ LIST QUEUE'                    53180023
531900                                     TO DP013-MESSAGE-TEXT(1)     53190023
532000         PERFORM DP013-0000-PROCESS-ABEND                         53200023
532100     END-IF.                                                      53210023
532200                                                                  53220023
532300*----------------------------------------------------------------*53230023
532400*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE.                *53240023
532500*----------------------------------------------------------------*53250023
532600 5540-WRITE-SEL-QUEUE.                                            53260023
532700                                                                  53270023
532800     MOVE ASC-NUMBER-OF-SELECTED-ITEMS TO RC801-SELECTED-ITEMS.   53280023
532900                                                                  53290023
533000     EXEC CICS                                                    53300023
533100          WRITEQ TS                                               53310023
533200              QUEUE (ASC-SEL-QUEUE-NAME)                          53320023
533300              FROM  (RC801-PREPACK-SELECT-RECORD)                 53330023
533400              ITEM  (PV-SEL-QUEUE-ITEM)                           53340023
533500              RESP  (PV-CICS-RESP)                                53350023
533600     END-EXEC.                                                    53360023
533700                                                                  53370023
533800                                                                  53380023
533900     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          53390023
534000         CONTINUE                                                 53400023
534100     ELSE                                                         53410023
534200         SET DP013-CICS-ABEND      TO TRUE                        53420023
534300         SET DP013-NO-ROLLBACK     TO TRUE                        53430023
534400         MOVE '5540-WRITE-SEL-QUEUE'                              53440023
534500                                   TO DP013-PARAGRAPH             53450023
534600         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          53460023
534700                                   TO DP013-MESSAGE-TEXT(1)       53470023
534800         PERFORM DP013-0000-PROCESS-ABEND                         53480023
534900     END-IF.                                                      53490023
535000                                                                  53500023
535100/                                                                 53510023
535200*----------------------------------------------------------------*53520023
535300*  WHEN RETURNING TO THIS TRANSACTION FROM ANOTHER TRANSACTION,  *53530023
535400*  SETUP THE ARRAY AS IT WAS WHEN WE HAD LEFT PREVIOUSLY.  EDIT  *53540023
535500*  THE SELECTIONS MADE AT THAT TIME AND DISPLAY THE PANEL TO     *53550023
535600*  THE USER.                                                     *53560023
535700*----------------------------------------------------------------*53570023
535800 6000-REFRESH-PANEL-FROM-TEMP.                                    53580023
535900                                                                  53590023
536000     IF ASC-UPDATE-TSQ                                            53600023
536100         SET ASC-NO-TSQ-UPDATE     TO TRUE                        53610023
536200         MOVE ZERO                 TO PV-SAVE-ITEM                53620023
536300                                      PV-SEL-QUEUE-ITEM           53630023
536400         MOVE ASC-NUMBER-OF-SELECTED-ITEMS                        53640023
536500                                   TO PV-HOLD-SELECTED-ITEMS      53650023
536600                                                                  53660023
536700         IF ASC-FUNC08-RETURN-YES                                 53670023
536800           OR ASC-FUNC09-RETURN-YES                               53680023
536900***          IF RC800-SEL-QUEUE-NAME > SPACES                     53690023
537000                 PERFORM 6200-UPDATE-TSQ                          53700023
537100                   UNTIL PV-ITEMS-PROCESSED >                     53710023
537200                         ASC-NUMBER-OF-SELECTED-ITEMS             53720023
537300***          END-IF                                               53730023
537400         ELSE                                                     53740023
537500***          IF RC015-SEL-QUEUE-NAME > SPACES                     53750023
537600                 PERFORM 6100-UPDATE-TSQ                          53760023
537700                   UNTIL PV-ITEMS-PROCESSED >                     53770023
537800                         ASC-NUMBER-OF-SELECTED-ITEMS             53780023
537900***          END-IF                                               53790023
538000         END-IF                                                   53800023
538100                                                                  53810023
538200         PERFORM 6010-DELETE-SEL-QUEUE                            53820023
538300         SET ASC-FUNC08-RETURN-NO TO TRUE                         53830023
538400         SET ASC-FUNC09-RETURN-NO TO TRUE                         53840023
538500         INITIALIZE ASC-BLOCK-ENTRIES (1)                         53850023
538600                    ASC-BLOCK-ENTRIES (2)                         53860023
538700     END-IF.                                                      53870023
538800                                                                  53880023
538900/                                                                 53890023
539000*----------------------------------------------------------------*53900023
539100*    DELETE THE SELECTED ITEMS TEMP STORAGE QUEUE.               *53910023
539200*----------------------------------------------------------------*53920023
539300 6010-DELETE-SEL-QUEUE.                                           53930023
539400                                                                  53940023
539500     EXEC CICS                                                    53950023
539600         DELETEQ TS                                               53960023
539700             QUEUE (ASC-SEL-QUEUE-NAME)                           53970023
539800             RESP  (PV-CICS-RESP)                                 53980023
539900     END-EXEC.                                                    53990023
540000                                                                  54000023
540100                                                                  54010023
540200     IF ((PV-CICS-RESP = DFHRESP(NORMAL)) OR                      54020023
540300         (PV-CICS-RESP = DFHRESP(QIDERR)))                        54030023
540400         CONTINUE                                                 54040023
540500     ELSE                                                         54050023
540600         SET DP013-CICS-ABEND      TO TRUE                        54060023
540700         SET DP013-NO-ROLLBACK     TO TRUE                        54070023
540800         MOVE '6010-DELETE-SEL-QUEUE'                             54080023
540900                                   TO DP013-PARAGRAPH             54090023
541000         MOVE 'ERROR TRYING TO DELETE SELECTION TS QUEUE'         54100023
541100                                   TO DP013-MESSAGE-TEXT (1)      54110023
541200         PERFORM DP013-0000-PROCESS-ABEND                         54120023
541300     END-IF.                                                      54130023
541400                                                                  54140023
541500/                                                                 54150023
541600*----------------------------------------------------------------*54160023
541700*    INCREMENT THE TSQ ITEM NUMBER AND READ THE LIST QUEUE.      *54170023
541800*    LOOP THROUGH THE LIST QUEUE TO OBTAIN THE LINE ITEM NUMBER  *54180023
541900*    TO BE USED TO UPDATE (DESELECT) THE CORRECT LINE ITEM IN    *54190023
542000*    THE TEMP QUEUE.                                             *54200023
542100*----------------------------------------------------------------*54210023
542200                                                                  54220023
542300 6100-UPDATE-TSQ.                                                 54230023
542400                                                                  54240023
542500     ADD +1                        TO PV-SEL-QUEUE-ITEM.          54250023
542600     PERFORM 6105-READ-SEL-QUEUE.                                 54260023
542700                                                                  54270023
542800     PERFORM                                                      54280023
542900       VARYING RC013-IDX FROM 1 BY 1                              54290023
543000         UNTIL ((PV-ITEMS-PROCESSED > PV-HOLD-SELECTED-ITEMS)     54300023
543100            OR (RC013-IDX GREATER THAN RC013-MAX-ITEMS))          54310023
543200                                                                  54320023
543300         IF RC013-ACTION-SW (RC013-IDX) > SPACE                   54330023
543400             PERFORM 6110-PROCESS-ITEMS                           54340023
543500         END-IF                                                   54350023
543600                                                                  54360023
543700         ADD +1 TO PV-ITEMS-PROCESSED                             54370023
543800     END-PERFORM.                                                 54380023
543900                                                                  54390023
544000     PERFORM 6111-WRITE-LIST-QUEUE.                               54400023
544100                                                                  54410023
544200*----------------------------------------------------------------*54420023
544300*    READ THE LIST QUEUE RECORD.                                 *54430023
544400*----------------------------------------------------------------*54440023
544500 6105-READ-SEL-QUEUE.                                             54450023
544600                                                                  54460023
544700     EXEC CICS                                                    54470023
544800         READQ TS                                                 54480023
544900         QUEUE (ASC-SEL-QUEUE-NAME)                               54490023
545000          INTO (RC013-DC-SELECT-RECORD)                           54500023
545100          ITEM (PV-SEL-QUEUE-ITEM)                                54510023
545200          RESP (PV-CICS-RESP)                                     54520023
545300     END-EXEC.                                                    54530023
545400                                                                  54540023
545500     IF PV-CICS-RESP = DFHRESP (NORMAL)                           54550023
545600         CONTINUE                                                 54560023
545700     ELSE                                                         54570023
545800         SET DP013-CICS-ABEND      TO TRUE                        54580023
545900         SET DP013-NO-ROLLBACK     TO TRUE                        54590023
546000         MOVE '6105-READ-SEL-QUEUE'                               54600023
546100                                   TO DP013-PARAGRAPH             54610023
546200         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           54620023
546300                                   TO DP013-MESSAGE-TEXT(1)       54630023
546400         MOVE ASC-SEL-TERM-ID      TO PV-SEL-TERM-ID              54640023
546500         MOVE ASC-SEL-TASK-NUMBER  TO PV-SEL-TASK-NUMBER          54650023
546600         MOVE ASC-SEL-SEQ          TO PV-SEL-SEQ                  54660023
546700         STRING ' QUEUE TERM ID-'     DELIMITED BY SIZE           54670023
546800                 PV-SEL-TERM-ID       DELIMITED BY SIZE           54680023
546900                ' QUEUE TASK-'        DELIMITED BY SIZE           54690023
547000                 PV-SEL-TASK-NUMBER   DELIMITED BY SIZE           54700023
547100                ' QUEUE SEQ-'         DELIMITED BY SIZE           54710023
547200                 PV-SEL-SEQ           DELIMITED BY SIZE           54720023
547300                                 INTO  DP013-MESSAGE-TEXT(2)      54730023
547400         PERFORM DP013-0000-PROCESS-ABEND                         54740023
547500     END-IF.                                                      54750023
547600                                                                  54760023
547700*----------------------------------------------------------------*54770023
547800*    CALCULATE THE TEMP QUEUE ITEM THAT MUST BE READ AND READ IT.*54780023
547900*    REWRITE THE CURRENT TEMP QUEUE ITEM IF NECESSARY.  CALCULATE*54790023
548000*    THE LINE ITEM OCCURENCE AND UPDATE (DESELECT) IT.           *54800023
548100*----------------------------------------------------------------*54810023
548200 6110-PROCESS-ITEMS.                                              54820023
548300                                                                  54830023
548400     COMPUTE PV-ITEM = 1 + ((RC013-ITEM (RC013-IDX) - 1)          54840023
548500                     / PC-ITEMS-PER-PANEL).                       54850023
548600                                                                  54860023
548700     IF PV-ITEM NOT EQUAL PV-SAVE-ITEM                            54870023
548800         IF PV-SAVE-ITEM NOT EQUAL ZERO                           54880023
548900             PERFORM 6111-WRITE-LIST-QUEUE                        54890023
549000         END-IF                                                   54900023
549100         MOVE PV-ITEM TO PV-SAVE-ITEM                             54910023
549200                                                                  54920023
549300         PERFORM 6112-READ-LIST-QUEUE                             54930023
549400         IF PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                54940023
549500             CONTINUE                                             54950023
549600         END-IF                                                   54960023
549700     END-IF.                                                      54970023
549800                                                                  54980023
549900     COMPUTE PV-SUB = (RC013-ITEM (RC013-IDX)                     54990023
550000                    - LQW-LIST-ITEM-NUMBER (1)) + 1.              55000023
550100                                                                  55010023
550200     SET LQW-DESELECT (PV-SUB)     TO TRUE.                       55020023
550300     MOVE LQW-SELECTED-SW (PV-SUB) TO LQW-TEMP-SELECTED-SW        55030023
550400                                     (PV-SUB).                    55040023
550500                                                                  55050023
550600     MOVE ASC-KEY-PO-NBR           TO DK-ORD-NBR.                 55060023
550700     MOVE ASC-KEY-RCVR-NBR         TO DK-RCVR-NBR.                55070023
550800     MOVE LQW-PO-LINE(PV-SUB)      TO DK-LINE-NBR.                55080023
550900                                                                  55090023
551000     PERFORM 7300-SUM-TDISTDT.                                    55100023
551100     IF (ASC-PKGNG-CDE = 'I' OR 'M')                              55110023
551200         IF LQW-PREPK-RATO-QTY (PV-SUB) NOT = ZERO                55120023
551300             IF ASC-AUTO-VE-YES AND PS-PACK-LNE-VERIFIED-NO       55130023
551400                 INITIALIZE RC074-FIELDS                          55140023
551500                 SET RC074-PACK-QTY-YES     TO TRUE               55150023
551600                 MOVE LQW-PREPK-L4 (PV-SUB)                       55160023
551700                                          TO RC074-PACK-ID        55170023
551800                 PERFORM 4350-CALL-RCKUT128                       55180023
551900                 MOVE RC074-FCSE-ACTL-PACK-QTY TO                 55190023
552000                        LQW-PROCESS-QTY (PV-SUB)                  55200023
552100             ELSE                                                 55210023
552200                 COMPUTE LQW-PROCESS-QTY (PV-SUB)                 55220023
552300                       = DISTDT-FCSE-ACTL-UNT-QTY                 55230023
552400                       / LQW-PREPK-RATO-QTY (PV-SUB)              55240023
552500             END-IF                                               55250023
552600         ELSE                                                     55260023
552700             IF ASC-AUTO-VE-YES AND PS-PACK-LNE-VERIFIED-NO       55270023
552800                 INITIALIZE RC074-FIELDS                          55280023
552900                 SET RC074-UNIT-QTY-YES     TO TRUE               55290023
553000                 MOVE DK-LINE-NBR         TO RC074-LINE-NBR       55300023
553100                 PERFORM 4350-CALL-RCKUT128                       55310023
553200                 MOVE RC074-FCSE-ACTL-ITM-QTY                     55320023
553300                   TO LQW-PROCESS-QTY (PV-SUB)                    55330023
553400             ELSE                                                 55340023
553500                 MOVE DISTDT-FCSE-ACTL-UNT-QTY                    55350023
553600                   TO LQW-PROCESS-QTY (PV-SUB)                    55360023
553700             END-IF                                               55370023
553800         END-IF                                                   55380023
553900     ELSE                                                         55390023
554000         IF ASC-AUTO-VE-YES AND PS-PACK-LNE-VERIFIED-NO           55400023
554100             INITIALIZE RC074-FIELDS                              55410023
554200             SET RC074-UNIT-QTY-YES     TO TRUE                   55420023
554300             MOVE DK-LINE-NBR         TO RC074-LINE-NBR           55430023
554400             PERFORM 4350-CALL-RCKUT128                           55440023
554500             MOVE RC074-FCSE-ACTL-ITM-QTY                         55450023
554600               TO LQW-PROCESS-QTY (PV-SUB)                        55460023
554700         ELSE                                                     55470023
554800             MOVE DISTDT-FCSE-ACTL-UNT-QTY                        55480023
554900               TO LQW-PROCESS-QTY (PV-SUB)                        55490023
555000         END-IF                                                   55500023
555100     END-IF.                                                      55510023
555200                                                                  55520023
555300     EVALUATE TRUE                                                55530023
555400       WHEN RC013-INQ (RC013-IDX)                                 55540023
555500           MOVE PC-INQ TO LQW-ACTION (PV-SUB)                     55550023
555600                                                                  55560023
555700       WHEN RC013-UPD (RC013-IDX)                                 55570023
555800           MOVE PC-UPD TO LQW-ACTION (PV-SUB)                     55580023
555900                                                                  55590023
556000       WHEN RC013-DEL (RC013-IDX)                                 55600023
556100           MOVE PC-DEL TO LQW-ACTION (PV-SUB)                     55610023
556200                                                                  55620023
556300       WHEN RC013-ERR (RC013-IDX)                                 55630023
556400           MOVE PC-ERR TO LQW-ACTION (PV-SUB)                     55640023
556500     END-EVALUATE.                                                55650023
556600                                                                  55660023
556700     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                55670023
556800                                                                  55680023
556900*----------------------------------------------------------------*55690023
557000*    WRITE THE TS QUEUE RECORD JUST UPDATED IN C600.             *55700023
557100*----------------------------------------------------------------*55710023
557200 6111-WRITE-LIST-QUEUE.                                           55720023
557300                                                                  55730023
557400     EXEC CICS                                                    55740023
557500         WRITEQ TS                                                55750023
557600             QUEUE (ASC-LIST-QUEUE-NAME)                          55760023
557700             FROM  (LQW-LIST-QUEUE-WORK-AREA)                     55770023
557800             ITEM  (PV-SAVE-ITEM)                                 55780023
557900             REWRITE                                              55790023
558000             RESP  (PV-CICS-RESP)                                 55800023
558100     END-EXEC.                                                    55810023
558200                                                                  55820023
558300     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          55830023
558400         CONTINUE                                                 55840023
558500     ELSE                                                         55850023
558600         SET DP013-CICS-ABEND      TO TRUE                        55860023
558700         SET DP013-NO-ROLLBACK     TO TRUE                        55870023
558800         MOVE '6111-WRITE-LIST-QUEUE'                             55880023
558900                                   TO DP013-PARAGRAPH             55890023
559000         MOVE 'ATTEMPTING TO REWRITE LIST QUEUE'                  55900023
559100                                   TO DP013-MESSAGE-TEXT(1)       55910023
559200         PERFORM DP013-0000-PROCESS-ABEND                         55920023
559300     END-IF.                                                      55930023
559400                                                                  55940023
559500*----------------------------------------------------------------*55950023
559600*    READ THE TEMPORARY STORAGE QUEUE INTO A TEMPORARY WORK AREA.*55960023
559700*----------------------------------------------------------------*55970023
559800 6112-READ-LIST-QUEUE.                                            55980023
559900                                                                  55990023
560000     EXEC CICS                                                    56000023
560100         READQ TS                                                 56010023
560200             QUEUE (ASC-LIST-QUEUE-NAME)                          56020023
560300             INTO  (LQW-LIST-QUEUE-WORK-AREA)                     56030023
560400             ITEM  (PV-ITEM)                                      56040023
560500             RESP  (PV-CICS-RESP)                                 56050023
560600     END-EXEC.                                                    56060023
560700                                                                  56070023
560800     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          56080023
560900         CONTINUE                                                 56090023
561000     ELSE                                                         56100023
561100         SET DP013-CICS-ABEND      TO TRUE                        56110023
561200         SET DP013-NO-ROLLBACK     TO TRUE                        56120023
561300         MOVE '6112-READ-LIST-QUEUE'                              56130023
561400                                   TO DP013-PARAGRAPH             56140023
561500         MOVE 'ATTEMPTING TO READQ LIST QUEUE'                    56150023
561600                                   TO DP013-MESSAGE-TEXT(1)       56160023
561700         PERFORM DP013-0000-PROCESS-ABEND                         56170023
561800     END-IF.                                                      56180023
561900                                                                  56190023
562000*----------------------------------------------------------------*56200023
562100*    INCREMENT THE TSQ ITEM NUMBER AND READ THE LIST QUEUE.      *56210023
562200*    LOOP THROUGH THE LIST QUEUE TO OBTAIN THE LINE ITEM NUMBER  *56220023
562300*    TO BE USED TO UPDATE (DESELECT) THE CORRECT LINE ITEM IN    *56230023
562400*    THE TEMP QUEUE.                                             *56240023
562500*----------------------------------------------------------------*56250023
562600 6200-UPDATE-TSQ.                                                 56260023
562700                                                                  56270023
562800     ADD +1 TO PV-SEL-QUEUE-ITEM.                                 56280023
562900     PERFORM 6205-READ-SEL-QUEUE.                                 56290023
563000                                                                  56300023
563100     PERFORM                                                      56310023
563200       VARYING RC801-IDX FROM 1 BY 1                              56320023
563300         UNTIL ((PV-ITEMS-PROCESSED > PV-HOLD-SELECTED-ITEMS)     56330023
563400            OR (RC801-IDX GREATER THAN RC801-MAX-ITEMS))          56340023
563500                                                                  56350023
563600         IF RC801-ACTION-SW (RC801-IDX) > SPACE                   56360023
563700             PERFORM 6210-PROCESS-ITEMS                           56370023
563800         END-IF                                                   56380023
563900                                                                  56390023
564000         ADD +1 TO PV-ITEMS-PROCESSED                             56400023
564100     END-PERFORM.                                                 56410023
564200                                                                  56420023
564300     PERFORM 6211-WRITE-LIST-QUEUE.                               56430023
564400                                                                  56440023
564500*----------------------------------------------------------------*56450023
564600*    READ THE LIST QUEUE RECORD.                                 *56460023
564700*----------------------------------------------------------------*56470023
564800 6205-READ-SEL-QUEUE.                                             56480023
564900                                                                  56490023
565000     EXEC CICS                                                    56500023
565100         READQ TS                                                 56510023
565200         QUEUE (ASC-SEL-QUEUE-NAME)                               56520023
565300          INTO (RC801-PREPACK-SELECT-RECORD)                      56530023
565400          ITEM (PV-SEL-QUEUE-ITEM)                                56540023
565500          RESP (PV-CICS-RESP)                                     56550023
565600     END-EXEC                                                     56560023
565700                                                                  56570023
565800     IF PV-CICS-RESP = DFHRESP (NORMAL)                           56580023
565900         CONTINUE                                                 56590023
566000     ELSE                                                         56600023
566100         SET DP013-CICS-ABEND       TO TRUE                       56610023
566200         SET DP013-NO-ROLLBACK      TO TRUE                       56620023
566300         MOVE '6205-READ-SEL-QUEUE' TO DP013-PARAGRAPH            56630023
566400         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           56640023
566500                                    TO DP013-MESSAGE-TEXT(1)      56650023
566600         MOVE ASC-SEL-TERM-ID-IN   TO PV-SEL-TERM-ID              56660023
566700         MOVE ASC-SEL-TASK-NUMBER-IN  TO PV-SEL-TASK-NUMBER       56670023
566800         MOVE ASC-SEL-SEQ-IN       TO PV-SEL-SEQ                  56680023
566900         STRING ' QUEUE IN TERM ID-'     DELIMITED BY SIZE        56690023
567000                 PV-SEL-TERM-ID       DELIMITED BY SIZE           56700023
567100                ' QUEUE TASK-'        DELIMITED BY SIZE           56710023
567200                 PV-SEL-TASK-NUMBER   DELIMITED BY SIZE           56720023
567300                ' QUEUE SEQ-'         DELIMITED BY SIZE           56730023
567400                 PV-SEL-SEQ           DELIMITED BY SIZE           56740023
567500                                 INTO  DP013-MESSAGE-TEXT(2)      56750023
567600         MOVE ASC-SEL-TERM-ID      TO PV-SEL-TERM-ID              56760023
567700         MOVE ASC-SEL-TASK-NUMBER  TO PV-SEL-TASK-NUMBER          56770023
567800         MOVE ASC-SEL-SEQ          TO PV-SEL-SEQ                  56780023
567900         STRING ' QUEUE OT TERM ID-'     DELIMITED BY SIZE        56790023
568000                 PV-SEL-TERM-ID       DELIMITED BY SIZE           56800023
568100                ' QUEUE TASK-'        DELIMITED BY SIZE           56810023
568200                 PV-SEL-TASK-NUMBER   DELIMITED BY SIZE           56820023
568300                ' QUEUE SEQ-'         DELIMITED BY SIZE           56830023
568400                 PV-SEL-SEQ           DELIMITED BY SIZE           56840023
568500                                 INTO  DP013-MESSAGE-TEXT(3)      56850023
568600         PERFORM DP013-0000-PROCESS-ABEND                         56860023
568700     END-IF.                                                      56870023
568800                                                                  56880023
568900*----------------------------------------------------------------*56890023
569000*    CALCULATE THE TEMP QUEUE ITEM THAT MUST BE READ AND READ IT.*56900023
569100*    REWRITE THE CURRENT TEMP QUEUE ITEM IF NECESSARY.  CALCULATE*56910023
569200*    THE LINE ITEM OCCURENCE AND UPDATE (DESELECT) IT.           *56920023
569300*----------------------------------------------------------------*56930023
569400 6210-PROCESS-ITEMS.                                              56940023
569500                                                                  56950023
569600     COMPUTE PV-ITEM = 1                                          56960023
569700                     + ((RC801-ITEM (RC801-IDX) - 1)              56970023
569800                     / PC-ITEMS-PER-PANEL).                       56980023
569900                                                                  56990023
570000     IF PV-ITEM NOT EQUAL PV-SAVE-ITEM                            57000023
570100         IF PV-SAVE-ITEM NOT EQUAL ZERO                           57010023
570200             PERFORM 6211-WRITE-LIST-QUEUE                        57020023
570300         END-IF                                                   57030023
570400                                                                  57040023
570500         MOVE PV-ITEM TO PV-SAVE-ITEM                             57050023
570600                                                                  57060023
570700         PERFORM 6212-READ-LIST-QUEUE                             57070023
570800         IF PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                57080023
570900             CONTINUE                                             57090023
571000         END-IF                                                   57100023
571100     END-IF.                                                      57110023
571200                                                                  57120023
571300     COMPUTE PV-SUB = (RC801-ITEM (RC801-IDX)                     57130023
571400                    - LQW-LIST-ITEM-NUMBER (1)) + 1.              57140023
571500                                                                  57150023
571600     SET LQW-DESELECT (PV-SUB)     TO TRUE.                       57160023
571700     MOVE LQW-SELECTED-SW (PV-SUB) TO LQW-TEMP-SELECTED-SW        57170023
571800                                     (PV-SUB).                    57180023
571900                                                                  57190023
572000     MOVE ASC-KEY-PO-NBR           TO DK-ORD-NBR.                 57200023
572100     MOVE ASC-KEY-RCVR-NBR         TO DK-RCVR-NBR.                57210023
572200     MOVE LQW-PO-LINE(PV-SUB)      TO DK-LINE-NBR.                57220023
572300                                                                  57230023
572400***  PERFORM 7300-SUM-TDISTDT.                                    57240023
572500***  IF ASC-PKGNG-CDE = 'I' OR 'M'                                57250023
572600***      MOVE ASC-PROCESS-QTY (ASC-BLK-SUB ASC-ITEM-SUB)          57260023
572700***        TO LQW-PROCESS-QTY (PV-SUB)                            57270023
572800***  ELSE                                                         57280023
572900***      MOVE DISTDT-FCSE-ACTL-UNT-QTY                            57290023
573000***        TO LQW-PROCESS-QTY (PV-SUB)                            57300023
573100***  END-IF.                                                      57310023
573200                                                                  57320023
573300     EVALUATE TRUE                                                57330023
573400       WHEN RC801-INQ (RC801-IDX)                                 57340023
573500           MOVE PC-INQ TO LQW-ACTION (PV-SUB)                     57350023
573600                                                                  57360023
573700       WHEN RC801-UPD (RC801-IDX)                                 57370023
573800           MOVE PC-UPD TO LQW-ACTION (PV-SUB)                     57380023
573900                                                                  57390023
574000       WHEN RC801-DEL (RC801-IDX)                                 57400023
574100           MOVE PC-DEL TO LQW-ACTION (PV-SUB)                     57410023
574200                                                                  57420023
574300       WHEN RC801-ERR (RC801-IDX)                                 57430023
574400           MOVE PC-ERR TO LQW-ACTION (PV-SUB)                     57440023
574500     END-EVALUATE.                                                57450023
574600                                                                  57460023
574700     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                57470023
574800                                                                  57480023
574900*----------------------------------------------------------------*57490023
575000*    WRITE THE TS QUEUE RECORD JUST UPDATED IN C600.             *57500023
575100*----------------------------------------------------------------*57510023
575200 6211-WRITE-LIST-QUEUE.                                           57520023
575300                                                                  57530023
575400     EXEC CICS                                                    57540023
575500         WRITEQ TS                                                57550023
575600             QUEUE (ASC-LIST-QUEUE-NAME)                          57560023
575700             FROM  (LQW-LIST-QUEUE-WORK-AREA)                     57570023
575800             ITEM  (PV-SAVE-ITEM)                                 57580023
575900             REWRITE                                              57590023
576000             RESP  (PV-CICS-RESP)                                 57600023
576100     END-EXEC.                                                    57610023
576200                                                                  57620023
576300     IF PV-CICS-RESP = DFHRESP (NORMAL)                           57630023
576400         CONTINUE                                                 57640023
576500     ELSE                                                         57650023
576600         SET DP013-CICS-ABEND      TO TRUE                        57660023
576700         SET DP013-NO-ROLLBACK     TO TRUE                        57670023
576800         MOVE '6211-WRITE-LIST-QUEUE'                             57680023
576900                                   TO DP013-PARAGRAPH             57690023
577000         MOVE 'ATTEMPTING TO REWRITE LIST QUEUE'                  57700023
577100                                   TO DP013-MESSAGE-TEXT(1)       57710023
577200         PERFORM DP013-0000-PROCESS-ABEND                         57720023
577300     END-IF.                                                      57730023
577400                                                                  57740023
577500*----------------------------------------------------------------*57750023
577600*    READ THE TEMPORARY STORAGE QUEUE INTO A TEMPORARY WORK AREA.*57760023
577700*----------------------------------------------------------------*57770023
577800 6212-READ-LIST-QUEUE.                                            57780023
577900                                                                  57790023
578000     EXEC CICS                                                    57800023
578100         READQ TS                                                 57810023
578200         QUEUE (ASC-LIST-QUEUE-NAME)                              57820023
578300          INTO (LQW-LIST-QUEUE-WORK-AREA)                         57830023
578400          ITEM (PV-ITEM)                                          57840023
578500          RESP (PV-CICS-RESP)                                     57850023
578600     END-EXEC.                                                    57860023
578700                                                                  57870023
578800     IF PV-CICS-RESP = DFHRESP (NORMAL)                           57880023
578900         CONTINUE                                                 57890023
579000     ELSE                                                         57900023
579100         SET DP013-CICS-ABEND      TO TRUE                        57910023
579200         SET DP013-NO-ROLLBACK     TO TRUE                        57920023
579300         MOVE '6212-READ-LIST-QUEUE'                              57930023
579400                                   TO DP013-PARAGRAPH             57940023
579500         MOVE 'ATTEMPTING TO READQ LIST QUEUE'                    57950023
579600                                   TO DP013-MESSAGE-TEXT(1)       57960023
579700         PERFORM DP013-0000-PROCESS-ABEND                         57970023
579800     END-IF.                                                      57980023
579900                                                                  57990023
580000*----------------------------------------------------------------*58000023
580100/                                                                 58010023
580200 7000-GET-DEPT.                                                   58020023
580300                                                                  58030023
580400     EXEC SQL                                                     58040023
580500     SELECT                                                       58050023
580600         DEPT_NBR                                                 58060023
580700     INTO                                                         58070023
580800         :PURCHS-DEPT-NBR                                         58080023
580900     FROM                                                         58090023
581000         TPURCHS A                                                58100023
581100     WHERE                                                        58110023
581200         A.PO_NBR = :DK-ORD-NBR                                   58120023
581300     AND                                                          58130023
581400         A.VER_STATUS_CDE = 'A'                                   58140023
581500     END-EXEC.                                                    58150023
581600                                                                  58160023
581700     EVALUATE TRUE                                                58170023
581800         WHEN SQLCODE = ZERO                                      58180023
581900         WHEN SQLCODE = +100                                      58190023
582000              CONTINUE                                            58200023
582100         WHEN SQLCODE = -904                                      58210023
582200         WHEN SQLCODE = -911                                      58220023
582300         WHEN SQLCODE = -913                                      58230023
582400              MOVE '7000-GET-DEPT'                                58240023
582500                                   TO DP013-PARAGRAPH             58250023
582600             MOVE SQLCODE            TO PC-DISPLAY-SQL-CODE       58260023
582700             PERFORM 9900-SOFT-ABORT                              58270023
582800                                                                  58280023
582900         WHEN SQLWARN0 NOT = SPACE                                58290023
583000         WHEN SQLCODE < ZERO                                      58300023
583100         WHEN SQLCODE > ZERO                                      58310023
583200              MOVE '7000-GET-DEPT'                                58320023
583300                                   TO DP013-PARAGRAPH             58330023
583400              MOVE 'SELECT DEPT NUMBER'                           58340023
583500                                   TO DP013-MESSAGE-TEXT (1)      58350023
583600              MOVE SQLCA           TO DP013-SQLCA                 58360023
583700              MOVE 'TPURCHS'       TO DP013-DB2-TABLE-NAME (1)    58370023
583800              SET DP013-DB2-ABEND  TO TRUE                        58380023
583900              PERFORM DP013-0000-PROCESS-ABEND                    58390023
584000     END-EVALUATE.                                                58400023
584100                                                                  58410023
584200                                                                  58420023
584300*----------------------------------------------------------------*58430023
584400* NUMERIC EDIT TO CONVERT DEPT TO NUMERIC                        *58440023
584500*----------------------------------------------------------------*58450023
584600 7005-NUM-EDIT.                                                   58460023
584700     IF  PURCHS-DEPT-NBR >  SPACES                                58470023
584800         MOVE PURCHS-DEPT-NBR           TO DP010I-UNEDITED-FIELD  58480023
584900         MOVE LENGTH OF PURCHS-DEPT-NBR TO DP010I-MAXIMUM-DIGITS  58490023
585000         MOVE ZERO                      TO DP010I-MAXIMUM-DECIMALS58500023
585100         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  58510023
585210         CALL DP010I-NUMERIC-EDIT-ROUTINE                         58521036
585220              USING DP010I-NUMERIC-EDIT-AREA                      58522036
585300         IF  DP010I-ERROR-DETECTED                                58530023
585400             MOVE  ZEROES               TO  ASC-DEPT-N            58540023
585500         ELSE                                                     58550023
585600             MOVE DP010I-NUMERIC-FIELD  TO  ASC-DEPT-N            58560023
585700         END-IF                                                   58570023
585800     ELSE                                                         58580023
585900             MOVE  ZEROES               TO  ASC-DEPT-N            58590023
586000     END-IF.                                                      58600023
586100                                                                  58610023
586200                                                                  58620023
586300*----------------------------------------------------------------*58630023
586400* GET VENDOR NAME FOR PO/RECEIVER TO DISPLAY ON SCREEN           *58640023
586500*----------------------------------------------------------------*58650023
586600 7010-GET-VENDOR-NAME.                                            58660023
586700     EXEC SQL                                                     58670023
586800         SELECT ENT_NAME_DESC                                     58680023
586900           INTO :ENTNME-ENT-NAME-DESC                             58690023
587000           FROM TPURCHS A,                                        58700023
587100                TENTNME B                                         58710023
587200          WHERE A.PO_NBR         =  :DK-ORD-NBR                   58720023
587300            AND A.VER_STATUS_CDE =  'A'                           58730023
587400            AND A.ENT_ID         =   B.ENT_ID                     58740023
587500            AND B.TYPE_CDE       =  :PC-01                        58750023
587600     END-EXEC                                                     58760023
587700                                                                  58770023
587800     EVALUATE TRUE                                                58780023
587900         WHEN SQLCODE = +0                                        58790023
588000             MOVE  ENTNME-ENT-NAME-DESC TO  PV-VENDOR-NAME        58800023
588100         WHEN SQLCODE = +100                                      58810023
588200             MOVE  SPACES          TO  PV-VENDOR-NAME             58820023
588300         WHEN SQLCODE = -904                                      58830023
588400         WHEN SQLCODE = -911                                      58840023
588500         WHEN SQLCODE = -913                                      58850023
588600             MOVE '7010-GET-VENDOR-NAME'                          58860023
588700                               TO DP013-PARAGRAPH                 58870023
588800             MOVE SQLCODE            TO PC-DISPLAY-SQL-CODE       58880023
588900             PERFORM 9900-SOFT-ABORT                              58890023
589000                                                                  58900023
589100         WHEN SQLWARN0 NOT = SPACES                               58910023
589200         WHEN SQLCODE < ZERO                                      58920023
589300         WHEN SQLCODE > ZERO                                      58930023
589400             MOVE '7010-GET-VENDOR-NAME'                          58940023
589500                               TO DP013-PARAGRAPH                 58950023
589600             MOVE 'GET VENDOR NAME FOR PO/RECEIVER '              58960023
589700                               TO DP013-MESSAGE-TEXT (1)          58970023
589800             MOVE SQLCA        TO DP013-SQLCA                     58980023
589900             MOVE 'TPURCHS'    TO DP013-DB2-TABLE-NAME (1)        58990023
590000             SET DP013-DB2-ABEND                                  59000023
590100                 DP013-XCTL-DISPLAY-RESTART                       59010023
590200                               TO TRUE                            59020023
590300             PERFORM DP013-0000-PROCESS-ABEND                     59030023
590400     END-EVALUATE.                                                59040023
590500                                                                  59050023
590600                                                                  59060023
590700 7150-GET-ZONE-DESC.                                              59070023
590800                                                                  59080023
590900     EXEC SQL                                                     59090023
591000     SELECT C.STR_ZN_ID                                           59100023
591100     INTO   :MDSEDP-STR-ZN-ID                                     59110023
591200     FROM   TPURCHS A,                                            59120023
591300            TMDSEAR B,                                            59130023
591400            TMDSEDP C                                             59140023
591500     WHERE  A.PO_NBR                  = :DK-ORD-NBR               59150023
591600       AND  A.VER_STATUS_CDE          = 'A'                       59160023
591700       AND  A.DEPT_NBR                = B.DEPT_NBR                59170023
591800       AND  B.MDSELV_CDE              = 'DPT'                     59180023
591900       AND  B.OPERCO_NBR              = '03'                      59190023
592000       AND (B.STRT_DTE               <= CURRENT DATE AND          59200023
592100                 B.END_DTE            > CURRENT DATE)             59210023
592200       AND  B.MDSEAR_DKEY             = C.MDSEAR_DKEY             59220023
592300     END-EXEC                                                     59230023
592400                                                                  59240023
592500     EVALUATE TRUE                                                59250023
592600         WHEN SQLCODE = ZERO                                      59260023
592700         WHEN SQLCODE = +100                                      59270023
592800             CONTINUE                                             59280023
592900         WHEN SQLCODE = -904                                      59290023
593000         WHEN SQLCODE = -911                                      59300023
593100         WHEN SQLCODE = -913                                      59310023
593200             MOVE '7150-GET-ZONE-DESC'                            59320023
593300                                  TO DP013-PARAGRAPH              59330023
593400             MOVE SQLCODE            TO PC-DISPLAY-SQL-CODE       59340023
593500             PERFORM 9900-SOFT-ABORT                              59350023
593600                                                                  59360023
593700         WHEN SQLWARN0 NOT = SPACES                               59370023
593800         WHEN SQLCODE < ZERO                                      59380023
593900         WHEN SQLCODE > ZERO                                      59390023
594000             MOVE '7150-GET-ZONE-DESC'                            59400023
594100                                  TO DP013-PARAGRAPH              59410023
594200             MOVE 'UNSUCCESSFUL SELECT OF ZONE DESC'              59420023
594300                                  TO DP013-MESSAGE-TEXT (1)       59430023
594400             MOVE SQLCA      TO DP013-SQLCA                       59440023
594500             MOVE 'TPURCHS ' TO DP013-DB2-TABLE-NAME (1)          59450023
594600             MOVE 'TMDSEAR ' TO DP013-DB2-TABLE-NAME (2)          59460023
594700             MOVE 'TMDSEDP ' TO DP013-DB2-TABLE-NAME (3)          59470023
594800             SET DP013-DB2-ABEND                                  59480023
594900                 DP013-NO-ROLLBACK                                59490023
595000                                  TO TRUE                         59500023
595100             PERFORM DP013-0000-PROCESS-ABEND                     59510023
595200     END-EVALUATE.                                                59520023
595300/                                                                 59530023
595400 7200-GET-RCVR-STATUS.                                            59540023
595500                                                                  59550023
595600     EXEC SQL                                                     59560023
595700     SELECT  STATUS_CDE                                           59570023
595800            ,REC_TMST                                             59580023
595900            ,PKGNG_CDE                                            59590023
596000            ,CURR_OPER_UNT_ID                                     59600023
596100       INTO :RECEIV-STATUS-CDE                                    59610023
596200           ,:RECEIV-REC-TMST                                      59620023
596300           ,:RECEIV-PKGNG-CDE                                     59630023
596400           ,:RECEIV-CURR-OPER-UNT-ID                              59640023
596500       FROM  TRECEIV A                                            59650023
596600      WHERE  A.ORD_NBR = :DK-ORD-NBR                              59660023
596700        AND  A.REC_SEQ_NBR = :DK-RCVR-NBR                         59670023
596800        AND  A.VER_STATUS_CDE = 'A'                               59680023
596900     END-EXEC.                                                    59690023
597000                                                                  59700023
597100     EVALUATE TRUE                                                59710023
597200                                                                  59720023
597300         WHEN SQLCODE = ZERO                                      59730023
597400                                                                  59740023
597500              SET PS-PO-RCVR-FOUND      TO  TRUE                  59750023
597600              MOVE RECEIV-PKGNG-CDE     TO ASC-PKGNG-CDE          59760023
597700                                           ASC-PKGNG-CDE-DISPLAY  59770023
597800* 10/06       IF  RECEIV-REC-TMST  =  PC-DEFAULT-TMST             59780023
597900* 10/06           SET DP020-NEXT-ACT-APPL-ERROR                   59790023
598000* 10/06           SET DP020-MSG-FATAL                             59800023
598100* 10/06               PS-ERROR            TO TRUE                 59810023
598200* 10/06           MOVE PC-TSYMSG-01730  TO DP020-MSG-NUMBER       59820023
598300* 10/06       END-IF                                              59830023
598400                                                                  59840023
598500         WHEN SQLCODE = +100                                      59850023
598600                                                                  59860023
598700              SET  PS-PO-RCVR-NOT-FOUND                           59870023
598800                   DP020-NEXT-ACT-APPL-ERROR                      59880023
598900                   DP020-MSG-FATAL                                59890023
599000                   PS-ERROR              TO TRUE                  59900023
599100              MOVE PC-TSYMSG-01298  TO DP020-MSG-NUMBER           59910023
599200                                                                  59920023
599300         WHEN SQLCODE = -904                                      59930023
599400         WHEN SQLCODE = -911                                      59940023
599500         WHEN SQLCODE = -913                                      59950023
599600              MOVE '7200-GET-RCVR-STATUS'                         59960023
599700                                   TO DP013-PARAGRAPH             59970023
599800             MOVE SQLCODE            TO PC-DISPLAY-SQL-CODE       59980023
599900             PERFORM 9900-SOFT-ABORT                              59990023
600000                                                                  60000023
600100         WHEN SQLWARN0 NOT = SPACE                                60010023
600200         WHEN SQLCODE < ZERO                                      60020023
600300         WHEN SQLCODE > ZERO                                      60030023
600400              MOVE '7200-GET-RCVR-STATUS'                         60040023
600500                                   TO DP013-PARAGRAPH             60050023
600600              MOVE 'SELECT RCVR STATUS'                           60060023
600700                                   TO DP013-MESSAGE-TEXT (1)      60070023
600800              MOVE SQLCA           TO DP013-SQLCA                 60080023
600900              MOVE 'TRECEIV'       TO DP013-DB2-TABLE-NAME (1)    60090023
601000              SET DP013-DB2-ABEND  TO TRUE                        60100023
601100              PERFORM DP013-0000-PROCESS-ABEND                    60110023
601200     END-EVALUATE.                                                60120023
601300/                                                                 60130023
601400*----------------------------------------------------------------*60140023
601500* INCLUDED FETCH TO ITEM_NBR.                     WR # 21361     *60150023
601600* IF THE SQL STATEMENT IS SUCCESSFUL, THEN SET PS-CALL-API-YES   *60160023
601700* TO TRUE.                                                       *60170023
601800*----------------------------------------------------------------*60180023
601900 7250-GET-SKU.                                                    60190023
602000                                                                  60200023
602100     EXEC SQL                                                     60210023
602200     SELECT B.CL_NBR                                              60220023
602300     ,      B.SKU_SEQ_NBR                                         60230023
602400     ,      B.ITM_NBR                                             60240023
602500     ,      A.STATUS_CDE                                          60250023
602600         INTO :PURITM-CL-NBR                                      60260023
602700         ,    :PURITM-SKU-SEQ-NBR                                 60270023
602800         ,    :PURITM-ITM-NBR                                     60280023
602900         ,    :RECITM-STATUS-CDE                                  60290023
603000         FROM                                                     60300023
603100             TRECITM A                                            60310023
603200         ,   TPURITM B                                            60320023
603300         WHERE A.ORD_NBR          = :DK-ORD-NBR                   60330023
603400         AND   A.ORD_NBR          = B.PO_NBR                      60340023
603500         AND A.REC_SEQ_NBR        = :DK-RCVR-NBR                  60350023
603600         AND A.ORD_LNE_NBR        = :DK-LINE-NBR                  60360023
603700         AND A.ORD_LNE_NBR        = B.APP_PO_LNE_NBR              60370023
603800         AND A.VER_STATUS_CDE     = 'A'                           60380023
603900         AND A.PO_VER_NBR         = B.VER_NBR                     60390023
604000     END-EXEC.                                                    60400023
604100                                                                  60410023
604200     EVALUATE TRUE                                                60420023
604300         WHEN SQLCODE = ZERO                                      60430023
604400             SET PS-CALL-API-YES TO TRUE                          60440023
604500             IF RECITM-STATUS-CDE = 'VE'                          60450023
604600                SET PS-PACK-LNE-VERIFIED-YES TO TRUE              60460023
604700             ELSE                                                 60470023
604800                SET PS-PACK-LNE-VERIFIED-NO  TO TRUE              60480023
604900             END-IF                                               60490023
605000         WHEN SQLCODE = +100                                      60500023
605100         WHEN SQLCODE = -305                                      60510023
605200                SET PS-PACK-LNE-VERIFIED-NO  TO TRUE              60520023
605300         WHEN SQLCODE = -904                                      60530023
605400         WHEN SQLCODE = -911                                      60540023
605500         WHEN SQLCODE = -913                                      60550023
605600             MOVE '7250-GET-SKU'                                  60560023
605700                                  TO DP013-PARAGRAPH              60570023
605800             MOVE SQLCODE            TO PC-DISPLAY-SQL-CODE       60580023
605900             PERFORM 9900-SOFT-ABORT                              60590023
606000                                                                  60600023
606100         WHEN SQLWARN0 NOT = SPACES                               60610023
606200         WHEN SQLCODE < ZERO                                      60620023
606300         WHEN SQLCODE > ZERO                                      60630023
606400             MOVE '7250-GET-SKU'                                  60640023
606500                                  TO DP013-PARAGRAPH              60650023
606600             MOVE 'UNSUCCESSFUL COUNT OF VERIFIED LINES'          60660023
606700                                  TO DP013-MESSAGE-TEXT (1)       60670023
606800             MOVE SQLCA      TO DP013-SQLCA                       60680023
606900             MOVE 'TRECITM ' TO DP013-DB2-TABLE-NAME (1)          60690023
607000             SET DP013-DB2-ABEND                                  60700023
607100                 DP013-NO-ROLLBACK                                60710023
607200                                  TO TRUE                         60720023
607300             PERFORM DP013-0000-PROCESS-ABEND                     60730023
607400     END-EVALUATE.                                                60740023
607500*----------------------------------------------------------------*60750023
607600* CHANGES MADE FOR WR # 21361 ENDS HERE.                         *60760023
607700*----------------------------------------------------------------*60770023
607800/                                                                 60780023
607900 7300-SUM-TDISTDT.                                                60790023
608000                                                                  60800023
608100      EXEC SQL                                                    60810023
608200         SELECT                                                   60820023
608300             SUM(P2L_SPLT_UNT_QTY)                                60830023
608400           , SUM(ACTL_ALLOC_QTY)                                  60840023
608500           , SUM(FCSE_SPLT_UNT_QTY)                               60850023
608600           , SUM(INPK_SPLT_UNT_QTY)                               60860023
608700           , SUM(FCSE_ACTL_UNT_QTY)                               60870023
608800           , SUM(PREPK_ODD_UNT_QTY)                               60880023
608900           INTO                                                   60890023
609000             :DISTDT-P2L-SPLT-UNT-QTY                             60900023
609100           , :DISTDT-ACTL-ALLOC-QTY                               60910023
609200           , :DISTDT-FCSE-SPLT-UNT-QTY                            60920023
609300           , :DISTDT-INPK-SPLT-UNT-QTY                            60930023
609400           , :DISTDT-FCSE-ACTL-UNT-QTY                            60940023
609500           , :DISTDT-PREPK-ODD-UNT-QTY                            60950023
609600           FROM TDISTDT                                           60960023
609700           WHERE ORD_NBR    = :DK-ORD-NBR                         60970023
609800           AND RCVR_SEQ_NBR = :DK-RCVR-NBR                        60980023
609900           AND ORD_LNE_NBR  = :DK-LINE-NBR                        60990023
610000      END-EXEC.                                                   61000023
610100                                                                  61010023
610200      EVALUATE TRUE                                               61020023
610300           WHEN SQLCODE = ZERO                                    61030023
610400               CONTINUE                                           61040023
610500           WHEN SQLCODE = -305                                    61050023
610600               MOVE ZERO        TO DISTDT-P2L-SPLT-UNT-QTY        61060023
610700                                   DISTDT-FCSE-SPLT-UNT-QTY       61070023
610800                                   DISTDT-INPK-SPLT-UNT-QTY       61080023
610900         WHEN SQLCODE = -904                                      61090023
611000         WHEN SQLCODE = -911                                      61100023
611100         WHEN SQLCODE = -913                                      61110023
611200             MOVE '7300-SUM-TDISTDT'                              61120023
611300                                  TO DP013-PARAGRAPH              61130023
611400             MOVE SQLCODE            TO PC-DISPLAY-SQL-CODE       61140023
611500             PERFORM 9900-SOFT-ABORT                              61150023
611600                                                                  61160023
611700         WHEN SQLWARN0 NOT = SPACES                               61170023
611800         WHEN SQLCODE < ZERO                                      61180023
611900         WHEN SQLCODE > ZERO                                      61190023
612000             MOVE '7300-SUM-TDISTDT'                              61200023
612100                                  TO DP013-PARAGRAPH              61210023
612200             MOVE 'UNSUCCESSFUL COUNT OF VERIFIED LINES'          61220023
612300                                  TO DP013-MESSAGE-TEXT (1)       61230023
612400             MOVE SQLCA      TO DP013-SQLCA                       61240023
612500             MOVE 'TDISTDT ' TO DP013-DB2-TABLE-NAME (1)          61250023
612600             SET DP013-DB2-ABEND                                  61260023
612700                 DP013-NO-ROLLBACK                                61270023
612800                                  TO TRUE                         61280023
612900             PERFORM DP013-0000-PROCESS-ABEND                     61290023
613000     END-EVALUATE.                                                61300023
613100                                                                  61310023
613200                                                                  61320023
613300 7345-GET-TRECITM.                                                61330023
613400     EXEC SQL                                                     61340023
613500          SELECT  PREPK_ID                                        61350023
613600                 ,STATUS_CDE                                      61360023
613700            INTO :RECITM-PREPK-ID                                 61370023
613800                ,:RECITM-STATUS-CDE                               61380023
613900            FROM  TRECITM                                         61390023
614000           WHERE  ORD_NBR          =  :DK-ORD-NBR                 61400023
614100           AND    REC_SEQ_NBR      =  :DK-RCVR-NBR                61410023
614200           AND    ORD_LNE_NBR      =  :DK-LINE-NBR                61420023
614300***        AND    OPER_UNT_ID      =  :DK-OPER-UNT-ID             61430023
614400***        AND    FCLTY_ID         =  :DK-FCLTY-ID                61440023
614500           AND    VER_STATUS_CDE   =  'A'                         61450023
614600     END-EXEC                                                     61460023
614700                                                                  61470023
614800     EVALUATE TRUE                                                61480023
614900         WHEN SQLCODE = ZERO                                      61490023
615000              CONTINUE                                            61500023
615100         WHEN SQLCODE = +100                                      61510023
615200              MOVE +0 TO RECITM-PREPK-ID                          61520023
615300         WHEN SQLCODE = -904                                      61530023
615400         WHEN SQLCODE = -911                                      61540023
615500         WHEN SQLCODE = -913                                      61550023
615600             MOVE '7345-GET-TRECITM'                              61560023
615700                                  TO DP013-PARAGRAPH              61570023
615800             MOVE SQLCODE            TO PC-DISPLAY-SQL-CODE       61580023
615900             PERFORM 9900-SOFT-ABORT                              61590023
616000                                                                  61600023
616100         WHEN SQLWARN0 NOT = SPACES                               61610023
616200         WHEN SQLCODE < ZERO                                      61620023
616300         WHEN SQLCODE > ZERO                                      61630023
616400             MOVE '7345-GET-TRECITM'                              61640023
616500                                  TO DP013-PARAGRAPH              61650023
616600             MOVE 'UNSUCCESSFUL SELECT FOR PREPK-ID  '            61660023
616700                                  TO DP013-MESSAGE-TEXT (1)       61670023
616800             MOVE SQLCA      TO DP013-SQLCA                       61680023
616900             MOVE 'TRECITM ' TO DP013-DB2-TABLE-NAME (1)          61690023
617000             SET DP013-DB2-ABEND                                  61700023
617100                  DP013-NO-ROLLBACK                               61710023
617200                                  TO TRUE                         61720023
617300             PERFORM DP013-0000-PROCESS-ABEND                     61730023
617400     END-EVALUATE.                                                61740023
617500                                                                  61750023
617600                                                                  61760023
617700 7350-CHECK-LINE-TROUBLE.                                         61770023
617800                                                                  61780023
617900     MOVE ZERO TO PV-TRBL-LINE-COUNT.                             61790023
618000                                                                  61800023
618100     EXEC SQL                                                     61810023
618200          SELECT  COUNT (*)                                       61820023
618300            INTO :PV-TRBL-LINE-COUNT                              61830023
618400            FROM  TTRBNTF A                                       61840023
618500                 ,TTRBRSN B                                       61850023
618600           WHERE  A.PO_NBR          =   :DK-ORD-NBR               61860023
618700           AND    A.REC_SEQ_NBR     =   :DK-RCVR-NBR              61870023
618800           AND  ((A.PO_LNE_NBR      =   :DK-LINE-NBR              61880023
618900           AND    B.TRBL_LVL_IND     <> :PC-M)                    61890023
619000           OR    (A.PREPK_ID        =   :RECITM-PREPK-ID          61900023
619100           AND    B.TRBL_LVL_IND     =  :PC-M))                   61910023
619200           AND    A.RESOLVED_IND    IN ('N', 'I', 'R')            61920023
619300           AND    A.TRBL_RSN_CDE    =    B.TRBL_RSN_CDE           61930023
619400           AND    B.NOTIF_IND       =   'T'                       61940023
619500     END-EXEC.                                                    61950023
619600                                                                  61960023
619700     EVALUATE TRUE                                                61970023
619800         WHEN SQLCODE = ZERO                                      61980023
619900         WHEN SQLCODE = +100                                      61990023
620000         WHEN SQLCODE = -811                                      62000023
620100              CONTINUE                                            62010023
620200         WHEN SQLCODE = -904                                      62020023
620300         WHEN SQLCODE = -911                                      62030023
620400         WHEN SQLCODE = -913                                      62040023
620500             MOVE '7350-CHECK-LINE-TROUBLE'                       62050023
620600                                  TO DP013-PARAGRAPH              62060023
620700             MOVE SQLCODE            TO PC-DISPLAY-SQL-CODE       62070023
620800             PERFORM 9900-SOFT-ABORT                              62080023
620900                                                                  62090023
621000         WHEN SQLWARN0 NOT = SPACES                               62100023
621100         WHEN SQLCODE < ZERO                                      62110023
621200         WHEN SQLCODE > ZERO                                      62120023
621300             MOVE '7350-CHECK-LINE-TROUBLE'                       62130023
621400                                  TO DP013-PARAGRAPH              62140023
621500             MOVE 'UNSUCCESSFUL COUNT OF TTRBNTF ROWS'            62150023
621600                                  TO DP013-MESSAGE-TEXT (1)       62160023
621700             MOVE SQLCA      TO DP013-SQLCA                       62170023
621800             MOVE 'TTRBNTF ' TO DP013-DB2-TABLE-NAME (1)          62180023
621900             SET DP013-DB2-ABEND                                  62190023
622000                  DP013-NO-ROLLBACK                               62200023
622100                                  TO TRUE                         62210023
622200             PERFORM DP013-0000-PROCESS-ABEND                     62220023
622300     END-EVALUATE.                                                62230023
622400/                                                                 62240023
622500 7400-OPEN-INVPAR-CSR.                                            62250023
622600                                                                  62260023
622700     EXEC SQL                                                     62270023
622800         OPEN INVPAR-CSR                                          62280023
622900     END-EXEC                                                     62290023
623000                                                                  62300023
623100     EVALUATE TRUE                                                62310023
623200         WHEN SQLCODE = ZERO                                      62320023
623300              CONTINUE                                            62330023
623400         WHEN SQLCODE = -904                                      62340023
623500         WHEN SQLCODE = -911                                      62350023
623600         WHEN SQLCODE = -913                                      62360023
623700             MOVE '7400-OPEN-INVPAR-CSR'                          62370023
623800                                   TO DP013-PARAGRAPH             62380023
623900             MOVE SQLCODE            TO PC-DISPLAY-SQL-CODE       62390023
624000             PERFORM 9900-SOFT-ABORT                              62400023
624100         WHEN SQLWARN0 NOT = SPACE                                62410023
624200         WHEN SQLCODE  NOT = ZERO                                 62420023
624300             MOVE '7400-OPEN-INVPAR-CSR'                          62430023
624400                                   TO DP013-PARAGRAPH             62440023
624500             MOVE 'OPEN INVPAR-CSR CURSOR'                        62450023
624600                                   TO DP013-MESSAGE-TEXT (1)      62460023
624700             MOVE SQLCA       TO DP013-SQLCA                      62470023
624800             MOVE 'XLT_MDSE_INV_PARM' TO DP013-DB2-TABLE-NAME (1) 62480023
624900             SET DP013-DB2-ABEND                                  62490023
625000                                   TO TRUE                        62500023
625100             PERFORM DP013-0000-PROCESS-ABEND                     62510023
625200     END-EVALUATE.                                                62520023
625300                                                                  62530023
625400 7401-FETCH-INVPAR-CSR.                                           62540023
625500     EXEC SQL                                                     62550023
625600         FETCH INVPAR-CSR                                         62560023
625700          INTO                                                    62570023
625800                 :XLT00025-LOC-NBR                                62580023
625900     END-EXEC.                                                    62590023
626000                                                                  62600023
626100     EVALUATE TRUE                                                62610023
626200         WHEN SQLCODE = ZERO                                      62620023
626300              CONTINUE                                            62630023
626400         WHEN SQLCODE = +100                                      62640023
626500              SET PS-EOF-INVPAR-CSR                               62650023
626600                                   TO TRUE                        62660023
626700         WHEN SQLCODE = -904                                      62670023
626800         WHEN SQLCODE = -911                                      62680023
626900         WHEN SQLCODE = -913                                      62690023
627000             MOVE '7401-FETCH-INVPAR-CSR' TO DP013-PARAGRAPH      62700023
627100             MOVE SQLCODE            TO PC-DISPLAY-SQL-CODE       62710023
627200             PERFORM 9900-SOFT-ABORT                              62720023
627300                                                                  62730023
627400         WHEN SQLWARN0 NOT = SPACE                                62740023
627500         WHEN SQLCODE < ZERO                                      62750023
627600         WHEN SQLCODE > ZERO                                      62760023
627700              MOVE '7401-FETCH-INVPAR-CSR' TO DP013-PARAGRAPH     62770023
627800              MOVE 'FETCH INVPAR CURSOR'                          62780023
627900                                      TO DP013-MESSAGE-TEXT (1)   62790023
628000              MOVE SQLCA              TO DP013-SQLCA              62800023
628100              MOVE 'XLT_MDSE_INV_PARM' TO DP013-DB2-TABLE-NAME (1)62810023
628200              SET DP013-DB2-ABEND     TO TRUE                     62820023
628300              PERFORM DP013-0000-PROCESS-ABEND                    62830023
628400     END-EVALUATE.                                                62840023
628500                                                                  62850023
628600 7402-CLOSE-INVPAR-CSR.                                           62860023
628700     EXEC SQL                                                     62870023
628800         CLOSE INVPAR-CSR                                         62880023
628900     END-EXEC                                                     62890023
629000                                                                  62900023
629100     EVALUATE TRUE                                                62910023
629200         WHEN SQLCODE = ZERO                                      62920023
629300              CONTINUE                                            62930023
629400         WHEN SQLCODE = -904                                      62940023
629500         WHEN SQLCODE = -911                                      62950023
629600         WHEN SQLCODE = -913                                      62960023
629700             MOVE '7402-CLOSE-INVPAR-CSR'                         62970023
629800                                   TO DP013-PARAGRAPH             62980023
629900             MOVE SQLCODE            TO PC-DISPLAY-SQL-CODE       62990023
630000             PERFORM 9900-SOFT-ABORT                              63000023
630100         WHEN SQLWARN0 NOT = SPACE                                63010023
630200         WHEN SQLCODE  NOT = ZERO                                 63020023
630300             MOVE '7402-CLOSE-INVPAR-CSR'                         63030023
630400                                   TO DP013-PARAGRAPH             63040023
630500             MOVE 'CLOSE INVPAR-CSR CURSOR'                       63050023
630600                                   TO DP013-MESSAGE-TEXT (1)      63060023
630700             MOVE SQLCA       TO DP013-SQLCA                      63070023
630800             MOVE 'XLT_MDSE_INV_PARM' TO DP013-DB2-TABLE-NAME (1) 63080023
630900             SET DP013-DB2-ABEND                                  63090023
631000                                   TO TRUE                        63100023
631100             PERFORM DP013-0000-PROCESS-ABEND                     63110023
631200     END-EVALUATE.                                                63120023
631300 7410-OPEN-TDISTDT-CSR.                                           63130023
631400                                                                  63140023
631500     SET PS-NO-STORE-INVENTORY  TO TRUE.                          63150023
631600     SET PS-NOT-EOF-TDISTDT-CSR TO TRUE.                          63160023
631700     SET PS-NO-MATCH-ERROR      TO TRUE.                          63170023
631800                                                                  63180023
631900     EXEC SQL                                                     63190023
632000         OPEN TDISTDT-CSR                                         63200023
632100     END-EXEC                                                     63210023
632200                                                                  63220023
632300     EVALUATE TRUE                                                63230023
632400         WHEN SQLCODE = ZERO                                      63240023
632500              CONTINUE                                            63250023
632600         WHEN SQLCODE = -904                                      63260023
632700         WHEN SQLCODE = -911                                      63270023
632800         WHEN SQLCODE = -913                                      63280023
632900             MOVE '7410-OPEN-DISTDT-CSR'                          63290023
633000                                   TO DP013-PARAGRAPH             63300023
633100             MOVE SQLCODE            TO PC-DISPLAY-SQL-CODE       63310023
633200             PERFORM 9900-SOFT-ABORT                              63320023
633300         WHEN SQLWARN0 NOT = SPACE                                63330023
633400         WHEN SQLCODE  NOT = ZERO                                 63340023
633500             MOVE '7410-OPEN-DISTDT-CSR'                          63350023
633600                                   TO DP013-PARAGRAPH             63360023
633700             MOVE 'OPEN DISTDT-CSR CURSOR'                        63370023
633800                                   TO DP013-MESSAGE-TEXT (1)      63380023
633900             MOVE SQLCA       TO DP013-SQLCA                      63390023
634000             MOVE 'TDISTDT'   TO DP013-DB2-TABLE-NAME (1)         63400023
634100             SET DP013-DB2-ABEND                                  63410023
634200                                   TO TRUE                        63420023
634300             PERFORM DP013-0000-PROCESS-ABEND                     63430023
634400     END-EVALUATE.                                                63440023
634500                                                                  63450023
634600 7411-FETCH-TDISTDT-CSR.                                          63460023
634700     EXEC SQL                                                     63470023
634800         FETCH TDISTDT-CSR                                        63480023
634900          INTO                                                    63490023
635000             :DISTDT-STR-NBR                                      63500023
635100     END-EXEC.                                                    63510023
635200                                                                  63520023
635300     EVALUATE TRUE                                                63530023
635400         WHEN SQLCODE = ZERO                                      63540023
635500              CONTINUE                                            63550023
635600         WHEN SQLCODE = +100                                      63560023
635700              SET PS-EOF-TDISTDT-CSR                              63570023
635800                                   TO TRUE                        63580023
635900         WHEN SQLCODE = -904                                      63590023
636000         WHEN SQLCODE = -911                                      63600023
636100         WHEN SQLCODE = -913                                      63610023
636200             MOVE '7411-FETCH-DISTDT-CSR' TO DP013-PARAGRAPH      63620023
636300             MOVE SQLCODE            TO PC-DISPLAY-SQL-CODE       63630023
636400             PERFORM 9900-SOFT-ABORT                              63640023
636500                                                                  63650023
636600         WHEN SQLWARN0 NOT = SPACE                                63660023
636700         WHEN SQLCODE < ZERO                                      63670023
636800         WHEN SQLCODE > ZERO                                      63680023
636900              MOVE '7411-FETCH-DISTDT-CSR' TO DP013-PARAGRAPH     63690023
637000              MOVE 'FETCH INVPAR CURSOR'                          63700023
637100                                      TO DP013-MESSAGE-TEXT (1)   63710023
637200              MOVE SQLCA              TO DP013-SQLCA              63720023
637300              MOVE 'TDISTDT'          TO DP013-DB2-TABLE-NAME (1) 63730023
637400              SET DP013-DB2-ABEND     TO TRUE                     63740023
637500              PERFORM DP013-0000-PROCESS-ABEND                    63750023
637600     END-EVALUATE.                                                63760023
637700                                                                  63770023
637800 7412-CLOSE-TDISTDT-CSR.                                          63780023
637900     EXEC SQL                                                     63790023
638000         CLOSE TDISTDT-CSR                                        63800023
638100     END-EXEC                                                     63810023
638200                                                                  63820023
638300     EVALUATE TRUE                                                63830023
638400         WHEN SQLCODE = ZERO                                      63840023
638500              CONTINUE                                            63850023
638600         WHEN SQLCODE = -904                                      63860023
638700         WHEN SQLCODE = -911                                      63870023
638800         WHEN SQLCODE = -913                                      63880023
638900             MOVE '7412-CLOSE-DISTDT-CSR'                         63890023
639000                                   TO DP013-PARAGRAPH             63900023
639100             MOVE SQLCODE            TO PC-DISPLAY-SQL-CODE       63910023
639200             PERFORM 9900-SOFT-ABORT                              63920023
639300         WHEN SQLWARN0 NOT = SPACE                                63930023
639400         WHEN SQLCODE  NOT = ZERO                                 63940023
639500             MOVE '7412-CLOSE-DISTDT-CSR'                         63950023
639600                                   TO DP013-PARAGRAPH             63960023
639700             MOVE 'CLOSE INVPAR-CSR CURSOR'                       63970023
639800                                   TO DP013-MESSAGE-TEXT (1)      63980023
639900             MOVE SQLCA       TO DP013-SQLCA                      63990023
640000             MOVE 'TDISTDT'   TO DP013-DB2-TABLE-NAME (1)         64000023
640100             SET DP013-DB2-ABEND                                  64010023
640200                                   TO TRUE                        64020023
640300             PERFORM DP013-0000-PROCESS-ABEND                     64030023
640400     END-EVALUATE.                                                64040023
640500 7415-SELECT-TRECDIS.                                             64050023
640600     INITIALIZE PV-STORE-COUNT.                                   64060023
640700                                                                  64070023
640800     EXEC SQL                                                     64080023
640900         SELECT  ORD_NBR                                          64090023
641000           INTO  :RECDIS-ORD-NBR                                  64100023
641100           FROM  TRECDIS                                          64110023
641200          WHERE  ORD_NBR         = :DK-ORD-NBR                    64120023
641300            AND  REC_SEQ_NBR     = :DK-RCVR-NBR                   64130023
641400            AND  ORD_LNE_NBR     = :DK-LINE-NBR                   64140023
641500*           AND  OPER_UNT_ID     = :DK-OPER-UNT-ID                64150023
641600*           AND  FCLTY_ID        = :DK-FCLTY-ID                   64160023
641700            AND  STR_NBR         = :DISTDT-STR-NBR                64170023
641900     END-EXEC.                                                    64190023
642000                                                                  64200023
642100     EVALUATE TRUE                                                64210023
642200         WHEN SQLCODE = ZERO                                      64220023
642300         WHEN SQLCODE = +100                                      64230023
642400              CONTINUE                                            64240023
642500         WHEN SQLCODE = -904                                      64250023
642600         WHEN SQLCODE = -911                                      64260023
642700         WHEN SQLCODE = -913                                      64270023
642800             MOVE '7415-SELECT-TRECDIS'                           64280023
642900                                  TO DP013-PARAGRAPH              64290023
643000             MOVE SQLCODE            TO PC-DISPLAY-SQL-CODE       64300023
643100             PERFORM 9900-SOFT-ABORT                              64310023
643200                                                                  64320023
643300         WHEN SQLWARN0 NOT = SPACES                               64330023
643400         WHEN SQLCODE < ZERO                                      64340023
643500         WHEN SQLCODE > ZERO                                      64350023
643600             MOVE '7415-SELECT-TRECDIS'                           64360023
643700                                  TO DP013-PARAGRAPH              64370023
643800             MOVE 'UNSUCCESSFUL COUNT OF TRECDIS ROWS'            64380023
643900                                  TO DP013-MESSAGE-TEXT (1)       64390023
644000             MOVE SQLCA      TO DP013-SQLCA                       64400023
644100             MOVE 'TRECDIS ' TO DP013-DB2-TABLE-NAME (1)          64410023
644200             SET DP013-DB2-ABEND                                  64420023
644300                  DP013-NO-ROLLBACK                               64430023
644400                                  TO TRUE                         64440023
644500             PERFORM DP013-0000-PROCESS-ABEND                     64450023
644600     END-EVALUATE.                                                64460023
644700/                                                                 64470023
644800/                                                                 64480023
644900 7450-SELECT-TDISTHD.                                             64490023
645000                                                                  64500023
645100     INITIALIZE DCLTDISTHD                                        64510023
645200     EXEC SQL                                                     64520023
645300     SELECT FCSE_CART_CNT                                         64530023
645400        ,   RSLTS_RCVD_TMST                                       64540023
645500        ,   FCSE_CNFRMN_TMST                                      64550023
645600        ,   ORD_LNE_NBR                                           64560023
645700        ,   PRCG_STAT_CDE                                         64570023
645800        ,   P2L_CART_CNT                                          64580023
645900        ,   INPK_CART_CNT                                         64590023
646000        ,   PREPK_LNE_PRC_CDE                                     64600023
646100        ,   OPER_UNT_ID                                           64610023
646200        ,   FCSE_FCLTY_AREA_ID                                    64620023
646300        INTO :DISTHD-FCSE-CART-CNT                                64630023
646400        ,    :DISTHD-RSLTS-RCVD-TMST                              64640023
646500        ,    :DISTHD-FCSE-CNFRMN-TMST                             64650023
646600        ,    :DISTHD-ORD-LNE-NBR                                  64660023
646700        ,    :DISTHD-PRCG-STAT-CDE                                64670023
646800        ,    :DISTHD-P2L-CART-CNT                                 64680023
646900        ,    :DISTHD-INPK-CART-CNT                                64690023
647000        ,    :DISTHD-PREPK-LNE-PRC-CDE                            64700023
647100        ,    :DISTHD-OPER-UNT-ID                                  64710023
647200        ,    :DISTHD-FCSE-FCLTY-AREA-ID                           64720023
647300        FROM  TDISTHD                                             64730023
647400      WHERE ORD_NBR                  = :DK-ORD-NBR                64740023
647500        AND RCVR_SEQ_NBR             = :DK-RCVR-NBR               64750023
647600        AND ORD_LNE_NBR              = :DK-LINE-NBR               64760023
647700        WITH UR                                                   64770023
647800     END-EXEC.                                                    64780023
647900                                                                  64790023
648000     EVALUATE TRUE                                                64800023
648100         WHEN SQLCODE = ZERO                                      64810023
648200         WHEN SQLCODE = +100                                      64820023
648300              CONTINUE                                            64830023
648400         WHEN SQLCODE = -904                                      64840023
648500         WHEN SQLCODE = -911                                      64850023
648600         WHEN SQLCODE = -913                                      64860023
648700             MOVE '7450-SELECT-TDISTHD'                           64870023
648800                                  TO DP013-PARAGRAPH              64880023
648900             MOVE SQLCODE            TO PC-DISPLAY-SQL-CODE       64890023
649000             PERFORM 9900-SOFT-ABORT                              64900023
649100                                                                  64910023
649200         WHEN SQLWARN0 NOT = SPACES                               64920023
649300         WHEN SQLCODE < ZERO                                      64930023
649400         WHEN SQLCODE > ZERO                                      64940023
649500             MOVE '7450-SELECT-TDISTHD'                           64950023
649600                                  TO DP013-PARAGRAPH              64960023
649700             MOVE 'UNSUCCESSFUL SELECT TDISTHD '                  64970023
649800                                  TO DP013-MESSAGE-TEXT (1)       64980023
649900             MOVE SQLCA      TO DP013-SQLCA                       64990023
650000             MOVE 'TDISTHD ' TO DP013-DB2-TABLE-NAME (1)          65000023
650100             SET DP013-DB2-ABEND                                  65010023
650200                  DP013-NO-ROLLBACK                               65020023
650300                                  TO TRUE                         65030023
650400             PERFORM DP013-0000-PROCESS-ABEND                     65040023
650500     END-EVALUATE.                                                65050023
650600/                                                                 65060023
650700 7500-RECITM-STATUS.                                              65070023
650800                                                                  65080023
650900     EXEC SQL                                                     65090023
651000     SELECT                                                       65100023
651100            A.STATUS_CDE                                          65110023
651200         INTO                                                     65120023
651300              :RECITM-STATUS-CDE                                  65130023
651400         FROM                                                     65140023
651500             TRECITM A                                            65150023
651600         WHERE A.ORD_NBR          = :DK-ORD-NBR                   65160023
651700         AND A.REC_SEQ_NBR        = :DK-RCVR-NBR                  65170023
651800         AND A.ORD_LNE_NBR        = :DK-LINE-NBR                  65180023
651900         AND A.VER_STATUS_CDE     = 'A'                           65190023
652000     END-EXEC.                                                    65200023
652100                                                                  65210023
652200     EVALUATE TRUE                                                65220023
652300         WHEN SQLCODE = ZERO                                      65230023
652400             CONTINUE                                             65240023
652500         WHEN SQLCODE = +100                                      65250023
652600             MOVE SPACES              TO RECITM-STATUS-CDE        65260023
652700         WHEN SQLCODE = -904                                      65270023
652800         WHEN SQLCODE = -911                                      65280023
652900         WHEN SQLCODE = -913                                      65290023
653000             MOVE '7500-RECITM-STATUS'                            65300023
653100                                  TO DP013-PARAGRAPH              65310023
653200             MOVE SQLCODE            TO PC-DISPLAY-SQL-CODE       65320023
653300             PERFORM 9900-SOFT-ABORT                              65330023
653400                                                                  65340023
653500         WHEN SQLWARN0 NOT = SPACES                               65350023
653600         WHEN SQLCODE < ZERO                                      65360023
653700         WHEN SQLCODE > ZERO                                      65370023
653800             MOVE '7500-RECITM-STATUS'                            65380023
653900                                  TO DP013-PARAGRAPH              65390023
654000             MOVE 'UNSUCCESSFUL COUNT OF VERIFIED LINES'          65400023
654100                                  TO DP013-MESSAGE-TEXT (1)       65410023
654200             MOVE SQLCA      TO DP013-SQLCA                       65420023
654300             MOVE 'TRECITM ' TO DP013-DB2-TABLE-NAME (1)          65430023
654400             SET DP013-DB2-ABEND                                  65440023
654500                 DP013-NO-ROLLBACK                                65450023
654600                                  TO TRUE                         65460023
654700             PERFORM DP013-0000-PROCESS-ABEND                     65470023
654800     END-EVALUATE.                                                65480023
654900/                                                                 65490023
655000 7550-FREIGHT-BILL.                                               65500023
655100                                                                  65510023
655200     MOVE ZERO                        TO PV-FREIGHT-COUNT         65520023
655300     EXEC SQL                                                     65530023
655400         SELECT COUNT(*)                                          65540023
655500         INTO :PV-FREIGHT-COUNT                                   65550023
655600         FROM TSHIPMT A                                           65560023
655700         ,    TSHPTPO B                                           65570023
655800         WHERE B.PO_NBR      = :DK-ORD-NBR                        65580023
655900           AND B.REC_SEQ_NBR = :DK-RCVR-NBR                       65590023
656000           AND A.SHIPT_ID    = B.SHIPT_ID                         65600023
656100           AND A.PRO_NBR <> :PC-SPACES                            65610023
656200     END-EXEC                                                     65620023
656300                                                                  65630023
656400     EVALUATE TRUE                                                65640023
656500         WHEN SQLCODE = ZERO                                      65650023
656600             IF  PV-FREIGHT-COUNT > ZERO                          65660023
656700                 CONTINUE                                         65670023
656800             ELSE                                                 65680023
656900                 SET PS-DONT-SUBMIT-E200   TO TRUE                65690023
657000             END-IF                                               65700023
657100         WHEN SQLCODE = +100                                      65710023
657200                 SET PS-DONT-SUBMIT-E200   TO TRUE                65720023
657300         WHEN SQLCODE = -904                                      65730023
657400         WHEN SQLCODE = -911                                      65740023
657500         WHEN SQLCODE = -913                                      65750023
657600             MOVE '7550-FREIGHT-BILL'                             65760023
657700                                  TO DP013-PARAGRAPH              65770023
657800             MOVE SQLCODE            TO PC-DISPLAY-SQL-CODE       65780023
657900             PERFORM 9900-SOFT-ABORT                              65790023
658000                                                                  65800023
658100         WHEN SQLWARN0 NOT = SPACES                               65810023
658200         WHEN SQLCODE < ZERO                                      65820023
658300         WHEN SQLCODE > ZERO                                      65830023
658400             MOVE '7550-FREIGHT-BILL'                             65840023
658500                                  TO DP013-PARAGRAPH              65850023
658600             MOVE 'UNSUCCESSFUL COUNT OF SHIPMENT ROWS'           65860023
658700                                  TO DP013-MESSAGE-TEXT (1)       65870023
658800             MOVE SQLCA      TO DP013-SQLCA                       65880023
658900             MOVE 'TSHIPMT ' TO DP013-DB2-TABLE-NAME (1)          65890023
659000             MOVE 'TSHPTPO ' TO DP013-DB2-TABLE-NAME (2)          65900023
659100             SET DP013-DB2-ABEND                                  65910023
659200                 DP013-NO-ROLLBACK                                65920023
659300                                  TO TRUE                         65930023
659400              PERFORM DP013-0000-PROCESS-ABEND                    65940023
659500     END-EVALUATE.                                                65950023
659600                                                                  65960023
659700                                                                  65970023
659800***************************************************************** 65980023
659900* CHECK TO SEE IF ARRIVED                                       * 65990023
660000***************************************************************** 66000023
660100 7560-CHECK-IF-ARRIVED.                                           66010023
660200                                                                  66020023
660300     EXEC SQL                                                     66030023
660400          SELECT REC_TMST                                         66040023
660500              ,  PACK_BY_ST_IND                                   66050023
660600            INTO :RECEIV-REC-TMST                                 66060023
660700              ,  :RECEIV-PACK-BY-ST-IND                           66070023
660800            FROM TRECEIV                                          66080023
660900           WHERE ORD_NBR       = :DK-ORD-NBR                      66090023
661000             AND REC_SEQ_NBR   = :DK-RCVR-NBR                     66100023
661100     END-EXEC.                                                    66110023
661200                                                                  66120023
661300     EVALUATE TRUE                                                66130023
661400         WHEN SQLCODE = +0                                        66140023
661500              IF  RECEIV-REC-TMST  =  PC-DEFAULT-TMST             66150023
661600                  SET PS-NOT-ARRIVED        TO  TRUE              66160023
661700                  SET PS-DONT-SUBMIT-E200   TO TRUE               66170023
661800              ELSE                                                66180023
661900                  SET PS-ARRIVED      TO TRUE                     66190023
662000              END-IF                                              66200023
662100                                                                  66210023
662200         WHEN SQLCODE = +100                                      66220023
662300              SET PS-NOT-ARRIVED      TO TRUE                     66230023
662400                                                                  66240023
662500         WHEN SQLCODE = -904                                      66250023
662600         WHEN SQLCODE = -911                                      66260023
662700         WHEN SQLCODE = -913                                      66270023
662800              MOVE '7560-CHECK-IF-ARRIVED'                        66280023
662900                                  TO DP013-PARAGRAPH              66290023
663000             MOVE SQLCODE            TO PC-DISPLAY-SQL-CODE       66300023
663100              PERFORM 9900-SOFT-ABORT                             66310023
663200                                                                  66320023
663300         WHEN SQLWARN0 NOT = SPACES                               66330023
663400         WHEN SQLCODE < +0                                        66340023
663500         WHEN SQLCODE > +0                                        66350023
663600              MOVE '7560-CHECK-IF-ARRIVED'                        66360023
663700                                  TO DP013-PARAGRAPH              66370023
663800              MOVE 'CHECK IF PO/RCVR IS ARRIVED'                  66380023
663900                                  TO DP013-MESSAGE-TEXT (1)       66390023
664000              MOVE DK-ORD-NBR     TO PV-ERROR-ORD-NBR             66400023
664100              MOVE DK-RCVR-NBR    TO PV-ERROR-RCVR-SEQ-NBR        66410023
664200              STRING ' RCVR: '              DELIMITED BY SIZE     66420023
664300                     PV-ERROR-ORD-NBR       DELIMITED BY SIZE     66430023
664400                     '-'                    DELIMITED BY SIZE     66440023
664500                     PV-ERROR-RCVR-SEQ-NBR  DELIMITED BY SIZE     66450023
664600                                INTO DP013-MESSAGE-TEXT (2)       66460023
664700              MOVE SQLCA          TO DP013-SQLCA                  66470023
664800              MOVE 'TRECEIV '     TO DP013-DB2-TABLE-NAME (1)     66480023
664900              SET  DP013-DB2-ABEND                                66490023
665000                   DP013-XCTL-DISPLAY-RESTART                     66500023
665100                   DP013-NO-ROLLBACK                              66510023
665200                                  TO TRUE                         66520023
665300              PERFORM DP013-0000-PROCESS-ABEND                    66530023
665400     END-EVALUATE.                                                66540023
665500                                                                  66550023
665600 7570-CALL-VEM-MODULE.                                            66560023
665700                                                                  66570023
665800     MOVE ASC-KEY-PO-NBR           TO RC038-PO-NBR.               66580023
665900     MOVE ASC-KEY-RCVR-NBR         TO RC038-REC-SEQ-NBR.          66590023
666000     MOVE DK-LINE-NBR              TO RC038-PO-LNE-NBR.           66600023
666100     MOVE 0                        TO RC038-PREPACK-ID.           66610023
666200     MOVE ASC-KEY-OPER-UNT-ID      TO RC038-OPER-UNT-ID.          66620023
666300     MOVE ASC-KEY-FCLTY-ID         TO RC038-FCLTY-ID.             66630023
666400     MOVE DP020-USERID             TO RC038-USER-ID.              66640023
666500     MOVE 'RCKCS297'               TO RC038-PROGRAM-NAME.         66650023
666600     IF RECEIV-PACK-BY-ST-IND = 'Y'                               66660023
666700        SET RC038-PBS              TO TRUE                        66670023
666800     ELSE                                                         66680023
666900         IF ASC-PKGNG-CDE-DISPLAY = 'M' OR 'I'                    66690023
667000            MOVE ASC-PKGNG-CDE-DISPLAY                            66700023
667100                                   TO RC038-PKGNG-CDE             66710023
667200            MOVE DK-PREPK-ID       TO RC038-PREPACK-ID            66720023
667300         ELSE                                                     66730023
667400            MOVE 'B'               TO RC038-PKGNG-CDE             66740023
667500         END-IF                                                   66750023
667600     END-IF.                                                      66760023
667700                                                                  66770023
667800     MOVE ASC-AUTO-VE-SW                 TO RC038-AUTOVE-PO-SW.   66780023
667900                                                                  66790023
668000     MOVE LENGTH OF RC038-FIELDS         TO PV-COMMAREA-LENGTH.   66800023
668100                                                                  66810023
668200     EXEC CICS                                                    66820023
668300         LINK PROGRAM  (PC-VERIFICATION-MODULE)                   66830023
668400              COMMAREA (RC038-FIELDS)                             66840023
668500              LENGTH   (PV-COMMAREA-LENGTH)                       66850023
668600              RESP     (PV-CICS-RESP)                             66860023
668700     END-EXEC.                                                    66870023
668800                                                                  66880023
668900     EVALUATE TRUE                                                66890023
669000         WHEN PV-CICS-RESP = DFHRESP (NORMAL)                     66900023
669100             IF  RC038-INVALID-SQL     OR                         66910023
669200                 RC038-DATABASE-BUSY                              66920023
669300                 STRING ' RCKCS297 - '        DELIMITED BY SIZE   66930023
669400                        ' RETURN MESSAGE - '  DELIMITED BY SIZE   66940023
669500                        RC038-SUCCESS-IND     DELIMITED BY SIZE   66950023
669600                                   INTO DP013-MESSAGE-TEXT(1)     66960023
669700                 SET DP013-CICS-ABEND        TO TRUE              66970023
669800                 SET DP013-ROLLBACK          TO TRUE              66980023
669900                 MOVE '7570-CALL-VEM-MODULE' TO DP013-PARAGRAPH   66990023
670000                 SET  DP013-DB2-ABEND                             67000023
670100                      DP013-XCTL-DISPLAY-RESTART                  67010023
670200                      DP013-NO-ROLLBACK                           67020023
670300                                     TO TRUE                      67030023
670400                 PERFORM DP013-0000-PROCESS-ABEND                 67040023
670500             END-IF                                               67050023
670600         WHEN OTHER                                               67060023
670700             MOVE PV-CICS-RESP          TO PV-DISPLAY-CICS-RESP   67070023
670800             STRING ' RCKCS297 (OTHER) -' DELIMITED BY SIZE       67080023
670900                    ' CICS RESP = '       DELIMITED BY SIZE       67090023
671000                    PV-DISPLAY-CICS-RESP  DELIMITED BY SIZE       67100023
671100                               INTO DP013-MESSAGE-TEXT(1)         67110023
671200             SET DP013-CICS-ABEND        TO TRUE                  67120023
671300             SET DP013-ROLLBACK          TO TRUE                  67130023
671400             MOVE '7570-CALL-VEM-MODULE' TO DP013-PARAGRAPH       67140023
671500             SET  DP013-DB2-ABEND                                 67150023
671600                  DP013-XCTL-DISPLAY-RESTART                      67160023
671700                  DP013-NO-ROLLBACK                               67170023
671800                                 TO TRUE                          67180023
671900             PERFORM DP013-0000-PROCESS-ABEND                     67190023
672000                                                                  67200023
672100     END-EVALUATE.                                                67210023
672200                                                                  67220023
672300                                                                  67230023
672400***************************************************************** 67240023
672500*                                                               * 67250023
672600***************************************************************** 67260023
672700 7600-COUNT-RCVR-TROUBLES.                                        67270023
672800     MOVE ZERO TO PV-TRBL-RCVR-COUNT.                             67280023
672900                                                                  67290023
673000     EXEC SQL                                                     67300023
673100         SELECT COUNT(*)                                          67310023
673200             INTO :PV-TRBL-RCVR-COUNT :PV-NULL-IND                67320023
673300             FROM TTRBNTF A                                       67330023
673400                 ,TTRBRSN B                                       67340023
673500             WHERE  A.PO_NBR          = :DK-ORD-NBR               67350023
673600               AND  A.REC_SEQ_NBR     = :DK-RCVR-NBR              67360023
673700               AND  A.RESOLVED_IND IN ('N', 'I', 'R')             67370023
673800               AND  A.TRBL_RSN_CDE    = B.TRBL_RSN_CDE            67380023
673900               AND  B.NOTIF_IND       = 'T'                       67390023
674000         END-EXEC                                                 67400023
674100                                                                  67410023
674200     EVALUATE TRUE                                                67420023
674300         WHEN SQLCODE = ZERO                                      67430023
674400             IF PV-TRBL-RCVR-COUNT > ZERO                         67440023
674500                 SET PS-DONT-SUBMIT-E200   TO TRUE                67450023
674600             END-IF                                               67460023
674700         WHEN SQLCODE = +100                                      67470023
674800             CONTINUE                                             67480023
674900         WHEN SQLCODE = -904                                      67490023
675000         WHEN SQLCODE = -911                                      67500023
675100         WHEN SQLCODE = -913                                      67510023
675200             MOVE '7600-COUNT-RCVR-TROUBLES'                      67520023
675300                                  TO DP013-PARAGRAPH              67530023
675400             MOVE SQLCODE            TO PC-DISPLAY-SQL-CODE       67540023
675500             PERFORM 9900-SOFT-ABORT                              67550023
675600                                                                  67560023
675700         WHEN SQLWARN0 NOT = SPACES                               67570023
675800         WHEN SQLCODE < ZERO                                      67580023
675900         WHEN SQLCODE > ZERO                                      67590023
676000             MOVE '7600-COUNT-RCVR-TROUBLES'                      67600023
676100                                  TO DP013-PARAGRAPH              67610023
676200             MOVE 'UNSUCCESSFUL COUNT OF SHIPMENT ROWS'           67620023
676300                                  TO DP013-MESSAGE-TEXT (1)       67630023
676400             MOVE SQLCA      TO DP013-SQLCA                       67640023
676500             MOVE 'TTRBNTF ' TO DP013-DB2-TABLE-NAME (1)          67650023
676600             SET DP013-DB2-ABEND                                  67660023
676700                 DP013-NO-ROLLBACK                                67670023
676800                                  TO TRUE                         67680023
676900              PERFORM DP013-0000-PROCESS-ABEND                    67690023
677000     END-EVALUATE.                                                67700023
677100                                                                  67710023
677200 7650-INVENTORY-CHECK.                                            67720023
677300     MOVE ZERO                        TO PV-INVENTORY-COUNT       67730023
677400                                                                  67740023
677500     EXEC SQL                                                     67750023
677600         SELECT COUNT (*)                                         67760023
677700         INTO                                                     67770023
677800             :PV-INVENTORY-COUNT :PV-NULL-IND                     67780023
677900         FROM                                                     67790023
678000             XLT_MDSE_INV_PARM                                    67800031
678100         WHERE                                                    67810023
678200             DC_CTOFF_DTE >= (CURRENT_DATE - 7 DAYS)              67820023
678300         AND DC_CTOFF_DTE <= (CURRENT_DATE + 7 DAYS)              67830023
678310         AND ACTV_IND      = 'Y'                                  67831028
678320         AND LOC_INV_STAT_CDE = 'IN'                              67832027
678400     END-EXEC                                                     67840023
678500                                                                  67850023
678600     EVALUATE TRUE                                                67860023
678700         WHEN SQLCODE = ZERO                                      67870023
678800         WHEN SQLCODE = +100                                      67880023
678900             CONTINUE                                             67890023
679000         WHEN SQLCODE = -904                                      67900023
679100         WHEN SQLCODE = -911                                      67910023
679200         WHEN SQLCODE = -913                                      67920023
679300             MOVE '7650-INVENTORY-CHECK'                          67930023
679400                                  TO DP013-PARAGRAPH              67940023
679500             MOVE SQLCODE            TO PC-DISPLAY-SQL-CODE       67950023
679600             PERFORM 9900-SOFT-ABORT                              67960023
679700                                                                  67970023
679800         WHEN SQLWARN0 NOT = SPACES                               67980023
679900         WHEN SQLCODE < ZERO                                      67990023
680000         WHEN SQLCODE > ZERO                                      68000023
680100             MOVE '7650-INVENTORY-CHECK'                          68010023
680200                                  TO DP013-PARAGRAPH              68020023
680300             MOVE 'UNSUCCESSFUL COUNT OF SHIPMENT ROWS'           68030023
680400                                  TO DP013-MESSAGE-TEXT (1)       68040023
680500             MOVE SQLCA      TO DP013-SQLCA                       68050023
680600             MOVE 'XLT_MDSE_INV_PARM' TO DP013-DB2-TABLE-NAME (1) 68060023
680700             SET DP013-DB2-ABEND                                  68070023
680800                 DP013-NO-ROLLBACK                                68080023
680900                                  TO TRUE                         68090023
681000              PERFORM DP013-0000-PROCESS-ABEND                    68100023
681100     END-EVALUATE.                                                68110023
681200/                                                                 68120023
681300 7655-SELECT-CONFIRM-TMST.                                        68130023
681400                                                                  68140023
681500     INITIALIZE DCLTDISTHD                                        68150023
681600                                                                  68160023
681700     EXEC SQL                                                     68170023
681800        SELECT FCSE_CNFRMN_TMST                                   68180023
681900              ,RSLTS_RCVD_TMST                                    68190023
682000              ,PRCG_STAT_CDE                                      68200023
682100              ,P2L_CART_CNT                                       68210023
682200           INTO :DISTHD-FCSE-CNFRMN-TMST                          68220023
682300               ,:DISTHD-RSLTS-RCVD-TMST                           68230023
682400               ,:DISTHD-PRCG-STAT-CDE                             68240023
682500               ,:DISTHD-P2L-CART-CNT                              68250023
682600           FROM  TDISTHD                                          68260023
682700         WHERE ORD_NBR                  = :DK-ORD-NBR             68270023
682800           AND RCVR_SEQ_NBR             = :DK-RCVR-NBR            68280023
682900           AND ORD_LNE_NBR              = :DK-LINE-NBR            68290023
683000     END-EXEC.                                                    68300023
683100                                                                  68310023
683200     EVALUATE TRUE                                                68320023
683300         WHEN SQLCODE = ZERO                                      68330023
683400         WHEN SQLCODE = +100                                      68340023
683500              CONTINUE                                            68350023
683600         WHEN SQLCODE = -904                                      68360023
683700         WHEN SQLCODE = -911                                      68370023
683800         WHEN SQLCODE = -913                                      68380023
683900             MOVE '7655-SELECT-CONFIRM-TMST'                      68390023
684000                                  TO DP013-PARAGRAPH              68400023
684100             MOVE SQLCODE            TO PC-DISPLAY-SQL-CODE       68410023
684200             PERFORM 9900-SOFT-ABORT                              68420023
684300                                                                  68430023
684400         WHEN SQLWARN0 NOT = SPACES                               68440023
684500         WHEN SQLCODE < ZERO                                      68450023
684600         WHEN SQLCODE > ZERO                                      68460023
684700             MOVE '7655-SELECT-CONFIRM-TMST'                      68470023
684800                                  TO DP013-PARAGRAPH              68480023
684900             MOVE 'UNSUCESSFUL COUNT OF TDISTHD'                  68490023
685000                                  TO DP013-MESSAGE-TEXT (1)       68500023
685100             MOVE SQLCA      TO DP013-SQLCA                       68510023
685200             MOVE 'TDISTHD ' TO DP013-DB2-TABLE-NAME (1)          68520023
685300             SET DP013-DB2-ABEND                                  68530023
685400                  DP013-NO-ROLLBACK                               68540023
685500                                  TO TRUE                         68550023
685600             PERFORM DP013-0000-PROCESS-ABEND                     68560023
685700     END-EVALUATE.                                                68570023
685800/                                                                 68580023
685900 7950-CONFIRM-UPDATE.                                             68590023
686000                                                                  68600023
686100     EXEC SQL                                                     68610023
686200         SET :PV-TMST =  CURRENT_TIMESTAMP                        68620023
686300     END-EXEC                                                     68630023
686400                                                                  68640023
686500     MOVE PV-TMST  TO DISTHD-FCSE-CNFRMN-TMST.                    68650023
686600                                                                  68660023
686700     IF DISTHD-P2L-CART-CNT = 0                                   68670023
686800        MOVE PV-TMST   TO DISTHD-RSLTS-RCVD-TMST                  68680023
686900     END-IF.                                                      68690023
687000                                                                  68700023
687100     IF DP020-FK-LOCAL-FUNC-07 (DP020-SRC-AID)                    68710023
687200        MOVE PC-CONFIRM-AT-ZERO  TO DISTHD-FCSE-CNFRMN-PGM-ID     68720023
687300     ELSE                                                         68730023
687400        MOVE PC-CURRENT-PROGRAM-NAME TO DISTHD-FCSE-CNFRMN-PGM-ID 68740023
687500     END-IF.                                                      68750023
687600                                                                  68760023
687700*  NOTE - IF THERE ARE P2L CARTONS, THEN THE TABLE WILL BE UPDATED68770023
687800*  WITH THE ORIGINAL VALUE                                        68780023
687900                                                                  68790023
688000     EXEC SQL                                                     68800023
688100         UPDATE  TDISTHD                                          68810023
688200           SET FCSE_CNFRMN_TMST   = :DISTHD-FCSE-CNFRMN-TMST      68820023
688300            ,  FCSE_CNFRMN_USR_ID = :DP020-USERID                 68830023
688400            ,  FCSE_CNFRMN_PGM_ID = :DISTHD-FCSE-CNFRMN-PGM-ID    68840023
688500            ,  PRCG_STAT_CDE      = :DISTHD-PRCG-STAT-CDE         68850023
688600            ,  RSLTS_RCVD_TMST    = :DISTHD-RSLTS-RCVD-TMST       68860023
688700            ,  FCSE_FCLTY_AREA_ID = :DISTHD-FCSE-FCLTY-AREA-ID    68870023
688800      WHERE ORD_NBR                  = :DK-ORD-NBR                68880023
688900        AND RCVR_SEQ_NBR             = :DK-RCVR-NBR               68890023
689000        AND ORD_LNE_NBR              = :DK-LINE-NBR               68900023
689100     END-EXEC.                                                    68910023
689200                                                                  68920023
689300     EVALUATE TRUE                                                68930023
689400         WHEN SQLCODE = ZERO                                      68940023
689500             PERFORM 7951-CONFIRM-DATE-TIME                       68950023
689600         WHEN SQLCODE = -904                                      68960023
689700         WHEN SQLCODE = -911                                      68970023
689800         WHEN SQLCODE = -913                                      68980023
689900             MOVE '7950-CONFIRM-UPDATE'                           68990023
690000                                  TO DP013-PARAGRAPH              69000023
690100             MOVE SQLCODE            TO PC-DISPLAY-SQL-CODE       69010023
690200             PERFORM 9900-SOFT-ABORT                              69020023
690300                                                                  69030023
690400         WHEN SQLWARN0 NOT = SPACES                               69040023
690500         WHEN SQLCODE < ZERO                                      69050023
690600         WHEN SQLCODE > ZERO                                      69060023
690700             MOVE '7950-CONFIRM-UPDATE'                           69070023
690800                                  TO DP013-PARAGRAPH              69080023
690900             MOVE 'UNSUCCESSFUL COUNT OF TDISTHD ROWS'            69090023
691000                                  TO DP013-MESSAGE-TEXT (1)       69100023
691100             MOVE SQLCA      TO DP013-SQLCA                       69110023
691200             MOVE 'TDISTHD ' TO DP013-DB2-TABLE-NAME (1)          69120023
691300             SET DP013-DB2-ABEND                                  69130023
691400                  DP013-NO-ROLLBACK                               69140023
691500                                  TO TRUE                         69150023
691600             PERFORM DP013-0000-PROCESS-ABEND                     69160023
691700     END-EVALUATE.                                                69170023
691800/                                                                 69180023
691900 7951-CONFIRM-DATE-TIME.                                          69190023
692000* THIS WILL REFRESH THE DATE AND TIME OF THE CONFIRMED LINE       69200023
692100     STRING                                                       69210023
692200             PV-MM                                                69220023
692300             '/'                                                  69230023
692400             PV-DD                                                69240023
692500             '/'                                                  69250023
692600             PV-CCYY                                              69260023
692700             '/'                                                  69270023
692800                     DELIMITED BY SIZE                            69280023
692900                                    INTO LQW-CONF-DATE(LQW-IDX).  69290023
693000                                                                  69300023
693100     STRING                                                       69310023
693200             PV-HH                                                69320023
693300             ':'                                                  69330023
693400             PV-MIN DELIMITED BY SIZE                             69340023
693500                                    INTO LQW-CONF-TIME(LQW-IDX).  69350023
693600/                                                                 69360023
693700 7952-UPDATE-UNITS-WRKD.                                          69370023
693800* THIS WILL CALL PCKCS756 WHICH WILL UPDATE THE TABLES FOR UNITS  69380023
693900* WORKED OR VERIFIED                                              69390023
694000     EXEC SQL                                                     69400023
694100         SET :PV-CURRENT-TMST =  CURRENT_TIMESTAMP                69410023
694200     END-EXEC.                                                    69420023
694300                                                                  69430023
694400     MOVE PV-CURRENT-TMST             TO PC238-WRKD-TMST.         69440023
694500     MOVE ASC-KEY-PO-NBR              TO PC238-PO-NBR.            69450023
694600     MOVE ASC-KEY-RCVR-NBR            TO PC238-RCVR-SEQ-NBR.      69460023
694700     MOVE ASC-KEY-LNE-NBR             TO PC238-PO-LNE-NBR.        69470023
694800     MOVE DISTHD-FCSE-FCLTY-AREA-ID   TO PC238-PRCG-AREA-CDE.     69480023
694900     MOVE PC-N                        TO PC238-VERIFY-TYPE-CDE.   69490023
695000     MOVE LENGTH OF PC238-COMM-AREA   TO PC-COMMAREA-LENGTH.      69500023
695100                                                                  69510023
695200     EXEC CICS                                                    69520023
695300         LINK                                                     69530023
695400             PROGRAM   (PC-UNTS-WRKD-PGRM-NAME)                   69540023
695500             COMMAREA  (PC238-COMM-AREA)                          69550023
695600             LENGTH    (PC-COMMAREA-LENGTH)                       69560023
695700             RESP      (PV-CICS-RESP)                             69570023
695800     END-EXEC.                                                    69580023
695900                                                                  69590023
696000     EVALUATE TRUE                                                69600023
696100         WHEN PV-CICS-RESP = DFHRESP (NORMAL)                     69610023
696200              EVALUATE TRUE                                       69620023
696300                  WHEN PC238-MOD-SUCCESSFUL                       69630023
696400                       CONTINUE                                   69640023
696500                 WHEN PC238-MOD-UNSUCCESSFUL                      69650023
696600                     PERFORM 7953-MOD-UNSUCCESSFUL                69660023
696700             END-EVALUATE                                         69670023
696800                                                                  69680023
696900         WHEN OTHER                                               69690023
697000             MOVE '7952-UPDATE-UNITS-WRKD'  TO DP013-PARAGRAPH    69700023
697100             MOVE 'UNABLE TO XCTL THE FOLLOWING PROGRAM: '        69710023
697200                                       TO DP013-MESSAGE-TEXT (1)  69720023
697300             MOVE 'PCKCS756'           TO DP013-MESSAGE-TEXT (2)  69730023
697400             SET DP013-CICS-ABEND                                 69740023
697500                 DP013-NO-ROLLBACK  TO TRUE                       69750023
697600             PERFORM DP013-0000-PROCESS-ABEND                     69760023
697700     END-EVALUATE.                                                69770023
697800/                                                                 69780023
697900 7953-MOD-UNSUCCESSFUL.                                           69790023
698000                                                                  69800023
698100     MOVE PC238-PO-NBR              TO PC-DISPLAY-PO.             69810023
698200     MOVE PC238-RCVR-SEQ-NBR        TO PC-DISPLAY-RCVR.           69820023
698300     MOVE PC238-PO-LNE-NBR          TO PC-DISPLAY-LINE.           69830023
698400     MOVE PC238-WRKD-OPER-UNT-ID    TO PC-DISPLAY-OPER.           69840023
698500     MOVE PC238-BAD-SQL-CDE         TO PC-DISPLAY-SQL-CODE.       69850023
698600     SET  PS-UNITS-WORKED-ERROR     TO TRUE.                      69860023
698700                                                                  69870023
698800     IF  PC238-MOD-BAD-TMST                                       69880023
698900         STRING ' RCKCS297 - '      DELIMITED BY SIZE             69890023
699000                ' 7952-UPDATE-UNITS-WRKD '                        69900023
699100                                    DELIMITED BY SIZE             69910023
699200                ' BAD TIMESTAMP '   DELIMITED BY SIZE             69920023
699300                PC238-WRKD-TMST     DELIMITED BY SIZE             69930023
699400                             INTO PV-CICS-MSG-AREA                69940023
699500         MOVE LENGTH OF PV-CICS-MSG-AREA                          69950023
699600                               TO PV-COMMAREA-LENGTH              69960023
699700         PERFORM 9200-WRITE-TO-CICS-LOG                           69970023
699800         STRING ' RCKCS297 - '      DELIMITED BY SIZE             69980023
699900                ' 7952-UPDATE-UNITS-WRKD '                        69990023
700000                                    DELIMITED BY SIZE             70000023
700100                ' KEY INFO - '      DELIMITED BY SIZE             70010023
700200                PC-DISPLAY-PO       DELIMITED BY SIZE             70020023
700300                ' - '               DELIMITED BY SIZE             70030023
700400                PC-DISPLAY-RCVR     DELIMITED BY SIZE             70040023
700500                ' - '               DELIMITED BY SIZE             70050023
700600                PC-DISPLAY-LINE     DELIMITED BY SIZE             70060023
700700                             INTO PV-CICS-MSG-AREA                70070023
700800         MOVE LENGTH OF PV-CICS-MSG-AREA                          70080023
700900                               TO PV-COMMAREA-LENGTH              70090023
701000         PERFORM 9200-WRITE-TO-CICS-LOG                           70100023
701100         PERFORM 9900-SOFT-ABORT                                  70110023
701200     ELSE                                                         70120023
701300     IF  PC238-MOD-BAD-OPER                                       70130023
701400         STRING ' RCKCS297 - '      DELIMITED BY SIZE             70140023
701500                ' 7952-UPDATE-UNITS-WRKD '                        70150023
701600                                    DELIMITED BY SIZE             70160023
701700                ' BAD OPER UNIT '   DELIMITED BY SIZE             70170023
701800                PC-DISPLAY-OPER     DELIMITED BY SIZE             70180023
701900                             INTO PV-CICS-MSG-AREA                70190023
702000         MOVE LENGTH OF PV-CICS-MSG-AREA                          70200023
702100                               TO PV-COMMAREA-LENGTH              70210023
702200         PERFORM 9200-WRITE-TO-CICS-LOG                           70220023
702300         STRING ' RCKCS297 - '      DELIMITED BY SIZE             70230023
702400                ' 7952-UPDATE-UNITS-WRKD '                        70240023
702500                                    DELIMITED BY SIZE             70250023
702600                ' KEY INFO - '      DELIMITED BY SIZE             70260023
702700                PC-DISPLAY-PO       DELIMITED BY SIZE             70270023
702800                ' - '               DELIMITED BY SIZE             70280023
702900                PC-DISPLAY-RCVR     DELIMITED BY SIZE             70290023
703000                ' - '               DELIMITED BY SIZE             70300023
703100                PC-DISPLAY-LINE     DELIMITED BY SIZE             70310023
703200                             INTO PV-CICS-MSG-AREA                70320023
703300         MOVE LENGTH OF PV-CICS-MSG-AREA                          70330023
703400                               TO PV-COMMAREA-LENGTH              70340023
703500         PERFORM 9200-WRITE-TO-CICS-LOG                           70350023
703600         PERFORM 9900-SOFT-ABORT                                  70360023
703700     ELSE                                                         70370023
703800     IF  PC238-MOD-BAD-TRANS-TYPE                                 70380023
703900         STRING ' RCKCS297 - '      DELIMITED BY SIZE             70390023
704000                ' 7952-UPDATE-UNITS-WRKD '                        70400023
704100                                    DELIMITED BY SIZE             70410023
704200                ' BAD TRAN TYPE '   DELIMITED BY SIZE             70420023
704300                PC238-TRANS-TYPE-CDE                              70430023
704400                                    DELIMITED BY SIZE             70440023
704500                             INTO PV-CICS-MSG-AREA                70450023
704600         MOVE LENGTH OF PV-CICS-MSG-AREA                          70460023
704700                               TO PV-COMMAREA-LENGTH              70470023
704800         PERFORM 9200-WRITE-TO-CICS-LOG                           70480023
704900         STRING ' RCKCS297 - '      DELIMITED BY SIZE             70490023
705000                ' 7952-UPDATE-UNITS-WRKD '                        70500023
705100                                    DELIMITED BY SIZE             70510023
705200                ' KEY INFO - '      DELIMITED BY SIZE             70520023
705300                PC-DISPLAY-PO       DELIMITED BY SIZE             70530023
705400                ' - '               DELIMITED BY SIZE             70540023
705500                PC-DISPLAY-RCVR     DELIMITED BY SIZE             70550023
705600                ' - '               DELIMITED BY SIZE             70560023
705700                PC-DISPLAY-LINE     DELIMITED BY SIZE             70570023
705800                             INTO PV-CICS-MSG-AREA                70580023
705900         MOVE LENGTH OF PV-CICS-MSG-AREA                          70590023
706000                               TO PV-COMMAREA-LENGTH              70600023
706100         PERFORM 9200-WRITE-TO-CICS-LOG                           70610023
706200         PERFORM 9900-SOFT-ABORT                                  70620023
706300     ELSE                                                         70630023
706400     IF  PC238-MOD-BAD-PO                                         70640023
706500         STRING ' RCKCS297 - '      DELIMITED BY SIZE             70650023
706600                ' 7952-UPDATE-UNITS-WRKD '                        70660023
706700                                    DELIMITED BY SIZE             70670023
706800                ' BAD PO NUMBER '   DELIMITED BY SIZE             70680023
706900                PC-DISPLAY-PO       DELIMITED BY SIZE             70690023
707000                             INTO PV-CICS-MSG-AREA                70700023
707100         MOVE LENGTH OF PV-CICS-MSG-AREA                          70710023
707200                               TO PV-COMMAREA-LENGTH              70720023
707300         PERFORM 9200-WRITE-TO-CICS-LOG                           70730023
707400         STRING ' RCKCS297 - '      DELIMITED BY SIZE             70740023
707500                ' 7952-UPDATE-UNITS-WRKD '                        70750023
707600                                    DELIMITED BY SIZE             70760023
707700                ' KEY INFO - '      DELIMITED BY SIZE             70770023
707800                PC-DISPLAY-PO       DELIMITED BY SIZE             70780023
707900                ' - '               DELIMITED BY SIZE             70790023
708000                PC-DISPLAY-RCVR     DELIMITED BY SIZE             70800023
708100                ' - '               DELIMITED BY SIZE             70810023
708200                PC-DISPLAY-LINE     DELIMITED BY SIZE             70820023
708300                             INTO PV-CICS-MSG-AREA                70830023
708400         MOVE LENGTH OF PV-CICS-MSG-AREA                          70840023
708500                               TO PV-COMMAREA-LENGTH              70850023
708600         PERFORM 9200-WRITE-TO-CICS-LOG                           70860023
708700         PERFORM 9900-SOFT-ABORT                                  70870023
708800     ELSE                                                         70880023
708900     IF  PC238-MOD-BAD-RCVR                                       70890023
709000         STRING ' RCKCS297 - '      DELIMITED BY SIZE             70900023
709100                ' 7952-UPDATE-UNITS-WRKD '                        70910023
709200                                    DELIMITED BY SIZE             70920023
709300                ' BAD RCVR NBR  '   DELIMITED BY SIZE             70930023
709400                PC-DISPLAY-RCVR     DELIMITED BY SIZE             70940023
709500                             INTO PV-CICS-MSG-AREA                70950023
709600         MOVE LENGTH OF PV-CICS-MSG-AREA                          70960023
709700                               TO PV-COMMAREA-LENGTH              70970023
709800         PERFORM 9200-WRITE-TO-CICS-LOG                           70980023
709900         STRING ' RCKCS297 - '      DELIMITED BY SIZE             70990023
710000                ' 7952-UPDATE-UNITS-WRKD '                        71000023
710100                                    DELIMITED BY SIZE             71010023
710200                ' KEY INFO - '      DELIMITED BY SIZE             71020023
710300                PC-DISPLAY-PO       DELIMITED BY SIZE             71030023
710400                ' - '               DELIMITED BY SIZE             71040023
710500                PC-DISPLAY-RCVR     DELIMITED BY SIZE             71050023
710600                ' - '               DELIMITED BY SIZE             71060023
710700                PC-DISPLAY-LINE     DELIMITED BY SIZE             71070023
710800                             INTO PV-CICS-MSG-AREA                71080023
710900         MOVE LENGTH OF PV-CICS-MSG-AREA                          71090023
711000                               TO PV-COMMAREA-LENGTH              71100023
711100         PERFORM 9200-WRITE-TO-CICS-LOG                           71110023
711200         PERFORM 9900-SOFT-ABORT                                  71120023
711300     ELSE                                                         71130023
711400     IF  PC238-MOD-BAD-LINE                                       71140023
711500         STRING ' RCKCS297 - '      DELIMITED BY SIZE             71150023
711600                ' 7952-UPDATE-UNITS-WRKD '                        71160023
711700                                    DELIMITED BY SIZE             71170023
711800                ' BAD LINE NBR  '   DELIMITED BY SIZE             71180023
711900                PC-DISPLAY-LINE     DELIMITED BY SIZE             71190023
712000                             INTO PV-CICS-MSG-AREA                71200023
712100         MOVE LENGTH OF PV-CICS-MSG-AREA                          71210023
712200                               TO PV-COMMAREA-LENGTH              71220023
712300         PERFORM 9200-WRITE-TO-CICS-LOG                           71230023
712400         STRING ' RCKCS297 - '      DELIMITED BY SIZE             71240023
712500                ' 7952-UPDATE-UNITS-WRKD '                        71250023
712600                                    DELIMITED BY SIZE             71260023
712700                ' KEY INFO - '      DELIMITED BY SIZE             71270023
712800                PC-DISPLAY-PO       DELIMITED BY SIZE             71280023
712900                ' - '               DELIMITED BY SIZE             71290023
713000                PC-DISPLAY-RCVR     DELIMITED BY SIZE             71300023
713100                ' - '               DELIMITED BY SIZE             71310023
713200                PC-DISPLAY-LINE     DELIMITED BY SIZE             71320023
713300                             INTO PV-CICS-MSG-AREA                71330023
713400         MOVE LENGTH OF PV-CICS-MSG-AREA                          71340023
713500                               TO PV-COMMAREA-LENGTH              71350023
713600         PERFORM 9200-WRITE-TO-CICS-LOG                           71360023
713700         PERFORM 9900-SOFT-ABORT                                  71370023
713800     ELSE                                                         71380023
713900     IF  PC238-MOD-BAD-NO-SHIFT                                   71390023
714000         STRING ' RCKCS297 - '      DELIMITED BY SIZE             71400023
714100                ' 7952-UPDATE-UNITS-WRKD '                        71410023
714200                                    DELIMITED BY SIZE             71420023
714300                ' SHIFT NOT FOUND ' DELIMITED BY SIZE             71430023
714400                PC238-WRKD-TMST     DELIMITED BY SIZE             71440023
714500                ' FOR OPER '        DELIMITED BY SIZE             71450023
714600                PC-DISPLAY-OPER     DELIMITED BY SIZE             71460023
714700                             INTO PV-CICS-MSG-AREA                71470023
714800         MOVE LENGTH OF PV-CICS-MSG-AREA                          71480023
714900                               TO PV-COMMAREA-LENGTH              71490023
715000         PERFORM 9200-WRITE-TO-CICS-LOG                           71500023
715100         STRING ' RCKCS297 - '      DELIMITED BY SIZE             71510023
715200                ' 7952-UPDATE-UNITS-WRKD '                        71520023
715300                                    DELIMITED BY SIZE             71530023
715400                ' KEY INFO - '      DELIMITED BY SIZE             71540023
715500                PC-DISPLAY-PO       DELIMITED BY SIZE             71550023
715600                ' - '               DELIMITED BY SIZE             71560023
715700                PC-DISPLAY-RCVR     DELIMITED BY SIZE             71570023
715800                ' - '               DELIMITED BY SIZE             71580023
715900                PC-DISPLAY-LINE     DELIMITED BY SIZE             71590023
716000                             INTO PV-CICS-MSG-AREA                71600023
716100         MOVE LENGTH OF PV-CICS-MSG-AREA                          71610023
716200                               TO PV-COMMAREA-LENGTH              71620023
716300         PERFORM 9200-WRITE-TO-CICS-LOG                           71630023
716400         PERFORM 9900-SOFT-ABORT                                  71640023
716500     ELSE                                                         71650023
716600         STRING ' RCKCS297 - '      DELIMITED BY SIZE             71660023
716700                ' 7952-UPDATE-UNITS-WRKD '                        71670023
716800                                    DELIMITED BY SIZE             71680023
716900                ' DB ERROR - SQL CODE '                           71690023
717000                                    DELIMITED BY SIZE             71700023
717100                PC-DISPLAY-SQL-CODE DELIMITED BY SIZE             71710023
717200                ' FUNC: '           DELIMITED BY SIZE             71720023
717300                PC238-BAD-TABLE-FUNCTION                          71730023
717400                                    DELIMITED BY SIZE             71740023
717500                ' TABLE: '          DELIMITED BY SIZE             71750023
717600                PC238-BAD-TABLE-NAME                              71760023
717700                                    DELIMITED BY SIZE             71770023
717800                             INTO PV-CICS-MSG-AREA                71780023
717900         MOVE LENGTH OF PV-CICS-MSG-AREA                          71790023
718000                               TO PV-COMMAREA-LENGTH              71800023
718100         PERFORM 9200-WRITE-TO-CICS-LOG                           71810023
718200         STRING ' RCKCS297 - '      DELIMITED BY SIZE             71820023
718300                ' 7952-UPDATE-UNITS-WRKD '                        71830023
718400                                    DELIMITED BY SIZE             71840023
718500                ' KEY INFO - '      DELIMITED BY SIZE             71850023
718600                PC-DISPLAY-PO       DELIMITED BY SIZE             71860023
718700                ' - '               DELIMITED BY SIZE             71870023
718800                PC-DISPLAY-RCVR     DELIMITED BY SIZE             71880023
718900                ' - '               DELIMITED BY SIZE             71890023
719000                PC-DISPLAY-LINE     DELIMITED BY SIZE             71900023
719100                             INTO PV-CICS-MSG-AREA                71910023
719200         MOVE LENGTH OF PV-CICS-MSG-AREA                          71920023
719300                               TO PV-COMMAREA-LENGTH              71930023
719400         PERFORM 9200-WRITE-TO-CICS-LOG                           71940023
719500         PERFORM 9900-SOFT-ABORT                                  71950023
719600     END-IF                                                       71960023
719700     END-IF                                                       71970023
719800     END-IF                                                       71980023
719900     END-IF                                                       71990023
720000     END-IF                                                       72000023
720100     END-IF                                                       72010023
720200     END-IF.                                                      72020023
720300                                                                  72030023
720400/                                                                 72040023
720500 7955-VERIFY-UPDATE.                                              72050023
720600                                                                  72060023
720700     EXEC SQL                                                     72070023
720800         SET :PV-TMST =  CURRENT_TIMESTAMP                        72080023
720900     END-EXEC                                                     72090023
721000                                                                  72100023
721100     MOVE PV-TMST  TO DISTHD-FCSE-CNFRMN-TMST.                    72110023
721200                                                                  72120023
721300     EXEC SQL                                                     72130023
721400         UPDATE TDISTHD                                           72140023
721500           SET FCSE_CNFRMN_TMST   = :DISTHD-FCSE-CNFRMN-TMST      72150023
721600            ,  FCSE_CNFRMN_USR_ID = :DP020-USERID                 72160023
721700            ,  FCSE_CNFRMN_PGM_ID = :PC-CURRENT-PROGRAM-NAME      72170023
721800            ,  PRCG_STAT_CDE      = :DISTHD-PRCG-STAT-CDE         72180023
721900            ,  FCSE_FCLTY_AREA_ID = :DISTHD-FCSE-FCLTY-AREA-ID    72190023
722000      WHERE ORD_NBR                  = :DK-ORD-NBR                72200023
722100        AND RCVR_SEQ_NBR             = :DK-RCVR-NBR               72210023
722200        AND ORD_LNE_NBR              = :DK-LINE-NBR               72220023
722300     END-EXEC.                                                    72230023
722400                                                                  72240023
722500     EVALUATE TRUE                                                72250023
722600         WHEN SQLCODE = ZERO                                      72260023
722700             PERFORM 7951-CONFIRM-DATE-TIME                       72270023
722800         WHEN SQLCODE = -904                                      72280023
722900         WHEN SQLCODE = -911                                      72290023
723000         WHEN SQLCODE = -913                                      72300023
723100             MOVE '7955-VERIFY-UPDATE'                            72310023
723200                                  TO DP013-PARAGRAPH              72320023
723300             MOVE SQLCODE            TO PC-DISPLAY-SQL-CODE       72330023
723400             PERFORM 9900-SOFT-ABORT                              72340023
723500                                                                  72350023
723600         WHEN SQLWARN0 NOT = SPACES                               72360023
723700         WHEN SQLCODE < ZERO                                      72370023
723800         WHEN SQLCODE > ZERO                                      72380023
723900             MOVE '7955-VERIFY-UPDATE'                            72390023
724000                                  TO DP013-PARAGRAPH              72400023
724100             MOVE 'UNSUCCESSFUL UPDATE'                           72410023
724200                                  TO DP013-MESSAGE-TEXT (1)       72420023
724300             MOVE SQLCA      TO DP013-SQLCA                       72430023
724400             MOVE 'TDISTHD ' TO DP013-DB2-TABLE-NAME (1)          72440023
724500             SET DP013-DB2-ABEND                                  72450023
724600                  DP013-NO-ROLLBACK                               72460023
724700                                  TO TRUE                         72470023
724800             PERFORM DP013-0000-PROCESS-ABEND                     72480023
724900     END-EVALUATE.                                                72490023
725000/                                                                 72500023
725100 7965-UNCONFIRM-UPDATE.                                           72510023
725200                                                                  72520023
725300     MOVE SPACES                 TO DISTHD-FCSE-CNFRMN-USR-ID     72530023
725400                                    DISTHD-FCSE-CNFRMN-PGM-ID.    72540023
725500                                                                  72550023
725600     IF LQW-LINE-CAUTION (LQW-IDX)                                72560023
725700         MOVE ' '                TO LQW-LINE-ERROR-FLAG (LQW-IDX) 72570023
725800     END-IF.                                                      72580023
725900                                                                  72590023
726000     IF DISTHD-PRCG-STAT-CDE = 'A'                                72600023
726100         CONTINUE                                                 72610023
726200     ELSE                                                         72620023
726300         IF DISTHD-RSLTS-RCVD-TMST NOT =  PC-DEFAULT-TMST         72630023
726400           AND DISTHD-P2L-CART-CNT NOT =  0                       72640023
726500             MOVE 'B'               TO DISTHD-PRCG-STAT-CDE       72650023
726600         END-IF                                                   72660023
726700     END-IF.                                                      72670023
726800                                                                  72680023
726900     IF DISTHD-PRCG-STAT-CDE = 'A'                                72690023
727000         CONTINUE                                                 72700023
727100     ELSE                                                         72710023
727200         IF (DISTHD-RSLTS-RCVD-TMST     =  PC-DEFAULT-TMST) OR    72720023
727300            (DISTHD-RSLTS-RCVD-TMST NOT =  PC-DEFAULT-TMST  AND   72730023
727400             DISTHD-P2L-CART-CNT        =  0)                     72740023
727500             MOVE 'D'                TO DISTHD-PRCG-STAT-CDE      72750023
727600             MOVE PC-DEFAULT-TMST    TO DISTHD-RSLTS-RCVD-TMST    72760023
727700         END-IF                                                   72770023
727800     END-IF.                                                      72780023
727900                                                                  72790023
728000     EXEC SQL                                                     72800023
728100         UPDATE TDISTHD                                           72810023
728200           SET FCSE_CNFRMN_TMST   = :PC-DEFAULT-TMST              72820023
728300            ,  FCSE_CNFRMN_USR_ID = :DISTHD-FCSE-CNFRMN-USR-ID    72830023
728400            ,  FCSE_CNFRMN_PGM_ID = :DISTHD-FCSE-CNFRMN-PGM-ID    72840023
728500            ,  PRCG_STAT_CDE      = :DISTHD-PRCG-STAT-CDE         72850023
728600            ,  RSLTS_RCVD_TMST    = :DISTHD-RSLTS-RCVD-TMST       72860023
728700            ,  FCSE_FCLTY_AREA_ID = :DISTHD-FCSE-FCLTY-AREA-ID    72870023
728800      WHERE ORD_NBR                  = :DK-ORD-NBR                72880023
728900        AND RCVR_SEQ_NBR             = :DK-RCVR-NBR               72890023
729000        AND ORD_LNE_NBR              = :DK-LINE-NBR               72900023
729100     END-EXEC.                                                    72910023
729200                                                                  72920023
729300     EVALUATE TRUE                                                72930023
729400         WHEN SQLCODE = ZERO                                      72940023
729500              CONTINUE                                            72950023
729600         WHEN SQLCODE = -904                                      72960023
729700         WHEN SQLCODE = -911                                      72970023
729800         WHEN SQLCODE = -913                                      72980023
729900             MOVE '7965-UNCONFIRM-UPDATE'                         72990023
730000                                  TO DP013-PARAGRAPH              73000023
730100             MOVE SQLCODE            TO PC-DISPLAY-SQL-CODE       73010023
730200             PERFORM 9900-SOFT-ABORT                              73020023
730300                                                                  73030023
730400         WHEN SQLWARN0 NOT = SPACES                               73040023
730500         WHEN SQLCODE < ZERO                                      73050023
730600         WHEN SQLCODE > ZERO                                      73060023
730700             MOVE '7965-UNCONFIRM-UPDATE'                         73070023
730800                                  TO DP013-PARAGRAPH              73080023
730900             MOVE 'UNSUCCESSFUL UPDATE TO DISTHD'                 73090023
731000                                  TO DP013-MESSAGE-TEXT (1)       73100023
731100             MOVE SQLCA      TO DP013-SQLCA                       73110023
731200             MOVE 'TDISTHD ' TO DP013-DB2-TABLE-NAME (1)          73120023
731300             SET DP013-DB2-ABEND                                  73130023
731400                  DP013-NO-ROLLBACK                               73140023
731500                                  TO TRUE                         73150023
731600             PERFORM DP013-0000-PROCESS-ABEND                     73160023
731700     END-EVALUATE.                                                73170023
731800                                                                  73180023
731900*----------------------------------------------------------------*73190023
732000 7966-UNCONFIRM-UPDATE-PK.                                        73200023
732100                                                                  73210023
732200     SET  PS-MORE-RECITM-YES  TO  TRUE.                           73220023
732300                                                                  73230023
732400     MOVE ASC-KEY-PO-NBR    TO DK-ORD-NBR.                        73240023
732500     MOVE ASC-KEY-RCVR-NBR  TO DK-RCVR-NBR.                       73250023
732600     MOVE LQW-PREPK-L4 (LQW-IDX)                                  73260023
732700                            TO DK-PREPK-ID.                       73270023
732800                                                                  73280023
732900     PERFORM 8331-OPEN-PREPK-SEARCH-CSR.                          73290023
733000                                                                  73300023
733100     PERFORM 7967-UNCONFIRM-PREPK-UPD                             73310023
733200       UNTIL PS-MORE-RECITM-NO OR PS-ERROR.                       73320023
733300                                                                  73330023
733400     PERFORM 8335-CLOSE-PREPK-SEARCH-CSR.                         73340023
733500                                                                  73350023
733600     PERFORM 9902-SYNCPOINT.                                      73360023
733700                                                                  73370023
733800*----------------------------------------------------------------*73380023
733900 7967-UNCONFIRM-PREPK-UPD.                                        73390023
734000                                                                  73400023
734100     PERFORM 8333-FETCH-PREPK-SEARCH-CSR.                         73410023
734200                                                                  73420023
734300     IF PS-MORE-RECITM-YES                                        73430023
734400         MOVE RECITM-ORD-LNE-NBR TO DK-LINE-NBR                   73440023
734500         PERFORM 7965-UNCONFIRM-UPDATE                            73450023
734600         IF RECITM-STATUS-CDE = 'VE'                              73460023
734700             CONTINUE                                             73470023
734800         ELSE                                                     73480023
734900             INITIALIZE PC238-COMM-AREA                           73490023
735000             MOVE ZEROES             TO PC238-WRKD-UNT-QTY        73500023
735100             MOVE RECITM-ORD-LNE-NBR TO ASC-KEY-LNE-NBR           73510023
735200             MOVE 'U'                TO PC238-TRANS-TYPE-CDE      73520023
735300             PERFORM 7450-SELECT-TDISTHD                          73530023
735400             MOVE DISTHD-OPER-UNT-ID TO PC238-WRKD-OPER-UNT-ID    73540023
735500             PERFORM 7952-UPDATE-UNITS-WRKD                       73550023
735600         END-IF                                                   73560023
735700     END-IF.                                                      73570023
735800*----------------------------------------------------------------*73580023
735900*----------------------------------------------------------------*73590023
736000 8000-CONFIRM.                                                    73600023
736100                                                                  73610023
736200*   THE ACTUAL CONFIRM UPDATE IS DONE IN PARAGRAPH                73620023
736300*   8210-UPDATE-VERIFY-FIELDS TO AVOID DOUBLE UPDATES TO TDISTHD. 73630023
736400*   THE CONFIRMATION FIELDS WILL BE UPDATED AND THE VERIFY FIELDS 73640023
736500*   WILL BE DONE IF ELIGIBLE.  PART OF THE VERIFY LOGIC IS        73650023
736600*   A CALL TO RCKCS200.  THIS WILL BE DONE ONLY IF A VERIFY IS    73660023
736700*   ALLOWED.  A SYNCPOINT WILL BE DONE AFTER EACH LINE IS         73670023
736800*   PROCESSED AND BEFORE RCKCS200 IS CALLED.                      73680023
736900                                                                  73690023
737000                                                                  73700023
737100     MOVE +1                       TO ASC-BLK-SUB.                73710023
737200     PERFORM 5100-WRITE-TEMP-STORAGE.                             73720023
737300     ADD +1                        TO ASC-BLK-SUB.                73730023
737400     PERFORM 5100-WRITE-TEMP-STORAGE.                             73740023
737500                                                                  73750023
737600     PERFORM 6112-READ-LIST-QUEUE.                                73760023
737700                                                                  73770023
737800     MOVE ASC-KEY-PO-NBR             TO DK-ORD-NBR                73780023
737900     MOVE ASC-KEY-RCVR-NBR           TO DK-RCVR-NBR               73790023
738000                                                                  73800023
738100     IF PV-CICS-RESP = DFHRESP (NORMAL)                           73810023
738200         PERFORM                                                  73820023
738300         VARYING LQW-IDX  FROM 1 BY 1                             73830023
738400         UNTIL   LQW-IDX > PC-ITEMS-PER-PANEL OR                  73840023
738500                 LQW-LIST-ITEM-NUMBER (LQW-IDX) = ZERO            73850023
738600                                                                  73860023
738700             IF  LQW-SELECT (LQW-IDX)                             73870023
738800                                                                  73880023
738900                 IF  LQW-LINE-PROTECT (LQW-IDX)                   73890023
739000                     SET LQW-ERROR(LQW-IDX)                       73900023
739100                         LQW-LINE-ERROR(LQW-IDX)                  73910023
739200                         PS-DONT-SUBMIT-E200                      73920023
739300                         ASC-FUNC01-CONFIRM-NO                    73930023
739400                         ASC-FUNC07-CONFIRM-NO TO TRUE            73940023
739500                     MOVE SPACE TO LQW-SELECTED-SW (LQW-IDX)      73950023
739600                     MOVE LQW-SELECTED-SW (LQW-IDX)               73960023
739700                                TO LQW-TEMP-SELECTED-SW (LQW-IDX) 73970023
739800                     MOVE PC-TSYMSG-00966  TO  DP020-MSG-NUMBER   73980023
739900                 ELSE                                             73990023
740000                     SET PS-DO-SUBMIT-E200 TO TRUE                74000023
740100                     IF ASC-PKGNG-CDE = 'I' OR 'M'                74010023
740200                         PERFORM 8001-CONFIRM-EDITS-PK            74020023
740300                     ELSE                                         74030023
740400                         MOVE LQW-PO-LINE(LQW-IDX) TO DK-LINE-NBR 74040023
740500                         PERFORM 8010-CONFIRM-EDITS               74050023
740600                     END-IF                                       74060023
740700                 END-IF                                           74070023
740800                                                                  74080023
740900                 IF LQW-NO-LINE-ERROR (LQW-IDX)                   74090023
741000                     SET LQW-DESELECT (LQW-IDX)                   74100023
741100                         LQW-UPDATE   (LQW-IDX)                   74110023
741200                                   TO  TRUE                       74120023
741300                     MOVE LQW-SELECTED-SW (LQW-IDX)               74130023
741400                                TO LQW-TEMP-SELECTED-SW (LQW-IDX) 74140023
741500                                                                  74150023
741600                     IF ASC-PKGNG-CDE = 'I' OR 'M'                74160023
741700                         PERFORM 8208-UPDATE-VERIFY-PREPK         74170023
741800                     ELSE                                         74180023
741900                         MOVE LQW-PO-LINE(LQW-IDX) TO DK-LINE-NBR 74190023
742000                         PERFORM 8210-UPDATE-VERIFY-FIELDS        74200023
742100                         IF DISTHD-PRCG-STAT-CDE = 'A'            74210023
742200                             SET PS-DONT-SUBMIT-E200 TO TRUE      74220023
742300                         END-IF                                   74230023
742400                     END-IF                                       74240023
742500                                                                  74250023
742600                     PERFORM 9000-CALL-PO-RCVR-TRKING-MOD         74260023
742700                     IF  PS-DO-SUBMIT-E200                        74270023
742800                         MOVE LQW-PO-LINE(LQW-IDX) TO DK-LINE-NBR 74280023
742900                         PERFORM 8220-START-VERIFY-MODULE         74290023
743000*                        YOUR UPDATE REQUEST HAS BEEN SUBMITTED   74300023
743100                         MOVE PC-TSYMSG-01779 TO DP020-MSG-NUMBER 74310023
743200                     ELSE                                         74320023
743300                         MOVE PC-TSYMSG-01804 TO DP020-MSG-NUMBER 74330023
743400                     END-IF                                       74340023
743500                                                                  74350023
743600                     SET DP020-MSG-WARNING TO TRUE                74360023
743700                 ELSE                                             74370023
743800                     SET LQW-DESELECT (LQW-IDX)                   74380023
743900                                      TO TRUE                     74390023
744000                     SET ASC-FUNC01-CONFIRM-NO TO TRUE            74400023
744100                     SET ASC-FUNC07-CONFIRM-NO TO TRUE            74410023
744200                     MOVE LQW-SELECTED-SW (LQW-IDX)               74420023
744300                                 TO LQW-TEMP-SELECTED-SW (LQW-IDX)74430023
744400*                    MOVE PV-ITEM     TO PV-SAVE-ITEM             74440023
744500*                    PERFORM 6111-WRITE-LIST-QUEUE                74450023
744600                 END-IF                                           74460023
744700             END-IF                                               74470023
744800         END-PERFORM                                              74480023
744900                                                                  74490023
745000     MOVE PV-ITEM      TO PV-SAVE-ITEM                            74500023
745100     PERFORM 6111-WRITE-LIST-QUEUE                                74510023
745200                                                                  74520023
745300     END-IF                                                       74530023
745400                                                                  74540023
745500     MOVE +1                     TO  ASC-BLK-SUB.                 74550023
745600     PERFORM 4410-READ-TEMP-STORAGE                               74560023
745700                                                                  74570023
745800     ADD +1                      TO  ASC-BLK-SUB                  74580023
745900                                     PV-BLOCK-NUMBER.             74590023
746000     PERFORM 4410-READ-TEMP-STORAGE                               74600023
746100     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        74610023
746200     SET ASC-FUNC01-CONFIRM-NO                                    74620023
746300         ASC-FUNC07-CONFIRM-NO  TO  TRUE.                         74630023
746400                                                                  74640023
746500*----------------------------------------------------------------*74650023
746600 8001-CONFIRM-EDITS-PK.                                           74660023
746700                                                                  74670023
746800     SET  PS-MORE-RECITM-YES  TO  TRUE.                           74680023
746900                                                                  74690023
747000     MOVE ASC-KEY-PO-NBR    TO DK-ORD-NBR.                        74700023
747100     MOVE ASC-KEY-RCVR-NBR  TO DK-RCVR-NBR.                       74710023
747200     MOVE LQW-PREPK-L4 (LQW-IDX)                                  74720023
747300                            TO DK-PREPK-ID.                       74730023
747400                                                                  74740023
747500     PERFORM 8331-OPEN-PREPK-SEARCH-CSR.                          74750023
747600                                                                  74760023
747700     PERFORM 8002-CONFIRM-PACK                                    74770023
747800       UNTIL PS-MORE-RECITM-NO OR PS-ERROR.                       74780023
747900                                                                  74790023
748000     PERFORM 8335-CLOSE-PREPK-SEARCH-CSR.                         74800023
748100                                                                  74810023
748200*----------------------------------------------------------------*74820023
748300 8002-CONFIRM-PACK.                                               74830023
748400                                                                  74840023
748500     PERFORM 8333-FETCH-PREPK-SEARCH-CSR.                         74850023
748600                                                                  74860023
748700     IF PS-MORE-RECITM-YES                                        74870023
748800         MOVE RECITM-ORD-LNE-NBR TO DK-LINE-NBR                   74880023
748900         PERFORM 8010-CONFIRM-EDITS                               74890023
749000     END-IF.                                                      74900023
749100                                                                  74910023
749200                                                                  74920023
749300*----------------------------------------------------------------*74930023
749400*                                                                *74940023
749500*----------------------------------------------------------------*74950023
749600 8010-CONFIRM-EDITS.                                              74960023
749700                                                                  74970023
749800***  MOVE LQW-PO-LINE(LQW-IDX)       TO DK-LINE-NBR               74980023
749900                                                                  74990023
750000     PERFORM 7450-SELECT-TDISTHD.                                 75000023
750100     PERFORM 7300-SUM-TDISTDT.                                    75010023
750200                                                                  75020023
750300     IF (ASC-PKGNG-CDE = 'I' OR 'M')                              75030023
750400       AND (DISTDT-PREPK-ODD-UNT-QTY > ZEROES)                    75040023
750500         SET PS-DISTDT-ODD-UNITS-YES TO TRUE                      75050023
750600     END-IF.                                                      75060023
750700                                                                  75070023
750800     EVALUATE TRUE                                                75080023
750900     WHEN DISTDT-FCSE-SPLT-UNT-QTY  =  ZEROES  AND                75090023
751000          DISTDT-INPK-SPLT-UNT-QTY  =  ZEROES  AND                75100023
751100          DISTDT-FCSE-ACTL-UNT-QTY  =  ZEROES                     75110023
751200             SET LQW-ERROR(LQW-IDX)                               75120023
751300                 LQW-LINE-ERROR(LQW-IDX)                          75130023
751400                 ASC-FUNC01-CONFIRM-NO                            75140023
751500                 PS-DONT-SUBMIT-E200           TO TRUE            75150023
751600             MOVE SPACE TO LQW-SELECTED-SW (LQW-IDX)              75160023
751700             MOVE LQW-SELECTED-SW (LQW-IDX)                       75170023
751800                                TO LQW-TEMP-SELECTED-SW (LQW-IDX) 75180023
751900             SUBTRACT 1        FROM ASC-NUMBER-OF-SELECTED-ITEMS  75190023
752000             MOVE PC-TSYMSG-01762    TO DP020-MSG-NUMBER          75200023
752100             SET DP020-MSG-WARNING        TO TRUE                 75210023
752200                                                                  75220023
752300     WHEN DISTHD-FCSE-CNFRMN-TMST NOT = PC-DEFAULT-TMST           75230023
752400         SET LQW-ERROR(LQW-IDX)                                   75240023
752500             LQW-LINE-ERROR(LQW-IDX)                              75250023
752600             PS-DONT-SUBMIT-E200                                  75260023
752700             ASC-FUNC01-CONFIRM-NO         TO TRUE                75270023
752800         MOVE SPACE TO LQW-SELECTED-SW (LQW-IDX)                  75280023
752900         MOVE LQW-SELECTED-SW (LQW-IDX)                           75290023
753000                                TO LQW-TEMP-SELECTED-SW (LQW-IDX) 75300023
753100         MOVE PC-TSYMSG-01809                                     75310023
753200                                 TO DP020-MSG-NUMBER              75320023
753300     WHEN LQW-NEED-FCSE-PROCESS-AREA (LQW-IDX)                    75330023
753400         SET LQW-ERROR(LQW-IDX)                                   75340023
753500             LQW-LINE-ERROR(LQW-IDX)                              75350023
753600             PS-DONT-SUBMIT-E200                                  75360023
753700             ASC-FUNC01-CONFIRM-NO         TO TRUE                75370023
753800         MOVE SPACE TO LQW-SELECTED-SW (LQW-IDX)                  75380023
753900         MOVE LQW-SELECTED-SW (LQW-IDX)                           75390023
754000                                TO LQW-TEMP-SELECTED-SW (LQW-IDX) 75400023
754100         MOVE PC-TSYMSG-00007                                     75410023
754200                                 TO DP020-MSG-NUMBER              75420023
754300     WHEN LQW-BAD-FCSE-PROCESS-AREA (LQW-IDX)                     75430023
754400         SET LQW-ERROR(LQW-IDX)                                   75440023
754500             LQW-LINE-ERROR(LQW-IDX)                              75450023
754600             PS-DONT-SUBMIT-E200                                  75460023
754700             ASC-FUNC01-CONFIRM-NO         TO TRUE                75470023
754800         MOVE SPACE TO LQW-SELECTED-SW (LQW-IDX)                  75480023
754900         MOVE LQW-SELECTED-SW (LQW-IDX)                           75490023
755000                                TO LQW-TEMP-SELECTED-SW (LQW-IDX) 75500023
755100         MOVE PC-TSYMSG-00005                                     75510023
755200                                 TO DP020-MSG-NUMBER              75520023
755300     END-EVALUATE.                                                75530023
755400                                                                  75540023
755500     IF  LQW-PROCESS-QTY (LQW-IDX) = ZERO  AND                    75550023
755600* DMH 2/27/04 BEGIN                                               75560023
755700         LQW-ODD-UNIT-QTY(LQW-IDX) = ZERO                         75570023
755800* DMH 2/27/04 END                                                 75580023
755900         SET  PS-PROCESS-QTY-ZERO  TO  TRUE                       75590023
756000     END-IF.                                                      75600023
756100                                                                  75610023
756200*    IF  DISTDT-FCSE-SPLT-UNT-QTY  =  ZEROES  AND                 75620023
756300*        DISTDT-INPK-SPLT-UNT-QTY  =  ZEROES  AND                 75630023
756400*        DISTDT-FCSE-ACTL-UNT-QTY  =  ZEROES                      75640023
756500*            SET LQW-ERROR(LQW-IDX)                               75650023
756600*                LQW-LINE-ERROR(LQW-IDX)                          75660023
756700*                ASC-FUNC01-CONFIRM-NO                            75670023
756800*                PS-DONT-SUBMIT-E200           TO TRUE            75680023
756900*            MOVE SPACE TO LQW-SELECTED-SW (LQW-IDX)              75690023
757000*            MOVE LQW-SELECTED-SW (LQW-IDX)                       75700023
757100*                               TO LQW-TEMP-SELECTED-SW (LQW-IDX) 75710023
757200*            SUBTRACT 1        FROM ASC-NUMBER-OF-SELECTED-ITEMS  75720023
757300*            MOVE PC-TSYMSG-01762    TO DP020-MSG-NUMBER          75730023
757400*            SET DP020-MSG-WARNING        TO TRUE                 75740023
757500*    END-IF.                                                      75750023
757600                                                                  75760023
757700                                                                  75770023
757800*----------------------------------------------------------------*75780023
757900*                                                                *75790023
758000*----------------------------------------------------------------*75800023
758100 8015-CONFIRM-ZERO-EDITS.                                         75810023
758200                                                                  75820023
758300***  MOVE LQW-PO-LINE(LQW-IDX)       TO DK-LINE-NBR               75830023
758400                                                                  75840023
758500     PERFORM 7450-SELECT-TDISTHD.                                 75850023
758600     PERFORM 7300-SUM-TDISTDT.                                    75860023
758700                                                                  75870023
758800     EVALUATE TRUE                                                75880023
758900     WHEN LQW-PROCESS-QTY (LQW-IDX) > ZERO AND                    75890023
759000         ASC-AUTO-VE-YES                                          75900023
759100         SET LQW-ERROR(LQW-IDX)                                   75910023
759200             LQW-LINE-ERROR(LQW-IDX)                              75920023
759300             PS-DONT-SUBMIT-E200                                  75930023
759400             ASC-FUNC07-CONFIRM-NO         TO TRUE                75940023
759500         MOVE SPACE TO LQW-SELECTED-SW (LQW-IDX)                  75950023
759600         MOVE LQW-SELECTED-SW (LQW-IDX)                           75960023
759700                                TO LQW-TEMP-SELECTED-SW (LQW-IDX) 75970023
759800         MOVE PC-TSYMSG-03275    TO DP020-MSG-NUMBER              75980023
759900         SET DP020-MSG-WARNING            TO TRUE                 75990023
760000         SET PS-DONT-SUBMIT-E200           TO TRUE                76000023
760100     WHEN DISTHD-FCSE-CNFRMN-TMST NOT = PC-DEFAULT-TMST           76010023
760200         SET LQW-ERROR(LQW-IDX)                                   76020023
760300             LQW-LINE-ERROR(LQW-IDX)                              76030023
760400             PS-DONT-SUBMIT-E200                                  76040023
760500             ASC-FUNC07-CONFIRM-NO         TO TRUE                76050023
760600         MOVE SPACE TO LQW-SELECTED-SW (LQW-IDX)                  76060023
760700         MOVE LQW-SELECTED-SW (LQW-IDX)                           76070023
760800                                TO LQW-TEMP-SELECTED-SW (LQW-IDX) 76080023
760900         MOVE PC-TSYMSG-01809                                     76090023
761000                                 TO DP020-MSG-NUMBER              76100023
761100     WHEN LQW-NEED-FCSE-PROCESS-AREA (LQW-IDX)                    76110023
761200         SET LQW-ERROR(LQW-IDX)                                   76120023
761300             LQW-LINE-ERROR(LQW-IDX)                              76130023
761400             PS-DONT-SUBMIT-E200                                  76140023
761500             ASC-FUNC07-CONFIRM-NO         TO TRUE                76150023
761600         MOVE SPACE TO LQW-SELECTED-SW (LQW-IDX)                  76160023
761700         MOVE LQW-SELECTED-SW (LQW-IDX)                           76170023
761800                                TO LQW-TEMP-SELECTED-SW (LQW-IDX) 76180023
761900         MOVE PC-TSYMSG-00007                                     76190023
762000                                 TO DP020-MSG-NUMBER              76200023
762100     WHEN LQW-BAD-FCSE-PROCESS-AREA (LQW-IDX)                     76210023
762200         SET LQW-ERROR(LQW-IDX)                                   76220023
762300             LQW-LINE-ERROR(LQW-IDX)                              76230023
762400             PS-DONT-SUBMIT-E200                                  76240023
762500             ASC-FUNC07-CONFIRM-NO         TO TRUE                76250023
762600         MOVE SPACE TO LQW-SELECTED-SW (LQW-IDX)                  76260023
762700         MOVE LQW-SELECTED-SW (LQW-IDX)                           76270023
762800                                TO LQW-TEMP-SELECTED-SW (LQW-IDX) 76280023
762900         MOVE PC-TSYMSG-00005                                     76290023
763000                                 TO DP020-MSG-NUMBER              76300023
763100     END-EVALUATE.                                                76310023
763200                                                                  76320023
763300     IF  LQW-NO-LINE-ERROR (LQW-IDX)                              76330023
763400         PERFORM 4500-SET-DISTRO-ZERO                             76340023
763500         MOVE  ZEROES  TO  LQW-PROCESS-QTY(LQW-IDX)               76350023
763600         SET LQW-UPDATE(LQW-IDX)  TO  TRUE                        76360023
763700         SET LQW-BLOCK-MODIFIED   TO  TRUE                        76370023
763800     END-IF.                                                      76380023
763900                                                                  76390023
764000                                                                  76400023
764100     IF  LQW-PROCESS-QTY (LQW-IDX) = ZERO                         76410023
764200         SET  PS-PROCESS-QTY-ZERO  TO  TRUE                       76420023
764300     END-IF.                                                      76430023
764400                                                                  76440023
764500                                                                  76450023
764600*----------------------------------------------------------------*76460023
764700*                                                                *76470023
764800*----------------------------------------------------------------*76480023
764900 8100-UNCONFIRM.                                                  76490023
765000                                                                  76500023
765100     MOVE +1                       TO ASC-BLK-SUB.                76510023
765200     PERFORM 5100-WRITE-TEMP-STORAGE.                             76520023
765300     ADD +1                        TO ASC-BLK-SUB.                76530023
765400     PERFORM 5100-WRITE-TEMP-STORAGE.                             76540023
765500                                                                  76550023
765600     PERFORM 6112-READ-LIST-QUEUE.                                76560023
765700                                                                  76570023
765800     MOVE ASC-KEY-PO-NBR             TO DK-ORD-NBR                76580023
765900     MOVE ASC-KEY-RCVR-NBR           TO DK-RCVR-NBR               76590023
766000                                                                  76600023
766100                                                                  76610023
766200     IF PV-CICS-RESP = DFHRESP (NORMAL)                           76620023
766300         PERFORM                                                  76630023
766400         VARYING LQW-IDX  FROM 1 BY 1                             76640023
766500         UNTIL   LQW-IDX > PC-ITEMS-PER-PANEL OR                  76650023
766600                 LQW-LIST-ITEM-NUMBER (LQW-IDX) = ZERO            76660023
766700                                                                  76670023
766800             IF  LQW-SELECT (LQW-IDX)                             76680023
766900                                                                  76690023
767000                 IF  LQW-LINE-PROTECT (LQW-IDX)                   76700023
767100                    SET LQW-ERROR(LQW-IDX)                        76710023
767200                        LQW-LINE-ERROR(LQW-IDX)  TO TRUE          76720023
767300                    MOVE SPACE TO LQW-SELECTED-SW (LQW-IDX)       76730023
767400                    MOVE LQW-SELECTED-SW (LQW-IDX)                76740023
767500                                TO LQW-TEMP-SELECTED-SW (LQW-IDX) 76750023
767600                    MOVE PC-TSYMSG-00966  TO  DP020-MSG-NUMBER    76760023
767700                 ELSE                                             76770023
767800                     IF ASC-PKGNG-CDE = 'I' OR 'M'                76780023
767900                         PERFORM 8106-UNCONFIRM-EDITS-PK          76790023
768000                     ELSE                                         76800023
768100                         PERFORM 8105-UNCONFIRM-EDITS             76810023
768200                     END-IF                                       76820023
768300                 END-IF                                           76830023
768400                                                                  76840023
768500             END-IF                                               76850023
768600         END-PERFORM                                              76860023
768700                                                                  76870023
768800     MOVE PV-ITEM      TO PV-SAVE-ITEM                            76880023
768900     PERFORM 6111-WRITE-LIST-QUEUE                                76890023
769000                                                                  76900023
769100     END-IF                                                       76910023
769200                                                                  76920023
769300     MOVE +1                     TO  ASC-BLK-SUB.                 76930023
769400     PERFORM 4410-READ-TEMP-STORAGE                               76940023
769500                                                                  76950023
769600     ADD +1                      TO  ASC-BLK-SUB                  76960023
769700                                     PV-BLOCK-NUMBER.             76970023
769800     PERFORM 4410-READ-TEMP-STORAGE                               76980023
769900     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        76990023
770000                                                                  77000023
770100*----------------------------------------------------------------*77010023
770200 8105-UNCONFIRM-EDITS.                                            77020023
770300                                                                  77030023
770400     MOVE LQW-PO-LINE(LQW-IDX) TO DK-LINE-NBR.                    77040023
770500     PERFORM 7655-SELECT-CONFIRM-TMST.                            77050023
770600     IF DISTHD-FCSE-CNFRMN-TMST NOT = PC-DEFAULT-TMST             77060023
770700         PERFORM 7500-RECITM-STATUS                               77070023
770800                                                                  77080023
770900         IF RECITM-STATUS-CDE NOT = 'VE'                          77090023
771000             SET ASC-CONFIRM-YES      TO TRUE                     77100023
771100             MOVE PC-TSYMSG-01761     TO DP020-MSG-NUMBER         77110023
771200             SET DP020-MSG-WARNING        TO TRUE                 77120023
771300         ELSE                                                     77130023
771400             SET PS-ERROR                                         77140023
771500                 LQW-ERROR(LQW-IDX)                               77150023
771600                 LQW-LINE-ERROR(LQW-IDX)                          77160023
771700                 ASC-CONFIRM-NO       TO TRUE                     77170023
771800             MOVE SPACE TO LQW-SELECTED-SW (LQW-IDX)              77180023
771900             MOVE LQW-SELECTED-SW (LQW-IDX)                       77190023
772000                                TO LQW-TEMP-SELECTED-SW (LQW-IDX) 77200023
772100             MOVE PC-TSYMSG-00929     TO DP020-MSG-NUMBER         77210023
772200             SET DP020-MSG-FATAL          TO TRUE                 77220023
772300     ELSE                                                         77230023
772400         SET PS-ERROR                                             77240023
772500             LQW-ERROR(LQW-IDX)                                   77250023
772600             LQW-LINE-ERROR(LQW-IDX)                              77260023
772700             ASC-CONFIRM-NO           TO TRUE                     77270023
772800         MOVE SPACE TO LQW-SELECTED-SW (LQW-IDX)                  77280023
772900         MOVE LQW-SELECTED-SW (LQW-IDX)                           77290023
773000                                TO LQW-TEMP-SELECTED-SW (LQW-IDX) 77300023
773100         MOVE PC-TSYMSG-01763         TO DP020-MSG-NUMBER         77310023
773200         SET DP020-MSG-FATAL          TO TRUE                     77320023
773300     END-IF.                                                      77330023
773400                                                                  77340023
773500*----------------------------------------------------------------*77350023
773600 8106-UNCONFIRM-EDITS-PK.                                         77360023
773700                                                                  77370023
773800     SET PS-MORE-RECITM-YES TO TRUE.                              77380023
773900                                                                  77390023
774000     MOVE ASC-KEY-PO-NBR    TO DK-ORD-NBR.                        77400023
774100     MOVE ASC-KEY-RCVR-NBR  TO DK-RCVR-NBR.                       77410023
774200     MOVE LQW-PREPK-L4 (LQW-IDX)                                  77420023
774300                            TO DK-PREPK-ID.                       77430023
774400                                                                  77440023
774500     PERFORM 8331-OPEN-PREPK-SEARCH-CSR.                          77450023
774600                                                                  77460023
774700     PERFORM 8107-UNCONFIRM-PREPK                                 77470023
774800       UNTIL PS-MORE-RECITM-NO OR PS-ERROR.                       77480023
774900                                                                  77490023
775000     PERFORM 8335-CLOSE-PREPK-SEARCH-CSR.                         77500023
775100                                                                  77510023
775200*----------------------------------------------------------------*77520023
775300 8107-UNCONFIRM-PREPK.                                            77530023
775400                                                                  77540023
775500     PERFORM 8333-FETCH-PREPK-SEARCH-CSR.                         77550023
775600                                                                  77560023
775700     IF PS-MORE-RECITM-YES                                        77570023
775800         MOVE RECITM-ORD-LNE-NBR TO DK-LINE-NBR                   77580023
775900         PERFORM 7655-SELECT-CONFIRM-TMST                         77590023
776000         IF DISTHD-FCSE-CNFRMN-TMST NOT = PC-DEFAULT-TMST         77600023
776100             IF RECITM-STATUS-CDE NOT = 'VE'                      77610023
776200                 SET ASC-CONFIRM-YES    TO TRUE                   77620023
776300                 MOVE PC-TSYMSG-01761   TO DP020-MSG-NUMBER       77630023
776400                 SET DP020-MSG-WARNING  TO TRUE                   77640023
776500             ELSE                                                 77650023
776600                 SET PS-ERROR                                     77660023
776700                     LQW-ERROR(LQW-IDX)                           77670023
776800                     LQW-LINE-ERROR(LQW-IDX)                      77680023
776900                     ASC-CONFIRM-NO     TO TRUE                   77690023
777000                 MOVE SPACE TO LQW-SELECTED-SW (LQW-IDX)          77700023
777100                 MOVE LQW-SELECTED-SW (LQW-IDX)                   77710023
777200                            TO LQW-TEMP-SELECTED-SW (LQW-IDX)     77720023
777300                 MOVE PC-TSYMSG-00929   TO DP020-MSG-NUMBER       77730023
777400                 SET DP020-MSG-FATAL    TO TRUE                   77740023
777500             END-IF                                               77750023
777600         ELSE                                                     77760023
777700             SET PS-ERROR                                         77770023
777800                 LQW-ERROR(LQW-IDX)                               77780023
777900                 LQW-LINE-ERROR(LQW-IDX)                          77790023
778000                 ASC-CONFIRM-NO         TO TRUE                   77800023
778100             MOVE SPACE TO LQW-SELECTED-SW (LQW-IDX)              77810023
778200             MOVE LQW-SELECTED-SW (LQW-IDX)                       77820023
778300                        TO LQW-TEMP-SELECTED-SW (LQW-IDX)         77830023
778400             MOVE PC-TSYMSG-01763       TO DP020-MSG-NUMBER       77840023
778500             SET DP020-MSG-FATAL        TO TRUE                   77850023
778600         END-IF                                                   77860023
778700     END-IF.                                                      77870023
778800                                                                  77880023
778900                                                                  77890023
779000 8110-PROCESS-UNCONFIRM.                                          77900023
779100*  THIS IS PERFORMED ONLY AFTER THE USER HAS PRESSED F2 TO        77910023
779200*  CONFIRM DOING THIS FUNCTION.                                   77920023
779300                                                                  77930023
779400     MOVE +1                       TO ASC-BLK-SUB.                77940023
779500     PERFORM 5100-WRITE-TEMP-STORAGE.                             77950023
779600     ADD +1                        TO ASC-BLK-SUB.                77960023
779700     PERFORM 5100-WRITE-TEMP-STORAGE.                             77970023
779800                                                                  77980023
779900     PERFORM 6112-READ-LIST-QUEUE.                                77990023
780000                                                                  78000023
780100     MOVE ASC-KEY-PO-NBR             TO DK-ORD-NBR                78010023
780200     MOVE ASC-KEY-RCVR-NBR           TO DK-RCVR-NBR               78020023
780300                                                                  78030023
780400                                                                  78040023
780500     IF PV-CICS-RESP = DFHRESP (NORMAL)                           78050023
780600         PERFORM                                                  78060023
780700         VARYING LQW-IDX  FROM 1 BY 1                             78070023
780800         UNTIL   LQW-IDX > PC-ITEMS-PER-PANEL OR                  78080023
780900                 LQW-LIST-ITEM-NUMBER (LQW-IDX) = ZERO            78090023
781000                                                                  78100023
781100             IF LQW-SELECT (LQW-IDX)                              78110023
781200                 IF ASC-PKGNG-CDE = 'I' OR 'M'                    78120023
781300                     PERFORM 8106-UNCONFIRM-EDITS-PK              78130023
781400                 ELSE                                             78140023
781500                     PERFORM 8105-UNCONFIRM-EDITS                 78150023
781600                 END-IF                                           78160023
781700                                                                  78170023
781800                 IF LQW-NO-LINE-ERROR(LQW-IDX)                    78180023
781900                     MOVE LQW-PO-LINE(LQW-IDX) TO DK-LINE-NBR     78190023
782000                     MOVE LQW-FCSE-AREA(LQW-IDX)                  78200023
782100                                  TO DISTHD-FCSE-FCLTY-AREA-ID    78210023
782200                                                                  78220023
782300                     IF ASC-PKGNG-CDE = 'I' OR 'M'                78230023
782400                         PERFORM 7966-UNCONFIRM-UPDATE-PK         78240023
782500                     ELSE                                         78250023
782600                         PERFORM 7965-UNCONFIRM-UPDATE            78260023
782700                         IF RECITM-STATUS-CDE = 'VE'              78270023
782800                             CONTINUE                             78280023
782900                         ELSE                                     78290023
783000                             INITIALIZE PC238-COMM-AREA           78300023
783100                             MOVE ZEROES TO    PC238-WRKD-UNT-QTY 78310023
783200                             MOVE LQW-PO-LINE(LQW-IDX) TO         78320023
783300                                                  ASC-KEY-LNE-NBR 78330023
783400                             MOVE 'U'    TO PC238-TRANS-TYPE-CDE  78340023
783500                             PERFORM 7450-SELECT-TDISTHD          78350023
783600                             MOVE DISTHD-OPER-UNT-ID TO           78360023
783700                                           PC238-WRKD-OPER-UNT-ID 78370023
783800                             PERFORM 7952-UPDATE-UNITS-WRKD       78380023
783900                         END-IF                                   78390023
784000                     END-IF                                       78400023
784100                                                                  78410023
784200                     SET LQW-DESELECT (LQW-IDX)                   78420023
784300                         LQW-UPDATE   (LQW-IDX)                   78430023
784400                                        TO  TRUE                  78440023
784500                     MOVE LQW-SELECTED-SW (LQW-IDX)               78450023
784600                                TO LQW-TEMP-SELECTED-SW (LQW-IDX) 78460023
784700                     MOVE SPACES      TO LQW-CONF-DATE(LQW-IDX)   78470023
784800                                         LQW-CONF-TIME(LQW-IDX)   78480023
784900                     PERFORM 4308A-LINE-STATUS                    78490023
785000                     IF NOT (ASC-PKGNG-CDE = 'I' OR 'M')          78500023
785100                         PERFORM 9902-SYNCPOINT                   78510023
785200                     END-IF                                       78520023
785300                 END-IF                                           78530023
785400             END-IF                                               78540023
785500         END-PERFORM                                              78550023
785600                                                                  78560023
785700         MOVE PV-ITEM      TO PV-SAVE-ITEM                        78570023
785800         PERFORM 6111-WRITE-LIST-QUEUE                            78580023
785900     END-IF                                                       78590023
786000                                                                  78600023
786100     IF PS-NO-ERROR                                               78610023
786200         SET ASC-CONFIRM-NO           TO TRUE                     78620023
786300         MOVE PC-TSYMSG-00059 TO DP020-MSG-NUMBER                 78630023
786400     END-IF                                                       78640023
786500                                                                  78650023
786600     MOVE +1                     TO  ASC-BLK-SUB.                 78660023
786700     PERFORM 4410-READ-TEMP-STORAGE                               78670023
786800                                                                  78680023
786900     ADD +1                      TO  ASC-BLK-SUB                  78690023
787000                                     PV-BLOCK-NUMBER.             78700023
787100     PERFORM 4410-READ-TEMP-STORAGE                               78710023
787200     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        78720023
787300                                                                  78730023
787400                                                                  78740023
787500/                                                                 78750023
787600 8200-VERIFY.                                                     78760023
787700                                                                  78770023
787800     MOVE +1                       TO ASC-BLK-SUB.                78780023
787900     PERFORM 5100-WRITE-TEMP-STORAGE.                             78790023
788000     ADD +1                        TO ASC-BLK-SUB.                78800023
788100     PERFORM 5100-WRITE-TEMP-STORAGE.                             78810023
788200                                                                  78820023
788300     PERFORM 6112-READ-LIST-QUEUE.                                78830023
788400                                                                  78840023
788500     MOVE ASC-KEY-PO-NBR           TO DK-ORD-NBR.                 78850023
788600     MOVE ASC-KEY-RCVR-NBR         TO DK-RCVR-NBR.                78860023
788700                                                                  78870023
788800*  THE FOLLOWING EDITS ARE AT THE RECEIVER LEVEL                  78880023
788900                                                                  78890023
789000     IF PV-CICS-RESP = DFHRESP (NORMAL)                           78900023
789100         PERFORM 7560-CHECK-IF-ARRIVED                            78910023
789200     END-IF                                                       78920023
789300                                                                  78930023
789400*  END OF RECEIVER LEVEL EDITS                                    78940023
789500                                                                  78950023
789600     IF PV-CICS-RESP = DFHRESP (NORMAL)                           78960023
789700         PERFORM                                                  78970023
789800         VARYING LQW-IDX  FROM 1 BY 1                             78980023
789900         UNTIL   LQW-IDX > PC-ITEMS-PER-PANEL OR                  78990023
790000                 LQW-LIST-ITEM-NUMBER (LQW-IDX) = ZERO            79000023
790100                                                                  79010023
790200             IF LQW-SELECT (LQW-IDX)                              79020023
790300                                                                  79030023
790400                 IF  LQW-LINE-PROTECT (LQW-IDX)                   79040023
790500                     SET LQW-ERROR(LQW-IDX)                       79050023
790600                         LQW-LINE-ERROR(LQW-IDX)  TO TRUE         79060023
790700                     MOVE SPACE TO LQW-SELECTED-SW (LQW-IDX)      79070023
790800                     MOVE LQW-SELECTED-SW (LQW-IDX)               79080023
790900                                TO LQW-TEMP-SELECTED-SW (LQW-IDX) 79090023
791000                     MOVE PC-TSYMSG-00966  TO  DP020-MSG-NUMBER   79100023
791100                                                                  79110023
791200                 ELSE                                             79120023
791300                     IF ASC-PKGNG-CDE = 'I' OR 'M'                79130023
791400                         PERFORM 8201-PACK-VERIFY                 79140023
791500                     ELSE                                         79150023
791600                         MOVE LQW-PO-LINE(LQW-IDX) TO DK-LINE-NBR 79160023
791700                         PERFORM 8205-VERIFY-LINE                 79170023
791800                     END-IF                                       79180023
791900                                                                  79190023
792000                 END-IF                                           79200023
792100             END-IF                                               79210023
792200         END-PERFORM                                              79220023
792300                                                                  79230023
792400         MOVE PV-ITEM TO PV-SAVE-ITEM                             79240023
792500         PERFORM 6111-WRITE-LIST-QUEUE                            79250023
792600                                                                  79260023
792700     END-IF.                                                      79270023
792800                                                                  79280023
792900     MOVE +1 TO  ASC-BLK-SUB.                                     79290023
793000     PERFORM 4410-READ-TEMP-STORAGE                               79300023
793100                                                                  79310023
793200     ADD +1  TO  ASC-BLK-SUB                                      79320023
793300                 PV-BLOCK-NUMBER.                                 79330023
793400     PERFORM 4410-READ-TEMP-STORAGE                               79340023
793500     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        79350023
793600                                                                  79360023
793700*----------------------------------------------------------------*79370023
793800 8201-PACK-VERIFY.                                                79380023
793900                                                                  79390023
794000     SET  PS-MORE-RECITM-YES  TO  TRUE.                           79400023
794100                                                                  79410023
794200     MOVE ASC-KEY-PO-NBR    TO DK-ORD-NBR.                        79420023
794300     MOVE ASC-KEY-RCVR-NBR  TO DK-RCVR-NBR.                       79430023
794400     MOVE LQW-PREPK-L4 (LQW-IDX)                                  79440023
794500                            TO DK-PREPK-ID.                       79450023
794600                                                                  79460023
794700     PERFORM 8331-OPEN-PREPK-SEARCH-CSR.                          79470023
794800                                                                  79480023
794900     PERFORM 8202-PACK-VERIFY-LINE                                79490023
795000       UNTIL PS-MORE-RECITM-NO OR PS-ERROR.                       79500023
795100                                                                  79510023
795200     PERFORM 8335-CLOSE-PREPK-SEARCH-CSR.                         79520023
795300                                                                  79530023
795400*----------------------------------------------------------------*79540023
795500 8202-PACK-VERIFY-LINE.                                           79550023
795600                                                                  79560023
795700     PERFORM 8333-FETCH-PREPK-SEARCH-CSR.                         79570023
795800                                                                  79580023
795900     IF PS-MORE-RECITM-YES                                        79590023
796000         MOVE RECITM-ORD-LNE-NBR TO DK-LINE-NBR                   79600023
796100         PERFORM 8205-VERIFY-LINE                                 79610023
796200     END-IF.                                                      79620023
796300                                                                  79630023
796400*JPL-------------------------------------------------------------*79640023
796500 8205-VERIFY-LINE.                                                79650023
796600                                                                  79660023
796700     PERFORM 7450-SELECT-TDISTHD.                                 79670023
796800                                                                  79680023
796900     PERFORM 7300-SUM-TDISTDT.                                    79690023
797000                                                                  79700023
797100     IF DISTHD-PRCG-STAT-CDE = 'A'                                79710023
797200         SET LQW-ERROR(LQW-IDX)                                   79720023
797300             LQW-LINE-ERROR(LQW-IDX) TO TRUE                      79730023
797400         MOVE SPACE TO LQW-SELECTED-SW (LQW-IDX)                  79740023
797500         MOVE LQW-SELECTED-SW (LQW-IDX)                           79750023
797600           TO LQW-TEMP-SELECTED-SW (LQW-IDX)                      79760023
797700         SET DP020-MSG-FATAL  TO TRUE                             79770023
797800         MOVE PC-TSYMSG-02483 TO DP020-MSG-NUMBER                 79780023
797900     ELSE                                                         79790023
798000     IF (DISTHD-RSLTS-RCVD-TMST = PC-DEFAULT-TMST                 79800023
798100       AND (DISTDT-P2L-SPLT-UNT-QTY > ZEROES                      79810023
798200        OR DISTDT-ACTL-ALLOC-QTY > ZEROES))                       79820023
798300       AND (DISTHD-FCSE-CNFRMN-TMST = PC-DEFAULT-TMST             79830023
798400       AND (DISTDT-FCSE-SPLT-UNT-QTY > ZEROES                     79840023
798500        OR DISTDT-INPK-SPLT-UNT-QTY > ZEROES                      79850023
798600        OR DISTDT-FCSE-ACTL-UNT-QTY > ZEROES))                    79860023
798700         SET LQW-ERROR(LQW-IDX)                                   79870023
798800             LQW-LINE-ERROR(LQW-IDX) TO TRUE                      79880023
798900         MOVE SPACE TO LQW-SELECTED-SW (LQW-IDX)                  79890023
799000         MOVE LQW-SELECTED-SW (LQW-IDX)                           79900023
799100           TO LQW-TEMP-SELECTED-SW (LQW-IDX)                      79910023
799200         SET DP020-MSG-FATAL  TO TRUE                             79920023
799300         MOVE PC-TSYMSG-01810 TO DP020-MSG-NUMBER                 79930023
799400     ELSE                                                         79940023
799500         IF DISTHD-RSLTS-RCVD-TMST = PC-DEFAULT-TMST              79950023
799600           AND (DISTDT-P2L-SPLT-UNT-QTY > ZEROES                  79960023
799700            OR DISTDT-ACTL-ALLOC-QTY > ZEROES)                    79970023
799800             SET LQW-ERROR(LQW-IDX)                               79980023
799900                 LQW-LINE-ERROR(LQW-IDX) TO TRUE                  79990023
800000             MOVE SPACE TO LQW-SELECTED-SW (LQW-IDX)              80000023
800100             MOVE LQW-SELECTED-SW (LQW-IDX)                       80010023
800200               TO LQW-TEMP-SELECTED-SW (LQW-IDX)                  80020023
800300             SET DP020-MSG-FATAL  TO TRUE                         80030023
800400             MOVE PC-TSYMSG-01811 TO DP020-MSG-NUMBER             80040023
800500         ELSE                                                     80050023
800600             IF DISTHD-FCSE-CNFRMN-TMST = PC-DEFAULT-TMST         80060023
800700               AND (DISTDT-FCSE-SPLT-UNT-QTY > ZEROES             80070023
800800                OR DISTDT-INPK-SPLT-UNT-QTY >  ZEROES             80080023
800900                OR DISTDT-FCSE-ACTL-UNT-QTY >  ZEROES)            80090023
801000                 SET LQW-ERROR(LQW-IDX)                           80100023
801100                     LQW-LINE-ERROR(LQW-IDX)  TO TRUE             80110023
801200                 MOVE SPACE TO LQW-SELECTED-SW (LQW-IDX)          80120023
801300                 MOVE LQW-SELECTED-SW (LQW-IDX)                   80130023
801400                   TO LQW-TEMP-SELECTED-SW (LQW-IDX)              80140023
801500                 MOVE PC-TSYMSG-01763 TO DP020-MSG-NUMBER         80150023
801600             ELSE                                                 80160023
801700                 SET LQW-DESELECT (LQW-IDX)                       80170023
801800                     LQW-UPDATE   (LQW-IDX) TO TRUE               80180023
801900                 MOVE LQW-SELECTED-SW (LQW-IDX)                   80190023
802000                   TO LQW-TEMP-SELECTED-SW (LQW-IDX)              80200023
802100                 PERFORM 8215-UPDATE-PRCS-CDE                     80210023
802200                 PERFORM 7570-CALL-VEM-MODULE                     80220023
802300                 IF RECITM-STATUS-CDE NOT = 'VE'                  80230023
802400                   AND RC038-VERIFY-YES                           80240023
802500                   AND PS-ARRIVED                                 80250023
802600                     PERFORM 8220-START-VERIFY-MODULE             80260023
802700                     SET DP020-MSG-FATAL   TO TRUE                80270023
802800                     MOVE PC-TSYMSG-01110  TO DP020-MSG-NUMBER    80280023
802900                     SET DP020-MSG-WARNING TO TRUE                80290023
803000                 ELSE                                             80300023
803100                     MOVE PC-TSYMSG-01806  TO DP020-MSG-NUMBER    80310023
803200                     SET DP020-MSG-WARNING TO TRUE                80320023
803300                 END-IF                                           80330023
803400             END-IF                                               80340023
803500         END-IF                                                   80350023
803600     END-IF.                                                      80360023
803700                                                                  80370023
803800*----------------------------------------------------------------*80380023
803900 8208-UPDATE-VERIFY-PREPK.                                        80390023
804000                                                                  80400023
804100     SET PS-MORE-RECITM-YES  TO  TRUE.                            80410023
804200                                                                  80420023
804300     MOVE ASC-KEY-PO-NBR    TO DK-ORD-NBR.                        80430023
804400     MOVE ASC-KEY-RCVR-NBR  TO DK-RCVR-NBR.                       80440023
804500     MOVE LQW-PREPK-L4 (LQW-IDX)                                  80450023
804600                            TO DK-PREPK-ID.                       80460023
804700                                                                  80470023
804800     PERFORM 8331-OPEN-PREPK-SEARCH-CSR.                          80480023
804900                                                                  80490023
805000     PERFORM 8209-UPDATE-VERIFY-PREPK-LINE                        80500023
805100       UNTIL PS-MORE-RECITM-NO OR PS-ERROR.                       80510023
805200                                                                  80520023
805300     PERFORM 8335-CLOSE-PREPK-SEARCH-CSR.                         80530023
805400                                                                  80540023
805500     PERFORM 9902-SYNCPOINT.                                      80550023
805600                                                                  80560023
805700*----------------------------------------------------------------*80570023
805800 8209-UPDATE-VERIFY-PREPK-LINE.                                   80580023
805900                                                                  80590023
806000     PERFORM 8333-FETCH-PREPK-SEARCH-CSR.                         80600023
806100                                                                  80610023
806200     IF PS-MORE-RECITM-YES                                        80620023
806300         MOVE RECITM-ORD-LNE-NBR TO DK-LINE-NBR                   80630023
806400         PERFORM 8210-UPDATE-VERIFY-FIELDS                        80640023
806500         IF DISTHD-PRCG-STAT-CDE = 'A'                            80650023
806600             SET PS-DONT-SUBMIT-E200 TO TRUE                      80660023
806700         END-IF                                                   80670023
806800     END-IF.                                                      80680023
806900                                                                  80690023
807000*----------------------------------------------------------------*80700023
807100 8210-UPDATE-VERIFY-FIELDS.                                       80710023
807200                                                                  80720023
807300***  MOVE LQW-PO-LINE(LQW-IDX)       TO DK-LINE-NBR.              80730023
807400                                                                  80740023
807500* THIS MAY HAVE ALREADY BEEN DONE IN PARA 8010-CONFIRM-EDITS      80750023
807600     MOVE LQW-PREPK-L4(LQW-IDX)      TO DK-PREPK-ID.              80760023
807700     PERFORM 7570-CALL-VEM-MODULE.                                80770023
807800                                                                  80780023
807900     PERFORM 7450-SELECT-TDISTHD                                  80790023
808000                                                                  80800023
808100***  PERFORM 7550-FREIGHT-BILL.                                   80810023
808200***  PERFORM 7560-CHECK-IF-ARRIVED.                               80820023
808300                                                                  80830023
808400     PERFORM 7500-RECITM-STATUS.                                  80840023
808500     PERFORM 7300-SUM-TDISTDT.                                    80850023
808600                                                                  80860023
808700***  PERFORM 7600-COUNT-RCVR-TROUBLES.                            80870023
808800***  IF PV-TRBL-RCVR-COUNT = ZERO                                 80880023
808900***      PERFORM 7650-INVENTORY-CHECK                             80890023
809000***  END-IF.                                                      80900023
809100                                                                  80910023
809200***  MOVE LQW-FCSE-AREA(LQW-IDX) TO DISTHD-FCSE-FCLTY-AREA-ID.    80920023
809300                                                                  80930023
809400     IF DISTHD-RSLTS-RCVD-TMST NOT = PC-DEFAULT-TMST              80940023
809500         IF DISTDT-P2L-SPLT-UNT-QTY > ZERO                        80950023
809600             IF DISTHD-PRCG-STAT-CDE = 'A'                        80960023
809700                 MOVE 'A'             TO DISTHD-PRCG-STAT-CDE     80970023
809800             ELSE                                                 80980023
809900*** DMH      IF RECITM-STATUS-CDE = 'VE'                          80990023
810000             IF RC038-LINE-ALREADY-VE                             81000023
810100                 MOVE 'P'             TO DISTHD-PRCG-STAT-CDE     81010023
810200             ELSE                                                 81020023
810300*** DMH          IF PV-FREIGHT-COUNT = ZERO                       81030023
810400                 IF RC038-NO-PRO                                  81040023
810500                     MOVE 'F'         TO DISTHD-PRCG-STAT-CDE     81050023
810600                 ELSE                                             81060023
810700*** DMH          IF PS-NOT-ARRIVED                                81070023
810800                 IF RC038-NOT-ARRIVED                             81080023
810900                     MOVE 'G'         TO DISTHD-PRCG-STAT-CDE     81090023
811000                 ELSE                                             81100023
811100                     MOVE 'R'         TO DISTHD-PRCG-STAT-CDE     81110023
811200                 END-IF                                           81120023
811300                 END-IF                                           81130023
811400             END-IF                                               81140023
811500             END-IF                                               81150023
811600*            UPDATE FULLCASE FIELDS AND PROCESS CODE              81160023
811700             PERFORM 7955-VERIFY-UPDATE                           81170023
811800             IF RECITM-STATUS-CDE = 'VE'                          81180023
811900                 CONTINUE                                         81190023
812000             ELSE                                                 81200023
812100                 INITIALIZE PC238-COMM-AREA                       81210023
812200                 COMPUTE PC238-WRKD-UNT-QTY =                     81220023
812300                 DISTDT-FCSE-ACTL-UNT-QTY +                       81230023
812400                                          DISTDT-PREPK-ODD-UNT-QTY81240023
812500                 MOVE DK-LINE-NBR TO ASC-KEY-LNE-NBR              81250023
812600                 MOVE 'C'         TO PC238-TRANS-TYPE-CDE         81260023
812700                 PERFORM 7450-SELECT-TDISTHD                      81270023
812800                 MOVE DISTHD-OPER-UNT-ID TO PC238-WRKD-OPER-UNT-ID81280023
812900                 PERFORM 7952-UPDATE-UNITS-WRKD                   81290023
813000             END-IF                                               81300023
813100             IF NOT (ASC-PKGNG-CDE = 'I' OR 'M')                  81310023
813200                 PERFORM 9902-SYNCPOINT                           81320023
813300             END-IF                                               81330023
813400         END-IF                                                   81340023
813500     ELSE                                                         81350023
813600*        PACK TO LIGHT HAS NOT BEEN WORKED YET, UPDATE FCSE FIELDS81360023
813700*        ELSE                                                     81370023
813800         IF DISTHD-PRCG-STAT-CDE = 'A'                            81380023
813900             MOVE 'A'         TO DISTHD-PRCG-STAT-CDE             81390023
814000         ELSE                                                     81400023
814100         IF DISTDT-P2L-SPLT-UNT-QTY > ZERO                        81410023
814200            SET PS-DONT-SUBMIT-E200 TO TRUE                       81420023
814300            MOVE 'B'          TO DISTHD-PRCG-STAT-CDE             81430023
814400         ELSE                                                     81440023
814500*** DMH     IF PV-FREIGHT-COUNT = ZERO                            81450023
814600            IF RC038-NO-PRO                                       81460023
814700                MOVE 'F'         TO DISTHD-PRCG-STAT-CDE          81470023
814800            ELSE                                                  81480023
814900*** DMH     IF PS-NOT-ARRIVED                                     81490023
815000            IF RC038-NOT-ARRIVED                                  81500023
815100                MOVE 'G'         TO DISTHD-PRCG-STAT-CDE          81510023
815200            ELSE                                                  81520023
815300                MOVE 'R'          TO DISTHD-PRCG-STAT-CDE         81530023
815400            END-IF                                                81540023
815500            END-IF                                                81550023
815600         END-IF                                                   81560023
815700         END-IF                                                   81570023
815800                                                                  81580023
815900         MOVE LQW-FCSE-AREA(LQW-IDX) TO DISTHD-FCSE-FCLTY-AREA-ID 81590023
816000         PERFORM 7950-CONFIRM-UPDATE                              81600023
816100         IF RECITM-STATUS-CDE = 'VE'                              81610023
816200             CONTINUE                                             81620023
816300         ELSE                                                     81630023
816400             INITIALIZE PC238-COMM-AREA                           81640023
816500             PERFORM 7300-SUM-TDISTDT                             81650023
816600             COMPUTE PC238-WRKD-UNT-QTY =                         81660023
816700               DISTDT-FCSE-ACTL-UNT-QTY + DISTDT-PREPK-ODD-UNT-QTY81670023
816800             MOVE DISTHD-ORD-LNE-NBR TO ASC-KEY-LNE-NBR           81680023
816900             MOVE 'C'                TO PC238-TRANS-TYPE-CDE      81690023
817000             PERFORM 7450-SELECT-TDISTHD                          81700023
817100             MOVE DISTHD-OPER-UNT-ID TO PC238-WRKD-OPER-UNT-ID    81710023
817200             PERFORM 7952-UPDATE-UNITS-WRKD                       81720023
817300         END-IF                                                   81730023
817400                                                                  81740023
817500         IF NOT (ASC-PKGNG-CDE = 'I' OR 'M')                      81750023
817600             PERFORM 9902-SYNCPOINT                               81760023
817700         END-IF                                                   81770023
817800     END-IF.                                                      81780023
817900                                                                  81790023
818000     PERFORM 4308A-LINE-STATUS.                                   81800023
818100                                                                  81810023
818200*----------------------------------------------------------------*81820023
818300 8215-UPDATE-PRCS-CDE.                                            81830023
818400                                                                  81840023
818500     MOVE ASC-KEY-PO-NBR           TO DK-ORD-NBR.                 81850023
818600     MOVE ASC-KEY-RCVR-NBR         TO DK-RCVR-NBR.                81860023
818700***  MOVE LQW-PO-LINE(LQW-IDX)     TO DK-LINE-NBR.                81870023
818800                                                                  81880023
818900     IF DISTHD-PRCG-STAT-CDE = 'A'                                81890023
819000         MOVE 'A'         TO DISTHD-PRCG-STAT-CDE                 81900023
819100     ELSE                                                         81910023
819200     IF PV-FREIGHT-COUNT = ZERO                                   81920023
819300         MOVE 'F'         TO DISTHD-PRCG-STAT-CDE                 81930023
819400     ELSE                                                         81940023
819500     IF PS-NOT-ARRIVED                                            81950023
819600         MOVE 'G'         TO DISTHD-PRCG-STAT-CDE                 81960023
819700     ELSE                                                         81970023
819800         MOVE 'R'         TO DISTHD-PRCG-STAT-CDE                 81980023
819900     END-IF                                                       81990023
820000     END-IF                                                       82000023
820100     END-IF.                                                      82010023
820200                                                                  82020023
820300     EXEC SQL                                                     82030023
820400         UPDATE  TDISTHD                                          82040023
820500           SET PRCG_STAT_CDE      = :DISTHD-PRCG-STAT-CDE         82050023
820600      WHERE ORD_NBR                  = :DK-ORD-NBR                82060023
820700        AND RCVR_SEQ_NBR             = :DK-RCVR-NBR               82070023
820800        AND ORD_LNE_NBR              = :DK-LINE-NBR               82080023
820900     END-EXEC.                                                    82090023
821000                                                                  82100023
821100     EVALUATE TRUE                                                82110023
821200         WHEN SQLCODE = ZERO                                      82120023
821300             PERFORM 4308A-LINE-STATUS                            82130023
821400         WHEN SQLCODE = -904                                      82140023
821500         WHEN SQLCODE = -911                                      82150023
821600         WHEN SQLCODE = -913                                      82160023
821700             MOVE '8215-UPD-PRCS-CDE  '                           82170023
821800                                  TO DP013-PARAGRAPH              82180023
821900             MOVE SQLCODE            TO PC-DISPLAY-SQL-CODE       82190023
822000             PERFORM 9900-SOFT-ABORT                              82200023
822100                                                                  82210023
822200         WHEN SQLWARN0 NOT = SPACES                               82220023
822300         WHEN SQLCODE < ZERO                                      82230023
822400         WHEN SQLCODE > ZERO                                      82240023
822500             MOVE '8215-UPD-PRCS-CDE  '                           82250023
822600                                  TO DP013-PARAGRAPH              82260023
822700             MOVE 'UNSUCCESSFUL COUNT OF TDISTHD ROWS'            82270023
822800                                  TO DP013-MESSAGE-TEXT (1)       82280023
822900             MOVE SQLCA      TO DP013-SQLCA                       82290023
823000             MOVE 'TDISTHD ' TO DP013-DB2-TABLE-NAME (1)          82300023
823100             SET DP013-DB2-ABEND                                  82310023
823200                  DP013-NO-ROLLBACK                               82320023
823300                                  TO TRUE                         82330023
823400             PERFORM DP013-0000-PROCESS-ABEND                     82340023
823500     END-EVALUATE.                                                82350023
823600                                                                  82360023
823700*----------------------------------------------------------------*82370023
823800*8218-START-VERIFY-MODULE-PK.                                     82380023
823900                                                                  82390023
824000*DMH MOVE ASC-KEY-PO-NBR    TO DK-ORD-NBR.                        82400023
824100*DMH MOVE ASC-KEY-RCVR-NBR  TO DK-RCVR-NBR.                       82410023
824200*DMH MOVE LQW-PREPK-L4 (LQW-IDX)                                  82420023
824300*DMH                        TO DK-PREPK-ID.                       82430023
824400*DMH                                                              82440023
824500*DMH PERFORM 8331-OPEN-PREPK-SEARCH-CSR.                          82450023
824600*DMH                                                              82460023
824700*DMH PERFORM 8219-START-VERIFY-PREPK-LINE                         82470023
824800*DMH   UNTIL PS-MORE-RECITM-NO OR PS-ERROR.                       82480023
824900*DMH                                                              82490023
825000*DMH PERFORM 8335-CLOSE-PREPK-SEARCH-CSR.                         82500023
825100                                                                  82510023
825200*----------------------------------------------------------------*82520023
825300*8219-START-VERIFY-PREPK-LINE.                                    82530023
825400*DMH                                                              82540023
825500*DMH PERFORM 8333-FETCH-PREPK-SEARCH-CSR.                         82550023
825600*DMH                                                              82560023
825700*DMH IF PS-MORE-RECITM-YES                                        82570023
825800*DMH     MOVE RECITM-ORD-LNE-NBR TO DK-LINE-NBR                   82580023
825900*DMH     PERFORM 8220-START-VERIFY-MODULE                         82590023
826000*DMH END-IF.                                                      82600023
826100                                                                  82610023
826200*----------------------------------------------------------------*82620023
826300 8220-START-VERIFY-MODULE.                                        82630023
826400                                                                  82640023
826500     IF  (DISTHD-FCSE-CART-CNT >  +0  OR                          82650023
826600          DISTHD-INPK-CART-CNT >  +0)                             82660023
826700          IF  DISTHD-P2L-CART-CNT  >  +0                          82670023
826800              SET RC289-P2L-CASE-PROCESS  TO  TRUE                82680023
826900          ELSE                                                    82690023
827000              SET RC289-CASE-PROCESS  TO  TRUE                    82700023
827100          END-IF                                                  82710023
827200     ELSE                                                         82720023
827300     IF  DISTHD-P2L-CART-CNT  >  +0                               82730023
827400         SET RC289-P2L-PROCESS   TO  TRUE                         82740023
827500     END-IF                                                       82750023
827600     END-IF.                                                      82760023
827700*    MOVE '16'                   TO RC289-DC-FUNCTION-CODE.       82770023
827800     IF PV-INVENTORY-COUNT > ZERO                                 82780023
827900         SET  RC289-INV-CYCLE-IN-PROCESS TO TRUE                  82790023
828000     ELSE                                                         82800023
828100         SET  RC289-NO-INV-CYCLE         TO TRUE                  82810023
828200     END-IF.                                                      82820023
828300     MOVE DK-ORD-NBR             TO RC289-ORD-NBR.                82830023
828400     MOVE DK-RCVR-NBR            TO RC289-RCVR-SEQ-NBR.           82840023
828500     MOVE DK-LINE-NBR            TO RC289-ORD-LNE-NBR.            82850023
828600                                                                  82860023
828700     MOVE ASC-PKGNG-CDE            TO RC289-PACKAGE-TYPE-CDE      82870023
828800     MOVE DISTHD-PREPK-LNE-PRC-CDE TO RC289-DISTHD-PROC-TYPE      82880023
828900     MOVE PC-CURRENT-PROGRAM-NAME  TO RC289-CALLING-PROGRAM.      82890023
829000     MOVE DP020-USERID             TO RC289-USER-ID.              82900023
829100     SET RC289-CONFIRMATION TO TRUE.                              82910023
829200                                                                  82920023
829300     EXEC CICS                                                    82930023
829400          START TRANSID ('E200')                                  82940023
829500               FROM (RC289-COMMAREA-FOR-E200)                     82950023
829600     END-EXEC.                                                    82960023
829700                                                                  82970023
829800*----------------------------------------------------------------*82980023
829900*                                                                *82990023
830000*----------------------------------------------------------------*83000023
830100 8300-UPDATE-EDITS.                                               83010023
830200     MOVE LQW-PO-LINE(LQW-IDX)       TO DK-LINE-NBR               83020023
830300                                                                  83030023
830400     EVALUATE TRUE                                                83040023
830500     WHEN LQW-NEED-FCSE-PROCESS-AREA (LQW-IDX)                    83050023
830600         SET LQW-ERROR(LQW-IDX)                                   83060023
830700             LQW-LINE-ERROR(LQW-IDX)                              83070023
830800             ASC-FUNC06-UPDATE-NO          TO TRUE                83080023
830900         MOVE SPACE TO LQW-SELECTED-SW (LQW-IDX)                  83090023
831000         MOVE LQW-SELECTED-SW (LQW-IDX)                           83100023
831100                                TO LQW-TEMP-SELECTED-SW (LQW-IDX) 83110023
831200         MOVE PC-TSYMSG-00007                                     83120023
831300                                 TO DP020-MSG-NUMBER              83130023
831400     WHEN LQW-BAD-FCSE-PROCESS-AREA (LQW-IDX)                     83140023
831500         SET LQW-ERROR(LQW-IDX)                                   83150023
831600             LQW-LINE-ERROR(LQW-IDX)                              83160023
831700             ASC-FUNC06-UPDATE-NO         TO TRUE                 83170023
831800         MOVE SPACE TO LQW-SELECTED-SW (LQW-IDX)                  83180023
831900         MOVE LQW-SELECTED-SW (LQW-IDX)                           83190023
832000                                TO LQW-TEMP-SELECTED-SW (LQW-IDX) 83200023
832100         MOVE PC-TSYMSG-00005                                     83210023
832200                                 TO DP020-MSG-NUMBER              83220023
832300     WHEN OTHER                                                   83230023
832400         SET ASC-FUNC06-UPDATE-YES        TO TRUE                 83240023
832500     END-EVALUATE.                                                83250023
832600                                                                  83260023
832700                                                                  83270023
832800*----------------------------------------------------------------*83280023
832900*                                                                *83290023
833000*----------------------------------------------------------------*83300023
833100 8310-UPDATE.                                                     83310023
833200                                                                  83320023
833300     MOVE +1                       TO ASC-BLK-SUB.                83330023
833400     PERFORM 5100-WRITE-TEMP-STORAGE.                             83340023
833500     ADD +1                        TO ASC-BLK-SUB.                83350023
833600     PERFORM 5100-WRITE-TEMP-STORAGE.                             83360023
833700                                                                  83370023
833800     PERFORM 6112-READ-LIST-QUEUE.                                83380023
833900                                                                  83390023
834000     MOVE ASC-KEY-PO-NBR             TO DK-ORD-NBR                83400023
834100     MOVE ASC-KEY-RCVR-NBR           TO DK-RCVR-NBR               83410023
834200                                                                  83420023
834300     IF PV-CICS-RESP = DFHRESP (NORMAL)                           83430023
834400         PERFORM                                                  83440023
834500         VARYING LQW-IDX  FROM 1 BY 1                             83450023
834600         UNTIL   LQW-IDX > PC-ITEMS-PER-PANEL OR                  83460023
834700                 LQW-LIST-ITEM-NUMBER (LQW-IDX) = ZERO            83470023
834800                                                                  83480023
834900             IF  LQW-SELECT (LQW-IDX)                             83490023
835000                                                                  83500023
835100                 PERFORM 8300-UPDATE-EDITS                        83510023
835200                                                                  83520023
835300                 IF LQW-NO-LINE-ERROR (LQW-IDX)                   83530023
835400                     SET LQW-DESELECT (LQW-IDX)                   83540023
835500                         LQW-UPDATE   (LQW-IDX)                   83550023
835600                                   TO  TRUE                       83560023
835700                     MOVE LQW-SELECTED-SW (LQW-IDX)               83570023
835800                                TO LQW-TEMP-SELECTED-SW (LQW-IDX) 83580023
835900                     SUBTRACT 1  FROM ASC-NUMBER-OF-SELECTED-ITEMS83590023
836000                     IF  LQW-FCSE-AREA-UPDATEABLE (LQW-IDX)       83600023
836100                         ADD 1  TO  PV-NUMBER-OF-UPDATED-ITEMS    83610023
836200                         IF ASC-PKGNG-CDE = 'I' OR 'M'            83620023
836300                             PERFORM 8330-UPDATE-CSEPK-PREPKS     83630023
836400                         ELSE                                     83640023
836500                             PERFORM 8320-UPDATE-CSEPK-FIELDS     83650023
836600                         END-IF                                   83660023
836700                     ELSE                                         83670023
836800                         SET LQW-NULL-ACTION (LQW-IDX)            83680023
836900                                   TO  TRUE                       83690023
837000                     END-IF                                       83700023
837100                     MOVE PC-TSYMSG-00059 TO DP020-MSG-NUMBER     83710023
837200                     SET DP020-MSG-WARNING TO TRUE                83720023
837300                 ELSE                                             83730023
837400                     SET LQW-DESELECT (LQW-IDX)                   83740023
837500                                      TO TRUE                     83750023
837600                     SET ASC-FUNC06-UPDATE-NO TO TRUE             83760023
837700                     MOVE LQW-SELECTED-SW (LQW-IDX)               83770023
837800                                 TO LQW-TEMP-SELECTED-SW (LQW-IDX)83780023
837900                 END-IF                                           83790023
838000             END-IF                                               83800023
838100         END-PERFORM                                              83810023
838200                                                                  83820023
838300     MOVE PV-ITEM      TO PV-SAVE-ITEM                            83830023
838400     PERFORM 6111-WRITE-LIST-QUEUE                                83840023
838500                                                                  83850023
838600     END-IF                                                       83860023
838700                                                                  83870023
838800     MOVE +1                     TO  ASC-BLK-SUB.                 83880023
838900     PERFORM 4410-READ-TEMP-STORAGE                               83890023
839000                                                                  83900023
839100     ADD +1                      TO  ASC-BLK-SUB                  83910023
839200                                     PV-BLOCK-NUMBER.             83920023
839300     PERFORM 4410-READ-TEMP-STORAGE                               83930023
839400     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        83940023
839500                                                                  83950023
839600*----------------------------------------------------------------*83960023
839700*                                                                *83970023
839800*----------------------------------------------------------------*83980023
839900 8320-UPDATE-CSEPK-FIELDS.                                        83990023
840000                                                                  84000023
840100     MOVE LQW-FCSE-AREA(LQW-IDX)  TO  DISTHD-FCSE-FCLTY-AREA-ID.  84010023
840200                                                                  84020023
840300     EXEC SQL                                                     84030023
840400         UPDATE  TDISTHD                                          84040023
840500           SET FCSE_FCLTY_AREA_ID = :DISTHD-FCSE-FCLTY-AREA-ID    84050023
840600      WHERE ORD_NBR                  = :DK-ORD-NBR                84060023
840700        AND RCVR_SEQ_NBR             = :DK-RCVR-NBR               84070023
840800        AND ORD_LNE_NBR              = :DK-LINE-NBR               84080023
840900     END-EXEC.                                                    84090023
841000                                                                  84100023
841100     EVALUATE TRUE                                                84110023
841200         WHEN SQLCODE = ZERO                                      84120023
841300             CONTINUE                                             84130023
841400         WHEN SQLCODE = -904                                      84140023
841500         WHEN SQLCODE = -911                                      84150023
841600         WHEN SQLCODE = -913                                      84160023
841700             MOVE '8320-UPDATE-CSEPK-FIELDS'                      84170023
841800                                  TO DP013-PARAGRAPH              84180023
841900             MOVE SQLCODE            TO PC-DISPLAY-SQL-CODE       84190023
842000             PERFORM 9900-SOFT-ABORT                              84200023
842100                                                                  84210023
842200         WHEN SQLWARN0 NOT = SPACES                               84220023
842300         WHEN SQLCODE < ZERO                                      84230023
842400         WHEN SQLCODE > ZERO                                      84240023
842500             MOVE '8320-UPDATE-CSEPK-FIELDS'                      84250023
842600                                  TO DP013-PARAGRAPH              84260023
842700             MOVE 'UNSUCCESSFUL UPDATE OF PROCESS AREA'           84270023
842800                                  TO DP013-MESSAGE-TEXT (1)       84280023
842900             MOVE SQLCA      TO DP013-SQLCA                       84290023
843000             MOVE 'TDISTHD ' TO DP013-DB2-TABLE-NAME (1)          84300023
843100             SET DP013-DB2-ABEND                                  84310023
843200                  DP013-NO-ROLLBACK                               84320023
843300                                  TO TRUE                         84330023
843400             PERFORM DP013-0000-PROCESS-ABEND                     84340023
843500     END-EVALUATE.                                                84350023
843600                                                                  84360023
843700     PERFORM 9902-SYNCPOINT.                                      84370023
843800                                                                  84380023
843900*----------------------------------------------------------------*84390023
844000*                                                                *84400023
844100*----------------------------------------------------------------*84410023
844200 8330-UPDATE-CSEPK-PREPKS.                                        84420023
844300                                                                  84430023
844400     SET PS-MORE-RECITM-YES TO TRUE.                              84440023
844500                                                                  84450023
844600     MOVE ASC-KEY-PO-NBR    TO DK-ORD-NBR.                        84460023
844700     MOVE ASC-KEY-RCVR-NBR  TO DK-RCVR-NBR.                       84470023
844800     MOVE LQW-PREPK-L4 (LQW-IDX)                                  84480023
844900                            TO DK-PREPK-ID.                       84490023
845000                                                                  84500023
845100     PERFORM 8331-OPEN-PREPK-SEARCH-CSR.                          84510023
845200                                                                  84520023
845300     PERFORM 8332-PROCESS-PREPK-SEARCH-CSR                        84530023
845400       UNTIL PS-MORE-RECITM-NO.                                   84540023
845500                                                                  84550023
845600     PERFORM 8335-CLOSE-PREPK-SEARCH-CSR.                         84560023
845700                                                                  84570023
845800     PERFORM 9902-SYNCPOINT.                                      84580023
845900                                                                  84590023
846000*----------------------------------------------------------------*84600023
846100 8331-OPEN-PREPK-SEARCH-CSR.                                      84610023
846200                                                                  84620023
846300     EXEC SQL                                                     84630023
846400         OPEN PREPK-SEARCH-CSR                                    84640023
846500     END-EXEC.                                                    84650023
846600                                                                  84660023
846700     EVALUATE TRUE                                                84670023
846800         WHEN SQLCODE = ZERO                                      84680023
846900             SET PS-MORE-RECITM-YES TO TRUE                       84690023
847000                                                                  84700023
847100         WHEN SQLCODE = -904                                      84710023
847200         WHEN SQLCODE = -911                                      84720023
847300         WHEN SQLCODE = -913                                      84730023
847400             MOVE '8331-OPEN-PREPK-SEARCH-CSR'                    84740023
847500                                 TO DP013-PARAGRAPH               84750023
847600             MOVE SQLCODE            TO PC-DISPLAY-SQL-CODE       84760023
847700             PERFORM 9900-SOFT-ABORT                              84770023
847800                                                                  84780023
847900         WHEN SQLWARN0 NOT = SPACE                                84790023
848000         WHEN SQLCODE  NOT = ZERO                                 84800023
848100             MOVE '8331-OPEN-PREPK-SEARCH-CSR'                    84810023
848200                                 TO DP013-PARAGRAPH               84820023
848300             MOVE 'OPEN PREPK UPD CURSOR'                         84830023
848400                                 TO DP013-MESSAGE-TEXT (1)        84840023
848500             MOVE SQLCA          TO DP013-SQLCA                   84850023
848600             MOVE 'TRECITM'      TO DP013-DB2-TABLE-NAME (1)      84860023
848700             SET DP013-DB2-ABEND TO TRUE                          84870023
848800             PERFORM DP013-0000-PROCESS-ABEND                     84880023
848900     END-EVALUATE.                                                84890023
849000                                                                  84900023
849100*----------------------------------------------------------------*84910023
849200 8332-PROCESS-PREPK-SEARCH-CSR.                                   84920023
849300                                                                  84930023
849400     PERFORM 8333-FETCH-PREPK-SEARCH-CSR.                         84940023
849500                                                                  84950023
849600     IF PS-MORE-RECITM-YES                                        84960023
849700         MOVE RECITM-ORD-LNE-NBR TO DK-LINE-NBR                   84970023
849800         PERFORM 8334-UPD-MATCHING-PREPKS                         84980023
849900     END-IF.                                                      84990023
850000                                                                  85000023
850100*----------------------------------------------------------------*85010023
850200 8333-FETCH-PREPK-SEARCH-CSR.                                     85020023
850300                                                                  85030023
850400     EXEC SQL                                                     85040023
850500         FETCH PREPK-SEARCH-CSR                                   85050023
850600          INTO :RECITM-ORD-LNE-NBR                                85060023
850700             , :RECITM-STATUS-CDE                                 85070023
850800             , :RECITM-PREPK-ODD-UNT-QTY                          85080023
850900     END-EXEC.                                                    85090023
851000                                                                  85100023
851100     EVALUATE TRUE                                                85110023
851200         WHEN SQLCODE = ZERO                                      85120023
851300             IF RECITM-PREPK-ODD-UNT-QTY > ZERO                   85130023
851400                 SET PS-RECITM-ODD-UNITS-YES TO TRUE              85140023
851500             END-IF                                               85150023
851600                                                                  85160023
851700         WHEN SQLCODE = +100                                      85170023
851800             MOVE SPACES TO RECITM-STATUS-CDE                     85180023
851900             SET PS-MORE-RECITM-NO TO TRUE                        85190023
852000                                                                  85200023
852100         WHEN SQLCODE = -904                                      85210023
852200         WHEN SQLCODE = -911                                      85220023
852300         WHEN SQLCODE = -913                                      85230023
852400             MOVE '8333-FETCH-PREPK-SEARCH-CSR'                   85240023
852500                                 TO DP013-PARAGRAPH               85250023
852600             MOVE SQLCODE            TO PC-DISPLAY-SQL-CODE       85260023
852700             PERFORM 9900-SOFT-ABORT                              85270023
852800                                                                  85280023
852900         WHEN SQLWARN0 NOT = SPACE                                85290023
853000         WHEN SQLCODE < ZERO                                      85300023
853100         WHEN SQLCODE > ZERO                                      85310023
853200             MOVE '8333-FETCH-PREPK-SEARCH-CSR'                   85320023
853300                                 TO DP013-PARAGRAPH               85330023
853400             MOVE 'FETCH PREPK-UPDATE CURSOR'                     85340023
853500                                 TO DP013-MESSAGE-TEXT (1)        85350023
853600             MOVE SQLCA          TO DP013-SQLCA                   85360023
853700             MOVE 'TRECITM'      TO DP013-DB2-TABLE-NAME (1)      85370023
853800             SET DP013-DB2-ABEND TO TRUE                          85380023
853900             PERFORM DP013-0000-PROCESS-ABEND                     85390023
854000     END-EVALUATE.                                                85400023
854100                                                                  85410023
854200*----------------------------------------------------------------*85420023
854300 8334-UPD-MATCHING-PREPKS.                                        85430023
854400                                                                  85440023
854500     MOVE LQW-FCSE-AREA(LQW-IDX)  TO  DISTHD-FCSE-FCLTY-AREA-ID.  85450023
854600                                                                  85460023
854700     EXEC SQL                                                     85470023
854800         UPDATE  TDISTHD                                          85480023
854900            SET FCSE_FCLTY_AREA_ID = :DISTHD-FCSE-FCLTY-AREA-ID   85490023
855000          WHERE ORD_NBR            = :DK-ORD-NBR                  85500023
855100            AND RCVR_SEQ_NBR       = :DK-RCVR-NBR                 85510023
855200            AND ORD_LNE_NBR        = :DK-LINE-NBR                 85520023
855300     END-EXEC.                                                    85530023
855400                                                                  85540023
855500     EVALUATE TRUE                                                85550023
855600         WHEN SQLCODE = ZERO                                      85560023
855700             CONTINUE                                             85570023
855800                                                                  85580023
855900         WHEN SQLCODE = -904                                      85590023
856000         WHEN SQLCODE = -911                                      85600023
856100         WHEN SQLCODE = -913                                      85610023
856200             MOVE '8334-UPD-MATCHING-PREPKS'                      85620023
856300                                  TO DP013-PARAGRAPH              85630023
856400             MOVE SQLCODE            TO PC-DISPLAY-SQL-CODE       85640023
856500             PERFORM 9900-SOFT-ABORT                              85650023
856600                                                                  85660023
856700         WHEN SQLWARN0 NOT = SPACES                               85670023
856800         WHEN SQLCODE < ZERO                                      85680023
856900         WHEN SQLCODE > ZERO                                      85690023
857000             MOVE '8334-UPD-MATCHING-PREPKS'                      85700023
857100                                  TO DP013-PARAGRAPH              85710023
857200             MOVE 'UNSUCCESSFUL UPDATE OF PROCESS AREA'           85720023
857300                                  TO DP013-MESSAGE-TEXT (1)       85730023
857400             MOVE SQLCA      TO DP013-SQLCA                       85740023
857500             MOVE 'TDISTHD ' TO DP013-DB2-TABLE-NAME (1)          85750023
857600             SET DP013-DB2-ABEND                                  85760023
857700                 DP013-NO-ROLLBACK TO TRUE                        85770023
857800             PERFORM DP013-0000-PROCESS-ABEND                     85780023
857900     END-EVALUATE.                                                85790023
858000                                                                  85800023
858100*----------------------------------------------------------------*85810023
858200 8335-CLOSE-PREPK-SEARCH-CSR.                                     85820023
858300                                                                  85830023
858400     EXEC SQL                                                     85840023
858500         CLOSE PREPK-SEARCH-CSR                                   85850023
858600     END-EXEC.                                                    85860023
858700                                                                  85870023
858800     EVALUATE TRUE                                                85880023
858900         WHEN SQLCODE = ZERO                                      85890023
859000             CONTINUE                                             85900023
859100                                                                  85910023
859200         WHEN SQLCODE = -904                                      85920023
859300         WHEN SQLCODE = -911                                      85930023
859400         WHEN SQLCODE = -913                                      85940023
859500             MOVE '8335-CLOSE-PREPK-SEARCH-CSR'                   85950023
859600                                 TO DP013-PARAGRAPH               85960023
859700             MOVE SQLCODE            TO PC-DISPLAY-SQL-CODE       85970023
859800             PERFORM 9900-SOFT-ABORT                              85980023
859900                                                                  85990023
860000         WHEN SQLWARN0 NOT = SPACE                                86000023
860100         WHEN SQLCODE  NOT = ZERO                                 86010023
860200             MOVE '8335-CLOSE-PREPK-SEARCH-CSR'                   86020023
860300                                 TO DP013-PARAGRAPH               86030023
860400             MOVE 'CLOSE PREPK-SEARCH-CSR CURSOR'                 86040023
860500                                 TO DP013-MESSAGE-TEXT (1)        86050023
860600             MOVE SQLCA          TO DP013-SQLCA                   86060023
860700             MOVE 'TRECITM'      TO DP013-DB2-TABLE-NAME (1)      86070023
860800             SET DP013-DB2-ABEND TO TRUE                          86080023
860900             PERFORM DP013-0000-PROCESS-ABEND                     86090023
861000     END-EVALUATE.                                                86100023
861100                                                                  86110023
861200*----------------------------------------------------------------*86120023
861300*    CALL (AUTOVE) AUTOVERIFICATION MODULE (RCKUT127)             86130023
861400*    TO SEE IF THIS IS AN AUTOVE PO                               86140023
861500*----------------------------------------------------------------*86150023
861600 8400-CHECK-AUTOVE.                                               86160023
861700                                                                  86170023
861800     INITIALIZE RC040-FIELDS.                                     86180023
861900     MOVE ASC-KEY-OPER-UNT-ID TO RC040-SIGNON-LOCATION.           86190023
862000     MOVE ASC-KEY-PO-NBR      TO RC040-PO-NBR.                    86200023
862100     MOVE ASC-KEY-RCVR-NBR    TO RC040-PO-RCVR.                   86210023
862200     SET  RC040-RCVR-EXISTS   TO TRUE.                            86220023
862300     MOVE ASC-DEPT-N          TO RC040-DEPT.                      86230023
862400     MOVE DP020-USERID        TO RC040-USER-ID.                   86240023
862500     MOVE 'RCKCS297'          TO RC040-CALLING-PROGRAM.           86250023
862600                                                                  86260023
862700     CALL RC040-AUTOVE-CHECK-PGM USING  DFHEIBLK                  86270023
862800                                        RC040-COMMAREA            86280023
862900                                        RC040-FIELDS.             86290023
863000     EVALUATE TRUE                                                86300023
863100         WHEN RC040-SUCCESSFUL                                    86310023
863200              MOVE RC040-AUTO-VE-SW     TO ASC-AUTO-VE-SW         86320023
863300         WHEN RC040-DATABASE-BUSY OR                              86330023
863400              RC040-INVALID-SQL                                   86340023
863500                  MOVE PC-TSYMSG-00984  TO DP020-MSG-NUMBER       86350023
863600                  SET DP020-MSG-WARNING TO TRUE                   86360023
863700                  SET DP030-OVERRIDE-GO TO TRUE                   86370023
863800                  SET PS-ERROR          TO TRUE                   86380023
863900         WHEN RC040-NOT-SUCCESSFUL                                86390023
864000                  MOVE PC-TSYMSG-03138  TO DP020-MSG-NUMBER       86400023
864100                  SET DP020-MSG-WARNING TO TRUE                   86410023
864200                  SET DP030-OVERRIDE-GO TO TRUE                   86420023
864300                  SET PS-ERROR          TO TRUE                   86430023
864400         WHEN OTHER                                               86440023
864500             MOVE '8400-CHECK-AUTOVE ' TO DP013-PARAGRAPH         86450023
864600             MOVE 'UNSUCCESSFUL CALL TO AUTO VE MOD'              86460023
864700                                         TO DP013-MESSAGE-TEXT (1)86470023
864800             MOVE RC040-SUCCESS-IND      TO DP013-MESSAGE-TEXT (2)86480023
864900             MOVE RC040-SQLCA            TO DP013-SQLCA           86490023
865000             SET DP013-DB2-ABEND                                  86500023
865100                 DP013-XCTL-DISPLAY-RESTART  TO TRUE              86510023
865200             SET PS-ERROR                    TO TRUE              86520023
865300             PERFORM DP013-0000-PROCESS-ABEND                     86530023
865400     END-EVALUATE.                                                86540023
865500                                                                  86550023
865600 9000-CALL-PO-RCVR-TRKING-MOD.                                    86560023
865700                                                                  86570023
865800     INITIALIZE RC071-FIELDS.                                     86580023
865900     MOVE ASC-KEY-PO-NBR            TO RC071-PO-NBR               86590023
866000     MOVE ASC-KEY-RCVR-NBR          TO RC071-PO-RCVR              86600023
866100     IF ASC-PKGNG-CDE = 'I' OR 'M'                                86610023
866200        MOVE LQW-PREPK-L4 (LQW-IDX)    TO RC071-PREPK-ID          86620023
866300        MOVE ZEROES                    TO RC071-PO-LINE           86630023
866400     ELSE                                                         86640023
866500        MOVE LQW-PO-LINE(LQW-IDX)      TO RC071-PO-LINE           86650023
866600        MOVE ZEROES                    TO RC071-PREPK-ID          86660023
866700     END-IF                                                       86670023
866800     MOVE ASC-KEY-OPER-UNT-ID       TO RC071-SIGNON-LOCATION      86680023
866900     MOVE DP020-USERID              TO RC071-USER-ID              86690023
867000     MOVE PC-CURRENT-PROGRAM-NAME   TO RC071-CALLING-PROGRAM      86700023
867100     IF ASC-FUNC01-CONFIRM-YES                                    86710023
867200         MOVE '14'                      TO RC071-DC-FUNCTION-CODE 86720023
867300     ELSE                                                         86730023
867400         MOVE '15'                      TO RC071-DC-FUNCTION-CODE 86740023
867500     END-IF.                                                      86750023
867600                                                                  86760023
867700     MOVE LENGTH OF RC071-FIELDS    TO PV-COMMAREA-LENGTH.        86770023
867800                                                                  86780023
867900     CALL RC071-PO-RCVR-TRACKING USING  DFHEIBLK                  86790023
868000                                        RC071-COMMAREA            86800023
868100                                        RC071-FIELDS.             86810023
868200                                                                  86820023
868300     IF RC071-SUCCESSFUL                                          86830023
868400         CONTINUE                                                 86840023
868500     ELSE                                                         86850023
868600         MOVE '9000-CALL-PO-RCVR-TRKING-MOD'                      86860023
868700                                 TO DP013-PARAGRAPH               86870023
868800         MOVE ASC-KEY-PO-NBR      TO PV-ERROR-ORD-NBR             86880023
868900         MOVE ASC-KEY-RCVR-NBR    TO PV-ERROR-RCVR-SEQ-NBR        86890023
869000         MOVE ASC-KEY-OPER-UNT-ID TO PV-ERROR-OPER-UNT-ID         86900023
869100         MOVE RC071-PO-LINE       TO PV-ERROR-ORD-LNE-NBR         86910023
869200         MOVE RC071-PREPK-ID      TO PV-ERROR-ORD-PCK-NBR         86920023
869300         STRING ' RCKCS297-RC137'   DELIMITED BY SIZE             86930023
869400                ' RCVR: '           DELIMITED BY SIZE             86940023
869500                PV-ERROR-ORD-NBR    DELIMITED BY SIZE             86950023
869600                '-'                 DELIMITED BY SIZE             86960023
869700                PV-ERROR-RCVR-SEQ-NBR                             86970023
869800                                    DELIMITED BY SIZE             86980023
869900                '  LINE: '          DELIMITED BY SIZE             86990023
870000                PV-ERROR-ORD-LNE-NBR                              87000023
870100                                    DELIMITED BY SIZE             87010023
870200                '  PACK: '          DELIMITED BY SIZE             87020023
870300                PV-ERROR-ORD-PCK-NBR                              87030023
870400                                    DELIMITED BY SIZE             87040023
870500                '  FCLTY: '         DELIMITED BY SIZE             87050023
870600                PV-ERROR-OPER-UNT-ID                              87060023
870700                                    DELIMITED BY SIZE             87070023
870800                                 INTO PV-CICS-MSG-AREA            87080023
870900         MOVE LENGTH OF PV-CICS-MSG-AREA                          87090023
871000                                   TO PV-COMMAREA-LENGTH          87100023
871100         PERFORM 9200-WRITE-TO-CICS-LOG                           87110023
871200         MOVE 'UNSUCCESSFUL CALL TO TRACKING MOD'                 87120023
871300                                     TO DP013-MESSAGE-TEXT (1)    87130023
871400         MOVE RC071-CRA-RET-MSG      TO DP013-MESSAGE-TEXT (2)    87140023
871500         STRING ' OPER: '            DELIMITED BY SIZE            87150023
871600              PV-ERROR-OPER-UNT-ID   DELIMITED BY SIZE            87160023
871700                ' RCVR: '            DELIMITED BY SIZE            87170023
871800              PV-ERROR-ORD-NBR       DELIMITED BY SIZE            87180023
871900              '-'                    DELIMITED BY SIZE            87190023
872000              PV-ERROR-RCVR-SEQ-NBR  DELIMITED BY SIZE            87200023
872100              ' IND: '               DELIMITED BY SIZE            87210023
872200              RC071-SUCCESS-IND      DELIMITED BY SIZE            87220023
872300                               INTO DP013-MESSAGE-TEXT (3)        87230023
872400         STRING ' LINE: '            DELIMITED BY SIZE            87240023
872500              PV-ERROR-ORD-LNE-NBR   DELIMITED BY SIZE            87250023
872600                ' PACK: '            DELIMITED BY SIZE            87260023
872700              PV-ERROR-ORD-PCK-NBR   DELIMITED BY SIZE            87270023
872800                               INTO DP013-MESSAGE-TEXT (4)        87280023
872900         MOVE '9000-CALL-PO-RCVR-TRKING-MOD'                      87290023
873000                                   TO DP013-PARAGRAPH             87300023
873100         SET DP013-XCTL-DISPLAY-RESTART                           87310023
873200             DP013-DB2-ABEND     TO TRUE                          87320023
873300         SET PS-ERROR                    TO TRUE                  87330023
873400         PERFORM DP013-0000-PROCESS-ABEND                         87340023
873500                                                                  87350023
873600      END-IF.                                                     87360023
873700                                                                  87370023
873800*----------------------------------------------------------------*87380023
873900*    READ THE INPUT SELECTION QUEUE.                             *87390023
874000*----------------------------------------------------------------*87400023
874100 9100-READ-SEL-QUEUE.                                             87410023
874200                                                                  87420023
874300     EXEC CICS                                                    87430023
874400         READQ TS                                                 87440023
874500         QUEUE (ASC-SEL-QUEUE-NAME-IN)                            87450023
874600          INTO (RC013-DC-SELECT-RECORD)                           87460023
874700          ITEM (PV-SEL-QUEUE-ITEM)                                87470023
874800          RESP (PV-CICS-RESP)                                     87480023
874900     END-EXEC.                                                    87490023
875000                                                                  87500023
875100     IF PV-CICS-RESP = DFHRESP (NORMAL)                           87510023
875200         CONTINUE                                                 87520023
875300     ELSE                                                         87530023
875400         SET DP013-CICS-ABEND       TO TRUE                       87540023
875500         SET DP013-NO-ROLLBACK      TO TRUE                       87550023
875600         MOVE '9100-READ-SEL-QUEUE' TO DP013-PARAGRAPH            87560023
875700         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           87570023
875800                                    TO DP013-MESSAGE-TEXT(1)      87580023
875900         PERFORM DP013-0000-PROCESS-ABEND                         87590023
876000     END-IF.                                                      87600023
876100                                                                  87610023
876200*----------------------------------------------------------------*87620023
876300*                                                                *87630023
876400*----------------------------------------------------------------*87640023
876500 9900-SOFT-ABORT.                                                 87650023
876600     SET PS-ERROR         TO TRUE.                                87660023
876700     SET DP020-MSG-FATAL  TO TRUE.                                87670023
876800     MOVE SPACES    TO PV-CICS-MSG-AREA.                          87680023
876900     STRING '9900-SOFT-ABORT '                                    87690023
877000             DP013-PARAGRAPH                                      87700023
877100             '  '                                                 87710023
877200             PC-DISPLAY-SQL-CODE                                  87720023
877300              DELIMITED BY SPACES                                 87730023
877400                  INTO PV-CICS-MSG-AREA.                          87740023
877500     PERFORM 9200-WRITE-TO-CICS-LOG.                              87750023
877600     MOVE 'THROUGH SOFT-ABORT PARA'                               87760023
877700                      TO DP013-MESSAGE-TEXT (1)                   87770023
877800     IF  PS-UNITS-WORKED-ERROR                                    87780023
877900         MOVE PC-TSYMSG-02875 TO DP020-MSG-NUMBER                 87790023
878000     ELSE                                                         87800023
878100         MOVE PC-TSYMSG-00551 TO DP020-MSG-NUMBER                 87810023
878200     END-IF.                                                      87820023
878300                                                                  87830023
878400     IF PS-NO-NEXT-SCREEN                                         87840023
878500        SET DP020-NEXT-ACT-APPL-ERROR TO TRUE                     87850023
878600     END-IF.                                                      87860023
878700     PERFORM 9901-BACKUP.                                         87870023
878800     MOVE 'PROGRAM EXIT CALL' TO DP013-MESSAGE-TEXT (1).          87880023
878900     PERFORM 0001-CALL-CICS-ARCH-API.                             87890023
879000                                                                  87900023
879100 9901-BACKUP.                                                     87910023
879200     EXEC CICS SYNCPOINT                                          87920023
879300          ROLLBACK                                                87930023
879400     END-EXEC.                                                    87940023
879500                                                                  87950023
879600 9902-SYNCPOINT.                                                  87960023
879700     EXEC CICS                                                    87970023
879800         SYNCPOINT                                                87980023
879900     END-EXEC.                                                    87990023
880000                                                                  88000023
880100/                                                                 88010023
880200*----------------------------------------------------------------*88020023
880300 9200-WRITE-TO-CICS-LOG.                                          88030023
880400                                                                  88040023
880500     EXEC CICS                                                    88050023
880600          WRITEQ TD                                               88060023
880700          QUEUE  ('CSSL')                                         88070023
880800          FROM  (PV-CICS-MSG-AREA)                                88080023
880900          LENGTH  (PV-COMMAREA-LENGTH)                            88090023
881000          RESP  (PV-CICS-RESP)                                    88100023
881100     END-EXEC.                                                    88110023
881200                                                                  88120023
881300     MOVE SPACES TO PV-CICS-MSG-AREA.                             88130023
881400                                                                  88140023
881500*----------------------------------------------------------------*88150023
881600*    ABEND PROCESSOR MODULE                                      *88160023
881700*----------------------------------------------------------------*88170023
881800                                                                  88180023
881900     COPY DPPD013.                                                88190023
