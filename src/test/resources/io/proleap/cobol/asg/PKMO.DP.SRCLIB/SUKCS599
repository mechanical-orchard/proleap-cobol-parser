000100*-----------------------*                                         00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300*-----------------------*                                         00030000
000400 PROGRAM-ID.    SUKCS599.                                         00040000
000500 AUTHOR.        LARRY SCHLEICHER.                                 00050000
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060000
000700 DATE-WRITTEN.  MARCH, 2005.                                      00070000
000800 DATE-COMPILED.                                                   00080000
000900*---------------------------------------------------------------* 00090000
001000*    S599 - OUTBOUND MASTER/CHILD LIST                          * 00100000
001100*---------------------------------------------------------------* 00110000
001110* CHANGED 11/15/2021    BY JIM HUNTER      WR: CHG0263968         00111016
001120* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00112017
001130* MAKING THE CALL DYNAMIC VS STATIC.                              00113017
001130*                                                                 00113119
001110* CHANGED 01/09/2023    BY JEAN KURK       WR: CHG0278099         00113219
001120* CHANGE CALL OF DPKCS030 TO BE DYNAMIC                           00113319
001140*---------------------------------------------------------------* 00114017
001200 ENVIRONMENT DIVISION.                                            00120000
001300 DATA DIVISION.                                                   00130000
001400                                                                  00140000
001500 WORKING-STORAGE SECTION.                                         00150000
001600 01  DK-DB2-KEYS.                                                 00160000
001700     05  DK-PO-TRN-NBR                  PIC 9(09) VALUE ZEROES.   00170000
001800     05  DK-TRN-NBR-N REDEFINES DK-PO-TRN-NBR.                    00180000
001900         10  DK-TRN-NBR-X               PIC X(09).                00190000
002000     05  DK-TRN-NBR-9.                                            00200000
002100         10  FILLER                       PIC X(01) VALUE SPACES. 00210000
002200         10  DK-TRN-NBR-8                 PIC X(08) VALUE SPACES. 00220000
002300                                                                  00230000
002400     05  DK-PO-RCVR-NBR-N                 PIC 9(09) VALUE ZEROES. 00240000
002500     05  DK-PO-RCVR-NBR-X REDEFINES DK-PO-RCVR-NBR-N.             00250000
002600         10  DK-RCVR-NBR-X                PIC X(09).              00260000
002700     05  DK-RCVR-NBR-9.                                           00270000
002800         10  FILLER                       PIC X(06) VALUE SPACES. 00280000
002900         10  DK-RCVR-NBR-3                PIC X(03) VALUE SPACES. 00290000
003000     05  DK-PO-RCVR.                                              00300000
003100         10  DK-PO                        PIC 9(08) VALUE ZEROES. 00310000
003200         10  FILLER                       PIC X(01) VALUE '-'.    00320000
003300         10  DK-RCVR                      PIC 9(03) VALUE ZEROES. 00330000
003400     05  DK-OPER-UNT-ID                 PIC S9(04)  VALUE ZERO    00340000
003500                                                   COMP.          00350000
003600     05  DK-STORE-NUMBER                PIC S9(04)  VALUE ZERO    00360000
003700                                                   COMP.          00370000
003800     05  DK-PO-NBR                      PIC S9(09) COMP.          00380000
003900     05  DK-REC-SEQ-NBR                 PIC S9(09) COMP.          00390000
004000     05  DK-LINE-NBR                    PIC S9(09) COMP.          00400000
004100     05  DK-TRIP-ID                     PIC S9(09) COMP.          00410000
004200     05  DK-SML-NBR                     PIC S9(18)V COMP-3.       00420000
004300     05  DK-SHIPT-UNT-ID                PIC S9(18)V COMP-3.       00430000
004400     05  DK-BARCODE                     PIC  X(22) VALUE SPACES.  00440000
004500     05  DK-BARCODE-R REDEFINES DK-BARCODE.                       00450000
004600         10  DK-BARCODE-1-2             PIC  9(02).               00460000
004700         10  DK-BARCODE-3-20            PIC  9(18).               00470000
004800         10  DK-BARCODE-21-22           PIC  X(02).               00480000
004900     05  DK-BARCODE-N                   PIC  9(18) VALUE ZEROES.  00490000
005000     05  DK-CRTN-STAT-DESC.                                       00500000
005100         10  DK-INVALID-DESC            PIC X(7) VALUE 'INVALID'. 00510000
005200         10  DK-INACT-DESC              PIC X(7) VALUE 'INACTIV'. 00520000
005300         10  DK-SC-OF-DESC              PIC X(7) VALUE 'SCD OFF'. 00530000
005400         10  DK-SC-ON-DESC              PIC X(7) VALUE 'SCND ON'. 00540000
005500         10  DK-DVRT-DESC               PIC X(7) VALUE 'DIVERTD'. 00550000
005600         10  DK-ASSUM-DESC              PIC X(7) VALUE 'ASSUMED'. 00560000
005700         10  DK-LOADED-DESC             PIC X(7) VALUE 'LOADED '. 00570000
005800         10  DK-CSEPK-DESC              PIC X(7) VALUE 'CASEPCK'. 00580000
005900         10  DK-CK-IN-DESC              PIC X(7) VALUE 'CHKD-IN'. 00590000
006000         10  DK-P2L-DESC                PIC X(7) VALUE 'P2L    '. 00600000
006100         10  DK-RDM-DESC                PIC X(7) VALUE 'CRD RDM'. 00610000
006200         10  DK-RECV-DESC               PIC X(7) VALUE 'CRD RCV'. 00620000
006300         10  DK-ASN-DESC                PIC X(7) VALUE 'CRD ASN'. 00630000
006400         10  DK-SMTH-DESC               PIC X(7) VALUE 'CRD SMO'. 00640000
006500         10  DK-XFER-DESC               PIC X(7) VALUE 'CRD XFR'. 00650000
006600         10  DK-MSTR-DESC               PIC X(7) VALUE 'CRD MST'. 00660000
006700         10  DK-BLD-DESC                PIC X(7) VALUE 'CRD BLD'. 00670000
006710         10  DK-3WD-DESC                PIC X(7) VALUE 'CRD 3WD'. 00671018
006800         10  DK-ASSUMED                 PIC X(7) VALUE 'ASSUMED'. 00680000
006900     05  DK-DEFAULT-BEGIN               PIC S9(09)  VALUE ZERO    00690000
007000                                                    COMP.         00700000
007100     05  DK-DEFAULT-END-LINE            PIC S9(09)  VALUE 9999999 00710000
007200                                                    COMP.         00720000
007300     05  DK-DEFAULT-END-STR             PIC S9(09)  VALUE 9999    00730000
007400                                                    COMP.         00740000
007500     05  DK-LINE-BEGIN                  PIC S9(09)  VALUE ZERO    00750000
007600                                                    COMP.         00760000
007700     05  DK-LINE-END                    PIC S9(09)  VALUE ZERO    00770000
007800                                                    COMP.         00780000
007900     05  DK-STR-BEGIN                   PIC S9(04)  VALUE ZERO    00790000
008000                                                    COMP.         00800000
008100     05  DK-STR-END                     PIC S9(04)  VALUE ZERO    00810000
008200                                                    COMP.         00820000
008300                                                                  00830000
008400 01  PC-PROGRAM-CONSTANTS.                                        00840000
008500     05  PC-DEFAULT-TMST           PIC  X(26)  VALUE              00850000
008600                                  '9999-09-09-09.09.09.999999'.   00860000
008700     05  PC-CURRENT-MAP-NAME       PIC  X(08)  VALUE 'SU599A  '.  00870000
008800     05  PC-CURRENT-MAPSET-NAME    PIC  X(08)  VALUE 'SUKM599'.   00880000
008900     05  PC-CURRENT-PROGRAM-NAME   PIC  X(08)  VALUE 'SUKCS599'.  00890000
009100     05  PC-LOCATION-MODULE        PIC  X(08)  VALUE 'XLKUT071'.  00910000
009200     05  PC-DPKCS060               PIC  X(08)  VALUE 'DPKCS060'.  00920000
009300     05  PC-SUKCS751               PIC  X(08)  VALUE 'SUKCS751'.  00930000
009400     05  PC-LIST-QUEUE-SEQ         PIC  9(01)  VALUE 1.           00940000
009500     05  PC-SEL-QUEUE-SEQ          PIC  9(01)  VALUE 2.           00950000
009600     05  PC-CRIT-SPEC-FORMAT       PIC  X(01)  VALUE '1'.         00960000
009700     05  PC-LIST-FORMAT            PIC  X(01)  VALUE '2'.         00970000
009800     05  PC-ITEMS-PER-PANEL        PIC S9(04)  VALUE +10          00980000
009900                                               COMP SYNC.         00990000
010000     05  PC-MAX-BLOCKS-IN-ARRAY    PIC S9(04)  VALUE +2           01000000
010100                                               COMP SYNC.         01010000
010200     05  PC-MAX-ITEMS              PIC S9(09)  VALUE +1000000     01020000
010300                                               COMP-3.            01030000
010400     05  PC-MSG-NUMBER-LENGTH      PIC S9(04)  VALUE +5           01040000
010500                                               COMP SYNC.         01050000
010600     05  PC-MAX-RETRIES            PIC S9(03)  VALUE 3            01060000
010700                                               COMP-3.            01070000
010800     05  PC-INQ                    PIC  X(03)  VALUE 'INQ'.       01080000
010900     05  PC-UPD                    PIC  X(03)  VALUE 'UPD'.       01090000
011000     05  PC-DEL                    PIC  X(03)  VALUE 'DEL'.       01100000
011100     05  PC-ERR                    PIC  X(03)  VALUE 'ERR'.       01110000
011200     05  PC-SLASH                  PIC  X(01)  VALUE '/'.         01120000
011300     05  PC-ZERO                   PIC S9(04)  VALUE ZEROES       01130000
011400                                               COMP.              01140000
011500     05  PC-INNER-PREPACK          PIC  X(06)  VALUE 'INPRPK'.    01150000
011600     05  PC-MULTI-SKU              PIC  X(06)  VALUE 'MLTSKU'.    01160000
011700     05  PC-SINGLE-SKU             PIC  X(06)  VALUE 'SGLSKU'.    01170000
011800     05  PC-CASEPACK               PIC  X(06)  VALUE 'CASEPK'.    01180000
011900     05  PC-BULK                   PIC  X(06)  VALUE 'BULK  '.    01190000
012000     05  PC-MANUAL                 PIC  X(07)  VALUE 'MANUAL '.   01200000
012100     05  PC-FCS-P2L                PIC  X(07)  VALUE 'FCS&P2L'.   01210000
012200     05  PC-P2L                    PIC  X(07)  VALUE 'P2L    '.   01220000
012300     05  PC-FCSE                   PIC  X(07)  VALUE 'FCSE   '.   01230000
012400*----------------------------------------------------------------*01240000
012500*  SYSTEM MESSAGES                                               *01250000
012600*----------------------------------------------------------------*01260000
012700*   00005 = INVALID VALUE                                        *01270000
012800*   00008 = MUST BE NUMERIC                                      *01280000
012900*   00050 - NO LIST ITEMS WERE FOUND FOR THE CRITERIA SPECIFIED  *01290000
013000*   00051 - NO END OF RANGE HAS BEEN SPECIFIED                   *01300000
013100*   00052 - END OF RANGE PRECEDES START OF RANGE                 *01310000
013200*   00053 - NO START OF RANGE HAS BEEN SPECIFIED                 *01320000
013300*   00054 - ONLY ONE START OF RANGE INDICATOR MAY BE SPECIFIED   *01330000
013400*   00055 - ONLY ONE END OF RANGE INDICATOR MAY BE SPECIFIED     *01340000
013500*   00057 - A LIST ITEM MUST BE SELECTED FOR THIS FUNCTION       *01350000
013600*   00069 - TOP OF LIST                                          *01360000
013700*   00070 - BOTTOM OF LIST                                       *01370000
013800*   00101 - VALUE MUST BE > ZERO AND  < 1,000,000                *01380000
013900*   00551 - WAIT 15 SECONDS;RETRY FUNCTION AGAIN; IF UNSUCCESSFUL*01390000
014000*   00279 - MORE ITEMS TO DISPLAY                                *01400000
014100*   00743 - TRIP DOES NOT EXIST                                  *01410000
014200*   00840 - YOU ARE NOT AUTHORIZED TO VIEW THIS DATA             *01420000
014300*   00984 - DATABASE IS BUSY, TRY AGAIN IN A FEW MINUTES         *01430000
014400*   02227 = APPLICATION UNAVAILABLE AT THIS TIME                 *01440000
014500*   02792 = ENDING CUTOFF ALREADY EXISTS FOR TRLR-BEGIN CUTOFF NE*01450000
014600*   02793 = CARTON IS ALREADY LOADED ONTO A TRAILER.             *01460000
014700*   02796 = END CUTOFF ASSIGNMENT SUCCESSFUL.                    *01470000
014800*   02799 = END CARTON DIVERT TIME MUST BE GREATER THAN BEGIN CAR*01480000
014900*   99901 = INVALID COMMAND WAS ENTERED                          *01490000
015000*----------------------------------------------------------------*01500000
015100     05  PC-TSYMSG-NUMBERS.                                       01510000
015200         10  PC-TSYMSG-00005            PIC  9(05)  VALUE 00005.  01520000
015300         10  PC-TSYMSG-00007            PIC  9(05)  VALUE 00007.  01530000
015400         10  PC-TSYMSG-00008            PIC  9(05)  VALUE 00008.  01540000
015500         10  PC-TSYMSG-00050            PIC  9(05)  VALUE 00050.  01550000
015600         10  PC-TSYMSG-00051            PIC  9(05)  VALUE 00051.  01560000
015700         10  PC-TSYMSG-00052            PIC  9(05)  VALUE 00052.  01570000
015800         10  PC-TSYMSG-00053            PIC  9(05)  VALUE 00053.  01580000
015900         10  PC-TSYMSG-00054            PIC  9(05)  VALUE 00054.  01590000
016000         10  PC-TSYMSG-00055            PIC  9(05)  VALUE 00055.  01600000
016100         10  PC-TSYMSG-00057            PIC  9(05)  VALUE 00057.  01610000
016200         10  PC-TSYMSG-00069            PIC  9(05)  VALUE 00069.  01620000
016300         10  PC-TSYMSG-00070            PIC  9(05)  VALUE 00070.  01630000
016400         10  PC-TSYMSG-00098            PIC  9(05)  VALUE 00098.  01640000
016500         10  PC-TSYMSG-00101            PIC  9(05)  VALUE 00101.  01650000
016600         10  PC-TSYMSG-00279            PIC  9(05)  VALUE 00279.  01660000
016700         10  PC-TSYMSG-00551            PIC  9(05)  VALUE 00551.  01670000
016800         10  PC-TSYMSG-00743            PIC  9(05)  VALUE 00743.  01680000
016900         10  PC-TSYMSG-00746            PIC  9(05)  VALUE 00746.  01690000
017000         10  PC-TSYMSG-01563            PIC  9(05)  VALUE 01563.  01700000
017100         10  PC-TSYMSG-00840            PIC  9(05)  VALUE 00840.  01710000
017200         10  PC-TSYMSG-00984            PIC  9(05)  VALUE 00984.  01720000
017300         10  PC-TSYMSG-02227            PIC  9(05)  VALUE 02227.  01730000
017400         10  PC-TSYMSG-02792            PIC  9(05)  VALUE 02792.  01740000
017500         10  PC-TSYMSG-02793            PIC  9(05)  VALUE 02793.  01750000
017600         10  PC-TSYMSG-02796            PIC  9(05)  VALUE 02796.  01760000
017700         10  PC-TSYMSG-02799            PIC  9(05)  VALUE 02799.  01770000
017800         10  PC-TSYMSG-99901            PIC  9(05)  VALUE 99901.  01780000
017900                                                                  01790017
018000 01  PS-PROGRAM-SWITCHES.                                         01800000
018100     05  PS-BLOCK-ERROR-SW              PIC  X(01)  VALUE 'Y'.    01810000
018200         88  PS-NO-BLOCK-ERROR                      VALUE 'Y'.    01820000
018300         88  PS-BLOCK-ERROR                         VALUE 'N'.    01830000
018400     05  PS-ERROR-SW                    PIC  X(01)  VALUE 'Y'.    01840000
018500         88  PS-NO-ERROR                            VALUE 'Y'.    01850000
018600         88  PS-ERROR                               VALUE 'N'.    01860000
018700     05  PS-SOFT-ABORT-ERROR-SW         PIC  X(01)  VALUE 'N'.    01870000
018800         88  PS-SOFT-ABORT-ERROR                    VALUE 'Y'.    01880000
018900         88  PS-NO-SOFT-ABORT-ERROR                 VALUE 'N'.    01890000
019000     05  PS-COMMAREA-SW                 PIC  X(01)  VALUE 'N'.    01900000
019100         88  PS-COMMAREA-VALID                      VALUE 'Y'.    01910000
019200         88  PS-COMMAREA-NOT-VALID                  VALUE 'N'.    01920000
019300     05  PS-DONE-SW                     PIC  X(01)  VALUE 'N'.    01930000
019400         88  PS-DONE                                VALUE 'Y'.    01940000
019500         88  PS-NOT-DONE                            VALUE 'N'.    01950000
019600     05  PS-LIST-END-SW                 PIC  X(01)  VALUE 'N'.    01960000
019700         88  PS-LIST-END                            VALUE 'Y'.    01970000
019800         88  PS-NO-LIST-END                         VALUE 'N'.    01980000
019900     05  PS-ACCESS-SW                   PIC  X(01)  VALUE 'N'.    01990000
020000         88  PS-ACCESS-ALLOWED                      VALUE 'Y'.    02000000
020100         88  PS-ACCESS-NOT-ALLOWED                  VALUE 'N'.    02010000
020200     05  PS-LOAD-STATUS-SW              PIC  9(01)  VALUE 0.      02020000
020300         88  PS-ASSUMED                             VALUE 1.      02030000
020400         88  PS-DIVERTED                            VALUE 2.      02040000
020500                                                                  02050017
020600 01  PV-PROGRAM-VARIABLES.                                        02060000
020700     05  PV-TOT-CHILDREN                 PIC  Z,ZZZ,ZZ9.          02070000
020800     05  PV-TOT-UNITS                    PIC  ZZZ,ZZZ,ZZ9.        02080000
020900     05  PV-SML                          PIC  X(20).              02090000
021000     05  PV-SML-R   REDEFINES PV-SML.                             02100000
021100         10  PV-SML-1-18                 PIC  9(18).              02110000
021200         10  FILLER                      PIC  X(02).              02120000
021300     05  PV-RACF-ERROR-CODE              PIC  9(04) VALUE ZEROES. 02130000
021400     05  PV-ORIGINAL-BLOCK               PIC S9(04)  VALUE +0     02140000
021500                                                     COMP SYNC.   02150000
021600     05  PV-ITEMS-HOLD                   PIC S9(03)  COMP-3.      02160000
021700     05  PV-ITEMS-DIFF                   PIC S9(03)  COMP-3.      02170000
021800     05  PV-CICS-RESPONSE               PIC S9(08)  VALUE ZEROES  02180000
021900                                        COMP SYNC.                02190000
022000     05  PV-SUB                         PIC S9(04)  VALUE +0      02200000
022100                                                    COMP SYNC.    02210000
022200     05  PV-REMAINDER                   PIC S9(04)  VALUE +0      02220000
022300                                                    COMP SYNC.    02230000
022310     05  PV-READ-COUNT                  PIC S9(09)  VALUE +0      02231011
022320                                                    COMP-3.       02232011
022400     05  PV-STR-SCAN-COUNT              PIC S9(09)  VALUE +0      02240011
022500                                                    COMP.         02250011
022600     05  PV-ITEMS-PROCESSED             PIC S9(09)  VALUE +0      02260000
022700                                                    COMP-3.       02270000
022800     05  PV-HOLD-SELECTED-ITEMS         PIC S9(09)  VALUE +0      02280000
022900                                                    COMP-3.       02290000
023000     05  PV-ITEM-IN-USE                 PIC S9(09)  VALUE +0      02300000
023100                                                    COMP-3.       02310000
023200     05  PV-TOP-ITEM                    PIC S9(09)  VALUE +0      02320000
023300                                                    COMP-3.       02330000
023400     05  PV-BOTTOM-ITEM                 PIC S9(09)  VALUE +0      02340000
023500                                                    COMP-3.       02350000
023600     05  PV-TEMP-BLOCK-NUMBER           PIC S9(09)  VALUE +0      02360000
023700                                                    COMP-3.       02370000
023800     05  PV-BLOCK-NUMBER                PIC S9(04)  VALUE +0      02380000
023900                                                    COMP SYNC.    02390000
024000     05  PV-CICS-RESP                   PIC S9(04)  VALUE +0      02400000
024100                                                    COMP SYNC.    02410000
024200     05  PV-ITEM                        PIC S9(04)  VALUE +0      02420000
024300                                                    COMP SYNC.    02430000
024400     05  PV-SEL-QUEUE-ITEM              PIC S9(04)  VALUE +0      02440000
024500                                                    COMP SYNC.    02450000
024600     05  PV-SAVE-ITEM                   PIC S9(04)  VALUE +0      02460000
024700                                                    COMP SYNC.    02470000
024800     05  PV-HIGHEST-BLOCK-WRITTEN       PIC S9(04)  VALUE +0      02480000
024900                                                    COMP SYNC.    02490000
025000     05  PV-LIST-ITEM-NUMBER            PIC S9(04)  VALUE +0      02500000
025100                                                    COMP SYNC.    02510000
025200     05  PV-FIRST-BLOCK-IN-ARRAY        PIC S9(04)  VALUE +0      02520000
025300                                                    COMP SYNC.    02530000
025400     05  PV-NEXT-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      02540000
025500                                                    COMP SYNC.    02550000
025600     05  PV-PREV-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      02560000
025700                                                    COMP SYNC.    02570000
025800     05  PV-FIRST-BLOCK-IN-RANGE        PIC S9(04)  VALUE +0      02580000
025900                                                    COMP SYNC.    02590000
026000     05  PV-LAST-BLOCK-IN-RANGE         PIC S9(04)  VALUE +0      02600000
026100                                                    COMP SYNC.    02610000
026200     05  PV-START-OF-SELECTED-RANGE     PIC S9(04)  VALUE +0      02620000
026300                                                    COMP SYNC.    02630000
026400     05  PV-END-OF-SELECTED-RANGE       PIC S9(04)  VALUE +0      02640000
026500                                                    COMP SYNC.    02650000
026600     05  PV-SQL-SUB                     PIC S9(04)  VALUE +0      02660000
026700                                                    COMP SYNC.    02670000
026800     05  PV-RETRY-COUNTER               PIC S9(04)  VALUE +0      02680000
026900                                                    COMP SYNC.    02690000
027000     05  PV-NULL-IND-1                  PIC S9(04)  VALUE +0      02700000
027100                                                    COMP.         02710000
027200     05  PV-NULL-IND-2                  PIC S9(04)  VALUE +0      02720000
027300                                                    COMP.         02730000
027400     05  PV-NULL-IND-3                  PIC S9(04)  VALUE +0      02740000
027500                                                    COMP.         02750000
027600     05  PV-SOFT-ABORT-MSG.                                       02760000
027700         10  FILLER            PIC X(12) VALUE ' SUKCS599 - '.    02770000
027800         10  FILLER            PIC X(09) VALUE 'SQLCODE: '.       02780000
027900         10  PV-SOFT-SQLCODE   PIC ZZZZZZZZ9-.                    02790000
028000         10  FILLER            PIC X(12) VALUE ' PARAGRAPH: '.    02800000
028100         10  PV-SOFT-PARAGRAPH PIC X(30).                         02810000
028200     05  PV-COMMAREA-LENGTH              PIC S9(04)  VALUE +0     02820000
028300                                                     COMP SYNC.   02830000
028400     05  PV-CICS-MSG-AREA.                                        02840000
028500         10  FILLER                      PIC X(05) VALUE 'TASK='. 02850000
028600         10  PV-CICS-TASK                PIC ZZZZ9.               02860000
028700         10  FILLER                      PIC X(01) VALUE SPACES.  02870000
028800         10  PV-CICS-MSG                 PIC X(68) VALUE SPACES.  02880000
028900                                                                  02890000
029000     05  PV-TMST                 PIC X(26)   VALUE SPACES.        02900000
029100     05  PV-TMST-R REDEFINES  PV-TMST.                            02910000
029200         10   PV-TMST-DATE.                                       02920000
029300             15   PV-TMST-CCYY          PIC X(04).                02930000
029400             15   FILLER                PIC X(01).                02940000
029500             15   PV-TMST-MM            PIC X(02).                02950000
029600             15   FILLER                PIC X(01).                02960000
029700             15   PV-TMST-DD            PIC X(02).                02970000
029800         10   FILLER                    PIC X(01).                02980000
029900         10   PV-TMST-TIME.                                       02990000
030000             15   PV-TMST-HRS           PIC X(02).                03000000
030100             15   FILLER                PIC X(01).                03010000
030200             15   PV-TMST-MIN           PIC X(02).                03020000
030300         10   FILLER                    PIC X(01).                03030000
030400         10   PV-TMST-SEC               PIC X(02).                03040000
030500         10   FILLER                    PIC X(07).                03050000
030600     05  PV-DATE-DISPLAY.                                         03060000
030700         10   PV-DISPLAY-MM             PIC X(02)   VALUE SPACES. 03070000
030800         10   PV-SLASH-1                PIC X(01)   VALUE '-'.    03080000
030900         10   PV-DISPLAY-DD             PIC X(02)   VALUE SPACES. 03090000
031000         10   PV-SLASH-2                PIC X(01)   VALUE '-'.    03100000
031100         10   PV-DISPLAY-YY             PIC X(02)   VALUE SPACES. 03110000
031200     05  PV-TIME-DISPLAY.                                         03120000
031300         10   PV-AT                     PIC X(03)   VALUE SPACES. 03130000
031400         10   PV-DISPLAY-HRS            PIC X(02)   VALUE SPACES. 03140000
031500         10   PV-SEMICOLON-1            PIC X(01)   VALUE SPACES. 03150000
031600         10   PV-DISPLAY-MIN            PIC X(02)   VALUE SPACES. 03160000
031700         10   PV-SEMICOLON-2            PIC X(01)   VALUE SPACES. 03170000
031800         10   PV-DISPLAY-SEC            PIC X(02)   VALUE SPACES. 03180000
031900     05  PV-DATE-TIME.                                            03190000
032000         10   PV-DT-CC             PIC X(02)  VALUE '20'.         03200000
032100         10   PV-DT-YY             PIC X(02)  VALUE ZEROES.       03210000
032200         10   FILLER               PIC X(01)  VALUE '-'.          03220000
032300         10   PV-DT-MM             PIC X(02)  VALUE ZEROES.       03230000
032400         10   FILLER               PIC X(01)  VALUE '-'.          03240000
032500         10   PV-DT-DD             PIC X(02)  VALUE ZEROES.       03250000
032600         10   FILLER               PIC X(01)  VALUE '-'.          03260000
032700         10   PV-DT-HRS            PIC X(02)   VALUE SPACES.      03270000
032800         10   FILLER               PIC X(01)   VALUE '.'.         03280000
032900         10   PV-DT-MIN            PIC X(02)   VALUE SPACES.      03290000
033000         10   FILLER               PIC X(01)   VALUE '.'.         03300000
033100         10   PV-DT-SEC            PIC X(09)   VALUE '59.999999'. 03310000
033200     05  PV-USA-DATE               PIC  X(10) VALUE SPACES.       03320000
033300     05  PV-JIS-TIME               PIC  X(05) VALUE SPACES.       03330000
033400     05  PV-SELECT-LIST-SEQ        PIC  X(01) VALUE SPACES.       03340000
033500     05  PV-NBR-ITEMS              PIC  9(05) VALUE ZEROES.       03350000
033600     05  PV-SEL-TERM-ID            PIC  X(04).                    03360000
033700     05  PV-SEL-TASK-NUMBER        PIC  9(05).                    03370000
033800     05  PV-SEL-SEQ                PIC  9(01).                    03380000
033900     05  PV-SHPD-QTY               PIC S9(9) COMP-3 VALUE ZEROES. 03390000
034000                                                                  03400000
034100******************************************************************03410000
034200**  THIS IS THE LAYOUT FOR THE LIST ITEMS TEMP STORAGE QUEUE.   **03420000
034300**  THIS MUST BE THE EXACT SAME FORMAT A BLOCK IN THE           **03430000
034400**  APPLICATION-SPECIFIC COMMAREA.                              **03440000
034500******************************************************************03450000
034600 01  LQW-LIST-QUEUE-WORK-AREA.                                    03460000
034700     05  LQW-BLOCK-MODIFIED             PIC  X(01)  VALUE SPACE.  03470000
034800     05  LQW-ITEM-ENTRIES               OCCURS 10 TIMES           03480000
034900                                        INDEXED BY LQW-IDX.       03490000
035000         10  LQW-LIST-ITEM-NUMBER       PIC S9(09)  COMP-3.       03500000
035100         10  LQW-TEMP-SELECTED-SW       PIC  X(01).               03510000
035200         10  LQW-SELECTED-SW            PIC  X(01).               03520000
035300             88  LQW-SELECT                         VALUE 'S'.    03530000
035400             88  LQW-DESELECT                       VALUE ' '.    03540000
035500         10  LQW-ACTION                 PIC  X(03).               03550000
035600             88  LQW-DEL                            VALUE 'DEL'.  03560000
035700             88  LQW-INQ                            VALUE 'INQ'.  03570000
035800             88  LQW-UPD                            VALUE 'UPD'.  03580000
035900             88  LQW-ERR                            VALUE 'ERR'.  03590000
036000         10  LQW-SML                    PIC  X(20).               03600000
036100         10  LQW-DEST-NBR               PIC  9(04).               03610000
036200         10  LQW-CREATE                 PIC  X(03).               03620000
036210         10  LQW-STR-SCAN               PIC  X(04).               03621002
036300         10  LQW-STAT-DATE              PIC  X(08).               03630000
036400         10  LQW-STAT-TIME              PIC  X(05).               03640000
036500         10  LQW-UNITS-MANIFST          PIC  9(06).               03650000
036600         10  LQW-LOAD-STATUS            PIC  X(07).               03660000
036700         10  LQW-TRIP-ID                PIC  X(09).               03670000
036710         10  LQW-STR-MULT-SW            PIC  X(01).               03671011
036800                                                                  03680000
036900*---------------------------------------------------------------* 03690000
037000* SELECTON QUEUE LAYOUT                                         * 03700000
037100*---------------------------------------------------------------* 03710000
037200     COPY SUWS010.                                                03720000
037300                                                                  03730000
037400******************************************************************03740000
037500* COMMAREA FOR PCKUT713 - CARTON STATUS MODULE                    03750014
037600******************************************************************03760000
037700     COPY PCWS046.                                                03770000
037800                                                                  03780000
037900*    FLAT COMMAREA FROM SUKCS750                                  03790000
038000*    THIS CONTAINS A TABLE OF SML NBRS TO BE PROCESSED            03800000
038100     COPY SUWS033.                                                03810000
038200*---------------------------------------------------------------* 03820000
038300*    MAP LAYOUT                                                 * 03830000
038400*---------------------------------------------------------------* 03840000
038500     COPY SUKM599.                                                03850000
038600                                                                  03860017
038700 01  MR-OCCURS-LAYOUT                   REDEFINES  SU599AO.       03870000
038800     05  FILLER                         PIC X(191).               03880000
038900     05  MR-SCROLL-AREA                 OCCURS 10 TIMES.          03890000
039000         10  MR-SELECTL                 PIC S9(04) COMP.          03900000
039100         10  MR-SELECTA                 PIC  X(01).               03910000
039200         10  MR-SELECTC                 PIC  X(01).               03920000
039300         10  MR-SELECTH                 PIC  X(01).               03930000
039400         10  MR-SELECTI                 PIC  X(01).               03940000
039500                                                                  03950000
039600         10  MR-ACTIONL                 PIC S9(04) COMP.          03960000
039700         10  MR-ACTIONA                 PIC  X(01).               03970000
039800         10  MR-ACTIONC                 PIC  X(01).               03980000
039900         10  MR-ACTIONH                 PIC  X(01).               03990000
040000         10  MR-ACTION                  PIC  X(01).               04000002
040100                                                                  04010000
040200         10  MR-SMLL                    PIC S9(04) COMP.          04020000
040300         10  MR-SMLA                    PIC  X(01).               04030000
040400         10  MR-SMLC                    PIC  X(01).               04040000
040500         10  MR-SMLH                    PIC  X(01).               04050000
040600         10  MR-SML                     PIC  X(20).               04060000
040700                                                                  04070000
040800         10  MR-DEST-NBRL               PIC S9(04) COMP.          04080000
040900         10  MR-DEST-NBRA               PIC  X(01).               04090000
041000         10  MR-DEST-NBRC               PIC  X(01).               04100000
041100         10  MR-DEST-NBRH               PIC  X(01).               04110000
041200         10  MR-DEST-NBR                PIC  Z(04).               04120000
041300                                                                  04130000
041400         10  MR-CREATEL                 PIC S9(04) COMP.          04140000
041500         10  MR-CREATEA                 PIC  X(01).               04150000
041600         10  MR-CREATEC                 PIC  X(01).               04160000
041700         10  MR-CREATEH                 PIC  X(01).               04170000
041800         10  MR-CREATE                  PIC  X(03).               04180000
041910         10  MR-STR-SCANL               PIC S9(04) COMP.          04191002
041920         10  MR-STR-SCANA               PIC  X(01).               04192002
041930         10  MR-STR-SCANC               PIC  X(01).               04193002
041940         10  MR-STR-SCANH               PIC  X(01).               04194002
041950         10  MR-STR-SCAN                PIC  X(04).               04195002
042000         10  MR-STAT-DATEL              PIC S9(04) COMP.          04200000
042100         10  MR-STAT-DATEA              PIC  X(01).               04210000
042200         10  MR-STAT-DATEC              PIC  X(01).               04220000
042300         10  MR-STAT-DATEH              PIC  X(01).               04230000
042400         10  MR-STAT-DATE               PIC  X(08).               04240000
042500                                                                  04250000
042600         10  MR-STAT-TIMEL              PIC S9(04) COMP.          04260000
042700         10  MR-STAT-TIMEA              PIC  X(01).               04270000
042800         10  MR-STAT-TIMEC              PIC  X(01).               04280000
042900         10  MR-STAT-TIMEH              PIC  X(01).               04290000
043000         10  MR-STAT-TIME               PIC  X(05).               04300000
043100                                                                  04310000
043200         10  MR-UNTS-MNFSTDL            PIC S9(04) COMP.          04320000
043300         10  MR-UNTS-MNFSTDA            PIC  X(01).               04330000
043400         10  MR-UNTS-MNFSTDC            PIC  X(01).               04340000
043500         10  MR-UNTS-MNFSTDH            PIC  X(01).               04350000
043600         10  MR-UNTS-MNFSTD-X           PIC  X(06).               04360000
043700         10  MR-UNTS-MNFSTD-N REDEFINES MR-UNTS-MNFSTD-X.         04370000
043800             15  MR-UNTS-MNFSTD         PIC  ZZZZZ9.              04380000
043900                                                                  04390000
044000         10  MR-LOAD-STATUSL            PIC S9(04) COMP.          04400000
044100         10  MR-LOAD-STATUSA            PIC  X(01).               04410000
044200         10  MR-LOAD-STATUSC            PIC  X(01).               04420000
044300         10  MR-LOAD-STATUSH            PIC  X(01).               04430000
044400         10  MR-LOAD-STATUS             PIC  X(07).               04440000
044500                                                                  04450000
044600         10  MR-TRIP-IDL                PIC S9(04) COMP.          04460000
044700         10  MR-TRIP-IDA                PIC  X(01).               04470000
044800         10  MR-TRIP-IDC                PIC  X(01).               04480000
044900         10  MR-TRIP-IDH                PIC  X(01).               04490000
045000         10  MR-TRIP-ID                 PIC  X(09).               04500000
045100                                                                  04510000
045200     05  FILLER                         PIC  X(03).               04520000
045300                                                                  04530000
045400*---------------------------------------------------------------* 04540000
045500*    ATTRIBUTE SETTINGS COPYBOOK.                               * 04550000
045600*---------------------------------------------------------------* 04560000
045700     COPY DPWS015.                                                04570000
045800                                                                  04580000
045900*---------------------------------------------------------------* 04590000
046000*    FUNCTION KEYS COPYBOOK.                                    * 04600000
046100*---------------------------------------------------------------* 04610000
046200     COPY DPWS016.                                                04620000
046300                                                                  04630000
046400*---------------------------------------------------------------* 04640000
046500*    NUMERIC EDIT LAYOUT.                                       * 04650000
046600*---------------------------------------------------------------* 04660000
046700     COPY DPWS010I.                                               04670000
046800                                                                  04680000
046900*---------------------------------------------------------------* 04690000
047000*    PARAMETERS FOR CALLING CICS ARCHITECTURE API               * 04700019
047100*---------------------------------------------------------------* 04710000
047200     COPY DPWS030.                                                04720000
047200     COPY DPWS930.                                                04721019
047300                                                                  04730000
047400***************************************************************** 04740000
047500*   XLWS071 - IS THE LAYOUT THAT IS USED TO PASS INFO TO THE    * 04750000
047600*             LOCATION MODULE (XLKUT071)                        * 04760000
047700***************************************************************** 04770000
047800     COPY XLWS071.                                                04780000
047900                                                                  04790000
048000******************************************************************04800000
048100*  SENDING/RECEIVING AREA FOR THE                                *04810000
048200*  PRINTER VALIDATION ROUTING (DPKCS060)                         *04820000
048300******************************************************************04830000
048400     COPY DPWS072.                                                04840000
048500*                                                                 04850000
048600*---------------------------------------------------------------* 04860000
048700*    STANDARD COMMAREA.                                         * 04870000
048800*---------------------------------------------------------------* 04880000
048900     COPY DPWS020.                                                04890000
049000     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                04900000
049100                                                                  04910000
049200*---------------------------------------------------------------* 04920000
049300* INTER-APPLICATION COMMAREA.                                   * 04930000
049400*   SUWS008 - IS THE INPUT LAYOUT WHEN COMING FROM THE CRIT.    * 04940000
049500*             SPEC SCREEN.                                      * 04950000
049600*   SUWS009 - IS THE OUTPUT LAYOUT THAT WILL BE PASSED FROM     * 04960000
049700*             THIS LIST PROGRAMMING FOR A LOCAL-GO FUNCTION.    * 04970000
049800*---------------------------------------------------------------* 04980000
049900                                                                  04990000
050000         10  INTER-APPL-COMM-AREA       PIC X(200).               05000000
050100     COPY SUWS008.                                                05010000
050200     COPY SUWS009.                                                05020000
050300*---------------------------------------------------------------* 05030000
050400*  THIS IS THE APPLICATION-SPECIFIC COMMAREA.                   * 05040000
050500*---------------------------------------------------------------* 05050000
050600         10  ASC-SPECIFIC-COMMAREA.                               05060000
050700             15  ASC-MASTER-SML              PIC S9(18) COMP-3.   05070000
050800             15  ASC-MASTER-STAT-DESC        PIC  X(19).          05080000
050900             15  ASC-MASTER-STAT-DATE        PIC  X(19).          05090000
051000             15  ASC-OPER-UNT-ID             PIC  X(04).          05100000
051100             15  ASC-OPER-UNT-ID-N REDEFINES                      05110000
051200                     ASC-OPER-UNT-ID         PIC  9(04).          05120000
051300             15  ASC-OPER-NAME               PIC  X(25).          05130000
051400             15  ASC-DEST-OPER-UNT-ID        PIC  X(04).          05140000
051500             15  ASC-DEST-OPER-UNT-ID-N REDEFINES                 05150000
051600                     ASC-DEST-OPER-UNT-ID    PIC  9(04).          05160000
051700             15  ASC-DEST-OPER-NAME          PIC  X(25).          05170000
051800             15  ASC-OUTBOUND-TRIP-ID        PIC  X(09).          05180000
051900             15  ASC-STR-NBR-X               PIC  X(04).          05190000
052000             15  ASC-STR-NBR-N REDEFINES ASC-STR-NBR-X.           05200000
052100                 20  ASC-STR-NBR             PIC  9(04).          05210000
052200             15  ASC-STATUS-DATE             PIC  X(08).          05220000
052300             15  ASC-STATUS-TIME             PIC  X(05).          05230000
052400             15  ASC-SML-NBR                 PIC  X(20).          05240000
052500             15  ASC-CREATE-ID               PIC  X(03).          05250000
052600             15  ASC-PO-RCVR                 PIC  X(12).          05260000
052700             15  ASC-LINE-NBR                PIC  9(04).          05270000
052800             15  ASC-LINE-STAT               PIC  X(02).          05280000
052900             15  ASC-TOT-CRTNS               PIC  Z(06).          05290000
053000             15  ASC-UNTS-MNFD               PIC  9(06).          05300000
053100             15  ASC-PRTR                    PIC  X(08).          05310000
053200             15  ASC-TRIPID                  PIC  9(09).          05320000
053300             15  ASC-PO-NBR                  PIC  9(09).          05330000
053400             15  ASC-RCVR-NBR                PIC  9(09).          05340000
053500             15  ASC-STATUS-CDE              PIC  XX.             05350000
053600             15  ASC-PACK-BY-ST-IND          PIC  X.              05360000
053700             15  ASC-CURR-OPER-UNT-ID        PIC  S9(4) COMP.     05370000
053800             15  ASC-PKGNG-CDE               PIC  X.              05380000
053900             15  ASC-SEQUENCE-SW             PIC  X(01).          05390000
054000                 88  ASC-LOADED-CRTNS           VALUE 'L'.        05400000
054100                 88  ASC-NOT-LOADED-CRTNS       VALUE 'N'.        05410000
054200             15  FILLER                      PIC  X(025).         05420000
054300*-----------------------------------------------------------------05430000
054400             15  ASC-BLK-SUB                  PIC S9(04) COMP     05440000
054500                                                         SYNC.    05450000
054600             15  ASC-ITEM-SUB                 PIC S9(04) COMP     05460000
054700                                                         SYNC.    05470000
054800             15  ASC-NUMBER-OF-ITEMS-READ     PIC S9(09) COMP-3.  05480000
054900             15  ASC-NUMBER-OF-SELECTED-ITEMS PIC S9(09) COMP-3.  05490000
055000             15  ASC-ITEMS-DISPLAYED          PIC S9(03) COMP-3.  05500000
055100             15  ASC-ITEM-AT-TOP-OF-PANEL     PIC S9(09) COMP-3.  05510000
055200             15  ASC-ITEM-AT-BOT-OF-PANEL     PIC S9(09) COMP-3.  05520000
055300             15  ASC-HIGHEST-BLOCK-WRITTEN    PIC S9(04) COMP     05530000
055400                                                         SYNC.    05540000
055500             15  ASC-START-OF-SELECTED-RANGE  PIC S9(09) COMP-3.  05550000
055600             15  ASC-END-OF-SELECTED-RANGE    PIC S9(09) COMP-3.  05560000
055700             15  ASC-ITEMS-LEFT-INDICATOR     PIC  X(01).         05570000
055800                 88  ASC-ITEMS-LEFT-ON-DB          VALUE 'Y'.     05580000
055900                 88  ASC-NO-ITEMS-LEFT-ON-DB       VALUE 'N'.     05590000
056000             15  ASC-TEMP-QUEUE-UPDATE-SW     PIC  X(01).         05600000
056100                 88  ASC-UPDATE-TSQ                VALUE 'Y'.     05610000
056200                 88  ASC-NO-TSQ-UPDATE             VALUE ' '.     05620000
056300             15  ASC-LIST-QUEUE-NAME.                             05630000
056400                 20  ASC-LIST-TERM-ID         PIC  X(04).         05640000
056500                 20  ASC-LIST-TASK-NUMBER     PIC S9(05) COMP-3.  05650000
056600                 20  ASC-LIST-SEQ             PIC  9(01).         05660000
056700                                                                  05670000
056800             15  ASC-START-ITEM-REQUEST.                          05680000
056900                 20  ASC-START-ITEM-REQUEST-N PIC  9(05).         05690000
057000                                                                  05700000
057100             15  ASC-SEL-SUB                  PIC S9(4) COMP.     05710000
057200             15  ASC-SEL-ITEM                 PIC S9(4) COMP.     05720000
057300             15  ASC-USE-SELECTION-QUEUE-IND  PIC  X(1).          05730000
057400                 88  ASC-USE-SELECTION-QUEUE           VALUE 'Y'. 05740000
057500             15  ASC-SEL-QUEUE-NAME-OUT.                          05750000
057600                 20  ASC-SEL-TERM-ID-OUT      PIC  X(04).         05760000
057700                 20  ASC-SEL-TASK-NUMBER-OUT  PIC S9(05) COMP-3.  05770000
057800                 20  ASC-SEL-SEQ-OUT          PIC  9(01).         05780000
057900             15  ASC-SEL-QUEUE-NAME-IN.                           05790000
058000                 20  ASC-SEL-TERM-ID-IN       PIC  X(04).         05800000
058100                 20  ASC-SEL-TASK-NUMBER-IN   PIC S9(05) COMP-3.  05810000
058200                 20  ASC-SEL-SEQ-IN           PIC  9(01).         05820000
058300             15  ASC-NUMBER-OF-TS-ITEMS       PIC S9(09) COMP-3.  05830000
058400                                                                  05840000
058500*-----------------------------------------------------------------05850000
058600             15  ASC-BLOCK-ENTRIES OCCURS 2 TIMES.                05860000
058700                 20  ASC-BLOCK-MODIFIED-SW           PIC  X(01).  05870000
058800                     88  ASC-BLOCK-NOT-MODIFIED      VALUE 'N'.   05880000
058900                     88  ASC-BLOCK-MODIFIED          VALUE 'Y'.   05890000
059000                                                                  05900000
059100                 20  ASC-ITEM-ARRAY.                              05910000
059200                     25  ASC-ITEM-ENTRIES OCCURS 10 TIMES.        05920000
059300                         30  ASC-LIST-ITEM-NUMBER                 05930000
059400                                                     PIC S9(09)   05940000
059500                                                     COMP-3.      05950000
059600                         30  ASC-TEMP-SELECTED-SW    PIC  X(01).  05960000
059700                             88  ASC-VALID-SELECT    VALUE ' '    05970000
059800                                                           'S'    05980000
059900                                                           'B'    05990000
060000                                                           'E'.   06000000
060100                             88  ASC-TEMP-NO-SELECT  VALUE ' '.   06010000
060200                             88  ASC-TEMP-SELECT     VALUE 'S'.   06020000
060300                             88  ASC-TEMP-BEGIN      VALUE 'B'.   06030000
060400                             88  ASC-TEMP-END        VALUE 'E'.   06040000
060500                         30  ASC-SELECTED-SW         PIC  X(01).  06050000
060600                             88  ASC-NO-SELECT       VALUE ' '.   06060000
060700                             88  ASC-SELECT          VALUE 'S'.   06070000
060800                             88  ASC-BEGIN           VALUE 'B'.   06080000
060900                             88  ASC-END             VALUE 'E'.   06090000
061000                         30  ASC-ACTION               PIC  X(03). 06100000
061100                         30  ASC-SML                  PIC  X(20). 06110000
061200                         30  ASC-DEST-NBR             PIC  9(04). 06120000
061300                         30  ASC-CREATE               PIC  X(03). 06130000
061310                         30  ASC-STR-SCAN             PIC  X(04). 06131002
061400                         30  ASC-STAT-DATE            PIC  X(08). 06140000
061500                         30  ASC-STAT-TIME            PIC  X(05). 06150000
061600                         30  ASC-UNTS-MNFSTD          PIC  9(06). 06160000
061700                         30  ASC-LOAD-STATUS          PIC  X(07). 06170000
061800                         30  ASC-TRIP-ID              PIC  X(09). 06180000
061900                         30  ASC-TRIP-ID-X REDEFINES ASC-TRIP-ID. 06190000
062000                             35  ASC-TRIP-ID-N        PIC  Z(09). 06200000
062010                         30  ASC-STR-MULT-SW          PIC  X.     06201011
062020                             88  ASC-STR-MULT   VALUE 'M'.        06202011
062100             15  ASC-PRTR-AUTO-CUTTER-IND    PIC  X(01).          06210000
062200             15  ASC-PRTR-PRTR-BRCDE-IND     PIC  X(01).          06220000
062300             15  ASC-PRTR-PRTR-CNTL-IND      PIC  X(01).          06230000
062400             15  ASC-PRTR-LOC-DESC           PIC  X(30).          06240000
062500             15  ASC-CALLED-PROGRAM          PIC  X(08).          06250000
062600                 88 ASC-CARTON-MANIFEST-PGM                       06260000
062700                                           VALUE 'SUKCS751'.      06270000
062800                                                                  06280000
062900*---------------------------------------------------------------* 06290000
063000*    ABEND PROCESSING COPYBOOK.                                 * 06300000
063100*---------------------------------------------------------------* 06310000
063200     COPY DPWS013.                                                06320000
063300                                                                  06330000
063400*---------------------------------------------------------------* 06340000
063500*    SUT_OTBND_CART OUTBOUND CARTON TABLE                         06350000
063600*---------------------------------------------------------------* 06360000
063700     EXEC SQL                                                     06370000
063800          INCLUDE SUT00024                                        06380000
063900     END-EXEC.                                                    06390000
064000                                                                  06400000
064100*---------------------------------------------------------------* 06410000
064200*    SUT_OTBND_UPC UPC TABLE                                      06420000
064300*---------------------------------------------------------------* 06430000
064400     EXEC SQL                                                     06440000
064500          INCLUDE SUT00028                                        06450000
064600     END-EXEC.                                                    06460000
064700                                                                  06470000
064800*---------------------------------------------------------------* 06480000
064900*    SUT_OTBND_VND                                                06490000
065000*---------------------------------------------------------------* 06500000
065100     EXEC SQL                                                     06510000
065200          INCLUDE SUT00026                                        06520000
065300     END-EXEC.                                                    06530000
065400                                                                  06540000
065500*---------------------------------------------------------------* 06550000
065600*    TSUCRDV - CARTON DIVERT TABLE                                06560000
065700*---------------------------------------------------------------* 06570000
065800     EXEC SQL                                                     06580000
065900          INCLUDE TSUCRDV                                         06590000
066000     END-EXEC.                                                    06600000
066100                                                                  06610000
066200*---------------------------------------------------------------* 06620000
066300*    TCNDCDR - DC DOOR TABLE                                      06630000
066400*---------------------------------------------------------------* 06640000
066500     EXEC SQL                                                     06650000
066600          INCLUDE TCNDCDR                                         06660000
066700     END-EXEC.                                                    06670000
066800                                                                  06680000
066900*---------------------------------------------------------------* 06690000
067000*    TSUOBTR - OUTBOUND TRIP TABLE                                06700000
067100*---------------------------------------------------------------* 06710000
067200     EXEC SQL                                                     06720000
067300          INCLUDE TSUOBTR                                         06730000
067400     END-EXEC.                                                    06740000
067500                                                                  06750000
067600*---------------------------------------------------------------* 06760000
067700*    TSUOBTS - OUTBOUND TRIP STATUS TABLE                         06770000
067800*---------------------------------------------------------------* 06780000
067900     EXEC SQL                                                     06790000
068000          INCLUDE TSUOBTS                                         06800000
068100     END-EXEC.                                                    06810000
068200                                                                  06820000
068300*---------------------------------------------------------------* 06830000
068400*    TSUCDOT - OUTBOUND TRIP/CARTON DIVERT ASSOCIATION TABLE      06840000
068500*---------------------------------------------------------------* 06850000
068600     EXEC SQL                                                     06860000
068700          INCLUDE TSUCDOT                                         06870000
068800     END-EXEC.                                                    06880000
068900                                                                  06890000
069000*---------------------------------------------------------------* 06900000
069100*    SUT_MSTR_SHIPT_UNT                                         * 06910000
069200*---------------------------------------------------------------* 06920000
069300     EXEC SQL                                                     06930000
069400          INCLUDE SUT00098                                        06940000
069500     END-EXEC.                                                    06950000
069600                                                                  06960000
069700*---------------------------------------------------------------* 06970000
069800*    SUT_MSTR_SHIPT_CNT                                         * 06980000
069900*---------------------------------------------------------------* 06990000
070000     EXEC SQL                                                     07000000
070100          INCLUDE SUT00099                                        07010000
070200     END-EXEC.                                                    07020000
070300                                                                  07030000
070310*---------------------------------------------------------------* 07031002
070320*    SUT_OTBND_STR_SCN                                          * 07032002
070330*---------------------------------------------------------------* 07033002
070340     EXEC SQL                                                     07034002
070350          INCLUDE SUT00121                                        07035002
070360     END-EXEC.                                                    07036002
070370                                                                  07037002
070400*---------------------------------------------------------------* 07040000
070500*    DB2 AREA FOR COMMUNICATIONS                                * 07050000
070600*---------------------------------------------------------------* 07060000
070700     EXEC SQL                                                     07070000
070800          INCLUDE SQLCA                                           07080000
070900     END-EXEC.                                                    07090000
071000                                                                  07100000
071100*---------------------------------------------------------------* 07110000
071200*  CURSOR TO RETRIEVE CARTONS BY PO, RECEIVER, LINE               07120000
071300*---------------------------------------------------------------* 07130000
071400     EXEC SQL                                                     07140000
071500          DECLARE CARTON-CSR CURSOR FOR                           07150000
071600        SELECT  SHIPT_UNT_ID                                      07160000
071700             ,  DEST_LOC_NBR                                      07170000
071800          FROM  SUT_OTBND_CART                                    07180000
071900         WHERE  PRNT_CART_ID   = :DK-SHIPT-UNT-ID                 07190000
072000           AND  PRNT_CART_ID   <> SHIPT_UNT_ID                    07200000
072100     END-EXEC.                                                    07210000
072200                                                                  07220000
072300                                                                  07230000
072400*---------------------------------------------------------------* 07240000
072500*  CURSOR TO RETRIEVE MASTER CONTAINER BUILD                      07250000
072600*---------------------------------------------------------------* 07260000
072700     EXEC SQL                                                     07270000
072800          DECLARE DISOLVED-MSTR-CSR CURSOR FOR                    07280000
072900        SELECT  A.CHLD_SHIPT_UNT_ID                               07290000
073000             ,  B.DEST_LOC_NBR                                    07300000
073100          FROM  SUT_MSTR_SHIPT_CNT A                              07310000
073200             ,  SUT_OTBND_CART     B                              07320000
073300         WHERE  A.MSTR_SHIPT_UNT_ID =  :DK-SHIPT-UNT-ID           07330015
073400           AND  A.ACTN_TYP_CDE      IN ('ACM','RTM')              07340015
073500           AND  A.CRE_TMST IN                                     07350000
073600                (SELECT MAX(B.CRE_TMST)                           07360000
073700                 FROM SUT_MSTR_SHIPT_CNT B                        07370000
073800                 WHERE A.MSTR_SHIPT_UNT_ID = B.MSTR_SHIPT_UNT_ID  07380000
073900                   AND A.CHLD_SHIPT_UNT_ID = B.CHLD_SHIPT_UNT_ID) 07390000
074000           AND A.CHLD_SHIPT_UNT_ID = B.SHIPT_UNT_ID               07400000
074100          ORDER BY A.CHLD_SHIPT_UNT_ID                            07410000
074200     END-EXEC.                                                    07420000
074300                                                                  07430000
074400                                                                  07440000
074500*-----------------------------------------------------------------07450000
074600 LINKAGE SECTION.                                                 07460000
074700                                                                  07470000
074800 01  DFHCOMMAREA.                                                 07480000
074900     05  FILLER                         OCCURS  1 TO 4072 TIMES   07490000
075000                                        DEPENDING ON EIBCALEN.    07500000
075100         10  FILLER                     PIC X.                    07510000
075200                                                                  07520000
075300                                                                  07530000
075400 PROCEDURE DIVISION.                                              07540000
075500******************************************************************07550000
075600**  THIS MODULE IS THE HIGHEST PROCESSING LEVEL IN THE PROGRAM. **07560000
075700**  FIRST, CALL THE CICS ARCHITECTURE API, PERFORM THE PROGRAM  **07570000
075800**  PROCESSING AND THEN CALL THE CICS ARCHITECTURE API TO EXIT. **07580000
075900******************************************************************07590000
076000 0000-MAIN-MODULE.                                                07600000
076100     INITIALIZE DP030-CICS-API-FIELDS.                            07610000
076200     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       07620000
076300     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          07630000
076400     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         07640000
076500     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       07650000
076600     MOVE LENGTH OF SU599AI        TO DP030-MAP-LENGTH (1).       07660000
076700     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     07670000
076800     PERFORM 0001-CALL-CICS-ARCH-API.                             07680000
076900                                                                  07690017
077000     PERFORM 1000-CONTROL-PROCESSING                              07700000
077100                                                                  07710017
077200     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     07720000
077300     PERFORM 0001-CALL-CICS-ARCH-API.                             07730000
077400                                                                  07740000
077500******************************************************************07750000
077600**  THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE   **07760000
077700**  AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.         **07770000
077800******************************************************************07780000
077900 0001-CALL-CICS-ARCH-API.                                         07790000
078000                                                                  07800000
078100*    CALL 'DPKCS030' USING DFHEIBLK                               07810019
078100     CALL DP930-CICS-ARCH-API USING DFHEIBLK                      07811019
078200                           DFHCOMMAREA                            07820000
078300                           DP030-CICS-API-FIELDS                  07830000
078400                           DP020-STANDARD-COMMAREA                07840000
078500                           SU599AI.                               07850000
078600                                                                  07860017
078700     IF  DP030-RC-CALL-SUCCESSFUL                                 07870000
078800         CONTINUE                                                 07880000
078900     ELSE                                                         07890000
079000         SET DP013-NO-ROLLBACK                                    07900000
079100             DP013-XCTL-DISPLAY-RESTART                           07910000
079200             DP013-CICS-ABEND      TO TRUE                        07920000
079300         MOVE '0001-CALL-CICS-ARCH-API' TO DP013-PARAGRAPH        07930000
079400*        MOVE 'CALL TO DPKCS030 NOT SUCCESSFUL, RETURN-CODE ON NEX07940019
079500*             'T LINE'             TO DP013-MESSAGE-TEXT (2)      07950019
079400         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O07951019
079500-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      07952019
079600         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      07960000
079700         PERFORM DP013-0000-PROCESS-ABEND                         07970000
079800     END-IF.                                                      07980000
079900                                                                  07990000
080000*----------------------------------------------------------------*08000000
080100* PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT      *08010000
080200* COURSE OF ACTION IS FOR THIS TRANSACTION.                      *08020000
080300*                                                                *08030000
080400* NOTE:  PV-TOP-ITEM IS THE ITEM THAT IS REQUESTED TO BE AT THE  *08040000
080500*  TOP OF THE PANEL.  MOVING ASC-ITEM-AT-TOP-OF-PANEL TO THIS    *08050000
080600*  MEANS THAT POSITION WITHIN THE LIST WILL NOT CHANGE -- THIS   *08060000
080700*  IS THE DEFAULT WHICH WILL BE OVERRIDDEN BY SCROLLING ACTIONS. *08070000
080800*----------------------------------------------------------------*08080000
080900 1000-CONTROL-PROCESSING.                                         08090000
081000                                                                  08100000
081100                                                                  08110000
081200     EVALUATE TRUE                                                08120000
081300         WHEN DP020-NEXT-ACT-INITIAL                              08130000
081400                 INITIALIZE ASC-SPECIFIC-COMMAREA                 08140000
081500                 MOVE EIBTRMID   TO ASC-LIST-TERM-ID              08150000
081600                                    ASC-SEL-TERM-ID-OUT           08160000
081700                MOVE DP020-SRC-TASK-NUMBER TO ASC-LIST-TASK-NUMBER08170000
081800                                           ASC-SEL-TASK-NUMBER-OUT08180000
081900                 MOVE PC-LIST-QUEUE-SEQ  TO ASC-LIST-SEQ          08190000
082000                 MOVE PC-SEL-QUEUE-SEQ TO ASC-SEL-SEQ-OUT         08200000
082100                 PERFORM 1100-PROCESS-INTER-APPL-COMM             08210000
082200                 PERFORM 4000-BUILD-INITIAL-PANEL                 08220000
082300                                                                  08230000
082400         WHEN DP020-NEXT-ACT-READ-MAP                             08240000
082500             MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-TOP-ITEM         08250000
082600             PERFORM 2000-PROCESS-PANEL                           08260000
082700                                                                  08270000
082800         WHEN DP020-NEXT-ACT-RETURN                               08280000
082900             MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-TOP-ITEM         08290000
083000             MOVE ZERO  TO ASC-ITEM-AT-TOP-OF-PANEL               08300000
083100             PERFORM 6000-REFRESH-PANEL-FROM-TEMP                 08310000
083200             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 08320000
083300                                                                  08330000
083400         WHEN OTHER                                               08340000
083500             SET DP013-LOGIC-ABEND TO TRUE                        08350000
083600             SET DP013-NO-ROLLBACK TO TRUE                        08360000
083700             MOVE '1000-CONTROL-PROCESSING' TO DP013-PARAGRAPH    08370000
083800             MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    08380000
083900                                   TO DP013-MESSAGE-TEXT(1)       08390000
084000             PERFORM DP013-0000-PROCESS-ABEND                     08400000
084100     END-EVALUATE.                                                08410000
084200                                                                  08420000
084300*----------------------------------------------------------------*08430000
084400* DETERMINE IF DATA WAS PASSED THROUGH INTER-APPL COMMAREA OR    *08440000
084500* IF THERE IS DATA TO BE USED IN THE NAV-KEY FIELD.              *08450000
084600*----------------------------------------------------------------*08460000
084700 1100-PROCESS-INTER-APPL-COMM.                                    08470000
084800     SET PS-COMMAREA-VALID         TO TRUE.                       08480000
084900     MOVE SPACE                    TO ASC-START-ITEM-REQUEST.     08490000
085000                                                                  08500000
085100     IF  DP020-INT-APPL-FORMAT-IND = PC-CRIT-SPEC-FORMAT          08510000
085200         MOVE SU008-SML-NBR           TO ASC-MASTER-SML           08520000
085300         MOVE ASC-MASTER-SML          TO ASC-SML-NBR              08530000
085400         MOVE SU008-OPER-UNT-ID       TO ASC-CURR-OPER-UNT-ID     08540000
085500     ELSE                                                         08550000
085520         SET ASC-USE-SELECTION-QUEUE TO TRUE                      08552007
085530         MOVE SU009-NUMBER-OF-SELECTED-ITEMS TO                   08553007
085540                                      ASC-NUMBER-OF-SELECTED-ITEMS08554007
085550         MOVE SU009-NUMBER-OF-TS-ITEMS TO ASC-NUMBER-OF-TS-ITEMS  08555007
085560         MOVE SU009-SEL-QUEUE-NAME     TO ASC-SEL-QUEUE-NAME-IN   08556007
085593         PERFORM 1120-PREPARE-LIST-ENTRY                          08559307
085700     END-IF.                                                      08570000
085800                                                                  08580000
085900*-----------------------------------------------------------------08590000
086000 1120-PREPARE-LIST-ENTRY.                                         08600000
086100                                                                  08610000
086200     MOVE SU010-MAX-ITEMS          TO ASC-SEL-SUB.                08620000
086300     MOVE ZERO                     TO ASC-SEL-ITEM.               08630000
086400     PERFORM 1130-GET-NEXT-RECORD.                                08640000
086500                                                                  08650000
086600*-----------------------------------------------------------------08660000
086700*    GET THE NEXT RECORD IF A LIST OF RECORDS ARE BEING PROCESSED*08670000
086800*-----------------------------------------------------------------08680000
086900 1130-GET-NEXT-RECORD.                                            08690000
087000                                                                  08700000
087100     ADD +1                       TO ASC-SEL-SUB.                 08710000
087200                                                                  08720000
087300     IF  ASC-SEL-SUB > SU010-MAX-ITEMS                            08730000
087400         ADD +1                   TO ASC-SEL-ITEM                 08740000
087500         MOVE +1                  TO ASC-SEL-SUB                  08750000
087600     END-IF.                                                      08760000
087700                                                                  08770000
087800     IF  ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                08780000
087900         PERFORM 9100-READ-SEL-QUEUE                              08790000
088000         IF  SU010-ITEM (ASC-SEL-SUB) > ZERO                      08800000
088010             MOVE SU010-SML (ASC-SEL-SUB)       TO ASC-MASTER-SML 08801008
088020                                                   ASC-SML-NBR    08802010
088100             MOVE SU010-LINE-NBR (ASC-SEL-SUB)  TO ASC-LINE-NBR   08810008
088200             MOVE SU010-LINE-STAT (ASC-SEL-SUB) TO ASC-LINE-STAT  08820008
088300             MOVE SU010-UNTS-MFSD (ASC-SEL-SUB) TO ASC-UNTS-MNFD  08830008
088400             MOVE SU010-TOT-CRTNS (ASC-SEL-SUB) TO ASC-TOT-CRTNS  08840008
088500             MOVE SU010-TRIP-ID   (ASC-SEL-SUB) TO ASC-TRIPID     08850008
088600             SET SU010-INQ (ASC-SEL-SUB) TO TRUE                  08860000
088700             PERFORM 9200-REWRITE-SEL-QUEUE                       08870000
088800         ELSE                                                     08880000
088900             SUBTRACT +1 FROM ASC-SEL-SUB                         08890000
089000             MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER             08900000
089100             SET DP020-MSG-INFORMATIONAL                          08910000
089200                 PS-LIST-END             TO TRUE                  08920000
089300         END-IF                                                   08930000
089400     ELSE                                                         08940000
089500         SUBTRACT +1 FROM ASC-SEL-ITEM                            08950000
089600         MOVE SU010-MAX-ITEMS     TO ASC-SEL-SUB                  08960000
089700         MOVE PC-TSYMSG-00070     TO DP020-MSG-NUMBER             08970000
089800         SET DP020-MSG-INFORMATIONAL                              08980000
089900             PS-LIST-END             TO TRUE                      08990000
090000     END-IF.                                                      09000000
090100                                                                  09010000
090200*-----------------------------------------------------------------09020000
090300*    GET THE PREVIOUS RECORD IF A LIST OF RECORDS ARE BEING      *09030000
090400*    PROCESSED.                                                  *09040000
090500*-----------------------------------------------------------------09050000
090600 1140-GET-PREV-RECORD.                                            09060000
090700                                                                  09070000
090800     SUBTRACT +1 FROM ASC-SEL-SUB.                                09080000
090900                                                                  09090000
091000     IF  ASC-SEL-SUB < +1                                         09100000
091100         SUBTRACT +1 FROM ASC-SEL-ITEM                            09110000
091200         MOVE SU010-MAX-ITEMS     TO ASC-SEL-SUB                  09120000
091300     END-IF.                                                      09130000
091400                                                                  09140000
091500     IF  ASC-SEL-ITEM > ZERO                                      09150000
091600         PERFORM 9100-READ-SEL-QUEUE                              09160000
091610         MOVE SU010-SML (ASC-SEL-SUB)       TO ASC-MASTER-SML     09161009
091620                                               ASC-SML-NBR        09162010
091700         MOVE SU010-LINE-NBR (ASC-SEL-SUB)  TO ASC-LINE-NBR       09170009
091800         MOVE SU010-LINE-STAT (ASC-SEL-SUB) TO ASC-LINE-STAT      09180009
091900         MOVE SU010-UNTS-MFSD (ASC-SEL-SUB) TO ASC-UNTS-MNFD      09190009
092000         MOVE SU010-TOT-CRTNS (ASC-SEL-SUB) TO ASC-TOT-CRTNS      09200009
092100         MOVE SU010-TRIP-ID   (ASC-SEL-SUB) TO ASC-TRIPID         09210009
092200         SET SU010-INQ (ASC-SEL-SUB) TO TRUE                      09220000
092300         PERFORM 9200-REWRITE-SEL-QUEUE                           09230000
092400     ELSE                                                         09240000
092500         MOVE +1                  TO ASC-SEL-ITEM                 09250000
092600                                     ASC-SEL-SUB                  09260000
092700         MOVE PC-TSYMSG-00069     TO DP020-MSG-NUMBER             09270000
092800         SET DP020-MSG-INFORMATIONAL                              09280000
092900             PS-LIST-END             TO TRUE                      09290000
093000     END-IF.                                                      09300000
093100                                                                  09310000
093200*----------------------------------------------------------------*09320000
093300* DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *09330000
093400* ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *09340000
093500* USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *09350000
093600* OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *09360000
093700* FUNCTION KEYS CAN GET THIS FAR.                                *09370000
093800*----------------------------------------------------------------*09380000
093900 2000-PROCESS-PANEL.                                              09390000
094000                                                                  09400000
094100     EVALUATE TRUE                                                09410000
094200         WHEN DP020-SRC-AID = DP016-CLEAR                         09420000
094300             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    09430000
094400             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   09440000
094500             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 09450000
094600                                                                  09460000
094700         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    09470000
094800             MOVE ZEROES TO ASC-UNTS-MNFD                         09480000
094900             PERFORM 2050-DELETE-LIST-QUEUE                       09490000
095000             PERFORM 4000-BUILD-INITIAL-PANEL                     09500000
095100                                                                  09510000
095200         WHEN DP020-FK-DESELECT(DP020-SRC-AID)                    09520000
095300             PERFORM 2140-DESELECT-ALL-ITEMS                      09530000
095400             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 09540000
095500                                                                  09550000
095600         WHEN DP020-FK-SELECT-ALL(DP020-SRC-AID)                  09560000
095700             PERFORM 2150-SELECT-ALL-ITEMS                        09570000
095800             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 09580000
095900                                                                  09590000
096000         WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             09600000
096100             IF  ASC-USE-SELECTION-QUEUE                          09610000
096200                 PERFORM 1130-GET-NEXT-RECORD                     09620000
096300                 IF PS-LIST-END                                   09630000
096400                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         09640000
096500                     SET PS-NO-LIST-END TO TRUE                   09650000
096600                 ELSE                                             09660000
096700                     PERFORM 2050-DELETE-LIST-QUEUE               09670000
096800                     PERFORM 3200-RESET-ATTRIBUTES                09680000
096900                     PERFORM 4000-BUILD-INITIAL-PANEL             09690000
097000                 END-IF                                           09700000
097100              ELSE                                                09710000
097200                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             09720000
097300*                --- BOTTOM OF LIST ---                           09730000
097400                 MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER         09740000
097500                 SET DP020-MSG-INFORMATIONAL TO TRUE              09750000
097600             END-IF                                               09760000
097700                                                                  09770000
097800         WHEN DP020-FK-PREV-SELECTION (DP020-SRC-AID)             09780000
097900             IF  ASC-USE-SELECTION-QUEUE                          09790000
098000                 PERFORM 1140-GET-PREV-RECORD                     09800000
098100                 IF PS-LIST-END                                   09810000
098200                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         09820000
098300                     SET PS-NO-LIST-END TO TRUE                   09830000
098400                 ELSE                                             09840000
098500                     PERFORM 2050-DELETE-LIST-QUEUE               09850000
098600                     PERFORM 3200-RESET-ATTRIBUTES                09860000
098700                     PERFORM 4000-BUILD-INITIAL-PANEL             09870000
098800                 END-IF                                           09880000
098900             ELSE                                                 09890000
099000                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             09900000
099100                 MOVE PC-TSYMSG-00069 TO DP020-MSG-NUMBER         09910000
099200                 SET DP020-MSG-INFORMATIONAL TO TRUE              09920000
099300             END-IF                                               09930000
099400                                                                  09940000
099500         WHEN OTHER                                               09950000
099600             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 09960000
099700             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   09970000
099800                                                                  09980000
099900             IF  PS-NO-ERROR                                      09990000
100000                 SET DP030-CONTINUE-GO TO TRUE                    10000000
100100                 PERFORM 2100-CHECK-FUNCTION-KEY                  10010000
100200             ELSE                                                 10020000
100300                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             10030000
100400                 SET DP030-OVERRIDE-GO TO TRUE                    10040000
100500             END-IF                                               10050000
100600     END-EVALUATE.                                                10060000
100700                                                                  10070000
100800*----------------------------------------------------------------*10080000
100900*  DELETE THE LIST ITEMS TEMP STORAGE QUEUE.                     *10090000
101000*----------------------------------------------------------------*10100000
101100 2050-DELETE-LIST-QUEUE.                                          10110000
101200                                                                  10120000
101300     EXEC CICS                                                    10130000
101400         DELETEQ TS                                               10140000
101500             QUEUE (ASC-LIST-QUEUE-NAME)                          10150000
101600             RESP  (PV-CICS-RESP)                                 10160000
101700     END-EXEC.                                                    10170000
101800                                                                  10180000
101900     IF (PV-CICS-RESP = DFHRESP(NORMAL)) OR                       10190000
102000        (PV-CICS-RESP = DFHRESP(QIDERR))                          10200000
102100         CONTINUE                                                 10210000
102200     ELSE                                                         10220000
102300         SET DP013-CICS-ABEND      TO TRUE                        10230000
102400         SET DP013-NO-ROLLBACK     TO TRUE                        10240000
102500                                                                  10250000
102600         MOVE '2050-DELETE-LIST-QUEUE' TO DP013-PARAGRAPH         10260000
102700         MOVE 'ERROR TRYING TO DELETE LIST TEMP STORAGE QUEUE'    10270000
102800                                   TO DP013-MESSAGE-TEXT (1)      10280000
102900         PERFORM DP013-0000-PROCESS-ABEND                         10290000
103000     END-IF.                                                      10300000
103100                                                                  10310000
103200     MOVE +0                       TO ASC-HIGHEST-BLOCK-WRITTEN.  10320000
103300                                                                  10330000
103400*----------------------------------------------------------------*10340000
103500* ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED FIRST.*10350000
103600* NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED FROM THE  *10360000
103700* CICS ARCHITECTURE API.                                         *10370000
103800*----------------------------------------------------------------*10380000
103900 2100-CHECK-FUNCTION-KEY.                                         10390000
104000                                                                  10400000
104100     EVALUATE TRUE                                                10410000
104200                                                                  10420017
104300* F22 - CARTON DETAIL LIST                                        10430000
104310* F14 - SML FLOW - LOCAL-FUNC-04                                  10431013
104400         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              10440000
104410         WHEN DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)              10441013
104500             IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              10450000
104600                 SET ASC-USE-SELECTION-QUEUE TO TRUE              10460000
104700                 INITIALIZE SU009-INTER-APPL-COMMAREA             10470000
104800                 MOVE ASC-NUMBER-OF-SELECTED-ITEMS                10480000
104900                                TO SU009-NUMBER-OF-SELECTED-ITEMS 10490000
105000                 MOVE ASC-NUMBER-OF-TS-ITEMS                      10500000
105100                                      TO SU009-NUMBER-OF-TS-ITEMS 10510000
105200                 MOVE ASC-SEL-QUEUE-NAME-OUT                      10520000
105300                                      TO SU009-SEL-QUEUE-NAME     10530000
105400                 MOVE ASC-OPER-UNT-ID      TO SU009-OPER-UNT-ID   10540000
105500                 PERFORM 5000-PREPARE-SEL-QUEUE                   10550000
105600             ELSE                                                 10560000
105700                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             10570000
105800                 SET DP030-OVERRIDE-GO TO TRUE                    10580000
105900                 MOVE PC-TSYMSG-00057 TO DP020-MSG-NUMBER         10590000
106000                 SET DP020-MSG-WARNING TO TRUE                    10600000
106100             END-IF                                               10610000
106200                                                                  10620017
106300* F23 - PRINT CARTON MANIFEST                                     10630000
106400         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              10640000
106500             IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              10650000
106600                 MOVE ASC-NUMBER-OF-SELECTED-ITEMS                10660000
106700                                TO SU033-NBR-OF-SELECTED-ITEMS    10670000
106800                 PERFORM 4600-PROCESS-REPORT-PRINT                10680000
106900                         VARYING PV-ITEM FROM 1 BY 1              10690000
107000                         UNTIL PV-ITEM > ASC-HIGHEST-BLOCK-WRITTEN10700000
107100                            OR PS-SOFT-ABORT-ERROR                10710000
107200                                                                  10720000
107300                 IF  PS-NO-SOFT-ABORT-ERROR                       10730000
107400                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         10740000
107500                     SET DP030-OVERRIDE-GO TO TRUE                10750000
107600                     MOVE PC-TSYMSG-00098  TO DP020-MSG-NUMBER    10760000
107700                     SET DP020-MSG-WARNING TO TRUE                10770000
107800                 END-IF                                           10780000
107900                                                                  10790000
108000             ELSE                                                 10800000
108100                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             10810000
108200                 SET DP030-OVERRIDE-GO TO TRUE                    10820000
108300                 MOVE PC-TSYMSG-00057  TO DP020-MSG-NUMBER        10830000
108400                 SET DP020-MSG-WARNING TO TRUE                    10840000
108500             END-IF                                               10850000
108600* F24 - CARTON PACKED DETAIL                                      10860000
108700         WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)              10870000
108800             IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              10880000
108900                 SET ASC-USE-SELECTION-QUEUE TO TRUE              10890000
109000                 INITIALIZE SU009-INTER-APPL-COMMAREA             10900000
109100                 MOVE ASC-NUMBER-OF-SELECTED-ITEMS                10910000
109200                                TO SU009-NUMBER-OF-SELECTED-ITEMS 10920000
109300                 MOVE ASC-NUMBER-OF-TS-ITEMS                      10930000
109400                                      TO SU009-NUMBER-OF-TS-ITEMS 10940000
109500                 MOVE ASC-SEL-QUEUE-NAME-OUT                      10950000
109600                                      TO SU009-SEL-QUEUE-NAME     10960000
109700                 MOVE ASC-OPER-UNT-ID      TO SU009-OPER-UNT-ID   10970000
109800                 MOVE ASC-STR-NBR          TO SU009-DEST-STR-NBR  10980000
109900                 MOVE ASC-OUTBOUND-TRIP-ID TO SU009-TRIP-ID       10990000
110000                 PERFORM 5000-PREPARE-SEL-QUEUE                   11000000
110100             ELSE                                                 11010000
110200                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             11020000
110300                 SET DP030-OVERRIDE-GO TO TRUE                    11030000
110400                 MOVE PC-TSYMSG-00057 TO DP020-MSG-NUMBER         11040000
110500                 SET DP020-MSG-WARNING TO TRUE                    11050000
110600             END-IF                                               11060000
110700                                                                  11070000
110800* F6 - FIRST PAGE                                                 11080000
110900         WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                  11090000
111000             MOVE +1               TO PV-TOP-ITEM                 11100000
111100             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 11110000
111200                                                                  11120017
111300* F7 - PREVIOUS PAGE                                              11130000
111400         WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                   11140000
111500             PERFORM 2110-BROWSE-BACKWARD                         11150000
111600             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 11160000
111700                                                                  11170017
111800* F8 - NEXT PAGE                                                  11180000
111900         WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                   11190000
112000             PERFORM 2120-BROWSE-FORWARD                          11200000
112100             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 11210000
112200                                                                  11220017
112300* ENTER KEY                                                       11230000
112400         WHEN DP020-SRC-AID = DP016-ENTER                         11240000
112500             PERFORM 2130-CHECK-FOR-JUMP-BROWSE                   11250000
112600             IF  PS-ERROR                                         11260000
112700                 CONTINUE                                         11270000
112800             ELSE                                                 11280000
112900                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             11290000
113000             END-IF                                               11300000
113100                                                                  11310000
113200         WHEN OTHER                                               11320000
113300             SET DP013-NO-ROLLBACK                                11330000
113400                 DP013-XCTL-DISPLAY-RESTART                       11340000
113500                 DP013-CICS-ABEND  TO TRUE                        11350000
113600             MOVE '2100-CHECK-FUNCTION-KEY' TO DP013-PARAGRAPH    11360000
113700             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      11370000
113800                                   TO DP013-MESSAGE-TEXT (1)      11380000
113900             PERFORM DP013-0000-PROCESS-ABEND                     11390000
114000     END-EVALUATE.                                                11400000
114100                                                                  11410017
114200*----------------------------------------------------------------*11420000
114300*    IF THE USER HITS THE PAGE BACKWARD KEY, COMPUTE THE TOP     *11430000
114400*    ITEM NUMBER FOR THE NEW PAGE.  IF IT IS ABOVE THE TOP,      *11440000
114500*    SET THE TOP ITEM NUMBER TO +1 AND DISPLAY THE TOP OF LIST   *11450000
114600*    MESSAGE.                                                    *11460000
114700*----------------------------------------------------------------*11470000
114800 2110-BROWSE-BACKWARD.                                            11480000
114900                                                                  11490000
115000     SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    11500000
115100         GIVING PV-TOP-ITEM.                                      11510000
115200                                                                  11520017
115300     IF  ((PV-TOP-ITEM < +1)                                      11530000
115400       OR (PV-TOP-ITEM = +1))                                     11540000
115500         MOVE +1                   TO PV-TOP-ITEM                 11550000
115600*        -- TOP OF LIST --                                        11560000
115700         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            11570000
115800         SET DP020-MSG-INFORMATIONAL TO TRUE                      11580000
115900     END-IF.                                                      11590000
116000                                                                  11600000
116100*----------------------------------------------------------------*11610000
116200*    IF THE USER HITS THE PAGE FORWARD KEY, COMPUTE THE TOP      *11620000
116300*    ITEM NUMBER FOR THE NEW PAGE.  IF THE USER ATTEMPTS TO GO   *11630000
116400*    PAST THE END, ISSUE THE BOTTOM OF LIST MESSAGE.             *11640000
116500*----------------------------------------------------------------*11650000
116600 2120-BROWSE-FORWARD.                                             11660000
116700                                                                  11670000
116800     ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              11680000
116900         GIVING PV-TOP-ITEM.                                      11690000
117000     IF  PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                   11700000
117100         MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-TOP-ITEM             11710000
117200*        -- BOTTOM OF LIST --                                     11720000
117300         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            11730000
117400         SET DP020-MSG-INFORMATIONAL  TO TRUE                     11740000
117500     ELSE                                                         11750000
117600         COMPUTE PV-BOTTOM-ITEM =                                 11760000
117700             PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 11770000
117800         IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ            11780000
117900*            -- BOTTOM OF LIST --                                 11790000
118000             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            11800000
118100             SET DP020-MSG-INFORMATIONAL TO TRUE                  11810000
118200         END-IF                                                   11820000
118300     END-IF.                                                      11830000
118400                                                                  11840000
118500*----------------------------------------------------------------*11850000
118600*    THE USER CAN CHANGE THE CURRENT BEGINNING LIST NUMBER SO    *11860000
118700*    THAT THE TRANSACTION WILL JUMP TO THAT POINT IN THE LIST.   *11870000
118800*    THIS IS A FASTER WAY TO GET TO A CERTAIN POINT IN THE LIST  *11880000
118900*    RATHER THAN HITTING NEXT-PAGE TO GET TO THAT POINT.         *11890000
119000*    THE NEW LIST NUMBER ENTERED IS EDITED TO MAKE SURE THAT     *11900000
119100*    IT IS NUMERIC AND FALLS BETWEEN A SPECIFIED RANGE.          *11910000
119200*----------------------------------------------------------------*11920000
119300 2130-CHECK-FOR-JUMP-BROWSE.                                      11930000
119400     SET PS-NO-ERROR               TO TRUE.                       11940000
119500     IF (ASC-START-ITEM-REQUEST = SPACE)                          11950000
119600         MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-TOP-ITEM             11960000
119700     ELSE                                                         11970000
119800         MOVE ASC-START-ITEM-REQUEST TO DP010I-UNEDITED-FIELD     11980000
119900         MOVE PC-MSG-NUMBER-LENGTH TO DP010I-MAXIMUM-DIGITS       11990000
120000         MOVE +0                   TO DP010I-MAXIMUM-DECIMALS     12000000
120100         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  12010000
120200         CALL DP010I-NUMERIC-EDIT-ROUTINE                         12020017
120210              USING DP010I-NUMERIC-EDIT-AREA                      12021017
120300                                                                  12030000
120400         IF  NOT DP010I-ERROR-DETECTED                            12040000
120500             MOVE DP010I-NUMERIC-FIELD TO ASC-START-ITEM-REQUEST-N12050000
120600             IF  ASC-START-ITEM-REQUEST-N > ZERO                  12060000
120700                 IF  ASC-START-ITEM-REQUEST-N >                   12070000
120800                                          ASC-NUMBER-OF-ITEMS-READ12080000
120900                     MOVE SPACE TO ASC-START-ITEM-REQUEST         12090000
121000                     COMPUTE PV-TOP-ITEM =                        12100000
121100                             ASC-NUMBER-OF-ITEMS-READ             12110000
121200                             - PC-ITEMS-PER-PANEL + 1             12120000
121300                     IF  PV-TOP-ITEM < +1                         12130000
121400                         MOVE +1   TO PV-TOP-ITEM                 12140000
121500                         MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER 12150000
121600                         SET DP020-MSG-INFORMATIONAL TO TRUE      12160000
121700                     ELSE                                         12170000
121800                         MOVE  PV-TOP-ITEM                        12180000
121900                           TO  ASC-START-ITEM-REQUEST-N           12190000
122000                     END-IF                                       12200000
122100                 ELSE                                             12210000
122200                     MOVE ASC-START-ITEM-REQUEST-N TO PV-TOP-ITEM 12220000
122300                     MOVE SPACE    TO ASC-START-ITEM-REQUEST      12230000
122400                     COMPUTE PV-BOTTOM-ITEM =                     12240000
122500                         PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1     12250000
122600                     IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ12260000
122700                         SUBTRACT  PV-TOP-ITEM                    12270000
122800                             FROM  ASC-NUMBER-OF-ITEMS-READ       12280000
122900                           GIVING  ASC-ITEMS-DISPLAYED            12290000
123000                         MOVE  ASC-NUMBER-OF-ITEMS-READ           12300000
123100                           TO  PV-BOTTOM-ITEM                     12310000
123200*                        -- BOTTOM OF LIST --                     12320000
123300                         MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER 12330000
123400                         SET DP020-MSG-INFORMATIONAL TO TRUE      12340000
123500                     END-IF                                       12350000
123600                 END-IF                                           12360000
123700             ELSE                                                 12370000
123800*                --- VALUE OUT OF RANGE ----                      12380000
123900                 MOVE PC-TSYMSG-00101  TO DP020-MSG-NUMBER        12390000
124000                 MOVE -1           TO ASTRTITL                    12400000
124100                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              12410000
124200                 MOVE DP015-REVERSE TO ASTRTITH                   12420000
124300                 MOVE DP015-RED    TO ASTRTITC                    12430000
124400                 MOVE DP015-UNP-NUM-BRT-MDT TO ASTRTITA           12440000
124500                 SET DP020-MSG-FATAL                              12450000
124600                     PS-ERROR        TO TRUE                      12460000
124700             END-IF                                               12470000
124800         ELSE                                                     12480000
124900             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            12490000
125000             MOVE -1               TO ASTRTITL                    12500000
125100             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  12510000
125200             MOVE DP015-REVERSE    TO ASTRTITH                    12520000
125300             MOVE DP015-RED        TO ASTRTITC                    12530000
125400             MOVE DP015-UNP-NUM-BRT-MDT TO ASTRTITA               12540000
125500             SET DP020-MSG-FATAL   TO TRUE                        12550000
125600             SET PS-ERROR          TO TRUE                        12560000
125700         END-IF                                                   12570000
125800     END-IF.                                                      12580000
125900                                                                  12590000
126000*----------------------------------------------------------------*12600000
126100*    IF THE USER HITS THE DESELECT KEY, CLEAR THE SELECTION      *12610000
126200*    SWITCH FOR ALL ITEMS THAT WERE PREVIOUSLY SELECTED.         *12620000
126300*----------------------------------------------------------------*12630000
126400 2140-DESELECT-ALL-ITEMS.                                         12640000
126500                                                                  12650000
126600     MOVE +1                       TO ASC-BLK-SUB.                12660000
126700                                                                  12670000
126800     PERFORM 2141-CLEAR-SELECTED-INDS                             12680000
126900         VARYING ASC-ITEM-SUB                                     12690000
127000         FROM 1 BY 1                                              12700000
127100         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 12710000
127200                                                                  12720000
127300     ADD +1                        TO ASC-BLK-SUB.                12730000
127400                                                                  12740000
127500     PERFORM 2141-CLEAR-SELECTED-INDS                             12750000
127600         VARYING ASC-ITEM-SUB                                     12760000
127700         FROM 1 BY 1                                              12770000
127800         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 12780000
127900                                                                  12790000
128000     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               12800000
128100                                   TO PV-LIST-ITEM-NUMBER.        12810000
128200                                                                  12820000
128300     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            12830000
128400         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    12840000
128500                                                                  12850000
128600     IF  PV-FIRST-BLOCK-IN-ARRAY  = +1                            12860000
128700         MOVE +1                   TO ASC-BLK-SUB                 12870000
128800                                                                  12880000
128900         PERFORM 5100-WRITE-TEMP-STORAGE                          12890000
129000         MOVE +2                   TO ASC-BLK-SUB                 12900000
129100         PERFORM 5100-WRITE-TEMP-STORAGE                          12910000
129200         MOVE +1                   TO ASC-BLK-SUB                 12920000
129300         MOVE +1                   TO PV-BLOCK-NUMBER             12930000
129400     END-IF.                                                      12940000
129500                                                                  12950000
129600     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     12960000
129700        (ASC-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)      12970000
129800         MOVE +1                   TO ASC-BLK-SUB                 12980000
129900                                                                  12990000
130000         PERFORM 5100-WRITE-TEMP-STORAGE                          13000000
130100         MOVE +2                   TO ASC-BLK-SUB                 13010000
130200         PERFORM 5100-WRITE-TEMP-STORAGE                          13020000
130300         MOVE +1                   TO ASC-BLK-SUB                 13030000
130400                                                                  13040000
130500         MOVE +1                   TO PV-BLOCK-NUMBER             13050000
130600                                                                  13060000
130700         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         13070000
130800             PV-FIRST-BLOCK-IN-ARRAY - 1                          13080000
130900                                                                  13090000
131000         PERFORM                                                  13100000
131100             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       13110000
131200                                                                  13120000
131300             PERFORM 4410-READ-TEMP-STORAGE                       13130000
131400                                                                  13140000
131500             PERFORM 2141-CLEAR-SELECTED-INDS                     13150000
131600                 VARYING ASC-ITEM-SUB FROM 1 BY 1                 13160000
131700                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          13170000
131800                                                                  13180000
131900             PERFORM 5100-WRITE-TEMP-STORAGE                      13190000
132000                                                                  13200000
132100             ADD +1                TO PV-BLOCK-NUMBER             13210000
132200                                                                  13220000
132300         END-PERFORM                                              13230000
132400                                                                  13240000
132500         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         13250000
132600             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     13260000
132700                                                                  13270000
132800         PERFORM                                                  13280000
132900             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       13290000
133000                   ASC-HIGHEST-BLOCK-WRITTEN                      13300000
133100                                                                  13310000
133200             MOVE PV-NEXT-BLOCK-IN-ARRAY                          13320000
133300                                   TO PV-BLOCK-NUMBER             13330000
133400                                                                  13340000
133500             PERFORM 4410-READ-TEMP-STORAGE                       13350000
133600                                                                  13360000
133700             PERFORM 2141-CLEAR-SELECTED-INDS                     13370000
133800                 VARYING ASC-ITEM-SUB                             13380000
133900                 FROM 1 BY 1                                      13390000
134000                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          13400000
134100                                                                  13410000
134200             PERFORM 5100-WRITE-TEMP-STORAGE                      13420000
134300                                                                  13430000
134400             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      13440000
134500         END-PERFORM                                              13450000
134600                                                                  13460000
134700         MOVE PV-FIRST-BLOCK-IN-ARRAY TO PV-BLOCK-NUMBER          13470000
134800         PERFORM 4410-READ-TEMP-STORAGE                           13480000
134900     END-IF.                                                      13490000
135000                                                                  13500000
135100                                                                  13510000
135200     MOVE +0                     TO ASC-NUMBER-OF-SELECTED-ITEMS. 13520000
135300     MOVE +0                     TO ASC-START-OF-SELECTED-RANGE.  13530000
135400     MOVE +0                     TO ASC-END-OF-SELECTED-RANGE.    13540000
135500                                                                  13550000
135600     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        13560000
135700                                                                  13570000
135800*----------------------------------------------------------------*13580000
135900*    MARK EACH ITEM AS BEING NOT SELECTED.                       *13590000
136000*----------------------------------------------------------------*13600000
136100 2141-CLEAR-SELECTED-INDS.                                        13610000
136200                                                                  13620000
136300     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           13630000
136400             NOT EQUAL ZERO                                       13640000
136500         IF  NOT ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          13650000
136600             SET ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          13660000
136700                 ASC-TEMP-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)    13670000
136800                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  13680000
136900                                   TO TRUE                        13690000
137000         END-IF                                                   13700000
137100     END-IF.                                                      13710000
137200                                                                  13720000
137300*----------------------------------------------------------------*13730000
137400*  IF THE USER HITS THE SELECT-ALL KEY, SET THE SELECTIO SWITCH  *13740000
137500*  FOR ALL ITEMS.                                                *13750000
137600*----------------------------------------------------------------*13760000
137700 2150-SELECT-ALL-ITEMS.                                           13770000
137800                                                                  13780000
137900     MOVE +1                       TO ASC-BLK-SUB.                13790000
138000                                                                  13800000
138100     PERFORM 2151-SET-SELECTED-INDS                               13810000
138200         VARYING ASC-ITEM-SUB                                     13820000
138300         FROM 1 BY 1                                              13830000
138400         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 13840000
138500                                                                  13850000
138600     ADD +1                        TO ASC-BLK-SUB.                13860000
138700                                                                  13870000
138800     PERFORM 2151-SET-SELECTED-INDS                               13880000
138900         VARYING ASC-ITEM-SUB                                     13890000
139000         FROM 1 BY 1                                              13900000
139100         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 13910000
139200                                                                  13920000
139300     MOVE ASC-LIST-ITEM-NUMBER(1 1) TO PV-LIST-ITEM-NUMBER.       13930000
139400                                                                  13940000
139500     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            13950000
139600         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    13960000
139700                                                                  13970000
139800     IF  PV-FIRST-BLOCK-IN-ARRAY  = +1                            13980000
139900         MOVE +1                   TO ASC-BLK-SUB                 13990000
140000                                                                  14000000
140100         PERFORM 5100-WRITE-TEMP-STORAGE                          14010000
140200         MOVE +2                   TO ASC-BLK-SUB                 14020000
140300         PERFORM 5100-WRITE-TEMP-STORAGE                          14030000
140400         MOVE +1                   TO ASC-BLK-SUB                 14040000
140500         MOVE +1                   TO PV-BLOCK-NUMBER             14050000
140600     END-IF.                                                      14060000
140700                                                                  14070000
140800     IF  PV-FIRST-BLOCK-IN-ARRAY  = +1                            14080000
140900         MOVE +1                   TO ASC-BLK-SUB                 14090000
141000                                                                  14100000
141100         PERFORM 5100-WRITE-TEMP-STORAGE                          14110000
141200         MOVE +2                   TO ASC-BLK-SUB                 14120000
141300         PERFORM 5100-WRITE-TEMP-STORAGE                          14130000
141400         MOVE +1                   TO ASC-BLK-SUB                 14140000
141500         MOVE +1                   TO PV-BLOCK-NUMBER             14150000
141600     END-IF.                                                      14160000
141700     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     14170000
141800        (ASC-HIGHEST-BLOCK-WRITTEN >   PC-MAX-BLOCKS-IN-ARRAY)    14180000
141900         MOVE +1                   TO ASC-BLK-SUB                 14190000
142000                                                                  14200000
142100         PERFORM 5100-WRITE-TEMP-STORAGE                          14210000
142200         MOVE +2                   TO ASC-BLK-SUB                 14220000
142300         PERFORM 5100-WRITE-TEMP-STORAGE                          14230000
142400         MOVE +1                   TO ASC-BLK-SUB                 14240000
142500         MOVE +1                   TO PV-BLOCK-NUMBER             14250000
142600                                                                  14260000
142700         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         14270000
142800             PV-FIRST-BLOCK-IN-ARRAY - 1                          14280000
142900                                                                  14290000
143000         PERFORM                                                  14300000
143100             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       14310000
143200                                                                  14320000
143300             PERFORM 4410-READ-TEMP-STORAGE                       14330000
143400                                                                  14340000
143500             PERFORM 2151-SET-SELECTED-INDS                       14350000
143600                 VARYING ASC-ITEM-SUB                             14360000
143700                 FROM 1 BY 1                                      14370000
143800                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          14380000
143900                                                                  14390000
144000             PERFORM 5100-WRITE-TEMP-STORAGE                      14400000
144100                                                                  14410000
144200             ADD +1                TO PV-BLOCK-NUMBER             14420000
144300                                                                  14430000
144400         END-PERFORM                                              14440000
144500                                                                  14450000
144600         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         14460000
144700             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     14470000
144800                                                                  14480000
144900         PERFORM                                                  14490000
145000             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       14500000
145100                   ASC-HIGHEST-BLOCK-WRITTEN                      14510000
145200                                                                  14520000
145300             MOVE PV-NEXT-BLOCK-IN-ARRAY                          14530000
145400                                   TO PV-BLOCK-NUMBER             14540000
145500                                                                  14550000
145600             PERFORM 4410-READ-TEMP-STORAGE                       14560000
145700                                                                  14570000
145800             PERFORM 2151-SET-SELECTED-INDS                       14580000
145900                 VARYING ASC-ITEM-SUB                             14590000
146000                 FROM 1 BY 1                                      14600000
146100                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          14610000
146200                                                                  14620000
146300             PERFORM 5100-WRITE-TEMP-STORAGE                      14630000
146400                                                                  14640000
146500             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      14650000
146600                                                                  14660000
146700         END-PERFORM                                              14670000
146800                                                                  14680000
146900         MOVE PV-FIRST-BLOCK-IN-ARRAY                             14690000
147000                                   TO PV-BLOCK-NUMBER             14700000
147100                                                                  14710000
147200         PERFORM 4410-READ-TEMP-STORAGE                           14720000
147300     END-IF.                                                      14730000
147400                                                                  14740000
147500                                                                  14750000
147600     MOVE ASC-NUMBER-OF-ITEMS-READ TO                             14760000
147700                       ASC-NUMBER-OF-SELECTED-ITEMS.              14770000
147800                                                                  14780000
147900     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        14790000
148000                                                                  14800000
148100*----------------------------------------------------------------*14810000
148200*    MARK EACH ITEM AS BEING SELECTED.                           *14820000
148300*----------------------------------------------------------------*14830000
148400 2151-SET-SELECTED-INDS.                                          14840000
148500                                                                  14850000
148600     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           14860000
148700             NOT EQUAL ZERO                                       14870000
148800         IF  NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             14880000
148900             SET ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             14890000
149000                 ASC-TEMP-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)        14900000
149100                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  14910000
149200                               TO  TRUE                           14920000
149300         END-IF                                                   14930000
149400     END-IF.                                                      14940000
149500                                                                  14950000
149600******************************************************************14960000
149700** MOVE ALL OF THE FIELDS THAT WERE ENTERED / CHANGED ON THE    **14970000
149800** SCREEN INTO THE COMMAREA.  ALL EDITTING IS DONE IN THE COMM. **14980000
149900******************************************************************14990000
150000 2200-MOVE-SCREEN-TO-COMMAREA.                                    15000000
150100                                                                  15010000
150200     MOVE PV-TOP-ITEM              TO PV-ITEM-IN-USE.             15020000
150300     MOVE +1                       TO PV-SUB.                     15030000
150400     IF  APRINTL  > ZERO                                          15040000
150500         MOVE APRINTI TO ASC-PRTR                                 15050000
150600     END-IF                                                       15060000
150700                                                                  15070017
150800     PERFORM 3100-SET-SUBSCRIPTS.                                 15080000
150900     IF  ASTRTITL > ZERO                                          15090000
151000         MOVE ASTRTITI         TO ASC-START-ITEM-REQUEST          15100000
151100     ELSE                                                         15110000
151200         IF  ASTRTITF = DP015-ERASE-EOF                           15120000
151300             INITIALIZE ASC-START-ITEM-REQUEST                    15130000
151400         END-IF                                                   15140000
151500     END-IF.                                                      15150000
151600                                                                  15160000
151700     PERFORM 2210-MOVE-LINES-TO-COMMAREA                          15170000
151800         VARYING PV-SUB                                           15180000
151900         FROM 1 BY 1                                              15190000
152000         UNTIL PV-SUB > ASC-ITEMS-DISPLAYED.                      15200000
152100******************************************************************15210000
152200** MOVE THE ENTERABLE FIELDS ON EACH LIST LINE INTO THE COMMAREA**15220000
152300******************************************************************15230000
152400 2210-MOVE-LINES-TO-COMMAREA.                                     15240000
152500     IF MR-SELECTL (PV-SUB) > ZERO                                15250000
152600         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE             15260000
152700         MOVE MR-SELECTI (PV-SUB)   TO ASC-TEMP-SELECTED-SW       15270000
152800                                      (ASC-BLK-SUB, ASC-ITEM-SUB) 15280000
152900     ELSE                                                         15290000
153000         IF  MR-SELECTA (PV-SUB) = DP015-ERASE-EOF                15300000
153100                 SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE     15310000
153200                 MOVE SPACE        TO ASC-TEMP-SELECTED-SW        15320000
153300                                      (ASC-BLK-SUB, ASC-ITEM-SUB) 15330000
153400         END-IF                                                   15340000
153500     END-IF.                                                      15350000
153600                                                                  15360000
153700     ADD +1                        TO ASC-ITEM-SUB.               15370000
153800     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        15380000
153900         IF  ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                     15390000
154000             COMPUTE PV-BLOCK-NUMBER  =                           15400000
154100                1 + ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) /         15410000
154200                    PC-ITEMS-PER-PANEL                            15420000
154300             PERFORM 5105-REWRITE-ASC-LISTQ                       15430000
154400         END-IF                                                   15440000
154500         ADD +1                    TO ASC-BLK-SUB                 15450000
154600         MOVE +1                   TO ASC-ITEM-SUB                15460000
154700     ELSE                                                         15470000
154800     IF  PV-SUB = ASC-ITEMS-DISPLAYED                             15480000
154900         IF  ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                     15490000
155000             COMPUTE PV-BLOCK-NUMBER  =                           15500000
155100                1 + ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) /         15510000
155200                    PC-ITEMS-PER-PANEL                            15520000
155300             PERFORM 5105-REWRITE-ASC-LISTQ                       15530000
155400         END-IF                                                   15540000
155500     END-IF.                                                      15550000
155600                                                                  15560000
155700                                                                  15570000
156200******************************************************************15620000
156300** EDIT ALL OF THE DATA ON THE SCREEN AS IT RESIDES IN THE      **15630000
156400** COMMAREA (EDITTING IS NOT DONE AGAINST THE SCREEN DIRECTLY). **15640000
156500******************************************************************15650000
156600 3000-EDIT-DATA-IN-COMMAREA.                                      15660000
156700                                                                  15670000
156800     SET PS-NO-ERROR               TO TRUE.                       15680000
156900     PERFORM 3200-RESET-ATTRIBUTES.                               15690000
157000     MOVE ASC-ITEMS-DISPLAYED      TO PV-SUB.                     15700000
157100                                                                  15710000
157200     EVALUATE TRUE                                                15720000
157300         WHEN DP020-FK-LOCAL-FUNC-02(DP020-SRC-AID)               15730000
157400              PERFORM 3600-VERIFY-PRINTER-ID                      15740000
157500     END-EVALUATE                                                 15750000
157600                                                                  15760000
157700**                                                                15770000
157800* CALCULATE THE POSITION OF THE LAST ITEM DISPLAYED.              15780000
157900* EDITTING IS DONE FROM THE BOTTOM UP.                            15790000
158000**                                                                15800000
158100     COMPUTE PV-ITEM-IN-USE = PV-TOP-ITEM +                       15810000
158200         ASC-ITEMS-DISPLAYED - 1.                                 15820000
158300     PERFORM 3100-SET-SUBSCRIPTS.                                 15830000
158400                                                                  15840017
158500     IF  PS-NO-ERROR                                              15850000
158600         PERFORM 3005-EDIT-COMMAREA-BLOCKS                        15860000
158700     END-IF.                                                      15870000
158800                                                                  15880000
158900     IF  PS-NO-ERROR                                              15890000
159000         PERFORM 3400-CHECK-RANGE-SEQUENCE                        15900000
159100     END-IF.                                                      15910000
159200                                                                  15920017
159300     IF  ((PS-NO-ERROR)                                           15930000
159400       AND (ASC-START-OF-SELECTED-RANGE > ZERO)                   15940000
159500       AND (ASC-END-OF-SELECTED-RANGE > ZERO))                    15950000
159600             PERFORM 3500-MARK-RANGE-AS-SELECTED                  15960000
159700     END-IF.                                                      15970000
159800                                                                  15980000
159900*----------------------------------------------------------------*15990000
160000*   3005-EDIT-COMMAREA-BLOCKS                                    *16000000
160100*----------------------------------------------------------------*16010000
160200 3005-EDIT-COMMAREA-BLOCKS.                                       16020000
160300                                                                  16030000
160400     MOVE +1                       TO PV-BLOCK-NUMBER.            16040000
160500     MOVE +1                       TO ASC-BLK-SUB.                16050000
160600     MOVE PC-ITEMS-PER-PANEL       TO ASC-ITEM-SUB.               16060000
160700                                                                  16070000
160800     COMPUTE PV-BLOCK-NUMBER  =                                   16080000
160900        1 + ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) /                 16090000
161000            PC-ITEMS-PER-PANEL.                                   16100000
161100                                                                  16110000
161200     MOVE  PV-BLOCK-NUMBER         TO PV-ORIGINAL-BLOCK.          16120000
161300                                                                  16130000
161400     PERFORM                                                      16140000
161500       UNTIL PV-BLOCK-NUMBER > ASC-HIGHEST-BLOCK-WRITTEN          16150000
161600          OR PS-ERROR                                             16160000
161700          OR PS-BLOCK-ERROR                                       16170000
161800                                                                  16180000
161900             COMPUTE PV-ITEMS-HOLD  =                             16190000
162000                     ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) +        16200000
162100                     PC-ITEMS-PER-PANEL - 1                       16210000
162200                                                                  16220000
162300             IF  PV-ITEMS-HOLD  >  ASC-NUMBER-OF-ITEMS-READ       16230000
162400                 SUBTRACT  ASC-NUMBER-OF-ITEMS-READ               16240000
162500                     FROM  PV-ITEMS-HOLD                          16250000
162600                   GIVING  PV-ITEMS-DIFF                          16260000
162700                 SUBTRACT  PV-ITEMS-DIFF                          16270000
162800                     FROM  PC-ITEMS-PER-PANEL                     16280000
162900                   GIVING  PV-ITEMS-HOLD                          16290000
163000                     MOVE  PV-ITEMS-HOLD  TO  PV-SUB              16300000
163100                                              ASC-ITEM-SUB        16310000
163200                                              ASC-ITEMS-DISPLAYED 16320000
163300             ELSE                                                 16330000
163400                 MOVE ASC-ITEMS-DISPLAYED  TO PV-SUB              16340000
163500                 MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB        16350000
163600             END-IF                                               16360000
163700                                                                  16370000
163800             PERFORM 3300-EDIT-SELECTIONS                         16380000
163900                     VARYING PV-SUB                               16390000
164000                        FROM PV-SUB BY -1                         16400000
164100                       UNTIL PV-SUB < +1                          16410000
164200                                                                  16420000
164300             MOVE +1               TO ASC-BLK-SUB                 16430000
164400                                                                  16440000
164500             PERFORM 5105-REWRITE-ASC-LISTQ                       16450000
164600                                                                  16460000
164700             MOVE +1                TO ASC-BLK-SUB                16470000
164800                                                                  16480000
164900             IF  PS-BLOCK-ERROR                                   16490000
165000                 SET  PS-ERROR     TO TRUE                        16500000
165100                 MOVE ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB 1)        16510000
165200                                   TO PV-TOP-ITEM                 16520000
165300             ELSE                                                 16530000
165400                 ADD  +1           TO PV-BLOCK-NUMBER             16540000
165500                 IF  PV-BLOCK-NUMBER >                            16550000
165600                     ASC-HIGHEST-BLOCK-WRITTEN                    16560000
165700                     MOVE +2       TO ASC-BLK-SUB                 16570000
165800                     PERFORM 4410-READ-TEMP-STORAGE               16580000
165900                     MOVE +1       TO ASC-BLK-SUB                 16590000
166000                 ELSE                                             16600000
166100                     PERFORM 4410-READ-TEMP-STORAGE               16610000
166200                     ADD  +1        TO PV-BLOCK-NUMBER            16620000
166300                     MOVE +2        TO ASC-BLK-SUB                16630000
166400                     PERFORM 4410-READ-TEMP-STORAGE               16640000
166500                     SUBTRACT +1  FROM PV-BLOCK-NUMBER            16650000
166600                     MOVE +1        TO ASC-BLK-SUB                16660000
166700                 END-IF                                           16670000
166800             END-IF                                               16680000
166900     END-PERFORM.                                                 16690000
167000                                                                  16700000
167100     IF  PV-ORIGINAL-BLOCK  = +1    OR                            16710000
167200         PS-ERROR                   OR                            16720000
167300         PS-BLOCK-ERROR                                           16730000
167400         CONTINUE                                                 16740000
167500     ELSE                                                         16750000
167600         MOVE +1                 TO PV-BLOCK-NUMBER               16760000
167700         MOVE +1                 TO ASC-BLK-SUB                   16770000
167800         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  16780000
167900         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEMS-DISPLAYED           16790000
168000         PERFORM 4410-READ-TEMP-STORAGE                           16800000
168100                                                                  16810000
168200         PERFORM                                                  16820000
168300           UNTIL PV-BLOCK-NUMBER = PV-ORIGINAL-BLOCK              16830000
168400              OR PS-ERROR                                         16840000
168500              OR PS-BLOCK-ERROR                                   16850000
168600                                                                  16860000
168700                 COMPUTE PV-ITEMS-HOLD  =                         16870000
168800                         ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) +    16880000
168900                         PC-ITEMS-PER-PANEL - 1                   16890000
169000                                                                  16900000
169100                 IF  PV-ITEMS-HOLD > ASC-NUMBER-OF-ITEMS-READ     16910000
169200                     SUBTRACT  ASC-NUMBER-OF-ITEMS-READ           16920000
169300                         FROM  PV-ITEMS-HOLD                      16930000
169400                       GIVING  PV-ITEMS-DIFF                      16940000
169500                     SUBTRACT  PV-ITEMS-DIFF                      16950000
169600                         FROM  PC-ITEMS-PER-PANEL                 16960000
169700                       GIVING  PV-ITEMS-HOLD                      16970000
169800                         MOVE  PV-ITEMS-HOLD TO PV-SUB            16980000
169900                                                ASC-ITEM-SUB      16990000
170000                                               ASC-ITEMS-DISPLAYED17000000
170100                 ELSE                                             17010000
170200                     MOVE ASC-ITEMS-DISPLAYED  TO PV-SUB          17020000
170300                     MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB    17030000
170400                 END-IF                                           17040000
170500                                                                  17050000
170600                 PERFORM 3300-EDIT-SELECTIONS                     17060000
170700                         VARYING PV-SUB                           17070000
170800                            FROM PV-SUB BY -1                     17080000
170900                           UNTIL PV-SUB < +1                      17090000
171000                                                                  17100000
171100                 MOVE +1               TO ASC-BLK-SUB             17110000
171200                                                                  17120000
171300                 PERFORM 5105-REWRITE-ASC-LISTQ                   17130000
171400                                                                  17140000
171500                 MOVE +1                TO ASC-BLK-SUB            17150000
171600                                                                  17160000
171700                 IF  PS-BLOCK-ERROR                               17170000
171800                     SET  PS-ERROR     TO TRUE                    17180000
171900                     MOVE ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB 1)    17190000
172000                                       TO PV-TOP-ITEM             17200000
172100                 ELSE                                             17210000
172200                     ADD  +1            TO PV-BLOCK-NUMBER        17220000
172300                     IF  PV-BLOCK-NUMBER = PV-ORIGINAL-BLOCK      17230000
172400                         MOVE +2        TO ASC-BLK-SUB            17240000
172500                         PERFORM 4410-READ-TEMP-STORAGE           17250000
172600                         MOVE +1        TO ASC-BLK-SUB            17260000
172700                     ELSE                                         17270000
172800                         PERFORM 4410-READ-TEMP-STORAGE           17280000
172900                         ADD  +1        TO PV-BLOCK-NUMBER        17290000
173000                         MOVE +2        TO ASC-BLK-SUB            17300000
173100                         PERFORM 4410-READ-TEMP-STORAGE           17310000
173200                         SUBTRACT +1  FROM PV-BLOCK-NUMBER        17320000
173300                         MOVE +1        TO ASC-BLK-SUB            17330000
173400                     END-IF                                       17340000
173500                 END-IF                                           17350000
173600     END-PERFORM.                                                 17360000
173700     MOVE +0 TO PV-ITEMS-HOLD.                                    17370000
173800                                                                  17380000
173900*----------------------------------------------------------------*17390000
174000*    DETERMINE THE VALUE OF THE ITEM SUBSCRIPT BASED ON THE ITEM *17400000
174100*    CURRENTLY IN USE AND THE FIRST ITEM IN THE ARRAY.  THIS WILL*17410000
174200*    POSITION US IN THE 1ST BLOCK OF THE ARRAY.                  *17420000
174300*                                                                *17430000
174400*    IF THE ITEM SUBSCRIPT EXCEEDS THE MAXIMUM NUMBER OF ITEMS   *17440000
174500*    IN A BLOCK, RECALCULATE THE SUBSCRIPT BY SUBTRACTING OUT    *17450000
174600*    THE MAXIMUM NUMBER OF ITEMS.  THIS WILL CORRECTLY POSITION  *17460000
174700*    US IN THE 2ND BLOCK OF THE ARRAY.                           *17470000
174800*----------------------------------------------------------------*17480000
174900 3100-SET-SUBSCRIPTS.                                             17490000
175000                                                                  17500000
175100     COMPUTE ASC-ITEM-SUB =                                       17510000
175200         (PV-ITEM-IN-USE - ASC-LIST-ITEM-NUMBER(1 1)) + 1.        17520000
175300                                                                  17530000
175400     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         17540000
175500         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            17550000
175600         MOVE PC-MAX-BLOCKS-IN-ARRAY TO ASC-BLK-SUB               17560000
175700     ELSE                                                         17570000
175800         MOVE +1                     TO ASC-BLK-SUB               17580000
175900     END-IF.                                                      17590000
176000******************************************************************17600000
176100** RESET THE ATTRIBUTES OF ALL ENTERABLE FIELDS ON THE MAP.     **17610000
176200******************************************************************17620000
176300 3200-RESET-ATTRIBUTES.                                           17630000
176400                                                                  17640000
176500     MOVE DP015-UNP-ALP-NOR-OFF    TO ASTRTITA.                   17650000
176600     MOVE DP015-GREEN              TO ASTRTITC.                   17660000
176700     MOVE DP015-UNDERLINE          TO ASTRTITH.                   17670000
176800                                                                  17680000
176900     PERFORM                                                      17690000
177000         VARYING PV-SUB                                           17700000
177100         FROM 1 BY 1                                              17710000
177200         UNTIL PV-SUB > PC-ITEMS-PER-PANEL                        17720000
177300             MOVE DP015-UNP-ALP-NOR-OFF TO MR-SELECTA (PV-SUB)    17730000
177400             MOVE DP015-GREEN         TO MR-SELECTC (PV-SUB)      17740000
177500             MOVE DP015-UNDERLINE     TO MR-SELECTH (PV-SUB)      17750000
177510             MOVE DP015-BLUE          TO MR-STR-SCANC (PV-SUB)    17751011
177600     END-PERFORM.                                                 17760000
177700                                                                  17770000
177800******************************************************************17780000
177900** EDIT THE SELECTIONS MADE.  NOTE THAT THE 'SELECTED-SW' IS    **17790000
178000** WHAT WAS PREVIOUSLY CHECKED AND CORRECT 'TEMP-SELECTED-SW'   **17800000
178100** IS WHAT HAS JUST BEEN ENTERED AND HAS NOT BEEN EDITTED OR    **17810000
178200** WAS ENTERED EARLIER, BUT DID NOT PASS THE EDITS.             **17820000
178300******************************************************************17830000
178400 3300-EDIT-SELECTIONS.                                            17840000
178500                                                                  17850000
178600     EVALUATE TRUE                                                17860000
178700         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     17870000
178800             = ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)         17880000
178900                 CONTINUE                                         17890000
179000         WHEN ASC-TEMP-SELECT  (ASC-BLK-SUB ASC-ITEM-SUB)         17900000
179100             IF  NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)        17910000
179200                 ADD +1         TO ASC-NUMBER-OF-SELECTED-ITEMS   17920000
179300                 MOVE ASC-TEMP-SELECTED-SW                        17930000
179400                                      (ASC-BLK-SUB ASC-ITEM-SUB)  17940000
179500                                TO ASC-SELECTED-SW                17950000
179600                                      (ASC-BLK-SUB ASC-ITEM-SUB)  17960000
179700             END-IF                                               17970000
179800         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     17980000
179900                 = SPACE                                          17990000
180000             EVALUATE TRUE                                        18000000
180100                 WHEN ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)       18010000
180200                     SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS18020000
180300                     MOVE SPACE TO ASC-SELECTED-SW                18030000
180400                                      (ASC-BLK-SUB ASC-ITEM-SUB)  18040000
180500                 WHEN ASC-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)        18050000
180600                     MOVE ZERO  TO ASC-START-OF-SELECTED-RANGE    18060000
180700                     MOVE SPACE TO ASC-SELECTED-SW                18070000
180800                                      (ASC-BLK-SUB ASC-ITEM-SUB)  18080000
180900                 WHEN ASC-END (ASC-BLK-SUB ASC-ITEM-SUB)          18090000
181000                     MOVE ZERO  TO ASC-END-OF-SELECTED-RANGE      18100000
181100                     MOVE SPACE TO ASC-SELECTED-SW                18110000
181200                                      (ASC-BLK-SUB ASC-ITEM-SUB)  18120000
181300             END-EVALUATE                                         18130000
181400         WHEN ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)           18140000
181500             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            18150000
181600                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    18160000
181700             END-IF                                               18170000
181800             PERFORM 3310-EDIT-RANGE                              18180000
181900         WHEN ASC-TEMP-END (ASC-BLK-SUB ASC-ITEM-SUB)             18190000
182000             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            18200000
182100                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    18210000
182200             END-IF                                               18220000
182300             PERFORM 3310-EDIT-RANGE                              18230000
182400         WHEN OTHER                                               18240000
182500             MOVE PC-TSYMSG-00005   TO DP020-MSG-NUMBER           18250000
182600             SET DP020-MSG-FATAL    TO TRUE                       18260000
182700             MOVE -1                TO ASTRTITL                   18270000
182800             SET DP030-SET-CURSOR-APPL-1                          18280000
182900                                    TO TRUE                       18290000
183000             MOVE DP015-RED         TO MR-SELECTC (PV-SUB)        18300000
183100             MOVE DP015-REVERSE     TO MR-SELECTH (PV-SUB)        18310000
183200             SET PS-ERROR TO TRUE                                 18320000
183300             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            18330000
183400                 SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS     18340000
183500                 MOVE SPACE         TO ASC-SELECTED-SW            18350000
183600                                        (ASC-BLK-SUB ASC-ITEM-SUB)18360000
183700             END-IF                                               18370000
183800     END-EVALUATE.                                                18380000
183900                                                                  18390000
184000     SUBTRACT +1             FROM PV-ITEM-IN-USE.                 18400000
184100     SUBTRACT +1 FROM ASC-ITEM-SUB.                               18410000
184200     IF  ASC-ITEM-SUB < 1                                         18420000
184300         SUBTRACT +1 FROM ASC-BLK-SUB                             18430000
184400         MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB                18440000
184500     END-IF.                                                      18450000
184600                                                                  18460000
184700******************************************************************18470000
184800** IF A BEGINNING AND END OF RANGE WAS ENTERED TO SELECT A      **18480000
184900** RANGE OF LINES, MAKE SURE THERE IS ONLY 1 BEGINNING AND 1    **18490000
185000** ENDING AND MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN)**18500000
185100** THE ENDING.                                                  **18510000
185200******************************************************************18520000
185300 3310-EDIT-RANGE.                                                 18530000
185400                                                                  18540000
185500     IF  ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)                18550000
185600         IF  ASC-START-OF-SELECTED-RANGE = ZERO                   18560000
185700             MOVE ASC-TEMP-SELECTED-SW  (ASC-BLK-SUB ASC-ITEM-SUB)18570000
185800                                   TO ASC-SELECTED-SW             18580000
185900                                        (ASC-BLK-SUB ASC-ITEM-SUB)18590000
186000             MOVE PV-ITEM-IN-USE   TO ASC-START-OF-SELECTED-RANGE 18600000
186100         ELSE                                                     18610000
186200             IF  ASC-START-OF-SELECTED-RANGE = PV-ITEM-IN-USE     18620000
186300                 CONTINUE                                         18630000
186400             ELSE                                                 18640000
186500*                -- ONLY ONE BEGINNING-OF-RANGE-ALLOWED --        18650000
186600                 MOVE PC-TSYMSG-00054                             18660000
186700                                       TO DP020-MSG-NUMBER        18670000
186800                 MOVE -1               TO ASTRTITL                18680000
186900                 SET DP020-MSG-FATAL                              18690000
187000                     DP030-SET-CURSOR-APPL-1                      18700000
187100                     PS-ERROR          TO TRUE                    18710000
187200             END-IF                                               18720000
187300         END-IF                                                   18730000
187400     ELSE                                                         18740000
187500         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     18750000
187600             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 18760000
187700                                   TO ASC-SELECTED-SW             18770000
187800                                     (ASC-BLK-SUB ASC-ITEM-SUB)   18780000
187900             MOVE PV-ITEM-IN-USE   TO ASC-END-OF-SELECTED-RANGE   18790000
188000         ELSE                                                     18800000
188100             IF  ASC-END-OF-SELECTED-RANGE = PV-ITEM-IN-USE       18810000
188200                 CONTINUE                                         18820000
188300             ELSE                                                 18830000
188400*                -- ONLY ONE END-OF-RANGE ALLOWED --              18840000
188500                 MOVE PC-TSYMSG-00055                             18850000
188600                                        TO DP020-MSG-NUMBER       18860000
188700                 MOVE -1                TO ASTRTITL               18870000
188800                 SET DP020-MSG-FATAL                              18880000
188900                     DP030-SET-CURSOR-APPL-1                      18890000
189000                     PS-ERROR           TO TRUE                   18900000
189100             END-IF                                               18910000
189200         END-IF                                                   18920000
189300     END-IF.                                                      18930000
189400                                                                  18940017
189500******************************************************************18950000
189600** IF BOTH A BEGINNING AND END OF RANGE HAVE BEEN SPECIFIED,    **18960000
189700** MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN) THE END.  **18970000
189800******************************************************************18980000
189900 3400-CHECK-RANGE-SEQUENCE.                                       18990000
190000                                                                  19000000
190100     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       19010000
190200       AND  ASC-END-OF-SELECTED-RANGE > ZERO                      19020000
190300       AND  ASC-START-OF-SELECTED-RANGE >                         19030000
190400                                         ASC-END-OF-SELECTED-RANGE19040000
190500*        -- END-OF-RANGE BEFORE BEGINNING-OF-RANGE                19050000
190600         MOVE PC-TSYMSG-00052 TO DP020-MSG-NUMBER                 19060000
190700         SET DP020-MSG-FATAL TO TRUE                              19070000
190800         SET PS-ERROR TO TRUE                                     19080000
190900         PERFORM 3410-POSITION-AT-ERROR                           19090000
191000     END-IF.                                                      19100000
191100******************************************************************19110000
191200** BECAUSE RANGES CAN SPAN ACROSS MULTIPLE PAGES, A SEPARATE    **19120000
191300** PARAGRAPH (THIS ONE) IS NEEDED TO DETERMINE WHERE THE CURSOR **19130000
191400** SHOULD BE POSITIONED ON A RANGE ERROR.                       **19140000
191500******************************************************************19150000
191600 3410-POSITION-AT-ERROR.                                          19160000
191700                                                                  19170000
191800     SET DP030-SET-CURSOR-APPL-1                                  19180000
191900                                   TO TRUE.                       19190000
192000     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 19200000
192100                    - PV-TOP-ITEM + 1.                            19210000
192200     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      19220000
192300         CONTINUE                                                 19230000
192400     ELSE                                                         19240000
192500         MOVE -1                   TO MR-SELECTL (PV-SUB)         19250000
192600         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         19260000
192700         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         19270000
192800     END-IF.                                                      19280000
192900                                                                  19290017
193000     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   19300000
193100                    - PV-TOP-ITEM + 1.                            19310000
193200     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      19320000
193300         CONTINUE                                                 19330000
193400     ELSE                                                         19340000
193500         MOVE -1                   TO MR-SELECTL (PV-SUB)         19350000
193600         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         19360000
193700         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         19370000
193800     END-IF.                                                      19380000
193900                                                                  19390000
194000*----------------------------------------------------------------*19400000
194100*    WHENEVER THE USER SELECTS AN ITEM AS THE BEGINNING RANGE    *19410000
194200*    AND ONE AS THE ENDING RANGE, MARK THESE ITEMS AS WELL AS    *19420000
194300*    THOSE THAT FALL IN THE RANGE AS BEING SELECTED.             *19430000
194400*----------------------------------------------------------------*19440000
194500 3500-MARK-RANGE-AS-SELECTED.                                     19450000
194600                                                                  19460000
194700     MOVE +1                       TO  ASC-BLK-SUB.               19470000
194800     PERFORM 3510-MARK-SELECTED-INDS                              19480000
194900         VARYING ASC-ITEM-SUB                                     19490000
195000         FROM 1 BY 1                                              19500000
195100         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 19510000
195200                                                                  19520000
195300     ADD +1                        TO ASC-BLK-SUB.                19530000
195400     PERFORM 3510-MARK-SELECTED-INDS                              19540000
195500         VARYING ASC-ITEM-SUB                                     19550000
195600         FROM 1 BY 1                                              19560000
195700         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 19570000
195800                                                                  19580000
195900     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               19590000
196000                                   TO  PV-LIST-ITEM-NUMBER.       19600000
196100     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            19610000
196200         1 + ((PV-LIST-ITEM-NUMBER - 1) /                         19620000
196300               PC-ITEMS-PER-PANEL).                               19630000
196400                                                                  19640000
196500     MOVE ASC-START-OF-SELECTED-RANGE                             19650000
196600                                   TO PV-START-OF-SELECTED-RANGE. 19660000
196700     COMPUTE PV-FIRST-BLOCK-IN-RANGE =                            19670000
196800         1 + ((PV-START-OF-SELECTED-RANGE - 1) /                  19680000
196900               PC-ITEMS-PER-PANEL).                               19690000
197000                                                                  19700000
197100     MOVE ASC-END-OF-SELECTED-RANGE                               19710000
197200                                   TO  PV-END-OF-SELECTED-RANGE.  19720000
197300     COMPUTE PV-LAST-BLOCK-IN-RANGE =                             19730000
197400         1 + ((PV-END-OF-SELECTED-RANGE - 1) /                    19740000
197500               PC-ITEMS-PER-PANEL).                               19750000
197600     COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                             19760000
197700         PV-FIRST-BLOCK-IN-ARRAY + 1.                             19770000
197800                                                                  19780000
197900     IF (PV-FIRST-BLOCK-IN-RANGE < PV-FIRST-BLOCK-IN-ARRAY) OR    19790000
198000        (PV-LAST-BLOCK-IN-RANGE  > PV-NEXT-BLOCK-IN-ARRAY)        19800000
198100         MOVE +1                   TO ASC-BLK-SUB                 19810000
198200         PERFORM 5100-WRITE-TEMP-STORAGE                          19820000
198300         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         19830000
198400             PV-FIRST-BLOCK-IN-ARRAY - 1                          19840000
198500                                                                  19850000
198600         PERFORM                                                  19860000
198700             UNTIL PV-FIRST-BLOCK-IN-RANGE >                      19870000
198800                   PV-PREV-BLOCK-IN-ARRAY                         19880000
198900             MOVE PV-FIRST-BLOCK-IN-RANGE                         19890000
199000                                   TO PV-BLOCK-NUMBER             19900000
199100             PERFORM 4410-READ-TEMP-STORAGE                       19910000
199200             PERFORM 3510-MARK-SELECTED-INDS                      19920000
199300                 VARYING ASC-ITEM-SUB                             19930000
199400                 FROM 1 BY 1                                      19940000
199500                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          19950000
199600             PERFORM 5100-WRITE-TEMP-STORAGE                      19960000
199700             ADD +1                TO PV-FIRST-BLOCK-IN-RANGE     19970000
199800         END-PERFORM                                              19980000
199900                                                                  19990000
200000         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         20000000
200100             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     20010000
200200         PERFORM                                                  20020000
200300             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       20030000
200400                   PV-LAST-BLOCK-IN-RANGE                         20040000
200500             MOVE PV-NEXT-BLOCK-IN-ARRAY                          20050000
200600                                   TO PV-BLOCK-NUMBER             20060000
200700             PERFORM 4410-READ-TEMP-STORAGE                       20070000
200800             PERFORM 3510-MARK-SELECTED-INDS                      20080000
200900                 VARYING ASC-ITEM-SUB                             20090000
201000                 FROM 1 BY 1                                      20100000
201100                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          20110000
201200             PERFORM 5100-WRITE-TEMP-STORAGE                      20120000
201300             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      20130000
201400         END-PERFORM                                              20140000
201500                                                                  20150000
201600         MOVE PV-FIRST-BLOCK-IN-ARRAY                             20160000
201700                                   TO PV-BLOCK-NUMBER             20170000
201800         PERFORM 4410-READ-TEMP-STORAGE                           20180000
201900     END-IF.                                                      20190000
202000                                                                  20200000
202100     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE 20210000
202200                                      ASC-END-OF-SELECTED-RANGE.  20220000
202300                                                                  20230000
202400*----------------------------------------------------------------*20240000
202500* SET THE SELECTION INDICATOR TO 'S' WITHIN THE RANGE.           *20250000
202600*----------------------------------------------------------------*20260000
202700 3510-MARK-SELECTED-INDS.                                         20270000
202800                                                                  20280000
202900     IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         20290000
203000                                ASC-ITEM-SUB) >                   20300000
203100         ASC-START-OF-SELECTED-RANGE)                             20310000
203200     OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         20320000
203300                                ASC-ITEM-SUB) =                   20330000
203400         ASC-START-OF-SELECTED-RANGE)                             20340000
203500                                                                  20350000
203600         IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     20360000
203700                                    ASC-ITEM-SUB) <               20370000
203800             ASC-END-OF-SELECTED-RANGE)                           20380000
203900         OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     20390000
204000                                    ASC-ITEM-SUB) =               20400000
204100             ASC-END-OF-SELECTED-RANGE)                           20410000
204200                                                                  20420000
204300             IF NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          20430000
204400                 SET ASC-SELECT     (ASC-BLK-SUB  ASC-ITEM-SUB)   20440000
204500                     ASC-TEMP-SELECT(ASC-BLK-SUB  ASC-ITEM-SUB)   20450000
204600                               TO TRUE                            20460000
204700                 SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB)              20470000
204800                               TO TRUE                            20480000
204900                 ADD +1        TO ASC-NUMBER-OF-SELECTED-ITEMS    20490000
205000             END-IF                                               20500000
205100         END-IF                                                   20510000
205200     END-IF.                                                      20520000
205300                                                                  20530000
205400 3600-VERIFY-PRINTER-ID.                                          20540000
205500     EVALUATE TRUE                                                20550000
205600         WHEN ASC-PRTR = SPACES                                   20560000
205700             SET PS-ERROR                                         20570000
205800                 DP020-MSG-FATAL  TO TRUE                         20580000
205900             MOVE PC-TSYMSG-00007 TO DP020-MSG-NUMBER             20590000
206000             MOVE DP015-UNP-ALP-BRT-MDT                           20600000
206100                                  TO APRINTA                      20610000
206200             MOVE DP015-RED       TO APRINTC                      20620000
206300             MOVE DP015-REVERSE   TO APRINTH                      20630000
206400             MOVE -1              TO APRINTL                      20640000
206500             SET DP030-SET-CURSOR-APPL-1                          20650000
206600                                  TO TRUE                         20660000
206700         WHEN ASC-PRTR > SPACES                                   20670000
206800*            VALIDATE USING DPKCS060                              20680000
206900             MOVE ASC-PRTR                                        20690000
207000                                     TO DP072-PRINTER-ID          20700000
207100             SET ASC-CARTON-MANIFEST-PGM                          20710000
207200                                    TO TRUE                       20720000
207300             MOVE ASC-CALLED-PROGRAM TO DP072-RPT-PGM-NME         20730000
207400             MOVE '01'               TO DP072-RPT-PGM-TYP-ID      20740000
207500             MOVE ASC-OPER-UNT-ID    TO DP072-ORIGIN-OPER-UNT-ID  20750000
207600                                        DP072-OPER-UNT-ID         20760000
207700             MOVE 1                  TO DP072-ORIGIN-FCLTY-ID     20770000
207800                                        DP072-FCLTY-ID            20780000
207900             SET DP072-VALIDATE     TO TRUE                       20790000
208000                                                                  20800000
208100             EXEC CICS                                            20810000
208200                 LINK PROGRAM  (PC-DPKCS060)                      20820000
208300                      COMMAREA (DP072-COMM-AREA)                  20830000
208400                      RESP     (PV-CICS-RESP)                     20840000
208500             END-EXEC                                             20850000
208600                                                                  20860000
208700             EVALUATE TRUE                                        20870000
208800                 WHEN PV-CICS-RESP = DFHRESP (NORMAL)             20880000
208900                     CONTINUE                                     20890000
209000                 WHEN OTHER                                       20900000
209100                       MOVE '3600-VERIFY-PRINTER-ID'              20910000
209200                                            TO DP013-PARAGRAPH    20920000
209300                       MOVE PV-CICS-RESP                          20930000
209400                            TO DP013-MESSAGE-TEXT(1)              20940000
209500                       MOVE SQLCA           TO DP013-SQLCA        20950000
209600                       SET DP013-LINK-RETURN                      20960000
209700                           DP013-CICS-ABEND                       20970000
209800                           DP013-NO-ROLLBACK TO TRUE              20980000
209900                       PERFORM DP013-0000-PROCESS-ABEND           20990000
210000             END-EVALUATE                                         21000000
210100                                                                  21010000
210200             IF  DP072-PRTR-PRTR-TRK-STAT-CDE = 'A'               21020000
210300                 MOVE DP072-PRTR-AUTO-CUTTER-IND                  21030000
210400                     TO ASC-PRTR-AUTO-CUTTER-IND                  21040000
210500                 MOVE DP072-PRTR-PRTR-BRCDE-IND                   21050000
210600                     TO ASC-PRTR-PRTR-BRCDE-IND                   21060000
210700                 MOVE DP072-PRTR-PRTR-CNTL-IND                    21070000
210800                     TO ASC-PRTR-PRTR-CNTL-IND                    21080000
210900                 MOVE DP072-PRTR-LOC-DESC                         21090000
211000                     TO ASC-PRTR-LOC-DESC                         21100000
211100             ELSE                                                 21110000
211200                 SET PS-ERROR                                     21120000
211300                     DP020-MSG-FATAL                              21130000
211400                                  TO TRUE                         21140000
211500                 MOVE PC-TSYMSG-00746                             21150000
211600                                  TO DP020-MSG-NUMBER             21160000
211700                 MOVE DP015-UNP-ALP-BRT-MDT                       21170000
211800                                  TO APRINTA                      21180000
211900                 MOVE DP015-RED   TO APRINTC                      21190000
212000                 MOVE DP015-REVERSE                               21200000
212100                                  TO APRINTH                      21210000
212200                 MOVE -1          TO APRINTL                      21220000
212300                 SET DP030-SET-CURSOR-APPL-1                      21230000
212400                                  TO TRUE                         21240000
212500             END-IF                                               21250000
212600     END-EVALUATE.                                                21260000
212700                                                                  21270017
212800     IF  PS-NO-ERROR                                              21280000
212900         MOVE -1                   TO APRINTL                     21290000
213000         SET DP030-SET-CURSOR-APPL-1                              21300000
213100                                   TO TRUE                        21310000
213200     END-IF.                                                      21320000
213300*----------------------------------------------------------------*21330000
213400*    INITIALIZE BOTH BLOCKS IN THE ARRAY.                        *21340000
213500*    INITIALIZE ALL COUNTERS AND FLAGS.                          *21350000
213600*    READ THE DATA BASE FOR THE 1ST TIME AND FILL UP THE ARRAY.  *21360000
213700*    DISPLAY THE PANEL TO USER.                                  *21370000
213800*----------------------------------------------------------------*21380000
213900 4000-BUILD-INITIAL-PANEL.                                        21390000
214000                                                                  21400000
214100     INITIALIZE                  ASC-BLOCK-ENTRIES (1)            21410000
214200                                 ASC-BLOCK-ENTRIES (2).           21420000
214300     MOVE +1                 TO ASC-BLK-SUB.                      21430000
214400     SET ASC-ITEMS-LEFT-ON-DB                                     21440000
214500                             TO TRUE.                             21450000
214600                                                                  21460000
214700     MOVE +0                 TO ASC-ITEM-SUB                      21470000
214800                                ASC-NUMBER-OF-ITEMS-READ          21480000
214900                                ASC-NUMBER-OF-SELECTED-ITEMS      21490000
215000                                ASC-HIGHEST-BLOCK-WRITTEN         21500000
215100                                ASC-START-OF-SELECTED-RANGE       21510000
215200                                ASC-END-OF-SELECTED-RANGE         21520000
215300                                ASC-ITEM-AT-TOP-OF-PANEL.         21530000
215400                                                                  21540000
215500     MOVE ASC-MASTER-SML        TO DK-SML-NBR                     21550000
215600                                   PC046-CARTON-ID                21560000
215700                                   DK-SHIPT-UNT-ID                21570000
215800     PERFORM 4350-CARTON-INFO                                     21580000
215900     IF PS-NO-ERROR                                               21590000
216000         MOVE PC046-CRTN-STAT-DESC   TO ASC-MASTER-STAT-DESC      21600000
216100         MOVE PC046-CRTN-STAT-TMST   TO PV-TMST                   21610000
216200         PERFORM 4300A-FORMAT-DATE-TIME                           21620000
216300         STRING PV-USA-DATE DELIMITED BY SIZE                     21630000
216400                ' '         DELIMITED BY SIZE                     21640000
216500              PV-JIS-TIME   DELIMITED BY SIZE                     21650000
216600                    INTO ASC-MASTER-STAT-DATE                     21660000
216700     ELSE                                                         21670000
216800         MOVE SPACES  TO ASC-MASTER-STAT-DESC                     21680000
216900                         ASC-MASTER-STAT-DATE                     21690000
217000     END-IF                                                       21700000
217100     MOVE PC046-PO-NBR          TO DK-PO-NBR.                     21710000
217200     MOVE PC046-RCVR-NBR        TO DK-REC-SEQ-NBR.                21720000
218700                                                                  21870000
218800     PERFORM 4100-PREPARE-HEADINGS.                               21880000
218900     PERFORM 4010-OPEN-CURSOR.                                    21890000
219000     PERFORM 4300-READ-ITEMS-FROM-DB.                             21900000
219100     PERFORM 4020-CLOSE-CURSOR.                                   21910000
219200                                                                  21920000
219300     IF   ASC-NUMBER-OF-ITEMS-READ = ZERO                         21930000
219400          SET ASC-ITEMS-LEFT-ON-DB TO TRUE                        21940000
219500          PERFORM  4110-OPEN-MSTR-CSR                             21950000
219600          PERFORM  4120-READ-MSTR                                 21960000
219700          PERFORM  4130-CLOSE-MSTR-CSR                            21970000
219800     END-IF                                                       21980000
219900                                                                  21990000
220000     MOVE ASC-NUMBER-OF-ITEMS-READ TO ASC-TOT-CRTNS.              22000000
220100                                                                  22010000
220200     MOVE +1                   TO  PV-TOP-ITEM.                   22020000
220300                                                                  22030000
220400     IF  ASC-NUMBER-OF-ITEMS-READ = ZERO                          22040000
220500         SET DP020-MSG-WARNING TO  TRUE                           22050000
220600         MOVE PC-TSYMSG-00050  TO  DP020-MSG-NUMBER               22060000
220700         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      22070000
220800         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                     22080000
220900     ELSE                                                         22090000
221000         MOVE -1               TO MR-SELECTL (1)                  22100000
221100         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      22110000
221200         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                     22120000
221300     END-IF.                                                      22130000
221400                                                                  22140000
221500*----------------------------------------------------------------*22150000
221600* OPEN THE CURSOR                                                 22160000
221700*----------------------------------------------------------------*22170000
221800 4010-OPEN-CURSOR.                                                22180000
221900     PERFORM                                                      22190000
222000         WITH TEST AFTER                                          22200000
222100         VARYING PV-RETRY-COUNTER                                 22210000
222200         FROM 1 BY 1                                              22220000
222300         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               22230000
222400                   OR (SQLCODE = ZERO))                           22240000
222500                                                                  22250000
222600         EXEC SQL                                                 22260000
222700              OPEN CARTON-CSR                                     22270000
222800         END-EXEC                                                 22280000
222900                                                                  22290000
223000         EVALUATE TRUE                                            22300000
223100             WHEN SQLCODE = ZERO                                  22310000
223200             WHEN SQLCODE = -904                                  22320000
223300             WHEN SQLCODE = -913                                  22330000
223400                 CONTINUE                                         22340000
223500             WHEN SQLWARN0 NOT = SPACES                           22350000
223600             WHEN SQLCODE < ZERO                                  22360000
223700             WHEN SQLCODE > ZERO                                  22370000
223800                 MOVE '4010-OPEN-CURSOR' TO DP013-PARAGRAPH       22380000
223900                 MOVE 'OPEN CURSOR PROBLEM    - '                 22390000
224000                                   TO DP013-MESSAGE-TEXT (1)      22400000
224100                 MOVE SQLCA        TO DP013-SQLCA                 22410000
224200                 MOVE 'SUT00028'   TO DP013-DB2-TABLE-NAME (1)    22420000
224300                 SET DP013-DB2-ABEND                              22430000
224400                     DP013-XCTL-DISPLAY-RESTART TO TRUE           22440000
224500                 PERFORM DP013-0000-PROCESS-ABEND                 22450000
224600         END-EVALUATE                                             22460000
224700     END-PERFORM.                                                 22470000
224800                                                                  22480017
224900     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        22490000
225000         MOVE '4010-OPEN-CURSOR'   TO DP013-PARAGRAPH             22500000
225100         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR'   22510000
225200                                   TO DP013-MESSAGE-TEXT (1)      22520000
225300         MOVE SQLCA                TO DP013-SQLCA                 22530000
225400         MOVE 'SUT00028'           TO DP013-DB2-TABLE-NAME (1)    22540000
225500         SET DP013-DB2-ABEND                                      22550000
225600             DP013-XCTL-DISPLAY-RESTART TO TRUE                   22560000
225700         PERFORM DP013-0000-PROCESS-ABEND                         22570000
225800     END-IF.                                                      22580000
225900                                                                  22590000
226000*----------------------------------------------------------------*22600000
226100* CLOSE THE CURSOR.                                               22610000
226200*----------------------------------------------------------------*22620000
226300 4020-CLOSE-CURSOR.                                               22630000
226400                                                                  22640000
226500     EXEC SQL                                                     22650000
226600          CLOSE CARTON-CSR                                        22660000
226700     END-EXEC.                                                    22670000
226800                                                                  22680000
226900     EVALUATE TRUE                                                22690000
227000         WHEN SQLCODE = ZERO                                      22700000
227100         WHEN SQLCODE = +100                                      22710000
227200             CONTINUE                                             22720000
227300         WHEN SQLWARN0 NOT = SPACES                               22730000
227400         WHEN SQLCODE < ZERO                                      22740000
227500         WHEN SQLCODE > ZERO                                      22750000
227600             MOVE '4020-CLOSE-CURSOR' TO DP013-PARAGRAPH          22760000
227700             MOVE 'CLOSE CURSOR PROBLEM   '                       22770000
227800                               TO DP013-MESSAGE-TEXT (1)          22780000
227900             MOVE SQLCA        TO DP013-SQLCA                     22790000
228000             MOVE 'SUT00028'   TO DP013-DB2-TABLE-NAME (1)        22800000
228100             SET DP013-DB2-ABEND                                  22810000
228200                 DP013-XCTL-DISPLAY-RESTART TO TRUE               22820000
228300             PERFORM DP013-0000-PROCESS-ABEND                     22830000
228400     END-EVALUATE.                                                22840000
228500                                                                  22850000
228600*----------------------------------------------------------------*22860000
228700*    FILL IN TOP PART OF SCREEN                                   22870000
228800*----------------------------------------------------------------*22880000
228900 4100-PREPARE-HEADINGS.                                           22890000
229000     MOVE ASC-CURR-OPER-UNT-ID TO ASC-OPER-UNT-ID.                22900000
229100                                                                  22910000
229200*----------------------------------------------------------------*22920000
229300* OPEN THE CURSOR                                                 22930000
229400*----------------------------------------------------------------*22940000
229500 4110-OPEN-MSTR-CSR.                                              22950000
229600     PERFORM                                                      22960000
229700         WITH TEST AFTER                                          22970000
229800         VARYING PV-RETRY-COUNTER                                 22980000
229900         FROM 1 BY 1                                              22990000
230000         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               23000000
230100                   OR (SQLCODE = ZERO))                           23010000
230200                                                                  23020000
230300         EXEC SQL                                                 23030000
230400              OPEN DISOLVED-MSTR-CSR                              23040000
230500         END-EXEC                                                 23050000
230600                                                                  23060000
230700         EVALUATE TRUE                                            23070000
230800             WHEN SQLCODE = ZERO                                  23080000
230900             WHEN SQLCODE = -904                                  23090000
231000             WHEN SQLCODE = -913                                  23100000
231100                 CONTINUE                                         23110000
231200             WHEN SQLWARN0 NOT = SPACES                           23120000
231300             WHEN SQLCODE < ZERO                                  23130000
231400             WHEN SQLCODE > ZERO                                  23140000
231500                 MOVE '4110-OPEN-MSTR-CSR' TO DP013-PARAGRAPH     23150000
231600                 MOVE 'OPEN CURSOR PROBLEM    - '                 23160000
231700                                   TO DP013-MESSAGE-TEXT (1)      23170000
231800                 MOVE SQLCA        TO DP013-SQLCA                 23180000
231900                 MOVE 'SUT00098'   TO DP013-DB2-TABLE-NAME (1)    23190000
232000                 MOVE 'SUT00099'   TO DP013-DB2-TABLE-NAME (2)    23200000
232100                 SET DP013-DB2-ABEND                              23210000
232200                     DP013-XCTL-DISPLAY-RESTART TO TRUE           23220000
232300                 PERFORM DP013-0000-PROCESS-ABEND                 23230000
232400         END-EVALUATE                                             23240000
232500     END-PERFORM.                                                 23250000
232600                                                                  23260017
232700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        23270000
232800         MOVE '4110-OPEN-MSTR-CSR' TO DP013-PARAGRAPH             23280000
232900         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR'   23290000
233000                                   TO DP013-MESSAGE-TEXT (1)      23300000
233100         MOVE SQLCA                TO DP013-SQLCA                 23310000
233200         MOVE 'SUT00098'           TO DP013-DB2-TABLE-NAME (1)    23320000
233300         MOVE 'SUT00099'           TO DP013-DB2-TABLE-NAME (2)    23330000
233400         SET DP013-DB2-ABEND                                      23340000
233500             DP013-XCTL-DISPLAY-RESTART TO TRUE                   23350000
233600         PERFORM DP013-0000-PROCESS-ABEND                         23360000
233700     END-IF.                                                      23370000
233800                                                                  23380000
233900*----------------------------------------------------------------*23390000
234000*    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE    *23400000
234100*    BLOCKS IN THE ARRAY.  WHENEVER BOTH BLOCKS BECOME FULL,     *23410000
234200*    WRITE OUT THE 1ST BLOCK TO TEMPORARY STORAGE, MOVE THE 2ND  *23420000
234300*    BLOCK IN THE ARRAY TO THE 1ST BLOCK, AND INITIALIZE THE     *23430000
234400*    2ND BLOCK MAKING IT AVAILABLE TO BE USED.                   *23440000
234500*                                                                *23450000
234600*    DUE TO THE SIZE OF THE TABLE, AND THE ORDER IN WHICH THE    *23460000
234700*    ROWS ARE SORTED, THE ENTIRE TABLE IS READ INTO THE PROGRAM  *23470000
234800*    UPON INITIALIZATION.                                        *23480000
234900*----------------------------------------------------------------*23490000
235000 4120-READ-MSTR.                                                  23500000
235100                                                                  23510000
235200     PERFORM                                                      23520000
235300         VARYING PV-READ-COUNT                                    23530000
235400         FROM 1 BY 1                                              23540000
235500         UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                    23550000
235600            OR (ASC-NO-ITEMS-LEFT-ON-DB))                         23560000
235700                                                                  23570000
235800         PERFORM 4121-FETCH-MSTR                                  23580000
235900                                                                  23590000
236000         IF  ASC-ITEMS-LEFT-ON-DB                                 23600000
236100             IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                23610000
236200                 ADD +1            TO ASC-ITEM-SUB                23620000
236300             ELSE                                                 23630000
236400                 ADD +1            TO ASC-BLK-SUB                 23640000
236500                 MOVE +1           TO ASC-ITEM-SUB                23650000
236600                                                                  23660000
236700                 IF  ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY         23670000
236800                     MOVE +1       TO ASC-BLK-SUB                 23680000
236900                     SET ASC-BLOCK-MODIFIED (1) TO TRUE           23690000
237000                     PERFORM 5100-WRITE-TEMP-STORAGE              23700000
237100                     MOVE ASC-BLOCK-ENTRIES                       23710000
237200                                   (PC-MAX-BLOCKS-IN-ARRAY)       23720000
237300                                TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB) 23730000
237400                     ADD +1        TO ASC-BLK-SUB                 23740000
237500                     INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)   23750000
237600                     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)      23760000
237700                                                          TO TRUE 23770000
237800                 END-IF                                           23780000
237900             END-IF                                               23790000
238000             ADD +1                TO ASC-NUMBER-OF-ITEMS-READ    23800000
238100             SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB) TO TRUE          23810000
238200             MOVE ASC-NUMBER-OF-ITEMS-READ                        23820000
238300                                   TO ASC-LIST-ITEM-NUMBER        23830000
238400                                      (ASC-BLK-SUB ASC-ITEM-SUB)  23840000
238500             MOVE SPACES TO ASC-ACTION                            23850000
238600                                      (ASC-BLK-SUB ASC-ITEM-SUB)  23860000
238700             PERFORM 4350-CARTON-INFO                             23870000
238710                                                                  23871017
238721             MOVE SUT00099-CHLD-SHIPT-UNT-ID                      23872104
238722                                       TO  SUT00121-SHIPT-UNT-ID  23872204
238723             PERFORM 4370-GET-STORE-SCAN-CDE                      23872304
238740                                                                  23874017
238800             IF PS-NO-ERROR                                       23880000
238900                 MOVE PC046-KOHLS-BARCODE                         23890000
239000                            TO ASC-SML (ASC-BLK-SUB ASC-ITEM-SUB) 23900000
239100                 MOVE PC046-DEST-OPER-UNT-ID TO                   23910000
239200                          ASC-DEST-NBR (ASC-BLK-SUB ASC-ITEM-SUB) 23920000
239300                          DK-STR-BEGIN                            23930000
239400                          DK-STR-END                              23940000
239500                 MOVE PC046-SHPUNT-SRC-ID                         23950000
239600                         TO ASC-CREATE (ASC-BLK-SUB ASC-ITEM-SUB) 23960000
239700                 MOVE PC046-CRTN-STAT-TMST   TO PV-TMST           23970000
239800                 PERFORM 4300A-FORMAT-DATE-TIME                   23980000
239900                 STRING PV-USA-DATE(1:6) PV-USA-DATE(9:2)         23990000
240000                     DELIMITED BY SIZE                            24000000
240100                    INTO ASC-STAT-DATE (ASC-BLK-SUB ASC-ITEM-SUB) 24010000
240200                 MOVE PV-JIS-TIME                                 24020000
240300                      TO ASC-STAT-TIME (ASC-BLK-SUB ASC-ITEM-SUB) 24030000
240400                 MOVE PC046-VENDOR-SHIPT-UNT-ID  TO               24040000
240500                                                DK-SHIPT-UNT-ID   24050000
240600                 MOVE ZEROES TO PV-SHPD-QTY                       24060000
240700                 MOVE SUT00099-CHLD-SHIPT-UNT-ID TO               24070000
240800                      SUT00028-SHIPT-UNT-ID                       24080000
240900                 PERFORM 4360-GET-SHPD-QTY                        24090000
241000                 MOVE PV-SHPD-QTY                                 24100000
241100                    TO ASC-UNTS-MNFSTD (ASC-BLK-SUB ASC-ITEM-SUB) 24110000
241200                 ADD PV-SHPD-QTY TO ASC-UNTS-MNFD                 24120000
241300                 EVALUATE PC046-CRTN-STATUS                       24130000
241400                     WHEN '01'                                    24140000
241500                         MOVE DK-INVALID-DESC TO ASC-LOAD-STATUS  24150000
241600                                       (ASC-BLK-SUB ASC-ITEM-SUB) 24160000
241700                     WHEN '02'                                    24170000
241800                         MOVE DK-INACT-DESC  TO ASC-LOAD-STATUS   24180000
241900                                       (ASC-BLK-SUB ASC-ITEM-SUB) 24190000
242000                     WHEN '03'                                    24200000
242100                         MOVE DK-SC-OF-DESC  TO ASC-LOAD-STATUS   24210000
242200                                       (ASC-BLK-SUB ASC-ITEM-SUB) 24220000
242300                     WHEN '04'                                    24230000
242400                         MOVE DK-SC-ON-DESC  TO ASC-LOAD-STATUS   24240000
242500                                       (ASC-BLK-SUB ASC-ITEM-SUB) 24250000
242600                     WHEN '05'                                    24260000
242700                         MOVE SUT00099-CHLD-SHIPT-UNT-ID TO       24270000
242800                              SUT00028-SHIPT-UNT-ID               24280000
242900                         PERFORM 4305-CHECK-ASSUMED               24290000
243000                         IF PS-DIVERTED                           24300000
243100                             MOVE DK-DVRT-DESC TO ASC-LOAD-STATUS 24310000
243200                                       (ASC-BLK-SUB ASC-ITEM-SUB) 24320000
243300                         ELSE                                     24330000
243400                             MOVE DK-ASSUM-DESC TO ASC-LOAD-STATUS24340000
243500                                       (ASC-BLK-SUB ASC-ITEM-SUB) 24350000
243600                         END-IF                                   24360000
243700                     WHEN '06'                                    24370000
243800                         MOVE DK-LOADED-DESC TO ASC-LOAD-STATUS   24380000
243900                                       (ASC-BLK-SUB ASC-ITEM-SUB) 24390000
244000                     WHEN '07'                                    24400000
244100                         MOVE DK-CSEPK-DESC  TO ASC-LOAD-STATUS   24410000
244200                                       (ASC-BLK-SUB ASC-ITEM-SUB) 24420000
244300                     WHEN '08'                                    24430000
244400                         MOVE DK-CK-IN-DESC  TO ASC-LOAD-STATUS   24440000
244500                                       (ASC-BLK-SUB ASC-ITEM-SUB) 24450000
244600                     WHEN '09'                                    24460000
244700                         MOVE DK-P2L-DESC    TO ASC-LOAD-STATUS   24470000
244800                                       (ASC-BLK-SUB ASC-ITEM-SUB) 24480000
244900                     WHEN '10'                                    24490000
245000                         MOVE DK-RDM-DESC    TO ASC-LOAD-STATUS   24500000
245100                                       (ASC-BLK-SUB ASC-ITEM-SUB) 24510000
245200                     WHEN '11'                                    24520000
245300                         MOVE DK-RECV-DESC   TO ASC-LOAD-STATUS   24530000
245400                                       (ASC-BLK-SUB ASC-ITEM-SUB) 24540000
245500                     WHEN '12'                                    24550000
245600                         MOVE DK-ASN-DESC    TO ASC-LOAD-STATUS   24560000
245700                                       (ASC-BLK-SUB ASC-ITEM-SUB) 24570000
245800                     WHEN '13'                                    24580000
245900                         MOVE DK-SMTH-DESC   TO ASC-LOAD-STATUS   24590000
246000                                       (ASC-BLK-SUB ASC-ITEM-SUB) 24600000
246100                     WHEN '14'                                    24610000
246200                         MOVE DK-XFER-DESC   TO ASC-LOAD-STATUS   24620000
246300                                       (ASC-BLK-SUB ASC-ITEM-SUB) 24630000
246400                     WHEN '15'                                    24640000
246500                         MOVE DK-MSTR-DESC   TO ASC-LOAD-STATUS   24650000
246600                                       (ASC-BLK-SUB ASC-ITEM-SUB) 24660000
246700                     WHEN '16'                                    24670000
246800                         MOVE DK-BLD-DESC    TO ASC-LOAD-STATUS   24680000
246900                                       (ASC-BLK-SUB ASC-ITEM-SUB) 24690000
247000                     WHEN '17'                                    24700000
247100                         MOVE 'JEWELRY'      TO ASC-LOAD-STATUS   24710000
247200                                       (ASC-BLK-SUB ASC-ITEM-SUB) 24720000
247300                     WHEN '18'                                    24730000
247400                         MOVE 'DAMAGED'      TO ASC-LOAD-STATUS   24740000
247500                                       (ASC-BLK-SUB ASC-ITEM-SUB) 24750000
247510                     WHEN '19'                                    24751018
247520                         MOVE DK-3WD-DESC    TO ASC-LOAD-STATUS   24752018
247530                                       (ASC-BLK-SUB ASC-ITEM-SUB) 24753018
247600                 END-EVALUATE                                     24760000
247700                 IF PC046-BEGIN-DIVERT                            24770000
247800                     MOVE 'DVT BEG' TO ASC-LOAD-STATUS            24780000
247900                                      (ASC-BLK-SUB ASC-ITEM-SUB)  24790000
248000                 ELSE                                             24800000
248100                     IF PC046-END-DIVERT                          24810000
248200                          MOVE 'DVT END' TO ASC-LOAD-STATUS       24820000
248300                                      (ASC-BLK-SUB ASC-ITEM-SUB)  24830000
248400                     END-IF                                       24840000
248500                 END-IF                                           24850000
248600                 MOVE PC046-OTBD-TRIP-ID                          24860000
248700                      TO ASC-TRIP-ID-N (ASC-BLK-SUB ASC-ITEM-SUB) 24870000
248800                                                                  24880000
248900             ELSE                                                 24890000
249000                 MOVE PC046-KOHLS-BARCODE                         24900000
249100                            TO ASC-SML (ASC-BLK-SUB ASC-ITEM-SUB) 24910000
249200             END-IF                                               24920000
249300         END-IF                                                   24930000
249400     END-PERFORM.                                                 24940000
249500                                                                  24950000
249600     IF  ASC-NUMBER-OF-ITEMS-READ > ZERO                          24960000
249700         MOVE +1               TO ASC-BLK-SUB                     24970000
249800         PERFORM 5100-WRITE-TEMP-STORAGE                          24980000
249900         ADD +1                TO ASC-BLK-SUB                     24990000
250000         PERFORM 5100-WRITE-TEMP-STORAGE                          25000000
250100                                                                  25010000
250200         MOVE 1                TO ASC-BLK-SUB                     25020000
250300                                  PV-BLOCK-NUMBER                 25030000
250400         PERFORM 4410-READ-TEMP-STORAGE                           25040000
250500         IF  ASC-HIGHEST-BLOCK-WRITTEN GREATER THAN 1             25050000
250600             MOVE 2            TO ASC-BLK-SUB                     25060000
250700                                  PV-BLOCK-NUMBER                 25070000
250800             PERFORM 4410-READ-TEMP-STORAGE                       25080000
250900         END-IF                                                   25090000
251000     END-IF.                                                      25100000
251100                                                                  25110000
251200*----------------------------------------------------------------*25120000
251300*    FETCH THE CURSOR                                             25130000
251400*----------------------------------------------------------------*25140000
251500 4121-FETCH-MSTR.                                                 25150000
251600                                                                  25160000
252000     INITIALIZE PC046-COMMAREA-REC.                               25200000
252100                                                                  25210000
252200     EXEC SQL                                                     25220000
252300         FETCH DISOLVED-MSTR-CSR                                  25230000
252400         INTO  :SUT00099-CHLD-SHIPT-UNT-ID                        25240000
252500            ,  :SUT00024-DEST-LOC-NBR                             25250000
252600     END-EXEC.                                                    25260000
252700                                                                  25270000
252800     EVALUATE TRUE                                                25280000
252900         WHEN SQLCODE = ZEROS                                     25290000
253000              MOVE SUT00099-CHLD-SHIPT-UNT-ID TO PC046-CARTON-ID  25300000
253100              MOVE SUT00024-DEST-LOC-NBR TO ASC-DEST-OPER-UNT-ID  25310000
253200                                                                  25320000
253300         WHEN SQLCODE = +100                                      25330000
253400             SET ASC-NO-ITEMS-LEFT-ON-DB TO TRUE                  25340000
253500                                                                  25350000
253600         WHEN SQLCODE = -904                                      25360000
253700         WHEN SQLCODE = -911                                      25370000
253800         WHEN SQLCODE = -913                                      25380000
253900              INITIALIZE DP013-MESSAGE-TEXT (1)                   25390000
254000              MOVE '4121-FETCH-MSTR'    TO DP013-PARAGRAPH        25400000
254100              MOVE 'PROBLEM FETCHING CURSOR'                      25410000
254200                                        TO DP013-MESSAGE-TEXT (1) 25420000
254300              MOVE SQLCA       TO DP013-SQLCA                     25430000
254400              MOVE 'SUT00098'   TO DP013-DB2-TABLE-NAME (1)       25440000
254500              MOVE 'SUT00099'   TO DP013-DB2-TABLE-NAME (2)       25450000
254600              SET DP013-DB2-ABEND TO TRUE                         25460000
254700              PERFORM DP013-0000-PROCESS-ABEND                    25470000
254800               SET  PS-ERROR                                      25480000
254900                    DP020-MSG-FATAL TO TRUE                       25490000
255000              MOVE PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          25500000
255100                                                                  25510000
255200         WHEN OTHER                                               25520000
255300              INITIALIZE DP013-MESSAGE-TEXT (1)                   25530000
255400              MOVE '4121-FETCH-MSTR'    TO DP013-PARAGRAPH        25540000
255500              MOVE 'PROBLEM FETCH CURSOR'                         25550000
255600                                        TO DP013-MESSAGE-TEXT (1) 25560000
255700              MOVE SQLCA       TO DP013-SQLCA                     25570000
255800              MOVE 'SUT00098'   TO DP013-DB2-TABLE-NAME (1)       25580000
255900              MOVE 'SUT00099'   TO DP013-DB2-TABLE-NAME (2)       25590000
256000              SET DP013-DB2-ABEND TO TRUE                         25600000
256100              PERFORM DP013-0000-PROCESS-ABEND                    25610000
256200              SET  PS-ERROR                                       25620000
256300                   DP020-MSG-FATAL TO TRUE                        25630000
256400              MOVE PC-TSYMSG-00551  TO  DP020-MSG-NUMBER          25640000
256500     END-EVALUATE.                                                25650000
256600                                                                  25660000
256700                                                                  25670000
257100*----------------------------------------------------------------*25710000
257200* CLOSE THE CURSOR.                                               25720000
257300*----------------------------------------------------------------*25730000
257400 4130-CLOSE-MSTR-CSR.                                             25740000
257500                                                                  25750000
257600     EXEC SQL                                                     25760000
257700          CLOSE DISOLVED-MSTR-CSR                                 25770000
257800     END-EXEC.                                                    25780000
257900                                                                  25790000
258000     EVALUATE TRUE                                                25800000
258100         WHEN SQLCODE = ZERO                                      25810000
258200         WHEN SQLCODE = +100                                      25820000
258300             CONTINUE                                             25830000
258400         WHEN SQLWARN0 NOT = SPACES                               25840000
258500         WHEN SQLCODE < ZERO                                      25850000
258600         WHEN SQLCODE > ZERO                                      25860000
258700             MOVE '4130-CLOSE-MSTR-CSR' TO DP013-PARAGRAPH        25870000
258800             MOVE 'CLOSE CURSOR PROBLEM   '                       25880000
258900                               TO DP013-MESSAGE-TEXT (1)          25890000
259000             MOVE SQLCA        TO DP013-SQLCA                     25900000
259100             MOVE 'SUT00098'   TO DP013-DB2-TABLE-NAME (1)        25910000
259200             MOVE 'SUT00099'   TO DP013-DB2-TABLE-NAME (2)        25920000
259300             SET DP013-DB2-ABEND                                  25930000
259400                 DP013-XCTL-DISPLAY-RESTART TO TRUE               25940000
259500             PERFORM DP013-0000-PROCESS-ABEND                     25950000
259600     END-EVALUATE.                                                25960000
259700                                                                  25970000
259800*----------------------------------------------------------------*25980000
259900*    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE    *25990000
260000*    BLOCKS IN THE ARRAY.  WHENEVER BOTH BLOCKS BECOME FULL,     *26000000
260100*    WRITE OUT THE 1ST BLOCK TO TEMPORARY STORAGE, MOVE THE 2ND  *26010000
260200*    BLOCK IN THE ARRAY TO THE 1ST BLOCK, AND INITIALIZE THE     *26020000
260300*    2ND BLOCK MAKING IT AVAILABLE TO BE USED.                   *26030000
260400*                                                                *26040000
260500*    DUE TO THE SIZE OF THE TABLE, AND THE ORDER IN WHICH THE    *26050000
260600*    ROWS ARE SORTED, THE ENTIRE TABLE IS READ INTO THE PROGRAM  *26060000
260700*    UPON INITIALIZATION.                                        *26070000
260800*----------------------------------------------------------------*26080000
260900 4300-READ-ITEMS-FROM-DB.                                         26090000
261000                                                                  26100000
261100     PERFORM                                                      26110000
261200         VARYING PV-READ-COUNT                                    26120000
261300         FROM 1 BY 1                                              26130000
261400         UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                    26140000
261500            OR (ASC-NO-ITEMS-LEFT-ON-DB))                         26150000
261600                                                                  26160000
261700         PERFORM 4310-FETCH                                       26170000
261800                                                                  26180000
261900         IF  ASC-ITEMS-LEFT-ON-DB                                 26190000
262000             IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                26200000
262100                 ADD +1            TO ASC-ITEM-SUB                26210000
262200             ELSE                                                 26220000
262300                 ADD +1            TO ASC-BLK-SUB                 26230000
262400                 MOVE +1           TO ASC-ITEM-SUB                26240000
262500                                                                  26250000
262600                 IF  ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY         26260000
262700                     MOVE +1       TO ASC-BLK-SUB                 26270000
262800                     SET ASC-BLOCK-MODIFIED (1) TO TRUE           26280000
262900                     PERFORM 5100-WRITE-TEMP-STORAGE              26290000
263000                     MOVE ASC-BLOCK-ENTRIES                       26300000
263100                                   (PC-MAX-BLOCKS-IN-ARRAY)       26310000
263200                                TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB) 26320000
263300                     ADD +1        TO ASC-BLK-SUB                 26330000
263400                     INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)   26340000
263500                     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)      26350000
263600                                                          TO TRUE 26360000
263700                 END-IF                                           26370000
263800             END-IF                                               26380000
263900             ADD +1                TO ASC-NUMBER-OF-ITEMS-READ    26390000
264000             SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB) TO TRUE          26400000
264100             MOVE ASC-NUMBER-OF-ITEMS-READ                        26410000
264200                                   TO ASC-LIST-ITEM-NUMBER        26420000
264300                                      (ASC-BLK-SUB ASC-ITEM-SUB)  26430000
264400             MOVE SPACES TO ASC-ACTION                            26440000
264500                                      (ASC-BLK-SUB ASC-ITEM-SUB)  26450000
264600             PERFORM 4350-CARTON-INFO                             26460000
264630             MOVE SUT00028-SHIPT-UNT-ID                           26463004
264640                                       TO  SUT00121-SHIPT-UNT-ID  26464004
264650             PERFORM 4370-GET-STORE-SCAN-CDE                      26465004
264670                                                                  26467017
264700             IF PS-NO-ERROR                                       26470000
264800                 MOVE PC046-KOHLS-BARCODE                         26480000
264900                            TO ASC-SML (ASC-BLK-SUB ASC-ITEM-SUB) 26490000
265000                 MOVE PC046-DEST-OPER-UNT-ID TO                   26500000
265100                          ASC-DEST-NBR (ASC-BLK-SUB ASC-ITEM-SUB) 26510000
265200                          DK-STR-BEGIN                            26520000
265300                          DK-STR-END                              26530000
265400                 MOVE PC046-SHPUNT-SRC-ID                         26540000
265500                         TO ASC-CREATE (ASC-BLK-SUB ASC-ITEM-SUB) 26550000
265600                 MOVE PC046-CRTN-STAT-TMST   TO PV-TMST           26560000
265700                 PERFORM 4300A-FORMAT-DATE-TIME                   26570000
265800                 STRING PV-USA-DATE(1:6) PV-USA-DATE(9:2)         26580000
265900                     DELIMITED BY SIZE                            26590000
266000                    INTO ASC-STAT-DATE (ASC-BLK-SUB ASC-ITEM-SUB) 26600000
266100                 MOVE PV-JIS-TIME                                 26610000
266200                      TO ASC-STAT-TIME (ASC-BLK-SUB ASC-ITEM-SUB) 26620000
266300                 MOVE PC046-VENDOR-SHIPT-UNT-ID  TO               26630000
266400                                                DK-SHIPT-UNT-ID   26640000
266500                 MOVE ZEROES TO PV-SHPD-QTY                       26650000
266600                 PERFORM 4360-GET-SHPD-QTY                        26660000
266700                 MOVE PV-SHPD-QTY                                 26670000
266800                    TO ASC-UNTS-MNFSTD (ASC-BLK-SUB ASC-ITEM-SUB) 26680000
266900                 ADD PV-SHPD-QTY TO ASC-UNTS-MNFD                 26690000
267000                 EVALUATE PC046-CRTN-STATUS                       26700000
267100                     WHEN '01'                                    26710000
267200                         MOVE DK-INVALID-DESC TO ASC-LOAD-STATUS  26720000
267300                                       (ASC-BLK-SUB ASC-ITEM-SUB) 26730000
267400                     WHEN '02'                                    26740000
267500                         MOVE DK-INACT-DESC  TO ASC-LOAD-STATUS   26750000
267600                                       (ASC-BLK-SUB ASC-ITEM-SUB) 26760000
267700                     WHEN '03'                                    26770000
267800                         MOVE DK-SC-OF-DESC  TO ASC-LOAD-STATUS   26780000
267900                                       (ASC-BLK-SUB ASC-ITEM-SUB) 26790000
268000                     WHEN '04'                                    26800000
268100                         MOVE DK-SC-ON-DESC  TO ASC-LOAD-STATUS   26810000
268200                                       (ASC-BLK-SUB ASC-ITEM-SUB) 26820000
268300                     WHEN '05'                                    26830000
268400                         PERFORM 4305-CHECK-ASSUMED               26840000
268500                         IF PS-DIVERTED                           26850000
268600                             MOVE DK-DVRT-DESC TO ASC-LOAD-STATUS 26860000
268700                                       (ASC-BLK-SUB ASC-ITEM-SUB) 26870000
268800                         ELSE                                     26880000
268900                             MOVE DK-ASSUM-DESC TO ASC-LOAD-STATUS26890000
269000                                       (ASC-BLK-SUB ASC-ITEM-SUB) 26900000
269100                         END-IF                                   26910000
269200                     WHEN '06'                                    26920000
269300                         MOVE DK-LOADED-DESC TO ASC-LOAD-STATUS   26930000
269400                                       (ASC-BLK-SUB ASC-ITEM-SUB) 26940000
269500                     WHEN '07'                                    26950000
269600                         MOVE DK-CSEPK-DESC  TO ASC-LOAD-STATUS   26960000
269700                                       (ASC-BLK-SUB ASC-ITEM-SUB) 26970000
269800                     WHEN '08'                                    26980000
269900                         MOVE DK-CK-IN-DESC  TO ASC-LOAD-STATUS   26990000
270000                                       (ASC-BLK-SUB ASC-ITEM-SUB) 27000000
270100                     WHEN '09'                                    27010000
270200                         MOVE DK-P2L-DESC    TO ASC-LOAD-STATUS   27020000
270300                                       (ASC-BLK-SUB ASC-ITEM-SUB) 27030000
270400                     WHEN '10'                                    27040000
270500                         MOVE DK-RDM-DESC    TO ASC-LOAD-STATUS   27050000
270600                                       (ASC-BLK-SUB ASC-ITEM-SUB) 27060000
270700                     WHEN '11'                                    27070000
270800                         MOVE DK-RECV-DESC   TO ASC-LOAD-STATUS   27080000
270900                                       (ASC-BLK-SUB ASC-ITEM-SUB) 27090000
271000                     WHEN '12'                                    27100000
271100                         MOVE DK-ASN-DESC    TO ASC-LOAD-STATUS   27110000
271200                                       (ASC-BLK-SUB ASC-ITEM-SUB) 27120000
271300                     WHEN '13'                                    27130000
271400                         MOVE DK-SMTH-DESC   TO ASC-LOAD-STATUS   27140000
271500                                       (ASC-BLK-SUB ASC-ITEM-SUB) 27150000
271600                     WHEN '14'                                    27160000
271700                         MOVE DK-XFER-DESC   TO ASC-LOAD-STATUS   27170000
271800                                       (ASC-BLK-SUB ASC-ITEM-SUB) 27180000
271900                     WHEN '15'                                    27190000
272000                         MOVE DK-MSTR-DESC   TO ASC-LOAD-STATUS   27200000
272100                                       (ASC-BLK-SUB ASC-ITEM-SUB) 27210000
272200                     WHEN '16'                                    27220000
272300                         MOVE DK-BLD-DESC    TO ASC-LOAD-STATUS   27230000
272400                                       (ASC-BLK-SUB ASC-ITEM-SUB) 27240000
272500                     WHEN '17'                                    27250000
272600                         MOVE 'JEWELRY'      TO ASC-LOAD-STATUS   27260000
272700                                       (ASC-BLK-SUB ASC-ITEM-SUB) 27270000
272800                     WHEN '18'                                    27280000
272900                         MOVE 'DAMAGED'      TO ASC-LOAD-STATUS   27290000
273000                                       (ASC-BLK-SUB ASC-ITEM-SUB) 27300000
273010                     WHEN '19'                                    27301018
273020                         MOVE DK-3WD-DESC    TO ASC-LOAD-STATUS   27302018
273030                                       (ASC-BLK-SUB ASC-ITEM-SUB) 27303018
273100                 END-EVALUATE                                     27310000
273200                 IF PC046-BEGIN-DIVERT                            27320000
273300                     MOVE 'DVT BEG' TO ASC-LOAD-STATUS            27330000
273400                                      (ASC-BLK-SUB ASC-ITEM-SUB)  27340000
273500                 ELSE                                             27350000
273600                     IF PC046-END-DIVERT                          27360000
273700                          MOVE 'DVT END' TO ASC-LOAD-STATUS       27370000
273800                                      (ASC-BLK-SUB ASC-ITEM-SUB)  27380000
273900                     END-IF                                       27390000
274000                 END-IF                                           27400000
274100                 MOVE PC046-OTBD-TRIP-ID                          27410000
274200                      TO ASC-TRIP-ID-N (ASC-BLK-SUB ASC-ITEM-SUB) 27420000
274300                                                                  27430000
274400             ELSE                                                 27440000
274500                 MOVE PC046-KOHLS-BARCODE                         27450000
274600                            TO ASC-SML (ASC-BLK-SUB ASC-ITEM-SUB) 27460000
274700             END-IF                                               27470000
274800         END-IF                                                   27480000
274900     END-PERFORM.                                                 27490000
275000                                                                  27500000
275100     IF  ASC-NUMBER-OF-ITEMS-READ > ZERO                          27510000
275200         MOVE +1               TO ASC-BLK-SUB                     27520000
275300         PERFORM 5100-WRITE-TEMP-STORAGE                          27530000
275400         ADD +1                TO ASC-BLK-SUB                     27540000
275500         PERFORM 5100-WRITE-TEMP-STORAGE                          27550000
275600                                                                  27560000
275700         MOVE 1                TO ASC-BLK-SUB                     27570000
275800                                  PV-BLOCK-NUMBER                 27580000
275900         PERFORM 4410-READ-TEMP-STORAGE                           27590000
276000         IF  ASC-HIGHEST-BLOCK-WRITTEN GREATER THAN 1             27600000
276100             MOVE 2            TO ASC-BLK-SUB                     27610000
276200                                  PV-BLOCK-NUMBER                 27620000
276300             PERFORM 4410-READ-TEMP-STORAGE                       27630000
276400         END-IF                                                   27640000
276500     END-IF.                                                      27650000
276600                                                                  27660000
276700 4300A-FORMAT-DATE-TIME.                                          27670000
276800                                                                  27680000
276900     EXEC SQL                                                     27690000
277000     SELECT                                                       27700000
277100         CHAR(DATE(:PV-TMST),USA)                                 27710000
277200     ,   SUBSTR(CHAR(TIME(:PV-TMST),JIS),1,5)                     27720000
277300     INTO                                                         27730000
277400         :PV-USA-DATE                                             27740000
277500     ,   :PV-JIS-TIME                                             27750000
277600     FROM SYSIBM.SYSDUMMY1                                        27760000
277700     END-EXEC.                                                    27770000
277800                                                                  27780000
277900     EVALUATE TRUE                                                27790000
278000         WHEN SQLCODE = ZERO                                      27800000
278100             CONTINUE                                             27810000
278200         WHEN SQLWARN0 NOT = SPACE                                27820000
278300         WHEN SQLCODE NOT = ZERO                                  27830000
278400              MOVE '4300A-FORMAT-DATE-TIME'  TO DP013-PARAGRAPH   27840000
278500              MOVE 'FORMAT DATE AND TIME'                         27850000
278600                               TO DP013-MESSAGE-TEXT (1)          27860000
278700              MOVE SQLCA       TO DP013-SQLCA                     27870000
278800              MOVE 'SYSDUMMY1'   TO DP013-DB2-TABLE-NAME (1)      27880000
278900              SET DP013-DB2-ABEND TO TRUE                         27890000
279000              PERFORM DP013-0000-PROCESS-ABEND                    27900000
279100     END-EVALUATE.                                                27910000
279200                                                                  27920000
279300*----------------------------------------------------------------*27930000
279400*  CHECK IF DIVERTED CARTON IS ASSUMED TO BE ON A TRAILER         27940000
279500*----------------------------------------------------------------*27950000
279600 4305-CHECK-ASSUMED.                                              27960000
279700                                                                  27970000
279800      PERFORM 4305A-GET-DVRT-OPER-DOOR.                           27980000
279900                                                                  27990000
280000      IF  CNDCDR-DOOR-TYP-CDE  =  'SH'                            28000000
280100          PERFORM 4305B-GET-SHIP-TRIP                             28010000
280200      ELSE                                                        28020000
280300          IF  CNDCDR-DOOR-TYP-CDE  =  ('ST' OR 'DS')              28030000
280400              PERFORM 4305C-GET-SHUT-STOR-TRIP                    28040000
280500          ELSE                                                    28050000
280600              SET PS-DIVERTED TO TRUE                             28060000
280700          END-IF                                                  28070000
280800      END-IF.                                                     28080000
280900                                                                  28090000
281000      IF  SUOBTR-OTBND-TRIP-ID  >  0                              28100000
281100          PERFORM 4305D-GET-BEG-DIVERT                            28110000
281200      ELSE                                                        28120000
281300          SET PS-DIVERTED TO TRUE                                 28130000
281400      END-IF.                                                     28140000
281500                                                                  28150000
281600*---------------------------------------------------------------* 28160000
281700*  GET THE OPER UNIT AND DIVERTED DOOR INFORMATION              * 28170000
281800*---------------------------------------------------------------* 28180000
281900 4305A-GET-DVRT-OPER-DOOR.                                        28190000
282000                                                                  28200000
282100     EXEC SQL                                                     28210000
282200          SELECT A.OPER_UNT_ID                                    28220000
282300               , A.DOOR_ID                                        28230000
282400               , A.DEST_OPER_UNT_ID                               28240000
282500               , C.DOOR_TYP_CDE                                   28250000
282600            INTO :SUCRDV-OPER-UNT-ID                              28260000
282700               , :SUCRDV-DOOR-ID                                  28270000
282800               , :SUCRDV-DEST-OPER-UNT-ID                         28280000
282900               , :CNDCDR-DOOR-TYP-CDE                             28290000
283000            FROM TSUCRDV A                                        28300000
283100               , TCNDCDR C                                        28310000
283200           WHERE A.SHIPT_UNT_ID  = :SUT00028-SHIPT-UNT-ID         28320000
283300             AND A.ACTV_CDE      =  'A'                           28330000
283400             AND A.OPER_UNT_ID   =  C.OPER_UNT_ID                 28340000
283500             AND A.DIVERT_NBR    =  C.DIVERT_NBR                  28350000
283600             AND A.DIVERT_LOC_ID =  C.DIVERT_LOC_ID               28360000
283700             AND A.DOOR_ID       =  C.DOOR_ID                     28370000
283800             AND A.DIVERT_TMST  IN                                28380000
283900                 (SELECT MAX(B.DIVERT_TMST)                       28390000
284000                    FROM TSUCRDV B                                28400000
284100                   WHERE B.SHIPT_UNT_ID  = :SUT00028-SHIPT-UNT-ID 28410000
284200                     AND B.ACTV_CDE      = 'A')                   28420000
284300     END-EXEC.                                                    28430000
284400                                                                  28440000
284500     EVALUATE TRUE                                                28450000
284600         WHEN SQLCODE = ZEROS                                     28460000
284700              CONTINUE                                            28470000
284800         WHEN SQLCODE = +100                                      28480000
284900             SET PS-DIVERTED TO TRUE                              28490000
285000         WHEN SQLCODE = -904                                      28500000
285100         WHEN SQLCODE = -911                                      28510000
285200         WHEN SQLCODE = -913                                      28520000
285300              INITIALIZE DP013-MESSAGE-TEXT (1)                   28530000
285400              MOVE '4305A-GET-DVRT-OPER'   TO DP013-PARAGRAPH     28540000
285500              MOVE 'ERROR FINDING DIVERT OPER/DOOR'               28550000
285600                                        TO DP013-MESSAGE-TEXT (1) 28560000
285700              STRING  ' CARTON='                                  28570000
285800                      PC046-CARTON-ID      DELIMITED BY SIZE      28580000
285900                                      INTO DP013-MESSAGE-TEXT (2) 28590000
286000              MOVE SQLCA       TO DP013-SQLCA                     28600000
286100              MOVE 'TSUCRDV '   TO DP013-DB2-TABLE-NAME (1)       28610000
286200              MOVE 'TCNDCDR '   TO DP013-DB2-TABLE-NAME (2)       28620000
286300              SET DP013-DB2-ABEND TO TRUE                         28630000
286400              PERFORM DP013-0000-PROCESS-ABEND                    28640000
286500               SET  PS-ERROR                                      28650000
286600                    DP020-MSG-FATAL TO TRUE                       28660000
286700              MOVE PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          28670000
286800                                                                  28680000
286900         WHEN OTHER                                               28690000
287000              INITIALIZE DP013-MESSAGE-TEXT (1)                   28700000
287100              MOVE '4305A-GET-DVRT-OPER'   TO DP013-PARAGRAPH     28710000
287200              MOVE 'ERROR FINDING DIVERT OPER/DOOR'               28720000
287300                                        TO DP013-MESSAGE-TEXT (1) 28730000
287400              STRING  ' CARTON='                                  28740000
287500                      PC046-CARTON-ID      DELIMITED BY SIZE      28750000
287600                                      INTO DP013-MESSAGE-TEXT (2) 28760000
287700              MOVE SQLCA       TO DP013-SQLCA                     28770000
287800              MOVE 'TSUCRDV '   TO DP013-DB2-TABLE-NAME (1)       28780000
287900              MOVE 'TCNDCDR '   TO DP013-DB2-TABLE-NAME (2)       28790000
288000              SET DP013-DB2-ABEND TO TRUE                         28800000
288100              PERFORM DP013-0000-PROCESS-ABEND                    28810000
288200              SET  PS-ERROR                                       28820000
288300                   DP020-MSG-FATAL TO TRUE                        28830000
288400              MOVE PC-TSYMSG-00551  TO  DP020-MSG-NUMBER          28840000
288500     END-EVALUATE.                                                28850000
288600                                                                  28860000
288700*---------------------------------------------------------------* 28870000
288800*  GET CURRENT OPEN TRIP AT SHIPPING DOOR FOR CARTON DESTINATION* 28880000
288900*---------------------------------------------------------------* 28890000
289000 4305B-GET-SHIP-TRIP.                                             28900000
289100     INITIALIZE DCLTSUOBTR.                                       28910000
289200                                                                  28920000
289300     EXEC SQL                                                     28930000
289400          SELECT A.OTBND_TRIP_ID                                  28940000
289500            INTO :SUOBTR-OTBND-TRIP-ID                            28950000
289600            FROM TSUOBTR A                                        28960000
289700               , TSUOBTS B                                        28970000
289800           WHERE A.DEST_OPER_UNT_ID  = :SUCRDV-DEST-OPER-UNT-ID   28980000
289900             AND A.ORGN_OPER_UNT_ID  = :SUCRDV-OPER-UNT-ID        28990000
290000             AND A.DOOR_TYP_CDE      = 'SH'                       29000000
290100             AND A.OTBND_TRIP_ID     =  B.OTBND_TRIP_ID           29010000
290200             AND B.TRIP_STAT_CDE     = 'DO'                       29020000
290300             AND B.DOOR_ID           = :SUCRDV-DOOR-ID            29030000
290400             AND B.OTBND_STAT_TMST   IN                           29040000
290500                   (SELECT MAX(C.OTBND_STAT_TMST)                 29050000
290600                      FROM TSUOBTS C                              29060000
290700                     WHERE B.OTBND_TRIP_ID = C.OTBND_TRIP_ID)     29070000
290800     END-EXEC.                                                    29080000
290900                                                                  29090000
291000     EVALUATE TRUE                                                29100000
291100         WHEN SQLCODE = ZEROS                                     29110000
291200              CONTINUE                                            29120000
291300         WHEN SQLCODE = +100                                      29130000
291400             SET PS-DIVERTED TO TRUE                              29140000
291500         WHEN SQLCODE = -904                                      29150000
291600         WHEN SQLCODE = -911                                      29160000
291700         WHEN SQLCODE = -913                                      29170000
291800              INITIALIZE DP013-MESSAGE-TEXT (1)                   29180000
291900              MOVE '4305B-GET-SHIP-TRIP'   TO DP013-PARAGRAPH     29190000
292000              MOVE 'ERROR FINDING DIVERT OPER/DOOR'               29200000
292100                                        TO DP013-MESSAGE-TEXT (1) 29210000
292200              STRING  ' CARTON='                                  29220000
292300                      PC046-CARTON-ID      DELIMITED BY SIZE      29230000
292400                                      INTO DP013-MESSAGE-TEXT (2) 29240000
292500              MOVE SQLCA       TO DP013-SQLCA                     29250000
292600              MOVE 'TSUOBTR '   TO DP013-DB2-TABLE-NAME (1)       29260000
292700              MOVE 'TSUOBTS '   TO DP013-DB2-TABLE-NAME (2)       29270000
292800              SET DP013-DB2-ABEND TO TRUE                         29280000
292900              PERFORM DP013-0000-PROCESS-ABEND                    29290000
293000               SET  PS-ERROR                                      29300000
293100                    DP020-MSG-FATAL TO TRUE                       29310000
293200              MOVE PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          29320000
293300                                                                  29330000
293400         WHEN OTHER                                               29340000
293500              INITIALIZE DP013-MESSAGE-TEXT (1)                   29350000
293600              MOVE '4305B-GET-SHIP-TRIP'   TO DP013-PARAGRAPH     29360000
293700              MOVE 'ERROR FINDING DIVERT OPER/DOOR'               29370000
293800                                        TO DP013-MESSAGE-TEXT (1) 29380000
293900              STRING  ' CARTON='                                  29390000
294000                      PC046-CARTON-ID      DELIMITED BY SIZE      29400000
294100                                      INTO DP013-MESSAGE-TEXT (2) 29410000
294200              MOVE SQLCA       TO DP013-SQLCA                     29420000
294300              MOVE 'TSUOBTR '   TO DP013-DB2-TABLE-NAME (1)       29430000
294400              MOVE 'TSUOBTS '   TO DP013-DB2-TABLE-NAME (2)       29440000
294500              SET DP013-DB2-ABEND TO TRUE                         29450000
294600              PERFORM DP013-0000-PROCESS-ABEND                    29460000
294700              SET  PS-ERROR                                       29470000
294800                   DP020-MSG-FATAL TO TRUE                        29480000
294900              MOVE PC-TSYMSG-00551  TO  DP020-MSG-NUMBER          29490000
295000     END-EVALUATE.                                                29500000
295100                                                                  29510000
295200                                                                  29520000
295300*---------------------------------------------------------------* 29530000
295400*  GET CURRENT OPEN TRIP FOR SHUTTLE/STORAGE TRAILER            * 29540000
295500*---------------------------------------------------------------* 29550000
295600 4305C-GET-SHUT-STOR-TRIP.                                        29560000
295700     INITIALIZE DCLTSUOBTR.                                       29570000
295800                                                                  29580000
295900     EXEC SQL                                                     29590000
296000          SELECT A.OTBND_TRIP_ID                                  29600000
296100            INTO :SUOBTR-OTBND-TRIP-ID                            29610000
296200            FROM TSUOBTR A                                        29620000
296300               , TSUOBTS B                                        29630000
296400           WHERE A.ORGN_OPER_UNT_ID  = :SUCRDV-OPER-UNT-ID        29640000
296500             AND A.DOOR_TYP_CDE     <> 'SH'                       29650000
296600             AND A.OTBND_TRIP_ID     =  B.OTBND_TRIP_ID           29660000
296700             AND A.ORGN_OPER_UNT_ID  =  B.STAT_OPER_UNT_ID        29670000
296800             AND B.TRIP_STAT_CDE     = 'DO'                       29680000
296900             AND B.DOOR_ID           = :SUCRDV-DOOR-ID            29690000
297000             AND B.OTBND_STAT_TMST   IN                           29700000
297100                   (SELECT MAX(C.OTBND_STAT_TMST)                 29710000
297200                      FROM TSUOBTS C                              29720000
297300                     WHERE B.OTBND_TRIP_ID = C.OTBND_TRIP_ID)     29730000
297400     END-EXEC.                                                    29740000
297500                                                                  29750000
297600     EVALUATE TRUE                                                29760000
297700         WHEN SQLCODE = ZEROS                                     29770000
297800              CONTINUE                                            29780000
297900         WHEN SQLCODE = +100                                      29790000
298000             SET PS-DIVERTED TO TRUE                              29800000
298100         WHEN SQLCODE = -904                                      29810000
298200         WHEN SQLCODE = -911                                      29820000
298300         WHEN SQLCODE = -913                                      29830000
298400              INITIALIZE DP013-MESSAGE-TEXT (1)                   29840000
298500              MOVE '4305C-GET-SHUT-STOR'   TO DP013-PARAGRAPH     29850000
298600              MOVE 'ERROR FINDING DIVERT OPER/DOOR'               29860000
298700                                        TO DP013-MESSAGE-TEXT (1) 29870000
298800              STRING  ' CARTON='                                  29880000
298900                      PC046-CARTON-ID      DELIMITED BY SIZE      29890000
299000                                      INTO DP013-MESSAGE-TEXT (2) 29900000
299100              MOVE SQLCA       TO DP013-SQLCA                     29910000
299200              MOVE 'TSUOBTR '   TO DP013-DB2-TABLE-NAME (1)       29920000
299300              MOVE 'TSUOBTS '   TO DP013-DB2-TABLE-NAME (2)       29930000
299400              SET DP013-DB2-ABEND TO TRUE                         29940000
299500              PERFORM DP013-0000-PROCESS-ABEND                    29950000
299600               SET  PS-ERROR                                      29960000
299700                    DP020-MSG-FATAL TO TRUE                       29970000
299800              MOVE PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          29980000
299900                                                                  29990000
300000         WHEN OTHER                                               30000000
300100              INITIALIZE DP013-MESSAGE-TEXT (1)                   30010000
300200              MOVE '4305C-GET-SHUT-STOR'   TO DP013-PARAGRAPH     30020000
300300              MOVE 'ERROR FINDING DIVERT OPER/DOOR'               30030000
300400                                        TO DP013-MESSAGE-TEXT (1) 30040000
300500              STRING  ' CARTON='                                  30050000
300600                      PC046-CARTON-ID      DELIMITED BY SIZE      30060000
300700                                      INTO DP013-MESSAGE-TEXT (2) 30070000
300800              MOVE SQLCA       TO DP013-SQLCA                     30080000
300900              MOVE 'TSUOBTR '   TO DP013-DB2-TABLE-NAME (1)       30090000
301000              MOVE 'TSUOBTS '   TO DP013-DB2-TABLE-NAME (2)       30100000
301100              SET DP013-DB2-ABEND TO TRUE                         30110000
301200              PERFORM DP013-0000-PROCESS-ABEND                    30120000
301300              SET  PS-ERROR                                       30130000
301400                   DP020-MSG-FATAL TO TRUE                        30140000
301500              MOVE PC-TSYMSG-00551  TO  DP020-MSG-NUMBER          30150000
301600     END-EVALUATE.                                                30160000
301700                                                                  30170000
301800                                                                  30180000
301900 4305D-GET-BEG-DIVERT.                                            30190000
302000                                                                  30200000
302100     EXEC SQL                                                     30210000
302200          SELECT A.STRT_DIVERT_TMST                               30220000
302300            INTO :SUCDOT-STRT-DIVERT-TMST                         30230000
302400            FROM TSUCDOT A                                        30240000
302500           WHERE A.OTBND_TRIP_ID     = :SUOBTR-OTBND-TRIP-ID      30250000
302600             AND A.END_DIVERT_TMST   = :PC-DEFAULT-TMST           30260000
302700     END-EXEC.                                                    30270000
302800                                                                  30280000
302900     EVALUATE TRUE                                                30290000
303000         WHEN SQLCODE = ZEROS                                     30300000
303100              IF  SUCDOT-STRT-DIVERT-TMST  <  PC046-CRTN-STAT-TMST30310000
303200                  SET PS-ASSUMED  TO TRUE                         30320000
303300                  MOVE SUOBTR-OTBND-TRIP-ID  TO PC046-OTBD-TRIP-ID30330000
303400              ELSE                                                30340000
303500                  SET PS-DIVERTED TO TRUE                         30350000
303600              END-IF                                              30360000
303700         WHEN SQLCODE = +100                                      30370000
303800             SET PS-DIVERTED TO TRUE                              30380000
303900         WHEN SQLCODE = -904                                      30390000
304000         WHEN SQLCODE = -911                                      30400000
304100         WHEN SQLCODE = -913                                      30410000
304200              INITIALIZE DP013-MESSAGE-TEXT (1)                   30420000
304300              MOVE '4305D-GET-BEG-DIVERT'  TO DP013-PARAGRAPH     30430000
304400              MOVE 'ERROR FINDING DIVERT BEGIN    '               30440000
304500                                        TO DP013-MESSAGE-TEXT (1) 30450000
304600              STRING  ' CARTON='                                  30460000
304700                       PC046-CARTON-ID     DELIMITED BY SIZE      30470000
304800                                      INTO DP013-MESSAGE-TEXT (2) 30480000
304900              MOVE SQLCA       TO DP013-SQLCA                     30490000
305000              MOVE 'TSUCDOT '   TO DP013-DB2-TABLE-NAME (1)       30500000
305100              SET DP013-DB2-ABEND TO TRUE                         30510000
305200              PERFORM DP013-0000-PROCESS-ABEND                    30520000
305300               SET  PS-ERROR                                      30530000
305400                    DP020-MSG-FATAL TO TRUE                       30540000
305500              MOVE PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          30550000
305600                                                                  30560000
305700         WHEN OTHER                                               30570000
305800              INITIALIZE DP013-MESSAGE-TEXT (1)                   30580000
305900              MOVE '4305D-GET-BEG-DIVERT'  TO DP013-PARAGRAPH     30590000
306000              MOVE 'ERROR FINDING DIVERT BEGIN    '               30600000
306100                                        TO DP013-MESSAGE-TEXT (1) 30610000
306200              STRING  ' CARTON='                                  30620000
306300                      PC046-CARTON-ID      DELIMITED BY SIZE      30630000
306400                                      INTO DP013-MESSAGE-TEXT (2) 30640000
306500              MOVE SQLCA       TO DP013-SQLCA                     30650000
306600              MOVE 'TSUCDOT '   TO DP013-DB2-TABLE-NAME (1)       30660000
306700              SET DP013-DB2-ABEND TO TRUE                         30670000
306800              PERFORM DP013-0000-PROCESS-ABEND                    30680000
306900              SET  PS-ERROR                                       30690000
307000                   DP020-MSG-FATAL TO TRUE                        30700000
307100              MOVE PC-TSYMSG-00551  TO  DP020-MSG-NUMBER          30710000
307200     END-EVALUATE.                                                30720000
307300                                                                  30730000
307400*----------------------------------------------------------------*30740000
307500*    FETCH THE CURSOR                                             30750000
307600*----------------------------------------------------------------*30760000
307700 4310-FETCH.                                                      30770000
307800                                                                  30780000
308200     INITIALIZE PC046-COMMAREA-REC.                               30820000
308300                                                                  30830000
308400     EXEC SQL                                                     30840000
308500         FETCH CARTON-CSR                                         30850000
308600         INTO  :SUT00028-SHIPT-UNT-ID                             30860000
308700            ,  :SUT00024-DEST-LOC-NBR                             30870000
308800     END-EXEC.                                                    30880000
308900                                                                  30890000
309000     EVALUATE TRUE                                                30900000
309100         WHEN SQLCODE = ZEROS                                     30910000
309200              MOVE SUT00028-SHIPT-UNT-ID TO PC046-CARTON-ID       30920000
309300              MOVE SUT00024-DEST-LOC-NBR TO ASC-DEST-OPER-UNT-ID  30930000
309400                                                                  30940000
309500         WHEN SQLCODE = +100                                      30950000
309600             SET ASC-NO-ITEMS-LEFT-ON-DB TO TRUE                  30960000
309700                                                                  30970000
309800         WHEN SQLCODE = -904                                      30980000
309900         WHEN SQLCODE = -911                                      30990000
310000         WHEN SQLCODE = -913                                      31000000
310100              INITIALIZE DP013-MESSAGE-TEXT (1)                   31010000
310200              MOVE '4310-FETCH'            TO DP013-PARAGRAPH     31020000
310300              MOVE 'PROBLEM FETCHING CURSOR'                      31030000
310400                                        TO DP013-MESSAGE-TEXT (1) 31040000
310500              MOVE SQLCA       TO DP013-SQLCA                     31050000
310600              MOVE 'SUT00028'   TO DP013-DB2-TABLE-NAME (1)       31060000
310700              MOVE 'SUT00024'   TO DP013-DB2-TABLE-NAME (2)       31070000
310800              MOVE 'SUT00026'   TO DP013-DB2-TABLE-NAME (3)       31080000
310900              SET DP013-DB2-ABEND TO TRUE                         31090000
311000              PERFORM DP013-0000-PROCESS-ABEND                    31100000
311100               SET  PS-ERROR                                      31110000
311200                    DP020-MSG-FATAL TO TRUE                       31120000
311300              MOVE PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          31130000
311400                                                                  31140000
311500         WHEN OTHER                                               31150000
311600              INITIALIZE DP013-MESSAGE-TEXT (1)                   31160000
311700              MOVE '4310-FETCH'            TO DP013-PARAGRAPH     31170000
311800              MOVE 'PROBLEM FETCH CURSOR'                         31180000
311900                                        TO DP013-MESSAGE-TEXT (1) 31190000
312000              MOVE SQLCA       TO DP013-SQLCA                     31200000
312100              MOVE 'SUT00028'   TO DP013-DB2-TABLE-NAME (1)       31210000
312200              MOVE 'SUT00024'   TO DP013-DB2-TABLE-NAME (2)       31220000
312300              MOVE 'SUT00026'   TO DP013-DB2-TABLE-NAME (3)       31230000
312400              SET DP013-DB2-ABEND TO TRUE                         31240000
312500              PERFORM DP013-0000-PROCESS-ABEND                    31250000
312600              SET  PS-ERROR                                       31260000
312700                   DP020-MSG-FATAL TO TRUE                        31270000
312800              MOVE PC-TSYMSG-00551  TO  DP020-MSG-NUMBER          31280000
312900     END-EVALUATE.                                                31290000
313000                                                                  31300000
313100                                                                  31310000
313500*----------------------------------------------------------------*31350000
313600* CALL PCKUT713 TO RETRIEVE CARTON INFORMATION                    31360014
313700*----------------------------------------------------------------*31370000
313800 4350-CARTON-INFO.                                                31380000
314000                                                                  31400000
314100     CALL PC046-CARTON-STATUS-MODULE                              31410000
314200             USING DFHEIBLK                                       31420000
314300             PC046-COMMAREA                                       31430000
314400             PC046-COMMAREA-REC                                   31440000
314500     END-CALL.                                                    31450000
314600                                                                  31460000
314700     PERFORM 4355-VALIDATE-STATUS-CALL.                           31470000
314800                                                                  31480000
314900*----------------------------------------------------------------*31490000
315000* CHECK RETURN CODE FROM CRTN STATUS PROGRAM TO SEE IF SUCCESSFUL*31500000
315100*----------------------------------------------------------------*31510000
315200 4355-VALIDATE-STATUS-CALL.                                       31520000
315300                                                                  31530000
315400     IF  PC046-SUCCESSFUL  OR                                     31540000
315600         PC046-CRTN-STAT-ERROR                                    31560000
315800         SET PS-NO-ERROR   TO  TRUE                               31580000
315900     ELSE                                                         31590000
316000         SET  PS-ERROR     TO  TRUE                               31600000
316100     END-IF.                                                      31610000
316200                                                                  31620000
316300*----------------------------------------------------------------*31630000
316400* GET TOTAL MANIFESTED UNIT QTY FROM SUT_OTBND_UPC                31640000
316500*----------------------------------------------------------------*31650000
316600 4360-GET-SHPD-QTY.                                               31660000
316700     EXEC SQL                                                     31670000
316800          SELECT  SUM(A.SHPD_UNT_QTY)                             31680000
316900            INTO  :PV-SHPD-QTY                                    31690000
317000            FROM  SUT_OTBND_UPC A                                 31700000
317100                 ,SUT_OTBND_CART B                                31710000
317200           WHERE  A.SHIPT_UNT_ID      = :SUT00028-SHIPT-UNT-ID    31720000
317300             AND  A.SHIPT_UNT_ID      = B.SHIPT_UNT_ID            31730000
317400             AND  B.ACTV_IND          = 'Y'                       31740000
317500     END-EXEC                                                     31750000
317600                                                                  31760000
317700     EVALUATE TRUE                                                31770000
317800         WHEN SQLCODE = ZERO                                      31780000
317900             CONTINUE                                             31790000
318000         WHEN SQLCODE = -305                                      31800000
318100             MOVE 0    TO PV-SHPD-QTY                             31810000
318200         WHEN SQLWARN0 NOT = SPACES                               31820000
318300         WHEN SQLCODE < ZERO                                      31830000
318400         WHEN SQLCODE > ZERO                                      31840000
318500             MOVE '4360-GET-SHPD-QTY' TO DP013-PARAGRAPH          31850000
318600             MOVE 'OPEN CURSOR PROBLEM   '                        31860000
318700                               TO DP013-MESSAGE-TEXT (1)          31870000
318800             MOVE SQLCA        TO DP013-SQLCA                     31880000
318900             MOVE 'SUT00028'   TO DP013-DB2-TABLE-NAME (1)        31890000
319000             MOVE 'SUT00024'   TO DP013-DB2-TABLE-NAME (2)        31900000
319100             SET DP013-DB2-ABEND                                  31910000
319200                 DP013-XCTL-DISPLAY-RESTART TO TRUE               31920000
319300             PERFORM DP013-0000-PROCESS-ABEND                     31930000
319400     END-EVALUATE.                                                31940000
319500                                                                  31950000
319510*----------------------------------------------------------------*31951003
319520* CHECK TO SEE IF CARTON HAS BEEN SCAN BASED RECEIVE AT A STORE   31952003
319530* DMH 10/03/17                                                    31953003
319540*----------------------------------------------------------------*31954003
319550 4370-GET-STORE-SCAN-CDE.                                         31955003
319560                                                                  31956003
319591     EXEC SQL                                                     31959103
319592          SELECT SCN_TYP_CDE                                      31959203
319593          INTO  :SUT00121-SCN-TYP-CDE                             31959303
319594           FROM  SUT_OTBND_STR_SCN A                              31959403
319595          WHERE A.SHIPT_UNT_ID = :SUT00121-SHIPT-UNT-ID           31959503
319596            AND A.CRE_TMST IN                                     31959603
319597                (SELECT MAX(B.CRE_TMST)                           31959703
319598                   FROM SUT_OTBND_STR_SCN B                       31959803
319599                  WHERE A.SHIPT_UNT_ID  =  B.SHIPT_UNT_ID         31959903
319600                    AND NOT B.SCN_TYP_CDE  =  'SSMS'              31960011
319601                )                                                 31960103
319602     END-EXEC                                                     31960203
319603     EVALUATE TRUE                                                31960303
319604         WHEN SQLCODE = ZERO                                      31960403
319605             MOVE SUT00121-SCN-TYP-CDE                            31960503
319606               TO ASC-STR-SCAN (ASC-BLK-SUB ASC-ITEM-SUB)         31960603
319607             PERFORM 4375-CHECK-MULT-STR-SCAN                     31960711
319608         WHEN SQLCODE = +100                                      31960803
319609             MOVE SPACES                                          31960903
319610               TO ASC-STR-SCAN (ASC-BLK-SUB ASC-ITEM-SUB)         31961003
319611                  ASC-STR-MULT-SW (ASC-BLK-SUB ASC-ITEM-SUB)      31961111
319612         WHEN SQLWARN0 NOT = SPACE                                31961203
319613         WHEN SQLCODE NOT = ZERO                                  31961303
319614              MOVE '4370-GET-STORE-SCAN-CDE'                      31961403
319615                               TO DP013-PARAGRAPH                 31961503
319616              MOVE 'GET STORE SCAN CODE    '                      31961603
319617                               TO DP013-MESSAGE-TEXT (1)          31961703
319618              MOVE SQLCA       TO DP013-SQLCA                     31961803
319619              MOVE 'SUT00121'   TO DP013-DB2-TABLE-NAME (1)       31961903
319620              SET DP013-DB2-ABEND TO TRUE                         31962003
319621              PERFORM DP013-0000-PROCESS-ABEND                    31962103
319622     END-EVALUATE.                                                31962203
319623                                                                  31962303
319624                                                                  31962411
319625*----------------------------------------------------------------*31962511
319626* CHECK TO SEE IF CARTON HAS BEEN SCANNED MULTIPLE TIMES AT STR   31962611
319628*----------------------------------------------------------------*31962811
319629 4375-CHECK-MULT-STR-SCAN.                                        31962911
319631                                                                  31963111
319632     EXEC SQL                                                     31963211
319633          SELECT COUNT(*)                                         31963311
319634          INTO  :PV-STR-SCAN-COUNT                                31963411
319635           FROM  SUT_OTBND_STR_SCN                                31963511
319636          WHERE  SHIPT_UNT_ID = :SUT00121-SHIPT-UNT-ID            31963612
319643     END-EXEC                                                     31964311
319644     EVALUATE TRUE                                                31964411
319645         WHEN SQLCODE = ZERO                                      31964511
319646              IF  PV-STR-SCAN-COUNT  > 1                          31964611
319647                  MOVE 'M'                                        31964711
319648                  TO ASC-STR-MULT-SW (ASC-BLK-SUB ASC-ITEM-SUB)   31964811
319649              ELSE                                                31964911
319650                  MOVE SPACES                                     31965011
319651                  TO ASC-STR-MULT-SW (ASC-BLK-SUB ASC-ITEM-SUB)   31965111
319652              END-IF                                              31965211
319653         WHEN SQLCODE = +100                                      31965311
319656             MOVE SPACES                                          31965611
319657                  TO ASC-STR-MULT-SW (ASC-BLK-SUB ASC-ITEM-SUB)   31965711
319659         WHEN SQLWARN0 NOT = SPACE                                31965911
319660         WHEN SQLCODE NOT = ZERO                                  31966011
319661              MOVE '4375-CHECK-MULT-STR-SCAN'                     31966111
319662                               TO DP013-PARAGRAPH                 31966211
319663              MOVE 'CHECK MULTIPLE SCANS   '                      31966311
319664                               TO DP013-MESSAGE-TEXT (1)          31966411
319665              MOVE SQLCA       TO DP013-SQLCA                     31966511
319666              MOVE 'SUT00121'   TO DP013-DB2-TABLE-NAME (1)       31966611
319667              SET DP013-DB2-ABEND TO TRUE                         31966711
319668              PERFORM DP013-0000-PROCESS-ABEND                    31966811
319669     END-EVALUATE.                                                31966911
319670                                                                  31967011
319671                                                                  31967111
319680*----------------------------------------------------------------*31968003
319700* MOVE THE DISPLAYED FIELDS FROM THE COMMAREA TO THE SCREEN.     *31970000
319800*----------------------------------------------------------------*31980000
319900 4400-MOVE-COMMAREA-TO-SCREEN.                                    31990000
320000                                                                  32000000
320100     IF  (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1))             32010000
320200         AND (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1)))          32020000
320300         OR  (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)))          32030000
320400             MOVE +1    TO ASC-BLK-SUB                            32040000
320500             PERFORM 5100-WRITE-TEMP-STORAGE                      32050000
320600             ADD +1     TO ASC-BLK-SUB                            32060000
320700             PERFORM 5100-WRITE-TEMP-STORAGE                      32070000
320800             DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             32080000
320900                 GIVING PV-BLOCK-NUMBER                           32090000
321000                 REMAINDER PV-REMAINDER                           32100000
321100             IF  PV-REMAINDER > ZERO                              32110000
321200                 ADD +1 TO PV-BLOCK-NUMBER                        32120000
321300             END-IF                                               32130000
321400             MOVE +1    TO ASC-BLK-SUB                            32140000
321500             PERFORM 4410-READ-TEMP-STORAGE                       32150000
321600             ADD +1     TO ASC-BLK-SUB                            32160000
321700                           PV-BLOCK-NUMBER                        32170000
321800             PERFORM 4410-READ-TEMP-STORAGE                       32180000
321900     END-IF.                                                      32190000
322000     MOVE +1            TO ASC-BLK-SUB.                           32200000
322100     COMPUTE ASC-ITEM-SUB =                                       32210000
322200         ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              32220000
322300         + PC-ITEMS-PER-PANEL).                                   32230000
322400                                                                  32240017
322500     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        32250000
322600         ADD +1         TO ASC-BLK-SUB                            32260000
322700         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            32270000
322800     END-IF.                                                      32280000
322900                                                                  32290017
323000     COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           32300000
323100         ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                32310000
323200     PERFORM 4430-CHECK-FOR-BEGIN-AND-END.                        32320000
323300     PERFORM 4420-FORMAT-LIST-LINES                               32330000
323400         VARYING PV-SUB                                           32340000
323500         FROM PC-ITEMS-PER-PANEL BY -1                            32350000
323600         UNTIL PV-SUB < +1.                                       32360000
323700                                                                  32370017
323800     COMPUTE ASC-ITEMS-DISPLAYED =                                32380000
323900         ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).          32390000
324000     MOVE PV-TOP-ITEM              TO ASC-ITEM-AT-TOP-OF-PANEL    32400000
324100                                      ASTRTITO.                   32410000
324200     MOVE ASC-ITEM-AT-BOT-OF-PANEL TO AENDITO.                    32420000
324300     MOVE ASC-NUMBER-OF-ITEMS-READ TO ATOTITO.                    32430000
324400     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            32440000
324500                                   TO ASELITO.                    32450000
324600                                                                  32460000
324700     MOVE ASC-SML-NBR              TO AMASTERO.                   32470000
324800     MOVE ASC-DEST-OPER-UNT-ID     TO AOPERO.                     32480000
324900     MOVE ASC-MASTER-STAT-DESC     TO ASTATUSO.                   32490000
325000     MOVE ASC-NUMBER-OF-ITEMS-READ TO PV-TOT-CHILDREN.            32500000
325100     MOVE PV-TOT-CHILDREN          TO ATCHLDNO.                   32510000
325200     MOVE ASC-MASTER-STAT-DATE     TO ADTETMEO.                   32520000
325300     MOVE ASC-UNTS-MNFD            TO PV-TOT-UNITS.               32530000
325400     MOVE PV-TOT-UNITS             TO ATMANFSTO.                  32540000
325500                                                                  32550017
326800*----------------------------------------------------------------*32680000
326900* RETRIEVE NAME FROM LOCATION MODULE - XLKUT071.                  32690000
327000*----------------------------------------------------------------*32700000
327100     INITIALIZE XL071-COMMAREA-REC.                               32710000
327200     MOVE ASC-DEST-OPER-UNT-ID TO XL071-LOCATION-NUMBER.          32720000
327300                                                                  32730000
327400     CALL PC-LOCATION-MODULE  USING                               32740000
327500                                    DFHEIBLK                      32750000
327600                                    XL071-COMMAREA                32760000
327700                                    XL071-COMMAREA-REC.           32770000
327800                                                                  32780000
327900     EVALUATE TRUE                                                32790000
328000         WHEN XL071-NO-ERRORS                                     32800000
328100             MOVE XL071-LOC-NM           TO ASC-DEST-OPER-NAME    32810000
328200         WHEN OTHER                                               32820000
328300             MOVE 'STORE NAME NOT FOUND' TO ASC-DEST-OPER-NAME    32830000
328400     END-EVALUATE.                                                32840000
328500                                                                  32850000
328600     MOVE ASC-DEST-OPER-NAME         TO ANAMEO.                   32860000
328900                                                                  32890000
329000     IF  DP020-MSG-NUMBER-X = SPACE                               32900000
329100         IF  ASC-ITEM-AT-BOT-OF-PANEL < ASC-NUMBER-OF-ITEMS-READ  32910000
329200*            --- MORE ITEMS TO DISPLAY ----                       32920000
329300             MOVE PC-TSYMSG-00279  TO DP020-MSG-NUMBER            32930000
329400             SET DP020-MSG-INFORMATIONAL TO TRUE                  32940000
329500         END-IF                                                   32950000
329600     END-IF.                                                      32960000
329700                                                                  32970000
329800*----------------------------------------------------------------*32980000
329900*    READ A BLOCK FROM TEMPORARY STORAGE INTO THE ARRAY.         *32990000
330000*----------------------------------------------------------------*33000000
330100 4410-READ-TEMP-STORAGE.                                          33010000
330200                                                                  33020000
330300     EXEC CICS                                                    33030000
330400         READQ TS                                                 33040000
330500             QUEUE (ASC-LIST-QUEUE-NAME)                          33050000
330600             INTO  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               33060000
330700             ITEM  (PV-BLOCK-NUMBER)                              33070000
330800             RESP  (PV-CICS-RESP)                                 33080000
330900     END-EXEC.                                                    33090000
331000                                                                  33100000
331100     IF  ((PV-CICS-RESP = DFHRESP (NORMAL))                       33110000
331200       OR (PV-CICS-RESP = DFHRESP (ITEMERR)))                     33120000
331300         CONTINUE                                                 33130000
331400     ELSE                                                         33140000
331500         SET DP013-CICS-ABEND     TO TRUE                         33150000
331600         SET DP013-NO-ROLLBACK    TO TRUE                         33160000
331700         MOVE '4410-READ-TEMP-STORAGE'                            33170000
331800                                  TO DP013-PARAGRAPH              33180000
331900         MOVE 'ERROR TRYING TO READ FROM TEMP STORAGE QUEUE'      33190000
332000                                  TO DP013-MESSAGE-TEXT(1)        33200000
332100         PERFORM DP013-0000-PROCESS-ABEND                         33210000
332200     END-IF.                                                      33220000
332300                                                                  33230000
332400     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             33240000
332500                                                                  33250017
332600     IF  PV-CICS-RESP = DFHRESP (ITEMERR)                         33260000
332700         INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               33270000
332800     END-IF.                                                      33280000
332900                                                                  33290000
333000*----------------------------------------------------------------*33300000
333100*    PROCESS THE ITEMS IN THE ARRAY AND MOVE THEM TO THE MAP.    *33310000
333200*----------------------------------------------------------------*33320000
333300 4420-FORMAT-LIST-LINES.                                          33330000
333400                                                                  33340000
333500     IF  ASC-ITEM-AT-BOT-OF-PANEL > ASC-NUMBER-OF-ITEMS-READ      33350000
333600         SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                33360000
333700         MOVE DP015-ASK-DRK-OFF  TO MR-SELECTA (PV-SUB)           33370000
333800                                    MR-ACTIONA (PV-SUB)           33380000
333900         MOVE DP015-HL-OFF       TO MR-SELECTH (PV-SUB)           33390000
334000                                    MR-ACTIONH (PV-SUB)           33400000
334100         MOVE SPACE              TO MR-SELECTI (PV-SUB)           33410000
334200                                    MR-ACTION (PV-SUB)            33420000
334300                                    MR-SML (PV-SUB)               33430000
334400                                    MR-CREATE (PV-SUB)            33440000
334410                                    MR-STR-SCAN (PV-SUB)          33441006
334500                                    MR-STAT-DATE (PV-SUB)         33450000
334600                                    MR-STAT-TIME (PV-SUB)         33460000
334700                                    MR-LOAD-STATUS (PV-SUB)       33470000
334800                                    MR-TRIP-ID (PV-SUB)           33480000
334900                                    MR-UNTS-MNFSTD-X (PV-SUB)     33490000
335000         MOVE ZEROES            TO  MR-DEST-NBR (PV-SUB)          33500000
335100     ELSE                                                         33510000
335200         IF  ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      33520000
335300                                                   > SPACE        33530000
335400             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 33540000
335500                                 TO MR-SELECTI (PV-SUB)           33550000
335600         ELSE                                                     33560000
335700             MOVE ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      33570000
335800                                 TO MR-SELECTI (PV-SUB)           33580000
335900         END-IF                                                   33590000
336000         IF  DP030-SET-CURSOR-TRAILER                             33600000
336100             IF  ((ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)33610000
336200                 > SPACE)                                         33620000
336300               OR (PV-SUB = 1))                                   33630000
336400                SET DP030-SET-CURSOR-APPL-1 TO TRUE               33640000
336500                MOVE -1               TO MR-SELECTL (PV-SUB)      33650000
336600             END-IF                                               33660000
336700         END-IF                                                   33670000
336900                                                                  33690000
337000         MOVE ASC-ACTION (ASC-BLK-SUB ASC-ITEM-SUB)               33700000
337100                                            TO MR-ACTION (PV-SUB) 33710000
337200         MOVE ASC-SML (ASC-BLK-SUB ASC-ITEM-SUB)                  33720000
337300                                               TO MR-SML (PV-SUB) 33730000
337400         MOVE ASC-DEST-NBR (ASC-BLK-SUB ASC-ITEM-SUB)             33740000
337500                                          TO MR-DEST-NBR (PV-SUB) 33750000
337600         MOVE ASC-CREATE (ASC-BLK-SUB ASC-ITEM-SUB)               33760000
337700                                            TO MR-CREATE (PV-SUB) 33770000
337710         MOVE ASC-STR-SCAN (ASC-BLK-SUB ASC-ITEM-SUB)             33771005
337720                                         TO MR-STR-SCAN  (PV-SUB) 33772005
337721         IF  ASC-STR-MULT (ASC-BLK-SUB ASC-ITEM-SUB)              33772111
337722             MOVE  DP015-RED             TO MR-STR-SCANC (PV-SUB) 33772211
337723         END-IF                                                   33772311
337800         MOVE ASC-STAT-DATE (ASC-BLK-SUB ASC-ITEM-SUB)            33780000
337900                                         TO MR-STAT-DATE (PV-SUB) 33790000
338000         MOVE ASC-STAT-TIME (ASC-BLK-SUB ASC-ITEM-SUB)            33800000
338100                                         TO MR-STAT-TIME (PV-SUB) 33810000
338200         MOVE ASC-UNTS-MNFSTD (ASC-BLK-SUB ASC-ITEM-SUB)          33820000
338300                                       TO MR-UNTS-MNFSTD (PV-SUB) 33830000
338400         MOVE ASC-LOAD-STATUS (ASC-BLK-SUB ASC-ITEM-SUB)          33840000
338500                                       TO MR-LOAD-STATUS (PV-SUB) 33850000
338600         MOVE ASC-TRIP-ID (ASC-BLK-SUB ASC-ITEM-SUB)              33860000
338700                                           TO MR-TRIP-ID (PV-SUB) 33870000
338800     END-IF.                                                      33880000
338900     SUBTRACT +1 FROM ASC-ITEM-SUB                                33890000
339000     IF  ASC-ITEM-SUB < + 1                                       33900000
339100         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  33910000
339200         MOVE +1                 TO ASC-BLK-SUB                   33920000
339300     END-IF.                                                      33930000
339400                                                                  33940000
339500******************************************************************33950000
339600** IF A BEGINNING OF RANGE WAS SPECIFIED, MAKE SURE AN END OF   **33960000
339700** RANGE WAS SPECIFIED AND VICE-VERSA.  IF ONE IS MISSING,      **33970000
339800** ISSUE A WARNING.                                             **33980000
339900******************************************************************33990000
340000 4430-CHECK-FOR-BEGIN-AND-END.                                    34000000
340100                                                                  34010000
340200     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       34020000
340300         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     34030000
340400*            -- NO END-OF-RANGE SPECFIED ---                      34040000
340500             MOVE PC-TSYMSG-00051  TO DP020-MSG-NUMBER            34050000
340600             SET DP020-MSG-WARNING TO TRUE                        34060000
340700             PERFORM 4431-POSITION-AT-WARNING                     34070000
340800         END-IF                                                   34080000
340900     ELSE                                                         34090000
341000         IF  ASC-END-OF-SELECTED-RANGE > ZERO                     34100000
341100*            -- NO BEGINNING-OF-RANGE SPECFIED ---                34110000
341200             MOVE PC-TSYMSG-00053  TO DP020-MSG-NUMBER            34120000
341300             SET DP020-MSG-WARNING TO TRUE                        34130000
341400             PERFORM 4431-POSITION-AT-WARNING                     34140000
341500         END-IF                                                   34150000
341600     END-IF.                                                      34160000
341700******************************************************************34170000
341800** ONCE IT HAS BEEN DETERMINED THAT A WARNING IS TO BE ISSUED,  **34180000
341900** DETERMINE IF EITHER THE BEGINNING OF RANGE OR END OF RANGE   **34190000
342000** IS ON THE CURRENT SCREEN.  IF IT IS, HIGHLIGHT IT AND        **34200000
342100** POSITION THE CURSOR THERE.                                   **34210000
342200******************************************************************34220000
342300 4431-POSITION-AT-WARNING.                                        34230000
342400                                                                  34240000
342500     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 34250000
342600                    - PV-TOP-ITEM + 1.                            34260000
342700     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      34270000
342800         CONTINUE                                                 34280000
342900     ELSE                                                         34290000
343000         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      34300000
343100         MOVE -1                   TO MR-SELECTL (PV-SUB)         34310000
343200         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         34320000
343300         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         34330000
343400     END-IF.                                                      34340000
343500*                                                                 34350000
343600     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   34360000
343700                    - PV-TOP-ITEM + 1.                            34370000
343800     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      34380000
343900         CONTINUE                                                 34390000
344000     ELSE                                                         34400000
344100         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      34410000
344200         MOVE -1                   TO MR-SELECTL (PV-SUB)         34420000
344300         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         34430000
344400         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         34440000
344500     END-IF.                                                      34450000
344600                                                                  34460000
344700*----------------------------------------------------------------*34470000
344800* THIS PARAGRAPH READS THE LIST FROM THE QUEUE AND WRITE IT TO   *34480000
344900* THE TEMPORARY STORAGE.                                         *34490000
345000*----------------------------------------------------------------*34500000
345100 4600-PROCESS-REPORT-PRINT.                                       34510000
345200                                                                  34520000
345300       MOVE +1 TO ASC-BLK-SUB                                     34530000
345400       PERFORM 5100-WRITE-TEMP-STORAGE                            34540000
345500       ADD  +1 TO ASC-BLK-SUB                                     34550000
345600       PERFORM 5100-WRITE-TEMP-STORAGE                            34560000
345700       PERFORM 6112-READ-LIST-QUEUE                               34570000
345800                                                                  34580000
345900       INITIALIZE SU033-COMM-AREA                                 34590000
346000                  SU033-SELECTED-ITEM-ARRAY                       34600000
346100       MOVE ASC-OPER-UNT-ID     TO SU033-OPER-UNT-ID              34610000
346200       MOVE 1                   TO SU033-FCLTY-ID                 34620000
346300       MOVE DP020-USERID        TO SU033-USER-ID                  34630000
346400       MOVE ASC-PRTR            TO SU033-PRINTER-ID               34640000
346500       MOVE ASC-PRTR-AUTO-CUTTER-IND                              34650000
346600                                TO SU033-PRTR-AUTO-CUTTER-IND     34660000
346700       MOVE ASC-PRTR-PRTR-BRCDE-IND                               34670000
346800                                TO SU033-PRTR-PRTR-BRCDE-IND      34680000
346900       MOVE ASC-PRTR-PRTR-CNTL-IND                                34690000
347000                                TO SU033-PRTR-PRTR-CNTL-IND       34700000
347100       MOVE 10                  TO SU033-MAX-ITEMS                34710000
347200       SET SU033-CRTN-MFST-RPT  TO TRUE                           34720000
347300       SET SU033-PCKD-DETL-RPT-NO TO TRUE                         34730000
347400       SET SU033-USE-SEL-QUEUE    TO TRUE                         34740000
347500                                                                  34750000
347600       SET LQW-IDX   TO +1                                        34760000
347700       SET SU033-IDX TO +1                                        34770000
347800       IF PS-NO-SOFT-ABORT-ERROR                                  34780000
347900          IF PV-CICS-RESP = DFHRESP(NORMAL)                       34790000
348000             PERFORM                                              34800000
348100             VARYING LQW-IDX FROM 1 BY 1                          34810000
348200               UNTIL LQW-IDX > PC-ITEMS-PER-PANEL                 34820000
348300                  OR LQW-LIST-ITEM-NUMBER(LQW-IDX) = ZEROES       34830000
348400                  OR LQW-SML(LQW-IDX)              = ZEROES       34840000
348500                  OR PS-SOFT-ABORT-ERROR                          34850000
348600                  OR PS-ERROR                                     34860000
348700                     IF LQW-SELECT(LQW-IDX)                       34870000
348800                        MOVE LQW-SML(LQW-IDX) TO PV-SML           34880000
348900                        MOVE PV-SML-1-18      TO                  34890000
349000                             SU033-SHIPT-UNT-ID(SU033-IDX)        34900000
349100                        SET SU033-IDX      UP BY +1               34910000
349200                        SET LQW-DESELECT(LQW-IDX)  TO TRUE        34920000
349300                        SET LQW-INQ(LQW-IDX)       TO TRUE        34930000
349400                        SUBTRACT 1                                34940000
349500                              FROM ASC-NUMBER-OF-SELECTED-ITEMS   34950000
349600                        MOVE LQW-SELECTED-SW(LQW-IDX) TO          34960000
349700                             LQW-TEMP-SELECTED-SW(LQW-IDX)        34970000
349800                     END-IF                                       34980000
349900             END-PERFORM                                          34990000
350000            PERFORM 4610-START-TRANID-S751                        35000000
350100          END-IF                                                  35010000
350200       END-IF                                                     35020000
350300       MOVE PV-ITEM TO PV-SAVE-ITEM                               35030000
350400       PERFORM 6111-WRITE-LIST-QUEUE                              35040000
350500       MOVE 1       TO ASC-BLK-SUB                                35050000
350600       PERFORM 4410-READ-TEMP-STORAGE                             35060000
350700       ADD  1       TO ASC-BLK-SUB                                35070000
350800                       PV-BLOCK-NUMBER                            35080000
350900       PERFORM 4410-READ-TEMP-STORAGE.                            35090000
351000                                                                  35100000
351100*----------------------------------------------------------------*35110000
351200* START TRANID FOR SUKCS751 CARTON MANIFEST REPORT               *35120000
351300*----------------------------------------------------------------*35130000
351400 4610-START-TRANID-S751.                                          35140000
351500                                                                  35150000
351600     MOVE LENGTH OF SU033-COMM-AREA   TO PV-COMMAREA-LENGTH       35160000
351700                                                                  35170000
351800     EXEC CICS                                                    35180000
351900         START TRANSID ('S751')                                   35190000
352000         FROM     (SU033-COMM-AREA)                               35200000
352100         LENGTH   (PV-COMMAREA-LENGTH)                            35210000
352200     END-EXEC.                                                    35220000
352300                                                                  35230017
352400*----------------------------------------------------------------*35240000
352500* PREPARE THE SELECTED ITEMS TEMP STORAGE QUEUE.  MOVE ALL SEL-  *35250000
352600* ECTED ITEMS FROM THE LIST TEMP STORAGE QUEUE TO THE LAYOUT     *35260000
352700* FOR THE SELECTED ITEMS QUEUE.                                  *35270000
352800*                                                                *35280000
352900* FIRST, DELETE THE SELECTION QUEUE, NEXT LOAD THE SELECTION     *35290000
353000* QUEUE RECORD.  FINALLY, WRITE THE SELECTION QUEUE ITEM WHEN    *35300000
353100* THE ARRAY IS FULL.                                             *35310000
353200*----------------------------------------------------------------*35320000
353300 5000-PREPARE-SEL-QUEUE.                                          35330000
353400                                                                  35340000
353500     MOVE +1                   TO  ASC-BLK-SUB.                   35350000
353600     PERFORM 5100-WRITE-TEMP-STORAGE.                             35360000
353700     ADD +1                    TO  ASC-BLK-SUB.                   35370000
353800     PERFORM 5100-WRITE-TEMP-STORAGE.                             35380000
353900                                                                  35390000
354000     MOVE ASC-SEL-QUEUE-NAME-OUT   TO  SU009-SEL-QUEUE-NAME.      35400000
354100     PERFORM 6010-DELETE-SEL-QUEUE.                               35410000
354200                                                                  35420000
354300     SET ASC-UPDATE-TSQ        TO  TRUE.                          35430000
354400                                                                  35440000
354500     SET SU010-IDX             TO  1.                             35450000
354600     MOVE ZERO                 TO SU009-NUMBER-OF-TS-ITEMS.       35460000
354700     INITIALIZE SU010-SELECTED-ITEM-ARRAY.                        35470000
354800                                                                  35480000
354900     PERFORM 5200-FILL-SEL-QUEUE-RECORD                           35490000
355000             VARYING PV-ITEM                                      35500000
355100             FROM 1 BY 1                                          35510000
355200             UNTIL PV-ITEM GREATER ASC-HIGHEST-BLOCK-WRITTEN.     35520000
355300                                                                  35530000
355400     IF  SU010-IDX > 1                                            35540000
355500         PERFORM 5205-WRITE-SEL-QUEUE                             35550000
355600         ADD +1                TO SU009-NUMBER-OF-TS-ITEMS        35560000
355700     END-IF.                                                      35570000
355800*----------------------------------------------------------------*35580000
355900*    WRITE A NEW BLOCK FROM THE ARRAY TO TEMPORARY STORAGE.      *35590000
356000*    REWRITE AN EXISITING BLOCK ONLY IF IT HAS BEEN MODIFIED.    *35600000
356100*----------------------------------------------------------------*35610000
356200 5100-WRITE-TEMP-STORAGE.                                         35620000
356300                                                                  35630000
356400     MOVE ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1)                     35640000
356500                                   TO PV-LIST-ITEM-NUMBER.        35650000
356600     COMPUTE PV-BLOCK-NUMBER =                                    35660000
356700         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    35670000
356800                                                                  35680000
356900     IF (PV-BLOCK-NUMBER < ASC-HIGHEST-BLOCK-WRITTEN)             35690000
357000     OR (PV-BLOCK-NUMBER = ASC-HIGHEST-BLOCK-WRITTEN)             35700000
357100         IF  ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                      35710000
357200             PERFORM 5105-REWRITE-ASC-LISTQ                       35720000
357300         END-IF                                                   35730000
357400     ELSE                                                         35740000
357500         COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                       35750000
357600         ASC-HIGHEST-BLOCK-WRITTEN + 1                            35760000
357700         PERFORM 5110-WRITE-ASC-LISTQ                             35770000
357800         ADD +1                    TO ASC-HIGHEST-BLOCK-WRITTEN   35780000
357900     END-IF.                                                      35790000
358000                                                                  35800000
358100     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             35810000
358200                                                                  35820000
358300******************************************************************35830000
358400** REWRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-    **35840000
358500** SPECIFIC COMMAREA.                                           **35850000
358600******************************************************************35860000
358700 5105-REWRITE-ASC-LISTQ.                                          35870000
358800                                                                  35880000
358900     EXEC CICS                                                    35890000
359000         WRITEQ TS                                                35900000
359100             QUEUE (ASC-LIST-QUEUE-NAME)                          35910000
359200             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               35920000
359300             ITEM  (PV-BLOCK-NUMBER)                              35930000
359400             REWRITE                                              35940000
359500             RESP  (PV-CICS-RESP)                                 35950000
359600     END-EXEC.                                                    35960000
359700                                                                  35970000
359800     IF  PV-CICS-RESP = DFHRESP(NORMAL)                           35980000
359900         CONTINUE                                                 35990000
360000     ELSE                                                         36000000
360100         SET DP013-CICS-ABEND            TO TRUE                  36010000
360200         SET DP013-NO-ROLLBACK           TO TRUE                  36020000
360300         MOVE '5105-REWRITE-ASC-LISTQ'   TO DP013-PARAGRAPH       36030000
360400         MOVE 'ATTEMPTING TO REWRITE LIST TEMP STORAGE QUEUE'     36040000
360500                                         TO DP013-MESSAGE-TEXT(1) 36050000
360600         PERFORM DP013-0000-PROCESS-ABEND                         36060000
360700     END-IF.                                                      36070000
360800                                                                  36080000
360900******************************************************************36090000
361000** WRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-      **36100000
361100** SPECIFIC COMMAREA.                                           **36110000
361200******************************************************************36120000
361300 5110-WRITE-ASC-LISTQ.                                            36130000
361400                                                                  36140000
361500     EXEC CICS                                                    36150000
361600         WRITEQ TS                                                36160000
361700             QUEUE (ASC-LIST-QUEUE-NAME)                          36170000
361800             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               36180000
361900             ITEM  (PV-BLOCK-NUMBER)                              36190000
362000             RESP  (PV-CICS-RESP)                                 36200000
362100     END-EXEC.                                                    36210000
362200     IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      36220000
362300         SET DP013-CICS-ABEND      TO TRUE                        36230000
362400         SET DP013-NO-ROLLBACK     TO TRUE                        36240000
362500         MOVE '5110-WRITE-ASC-LISTQ'                              36250000
362600                                   TO DP013-PARAGRAPH             36260000
362700         MOVE 'ATTEMPTING TO WRITE ASC LIST QUEUE'                36270000
362800                                   TO DP013-MESSAGE-TEXT(1)       36280000
362900         PERFORM DP013-0000-PROCESS-ABEND                         36290000
363000     END-IF.                                                      36300000
363100                                                                  36310000
363200*----------------------------------------------------------------*36320000
363300* READ A LIST QUEUE RECORD AND MOVE THE KEYS OF SELECTED OBJECTS *36330000
363400* TO THE SELECTED ITEMS TEMP STORAGE QUEUE RECORD.               *36340000
363500*----------------------------------------------------------------*36350000
363600 5200-FILL-SEL-QUEUE-RECORD.                                      36360000
363700                                                                  36370000
363800     PERFORM 6112-READ-LIST-QUEUE.                                36380000
363900                                                                  36390000
364000     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       36400000
364100         PERFORM                                                  36410000
364200         VARYING LQW-IDX                                          36420000
364300         FROM 1 BY 1                                              36430000
364400         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            36440000
364500           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          36450000
364600                                                                  36460000
364700             IF  LQW-SELECT (LQW-IDX)                             36470000
364800                 MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)              36480000
364900                                   TO SU010-ITEM (SU010-IDX)      36490000
365000                 MOVE SPACE        TO SU010-ACTION-SW (SU010-IDX) 36500000
365100                                                                  36510000
365200                 MOVE LQW-SML (LQW-IDX)  TO PV-SML                36520000
365300                 MOVE PV-SML-1-18        TO SU010-SML (SU010-IDX) 36530000
365400                 MOVE LQW-DEST-NBR (LQW-IDX)  TO                  36540000
365500                                       SU010-DEST-NBR (SU010-IDX) 36550000
365600                 MOVE LQW-CREATE (LQW-IDX) TO                     36560000
365700                                         SU010-CREATE (SU010-IDX) 36570000
365800                 MOVE LQW-STAT-DATE (LQW-IDX) TO                  36580000
365900                                       SU010-STAT-DATE(SU010-IDX) 36590000
366000                 MOVE LQW-STAT-TIME (LQW-IDX) TO                  36600000
366100                                       SU010-STAT-TIME(SU010-IDX) 36610000
366200                 MOVE LQW-LOAD-STATUS (LQW-IDX)                   36620000
366300                                 TO SU010-LOAD-STATUS (SU010-IDX) 36630000
366400                 MOVE LQW-TRIP-ID (LQW-IDX)                       36640000
366500                                     TO SU010-TRIP-ID (SU010-IDX) 36650000
366600                 SET SU010-IDX UP BY 1                            36660000
366700                 IF  SU010-IDX > SU010-MAX-ITEMS                  36670000
366800                     PERFORM 5205-WRITE-SEL-QUEUE                 36680000
366900                     ADD +1        TO SU009-NUMBER-OF-TS-ITEMS    36690000
367000                     INITIALIZE SU010-SELECTED-ITEM-ARRAY         36700000
367100                     SET SU010-IDX TO  1                          36710000
367200                 END-IF                                           36720000
367300             END-IF                                               36730000
367400         END-PERFORM                                              36740000
367500     END-IF.                                                      36750000
367600                                                                  36760000
367700*----------------------------------------------------------------*36770000
367800*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE.                *36780000
367900*----------------------------------------------------------------*36790000
368000 5205-WRITE-SEL-QUEUE.                                            36800000
368100                                                                  36810000
368200     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            36820000
368300                                   TO SU010-SELECTED-ITEMS.       36830000
368400                                                                  36840000
368500     EXEC CICS                                                    36850000
368600          WRITEQ TS                                               36860000
368700              QUEUE (ASC-SEL-QUEUE-NAME-OUT)                      36870000
368800              FROM  (SU010-SELECT-RECORD)                         36880000
368900              ITEM  (PV-SEL-QUEUE-ITEM)                           36890000
369000              RESP  (PV-CICS-RESP)                                36900000
369100     END-EXEC.                                                    36910000
369200                                                                  36920000
369300     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          36930000
369400         CONTINUE                                                 36940000
369500     ELSE                                                         36950000
369600         SET DP013-CICS-ABEND      TO TRUE                        36960000
369700         SET DP013-NO-ROLLBACK     TO TRUE                        36970000
369800         MOVE '5205-WRITE-SEL-QUEUE'  TO DP013-PARAGRAPH          36980000
369900         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          36990000
370000                                   TO DP013-MESSAGE-TEXT(1)       37000000
370100         PERFORM DP013-0000-PROCESS-ABEND                         37010000
370200     END-IF.                                                      37020000
370300******************************************************************37030000
370400** WHEN RETURNING TO THIS TRANSACTION FROM ANOTHER TRANSACTION, **37040000
370500** SETUP THE ARRAY AS IT WAS WHEN WE HAD LEFT PREVIOUSLY.  EDIT **37050000
370600** THE SELECTIONS MADE AT THAT TIME AND DISPLAY THE PANEL TO    **37060000
370700** THE USER.                                                    **37070000
370800******************************************************************37080000
370900 6000-REFRESH-PANEL-FROM-TEMP.                                    37090000
371000                                                                  37100000
371100     IF  ASC-UPDATE-TSQ AND ASC-NUMBER-OF-SELECTED-ITEMS > 0      37110000
371200         SET ASC-NO-TSQ-UPDATE TO TRUE                            37120000
371300         MOVE ZERO                 TO PV-SAVE-ITEM                37130000
371400                                      PV-SEL-QUEUE-ITEM           37140000
371500         MOVE ASC-NUMBER-OF-SELECTED-ITEMS                        37150000
371600                                   TO PV-HOLD-SELECTED-ITEMS      37160000
371700         MOVE +1                   TO PV-ITEMS-PROCESSED          37170000
371800         PERFORM 6100-UPDATE-TSQ                                  37180000
371900             UNTIL PV-ITEMS-PROCESSED >                           37190000
372000                                     PV-HOLD-SELECTED-ITEMS       37200000
372100         INITIALIZE ASC-BLOCK-ENTRIES (1)                         37210000
372200                    ASC-BLOCK-ENTRIES (2)                         37220000
372300     END-IF.                                                      37230000
372400                                                                  37240000
372500*----------------------------------------------------------------*37250000
372600*    DELETE THE SELECTED ITEMS TEMP STORAGE QUEUE.               *37260000
372700*----------------------------------------------------------------*37270000
372800 6010-DELETE-SEL-QUEUE.                                           37280000
372900                                                                  37290000
373000     EXEC CICS                                                    37300000
373100         DELETEQ TS                                               37310000
373200             QUEUE (ASC-SEL-QUEUE-NAME-OUT)                       37320000
373300             RESP  (PV-CICS-RESP)                                 37330000
373400     END-EXEC.                                                    37340000
373500                                                                  37350017
373600     IF ((PV-CICS-RESP = DFHRESP(NORMAL)) OR                      37360000
373700        (PV-CICS-RESP = DFHRESP(QIDERR)))                         37370000
373800         CONTINUE                                                 37380000
373900     ELSE                                                         37390000
374000         SET DP013-CICS-ABEND TO TRUE                             37400000
374100         SET DP013-NO-ROLLBACK TO TRUE                            37410000
374200         MOVE '6010-DELETE-SEL-QUEUE'                             37420000
374300                        TO DP013-PARAGRAPH                        37430000
374400         MOVE 'ERROR TRYING TO DELETE SELECTION TS QUEUE'         37440000
374500                        TO DP013-MESSAGE-TEXT (1)                 37450000
374600         PERFORM DP013-0000-PROCESS-ABEND                         37460000
374700     END-IF.                                                      37470000
374800                                                                  37480000
374900*----------------------------------------------------------------*37490000
375000*    INCREMENT THE TSQ ITEM NUMBER AND READ THE LIST QUEUE.      *37500000
375100*    LOOP THROUGH THE LIST QUEUE TO OBTAIN THE LINE ITEM NUMBER  *37510000
375200*    TO BE USED TO UPDATE (DESELECT) THE CORRECT LINE ITEM IN    *37520000
375300*    THE TEMP QUEUE.                                             *37530000
375400*    USE THE SELECT QUE THAT WAS SENT OFF TO THE NEXT PROGRAM.   *37540000
375500*----------------------------------------------------------------*37550000
375600 6100-UPDATE-TSQ.                                                 37560000
375700                                                                  37570000
375800     ADD 1                     TO  PV-SEL-QUEUE-ITEM.             37580000
375900     PERFORM 6150-READ-SEL-QUEUE.                                 37590000
376000     PERFORM                                                      37600000
376100         VARYING SU010-IDX                                        37610000
376200         FROM 1 BY 1                                              37620000
376300         UNTIL ((PV-ITEMS-PROCESSED > PV-HOLD-SELECTED-ITEMS)     37630000
376400         OR (SU010-IDX GREATER THAN SU010-MAX-ITEMS))             37640000
376500         IF  SU010-ACTION-SW (SU010-IDX) > SPACE                  37650000
376600             PERFORM 6110-PROCESS-ITEMS                           37660000
376700         END-IF                                                   37670000
376800         ADD +1                TO PV-ITEMS-PROCESSED              37680000
376900     END-PERFORM.                                                 37690000
377000     PERFORM 6111-WRITE-LIST-QUEUE.                               37700000
377100                                                                  37710000
377200*----------------------------------------------------------------*37720000
377300*    READ THE LIST QUEUE RECORD.                                 *37730000
377400*----------------------------------------------------------------*37740000
377500 6150-READ-SEL-QUEUE.                                             37750000
377600                                                                  37760000
377700     EXEC CICS                                                    37770000
377800          READQ TS                                                37780000
377900              QUEUE (ASC-SEL-QUEUE-NAME-OUT)                      37790000
378000              INTO  (SU010-SELECT-RECORD)                         37800000
378100              ITEM  (PV-SEL-QUEUE-ITEM)                           37810000
378200              RESP  (PV-CICS-RESP)                                37820000
378300     END-EXEC.                                                    37830000
378400                                                                  37840017
378500     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          37850000
378600         CONTINUE                                                 37860000
378700     ELSE                                                         37870000
378800         SET DP013-CICS-ABEND      TO  TRUE                       37880000
378900         SET DP013-NO-ROLLBACK     TO  TRUE                       37890000
379000         MOVE '6150-READ-SEL-QUEUE' TO  DP013-PARAGRAPH           37900000
379100         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           37910000
379200                                   TO  DP013-MESSAGE-TEXT(1)      37920000
379300         PERFORM DP013-0000-PROCESS-ABEND                         37930000
379400     END-IF.                                                      37940000
379500                                                                  37950000
379600*----------------------------------------------------------------*37960000
379700*    CALCULATE THE TEMP QUEUE ITEM THAT MUST BE READ AND READ IT.*37970000
379800*    REWRITE THE CURRENT TEMP QUEUE ITEM IF NECESSARY.  CALCULATE*37980000
379900*    THE LINE ITEM OCCURENCE AND UPDATE (DESELECT) IT.           *37990000
380000*----------------------------------------------------------------*38000000
380100 6110-PROCESS-ITEMS.                                              38010000
380200                                                                  38020000
380300     COMPUTE PV-ITEM = 1 + ((SU010-ITEM (SU010-IDX) - 1)          38030000
380400                     / PC-ITEMS-PER-PANEL).                       38040000
380500                                                                  38050000
380600     IF  PV-ITEM NOT EQUAL PV-SAVE-ITEM                           38060000
380700         IF  PV-SAVE-ITEM NOT EQUAL ZERO                          38070000
380800             PERFORM 6111-WRITE-LIST-QUEUE                        38080000
380900         END-IF                                                   38090000
381000         MOVE PV-ITEM          TO PV-SAVE-ITEM                    38100000
381100                                                                  38110000
381200         PERFORM 6112-READ-LIST-QUEUE                             38120000
381300         IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)               38130000
381400             CONTINUE                                             38140000
381500         END-IF                                                   38150000
381600     END-IF.                                                      38160000
381700                                                                  38170000
381800     COMPUTE PV-SUB = (SU010-ITEM (SU010-IDX)                     38180000
381900                    - LQW-LIST-ITEM-NUMBER (1)) + 1.              38190000
382000     SET LQW-DESELECT (PV-SUB) TO    TRUE                         38200000
382100     MOVE LQW-SELECTED-SW (PV-SUB)                                38210000
382200                               TO LQW-TEMP-SELECTED-SW (PV-SUB).  38220000
382300                                                                  38230000
382400     EVALUATE TRUE                                                38240000
382500         WHEN SU010-INQ (SU010-IDX)                               38250000
382600              MOVE PC-INQ      TO LQW-ACTION (PV-SUB)             38260000
382700                                                                  38270000
382800         WHEN SU010-UPD (SU010-IDX)                               38280000
382900              MOVE PC-UPD      TO LQW-ACTION (PV-SUB)             38290000
383000                                                                  38300000
383100         WHEN SU010-DEL (SU010-IDX)                               38310000
383200              MOVE PC-DEL      TO LQW-ACTION (PV-SUB)             38320000
383300                                                                  38330000
383400         WHEN SU010-ERR (SU010-IDX)                               38340000
383500              MOVE PC-ERR      TO LQW-ACTION (PV-SUB)             38350000
383600     END-EVALUATE.                                                38360000
383700                                                                  38370000
383800     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                38380000
383900                                                                  38390000
384000*----------------------------------------------------------------*38400000
384100*    WRITE THE TS QUEUE RECORD JUST UPDATED IN C600.             *38410000
384200*----------------------------------------------------------------*38420000
384300 6111-WRITE-LIST-QUEUE.                                           38430000
384400                                                                  38440000
384500     EXEC CICS                                                    38450000
384600         WRITEQ TS                                                38460000
384700             QUEUE (ASC-LIST-QUEUE-NAME)                          38470000
384800             FROM  (LQW-LIST-QUEUE-WORK-AREA)                     38480000
384900             ITEM  (PV-SAVE-ITEM)                                 38490000
385000             REWRITE                                              38500000
385100             RESP  (PV-CICS-RESP)                                 38510000
385200     END-EXEC.                                                    38520000
385300                                                                  38530017
385400     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          38540000
385500         CONTINUE                                                 38550000
385600     ELSE                                                         38560000
385700         SET DP013-CICS-ABEND  TO  TRUE                           38570000
385800         SET DP013-NO-ROLLBACK TO  TRUE                           38580000
385900         MOVE '6111-WRITE-LIST-QUEUE'                             38590000
386000                               TO  DP013-PARAGRAPH                38600000
386100         MOVE 'ATTEMPTING TO REWRITE LIST QUEUE'                  38610000
386200                               TO  DP013-MESSAGE-TEXT(1)          38620000
386300         PERFORM DP013-0000-PROCESS-ABEND                         38630000
386400     END-IF.                                                      38640000
386500                                                                  38650000
386600*----------------------------------------------------------------*38660000
386700*    READ THE TEMPORARY STORAGE QUEUE INTO A TEMPORARY WORK AREA.*38670000
386800*----------------------------------------------------------------*38680000
386900 6112-READ-LIST-QUEUE.                                            38690000
387000                                                                  38700000
387100     EXEC CICS                                                    38710000
387200         READQ TS                                                 38720000
387300             QUEUE (ASC-LIST-QUEUE-NAME)                          38730000
387400             INTO  (LQW-LIST-QUEUE-WORK-AREA)                     38740000
387500             ITEM  (PV-ITEM)                                      38750000
387600             RESP  (PV-CICS-RESP)                                 38760000
387700     END-EXEC.                                                    38770000
387800                                                                  38780017
387900     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          38790000
388000         CONTINUE                                                 38800000
388100     ELSE                                                         38810000
388200         SET DP013-CICS-ABEND        TO TRUE                      38820000
388300         SET DP013-NO-ROLLBACK       TO TRUE                      38830000
388400         MOVE '6112-READ-LIST-QUEUE' TO DP013-PARAGRAPH           38840000
388500         MOVE 'ATTEMPTING TO READQ LIST QUEUE'                    38850000
388600                                     TO DP013-MESSAGE-TEXT(1)     38860000
388700         PERFORM DP013-0000-PROCESS-ABEND                         38870000
388800     END-IF.                                                      38880000
388900                                                                  38890000
389000                                                                  38900000
389100 8000-WRITE-CSSL.                                                 38910000
389200                                                                  38920000
389300     MOVE EIBTASKN TO PV-CICS-TASK                                38930000
389400     MOVE LENGTH OF PV-CICS-MSG-AREA                              38940000
389500               TO PV-COMMAREA-LENGTH                              38950000
389600                                                                  38960000
389700     EXEC CICS                                                    38970000
389800         WRITEQ TD                                                38980000
389900             QUEUE  ('CSSL')                                      38990000
390000             FROM  (PV-CICS-MSG-AREA)                             39000000
390100             LENGTH  (PV-COMMAREA-LENGTH)                         39010000
390200             RESP  (PV-CICS-RESP)                                 39020000
390300     END-EXEC.                                                    39030000
390400                                                                  39040017
390500*-----------------------------------------------------------------39050000
390600*  READ THE LIST QUEUE RECORD                                     39060000
390700*-----------------------------------------------------------------39070000
390800 9100-READ-SEL-QUEUE.                                             39080000
390900                                                                  39090000
391000     EXEC CICS                                                    39100000
391100         READQ TS                                                 39110000
391200             QUEUE (ASC-SEL-QUEUE-NAME-IN)                        39120000
391300             INTO  (SU010-SELECT-RECORD)                          39130000
391400             ITEM  (ASC-SEL-ITEM)                                 39140000
391500             RESP  (PV-CICS-RESP)                                 39150000
391600     END-EXEC.                                                    39160000
391700     IF PV-CICS-RESP EQUAL DFHRESP(NORMAL)                        39170000
391800         CONTINUE                                                 39180000
391900     ELSE                                                         39190000
392000         SET DP013-LOGIC-ABEND                                    39200000
392100             DP013-NO-ROLLBACK   TO   TRUE                        39210000
392200         MOVE '9100-READ-SEL-QUEUE' TO   DP013-PARAGRAPH          39220000
392300         MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   39230000
392400                                 TO   DP013-MESSAGE-TEXT (1)      39240000
392500         PERFORM DP013-0000-PROCESS-ABEND                         39250000
392600     END-IF.                                                      39260000
392700                                                                  39270000
392800*-----------------------------------------------------------------39280000
392900* UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE.       *39290000
393000*-----------------------------------------------------------------39300000
393100 9200-REWRITE-SEL-QUEUE.                                          39310000
393200                                                                  39320000
393300     EXEC CICS                                                    39330000
393400          WRITEQ TS                                               39340000
393500              QUEUE  (ASC-SEL-QUEUE-NAME-IN)                      39350000
393600              FROM   (SU010-SELECT-RECORD)                        39360000
393700              ITEM   (ASC-SEL-ITEM)                               39370000
393800              RESP   (PV-CICS-RESP)                               39380000
393900              REWRITE                                             39390000
394000     END-EXEC.                                                    39400000
394100                                                                  39410000
394200     IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                   39420000
394300         SET DP013-CICS-ABEND                                     39430000
394400             DP013-NO-ROLLBACK     TO TRUE                        39440000
394500         MOVE '9200-REWRITE-SEL-QUEUE'                            39450000
394600                                   TO DP013-PARAGRAPH             39460000
394700         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   39470000
394800                                   TO DP013-MESSAGE-TEXT (1)      39480000
394900         PERFORM DP013-0000-PROCESS-ABEND                         39490000
395000     END-IF.                                                      39500000
395100                                                                  39510000
395200*----------------------------------------------------------------*39520000
395300*    THE DB2 RESOURCE IS NOT AVAILABLE, DISPLAY A MESSAGE ON     *39530000
395400*    THE TERMINAL INDICATING THAT THE RESOURCE IS UNAVAILABLE.   *39540000
395500*----------------------------------------------------------------*39550000
395600 9900-SOFT-ABORT.                                                 39560000
395700                                                                  39570000
395800     EXEC CICS SYNCPOINT                                          39580000
395900          ROLLBACK                                                39590000
396000     END-EXEC.                                                    39600000
396100                                                                  39610000
396200     SET  PS-ERROR                                                39620000
396300          PS-SOFT-ABORT-ERROR                                     39630000
396400          DP020-MSG-FATAL       TO  TRUE.                         39640000
396500                                                                  39650000
396600*----------------------------------------------------------------*39660000
396700*    ABEND PROCESSOR MODULE                                      *39670000
396800*----------------------------------------------------------------*39680000
396900     COPY DPPD013.                                                39690000
397000                                                                  39700000
