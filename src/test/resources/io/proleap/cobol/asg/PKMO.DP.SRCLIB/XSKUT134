000100 IDENTIFICATION DIVISION.                                         00001004
000200 PROGRAM-ID.      XSKUT134.                                       00002004
000300 AUTHOR.          CHERI PARMLEY.                                  00003004
000400 DATE-WRITTEN.    APRIL 16, 2010.                                 00004004
000500                                                                  00005004
000600*-----------------------------------------------------------      00006004
000700*           REBATE FORM DATA QUEUE READER                         00007004
000800*-----------------------------------------------------------      00008004
000810* THIS PROGRAM WILL READ A MESSAGE FROM A QUEUE AND CALL          00009004
000820* THE NECESSARY PROGRAM THAT IT RELATES TO.  THIS PROGRAM         00009104
000830* IS A COBOL MQ SERIES PROGRAM THAT READS FROM A QUEUE            00009204
000840* INCOMING MESSAGES. THE FIRST THING THIS PROGRAM DOES IS         00009304
000850* READS IN THE CONTROL CARDS AND VALIDATES THEM. IT THEN          00009404
000860* CALCULATES THE FUTURE OFFSET DATE BY GETTING THE FUTURE         00009504
000870* OFFSET NUMBER FROM THE XST_INTFC_CNTL AND ADDING IT TO THE      00009604
000880* CURRENT DATE AND ADDING THE BUSINESS DAYS FROM CONTROL CARD     00009704
000890* 4. THIS PROGRAM THEN CONNECTS TO THE QUEUE MANAGER, OPENS       00009804
000891* THE BUSINESS EVENT QUEUE AND THE ERROR QUEUE, AND THEN          00009904
000892* READS A MESSAGE FROM THE BUSINESS EVENT QUEUE.  IT WILL         00010004
000893* THEN EVALUATE THE MESSAGE TYPE AND CALL THE NECESSARY           00010104
000894* PROGRAM THAT WILL LOAD THIS RECORD TO A XS DOMAIN PROMO         00010204
000895* TABLE.  IT WILL THEN EVALUATE THE PROGRAM STATUS CODE           00010304
000896* AND ERROR CODE THAT IS SENT BACK.  IF THE MESSAGE WAS           00010404
000897* SUCCESSFUL IT WILL WRITE THE MESSAGE OUT TO A BACKUP            00010504
000898* MESSAGE LOG.  IF THE MESSAGE WAS NOT SUCCESSFUL IT WILL         00010604
000899* WRITE THE MESSAGE OUT TO THE ERROR QUEUE AND CALL THE           00010704
000900* SERVICE CENTER PROGRAM.  ONCE ALL THE MESSAGES ARE READ         00010804
000901* THE PROGRAM WILL CLOSE ALL QUEUES, DISCONNECT FROM THE          00010904
000902* QUEUE MANAGER, AND DISPLAY ALL COUNTS OF EVERYTHING THAT        00011004
000903* HAPPENED.                                                       00011104
000904*                                                                 00011204
000904* THIS PROGRAM IS COPIED FROM XSKUT034 AND IS NEEDED FOR          00011304
000904* REBATES. REBATES WILL BE GOING TO A SEPARATE QUEUE FROM         00011404
000904* PROMOTIONS.                                                     00011504
000904*                                                                 00011604
000905*       MESSAGE TYPES - MESSAGES COMING THROUGH                   00011704
000906******          010 - AD EVENT MESSAGE                            00011804
000907*               020 - PROMOTION MESSAGE                           00011904
000908*               030 - PRICE VERSION MESSAGE                       00012004
000909*               040 - ADHOC STORE GROUP MESSAGE                   00012104
000910*               050 - ADHOC STORE LIST MESSAGE                    00012204
000911*               090 - PRICING MESSAGE                             00012304
000912******          100 - BENEFIT WITH PURCHASE 'GET' MESSAGE         00012404
000913*               110 - EXCLUSION MESSAGE                           00012504
000914*               120 - STORE GROUP MESSAGE                         00012604
000914*               130 - REBATE FORM MESSAGE                         00012704
000915*                                                                 00012804
000916*       THIS IS WHAT IS BEING SENT BACK FROM THE CALLED PROGRAM.  00012904
000917*       THERE IS A PROGRAM STATUS CODE SENT BACK, SQL RETURN CODE,00013004
000918*       AND A LOAD SEVERITY ERROR CODE.                           00013104
000919*                                                                 00013204
000920*          SQL CODES - LOAD SQL RETURN CODE                       00013304
000921*             - THIS IS THE LAST SQL RETURN CODE RECEIVED         00013404
000922*               FROM A DATABASE ACTION.                           00013504
000923*                                                                 00013604
000924*          PROGRAM CODES - PROGRAM STATUS CODE                    00013704
000925*           - 00 - ALL DATABASE ACTION WAS SUCCESSFUL AND         00013804
000926*                  WORKED ACCORDING TO THE MESSAGE TYPE.          00013904
000927*           - 01 - AN 'ADD' RECORD WAS TURNED INTO AN             00014004
000928*                  UPDATE AND THE BUSINESS EVENT WAS FOUND        00014104
000929*                  TO BE THE ONE NEEDED ON THE DATABASE.          00014204
000930*           - 02 - AN 'ADD' RECORD WAS TURNED INTO AN UPDATE      00014304
000931*                  AND THE BUSINESS EVENT WAS FOUND TO BE         00014404
000932*                  THE ONE NOT NEEDED ON THE DATABASE.            00014504
000933*           - 03 - AN 'UPDATE' RECORD WAS TURNED INTO AN ADD.     00014604
000934*           - 04 - AN 'UPDATE' RECORD WAS BYPASSED BECAUSE THE    00014704
000935*                  RECORD CURRENTLY ON THE DATABASE WAS THE       00014804
000936*                  MOST RECENT DATA.                              00014904
000937*           - 05 - THE DATABASE ACTION WAS NOT SUCCESSFUL DUE     00015004
000938*                  TO THE RETURNED SQL CODE.                      00015104
000939*           - 06 - UNEXPECTED ACTION CODE RECEIVED.               00015204
000940*                                                                 00015304
000941*          ERROR CODES - LOAD SEVERITY LEVEL                      00015404
000947*           - 00 - THE LOAD OF THE DATA WAS SUCCESSFUL AND        00015504
000948*                  THEREFORE THE SEVERITY OF THE LOAD DID         00015604
000949*                  NOT NEED TO BE DETERMINED.                     00015704
000950*           - 01 - THE LOAD IS CRITICAL TO A SYSTEM AND           00015804
000951*                  THEREFORE MUST BE RESOLVED ASAP.               00015904
000952*           - 02 - THE LOAD IS NOT CRITICAL AND THEREFORE CAN     00016004
000953*                  WAIT UNTIL A LATER TIME TO BE RESOLVED.        00016104
000954*                                                                 00016204
000960*-----------------------------------------------------------      00016304
001000* HISTORY LOG:                                                    00016404
001100*-----------------------------------------------------------      00016504
001200* DATE: 04/16/2010                                                00016604
001300* WR/IR#: WR#38172                                                00016704
001400* PROGRAMMER: CHERI PARMLEY                                       00016804
001500* DESCRIPTION: INITIAL VERSION                                    00016904
001600*                                                                 00017004
101310* DATE: 10/13/2010                                                00017104
101310* WR/IR#: PKE#0000005286                                          00017204
101310* PROGRAMMER: CHERI PARMLEY                                       00017304
101310* DESCRIPTION: ADD COMMIT REGARDLESS WHETHER INSERT/UPDATE        00017404
101310* WAS SUCCESSFUL. RECOMMENDED BY RICH RIAMOND TO AVOID            00017504
101310* LOCKING DB2 RESOURCES.                                          00017604
001600*                                                                 00017804
PK6955* DATE: 02/15/2011                                                00017904
PK6955* PROGRAMMER: COGNIZANT                                           00018104
PK6955* DESCRIPTION:ADDED A SEPERATE EVALUATE CONDITION FOR CHECKING    00018204
PK6955* THE PV-NO-SUCCESS INDICTOR. WHEN IT IS SET THEN PGM SHOULD NOT  00018304
PK6955* CALL THE 2800-CALL-DISPLAY-CONSOLE-MSG PARA FOR CREATING INCIDT 00018304
PK6955* AS THE MESSAGE QUEUE IS CLEARED TIMELY BY THE JOB XSK403.       00018304
229232*                                                                         
229232* DATE:        08/09/2019                                                 
229232* WR/IR#:      CHG0229232                                                 
229232* PROGRAMMER:  JIM HUNTER                                                 
229232* DESCRIPTION: MAINFRAME REFACTORING - THE CALL TO DPKUT175 IS            
229232*              BEING REMOVED BECAUSE IT IS AN ASSEMBLER PROGRAM           
229232*              AND CAN'T BE REFACTORED.  DPKUT175 SENT UP TO              
229232*              5 ERROR MESSAGES TO THE OPERATOR CONSOLE WHEN              
229232*              RECORDS WITH INVALID BUSINESS EVENTS WERE READ.            
229232*              THE SERVICE DELIVERY TEAM CONFIRMED THAT                   
229232*              OPERATIONS HAS NOT NOTIFIED THEM ABOUT MESSAGES            
229232*              RECEIVED ON THE CONSOLE IN THE PAST.                       
229232*                                                                         
001700*----------------------------------------------------------       00018404
001800 ENVIRONMENT DIVISION.                                            00018504
001900*----------------------------------------------------------       00018604
002000 CONFIGURATION SECTION.                                           00018704
002100 SOURCE-COMPUTER.        IBM-3090.                                00018804
002200 OBJECT-COMPUTER.        IBM-3090.                                00018904
002210                                                                  00019004
002220 INPUT-OUTPUT SECTION.                                            00019104
002230                                                                  00019204
002240 FILE-CONTROL.                                                    00019304
002250                                                                  00019404
002260     SELECT CONTROL-CARD-1                                        00019504
002270            ASSIGN TO INP01.                                      00019604
002280     SELECT CONTROL-CARD-2                                        00019704
002290            ASSIGN TO INP02.                                      00019804
002300     SELECT CONTROL-CARD-3                                        00019904
002400            ASSIGN TO INP03.                                      00020004
002500     SELECT CONTROL-CARD-4                                        00020104
002600            ASSIGN TO INP04.                                      00020204
002700     SELECT MESSAGE-LOG                                           00020304
002800            ASSIGN TO OUT01.                                      00020404
002900                                                                  00020504
003000 DATA DIVISION.                                                   00020604
003100 FILE SECTION.                                                    00020704
003200                                                                  00020804
003300 FD  CONTROL-CARD-1                                               00020904
003400     RECORDING MODE F                                             00021004
003500     BLOCK CONTAINS 0 RECORDS                                     00021104
003600     LABEL RECORDS ARE OMITTED                                    00021204
003700     DATA RECORD IS CONTROL-CARD-1-RECORD.                        00021304
003800 01  CONTROL-CARD-1-RECORD           PIC X(80).                   00021404
003900                                                                  00021504
004000 FD  CONTROL-CARD-2                                               00021604
004100     RECORDING MODE F                                             00021704
004200     BLOCK CONTAINS 0 RECORDS                                     00021804
004300     LABEL RECORDS ARE OMITTED                                    00021904
004400     DATA RECORD IS CONTROL-CARD-2-RECORD.                        00022004
004500 01  CONTROL-CARD-2-RECORD           PIC X(80).                   00022104
004600                                                                  00022204
004700 FD  CONTROL-CARD-3                                               00022304
004800     RECORDING MODE F                                             00022404
004900     BLOCK CONTAINS 0 RECORDS                                     00022504
005000     LABEL RECORDS ARE OMITTED                                    00022604
005100     DATA RECORD IS CONTROL-CARD-3-RECORD.                        00022704
005200 01  CONTROL-CARD-3-RECORD           PIC X(80).                   00022804
005300                                                                  00022904
005400 FD  CONTROL-CARD-4                                               00023004
005500     RECORDING MODE F                                             00023104
005600     BLOCK CONTAINS 0 RECORDS                                     00023204
005700     LABEL RECORDS ARE OMITTED                                    00023304
005800     DATA RECORD IS CONTROL-CARD-4-RECORD.                        00023404
005810 01  CONTROL-CARD-4-RECORD           PIC X(80).                   00023504
005820                                                                  00023604
005830 FD  MESSAGE-LOG                                                  00023704
005840     RECORDING MODE F                                             00023804
005850     BLOCK CONTAINS 0 RECORDS                                     00023904
005860     LABEL RECORDS ARE OMITTED                                    00024004
005870     DATA RECORD IS MESSAGE-LOG-RECORD.                           00024104
005880 01  MESSAGE-LOG-RECORD              PIC X(300).                  00024204
005890                                                                  00024304
005900 WORKING-STORAGE SECTION.                                         00024404
006000*-----------------------------------------------------------      00024504
006100* PS- PROGRAM SWITCHES                                            00024604
006200*-----------------------------------------------------------      00024704
006300 01  PS-PROGRAM-SWITCHES.                                         00024804
006400     05  PS-PROCESS-INDICATOR-SW  PIC X(01) VALUE 'Y'.            00024904
006500         88  PS-PROCESS-COMPLETE            VALUE 'N'.            00025004
006600         88  PS-PROCESS-CONTINUE            VALUE 'Y'.            00025104
006700                                                                  00025204
006800*-----------------------------------------------------------      00025304
006900* CONTROL CARD 1 RECORD LAYOUT - QUEUE MANAGER NAME               00025404
007000*-----------------------------------------------------------      00025504
007100 01  CC-CONTROL-CARD-1-LAYOUT.                                    00025604
007200     05  CC-QUEUE-MANAGER-NAME    PIC X(48) VALUE SPACES.         00025704
007300     05  FILLER                   PIC X(32) VALUE SPACES.         00025804
007400                                                                  00025904
007500*-----------------------------------------------------------      00026004
007600* CONTROL CARD 2 RECORD LAYOUT - BUSINESS EVENT QUEUE NAME        00026104
007700*-----------------------------------------------------------      00026204
007800 01  CC-CONTROL-CARD-2-LAYOUT.                                    00026304
007900     05  CC-BUS-EVNT-QUEUE-NAME   PIC X(48) VALUE SPACES.         00026404
008000     05  FILLER                   PIC X(32) VALUE SPACES.         00026504
008100                                                                  00026604
008200*-----------------------------------------------------------      00026704
008300* CONTROL CARD 3 RECORD LAYOUT - BUSINESS EVENT ERROR QUEUE NAME  00026804
008400*-----------------------------------------------------------      00026904
008500 01  CC-CONTROL-CARD-3-LAYOUT.                                    00027004
008600     05  CC-ERROR-QUEUE-NAME      PIC X(48) VALUE SPACES.         00027104
008700     05  FILLER                   PIC X(32) VALUE SPACES.         00027204
008800                                                                  00027304
008900*-----------------------------------------------------------      00027404
009000* CONTROL CARD 4 RECORD LAYOUT - BUSINESS OFFSET DAYS             00027504
009100*-----------------------------------------------------------      00027604
009110 01  CC-CONTROL-CARD-4-LAYOUT.                                    00027704
009120     05  FILLER                   PIC X(30) VALUE SPACES.         00027804
009130     05  CC-BUS-DAYS-NBR          PIC X(03) VALUE SPACES.         00027904
009140     05  FILLER                   PIC X(47) VALUE SPACES.         00028004
009150                                                                  00028104
009160*-----------------------------------------------------------      00028204
009170* PROGRAM CONSTANTS                                               00028304
009180*-----------------------------------------------------------      00028404
009190 01  PC-PROGRAM-CONSTANTS.                                        00028504
009191     05  PC-TEST-QUEUE            PIC X(04) VALUE 'QKST'.         00028604
009191     05  PC-QUAL-QUEUE            PIC X(04) VALUE 'QKSQ'.         00028704
009191     05  PC-PROD-QUEUE            PIC X(04) VALUE 'QKSP'.         00028804
009200     05  PC-CURRENT-PROGRAM-NAME  PIC X(08) VALUE 'XSKUT134'.     00028904
009300     05  PC-MAX-RETRIES           PIC S9(04) VALUE +5 COMP.       00029004
009310     05  PC-RI-ERROR-530          PIC S9(04) VALUE -530.          00029104
009360     05  PC-BAD-MESSAGE           PIC X(19) VALUE                 00029204
009370                                  'BAD BUS EVENT ID   '.          00029304
009380     05  PC-MSG-NOT-LOAD          PIC X(19) VALUE                 00029404
009390                                  'MSG DID NOT LOAD   '.          00029504
009400     05  PC-CALLED-PROGRAM        PIC X(08).                      00029604
009500         88  PC-CALLED-XSKUP134             VALUE 'XSKUP134'.     00029704
009500         88  PC-CALLED-XSKUP028             VALUE 'XSKUP028'.     00029804
009600         88  PC-CALLED-XSKUP031             VALUE 'XSKUP031'.     00029904
009700         88  PC-CALLED-XSKUP032             VALUE 'XSKUP032'.     00030004
009800         88  PC-CALLED-XSKUP033             VALUE 'XSKUP033'.     00030104
009900         88  PC-CALLED-XSKUP034             VALUE 'XSKUP034'.     00030204
010000         88  PC-CALLED-XSKUP035             VALUE 'XSKUP035'.     00030304
010100         88  PC-CALLED-XSKUP036             VALUE 'XSKUP036'.     00030404
010200         88  PC-CALLED-XSKUP037             VALUE 'XSKUP037'.     00030504
010300         88  PC-CALLED-XSKUP038             VALUE 'XSKUP038'.     00030604
010400                                                                  00030804
010500*-----------------------------------------------------------      00030904
010600* PV- PROGRAM VARIABLES                                           00031004
010700*-----------------------------------------------------------      00031104
010800 01  PV-PROGRAM-VARAIBLES.                                        00031204
010900     05  PV-SQL-SUB               PIC S9(4)  VALUE +0 COMP.       00031304
010910     05  PV-MQ-ERROR-COUNT        PIC 9(04)  VALUE 0.             00031404
011000     05  PV-CURRENT-DATE          PIC X(10) VALUE SPACES.         00031604
011100     05  PV-FUT-OFFST-NBR         PIC S9(05) VALUE +0.            00031704
011200     05  PV-SAVE-DAYS-AHEAD       PIC X(05) VALUE SPACES.         00031804
011300     05  PV-FUTURE-OFFSET-DTE     PIC X(10) VALUE SPACES.         00031904
011400     05  PV-BUS-DAYS              PIC 9(03) VALUE 0.              00032004
011500     05  PV-BUS-DAYS-NBR          PIC 9(05) VALUE 0.              00032104
011510     05  PV-BUS-DAYS-AHEAD        PIC X(05) VALUE SPACES.         00032204
011511     05  PV-SQL-ERR-CDE           PIC 9(04) VALUE 0.              00032304
011512     05  PV-FORMAT-CORR-ID.                                       00032404
011513         10  PV-FORMAT-MQ-CORR-ID PIC X(03).                      00032504
011514         10  PV-NULL-VALUE        PIC X(21).                      00032604
011515     05  PV-MQ-CORR-ID            PIC S9(04) VALUE +0 COMP-3.     00032704
011516     05  PV-MQ-CORR-ID-CHAR REDEFINES                             00032804
011517        PV-MQ-CORR-ID             PIC X(03).                      00032904
011520     05  PV-SAVE-CCYY-MM-DD.                                      00033004
011530         10  PV-SAVE-CCYY         PIC X(04).                      00033104
011540         10  FILLER               PIC X(01).                      00033204
011550         10  PV-SAVE-MM           PIC X(02).                      00033304
011560         10  FILLER               PIC X(01).                      00033404
011570         10  PV-SAVE-DD           PIC X(02).                      00033504
011571     05  PV-PRCS-BUS-DTE.                                         00033604
011572         10  PV-PRCS-BUS-CCYY     PIC X(04).                      00033704
011573         10  FILLER               PIC X(01).                      00033804
011574         10  PV-PRCS-BUS-MM       PIC X(02).                      00033904
011575         10  FILLER               PIC X(01).                      00034004
011576         10  PV-PRCS-BUS-DD       PIC X(02).                      00034104
011577     05  PV-FUT-OFFST-BUS-DTE.                                    00034204
011578         10  PV-FUT-BUS-CCYY      PIC X(04).                      00034304
011579         10  PV-FUT-BUS-MM        PIC X(02).                      00034404
011580         10  PV-FUT-BUS-DD        PIC X(02).                      00034504
011581     05  PV-MESSAGE-RECORD.                                       00034604
011582         10  PV-BUS-EVNT-ID       PIC X(03)  VALUE SPACES.        00034704
011583         10  FILLER               PIC X(297) VALUE SPACES.        00034804
011584     05  PV-SAVE-BUS-EVNT-ID      PIC 9(03).                      00034904
011585         88  PV-AD-EVENT                     VALUE 010.           00035004
011586         88  PV-PROMOTION                    VALUE 020.           00035104
011587         88  PV-PRICE-VERSION                VALUE 030.           00035204
011588         88  PV-ADHOC-STR-GRP                VALUE 040.           00035304
011589         88  PV-ADHOC-STR-LIST               VALUE 050.           00035404
011590         88  PV-PROMOTION-ITEM               VALUE 060.           00035504
011600         88  PV-PROMOTION-ITEM-STR-GRP       VALUE 070.           00035604
011601         88  PV-FORECAST                     VALUE 080.           00035704
011602         88  PV-PRICING                      VALUE 090.           00035804
011603         88  PV-BENEFIT-W-PURCHASE           VALUE 100.           00035904
011604         88  PV-PRICING-EXCLUSIONS           VALUE 110.           00036004
011605         88  PV-PRICING-STR-GRP              VALUE 120.           00036104
011605         88  PV-REBATE-FORM                  VALUE 130.           00036204
011606         88  PV-END-OF-DAY                   VALUE 999.           00036304
011607     05  PV-PRGM-STAT-CDE         PIC X(02).                      00036404
011608         88  PV-SUCCESS                      VALUE '00'.          00036504
011609         88  PV-UPDATE-NEEDED                VALUE '01'.          00036604
011610         88  PV-UPDATE-NOT-NEEDED            VALUE '02'.          00036704
011611         88  PV-INSERT                       VALUE '03'.          00036804
011612         88  PV-UPDATE-BYPASS                VALUE '04'.          00036904
011613         88  PV-NO-SUCCESS                   VALUE '05'.          00037004
011614         88  PV-UNEXPECTED                   VALUE '06'.          00037104
011615     05  PV-SEVERITY-ERR-CDE      PIC X(02).                      00037204
011616         88  PV-CRITICAL-ERROR               VALUE '01'.          00037304
011617         88  PV-UNCRITICAL-ERROR             VALUE '02'.          00037404
011618     05  PV-REFER-INTEGRITY-ERR   PIC S9(04).                     00037504
011619         88  PV-RI-ERROR                     VALUES -530,         00037604
011620                                        -531, -532, -543.         00037704
011621                                                                  00037804
011644*----------------------------------------------------------       00040004
011645* MQ WORKING STORAGE                                              00040104
011646*----------------------------------------------------------       00040204
011647 01  MQV-WORKING-STORAGE.                                         00040304
011648     05  MQV-MQCONN               PIC  X(08) VALUE 'CSQBCONN'.    00040404
011650     05  MQV-MQOPEN               PIC  X(08) VALUE 'CSQBOPEN'.    00040504
011660     05  MQV-MQPUT                PIC  X(08) VALUE 'CSQBPUT '.    00040604
011670     05  MQV-MQGET                PIC  X(08) VALUE 'CSQBGET '.    00040704
011680     05  MQV-MQCMIT               PIC  X(08) VALUE 'CSQBCOMM'.    00040804
011690     05  MQV-MQBACK               PIC  X(08) VALUE 'CSQBBACK'.    00040904
011700     05  MQV-MQCLOSE              PIC  X(08) VALUE 'CSQBCLOS'.    00041004
011800     05  MQV-MQDISC               PIC  X(08) VALUE 'CSQBDISC'.    00041104
011900     05  MQV-MQCHECK              PIC  X(08) VALUE 'MQR2C'.       00041204
012000     05  MQV-HCONN                PIC S9(09) BINARY VALUE 0.      00041304
012100     05  MQV-COMPLETION-CODE      PIC S9(09) BINARY.              00041404
012200     05  MQV-REASON               PIC S9(09) BINARY.              00041504
012300     05  MQV-OPEN-OPTIONS         PIC S9(09) BINARY.              00041604
012400     05  MQV-PROMO-HANDLE         PIC S9(09) BINARY VALUE 0.      00041704
012500     05  MQV-ERROR-HANDLE         PIC S9(09) BINARY VALUE 0.      00041804
012600     05  MQV-REASON-TEXT          PIC X(30)  VALUE SPACES.        00041904
012700     05  MQV-MSGBUFFER            PIC X(300) VALUE SPACES.        00042004
012800     05  MQV-ERRMSGBUF            PIC X(300) VALUE SPACES.        00042104
012900     05  MQV-MSG-LENGTH           PIC S9(09) BINARY VALUE         00042204
013000                                              +300.               00042304
013100     05  MQV-DATA-LENGTH          PIC S9(09) BINARY.              00042404
013200                                                                  00042504
014056*----------------------------------------------------------       00042604
014057* DATE ROUTINE COPY MEMBERS                                       00042704
014058*----------------------------------------------------------       00042804
014059     COPY DPWS500.                                                00042904
014060                                                                  00043004
014070*-----------------------------------------------------------      00043104
014080* VARIABLES REQUIRED FOR THE FORMAT SQLCA ROUTINE DPPD004         00043204
014090*-----------------------------------------------------------      00043304
014100     COPY DPWS004.                                                00043404
014200                                                                  00043504
014300*-----------------------------------------------------------      00043604
014400* DB2 ABEND COPYBOOK                                              00043704
014500*-----------------------------------------------------------      00043804
014600     COPY DPWS900.                                                00043904
014700                                                                  00044004
014710*-----------------------------------------------------------      00044104
014720* DB2 MESSAGE AREA                                                00044204
014730*-----------------------------------------------------------      00044304
014740     COPY SQLCA2.                                                 00044404
014750                                                                  00044504
014760*-----------------------------------------------------------      00044604
014770* OBJECT-DESCRIPTOR - MQ SERIES                                   00044704
014780*-----------------------------------------------------------      00044804
014790 01  MQM-OBJECT-DESCRIPTOR.                                       00044904
014800     COPY CMQODV.                                                 00045004
014900                                                                  00045104
015000*-----------------------------------------------------------      00045204
015100* MESSAGE-DESCRIPTOR - MQ SERIES                                  00045304
015200*-----------------------------------------------------------      00045404
015300 01  MQM-MESSAGE-DESCRIPTOR.                                      00045504
015400     COPY CMQMDV.                                                 00045604
015500                                                                  00045704
015600*-----------------------------------------------------------      00045804
015700* GET-MESSAGE-OPTIONS - MQ SERIES                                 00045904
015800*-----------------------------------------------------------      00046004
015900 01  MQM-GET-MESSAGE-OPTIONS.                                     00046104
016000     COPY CMQGMOV.                                                00046204
016010                                                                  00046304
016020*-----------------------------------------------------------      00046404
016030* PUT-MESSAGE-OPTIONS - MQ SERIES                                 00046504
016040*-----------------------------------------------------------      00046604
016050 01  MQM-PUT-MESSAGE-OPTIONS.                                     00046704
016060     COPY CMQPMOV.                                                00046804
016070                                                                  00046904
016080*-----------------------------------------------------------      00047004
016090* CONSTANTS - MQ SERIES                                           00047104
016100*-----------------------------------------------------------      00047204
016200 01  MQM-CONSTANTS.                                               00047304
016300     COPY CMQV.                                                   00047404
016400                                                                  00047504
016500*-----------------------------------------------------------      00047604
016600* PROGRAM COUNTERS                                                00047704
016700*-----------------------------------------------------------      00047804
016800 01  PC-PROGRAM-COUNTERS.                                         00047904
016900     05  PC-MESSAGE-FROM-QUEUE        PIC 9(09) VALUE ZEROS.      00048004
017000     05  PC-MESSAGES-WRITTEN-TO-FILE  PIC 9(09) VALUE ZEROS.      00048104
017100     05  PC-MESSAGES-TO-ERR-QUEUE     PIC 9(09) VALUE ZEROS.      00048204
017200     05  PC-MESSAGE-ALL               PIC 9(09) VALUE ZEROS.      00048304
017300     05  PC-MESSAGE-010               PIC 9(09) VALUE ZEROS.      00048404
017400     05  PC-MESSAGE-020               PIC 9(09) VALUE ZEROS.      00048504
017500     05  PC-MESSAGE-030               PIC 9(09) VALUE ZEROS.      00048604
017600     05  PC-MESSAGE-040               PIC 9(09) VALUE ZEROS.      00048704
017700     05  PC-MESSAGE-050               PIC 9(09) VALUE ZEROS.      00048804
017800     05  PC-MESSAGE-060               PIC 9(09) VALUE ZEROS.      00048904
017900     05  PC-MESSAGE-070               PIC 9(09) VALUE ZEROS.      00049004
018000     05  PC-MESSAGE-080               PIC 9(09) VALUE ZEROS.      00049104
018100     05  PC-MESSAGE-090               PIC 9(09) VALUE ZEROS.      00049204
018200     05  PC-MESSAGE-100               PIC 9(09) VALUE ZEROS.      00049304
018300     05  PC-MESSAGE-110               PIC 9(09) VALUE ZEROS.      00049404
018400     05  PC-MESSAGE-120               PIC 9(09) VALUE ZEROS.      00049504
018400     05  PC-MESSAGE-130               PIC 9(09) VALUE ZEROS.      00049604
018500     05  PC-STAT-00                   PIC 9(09) VALUE ZEROS.      00049704
018600     05  PC-STAT-01                   PIC 9(09) VALUE ZEROS.      00049804
018700     05  PC-STAT-02                   PIC 9(09) VALUE ZEROS.      00049904
018800     05  PC-STAT-03                   PIC 9(09) VALUE ZEROS.      00050004
018810     05  PC-STAT-04                   PIC 9(09) VALUE ZEROS.      00050104
018900     05  PC-STAT-05-01                PIC 9(09) VALUE ZEROS.      00050204
019000     05  PC-STAT-05-02                PIC 9(09) VALUE ZEROS.      00050304
019100     05  PC-STAT-06-01                PIC 9(09) VALUE ZEROS.      00050404
019200     05  PC-STAT-06-02                PIC 9(09) VALUE ZEROS.      00050504
101310     05  PC-ACTUAL-COMMITS            PIC 9(09) VALUE ZEROS.      00050604
019300                                                                  00050704
019400*-----------------------------------------------------------      00050804
019500* ERROR HANDLING                                                  00050904
019600*-----------------------------------------------------------      00051004
019700 01  PV-MISC-ABEND-FIELDS.                                        00051104
019800     05  PV-PARAGRAPH-NAME            PIC X(30) VALUE SPACE.      00051204
019900     05  PV-OPERATION-MSG-1           PIC X(40) VALUE SPACE.      00051304
020000     05  PV-OPERATION-MSG-2           PIC X(40) VALUE SPACE.      00051404
020100     05  PV-DB2-OPERATION             PIC X(30) VALUE SPACE.      00051504
020110     05  PV-COMPLETION-CODE           PIC S9(09) BINARY.          00051604
020120     05  PV-REASON                    PIC S9(09) BINARY.          00051704
020130     05  PV-REASON-TEXT               PIC X(30)  VALUE SPACES.    00051804
020200 01  ABEND-CODE                  PIC S9(4) VALUE ZEROS COMP SYNC. 00051904
020300     88  ABEND-4003-CTRL-CARD-ERROR        VALUE +4003.           00052004
020400     88  ABEND-4013-DB2-ERROR              VALUE +4013.           00052104
020500     88  ABEND-4019-CAL-SUB-ERROR          VALUE +4019.           00052204
020600     88  ABEND-4020-MQ-ERROR               VALUE +4020.           00052304
020700     88  ABEND-4444-FORCED-ABEND           VALUE +4444.           00052404
020800                                                                  00052504
020900*-----------------------------------------------------------      00052604
021000* DB2 COMMUNICATIONS AREA                                         00052704
021100*-----------------------------------------------------------      00052804
021200     EXEC SQL                                                     00052904
021300          INCLUDE SQLCA                                           00053004
021400     END-EXEC.                                                    00053104
021500                                                                  00053204
021600*-----------------------------------------------------------      00053304
021700* DB2 TABLE XST00037(XST_INFC_CNTL) - PROMO INTERFACE CONTROL     00053404
021800*                                             TABLE               00053504
021900*-----------------------------------------------------------      00053604
022000     EXEC SQL                                                     00053704
022100          INCLUDE XST00037                                        00053804
022200     END-EXEC.                                                    00053904
022300                                                                  00054004
022600*-----------------------------------------------------------      00054104
022700* LV- LINKAGE VARIABLES                                           00054204
022800*-----------------------------------------------------------      00054304
022900 01 LV-LINKAGE-VARIABLES.                                         00054404
023000    05  LV-BUS-EVENT-RECORD        PIC X(300) VALUE SPACES.       00054504
023100    05  LV-MAX-OFFSET-DTE          PIC X(08) VALUE SPACES.        00054604
023200    05  LV-LD-SQL-RETURN-CDE       PIC S9(4) VALUE +0.            00054704
023300    05  LV-PGM-STATUS-CDE          PIC X(02) VALUE SPACES.        00054804
023400    05  LV-LD-SEVERITY-LVL         PIC X(02) VALUE SPACES.        00054904
023500                                                                  00055004
023600*----------------------------------------------------------       00055104
023700 PROCEDURE DIVISION.                                              00055204
023800*----------------------------------------------------------       00055304
023900 0000-MAINLINE.                                                   00055404
024000                                                                  00055504
024100     PERFORM 1000-INITIALIZATION.                                 00055604
024200                                                                  00055704
024300     PERFORM 2000-PROCESS-RECORDS                                 00055804
024400             UNTIL PS-PROCESS-COMPLETE.                           00055904
024500                                                                  00056004
024600     PERFORM 9000-WRAPUP.                                         00056104
024900                                                                  00056204
024910     GOBACK.                                                      00056304
024920                                                                  00056404
025000*0000-EXIT.                                                       00056504
025100 EJECT.                                                           00056604
025200                                                                  00056704
025300*----------------------------------------------------------       00056804
025400* 1000-INITIALIZATION.                                            00056904
025500*     INITIALIZATION AREA - GETS THE CURRENT DATE, INITIALIZES    00057004
025510*     PROGRAM COUNTERS, READS CONTROL CARDS, GETS THE OFFSET DATE 00057104
025520*     AND SETS UP QUEUES FOR PROCESSING.                          00057204
025530*----------------------------------------------------------       00057304
025540 1000-INITIALIZATION.                                             00057404
025550                                                                  00057504
025560     EXEC SQL                                                     00057604
025570         SET :PV-CURRENT-DATE = CURRENT DATE                      00057704
025580     END-EXEC.                                                    00057804
025590                                                                  00057904
025600     MOVE PV-CURRENT-DATE TO PV-SAVE-CCYY-MM-DD.                  00058004
025700     DISPLAY 'CURRENT DATE: ' PV-SAVE-CCYY-MM-DD.                 00058104
025710                                                                  00058204
025800     INITIALIZE PC-PROGRAM-COUNTERS.                              00058304
025900                                                                  00058404
026000     OPEN INPUT  CONTROL-CARD-1                                   00058504
026100                 CONTROL-CARD-2                                   00058604
026200                 CONTROL-CARD-3                                   00058704
026300                 CONTROL-CARD-4                                   00058804
026400          OUTPUT MESSAGE-LOG.                                     00058904
026500                                                                  00059004
026600     PERFORM 1010-READ-CONTROL-CARD-1.                            00059104
026700     PERFORM 1020-READ-CONTROL-CARD-2.                            00059204
026800     PERFORM 1030-READ-CONTROL-CARD-3.                            00059304
026810     PERFORM 1040-READ-CONTROL-CARD-4.                            00059404
026820                                                                  00059504
026830     IF  CC-QUEUE-MANAGER-NAME    =  SPACES                       00059604
026840      OR CC-BUS-EVNT-QUEUE-NAME   =  SPACES                       00059704
026850      OR CC-ERROR-QUEUE-NAME      =  SPACES                       00059804
026860      OR CC-BUS-DAYS-NBR          =  SPACES                       00059904
026870         DISPLAY 'EMPTY CONTROL CARD'                             00060004
026880         DISPLAY 'QUEUE MANAGER NAME: ' CC-QUEUE-MANAGER-NAME     00060104
026890         DISPLAY 'BUS EVENT QUEUE NAME: ' CC-BUS-EVNT-QUEUE-NAME  00060204
026900         DISPLAY 'ERROR QUEUE NAME: ' CC-ERROR-QUEUE-NAME         00060304
027000         DISPLAY 'BUSINESS DAYS #: ' CC-BUS-DAYS-NBR              00060404
027100         MOVE '1000-INITIALIZATION' TO PV-PARAGRAPH-NAME          00060504
027200         MOVE 'CONTROL CARD IS EMPTY' TO PV-OPERATION-MSG-1       00060604
027300         SET ABEND-4003-CTRL-CARD-ERROR TO TRUE                   00060704
027400         PERFORM 9300-ABEND                                       00060804
027500     END-IF.                                                      00060904
027600                                                                  00061004
027700     MOVE CC-BUS-DAYS-NBR TO PV-BUS-DAYS.                         00061104
027800     MOVE PV-BUS-DAYS     TO PV-BUS-DAYS-NBR.                     00061204
027900     MOVE PV-BUS-DAYS-NBR TO PV-BUS-DAYS-AHEAD.                   00061304
027910     PERFORM 1400-SELECT-DATA.                                    00061404
027920     PERFORM 1500-FUTURE-OFFSET-DTE.                              00061504
027930     PERFORM 1600-GET-BUS-DAYS.                                   00061604
027940     PERFORM 1700-FORMAT-OFFST-DTE.                               00061704
027950     MOVE PV-FUT-OFFST-BUS-DTE TO LV-MAX-OFFSET-DTE.              00061804
027960                                                                  00061904
027970     PERFORM 1100-CONNECT-TO-QMGR.                                00062004
027980     PERFORM 1200-OPEN-BUS-EVNT-QUEUE.                            00062104
027990     PERFORM 1300-OPEN-ERROR-QUEUE.                               00062204
028000                                                                  00062304
028100     PERFORM 3000-RETRIEVE-MESSAGE.                               00062404
028200                                                                  00062504
028300*1000-EXIT.                                                       00062604
028400 EJECT.                                                           00062704
028500                                                                  00062804
028510*----------------------------------------------------------       00062904
028520* 1010-READ-CONTROL-CARD-1.                                       00063004
028530*     READ CONTROL CARD 1.  THIS GETS THE QUEUE MANAGER NAME.     00063104
028540*----------------------------------------------------------       00063204
028550 1010-READ-CONTROL-CARD-1.                                        00063304
028560                                                                  00063404
028570     READ CONTROL-CARD-1 INTO CC-CONTROL-CARD-1-LAYOUT.           00063504
028580                                                                  00063604
028590*1010-EXIT.                                                       00063704
028591 EJECT.                                                           00063804
028592                                                                  00063904
028593*----------------------------------------------------------       00064004
028594* 1020-READ-CONTROL-CARD-2.                                       00064104
028595*     READ CONTROL CARD 2.  THIS GETS THE BUSINESS EVENT QUEUE    00064204
028596*     NAME.                                                       00064304
028597*----------------------------------------------------------       00064404
028598 1020-READ-CONTROL-CARD-2.                                        00064504
028599                                                                  00064604
028600     READ CONTROL-CARD-2 INTO CC-CONTROL-CARD-2-LAYOUT.           00064704
028601                                                                  00064804
028602*1020-EXIT.                                                       00064904
028603 EJECT.                                                           00065004
028604                                                                  00065104
028605*----------------------------------------------------------       00065204
028606* 1030-READ-CONTROL-CARD-3.                                       00065304
028607*     READ CONTROL CARD 3.  THIS GETS THE ERROR QUEUE NAME.       00065404
028608*----------------------------------------------------------       00065504
028609 1030-READ-CONTROL-CARD-3.                                        00065604
028610                                                                  00065704
028611     READ CONTROL-CARD-3 INTO CC-CONTROL-CARD-3-LAYOUT.           00065804
028612                                                                  00065904
028613*1030-EXIT.                                                       00066004
028614 EJECT.                                                           00066104
028615                                                                  00066204
028616*----------------------------------------------------------       00066304
028617* 1040-READ-CONTROL-CARD-4.                                       00066404
028618*     READ CONTROL CARD 4.  THIS GETS THE NUMBER OF BUSINESS DAYS.00066504
028619*----------------------------------------------------------       00066604
028620 1040-READ-CONTROL-CARD-4.                                        00066704
028621                                                                  00066804
028622     READ CONTROL-CARD-4 INTO CC-CONTROL-CARD-4-LAYOUT.           00066904
028623                                                                  00067004
028624*1040-EXIT.                                                       00067104
028625 EJECT.                                                           00067204
028626                                                                  00067304
028630*----------------------------------------------------------       00067404
028700* 1100-CONNECT-TO-QMGR.                                           00067504
028800*     CONNECT TO THE QUEUE MANAGER.                               00067604
028900*----------------------------------------------------------       00067704
029000 1100-CONNECT-TO-QMGR.                                            00067804
029100                                                                  00067904
029200     CALL MQV-MQCONN USING CC-QUEUE-MANAGER-NAME                  00068004
029300                           MQV-HCONN                              00068104
029400                           MQV-COMPLETION-CODE                    00068204
029500                           MQV-REASON.                            00068304
029600                                                                  00068404
029700     EVALUATE TRUE                                                00068504
029800        WHEN MQV-COMPLETION-CODE = MQCC-OK                        00068604
029810             DISPLAY ' '                                          00068704
029900             DISPLAY 'SUCCESSFULLY CONNECTED TO: '                00068804
030000                                            CC-QUEUE-MANAGER-NAME 00068904
030100        WHEN OTHER                                                00069004
030200             CALL MQV-MQCHECK USING MQV-REASON                    00069104
030300                                    MQV-REASON-TEXT               00069204
030400             DISPLAY 'QUEUE CONNECTING TO ' CC-QUEUE-MANAGER-NAME 00069304
030500             MOVE '1100-CONNECT-TO-QMGR' TO PV-PARAGRAPH-NAME     00069404
030600             MOVE 'UNABLE TO CONNECT'  TO PV-OPERATION-MSG-1      00069504
030610             MOVE MQV-COMPLETION-CODE    TO PV-COMPLETION-CODE    00069604
030620             MOVE MQV-REASON             TO PV-REASON             00069704
030630             MOVE MQV-REASON-TEXT        TO PV-REASON-TEXT        00069804
030700             PERFORM 9400-MQ-ABEND                                00069904
030800     END-EVALUATE.                                                00070004
030900                                                                  00070104
031000*1100-EXIT.                                                       00070204
031100 EJECT.                                                           00070304
031110                                                                  00070404
031120*----------------------------------------------------------       00070504
031130* 1200-OPEN-BUS-EVNT-QUEUE.                                       00070604
031140*     OPEN THE BUSINESS EVENT QUEUE.                              00070704
031150*----------------------------------------------------------       00070804
031160 1200-OPEN-BUS-EVNT-QUEUE.                                        00070904
031170                                                                  00071004
031180     MOVE CC-BUS-EVNT-QUEUE-NAME   TO MQOD-OBJECTNAME             00071104
031190     MOVE CC-QUEUE-MANAGER-NAME    TO MQOD-OBJECTQMGRNAME.        00071204
031200                                                                  00071304
031300     COMPUTE MQV-OPEN-OPTIONS      = MQOO-INPUT-SHARED            00071404
031500                                   + MQOO-SAVE-ALL-CONTEXT        00071504
031600                                   + MQOO-FAIL-IF-QUIESCING.      00071604
031700                                                                  00071704
031800     CALL MQV-MQOPEN USING MQV-HCONN                              00071804
031900                           MQM-OBJECT-DESCRIPTOR                  00071904
032000                           MQV-OPEN-OPTIONS                       00072004
032100                           MQV-PROMO-HANDLE                       00072104
032200                           MQV-COMPLETION-CODE                    00072204
032300                           MQV-REASON.                            00072304
032400                                                                  00072404
032500     EVALUATE TRUE                                                00072504
032600        WHEN MQV-COMPLETION-CODE = MQCC-OK                        00072604
032700             DISPLAY 'SUCCESSFULLY OPENED QUEUE: '                00072704
032800                                           CC-BUS-EVNT-QUEUE-NAME 00072804
032900        WHEN OTHER                                                00072904
033000             CALL MQV-MQCHECK USING MQV-REASON                    00073004
033100                                   MQV-REASON-TEXT                00073104
033200             DISPLAY 'CANNOT OPEN QUEUE ' CC-BUS-EVNT-QUEUE-NAME  00073204
033300             MOVE '1200-OPEN-BUS-EVNT-QUEUE' TO PV-PARAGRAPH-NAME 00073304
033400             MOVE 'CANNOT OPEN QUEUE'  TO PV-OPERATION-MSG-1      00073404
033410             MOVE MQV-COMPLETION-CODE    TO PV-COMPLETION-CODE    00073504
033420             MOVE MQV-REASON             TO PV-REASON             00073604
033430             MOVE MQV-REASON-TEXT        TO PV-REASON-TEXT        00073704
033500             PERFORM 9200-DISCONNECT-QMGR                         00073804
033600             PERFORM 9400-MQ-ABEND                                00073904
033700     END-EVALUATE.                                                00074004
033800                                                                  00074104
033900*1200-EXIT.                                                       00074204
034000 EJECT.                                                           00074304
034100                                                                  00074404
034200*----------------------------------------------------------       00074504
034300* 1300-OPEN-ERROR-QUEUE.                                          00074604
034400*     OPEN THE ERROR QUEUE.                                       00074704
034500*----------------------------------------------------------       00074804
034600 1300-OPEN-ERROR-QUEUE.                                           00074904
034700                                                                  00075004
034800     MOVE CC-ERROR-QUEUE-NAME          TO MQOD-OBJECTNAME         00075104
034900     MOVE CC-QUEUE-MANAGER-NAME        TO MQOD-OBJECTQMGRNAME.    00075204
035000                                                                  00075304
035100     COMPUTE MQV-OPEN-OPTIONS      = MQOO-OUTPUT                  00075404
035300                                   + MQOO-SET-ALL-CONTEXT         00075504
035400                                   + MQOO-FAIL-IF-QUIESCING.      00075604
035500                                                                  00075704
035600     CALL MQV-MQOPEN USING MQV-HCONN                              00075804
035700                           MQM-OBJECT-DESCRIPTOR                  00075904
035800                           MQV-OPEN-OPTIONS                       00076004
035900                           MQV-ERROR-HANDLE                       00076104
036000                           MQV-COMPLETION-CODE                    00076204
036100                           MQV-REASON.                            00076304
036200                                                                  00076404
036300     EVALUATE TRUE                                                00076504
036400        WHEN MQV-COMPLETION-CODE = MQCC-OK                        00076604
036500             DISPLAY 'SUCCESSFULLY OPENED QUEUE: '                00076704
036600                                          CC-ERROR-QUEUE-NAME     00076804
036700        WHEN OTHER                                                00076904
036800             CALL MQV-MQCHECK USING MQV-REASON                    00077004
036900                                    MQV-REASON-TEXT               00077104
037000             MOVE '1300-OPEN-ERROR-QUEUE' TO PV-PARAGRAPH-NAME    00077204
037100             MOVE 'CANNOT OPEN QUEUE'  TO PV-OPERATION-MSG-1      00077304
037110             MOVE MQV-COMPLETION-CODE    TO PV-COMPLETION-CODE    00077404
037120             MOVE MQV-REASON             TO PV-REASON             00077504
037130             MOVE MQV-REASON-TEXT        TO PV-REASON-TEXT        00077604
037200             PERFORM 9200-DISCONNECT-QMGR                         00077704
037300             PERFORM 9400-MQ-ABEND                                00077804
037400     END-EVALUATE.                                                00077904
037500                                                                  00078004
037600*1300-EXIT.                                                       00078104
037700 EJECT.                                                           00078204
037800                                                                  00078304
037900*------------------------------------------------------           00078404
038000* 1400-SELECT-DATA.                                               00078504
038100*     SELECT THE FUTURE DAY OFFSET NUMBER FROM THE                00078604
038200*     XST_INTFC_CNTL TABLE.                                       00078704
038210*------------------------------------------------------           00078804
038220 1400-SELECT-DATA.                                                00078904
038230                                                                  00079004
038240     PERFORM                                                      00079104
038250         WITH TEST AFTER                                          00079204
038260         VARYING PV-SQL-SUB                                       00079304
038270         FROM 1 BY 1                                              00079404
038280         UNTIL (PV-SQL-SUB GREATER PC-MAX-RETRIES                 00079504
038290                   OR  SQLCODE = 0)                               00079604
038293                                                                  00079704
038294         EXEC SQL                                                 00079804
038295             SELECT  MAX(FUT_DAY_OFFST_NBR)                       00079904
038296               INTO :XST00037-FUT-DAY-OFFST-NBR                   00080004
038297               FROM  XST_INTFC_CNTL                               00080104
038298               WITH UR                                            00080204
038299         END-EXEC                                                 00080304
038300                                                                  00080404
038301         EVALUATE TRUE                                            00080504
038302             WHEN SQLCODE = -904                                  00080604
038303             WHEN SQLCODE = -911                                  00080704
038304             WHEN SQLCODE = -913                                  00080804
038305                  CONTINUE                                        00080904
038306             WHEN SQLCODE = 0                                     00081004
038307                  MOVE XST00037-FUT-DAY-OFFST-NBR TO              00081104
038308                                     PV-FUT-OFFST-NBR             00081204
038309                  MOVE PV-FUT-OFFST-NBR TO PV-SAVE-DAYS-AHEAD     00081304
038310             WHEN OTHER                                           00081404
038311                  MOVE '1400-SELECT-DATA'                         00081504
038312                                TO  PV-PARAGRAPH-NAME             00081604
038313                  MOVE 'SELECT MAX OFFSET NBR'                    00081704
038314                                TO  PV-DB2-OPERATION              00081804
038315                  PERFORM 9500-SQL-ABEND-ROUTINE                  00081904
038316         END-EVALUATE                                             00082004
038317     END-PERFORM.                                                 00082104
038318                                                                  00082204
038319     IF PV-SQL-SUB GREATER PC-MAX-RETRIES                         00082304
038320        MOVE '1400-SELECT-DATA'                                   00082404
038321                              TO  PV-PARAGRAPH-NAME               00082504
038322        MOVE 'SELECT RETRIES EXCEEDED'                            00082604
038323                              TO  PV-DB2-OPERATION                00082704
038324        PERFORM 9500-SQL-ABEND-ROUTINE                            00082804
038325     END-IF.                                                      00082904
038326                                                                  00083004
038327*1400-EXIT.                                                       00083104
038328 EJECT.                                                           00083204
038329                                                                  00083304
038330*----------------------------------------------------------       00083404
038331* 1500-FUTURE-OFFSET-DTE.                                         00083504
038340*     GETS THE FUTURE OFFSET DATE BASED ON THE NUMBER FOUND       00083604
038341*     IN THE XST_INTFC_CNTL TABLE.                                00083704
038342*----------------------------------------------------------       00083804
038343 1500-FUTURE-OFFSET-DTE.                                          00083904
038344                                                                  00084004
038345     INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              00084104
038346     MOVE PV-SAVE-CCYY-MM-DD           TO DPG52-LK-DATE-INPUT.    00084204
038347     SET  DPG51-ACTUAL-CALENDAR-ONLY   TO TRUE.                   00084304
038348     SET  DPG52-LK-DTE-ISO-FMT         TO TRUE.                   00084404
038349     SET  DPG51-INCREMENT-DATE         TO TRUE.                   00084504
038350     MOVE PV-SAVE-DAYS-AHEAD           TO DPG51-INCR-DECR-DAYS-X. 00084604
038351                                                                  00084704
038352     CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51 DPG52 DPG53    00084804
038353                                             DPG54 DPG55 DPG56.   00084904
038354     EVALUATE TRUE                                                00085004
038355         WHEN DPG54-NO-ERROR                                      00085104
038357             DISPLAY 'DAYS AHEAD NEEDED: ' PV-SAVE-DAYS-AHEAD     00085204
038358             DISPLAY 'RETRIEVING FUTURE OFFSET DATE'              00085304
038361         WHEN DPG54-SEVERE-ERROR                                  00085404
038362             DISPLAY ' '                                          00085504
038363             DISPLAY '** ABEND ** IN XSKUT134'                    00085604
038364             DISPLAY '** INVALID RETURN FROM CALENDAR ROUTINE'    00085704
038365             DISPLAY '** CALLED BY 1500-FUTURE-OFFSET-DTE'        00085804
038366             DISPLAY '** ERROR MESSAGE = '                        00085904
038367                               DPG54-ERROR-MESSAGE                00086004
038368             DISPLAY '** DPG51 = ' DPG51                          00086104
038369             DISPLAY '** DPG52 = ' DPG52                          00086204
038370             DISPLAY '** DPG53 = ' DPG53                          00086304
038371             DISPLAY '** DPG54 = ' DPG54                          00086404
038372             DISPLAY '** DPG55 = ' DPG55                          00086504
038373             DISPLAY '** DPG56 = ' DPG56                          00086604
038374             MOVE '1500-FUTURE-OFFSET-DTE'                        00086704
038375                                           TO PV-PARAGRAPH-NAME   00086804
038376             MOVE 'ERROR VALIDATING INPUT DATE'                   00086904
038377                                           TO PV-OPERATION-MSG-1  00087004
038378             SET ABEND-4019-CAL-SUB-ERROR  TO TRUE                00087104
038379             MOVE DPG54-ERROR-MESSAGE      TO PV-OPERATION-MSG-2  00087204
038380             PERFORM 9300-ABEND                                   00087304
038381     END-EVALUATE.                                                00087404
038382                                                                  00087504
038383     MOVE DPG55-DB2-ISO-DATE-FMT TO PV-FUTURE-OFFSET-DTE.         00087604
038384     DISPLAY 'NEW FUTURE OFFSET DATE: ' PV-FUTURE-OFFSET-DTE.     00087704
038385                                                                  00087804
038386*1500-EXIT.                                                       00087904
038387 EJECT.                                                           00088004
038388                                                                  00088104
038389*----------------------------------------------------------       00088204
038390* 1600-GET-BUS-DAYS.                                              00088304
038391*     INCREASES THE FUTURE OFFSET DATE BY THE AMOUNT OF BUSINESS  00088404
038400*     DAYS FOUND IN CONTROL CARD 4.                               00088504
038410*----------------------------------------------------------       00088604
038420 1600-GET-BUS-DAYS.                                               00088704
038421                                                                  00088804
038422     INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              00088904
038423     SET DPG51-ACTUAL-CALENDAR-ONLY  TO TRUE.                     00089004
038424     SET DPG51-INCREMENT-DATE      TO TRUE.                       00089104
038425     MOVE PV-BUS-DAYS-AHEAD        TO DPG51-INCR-DECR-BUS-DAYS-9. 00089204
038426     SET DPG52-LK-DTE-ISO-FMT      TO TRUE.                       00089304
038427     MOVE PV-FUTURE-OFFSET-DTE     TO DPG52-LK-DATE-INPUT.        00089404
038428                                                                  00089504
038429     CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51 DPG52          00089604
038430                                             DPG53 DPG54          00089704
038440                                             DPG55 DPG56.         00089804
038450                                                                  00089904
038460     EVALUATE TRUE                                                00090004
038461         WHEN DPG54-NO-ERROR                                      00090104
038464             DISPLAY 'BUSINESS DAYS AHEAD: ' PV-BUS-DAYS-AHEAD    00090204
038465             DISPLAY 'RETRIEVING FUTURE OFFSET BUSINESS DATE'     00090304
038466         WHEN DPG54-SEVERE-ERROR                                  00090404
038467              DISPLAY '** ABEND - PROGRAM '                       00090504
038468                       PC-CURRENT-PROGRAM-NAME ' **'              00090604
038469              DISPLAY '** 1600-GET-BUS-DAYS'                      00090704
038470              DISPLAY '** CALL TO DPKUT500 RETURNED SEVERE ERROR' 00090804
038471              IF DPG54-CALENDAR-TYPE-INVALID                      00090904
038472                 DISPLAY '** DPG54-CALENDAR-TYPE-INVALID'         00091004
038473                 DISPLAY '** DPG51-CALENDAR-TYPE: '               00091104
038480                          DPG51-CALENDAR-TYPE                     00091204
038481              END-IF                                              00091304
038482              IF DPG54-DATE-INVALID                               00091404
038483                 DISPLAY '** DPG54-DATE-INVALID'                  00091504
038484                 DISPLAY '** DPG52-LK-DATE-INPUT: '               00091604
038485                          DPG52-LK-DATE-INPUT                     00091704
038486              END-IF                                              00091804
038487              IF DPG54-INCR-DECR-INVALID                          00091904
038488                 DISPLAY '** DPG54-INCR-DECR-INVALID'             00092004
038489                 DISPLAY '** DPG51-INCREMENT-DECREMENT-FLAG: '    00092104
038490                          DPG51-INCREMENT-DECREMENT-FLAG          00092204
038491              END-IF                                              00092304
038492              MOVE '1500-GET-DATE'                                00092404
038493                                            TO PV-PARAGRAPH-NAME  00092504
038494              MOVE 'ERROR VALIDATING INPUT DATE'                  00092604
038495                                            TO PV-OPERATION-MSG-1 00092704
038496              MOVE DPG54-ERROR-MESSAGE TO PV-OPERATION-MSG-2      00092804
038497              SET ABEND-4019-CAL-SUB-ERROR TO TRUE                00092904
038498              PERFORM 9300-ABEND                                  00093004
038499     END-EVALUATE.                                                00093104
038500                                                                  00093204
038501     MOVE DPG55-DB2-ISO-DATE-FMT TO PV-PRCS-BUS-DTE.              00093304
038502     DISPLAY 'NEW FUTURE OFFSET BUSINESS DATE: ' PV-PRCS-BUS-DTE. 00093404
038503                                                                  00093504
038504*1600-EXIT.                                                       00093604
038505 EJECT.                                                           00093704
038506                                                                  00093804
038507*----------------------------------------------------------       00093904
038508* 1700-FORMAT-OFFST-DTE.                                          00094004
038509*     FORMATS THE DATE SO IT CAN BE SENT TO THE CALLED            00094104
038510*     PROGRAM.                                                    00094204
038511*----------------------------------------------------------       00094304
038512 1700-FORMAT-OFFST-DTE.                                           00094404
038513                                                                  00094504
038514     MOVE PV-PRCS-BUS-CCYY   TO PV-FUT-BUS-CCYY.                  00094604
038515     MOVE PV-PRCS-BUS-MM     TO PV-FUT-BUS-MM.                    00094704
038516     MOVE PV-PRCS-BUS-DD     TO PV-FUT-BUS-DD.                    00094804
038517                                                                  00094904
038518*1700-EXIT.                                                       00095004
038519 EJECT.                                                           00095104
038520                                                                  00095204
038521*----------------------------------------------------------       00095304
038530* 2000-PROCESS-RECORDS.                                           00095404
038540*     READ BUSINESS EVENT MESSAGE AND BASED ON THE CORRECT        00095504
038550*     BUSINESS EVENT; CALL THE CORRECT PROGRAM TO EXECUTE THE     00095604
038560*     BUSINESS LOGIC.                                             00095704
038570*----------------------------------------------------------       00095804
038580 2000-PROCESS-RECORDS.                                            00095904
038590                                                                  00096004
038600*INITIALIZE VARIABLES FOR EACH MESSAGE RETRIEVED                  00096104
038700     INITIALIZE MESSAGE-LOG-RECORD.                               00096204
038800     INITIALIZE LV-BUS-EVENT-RECORD                               00096304
038900                LV-LD-SQL-RETURN-CDE                              00096404
039000                LV-PGM-STATUS-CDE                                 00096504
039100                LV-LD-SEVERITY-LVL.                               00096604
039200                                                                  00096904
039300     MOVE PV-BUS-EVNT-ID  TO PV-SAVE-BUS-EVNT-ID.                 00097004
039400                                                                  00097104
039500     EVALUATE TRUE                                                00097204
039600                                                                  00097304
039700**010 - AD EVENT                                                  00097404
039800        WHEN PV-AD-EVENT                                          00097504
040100             ADD +1                      TO PC-MESSAGE-010        00097604
040200                                            PC-MESSAGE-ALL        00097704
040300             SET PC-CALLED-XSKUP028      TO TRUE                  00097804
040400             PERFORM 2100-CALL-PROGRAM                            00097904
040500                                                                  00098004
040600**020 - PROMOTION                                                 00098104
040700        WHEN PV-PROMOTION                                         00098204
040730             ADD +1                      TO PC-MESSAGE-020        00098304
040740                                            PC-MESSAGE-ALL        00098404
040750             SET PC-CALLED-XSKUP031      TO TRUE                  00098504
040760             PERFORM 2100-CALL-PROGRAM                            00098604
040770                                                                  00098704
040780**030 - PRICE VERSION                                             00098804
040790        WHEN PV-PRICE-VERSION                                     00098904
041000             ADD +1                      TO PC-MESSAGE-030        00099004
041100                                            PC-MESSAGE-ALL        00099104
041200             SET PC-CALLED-XSKUP032      TO TRUE                  00099204
041300             PERFORM 2100-CALL-PROGRAM                            00099304
041400                                                                  00099404
041500**040 - ADHOC STORE GROUP                                         00099504
041600        WHEN PV-ADHOC-STR-GRP                                     00099604
041900             ADD +1                      TO PC-MESSAGE-040        00099704
042000                                            PC-MESSAGE-ALL        00099804
042100             SET PC-CALLED-XSKUP033      TO TRUE                  00099904
042200             PERFORM 2100-CALL-PROGRAM                            00100004
042300                                                                  00100104
042400**050 - ADHOC STORE LIST                                          00100204
042500        WHEN PV-ADHOC-STR-LIST                                    00100304
042530             ADD +1                      TO PC-MESSAGE-050        00100404
042540                                            PC-MESSAGE-ALL        00100504
042550             SET PC-CALLED-XSKUP034      TO TRUE                  00100604
042560             PERFORM 2100-CALL-PROGRAM                            00100704
042570                                                                  00100804
044500**090 - PRICING                                                   00100904
044600        WHEN PV-PRICING                                           00101004
044900             ADD +1                      TO PC-MESSAGE-090        00101104
045000                                            PC-MESSAGE-ALL        00101204
045100             SET PC-CALLED-XSKUP035      TO TRUE                  00101304
045200             PERFORM 2100-CALL-PROGRAM                            00101404
045300                                                                  00101504
045580**110 - PRICING EXCLUSIONS                                        00101604
045590        WHEN PV-PRICING-EXCLUSIONS                                00101704
045900             ADD +1                      TO PC-MESSAGE-110        00101804
046000                                            PC-MESSAGE-ALL        00101904
046100             SET PC-CALLED-XSKUP037      TO TRUE                  00102004
046200             PERFORM 2100-CALL-PROGRAM                            00102104
046300                                                                  00102204
046400**120 - PRICING STORE GROUP                                       00102304
046500        WHEN PV-PRICING-STR-GRP                                   00102404
046720             ADD +1                      TO PC-MESSAGE-120        00102504
046730                                            PC-MESSAGE-ALL        00102604
046740             SET PC-CALLED-XSKUP038      TO TRUE                  00102704
046750             PERFORM 2100-CALL-PROGRAM                            00102804
046760                                                                  00102904
046400**130 - REBATE FORM TEXT                                          00103004
046500        WHEN PV-REBATE-FORM                                       00103104
046720             ADD +1                      TO PC-MESSAGE-130        00103204
046730                                            PC-MESSAGE-ALL        00103304
046740             SET PC-CALLED-XSKUP134      TO TRUE                  00103404
046750             PERFORM 2100-CALL-PROGRAM                            00103504
046760                                                                  00103604
046770**999 - END OF DAY                                                00103704
046780        WHEN PV-END-OF-DAY                                        00103804
046790             SET PS-PROCESS-COMPLETE     TO TRUE                  00103904
046800                                                                  00104004
046801***NOT A LEGIT BUSINESS EVENT                                     00105004
046810        WHEN OTHER                                                00105104
046820             MOVE '06' TO LV-PGM-STATUS-CDE                       00105204
046830             MOVE '01' TO LV-LD-SEVERITY-LVL                      00105304
046831             MOVE 'XSKUT134'      TO PC-CALLED-PROGRAM            00105404
046900     END-EVALUATE.                                                00105604
047000                                                                  00105704
047100     MOVE LV-PGM-STATUS-CDE  TO PV-PRGM-STAT-CDE.                 00105804
047200                                                                  00105904
047300     EVALUATE TRUE                                                00106004
047400        WHEN PV-SUCCESS OR PV-UPDATE-NEEDED OR PV-INSERT          00106104
047500             PERFORM 2200-COMMIT-DATA                             00106204
047600             PERFORM 2300-COMMIT-MESSAGE                          00106304
047700             PERFORM 2400-BACKUP-MESSAGE                          00106404
047800             PERFORM 2600-PROGRAM-STAT-CNT                        00106504
047900        WHEN PV-UPDATE-NOT-NEEDED OR PV-UPDATE-BYPASS             00106604
101310             PERFORM 2200-COMMIT-DATA                             00106704
048000             PERFORM 2300-COMMIT-MESSAGE                          00106804
048100             PERFORM 2400-BACKUP-MESSAGE                          00106904
048200             PERFORM 2600-PROGRAM-STAT-CNT                        00107004
PK6955        WHEN PV-UNEXPECTED                                        00107104
PK6955             PERFORM 2200-COMMIT-DATA                             00107204
PK6955             PERFORM 2500-PUT-ON-ERROR-QUEUE                      00107304
PK6955             PERFORM 2300-COMMIT-MESSAGE                          00107404
PK6955             MOVE LV-LD-SEVERITY-LVL TO PV-SEVERITY-ERR-CDE       00107804
PK6955             PERFORM 2700-PROGRAM-ERROR-CNT                       00107904
PK6955        WHEN PV-NO-SUCCESS                                        00107104
101310             PERFORM 2200-COMMIT-DATA                             00107204
048400             PERFORM 2500-PUT-ON-ERROR-QUEUE                      00107304
048500             PERFORM 2300-COMMIT-MESSAGE                          00107404
048600             MOVE LV-LD-SEVERITY-LVL TO PV-SEVERITY-ERR-CDE       00107804
048700             PERFORM 2700-PROGRAM-ERROR-CNT                       00107904
048900     END-EVALUATE.                                                00108404
049000                                                                  00108504
049100     IF PS-PROCESS-CONTINUE                                       00108604
049200        PERFORM 3000-RETRIEVE-MESSAGE                             00108704
049300     END-IF.                                                      00108804
049400                                                                  00108904
049500*2000-EXIT.                                                       00109004
049600 EJECT.                                                           00109104
049700                                                                  00109204
049800*----------------------------------------------------------       00109304
049900* 2100-CALL-PROGRAM.                                              00109404
050000*     CALL THE CORRECT PROGRAM TO EXECUTE MESSAGE.                00109504
050100*----------------------------------------------------------       00109604
050200 2100-CALL-PROGRAM.                                               00109704
050300                                                                  00109804
050400     MOVE PV-MESSAGE-RECORD   TO LV-BUS-EVENT-RECORD.             00109904
047100     MOVE ZEROES              TO LV-LD-SQL-RETURN-CDE.            00110004
050500                                                                  00110104
050600     CALL PC-CALLED-PROGRAM USING LV-LINKAGE-VARIABLES.           00110204
050700                                                                  00110304
050800*2100-EXIT.                                                       00110404
050900 EJECT.                                                           00110504
051000                                                                  00110604
051100*----------------------------------------------------------       00110704
051200* 2200-COMMIT-DATA.                                               00110804
051300*     COMMIT DATA TO THE DATABASE.                                00110904
051400*----------------------------------------------------------       00111004
051500 2200-COMMIT-DATA.                                                00111104
051600                                                                  00111204
051700     PERFORM                                                      00111304
051800         WITH TEST AFTER                                          00111404
051900         VARYING PV-SQL-SUB                                       00111504
052000         FROM 1 BY 1                                              00111604
052100         UNTIL (PV-SQL-SUB GREATER PC-MAX-RETRIES                 00111704
052200                   OR  SQLCODE = 0)                               00111804
052300                                                                  00111904
052400         EXEC SQL                                                 00112004
052500             COMMIT                                               00112104
052600         END-EXEC                                                 00112204
052700                                                                  00112304
052800         EVALUATE TRUE                                            00112404
052900             WHEN SQLCODE = -904                                  00112504
053000             WHEN SQLCODE = -911                                  00112604
053100             WHEN SQLCODE = -913                                  00112704
053300                  CONTINUE                                        00112804
053200             WHEN SQLCODE = 0                                     00112904
053300                  ADD 1 TO PC-ACTUAL-COMMITS                      00113004
053400             WHEN OTHER                                           00113104
053500                  DISPLAY 'UNABLE TO COMMIT DATA'                 00113204
053600                  PERFORM 3100-BACK-OUT-MQV-CHANGES               00113304
053700                  PERFORM 9200-DISCONNECT-QMGR                    00113404
053800                  MOVE '2200-COMMIT-DATA' TO PV-PARAGRAPH-NAME    00113504
053900                  MOVE 'COMMIT DID NOT WORK' TO PV-DB2-OPERATION  00113604
054000                  PERFORM 9500-SQL-ABEND-ROUTINE                  00113704
054100         END-EVALUATE                                             00113804
054200     END-PERFORM.                                                 00113904
054300                                                                  00114004
054400     IF  PV-SQL-SUB GREATER PC-MAX-RETRIES                        00114104
054500         PERFORM 3100-BACK-OUT-MQV-CHANGES                        00114204
054600         PERFORM 9200-DISCONNECT-QMGR                             00114304
054700         MOVE '2200-UPDATE-COMMIT'                                00114404
054800                               TO  PV-PARAGRAPH-NAME              00114504
054900         MOVE 'COMMIT RETRIES EXCEEDED'                           00114604
055000                               TO  PV-DB2-OPERATION               00114704
055100         PERFORM 9500-SQL-ABEND-ROUTINE                           00114804
055200     END-IF.                                                      00114904
055300                                                                  00115004
055400*2200-EXIT.                                                       00115104
055500 EJECT.                                                           00115204
055600                                                                  00115304
055700*----------------------------------------------------------       00115404
055800* 2300-COMMIT-MESSAGE.                                            00115504
055900*     REMOVES THE MESSAGE FROM THE QUEUE.                         00115604
056000*----------------------------------------------------------       00115704
056100 2300-COMMIT-MESSAGE.                                             00115804
056200                                                                  00115904
056300     CALL MQV-MQCMIT USING MQV-HCONN                              00116004
056400                           MQV-COMPLETION-CODE                    00116104
056500                           MQV-REASON.                            00116204
056600                                                                  00116304
056700     EVALUATE TRUE                                                00116404
056800        WHEN MQV-COMPLETION-CODE = MQCC-OK                        00116504
056900             CONTINUE                                             00116604
057000        WHEN OTHER                                                00116704
057100             CALL MQV-MQCHECK USING MQV-REASON                    00116804
057200                                    MQV-REASON-TEXT               00116904
057300             MOVE '2300-COMMIT-MESSAGE'  TO PV-PARAGRAPH-NAME     00117004
057400             MOVE 'ERROR COMMITING DATA' TO PV-OPERATION-MSG-1    00117104
057410             MOVE MQV-COMPLETION-CODE    TO PV-COMPLETION-CODE    00117204
057420             MOVE MQV-REASON             TO PV-REASON             00117304
057430             MOVE MQV-REASON-TEXT        TO PV-REASON-TEXT        00117404
057500             PERFORM 3100-BACK-OUT-MQV-CHANGES                    00117504
057600             PERFORM 9200-DISCONNECT-QMGR                         00117604
057700             PERFORM 9400-MQ-ABEND                                00117704
057800     END-EVALUATE.                                                00117804
057900                                                                  00117904
058000*2300-EXIT.                                                       00118004
058100 EJECT.                                                           00118104
058200                                                                  00118204
058300*----------------------------------------------------------       00118304
058400* 2400-BACKUP-MESSAGE.                                            00118404
058500*     WRITES THE MESSAGE TO A LOG IN CASE RECOVERY IS NEEDED.     00118504
058600*----------------------------------------------------------       00118604
058700 2400-BACKUP-MESSAGE.                                             00118704
058800                                                                  00118804
058900     MOVE MQV-MSGBUFFER TO MESSAGE-LOG-RECORD.                    00118904
059000     WRITE MESSAGE-LOG-RECORD.                                    00119004
059100                                                                  00119104
059200     ADD +1 TO PC-MESSAGES-WRITTEN-TO-FILE.                       00119204
059300                                                                  00119304
059400*2400-EXIT.                                                       00119404
059500 EJECT.                                                           00119504
059600                                                                  00119604
059700*----------------------------------------------------------       00119704
059800* 2500-PUT-ON-ERROR-QUEUE.                                        00119804
059900*     PUTS THE MESSAGE THAT HAD AN ERROR ON ERROR QUEUE.          00119904
060000*----------------------------------------------------------       00120004
060100 2500-PUT-ON-ERROR-QUEUE.                                         00120104
060200                                                                  00120204
060210     MOVE LV-LD-SQL-RETURN-CDE      TO PV-REFER-INTEGRITY-ERR.    00120304
060300     MOVE CC-ERROR-QUEUE-NAME       TO MQOD-OBJECTNAME.           00120404
060400     MOVE CC-QUEUE-MANAGER-NAME     TO MQOD-OBJECTQMGRNAME.       00120504
060500                                                                  00120604
060600     MOVE PV-MESSAGE-RECORD         TO MQV-ERRMSGBUF.             00120704
060700                                                                  00120804
060800     MOVE MQMI-NONE                 TO MQMD-MSGID.                00120904
060900     MOVE MQCI-NONE                 TO MQMD-CORRELID              00121004
060901                                       PV-NULL-VALUE.             00121104
060907                                                                  00122304
060910     IF PV-RI-ERROR                                               00122404
060920        MOVE PC-RI-ERROR-530        TO PV-MQ-CORR-ID              00122504
060921                                       PV-SQL-ERR-CDE             00122604
060930     ELSE                                                         00122704
060940        MOVE LV-LD-SQL-RETURN-CDE   TO PV-MQ-CORR-ID              00122804
060941                                       PV-SQL-ERR-CDE             00122904
060950     END-IF.                                                      00123004
060960                                                                  00123104
060970     MOVE PV-MQ-CORR-ID-CHAR        TO PV-FORMAT-MQ-CORR-ID.      00123204
060971     MOVE PV-FORMAT-CORR-ID         TO MQMD-CORRELID.             00123304
061000     MOVE +300                      TO MQV-MSG-LENGTH.            00123404
061100     MOVE MQFMT-STRING              TO MQMD-FORMAT.               00123504
061101     ADD 1                          TO PV-MQ-ERROR-COUNT.         00123604
061103     MOVE PV-MQ-ERROR-COUNT         TO MQMD-APPLORIGINDATA.       00123704
061200     COMPUTE MQPMO-OPTIONS  =  MQPMO-SYNCPOINT +                  00123804
061300                               MQPMO-SET-ALL-CONTEXT.             00123904
061400                                                                  00124004
061500     CALL MQV-MQPUT USING MQV-HCONN                               00124104
061600                          MQV-ERROR-HANDLE                        00124204
061700                          MQM-MESSAGE-DESCRIPTOR                  00124304
061800                          MQM-PUT-MESSAGE-OPTIONS                 00124404
061900                          MQV-MSG-LENGTH                          00124504
062000                          MQV-ERRMSGBUF                           00124604
062100                          MQV-COMPLETION-CODE                     00124704
062200                          MQV-REASON.                             00124804
062300                                                                  00124904
062400     EVALUATE TRUE                                                00125004
062500        WHEN MQV-COMPLETION-CODE = MQCC-OK                        00125104
062600             ADD +1        TO PC-MESSAGES-TO-ERR-QUEUE            00125204
062700        WHEN OTHER                                                00125304
062800             DISPLAY 'UNABLE TO WRITE TO ERROR QUEUE'             00125404
062900             CALL MQV-MQCHECK USING MQV-REASON                    00125504
063000                                    MQV-REASON-TEXT               00125604
063100             MOVE '2500-PUT-ON-ERROR-QUEUE' TO PV-PARAGRAPH-NAME  00125704
063200             MOVE 'MQBACK ERROR'      TO PV-OPERATION-MSG-1       00125804
063210             MOVE MQV-COMPLETION-CODE    TO PV-COMPLETION-CODE    00125904
063220             MOVE MQV-REASON             TO PV-REASON             00126004
063230             MOVE MQV-REASON-TEXT        TO PV-REASON-TEXT        00126104
063300             PERFORM 9200-DISCONNECT-QMGR                         00126204
063400             PERFORM 9400-MQ-ABEND                                00126304
063500     END-EVALUATE.                                                00126404
063600                                                                  00126504
063700*2500-EXIT.                                                       00126604
063800 EJECT.                                                           00126704
063900                                                                  00126804
064000*----------------------------------------------------------       00126904
064100* 2600-PROGRAM-STAT-CNT.                                          00127004
064200*     COUNTS ALL THE SUCCESSFUL STATUS CODES PROCESSED.           00127104
064300*----------------------------------------------------------       00127204
064400 2600-PROGRAM-STAT-CNT.                                           00127304
064500                                                                  00127404
064600     EVALUATE TRUE                                                00127504
064700         WHEN PV-SUCCESS                                          00127604
064800              ADD +1 TO PC-STAT-00                                00127704
064900         WHEN PV-UPDATE-NEEDED                                    00127804
065000              ADD +1 TO PC-STAT-01                                00127904
065010         WHEN PV-UPDATE-NOT-NEEDED                                00128004
065011              ADD +1 TO PC-STAT-02                                00128104
065012         WHEN PV-INSERT                                           00128204
065013              ADD +1 TO PC-STAT-03                                00128304
065014         WHEN PV-UPDATE-BYPASS                                    00128404
065015              ADD +1 TO PC-STAT-04                                00128504
065016     END-EVALUATE.                                                00128604
065017                                                                  00128704
065018*2600-EXIT.                                                       00128804
065019 EJECT.                                                           00128904
065020                                                                  00129004
065021*----------------------------------------------------------       00129104
065022* 2700-PROGRAM-ERROR-CNT.                                         00129204
065023*     COUNTS ALL THE UNSUCCESSFUL STATUS CODES PROCESSED.         00129304
065024*----------------------------------------------------------       00129404
065025 2700-PROGRAM-ERROR-CNT.                                          00129504
065026                                                                  00129604
065027     EVALUATE TRUE                                                00129704
065028         WHEN PV-NO-SUCCESS                                       00129804
065029              IF PV-CRITICAL-ERROR                                00129904
065030                 ADD +1 TO PC-STAT-05-01                          00130004
065031              ELSE                                                00130104
065032                 ADD +1 TO PC-STAT-05-02                          00130204
065033              END-IF                                              00130304
065034         WHEN PV-UNEXPECTED                                       00130404
065035              IF PV-CRITICAL-ERROR                                00130504
065036                 ADD +1 TO PC-STAT-06-01                          00130604
065037              ELSE                                                00130704
065038                 ADD +1 TO PC-STAT-06-02                          00130804
065039              END-IF                                              00130904
065040     END-EVALUATE.                                                00131004
065041                                                                  00131104
065042*2700-EXIT.                                                       00131204
065043 EJECT.                                                           00131304
065044                                                                  00131404
065067*----------------------------------------------------------       00133504
065068* 3000-RETRIEVE-MESSAGE.                                          00133604
065069*     RETRIEVES THE NEXT MESSAGE FROM THE BUSINESS EVENT QUEUE.   00133704
065070*----------------------------------------------------------       00133804
065071 3000-RETRIEVE-MESSAGE.                                           00133904
065072                                                                  00134004
065073     INITIALIZE MQV-MSGBUFFER                                     00134104
065074                MQV-ERRMSGBUF.                                    00134204
065075                                                                  00134304
065076     MOVE +300                 TO MQV-MSG-LENGTH.                 00134404
065077     MOVE MQMI-NONE            TO MQMD-MSGID.                     00134504
065078     MOVE MQCI-NONE            TO MQMD-CORRELID.                  00134604
065079     MOVE CC-BUS-EVNT-QUEUE-NAME   TO MQOD-OBJECTNAME.            00134704
065080     MOVE MQFMT-STRING         TO MQMD-FORMAT.                    00134804
065081     MOVE MQWI-UNLIMITED       TO MQGMO-WAITINTERVAL.             00134904
065082                                                                  00135004
065083     COMPUTE MQGMO-OPTIONS  =  MQGMO-SYNCPOINT +                  00135104
065084                               MQGMO-CONVERT   +                  00135204
065085                               MQGMO-ACCEPT-TRUNCATED-MSG +       00135304
065086                               MQGMO-WAIT.                        00135404
065087                                                                  00135504
065088     CALL MQV-MQGET USING MQV-HCONN                               00135604
065089                          MQV-PROMO-HANDLE                        00135704
065090                          MQM-MESSAGE-DESCRIPTOR                  00135804
065091                          MQM-GET-MESSAGE-OPTIONS                 00135904
065092                          MQV-MSG-LENGTH                          00136004
065093                          MQV-MSGBUFFER                           00136104
065094                          MQV-DATA-LENGTH                         00136204
065095                          MQV-COMPLETION-CODE                     00136304
065096                          MQV-REASON.                             00136404
065097                                                                  00136504
065098     IF  MQV-COMPLETION-CODE = MQCC-OK                            00136604
065099         ADD +1             TO PC-MESSAGE-FROM-QUEUE              00136704
065100         MOVE SPACES TO PV-MESSAGE-RECORD                         00136804
065101         MOVE MQV-MSGBUFFER TO PV-MESSAGE-RECORD                  00136904
065102         IF MQMD-APPLORIGINDATA = SPACES                          00137004
065103            INITIALIZE PV-MQ-ERROR-COUNT                          00137104
065104         ELSE                                                     00137204
065105            MOVE MQMD-APPLORIGINDATA TO PV-MQ-ERROR-COUNT         00137304
065106         END-IF                                                   00137404
065107     ELSE                                                         00137504
065108         EVALUATE TRUE                                            00137604
065109            WHEN MQV-REASON = MQRC-Q-MGR-QUIESCING                00137704
065110            WHEN MQV-REASON = MQRC-Q-MGR-STOPPING                 00137804
065111                 CONTINUE                                         00137904
065112            WHEN MQV-REASON = MQRC-NO-MSG-AVAILABLE               00138004
065113                 DISPLAY 'NO MORE MESSAGES AVAILABLE'             00138104
065114            WHEN OTHER                                            00138204
065115                 CALL MQV-MQCHECK USING MQV-REASON                00138304
065116                                        MQV-REASON-TEXT           00138404
065117                 MOVE '3000-RETRIEVE-MESSAGE' TO PV-PARAGRAPH-NAME00138504
065118                 MOVE 'ERROR RETRIEVING MESSAGE'                  00138604
065119                                       TO PV-OPERATION-MSG-1      00138704
065120                 MOVE MQV-COMPLETION-CODE    TO PV-COMPLETION-CODE00138804
065121                 MOVE MQV-REASON             TO PV-REASON         00138904
065122                 MOVE MQV-REASON-TEXT        TO PV-REASON-TEXT    00139004
065123                 PERFORM 3100-BACK-OUT-MQV-CHANGES                00139104
065124                 PERFORM 9200-DISCONNECT-QMGR                     00139204
065125                 PERFORM 9400-MQ-ABEND                            00139304
065126         END-EVALUATE                                             00139404
065127     END-IF.                                                      00139504
065128                                                                  00139604
065129*3000-EXIT.                                                       00139704
065130 EJECT.                                                           00139804
065131                                                                  00139904
065132*----------------------------------------------------------       00140004
065133* 3100-BACK-OUT-MQV-CHANGES.                                      00140104
065134*     ROLLBACK MQ CHANGES.                                        00140204
065135*----------------------------------------------------------       00140304
065136 3100-BACK-OUT-MQV-CHANGES.                                       00140404
065137                                                                  00140504
065138     CALL MQV-MQBACK USING MQV-HCONN                              00140604
065139                           MQV-COMPLETION-CODE                    00140704
065140                           MQV-REASON.                            00140804
065141                                                                  00140904
065142     EVALUATE TRUE                                                00141004
065143        WHEN MQV-COMPLETION-CODE = MQCC-OK                        00141104
065144             CONTINUE                                             00141204
065145        WHEN OTHER                                                00141304
065146             CALL MQV-MQCHECK USING MQV-REASON                    00141404
065147                                    MQV-REASON-TEXT               00141504
065148             MOVE '3100-BACK-OUT-MQV-CHANGES' TO PV-PARAGRAPH-NAME00141604
065149             MOVE 'MQBACK ERROR'  TO PV-OPERATION-MSG-1           00141704
065150             MOVE MQV-COMPLETION-CODE    TO PV-COMPLETION-CODE    00141804
065151             MOVE MQV-REASON             TO PV-REASON             00141904
065152             MOVE MQV-REASON-TEXT        TO PV-REASON-TEXT        00142004
065153             PERFORM 9200-DISCONNECT-QMGR                         00142104
065154             PERFORM 9400-MQ-ABEND                                00142204
065155     END-EVALUATE.                                                00142304
065156                                                                  00142404
065157*3100-EXIT.                                                       00142504
065158 EJECT.                                                           00142604
065160                                                                  00142704
065189*----------------------------------------------------------       00142804
065190* 9000-WRAPUP.                                                    00142904
065200*     END OF PROGRAM ROUTINE.  CLOSES ALL QUEUES, DISCONNECTS     00143004
065300*     FROM THE QUEUE MANAGER, CLOSES ALL FILES, AND               00143104
065400*     DISPLAYS ALL DATA.                                          00143204
065500*----------------------------------------------------------       00143304
065600 9000-WRAPUP.                                                     00143404
065700                                                                  00143504
065800     PERFORM 9100-CLOSE-QUEUES.                                   00143604
065900     PERFORM 9200-DISCONNECT-QMGR.                                00143704
066000                                                                  00143804
066100     CLOSE CONTROL-CARD-1                                         00143904
066200           CONTROL-CARD-2                                         00144004
066300           CONTROL-CARD-3                                         00144104
066310           CONTROL-CARD-4                                         00144204
066400           MESSAGE-LOG.                                           00144304
066500                                                                  00144404
066510     DISPLAY ' '.                                                 00144504
066600     DISPLAY '**********************************************'.    00144604
066700     DISPLAY '   PROGRAM NAME: ' PC-CURRENT-PROGRAM-NAME.         00144704
066800     DISPLAY '**********************************************'.    00144804
066900     DISPLAY 'MESSAGES FROM QUEUE ............: '                 00144904
066900                                           PC-MESSAGE-FROM-QUEUE. 00145004
067100     DISPLAY '010  AD EVENT ...................: ' PC-MESSAGE-010.00145104
067200     DISPLAY '020  PROMOTION ..................: ' PC-MESSAGE-020.00145204
067300     DISPLAY '030  PRICE VERSION ..............: ' PC-MESSAGE-030.00145304
067400     DISPLAY '040  ADHOC STORE GROUP ..........: ' PC-MESSAGE-040.00145404
067500     DISPLAY '050  ADHOC STORE LIST ...........: ' PC-MESSAGE-050.00145504
067600     DISPLAY '060  PROMOTIONAL ITEM ...........: ' PC-MESSAGE-060.00145604
067700     DISPLAY '070  PROMOTIONAL ITEM STORE GROUP: ' PC-MESSAGE-070.00145704
067800     DISPLAY '080  FORECAST ...................: ' PC-MESSAGE-080.00145804
067900     DISPLAY '090  PRICING ....................: ' PC-MESSAGE-090.00145904
068000     DISPLAY '100  BENEFIT WITH PURCHASE ......: ' PC-MESSAGE-100.00146004
068100     DISPLAY '110  PRICING EXCLUSIONS .........: ' PC-MESSAGE-110.00146104
068200     DISPLAY '120  PRICING STORE GROUP ........: ' PC-MESSAGE-120.00146204
068200     DISPLAY '130  REBATES ....................: ' PC-MESSAGE-130.00146304
067000     DISPLAY '      ALL LOADING PROGRAMS CALLED ..: '             00146404
067000                                                   PC-MESSAGE-ALL.00146504
068200     DISPLAY ' '.                                                 00146604
068300     DISPLAY '************* RESULTS FROM LOADS ****************'. 00146704
068400     DISPLAY 'MESSAGES BACKED UP ..............: '                00146804
068400                                     PC-MESSAGES-WRITTEN-TO-FILE. 00146904
101310     DISPLAY 'ACTUAL COMMITS TAKEN ............: '                00147004
101310                                        PC-ACTUAL-COMMITS.        00147105
068500     DISPLAY 'LOADS WITH 00 STAT CDE ..........: ' PC-STAT-00.    00147204
068600     DISPLAY 'LOADS WITH 01 STAT CDE ..........: ' PC-STAT-01.    00147304
068700     DISPLAY 'LOADS WITH 02 STAT CDE ..........: ' PC-STAT-02.    00147404
068800     DISPLAY 'LOADS WITH 03 STAT CDE ..........: ' PC-STAT-03.    00147504
068810     DISPLAY 'LOADS WITH 04 STAT CDE ..........: ' PC-STAT-04.    00147604
068900     DISPLAY 'MESSAGES ON ERROR QUEUE .........: '                00147704
068900                                         PC-MESSAGES-TO-ERR-QUEUE.00147804
069000     DISPLAY 'LOADS WITH 05 STAT CDE AND CRITICAL .: '            00147904
069100                                                  PC-STAT-05-01.  00148004
069200     DISPLAY 'LOADS WITH 05 STAT CDE AND UNCRITICAL: '            00148104
069300                                                  PC-STAT-05-02.  00148204
069400     DISPLAY 'LOADS WITH 06 STAT CDE AND CRITICAL .: '            00148304
069500                                                  PC-STAT-06-01.  00148404
069600     DISPLAY 'LOADS WITH 06 STAT CDE AND UNCRITICAL: '            00148504
069700                                                  PC-STAT-06-02.  00148604
069800     DISPLAY '*************************************************'. 00148704
S69800     DISPLAY ' '.                                                 00148804
069900                                                                  00152804
070000*9000-EXIT.                                                       00152904
070100 EJECT.                                                           00153004
070200                                                                  00153104
070300*----------------------------------------------------------       00153204
070400* 9100-CLOSE-QUEUES.                                              00153304
070500*     CLOSE BUSINESS EVENT QUEUE AND ERROR QUEUE.                 00153404
070600*----------------------------------------------------------       00153504
070700 9100-CLOSE-QUEUES.                                               00153604
070800                                                                  00153704
070900     CALL MQV-MQCLOSE USING MQV-HCONN                             00153804
071000                            MQV-PROMO-HANDLE                      00153904
071100                            MQCO-NONE                             00154004
071200                            MQV-COMPLETION-CODE                   00154104
071300                            MQV-REASON.                           00154204
071400                                                                  00154304
071500     EVALUATE TRUE                                                00154404
071600        WHEN MQV-COMPLETION-CODE = MQCC-OK                        00154504
071700             CONTINUE                                             00154604
071800        WHEN MQV-COMPLETION-CODE NOT EQUAL MQCC-OK                00154704
071900             CALL MQV-MQCHECK USING MQV-REASON                    00154804
072000                                    MQV-REASON-TEXT               00154904
072010             MOVE '9100-CLOSE-QUEUES' TO PV-PARAGRAPH-NAME        00155004
072100             MOVE 'CANNOT CLOSE BUS EVENT QUEUE'                  00155104
072200                                    TO PV-OPERATION-MSG-1         00155204
072210             MOVE MQV-COMPLETION-CODE    TO PV-COMPLETION-CODE    00155304
072220             MOVE MQV-REASON             TO PV-REASON             00155404
072230             MOVE MQV-REASON-TEXT        TO PV-REASON-TEXT        00155504
072300             PERFORM 9400-MQ-ABEND                                00155604
072400     END-EVALUATE.                                                00155704
072500                                                                  00155804
072600     CALL MQV-MQCLOSE USING MQV-HCONN                             00155904
072700                            MQV-ERROR-HANDLE                      00156004
072800                            MQCO-NONE                             00156104
072900                            MQV-COMPLETION-CODE                   00156204
073000                            MQV-REASON.                           00156304
073100                                                                  00156404
073200     EVALUATE TRUE                                                00156504
073300        WHEN MQV-COMPLETION-CODE = MQCC-OK                        00156604
073400             CONTINUE                                             00156704
073500        WHEN MQV-COMPLETION-CODE NOT EQUAL MQCC-OK                00156804
073600             CALL MQV-MQCHECK USING MQV-REASON                    00156904
073700                                    MQV-REASON-TEXT               00157004
073710             MOVE '9100-CLOSE-QUEUES' TO PV-PARAGRAPH-NAME        00157104
073800             MOVE 'CANNOT CLOSE ERROR QUEUE' TO PV-OPERATION-MSG-100157204
073810             MOVE MQV-COMPLETION-CODE    TO PV-COMPLETION-CODE    00157304
073820             MOVE MQV-REASON             TO PV-REASON             00157404
073830             MOVE MQV-REASON-TEXT        TO PV-REASON-TEXT        00157504
073900             PERFORM 9400-MQ-ABEND                                00157604
074000     END-EVALUATE.                                                00157704
074100                                                                  00157804
074200*9100-EXIT.                                                       00157904
074300 EJECT.                                                           00158004
074400                                                                  00158104
074500*----------------------------------------------------------       00158204
074600* 9200-DISCONNECT-QMGR.                                           00158304
074700*     DISCONNECT FROM THE QUEUE MANAGER.                          00158404
074800*----------------------------------------------------------       00158504
074900 9200-DISCONNECT-QMGR.                                            00158604
075000                                                                  00158704
075100     CALL MQV-MQDISC USING MQV-HCONN                              00158804
075200                           MQV-COMPLETION-CODE                    00158904
075300                           MQV-REASON.                            00159004
075400                                                                  00159104
075500     EVALUATE TRUE                                                00159204
075600        WHEN MQV-COMPLETION-CODE = MQCC-OK                        00159304
075700             CONTINUE                                             00159404
075800        WHEN MQV-COMPLETION-CODE NOT EQUAL MQCC-OK                00159504
075900             CALL MQV-MQCHECK USING MQV-REASON                    00159604
076000                                    MQV-REASON-TEXT               00159704
076100             MOVE '9200-DISCONNECT-QMGR' TO PV-PARAGRAPH-NAME     00159804
076200             MOVE 'MQDISC ERROR'         TO PV-OPERATION-MSG-1    00159904
076210             MOVE MQV-COMPLETION-CODE    TO PV-COMPLETION-CODE    00160004
076220             MOVE MQV-REASON             TO PV-REASON             00160104
076230             MOVE MQV-REASON-TEXT        TO PV-REASON-TEXT        00160204
076300             PERFORM 9400-MQ-ABEND                                00160304
076400     END-EVALUATE.                                                00160404
076500                                                                  00160504
076600*9200-EXIT.                                                       00160604
076700 EJECT.                                                           00160704
076800                                                                  00160804
076900*---------------------------------------------------------        00160904
077000* 9300-ABEND.                                                     00161004
077100*     ABEND PROGRAM WHEN A NON-DB2 ERROR OCCURS.                  00161104
077200*---------------------------------------------------------        00161204
077300 9300-ABEND.                                                      00161304
077400                                                                  00161404
077500     DISPLAY '** ABEND           **'.                             00161504
077600     DISPLAY '** PROGRAM         ** = ' PC-CURRENT-PROGRAM-NAME.  00161604
077700     DISPLAY '** PARAGRAPH       ** = ' PV-PARAGRAPH-NAME.        00161704
077800     DISPLAY '** OPERATION       ** = ' PV-OPERATION-MSG-1.       00161804
077900     DISPLAY '**                 ** = ' PV-OPERATION-MSG-2.       00161904
078000     CALL 'ILBOABN0' USING ABEND-CODE.                            00162004
078100                                                                  00162104
078200*9300-EXIT.                                                       00162204
078300 EJECT.                                                           00162304
078400                                                                  00162404
078500*----------------------------------------------------------       00162504
078600* 9400-MQ-ABEND.                                                  00162604
078700*     MQ ABEND ROUTINE.                                           00162704
078800*----------------------------------------------------------       00162804
078900 9400-MQ-ABEND.                                                   00162904
079000                                                                  00163004
079100     SET ABEND-4020-MQ-ERROR TO TRUE.                             00163104
079200     DISPLAY '**** ABEND *************************************'.  00163204
079300     DISPLAY '** MQSERIES ERROR **'.                              00163304
079400     DISPLAY '** PROGRAM:    ' PC-CURRENT-PROGRAM-NAME.           00163404
079500     DISPLAY '** ABEND CODE: ' ABEND-CODE.                        00163504
079600     DISPLAY '** PARAGRAPH:  ' PV-PARAGRAPH-NAME.                 00163604
079700     DISPLAY '** MESSAGE:    ' PV-OPERATION-MSG-1.                00163704
079800     DISPLAY '** COMP CODE:  ' PV-COMPLETION-CODE.                00163804
079900     DISPLAY '** RSN CODE:   ' PV-REASON.                         00163904
080000     DISPLAY '** RSN TEXT:   ' PV-REASON-TEXT.                    00164004
080100     DISPLAY '************************************************'.  00164104
080200     CALL 'ILBOABN0' USING ABEND-CODE.                            00164204
080300                                                                  00164304
080400*9400-EXIT.                                                       00164404
080500 EJECT.                                                           00164504
080600                                                                  00164604
080700*----------------------------------------------------------       00164704
080800* 9500-SQL-ABEND-ROUTINE.                                         00164804
080900*     SQL ABEND ROUTINE.                                          00164904
081000*----------------------------------------------------------       00165004
081100 9500-SQL-ABEND-ROUTINE.                                          00165104
081200                                                                  00165204
081210     SET ABEND-4013-DB2-ERROR TO TRUE.                            00165304
081220                                                                  00165404
081300     DISPLAY '** ABEND     **'.                                   00165504
081400     DISPLAY '** PROGRAM   ** = ' PC-CURRENT-PROGRAM-NAME.        00165604
081500     DISPLAY '** PARAGRAPH ** = ' PV-PARAGRAPH-NAME.              00165704
081600     DISPLAY '** OPERATION ** = ' PV-DB2-OPERATION.               00165804
081700                                                                  00165904
081800     COPY DPPD004.                                                00166004
082000     CALL 'ILBOABN0' USING ABEND-CODE.                            00166104
082100                                                                  00166204
082200*9500-EXIT.                                                       00166304
082300 EJECT.                                                           00166404
082400                                                                  00167004
