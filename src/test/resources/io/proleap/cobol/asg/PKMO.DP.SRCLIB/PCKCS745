000100*-----------------------*                                         00010001
000200 IDENTIFICATION DIVISION.                                         00020001
000300*-----------------------*                                         00030001
000400 PROGRAM-ID.    PCKCS745.                                         00040001
000500 AUTHOR.        DEANNA BRANTNER                                   00050001
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060001
000700 DATE-WRITTEN.  OCTOBER, 2001.                                    00070035
000800 DATE-COMPILED.                                                   00080065
000900*----------------------------------------------------------------*00090001
001000*    S745 - PC - IN-TRANSIT CRITERIA SPECIFICATION SCREEN        *00100001
001100*----------------------------------------------------------------*00110001
001110* DATE  11/04/2021                                                00111067
001120*            - CHANGE CALL OF 'DPKUT100' TO                     * 00112067
001130*              CALL DP010I-NUMERIC-EDIT-ROUTINE                 * 00113067
001140*              MAKING THE CALL DYNAMIC VS STATIC                * 00114067
001150*     MADE BY: GERMAN BANDA            WR/IR #: CHG0264232        00115068
001160*-----------------------------------------------------------------00116067
1122RM* DATE  11/07/2022                                              * 00117069
1122RM*            - ADD COPYBOOK DPWS930                             * 00118069
1122RM*              CHANGE CALL TO DPWS030 FROM STATIC TO            * 00119069
1122RM*              DYNAMIC.                                         * 00119169
1122RM*     MADE BY: BOB MCASEY              WR/IR #: CHG0277910      * 00119269
1122RM*-----------------------------------------------------------------00119369
001200 ENVIRONMENT DIVISION.                                            00120001
001300 DATA DIVISION.                                                   00130001
001400                                                                  00140001
001500 WORKING-STORAGE SECTION.                                         00150001
001600*----------------------------------------------------------------*00160001
001700*   PROGRAM CONSTANTS                                            *00170001
001800*----------------------------------------------------------------*00180001
001900 01  PC-PROGRAM-CONSTANTS.                                        00190001
002000     05  PC-CURRENT-MAP-NAME       PIC  X(08)  VALUE 'PC745A  '.  00200001
002100     05  PC-CURRENT-MAPSET-NAME    PIC  X(08)  VALUE 'PCKM745 '.  00210001
002200     05  PC-CURRENT-PROGRAM-NAME   PIC  X(08)  VALUE 'PCKCS745'.  00220001
002210     05  PC-XL001-VSM-PGM          PIC  X(08)  VALUE 'XLKUT001'.  00221065
002220     05  PC-OP-CO-NBR              PIC  X(02)  VALUE '03'.        00222065
002230     05  PC-000                    PIC  X(03)  VALUE '000'.       00223065
002240     05  PC-FCLTY-ID-0001          PIC  9(04)  VALUE  0001.       00224065
002250     05  PC-01                     PIC  X(02)  VALUE '01'.        00225065
002260     05  PC-CALENDAR-MODULE        PIC  X(08)  VALUE 'DPKUT500'.  00226065
002270     05  PC-ALL                    PIC  X(04)  VALUE 'ALL '.      00227065
002280     05  PC-A                      PIC  X(01)  VALUE 'A'.         00228065
002290                                                                  00229065
002300*-----------------------------------------------------------------00230065
002400*  DB2 KEYS                                                       00240065
002500*-----------------------------------------------------------------00250065
002600 01  DK-DB2-KEYS.                                                 00260065
002700                                                                  00270065
002800     05  DK-SKU                         PIC S9(08)V COMP-3.       00280065
002900     05  DK-STORE-NBR                   PIC S9(04)  COMP VALUE +0.00290065
003000     05  DK-STORE-NUMBER                PIC  X(04)  VALUE SPACES. 00300065
003100     05  DK-STORE-NUMBER-R REDEFINES DK-STORE-NUMBER.             00310065
003200         10  FILLER                     PIC  X(01).               00320065
003300         10  DK-STORE-NUMBER-3POS       PIC  X(03).               00330065
003400     05  DK-STORE-NUMBER-PIC9           PIC  9(04)  VALUE 0.      00340065
003500     05  DK-ITEM-NBR                    PIC  S9(15)V COMP-3.      00350065
003600     05  DK-UPC-ID                      PIC  S9(09)  VALUE ZERO   00360065
003700                                                    COMP.         00370065
003800                                                                  00380065
003900*----------------------------------------------------------------*00390065
004000*  SYSTEM MESSAGES                                               *00400065
004100*----------------------------------------------------------------*00410065
004200*   00005 = INVALID VALUE                                         00420065
004300*   00007 = REQUIRED ENTRY                                        00430065
004400*   00008 = MUST BE NUMERIC                                       00440065
004500*   00009 = INVALID DATE                                          00450065
004600*   00045 = INVALID FUNCTION KEY                                  00460065
004700*   21040 = YOU ARE NOT AUTHORIZED TO VIEW THIS DATA              00470065
004800*   02227 = APPLICATION UNAVAILABLE AT THIS TIME                  00480065
004900*   02307 - YOU DO NOT HAVE AUTHORITY TO CANCEL/UNCANCEL          00490065
005000*   02698 - DATE RANGE INVALID                                    00500065
005100*                                                                 00510065
005200*----------------------------------------------------------------*00520065
005300 01  PC-TSYMSG-NUMBERS.                                           00530065
005400     05  PC-TSYMSG-00005       PIC  9(05)  VALUE  00005.          00540065
005500     05  PC-TSYMSG-00007       PIC  9(05)  VALUE  00007.          00550065
005600     05  PC-TSYMSG-00008       PIC  9(05)  VALUE  00008.          00560065
005700     05  PC-TSYMSG-00009       PIC  9(05)  VALUE  00009.          00570065
005800     05  PC-TSYMSG-00032       PIC  9(05)  VALUE  00032.          00580065
005900     05  PC-TSYMSG-00045       PIC  9(05)  VALUE  00045.          00590065
006000     05  PC-TSYMSG-21040       PIC  9(05)  VALUE  21040.          00600065
006100     05  PC-TSYMSG-02224       PIC  9(05)  VALUE  02224.          00610065
006200     05  PC-TSYMSG-02227       PIC  9(05)  VALUE  02227.          00620065
006300     05  PC-TSYMSG-02307       PIC  9(05)  VALUE  02307.          00630065
006400     05  PC-TSYMSG-02516       PIC  9(05)  VALUE  02516.          00640065
006500     05  PC-TSYMSG-02697       PIC  9(05)  VALUE  02697.          00650065
006600     05  PC-TSYMSG-02698       PIC  9(05)  VALUE  02698.          00660065
006700                                                                  00670065
006800*----------------------------------------------------------------*00680065
006900*   PROGRAM MESSAGES                                             *00690065
007000*----------------------------------------------------------------*00700065
007100 01  PM-PROGRAM-MESSAGES.                                         00710065
007200     05  PM-ABEND-INFO-A.                                         00720065
007300         10  FILLER                PIC X(15)   VALUE              00730065
007400                                   'DP020-SRC-AID: '.             00740065
007500         10  PM-A-SRC-AID          PIC X(02)   VALUE  SPACE.      00750065
007600         10  FILLER                PIC X(19)   VALUE              00760065
007700                                   '. DP020-FK-ACTION: '.         00770065
007800         10  PM-A-FK-ACTION        PIC X(01)   VALUE  SPACE.      00780065
007900         10  FILLER                PIC X(22)   VALUE              00790065
008000                                   '. DP020-FK-DISPN-IND: '.      00800065
008100         10  PM-A-FK-DISPN         PIC X(01)   VALUE  SPACE.      00810065
008200         10  FILLER                PIC X(01)   VALUE '.'.         00820065
008300         10  FILLER                PIC X(19)   VALUE SPACE.       00830065
008400                                                                  00840065
008500*----------------------------------------------------------------*00850065
008600*   SWITCHES                                                     *00860065
008700*----------------------------------------------------------------*00870065
008800 01  PS-PROGRAM-SWITCHES.                                         00880065
008900     05  PS-ERROR-SW               PIC  X(01)  VALUE  'N'.        00890065
009000         88  PS-ERROR                          VALUE  'Y'.        00900065
009100         88  PS-NO-ERROR                       VALUE  'N'.        00910065
009200     05  PS-CONFIRM-PROCESSING-IND PIC  X(01)  VALUE  'N'.        00920065
009300         88  PS-CONFIRM-PROCESSING             VALUE  'Y'.        00930065
009400         88  PS-NOT-CONFIRM-PROCESSING         VALUE  'N'.        00940065
009500     05  PS-ACCESS-SW                   PIC  X(01)  VALUE  'N'.   00950065
009600         88  PS-ACCESS-ALLOWED                      VALUE  'Y'.   00960065
009700         88  PS-ACCESS-NOT-ALLOWED                  VALUE  'N'.   00970065
009800                                                                  00980065
009900*----------------------------------------------------------------*00990065
010000*   PROGRAM VARIABLES                                            *01000065
010100*----------------------------------------------------------------*01010065
010200 01  PV-PROGRAM-VARIABLES.                                        01020065
010300     05  PV-RACF-ERROR-CODE        PIC  9(04)  VALUE ZEROES.      01030065
010400     05  PV-ONHAND-QTY             PIC S9(10)V COMP-3.            01040065
010500     05  PV-INTRNST-QTY            PIC S9(10)V COMP-3.            01050065
010600     05  PV-STR-EXPECT             PIC S9(10)V COMP-3.            01060065
010700     05  PV-4-DIGIT-STORE          PIC  Z999   VALUE  ZEROES.     01070065
010800     05  PV-PO-NBR                 PIC ZZZZZZZZZ VALUE  ZEROES.   01080065
010900     05  PV-RCVR-NBR               PIC ZZZZ     VALUE  ZEROES.    01090065
011000     05  PV-COMMAREA-LENGTH        PIC S9(04)  VALUE +0           01100065
011100                                                COMP SYNC.        01110065
011200     05  PV-REF-NBR-COUNT          PIC S9(09)  COMP.              01120065
011300     05  PV-CEPLDS-COUNT           PIC S9(09)  VALUE ZEROES       01130065
011400                                               COMP.              01140065
011500     05  PV-TCEPLMF-COUNT          PIC S9(09)  VALUE ZEROES       01150065
011600                                               COMP.              01160065
011700     05  PV-TCEPLAU-COUNT          PIC S9(09)  VALUE ZEROES       01170065
011800                                               COMP.              01180065
011900     05  PV-LINES-NEW              PIC S9(09)  VALUE ZEROES       01190065
012000                                               COMP.              01200065
012100     05  PV-LINES-POSTED-DISTRB    PIC S9(09)  COMP.              01210065
012200     05  PV-CICS-RESPONSE          PIC S9(08)  VALUE ZEROES       01220065
012300                                   COMP SYNC.                     01230065
012400     05  PV-CICS-MSG-AREA2         PIC  X(100) VALUE SPACE.       01240065
012500     05  PV-CURRENT-DATE           PIC  X(10)  VALUE SPACES.      01250065
012600     05  PV-CURRENT-DATE-R REDEFINES PV-CURRENT-DATE.             01260065
012700         10  PV-CURR-YY            PIC  9(04).                    01270065
012800         10  FILLER                PIC  X(01).                    01280065
012900         10  PV-CURR-MM            PIC  9(02).                    01290065
013000         10  FILLER                PIC  X(01).                    01300065
013100         10  PV-CURR-DD            PIC  9(02).                    01310065
013200     05  PV-PARM-BOSS-RECV         PIC S9(09)  COMP.              01320065
013300                                                                  01330065
013400*----------------------------------------------------------------*01340065
013500*    MAP LAYOUT                                                  *01350065
013600*----------------------------------------------------------------*01360065
013700     COPY PCKM745.                                                01370065
013800                                                                  01380065
013900*----------------------------------------------------------------*01390065
014000*    XLKUT001 COPYBOOK USED WITH XLKUT001 - SKU CALLED MODULE    *01400065
014100*----------------------------------------------------------------*01410065
014200     COPY XLWS001.                                                01420065
014300                                                                  01430065
014400*----------------------------------------------------------------*01440065
014500*    XLKUT071 COPYBOOK - USED WITH XLKUT071 - LOCATION MODULE     01450065
014600*----------------------------------------------------------------*01460065
014700     COPY XLWS071.                                                01470065
014800                                                                  01480065
014900*----------------------------------------------------------------*01490065
015000*    ATTRIBUTE SETTINGS COPYBOOK.                                *01500065
015100*----------------------------------------------------------------*01510065
015200     COPY DPWS015.                                                01520065
015300                                                                  01530065
015400*----------------------------------------------------------------*01540065
015500*    FUNCTION KEYS COPYBOOK                                      *01550065
015600*----------------------------------------------------------------*01560065
015700     COPY DPWS016.                                                01570065
015800                                                                  01580065
015900*----------------------------------------------------------------*01590065
016000*    ABEND PROCESSING COPYBOOK.                                  *01600065
016100*----------------------------------------------------------------*01610065
016200     COPY DPWS013.                                                01620065
016300                                                                  01630065
016400*----------------------------------------------------------------*01640065
016500*  THE CALLING PARAMETER LIST (DPWS010) FOR THE NUMERIC EDIT     *01650065
016600*  SUB-ROUTINE (DPKUT100).                                       *01660065
016700*----------------------------------------------------------------*01670065
016800     COPY DPWS010I.                                               01680065
016900                                                                  01690065
017000*----------------------------------------------------------------*01700065
017100*  THE CALLING PARAMETER LIST (DPWS030) FOR THE CICS             *01710065
017200*  ARCHITECTURE API (BLACK BOX) SUB-ROUTINE.                     *01720065
017300*----------------------------------------------------------------*01730065
017400     COPY DPWS030.                                                01740065
1122RM     COPY DPWS930.                                                01741069
017500                                                                  01750065
017600*----------------------------------------------------------------*01760065
017700*    STANDARD COMMAREA.                                          *01770065
017800*----------------------------------------------------------------*01780065
017900     COPY DPWS020.                                                01790065
018000     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                01800065
018100                                                                  01810065
018200*----------------------------------------------------------------*01820065
018300*    INTER-APPLICATION COMMAREA.                                 *01830065
018400*----------------------------------------------------------------*01840065
018500         10  INTER-APPL-COMM-AREA PIC X(200).                     01850065
018600     COPY PCWS210.                                                01860065
018700                                                                  01870065
018800*----------------------------------------------------------------*01880065
018900*    SPECIFIC COMMMAREA FOR PCKCS745.                            *01890065
019000*----------------------------------------------------------------*01900065
019100         10  ASC-SPECIFIC-COMMAREA.                               01910065
019200             15  ASC-SKU-X                   PIC  X(08).          01920065
019300             15  ASC-SKU-A   REDEFINES ASC-SKU-X.                 01930065
019400                 20  ASC-SKU-B               PIC  9(08).          01940065
019500             15  ASC-SKU                     PIC S9(08)V COMP-3.  01950065
019600             15  ASC-SKU-DESC                PIC  X(20).          01960065
019700             15  ASC-STORE-NBR-X             PIC  X(04).          01970065
019800             15  ASC-STORE-NBR-N REDEFINES ASC-STORE-NBR-X.       01980065
019900                 20  ASC-STORE-NBR           PIC  9(04).          01990065
020000             15  ASC-STORE-NAME              PIC  X(20).          02000065
020100             15  ASC-UPC-ID                  PIC S9(09)  COMP.    02010065
020200             15  ASC-ITEM-NBR                PIC S9(15)V COMP-3.  02020065
020300             15  ASC-SCREEN-DISPLAY          PIC  X(01).          02030065
020400                 88  ASC-DISPLAY-INTR             VALUE 'I'.      02040065
020500                 88  ASC-DISPLAY-STR-EXPT         VALUE 'S'.      02050065
025600             15  ASC-PO-X                    PIC  X(09).          02560014
025700             15  ASC-PO-N    REDEFINES ASC-PO-X.                  02570065
025800                 20  ASC-PO                  PIC  9(09).          02580065
027800             15  ASC-RCVR-NBR-X              PIC  X(04).          02780030
027900             15  ASC-RCVR-NBR-N REDEFINES ASC-RCVR-NBR-X.         02790030
028000                 20  ASC-RCVR-NBR            PIC  9(04).          02800030
028600                                                                  02860014
028700*----------------------------------------------------------------*02870065
028701*    DB2 AREA FOR THE PARAMETER TABLE                            *02870165
028702*----------------------------------------------------------------*02870201
028703     EXEC SQL                                                     02870365
028704         INCLUDE TKRPRPM                                          02870465
028705     END-EXEC.                                                    02870565
028706                                                                  02870665
028707*----------------------------------------------------------------*02870701
028708*    DB2 AREA FOR COMMUNICATIONS                                 *02870865
028709*----------------------------------------------------------------*02870901
028710     EXEC SQL                                                     02871065
028720          INCLUDE SQLCA                                           02872065
028730     END-EXEC.                                                    02873065
028740                                                                  02874065
033800*-----------------------------------------------------------------03380001
033900 LINKAGE SECTION.                                                 03390002
034000*-----------------------------------------------------------------03400001
034100 01  DFHCOMMAREA.                                                 03410001
034200     05  FILLER                         OCCURS  1 TO 4072 TIMES   03420001
034300                                        DEPENDING ON EIBCALEN.    03430001
034400         10  FILLER                     PIC X.                    03440001
034500                                                                  03450001
034600                                                                  03460001
034700 PROCEDURE DIVISION.                                              03470001
034800*----------------------------------------------------------------*03480001
034900*  THIS MODULE CONTROLS THE OVERALL PROCESSING IN THE PROGRAM.   *03490001
035000*  THE SETUP AND PERFORM OF PARAGRAPH 0001-CALL-CICS-ARCH-API    *03500001
035100*  MUST BE THE FIRST CODE EXECUTED IN THIS PROGRAM.              *03510001
035200*                                                                *03520001
035300*  THE SECOND OR 'EXIT' PERFORM OF THIS PARAGRAPH MUST BE THE    *03530001
035400*  LAST CODE EXECUTED ON EACH ITERATION OF THIS PROGRAM.         *03540001
035500*----------------------------------------------------------------*03550001
035600 0000-MAIN-MODULE.                                                03560001
035700     INITIALIZE DP030-CICS-API-FIELDS.                            03570001
035800     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       03580001
035900     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          03590001
036000     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         03600001
036100     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       03610001
036200     MOVE LENGTH OF PC745AI        TO DP030-MAP-LENGTH (1).       03620002
036300     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     03630001
036400     PERFORM 0001-CALL-CICS-ARCH-API.                             03640001
036500                                                                  03650001
036600     PERFORM 1000-CONTROL-PROCESSING                              03660001
036700                                                                  03670001
036800     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     03680001
036900     PERFORM 0001-CALL-CICS-ARCH-API.                             03690001
037000                                                                  03700001
037100*----------------------------------------------------------------*03710002
037200 0001-CALL-CICS-ARCH-API.                                         03720001
1122RM*    CALL 'DPKCS030' USING DFHEIBLK                               03730069
1122RM     CALL DP930-CICS-ARCH-API                                     03731069
1122RM                     USING DFHEIBLK                               03732069
037400                           DFHCOMMAREA                            03740001
037500                           DP030-CICS-API-FIELDS                  03750001
037600                           DP020-STANDARD-COMMAREA                03760001
037700                           PC745AI.                               03770002
037800                                                                  03780001
037900     IF  DP030-RC-CALL-SUCCESSFUL                                 03790001
038000         CONTINUE                                                 03800001
038100     ELSE                                                         03810001
038200         SET DP013-NO-ROLLBACK                                    03820001
038300             DP013-XCTL-DISPLAY-RESTART                           03830001
038400             DP013-CICS-ABEND      TO TRUE                        03840001
038500         MOVE 'BEFORE 0000-MAIN-MODULE'                           03850001
038600                                   TO DP013-PARAGRAPH             03860001
1122RM*        MOVE 'CALL TO DPKCS030 NOT SUCCESSFUL'                   03870069
1122RM*                                  TO DP013-MESSAGE-TEXT (2)      03880069
1122rm         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O03881069
1122RM-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      03882069
038900         MOVE  SPACES              TO DP013-MESSAGE-TEXT (3)      03890001
039000         STRING  'RETURN CODE - '     DELIMITED BY SIZE           03900001
039100                  DP030-RETURN-CODE   DELIMITED BY SIZE           03910001
039200                                 INTO DP013-MESSAGE-TEXT (3)      03920001
039300         PERFORM DP013-0000-PROCESS-ABEND                         03930001
039400     END-IF.                                                      03940001
039500                                                                  03950001
039600*----------------------------------------------------------------*03960001
039700*    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT   *03970001
039800*    COURSE OF ACTION IS FOR THIS TRANSACTION.                   *03980001
039900*----------------------------------------------------------------*03990001
040000 1000-CONTROL-PROCESSING.                                         04000001
040100                                                                  04010001
040200     EVALUATE TRUE                                                04020001
040300         WHEN DP020-NEXT-ACT-INITIAL                              04030001
040400             INITIALIZE ASC-SPECIFIC-COMMAREA                     04040001
040410             INITIALIZE ASC-SKU                                   04041065
040500             PERFORM 4000-BUILD-INITIAL-PANEL                     04050023
040600             PERFORM 3200-RESET-ATTRIBUTES                        04060024
040700                                                                  04070001
040800         WHEN DP020-NEXT-ACT-READ-MAP                             04080001
040900             PERFORM 2000-FKEY-PROCESSING                         04090001
041000                                                                  04100001
041100         WHEN DP020-NEXT-ACT-RETURN                               04110001
041400             INITIALIZE ASC-SPECIFIC-COMMAREA                     04140041
041500             PERFORM 4000-BUILD-INITIAL-PANEL                     04150042
041600             PERFORM 3200-RESET-ATTRIBUTES                        04160001
041700                                                                  04170001
041800         WHEN OTHER                                               04180001
041900             SET DP013-LOGIC-ABEND                                04190001
042000                 DP013-NO-ROLLBACK TO TRUE                        04200001
042100             MOVE 'PCKCS745 - 1000-CONTROL-PROCESSING'            04210001
042200                                   TO  DP013-PARAGRAPH            04220001
042300             MOVE 'INVALID NEXT ACTIVITY RETURNED TO APPL PGM:'   04230001
042400                                   TO  DP013-MESSAGE-TEXT(1)      04240001
042500             MOVE DP020-NEXT-APPL-ACTIVITY                        04250001
042600                                   TO DP013-MESSAGE-TEXT(2)       04260001
042700             PERFORM DP013-0000-PROCESS-ABEND                     04270001
042800     END-EVALUATE.                                                04280001
042900                                                                  04290001
043000*----------------------------------------------------------------*04300001
043100* FURTHER DETERMINE PROCESSING PATH BASED ON FUNCTION KEY ACTIONS*04310001
043200* SPECIFIC FUNCTION KEYS LISTED HERE ARE ACTED UPON REGARDLESS OF*04320001
043300* EDITS.                                                         *04330001
043400*----------------------------------------------------------------*04340001
043500 2000-FKEY-PROCESSING.                                            04350001
043600                                                                  04360001
043700     EVALUATE TRUE                                                04370001
043800                                                                  04380001
043900         WHEN DP020-SRC-AID = DP016-CLEAR                         04390001
044000             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   04400001
044100             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 04410001
044300                                                                  04430001
044400         WHEN DP020-FK-REFRESH(DP020-SRC-AID)                     04440001
044500             INITIALIZE ASC-SPECIFIC-COMMAREA                     04450001
044600             PERFORM 4000-BUILD-INITIAL-PANEL                     04460007
044700             PERFORM 3200-RESET-ATTRIBUTES                        04470001
044900                                                                  04490001
045000         WHEN OTHER                                               04500001
045100                                                                  04510065
045200             EVALUATE TRUE                                        04520065
045300                 WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)      04530065
045400                      SET ASC-DISPLAY-INTR TO TRUE                04540065
045500                 WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)      04550065
045600                      SET ASC-DISPLAY-STR-EXPT TO TRUE            04560065
045700             END-EVALUATE                                         04570065
045701                                                                  04570165
045702             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 04570201
045703             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   04570301
045704                                                                  04570401
045705             IF  PS-NO-ERROR                                      04570501
045706                 SET DP030-CONTINUE-GO TO TRUE                    04570601
045707                 PERFORM 2100-CHECK-FUNCTION-KEY                  04570701
045708                 IF  PS-NO-ERROR                                  04570852
045800                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         04580052
045900                 ELSE                                             04590052
046000                     SET DP030-OVERRIDE-GO TO TRUE                04600045
046100                 END-IF                                           04610045
046200             ELSE                                                 04620001
046300                 SET DP030-OVERRIDE-GO TO TRUE                    04630001
046400             END-IF                                               04640001
046500     END-EVALUATE.                                                04650001
046600                                                                  04660001
046700*----------------------------------------------------------------*04670001
046800*  ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED      *04680001
046900*  FIRST.  NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED  *04690001
047000*  FROM THE CICS ARCHITECTURE API.                               *04700001
047100*----------------------------------------------------------------*04710001
047200 2100-CHECK-FUNCTION-KEY.                                         04720001
047300     EVALUATE TRUE                                                04730001
047400*                                                                 04740001
047500* ENTER                                                           04750001
047600         WHEN DP020-SRC-AID = DP016-ENTER                         04760001
047700             PERFORM 4000-BUILD-INITIAL-PANEL                     04770065
047800             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 04780065
047900             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  04790065
047910             MOVE -1  TO  ASKUL                                   04791065
048000                                                                  04800035
048100*                                                                 04810001
048200* F17 - STORE LIST                                                04820002
048300         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              04830034
048400             IF ASC-SKU-X  = SPACES                               04840065
048500                 SET PS-ERROR                                     04850034
048600                     DP020-MSG-FATAL         TO TRUE              04860034
048700                 MOVE PC-TSYMSG-00007        TO DP020-MSG-NUMBER  04870034
048800                 MOVE DP015-UNP-ALP-BRT-OFF  TO ASKUA             04880065
048900                 MOVE DP015-RED              TO ASKUC             04890065
049000                 MOVE DP015-REVERSE          TO ASKUH             04900065
049100                 MOVE -1                     TO ASKUL             04910065
049200                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              04920034
049300             END-IF                                               04930035
050800             IF PS-NO-ERROR                                       05080036
050900                 PERFORM 2110-PREPARE-INTER-APPL-COMM             05090036
051000             END-IF                                               05100037
051200*                                                                 05120002
051300* F18 - STORE INTRANSIT DETAIL LIST                               05130002
051400         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              05140034
051500             IF ASC-SKU-X  = SPACES                               05150065
051600                 SET PS-ERROR                                     05160035
051700                     DP020-MSG-FATAL         TO TRUE              05170035
051800                 MOVE PC-TSYMSG-00007        TO DP020-MSG-NUMBER  05180035
051900                 MOVE DP015-UNP-ALP-BRT-OFF  TO ASKUA             05190065
052000                 MOVE DP015-RED              TO ASKUC             05200065
052100                 MOVE DP015-REVERSE          TO ASKUH             05210065
052200                 MOVE -1                     TO ASKUL             05220065
052300                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              05230035
052400             END-IF                                               05240035
052401             IF ASC-STORE-NBR-X = SPACES                          05240165
052402                 SET PS-ERROR                                     05240235
052403                     DP020-MSG-FATAL         TO TRUE              05240335
052404                 MOVE PC-TSYMSG-00007        TO DP020-MSG-NUMBER  05240435
052405                 MOVE DP015-UNP-ALP-BRT-OFF  TO ASTOREA           05240565
052406                 MOVE DP015-RED              TO ASTOREC           05240665
052407                 MOVE DP015-REVERSE          TO ASTOREH           05240765
052408                 MOVE -1                     TO ASTOREL           05240865
052409                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              05240935
052410             END-IF                                               05241035
053900             IF PS-NO-ERROR                                       05390036
054000                 MOVE ASC-STORE-NBR-X TO DK-STORE-NUMBER          05400065
054100                 MOVE ASC-STORE-NBR   TO DK-STORE-NBR             05410065
054101                 SET ASC-DISPLAY-INTR TO TRUE                     05410165
054102                 PERFORM 2110-PREPARE-INTER-APPL-COMM             05410236
054103             END-IF                                               05410337
054200                                                                  05420002
054201*                                                                 05420165
054202* F23 - PO/RCVR UNBALANCED STORE EXPECTED SKU LIST                05420202
054203         WHEN DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)              05420334
054204             IF ASC-PO-X  = SPACES                                05420465
054205                 SET PS-ERROR                                     05420535
054206                     DP020-MSG-FATAL         TO TRUE              05420635
054207                 MOVE PC-TSYMSG-00007        TO DP020-MSG-NUMBER  05420735
054208                 MOVE DP015-UNP-ALP-BRT-OFF  TO APONBRA           05420865
054209                 MOVE DP015-RED              TO APONBRC           05420965
054210                 MOVE DP015-REVERSE          TO APONBRH           05421065
054211                 MOVE -1                     TO APONBRL           05421165
054212                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              05421235
054213             END-IF                                               05421335
054214             IF ASC-RCVR-NBR-X = SPACES                           05421465
054215                 SET PS-ERROR                                     05421535
054216                     DP020-MSG-FATAL         TO TRUE              05421635
054217                 MOVE PC-TSYMSG-00007        TO DP020-MSG-NUMBER  05421735
054218                 MOVE DP015-UNP-ALP-BRT-OFF  TO ARCVRA            05421865
054219                 MOVE DP015-RED              TO ARCVRC            05421965
054220                 MOVE DP015-REVERSE          TO ARCVRH            05422065
054221                 MOVE -1                     TO ARCVRL            05422165
054222                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              05422235
054223             END-IF                                               05422335
054224             IF PS-NO-ERROR                                       05422436
054225                 PERFORM 2110-PREPARE-INTER-APPL-COMM             05422536
054226             END-IF                                               05422637
054227                                                                  05422702
054228*                                                                 05422865
054229* F24 - STORE EXPECTED DETAIL LIST                                05422902
054230         WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)              05423034
054231             IF ASC-SKU-X  = SPACES                               05423165
054232                 SET PS-ERROR                                     05423235
054233                     DP020-MSG-FATAL         TO TRUE              05423335
054234                 MOVE PC-TSYMSG-00007        TO DP020-MSG-NUMBER  05423435
054235                 MOVE DP015-UNP-ALP-BRT-OFF  TO ASKUA             05423565
054236                 MOVE DP015-RED              TO ASKUC             05423665
054237                 MOVE DP015-REVERSE          TO ASKUH             05423765
054238                 MOVE -1                     TO ASKUL             05423865
054239                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              05423935
054240             END-IF                                               05424035
054241             IF ASC-STORE-NBR-X = SPACES                          05424165
054242                 SET PS-ERROR                                     05424235
054243                     DP020-MSG-FATAL         TO TRUE              05424335
054244                 MOVE PC-TSYMSG-00007        TO DP020-MSG-NUMBER  05424435
054245                 MOVE DP015-UNP-ALP-BRT-OFF  TO ASTOREA           05424565
054246                 MOVE DP015-RED              TO ASTOREC           05424665
054247                 MOVE DP015-REVERSE          TO ASTOREH           05424765
054248                 MOVE -1                     TO ASTOREL           05424865
054249                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              05424935
054250             END-IF                                               05425035
054260             IF PS-NO-ERROR                                       05426036
054270                 MOVE ASC-STORE-NBR-X TO DK-STORE-NUMBER          05427065
054280                 MOVE ASC-STORE-NBR   TO DK-STORE-NBR             05428065
054281                 SET ASC-DISPLAY-STR-EXPT TO TRUE                 05428165
054282                 PERFORM 2110-PREPARE-INTER-APPL-COMM             05428236
054283             END-IF                                               05428337
054284                                                                  05428402
076700         WHEN DP020-FK-LOCAL-GOTO (DP020-SRC-AID)                 07670046
076800         WHEN DP020-FK-DISPN-GO (DP020-SRC-AID)                   07680046
076900              PERFORM 2110-PREPARE-INTER-APPL-COMM                07690046
077000*                                                                 07700046
077100* OTHER                                                           07710036
077200         WHEN OTHER                                               07720001
077300              SET DP013-NO-ROLLBACK                               07730001
077400                  DP013-XCTL-DISPLAY-RESTART                      07740001
077500                  DP013-CICS-ABEND  TO TRUE                       07750001
077600              MOVE '2100-CHECK-FUNCTION-KEY'                      07760001
077700                                    TO DP013-PARAGRAPH            07770001
077800              MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'     07780001
077900                                   TO DP013-MESSAGE-TEXT (1)      07790001
078000             MOVE 'OR CODE MISSING FROM THIS PROGRAM TO PROCESS:' 07800001
078100                                   TO DP013-MESSAGE-TEXT (2)      07810001
078200             MOVE DP020-SRC-AID    TO PM-A-SRC-AID                07820001
078300             MOVE DP020-FK-ACTION (DP020-SRC-AID)                 07830001
078400                                   TO PM-A-FK-ACTION              07840001
078500             MOVE DP020-FK-DISPN-IND (DP020-SRC-AID)              07850001
078600                                   TO PM-A-FK-DISPN               07860001
078700             MOVE PM-ABEND-INFO-A  TO DP013-MESSAGE-TEXT (3)      07870001
078800             MOVE 'REVIEW PFKEYS SETUP FOR THIS MNEMONIC.'        07880001
078900                                   TO DP013-MESSAGE-TEXT (4)      07890001
079000             PERFORM DP013-0000-PROCESS-ABEND                     07900001
079100     END-EVALUATE.                                                07910001
079200                                                                  07920001
084000*----------------------------------------------------------------*08400001
084100*  MOVE DATA NECESSARY TO THE DESTINATION PROGRAM(S) INTO THE    *08410001
084200*  INTER-APPLICATION COMMAREA.                                   *08420001
084300*----------------------------------------------------------------*08430001
084400 2110-PREPARE-INTER-APPL-COMM.                                    08440001
084500                                                                  08450001
084600     INITIALIZE PC210-INTER-APPL-COMMAREA.                        08460002
084700                                                                  08470001
085100     MOVE ASC-SKU                 TO PC210-SKU.                   08510002
085200     MOVE ASC-STORE-NBR           TO PC210-STORE-NBR.             08520065
085300     MOVE ASC-STORE-NAME          TO PC210-STORE-NAME.            08530065
085400     MOVE ASC-PO                  TO PC210-PO-NBR.                08540065
085500     PERFORM 2115-GET-BOSS-PARM.                                  08550065
085600**  CHECK IF THIS IS A BOSS RECEIVER                              08560065
085700     IF ASC-RCVR-NBR-X = 'BSS '                                   08570065
085800        MOVE PV-PARM-BOSS-RECV    TO PC210-RCVR-NBR               08580065
085900     ELSE                                                         08590065
086000        MOVE ASC-RCVR-NBR         TO PC210-RCVR-NBR               08600065
086100     END-IF.                                                      08610065
086200     MOVE ASC-UPC-ID              TO PC210-UPC-ID.                08620065
086201     MOVE ASC-SCREEN-DISPLAY      TO PC210-SCREEN-DISPLAY.        08620165
086202                                                                  08620201
086203*----------------------------------------------------------------*08620365
086204*- RETRIEVE THE PARAMETER FROM TKRPRPM TO DETERMINE IF THIS IS    08620465
086205*- A BOSS RECEIVER.                                               08620565
086206*----------------------------------------------------------------*08620665
086207 2115-GET-BOSS-PARM.                                              08620765
086208                                                                  08620865
086209     EXEC SQL                                                     08620965
086210          SELECT FUNC_QTY                                         08621065
086220          INTO  :PV-PARM-BOSS-RECV                                08622065
086230           FROM TKRPRPM                                           08623065
086240          WHERE LOC_ID            =  90                           08624065
086250            AND SYS_PRC_FUNC_CDE  = 'BSSRCV'                      08625065
086260            AND INTFC_SYS_CDE     = 'GIV'                         08626065
086270            AND FUNC_PRC_STAT_CDE = 'AC'                          08627065
086280           WITH UR                                                08628065
086290     END-EXEC.                                                    08629065
086300                                                                  08630065
086400     EVALUATE TRUE                                                08640065
086500         WHEN SQLCODE = ZERO                                      08650065
086600              CONTINUE                                            08660065
086700                                                                  08670065
086800         WHEN SQLWARN0 NOT = SPACE                                08680065
086900         WHEN SQLCODE NOT = ZERO                                  08690065
087000              MOVE '1110-GET-BOSS-PARM'                           08700065
087100                                  TO DP013-PARAGRAPH              08710065
087200              MOVE 'BOSS RCVR PARM       '                        08720065
087300                                  TO DP013-MESSAGE-TEXT (1)       08730065
087400              MOVE SQLCA          TO DP013-SQLCA                  08740065
087500              MOVE 'TKRPRPM'      TO DP013-DB2-TABLE-NAME (1)     08750065
087600              SET DP013-DB2-ABEND TO TRUE                         08760065
087700              PERFORM DP013-0000-PROCESS-ABEND                    08770065
087800     END-EVALUATE.                                                08780065
087801                                                                  08780165
087802*----------------------------------------------------------------*08780201
087803* MOVE DATA ENTERED ON THE SCREEN INTO THEIR RESPECTIVE FIELDS IN*08780301
087804* THE APPLICATION-SPECIFIC COMMAREA.  ALL EDITS ARE DONE IN THE  *08780401
087805* APPLICATION-SPECIFIC COMMAREA, NOT ON THE SCREEN.              *08780501
087806*----------------------------------------------------------------*08780601
087807 2200-MOVE-SCREEN-TO-COMMAREA.                                    08780701
087808                                                                  08780801
087809* SKU NUMBER                                                      08780903
087810     IF  ASKUL   > ZERO                                           08781038
087811         MOVE ASKUI            TO ASC-SKU-X                       08781165
087812     ELSE                                                         08781254
087813         MOVE ZEROES           TO ASC-SKU-X                       08781365
087814     END-IF.                                                      08781401
087815                                                                  08781501
103800* STORE DESTINATION                                               10380003
103900     IF  ASTOREL  > ZERO                                          10390038
104000         MOVE ASTOREI             TO ASC-STORE-NBR-X              10400030
104100     ELSE                                                         10410054
104200         MOVE SPACES              TO ASC-STORE-NBR-X              10420054
104300     END-IF.                                                      10430003
104400                                                                  10440003
104401* PO / RCVR NUMBER                                                10440165
104402     IF  APONBRL  > ZERO                                          10440238
104403         MOVE APONBRI             TO ASC-PO-X                     10440365
104404     ELSE                                                         10440454
104405         MOVE SPACES              TO ASC-PO-X                     10440565
104406     END-IF.                                                      10440603
104407                                                                  10440703
104408     IF  ARCVRL  > ZERO                                           10440838
104409         MOVE ARCVRI             TO ASC-RCVR-NBR-X                10440965
104410     ELSE                                                         10441054
104411         MOVE SPACES              TO ASC-RCVR-NBR-X               10441165
104412     END-IF.                                                      10441203
104413                                                                  10441303
105900*----------------------------------------------------------------*10590003
106000* ENSURE THE DATA IS CORRECT.  NOTE THAT IN A CRITERIA SPECIFI-  *10600001
106100* CATION SCREEN ONLY MINIMAL EDITS ARE DONE.  EDITS RELATED TO   *10610001
106200* A SPECIFIC SCREEN THAT THE USER IS GOING TO (LOCAL-GO) ARE DONE*10620001
106300* IN THE DESTINATION PROGRAM, NOT HERE.                          *10630001
106400*----------------------------------------------------------------*10640001
106500 3000-EDIT-DATA-IN-COMMAREA.                                      10650001
106600                                                                  10660001
106700     PERFORM 3200-RESET-ATTRIBUTES.                               10670001
106800                                                                  10680001
106900*-----------------------------------------------------------------10690001
107000* VERIFY THAT SKU NUMBER IS NUMERIC                               10700065
107100*-----------------------------------------------------------------10710001
107200     IF  ASC-SKU-X >  SPACES                                      10720065
107300         MOVE ASC-SKU-B                TO DP010I-UNEDITED-FIELD   10730065
107400         MOVE LENGTH OF ASC-SKU-B      TO DP010I-MAXIMUM-DIGITS   10740065
107500         MOVE ZERO                     TO DP010I-MAXIMUM-DECIMALS 10750065
107600         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  10760001
107710         CALL DP010I-NUMERIC-EDIT-ROUTINE                         10771066
107720                         USING DP010I-NUMERIC-EDIT-AREA           10772066
107800         IF  DP010I-ERROR-DETECTED                                10780001
107900             SET PS-ERROR                                         10790001
108000                 DP020-MSG-FATAL         TO TRUE                  10800005
108100             MOVE PC-TSYMSG-00008        TO DP020-MSG-NUMBER      10810005
108200             MOVE DP015-UNP-ALP-BRT-OFF  TO ASKUA                 10820065
108300             MOVE DP015-RED              TO ASKUC                 10830065
108400             MOVE DP015-REVERSE          TO ASKUH                 10840065
108500             MOVE -1                     TO ASKUL                 10850065
108600             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  10860001
108700         ELSE                                                     10870001
108800             MOVE DP010I-NUMERIC-FIELD TO ASC-SKU                 10880065
109000         END-IF                                                   10900001
109100*    ELSE                                                         10910019
109200*            SET PS-ERROR                                         10920019
109300*                DP020-MSG-FATAL         TO TRUE                  10930019
109400*            MOVE PC-TSYMSG-00007        TO DP020-MSG-NUMBER      10940019
109500*            MOVE DP015-UNP-ALP-BRT-OFF  TO ASKUA                 10950065
109600*            MOVE DP015-RED              TO ASKUC                 10960065
109700*            MOVE DP015-REVERSE          TO ASKUH                 10970065
109800*            MOVE -1                     TO ASKUL                 10980065
109900*            SET DP030-SET-CURSOR-APPL-1 TO TRUE                  10990019
110000     END-IF.                                                      11000001
110100                                                                  11010001
110200*-----------------------------------------------------------------11020065
110201* VERIFY THAT SKU NUMBER IS VALID                                 11020165
110202*-----------------------------------------------------------------11020201
110203     IF  PS-NO-ERROR                                              11020365
110204         IF  ASC-SKU   >  ZEROES                                  11020465
110205             INITIALIZE XL001-ITEM-COMMAREA                       11020565
110206             SET XL001-BY-NUMERIC-SKU TO TRUE                     11020665
110207             SET XL001-SELECT-SKU     TO TRUE                     11020765
110208             MOVE ASC-SKU             TO XL001-KEY-SKU            11020865
110209                                                                  11020965
110210             CALL PC-XL001-VSM-PGM USING DFHEIBLK                 11021065
110220                                         XL001-COMMAREA           11022065
110230                                         XL001-ITEM-COMMAREA      11023065
110240                                                                  11024065
110250             IF XL001-SUCCESSFUL                                  11025065
110260                 MOVE XL001-SKU-DESC    TO ADESCO                 11026065
110270                                           ASC-SKU-DESC           11027065
110280                 MOVE XL001-INTR-UPC-ID TO ASC-UPC-ID             11028065
110290                 MOVE XL001-ITM-NBR     TO ASC-ITEM-NBR           11029065
110300             ELSE                                                 11030065
110400                 IF XL001-SQL-ERROR                               11040065
110500                     MOVE SPACES              TO ADESCO           11050065
110600                                                 ASC-SKU-DESC     11060065
110700                     MOVE ZEROES              TO ASC-UPC-ID       11070065
110800                                                 ASC-ITEM-NBR     11080065
110900                     SET PS-ERROR                                 11090065
111000                         DP020-MSG-FATAL         TO TRUE          11100065
111100                     MOVE PC-TSYMSG-00005    TO DP020-MSG-NUMBER  11110065
111200                     MOVE DP015-UNP-ALP-BRT-OFF  TO ASKUA         11120065
111300                     MOVE DP015-RED              TO ASKUC         11130065
111400                     MOVE DP015-REVERSE          TO ASKUH         11140065
111500                     MOVE -1                     TO ASKUL         11150065
111600                     SET DP030-SET-CURSOR-APPL-1 TO TRUE          11160065
111700                 ELSE                                             11170065
111800                     SET PS-ERROR    TO TRUE                      11180065
111900                     MOVE '3000-VALIDATE-SKU' TO DP013-PARAGRAPH  11190065
112000                     MOVE 'UNSUCCESSFUL CALL TO XLKUT001'         11200065
112100                                         TO DP013-MESSAGE-TEXT (1)11210065
112200                     MOVE 'XLKUT001' TO DP013-DB2-TABLE-NAME (1)  11220065
112300                     SET DP013-DB2-ABEND                          11230065
112400                         DP013-XCTL-DISPLAY-RESTART TO TRUE       11240065
112500                     PERFORM DP013-0000-PROCESS-ABEND             11250065
112600                 END-IF                                           11260065
112700             END-IF                                               11270065
112800         END-IF                                                   11280065
112900     END-IF.                                                      11290065
113000                                                                  11300065
129100*-----------------------------------------------------------------12910031
129200* VERIFY THAT STORE NUMBER IS NUMERIC                             12920031
129300*-----------------------------------------------------------------12930031
129400     IF  PS-NO-ERROR                                              12940031
129500         IF  ASC-STORE-NBR-X  >  ZEROES                           12950065
129600             MOVE ASC-STORE-NBR-X        TO DP010I-UNEDITED-FIELD 12960031
129700             MOVE LENGTH OF ASC-STORE-NBR-X  TO                   12970065
129800                                            DP010I-MAXIMUM-DIGITS 12980031
129900             MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS 12990031
130000             SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE              13000031
130110             CALL DP010I-NUMERIC-EDIT-ROUTINE                     13011066
130120                         USING DP010I-NUMERIC-EDIT-AREA           13012066
130200             IF  DP010I-ERROR-DETECTED                            13020031
130300                 SET PS-ERROR                                     13030031
130400                     DP020-MSG-FATAL         TO TRUE              13040031
130500                 MOVE PC-TSYMSG-00008        TO DP020-MSG-NUMBER  13050031
130600                 MOVE DP015-UNP-ALP-BRT-OFF  TO ASTOREA           13060031
130700                 MOVE DP015-RED              TO ASTOREC           13070031
130800                 MOVE DP015-REVERSE          TO ASTOREH           13080031
130900                 MOVE -1                     TO ASTOREL           13090031
131000                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              13100031
131100             ELSE                                                 13110031
131200                 MOVE DP010I-NUMERIC-FIELD TO ASC-STORE-NBR       13120031
131300                 MOVE ASC-STORE-NBR        TO ASTOREO             13130031
131400             END-IF                                               13140031
131500         END-IF                                                   13150031
131600     END-IF.                                                      13160031
131700                                                                  13170031
131800*-----------------------------------------------------------------13180031
131900* VERIFY THAT STORE NUMBER ENTERED IS VALID                       13190031
132000*-----------------------------------------------------------------13200031
132100     IF  PS-NO-ERROR                                              13210031
132200         IF  ASC-STORE-NBR  >  ZEROES                             13220031
132300             MOVE  ASC-STORE-NBR  TO  DK-STORE-NBR                13230031
132400             PERFORM 3500-GET-STORE-INFORMATION                   13240065
135500         END-IF                                                   13550031
135600     END-IF.                                                      13560031
135700                                                                  13570031
135800*-----------------------------------------------------------------13580065
135801* VERIFY THAT PO NUMBER IS NUMERIC                                13580165
135802*-----------------------------------------------------------------13580231
135803     IF  PS-NO-ERROR                                              13580331
135804         IF  ASC-PO-X   >  ZEROES                                 13580465
135805             MOVE ASC-PO-X               TO DP010I-UNEDITED-FIELD 13580531
135806             MOVE LENGTH OF ASC-PO-X    TO  DP010I-MAXIMUM-DIGITS 13580631
135807             MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS 13580731
135808             SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE              13580831
135810             CALL DP010I-NUMERIC-EDIT-ROUTINE                     13581066
135811                         USING DP010I-NUMERIC-EDIT-AREA           13581166
135812             IF  DP010I-ERROR-DETECTED                            13581231
135813                 SET PS-ERROR                                     13581331
135814                     DP020-MSG-FATAL         TO TRUE              13581431
135815                 MOVE PC-TSYMSG-00008        TO DP020-MSG-NUMBER  13581531
135816                 MOVE DP015-UNP-ALP-BRT-OFF  TO APONBRA           13581631
135817                 MOVE DP015-RED              TO APONBRC           13581731
135818                 MOVE DP015-REVERSE          TO APONBRH           13581831
135819                 MOVE -1                     TO APONBRL           13581931
135820                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              13582031
135821             ELSE                                                 13582131
135822                 MOVE DP010I-NUMERIC-FIELD TO ASC-PO              13582231
135823                 MOVE ASC-PO               TO PV-PO-NBR           13582331
135824                 MOVE PV-PO-NBR            TO APONBRO             13582431
135825             END-IF                                               13582531
135826         END-IF                                                   13582631
135827     END-IF.                                                      13582731
135828                                                                  13582831
135829*-----------------------------------------------------------------13582931
135830* VERIFY THAT RCVR NUMBER IS NUMERIC                              13583065
135831*-----------------------------------------------------------------13583131
135832     IF  PS-NO-ERROR                                              13583231
135840         IF  ASC-RCVR-NBR-X = 'BSS '                              13584065
135850             MOVE 'BSS '                 TO ARCVRO                13585065
135860         ELSE                                                     13586065
135861         IF  ASC-RCVR-NBR-X > ZEROES                              13586165
135862             MOVE ASC-RCVR-NBR-X         TO DP010I-UNEDITED-FIELD 13586231
135863             MOVE LENGTH OF ASC-RCVR-NBR-X TO                     13586365
135864                                            DP010I-MAXIMUM-DIGITS 13586431
135865             MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS 13586531
135866             SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE              13586631
135868             CALL DP010I-NUMERIC-EDIT-ROUTINE                     13586866
135869                         USING DP010I-NUMERIC-EDIT-AREA           13586966
135870             IF  DP010I-ERROR-DETECTED                            13587031
135871                 SET PS-ERROR                                     13587131
135872                     DP020-MSG-FATAL         TO TRUE              13587231
135880                 MOVE PC-TSYMSG-00008        TO DP020-MSG-NUMBER  13588031
135890                 MOVE DP015-UNP-ALP-BRT-OFF  TO ARCVRA            13589065
135900                 MOVE DP015-RED              TO ARCVRC            13590065
136000                 MOVE DP015-REVERSE          TO ARCVRH            13600065
136100                 MOVE -1                     TO ARCVRL            13610065
136101                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              13610165
136102             ELSE                                                 13610231
136103                 MOVE DP010I-NUMERIC-FIELD TO ASC-RCVR-NBR        13610331
136104                 MOVE ASC-RCVR-NBR         TO PV-RCVR-NBR         13610465
136105                 MOVE PV-RCVR-NBR          TO ARCVRO              13610565
136106             END-IF                                               13610665
136107         END-IF                                                   13610731
136108       END-IF                                                     13610831
136109     END-IF.                                                      13610931
136110                                                                  13611031
136120****************************************************************  13612065
136130*    THIS PARAGRAPH RETRIEVES THE STORE INFORMATION.           *  13613065
136140*                                                              *  13614065
136150****************************************************************  13615065
136160 3500-GET-STORE-INFORMATION.                                      13616065
136170                                                                  13617065
136180     INITIALIZE XL071-COMMAREA.                                   13618065
136190     MOVE DK-STORE-NBR TO XL071-LOCATION-NUMBER.                  13619065
136200                                                                  13620065
136300     CALL XL071-LOCATION-MODULE USING                             13630065
136400                                DFHEIBLK                          13640065
136500                                XL071-COMMAREA                    13650065
136600                                XL071-COMMAREA-REC.               13660065
136700                                                                  13670065
136800     EVALUATE TRUE                                                13680065
136900         WHEN XL071-NO-ERRORS                                     13690065
137000              MOVE XL071-LOC-NM TO ASC-STORE-NAME                 13700065
137100                                                                  13710065
137200         WHEN XL071-LOC-NOT-FOUND                                 13720065
137300              MOVE SPACES      TO ASC-STORE-NAME                  13730065
137400              SET PS-ERROR                                        13740065
137500                  DP020-MSG-FATAL         TO TRUE                 13750065
137600              MOVE PC-TSYMSG-00005        TO DP020-MSG-NUMBER     13760065
137700              MOVE DP015-UNP-ALP-BRT-OFF  TO ASTOREA              13770065
137800              MOVE DP015-RED              TO ASTOREC              13780065
137900              MOVE DP015-REVERSE          TO ASTOREH              13790065
138000              MOVE -1                     TO ASTOREL              13800065
138100              SET DP030-SET-CURSOR-APPL-1 TO TRUE                 13810065
138200                                                                  13820065
138300         WHEN OTHER                                               13830065
138400              MOVE '3500-GET-STORE-INFORMATION'                   13840065
138500                                  TO DP013-PARAGRAPH              13850065
138600              MOVE 'VALIDATE STORE NAME'                          13860065
138700                                  TO DP013-MESSAGE-TEXT (1)       13870065
138800              STRING ' LOCATION - '                               13880065
138900                      XL071-LOCATION-NUMBER                       13890065
139000                      DELIMITED BY SIZE                           13900065
139100                      INTO DP013-MESSAGE-TEXT (2)                 13910065
139200              MOVE XL071-SQLCA   TO DP013-SQLCA                   13920065
139300              MOVE XL071-DB2-TABLE TO DP013-DB2-TABLE-NAME (1)    13930065
139400              SET DP013-DB2-ABEND                                 13940065
139500                  DP013-XCTL-DISPLAY-RESTART TO TRUE              13950065
139600              PERFORM DP013-0000-PROCESS-ABEND                    13960065
139700                                                                  13970065
139800     END-EVALUATE.                                                13980065
139900                                                                  13990065
140000                                                                  14000065
163000*----------------------------------------------------------------*16300001
163100*  MOVE THE DEFAULT ATTRIBUTES TO ALL OF THE OPEN FIELDS ON THE  *16310001
163200*  MAP.                                                          *16320001
163300*----------------------------------------------------------------*16330001
163400 3200-RESET-ATTRIBUTES.                                           16340001
163500                                                                  16350001
163600     MOVE DP015-ASK-NOR-MDT        TO ADESCA                      16360005
163700                                      ANAMEA.                     16370065
164100                                                                  16410001
166700     MOVE DP015-UNP-NUM-NOR-MDT    TO ASKUA                       16670006
166900                                      ASTOREA.                    16690006
167100                                                                  16710001
167200     MOVE DP015-GREEN              TO ASKUC                       16720006
169600                                      ASTOREC.                    16960032
169900                                                                  16990001
170000     MOVE DP015-BLUE               TO ADESCC                      17000006
170100                                      ANAMEC.                     17010065
170500                                                                  17050001
170600     MOVE DP015-UNDERLINE          TO ASKUH                       17060006
173000                                      ASTOREH.                    17300006
173300                                                                  17330001
173400*----------------------------------------------------------------*17340007
173500*  POSITION THE CURSOR AT THE APPROPRIATE FIELD.                 *17350007
173600*  IF THERE IS ANY DATA TO MOVE TO THE SCREEN ON INITIAL, MOVE   *17360007
173700*  IT HERE.                                                      *17370007
173800*----------------------------------------------------------------*17380007
173900 4000-BUILD-INITIAL-PANEL.                                        17390007
174000     SET DP030-SET-CURSOR-APPL-1   TO TRUE.                       17400007
174100     MOVE -1                       TO ASKUL.                      17410065
174200                                                                  17420065
174300     MOVE ASC-SKU                  TO ASKUO.                      17430065
174400     MOVE ASC-SKU-DESC             TO ADESCO.                     17440065
174500     MOVE ASC-STORE-NBR            TO ASTOREO.                    17450065
174600     MOVE ASC-STORE-NAME           TO ANAMEO.                     17460065
174700     MOVE ASC-PO                   TO PV-PO-NBR.                  17470065
174800     MOVE PV-PO-NBR                TO APONBRO.                    17480065
174900**  CHECK IF THIS IS A BOSS RECEIVER                              17490065
175000     IF ASC-RCVR-NBR-X = 'BSS '                                   17500065
175100        MOVE 'BSS '                TO ARCVRO                      17510065
175200     ELSE                                                         17520065
175300        MOVE ASC-RCVR-NBR          TO PV-RCVR-NBR                 17530065
175400        MOVE PV-RCVR-NBR           TO ARCVRO                      17540065
175500     END-IF.                                                      17550065
175600                                                                  17560065
179500*----------------------------------------------------------------*17950026
179600*    RESTORE THE DATA ON THE SCREEN FROM THE COMM AREA.          *17960026
179700*----------------------------------------------------------------*17970026
179800 4400-MOVE-COMMAREA-TO-SCREEN.                                    17980026
179900     MOVE ASC-SKU              TO ASKUO.                          17990065
180000     MOVE ASC-SKU-DESC         TO ADESCO.                         18000065
180100     MOVE ASC-STORE-NBR        TO ASTOREO.                        18010065
180200     MOVE ASC-STORE-NAME       TO ANAMEO.                         18020065
186200                                                                  18620026
186300*----------------------------------------------------------------*18630001
186400*    ABEND PROCESSOR MODULE                                      *18640001
186500*----------------------------------------------------------------*18650001
186700     COPY DPPD013.                                                18670001
186800                                                                  18680001
