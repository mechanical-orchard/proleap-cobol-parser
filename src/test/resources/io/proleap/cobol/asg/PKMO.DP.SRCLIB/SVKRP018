000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.         SVKRP018.                                    00020099
000300 AUTHOR.             ANGIE COLE.                                  00030000
000400 INSTALLATION.       KOHLS DEPARTMENT STORES.                     00040000
000500 DATE-WRITTEN.       NOVEMBER 1996.                               00050000
000600 DATE-COMPILED.                                                   00060000
000700                                                                  00070000
000800******************************************************************00080099
000900* THIS PROGRAM PRODUCES TWO DAILY REPORTS.                       *00090000
001000*   1.) KOHL'S MERCHANDISE RETURN CREDIT AUTHORIZER LOG.         *00100000
001100*   2.) KOHL'S GIFT CARD AUTHORIZER LOG.                         *00110000
001200*                                                                *00120000
001300* THE PURPOSE OF THESE REPORTS IS TO SHOW EACH AUTHORIZER THAT   *00130000
001400* WAS INVOLVED IN VOIDING, ISSUING OR TENDERING A KMRC, OR GIFT  *00140000
001500* CARD.                                                          *00150000
001600*                                                                *00160000
001700* ALL TRANSACTIONS WITH A TRN-VOID-IND OF 'Y' AND A TRN-RVRSL-CDE*00170000
001800* OF '0' WILL NOT BE INDICATED AS A VOID ON THE REPORT.          *00180000
001900******************************************************************00190000
W3540C*                                                                 00191099
W3540C* REQUIREMENT   : PAYMENT RELATED CHANGES FOR FSH PROJECT         00192099
W3540C* PROJECT ID    : W3540C                                          00193099
W3540C* AUTHOR        : COGNIZANT                                       00194099
W3540C* DATES CHANGED : 15-OCT-2012                                     00195099
W3540C* CHANGES MADE  : THE FORMAT OF THE DATE CONTROL CARD IS BEING    00196099
W3540C*                 CHANGED FROM 'MMDDCCYY' TO 'CCYYMMDD CCYYMMDD'  00197099
W3540C*                 AND CORRESPONDINGLY, THE CODE IS UPDATED.       00198099
W3540C*                                                                 00199199
W3540C******************************************************************00199299
002000 ENVIRONMENT DIVISION.                                            00200000
002100******************************************************************00210000
002200 CONFIGURATION SECTION.                                           00220000
002300                                                                  00230000
002400 SOURCE-COMPUTER.    IBM-3090.                                    00240000
002500 OBJECT-COMPUTER.    IBM-3090.                                    00250000
002600                                                                  00260000
002700 INPUT-OUTPUT SECTION.                                            00270000
002800                                                                  00280000
002900 FILE-CONTROL.                                                    00290000
003000                                                                  00300000
003100     SELECT CONTROL-DATE-FILE         ASSIGN TO INP01.            00310000
003200     SELECT REPORT-FILE               ASSIGN TO RPT01.            00320000
003300     SELECT REPORT-FILE-GFT-CRD       ASSIGN TO RPT02.            00330000
003400     SELECT REPORT-FILE-KMRC          ASSIGN TO RPT03.            00340099
003500     SELECT REPORT-FILE-GIFT          ASSIGN TO RPT04.            00350099
003600                                                                  00360000
003700******************************************************************00370000
003800 DATA DIVISION.                                                   00380000
003900******************************************************************00390000
004000                                                                  00400000
004100 FILE SECTION.                                                    00410000
004200                                                                  00420000
004300                                                                  00430000
004400 FD  CONTROL-DATE-FILE                                            00440000
004500     RECORDING MODE IS F                                          00450000
004600     BLOCK CONTAINS 0 RECORDS                                     00460000
004700     LABEL RECORDS ARE OMITTED.                                   00470000
004800                                                                  00480000
004900 01  CONTROL-DATE-RECORD              PIC X(80).                  00490000
005000                                                                  00500000
005100 FD  REPORT-FILE                                                  00510000
005200     RECORDING MODE IS F                                          00520000
005300     BLOCK CONTAINS 0 RECORDS                                     00530000
005400     LABEL RECORDS ARE OMITTED.                                   00540000
005500                                                                  00550000
005600 01  REPORT-RECORD                    PIC X(132).                 00560000
005700                                                                  00570000
005800 FD  REPORT-FILE-GFT-CRD                                          00580000
005900     RECORDING MODE IS F                                          00590000
006000     BLOCK CONTAINS 0 RECORDS                                     00600000
006100     LABEL RECORDS ARE OMITTED.                                   00610000
006200                                                                  00620000
006300 01  REPORT-RECORD-GFT-CRD            PIC X(132).                 00630000
006400                                                                  00640000
006500 FD  REPORT-FILE-KMRC                                             00650099
006600     RECORDING MODE IS F                                          00660099
006700     BLOCK CONTAINS 0 RECORDS                                     00670099
006800     LABEL RECORDS ARE OMITTED.                                   00680099
006900                                                                  00690099
007000 01  REPORT-RECORD-KMRC               PIC X(132).                 00700099
007100                                                                  00710099
007200 FD  REPORT-FILE-GIFT                                             00720099
007300     RECORDING MODE IS F                                          00730099
007400     BLOCK CONTAINS 0 RECORDS                                     00740099
007500     LABEL RECORDS ARE OMITTED.                                   00750099
007600                                                                  00760099
007700 01  REPORT-RECORD-GIFT               PIC X(132).                 00770099
007800                                                                  00780099
007900                                                                  00790000
008000 WORKING-STORAGE SECTION.                                         00800000
008100                                                                  00810000
008200 01  ABEND-CODE                       PIC S9(04)    VALUE +0 COMP.00820000
008300                                                                  00830000
008400******************************************************************00840000
W3540C*    CR-CONTROL RECORD   DATE IN CCYYMMDD CCYYMMDD FORMAT        *00851099
008600******************************************************************00860000
008700 01  CR-CONTROL-RECORD.                                           00870000
W3540C     05  CR-CONTROL-CURR-DATE.                                    00881099
W3540C         10  CR-CURR-CC               PIC  X(02)    VALUE SPACES. 00882099
W3540C         10  CR-CURR-YY               PIC  X(02)    VALUE SPACES. 00883099
W3540C         10  CR-CURR-MM               PIC  X(02)    VALUE SPACES. 00884099
W3540C         10  CR-CURR-DD               PIC  X(02)    VALUE SPACES. 00885099
W3540C     05  FILLER                       PIC  X(01)    VALUE SPACE.  00886099
W3540C     05  CR-CONTROL-PREV-DATE.                                    00886199
W3540C         10  CR-PREV-CC               PIC  X(02)    VALUE SPACES. 00886299
W3540C         10  CR-PREV-YY               PIC  X(02)    VALUE SPACES. 00886399
W3540C         10  CR-PREV-MM               PIC  X(02)    VALUE SPACES. 00886499
W3540C         10  CR-PREV-DD               PIC  X(02)    VALUE SPACES. 00886599
W3540C     05  FILLER                       PIC  X(63)    VALUE SPACES. 00887099
009400                                                                  00940000
009500******************************************************************00950000
009600*    PC-PROGRAM CONSTANTS                                        *00960000
009700******************************************************************00970000
009800 01  PC-PROGRAM-CONSTANTS.                                        00980000
009900     05  PC-PROGRAM-NAME              PIC  X(08)     VALUE        00990000
010000                                                      'SVKRP018'. 01000099
010100     05  PC-CALENDAR-PGM              PIC  X(08)     VALUE        01010000
010200                                                    'DPKUT500'.   01020000
010300     05  PC-ONE                       PIC  9(01)     VALUE 1.     01030000
010400     05  PC-TWO                       PIC  9(01)     VALUE 2.     01040000
010500     05  PC-THREE                     PIC  9(01)     VALUE 3.     01050000
010600     05  PC-FOUR                      PIC  9(01)     VALUE 4.     01060000
010700     05  PC-HEADER-LINE-COUNT         PIC S9(03)     VALUE +3     01070000
010800                                                     COMP.        01080000
010900     05  PC-MAX-LINES-PER-PAGE        PIC S9(03)     VALUE +60    01090000
011000                                                     COMP.        01100000
011100     05  PC-MAX-LINES-BEFORE-TOT-PG   PIC S9(03)     VALUE +46    01110000
011200                                                     COMP.        01120000
011300     05  PC-MAX-LINES-AUTH-HEADER PIC S9(03)         VALUE +58    01130000
011400                                                     COMP.        01140000
011500     05  PC-DAYS-TO-INCREMENT         PIC 9(04)      VALUE 1.     01150000
011600                                                                  01160000
011700******************************************************************01170000
011800*    RESPROGRAM VARIABLES                                        *01180000
011900******************************************************************01190000
012000 01  PV-PROGRAM-VARIABLES.                                        01200000
012100     05  PV-PARAGRAPH-NAME            PIC  X(30)     VALUE SPACES.01210000
012200     05  PV-DB2-OPERATION-ATTEMPTED   PIC  X(30)     VALUE SPACES.01220000
012300                                                                  01230000
012400     05  PV-CURRENT-DATE.                                         01240000
012500         10  PV-CURRENT-YEAR          PIC  9(02)     VALUE ZERO.  01250000
012600         10  PV-CURRENT-MONTH         PIC  9(02)     VALUE ZERO.  01260000
012700         10  PV-CURRENT-DAY           PIC  9(02)     VALUE ZERO.  01270000
012800     05  PV-CURRENT-TIME.                                         01280000
012900         10  PV-CURRENT-HOUR          PIC  9(02)     VALUE ZERO.  01290000
013000         10  PV-CURRENT-MINUTE        PIC  9(02)     VALUE ZERO.  01300000
013100         10  FILLER                   PIC  9(04)     VALUE ZERO.  01310000
013200     05  PV-TODAYS-TIMESTAMP-DETAIL.                              01320000
013300         10  PV-TODAYS-DATE.                                      01330099
W3540C             15  PV-TODAYS-YYYY           PIC  X(04).             01351099
013600             15  FILLER                   PIC  X(01)   VALUE '-'. 01360099
013700             15  PV-TODAYS-MM             PIC  X(02).             01370099
013800             15  FILLER                   PIC  X(01)   VALUE '-'. 01380099
013900             15  PV-TODAYS-DD             PIC  X(02).             01390099
014000         10  FILLER                   PIC  X(01)     VALUE '-'.   01400000
014100         10  PV-TODAYS-BEG-HH         PIC  X(02)     VALUE '03'.  01410000
014200         10  FILLER                   PIC  X(01)     VALUE '.'.   01420000
014300         10  PV-TODAYS-BEG-MM         PIC  X(02)     VALUE '00'.  01430000
014400         10  FILLER                   PIC  X(01)     VALUE '.'.   01440000
014500         10  PV-TODAYS-BEG-SS         PIC  X(02)     VALUE '00'.  01450000
014600         10  FILLER                   PIC  X(01)     VALUE '.'.   01460000
014700         10  PV-TODAYS-BEG-TTTTTT     PIC  X(06)     VALUE        01470000
014800                                                     '000000'.    01480000
014900     05  PV-TODAYS-TIMESTAMP REDEFINES PV-TODAYS-TIMESTAMP-DETAIL 01490000
015000                                      PIC  X(26).                 01500000
015100                                                                  01510000
015200     05  PV-TOMORROWS-TIMESTAMP-DTL.                              01520000
015300         10  PV-TOMORROWS-YYYY        PIC  X(04).                 01530000
015400         10  FILLER                   PIC  X(01)     VALUE '-'.   01540000
015500         10  PV-TOMORROWS-MM          PIC  X(02).                 01550000
015600         10  FILLER                   PIC  X(01)     VALUE '-'.   01560000
015700         10  PV-TOMORROWS-DD          PIC  X(02).                 01570000
015800         10  FILLER                   PIC  X(01)     VALUE '-'.   01580000
015900         10  PV-TOMORROWS-BEG-HH      PIC  X(02)     VALUE '02'.  01590000
016000         10  FILLER                   PIC  X(01)     VALUE '.'.   01600000
016100         10  PV-TOMORROWS-BEG-MM      PIC  X(02)     VALUE '59'.  01610000
016200         10  FILLER                   PIC  X(01)     VALUE '.'.   01620000
016300         10  PV-TOMORROWS-BEG-SS      PIC  X(02)     VALUE '59'.  01630000
016400         10  FILLER                   PIC  X(01)     VALUE '.'.   01640000
016500         10  PV-TOMORROWS-BEG-TTTTTT  PIC  X(06)     VALUE        01650000
016600                                                     '999999'.    01660000
016700     05  PV-TOMORROWS-TIMESTAMP REDEFINES                         01670000
016800         PV-TOMORROWS-TIMESTAMP-DTL   PIC  X(26).                 01680000
016900                                                                  01690000
017000     05  PV-TODAYS-INPUT-DATE.                                    01700000
017100         10  PV-TODAYS-INPUT-MM       PIC  X(02)     VALUE ZERO.  01710000
017200         10  PV-TODAYS-INPUT-DD       PIC  X(02)     VALUE ZERO.  01720000
017300         10  PV-TODAYS-INPUT-YY       PIC  X(02)     VALUE ZERO.  01730000
017400         10  FILLER                   PIC  X(04)     VALUE SPACES.01740000
017500                                                                  01750000
017600     05  PV-DATE-RETURNED-FROM-ROUTINE.                           01760000
017700         10  PV-DATE-RETURNED-CCYY    PIC  X(04)     VALUE ZERO.  01770000
017800         10  FILLER                   PIC  X(01)     VALUE '-'.   01780000
017900         10  PV-DATE-RETURNED-MM      PIC  X(02)     VALUE ZERO.  01790000
018000         10  FILLER                   PIC  X(01)     VALUE '-'.   01800000
018100         10  PV-DATE-RETURNED-DD      PIC  X(02)     VALUE ZERO.  01810000
018200                                                                  01820000
018300     05  PV-TRN-AUTH-TMST.                                        01830000
018400         10  PV-AUTH-DATE.                                        01840000
018500             15  PV-AUTH-DATE-CC      PIC  X(02).                 01850000
018600             15  PV-AUTH-DATE-YY      PIC  X(02).                 01860000
018700             15  FILLER               PIC  X(01).                 01870000
018800             15  PV-AUTH-DATE-MM      PIC  X(02).                 01880000
018900             15  FILLER               PIC  X(01).                 01890000
019000             15  PV-AUTH-DATE-DD      PIC  X(02).                 01900000
019100         10  FILLER                   PIC  X(01).                 01910000
019200         10  PV-AUTH-TIME             PIC  X(08).                 01920000
019300         10  FILLER                   PIC  X(07).                 01930000
019400                                                                  01940000
019500     05  PV-ISSUE-DATE-TMST-DTL.                                  01950000
019600         10  PV-ISSUE-DATE.                                       01960000
019700             15  PV-ISSUE-DATE-CC     PIC  X(02).                 01970000
019800             15  PV-ISSUE-DATE-YY     PIC  X(02).                 01980000
019900             15  FILLER               PIC  X(01)     VALUE '-'.   01990000
020000             15  PV-ISSUE-DATE-MM     PIC  X(02).                 02000000
020100             15  FILLER               PIC  X(01)     VALUE '-'.   02010000
020200             15  PV-ISSUE-DATE-DD     PIC  X(02).                 02020000
020300         10  FILLER                   PIC  X(16).                 02030000
020400     05  PV-ISSUE-DATE-TMST     REDEFINES                         02040000
020500         PV-ISSUE-DATE-TMST-DTL       PIC  X(26).                 02050000
020600                                                                  02060000
020700     05  PV-HOLD-APVL-USR-ID          PIC  X(08)     VALUE SPACES.02070000
020800     05  PV-HOLD-PREV-CARD-TYPE-CDE   PIC  S9(1)V    COMP-3       02080099
020900                                                     VALUE +0.    02090099
021000     05  PV-CRD-NBR                   PIC  S9(12)    COMP-3.      02100099
021100                                                                  02110000
021200******************************************************************02120000
021300*    PS-PROGRAM SWITCHES                                         *02130000
021400******************************************************************02140000
021500 01  PS-PROGRAM-SWITCHES.                                         02150000
021600     05  PS-END-OF-CONTROL-FILE-SW    PIC  X(01)     VALUE 'N'.   02160000
021700         88  PS-END-OF-CONTROL-FILE                  VALUE 'Y'.   02170000
021800     05  PS-END-OF-KMRC-CSR-SW        PIC  X(01)     VALUE 'N'.   02180000
021900         88  PS-END-OF-KMRC-CSR                      VALUE 'Y'.   02190000
022000         88  PS-NOT-END-OF-KMRC-CSR                  VALUE 'N'.   02200000
022100     05  PS-VALID-AUTH-SW             PIC  X(01)     VALUE 'N'.   02210000
022200         88  PS-NOT-VALID-AUTH                       VALUE 'N'.   02220000
022300         88  PS-VALID-AUTH                           VALUE 'Y'.   02230000
022400     05  PS-CARD-TYPE-CODE-SW         PIC S9(01)  COMP-3  VALUE 0.02240099
022500         88  PS-MERCHANDISE-RETURN-CREDIT            VALUE 1.     02250099
022600         88  PS-GIFT-CARD                            VALUE 2.     02260099
022700                                                                  02270000
022800******************************************************************02280000
022900*    PA-PROGRAM ACCUMULATORS                                     *02290000
023000******************************************************************02300000
023100 01  PA-PROGRAM-ACCUMULATORS.                                     02310000
023200     05  PA-TOTAL-AUTHORIZERS         PIC S9(11)     COMP-3       02320000
023300                                                     VALUE ZEROES.02330000
023400     05  PA-GRAND-AUTH-NUM            PIC S9(11)     COMP-3       02340000
023500                                                     VALUE ZEROES.02350000
023600     05  PA-AUTH-TOTAL-ISSUES         PIC S9(6)V99   COMP-3       02360000
023700                                                     VALUE ZEROES.02370000
023800     05  PA-AUTH-TOTAL-ISSUE-VOIDS    PIC S9(6)V99   COMP-3       02380000
023900                                                     VALUE ZEROES.02390000
024000     05  PA-AUTH-TOTAL-TENDERS        PIC S9(6)V99   COMP-3       02400000
024100                                                     VALUE ZEROES.02410000
024200     05  PA-AUTH-TOTAL-TENDER-VOIDS   PIC S9(6)V99   COMP-3       02420000
024300                                                     VALUE ZEROES.02430000
024400     05  PA-AUTH-TOTAL-FEE-VOIDS      PIC S9(6)V99   COMP-3       02440000
024500                                                     VALUE ZEROES.02450000
024600     05  PA-AUTH-NUM-ISSUES           PIC S9(11)     COMP-3       02460000
024700                                                     VALUE ZEROES.02470000
024800     05  PA-AUTH-NUM-ISSUE-VOIDS      PIC S9(11)     COMP-3       02480000
024900                                                     VALUE ZEROES.02490000
025000     05  PA-AUTH-NUM-TENDERS          PIC S9(11)     COMP-3       02500000
025100                                                     VALUE ZEROES.02510000
025200     05  PA-AUTH-NUM-TENDER-VOIDS     PIC S9(11)     COMP-3       02520000
025300                                                     VALUE ZEROES.02530000
025400     05  PA-AUTH-NUM-FEE-VOIDS        PIC S9(11)     COMP-3       02540000
025500                                                     VALUE ZEROES.02550000
025600     05  PA-TRANS-NUM-ISSUES          PIC S9(11)     COMP-3       02560000
025700                                                     VALUE ZEROES.02570000
025800     05  PA-TRANS-NUM-ISSUE-VOIDS     PIC S9(11)     COMP-3       02580000
025900                                                     VALUE ZEROES.02590000
026000     05  PA-TRANS-NUM-TENDER          PIC S9(11)     COMP-3       02600000
026100                                                     VALUE ZEROES.02610000
026200     05  PA-TRANS-NUM-TENDER-VOIDS    PIC S9(11)     COMP-3       02620000
026300                                                     VALUE ZEROES.02630000
026400     05  PA-TRANS-NUM-FEE-VOIDS       PIC S9(11)     COMP-3       02640000
026500                                                     VALUE ZEROES.02650000
026600     05  PA-KMRC-RECS-READ            PIC S9(11)     COMP-3       02660000
026700                                                     VALUE ZEROES.02670000
026800     05  PA-LINE-COUNTER              PIC S9(03)     COMP-3       02680099
026900                                                     VALUE +65.   02690099
027000     05  PA-PAGE-COUNTER              PIC S9(11)     COMP-3       02700000
027100                                                     VALUE ZEROES.02710000
027200     05  PA-GFT-CRD-RECS-READ         PIC S9(11)     COMP-3       02720000
027300                                                     VALUE ZEROES.02730000
027400     05  PA-LINE-COUNTER-GFT-CRD      PIC S9(03)     COMP-3       02740099
027500                                                     VALUE +65.   02750099
027600     05  PA-PAGE-COUNTER-GFT-CRD      PIC S9(11)     COMP-3       02760000
027700                                                     VALUE ZEROES.02770000
027800     05  PA-LINE-COUNTER-KMRC         PIC S9(03)     COMP-3       02780099
027900                                                     VALUE +65.   02790099
028000     05  PA-PAGE-COUNTER-KMRC         PIC S9(11)     COMP-3       02800099
028100                                                     VALUE ZEROES.02810099
028200     05  PA-LINE-COUNTER-GIFT         PIC S9(03)     COMP-3       02820099
028300                                                     VALUE +65.   02830099
028400     05  PA-PAGE-COUNTER-GIFT         PIC S9(11)     COMP-3       02840099
028500                                                     VALUE ZEROES.02850099
028600                                                                  02860000
028700******************************************************************02870000
028800*    STANDARD HEADER FOR 132 COLUMN REPORT                       *02880000
028900******************************************************************02890000
029000     COPY DPWS132O.                                               02900000
029100                                                                  02910000
029200 01  REPORT-TITLE-LINE.                                           02920000
029300     05  FILLER                         PIC  X(44)   VALUE SPACES.02930000
029400     05  FILLER                         PIC  X(47)   VALUE        02940000
029500         'KOHLS MERCHANDISE RETURN CREDIT AUTHORIZER LOG'.        02950000
029600     05  FILLER                         PIC  X(41)   VALUE SPACES.02960000
029700                                                                  02970000
029800 01  REPORT-TITLE-LINE-GFT-CRD.                                   02980000
029900     05  FILLER                         PIC  X(51)   VALUE SPACES.02990000
030000     05  FILLER                         PIC  X(30)   VALUE        03000000
030100         'KOHLS GIFT CARD AUTHORIZER LOG'.                        03010000
030200     05  FILLER                         PIC  X(51)   VALUE SPACES.03020000
030300                                                                  03030000
030400 01  REPORT-SUBTITLE-LINE.                                        03040000
W3540C     05  FILLER                         PIC  X(33)   VALUE SPACES.03051099
030600     05  FILLER                         PIC  X(12)   VALUE        03060000
030700         'SALE DATE:  '.                                          03070000
W3540C     05  RSL-SALE-FROM-DATE-MM          PIC  X(02)   VALUE SPACES.03081099
030900     05  FILLER                         PIC  X(01)   VALUE '/'.   03090000
W3540C     05  RSL-SALE-FROM-DATE-DD          PIC  X(02)   VALUE SPACES.03101099
031100     05  FILLER                         PIC  X(01)   VALUE '/'.   03110000
W3540C     05  RSL-SALE-FROM-DATE-CCYY        PIC  X(04)   VALUE SPACES.03130099
W3540C     05  FILLER                         PIC  X(01)   VALUE '-'.   03131099
W3540C     05  RSL-SALE-FROM-DATE-HH          PIC  X(02)   VALUE '03'.  03132099
W3540C     05  FILLER                         PIC  X(01)   VALUE '.'.   03133099
W3540C     05  RSL-SALE-FROM-DATE-MN          PIC  X(02)   VALUE '00'.  03134099
W3540C     05  FILLER                         PIC  X(01)   VALUE '.'.   03135099
W3540C     05  RSL-SALE-FROM-DATE-SS          PIC  X(02)   VALUE '00'.  03136099
W3540C     05  FILLER                         PIC  X(01)   VALUE '.'.   03136199
W3540C     05  RSL-SALE-FROM-DATE-TTTTTT      PIC  X(06)   VALUE        03137099
W3540C                                                     '000000'.    03137199
W3540C     05  FILLER                         PIC  X(05)   VALUE        03138099
W3540C         ' TO: '.                                                 03139099
W3540C     05  RSL-SALE-TO-DATE-MM            PIC  X(02)   VALUE SPACES.03139199
W3540C     05  FILLER                         PIC  X(01)   VALUE '/'.   03139299
W3540C     05  RSL-SALE-TO-DATE-DD            PIC  X(02)   VALUE SPACES.03139499
W3540C     05  FILLER                         PIC  X(01)   VALUE '/'.   03139599
W3540C     05  RSL-SALE-TO-DATE-CCYY          PIC  X(04)   VALUE SPACES.03139999
W3540C     05  FILLER                         PIC  X(01)   VALUE '-'.   03140099
W3540C     05  RSL-SALE-TO-DATE-HH            PIC  X(02)   VALUE '02'.  03140199
W3540C     05  FILLER                         PIC  X(01)   VALUE '.'.   03140299
W3540C     05  RSL-SALE-TO-DATE-MN            PIC  X(02)   VALUE '59'.  03140399
W3540C     05  FILLER                         PIC  X(01)   VALUE '.'.   03140499
W3540C     05  RSL-SALE-TO-DATE-SS            PIC  X(02)   VALUE '59'.  03140599
W3540C     05  FILLER                         PIC  X(01)   VALUE '.'.   03140699
W3540C     05  RSL-SALE-TO-DATE-TTTTTT        PIC  X(06)   VALUE        03140799
W3540C                                                     '999999'.    03140899
W3540C     05  FILLER                         PIC  X(32)   VALUE SPACES.03142099
031500                                                                  03150000
031600******************************************************************03160000
031700*    HEADERS                                                     *03170000
031800******************************************************************03180000
031900 01  REPORT-DETAIL-HEADER.                                        03190000
032000     05  FILLER                         PIC  X(11)   VALUE SPACES.03200000
032100     05  FILLER                         PIC  X(07)   VALUE        03210000
032200         'CARD ID'.                                               03220000
032300     05  FILLER                         PIC  X(09)   VALUE SPACES.03230000
032400     05  FILLER                         PIC  X(10)   VALUE        03240000
032500         'ISSUE DATE'.                                            03250000
032600     05  FILLER                         PIC  X(07)   VALUE SPACES.03260000
032700     05  FILLER                         PIC  X(09)   VALUE        03270000
032800         'AUTH TIME'.                                             03280000
032900     05  FILLER                         PIC  X(07)   VALUE SPACES.03290000
033000     05  FILLER                         PIC  X(05)   VALUE        03300000
033100         'STORE'.                                                 03310000
033200     05  FILLER                         PIC  X(04)   VALUE SPACES.03320000
033300     05  FILLER                         PIC  X(08)   VALUE        03330000
033400         'TERMINAL'.                                              03340000
033500     05  FILLER                         PIC  X(05)   VALUE SPACES.03350000
033600     05  FILLER                         PIC  X(11)   VALUE        03360000
033700         'TRANSACTION'.                                           03370000
033800     05  FILLER                         PIC  X(05)   VALUE SPACES.03380000
033900     05  FILLER                         PIC  X(06)   VALUE        03390000
034000         'AMOUNT'.                                                03400000
034100     05  FILLER                         PIC  X(06)   VALUE SPACES.03410000
034200     05  FILLER                         PIC  X(13)   VALUE        03420000
034300         'ACTIVITY TYPE'.                                         03430000
034400     05  FILLER                         PIC  X(04)   VALUE SPACES.03440000
034500     05  FILLER                         PIC  X(04)   VALUE        03450000
034600         'VOID'.                                                  03460000
034700     05  FILLER                         PIC  X(02)   VALUE SPACES.03470000
034800                                                                  03480000
034900 01  REPORT-AUTH-HEADER-LINE.                                     03490000
035000     05  FILLER                         PIC  X(03)   VALUE SPACES.03500000
035100     05  RAHL-AUTHORIZER-NUMBER         PIC  X(08)   VALUE SPACES.03510099
035200     05  FILLER                         PIC  X(122)  VALUE SPACES.03520000
035300                                                                  03530000
035400 01  REPORT-DETAIL-HEADER2.                                       03540099
035500     05  FILLER                         PIC  X(08)   VALUE        03550099
035600         'USER ID '.                                              03560099
035700     05  FILLER                         PIC  X(03)   VALUE SPACES.03570099
035800     05  FILLER                         PIC  X(07)   VALUE        03580099
035900         'CARD ID'.                                               03590099
036000     05  FILLER                         PIC  X(09)   VALUE SPACES.03600099
036100     05  FILLER                         PIC  X(10)   VALUE        03610099
036200         'ISSUE DATE'.                                            03620099
036300     05  FILLER                         PIC  X(07)   VALUE SPACES.03630099
036400     05  FILLER                         PIC  X(09)   VALUE        03640099
036500         'AUTH TIME'.                                             03650099
036600     05  FILLER                         PIC  X(07)   VALUE SPACES.03660099
036700     05  FILLER                         PIC  X(05)   VALUE        03670099
036800         'STORE'.                                                 03680099
036900     05  FILLER                         PIC  X(04)   VALUE SPACES.03690099
037000     05  FILLER                         PIC  X(08)   VALUE        03700099
037100         'TERMINAL'.                                              03710099
037200     05  FILLER                         PIC  X(05)   VALUE SPACES.03720099
037300     05  FILLER                         PIC  X(11)   VALUE        03730099
037400         'TRANSACTION'.                                           03740099
037500     05  FILLER                         PIC  X(05)   VALUE SPACES.03750099
037600     05  FILLER                         PIC  X(06)   VALUE        03760099
037700         'AMOUNT'.                                                03770099
037800     05  FILLER                         PIC  X(06)   VALUE SPACES.03780099
037900     05  FILLER                         PIC  X(13)   VALUE        03790099
038000         'ACTIVITY TYPE'.                                         03800099
038100     05  FILLER                         PIC  X(04)   VALUE SPACES.03810099
038200     05  FILLER                         PIC  X(04)   VALUE        03820099
038300         'VOID'.                                                  03830099
038400     05  FILLER                         PIC  X(02)   VALUE SPACES.03840099
038500                                                                  03850099
038600******************************************************************03860000
038700*    AUTHORIZED TRANSACTION DETAIL LINE                          *03870000
038800******************************************************************03880000
038900 01  REPORT-DETAIL-LINE.                                          03890000
039000     05  FILLER                         PIC  X(09)   VALUE SPACES.03900000
039100     05  RDL-CRD-NBR                    PIC  ZZ9(10) VALUE ZEROS. 03910099
039200     05  FILLER                         PIC  X(06)   VALUE SPACES.03920099
039300     05  RDL-AUTH-DATE.                                           03930000
039400         10  RDL-AUTH-DATE-MM           PIC  X(2)    VALUE SPACES.03940000
039500         10  RDL-AUTH-SLASH1            PIC  X       VALUE '/'.   03950000
039600         10  RDL-AUTH-DATE-DD           PIC  X(2)    VALUE SPACES.03960000
039700         10  RDL-AUTH-SLASH2            PIC  X       VALUE '/'.   03970000
039800         10  RDL-AUTH-DATE-CC           PIC  X(2)    VALUE SPACES.03980000
039900         10  RDL-AUTH-DATE-YY           PIC  X(2)    VALUE SPACES.03990000
040000     05  FILLER                         PIC  X(08)   VALUE SPACES.04000099
040100     05  RDL-AUTH-TIME                  PIC  X(08)   VALUE SPACES.04010000
040200     05  FILLER                         PIC  X(08)   VALUE SPACES.04020000
040300     05  RDL-STR-NBR                    PIC  X(04)   VALUE SPACES.04030000
040400     05  FILLER                         PIC  X(06)   VALUE SPACES.04040000
040500     05  RDL-POS-TRMNL-NBR              PIC  X(04)   VALUE SPACES.04050000
040600     05  FILLER                         PIC  X(11)   VALUE SPACES.04060000
040700     05  RDL-POS-TRN-NBR                PIC  X(04)   VALUE SPACES.04070000
040800     05  FILLER                         PIC  X(04)   VALUE SPACES.04080000
040900     05  RDL-APP-AUTH-AMT               PIC  ZZZ,ZZZ.99-          04090000
041000                                                     VALUE ZEROS. 04100000
041100     05  FILLER                         PIC  X(07)   VALUE SPACES.04110000
041200     05  RDL-ACTVY-TYP-DESC             PIC  X(07)   VALUE SPACES.04120000
041300     05  FILLER                         PIC  X(08)   VALUE SPACES.04130000
041400     05  RDL-VOID-IND                   PIC  X(04)   VALUE SPACES.04140000
041500     05  FILLER                         PIC  X(02)   VALUE SPACES.04150000
041600                                                                  04160000
041700 01  REPORT-DETAIL-LINE2.                                         04170099
041800     05  RDL2-USER-ID                   PIC  X(08)   VALUE SPACES.04180099
041900     05  FILLER                         PIC  X       VALUE SPACES.04190099
042000     05  RDL2-CRD-NBR                   PIC  ZZ9(10) VALUE ZEROS. 04200099
042100     05  FILLER                         PIC  X(06)   VALUE SPACES.04210099
042200     05  RDL2-AUTH-DATE.                                          04220099
042300         10  RDL2-AUTH-DATE-MM          PIC  X(2)    VALUE SPACES.04230099
042400         10  RDL2-AUTH-SLASH1           PIC  X       VALUE '/'.   04240099
042500         10  RDL2-AUTH-DATE-DD          PIC  X(2)    VALUE SPACES.04250099
042600         10  RDL2-AUTH-SLASH2           PIC  X       VALUE '/'.   04260099
042700         10  RDL2-AUTH-DATE-CC          PIC  X(2)    VALUE SPACES.04270099
042800         10  RDL2-AUTH-DATE-YY          PIC  X(2)    VALUE SPACES.04280099
042900     05  FILLER                         PIC  X(08)   VALUE SPACES.04290099
043000     05  RDL2-AUTH-TIME                 PIC  X(08)   VALUE SPACES.04300099
043100     05  FILLER                         PIC  X(08)   VALUE SPACES.04310099
043200     05  RDL2-STR-NBR                   PIC  X(04)   VALUE SPACES.04320099
043300     05  FILLER                         PIC  X(06)   VALUE SPACES.04330099
043400     05  RDL2-POS-TRMNL-NBR             PIC  X(04)   VALUE SPACES.04340099
043500     05  FILLER                         PIC  X(11)   VALUE SPACES.04350099
043600     05  RDL2-POS-TRN-NBR               PIC  X(04)   VALUE SPACES.04360099
043700     05  FILLER                         PIC  X(04)   VALUE SPACES.04370099
043800     05  RDL2-APP-AUTH-AMT              PIC  ZZZ,ZZZ.99-          04380099
043900                                                     VALUE ZEROS. 04390099
044000     05  FILLER                         PIC  X(07)   VALUE SPACES.04400099
044100     05  RDL2-ACTVY-TYP-DESC            PIC  X(07)   VALUE SPACES.04410099
044200     05  FILLER                         PIC  X(08)   VALUE SPACES.04420099
044300     05  RDL2-VOID-IND                  PIC  X(04)   VALUE SPACES.04430099
044400     05  FILLER                         PIC  X(02)   VALUE SPACES.04440099
044500                                                                  04450099
044600******************************************************************04460099
044700*    TOTAL LINES                                                 *04470000
044800******************************************************************04480000
044900 01  REPORT-TOTAL-TRANS-LINE.                                     04490000
045000     05  FILLER                         PIC  X(14)   VALUE SPACES.04500099
045100     05  FILLER                         PIC  X(08)   VALUE        04510000
045200         'ISSUES: '.                                              04520000
045300     05  RTTL-NUM-ISSUES                PIC  ZZZ,ZZ9.             04530099
045400     05  FILLER                         PIC  X(02)   VALUE SPACES.04540000
045500     05  FILLER                         PIC  X(13)   VALUE        04550000
045600         'ISSUE VOIDS: '.                                         04560000
045700     05  RTTL-NUM-ISSUE-VOIDS           PIC  ZZZ,ZZ9.             04570099
045800     05  FILLER                         PIC  X(02)   VALUE SPACES.04580000
045900     05  FILLER                         PIC  X(09)   VALUE        04590000
046000         'TENDERS: '.                                             04600000
046100     05  RTTL-NUM-TENDERS               PIC  ZZZ,ZZ9.             04610099
046200     05  FILLER                         PIC  X(02)   VALUE SPACES.04620000
046300     05  FILLER                         PIC  X(14)   VALUE        04630000
046400         'TENDER VOIDS: '.                                        04640000
046500     05  RTTL-NUM-TENDER-VOIDS          PIC  ZZZ,ZZ9.             04650099
046600     05  FILLER                         PIC  X(02)   VALUE SPACES.04660000
046700     05  FILLER                         PIC  X(11)   VALUE        04670000
046800         'FEE VOIDS: '.                                           04680000
046900     05  RTTL-NUM-FEE-VOIDS             PIC  ZZZ,ZZ9.             04690099
047000     05  FILLER                         PIC  X(15)   VALUE SPACES.04700099
047100                                                                  04710000
047200 01  REPORT-TOTAL-AUTHORIZERS-LINE.                               04720000
047300     05  FILLER                         PIC  X(03)   VALUE SPACES.04730000
047400     05  FILLER                         PIC  X(19)   VALUE        04740000
047500         'TOTAL AUTHORIZERS: '.                                   04750000
047600     05  FILLER                         PIC  X(02)   VALUE SPACES.04760000
047700     05  RTAL-TOTAL-AUTHORIZERS         PIC  ZZ9.                 04770000
047800     05  FILLER                         PIC  X(99)   VALUE SPACES.04780000
047900                                                                  04790000
048000 01  REPORT-TOTAL-ISSUES-LINE.                                    04800000
048100     05  FILLER                         PIC  X(10)   VALUE SPACES.04810000
048200     05  FILLER                         PIC  X(14)   VALUE        04820000
048300         'ISSUES:       '.                                        04830000
048400     05  FILLER                         PIC  X(01)   VALUE SPACES.04840000
048500     05  RTIL-AUTH-NUM-ISSUES           PIC  ZZZ,Z99              04850099
048600                                                     VALUE ZEROS. 04860000
048700     05  FILLER                         PIC  X(02)   VALUE SPACES.04870000
048800     05  RTIL-AUTH-TOTAL-ISSUES         PIC  $ZZZ,ZZZ.99-         04880000
048900                                                     VALUE ZEROS. 04890000
049000     05  FILLER                         PIC  X(90)   VALUE SPACES.04900000
049100                                                                  04910000
049200 01  REPORT-TOTAL-ISSUE-VOIDS-LINE.                               04920000
049300     05  FILLER                         PIC  X(10)   VALUE SPACES.04930000
049400     05  FILLER                         PIC  X(14)   VALUE        04940000
049500         'ISSUE VOIDS:  '.                                        04950000
049600     05  FILLER                         PIC  X(01)   VALUE SPACES.04960000
049700     05  RTIVL-AUTH-NUM-ISSUE-VOIDS     PIC  ZZZ,Z99              04970099
049800                                                     VALUE ZEROS. 04980000
049900     05  FILLER                         PIC  X(02)   VALUE SPACES.04990000
050000     05  RTIVL-AUTH-TOTAL-ISSUE-VOIDS   PIC  $ZZZ,ZZZ.99-         05000000
050100                                                     VALUE ZEROS. 05010000
050200     05  FILLER                         PIC  X(90)   VALUE SPACES.05020000
050300                                                                  05030000
050400 01  REPORT-TOTAL-TENDERS-LINE.                                   05040000
050500     05  FILLER                         PIC  X(10)   VALUE SPACES.05050000
050600     05  FILLER                         PIC  X(14)   VALUE        05060000
050700         'TENDERS:      '.                                        05070000
050800     05  FILLER                         PIC  X(01)   VALUE SPACES.05080000
050900     05  RTTL-AUTH-NUM-TENDERS          PIC  ZZZ,Z99              05090099
051000                                                     VALUE ZEROS. 05100000
051100     05  FILLER                         PIC  X(02)   VALUE SPACES.05110000
051200     05  RTTL-AUTH-TOTAL-TENDERS        PIC  $ZZZ,ZZZ.99-         05120000
051300                                                     VALUE ZEROS. 05130000
051400     05  FILLER                         PIC  X(90)   VALUE SPACES.05140000
051500                                                                  05150000
051600 01  REPORT-TOTAL-TENDER-VOIDS-LINE.                              05160000
051700     05  FILLER                         PIC  X(10)   VALUE SPACES.05170000
051800     05  FILLER                         PIC  X(14)   VALUE        05180000
051900         'TENDER VOIDS: '.                                        05190000
052000     05  FILLER                         PIC  X(01)   VALUE SPACES.05200000
052100     05  RTTVL-AUTH-NUM-TENDER-VOIDS    PIC  ZZZ,Z99              05210099
052200                                                     VALUE ZEROS. 05220000
052300     05  FILLER                         PIC  X(02)   VALUE SPACES.05230000
052400     05  RTTVL-AUTH-TOTAL-TENDER-VOIDS  PIC  $ZZZ,ZZZ.99-         05240000
052500                                                     VALUE ZEROS. 05250000
052600     05  FILLER                         PIC  X(90)   VALUE SPACES.05260000
052700                                                                  05270000
052800 01  REPORT-TOTAL-FEE-VOIDS-LINE.                                 05280000
052900     05  FILLER                         PIC  X(10)   VALUE SPACES.05290000
053000     05  FILLER                         PIC  X(14)   VALUE        05300000
053100         'FEE VOIDS:    '.                                        05310000
053200     05  FILLER                         PIC  X(01)   VALUE SPACES.05320000
053300     05  RTTVL-AUTH-NUM-FEE-VOIDS       PIC  ZZZ,Z99              05330099
053400                                                     VALUE ZEROS. 05340000
053500     05  FILLER                         PIC  X(02)   VALUE SPACES.05350000
053600     05  RTTVL-AUTH-TOTAL-FEE-VOIDS     PIC  $ZZZ,ZZZ.99-         05360000
053700                                                     VALUE ZEROS. 05370000
053800     05  FILLER                         PIC  X(90)   VALUE SPACES.05380000
053900                                                                  05390000
054000 01  REPORT-TOTAL-TOTAL-AUTHS-LINE.                               05400000
054100     05  FILLER                         PIC  X(10)   VALUE SPACES.05410000
054200     05  FILLER                         PIC  X(14)   VALUE        05420000
054300         'GRAND TOTAL: '.                                         05430000
054400     05  FILLER                         PIC  X(01)   VALUE SPACES.05440000
054500     05  RTTAL-GRAND-NUM-TOTAL          PIC  ZZZ,Z99              05450099
054600                                                     VALUE ZEROS. 05460000
054700     05  FILLER                         PIC  X(02)   VALUE SPACES.05470000
054800     05  FILLER                         PIC  X(102)  VALUE SPACES.05480000
054900                                                                  05490000
055000 01  REPORT-TOTAL-DASH-LINE.                                      05500000
055100     05  FILLER                         PIC  X(10)   VALUE SPACES.05510000
055200     05  FILLER                         PIC  X(14)   VALUE SPACES.05520000
055300     05  FILLER                         PIC  X(01)   VALUE SPACES.05530000
055400     05  FILLER                         PIC  X(07)   VALUE        05540099
055500         '-------'.                                               05550099
055600     05  FILLER                         PIC  X(102)  VALUE SPACES.05560000
055700                                                                  05570000
055800******************************************************************05580000
055900*    KMRC CONSTANTS                                              *05590000
056000******************************************************************05600000
056100     COPY SVWS004.                                                05610099
056200                                                                  05620000
056300******************************************************************05630000
056400*    DATE ROUTINE COPY MEMBERS                                   *05640000
056500******************************************************************05650000
056600     COPY DPWS500.                                                05660000
056700                                                                  05670000
056800******************************************************************05680000
056900*    VARIABLES REQUIRED FOR THE FORMAT SQLCA ROUTINE DPPD004     *05690000
057000******************************************************************05700000
057100     COPY DPWS004.                                                05710000
057200                                                                  05720000
057300******************************************************************05730099
057400*    DB2 AREA FOR SVT_KOHLS_CRD_TXN                              *05740099
057500*    SV-KOHL'S MERCHANDISE CARD ACTIVITY TABLE                   *05750099
057600******************************************************************05760099
057700     EXEC SQL                                                     05770099
057800         INCLUDE SVT00002                                         05780099
057900     END-EXEC.                                                    05790099
058000******************************************************************05800099
058100*    DB2 AREA FOR SVT_KOHLS_CRD_ACCT                             *05810099
058200*    SV-KOHL'S MERCHANDISE CARD TABLE                            *05820099
058300******************************************************************05830099
058400     EXEC SQL                                                     05840099
058500         INCLUDE SVT00001                                         05850099
058600     END-EXEC.                                                    05860099
058700******************************************************************05870000
058800*    CURSOR TO ACCESS ISSUED KMRC CARDS                          *05880000
058900******************************************************************05890000
059000     EXEC SQL                                                     05900000
059100       DECLARE KMRC-CSR CURSOR FOR                                05910000
059200           SELECT APVL_USR_ID,                                    05920000
059300                  A.CRD_NBR,                                      05930000
059400                  TRN_AUTH_TMST,                                  05940000
059500                  A.STR_NBR,                                      05950000
059600                  POS_TRMNL_NBR,                                  05960000
059700                  POS_TRN_NBR,                                    05970000
059800                  APP_AUTH_AMT,                                   05980000
059900                  ACTVY_TYP_CDE,                                  05990000
060000                  TRN_VOID_IND,                                   06000000
060100                  TRN_RVRSL_CDE,                                  06010000
060200                  CRD_TYP_CDE                                     06020000
060300             FROM SVT_KOHLS_CRD_TXN A,                            06030099
060400                  SVT_KOHLS_CRD_ACCT T                            06040099
060500            WHERE                                                 06050000
060600              A.CRD_NBR = T.CRD_NBR                      AND      06060099
060700              TRN_AUTH_TMST BETWEEN :PV-TODAYS-TIMESTAMP          06070099
060800                 AND :PV-TOMORROWS-TIMESTAMP             AND      06080099
060900               APVL_USR_ID > '        '                           06090099
061000                AND APVL_USR_ID NOT IN (:SV004-APVL-USR-ID-SYSTEM 06100099
061100                                   ,:SV004-APVL-USR-ID-SVKUP001)  06110099
061200            ORDER BY CRD_TYP_CDE, APVL_USR_ID, TRN_AUTH_TMST      06120000
061300             WITH UR                                              06130099
061400     END-EXEC.                                                    06140000
061500                                                                  06150000
061600     EXEC SQL                                                     06160000
061700       DECLARE KMRC-ISS-DT-CSR CURSOR FOR                         06170000
061800            SELECT  TRN_AUTH_TMST                                 06180000
061900              FROM  SVT_KOHLS_CRD_TXN                             06190099
062000             WHERE  CRD_NBR = :PV-CRD-NBR                         06200099
062100               AND  ACTVY_TYP_CDE IN (:SV004-ISSUE-KMRC-ACT-TYP-N 06210099
062200                                ,:SV004-ISSUE-GIFT-CRD-ACT-TYP-N) 06220099
062300               AND  TRN_RVRSL_CDE = :SV004-REV-CDE-NORMAL         06230099
062400            ORDER BY TRN_AUTH_TMST                                06240000
062500             WITH UR                                              06250099
062600     END-EXEC.                                                    06260000
062700                                                                  06270000
062800******************************************************************06280000
062900*    STANDARD LAYOUT FOR THE SQL COMMUNCATIONS AREA              *06290000
063000******************************************************************06300000
063100     EXEC SQL                                                     06310000
063200         INCLUDE SQLCA                                            06320000
063300     END-EXEC.                                                    06330000
063400                                                                  06340000
063500     COPY SQLCA2.                                                 06350000
063600                                                                  06360000
063700 PROCEDURE DIVISION.                                              06370000
063800                                                                  06380000
063900 A100-MAINLINE.                                                   06390000
064000                                                                  06400000
064100     PERFORM B100-INITIALIZE.                                     06410000
064200                                                                  06420000
064300     PERFORM B200-PROCESS-AUTHS                                   06430000
064400         UNTIL PS-END-OF-KMRC-CSR.                                06440000
064500                                                                  06450000
064600     PERFORM B900-EOJ-ROUTINE.                                    06460000
064700                                                                  06470000
064800     GOBACK.                                                      06480000
064900                                                                  06490000
065000******************************************************************06500000
065100*     B100-INITIALIZE                                            *06510000
065200* ==> PROCESSES:                                                 *06520000
065300*     - READS CONTROL DATE FROM CONTROL RECORD                   *06530000
065400*     - ACCEPTS THE CURRENT DATE AND TIME FOR THE REPORT HEADING *06540000
065500*     - OPENS KMRC-CSR (CURSOR).                                 *06550000
065600*     - READS FIRST KMRC OR GIFT CARD CONTROL NUMBER. IF ONE IS  *06560000
065700*       NOT FOUND, ISSUE MESSAGE.                                *06570000
065800* ==> PERFORMED FROM:  A100-MAINLINE                             *06580000
065900******************************************************************06590000
066000 B100-INITIALIZE.                                                 06600000
066100                                                                  06610000
066200     OPEN INPUT CONTROL-DATE-FILE.                                06620000
066300     OPEN OUTPUT REPORT-FILE                                      06630099
066400                 REPORT-FILE-GFT-CRD                              06640099
066500                 REPORT-FILE-KMRC                                 06650099
066600                 REPORT-FILE-GIFT.                                06660099
066700                                                                  06670000
066800     READ CONTROL-DATE-FILE INTO CR-CONTROL-RECORD                06680000
066900         AT END                                                   06690000
067000             SET PS-END-OF-CONTROL-FILE TO TRUE.                  06700000
067100                                                                  06710000
067200     IF PS-END-OF-CONTROL-FILE                                    06720000
067300         DISPLAY ' '                                              06730000
067400         DISPLAY '** ABEND     **'                                06740000
067500         DISPLAY '** PROGRAM   **  = ' PC-PROGRAM-NAME            06750000
067600         DISPLAY '** PARAGRAPH **  = B100-INITIALIZE      '       06760000
067700         DISPLAY '** CONTROL DATE FILE IS EMPTY  '                06770000
067800         DISPLAY ' '                                              06780000
067900         MOVE +4002 TO ABEND-CODE                                 06790000
068000         CALL 'ILBOABN0' USING ABEND-CODE                         06800000
068100     ELSE                                                         06810000
068200         DISPLAY PC-PROGRAM-NAME ' CONTROL DATE:  '               06820000
W3540C                 CR-CONTROL-RECORD                                06831099
068400     END-IF.                                                      06840000
068500                                                                  06850000
068600     INITIALIZE DPG51 DPG52 DPG53                                 06860000
068700                DPG54 DPG55 DPG56.                                06870000
068800     SET DPG51-ACTUAL-CALENDAR-ONLY                               06880000
068900                                 TO TRUE.                         06890000
069000     SET DPG51-DO-NOT-INCR-DECR-DATE                              06900000
069100                                 TO TRUE.                         06910000
069200     MOVE ZEROES TO DPG51-INCR-DECR-DAYS-9                        06920000
069300                    DPG51-INCR-DECR-BUS-DAYS-9.                   06930000
W3540C     MOVE CR-CONTROL-CURR-DATE      TO DPG52-LK-DATE-INPUT.       06941099
W3540C     SET DPG52-LK-DTE-ISO           TO TRUE.                      06951099
069600     CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51 DPG52 DPG53    06960000
069700                                       DPG54 DPG55 DPG56.         06970000
069800                                                                  06980000
069900     EVALUATE TRUE                                                06990000
070000         WHEN DPG54-SEVERE-ERROR                                  07000000
070100         WHEN DPG54-DATE-INVALID                                  07010000
070200             DISPLAY ' '                                          07020000
070300             DISPLAY '** ABEND     **'                            07030000
070400             DISPLAY '** PROGRAM   **  = ' PC-PROGRAM-NAME        07040000
070500             DISPLAY '** PARAGRAPH **  = B100-INITIALIZE'         07050000
070600             DISPLAY '** BAD CALL TO CALENDAR MODULE '            07060000
070700                     PC-CALENDAR-PGM                              07070000
070800             DISPLAY '** DETERMINE VALID DATE **'                 07080000
070900             DISPLAY DPG54-ERROR-MESSAGE                          07090000
071000             DISPLAY ' '                                          07100000
071100             MOVE +4019             TO ABEND-CODE                 07110000
071200             CALL 'ILBOABN0' USING ABEND-CODE                     07120000
071300     END-EVALUATE.                                                07130000
071400                                                                  07140000
W3540C     INITIALIZE DPG51 DPG52 DPG53                                 07141099
W3540C                DPG54 DPG55 DPG56.                                07142099
W3540C     SET DPG51-ACTUAL-CALENDAR-ONLY                               07143099
W3540C                                 TO TRUE.                         07144099
W3540C     SET DPG51-DO-NOT-INCR-DECR-DATE                              07145099
W3540C                                 TO TRUE.                         07146099
W3540C     MOVE ZEROES TO DPG51-INCR-DECR-DAYS-9                        07147099
W3540C                    DPG51-INCR-DECR-BUS-DAYS-9.                   07148099
W3540C     MOVE CR-CONTROL-PREV-DATE      TO DPG52-LK-DATE-INPUT.       07149199
W3540C     SET DPG52-LK-DTE-ISO           TO TRUE.                      07149399
W3540C     CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51 DPG52 DPG53    07149499
W3540C                                       DPG54 DPG55 DPG56.         07149599
W3540C                                                                  07149699
W3540C     EVALUATE TRUE                                                07149799
W3540C         WHEN DPG54-SEVERE-ERROR                                  07149899
W3540C         WHEN DPG54-DATE-INVALID                                  07149999
W3540C             DISPLAY ' '                                          07150099
W3540C             DISPLAY '** ABEND     **'                            07150199
W3540C             DISPLAY '** PROGRAM   **  = ' PC-PROGRAM-NAME        07150299
W3540C             DISPLAY '** PARAGRAPH **  = B100-INITIALIZE'         07150399
W3540C             DISPLAY '** BAD CALL TO CALENDAR MODULE '            07150499
W3540C                     PC-CALENDAR-PGM                              07150599
W3540C             DISPLAY '** DETERMINE VALID DATE **'                 07150699
W3540C             DISPLAY DPG54-ERROR-MESSAGE                          07150799
W3540C             DISPLAY ' '                                          07150899
W3540C             MOVE +4019             TO ABEND-CODE                 07150999
W3540C             CALL 'ILBOABN0' USING ABEND-CODE                     07151099
W3540C     END-EVALUATE.                                                07151199
072600                                                                  07260000
072700******************************************************************07270000
W3540C** INCREMENT CURRENT-PROCESS-DATE BY 1 GIVING                   **07281099
W3540C** TOMORROWS-TIMESTAMP.                                         **07282099
072900******************************************************************07290000
073000                                                                  07300000
073100     INITIALIZE DPG51 DPG52 DPG53                                 07310000
073200                DPG54 DPG55 DPG56.                                07320000
073300     SET DPG51-ACTUAL-CALENDAR-ONLY TO TRUE.                      07330000
073400     SET DPG51-INCREMENT-DATE       TO TRUE.                      07340000
073500     MOVE PC-DAYS-TO-INCREMENT      TO DPG51-INCR-DECR-DAYS-9.    07350000
073600     MOVE ZEROES                    TO DPG51-INCR-DECR-BUS-DAYS-9.07360000
073700                                                                  07370000
W3540C     MOVE CR-CONTROL-CURR-DATE      TO DPG52-LK-DATE-INPUT.       07381099
W3540C     SET DPG52-LK-DTE-ISO           TO TRUE.                      07391099
074000                                                                  07400000
074100     CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51 DPG52 DPG53    07410000
074200                                       DPG54 DPG55 DPG56.         07420000
074300                                                                  07430000
074400     EVALUATE TRUE                                                07440000
074500         WHEN DPG54-SEVERE-ERROR                                  07450000
074600         WHEN DPG54-DATE-INVALID                                  07460000
074700             DISPLAY ' '                                          07470000
074800             DISPLAY '** ABEND     **'                            07480000
074900             DISPLAY '** PROGRAM   **  = ' PC-PROGRAM-NAME        07490000
075000             DISPLAY '** PARAGRAPH **  = C100-DATE-ROUTI'         07500000
075100             DISPLAY '** BAD CALL TO CALENDAR MODULE '            07510000
075200                     PC-CALENDAR-PGM                              07520000
075300             DISPLAY '** ADDING ONE DAY TO POS DATE    '          07530000
075400             DISPLAY DPG54-ERROR-MESSAGE                          07540000
075500             DISPLAY ' '                                          07550000
075600             MOVE +4019 TO ABEND-CODE                             07560000
075700             CALL 'ILBOABN0' USING ABEND-CODE                     07570099
075800     END-EVALUATE.                                                07580000
075900                                                                  07590000
076000     MOVE DPG55-DB2-ISO-DATE-FMT TO PV-DATE-RETURNED-FROM-ROUTINE.07600000
076100     DISPLAY PC-PROGRAM-NAME ' NEXT POS DATE:  '                  07610000
076200                                    PV-DATE-RETURNED-FROM-ROUTINE.07620000
076300                                                                  07630000
W3540C     MOVE PV-DATE-RETURNED-CCYY  TO PV-TOMORROWS-YYYY             07640099
W3540C                                    RSL-SALE-TO-DATE-CCYY.        07641099
W3540C     MOVE PV-DATE-RETURNED-MM    TO PV-TOMORROWS-MM               07650099
W3540C                                    RSL-SALE-TO-DATE-MM.          07651099
W3540C     MOVE PV-DATE-RETURNED-DD    TO PV-TOMORROWS-DD               07660099
W3540C                                    RSL-SALE-TO-DATE-DD.          07671199
W3540C                                                                  07671299
W3540C******************************************************************07671399
W3540C** INCREMENT PREVIOUS-PROCESS-DATE BY 1 GIVING                  **07671499
W3540C** TODAYS-TIMESTAMP.                                            **07671599
W3540C******************************************************************07671699
W3540C                                                                  07671799
W3540C     INITIALIZE DPG51 DPG52 DPG53                                 07671899
W3540C                DPG54 DPG55 DPG56                                 07671999
W3540C                PV-DATE-RETURNED-FROM-ROUTINE.                    07672099
W3540C     SET DPG51-ACTUAL-CALENDAR-ONLY TO TRUE.                      07672199
W3540C     SET DPG51-INCREMENT-DATE       TO TRUE.                      07672299
W3540C     MOVE PC-DAYS-TO-INCREMENT      TO DPG51-INCR-DECR-DAYS-9.    07672399
W3540C     MOVE ZEROES                    TO DPG51-INCR-DECR-BUS-DAYS-9.07672499
W3540C                                                                  07672599
W3540C     MOVE CR-CONTROL-PREV-DATE      TO DPG52-LK-DATE-INPUT.       07672699
W3540C     SET DPG52-LK-DTE-ISO           TO TRUE.                      07672899
W3540C                                                                  07672999
W3540C     CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51 DPG52 DPG53    07673099
W3540C                                       DPG54 DPG55 DPG56.         07673199
W3540C                                                                  07673299
W3540C     EVALUATE TRUE                                                07673399
W3540C         WHEN DPG54-SEVERE-ERROR                                  07673499
W3540C         WHEN DPG54-DATE-INVALID                                  07673599
W3540C             DISPLAY ' '                                          07673699
W3540C             DISPLAY '** ABEND     **'                            07673799
W3540C             DISPLAY '** PROGRAM   **  = ' PC-PROGRAM-NAME        07673899
W3540C             DISPLAY '** PARAGRAPH **  = C100-DATE-ROUTI'         07673999
W3540C             DISPLAY '** BAD CALL TO CALENDAR MODULE '            07674099
W3540C                     PC-CALENDAR-PGM                              07674199
W3540C             DISPLAY '** ADDING ONE DAY TO POS DATE    '          07674299
W3540C             DISPLAY DPG54-ERROR-MESSAGE                          07674399
W3540C             DISPLAY ' '                                          07674499
W3540C             MOVE +4019 TO ABEND-CODE                             07674599
W3540C             CALL 'ILBOABN0' USING ABEND-CODE                     07674699
W3540C     END-EVALUATE.                                                07674799
W3540C                                                                  07674899
W3540C     MOVE DPG55-DB2-ISO-DATE-FMT TO PV-DATE-RETURNED-FROM-ROUTINE.07674999
W3540C     DISPLAY PC-PROGRAM-NAME ' NEXT POS DATE:  '                  07675099
W3540C                                    PV-DATE-RETURNED-FROM-ROUTINE.07675199
W3540C                                                                  07675299
W3540C     MOVE PV-DATE-RETURNED-CCYY  TO PV-TODAYS-YYYY                07675399
W3540C                                    RSL-SALE-FROM-DATE-CCYY.      07675499
W3540C     MOVE PV-DATE-RETURNED-MM    TO PV-TODAYS-MM                  07675599
W3540C                                    RSL-SALE-FROM-DATE-MM.        07675699
W3540C     MOVE PV-DATE-RETURNED-DD    TO PV-TODAYS-DD                  07675799
W3540C                                    RSL-SALE-FROM-DATE-DD.        07675899
W3540C                                                                  07675999
076800     ACCEPT PV-CURRENT-DATE      FROM DATE.                       07680000
076900     MOVE PV-CURRENT-YEAR          TO DP132O-RUN-YEAR.            07690000
077000     MOVE PV-CURRENT-MONTH         TO DP132O-RUN-MONTH.           07700000
077100     MOVE PV-CURRENT-DAY           TO DP132O-RUN-DAY.             07710000
077200                                                                  07720000
077300     ACCEPT PV-CURRENT-TIME      FROM TIME.                       07730000
077400     MOVE PV-CURRENT-HOUR          TO DP132O-RUN-HOUR.            07740000
077500     MOVE PV-CURRENT-MINUTE        TO DP132O-RUN-MINUTE.          07750000
077600                                                                  07760000
077700     MOVE PC-PROGRAM-NAME          TO DP132O-PROGRAM-NAME.        07770000
077800                                                                  07780000
077900     EXEC SQL                                                     07790000
078000         OPEN KMRC-CSR                                            07800000
078100     END-EXEC.                                                    07810000
078200     EVALUATE TRUE                                                07820000
078300         WHEN SQLCODE NOT = 0                                     07830000
078400         WHEN SQLWARN0    = 'W'                                   07840000
078500             DISPLAY ' '                                          07850000
078600             DISPLAY '** ABEND     **'                            07860000
078700             DISPLAY '** PROGRAM   **  = ' PC-PROGRAM-NAME        07870000
078800             DISPLAY '** PARAGRAPH **  = B200-PROCESS-KMRC'       07880000
078900             DISPLAY '** OPEN CURSOR TO SVT_KOHLS_CRD_TXN TABLE'  07890099
079000             PERFORM Z900-SQL-ABEND                               07900000
079100     END-EVALUATE.                                                07910000
079200                                                                  07920000
079300     PERFORM D100-FETCH-KMRC-CURSOR.                              07930000
079400     IF PS-END-OF-KMRC-CSR                                        07940000
079500         DISPLAY ' '                                              07950000
079600         DISPLAY '** PROGRAM   **  = ' PC-PROGRAM-NAME            07960000
079700         DISPLAY '** FIRST FETCH FOUND NO KMRC OR GIFT CARD'      07970000
079800         DISPLAY ' '                                              07980000
079900     ELSE                                                         07990000
080000         MOVE SVT00001-CRD-TYP-CDE TO PV-HOLD-PREV-CARD-TYPE-CDE  08000099
080100                                    PS-CARD-TYPE-CODE-SW          08010000
080200         MOVE SVT00002-APVL-USR-ID TO PV-HOLD-APVL-USR-ID         08020099
080300         ADD +1 TO PA-TOTAL-AUTHORIZERS                           08030099
080400     END-IF.                                                      08040099
080500******************************************************************08050000
080600*     B200-PROCESS-AUTHS                                          08060000
080700* ==> PROCESSES:                                                 *08070000
080800*     - PROCESSES AUTHORIZATIONS FOR A GIVEN DAY.                *08080000
080900* ==> PERFORMED FROM:  A100-MAINLINE                             *08090000
081000******************************************************************08100000
081100 B200-PROCESS-AUTHS.                                              08110000
081200                                                                  08120000
081300     IF SVT00001-CRD-TYP-CDE = SV004-KMRC-CRD-TYP                 08130099
081400         ADD +1 TO PA-KMRC-RECS-READ                              08140099
081500     ELSE                                                         08150099
081600         IF SVT00001-CRD-TYP-CDE = SV004-GIFT-CRD-TYP             08160099
081700             ADD +1 TO PA-GFT-CRD-RECS-READ                       08170099
081800         END-IF                                                   08180099
081900     END-IF.                                                      08190099
082000                                                                  08200099
082100     INITIALIZE PS-VALID-AUTH-SW.                                 08210099
082200                                                                  08220099
082300     IF SVT00002-APVL-USR-ID NOT = PV-HOLD-APVL-USR-ID            08230099
082400      OR SVT00001-CRD-TYP-CDE NOT = PV-HOLD-PREV-CARD-TYPE-CDE    08240099
082500         PERFORM F200-PRINT-TOTAL-TRANS-LINE                      08250000
082600                                                                  08260099
082700         IF SVT00001-CRD-TYP-CDE NOT = PV-HOLD-PREV-CARD-TYPE-CDE 08270099
082800             PERFORM F300-PRINT-TOTAL-LINE                        08280099
082900             INITIALIZE PA-AUTH-TOTAL-ISSUES                      08290099
083000                        PA-AUTH-NUM-ISSUE-VOIDS                   08300099
083100                        PA-AUTH-NUM-ISSUES                        08310099
083200                        PA-AUTH-TOTAL-ISSUE-VOIDS                 08320099
083300                        PA-GRAND-AUTH-NUM                         08330099
083400                        PA-TOTAL-AUTHORIZERS                      08340099
083500                        PA-AUTH-NUM-TENDER-VOIDS                  08350099
083600                        PA-AUTH-NUM-TENDERS                       08360099
083700                        PA-AUTH-NUM-FEE-VOIDS                     08370099
083800                        PA-AUTH-TOTAL-TENDERS                     08380099
083900                        PA-AUTH-TOTAL-TENDER-VOIDS                08390099
084000                        PA-AUTH-TOTAL-FEE-VOIDS                   08400099
084100             MOVE SVT00001-CRD-TYP-CDE TO                         08410099
084200                        PV-HOLD-PREV-CARD-TYPE-CDE                08420099
084300                        PS-CARD-TYPE-CODE-SW                      08430099
084400             PERFORM F100-PROCESS-PAGE-BREAK                      08440099
084500             PERFORM F400-PROCESS-PAGE-BREAK                      08450099
084600         END-IF                                                   08460099
084700                                                                  08470099
084800         INITIALIZE PA-TRANS-NUM-ISSUES                           08480000
084900                    PA-TRANS-NUM-ISSUE-VOIDS                      08490000
085000                    PA-TRANS-NUM-TENDER                           08500000
085100                    PA-TRANS-NUM-TENDER-VOIDS                     08510000
085200                    PA-TRANS-NUM-FEE-VOIDS                        08520000
085300         MOVE SVT00002-APVL-USR-ID TO PV-HOLD-APVL-USR-ID         08530099
085400         PERFORM F250-PRINT-AUTH-HEADER-LINE                      08540099
085500         ADD +1 TO PA-TOTAL-AUTHORIZERS                           08550000
085600     END-IF.                                                      08560099
085700                                                                  08570099
085800     PERFORM D200-TOTAL-TRANS.                                    08580099
085900                                                                  08590099
086000     IF PS-VALID-AUTH                                             08600099
086100         PERFORM E100-PRINT-DETAIL                                08610099
086200         PERFORM E200-PRINT-DETAIL2                               08620099
086300     END-IF.                                                      08630099
086400                                                                  08640000
086500     PERFORM D100-FETCH-KMRC-CURSOR.                              08650099
086600                                                                  08660099
086700******************************************************************08670000
086800*     B900-EOJ-ROUTINE                                           *08680000
086900* ==> PROCESSES:                                                 *08690000
087000*     - WRITES AN END OF REPORT LINE TO THE REPORT               *08700000
087100*     - CLOSES THE FILES                                         *08710000
087200*     - DISPLAYS THE NUMBER OF RECORDS READ AND WRITTEN          *08720000
087300* ==> PERFORMED FROM:  A100-MAINLINE                             *08730000
087400******************************************************************08740000
087500 B900-EOJ-ROUTINE.                                                08750000
087600                                                                  08760000
087700     PERFORM F200-PRINT-TOTAL-TRANS-LINE.                         08770099
087800                                                                  08780099
087900     PERFORM F300-PRINT-TOTAL-LINE.                               08790099
088000                                                                  08800099
088100     CLOSE CONTROL-DATE-FILE                                      08810000
088200           REPORT-FILE                                            08820000
088300           REPORT-FILE-KMRC                                       08830099
088400           REPORT-FILE-GIFT                                       08840099
088500           REPORT-FILE-GFT-CRD.                                   08850000
088600                                                                  08860000
088700     EXEC SQL                                                     08870000
088800        CLOSE KMRC-CSR                                            08880000
088900     END-EXEC.                                                    08890000
089000     EVALUATE TRUE                                                08900000
089100         WHEN SQLCODE NOT = 0                                     08910000
089200         WHEN SQLWARN0    = 'W'                                   08920000
089300             DISPLAY ' '                                          08930000
089400             DISPLAY '** ABEND     **'                            08940000
089500             DISPLAY '** PROGRAM   **  = ' PC-PROGRAM-NAME        08950000
089600             DISPLAY '** PARAGRAPH **  = B200-PROCESS-EXCEPTIONS' 08960000
089700             DISPLAY '** CLOSE CURSOR TO SVT_KOHLS_CRD_TXN TABLE' 08970099
089800             PERFORM Z900-SQL-ABEND                               08980000
089900     END-EVALUATE.                                                08990000
090000                                                                  09000000
090100                                                                  09010000
090200     DISPLAY ' '.                                                 09020000
090300     DISPLAY 'MESSAGES FOR PROGRAM ' PC-PROGRAM-NAME.             09030000
090400     DISPLAY 'NUMBER OF KMRC RECORDS READ:       '                09040000
090500         PA-KMRC-RECS-READ.                                       09050000
090600     DISPLAY ' '.                                                 09060000
090700     DISPLAY 'MESSAGES FOR PROGRAM ' PC-PROGRAM-NAME.             09070000
090800     DISPLAY 'NUMBER OF GIFT CARD RECORDS READ:  '                09080000
090900         PA-GFT-CRD-RECS-READ.                                    09090000
091000     DISPLAY ' '.                                                 09100000
091100                                                                  09110000
091200******************************************************************09120000
091300*     D100-FETCH-KMRC-CURSOR                                     *09130000
091400* ==> PROCESSES:                                                 *09140000
091500*     - READS ACTIVITY FROM THE SVT_KOHLS_CRD_TXN                *09150099
091600* ==> PERFORMED FROM:  B200-PROCESS-AUTHS                        *09160099
091700*                      B100-INITIALIZE                           *09170000
091800******************************************************************09180000
091900 D100-FETCH-KMRC-CURSOR.                                          09190000
092000                                                                  09200000
092100     EXEC SQL                                                     09210000
092200         FETCH KMRC-CSR                                           09220000
092300           INTO  :SVT00002-APVL-USR-ID,                           09230099
092400                 :SVT00002-CRD-NBR,                               09240099
092500                 :SVT00002-TRN-AUTH-TMST,                         09250099
092600                 :SVT00002-STR-NBR,                               09260099
092700                 :SVT00002-POS-TRMNL-NBR,                         09270099
092800                 :SVT00002-POS-TRN-NBR,                           09280099
092900                 :SVT00002-APP-AUTH-AMT,                          09290099
093000                 :SVT00002-ACTVY-TYP-CDE,                         09300099
093100                 :SVT00002-TRN-VOID-IND,                          09310099
093200                 :SVT00002-TRN-RVRSL-CDE,                         09320099
093300                 :SVT00001-CRD-TYP-CDE                            09330099
093400     END-EXEC.                                                    09340000
093500                                                                  09350000
093600     EVALUATE TRUE                                                09360000
093700         WHEN SQLCODE = +0                                        09370000
093800             CONTINUE                                             09380099
093900         WHEN SQLCODE = +100                                      09390000
094000             SET PS-END-OF-KMRC-CSR     TO TRUE                   09400000
094100         WHEN OTHER                                               09410000
094200             MOVE 'D100-FETCH-KMRC-CURSOR     '                   09420000
094300                               TO PV-PARAGRAPH-NAME               09430000
094400             MOVE 'READ ROWS FROM SVT_KOHLS_CRD_TXN        '      09440099
094500                               TO PV-DB2-OPERATION-ATTEMPTED      09450000
094600             PERFORM Z900-SQL-ABEND                               09460000
094700     END-EVALUATE.                                                09470000
094800                                                                  09480000
094900******************************************************************09490000
095000*     D200-TOTAL-TRANS.                                          *09500000
095100* ==> PROCESSES:                                                 *09510000
095200*     - TOTALS THE AUTHORIZATION TYPE TRANSACTIONS.              *09520000
095300* ==> PERFORMED FROM:  B100-INITIALIZE                           *09530000
095400*                      B200-PROCESS-AUTHS                        *09540000
095500******************************************************************09550000
095600 D200-TOTAL-TRANS.                                                09560000
095700                                                                  09570000
095800     IF SVT00002-ACTVY-TYP-CDE = SV004-ISSUE-KMRC-ACT-TYP-N OR    09580099
095900        SVT00002-ACTVY-TYP-CDE = SV004-ISSUE-GIFT-CRD-ACT-TYP-N   09590099
096000        IF SVT00002-TRN-VOID-IND = SV004-VOID-TRANS               09600099
096100           AND SVT00002-TRN-RVRSL-CDE = SV004-REV-CDE-REVERSAL    09610099
096200           ADD +1 TO PA-AUTH-NUM-ISSUE-VOIDS                      09620000
096300                     PA-TRANS-NUM-ISSUE-VOIDS                     09630000
096400           ADD SVT00002-APP-AUTH-AMT TO PA-AUTH-TOTAL-ISSUE-VOIDS 09640099
096500           SET PS-VALID-AUTH TO TRUE                              09650000
096600        ELSE                                                      09660000
096700           ADD +1 TO PA-AUTH-NUM-ISSUES                           09670000
096800                     PA-TRANS-NUM-ISSUES                          09680000
096900           ADD SVT00002-APP-AUTH-AMT TO PA-AUTH-TOTAL-ISSUES      09690099
097000           SET PS-VALID-AUTH TO TRUE                              09700000
097100        END-IF                                                    09710000
097200     ELSE                                                         09720000
097300     IF SVT00002-ACTVY-TYP-CDE = SV004-TENDER-ACT-TYP-N           09730099
097400        IF SVT00002-TRN-VOID-IND = SV004-VOID-TRANS               09740099
097500           AND SVT00002-TRN-RVRSL-CDE = SV004-REV-CDE-REVERSAL    09750099
097600           ADD +1 TO PA-AUTH-NUM-TENDER-VOIDS                     09760000
097700                     PA-TRANS-NUM-TENDER-VOIDS                    09770000
097800           ADD SVT00002-APP-AUTH-AMT TO PA-AUTH-TOTAL-TENDER-VOIDS09780099
097900           SET PS-VALID-AUTH TO TRUE                              09790000
098000        ELSE                                                      09800000
098100           ADD +1 TO PA-AUTH-NUM-TENDERS                          09810000
098200                     PA-TRANS-NUM-TENDER                          09820000
098300           ADD SVT00002-APP-AUTH-AMT TO PA-AUTH-TOTAL-TENDERS     09830099
098400           SET PS-VALID-AUTH TO TRUE                              09840000
098500        END-IF                                                    09850000
098600     ELSE                                                         09860000
098700     IF SVT00002-ACTVY-TYP-CDE = SV004-SRV-FEE-ACT-TYP-N          09870099
098800        IF SVT00002-TRN-VOID-IND = SV004-VOID-TRANS               09880099
098900           AND SVT00002-TRN-RVRSL-CDE = SV004-REV-CDE-REVERSAL    09890099
099000           ADD +1 TO PA-AUTH-NUM-FEE-VOIDS                        09900000
099100                     PA-TRANS-NUM-FEE-VOIDS                       09910000
099200           ADD SVT00002-APP-AUTH-AMT TO PA-AUTH-TOTAL-FEE-VOIDS   09920099
099300           SET PS-VALID-AUTH TO TRUE                              09930000
099400        END-IF                                                    09940000
099500     END-IF                                                       09950000
099600     END-IF.                                                      09960000
099700                                                                  09970000
099800     IF PS-VALID-AUTH                                             09980000
099900        ADD +1 TO PA-GRAND-AUTH-NUM.                              09990000
100000                                                                  10000000
100100******************************************************************10010000
100200*     E100-PRINT-DETAIL.                                         *10020000
100300* ==> PROCESSES:                                                 *10030000
100400*     - WRITES THE SINGLE TRANSACTION DETAIL LINES.              *10040000
100500* ==> PERFORMED FROM:                                            *10050099
100600*                      B100-INITIALIZE                           *10060000
100700*                      B200-PROCESS-AUTHS                        *10070000
100800******************************************************************10080000
100900 E100-PRINT-DETAIL.                                               10090000
101000                                                                  10100000
101100     MOVE SVT00002-TRN-AUTH-TMST TO PV-TRN-AUTH-TMST.             10110099
101200     MOVE PV-AUTH-TIME         TO RDL-AUTH-TIME                   10120099
101300                                  RDL2-AUTH-TIME.                 10130099
101400                                                                  10140000
101500     IF SVT00002-ACTVY-TYP-CDE = SV004-TENDER-ACT-TYP-N OR        10150099
101600        SVT00002-ACTVY-TYP-CDE = SV004-SRV-FEE-ACT-TYP-N OR       10160099
101700        SVT00002-TRN-RVRSL-CDE = SV004-REV-CDE-REVERSAL           10170099
101800         MOVE SVT00002-CRD-NBR TO PV-CRD-NBR                      10180099
101900         PERFORM E110-FIND-ISSUE-DATE                             10190099
102000     ELSE                                                         10200099
102100        MOVE PV-AUTH-DATE TO PV-ISSUE-DATE                        10210099
102200     END-IF.                                                      10220099
102300                                                                  10230099
102400     IF PV-TODAYS-DATE = PV-ISSUE-DATE                            10240099
102500         MOVE SPACES TO RDL-AUTH-DATE                             10250099
102600                        RDL2-AUTH-DATE                            10260099
102700     ELSE                                                         10270099
102800         MOVE PV-ISSUE-DATE-CC TO RDL-AUTH-DATE-CC                10280099
102900                                  RDL2-AUTH-DATE-CC               10290099
103000         MOVE PV-ISSUE-DATE-YY TO RDL-AUTH-DATE-YY                10300099
103100                                  RDL2-AUTH-DATE-YY               10310099
103200         MOVE PV-ISSUE-DATE-MM TO RDL-AUTH-DATE-MM                10320099
103300                                  RDL2-AUTH-DATE-MM               10330099
103400         MOVE PV-ISSUE-DATE-DD TO RDL-AUTH-DATE-DD                10340099
103500                                  RDL2-AUTH-DATE-DD               10350099
103600         MOVE '/' TO RDL-AUTH-SLASH1                              10360099
103700                     RDL2-AUTH-SLASH1                             10370099
103800                     RDL-AUTH-SLASH2                              10380099
103900                     RDL2-AUTH-SLASH2                             10390099
104000     END-IF.                                                      10400099
104100                                                                  10410000
104200     MOVE SVT00002-CRD-NBR              TO RDL-CRD-NBR            10420099
104300                                           RDL2-CRD-NBR.          10430099
104400     MOVE SVT00002-STR-NBR              TO RDL-STR-NBR            10440099
104500                                           RDL2-STR-NBR.          10450099
104600     MOVE SVT00002-POS-TRMNL-NBR        TO RDL-POS-TRMNL-NBR      10460099
104700                                           RDL2-POS-TRMNL-NBR.    10470099
104800     MOVE SVT00002-POS-TRN-NBR          TO RDL-POS-TRN-NBR        10480099
104900                                           RDL2-POS-TRN-NBR.      10490099
105000     MOVE SVT00002-APP-AUTH-AMT         TO RDL-APP-AUTH-AMT       10500099
105100                                           RDL2-APP-AUTH-AMT.     10510099
105200                                                                  10520000
105300     EVALUATE TRUE                                                10530099
105400         WHEN SVT00002-ACTVY-TYP-CDE = SV004-ISSUE-KMRC-ACT-TYP-N 10540099
105500             MOVE SV004-ISSUE-KMRC-SHRT-DESC TO RDL-ACTVY-TYP-DESC10550099
105600                                               RDL2-ACTVY-TYP-DESC10560099
105700         WHEN SVT00002-ACTVY-TYP-CDE =                            10570099
105800                                   SV004-ISSUE-GIFT-CRD-ACT-TYP-N 10580099
105900             MOVE SV004-ISSUE-GIFT-CRD-SHRT-DESC TO               10590099
106000                                               RDL-ACTVY-TYP-DESC 10600099
106100                                              RDL2-ACTVY-TYP-DESC 10610099
106200         WHEN SVT00002-ACTVY-TYP-CDE = SV004-TENDER-ACT-TYP-N     10620099
106300             MOVE SV004-TENDER-SHRT-DESC    TO RDL-ACTVY-TYP-DESC 10630099
106400                                              RDL2-ACTVY-TYP-DESC 10640099
106500         WHEN SVT00002-ACTVY-TYP-CDE = SV004-SRV-FEE-ACT-TYP-N    10650099
106600             MOVE SV004-SRV-FEE-SHRT-DESC   TO RDL-ACTVY-TYP-DESC 10660099
106700                                              RDL2-ACTVY-TYP-DESC 10670099
106800         WHEN OTHER                                               10680099
106900             MOVE SPACES                    TO RDL-ACTVY-TYP-DESC 10690099
107000                                              RDL2-ACTVY-TYP-DESC 10700099
107100     END-EVALUATE.                                                10710099
107200                                                                  10720000
107300     IF (SVT00002-TRN-VOID-IND = SV004-VOID-TRANS)                10730099
107400        AND (SVT00002-TRN-RVRSL-CDE = SV004-REV-CDE-REVERSAL)     10740099
107500         MOVE SV004-VOID-LONG-DESC TO RDL-VOID-IND                10750099
107600                                      RDL2-VOID-IND               10760099
107700     ELSE                                                         10770000
107800         MOVE SPACES               TO RDL-VOID-IND                10780099
107900                                      RDL2-VOID-IND.              10790099
108000                                                                  10800000
108100     IF PS-MERCHANDISE-RETURN-CREDIT                              10810000
108200       IF PA-LINE-COUNTER > PC-MAX-LINES-PER-PAGE                 10820000
108300         PERFORM F100-PROCESS-PAGE-BREAK                          10830000
108400         PERFORM F250-PRINT-AUTH-HEADER-LINE                      10840000
108500       END-IF                                                     10850000
108600                                                                  10860000
108700       WRITE REPORT-RECORD                                        10870000
108800           FROM REPORT-DETAIL-LINE                                10880000
108900           AFTER ADVANCING 1 LINE                                 10890000
109000                                                                  10900000
109100       ADD PC-ONE TO PA-LINE-COUNTER                              10910000
109200     ELSE                                                         10920000
109300       IF PS-GIFT-CARD                                            10930000
109400         IF PA-LINE-COUNTER-GFT-CRD > PC-MAX-LINES-PER-PAGE       10940000
109500           PERFORM F100-PROCESS-PAGE-BREAK                        10950000
109600           PERFORM F250-PRINT-AUTH-HEADER-LINE                    10960000
109700         END-IF                                                   10970000
109800                                                                  10980000
109900         WRITE REPORT-RECORD-GFT-CRD                              10990000
110000             FROM REPORT-DETAIL-LINE                              11000000
110100             AFTER ADVANCING 1 LINE                               11010000
110200                                                                  11020000
110300         ADD PC-ONE TO PA-LINE-COUNTER-GFT-CRD                    11030000
110400       END-IF                                                     11040000
110500     END-IF.                                                      11050000
110600                                                                  11060099
110700******************************************************************11070000
110800*     E110-FIND-ISSUE-DATE.                                      *11080000
110900* ==> PROCESSES:                                                 *11090000
111000*     - LOCATES THE ISSUE DATE.                                  *11100000
111100* ==> PERFORMED FROM:  E100-PRINT-DETAIL                         *11110000
111200******************************************************************11120000
111300 E110-FIND-ISSUE-DATE.                                            11130000
111400                                                                  11140000
111500     EXEC SQL                                                     11150099
111600         OPEN KMRC-ISS-DT-CSR                                     11160099
111700     END-EXEC.                                                    11170099
111800                                                                  11180099
111900     EVALUATE TRUE                                                11190099
112000         WHEN SQLCODE NOT = 0                                     11200099
112100             DISPLAY ' '                                          11210099
112200             DISPLAY '** ABEND     **'                            11220099
112300             DISPLAY '** PROGRAM   **  = ' PC-PROGRAM-NAME        11230099
112400             DISPLAY '** PARAGRAPH **  = E110-PROCESS-KMRC'       11240099
112500             DISPLAY '** OPEN CURSOR TO '                         11250099
112600             DISPLAY '** SVT_KOHLS_CRD_TXN TABLE '                11260099
112700             DISPLAY '** TO FIND THE ISSUE DATE'                  11270099
112800             PERFORM Z900-SQL-ABEND                               11280099
112900     END-EVALUATE.                                                11290099
113000                                                                  11300000
113100     EXEC SQL                                                     11310099
113200         FETCH   KMRC-ISS-DT-CSR                                  11320099
113300          INTO  :PV-ISSUE-DATE-TMST                               11330099
113400     END-EXEC.                                                    11340099
113500                                                                  11350099
113600     EVALUATE TRUE                                                11360099
113700         WHEN SQLCODE = +100                                      11370099
113800             MOVE PV-AUTH-DATE TO PV-ISSUE-DATE                   11380099
113900         WHEN SQLCODE NOT = 0                                     11390099
114000             DISPLAY 'CARD NUMBER' PV-CRD-NBR                     11400000
114100             DISPLAY '** ABEND     **'                            11410000
114200             DISPLAY '** PROGRAM   **  = ' PC-PROGRAM-NAME        11420000
114300             DISPLAY '** PARAGRAPH **  = E110-FIND-ISSUE-DATE'    11430000
114400             DISPLAY '** FETCH RECORE FROM '                      11440099
114500             DISPLAY '** SVT_KOHLS_CRD_TXN TABLE'                 11450099
114600             PERFORM Z900-SQL-ABEND                               11460000
114700     END-EVALUATE.                                                11470099
114800                                                                  11480000
114900     EXEC SQL                                                     11490099
115000         CLOSE KMRC-ISS-DT-CSR                                    11500099
115100     END-EXEC.                                                    11510099
115200                                                                  11520099
115300     EVALUATE TRUE                                                11530099
115400         WHEN SQLCODE NOT = 0                                     11540099
115500             DISPLAY '** ABEND     **'                            11550099
115600             DISPLAY '** PROGRAM   **  = ' PC-PROGRAM-NAME        11560099
115700             DISPLAY '** CLOSE CURSOR FOR ISSUE DATE'             11570099
115800             PERFORM Z900-SQL-ABEND                               11580099
115900     END-EVALUATE.                                                11590099
116000                                                                  11600000
116100******************************************************************11610099
116200*     E200-PRINT-DETAIL2.                                        *11620099
116300* ==> PROCESSES:                                                 *11630099
116400*     - WRITES THE SINGLE TRANSACTION DETAIL LINES.              *11640099
116500* ==> PERFORMED FROM:                                            *11650099
116600*                      B200-PROCESS-AUTHS                        *11660099
116700******************************************************************11670099
116800 E200-PRINT-DETAIL2.                                              11680099
116900                                                                  11690099
117000     IF PS-MERCHANDISE-RETURN-CREDIT                              11700099
117100         IF PA-LINE-COUNTER-KMRC > PC-MAX-LINES-PER-PAGE          11710099
117200             PERFORM F400-PROCESS-PAGE-BREAK                      11720099
117300         END-IF                                                   11730099
117400                                                                  11740099
117500         WRITE REPORT-RECORD-KMRC                                 11750099
117600             FROM REPORT-DETAIL-LINE2                             11760099
117700             AFTER ADVANCING 1 LINE                               11770099
117800                                                                  11780099
117900         ADD PC-ONE TO PA-LINE-COUNTER-KMRC                       11790099
118000     ELSE                                                         11800099
118100         IF PS-GIFT-CARD                                          11810099
118200             IF PA-LINE-COUNTER-GIFT > PC-MAX-LINES-PER-PAGE      11820099
118300                 PERFORM F400-PROCESS-PAGE-BREAK                  11830099
118400             END-IF                                               11840099
118500                                                                  11850099
118600             WRITE REPORT-RECORD-GIFT                             11860099
118700                 FROM REPORT-DETAIL-LINE2                         11870099
118800                 AFTER ADVANCING 1 LINE                           11880099
118900                                                                  11890099
119000             ADD PC-ONE TO PA-LINE-COUNTER-GIFT                   11900099
119100         END-IF                                                   11910099
119200     END-IF.                                                      11920099
119300******************************************************************11930000
119400*     F100-PROCESS-PAGE-BREAK.                                   *11940000
119500* ==> PROCESSES:                                                 *11950000
119600*     - ADVANCES TO A NEW PAGE AND WRITES THE REPORT HEADINGS    *11960000
119700* ==> PERFORMED FROM:  E100-PRINT-DETAIL-LINE                    *11970000
119800*                      B200-PROCESS-AUTHS                        *11980000
119900*                      B100-INITIALIZE                           *11990000
120000*                      F200-PRINT-TOTAL-TRANS-LINE               *12000000
120100*                      F250-PRINT-AUTH-HEADER-LINE               *12010000
120200*                      F300-PRINT-TOTAL-LINE                     *12020000
120300******************************************************************12030000
120400 F100-PROCESS-PAGE-BREAK.                                         12040000
120500                                                                  12050000
120600     IF PS-MERCHANDISE-RETURN-CREDIT                              12060000
120700       MOVE PC-ONE               TO DP132O-REPORT-NUMBER          12070000
120800       ADD PC-ONE                TO PA-PAGE-COUNTER               12080000
120900       MOVE PA-PAGE-COUNTER      TO DP132O-PAGE-NUMBER            12090000
121000                                                                  12100000
121100       MOVE PC-HEADER-LINE-COUNT TO PA-LINE-COUNTER               12110000
121200                                                                  12120000
121300       WRITE REPORT-RECORD                                        12130000
121400           FROM DP132O-STANDRD-HEADER-132-COLS                    12140000
121500           AFTER ADVANCING PAGE                                   12150000
121600                                                                  12160000
121700       WRITE REPORT-RECORD                                        12170000
121800           FROM REPORT-TITLE-LINE                                 12180000
121900           AFTER ADVANCING 1 LINE                                 12190000
122000                                                                  12200000
122100       WRITE REPORT-RECORD                                        12210000
122200           FROM REPORT-SUBTITLE-LINE                              12220000
122300           AFTER ADVANCING 1 LINE                                 12230000
122400                                                                  12240000
122500       WRITE REPORT-RECORD                                        12250000
122600           FROM REPORT-DETAIL-HEADER                              12260000
122700           AFTER ADVANCING 2 LINES                                12270000
122800                                                                  12280000
122900       ADD PC-FOUR  TO PA-LINE-COUNTER                            12290000
123000     ELSE                                                         12300000
123100       IF PS-GIFT-CARD                                            12310000
123200         MOVE PC-TWO                  TO DP132O-REPORT-NUMBER     12320000
123300         ADD PC-ONE                   TO PA-PAGE-COUNTER-GFT-CRD  12330000
123400         MOVE PA-PAGE-COUNTER-GFT-CRD TO DP132O-PAGE-NUMBER       12340000
123500                                                                  12350000
123600         MOVE PC-HEADER-LINE-COUNT TO PA-LINE-COUNTER-GFT-CRD     12360000
123700                                                                  12370000
123800         WRITE REPORT-RECORD-GFT-CRD                              12380000
123900             FROM DP132O-STANDRD-HEADER-132-COLS                  12390000
124000             AFTER ADVANCING PAGE                                 12400000
124100                                                                  12410000
124200         WRITE REPORT-RECORD-GFT-CRD                              12420000
124300             FROM REPORT-TITLE-LINE-GFT-CRD                       12430000
124400             AFTER ADVANCING 1 LINE                               12440000
124500                                                                  12450000
124600         WRITE REPORT-RECORD-GFT-CRD                              12460000
124700             FROM REPORT-SUBTITLE-LINE                            12470000
124800             AFTER ADVANCING 1 LINE                               12480000
124900                                                                  12490000
125000         WRITE REPORT-RECORD-GFT-CRD                              12500000
125100             FROM REPORT-DETAIL-HEADER                            12510000
125200             AFTER ADVANCING 2 LINES                              12520000
125300                                                                  12530000
125400         ADD PC-FOUR  TO PA-LINE-COUNTER-GFT-CRD                  12540000
125500       END-IF                                                     12550000
125600     END-IF.                                                      12560000
125700******************************************************************12570000
125800*     F200-PRINT-TOTAL-TRANS-LINE.                               *12580000
125900* ==> PROCESSES:                                                 *12590000
126000*     - WRITES TOTAL TRANSACTION LINE FOR A GIVEN AUTHORIZER.    *12600000
126100* ==> PERFORMED FROM:  B200-PROCESS-AUTH                         *12610000
126200******************************************************************12620000
126300 F200-PRINT-TOTAL-TRANS-LINE.                                     12630000
126400                                                                  12640000
126500     MOVE PA-TRANS-NUM-ISSUES         TO RTTL-NUM-ISSUES.         12650000
126600     MOVE PA-TRANS-NUM-ISSUE-VOIDS    TO RTTL-NUM-ISSUE-VOIDS.    12660000
126700     MOVE PA-TRANS-NUM-TENDER         TO RTTL-NUM-TENDERS.        12670000
126800     MOVE PA-TRANS-NUM-TENDER-VOIDS   TO RTTL-NUM-TENDER-VOIDS.   12680000
126900     MOVE PA-TRANS-NUM-FEE-VOIDS      TO RTTL-NUM-FEE-VOIDS.      12690000
127000                                                                  12700000
127100     IF PS-MERCHANDISE-RETURN-CREDIT                              12710000
127200       IF PA-LINE-COUNTER > PC-MAX-LINES-PER-PAGE                 12720000
127300         PERFORM F100-PROCESS-PAGE-BREAK                          12730000
127400       END-IF                                                     12740000
127500                                                                  12750000
127600       WRITE REPORT-RECORD                                        12760000
127700           FROM REPORT-TOTAL-TRANS-LINE                           12770000
127800           AFTER ADVANCING 2 LINES                                12780000
127900                                                                  12790000
128000       ADD PC-TWO   TO PA-LINE-COUNTER                            12800000
128100     ELSE                                                         12810000
128200       IF PS-GIFT-CARD                                            12820000
128300         IF PA-LINE-COUNTER-GFT-CRD > PC-MAX-LINES-PER-PAGE       12830000
128400           PERFORM F100-PROCESS-PAGE-BREAK                        12840000
128500         END-IF                                                   12850000
128600                                                                  12860000
128700         WRITE REPORT-RECORD-GFT-CRD                              12870000
128800             FROM REPORT-TOTAL-TRANS-LINE                         12880000
128900             AFTER ADVANCING 2 LINES                              12890000
129000                                                                  12900000
129100         ADD PC-TWO   TO PA-LINE-COUNTER-GFT-CRD                  12910000
129200       END-IF                                                     12920000
129300     END-IF.                                                      12930000
129400******************************************************************12940000
129500*     F250-PRINT-AUTH-HEADER-LINE.                               *12950000
129600* ==> PROCESSES:                                                 *12960000
129700*     - WRITES THE AUTHORIZER HEADER.                            *12970000
129800* ==> PERFORMED FROM:  B200-PROCESS-AUTH                         *12980000
129900*                      B100-INITIALIZE                           *12990000
130000*                      E100-PRINT-DETAIL-LINE                    *13000000
130100*                      F300-PRINT-TOTAL-LINE                     *13010000
130200******************************************************************13020000
130300 F250-PRINT-AUTH-HEADER-LINE.                                     13030000
130400                                                                  13040000
130500     MOVE PV-HOLD-APVL-USR-ID TO RAHL-AUTHORIZER-NUMBER           13050099
130600                                 RDL2-USER-ID.                    13060099
130700                                                                  13070000
130800     IF PS-MERCHANDISE-RETURN-CREDIT                              13080000
130900       IF PA-LINE-COUNTER > PC-MAX-LINES-AUTH-HEADER              13090000
131000         PERFORM F100-PROCESS-PAGE-BREAK                          13100000
131100       END-IF                                                     13110000
131200                                                                  13120000
131300       WRITE REPORT-RECORD                                        13130000
131400           FROM REPORT-AUTH-HEADER-LINE                           13140000
131500           AFTER ADVANCING 2 LINES                                13150000
131600                                                                  13160000
131700       ADD PC-TWO   TO PA-LINE-COUNTER                            13170000
131800     ELSE                                                         13180000
131900       IF PS-GIFT-CARD                                            13190000
132000         IF PA-LINE-COUNTER-GFT-CRD > PC-MAX-LINES-AUTH-HEADER    13200000
132100           PERFORM F100-PROCESS-PAGE-BREAK                        13210000
132200         END-IF                                                   13220000
132300                                                                  13230000
132400         WRITE REPORT-RECORD-GFT-CRD                              13240000
132500             FROM REPORT-AUTH-HEADER-LINE                         13250000
132600             AFTER ADVANCING 2 LINES                              13260000
132700                                                                  13270000
132800         ADD PC-TWO   TO PA-LINE-COUNTER-GFT-CRD                  13280000
132900       END-IF                                                     13290000
133000     END-IF.                                                      13300000
133100******************************************************************13310000
133200*     F300-PRINT-TOTAL-LINE.                                     *13320000
133300* ==> PROCESSES:                                                 *13330000
133400*     - WRITES THE TOTAL SECTION OF THE REPORT.                  *13340000
133500* ==> PERFORMED FROM:  A100-MAINLINE                             *13350000
133600******************************************************************13360000
133700 F300-PRINT-TOTAL-LINE.                                           13370000
133800                                                                  13380000
133900     IF PS-MERCHANDISE-RETURN-CREDIT                              13390000
134000       IF PA-LINE-COUNTER > PC-MAX-LINES-BEFORE-TOT-PG            13400000
134100         PERFORM F100-PROCESS-PAGE-BREAK                          13410000
134200       END-IF                                                     13420000
134300                                                                  13430000
134400       MOVE PA-TOTAL-AUTHORIZERS TO RTAL-TOTAL-AUTHORIZERS        13440000
134500       WRITE REPORT-RECORD                                        13450000
134600           FROM REPORT-TOTAL-AUTHORIZERS-LINE                     13460000
134700           AFTER ADVANCING 2 LINES                                13470000
134800       ADD PC-TWO TO PA-LINE-COUNTER                              13480000
134900                                                                  13490000
135000       MOVE PA-AUTH-TOTAL-ISSUES TO RTIL-AUTH-TOTAL-ISSUES        13500000
135100       MOVE PA-AUTH-NUM-ISSUES   TO RTIL-AUTH-NUM-ISSUES          13510000
135200       WRITE REPORT-RECORD                                        13520000
135300           FROM REPORT-TOTAL-ISSUES-LINE                          13530000
135400           AFTER ADVANCING 2 LINES                                13540000
135500       ADD PC-TWO TO PA-LINE-COUNTER                              13550000
135600                                                                  13560000
135700       MOVE PA-AUTH-TOTAL-ISSUE-VOIDS                             13570000
135800                                 TO RTIVL-AUTH-TOTAL-ISSUE-VOIDS  13580000
135900       MOVE PA-AUTH-NUM-ISSUE-VOIDS TO RTIVL-AUTH-NUM-ISSUE-VOIDS 13590000
136000       WRITE REPORT-RECORD                                        13600000
136100           FROM REPORT-TOTAL-ISSUE-VOIDS-LINE                     13610000
136200           AFTER ADVANCING 2 LINES                                13620000
136300       ADD PC-TWO TO PA-LINE-COUNTER                              13630000
136400                                                                  13640000
136500       MOVE PA-AUTH-TOTAL-TENDERS     TO RTTL-AUTH-TOTAL-TENDERS  13650000
136600       MOVE PA-AUTH-NUM-TENDERS  TO RTTL-AUTH-NUM-TENDERS         13660000
136700       WRITE REPORT-RECORD                                        13670000
136800           FROM REPORT-TOTAL-TENDERS-LINE                         13680000
136900           AFTER ADVANCING 2 LINES                                13690000
137000       ADD PC-TWO TO PA-LINE-COUNTER                              13700000
137100                                                                  13710000
137200       MOVE PA-AUTH-TOTAL-TENDER-VOIDS                            13720000
137300                                 TO RTTVL-AUTH-TOTAL-TENDER-VOIDS 13730000
137400       MOVE PA-AUTH-NUM-TENDER-VOIDS                              13740000
137500                                 TO RTTVL-AUTH-NUM-TENDER-VOIDS   13750000
137600       WRITE REPORT-RECORD                                        13760000
137700           FROM REPORT-TOTAL-TENDER-VOIDS-LINE                    13770000
137800           AFTER ADVANCING 2 LINES                                13780000
137900       ADD PC-TWO TO PA-LINE-COUNTER                              13790000
138000                                                                  13800000
138100       MOVE PA-AUTH-TOTAL-FEE-VOIDS                               13810000
138200                                 TO RTTVL-AUTH-TOTAL-FEE-VOIDS    13820000
138300       MOVE PA-AUTH-NUM-FEE-VOIDS                                 13830000
138400                                 TO RTTVL-AUTH-NUM-FEE-VOIDS      13840000
138500       WRITE REPORT-RECORD                                        13850000
138600           FROM REPORT-TOTAL-FEE-VOIDS-LINE                       13860000
138700           AFTER ADVANCING 2 LINES                                13870000
138800       ADD PC-TWO TO PA-LINE-COUNTER                              13880000
138900                                                                  13890000
139000       WRITE REPORT-RECORD                                        13900000
139100           FROM REPORT-TOTAL-DASH-LINE                            13910000
139200           AFTER ADVANCING 2 LINES                                13920000
139300       ADD PC-TWO TO PA-LINE-COUNTER                              13930000
139400                                                                  13940000
139500       MOVE PA-GRAND-AUTH-NUM      TO RTTAL-GRAND-NUM-TOTAL       13950000
139600       WRITE REPORT-RECORD                                        13960000
139700           FROM REPORT-TOTAL-TOTAL-AUTHS-LINE                     13970000
139800           AFTER ADVANCING 1 LINE                                 13980000
139900       ADD PC-ONE TO PA-LINE-COUNTER                              13990000
140000     ELSE                                                         14000000
140100       IF PS-GIFT-CARD                                            14010000
140200         IF PA-LINE-COUNTER-GFT-CRD > PC-MAX-LINES-BEFORE-TOT-PG  14020000
140300            PERFORM F100-PROCESS-PAGE-BREAK                       14030000
140400         END-IF                                                   14040000
140500                                                                  14050000
140600         MOVE PA-TOTAL-AUTHORIZERS TO RTAL-TOTAL-AUTHORIZERS      14060000
140700         WRITE REPORT-RECORD-GFT-CRD                              14070000
140800             FROM REPORT-TOTAL-AUTHORIZERS-LINE                   14080000
140900             AFTER ADVANCING 2 LINES                              14090000
141000         ADD PC-TWO TO PA-LINE-COUNTER-GFT-CRD                    14100000
141100                                                                  14110000
141200         MOVE PA-AUTH-TOTAL-ISSUES TO RTIL-AUTH-TOTAL-ISSUES      14120000
141300         MOVE PA-AUTH-NUM-ISSUES   TO RTIL-AUTH-NUM-ISSUES        14130000
141400         WRITE REPORT-RECORD-GFT-CRD                              14140000
141500             FROM REPORT-TOTAL-ISSUES-LINE                        14150000
141600             AFTER ADVANCING 2 LINES                              14160000
141700         ADD PC-TWO TO PA-LINE-COUNTER-GFT-CRD                    14170000
141800                                                                  14180000
141900         MOVE PA-AUTH-TOTAL-ISSUE-VOIDS                           14190000
142000                                 TO RTIVL-AUTH-TOTAL-ISSUE-VOIDS  14200000
142100         MOVE PA-AUTH-NUM-ISSUE-VOIDS                             14210000
142200                                 TO RTIVL-AUTH-NUM-ISSUE-VOIDS    14220000
142300         WRITE REPORT-RECORD-GFT-CRD                              14230000
142400             FROM REPORT-TOTAL-ISSUE-VOIDS-LINE                   14240000
142500             AFTER ADVANCING 2 LINES                              14250000
142600         ADD PC-TWO TO PA-LINE-COUNTER-GFT-CRD                    14260000
142700                                                                  14270000
142800         MOVE PA-AUTH-TOTAL-TENDERS  TO RTTL-AUTH-TOTAL-TENDERS   14280000
142900         MOVE PA-AUTH-NUM-TENDERS    TO RTTL-AUTH-NUM-TENDERS     14290000
143000         WRITE REPORT-RECORD-GFT-CRD                              14300000
143100             FROM REPORT-TOTAL-TENDERS-LINE                       14310000
143200             AFTER ADVANCING 2 LINES                              14320000
143300         ADD PC-TWO TO PA-LINE-COUNTER-GFT-CRD                    14330000
143400                                                                  14340000
143500         MOVE PA-AUTH-TOTAL-TENDER-VOIDS                          14350000
143600                                 TO RTTVL-AUTH-TOTAL-TENDER-VOIDS 14360000
143700         MOVE PA-AUTH-NUM-TENDER-VOIDS                            14370000
143800                                 TO RTTVL-AUTH-NUM-TENDER-VOIDS   14380000
143900         WRITE REPORT-RECORD-GFT-CRD                              14390000
144000             FROM REPORT-TOTAL-TENDER-VOIDS-LINE                  14400000
144100             AFTER ADVANCING 2 LINES                              14410000
144200         ADD PC-TWO TO PA-LINE-COUNTER-GFT-CRD                    14420000
144300                                                                  14430000
144400         MOVE PA-AUTH-TOTAL-FEE-VOIDS                             14440000
144500                                 TO RTTVL-AUTH-TOTAL-FEE-VOIDS    14450000
144600         MOVE PA-AUTH-NUM-FEE-VOIDS                               14460000
144700                                 TO RTTVL-AUTH-NUM-FEE-VOIDS      14470000
144800         WRITE REPORT-RECORD-GFT-CRD                              14480000
144900             FROM REPORT-TOTAL-FEE-VOIDS-LINE                     14490000
145000             AFTER ADVANCING 2 LINES                              14500000
145100         ADD PC-TWO TO PA-LINE-COUNTER-GFT-CRD                    14510000
145200                                                                  14520000
145300         WRITE REPORT-RECORD-GFT-CRD                              14530000
145400             FROM REPORT-TOTAL-DASH-LINE                          14540000
145500             AFTER ADVANCING 2 LINES                              14550000
145600         ADD PC-TWO TO PA-LINE-COUNTER-GFT-CRD                    14560000
145700                                                                  14570000
145800         MOVE PA-GRAND-AUTH-NUM      TO RTTAL-GRAND-NUM-TOTAL     14580000
145900         WRITE REPORT-RECORD-GFT-CRD                              14590000
146000             FROM REPORT-TOTAL-TOTAL-AUTHS-LINE                   14600000
146100             AFTER ADVANCING 1 LINE                               14610000
146200         ADD PC-ONE TO PA-LINE-COUNTER-GFT-CRD                    14620000
146300       END-IF                                                     14630000
146400     END-IF.                                                      14640000
146500******************************************************************14650099
146600*     F400-PROCESS-PAGE-BREAK.                                   *14660099
146700* ==> PROCESSES:                                                 *14670099
146800*     - ADVANCES TO A NEW PAGE AND WRITES THE REPORT HEADINGS    *14680099
146900* ==> PERFORMED FROM:  E200-PRINT-DETAIL-LINE                    *14690099
147000******************************************************************14700099
147100 F400-PROCESS-PAGE-BREAK.                                         14710099
147200                                                                  14720099
147300     IF PS-MERCHANDISE-RETURN-CREDIT                              14730099
147400         MOVE PC-THREE             TO DP132O-REPORT-NUMBER        14740099
147500         ADD PC-ONE                TO PA-PAGE-COUNTER-KMRC        14750099
147600         MOVE PA-PAGE-COUNTER-KMRC TO DP132O-PAGE-NUMBER          14760099
147700                                                                  14770099
147800         MOVE PC-HEADER-LINE-COUNT TO PA-LINE-COUNTER-KMRC        14780099
147900                                                                  14790099
148000         WRITE REPORT-RECORD-KMRC                                 14800099
148100             FROM DP132O-STANDRD-HEADER-132-COLS                  14810099
148200             AFTER ADVANCING PAGE                                 14820099
148300                                                                  14830099
148400         WRITE REPORT-RECORD-KMRC                                 14840099
148500             FROM REPORT-TITLE-LINE                               14850099
148600             AFTER ADVANCING 1 LINE                               14860099
148700                                                                  14870099
148800         WRITE REPORT-RECORD-KMRC                                 14880099
148900             FROM REPORT-SUBTITLE-LINE                            14890099
149000             AFTER ADVANCING 1 LINE                               14900099
149100                                                                  14910099
149200         WRITE REPORT-RECORD-KMRC                                 14920099
149300             FROM REPORT-DETAIL-HEADER2                           14930099
149400             AFTER ADVANCING 2 LINES                              14940099
149500                                                                  14950099
149600         ADD PC-FOUR  TO PA-LINE-COUNTER-KMRC                     14960099
149700     ELSE                                                         14970099
149800         IF PS-GIFT-CARD                                          14980099
149900             MOVE PC-FOUR                 TO DP132O-REPORT-NUMBER 14990099
150000             ADD PC-ONE                   TO PA-PAGE-COUNTER-GIFT 15000099
150100             MOVE PA-PAGE-COUNTER-GIFT    TO DP132O-PAGE-NUMBER   15010099
150200                                                                  15020099
150300             MOVE PC-HEADER-LINE-COUNT TO PA-LINE-COUNTER-GIFT    15030099
150400                                                                  15040099
150500             WRITE REPORT-RECORD-GIFT                             15050099
150600                 FROM DP132O-STANDRD-HEADER-132-COLS              15060099
150700                 AFTER ADVANCING PAGE                             15070099
150800                                                                  15080099
150900             WRITE REPORT-RECORD-GIFT                             15090099
151000                 FROM REPORT-TITLE-LINE-GFT-CRD                   15100099
151100                 AFTER ADVANCING 1 LINE                           15110099
151200                                                                  15120099
151300             WRITE REPORT-RECORD-GIFT                             15130099
151400                 FROM REPORT-SUBTITLE-LINE                        15140099
151500                 AFTER ADVANCING 1 LINE                           15150099
151600                                                                  15160099
151700             WRITE REPORT-RECORD-GIFT                             15170099
151800                 FROM REPORT-DETAIL-HEADER2                       15180099
151900                 AFTER ADVANCING 2 LINES                          15190099
152000                                                                  15200099
152100             ADD PC-FOUR  TO PA-LINE-COUNTER-GIFT                 15210099
152200         END-IF                                                   15220099
152300     END-IF.                                                      15230099
152400******************************************************************15240000
152500*     Z900-SQL-ABEND                                             *15250000
152600* ==> PROCESSES:                                                 *15260000
152700*     -PERFORMS ABEND PROCESSING FOR SQL ERRORS.                 *15270000
152800* ==> PERFORMED FROM:  B100-INITIALIZE                           *15280000
152900*                      D100-FETCH-KMRC-CURSOR                    *15290000
153000*                      B900-EOJ-ROUTINE                          *15300000
153100******************************************************************15310000
153200 Z900-SQL-ABEND.                                                  15320000
153300                                                                  15330000
153400     DISPLAY 'Z900-SQL-ABEND'.                                    15340000
153500     DISPLAY '**  ABEND     **'.                                  15350000
153600     DISPLAY '**  PROGRAM   ** = ' PC-PROGRAM-NAME.               15360000
153700     DISPLAY '**  PARAGRAPH ** = ' PV-PARAGRAPH-NAME.             15370000
153800     DISPLAY '**  OPERATION ** = ' PV-DB2-OPERATION-ATTEMPTED.    15380000
153900                                                                  15390000
154000******************************************************************15400000
154100* THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION STATE-   *15410000
154200* MENTS THAT ARE REQUIRED TO UTILIZE THE DB2 ABEND MODULE        *15420000
154300* 'DSNTIAR' AND CONVERT THE SQLCA INFORMATION INTO A READABLE    *15430000
154400* FORMAT.                                                        *15440000
154500******************************************************************15450000
154600     COPY DPPD004.                                                15460000
154700                                                                  15470000
154800     MOVE +4013 TO ABEND-CODE.                                    15480000
154900     CALL 'ILBOABN0' USING ABEND-CODE.                            15490000
