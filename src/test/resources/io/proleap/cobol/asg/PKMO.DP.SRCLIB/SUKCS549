000100 IDENTIFICATION DIVISION.                                         00010051
000200 PROGRAM-ID.    SUKCS549.                                         00020000
000300 AUTHOR.        DENNIS STEFFEN.                                   00030000
000400 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00040000
000500 DATE-WRITTEN.  OCTOBER, 2002                                     00050000
000600 DATE-COMPILED.                                                   00060000
000700*---------------------------------------------------------------* 00070000
000800*    S549 - SML CARTON PACKED DETAIL                              00080000
000900*---------------------------------------------------------------* 00090000
000910* CHANGED 11/15/2021    BY JIM HUNTER      WR: CHG0263968         00091057
000920* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00092058
000930* MAKING THE CALL DYNAMIC VS STATIC.                              00093058
000931*                                                                 00093159
000932* CHANGED 01/09/2023    BY JEAN KURK       WR: CHG0278099         00093260
000933* CHANGE CALL OF DPKCS030 TO BE DYNAMIC                           00093360
000940*---------------------------------------------------------------* 00094058
001000 ENVIRONMENT DIVISION.                                            00100000
001100 DATA DIVISION.                                                   00110000
001200                                                                  00120000
001300 WORKING-STORAGE SECTION.                                         00130000
001400 01  DK-DB2-KEYS.                                                 00140000
001500     05  DK-SHIPT-UNT-ID                PIC S9(18) COMP-3.        00150000
001600     05  DK-PO-NBR                      PIC  Z(08) VALUE ZERO.    00160025
001700     05  DK-TRN-NBR                     PIC  Z(09) VALUE ZERO.    00170044
001800     05  DK-UPC-NBR                     PIC  9(15) VALUE ZERO.    00180019
001900     05  DK-UPC-NBR-HOLD                PIC  9(15) VALUE ZERO.    00190019
002000     05  DK-RCVR                        PIC  9(04) VALUE ZERO.    00200060
002100     05  DK-KOHLS-BARCODE.                                        00210000
002200         10   FILLER                    PIC X(02)  VALUE '00'.    00220000
002300         10   DK-KOHLS-18               PIC X(18)  VALUE SPACES.  00230000
002400         10   FILLER                    PIC X(02)  VALUE SPACES.  00240000
002500     05  DK-KOHLS-BRCDE REDEFINES DK-KOHLS-BARCODE                00250000
002600                                        PIC X(22).                00260000
002700                                                                  00270000
002800 01  PC-PROGRAM-CONSTANTS.                                        00280000
002900     05  PC-CURRENT-MAP-NAME       PIC  X(08)  VALUE 'SU549A  '.  00290000
003000     05  PC-CURRENT-MAPSET-NAME    PIC  X(08)  VALUE 'SUKM549'.   00300000
003100     05  PC-CURRENT-PROGRAM-NAME   PIC  X(08)  VALUE 'SUKCS549'.  00310000
003200     05  PC-LIST-QUEUE-SEQ         PIC  9(01)  VALUE 1.           00320000
003300     05  PC-SEL-QUEUE-SEQ          PIC  9(01)  VALUE 2.           00330000
003400     05  PC-CRIT-SPEC-FORMAT       PIC  X(01)  VALUE '1'.         00340000
003500     05  PC-LIST-FORMAT            PIC  X(01)  VALUE '2'.         00350000
003600     05  PC-ITEMS-PER-PANEL        PIC S9(04)  VALUE +10          00360000
003700                                               COMP SYNC.         00370000
003800     05  PC-MAX-BLOCKS-IN-ARRAY    PIC S9(04)  VALUE +2           00380000
003900                                               COMP SYNC.         00390000
004000     05  PC-MAX-ITEMS              PIC S9(09)  VALUE +1000000     00400000
004100                                               COMP-3.            00410000
004200     05  PC-MSG-NUMBER-LENGTH      PIC S9(04)  VALUE +5           00420000
004300                                               COMP SYNC.         00430000
004400     05  PC-MAX-RETRIES            PIC S9(03)  VALUE 3            00440000
004500                                               COMP-3.            00450000
004600     05  PC-INQ                    PIC  X(03)  VALUE 'INQ'.       00460000
004700     05  PC-UPD                    PIC  X(03)  VALUE 'UPD'.       00470000
004800     05  PC-DEL                    PIC  X(03)  VALUE 'DEL'.       00480000
004900     05  PC-ERR                    PIC  X(03)  VALUE 'ERR'.       00490000
005000     05  PC-SLASH                  PIC  X(01)  VALUE '/'.         00500000
005100     05  PC-ZERO                   PIC S9(04)  VALUE ZEROES       00510000
005200                                               COMP.              00520000
005300     05  PC-01                     PIC  X(02)  VALUE '01'.        00530000
005400     05  PC-PO                     PIC  X(02)  VALUE 'PO'.        00540000
005500     05  PC-SH                     PIC  X(02)  VALUE 'SH'.        00550000
005600     05  PC-A                      PIC  X(01)  VALUE 'A'.         00560000
005700     05  PC-D                      PIC  X(01)  VALUE 'D'.         00570000
005800     05  PC-S                      PIC  X(01)  VALUE 'S'.         00580000
005900     05  PC-I                      PIC  X(01)  VALUE 'I'.         00590000
006000     05  PC-SHON                   PIC  X(04)  VALUE 'SHON'.      00600000
006100     05  PC-SHOF                   PIC  X(04)  VALUE 'SHOF'.      00610000
006200*                                                                 00620000
006300     05  PC-PCKRF743           PIC  X(15) VALUE 'TRAILER LOG-IN '.00630000
006400     05  PC-PCKRF870           PIC  X(15) VALUE 'OPEN TRAILER'.   00640000
006500     05  PC-PCKRF872           PIC  X(15) VALUE 'SIGN ON TRAILER'.00650000
006600     05  PC-PCKRF874           PIC  X(15) VALUE 'DIVERT BEG/END'. 00660000
006700     05  PC-PCKRF877           PIC  X(15) VALUE 'CLOSE TRAILER'.  00670000
006800     05  PC-PCKRF878           PIC  X(15) VALUE 'SIGN ON TRAILER'.00680000
006900     05  PC-PCKRF879           PIC  X(15) VALUE 'SCAN ON/OFF CTN'.00690000
007000     05  PC-PCKRF898           PIC  X(15) VALUE 'SIGN ON TRAILER'.00700000
007100                                                                  00710000
007200*----------------------------------------------------------------*00720000
007300*  SYSTEM MESSAGES                                               *00730000
007400*----------------------------------------------------------------*00740000
007500*   00005 = INVALID VALUE                                        *00750000
007600*   00008 = MUST BE NUMERIC                                      *00760000
007700*   00050 - NO LIST ITEMS WERE FOUND FOR THE CRITERIA SPECIFIED  *00770000
007800*   00051 - NO END OF RANGE HAS BEEN SPECIFIED                   *00780000
007900*   00052 - END OF RANGE PRECEDES START OF RANGE                 *00790000
008000*   00053 - NO START OF RANGE HAS BEEN SPECIFIED                 *00800000
008100*   00054 - ONLY ONE START OF RANGE INDICATOR MAY BE SPECIFIED   *00810000
008200*   00055 - ONLY ONE END OF RANGE INDICATOR MAY BE SPECIFIED     *00820000
008300*   00057 - A LIST ITEM MUST BE SELECTED FOR THIS FUNCTION       *00830000
008400*   00069 - TOP OF LIST                                          *00840000
008500*   00070 - BOTTOM OF LIST                                       *00850000
008600*   00101 - VALUE MUST BE > ZERO AND  < 1,000,000                *00860000
008700*   00551 - WAIT 15 SECONDS;RETRY FUNCTION AGAIN; IF UNSUCCESSFUL*00870000
008800*   00279 - MORE ITEMS TO DISPLAY                                *00880000
008900*   00743 - TRIP DOES NOT EXIST                                  *00890000
009000*   00840 - YOU ARE NOT AUTHORIZED TO VIEW THIS DATA             *00900000
009100*   00984 - DATABASE IS BUSY, TRY AGAIN IN A FEW MINUTES         *00910000
009200*   02227 = APPLICATION UNAVAILABLE AT THIS TIME                 *00920000
009300*   02792 = ENDING CUTOFF ALREADY EXISTS FOR TRLR-BEGIN CUTOFF NE*00930000
009400*   02793 = CARTON IS ALREADY LOADED ONTO A TRAILER.             *00940000
009500*   02796 = END CUTOFF ASSIGNMENT SUCCESSFUL.                    *00950000
009600*   02799 = END CARTON DIVERT TIME MUST BE GREATER THAN BEGIN CAR*00960000
009700*   99901 = INVALID COMMAND WAS ENTERED                          *00970000
009800*----------------------------------------------------------------*00980000
009900     05  PC-TSYMSG-NUMBERS.                                       00990000
010000         10  PC-TSYMSG-00005            PIC  9(05)  VALUE 00005.  01000000
010100         10  PC-TSYMSG-00008            PIC  9(05)  VALUE 00008.  01010000
010200         10  PC-TSYMSG-00050            PIC  9(05)  VALUE 00050.  01020000
010300         10  PC-TSYMSG-00051            PIC  9(05)  VALUE 00051.  01030000
010400         10  PC-TSYMSG-00052            PIC  9(05)  VALUE 00052.  01040000
010500         10  PC-TSYMSG-00053            PIC  9(05)  VALUE 00053.  01050000
010600         10  PC-TSYMSG-00054            PIC  9(05)  VALUE 00054.  01060000
010700         10  PC-TSYMSG-00055            PIC  9(05)  VALUE 00055.  01070000
010800         10  PC-TSYMSG-00057            PIC  9(05)  VALUE 00057.  01080000
010900         10  PC-TSYMSG-00069            PIC  9(05)  VALUE 00069.  01090000
011000         10  PC-TSYMSG-00070            PIC  9(05)  VALUE 00070.  01100000
011100         10  PC-TSYMSG-00101            PIC  9(05)  VALUE 00101.  01110000
011200         10  PC-TSYMSG-00279            PIC  9(05)  VALUE 00279.  01120000
011300         10  PC-TSYMSG-00551            PIC  9(05)  VALUE 00551.  01130000
011400         10  PC-TSYMSG-00743            PIC  9(05)  VALUE 00743.  01140000
011500         10  PC-TSYMSG-00746            PIC  9(05)  VALUE 00746.  01150000
011600         10  PC-TSYMSG-01563            PIC  9(05)  VALUE 01563.  01160000
011700         10  PC-TSYMSG-00840            PIC  9(05)  VALUE 00840.  01170000
011800         10  PC-TSYMSG-00984            PIC  9(05)  VALUE 00984.  01180000
011900         10  PC-TSYMSG-02227            PIC  9(05)  VALUE 02227.  01190000
012000         10  PC-TSYMSG-02792            PIC  9(05)  VALUE 02792.  01200000
012100         10  PC-TSYMSG-02793            PIC  9(05)  VALUE 02793.  01210000
012200         10  PC-TSYMSG-02796            PIC  9(05)  VALUE 02796.  01220000
012300         10  PC-TSYMSG-02799            PIC  9(05)  VALUE 02799.  01230000
012400         10  PC-TSYMSG-99901            PIC  9(05)  VALUE 99901.  01240000
012500*                                                                 01250000
012600 01  PS-PROGRAM-SWITCHES.                                         01260000
012700     05  PS-BLOCK-ERROR-SW              PIC  X(01)  VALUE 'Y'.    01270000
012800         88  PS-NO-BLOCK-ERROR                      VALUE 'Y'.    01280000
012900         88  PS-BLOCK-ERROR                         VALUE 'N'.    01290000
013000     05  PS-ERROR-SW                    PIC  X(01)  VALUE 'Y'.    01300000
013100         88  PS-NO-ERROR                            VALUE 'Y'.    01310000
013200         88  PS-ERROR                               VALUE 'N'.    01320000
013300     05  PS-SOFT-ABORT-ERROR-SW         PIC  X(01)  VALUE 'N'.    01330000
013400         88  PS-SOFT-ABORT-ERROR                    VALUE 'Y'.    01340000
013500         88  PS-NO-SOFT-ABORT-ERROR                 VALUE 'N'.    01350000
013600     05  PS-COMMAREA-SW                 PIC  X(01)  VALUE 'N'.    01360000
013700         88  PS-COMMAREA-VALID                      VALUE 'Y'.    01370000
013800         88  PS-COMMAREA-NOT-VALID                  VALUE 'N'.    01380000
013900     05  PS-DONE-SW                     PIC  X(01)  VALUE 'N'.    01390000
014000         88  PS-DONE                                VALUE 'Y'.    01400000
014100         88  PS-NOT-DONE                            VALUE 'N'.    01410000
014200     05  PS-LIST-END-SW                 PIC  X(01)  VALUE 'N'.    01420000
014300         88  PS-LIST-END                            VALUE 'Y'.    01430000
014400         88  PS-NO-LIST-END                         VALUE 'N'.    01440000
014500     05  PS-ACCESS-SW                   PIC  X(01)  VALUE 'N'.    01450000
014600         88  PS-ACCESS-ALLOWED                      VALUE 'Y'.    01460000
014700         88  PS-ACCESS-NOT-ALLOWED                  VALUE 'N'.    01470000
014800     05  PS-TRIP-OPEN-SW                PIC  X(01)  VALUE ' '.    01480000
014900         88  PS-TRIP-OPEN                           VALUE 'Y'.    01490000
015000         88  PS-TRIP-NOT-OPEN                       VALUE 'N'.    01500000
015100*                                                                 01510000
015200 01  PV-PROGRAM-VARIABLES.                                        01520000
015300     05  PV-DISPLAY-PARENT               PIC  9(18)  VALUE  0.    01530028
015400     05  PV-RACF-ERROR-CODE              PIC  9(04) VALUE ZEROES. 01540000
015500     05  PV-ORIGINAL-BLOCK               PIC S9(04)  VALUE +0     01550000
015600                                                     COMP SYNC.   01560000
015700     05  PV-ITEMS-HOLD                   PIC S9(03)  COMP-3.      01570000
015800     05  PV-ITEMS-DIFF                   PIC S9(03)  COMP-3.      01580000
015900     05  PV-CICS-RESPONSE               PIC S9(08)  VALUE ZEROES  01590000
016000                                        COMP SYNC.                01600000
016100     05  PV-SUB                         PIC S9(04)  VALUE +0      01610000
016200                                                    COMP SYNC.    01620000
016300     05  PV-REMAINDER                   PIC S9(04)  VALUE +0      01630000
016400                                                    COMP SYNC.    01640000
016500     05  PV-READ-COUNT                  PIC S9(09)  VALUE +0      01650000
016600                                                    COMP-3.       01660000
016700     05  PV-ITEMS-PROCESSED             PIC S9(09)  VALUE +0      01670000
016800                                                    COMP-3.       01680000
016900     05  PV-HOLD-SELECTED-ITEMS         PIC S9(09)  VALUE +0      01690000
017000                                                    COMP-3.       01700000
017100     05  PV-ITEM-IN-USE                 PIC S9(09)  VALUE +0      01710000
017200                                                    COMP-3.       01720000
017300     05  PV-TOP-ITEM                    PIC S9(09)  VALUE +0      01730000
017400                                                    COMP-3.       01740000
017500     05  PV-BOTTOM-ITEM                 PIC S9(09)  VALUE +0      01750000
017600                                                    COMP-3.       01760000
017700     05  PV-TEMP-BLOCK-NUMBER           PIC S9(09)  VALUE +0      01770000
017800                                                    COMP-3.       01780000
017900     05  PV-BLOCK-NUMBER                PIC S9(04)  VALUE +0      01790000
018000                                                    COMP SYNC.    01800000
018100     05  PV-CICS-RESP                   PIC S9(04)  VALUE +0      01810000
018200                                                    COMP SYNC.    01820000
018300     05  PV-ITEM                        PIC S9(04)  VALUE +0      01830000
018400                                                    COMP SYNC.    01840000
018500     05  PV-SEL-QUEUE-ITEM              PIC S9(04)  VALUE +0      01850000
018600                                                    COMP SYNC.    01860000
018700     05  PV-SAVE-ITEM                   PIC S9(04)  VALUE +0      01870000
018800                                                    COMP SYNC.    01880000
018900     05  PV-HIGHEST-BLOCK-WRITTEN       PIC S9(04)  VALUE +0      01890000
019000                                                    COMP SYNC.    01900000
019100     05  PV-LIST-ITEM-NUMBER            PIC S9(04)  VALUE +0      01910000
019200                                                    COMP SYNC.    01920000
019300     05  PV-FIRST-BLOCK-IN-ARRAY        PIC S9(04)  VALUE +0      01930000
019400                                                    COMP SYNC.    01940000
019500     05  PV-NEXT-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      01950000
019600                                                    COMP SYNC.    01960000
019700     05  PV-PREV-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      01970000
019800                                                    COMP SYNC.    01980000
019900     05  PV-FIRST-BLOCK-IN-RANGE        PIC S9(04)  VALUE +0      01990000
020000                                                    COMP SYNC.    02000000
020100     05  PV-LAST-BLOCK-IN-RANGE         PIC S9(04)  VALUE +0      02010000
020200                                                    COMP SYNC.    02020000
020300     05  PV-START-OF-SELECTED-RANGE     PIC S9(04)  VALUE +0      02030000
020400                                                    COMP SYNC.    02040000
020500     05  PV-END-OF-SELECTED-RANGE       PIC S9(04)  VALUE +0      02050000
020600                                                    COMP SYNC.    02060000
020700     05  PV-SQL-SUB                     PIC S9(04)  VALUE +0      02070000
020800                                                    COMP SYNC.    02080000
020900     05  PV-RETRY-COUNTER               PIC S9(04)  VALUE +0      02090000
021000                                                    COMP SYNC.    02100000
021100     05  PV-NULL-IND-1                  PIC S9(04)  VALUE +0      02110000
021200                                                    COMP.         02120000
021300     05  PV-NULL-IND-2                  PIC S9(04)  VALUE +0      02130000
021400                                                    COMP.         02140000
021500     05  PV-NULL-IND-3                  PIC S9(04)  VALUE +0      02150000
021600                                                    COMP.         02160000
021700     05  PV-SOFT-ABORT-MSG.                                       02170000
021800         10  FILLER            PIC X(12) VALUE ' SUKCS549 - '.    02180000
021900         10  FILLER            PIC X(09) VALUE 'SQLCODE: '.       02190000
022000         10  PV-SOFT-SQLCODE   PIC ZZZZZZZZ9-.                    02200000
022100         10  FILLER            PIC X(12) VALUE ' PARAGRAPH: '.    02210000
022200         10  PV-SOFT-PARAGRAPH PIC X(30).                         02220000
022300     05  PV-COMMAREA-LENGTH              PIC S9(04)  VALUE +0     02230000
022400                                                     COMP SYNC.   02240000
022500     05  PV-CICS-MSG-AREA                PIC  X(80)  VALUE SPACE. 02250000
022600     05  PV-CICS-MSG-AREA2               PIC  X(100) VALUE SPACE. 02260000
022700     05  PV-CICS-MSG-HOLD.                                        02270000
022800         10  FILLER                      PIC  X(01)  VALUE SPACE. 02280000
022900         10  PV-CICS-MSG-DATA            PIC  X(79)  VALUE SPACE. 02290000
023000     05  PV-CICS-MSG-HOLD2.                                       02300000
023100         10  FILLER                      PIC  X(01)  VALUE SPACE. 02310000
023200         10  PV-CICS-MSG-DATA2           PIC  X(99)  VALUE SPACE. 02320000
023300                                                                  02330000
023400     05  PV-TMST                 PIC X(26)   VALUE SPACES.        02340000
023500     05  PV-TMST-R REDEFINES  PV-TMST.                            02350000
023600         10   PV-TMST-DATE.                                       02360000
023700             15   PV-TMST-CCYY          PIC X(04).                02370000
023800             15   FILLER                PIC X(01).                02380000
023900             15   PV-TMST-MM            PIC X(02).                02390000
024000             15   FILLER                PIC X(01).                02400000
024100             15   PV-TMST-DD            PIC X(02).                02410000
024200         10   FILLER                    PIC X(01).                02420000
024300         10   PV-TMST-TIME.                                       02430000
024400             15   PV-TMST-HRS           PIC X(02).                02440000
024500             15   FILLER                PIC X(01).                02450000
024600             15   PV-TMST-MIN           PIC X(02).                02460000
024700         10   FILLER                    PIC X(01).                02470000
024800         10   PV-TMST-SEC               PIC X(02).                02480000
024900         10   FILLER                    PIC X(07).                02490000
025000     05  PV-FROM-TMST.                                            02500000
025100         10   PV-FROM-YY    PIC X(04)  VALUE ZEROES.              02510000
025200         10   FILLER        PIC X(01)  VALUE '-'.                 02520000
025300         10   PV-FROM-MM    PIC X(02)  VALUE ZEROES.              02530000
025400         10   FILLER        PIC X(01)  VALUE '-'.                 02540000
025500         10   PV-FROM-DD    PIC X(02)  VALUE ZEROES.              02550000
025600         10   FILLER        PIC X(16)  VALUE '-00.00.00.000000'.  02560000
025700     05  PV-TO-TMST.                                              02570000
025800         10   PV-TO-YY      PIC X(04)  VALUE ZEROES.              02580000
025900         10   FILLER        PIC X(01)  VALUE '-'.                 02590000
026000         10   PV-TO-MM      PIC X(02)  VALUE ZEROES.              02600000
026100         10   FILLER        PIC X(01)  VALUE '-'.                 02610000
026200         10   PV-TO-DD      PIC X(02)  VALUE ZEROES.              02620000
026300         10   FILLER        PIC X(16)  VALUE '-23.59.59.999999'.  02630000
026400     05  PV-DATE-DISPLAY.                                         02640000
026500         10   PV-DISPLAY-MM             PIC X(02)   VALUE SPACES. 02650000
026600         10   PV-SLASH-1                PIC X(01)   VALUE '-'.    02660000
026700         10   PV-DISPLAY-DD             PIC X(02)   VALUE SPACES. 02670000
026800         10   PV-SLASH-2                PIC X(01)   VALUE '-'.    02680000
026900         10   PV-DISPLAY-CCYY           PIC X(04)   VALUE SPACES. 02690000
027000     05  PV-TIME-DISPLAY.                                         02700000
027100         10   PV-AT                     PIC X(03)   VALUE SPACES. 02710000
027200         10   PV-DISPLAY-HRS            PIC X(02)   VALUE SPACES. 02720000
027300         10   PV-SEMICOLON-1            PIC X(01)   VALUE SPACES. 02730000
027400         10   PV-DISPLAY-MIN            PIC X(02)   VALUE SPACES. 02740000
027500         10   PV-SEMICOLON-2            PIC X(01)   VALUE SPACES. 02750000
027600         10   PV-DISPLAY-SEC            PIC X(02)   VALUE SPACES. 02760000
027700     05  PV-DATE-TIME.                                            02770000
027800         10   PV-DT-CC             PIC X(02)  VALUE '20'.         02780000
027900         10   PV-DT-YY             PIC X(02)  VALUE ZEROES.       02790000
028000         10   FILLER               PIC X(01)  VALUE '-'.          02800000
028100         10   PV-DT-MM             PIC X(02)  VALUE ZEROES.       02810000
028200         10   FILLER               PIC X(01)  VALUE '-'.          02820000
028300         10   PV-DT-DD             PIC X(02)  VALUE ZEROES.       02830000
028400         10   FILLER               PIC X(01)  VALUE '-'.          02840000
028500         10   PV-DT-HRS            PIC X(02)   VALUE SPACES.      02850000
028600         10   FILLER               PIC X(01)   VALUE '.'.         02860000
028700         10   PV-DT-MIN            PIC X(02)   VALUE SPACES.      02870000
028800         10   FILLER               PIC X(01)   VALUE '.'.         02880000
028900         10   PV-DT-SEC            PIC X(09)   VALUE '59.999999'. 02890000
029000     05  PV-CREATE-DATE                  PIC  X(08) VALUE SPACES. 02900000
029100     05  PV-USA-DATE                     PIC  X(10) VALUE SPACES. 02910000
029200     05  PV-JIS-TIME                     PIC  X(05) VALUE SPACES. 02920000
029300     05  PV-SELECT-LIST-SEQ              PIC  X(01) VALUE SPACES. 02930000
029400     05  PV-NBR-ITEMS                    PIC  9(05) VALUE ZEROES. 02940000
029500     05  PV-SEL-TERM-ID                  PIC  X(04).              02950000
029600     05  PV-SEL-TASK-NUMBER              PIC  9(05).              02960000
029700     05  PV-SEL-SEQ                      PIC  9(01).              02970000
029800     05  PV-REC-TYPE                     PIC  X(03).              02980000
029900                                                                  02990000
030000******************************************************************03000000
030100**  THIS IS THE LAYOUT FOR THE LIST ITEMS TEMP STORAGE QUEUE.   **03010000
030200**  THIS MUST BE THE EXACT SAME FORMAT A BLOCK IN THE           **03020000
030300**  APPLICATION-SPECIFIC COMMAREA.                              **03030000
030400******************************************************************03040000
030500 01  LQW-LIST-QUEUE-WORK-AREA.                                    03050000
030600     05  LQW-BLOCK-MODIFIED             PIC  X(01)  VALUE SPACE.  03060000
030700     05  LQW-ITEM-ENTRIES               OCCURS 10 TIMES           03070035
030800                                        INDEXED BY LQW-IDX.       03080000
030900         10  LQW-LIST-ITEM-NUMBER       PIC S9(09)  COMP-3.       03090000
031000         10  LQW-TEMP-SELECTED-SW       PIC  X(01).               03100000
031100         10  LQW-SELECTED-SW            PIC  X(01).               03110000
031200             88  LQW-SELECT                         VALUE 'S'.    03120000
031300             88  LQW-DESELECT                       VALUE ' '.    03130000
031400         10  LQW-ACTION               PIC  X(03).                 03140000
031500             88  LQW-DEL                            VALUE 'DEL'.  03150000
031600             88  LQW-INQ                            VALUE 'INQ'.  03160000
031700             88  LQW-UPD                            VALUE 'UPD'.  03170000
031800             88  LQW-ERR                            VALUE 'ERR'.  03180000
031900         10  LQW-REC-TYPE             PIC  X(01).                 03190013
032000         10  LQW-PORCVR.                                          03200000
032100             15  LQW-PO               PIC 9(08).                  03210000
032200             15  LQW-PO-DASH          PIC X(01).                  03220000
032300             15  LQW-RCVR             PIC 9(04).                  03230060
032400         10  LQW-TRN                  PIC X(13).                  03240060
032500         10  LQW-LINE                 PIC 9(03).                  03250060
032600         10  LQW-SKU                  PIC 9(08).                  03260000
032700         10  LQW-UPC                  PIC 9(15).                  03270000
032800         10  LQW-SHIPD-QTY            PIC 9(05).                  03280000
032900         10  LQW-PACKED-QTY           PIC S9(05).                 03290000
033000         10  LQW-MOD                  PIC X(03).                  03300000
033100         10  LQW-USERID               PIC X(07).                  03310000
033200         10  LQW-DATE                 PIC X(05).                  03320000
033300         10  LQW-TIME                 PIC X(05).                  03330000
033400                                                                  03340000
033500*---------------------------------------------------------------* 03350000
033600* SELECTON QUEUE LAYOUT                                         * 03360000
033700*---------------------------------------------------------------* 03370000
033800     COPY SUWS010.                                                03380000
033900                                                                  03390000
034000******************************************************************03400000
034100* COMMAREA FOR PCKUT713 - CARTON STATUS MODULE                    03410000
034200******************************************************************03420000
034300     COPY PCWS046.                                                03430000
034400                                                                  03440000
034500*---------------------------------------------------------------* 03450000
034600*    MAP LAYOUT                                                 * 03460000
034700*---------------------------------------------------------------* 03470000
034800     COPY SUKM549.                                                03480000
034900*                                                                 03490000
035000 01  MR-OCCURS-LAYOUT                   REDEFINES  SU549AO.       03500000
035100     05  FILLER                         PIC X(272).               03510042
035200     05  MR-SCROLL-AREA                 OCCURS 10 TIMES.          03520000
035300         10  MR-PORCVRL                 PIC S9(04) COMP.          03530008
035400         10  MR-PORCVRA                 PIC  X(01).               03540000
035500         10  MR-PORCVRC                 PIC  X(01).               03550000
035600         10  MR-PORCVRH                 PIC  X(01).               03560000
035700         10  MR-PORCVR.                                           03570000
035800             15  MR-PO                  PIC X(08).                03580003
035900             15  MR-PO-DASH             PIC X(01).                03590000
036000             15  MR-RCVR                PIC X(04).                03600060
036100                                                                  03610000
036200         10  MR-LINEL                   PIC S9(04) COMP.          03620000
036300         10  MR-LINEA                   PIC  X(01).               03630000
036400         10  MR-LINEC                   PIC  X(01).               03640000
036500         10  MR-LINEH                   PIC  X(01).               03650000
036600         10  MR-LINE                    PIC  9(03) BLANK ZERO.    03660060
036700                                                                  03670000
036800                                                                  03680000
036900         10  MR-SKUL                    PIC S9(04) COMP.          03690000
037000         10  MR-SKUA                    PIC  X(01).               03700000
037100         10  MR-SKUC                    PIC  X(01).               03710000
037200         10  MR-SKUH                    PIC  X(01).               03720000
037300         10  MR-SKU                     PIC  9(08) BLANK ZERO.    03730000
037400                                                                  03740000
037500                                                                  03750000
037600         10  MR-UPCL                    PIC S9(04) COMP.          03760000
037700         10  MR-UPCA                    PIC  X(01).               03770000
037800         10  MR-UPCC                    PIC  X(01).               03780000
037900         10  MR-UPCH                    PIC  X(01).               03790000
038000         10  MR-UPC                     PIC  9(15) BLANK ZERO.    03800000
038100                                                                  03810000
038200                                                                  03820000
038300         10  MR-SHIPD-QTYL              PIC S9(04) COMP.          03830000
038400         10  MR-SHIPD-QTYA              PIC  X(01).               03840000
038500         10  MR-SHIPD-QTYC              PIC  X(01).               03850000
038600         10  MR-SHIPD-QTYH              PIC  X(01).               03860000
038700         10  MR-SHIPD-QTY-X             PIC  X(05).               03870000
038800         10  FILLER REDEFINES MR-SHIPD-QTY-X.                     03880000
038900             15  MR-SHIPD-QTY           PIC  ZZZZ9.               03890000
039000                                                                  03900000
039100                                                                  03910000
039200         10  MR-PACKED-QTYL             PIC S9(04) COMP.          03920000
039300         10  MR-PACKED-QTYA             PIC  X(01).               03930000
039400         10  MR-PACKED-QTYC             PIC  X(01).               03940000
039500         10  MR-PACKED-QTYH             PIC  X(01).               03950000
039600         10  MR-PACKED-QTY              PIC  Z(05)-.              03960000
039700                                                                  03970000
039800         10  MR-MODL                    PIC S9(04) COMP.          03980000
039900         10  MR-MODA                    PIC  X(01).               03990000
040000         10  MR-MODC                    PIC  X(01).               04000000
040100         10  MR-MODH                    PIC  X(01).               04010000
040200         10  MR-MOD                     PIC  X(03).               04020000
040300                                                                  04030000
040400         10  MR-USERIDL                 PIC S9(04) COMP.          04040000
040500         10  MR-USERIDA                 PIC  X(01).               04050000
040600         10  MR-USERIDC                 PIC  X(01).               04060000
040700         10  MR-USERIDH                 PIC  X(01).               04070000
040800         10  MR-USERID                  PIC  X(07).               04080000
040900                                                                  04090000
041000         10  MR-DATEL                   PIC S9(04) COMP.          04100000
041100         10  MR-DATEA                   PIC  X(01).               04110000
041200         10  MR-DATEC                   PIC  X(01).               04120000
041300         10  MR-DATEH                   PIC  X(01).               04130000
041400         10  MR-DATE                    PIC  X(05).               04140000
041500                                                                  04150000
041600         10  MR-TIMEL                   PIC S9(04) COMP.          04160000
041700         10  MR-TIMEA                   PIC  X(01).               04170000
041800         10  MR-TIMEC                   PIC  X(01).               04180000
041900         10  MR-TIMEH                   PIC  X(01).               04190000
042000         10  MR-TIME                    PIC  X(05).               04200000
042100                                                                  04210000
042200*    DOMAIN ITEN MODULE COPYBOOK.                               * 04220000
042300     COPY XLWS001.                                                04230000
042400/                                                                 04240000
042500*    ATTRIBUTE SETTINGS COPYBOOK.                               * 04250000
042600     COPY DPWS015.                                                04260000
042700                                                                  04270000
042800*    FUNCTION KEYS COPYBOOK.                                    * 04280000
042900     COPY DPWS016.                                                04290000
043000                                                                  04300000
043100**  SECURITY SUBROUTINE PARAMETERS                                04310000
043200     COPY DPWS008.                                                04320000
043300                                                                  04330000
043400*    NUMERIC EDIT LAYOUT.                                       * 04340000
043500     COPY DPWS010I.                                               04350000
043600                                                                  04360000
043700*    PARAMETERS FOR CALLING CICS ARCHITECTURE API               * 04370059
043800     COPY DPWS030.                                                04380000
043810     COPY DPWS930.                                                04381060
043900                                                                  04390000
044000*    STANDARD COMMAREA.                                         * 04400000
044100     COPY DPWS020.                                                04410000
044200     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                04420000
044300                                                                  04430000
044400*---------------------------------------------------------------* 04440000
044500* INTER-APPLICATION COMMAREA.                                   * 04450000
044600*   SUWS008 - IS THE INPUT LAYOUT WHEN COMING FROM THE CRIT.    * 04460000
044700*             SPEC SCREEN.                                      * 04470000
044800*   SUWS009 - IS THE OUTPUT LAYOUT THAT WILL BE PASSED FROM     * 04480000
044900*             THIS LIST PROGRAMMING FOR A LOCAL-GO FUNCTION.    * 04490000
045000*---------------------------------------------------------------* 04500000
045100                                                                  04510000
045200         10  INTER-APPL-COMM-AREA       PIC X(200).               04520000
045300     COPY SUWS008.                                                04530000
045400     COPY SUWS009.                                                04540000
045500*  THIS IS THE APPLICATION-SPECIFIC COMMAREA.                   * 04550000
045600         10  ASC-SPECIFIC-COMMAREA.                               04560000
045700             15  ASC-OPER-UNT-ID             PIC  X(04).          04570000
045800             15  ASC-OPER-UNT-ID-N REDEFINES                      04580000
045900                     ASC-OPER-UNT-ID         PIC  9(04).          04590000
046000             15  ASC-SCAC                    PIC  X(04).          04600000
046100             15  ASC-MANUAL                  PIC  9(06).          04610000
046200             15  ASC-DIVERT                  PIC  9(06).          04620000
046300             15  ASC-TRLR-SRL-NBR            PIC  9(09).          04630000
046400             15  ASC-TRLR-STATUS             PIC  X(12).          04640000
046500             15  ASC-TRLR-ID                 PIC  X(12).          04650000
046600             15  ASC-OTBND-TRIP-ID           PIC  9(09).          04660000
046700             15  ASC-DOORSLOT                PIC  X(06).          04670000
046800             15  ASC-NUMBER                  PIC  X(06).          04680000
046900             15  ASC-DOOR-DESC               PIC  X(25).          04690000
047000             15  ASC-TOT-CARTON-QTY          PIC  9(06).          04700000
047100             15  ASC-DOOR-ID                 PIC  X(04).          04710000
047200             15  ASC-DOOR-TYPE               PIC  X(02).          04720000
047300             15  ASC-STR-NBR-X               PIC  X(04).          04730000
047400             15  ASC-STR-NBR-N REDEFINES ASC-STR-NBR-X.           04740000
047500                 20  ASC-STR-NBR             PIC  9(04).          04750000
047600             15  ASC-STATUS-DATE             PIC  X(10).          04760000
047700             15  ASC-STATUS-TIME             PIC  X(05).          04770000
047800             15  ASC-SHIPT-UNT-ID            PIC S9(18) COMP-3.   04780000
047900             15  ASC-STORE                   PIC S9(04) COMP.     04790000
048000             15  ASC-CRTN-STAT               PIC  X(19).          04800000
048100             15  ASC-CRTN-SRC                PIC  X(21).          04810000
048200             15  ASC-CRE-DATE                PIC  X(10).          04820000
048300             15  ASC-CRE-TIME                PIC  X(08).          04830000
048400             15  FILLER                      PIC  X(015).         04840000
048500*-----------------------------------------------------------------04850000
048600             15  ASC-BLK-SUB                  PIC S9(04) COMP     04860000
048700                                                         SYNC.    04870000
048800             15  ASC-ITEM-SUB                 PIC S9(04) COMP     04880000
048900                                                         SYNC.    04890000
049000             15  ASC-NUMBER-OF-ITEMS-READ     PIC S9(09) COMP-3.  04900000
049100             15  ASC-NUMBER-OF-SELECTED-ITEMS PIC S9(09) COMP-3.  04910000
049200             15  ASC-ITEMS-DISPLAYED          PIC S9(03) COMP-3.  04920000
049300             15  ASC-ITEM-AT-TOP-OF-PANEL     PIC S9(09) COMP-3.  04930000
049400             15  ASC-ITEM-AT-BOT-OF-PANEL     PIC S9(09) COMP-3.  04940000
049500             15  ASC-HIGHEST-BLOCK-WRITTEN    PIC S9(04) COMP     04950000
049600                                                         SYNC.    04960000
049700             15  ASC-START-OF-SELECTED-RANGE  PIC S9(09) COMP-3.  04970000
049800             15  ASC-END-OF-SELECTED-RANGE    PIC S9(09) COMP-3.  04980000
049900             15  ASC-ITEMS-LEFT-INDICATOR     PIC  X(01).         04990000
050000                 88  ASC-ITEMS-LEFT-ON-DB          VALUE 'Y'.     05000000
050100                 88  ASC-NO-ITEMS-LEFT-ON-DB       VALUE 'N'.     05010000
050200             15  ASC-TEMP-QUEUE-UPDATE-SW     PIC  X(01).         05020000
050300                 88  ASC-UPDATE-TSQ                VALUE 'Y'.     05030000
050400                 88  ASC-NO-TSQ-UPDATE             VALUE ' '.     05040000
050500             15  ASC-LIST-QUEUE-NAME.                             05050000
050600                 20  ASC-LIST-TERM-ID         PIC  X(04).         05060000
050700                 20  ASC-LIST-TASK-NUMBER     PIC S9(05) COMP-3.  05070000
050800                 20  ASC-LIST-SEQ             PIC  9(01).         05080000
050900                                                                  05090000
051000             15  ASC-START-ITEM-REQUEST.                          05100000
051100                 20  ASC-START-ITEM-REQUEST-N PIC  9(05).         05110000
051200                                                                  05120000
051300             15  ASC-SEL-SUB                  PIC S9(4) COMP.     05130000
051400             15  ASC-SEL-ITEM                 PIC S9(4) COMP.     05140000
051500             15  ASC-USE-SELECTION-QUEUE-IND  PIC  X(1).          05150000
051600                 88  ASC-USE-SELECTION-QUEUE           VALUE 'Y'. 05160000
051700             15  ASC-SEL-QUEUE-NAME.                              05170000
051800                 20  ASC-SEL-TERM-ID          PIC  X(04).         05180000
051900                 20  ASC-SEL-TASK-NUMBER      PIC S9(05) COMP-3.  05190000
052000                 20  ASC-SEL-SEQ              PIC  9(01).         05200000
052100             15  ASC-NUMBER-OF-TS-ITEMS       PIC S9(09) COMP-3.  05210000
052200                                                                  05220000
052300*-----------------------------------------------------------------05230000
052400             15  ASC-BLOCK-ENTRIES OCCURS 2 TIMES.                05240000
052500                 20  ASC-BLOCK-MODIFIED-SW           PIC  X(01).  05250000
052600                     88  ASC-BLOCK-NOT-MODIFIED      VALUE 'N'.   05260000
052700                     88  ASC-BLOCK-MODIFIED          VALUE 'Y'.   05270000
052800                                                                  05280000
052900                 20  ASC-ITEM-ARRAY.                              05290000
053000                     25  ASC-ITEM-ENTRIES OCCURS 10 TIMES.        05300000
053100                         30  ASC-LIST-ITEM-NUMBER                 05310000
053200                                                     PIC S9(09)   05320000
053300                                                     COMP-3.      05330000
053400                         30  ASC-TEMP-SELECTED-SW    PIC  X(01).  05340000
053500                             88  ASC-VALID-SELECT    VALUE ' '    05350000
053600                                                           'S'    05360000
053700                                                           'B'    05370000
053800                                                           'E'.   05380000
053900                             88  ASC-TEMP-NO-SELECT  VALUE ' '.   05390000
054000                             88  ASC-TEMP-SELECT     VALUE 'S'.   05400000
054100                             88  ASC-TEMP-BEGIN      VALUE 'B'.   05410000
054200                             88  ASC-TEMP-END        VALUE 'E'.   05420000
054300                         30  ASC-SELECTED-SW         PIC  X(01).  05430000
054400                             88  ASC-NO-SELECT       VALUE ' '.   05440000
054500                             88  ASC-SELECT          VALUE 'S'.   05450000
054600                             88  ASC-BEGIN           VALUE 'B'.   05460000
054700                             88  ASC-END             VALUE 'E'.   05470000
054800                         30  ASC-ACTION               PIC  X(03). 05480000
054900                         30  ASC-REC-TYPE             PIC  X(01). 05490012
055000                         30  ASC-PORCVR.                          05500012
055100                             35  ASC-PO       PIC X(08).          05510012
055200                             35  ASC-PO-DASH  PIC X(01).          05520012
055300                             35  ASC-RCVR     PIC X(04).          05530060
055400                         30  ASC-TRN-NBR      PIC X(13).          05540060
055500                         30  ASC-LINE         PIC 9(03).          05550060
055600                         30  ASC-SKU          PIC 9(08).          05560012
055700                         30  ASC-UPC          PIC 9(15).          05570012
055800                         30  ASC-SHIPD-QTY    PIC 9(05).          05580012
055900                         30  ASC-PACKED-QTY   PIC S9(05).         05590012
056000                         30  ASC-MOD.                             05600012
056100                             35 ASC-MOD-N     PIC 9(03).          05610012
056200                         30  ASC-USERID       PIC X(07).          05620012
056300                         30  ASC-DATE         PIC X(05).          05630012
056400                         30  ASC-TIME         PIC X(05).          05640012
056500                                                                  05650012
056600                                                                  05660012
056700*---------------------------------------------------------------* 05670012
056800*    ABEND PROCESSING COPYBOOK.                                 * 05680012
056900*---------------------------------------------------------------* 05690012
057000     COPY DPWS013.                                                05700012
057100                                                                  05710000
057200                                                                  05720000
057300*    SUT_PKD_UPC                                                  05730000
057400     EXEC SQL                                                     05740000
057500          INCLUDE SUT00025                                        05750000
057600     END-EXEC.                                                    05760000
057700                                                                  05770000
057800*    SUT_OTBND_CART                                               05780000
057900     EXEC SQL                                                     05790000
058000          INCLUDE SUT00024                                        05800000
058100     END-EXEC.                                                    05810000
058200                                                                  05820000
058300*    SUT_OTBND_UPC - OUTBOUND SHIPT UNT UPC TABLE                 05830000
058400     EXEC SQL                                                     05840000
058500          INCLUDE SUT00028                                        05850000
058600     END-EXEC.                                                    05860000
058700                                                                  05870000
058800*    OUTBOUND CARTON ADJUSTMENTS                                  05880000
058900     EXEC SQL                                                     05890000
059000          INCLUDE TSUQADJ                                         05900000
059100     END-EXEC.                                                    05910000
059200                                                                  05920000
059300*    STATUS CODE TABLE                                            05930000
059400     EXEC SQL                                                     05940000
059500          INCLUDE TSUOBSC                                         05950000
059600     END-EXEC.                                                    05960000
059700                                                                  05970000
059800*    PACKSLIPS                                                    05980000
059900     EXEC SQL                                                     05990000
060000          INCLUDE TPKSLIP                                         06000000
060100     END-EXEC.                                                    06010000
060200                                                                  06020000
060300*    OUTBOUND PACKSLIPS                                           06030000
060400     EXEC SQL                                                     06040000
060500          INCLUDE SUT00026                                        06050000
060600     END-EXEC.                                                    06060000
060700                                                                  06070000
060800*    FINACIAL ADJUSTMENT TABLE - SUT_FINCL_ADJ                    06080004
060900     EXEC SQL                                                     06090004
061000          INCLUDE SUT00030                                        06100004
061100     END-EXEC.                                                    06110004
061200                                                                  06120004
061300                                                                  06130000
061400     EXEC SQL                                                     06140000
061500         DECLARE CARTON-DETAIL-CSR CURSOR FOR                     06150000
061600                                                                  06160000
061700       SELECT                                                     06170000
061800             'A'                   AS REC_TYPE                    06180000
061900            , A.SHIPT_UNT_ID       AS SML                         06190000
062000            , A.TRN_NBR            AS PO                          06200000
062100            , A.RCVR_SEQ_NBR       AS RCVR                        06210000
062200            , A.TRN_LNE_NBR        AS LINE                        06220000
062300            , A.UPC_NBR            AS UPC                         06230000
062400            , A.SHPD_UNT_QTY                                      06240000
062500            , B.PKD_QTY            AS PQTY                        06250000
062600            , B.MODU_NBR           AS MODULE_NBR                  06260000
062700            , B.PKD_BY_USR_ID      AS USER                        06270000
062800            , SUBSTR( CHAR( DATE(B.PKD_TMST),USA), 1,5)           06280000
062900                                   AS TRAN_DATE                   06290000
063000            , SUBSTR( CHAR( TIME(B.PKD_TMST),JIS), 1,5)           06300000
063100                                   AS TRAN_TIME                   06310000
063200            , D.CART_SRC_CDE       AS CTN_SOURCE                  06320000
063300            , B.PKD_TMST           AS TRAN_TMST                   06330000
063400       FROM SUT_OTBND_UPC A                                       06340000
063500       ,    SUT_OTBND_PKD_UPC B                                   06350000
063600       ,    SUT_OTBND_CART    D                                   06360000
063700       WHERE                                                      06370000
063800                 A.SHIPT_UNT_ID           = :DK-SHIPT-UNT-ID      06380000
063900             AND A.SHIPT_UNT_ID           = B.SHIPT_UNT_ID        06390000
064000             AND A.SHIPT_UNT_ID           = D.SHIPT_UNT_ID        06400000
064100             AND A.TRN_NBR                = B.TRN_NBR             06410000
064200             AND A.RCVR_SEQ_NBR           = B.RCVR_SEQ_NBR        06420000
064300             AND A.TRN_LNE_NBR            = B.TRN_LNE_NBR         06430000
064400             AND A.UPC_NBR                = B.UPC_NBR             06440000
064500                                                                  06450000
064600         UNION                                                    06460000
064700                                                                  06470000
064800        SELECT                                                    06480000
064900              'B'                  AS REC_TYPE                    06490000
065000             , E.SHIPT_UNT_ID      AS SML                         06500002
065100             , E.TRN_NBR           AS PO                          06510000
065200             , E.RCVR_SEQ_NBR      AS RCVR                        06520000
065300             , E.TRN_LNE_NBR       AS LINE                        06530000
065400             , E.UPC_NBR           AS UPC                         06540000
065500             , E.SHPD_UNT_QTY      AS SQTY                        06550000
065600             , E.SHPD_UNT_QTY      AS PQTY                        06560000
065700             , 0                   AS MODULE_NBR                  06570000
065800             , H.CRE_USR_ID        AS USER                        06580000
065900             , SUBSTR( CHAR (H.CRE_DTE,USA) ,1,5)                 06590000
066000                                   AS TRAN_DATE                   06600000
066100             , SUBSTR( CHAR ( H.CRE_TM,JIS), 1,5)                 06610000
066200                                   AS TRAN_TIME                   06620000
066300             , H.CART_SRC_CDE      AS CTN_SOURCE                  06630000
066400             , TIMESTAMP(CRE_DTE, CRE_TM)                         06640000
066500                                   AS TRAN_TMST                   06650000
066600        FROM   SUT_OTBND_UPC E                                    06660000
066700             , SUT_OTBND_CART H                                   06670000
066800         WHERE E.SHIPT_UNT_ID             = :DK-SHIPT-UNT-ID      06680000
066900                AND E.SHIPT_UNT_ID        = H.SHIPT_UNT_ID        06690000
067000                                                                  06700000
067100                AND NOT EXISTS                                    06710000
067200                    (SELECT *                                     06720000
067300                    FROM SUT_OTBND_UPC F                          06730000
067400                    ,    SUT_OTBND_PKD_UPC G                      06740000
067500                     WHERE E.SHIPT_UNT_ID = F.SHIPT_UNT_ID        06750000
067600                       AND E.TRN_NBR      = F.TRN_NBR             06760000
067700                       AND E.RCVR_SEQ_NBR = F.RCVR_SEQ_NBR        06770000
067800                       AND E.TRN_LNE_NBR  = F.TRN_LNE_NBR         06780000
067900                       AND E.UPC_NBR      = F.UPC_NBR             06790000
068000                       AND F.SHIPT_UNT_ID = G.SHIPT_UNT_ID        06800000
068100                       AND F.TRN_NBR      = G.TRN_NBR             06810000
068200                       AND F.RCVR_SEQ_NBR = G.RCVR_SEQ_NBR        06820000
068300                       AND F.TRN_LNE_NBR  = G.TRN_LNE_NBR         06830000
068400                       AND F.UPC_NBR      = G.UPC_NBR)            06840000
068500                                                                  06850000
068600                 UNION                                            06860000
068700                                                                  06870000
068800              SELECT                                              06880000
068900                    'C'            AS REC_TYPE                    06890000
069000                   , J.SHIPT_UNT_ID AS SML                        06900002
069100                   , 0             AS PO                          06910000
069200                   , 0             AS RCVR                        06920000
069300                   , 0             AS LINE                        06930000
069400                   , J.UPC_NBR     AS UPC                         06940000
069500                   , J.ADJ_AFT_QTY AS SQTY                        06950000
069600                   , J.ADJ_BEF_QTY AS PQTY                        06960000
069700                   , 0             AS MODULE_NBR                  06970000
069800                   , J.ADJ_USR_ID  AS USER                        06980000
069900                   , SUBSTR(CHAR(DATE(J.ADJ_TMST),USA),1,5)       06990000
070000                                   AS TRAN_DATE                   07000000
070100                   , SUBSTR(CHAR(TIME(J.ADJ_TMST),JIS),1,5)       07010000
070200                                   AS TRAN_TIME                   07020000
070300                   , 'ADJ'         AS CTN_SOURCE                  07030000
070400                   , J.ADJ_TMST    AS TRAN_TMST                   07040000
070500                                                                  07050000
070600                 FROM TSUQADJ J                                   07060000
070700             ,        SUT_FINCL_ADJ K                             07070023
070800                                                                  07080000
070900                WHERE J.SHIPT_UNT_ID      = :DK-SHIPT-UNT-ID      07090000
071000                  AND J.ADJ_AFT_QTY      <> J.ADJ_BEF_QTY         07100000
071100                  AND J.SHIPT_UNT_ID      = K.SHIPT_UNT_ID        07110023
071200                  AND J.FINCL_ADJ_ID      = K.FINCL_ADJ_ID        07120023
071300                  AND K.ADJ_ERR_CDE      IS NULL                  07130023
071400    UNION                                                         07140023
071500        SELECT                                                    07150023
071600             'D'            AS REC_TYPE                           07160023
071700             , L.SHIPT_UNT_ID AS SML                              07170023
071800            , 0             AS PO                                 07180023
071900            , 0             AS RCVR                               07190023
072000            , 0             AS LINE                               07200023
072100            , L.UPC_NBR     AS UPC                                07210023
072200            , L.ADJ_AFT_QTY AS SQTY                               07220023
072300            , L.ADJ_BEF_QTY AS PQTY                               07230023
072400            , 0             AS MODULE_NBR                         07240023
072500            , L.ADJ_USR_ID  AS USER                               07250023
072600            , SUBSTR(CHAR(DATE(L.ADJ_TMST),USA),1,5)              07260023
072700                            AS TRAN_DATE                          07270023
072800            , SUBSTR(CHAR(TIME(L.ADJ_TMST),JIS),1,5)              07280023
072900                            AS TRAN_TIME                          07290023
073000            , 'ADJ'         AS CTN_SOURCE                         07300023
073100            , L.ADJ_TMST    AS TRAN_TMST                          07310023
073200                                                                  07320023
073300          FROM TSUQADJ L                                          07330023
073400             , SUT_FINCL_ADJ M                                    07340023
073500                                                                  07350023
073600         WHERE L.SHIPT_UNT_ID      = :DK-SHIPT-UNT-ID             07360023
073700           AND L.ADJ_AFT_QTY      <> L.ADJ_BEF_QTY                07370023
073800           AND L.SHIPT_UNT_ID      = M.SHIPT_UNT_ID               07380023
073900           AND L.UPC_NBR           = M.UPC_NBR                    07390023
074000           AND M.FINCL_AFT_QTY    <> M.FINCL_BEF_QTY              07400025
074100           AND M.ADJ_ERR_CDE       > 0                            07410024
074200                                                                  07420000
074300                ORDER BY                                          07430000
074400                  UPC                                             07440018
074500                , REC_TYPE                                        07450000
074600                , PO                                              07460000
074700                , RCVR                                            07470000
074800                , LINE                                            07480000
074900                , TRAN_DATE                                       07490000
075000                , TRAN_TMST                                       07500000
075100                , PQTY                                            07510000
075200                , SML                                             07520000
075300     END-EXEC                                                     07530000
075400                                                                  07540000
075500*---------------------------------------------------------------* 07550000
075600*    DB2 AREA FOR COMMUNICATIONS                                * 07560000
075700*---------------------------------------------------------------* 07570000
075800     EXEC SQL                                                     07580000
075900          INCLUDE SQLCA                                           07590000
076000     END-EXEC.                                                    07600000
076100*-----------------------------------------------------------------07610000
076200 LINKAGE SECTION.                                                 07620000
076300                                                                  07630000
076400 01  DFHCOMMAREA.                                                 07640000
076500     05  FILLER                         OCCURS  1 TO 4072 TIMES   07650000
076600                                        DEPENDING ON EIBCALEN.    07660000
076700         10  FILLER                     PIC X.                    07670000
076800                                                                  07680000
076900                                                                  07690000
077000 PROCEDURE DIVISION.                                              07700000
077100******************************************************************07710000
077200**  THIS MODULE IS THE HIGHEST PROCESSING LEVEL IN THE PROGRAM. **07720000
077300**  FIRST, CALL THE CICS ARCHITECTURE API, PERFORM THE PROGRAM  **07730000
077400**  PROCESSING AND THEN CALL THE CICS ARCHITECTURE API TO EXIT. **07740000
077500******************************************************************07750000
077600 0000-MAIN-MODULE.                                                07760000
077700     INITIALIZE DP030-CICS-API-FIELDS.                            07770000
077800     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       07780000
077900     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          07790000
078000     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         07800000
078100     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       07810000
078200     MOVE LENGTH OF SU549AI        TO DP030-MAP-LENGTH (1).       07820000
078300     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     07830000
078400     PERFORM 0001-CALL-CICS-ARCH-API.                             07840000
078500*                                                                 07850000
078600     PERFORM 1000-CONTROL-PROCESSING                              07860000
078700*                                                                 07870000
078800     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     07880000
078900     PERFORM 0001-CALL-CICS-ARCH-API.                             07890000
079000                                                                  07900000
079100******************************************************************07910000
079200**  THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE   **07920000
079300**  AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.         **07930000
079400******************************************************************07940000
079500 0001-CALL-CICS-ARCH-API.                                         07950000
079600*    CALL 'DPKCS030' USING DFHEIBLK                               07960059
079610     CALL DP930-CICS-ARCH-API USING DFHEIBLK                      07961060
079700                           DFHCOMMAREA                            07970000
079800                           DP030-CICS-API-FIELDS                  07980000
079900                           DP020-STANDARD-COMMAREA                07990000
080000                           SU549AI.                               08000000
080100*                                                                 08010000
080200     IF  DP030-RC-CALL-SUCCESSFUL                                 08020000
080300         CONTINUE                                                 08030000
080400     ELSE                                                         08040000
080500         SET DP013-NO-ROLLBACK                                    08050000
080600             DP013-XCTL-DISPLAY-RESTART                           08060000
080700             DP013-CICS-ABEND      TO TRUE                        08070000
080800         MOVE '0001-CALL-CICS-ARCH-API' TO DP013-PARAGRAPH        08080000
080900*        MOVE 'CALL TO DPKCS030 NOT SUCCESSFUL, RETURN-CODE ON NEX08090059
081000*             'T LINE'             TO DP013-MESSAGE-TEXT (2)      08100059
081010         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O08101060
081020-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      08102059
081100         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      08110000
081200         PERFORM DP013-0000-PROCESS-ABEND                         08120000
081300     END-IF.                                                      08130000
081400                                                                  08140000
081500*----------------------------------------------------------------*08150000
081600* PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT      *08160000
081700* COURSE OF ACTION IS FOR THIS TRANSACTION.                      *08170000
081800*                                                                *08180000
081900* NOTE:  PV-TOP-ITEM IS THE ITEM THAT IS REQUESTED TO BE AT THE  *08190000
082000*  TOP OF THE PANEL.  MOVING ASC-ITEM-AT-TOP-OF-PANEL TO THIS    *08200000
082100*  MEANS THAT POSITION WITHIN THE LIST WILL NOT CHANGE -- THIS   *08210000
082200*  IS THE DEFAULT WHICH WILL BE OVERRIDDEN BY SCROLLING ACTIONS. *08220000
082300*----------------------------------------------------------------*08230000
082400 1000-CONTROL-PROCESSING.                                         08240000
082500                                                                  08250000
082600     EVALUATE TRUE                                                08260000
082700         WHEN DP020-NEXT-ACT-INITIAL                              08270000
082800             INITIALIZE ASC-SPECIFIC-COMMAREA                     08280000
082900             MOVE EIBTRMID         TO ASC-LIST-TERM-ID            08290000
083000                                      ASC-SEL-TERM-ID             08300000
083100             MOVE DP020-SRC-TASK-NUMBER TO ASC-LIST-TASK-NUMBER   08310000
083200                                           ASC-SEL-TASK-NUMBER    08320000
083300             MOVE PC-LIST-QUEUE-SEQ  TO ASC-LIST-SEQ              08330000
083400             MOVE PC-SEL-QUEUE-SEQ TO ASC-SEL-SEQ                 08340000
083500             PERFORM 1100-PROCESS-INTER-APPL-COMM                 08350000
083600             PERFORM 4000-BUILD-INITIAL-PANEL                     08360000
083700                                                                  08370000
083800         WHEN DP020-NEXT-ACT-READ-MAP                             08380000
083900             MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-TOP-ITEM         08390000
084000             PERFORM 2000-PROCESS-PANEL                           08400000
084100                                                                  08410000
084200         WHEN DP020-NEXT-ACT-RETURN                               08420000
084300             MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-TOP-ITEM         08430000
084400             MOVE ZERO  TO ASC-ITEM-AT-TOP-OF-PANEL               08440000
084500             PERFORM 6000-REFRESH-PANEL-FROM-TEMP                 08450000
084600             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 08460000
084700                                                                  08470000
084800         WHEN OTHER                                               08480000
084900             SET DP013-LOGIC-ABEND TO TRUE                        08490000
085000             SET DP013-NO-ROLLBACK TO TRUE                        08500000
085100             MOVE '1000-CONTROL-PROCESSING' TO DP013-PARAGRAPH    08510000
085200             MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    08520000
085300                                   TO DP013-MESSAGE-TEXT(1)       08530000
085400             PERFORM DP013-0000-PROCESS-ABEND                     08540000
085500     END-EVALUATE.                                                08550000
085600                                                                  08560000
085700*----------------------------------------------------------------*08570000
085800* DETERMINE IF DATA WAS PASSED THROUGH INTER-APPL COMMAREA OR    *08580000
085900* IF THERE IS DATA TO BE USED IN THE NAV-KEY FIELD.              *08590000
086000*----------------------------------------------------------------*08600000
086100 1100-PROCESS-INTER-APPL-COMM.                                    08610000
086200                                                                  08620000
086300     SET PS-COMMAREA-VALID         TO TRUE.                       08630000
086400     MOVE SPACE                    TO ASC-START-ITEM-REQUEST.     08640000
086500                                                                  08650000
086600     IF  DP020-INT-APPL-FORMAT-IND = PC-CRIT-SPEC-FORMAT          08660000
086700         MOVE SU008-SML-NBR           TO ASC-SHIPT-UNT-ID         08670000
086800                                         DK-SHIPT-UNT-ID          08680000
086900         MOVE SU008-DEST-STR-NBR      TO ASC-STORE                08690000
087000         MOVE SU008-DOOR-ID           TO ASC-DOOR-ID              08700000
087100         MOVE SU008-SCAC-CDE          TO ASC-SCAC                 08710000
087200         MOVE SU008-TRLR-SRL-NBR      TO ASC-TRLR-SRL-NBR         08720000
087300         MOVE SU008-TRLR-STATUS       TO ASC-TRLR-STATUS          08730000
087400         MOVE SU008-TRIP-ID           TO ASC-OTBND-TRIP-ID        08740000
087500                                                                  08750000
087600     ELSE                                                         08760000
087700         SET ASC-USE-SELECTION-QUEUE TO TRUE                      08770000
087800         MOVE SU009-NUMBER-OF-SELECTED-ITEMS TO                   08780000
087900                                      ASC-NUMBER-OF-SELECTED-ITEMS08790000
088000         MOVE SU009-NUMBER-OF-TS-ITEMS TO ASC-NUMBER-OF-TS-ITEMS  08800000
088100         MOVE SU009-SEL-QUEUE-NAME     TO ASC-SEL-QUEUE-NAME      08810000
088200         MOVE SU009-OPER-UNT-ID        TO ASC-OPER-UNT-ID-N       08820000
088300         MOVE SU009-TRLR-SRL-NBR       TO ASC-TRLR-SRL-NBR        08830000
088400         MOVE SU009-SCAC-CDE           TO ASC-SCAC                08840000
088500         MOVE SU009-TRLR-ID            TO ASC-TRLR-ID             08850000
088600         MOVE SU009-TRIP-ID            TO ASC-OTBND-TRIP-ID       08860000
088700         MOVE SU009-DEST-STR-NBR       TO ASC-STORE               08870000
088800         MOVE SU009-DOOR-ID            TO ASC-DOOR-ID             08880000
088900         PERFORM 1120-PREPARE-LIST-ENTRY                          08890000
089000     END-IF.                                                      08900000
089100                                                                  08910000
089200*-----------------------------------------------------------------08920000
089300 1120-PREPARE-LIST-ENTRY.                                         08930000
089400                                                                  08940000
089500     MOVE SU010-MAX-ITEMS          TO ASC-SEL-SUB.                08950000
089600     MOVE ZERO                     TO ASC-SEL-ITEM.               08960000
089700     PERFORM 1130-GET-NEXT-RECORD.                                08970000
089800                                                                  08980000
089900*-----------------------------------------------------------------08990000
090000*    GET THE NEXT RECORD IF A LIST OF RECORDS ARE BEING PROCESSED*09000000
090100*-----------------------------------------------------------------09010000
090200 1130-GET-NEXT-RECORD.                                            09020000
090300                                                                  09030000
090400     ADD +1                       TO ASC-SEL-SUB.                 09040000
090500                                                                  09050000
090600     IF  ASC-SEL-SUB > SU010-MAX-ITEMS                            09060000
090700         ADD +1                   TO ASC-SEL-ITEM                 09070000
090800         MOVE +1                  TO ASC-SEL-SUB                  09080000
090900     END-IF.                                                      09090000
091000                                                                  09100000
091100     IF  ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                09110000
091200         PERFORM 9100-READ-SEL-QUEUE                              09120000
091300         IF  SU010-ITEM (ASC-SEL-SUB) > ZERO                      09130000
092500             MOVE SU010-SML (ASC-SEL-SUB)     TO ASC-SHIPT-UNT-ID 09250000
092600                                                 DK-SHIPT-UNT-ID  09260000
092700             SET SU010-INQ (ASC-SEL-SUB)      TO TRUE             09270000
092800             PERFORM 9200-REWRITE-SEL-QUEUE                       09280000
092900         ELSE                                                     09290000
093000             SUBTRACT +1 FROM ASC-SEL-SUB                         09300000
093100             MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER             09310000
093200             SET DP020-MSG-INFORMATIONAL                          09320000
093300             PS-LIST-END             TO TRUE                      09330000
093400         END-IF                                                   09340000
093500     ELSE                                                         09350000
093600         SUBTRACT +1 FROM ASC-SEL-ITEM                            09360000
093700         MOVE SU010-MAX-ITEMS     TO ASC-SEL-SUB                  09370000
093800         MOVE PC-TSYMSG-00070     TO DP020-MSG-NUMBER             09380000
093900         SET DP020-MSG-INFORMATIONAL                              09390000
094000             PS-LIST-END             TO TRUE                      09400000
094100     END-IF.                                                      09410000
094200                                                                  09420000
094300*-----------------------------------------------------------------09430000
094400*    GET THE PREVIOUS RECORD IF A LIST OF RECORDS ARE BEING      *09440000
094500*    PROCESSED.                                                  *09450000
094600*-----------------------------------------------------------------09460000
094700 1140-GET-PREV-RECORD.                                            09470000
094800                                                                  09480000
094900     SUBTRACT +1 FROM ASC-SEL-SUB.                                09490000
095000                                                                  09500000
095100     IF  ASC-SEL-SUB < +1                                         09510000
095200         SUBTRACT +1 FROM ASC-SEL-ITEM                            09520000
095300         MOVE SU010-MAX-ITEMS     TO ASC-SEL-SUB                  09530000
095400     END-IF.                                                      09540000
095500                                                                  09550000
095600     IF  ASC-SEL-ITEM > ZERO                                      09560000
095700         PERFORM 9100-READ-SEL-QUEUE                              09570000
095800         MOVE SU010-TRLR-SRL-NBR (ASC-SEL-SUB) TO                 09580000
095900                                               ASC-TRLR-SRL-NBR   09590000
096000         MOVE SU010-TRIP-ID (ASC-SEL-SUB)   TO ASC-OTBND-TRIP-ID  09600000
096100         MOVE SU010-STAT-DATE (ASC-SEL-SUB) TO ASC-STATUS-DATE    09610000
096200         MOVE SU010-SCAC (ASC-SEL-SUB)      TO ASC-SCAC           09620000
096300         MOVE SU010-TRLR-ID (ASC-SEL-SUB)   TO ASC-TRLR-ID        09630000
096400         MOVE SU010-SML (ASC-SEL-SUB)       TO ASC-SHIPT-UNT-ID   09640000
096500                                               DK-SHIPT-UNT-ID    09650000
096600         SET SU010-INQ (ASC-SEL-SUB) TO TRUE                      09660000
096700         PERFORM 9200-REWRITE-SEL-QUEUE                           09670000
096800     ELSE                                                         09680000
096900         MOVE +1                  TO ASC-SEL-ITEM                 09690000
097000                                     ASC-SEL-SUB                  09700000
097100         MOVE PC-TSYMSG-00069     TO DP020-MSG-NUMBER             09710000
097200         SET DP020-MSG-INFORMATIONAL                              09720000
097300             PS-LIST-END             TO TRUE                      09730000
097400     END-IF.                                                      09740000
097500                                                                  09750000
097600*----------------------------------------------------------------*09760000
097700* DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *09770000
097800* ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *09780000
097900* USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *09790000
098000* OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *09800000
098100* FUNCTION KEYS CAN GET THIS FAR.                                *09810000
098200*----------------------------------------------------------------*09820000
098300 2000-PROCESS-PANEL.                                              09830000
098400     EVALUATE TRUE                                                09840000
098500         WHEN DP020-SRC-AID = DP016-CLEAR                         09850000
098600             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    09860000
098700             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   09870000
098800             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 09880000
098900                                                                  09890000
099000         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    09900000
099100             PERFORM 2050-DELETE-LIST-QUEUE                       09910000
099200             PERFORM 4000-BUILD-INITIAL-PANEL                     09920000
099300                                                                  09930000
099400         WHEN DP020-FK-DESELECT(DP020-SRC-AID)                    09940000
099500             PERFORM 2140-DESELECT-ALL-ITEMS                      09950000
099600             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 09960000
099700                                                                  09970000
099800         WHEN DP020-FK-SELECT-ALL(DP020-SRC-AID)                  09980000
099900             PERFORM 2150-SELECT-ALL-ITEMS                        09990000
100000             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 10000000
100100                                                                  10010000
100200         WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             10020000
100300             IF  ASC-USE-SELECTION-QUEUE                          10030000
100400                 PERFORM 1130-GET-NEXT-RECORD                     10040000
100500                 IF PS-LIST-END                                   10050000
100600                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         10060000
100700                     SET PS-NO-LIST-END TO TRUE                   10070000
100800                 ELSE                                             10080000
100900                     PERFORM 2050-DELETE-LIST-QUEUE               10090000
101000                     PERFORM 3200-RESET-ATTRIBUTES                10100000
101100                     PERFORM 4000-BUILD-INITIAL-PANEL             10110000
101200                 END-IF                                           10120000
101300              ELSE                                                10130000
101400*                PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             10140000
101500*                --- BOTTOM OF LIST ---                           10150000
101600                 MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER         10160000
101700                 SET DP020-MSG-INFORMATIONAL TO TRUE              10170000
101800             END-IF                                               10180000
101900                                                                  10190000
102000         WHEN DP020-FK-PREV-SELECTION (DP020-SRC-AID)             10200000
102100             IF  ASC-USE-SELECTION-QUEUE                          10210000
102200                 PERFORM 1140-GET-PREV-RECORD                     10220000
102300                 IF PS-LIST-END                                   10230000
102400                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         10240000
102500                     SET PS-NO-LIST-END TO TRUE                   10250000
102600                 ELSE                                             10260000
102700                     PERFORM 2050-DELETE-LIST-QUEUE               10270000
102800                     PERFORM 3200-RESET-ATTRIBUTES                10280000
102900                     PERFORM 4000-BUILD-INITIAL-PANEL             10290000
103000                 END-IF                                           10300000
103100             ELSE                                                 10310000
103200                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             10320000
103300                 MOVE PC-TSYMSG-00069 TO DP020-MSG-NUMBER         10330000
103400                 SET DP020-MSG-INFORMATIONAL TO TRUE              10340000
103500             END-IF                                               10350000
103600                                                                  10360000
103700         WHEN OTHER                                               10370000
103800             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 10380000
103900             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   10390000
104000                                                                  10400000
104100             IF  PS-NO-ERROR                                      10410000
104200                 SET DP030-CONTINUE-GO TO TRUE                    10420000
104300                 PERFORM 2100-CHECK-FUNCTION-KEY                  10430000
104400             ELSE                                                 10440000
104500                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             10450000
104600                 SET DP030-OVERRIDE-GO TO TRUE                    10460000
104700             END-IF                                               10470000
104800     END-EVALUATE.                                                10480000
104900                                                                  10490000
105000*----------------------------------------------------------------*10500000
105100*  DELETE THE LIST ITEMS TEMP STORAGE QUEUE.                     *10510000
105200*----------------------------------------------------------------*10520000
105300 2050-DELETE-LIST-QUEUE.                                          10530000
105400                                                                  10540000
105500     EXEC CICS                                                    10550000
105600         DELETEQ TS                                               10560000
105700             QUEUE (ASC-LIST-QUEUE-NAME)                          10570000
105800             RESP  (PV-CICS-RESP)                                 10580000
105900     END-EXEC.                                                    10590000
106000                                                                  10600000
106100     IF (PV-CICS-RESP = DFHRESP(NORMAL)) OR                       10610000
106200        (PV-CICS-RESP = DFHRESP(QIDERR))                          10620000
106300         CONTINUE                                                 10630000
106400     ELSE                                                         10640000
106500         SET DP013-CICS-ABEND      TO TRUE                        10650000
106600         SET DP013-NO-ROLLBACK     TO TRUE                        10660000
106700                                                                  10670000
106800         MOVE '2050-DELETE-LIST-QUEUE' TO DP013-PARAGRAPH         10680000
106900         MOVE 'ERROR TRYING TO DELETE LIST TEMP STORAGE QUEUE'    10690000
107000                                   TO DP013-MESSAGE-TEXT (1)      10700000
107100         PERFORM DP013-0000-PROCESS-ABEND                         10710000
107200     END-IF.                                                      10720000
107300                                                                  10730000
107400     MOVE +0                       TO ASC-HIGHEST-BLOCK-WRITTEN.  10740000
107500                                                                  10750000
107600*----------------------------------------------------------------*10760000
107700* ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED FIRST.*10770000
107800* NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED FROM THE  *10780000
107900* CICS ARCHITECTURE API.                                         *10790000
108000*----------------------------------------------------------------*10800000
108100 2100-CHECK-FUNCTION-KEY.                                         10810000
108200                                                                  10820000
108300     EVALUATE TRUE                                                10830000
108400*                                                                 10840000
108500* F6 - FIRST PAGE                                                 10850000
108600         WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                  10860000
108700             MOVE +1               TO PV-TOP-ITEM                 10870000
108800             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 10880000
108900*                                                                 10890000
109000* F7 - PREVIOUS PAGE                                              10900000
109100         WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                   10910000
109200             PERFORM 2110-BROWSE-BACKWARD                         10920000
109300             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 10930000
109400*                                                                 10940000
109500* F8 - NEXT PAGE                                                  10950000
109600         WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                   10960000
109700             PERFORM 2120-BROWSE-FORWARD                          10970000
109800             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 10980000
109900*                                                                 10990000
110000* ENTER KEY                                                       11000000
110100         WHEN DP020-SRC-AID = DP016-ENTER                         11010000
110200             PERFORM 2130-CHECK-FOR-JUMP-BROWSE                   11020000
110300             IF  PS-ERROR                                         11030000
110400                 CONTINUE                                         11040000
110500             ELSE                                                 11050000
110600                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             11060000
110700             END-IF                                               11070000
110800                                                                  11080000
110900         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              11090000
111000*            INITIALIZE SU008-COMM-AREA                           11100000
111100             MOVE ASC-SHIPT-UNT-ID    TO SU008-SML-NBR            11110000
111200             MOVE DP020-LOCATION-NBR  TO SU008-OPER-UNT-ID        11120026
111300         WHEN OTHER                                               11130000
111400             SET DP013-NO-ROLLBACK                                11140000
111500                 DP013-XCTL-DISPLAY-RESTART                       11150000
111600                 DP013-CICS-ABEND  TO TRUE                        11160000
111700             MOVE '2100-CHECK-FUNCTION-KEY' TO DP013-PARAGRAPH    11170000
111800             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      11180000
111900                                   TO DP013-MESSAGE-TEXT (1)      11190000
112000             PERFORM DP013-0000-PROCESS-ABEND                     11200000
112100     END-EVALUATE.                                                11210000
112200*                                                                 11220000
112300*----------------------------------------------------------------*11230000
112400*    IF THE USER HITS THE PAGE BACKWARD KEY, COMPUTE THE TOP     *11240000
112500*    ITEM NUMBER FOR THE NEW PAGE.  IF IT IS ABOVE THE TOP,      *11250000
112600*    SET THE TOP ITEM NUMBER TO +1 AND DISPLAY THE TOP OF LIST   *11260000
112700*    MESSAGE.                                                    *11270000
112800*----------------------------------------------------------------*11280000
112900 2110-BROWSE-BACKWARD.                                            11290000
113000     SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    11300000
113100         GIVING PV-TOP-ITEM.                                      11310000
113200*                                                                 11320000
113300     IF  ((PV-TOP-ITEM < +1)                                      11330000
113400       OR (PV-TOP-ITEM = +1))                                     11340000
113500         MOVE +1                   TO PV-TOP-ITEM                 11350000
113600*        -- TOP OF LIST --                                        11360000
113700         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            11370000
113800         SET DP020-MSG-INFORMATIONAL TO TRUE                      11380000
113900     END-IF.                                                      11390000
114000                                                                  11400000
114100*----------------------------------------------------------------*11410000
114200*    IF THE USER HITS THE PAGE FORWARD KEY, COMPUTE THE TOP      *11420000
114300*    ITEM NUMBER FOR THE NEW PAGE.  IF THE USER ATTEMPTS TO GO   *11430000
114400*    PAST THE END, ISSUE THE BOTTOM OF LIST MESSAGE.             *11440000
114500*----------------------------------------------------------------*11450000
114600 2120-BROWSE-FORWARD.                                             11460000
114700                                                                  11470000
114800     ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              11480000
114900         GIVING PV-TOP-ITEM.                                      11490000
115000     IF  PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                   11500000
115100         MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-TOP-ITEM             11510000
115200*        -- BOTTOM OF LIST --                                     11520000
115300         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            11530000
115400         SET DP020-MSG-INFORMATIONAL  TO TRUE                     11540000
115500     ELSE                                                         11550000
115600         COMPUTE PV-BOTTOM-ITEM =                                 11560000
115700             PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 11570000
115800         IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ            11580000
115900*            -- BOTTOM OF LIST --                                 11590000
116000             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            11600000
116100             SET DP020-MSG-INFORMATIONAL TO TRUE                  11610000
116200         END-IF                                                   11620000
116300     END-IF.                                                      11630000
116400                                                                  11640000
116500*----------------------------------------------------------------*11650000
116600*    THE USER CAN CHANGE THE CURRENT BEGINNING LIST NUMBER SO    *11660000
116700*    THAT THE TRANSACTION WILL JUMP TO THAT POINT IN THE LIST.   *11670000
116800*    THIS IS A FASTER WAY TO GET TO A CERTAIN POINT IN THE LIST  *11680000
116900*    RATHER THAN HITTING NEXT-PAGE TO GET TO THAT POINT.         *11690000
117000*    THE NEW LIST NUMBER ENTERED IS EDITED TO MAKE SURE THAT     *11700000
117100*    IT IS NUMERIC AND FALLS BETWEEN A SPECIFIED RANGE.          *11710000
117200*----------------------------------------------------------------*11720000
117300 2130-CHECK-FOR-JUMP-BROWSE.                                      11730000
117400     SET PS-NO-ERROR               TO TRUE.                       11740000
117500     IF (ASC-START-ITEM-REQUEST = SPACE)                          11750000
117600         MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-TOP-ITEM             11760000
117700     ELSE                                                         11770000
117800         MOVE ASC-START-ITEM-REQUEST TO DP010I-UNEDITED-FIELD     11780000
117900         MOVE PC-MSG-NUMBER-LENGTH TO DP010I-MAXIMUM-DIGITS       11790000
118000         MOVE +0                   TO DP010I-MAXIMUM-DECIMALS     11800000
118100         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  11810000
118200         CALL DP010I-NUMERIC-EDIT-ROUTINE                         11820058
118210              USING DP010I-NUMERIC-EDIT-AREA                      11821058
118300                                                                  11830000
118400         IF  NOT DP010I-ERROR-DETECTED                            11840000
118500             MOVE DP010I-NUMERIC-FIELD TO ASC-START-ITEM-REQUEST-N11850000
118600             IF  ASC-START-ITEM-REQUEST-N > ZERO                  11860000
118700                 IF  ASC-START-ITEM-REQUEST-N >                   11870000
118800                                          ASC-NUMBER-OF-ITEMS-READ11880000
118900                     MOVE SPACE TO ASC-START-ITEM-REQUEST         11890000
119000                     COMPUTE PV-TOP-ITEM =                        11900000
119100                             ASC-NUMBER-OF-ITEMS-READ             11910000
119200                             - PC-ITEMS-PER-PANEL + 1             11920000
119300                     IF  PV-TOP-ITEM < +1                         11930000
119400                         MOVE +1   TO PV-TOP-ITEM                 11940000
119500                         MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER 11950000
119600                         SET DP020-MSG-INFORMATIONAL TO TRUE      11960000
119700                     END-IF                                       11970000
119800                 ELSE                                             11980000
119900                     MOVE ASC-START-ITEM-REQUEST-N TO PV-TOP-ITEM 11990000
120000                     MOVE SPACE    TO ASC-START-ITEM-REQUEST      12000000
120100                     COMPUTE PV-BOTTOM-ITEM =                     12010000
120200                         PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1     12020000
120300                     IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ12030000
120400*                        -- BOTTOM OF LIST --                     12040000
120500                         MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER 12050000
120600                         SET DP020-MSG-INFORMATIONAL TO TRUE      12060000
120700                     END-IF                                       12070000
120800                 END-IF                                           12080000
120900             ELSE                                                 12090000
121000*                --- VALUE OUT OF RANGE ----                      12100000
121100                 MOVE PC-TSYMSG-00101  TO DP020-MSG-NUMBER        12110000
121200                 MOVE -1           TO ASTRTITL                    12120000
121300                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              12130000
121400                 MOVE DP015-REVERSE TO ASTRTITH                   12140000
121500                 MOVE DP015-RED    TO ASTRTITC                    12150000
121600                 MOVE DP015-UNP-NUM-BRT-MDT TO ASTRTITA           12160000
121700                 SET DP020-MSG-FATAL                              12170000
121800                     PS-ERROR        TO TRUE                      12180000
121900             END-IF                                               12190000
122000         ELSE                                                     12200000
122100             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            12210000
122200             MOVE -1               TO ASTRTITL                    12220000
122300             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  12230000
122400             MOVE DP015-REVERSE    TO ASTRTITH                    12240000
122500             MOVE DP015-RED        TO ASTRTITC                    12250000
122600             MOVE DP015-UNP-NUM-BRT-MDT TO ASTRTITA               12260000
122700             SET DP020-MSG-FATAL   TO TRUE                        12270000
122800             SET PS-ERROR          TO TRUE                        12280000
122900         END-IF                                                   12290000
123000     END-IF.                                                      12300000
123100                                                                  12310000
123200*----------------------------------------------------------------*12320000
123300*    IF THE USER HITS THE DESELECT KEY, CLEAR THE SELECTION      *12330000
123400*    SWITCH FOR ALL ITEMS THAT WERE PREVIOUSLY SELECTED.         *12340000
123500*----------------------------------------------------------------*12350000
123600 2140-DESELECT-ALL-ITEMS.                                         12360000
123700     MOVE +1                       TO ASC-BLK-SUB.                12370000
123800                                                                  12380000
123900     PERFORM 2141-CLEAR-SELECTED-INDS                             12390000
124000         VARYING ASC-ITEM-SUB                                     12400000
124100         FROM 1 BY 1                                              12410000
124200         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 12420000
124300                                                                  12430000
124400     ADD +1                        TO ASC-BLK-SUB.                12440000
124500                                                                  12450000
124600     PERFORM 2141-CLEAR-SELECTED-INDS                             12460000
124700         VARYING ASC-ITEM-SUB                                     12470000
124800         FROM 1 BY 1                                              12480000
124900         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 12490000
125000                                                                  12500000
125100     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               12510000
125200                                   TO PV-LIST-ITEM-NUMBER.        12520000
125300                                                                  12530000
125400     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            12540000
125500         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    12550000
125600                                                                  12560000
125700     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     12570000
125800        (ASC-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)      12580000
125900         MOVE +1                   TO ASC-BLK-SUB                 12590000
126000                                                                  12600000
126100         PERFORM 5100-WRITE-TEMP-STORAGE                          12610000
126200         MOVE +2                   TO ASC-BLK-SUB                 12620000
126300         PERFORM 5100-WRITE-TEMP-STORAGE                          12630000
126400         MOVE +1                   TO ASC-BLK-SUB                 12640000
126500                                                                  12650000
126600         MOVE +1                   TO PV-BLOCK-NUMBER             12660000
126700                                                                  12670000
126800         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         12680000
126900             PV-FIRST-BLOCK-IN-ARRAY - 1                          12690000
127000                                                                  12700000
127100         PERFORM                                                  12710000
127200             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       12720000
127300                                                                  12730000
127400             PERFORM 4410-READ-TEMP-STORAGE                       12740000
127500                                                                  12750000
127600             PERFORM 2141-CLEAR-SELECTED-INDS                     12760000
127700                 VARYING ASC-ITEM-SUB FROM 1 BY 1                 12770000
127800                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          12780000
127900                                                                  12790000
128000             PERFORM 5100-WRITE-TEMP-STORAGE                      12800000
128100                                                                  12810000
128200             ADD +1                TO PV-BLOCK-NUMBER             12820000
128300                                                                  12830000
128400         END-PERFORM                                              12840000
128500                                                                  12850000
128600         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         12860000
128700             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     12870000
128800                                                                  12880000
128900         PERFORM                                                  12890000
129000             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       12900000
129100                   ASC-HIGHEST-BLOCK-WRITTEN                      12910000
129200                                                                  12920000
129300             MOVE PV-NEXT-BLOCK-IN-ARRAY                          12930000
129400                                   TO PV-BLOCK-NUMBER             12940000
129500                                                                  12950000
129600             PERFORM 4410-READ-TEMP-STORAGE                       12960000
129700                                                                  12970000
129800             PERFORM 2141-CLEAR-SELECTED-INDS                     12980000
129900                 VARYING ASC-ITEM-SUB                             12990000
130000                 FROM 1 BY 1                                      13000000
130100                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          13010000
130200                                                                  13020000
130300             PERFORM 5100-WRITE-TEMP-STORAGE                      13030000
130400                                                                  13040000
130500             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      13050000
130600         END-PERFORM                                              13060000
130700                                                                  13070000
130800         MOVE PV-FIRST-BLOCK-IN-ARRAY TO PV-BLOCK-NUMBER          13080000
130900         PERFORM 4410-READ-TEMP-STORAGE                           13090000
131000     END-IF.                                                      13100000
131100                                                                  13110000
131200                                                                  13120000
131300     MOVE +0                     TO ASC-NUMBER-OF-SELECTED-ITEMS. 13130000
131400     MOVE +0                     TO ASC-START-OF-SELECTED-RANGE.  13140000
131500     MOVE +0                     TO ASC-END-OF-SELECTED-RANGE.    13150000
131600                                                                  13160000
131700     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        13170000
131800                                                                  13180000
131900*----------------------------------------------------------------*13190000
132000*    MARK EACH ITEM AS BEING NOT SELECTED.                       *13200000
132100*----------------------------------------------------------------*13210000
132200 2141-CLEAR-SELECTED-INDS.                                        13220000
132300                                                                  13230000
132400     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           13240000
132500             NOT EQUAL ZERO                                       13250000
132600         IF  NOT ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          13260000
132700             SET ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          13270000
132800                 ASC-TEMP-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)    13280000
132900                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  13290000
133000                                   TO TRUE                        13300000
133100         END-IF                                                   13310000
133200     END-IF.                                                      13320000
133300                                                                  13330000
133400*----------------------------------------------------------------*13340000
133500*  IF THE USER HITS THE SELECT-ALL KEY, SET THE SELECTIO SWITCH  *13350000
133600*  FOR ALL ITEMS.                                                *13360000
133700*----------------------------------------------------------------*13370000
133800 2150-SELECT-ALL-ITEMS.                                           13380000
133900                                                                  13390000
134000     MOVE +1                       TO ASC-BLK-SUB.                13400000
134100                                                                  13410000
134200     PERFORM 2151-SET-SELECTED-INDS                               13420000
134300         VARYING ASC-ITEM-SUB                                     13430000
134400         FROM 1 BY 1                                              13440000
134500         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 13450000
134600                                                                  13460000
134700     ADD +1                        TO ASC-BLK-SUB.                13470000
134800                                                                  13480000
134900     PERFORM 2151-SET-SELECTED-INDS                               13490000
135000         VARYING ASC-ITEM-SUB                                     13500000
135100         FROM 1 BY 1                                              13510000
135200         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 13520000
135300                                                                  13530000
135400     MOVE ASC-LIST-ITEM-NUMBER(1 1) TO PV-LIST-ITEM-NUMBER.       13540000
135500                                                                  13550000
135600     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            13560000
135700         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    13570000
135800                                                                  13580000
135900     IF  PV-FIRST-BLOCK-IN-ARRAY  = +1                            13590000
136000         MOVE +1                   TO ASC-BLK-SUB                 13600000
136100                                                                  13610000
136200         PERFORM 5100-WRITE-TEMP-STORAGE                          13620000
136300         MOVE +2                   TO ASC-BLK-SUB                 13630000
136400         PERFORM 5100-WRITE-TEMP-STORAGE                          13640000
136500         MOVE +1                   TO ASC-BLK-SUB                 13650000
136600         MOVE +1                   TO PV-BLOCK-NUMBER             13660000
136700     END-IF.                                                      13670000
136800*                                                                 13680000
136900     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     13690000
137000        (ASC-HIGHEST-BLOCK-WRITTEN >   PC-MAX-BLOCKS-IN-ARRAY)    13700000
137100         MOVE +1                   TO ASC-BLK-SUB                 13710000
137200                                                                  13720000
137300         PERFORM 5100-WRITE-TEMP-STORAGE                          13730000
137400         MOVE +2                   TO ASC-BLK-SUB                 13740000
137500         PERFORM 5100-WRITE-TEMP-STORAGE                          13750000
137600         MOVE +1                   TO ASC-BLK-SUB                 13760000
137700         MOVE +1                   TO PV-BLOCK-NUMBER             13770000
137800                                                                  13780000
137900         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         13790000
138000             PV-FIRST-BLOCK-IN-ARRAY - 1                          13800000
138100                                                                  13810000
138200         PERFORM                                                  13820000
138300             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       13830000
138400                                                                  13840000
138500             PERFORM 4410-READ-TEMP-STORAGE                       13850000
138600                                                                  13860000
138700             PERFORM 2151-SET-SELECTED-INDS                       13870000
138800                 VARYING ASC-ITEM-SUB                             13880000
138900                 FROM 1 BY 1                                      13890000
139000                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          13900000
139100                                                                  13910000
139200             PERFORM 5100-WRITE-TEMP-STORAGE                      13920000
139300                                                                  13930000
139400             ADD +1                TO PV-BLOCK-NUMBER             13940000
139500                                                                  13950000
139600         END-PERFORM                                              13960000
139700                                                                  13970000
139800         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         13980000
139900             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     13990000
140000                                                                  14000000
140100         PERFORM                                                  14010000
140200             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       14020000
140300                   ASC-HIGHEST-BLOCK-WRITTEN                      14030000
140400                                                                  14040000
140500             MOVE PV-NEXT-BLOCK-IN-ARRAY                          14050000
140600                                   TO PV-BLOCK-NUMBER             14060000
140700                                                                  14070000
140800             PERFORM 4410-READ-TEMP-STORAGE                       14080000
140900                                                                  14090000
141000             PERFORM 2151-SET-SELECTED-INDS                       14100000
141100                 VARYING ASC-ITEM-SUB                             14110000
141200                 FROM 1 BY 1                                      14120000
141300                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          14130000
141400                                                                  14140000
141500             PERFORM 5100-WRITE-TEMP-STORAGE                      14150000
141600                                                                  14160000
141700             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      14170000
141800                                                                  14180000
141900         END-PERFORM                                              14190000
142000                                                                  14200000
142100         MOVE PV-FIRST-BLOCK-IN-ARRAY                             14210000
142200                                   TO PV-BLOCK-NUMBER             14220000
142300                                                                  14230000
142400         PERFORM 4410-READ-TEMP-STORAGE                           14240000
142500     END-IF.                                                      14250000
142600                                                                  14260000
142700                                                                  14270000
142800     MOVE ASC-NUMBER-OF-ITEMS-READ TO                             14280000
142900                       ASC-NUMBER-OF-SELECTED-ITEMS.              14290000
143000                                                                  14300000
143100     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        14310000
143200                                                                  14320000
143300*----------------------------------------------------------------*14330000
143400*    MARK EACH ITEM AS BEING SELECTED.                           *14340000
143500*----------------------------------------------------------------*14350000
143600 2151-SET-SELECTED-INDS.                                          14360000
143700                                                                  14370000
143800     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           14380000
143900             NOT EQUAL ZERO                                       14390000
144000         IF  NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             14400000
144100             SET ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             14410000
144200                 ASC-TEMP-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)        14420000
144300                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  14430000
144400                               TO  TRUE                           14440000
144500         END-IF                                                   14450000
144600     END-IF.                                                      14460000
144700                                                                  14470000
144800******************************************************************14480000
144900** MOVE ALL OF THE FIELDS THAT WERE ENTERED / CHANGED ON THE    **14490000
145000** SCREEN INTO THE COMMAREA.  ALL EDITTING IS DONE IN THE COMM. **14500000
145100******************************************************************14510000
145200 2200-MOVE-SCREEN-TO-COMMAREA.                                    14520000
145300                                                                  14530000
145400     MOVE PV-TOP-ITEM              TO PV-ITEM-IN-USE.             14540000
145500     MOVE +1                       TO PV-SUB.                     14550000
145600*                                                                 14560000
145700     PERFORM 3100-SET-SUBSCRIPTS.                                 14570000
145800     IF  ASTRTITL > ZERO                                          14580000
145900         MOVE ASTRTITI         TO ASC-START-ITEM-REQUEST          14590000
146000     ELSE                                                         14600000
146100         IF  ASTRTITF = DP015-ERASE-EOF                           14610000
146200             INITIALIZE ASC-START-ITEM-REQUEST                    14620000
146300         END-IF                                                   14630000
146400     END-IF.                                                      14640000
146500                                                                  14650000
146600******************************************************************14660000
146700** EDIT ALL OF THE DATA ON THE SCREEN AS IT RESIDES IN THE      **14670000
146800** COMMAREA (EDITTING IS NOT DONE AGAINST THE SCREEN DIRECTLY). **14680000
146900******************************************************************14690000
147000 3000-EDIT-DATA-IN-COMMAREA.                                      14700000
147100     SET PS-NO-ERROR               TO TRUE.                       14710000
147200     PERFORM 3200-RESET-ATTRIBUTES.                               14720000
147300     MOVE ASC-ITEMS-DISPLAYED      TO PV-SUB.                     14730000
147400                                                                  14740000
147500**                                                                14750000
147600* CALCULATE THE POSITION OF THE LAST ITEM DISPLAYED.              14760000
147700* EDITTING IS DONE FROM THE BOTTOM UP.                            14770000
147800**                                                                14780000
147900     COMPUTE PV-ITEM-IN-USE = PV-TOP-ITEM +                       14790000
148000         ASC-ITEMS-DISPLAYED - 1.                                 14800000
148100     PERFORM 3100-SET-SUBSCRIPTS.                                 14810000
148200*                                                                 14820000
148300     IF  PS-NO-ERROR                                              14830000
148400         PERFORM 3005-EDIT-COMMAREA-BLOCKS                        14840000
148500     END-IF.                                                      14850000
148600                                                                  14860000
148700*                                                                 14870000
148800     IF  ((PS-NO-ERROR)                                           14880000
148900       AND (ASC-START-OF-SELECTED-RANGE > ZERO)                   14890000
149000       AND (ASC-END-OF-SELECTED-RANGE > ZERO))                    14900000
149100             PERFORM 3500-MARK-RANGE-AS-SELECTED                  14910000
149200     END-IF.                                                      14920000
149300                                                                  14930000
149400*----------------------------------------------------------------*14940000
149500*   3005-EDIT-COMMAREA-BLOCKS                                    *14950000
149600*----------------------------------------------------------------*14960000
149700 3005-EDIT-COMMAREA-BLOCKS.                                       14970000
149800     MOVE +1                       TO PV-BLOCK-NUMBER.            14980000
149900     MOVE +1                       TO ASC-BLK-SUB.                14990000
150000     MOVE PC-ITEMS-PER-PANEL       TO ASC-ITEM-SUB.               15000000
150100                                                                  15010000
150200     COMPUTE PV-BLOCK-NUMBER  =                                   15020000
150300        1 + ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) /                 15030000
150400            PC-ITEMS-PER-PANEL.                                   15040000
150500                                                                  15050000
150600     MOVE  PV-BLOCK-NUMBER         TO PV-ORIGINAL-BLOCK.          15060000
150700                                                                  15070000
150800     PERFORM                                                      15080000
150900       UNTIL PV-BLOCK-NUMBER > ASC-HIGHEST-BLOCK-WRITTEN          15090000
151000          OR PS-ERROR                                             15100000
151100          OR PS-BLOCK-ERROR                                       15110000
151200                                                                  15120000
151300             COMPUTE PV-ITEMS-HOLD  =                             15130000
151400                     ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) +        15140000
151500                     PC-ITEMS-PER-PANEL - 1                       15150000
151600                                                                  15160000
151700             IF  PV-ITEMS-HOLD  >  ASC-NUMBER-OF-ITEMS-READ       15170000
151800                 SUBTRACT  ASC-NUMBER-OF-ITEMS-READ               15180000
151900                     FROM  PV-ITEMS-HOLD                          15190000
152000                   GIVING  PV-ITEMS-DIFF                          15200000
152100                 SUBTRACT  PV-ITEMS-DIFF                          15210000
152200                     FROM  PC-ITEMS-PER-PANEL                     15220000
152300                   GIVING  PV-ITEMS-HOLD                          15230000
152400                     MOVE  PV-ITEMS-HOLD  TO  PV-SUB              15240000
152500                                              ASC-ITEM-SUB        15250000
152600                                              ASC-ITEMS-DISPLAYED 15260000
152700             ELSE                                                 15270000
152800                 MOVE ASC-ITEMS-DISPLAYED  TO PV-SUB              15280000
152900                 MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB        15290000
153000             END-IF                                               15300000
153100                                                                  15310000
153200             MOVE +1               TO ASC-BLK-SUB                 15320000
153300                                                                  15330000
153400             PERFORM 5105-REWRITE-ASC-LISTQ                       15340000
153500                                                                  15350000
153600             MOVE +1                TO ASC-BLK-SUB                15360000
153700                                                                  15370000
153800             IF  PS-BLOCK-ERROR                                   15380000
153900                 SET  PS-ERROR     TO TRUE                        15390000
154000                 MOVE ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB 1)        15400000
154100                                   TO PV-TOP-ITEM                 15410000
154200             ELSE                                                 15420000
154300                 ADD  +1           TO PV-BLOCK-NUMBER             15430000
154400                 IF  PV-BLOCK-NUMBER >                            15440000
154500                     ASC-HIGHEST-BLOCK-WRITTEN                    15450000
154600                     MOVE +2       TO ASC-BLK-SUB                 15460000
154700                     PERFORM 4410-READ-TEMP-STORAGE               15470000
154800                     MOVE +1       TO ASC-BLK-SUB                 15480000
154900                 ELSE                                             15490000
155000                     PERFORM 4410-READ-TEMP-STORAGE               15500000
155100                     ADD  +1        TO PV-BLOCK-NUMBER            15510000
155200                     MOVE +2        TO ASC-BLK-SUB                15520000
155300                     PERFORM 4410-READ-TEMP-STORAGE               15530000
155400                     SUBTRACT +1  FROM PV-BLOCK-NUMBER            15540000
155500                     MOVE +1        TO ASC-BLK-SUB                15550000
155600                 END-IF                                           15560000
155700             END-IF                                               15570000
155800     END-PERFORM.                                                 15580000
155900                                                                  15590000
156000     IF  PV-ORIGINAL-BLOCK  = +1    OR                            15600000
156100         PS-ERROR                   OR                            15610000
156200         PS-BLOCK-ERROR                                           15620000
156300         CONTINUE                                                 15630000
156400     ELSE                                                         15640000
156500         MOVE +1                 TO PV-BLOCK-NUMBER               15650000
156600         MOVE +1                 TO ASC-BLK-SUB                   15660000
156700         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  15670000
156800         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEMS-DISPLAYED           15680000
156900         PERFORM 4410-READ-TEMP-STORAGE                           15690000
157000                                                                  15700000
157100         PERFORM                                                  15710000
157200           UNTIL PV-BLOCK-NUMBER = PV-ORIGINAL-BLOCK              15720000
157300              OR PS-ERROR                                         15730000
157400              OR PS-BLOCK-ERROR                                   15740000
157500                                                                  15750000
157600                 COMPUTE PV-ITEMS-HOLD  =                         15760000
157700                         ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) +    15770000
157800                         PC-ITEMS-PER-PANEL - 1                   15780000
157900                                                                  15790000
158000                 IF  PV-ITEMS-HOLD > ASC-NUMBER-OF-ITEMS-READ     15800000
158100                     SUBTRACT  ASC-NUMBER-OF-ITEMS-READ           15810000
158200                         FROM  PV-ITEMS-HOLD                      15820000
158300                       GIVING  PV-ITEMS-DIFF                      15830000
158400                     SUBTRACT  PV-ITEMS-DIFF                      15840000
158500                         FROM  PC-ITEMS-PER-PANEL                 15850000
158600                       GIVING  PV-ITEMS-HOLD                      15860000
158700                         MOVE  PV-ITEMS-HOLD TO PV-SUB            15870000
158800                                                ASC-ITEM-SUB      15880000
158900                                               ASC-ITEMS-DISPLAYED15890000
159000                 ELSE                                             15900000
159100                     MOVE ASC-ITEMS-DISPLAYED  TO PV-SUB          15910000
159200                     MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB    15920000
159300                 END-IF                                           15930000
159400                                                                  15940000
159500                 MOVE +1               TO ASC-BLK-SUB             15950000
159600                                                                  15960000
159700                 PERFORM 5105-REWRITE-ASC-LISTQ                   15970000
159800                                                                  15980000
159900                 MOVE +1                TO ASC-BLK-SUB            15990000
160000                                                                  16000000
160100                 IF  PS-BLOCK-ERROR                               16010000
160200                     SET  PS-ERROR     TO TRUE                    16020000
160300                     MOVE ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB 1)    16030000
160400                                       TO PV-TOP-ITEM             16040000
160500                 ELSE                                             16050000
160600                     ADD  +1            TO PV-BLOCK-NUMBER        16060000
160700                     IF  PV-BLOCK-NUMBER = PV-ORIGINAL-BLOCK      16070000
160800                         MOVE +2        TO ASC-BLK-SUB            16080000
160900                         PERFORM 4410-READ-TEMP-STORAGE           16090000
161000                         MOVE +1        TO ASC-BLK-SUB            16100000
161100                     ELSE                                         16110000
161200                         PERFORM 4410-READ-TEMP-STORAGE           16120000
161300                         ADD  +1        TO PV-BLOCK-NUMBER        16130000
161400                         MOVE +2        TO ASC-BLK-SUB            16140000
161500                         PERFORM 4410-READ-TEMP-STORAGE           16150000
161600                         SUBTRACT +1  FROM PV-BLOCK-NUMBER        16160000
161700                         MOVE +1        TO ASC-BLK-SUB            16170000
161800                     END-IF                                       16180000
161900                 END-IF                                           16190000
162000     END-PERFORM.                                                 16200000
162100     MOVE +0 TO PV-ITEMS-HOLD.                                    16210000
162200                                                                  16220000
162300*----------------------------------------------------------------*16230000
162400*    DETERMINE THE VALUE OF THE ITEM SUBSCRIPT BASED ON THE ITEM *16240000
162500*    CURRENTLY IN USE AND THE FIRST ITEM IN THE ARRAY.  THIS WILL*16250000
162600*    POSITION US IN THE 1ST BLOCK OF THE ARRAY.                  *16260000
162700*                                                                *16270000
162800*    IF THE ITEM SUBSCRIPT EXCEEDS THE MAXIMUM NUMBER OF ITEMS   *16280000
162900*    IN A BLOCK, RECALCULATE THE SUBSCRIPT BY SUBTRACTING OUT    *16290000
163000*    THE MAXIMUM NUMBER OF ITEMS.  THIS WILL CORRECTLY POSITION  *16300000
163100*    US IN THE 2ND BLOCK OF THE ARRAY.                           *16310000
163200*----------------------------------------------------------------*16320000
163300 3100-SET-SUBSCRIPTS.                                             16330000
163400                                                                  16340000
163500     COMPUTE ASC-ITEM-SUB =                                       16350000
163600         (PV-ITEM-IN-USE - ASC-LIST-ITEM-NUMBER(1 1)) + 1.        16360000
163700                                                                  16370000
163800     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         16380000
163900         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            16390000
164000         MOVE PC-MAX-BLOCKS-IN-ARRAY TO ASC-BLK-SUB               16400000
164100     ELSE                                                         16410000
164200         MOVE +1                     TO ASC-BLK-SUB               16420000
164300     END-IF.                                                      16430000
164400******************************************************************16440000
164500** RESET THE ATTRIBUTES OF ALL ENTERABLE FIELDS ON THE MAP.     **16450000
164600******************************************************************16460000
164700 3200-RESET-ATTRIBUTES.                                           16470000
164800     MOVE DP015-UNP-ALP-NOR-OFF    TO ASTRTITA.                   16480000
164900     MOVE DP015-GREEN              TO ASTRTITC.                   16490000
165000     MOVE DP015-UNDERLINE          TO ASTRTITH.                   16500000
165100     MOVE -1                       TO ASTRTITL.                   16510000
165200     SET DP030-SET-CURSOR-APPL-1   TO TRUE.                       16520000
165300                                                                  16530000
165400******************************************************************16540000
165500** IF A BEGINNING AND END OF RANGE WAS ENTERED TO SELECT A      **16550000
165600** RANGE OF LINES, MAKE SURE THERE IS ONLY 1 BEGINNING AND 1    **16560000
165700** ENDING AND MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN)**16570000
165800** THE ENDING.                                                  **16580000
165900******************************************************************16590000
166000 3310-EDIT-RANGE.                                                 16600000
166100     IF  ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)                16610000
166200         IF  ASC-START-OF-SELECTED-RANGE = ZERO                   16620000
166300             MOVE ASC-TEMP-SELECTED-SW  (ASC-BLK-SUB ASC-ITEM-SUB)16630000
166400                                   TO ASC-SELECTED-SW             16640000
166500                                        (ASC-BLK-SUB ASC-ITEM-SUB)16650000
166600             MOVE PV-ITEM-IN-USE   TO ASC-START-OF-SELECTED-RANGE 16660000
166700         ELSE                                                     16670000
166800             IF  ASC-START-OF-SELECTED-RANGE = PV-ITEM-IN-USE     16680000
166900                 CONTINUE                                         16690000
167000             ELSE                                                 16700000
167100*                -- ONLY ONE BEGINNING-OF-RANGE-ALLOWED --        16710000
167200                 MOVE PC-TSYMSG-00054                             16720000
167300                                       TO DP020-MSG-NUMBER        16730000
167400                 MOVE -1               TO ASTRTITL                16740000
167500                 SET DP020-MSG-FATAL                              16750000
167600                     DP030-SET-CURSOR-APPL-1                      16760000
167700                     PS-ERROR          TO TRUE                    16770000
167800             END-IF                                               16780000
167900         END-IF                                                   16790000
168000     ELSE                                                         16800000
168100         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     16810000
168200             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 16820000
168300                                   TO ASC-SELECTED-SW             16830000
168400                                     (ASC-BLK-SUB ASC-ITEM-SUB)   16840000
168500             MOVE PV-ITEM-IN-USE   TO ASC-END-OF-SELECTED-RANGE   16850000
168600         ELSE                                                     16860000
168700             IF  ASC-END-OF-SELECTED-RANGE = PV-ITEM-IN-USE       16870000
168800                 CONTINUE                                         16880000
168900             ELSE                                                 16890000
169000*                -- ONLY ONE END-OF-RANGE ALLOWED --              16900000
169100                 MOVE PC-TSYMSG-00055                             16910000
169200                                        TO DP020-MSG-NUMBER       16920000
169300                 MOVE -1                TO ASTRTITL               16930000
169400                 SET DP020-MSG-FATAL                              16940000
169500                     DP030-SET-CURSOR-APPL-1                      16950000
169600                     PS-ERROR           TO TRUE                   16960000
169700             END-IF                                               16970000
169800         END-IF                                                   16980000
169900     END-IF.                                                      16990000
170000*                                                                 17000000
170100*----------------------------------------------------------------*17010000
170200*    WHENEVER THE USER SELECTS AN ITEM AS THE BEGINNING RANGE    *17020000
170300*    AND ONE AS THE ENDING RANGE, MARK THESE ITEMS AS WELL AS    *17030000
170400*    THOSE THAT FALL IN THE RANGE AS BEING SELECTED.             *17040000
170500*----------------------------------------------------------------*17050000
170600 3500-MARK-RANGE-AS-SELECTED.                                     17060000
170700     MOVE +1                       TO  ASC-BLK-SUB.               17070000
170800     PERFORM 3510-MARK-SELECTED-INDS                              17080000
170900         VARYING ASC-ITEM-SUB                                     17090000
171000         FROM 1 BY 1                                              17100000
171100         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 17110000
171200                                                                  17120000
171300     ADD +1                        TO ASC-BLK-SUB.                17130000
171400     PERFORM 3510-MARK-SELECTED-INDS                              17140000
171500         VARYING ASC-ITEM-SUB                                     17150000
171600         FROM 1 BY 1                                              17160000
171700         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 17170000
171800                                                                  17180000
171900     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               17190000
172000                                   TO  PV-LIST-ITEM-NUMBER.       17200000
172100     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            17210000
172200         1 + ((PV-LIST-ITEM-NUMBER - 1) /                         17220000
172300               PC-ITEMS-PER-PANEL).                               17230000
172400                                                                  17240000
172500     MOVE ASC-START-OF-SELECTED-RANGE                             17250000
172600                                   TO PV-START-OF-SELECTED-RANGE. 17260000
172700     COMPUTE PV-FIRST-BLOCK-IN-RANGE =                            17270000
172800         1 + ((PV-START-OF-SELECTED-RANGE - 1) /                  17280000
172900               PC-ITEMS-PER-PANEL).                               17290000
173000                                                                  17300000
173100     MOVE ASC-END-OF-SELECTED-RANGE                               17310000
173200                                   TO  PV-END-OF-SELECTED-RANGE.  17320000
173300     COMPUTE PV-LAST-BLOCK-IN-RANGE =                             17330000
173400         1 + ((PV-END-OF-SELECTED-RANGE - 1) /                    17340000
173500               PC-ITEMS-PER-PANEL).                               17350000
173600     COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                             17360000
173700         PV-FIRST-BLOCK-IN-ARRAY + 1.                             17370000
173800                                                                  17380000
173900     IF (PV-FIRST-BLOCK-IN-RANGE < PV-FIRST-BLOCK-IN-ARRAY) OR    17390000
174000        (PV-LAST-BLOCK-IN-RANGE  > PV-NEXT-BLOCK-IN-ARRAY)        17400000
174100         MOVE +1                   TO ASC-BLK-SUB                 17410000
174200         PERFORM 5100-WRITE-TEMP-STORAGE                          17420000
174300         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         17430000
174400             PV-FIRST-BLOCK-IN-ARRAY - 1                          17440000
174500                                                                  17450000
174600         PERFORM                                                  17460000
174700             UNTIL PV-FIRST-BLOCK-IN-RANGE >                      17470000
174800                   PV-PREV-BLOCK-IN-ARRAY                         17480000
174900             MOVE PV-FIRST-BLOCK-IN-RANGE                         17490000
175000                                   TO PV-BLOCK-NUMBER             17500000
175100             PERFORM 4410-READ-TEMP-STORAGE                       17510000
175200             PERFORM 3510-MARK-SELECTED-INDS                      17520000
175300                 VARYING ASC-ITEM-SUB                             17530000
175400                 FROM 1 BY 1                                      17540000
175500                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          17550000
175600             PERFORM 5100-WRITE-TEMP-STORAGE                      17560000
175700             ADD +1                TO PV-FIRST-BLOCK-IN-RANGE     17570000
175800         END-PERFORM                                              17580000
175900                                                                  17590000
176000         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         17600000
176100             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     17610000
176200         PERFORM                                                  17620000
176300             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       17630000
176400                   PV-LAST-BLOCK-IN-RANGE                         17640000
176500             MOVE PV-NEXT-BLOCK-IN-ARRAY                          17650000
176600                                   TO PV-BLOCK-NUMBER             17660000
176700             PERFORM 4410-READ-TEMP-STORAGE                       17670000
176800             PERFORM 3510-MARK-SELECTED-INDS                      17680000
176900                 VARYING ASC-ITEM-SUB                             17690000
177000                 FROM 1 BY 1                                      17700000
177100                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          17710000
177200             PERFORM 5100-WRITE-TEMP-STORAGE                      17720000
177300             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      17730000
177400         END-PERFORM                                              17740000
177500                                                                  17750000
177600         MOVE PV-FIRST-BLOCK-IN-ARRAY                             17760000
177700                                   TO PV-BLOCK-NUMBER             17770000
177800         PERFORM 4410-READ-TEMP-STORAGE                           17780000
177900     END-IF.                                                      17790000
178000                                                                  17800000
178100     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE 17810000
178200                                      ASC-END-OF-SELECTED-RANGE.  17820000
178300                                                                  17830000
178400*----------------------------------------------------------------*17840000
178500* SET THE SELECTION INDICATOR TO 'S' WITHIN THE RANGE.           *17850000
178600*----------------------------------------------------------------*17860000
178700 3510-MARK-SELECTED-INDS.                                         17870000
178800                                                                  17880000
178900     IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         17890000
179000                                ASC-ITEM-SUB) >                   17900000
179100         ASC-START-OF-SELECTED-RANGE)                             17910000
179200     OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         17920000
179300                                ASC-ITEM-SUB) =                   17930000
179400         ASC-START-OF-SELECTED-RANGE)                             17940000
179500                                                                  17950000
179600         IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     17960000
179700                                    ASC-ITEM-SUB) <               17970000
179800             ASC-END-OF-SELECTED-RANGE)                           17980000
179900         OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     17990000
180000                                    ASC-ITEM-SUB) =               18000000
180100             ASC-END-OF-SELECTED-RANGE)                           18010000
180200                                                                  18020000
180300             IF NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          18030000
180400                 SET ASC-SELECT     (ASC-BLK-SUB  ASC-ITEM-SUB)   18040000
180500                     ASC-TEMP-SELECT(ASC-BLK-SUB  ASC-ITEM-SUB)   18050000
180600                               TO TRUE                            18060000
180700                 SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB)              18070000
180800                               TO TRUE                            18080000
180900                 ADD +1        TO ASC-NUMBER-OF-SELECTED-ITEMS    18090000
181000             END-IF                                               18100000
181100         END-IF                                                   18110000
181200     END-IF.                                                      18120000
181300                                                                  18130000
181400*----------------------------------------------------------------*18140000
181500*    INITIALIZE BOTH BLOCKS IN THE ARRAY.                        *18150000
181600*    INITIALIZE ALL COUNTERS AND FLAGS.                          *18160000
181700*    READ THE DATA BASE FOR THE 1ST TIME AND FILL UP THE ARRAY.  *18170000
181800*    DISPLAY THE PANEL TO USER.                                  *18180000
181900*----------------------------------------------------------------*18190000
182000 4000-BUILD-INITIAL-PANEL.                                        18200000
182100                                                                  18210000
182200     INITIALIZE                  ASC-BLOCK-ENTRIES (1)            18220000
182300                                 ASC-BLOCK-ENTRIES (2).           18230000
182400     MOVE +1                 TO ASC-BLK-SUB.                      18240000
182500     SET ASC-ITEMS-LEFT-ON-DB                                     18250000
182600                             TO TRUE.                             18260000
182700                                                                  18270000
182800     MOVE ZERO               TO ASC-ITEM-SUB                      18280000
182900                                ASC-NUMBER-OF-ITEMS-READ          18290000
183000                                ASC-NUMBER-OF-SELECTED-ITEMS      18300000
183100                                ASC-HIGHEST-BLOCK-WRITTEN         18310000
183200                                ASC-START-OF-SELECTED-RANGE       18320000
183300                                ASC-END-OF-SELECTED-RANGE         18330000
183400                                ASC-ITEM-AT-TOP-OF-PANEL          18340000
183500                                ASC-TOT-CARTON-QTY                18350000
183600                                                                  18360000
183700     MOVE ASC-SHIPT-UNT-ID            TO DK-SHIPT-UNT-ID          18370000
183800     IF ASC-SHIPT-UNT-ID > 0                                      18380000
183900         PERFORM 4350-GET-CART-INFO                               18390000
184000         PERFORM 4355-GET-CART-DATE-TIME                          18400000
184100         IF SUT00024-PRNT-CART-ID  =  DK-SHIPT-UNT-ID OR          18410027
184200            SUT00024-PRNT-CART-ID  =  0                           18420027
184300             MOVE SPACES           TO AMSTO                       18430027
184400                                      AMSTNBRO                    18440027
184500         ELSE                                                     18450027
184600             MOVE 'MASTER SML.:'     TO AMSTO                     18460027
184700             MOVE SUT00024-PRNT-CART-ID  TO PV-DISPLAY-PARENT     18470027
184800             MOVE PV-DISPLAY-PARENT  TO AMSTNBRO                  18480027
184900                                                                  18490027
185000         END-IF                                                   18500027
185100         PERFORM 4360-RETRIEVE-PO-INFO                            18510000
185200         PERFORM 4100-OPEN-CURSOR                                 18520000
185300         PERFORM 4300-READ-ITEMS-FROM-DB                          18530000
185400         PERFORM 4200-CLOSE-CURSOR                                18540000
185500     END-IF.                                                      18550000
185600                                                                  18560000
185700     MOVE +1                   TO  PV-TOP-ITEM.                   18570000
185800*    IF MORE THAN ONE ITEM WAS SELECTED, SHOW A BLANK LIST        18580000
185900*    FOR THOSE ITEMS THAT WERE NOT FOUND.  THIS ALLOWS THE USER   18590000
186000*    TO BROWSE THRU THEIR SELECTIONS WITHOUT JUMPING BACK TO      18600000
186100*    THE ORIGINAL SCREEN.                                         18610000
186200     EVALUATE TRUE                                                18620000
186300         WHEN SU010-SELECTED-ITEMS > 1                            18630000
186400             IF  ASC-NUMBER-OF-ITEMS-READ = ZERO                  18640000
186500                 SET DP020-MSG-FATAL   TO  TRUE                   18650000
186600                 MOVE PC-TSYMSG-00050  TO  DP020-MSG-NUMBER       18660000
186700                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              18670000
186800                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             18680000
186900             ELSE                                                 18690000
187000                 MOVE -1               TO ASTRTITL                18700000
187100                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              18710000
187200                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             18720000
187300             END-IF                                               18730000
187400         WHEN OTHER                                               18740000
187500             IF  ASC-NUMBER-OF-ITEMS-READ = ZERO                  18750000
187600                 SET DP020-NEXT-ACT-APPL-ERROR TO TRUE            18760000
187700                 SET DP020-MSG-FATAL   TO  TRUE                   18770000
187800                 MOVE PC-TSYMSG-00050  TO  DP020-MSG-NUMBER       18780000
187900             ELSE                                                 18790000
188000                 MOVE -1               TO ASTRTITL                18800000
188100                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              18810000
188200                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             18820000
188300             END-IF                                               18830000
188400     END-EVALUATE.                                                18840000
188500                                                                  18850000
188600*----------------------------------------------------------------*18860000
188700*    FILL TOP OF SCREEN WITH DATA                                 18870000
188800*----------------------------------------------------------------*18880000
188900                                                                  18890000
193400*----------------------------------------------------------------*19340000
193500*    RETRIEVE TRLR ID                                             19350000
193600*----------------------------------------------------------------*19360000
193700*----------------------------------------------------------------*19370000
193800* OPEN THE CURSOR                                                 19380000
193900*----------------------------------------------------------------*19390000
194000 4100-OPEN-CURSOR.                                                19400000
194100                                                                  19410000
194200     PERFORM                                                      19420000
194300         WITH TEST AFTER                                          19430000
194400         VARYING PV-RETRY-COUNTER                                 19440000
194500         FROM 1 BY 1                                              19450000
194600         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               19460000
194700                   OR (SQLCODE = ZERO))                           19470000
194800                                                                  19480000
194900         EXEC SQL                                                 19490000
195000              OPEN CARTON-DETAIL-CSR                              19500000
195100         END-EXEC                                                 19510000
195200                                                                  19520000
195300         EVALUATE TRUE                                            19530000
195400             WHEN SQLCODE = ZERO                                  19540000
195500             WHEN SQLCODE = -904                                  19550000
195600             WHEN SQLCODE = -911                                  19560000
195700             WHEN SQLCODE = -913                                  19570000
195800                 CONTINUE                                         19580000
195900             WHEN SQLWARN0 NOT = SPACES                           19590000
196000             WHEN SQLCODE < ZERO                                  19600000
196100             WHEN SQLCODE > ZERO                                  19610000
196200                 MOVE '4100-OPEN-CURSOR' TO DP013-PARAGRAPH       19620000
196300                 MOVE 'OPEN CURSOR PROBLEM    - '                 19630000
196400                                   TO DP013-MESSAGE-TEXT (1)      19640000
196500                 MOVE SQLCA        TO DP013-SQLCA                 19650000
196600                 MOVE 'SUT_OTBND_UPC'                             19660000
196700                                   TO DP013-DB2-TABLE-NAME (1)    19670000
196800                 MOVE 'SUT_PKD_UPC'                               19680000
196900                                   TO DP013-DB2-TABLE-NAME (2)    19690000
197000                 MOVE 'SUT_OTBND_CART'                            19700000
197100                                   TO DP013-DB2-TABLE-NAME (3)    19710000
197200                 MOVE 'TSUQADJ'                                   19720000
197300                                   TO DP013-DB2-TABLE-NAME (4)    19730000
197400                 SET DP013-DB2-ABEND                              19740000
197500                     DP013-XCTL-DISPLAY-RESTART TO TRUE           19750000
197600                 PERFORM DP013-0000-PROCESS-ABEND                 19760000
197700         END-EVALUATE                                             19770000
197800     END-PERFORM.                                                 19780000
197900*                                                                 19790000
198000     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        19800000
198100         MOVE '4100-OPEN-CURSOR'   TO DP013-PARAGRAPH             19810000
198200         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR'   19820000
198300                                   TO DP013-MESSAGE-TEXT (1)      19830000
198400         MOVE SQLCA                TO DP013-SQLCA                 19840000
198500         MOVE 'SUT_OTBND_UPC'      TO DP013-DB2-TABLE-NAME (1)    19850000
198600         MOVE 'SUT_PKD_UPC'        TO DP013-DB2-TABLE-NAME (2)    19860000
198700         MOVE 'SUT_OTBND_CART'     TO DP013-DB2-TABLE-NAME (3)    19870000
198800         MOVE 'TSUQADJ'            TO DP013-DB2-TABLE-NAME (4)    19880000
198900         SET DP013-DB2-ABEND                                      19890000
199000             DP013-XCTL-DISPLAY-RESTART TO TRUE                   19900000
199100         PERFORM DP013-0000-PROCESS-ABEND                         19910000
199200     END-IF.                                                      19920000
199300                                                                  19930000
199400*----------------------------------------------------------------*19940000
199500* CLOSE THE CURSOR.                                               19950000
199600*   IN THIS PARTICULAR APPLICATION ONE OF 2 DIFFERENT CURSORS    *19960000
199700*   WILL BE CLOSED DEPENDING ON THE CRITERIA SPECIFIED BY THE    *19970000
199800*   USER.                                                        *19980000
199900*----------------------------------------------------------------*19990000
200000 4200-CLOSE-CURSOR.                                               20000000
200100                                                                  20010000
200200     EXEC SQL                                                     20020000
200300         CLOSE CARTON-DETAIL-CSR                                  20030000
200400     END-EXEC.                                                    20040000
200500                                                                  20050000
200600     EVALUATE TRUE                                                20060000
200700         WHEN SQLCODE = ZERO                                      20070000
200800         WHEN SQLCODE = +100                                      20080000
200900             CONTINUE                                             20090000
201000         WHEN SQLWARN0 NOT = SPACES                               20100000
201100         WHEN SQLCODE < ZERO                                      20110000
201200         WHEN SQLCODE > ZERO                                      20120000
201300             MOVE '4200-CLOSE-CURSOR' TO DP013-PARAGRAPH          20130000
201400             MOVE 'CLOSE CURSOR PROBLEM   '                       20140000
201500                               TO DP013-MESSAGE-TEXT (1)          20150000
201600             MOVE SQLCA        TO DP013-SQLCA                     20160000
201700         MOVE 'SUT_OTBND_UPC'      TO DP013-DB2-TABLE-NAME (1)    20170000
201800         MOVE 'SUT_PKD_UPC'        TO DP013-DB2-TABLE-NAME (2)    20180000
201900         MOVE 'SUT_OTBND_CART'     TO DP013-DB2-TABLE-NAME (3)    20190000
202000         MOVE 'TSUQADJ'            TO DP013-DB2-TABLE-NAME (4)    20200000
202100             SET DP013-DB2-ABEND                                  20210000
202200                 DP013-XCTL-DISPLAY-RESTART TO TRUE               20220000
202300             PERFORM DP013-0000-PROCESS-ABEND                     20230000
202400     END-EVALUATE.                                                20240000
202500                                                                  20250000
202600*----------------------------------------------------------------*20260000
202700*    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE    *20270000
202800*    BLOCKS IN THE ARRAY.  WHENEVER BOTH BLOCKS BECOME FULL,     *20280000
202900*    WRITE OUT THE 1ST BLOCK TO TEMPORARY STORAGE, MOVE THE 2ND  *20290000
203000*    BLOCK IN THE ARRAY TO THE 1ST BLOCK, AND INITIALIZE THE     *20300000
203100*    2ND BLOCK MAKING IT AVAILABLE TO BE USED.                   *20310000
203200*                                                                *20320000
203300*    DUE TO THE SIZE OF THE TABLE, AND THE ORDER IN WHICH THE    *20330000
203400*    ROWS ARE SORTED, THE ENTIRE TABLE IS READ INTO THE PROGRAM  *20340000
203500*    UPON INITIALIZATION.                                        *20350000
203600*----------------------------------------------------------------*20360000
203700 4300-READ-ITEMS-FROM-DB.                                         20370000
203800                                                                  20380000
203900     PERFORM                                                      20390000
204000         VARYING PV-READ-COUNT                                    20400000
204100         FROM 1 BY 1                                              20410000
204200         UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                    20420000
204300            OR (ASC-NO-ITEMS-LEFT-ON-DB))                         20430000
204400                                                                  20440000
204500         PERFORM 4310-FETCH                                       20450000
204600                                                                  20460000
204700         IF  ASC-ITEMS-LEFT-ON-DB                                 20470000
204800             IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                20480000
204900                 ADD +1            TO ASC-ITEM-SUB                20490000
205000             ELSE                                                 20500000
205100                 ADD +1            TO ASC-BLK-SUB                 20510000
205200                 MOVE +1           TO ASC-ITEM-SUB                20520000
205300                                                                  20530000
205400                 IF  ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY         20540000
205500                     MOVE +1       TO ASC-BLK-SUB                 20550000
205600                     SET ASC-BLOCK-MODIFIED (1) TO TRUE           20560000
205700                     PERFORM 5100-WRITE-TEMP-STORAGE              20570000
205800                     MOVE ASC-BLOCK-ENTRIES                       20580000
205900                                   (PC-MAX-BLOCKS-IN-ARRAY)       20590000
206000                                TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB) 20600000
206100                     ADD +1        TO ASC-BLK-SUB                 20610000
206200                     INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)   20620000
206300                     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)      20630000
206400                                                          TO TRUE 20640000
206500                 END-IF                                           20650000
206600             END-IF                                               20660000
206700             ADD +1                TO ASC-NUMBER-OF-ITEMS-READ    20670000
206800             SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB) TO TRUE          20680000
206900             MOVE ASC-NUMBER-OF-ITEMS-READ                        20690000
207000                                   TO ASC-LIST-ITEM-NUMBER        20700000
207100                                      (ASC-BLK-SUB ASC-ITEM-SUB)  20710000
207200             IF  ASC-NUMBER-OF-ITEMS-READ > ZERO                  20720000
207300                 PERFORM 4310A-MOVE-FIELDS                        20730000
207400             END-IF                                               20740000
207500         END-IF                                                   20750000
207600     END-PERFORM.                                                 20760000
207700                                                                  20770000
207800     IF  ASC-NUMBER-OF-ITEMS-READ > ZERO                          20780000
207900         MOVE +1               TO ASC-BLK-SUB                     20790000
208000         PERFORM 5100-WRITE-TEMP-STORAGE                          20800000
208100         ADD +1                TO ASC-BLK-SUB                     20810000
208200         PERFORM 5100-WRITE-TEMP-STORAGE                          20820000
208300                                                                  20830000
208400         MOVE 1                TO ASC-BLK-SUB                     20840000
208500                                  PV-BLOCK-NUMBER                 20850000
208600         PERFORM 4410-READ-TEMP-STORAGE                           20860000
208700         IF  ASC-HIGHEST-BLOCK-WRITTEN GREATER THAN 1             20870000
208800             MOVE 2            TO ASC-BLK-SUB                     20880000
208900                                  PV-BLOCK-NUMBER                 20890000
209000             PERFORM 4410-READ-TEMP-STORAGE                       20900000
209100         END-IF                                                   20910000
209200     END-IF.                                                      20920000
209300                                                                  20930000
209400*----------------------------------------------------------------*20940000
209500*   GET RCVR SEQ FOR CARTONS CREATED BY ASN                      *20950000
209600*----------------------------------------------------------------*20960000
209700 4305-GET-RCVR-SEQ.                                               20970000
209800     MOVE ASC-SHIPT-UNT-ID           TO DK-SHIPT-UNT-ID           20980000
209900                                                                  20990000
210000     EXEC SQL                                                     21000000
210100          SELECT  B.REC_SEQ_NBR                                   21010000
210200            INTO  :PKSLIP-REC-SEQ-NBR                             21020000
210300            FROM  SUT_OTBND_VND A                                 21030000
210400                 ,TPKSLIP  B                                      21040000
210500           WHERE  A.SHIPT_UNT_ID      = :DK-SHIPT-UNT-ID          21050000
210600             AND  A.PO_NBR            = B.PO_NBR                  21060000
210700             AND  A.PKSL_SEQ_NBR      = B.SEQ_NBR                 21070000
210800             AND  B.VER_STAT_CDE      = 'A'                       21080000
210900       END-EXEC.                                                  21090000
211000                                                                  21100000
211100     EVALUATE TRUE                                                21110000
211200         WHEN SQLCODE = ZERO                                      21120000
211300             MOVE PKSLIP-REC-SEQ-NBR  TO DK-RCVR                  21130017
211400         WHEN SQLCODE = +100                                      21140000
211500              CONTINUE                                            21150000
211600         WHEN SQLWARN0 NOT = SPACE                                21160000
211700         WHEN SQLCODE NOT = ZERO                                  21170000
211800              MOVE '4305-GET-RCVR-SEQ' TO DP013-PARAGRAPH         21180000
211900              MOVE 'GET RECV FROM PACKSLIP'                       21190000
212000                               TO DP013-MESSAGE-TEXT (1)          21200000
212100              MOVE SQLCA       TO DP013-SQLCA                     21210000
212200              MOVE 'TPKSLIP '   TO DP013-DB2-TABLE-NAME (1)       21220000
212300              MOVE 'SUT00026'   TO DP013-DB2-TABLE-NAME (1)       21230000
212400              SET DP013-DB2-ABEND TO TRUE                         21240000
212500              PERFORM DP013-0000-PROCESS-ABEND                    21250000
212600     END-EVALUATE.                                                21260000
212700                                                                  21270000
212800                                                                  21280000
212900 4310-FETCH.                                                      21290000
213000                                                                  21300000
213100     EXEC SQL                                                     21310000
213200          FETCH CARTON-DETAIL-CSR                                 21320000
213300         INTO                                                     21330000
213400              :PV-REC-TYPE                                        21340016
213500            , :SUT00028-SHIPT-UNT-ID                              21350000
213600            , :SUT00028-TRN-NBR                                   21360000
213700            , :SUT00028-RCVR-SEQ-NBR                              21370000
213800            , :SUT00028-TRN-LNE-NBR                               21380000
213900            , :SUT00028-UPC-NBR                                   21390000
214000            , :SUT00028-SHPD-UNT-QTY                              21400000
214100            , :SUT00025-PKD-QTY                                   21410000
214200            , :SUT00025-MODU-NBR                                  21420000
214300            , :SUT00025-PKD-BY-USR-ID                             21430000
214400            , :PV-USA-DATE                                        21440000
214500            , :PV-JIS-TIME                                        21450000
214600            , :SUT00024-CART-SRC-CDE                              21460000
214700     END-EXEC.                                                    21470000
214800                                                                  21480000
214900     IF  SQLCODE EQUAL +0                                         21490011
215000         MOVE SUT00028-UPC-NBR  TO  DK-UPC-NBR                    21500011
215100     ELSE                                                         21510011
215200         IF  SQLCODE EQUAL + 100                                  21520011
215300             SET ASC-NO-ITEMS-LEFT-ON-DB TO TRUE                  21530011
215400         END-IF                                                   21540011
215500     END-IF.                                                      21550011
215600                                                                  21560000
215700 4310A-MOVE-FIELDS.                                               21570000
215800     MOVE PV-REC-TYPE  TO ASC-REC-TYPE (ASC-BLK-SUB ASC-ITEM-SUB) 21580016
215900     IF PV-REC-TYPE  = 'D'                                        21590016
216000         IF DK-UPC-NBR  =  DK-UPC-NBR-HOLD                        21600036
216100             MOVE SPACES   TO ASC-PO    (ASC-BLK-SUB ASC-ITEM-SUB)21610011
216200             MOVE SPACES   TO ASC-RCVR  (ASC-BLK-SUB ASC-ITEM-SUB)21620011
216300         ELSE                                                     21630011
216400             MOVE ' NOT ON' TO ASC-PO   (ASC-BLK-SUB ASC-ITEM-SUB)21640011
216500             MOVE 'PO'      TO ASC-RCVR (ASC-BLK-SUB ASC-ITEM-SUB)21650011
216600             MOVE DK-UPC-NBR TO  DK-UPC-NBR-HOLD                  21660011
216700         END-IF                                                   21670011
216800     ELSE                                                         21680003
216900         IF PV-REC-TYPE  = 'C'                                    21690016
217000             MOVE SPACES   TO ASC-PO    (ASC-BLK-SUB ASC-ITEM-SUB)21700010
217100             MOVE SPACES   TO ASC-RCVR  (ASC-BLK-SUB ASC-ITEM-SUB)21710010
217200         ELSE                                                     21720010
217300             MOVE DK-UPC-NBR          TO DK-UPC-NBR-HOLD          21730024
217400                                                                  21740048
217500*IF FAST XFER DISPLAY TRN # (CAN BE UP TO 9 DIGITS) NOT PO/RCVR   21750048
217600             IF PC046-SRC-FAST-XFER                               21760030
217700                MOVE SUT00028-TRN-NBR    TO DK-TRN-NBR            21770048
217800                MOVE DK-TRN-NBR(1:8)     TO ASC-TRN-NBR           21780048
217900                                        (ASC-BLK-SUB ASC-ITEM-SUB)21790030
218000                MOVE DK-TRN-NBR(9:1)     TO ASC-PO-DASH           21800048
218100                                        (ASC-BLK-SUB ASC-ITEM-SUB)21810033
218200                MOVE SPACES              TO ASC-RCVR              21820048
218300                                        (ASC-BLK-SUB ASC-ITEM-SUB)21830033
218400             ELSE                                                 21840030
218500                MOVE SUT00028-TRN-NBR    TO DK-PO-NBR             21850044
218600                MOVE DK-PO-NBR           TO ASC-PO                21860048
218700                                        (ASC-BLK-SUB ASC-ITEM-SUB)21870010
218800                IF  SUT00028-RCVR-SEQ-NBR = ZERO                  21880030
218900                    IF  SUT00028-TRN-NBR       =  ZERO  AND       21890030
219000                        SUT00028-TRN-LNE-NBR   =  ZERO            21900030
219100                          CONTINUE                                21910030
219200                    ELSE                                          21920030
219300                        PERFORM 4305-GET-RCVR-SEQ                 21930030
219400                        MOVE DK-RCVR TO ASC-RCVR                  21940030
219500                                        (ASC-BLK-SUB ASC-ITEM-SUB)21950030
219600                    END-IF                                        21960030
219700                ELSE                                              21970030
219800                    MOVE SUT00028-RCVR-SEQ-NBR   TO DK-RCVR       21980030
219900                    MOVE DK-RCVR TO ASC-RCVR                      21990030
220000                                        (ASC-BLK-SUB ASC-ITEM-SUB)22000030
220100                END-IF                                            22010030
220200             END-IF                                               22020030
220300         END-IF                                                   22030010
220400     END-IF                                                       22040010
220500                                                                  22050000
220600     MOVE SUT00028-TRN-LNE-NBR        TO ASC-LINE                 22060000
220700                              (ASC-BLK-SUB ASC-ITEM-SUB)          22070000
220800     IF PV-REC-TYPE  = 'C'                                        22080016
220900         MOVE SPACE                   TO ASC-PO-DASH              22090000
221000                              (ASC-BLK-SUB ASC-ITEM-SUB)          22100000
221100     ELSE                                                         22110000
221200         IF PV-REC-TYPE  = 'D'                                    22120016
221300             CONTINUE                                             22130003
221400         ELSE                                                     22140003
221500             IF PC046-SRC-FAST-XFER                               22150034
221600                CONTINUE                                          22160034
221700             ELSE                                                 22170034
221800                MOVE '-' TO ASC-PO-DASH (ASC-BLK-SUB ASC-ITEM-SUB)22180034
221900             END-IF                                               22190034
222000         END-IF                                                   22200003
222100     END-IF                                                       22210003
222200     PERFORM 4320-GET-SKU                                         22220000
222300     MOVE SUT00028-UPC-NBR TO ASC-UPC   (ASC-BLK-SUB ASC-ITEM-SUB)22230014
222400     EVALUATE PV-REC-TYPE                                         22240016
222500     WHEN 'A'                                                     22250000
222600         MOVE SUT00028-SHPD-UNT-QTY   TO ASC-SHIPD-QTY            22260000
222700                              (ASC-BLK-SUB ASC-ITEM-SUB)          22270000
222800                                                                  22280000
222900         MOVE SUT00025-PKD-QTY        TO ASC-PACKED-QTY           22290000
223000                              (ASC-BLK-SUB ASC-ITEM-SUB)          22300000
223100     WHEN 'B'                                                     22310000
223200         MOVE SUT00028-SHPD-UNT-QTY   TO ASC-SHIPD-QTY            22320000
223300                              (ASC-BLK-SUB ASC-ITEM-SUB)          22330000
223400                                                                  22340000
223500         MOVE ZEROES                  TO ASC-PACKED-QTY           22350000
223600                              (ASC-BLK-SUB ASC-ITEM-SUB)          22360000
223700     WHEN 'C'                                                     22370000
223800         MOVE  SUT00025-PKD-QTY                                   22380000
223900           TO  ASC-SHIPD-QTY (ASC-BLK-SUB ASC-ITEM-SUB)           22390000
224000                                                                  22400000
224100         COMPUTE ASC-PACKED-QTY(ASC-BLK-SUB ASC-ITEM-SUB) =       22410000
224200              SUT00028-SHPD-UNT-QTY - SUT00025-PKD-QTY            22420000
224300         END-COMPUTE                                              22430000
224400     WHEN 'D'                                                     22440009
224500         MOVE  SUT00025-PKD-QTY                                   22450009
224600           TO  ASC-SHIPD-QTY (ASC-BLK-SUB ASC-ITEM-SUB)           22460009
224700                                                                  22470009
224800         COMPUTE ASC-PACKED-QTY(ASC-BLK-SUB ASC-ITEM-SUB) =       22480009
224900              SUT00028-SHPD-UNT-QTY - SUT00025-PKD-QTY            22490009
225000         END-COMPUTE                                              22500009
225100                                                                  22510000
225200     END-EVALUATE                                                 22520000
225300                                                                  22530000
225400     EVALUATE PV-REC-TYPE                                         22540016
225500     WHEN 'A'                                                     22550000
225600         IF SUT00025-MODU-NBR = ZERO                              22560000
225700             MOVE 'BLD' TO ASC-MOD  (ASC-BLK-SUB ASC-ITEM-SUB)    22570014
225800         ELSE                                                     22580000
225900             MOVE SUT00025-MODU-NBR   TO ASC-MOD-N                22590000
226000                              (ASC-BLK-SUB ASC-ITEM-SUB)          22600000
226100         END-IF                                                   22610000
226200     WHEN 'B'                                                     22620000
226300         MOVE SUT00024-CART-SRC-CDE   TO ASC-MOD                  22630000
226400                              (ASC-BLK-SUB ASC-ITEM-SUB)          22640000
226500     WHEN 'C'                                                     22650000
226600         MOVE SUT00024-CART-SRC-CDE   TO ASC-MOD                  22660000
226700                              (ASC-BLK-SUB ASC-ITEM-SUB)          22670000
226800     WHEN 'D'                                                     22680009
226900         MOVE SUT00024-CART-SRC-CDE   TO ASC-MOD                  22690009
227000                              (ASC-BLK-SUB ASC-ITEM-SUB)          22700009
227100     END-EVALUATE                                                 22710000
227200                                                                  22720000
227300     MOVE SUT00025-PKD-BY-USR-ID      TO ASC-USERID               22730000
227400                              (ASC-BLK-SUB ASC-ITEM-SUB)          22740000
227500     MOVE PV-USA-DATE                 TO ASC-DATE                 22750000
227600                              (ASC-BLK-SUB ASC-ITEM-SUB)          22760000
227700     MOVE PV-JIS-TIME                 TO ASC-TIME                 22770000
227800                              (ASC-BLK-SUB ASC-ITEM-SUB).         22780000
227900                                                                  22790000
228200                                                                  22820000
228300 4320-GET-SKU.                                                    22830000
228400     INITIALIZE XL001-ITEM-COMMAREA                               22840000
228500     MOVE SUT00028-UPC-NBR TO XL001-KEY-UPC-NBR                   22850000
228600                                                                  22860000
228700     SET XL001-BY-UPC-NBR                                         22870000
228800         XL001-SELECT-SKU TO TRUE                                 22880000
228900                                                                  22890000
229000     CALL XL001-VSM-PGM USING DFHEIBLK                            22900000
229100                              XL001-COMMAREA                      22910000
229200                              XL001-ITEM-COMMAREA                 22920000
229300                                                                  22930000
229400     EVALUATE TRUE                                                22940000
229500         WHEN XL001-UPC-SQLCODE = ZERO                            22950000
229600             PERFORM 4322-ITEM-ID                                 22960000
229700         WHEN XL001-UPC-SQLCODE = +100                            22970000
229800             MOVE ZEROES TO ASC-SKU (ASC-BLK-SUB ASC-ITEM-SUB)    22980000
229900         WHEN XL001-UPC-CONTENTION                                22990000
230000             MOVE '4320-GET-SKU'     TO DP013-PARAGRAPH           23000000
230100             MOVE 'MAXIMUM RETRIES EXCEEDED'                      23010000
230200                                  TO DP013-MESSAGE-TEXT (1)       23020000
230300             MOVE XL001-UPC-SQLCODE  TO SQLCODE                   23030000
230400             MOVE SQLCA TO DP013-SQLCA                            23040000
230500             MOVE 'XLV_UPC' TO DP013-DB2-TABLE-NAME (1)           23050000
230600             SET DP013-DB2-ABEND                                  23060000
230700                 DP013-XCTL-DISPLAY-RESTART                       23070000
230800                                     TO TRUE                      23080000
230900             PERFORM DP013-0000-PROCESS-ABEND                     23090000
231000         WHEN OTHER                                               23100000
231100             MOVE '4320-GET-SKU'     TO DP013-PARAGRAPH           23110000
231200             MOVE 'SELECT FROM UPC VIEW'                          23120000
231300                                  TO DP013-MESSAGE-TEXT (1)       23130000
231400             MOVE XL001-UPC-SQLCODE                               23140000
231500                                     TO SQLCODE                   23150000
231600             MOVE SQLCA TO DP013-SQLCA                            23160000
231700             MOVE 'XLV_UPC' TO DP013-DB2-TABLE-NAME (1)           23170000
231800             SET DP013-DB2-ABEND                                  23180000
231900                 DP013-XCTL-DISPLAY-RESTART TO TRUE               23190000
232000             PERFORM DP013-0000-PROCESS-ABEND                     23200000
232100     END-EVALUATE.                                                23210000
232200                                                                  23220000
232300 4322-ITEM-ID.                                                    23230000
232400     EVALUATE TRUE                                                23240000
232500         WHEN XL001-SKU-SQLCODE = ZERO                            23250000
232600             MOVE XL001-SKU-NBR                                   23260000
232700                               TO ASC-SKU                         23270000
232800                                 (ASC-BLK-SUB ASC-ITEM-SUB)       23280000
232900         WHEN XL001-SKU-CONTENTION                                23290000
233000             MOVE '4322-ITEM-ID'                                  23300000
233100                               TO DP013-PARAGRAPH                 23310000
233200             MOVE 'MAXIMUM RETRIES EXCEEDED'                      23320000
233300                               TO DP013-MESSAGE-TEXT (1)          23330000
233400             MOVE XL001-SKU-SQLCODE                               23340000
233500                               TO SQLCODE                         23350000
233600             MOVE SQLCA        TO DP013-SQLCA                     23360000
233700             MOVE 'XLV_SKU'    TO DP013-DB2-TABLE-NAME (1)        23370000
233800             SET DP013-DB2-ABEND                                  23380000
233900                 DP013-XCTL-DISPLAY-RESTART                       23390000
234000                               TO TRUE                            23400000
234100             PERFORM DP013-0000-PROCESS-ABEND                     23410000
234200         WHEN OTHER                                               23420000
234300             MOVE '4322-ITEM-ID'                                  23430000
234400                               TO DP013-PARAGRAPH                 23440000
234500             MOVE 'SELECT FROM SKU VIEW'                          23450000
234600                               TO DP013-MESSAGE-TEXT (1)          23460000
234700             MOVE XL001-SKU-SQLCODE                               23470000
234800                               TO SQLCODE                         23480000
234900             MOVE SQLCA        TO DP013-SQLCA                     23490000
235000             MOVE 'XLV_SKU'    TO DP013-DB2-TABLE-NAME (1)        23500000
235100             SET DP013-DB2-ABEND                                  23510000
235200                 DP013-XCTL-DISPLAY-RESTART TO TRUE               23520000
235300             PERFORM DP013-0000-PROCESS-ABEND                     23530000
235400     END-EVALUATE.                                                23540000
235500                                                                  23550000
235600                                                                  23560000
235700 4350-GET-CART-INFO.                                              23570000
235800                                                                  23580000
235900     EXEC SQL                                                     23590000
236000          SELECT SUM(SHPD_UNT_QTY)                                23600000
236100            INTO :SUT00028-SHPD-UNT-QTY                           23610000
236200            FROM SUT_OTBND_UPC                                    23620000
236300           WHERE SHIPT_UNT_ID  =  :DK-SHIPT-UNT-ID                23630000
236400     END-EXEC.                                                    23640000
236500                                                                  23650000
236600     EVALUATE TRUE                                                23660000
236700         WHEN SQLCODE EQUAL 0                                     23670000
236800              MOVE SUT00028-SHPD-UNT-QTY                          23680000
236900                TO ASC-TOT-CARTON-QTY                             23690000
237000                                                                  23700000
237100         WHEN SQLCODE EQUAL -305                                  23710000
237200              MOVE ZERO                                           23720000
237300                TO ASC-TOT-CARTON-QTY                             23730000
237400                                                                  23740000
237500         WHEN OTHER                                               23750000
237600             MOVE '4350-GET-CART-INFO'  TO DP013-PARAGRAPH        23760000
237700             MOVE 'SELECT FROM OTBND CART'                        23770000
237800                                  TO DP013-MESSAGE-TEXT (1)       23780000
237900             MOVE SQLCA TO DP013-SQLCA                            23790000
238000             MOVE 'SUT_OTBND_CART' TO DP013-DB2-TABLE-NAME (1)    23800000
238100             SET DP013-DB2-ABEND            TO TRUE               23810000
238200             PERFORM DP013-0000-PROCESS-ABEND                     23820000
238300                                                                  23830000
238400     END-EVALUATE.                                                23840000
238500                                                                  23850000
238600                                                                  23860000
238700 4355-GET-CART-DATE-TIME.                                         23870000
238800                                                                  23880000
238900     EXEC SQL                                                     23890000
239000          SELECT CRE_DTE                                          23900000
239100                ,CRE_TM                                           23910000
239200                ,PRNT_CART_ID                                     23920027
239300            INTO :SUT00024-CRE-DTE                                23930000
239400                ,:SUT00024-CRE-TM                                 23940000
239500                ,:SUT00024-PRNT-CART-ID                           23950027
239600            FROM SUT_OTBND_CART                                   23960000
239700           WHERE SHIPT_UNT_ID  =  :DK-SHIPT-UNT-ID                23970000
239800     END-EXEC.                                                    23980000
239900                                                                  23990000
240000     EVALUATE TRUE                                                24000000
240100         WHEN SQLCODE EQUAL 0                                     24010000
240200              MOVE SUT00024-CRE-DTE                               24020000
240300                TO ASC-CRE-DATE                                   24030000
240400              MOVE SUT00024-CRE-TM                                24040000
240500                TO ASC-CRE-TIME                                   24050000
240600                                                                  24060000
240610         WHEN SQLCODE EQUAL +100                                  24061052
240620             MOVE ZERO TO SUT00024-PRNT-CART-ID                   24062055
240630*                                                                 24063056
240700         WHEN OTHER                                               24070000
240800             MOVE '4355-GET-CART-DATE'  TO DP013-PARAGRAPH        24080000
240900             MOVE 'SELECT FROM OTBND CART'                        24090000
241000                                  TO DP013-MESSAGE-TEXT (1)       24100000
241100             MOVE SQLCA TO DP013-SQLCA                            24110000
241200             MOVE 'SUT_OTBND_CART' TO DP013-DB2-TABLE-NAME (1)    24120000
241300             SET DP013-DB2-ABEND            TO TRUE               24130000
241400             PERFORM DP013-0000-PROCESS-ABEND                     24140000
241500                                                                  24150000
241600     END-EVALUATE.                                                24160000
241700                                                                  24170000
241800                                                                  24180000
241900*----------------------------------------------------------------*24190000
242000* CALL PCKUT713 TO RETRIEVE PO, RCVR, DEST-OPER-UNT-ID, ETC.      24200000
242100*----------------------------------------------------------------*24210000
242200 4360-RETRIEVE-PO-INFO.                                           24220000
242300                                                                  24230000
242400     INITIALIZE  PC046-COMMAREA-REC.                              24240000
242500     MOVE ASC-SHIPT-UNT-ID TO PC046-CARTON-ID.                    24250000
242600                                                                  24260000
242700     CALL PC046-CARTON-STATUS-MODULE                              24270000
242800             USING DFHEIBLK                                       24280000
242900             PC046-COMMAREA                                       24290000
243000             PC046-COMMAREA-REC                                   24300000
243100     END-CALL.                                                    24310000
243200                                                                  24320000
243300     IF  PC046-SUCCESSFUL  OR                                     24330001
243500         PC046-CRTN-STAT-ERROR                                    24350001
243700         MOVE  PC046-CRTN-STAT-DESC    TO  ASC-CRTN-STAT          24370000
243800                                                                  24380000
243900         EVALUATE TRUE                                            24390000
244000             WHEN PC046-SRC-ASN                                   24400000
244100                  MOVE 'CREATED BY ASN      ' TO  ASC-CRTN-SRC    24410000
244200             WHEN PC046-SRC-CHECKED-IN                            24420000
244300                  MOVE 'CHECK-IN            ' TO  ASC-CRTN-SRC    24430000
244400             WHEN PC046-SRC-CASEPACK-SPLIT                        24440000
244500                  MOVE 'CASEPACK SPLIT      ' TO  ASC-CRTN-SRC    24450000
244600             WHEN PC046-SRC-MANUAL                                24460000
244700                  MOVE 'MISCELLANEOUS LABEL ' TO  ASC-CRTN-SRC    24470000
244800             WHEN PC046-SRC-P2L                                   24480000
244900                  MOVE 'PACK-TO-LIGHT       ' TO  ASC-CRTN-SRC    24490000
245000             WHEN PC046-SRC-RECV                                  24500000
245100                  MOVE 'CREATED IN RECEIVING' TO  ASC-CRTN-SRC    24510000
245200             WHEN PC046-SRC-RDM                                   24520000
245300                  MOVE 'CREATED BY RDM      ' TO  ASC-CRTN-SRC    24530000
245400             WHEN PC046-SRC-SMOOTHING                             24540000
245500                  MOVE 'SMOOTHING           ' TO  ASC-CRTN-SRC    24550000
245600             WHEN PC046-SRC-FAST-XFER                             24560000
245700                  MOVE 'FAST TRANSFER       ' TO  ASC-CRTN-SRC    24570000
245800             WHEN PC046-SRC-MSTR-CNTR                             24580000
245900                  MOVE 'MASTER CONTAINER    ' TO  ASC-CRTN-SRC    24590000
246000             WHEN PC046-SRC-CRTN-BULD                             24600000
246100                  MOVE 'CARTON BUILD        ' TO  ASC-CRTN-SRC    24610000
246110             WHEN PC046-SRC-3WD                                   24611058
246120                  MOVE '3RD PARTY WHSE DISTR' TO  ASC-CRTN-SRC    24612058
246200             WHEN PC046-SRC-UNKNOWN                               24620000
246300                  MOVE 'UNKNOWN             ' TO  ASC-CRTN-SRC    24630000
246400             WHEN OTHER                                           24640000
246500                  MOVE  PC046-SHPUNT-SRC-ID   TO  ASC-CRTN-SRC    24650000
246600         END-EVALUATE                                             24660000
246700                                                                  24670000
246800*        MOVE  PC046-TRLR-SRL          TO  ASC-TRLR-SRL           24680000
246900         MOVE  PC046-OTBD-TRIP-ID      TO  ASC-OTBND-TRIP-ID      24690000
247000         MOVE  PC046-TRLR-ID           TO  ASC-TRLR-ID            24700000
247100         MOVE  PC046-SCAC              TO  ASC-SCAC               24710000
247200         MOVE  PC046-DOOR-ID           TO  ASC-DOOR-ID            24720000
247300         MOVE  PC046-DEST-OPER-UNT-ID  TO  ASC-STR-NBR            24730000
247400         IF  PC046-TRIP-STATUS  >  SPACES                         24740000
247500             PERFORM 4365-GET-TRLR-STATUS                         24750000
247600         END-IF                                                   24760000
247700                                                                  24770000
247800     END-IF.                                                      24780000
247900                                                                  24790000
248000 4365-GET-TRLR-STATUS.                                            24800000
248100                                                                  24810000
248200     EXEC SQL                                                     24820000
248300          SELECT STAT_SHRT_DESC                                   24830000
248400            INTO :SUOBSC-STAT-SHRT-DESC                           24840000
248500            FROM TSUOBSC                                          24850000
248600           WHERE TRIP_STAT_CDE  =  :PC046-TRIP-STATUS             24860000
248700     END-EXEC.                                                    24870000
248800                                                                  24880000
248900     EVALUATE TRUE                                                24890000
249000         WHEN SQLCODE EQUAL 0                                     24900000
249100              MOVE  SUOBSC-STAT-SHRT-DESC TO  ASC-TRLR-STATUS     24910000
249200                                                                  24920000
249300         WHEN OTHER                                               24930000
249400             MOVE '4365-GET-TRLR-STAT'  TO DP013-PARAGRAPH        24940000
249500             MOVE 'SELECT FROM OTBND CART'                        24950000
249600                                  TO DP013-MESSAGE-TEXT (1)       24960000
249700             MOVE SQLCA TO DP013-SQLCA                            24970000
249800             MOVE 'TSUOBSC' TO DP013-DB2-TABLE-NAME (1)           24980000
249900             SET DP013-DB2-ABEND            TO TRUE               24990000
250000             PERFORM DP013-0000-PROCESS-ABEND                     25000000
250100                                                                  25010000
250200     END-EVALUATE.                                                25020000
250300                                                                  25030000
250400                                                                  25040000
250500*----------------------------------------------------------------*25050000
250600* MOVE THE DISPLAYED FIELDS FROM THE COMMAREA TO THE SCREEN.     *25060000
250700*----------------------------------------------------------------*25070000
250800 4400-MOVE-COMMAREA-TO-SCREEN.                                    25080000
250900     IF  (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1))             25090000
251000         AND (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1)))          25100000
251100         OR  (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)))          25110000
251200             MOVE +1    TO ASC-BLK-SUB                            25120000
251300             PERFORM 5100-WRITE-TEMP-STORAGE                      25130000
251400             ADD +1     TO ASC-BLK-SUB                            25140000
251500             PERFORM 5100-WRITE-TEMP-STORAGE                      25150000
251600             DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             25160000
251700                 GIVING PV-BLOCK-NUMBER                           25170000
251800                 REMAINDER PV-REMAINDER                           25180000
251900             IF  PV-REMAINDER > ZERO                              25190000
252000                 ADD +1 TO PV-BLOCK-NUMBER                        25200000
252100             END-IF                                               25210000
252200             MOVE +1    TO ASC-BLK-SUB                            25220000
252300             PERFORM 4410-READ-TEMP-STORAGE                       25230000
252400             ADD +1     TO ASC-BLK-SUB                            25240000
252500                           PV-BLOCK-NUMBER                        25250000
252600             PERFORM 4410-READ-TEMP-STORAGE                       25260000
252700     END-IF.                                                      25270000
252800     MOVE +1            TO ASC-BLK-SUB.                           25280000
252900     COMPUTE ASC-ITEM-SUB =                                       25290000
253000         ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              25300000
253100         + PC-ITEMS-PER-PANEL).                                   25310000
253200*                                                                 25320000
253300     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        25330000
253400         ADD +1         TO ASC-BLK-SUB                            25340000
253500         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            25350000
253600     END-IF.                                                      25360000
253700*                                                                 25370000
253800     COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           25380000
253900         ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                25390000
254000     PERFORM 4420-FORMAT-LIST-LINES                               25400000
254100         VARYING PV-SUB                                           25410000
254200         FROM PC-ITEMS-PER-PANEL BY -1                            25420000
254300         UNTIL PV-SUB < +1.                                       25430000
254400*                                                                 25440000
254500     COMPUTE ASC-ITEMS-DISPLAYED =                                25450000
254600         ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).          25460000
254800     MOVE PV-TOP-ITEM              TO ASC-ITEM-AT-TOP-OF-PANEL    25480000
254900                                      ASTRTITO.                   25490000
255000     MOVE -1                       TO ASTRTITL.                   25500000
255100     SET DP030-SET-CURSOR-APPL-1   TO TRUE.                       25510000
255200     MOVE ASC-ITEM-AT-BOT-OF-PANEL TO AENDITO.                    25520000
255300     MOVE ASC-NUMBER-OF-ITEMS-READ TO ATOTITO.                    25530000
255400                                                                  25540000
255500     IF ASC-SHIPT-UNT-ID > 0                                      25550000
255600         MOVE ASC-SHIPT-UNT-ID            TO ASMLO                25560000
255700         MOVE ASC-STORE                   TO ASTOREO              25570000
255800         MOVE ASC-DOOR-ID                 TO ADOORO               25580000
255900         MOVE ASC-SCAC                    TO ASCACO               25590000
256000         MOVE ASC-TRLR-ID                 TO ATRLRO               25600000
256100         MOVE ASC-TRLR-STATUS             TO ATRSTATO             25610000
256200         MOVE ASC-OTBND-TRIP-ID           TO ATRIPO               25620000
256300         MOVE ASC-TOT-CARTON-QTY          TO ACTNQTYO             25630000
256400         MOVE ASC-CRTN-STAT               TO ACRSTATO             25640000
256500         MOVE ASC-CRTN-SRC                TO ASRCEO               25650000
256600         MOVE ASC-CRE-DATE                TO ACRDTEO              25660000
256700         MOVE ASC-CRE-TIME                TO ACRTMEO              25670000
256900         MOVE ASC-DOOR-ID                 TO ADOORO               25690000
257000         MOVE ASC-STR-NBR                 TO ASTOREO              25700000
257100     END-IF.                                                      25710000
257200                                                                  25720000
257300     IF  DP020-MSG-NUMBER-X = SPACE                               25730000
257400         IF  ASC-ITEM-AT-BOT-OF-PANEL < ASC-NUMBER-OF-ITEMS-READ  25740000
257500*            --- MORE ITEMS TO DISPLAY ----                       25750000
257600             MOVE PC-TSYMSG-00279  TO DP020-MSG-NUMBER            25760000
257700             SET DP020-MSG-INFORMATIONAL TO TRUE                  25770000
257800         END-IF                                                   25780000
257900     END-IF.                                                      25790000
258000                                                                  25800000
258100*----------------------------------------------------------------*25810000
258200*    READ A BLOCK FROM TEMPORARY STORAGE INTO THE ARRAY.         *25820000
258300*----------------------------------------------------------------*25830000
258400 4410-READ-TEMP-STORAGE.                                          25840000
258500                                                                  25850000
258600     EXEC CICS                                                    25860000
258700         READQ TS                                                 25870000
258800             QUEUE (ASC-LIST-QUEUE-NAME)                          25880000
258900             INTO  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               25890000
259000             ITEM  (PV-BLOCK-NUMBER)                              25900000
259100             RESP  (PV-CICS-RESP)                                 25910000
259200     END-EXEC.                                                    25920000
259300                                                                  25930000
259400     IF  ((PV-CICS-RESP = DFHRESP (NORMAL))                       25940000
259500       OR (PV-CICS-RESP = DFHRESP (ITEMERR)))                     25950000
259600         CONTINUE                                                 25960000
259700     ELSE                                                         25970000
259800         SET DP013-CICS-ABEND     TO TRUE                         25980000
259900         SET DP013-NO-ROLLBACK    TO TRUE                         25990000
260000         MOVE '4410-READ-TEMP-STORAGE'                            26000000
260100                                  TO DP013-PARAGRAPH              26010000
260200         MOVE 'ERROR TRYING TO READ FROM TEMP STORAGE QUEUE'      26020000
260300                                  TO DP013-MESSAGE-TEXT(1)        26030000
260400         PERFORM DP013-0000-PROCESS-ABEND                         26040000
260500     END-IF.                                                      26050000
260600                                                                  26060000
260700     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             26070000
260800*                                                                 26080000
260900     IF  PV-CICS-RESP = DFHRESP (ITEMERR)                         26090000
261000         INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               26100000
261100     END-IF.                                                      26110000
261200                                                                  26120000
261300*----------------------------------------------------------------*26130000
261400*    PROCESS THE ITEMS IN THE ARRAY AND MOVE THEM TO THE MAP.    *26140000
261500*----------------------------------------------------------------*26150000
261600 4420-FORMAT-LIST-LINES.                                          26160000
261700     IF  ASC-ITEM-AT-BOT-OF-PANEL > ASC-NUMBER-OF-ITEMS-READ      26170000
261800         SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                26180000
261900         MOVE SPACE                   TO MR-USERID      (PV-SUB)  26190000
262000                                         MR-PORCVR      (PV-SUB)  26200000
262100                                         MR-MOD         (PV-SUB)  26210000
262200                                         MR-DATE        (PV-SUB)  26220000
262300                                         MR-TIME        (PV-SUB)  26230000
262400                                         MR-SHIPD-QTY-X (PV-SUB)  26240000
262500         MOVE ZERO                    TO MR-LINE        (PV-SUB)  26250000
262600                                         MR-SKU         (PV-SUB)  26260000
262700                                         MR-UPC         (PV-SUB)  26270000
262800                                         MR-PACKED-QTY  (PV-SUB)  26280000
262900                                                                  26290000
263000     ELSE                                                         26300000
263100                                                                  26310000
263200         IF ASC-REC-TYPE  (ASC-BLK-SUB ASC-ITEM-SUB) = 'D'        26320015
263300             MOVE ASC-PO (ASC-BLK-SUB ASC-ITEM-SUB)               26330007
263400                                      TO MR-PO          (PV-SUB)  26340007
263500             MOVE ASC-RCVR (ASC-BLK-SUB ASC-ITEM-SUB)             26350007
263600                                      TO MR-RCVR        (PV-SUB)  26360007
263700         ELSE                                                     26370006
263800                                                                  26380049
263900             IF PC046-SRC-FAST-XFER                               26390032
264000                MOVE ASC-TRN-NBR (ASC-BLK-SUB ASC-ITEM-SUB)       26400046
264100                                      TO MR-PO          (PV-SUB)  26410043
264200                MOVE ASC-PO-DASH (ASC-BLK-SUB ASC-ITEM-SUB)       26420033
264300                                      TO MR-PO-DASH     (PV-SUB)  26430033
264400                MOVE ASC-RCVR (ASC-BLK-SUB ASC-ITEM-SUB)          26440033
264500                                      TO MR-RCVR        (PV-SUB)  26450033
264600             ELSE                                                 26460032
264700                MOVE ASC-PO (ASC-BLK-SUB ASC-ITEM-SUB)            26470032
264800                                      TO MR-PO          (PV-SUB)  26480006
264900                MOVE ASC-PO-DASH (ASC-BLK-SUB ASC-ITEM-SUB)       26490032
265000                                      TO MR-PO-DASH     (PV-SUB)  26500006
265100                MOVE ASC-RCVR (ASC-BLK-SUB ASC-ITEM-SUB)          26510032
265200                                      TO MR-RCVR        (PV-SUB)  26520006
265300             END-IF                                               26530032
265400         END-IF                                                   26540006
265500         MOVE ASC-LINE (ASC-BLK-SUB ASC-ITEM-SUB)                 26550006
265600                                      TO MR-LINE        (PV-SUB)  26560006
265700                                                                  26570006
265800         MOVE ASC-MOD (ASC-BLK-SUB ASC-ITEM-SUB)                  26580006
265900                                      TO MR-MOD         (PV-SUB)  26590000
266000         MOVE ASC-USERID (ASC-BLK-SUB ASC-ITEM-SUB)               26600000
266100                                      TO MR-USERID (PV-SUB)       26610000
266200         MOVE ASC-DATE (ASC-BLK-SUB ASC-ITEM-SUB)                 26620000
266300                                      TO MR-DATE        (PV-SUB)  26630000
266400         MOVE ASC-TIME (ASC-BLK-SUB ASC-ITEM-SUB)                 26640000
266500                                      TO MR-TIME        (PV-SUB)  26650000
266600         MOVE ASC-SKU (ASC-BLK-SUB ASC-ITEM-SUB)                  26660000
266700                                      TO MR-SKU         (PV-SUB)  26670000
266800         MOVE ASC-UPC (ASC-BLK-SUB ASC-ITEM-SUB)                  26680000
266900                                      TO MR-UPC         (PV-SUB)  26690000
267000         MOVE ASC-SHIPD-QTY (ASC-BLK-SUB ASC-ITEM-SUB)            26700000
267100                                      TO MR-SHIPD-QTY   (PV-SUB)  26710000
267200         MOVE ASC-PACKED-QTY (ASC-BLK-SUB ASC-ITEM-SUB)           26720000
267300                                      TO MR-PACKED-QTY  (PV-SUB)  26730000
267400                                                                  26740000
267500     END-IF.                                                      26750000
267600     SUBTRACT +1 FROM ASC-ITEM-SUB                                26760000
267700     IF  ASC-ITEM-SUB < + 1                                       26770000
267800         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  26780000
267900         MOVE +1                 TO ASC-BLK-SUB                   26790000
268000     END-IF.                                                      26800000
268100                                                                  26810000
271600*----------------------------------------------------------------*27160000
271700*    WRITE A NEW BLOCK FROM THE ARRAY TO TEMPORARY STORAGE.      *27170000
271800*    REWRITE AN EXISITING BLOCK ONLY IF IT HAS BEEN MODIFIED.    *27180000
271900*----------------------------------------------------------------*27190000
272000 5100-WRITE-TEMP-STORAGE.                                         27200000
272100     MOVE ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1)                     27210000
272200                                   TO PV-LIST-ITEM-NUMBER.        27220000
272300     COMPUTE PV-BLOCK-NUMBER =                                    27230000
272400         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    27240000
272500                                                                  27250000
272600     IF (PV-BLOCK-NUMBER < ASC-HIGHEST-BLOCK-WRITTEN)             27260000
272700     OR (PV-BLOCK-NUMBER = ASC-HIGHEST-BLOCK-WRITTEN)             27270000
272800         IF  ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                      27280000
272900             PERFORM 5105-REWRITE-ASC-LISTQ                       27290000
273000         END-IF                                                   27300000
273100     ELSE                                                         27310000
273200         COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                       27320000
273300         ASC-HIGHEST-BLOCK-WRITTEN + 1                            27330000
273400         PERFORM 5110-WRITE-ASC-LISTQ                             27340000
273500         ADD +1                    TO ASC-HIGHEST-BLOCK-WRITTEN   27350000
273600     END-IF.                                                      27360000
273700                                                                  27370000
273800     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             27380000
273900                                                                  27390000
274000******************************************************************27400000
274100** REWRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-    **27410000
274200** SPECIFIC COMMAREA.                                           **27420000
274300******************************************************************27430000
274400 5105-REWRITE-ASC-LISTQ.                                          27440000
274500     EXEC CICS                                                    27450000
274600         WRITEQ TS                                                27460000
274700             QUEUE (ASC-LIST-QUEUE-NAME)                          27470000
274800             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               27480000
274900             ITEM  (PV-BLOCK-NUMBER)                              27490000
275000             REWRITE                                              27500000
275100             RESP  (PV-CICS-RESP)                                 27510000
275200     END-EXEC.                                                    27520000
275300                                                                  27530000
275400     IF  PV-CICS-RESP = DFHRESP(NORMAL)                           27540000
275500         CONTINUE                                                 27550000
275600     ELSE                                                         27560000
275700         SET DP013-CICS-ABEND            TO TRUE                  27570000
275800         SET DP013-NO-ROLLBACK           TO TRUE                  27580000
275900         MOVE '5105-REWRITE-ASC-LISTQ'   TO DP013-PARAGRAPH       27590000
276000         MOVE 'ATTEMPTING TO REWRITE LIST TEMP STORAGE QUEUE'     27600000
276100                                         TO DP013-MESSAGE-TEXT(1) 27610000
276200         PERFORM DP013-0000-PROCESS-ABEND                         27620000
276300     END-IF.                                                      27630000
276400                                                                  27640000
276500******************************************************************27650000
276600** WRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-      **27660000
276700** SPECIFIC COMMAREA.                                           **27670000
276800******************************************************************27680000
276900 5110-WRITE-ASC-LISTQ.                                            27690000
277000     EXEC CICS                                                    27700000
277100         WRITEQ TS                                                27710000
277200             QUEUE (ASC-LIST-QUEUE-NAME)                          27720000
277300             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               27730000
277400             ITEM  (PV-BLOCK-NUMBER)                              27740000
277500             RESP  (PV-CICS-RESP)                                 27750000
277600     END-EXEC.                                                    27760000
277700     IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      27770000
277800         SET DP013-CICS-ABEND      TO TRUE                        27780000
277900         SET DP013-NO-ROLLBACK     TO TRUE                        27790000
278000         MOVE '5110-WRITE-ASC-LISTQ'                              27800000
278100                                   TO DP013-PARAGRAPH             27810000
278200         MOVE 'ATTEMPTING TO WRITE ASC LIST QUEUE'                27820000
278300                                   TO DP013-MESSAGE-TEXT(1)       27830000
278400         PERFORM DP013-0000-PROCESS-ABEND                         27840000
278500     END-IF.                                                      27850000
278600                                                                  27860000
282300*----------------------------------------------------------------*28230000
282400*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE.                *28240000
282500*----------------------------------------------------------------*28250000
282600 5205-WRITE-SEL-QUEUE.                                            28260000
282700                                                                  28270000
282800     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            28280000
282900                                   TO SU010-SELECTED-ITEMS.       28290000
283000                                                                  28300000
283100     EXEC CICS                                                    28310000
283200          WRITEQ TS                                               28320000
283300              QUEUE (ASC-SEL-QUEUE-NAME)                          28330000
283400              FROM  (SU010-SELECT-RECORD)                         28340000
283500              ITEM  (PV-SEL-QUEUE-ITEM)                           28350000
283600              RESP  (PV-CICS-RESP)                                28360000
283700     END-EXEC.                                                    28370000
283800                                                                  28380000
283900     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          28390000
284000         CONTINUE                                                 28400000
284100     ELSE                                                         28410000
284200         SET DP013-CICS-ABEND      TO TRUE                        28420000
284300         SET DP013-NO-ROLLBACK     TO TRUE                        28430000
284400         MOVE '5205-WRITE-SEL-QUEUE'  TO DP013-PARAGRAPH          28440000
284500         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          28450000
284600                                   TO DP013-MESSAGE-TEXT(1)       28460000
284700         PERFORM DP013-0000-PROCESS-ABEND                         28470000
284800     END-IF.                                                      28480000
284900******************************************************************28490000
285000** WHEN RETURNING TO THIS TRANSACTION FROM ANOTHER TRANSACTION, **28500000
285100** SETUP THE ARRAY AS IT WAS WHEN WE HAD LEFT PREVIOUSLY.  EDIT **28510000
285200** THE SELECTIONS MADE AT THAT TIME AND DISPLAY THE PANEL TO    **28520000
285300** THE USER.                                                    **28530000
285400******************************************************************28540000
285500 6000-REFRESH-PANEL-FROM-TEMP.                                    28550000
285600     IF  ASC-UPDATE-TSQ AND ASC-NUMBER-OF-SELECTED-ITEMS > 0      28560000
285700         SET ASC-NO-TSQ-UPDATE TO TRUE                            28570000
285800         MOVE ZERO                 TO PV-SAVE-ITEM                28580000
285900                                      PV-SEL-QUEUE-ITEM           28590000
286000         MOVE ASC-NUMBER-OF-SELECTED-ITEMS                        28600000
286100                                   TO PV-HOLD-SELECTED-ITEMS      28610000
286200         MOVE +1                   TO PV-ITEMS-PROCESSED          28620000
286300         PERFORM 6100-UPDATE-TSQ                                  28630000
286400             UNTIL PV-ITEMS-PROCESSED >                           28640000
286500                                     PV-HOLD-SELECTED-ITEMS       28650000
286600         INITIALIZE ASC-BLOCK-ENTRIES (1)                         28660000
286700                    ASC-BLOCK-ENTRIES (2)                         28670000
286800     END-IF.                                                      28680000
286900                                                                  28690000
287000*----------------------------------------------------------------*28700000
287100*    DELETE THE SELECTED ITEMS TEMP STORAGE QUEUE.               *28710000
287200*----------------------------------------------------------------*28720000
287300 6010-DELETE-SEL-QUEUE.                                           28730000
287400                                                                  28740000
287500     EXEC CICS                                                    28750000
287600         DELETEQ TS                                               28760000
287700             QUEUE (ASC-SEL-QUEUE-NAME)                           28770000
287800             RESP  (PV-CICS-RESP)                                 28780000
287900     END-EXEC.                                                    28790000
288000*                                                                 28800000
288100     IF ((PV-CICS-RESP = DFHRESP(NORMAL)) OR                      28810000
288200        (PV-CICS-RESP = DFHRESP(QIDERR)))                         28820000
288300         CONTINUE                                                 28830000
288400     ELSE                                                         28840000
288500         SET DP013-CICS-ABEND TO TRUE                             28850000
288600         SET DP013-NO-ROLLBACK TO TRUE                            28860000
288700         MOVE '6010-DELETE-SEL-QUEUE'                             28870000
288800                        TO DP013-PARAGRAPH                        28880000
288900         MOVE 'ERROR TRYING TO DELETE SELECTION TS QUEUE'         28890000
289000                        TO DP013-MESSAGE-TEXT (1)                 28900000
289100         PERFORM DP013-0000-PROCESS-ABEND                         28910000
289200     END-IF.                                                      28920000
289300                                                                  28930000
289400*----------------------------------------------------------------*28940000
289500*    INCREMENT THE TSQ ITEM NUMBER AND READ THE LIST QUEUE.      *28950000
289600*    LOOP THROUGH THE LIST QUEUE TO OBTAIN THE LINE ITEM NUMBER  *28960000
289700*    TO BE USED TO UPDATE (DESELECT) THE CORRECT LINE ITEM IN    *28970000
289800*    THE TEMP QUEUE.                                             *28980000
289900*----------------------------------------------------------------*28990000
290000 6100-UPDATE-TSQ.                                                 29000000
290100                                                                  29010000
290200     ADD 1                     TO  PV-SEL-QUEUE-ITEM.             29020000
290300     PERFORM 6150-READ-SEL-QUEUE.                                 29030000
290400     PERFORM                                                      29040000
290500         VARYING SU010-IDX                                        29050000
290600         FROM 1 BY 1                                              29060000
290700         UNTIL ((PV-ITEMS-PROCESSED > PV-HOLD-SELECTED-ITEMS)     29070000
290800         OR (SU010-IDX GREATER THAN SU010-MAX-ITEMS))             29080000
290900         IF  SU010-ACTION-SW (SU010-IDX) > SPACE                  29090000
291000             PERFORM 6110-PROCESS-ITEMS                           29100000
291100         END-IF                                                   29110000
291200         ADD +1                TO PV-ITEMS-PROCESSED              29120000
291300     END-PERFORM.                                                 29130000
291400     PERFORM 6111-WRITE-LIST-QUEUE.                               29140000
291500                                                                  29150000
291600*----------------------------------------------------------------*29160000
291700*    READ THE LIST QUEUE RECORD.                                 *29170000
291800*----------------------------------------------------------------*29180000
291900 6150-READ-SEL-QUEUE.                                             29190000
292000                                                                  29200000
292100     EXEC CICS                                                    29210000
292200          READQ TS                                                29220000
292300              QUEUE (ASC-SEL-QUEUE-NAME)                          29230000
292400              INTO  (SU010-SELECT-RECORD)                         29240000
292500              ITEM  (PV-SEL-QUEUE-ITEM)                           29250000
292600              RESP  (PV-CICS-RESP)                                29260000
292700     END-EXEC.                                                    29270000
292800*                                                                 29280000
292900     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          29290000
293000         CONTINUE                                                 29300000
293100     ELSE                                                         29310000
293200         SET DP013-CICS-ABEND      TO  TRUE                       29320000
293300         SET DP013-NO-ROLLBACK     TO  TRUE                       29330000
293400         MOVE '6150-READ-SEL-QUEUE' TO  DP013-PARAGRAPH           29340000
293500         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           29350000
293600                                   TO  DP013-MESSAGE-TEXT(1)      29360000
293700         PERFORM DP013-0000-PROCESS-ABEND                         29370000
293800     END-IF.                                                      29380000
293900                                                                  29390000
294000*----------------------------------------------------------------*29400000
294100*    CALCULATE THE TEMP QUEUE ITEM THAT MUST BE READ AND READ IT.*29410000
294200*    REWRITE THE CURRENT TEMP QUEUE ITEM IF NECESSARY.  CALCULATE*29420000
294300*    THE LINE ITEM OCCURENCE AND UPDATE (DESELECT) IT.           *29430000
294400*----------------------------------------------------------------*29440000
294500 6110-PROCESS-ITEMS.                                              29450000
294600                                                                  29460000
294700     COMPUTE PV-ITEM = 1 + ((SU010-ITEM (SU010-IDX) - 1)          29470000
294800                     / PC-ITEMS-PER-PANEL).                       29480000
294900                                                                  29490000
295000     IF  PV-ITEM NOT EQUAL PV-SAVE-ITEM                           29500000
295100         IF  PV-SAVE-ITEM NOT EQUAL ZERO                          29510000
295200             PERFORM 6111-WRITE-LIST-QUEUE                        29520000
295300         END-IF                                                   29530000
295400         MOVE PV-ITEM          TO PV-SAVE-ITEM                    29540000
295500                                                                  29550000
295600         PERFORM 6112-READ-LIST-QUEUE                             29560000
295700         IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)               29570000
295800             CONTINUE                                             29580000
295900         END-IF                                                   29590000
296000     END-IF.                                                      29600000
296100                                                                  29610000
296200     COMPUTE PV-SUB = (SU010-ITEM (SU010-IDX)                     29620000
296300                    - LQW-LIST-ITEM-NUMBER (1)) + 1.              29630000
296400     SET LQW-DESELECT (PV-SUB) TO    TRUE                         29640000
296500     MOVE LQW-SELECTED-SW (PV-SUB)                                29650000
296600                               TO LQW-TEMP-SELECTED-SW (PV-SUB).  29660000
296700                                                                  29670000
296800     EVALUATE TRUE                                                29680000
296900         WHEN SU010-INQ (SU010-IDX)                               29690000
297000              MOVE PC-INQ      TO LQW-ACTION (PV-SUB)             29700000
297100                                                                  29710000
297200         WHEN SU010-UPD (SU010-IDX)                               29720000
297300              MOVE PC-UPD      TO LQW-ACTION (PV-SUB)             29730000
297400                                                                  29740000
297500         WHEN SU010-DEL (SU010-IDX)                               29750000
297600              MOVE PC-DEL      TO LQW-ACTION (PV-SUB)             29760000
297700                                                                  29770000
297800         WHEN SU010-ERR (SU010-IDX)                               29780000
297900              MOVE PC-ERR      TO LQW-ACTION (PV-SUB)             29790000
298000     END-EVALUATE.                                                29800000
298100                                                                  29810000
298200     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                29820000
298300                                                                  29830000
298400*----------------------------------------------------------------*29840000
298500*    WRITE THE TS QUEUE RECORD JUST UPDATED IN C600.             *29850000
298600*----------------------------------------------------------------*29860000
298700 6111-WRITE-LIST-QUEUE.                                           29870000
298800                                                                  29880000
298900     EXEC CICS                                                    29890000
299000         WRITEQ TS                                                29900000
299100             QUEUE (ASC-LIST-QUEUE-NAME)                          29910000
299200             FROM  (LQW-LIST-QUEUE-WORK-AREA)                     29920000
299300             ITEM  (PV-SAVE-ITEM)                                 29930000
299400             REWRITE                                              29940000
299500             RESP  (PV-CICS-RESP)                                 29950000
299600     END-EXEC.                                                    29960000
299700*                                                                 29970000
299800     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          29980000
299900         CONTINUE                                                 29990000
300000     ELSE                                                         30000000
300100         SET DP013-CICS-ABEND  TO  TRUE                           30010000
300200         SET DP013-NO-ROLLBACK TO  TRUE                           30020000
300300         MOVE '6111-WRITE-LIST-QUEUE'                             30030000
300400                               TO  DP013-PARAGRAPH                30040000
300500         MOVE 'ATTEMPTING TO REWRITE LIST QUEUE'                  30050000
300600                               TO  DP013-MESSAGE-TEXT(1)          30060000
300700         PERFORM DP013-0000-PROCESS-ABEND                         30070000
300800     END-IF.                                                      30080000
300900                                                                  30090000
301000*----------------------------------------------------------------*30100000
301100*    READ THE TEMPORARY STORAGE QUEUE INTO A TEMPORARY WORK AREA.*30110000
301200*----------------------------------------------------------------*30120000
301300 6112-READ-LIST-QUEUE.                                            30130000
301400                                                                  30140000
301500     EXEC CICS                                                    30150000
301600         READQ TS                                                 30160000
301700             QUEUE (ASC-LIST-QUEUE-NAME)                          30170000
301800             INTO  (LQW-LIST-QUEUE-WORK-AREA)                     30180000
301900             ITEM  (PV-ITEM)                                      30190000
302000             RESP  (PV-CICS-RESP)                                 30200000
302100     END-EXEC.                                                    30210000
302200*                                                                 30220000
302300     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          30230000
302400         CONTINUE                                                 30240000
302500     ELSE                                                         30250000
302600         SET DP013-CICS-ABEND        TO TRUE                      30260000
302700         SET DP013-NO-ROLLBACK       TO TRUE                      30270000
302800         MOVE '6112-READ-LIST-QUEUE' TO DP013-PARAGRAPH           30280000
302900         MOVE 'ATTEMPTING TO READQ LIST QUEUE'                    30290000
303000                                     TO DP013-MESSAGE-TEXT(1)     30300000
303100         PERFORM DP013-0000-PROCESS-ABEND                         30310000
303200     END-IF.                                                      30320000
303300                                                                  30330000
303400/                                                                 30340000
303500*-----------------------------------------------------------------30350000
303600*  READ THE LIST QUEUE RECORD                                     30360000
303700*-----------------------------------------------------------------30370000
303800 9100-READ-SEL-QUEUE.                                             30380000
303900                                                                  30390000
304000     EXEC CICS                                                    30400000
304100         READQ TS                                                 30410000
304200             QUEUE (ASC-SEL-QUEUE-NAME)                           30420000
304300             INTO  (SU010-SELECT-RECORD)                          30430000
304400             ITEM  (ASC-SEL-ITEM)                                 30440000
304500             RESP  (PV-CICS-RESP)                                 30450000
304600     END-EXEC.                                                    30460000
304700     IF PV-CICS-RESP EQUAL DFHRESP(NORMAL)                        30470000
304800         CONTINUE                                                 30480000
304900     ELSE                                                         30490000
305000         SET DP013-LOGIC-ABEND                                    30500000
305100             DP013-NO-ROLLBACK   TO   TRUE                        30510000
305200         MOVE '9100-READ-SEL-QUEUE' TO   DP013-PARAGRAPH          30520000
305300         MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   30530000
305400                                 TO   DP013-MESSAGE-TEXT (1)      30540000
305500         PERFORM DP013-0000-PROCESS-ABEND                         30550000
305600     END-IF.                                                      30560000
305700                                                                  30570000
305800*-----------------------------------------------------------------30580000
305900* UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE.       *30590000
306000*-----------------------------------------------------------------30600000
306100 9200-REWRITE-SEL-QUEUE.                                          30610000
306200                                                                  30620000
306300     EXEC CICS                                                    30630000
306400          WRITEQ TS                                               30640000
306500              QUEUE  (ASC-SEL-QUEUE-NAME)                         30650000
306600              FROM   (SU010-SELECT-RECORD)                        30660000
306700              ITEM   (ASC-SEL-ITEM)                               30670000
306800              RESP   (PV-CICS-RESP)                               30680000
306900              REWRITE                                             30690000
307000     END-EXEC.                                                    30700000
307100                                                                  30710000
307200     IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                   30720000
307300         SET DP013-CICS-ABEND                                     30730000
307400             DP013-NO-ROLLBACK     TO TRUE                        30740000
307500         MOVE '9200-REWRITE-SEL-QUEUE'                            30750000
307600                                   TO DP013-PARAGRAPH             30760000
307700         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   30770000
307800                                   TO DP013-MESSAGE-TEXT (1)      30780000
307900         PERFORM DP013-0000-PROCESS-ABEND                         30790000
308000     END-IF.                                                      30800000
308100                                                                  30810000
308200*----------------------------------------------------------------*30820000
308300*    THE DB2 RESOURCE IS NOT AVAILABLE, DISPLAY A MESSAGE ON     *30830000
308400*    THE TERMINAL INDICATING THAT THE RESOURCE IS UNAVAILABLE.   *30840000
308500*----------------------------------------------------------------*30850000
308600 9900-SOFT-ABORT.                                                 30860000
308700                                                                  30870000
308800     EXEC CICS SYNCPOINT                                          30880000
308900          ROLLBACK                                                30890000
309000     END-EXEC.                                                    30900000
309100                                                                  30910000
309200     SET  PS-ERROR                                                30920000
309300          PS-SOFT-ABORT-ERROR                                     30930000
309400          DP020-MSG-FATAL       TO  TRUE.                         30940000
309500                                                                  30950000
309600*----------------------------------------------------------------*30960000
309700*    ABEND PROCESSOR MODULE                                      *30970000
309800*----------------------------------------------------------------*30980000
309900     COPY DPPD013.                                                30990000
