000100*-----------------------*                                         00010099
000200 IDENTIFICATION DIVISION.                                         00020099
000210*-----------------------*                                         00021099
000220 PROGRAM-ID.    SUKCS772.                                         00022099
000230 AUTHOR.        CHRISTINE TWIEHAUS                                00023099
000240 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00024099
000250 DATE-WRITTEN.  NOVEMBER, 2008.                                   00025099
000260 DATE-COMPILED.                                                   00026099
000270                                                                  00027099
000271*---------------------------------------------------------------* 00027199
000272*    02/03/09 IR 12394 CHRISTINE TWIEHAUS                         00027299
000273*             CHANGED SUKUT135 TO SUKUT134                        00027399
000274*---------------------------------------------------------------* 00027499
000275*    01/30/14 PR 5148D CHERI PARMLEY                              00027599
000276*             IF PO IS PART OF A COMBO AUDIT AND BOTH AUDITS      00027699
000277*             FAILED HIGHLIGHT SML/P2L DEST CARTON YELLOW.        00027799
000278*                                                                 00027899
000279*             ADDED 'CARTONS WITH 2 LOCKS ARE YELLOW'             00027999
000280*             CODE BEGINS AT 4425-CHECK-AUDIT-COMBO PARA.         00028099
000281*---------------------------------------------------------------* 00028199
000282*    09/25/14          CHERI PARMLEY                              00028299
000283*             CHANGE PO# FROM 7 DIGITS TO 8 DIGITS                00028399
000288*---------------------------------------------------------------* 00028899
263968* CHANGED 11/15/2021    BY JIM HUNTER      WR: CHG0263968         00029099
263968* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00029199
263968* MAKING THE CALL DYNAMIC VS STATIC.                              00029299
001130*                                                                 00029399
001110* CHANGED 01/09/2023    BY JEAN KURK       WR: CHG0278099         00029499
001120* CHANGE CALL OF DPKCS030 TO BE DYNAMIC                           00029599
263968*---------------------------------------------------------------* 00029699
000290*    Y772 - DIRECTIVE LIST SCREEN                               * 00029799
000300*---------------------------------------------------------------* 00030099
000400 ENVIRONMENT DIVISION.                                            00040099
000500 DATA DIVISION.                                                   00050099
000600                                                                  00060099
000700 WORKING-STORAGE SECTION.                                         00070099
000800                                                                  00080099
000900 01  DK-DB2-KEYS.                                                 00090099
001000     05  DK-OPER-UNIT-ID           PIC S9(04) COMP VALUE +0.      00100099
001010     05  DK-LGCL-LOC-NM            PIC X(32)       VALUE SPACES.  00101099
001020     05  DK-LOC-SENT-DESC          PIC X(04)       VALUE SPACES.  00102099
001030     05  DK-TYPE-CODE              PIC X(02)       VALUE SPACES.  00103099
001040     05  DK-PO-NUMBER              PIC S9(9) COMP VALUE +0.       00104099
001041*CLP 09/25/2014                                                   00104199
001050     05  DK-PO-NUMBER-DROP.                                       00105099
001060         10  FILLER                PIC  X(01).                    00106099
001070         10  DK-PO-NUMBER-8        PIC  X(08).                    00107099
001080     05  DK-RCVR-NO                PIC S9(9) COMP VALUE +0.       00108099
001090     05  DK-LINE-NO                PIC S9(9) COMP VALUE +0.       00109099
001100     05  DK-PACK-ID                PIC S9(4) COMP VALUE +0.       00110099
001200     05  DK-AUDIT-NO               PIC S9(9) COMP VALUE +0.       00120099
001300     05  DK-CART-ID                PIC X(22)       VALUE ZEROS.   00130099
001400     05  DK-CART-ID-R REDEFINES DK-CART-ID.                       00140099
001500         10  DK-CART-ID-N          PIC 9(20).                     00150099
001600         10  FILLER                PIC 9(02).                     00160099
001700     05  DK-CART-ID-PACKED         PIC S9(18) COMP-3              00170099
001800                                                   VALUE ZEROS.   00180099
001900     05  DK-SET-NAME               PIC X(05)       VALUE SPACES.  00190099
002000     05  DK-SET-YEAR               PIC X(04)       VALUE SPACES.  00200099
002100     05  DK-CART-CRE-SRCE          PIC X(03)      VALUE SPACES.   00210099
002200     05  DK-DIR-TYPE               PIC X(01)       VALUE SPACES.  00220099
002300     05  DK-BEGIN-DATE             PIC X(26)       VALUE SPACES.  00230099
002400     05  DK-END-DATE               PIC X(26)       VALUE SPACES.  00240099
002500     05  DK-CASI                   PIC X(01)       VALUE SPACES.  00250099
002600     05  DK-UNIQUE-IND             PIC X(01)       VALUE SPACES.  00260099
002700     05  DK-DIRV-RSN-CDE           PIC X(03)       VALUE SPACES.  00270099
002710     05  DK-LIST-ITEM-NUMBER       PIC 9(05).                     00271099
002720     05  DK-LIST-ITEM-NUMBER-X     REDEFINES                      00272099
002730         DK-LIST-ITEM-NUMBER       PIC X(05).                     00273099
002800                                                                  00280099
002900 01  PC-PROGRAM-CONSTANTS.                                        00290099
003000     05  PC-CURRENT-MAP-NAME       PIC  X(08)  VALUE 'SUK772  '.  00300099
003100     05  PC-CURRENT-MAPSET-NAME    PIC  X(08)  VALUE 'SUKM772 '.  00310099
003200     05  PC-CURRENT-PROGRAM-NAME   PIC  X(08)  VALUE 'SUKCS772'.  00320099
003300     05  PC-APPL-MAP               PIC S9(04)  VALUE  +1          00330099
003400                                                     COMP.        00340099
003500     05  PC-LIST-QUEUE-SEQ         PIC  9(01)  VALUE 1.           00350099
003600     05  PC-SEL-QUEUE-SEQ          PIC  9(01)  VALUE 2.           00360099
003700     05  PC-CRIT-SPEC-FORMAT       PIC  X(01)  VALUE '1'.         00370099
003800     05  PC-DETAIL-SCREEN          PIC  X(01)  VALUE '2'.         00380099
003900     05  PC-ITEMS-PER-PANEL        PIC S9(04)  VALUE +9           00390099
004000                                               COMP SYNC.         00400099
004100     05  PC-MAX-BLOCKS-IN-ARRAY    PIC S9(04)  VALUE +2           00410099
004200                                               COMP SYNC.         00420099
004300     05  PC-MAX-ITEMS              PIC S9(09)  VALUE +1000000     00430099
004400                                               COMP-3.            00440099
004500     05  PC-MSG-NUMBER-LENGTH      PIC S9(04)  VALUE +5           00450099
004600                                               COMP SYNC.         00460099
004700     05  PC-MAX-RETRIES            PIC S9(03)  VALUE 3            00470099
004800                                               COMP-3.            00480099
004900     05  PC-INQ                    PIC  X(03)  VALUE 'INQ'.       00490099
005000     05  PC-ADD                    PIC  X(03)  VALUE 'ADD'.       00500099
005100     05  PC-UPD                    PIC  X(03)  VALUE 'UPD'.       00510099
005200     05  PC-DEL                    PIC  X(03)  VALUE 'DEL'.       00520099
005300     05  PC-ERR                    PIC  X(03)  VALUE 'ERR'.       00530099
005400     05  PC-PO-NUMBER              PIC  X(04)  VALUE 'PONO'.      00540099
005500     05  PC-C1                     PIC  X(01)  VALUE '1'.         00550099
005600     05  PC-C1-DESCRIPTION         PIC  X(53)  VALUE              00560099
005700         'SORTED BY PO, RCVR, PACK, LINE, SML / P2L DEST       '. 00570099
005800     05  PC-C2                     PIC  X(01)  VALUE '2'.         00580099
005900     05  PC-C2-DESCRIPTION         PIC  X(53)  VALUE              00590099
006000         'SORTED BY ASCENDING CREATE DATE/TIME                 '. 00600099
006100     05  PC-01                     PIC  X(02)  VALUE '01'.        00610099
006200     05  PC-A                      PIC  X(01)  VALUE 'A'.         00620099
006300     05  PC-D                      PIC  X(01)  VALUE 'D'.         00630099
006400     05  PC-S                      PIC  X(01)  VALUE 'S'.         00640099
006500     05  PC-U                      PIC  X(01)  VALUE 'U'.         00650099
006510     05  PC-F                      PIC  X(01)  VALUE 'F'.         00651099
006520     05  PC-RF                     PIC  X(02)  VALUE 'RF'.        00652099
006600     05  PC-MULTI                  PIC  X(05)  VALUE 'MULTI'.     00660099
006700     05  PC-DEFAULT-TIMESTAMP     PIC  X(26)                      00670099
006800                          VALUE  '9999-09-09-09.09.09.999999'.    00680099
006900                                                                  00690099
007000     05  PC-TIMESTAMP.                                            00700099
007100         10  FILLER               PIC X(05).                      00710099
007200         10  PC-TS-MM             PIC X(02).                      00720099
007300         10  FILLER               PIC X(01).                      00730099
007400         10  PC-TS-DD             PIC X(02).                      00740099
007500         10  FILLER               PIC X(01).                      00750099
007600         10  PC-TS-HH-COL-MN.                                     00760099
007700             15  PC-TS-HH             PIC X(02).                  00770099
007800             15  PC-TS-COL            PIC X(01).                  00780099
007900             15  PC-TS-MN             PIC X(02).                  00790099
008000         10  FILLER               PIC X(10).                      00800099
008100     05  PC-MMDD.                                                 00810099
008200         10  PC-MM                PIC X(02).                      00820099
008300         10  PC-DD                PIC X(02).                      00830099
008400     05  PC-MULTIPLE-SKU-PPK       PIC  X(21)  VALUE              00840099
008500         'M - MULTI SKU PREPACK'.                                 00850099
008600     05  PC-SINGLE-SKU-PPK         PIC  X(22)  VALUE              00860099
008700         'S - SINGLE SKU PREPACK'.                                00870099
008800     05  PC-INNER-PPK              PIC  X(17)  VALUE              00880099
008900         'I - INNER PREPACK'.                                     00890099
009000     05  PC-BULK-PPK               PIC  X(13)  VALUE              00900099
009100         'B - BULK PACK'.                                         00910099
009200     05  PC-CASEPACK               PIC  X(12)  VALUE              00920099
009300         'C - CASEPACK'.                                          00930099
009400     05  PC-PBS                    PIC  X(13)  VALUE              00940099
009500         'PACK BY STORE'.                                         00950099
009600                                                                  00960099
009700                                                                  00970099
009800*----------------------------------------------------------------*00980099
009900*  SYSTEM MESSAGES                                               *00990099
010000*----------------------------------------------------------------*01000099
010100*   00005 = INVALID VALUE                                        *01010099
010200*   00008 = MUST BE NUMERIC                                      *01020099
010300*   00050 - NO LIST ITEMS WERE FOUND FOR THE CRITERIA SPECIFIED  *01030099
010400*   00051 - NO END OF RANGE HAS BEEN SPECIFIED                   *01040099
010500*   00052 - END OF RANGE PRECEDES START OF RANGE                 *01050099
010600*   00053 - NO START OF RANGE HAS BEEN SPECIFIED                 *01060099
010700*   00054 - ONLY ONE START OF RANGE INDICATOR MAY BE SPECIFIED   *01070099
010800*   00055 - ONLY ONE END OF RANGE INDICATOR MAY BE SPECIFIED     *01080099
010900*   00057 - A LIST ITEM MUST BE SELECTED FOR THIS FUNCTION       *01090099
011000*   00069 - TOP OF LIST                                          *01100099
011100*   00070 - BOTTOM OF LIST                                       *01110099
011200*   00101 - VALUE MUST BE > ZERO AND  < 1,000,000                *01120099
011300*   00279 - MORE ITEMS TO DISPLAY                                *01130099
011400*   02571 - UNABLE TO UPD - CURRENT OPER UNT AND OPER UNIT ID ENTE01140099
011500*   02575 - STORE ASSIGNMNT FUNCTION ONLY VALID FOR DOOR TYPES SHI01150099
011600*----------------------------------------------------------------*01160099
011700     05  PC-TSYMSG-NUMBERS.                                       01170099
011800         10  PC-TSYMSG-00005            PIC  9(05)  VALUE 00005.  01180099
011900         10  PC-TSYMSG-00008            PIC  9(05)  VALUE 00008.  01190099
012000         10  PC-TSYMSG-00050            PIC  9(05)  VALUE 00050.  01200099
012100         10  PC-TSYMSG-00051            PIC  9(05)  VALUE 00051.  01210099
012200         10  PC-TSYMSG-00052            PIC  9(05)  VALUE 00052.  01220099
012300         10  PC-TSYMSG-00053            PIC  9(05)  VALUE 00053.  01230099
012400         10  PC-TSYMSG-00054            PIC  9(05)  VALUE 00054.  01240099
012500         10  PC-TSYMSG-00055            PIC  9(05)  VALUE 00055.  01250099
012600         10  PC-TSYMSG-00057            PIC  9(05)  VALUE 00057.  01260099
012700         10  PC-TSYMSG-00069            PIC  9(05)  VALUE 00069.  01270099
012800         10  PC-TSYMSG-00070            PIC  9(05)  VALUE 00070.  01280099
012900         10  PC-TSYMSG-00101            PIC  9(05)  VALUE 00101.  01290099
013000         10  PC-TSYMSG-00279            PIC  9(05)  VALUE 00279.  01300099
013100         10  PC-TSYMSG-02571            PIC  9(05)  VALUE 02571.  01310099
013200         10  PC-TSYMSG-02575            PIC  9(05)  VALUE 02575.  01320099
013300*                                                                 01330099
013400 01  PS-PROGRAM-SWITCHES.                                         01340099
013500     05  PS-ERROR-SW                    PIC  X(01)  VALUE 'Y'.    01350099
013600         88  PS-NO-ERROR                            VALUE 'Y'.    01360099
013700         88  PS-ERROR                               VALUE 'N'.    01370099
013800     05  PS-BLOCK-ERROR-SW              PIC  X(01)  VALUE 'Y'.    01380099
013900         88  PS-NO-BLOCK-ERROR                      VALUE 'Y'.    01390099
014000         88  PS-BLOCK-ERROR                         VALUE 'N'.    01400099
014100     05  PS-CONFIRM-PROCESSING-IND      PIC  X(01)  VALUE  'N'.   01410099
014200         88  PS-CONFIRM-PROCESSING                  VALUE  'Y'.   01420099
014300         88  PS-NOT-CONFIRM-PROCESSING              VALUE  'N'.   01430099
014400     05  PS-SOFT-ABORT-ERROR-SW         PIC  X(01)  VALUE 'N'.    01440099
014500         88  PS-SOFT-ABORT-ERROR                    VALUE 'Y'.    01450099
014600         88  PS-NO-SOFT-ABORT-ERROR                 VALUE 'N'.    01460099
014700     05  PS-COMMAREA-SW                 PIC  X(01)  VALUE 'N'.    01470099
014800         88  PS-COMMAREA-VALID                      VALUE 'Y'.    01480099
014900         88  PS-COMMAREA-NOT-VALID                  VALUE 'N'.    01490099
015000     05  PS-LIST-END-SW                 PIC  X(01)  VALUE 'N'.    01500099
015100         88  PS-LIST-END                            VALUE 'Y'.    01510099
015200         88  PS-NO-LIST-END                         VALUE 'N'.    01520099
015210     05  PS-AUDIT-COMBO-SW              PIC  X(01)  VALUE 'N'.    01521099
015220         88  PS-COMBO-AUDIT                         VALUE 'Y'.    01522099
015230         88  PS-NOT-COMBO-AUDIT                     VALUE 'Y'.    01523099
015240     05  PS-HIGHLIGHT-CARTON-SW         PIC  X(01)  VALUE 'N'.    01524099
015250         88  PS-HIGHLIGHT-CARTON                    VALUE 'Y'.    01525099
015260         88  PS-NOT-HIGHLIGHT-CARTON                VALUE 'N'.    01526099
015300*                                                                 01530099
015400 01  PV-PROGRAM-VARIABLES.                                        01540099
015410     05  PV-NULL-IND                    PIC S9(4)   VALUE ZERO    01541099
015420                                                     COMP SYNC.   01542099
015500     05  PV-CICS-RESPONSE               PIC S9(08)  VALUE ZEROES  01550099
015600                                        COMP SYNC.                01560099
015700     05  PV-SUB                         PIC S9(04)  VALUE +0      01570099
015800                                                    COMP SYNC.    01580099
015900     05  PV-REMAINDER                   PIC S9(04)  VALUE +0      01590099
016000                                                    COMP SYNC.    01600099
016100     05  PV-READ-COUNT                  PIC S9(09)  VALUE +0      01610099
016200                                                    COMP-3.       01620099
016300     05  PV-ITEMS-PROCESSED             PIC S9(09)  VALUE +0      01630099
016400                                                    COMP-3.       01640099
016500     05  PV-HOLD-SELECTED-ITEMS         PIC S9(09)  VALUE +0      01650099
016600                                                    COMP-3.       01660099
016700     05  PV-ITEM-IN-USE                 PIC S9(09)  VALUE +0      01670099
016800                                                    COMP-3.       01680099
016900     05  PV-TOP-ITEM                    PIC S9(09)  VALUE +0      01690099
017000                                                    COMP-3.       01700099
017100     05  PV-BOTTOM-ITEM                 PIC S9(09)  VALUE +0      01710099
017200                                                    COMP-3.       01720099
017300     05  PV-TEMP-BLOCK-NUMBER           PIC S9(09)  VALUE +0      01730099
017400                                                    COMP-3.       01740099
017500     05  PV-BLOCK-NUMBER                PIC S9(04)  VALUE +0      01750099
017600                                                    COMP SYNC.    01760099
017700     05  PV-CICS-RESP                   PIC S9(04)  VALUE +0      01770099
017800                                                    COMP SYNC.    01780099
017900     05  PV-ITEM                        PIC S9(04)  VALUE +0      01790099
018000                                                    COMP SYNC.    01800099
018100     05  PV-SEL-QUEUE-ITEM              PIC S9(04)  VALUE +0      01810099
018200                                                    COMP SYNC.    01820099
018300     05  PV-SAVE-ITEM                   PIC S9(04)  VALUE +0      01830099
018400                                                    COMP SYNC.    01840099
018500     05  PV-HIGHEST-BLOCK-WRITTEN       PIC S9(04)  VALUE +0      01850099
018600                                                    COMP SYNC.    01860099
018700     05  PV-LIST-ITEM-NUMBER            PIC S9(04)  VALUE +0      01870099
018800                                                    COMP SYNC.    01880099
018900     05  PV-FIRST-BLOCK-IN-ARRAY        PIC S9(04)  VALUE +0      01890099
019000                                                    COMP SYNC.    01900099
019100     05  PV-NEXT-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      01910099
019200                                                    COMP SYNC.    01920099
019300     05  PV-PREV-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      01930099
019400                                                    COMP SYNC.    01940099
019500     05  PV-FIRST-BLOCK-IN-RANGE        PIC S9(04)  VALUE +0      01950099
019600                                                    COMP SYNC.    01960099
019700     05  PV-LAST-BLOCK-IN-RANGE         PIC S9(04)  VALUE +0      01970099
019800                                                    COMP SYNC.    01980099
019900     05  PV-START-OF-SELECTED-RANGE     PIC S9(04)  VALUE +0      01990099
020000                                                    COMP SYNC.    02000099
020100     05  PV-END-OF-SELECTED-RANGE       PIC S9(04)  VALUE +0      02010099
020200                                                    COMP SYNC.    02020099
020300     05  PV-RETRY-COUNTER               PIC S9(04)  VALUE +0      02030099
020400                                                    COMP SYNC.    02040099
020500     05  PV-SOFT-ABORT-MSG.                                       02050099
020600         10  FILLER            PIC X(12) VALUE ' SUKCS772 - '.    02060099
020700         10  FILLER            PIC X(09) VALUE 'SQLCODE: '.       02070099
020800         10  PV-SOFT-SQLCODE   PIC ZZZZZZZZ9-.                    02080099
020900         10  FILLER            PIC X(12) VALUE ' PARAGRAPH: '.    02090099
021000         10  PV-SOFT-PARAGRAPH PIC X(30).                         02100099
021100     05  PV-COMMAREA-LENGTH              PIC S9(04)  VALUE +0     02110099
021200                                                     COMP SYNC.   02120099
021210     05  PV-CICS-MSG-AREA                PIC  X(80)  VALUE SPACE. 02121099
021211     05  PV-CICS-MSG-AREA2               PIC  X(100) VALUE SPACE. 02121199
021212     05  PV-CICS-MSG-HOLD.                                        02121299
021213         10  FILLER                      PIC  X(01)  VALUE SPACE. 02121399
021214         10  PV-CICS-MSG-DATA            PIC  X(79)  VALUE SPACE. 02121499
021215     05  PV-CICS-MSG-HOLD2.                                       02121599
021216         10  FILLER                      PIC  X(01)  VALUE SPACE. 02121699
021217         10  PV-CICS-MSG-DATA2           PIC  X(99)  VALUE SPACE. 02121799
021218                                                                  02121899
021219     05  PV-ORIGINAL-BLOCK               PIC S9(04)  VALUE +0     02121999
021220                                                     COMP SYNC.   02122099
021221     05  PV-ITEMS-HOLD                   PIC S9(03)  COMP-3.      02122199
021222     05  PV-ITEMS-DIFF                   PIC S9(03)  COMP-3.      02122299
021223     05  PV-CASE-NBR                     PIC  X(10).              02122399
021224     05  PV-UNION-TYPE                   PIC  X(01) VALUE SPACE.  02122499
021225     05  PV-AUD-STAT-CDE                 PIC  X(01) VALUE SPACE.  02122599
021226                                                                  02122699
021227******************************************************************02122799
021228**  THIS IS THE LAYOUT FOR THE LIST ITEMS TEMP STORAGE QUEUE.   **02122899
021229**  THIS MUST BE THE EXACT SAME FORMAT AS BLOCK IN THE          **02122999
021230**  APPLICATION-SPECIFIC COMMAREA.                              **02123099
021231******************************************************************02123199
021232 01  LQW-LIST-QUEUE-WORK-AREA.                                    02123299
021233     05  LQW-BLOCK-MODIFIED             PIC  X(01)  VALUE SPACE.  02123399
021234     05  LQW-ITEM-ENTRIES               OCCURS 09 TIMES           02123499
021235                                        INDEXED BY LQW-IDX.       02123599
021236         10  LQW-LIST-ITEM-NUMBER       PIC S9(09)  COMP-3.       02123699
021237         10  LQW-TEMP-SELECTED-SW       PIC  X(01).               02123799
021238         10  LQW-SELECTED-SW            PIC  X(01).               02123899
021239             88  LQW-SELECT                         VALUE 'S'.    02123999
021240             88  LQW-DESELECT                       VALUE ' '.    02124099
021241         10  LQW-ACTION                 PIC  X(03).               02124199
021242             88  LQW-ADD                            VALUE 'ADD'.  02124299
021243             88  LQW-INQ                            VALUE 'INQ'.  02124399
021244             88  LQW-UPD                            VALUE 'UPD'.  02124499
021245             88  LQW-ERR                            VALUE 'ERR'.  02124599
021246         10  LQW-PO-NUMBER              PIC  9(09).               02124699
021247         10  LQW-LOCKED-OR-NOT          PIC  X(01).               02124799
021248         10  LQW-RECEIVER-NO            PIC  X(04).               02124899
021249         10  LQW-LINE-PACK              PIC  X(04).               02124999
021250         10  LQW-CARTON-ID              PIC  9(22).               02125099
021251         10  LQW-PACK-TYPE              PIC  X(14).               02125199
021252         10  LQW-PACK-ID                PIC  X(04).               02125299
021253         10  LQW-PACK-ID-N REDEFINES LQW-PACK-ID                  02125399
021254                                        PIC  9(04).               02125499
021255         10  LQW-AUDIT-NUMBER           PIC  X(09).               02125599
021256         10  LQW-AUDIT-NUMBER-N REDEFINES                         02125699
021257                                LQW-AUDIT-NUMBER                  02125799
021258                                        PIC  9(09).               02125899
021259         10  LQW-SET-NAME               PIC  X(05).               02125999
021260         10  LQW-SET-YEAR               PIC  X(04).               02126099
021261         10  LQW-CRE-SRC                PIC  X(03).               02126199
021270         10  LQW-DIR-TYPE               PIC  X(01).               02127099
021280         10  LQW-DIRECTIVE-REASON-CDE   PIC  X(03).               02128099
021290         10  LQW-LOC-SENT               PIC  X(04).               02129099
021291         10  LQW-CREATE-DATE            PIC  X(04).               02129199
021292         10  LQW-CREATE-TIME            PIC  X(05).               02129299
021293         10  LQW-CASI                   PIC  X(01).               02129399
021294         10  LQW-CRE-PGM-NM             PIC  X(08).               02129499
021295         10  LQW-CRE-TMST               PIC  X(26).               02129599
021296         10  LQW-SHIPT-UNT-ID           PIC  X(01).               02129699
021297                                                                  02129799
021298*---------------------------------------------------------------* 02129899
021299* SELECTION QUEUE LAYOUT                                        * 02129999
021300*---------------------------------------------------------------* 02130099
021400     COPY SUWS102.                                                02140099
021500*---------------------------------------------------------------* 02150099
021501*    MAP LAYOUT                                                 * 02150199
021502*---------------------------------------------------------------* 02150299
021503     COPY SUKM772.                                                02150399
021504*                                                                 02150499
021505 01  MR-OCCURS-LAYOUT                   REDEFINES  SUK772O.       02150599
021506     05  FILLER                         PIC X(172).               02150699
021507     05  MR-SCROLL-AREA                 OCCURS  9 TIMES.          02150799
021508         10  MR-SELECTL                 PIC S9(04) COMP.          02150899
021509         10  MR-SELECTA                 PIC  X(01).               02150999
021510         10  MR-SELECTC                 PIC  X(01).               02151099
021511         10  MR-SELECTH                 PIC  X(01).               02151199
021512         10  MR-SELECTI                 PIC  X(01).               02151299
021513                                                                  02151399
021514         10  MR-APONL                   PIC S9(04) COMP.          02151499
021515         10  MR-APONA                   PIC  X(01).               02151599
021516         10  MR-APONC                   PIC  X(01).               02151699
021517         10  MR-APONH                   PIC  X(01).               02151799
021518*CLP 09/25/2014                                                   02151899
021519         10  MR-APON                    PIC  X(09).               02151999
021522                                                                  02152299
021523         10  MR-ARCVRL                 PIC S9(04) COMP.           02152399
021530         10  MR-ARCVRA                 PIC  X(01).                02153099
021540         10  MR-ARCVRC                 PIC  X(01).                02154099
021550         10  MR-ARCVRH                 PIC  X(01).                02155099
021560         10  MR-ARCVR                  PIC  X(04).                02156099
021570                                                                  02157099
021580         10  MR-ALINEL                 PIC S9(04) COMP.           02158099
021590         10  MR-ALINEA                 PIC  X(01).                02159099
021600         10  MR-ALINEC                 PIC  X(01).                02160099
021700         10  MR-ALINEH                 PIC  X(01).                02170099
021800         10  MR-ALINE                  PIC  X(04).                02180099
021900                                                                  02190099
022000         10  MR-ACARTL                 PIC S9(04) COMP.           02200099
022100         10  MR-ACARTA                 PIC  X(01).                02210099
022200         10  MR-ACARTC                 PIC  X(01).                02220099
022300         10  MR-ACARTH                 PIC  X(01).                02230099
022400         10  MR-ACART                  PIC  X(22).                02240099
022500                                                                  02250099
022600         10  MR-ASETNL                 PIC S9(04) COMP.           02260099
022700         10  MR-ASETNA                 PIC  X(01).                02270099
022800         10  MR-ASETNC                 PIC  X(01).                02280099
022900         10  MR-ASETNH                 PIC  X(01).                02290099
023000         10  MR-ASETN                  PIC  X(05).                02300099
023100                                                                  02310099
023200         10  MR-ACSRCL                 PIC S9(04) COMP.           02320099
023300         10  MR-ACSRCA                 PIC  X(01).                02330099
023400         10  MR-ACSRCC                 PIC  X(01).                02340099
023500         10  MR-ACSRCH                 PIC  X(01).                02350099
023600         10  MR-ACSRC                  PIC  X(03).                02360099
023700                                                                  02370099
023800         10  MR-ATYPEL                 PIC S9(04) COMP.           02380099
023900         10  MR-ATYPEA                 PIC  X(01).                02390099
024000         10  MR-ATYPEC                 PIC  X(01).                02400099
024100         10  MR-ATYPEH                 PIC  X(01).                02410099
024200         10  MR-ATYPE                  PIC  X(01).                02420099
024300                                                                  02430099
024400         10  MR-ADIRCL                 PIC S9(04) COMP.           02440099
024500         10  MR-ADIRCA                 PIC  X(01).                02450099
024600         10  MR-ADIRCC                 PIC  X(01).                02460099
024700         10  MR-ADIRCH                 PIC  X(01).                02470099
024701         10  MR-ADIRC                  PIC  X(03).                02470199
024702                                                                  02470299
024703                                                                  02470399
024704         10  MR-ALOCSL                 PIC S9(04) COMP.           02470499
024705         10  MR-ALOCSA                 PIC  X(01).                02470599
024706         10  MR-ALOCSC                 PIC  X(01).                02470699
024707         10  MR-ALOCSH                 PIC  X(01).                02470799
024708         10  MR-ALOCS                  PIC  X(04).                02470899
024709                                                                  02470999
024710         10  MR-ACDATL                 PIC S9(04) COMP.           02471099
024711         10  MR-ACDATA                 PIC  X(01).                02471199
024712         10  MR-ACDATC                 PIC  X(01).                02471299
024713         10  MR-ACDATH                 PIC  X(01).                02471399
024714         10  MR-ACDAT                  PIC  X(04).                02471499
024715                                                                  02471599
024716         10  MR-ACTIML                 PIC S9(04) COMP.           02471699
024717         10  MR-ACTIMA                 PIC  X(01).                02471799
024718         10  MR-ACTIMC                 PIC  X(01).                02471899
024719         10  MR-ACTIMH                 PIC  X(01).                02471999
024720         10  MR-ACTIM                  PIC  X(05).                02472099
024721                                                                  02472199
024722         10  MR-ACASIL                 PIC S9(04) COMP.           02472299
024723         10  MR-ACASIA                 PIC  X(01).                02472399
024724         10  MR-ACASIC                 PIC  X(01).                02472499
024725         10  MR-ACASIH                 PIC  X(01).                02472599
024726         10  MR-ACASI                  PIC  X(01).                02472699
024727                                                                  02472799
024728     05  FILLER                         PIC  X(12).               02472899
024729                                                                  02472999
024730*----------------------------------------------------------------*02473099
024731*  SENDING/RECEIVING AREA FOR THE                                 02473199
024732*  PRINTER VALIDATION ROUTING (DPKCS060)                          02473299
024733*----------------------------------------------------------------*02473399
024734     COPY DPWS072.                                                02473499
024735                                                                  02473599
024736*---------------------------------------------------------------* 02473699
024737*    ATTRIBUTE SETTINGS COPYBOOK.                               * 02473799
024738*---------------------------------------------------------------* 02473899
024739     COPY DPWS015.                                                02473999
024740                                                                  02474099
024750*---------------------------------------------------------------* 02475099
024760*    FUNCTION KEYS COPYBOOK.                                    * 02476099
024770*---------------------------------------------------------------* 02477099
024780     COPY DPWS016.                                                02478099
024790                                                                  02479099
024800*---------------------------------------------------------------* 02480099
024900*    NUMERIC EDIT LAYOUT.                                       * 02490099
025000*---------------------------------------------------------------* 02500099
025100     COPY DPWS010I.                                               02510099
025200                                                                  02520099
025300*---------------------------------------------------------------* 02530099
025400*    PARAMETERS FOR CALLING CICS ARCHITECTURE API               * 02540099
025500*---------------------------------------------------------------* 02550099
025600     COPY DPWS030.                                                02560099
025600     COPY DPWS930.                                                02561099
025700                                                                  02570099
025800*---------------------------------------------------------------* 02580099
025900*    STANDARD COMMAREA.                                         * 02590099
026000*---------------------------------------------------------------* 02600099
026100     COPY DPWS020.                                                02610099
026200     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                02620099
026300                                                                  02630099
026400*---------------------------------------------------------------* 02640099
026500* INTER-APPLICATION COMMAREA.                                   * 02650099
026600*   SUWS100 - IS THE INPUT LAYOUT WHEN COMING FROM THE CRIT.    * 02660099
026700*             SPEC SCREEN.                                      * 02670099
026800*   SUWS101 - IS THE OUTPUT LAYOUT CONTAINING HEADER INFO.      * 02680099
026900*---------------------------------------------------------------* 02690099
027000         10  INTER-APPL-COMM-AREA       PIC X(200).               02700099
027100                                                                  02710099
027200     COPY SUWS100.                                                02720099
027300                                                                  02730099
027400     COPY SUWS101.                                                02740099
027500                                                                  02750099
027600*---------------------------------------------------------------* 02760099
027700*  THIS IS THE APPLICATION-SPECIFIC COMMAREA.                   * 02770099
027800*---------------------------------------------------------------* 02780099
027900         10  ASC-SPECIFIC-COMMAREA.                               02790099
028000             15  ASC-FUNCTION                 PIC  X(01).         02800099
028100             15  ASC-OPER-UNIT                PIC  9(04).         02810099
028200             15  ASC-OPER-UNIT-NAME           PIC  X(25).         02820099
028300             15  ASC-PO-NUMBER-H              PIC  9(09).         02830099
028400             15  ASC-RCVR-NUMBER-H            PIC  X(04).         02840099
028500             15  ASC-RCVR-NUMBER-N-H REDEFINES                    02850099
028600                                    ASC-RCVR-NUMBER-H             02860099
028700                                         PIC  9(04).              02870099
028800             15  ASC-PACK-TYPE-H              PIC  X(14).         02880099
028900             15  ASC-LINE-NO-H                PIC  X(04).         02890099
029000             15  ASC-PACK-ID-H                PIC  X(04).         02900099
029100             15  ASC-AUDIT-NUMBER-H           PIC  X(09).         02910099
029200             15  ASC-AUDIT-NUMBER-N-H REDEFINES                   02920099
029300                                    ASC-AUDIT-NUMBER-H            02930099
029400                                         PIC  9(09).              02940099
029500             15  ASC-CARTON-ID-H              PIC  X(22).         02950099
029600             15  ASC-CASI-H                   PIC  X(01).         02960099
029700             15  ASC-CRE-PGM-NM-H             PIC  X(08).         02970099
029710             15  ASC-DIR-CODE-H               PIC  X(03).         02971099
029800             15  ASC-SET-NAME-H               PIC  X(05).         02980099
029900             15  ASC-SET-YEAR-H               PIC  X(04).         02990099
030000             15  ASC-START-DATE-TIMESTAMP.                        03000099
030100                 20  ASC-START-DATE.                              03010099
030200                     25  ASC-START-CC        PIC  X(02).          03020099
030300                     25  ASC-START-YY        PIC  X(02).          03030099
030400                     25  ASC-START-HYP1      PIC  X(01).          03040099
030500                     25  ASC-START-MM        PIC  X(02).          03050099
030600                     25  ASC-START-HYP2      PIC  X(01).          03060099
030700                     25  ASC-START-DD        PIC  X(02).          03070099
030800                     25  ASC-START-SPACE     PIC  X(01).          03080099
030900                     25  ASC-START-HH        PIC  X(02).          03090099
031000                     25  ASC-START-COL1      PIC  X(01).          03100099
031100                     25  ASC-START-MN        PIC  X(02).          03110099
031200                     25  ASC-START-COL2      PIC  X(01).          03120099
031300                     25  ASC-START-SS        PIC  X(02).          03130099
031400                 20  ASC-START-SSSSSS    PIC  X(07).              03140099
031500             15  ASC-DATE-END-TIMESTAMP.                          03150099
031600                 20  ASC-END-DATE.                                03160099
031700                     25  ASC-END-CC          PIC  X(02).          03170099
031800                     25  ASC-END-YY          PIC  X(02).          03180099
031900                     25  ASC-END-HYP1        PIC  X(01).          03190099
032000                     25  ASC-END-MM          PIC  X(02).          03200099
032100                     25  ASC-END-HYP2        PIC  X(01).          03210099
032200                     25  ASC-END-DD          PIC  X(02).          03220099
032300                     25  ASC-END-SPACE       PIC  X(01).          03230099
032400                     25  ASC-END-HH          PIC  X(02).          03240099
032500                     25  ASC-END-COL1        PIC  X(01).          03250099
032600                     25  ASC-END-MN          PIC  X(02).          03260099
032700                     25  ASC-END-COL2        PIC  X(01).          03270099
032800                     25  ASC-END-SS          PIC  X(02).          03280099
032900                 20  ASC-END-SSSSSS      PIC  X(07).              03290099
033000             15  ASC-COUNT                    PIC S9(09) COMP.    03300099
033100             15  ASC-SORT-SEQ-SW              PIC  X(01).         03310099
033200                 88  ASC-SORT-SEQ-DEFAULT          VALUE '1'.     03320099
033201                 88  ASC-SORT-SEQ-ASCEND-TMST      VALUE '2'.     03320199
033202             15  ASC-LOCK-MODE-SW             PIC  X(01).         03320299
033203                 88  ASC-LOCK-MODE-ALL-DIRECT      VALUE '1'.     03320399
033204                 88  ASC-LOCK-MODE-DIRECT          VALUE '2'.     03320499
033205             15  ASC-BLK-SUB                  PIC S9(04) COMP     03320599
033206                                                         SYNC.    03320699
033207             15  ASC-ITEM-SUB                 PIC S9(04) COMP     03320799
033208                                                         SYNC.    03320899
033209             15  ASC-NUMBER-OF-ITEMS-READ     PIC S9(09) COMP-3.  03320999
033210             15  ASC-NUMBER-OF-SELECTED-ITEMS PIC S9(09) COMP-3.  03321099
033211             15  ASC-ITEMS-DISPLAYED          PIC S9(03) COMP-3.  03321199
033212             15  ASC-ITEM-AT-TOP-OF-PANEL     PIC S9(09) COMP-3.  03321299
033213             15  ASC-ITEM-AT-BOT-OF-PANEL     PIC S9(09) COMP-3.  03321399
033214             15  ASC-HIGHEST-BLOCK-WRITTEN    PIC S9(04) COMP     03321499
033215                                                         SYNC.    03321599
033216             15  ASC-START-OF-SELECTED-RANGE  PIC S9(09) COMP-3.  03321699
033217             15  ASC-END-OF-SELECTED-RANGE    PIC S9(09) COMP-3.  03321799
033218             15  ASC-XCNTL-TO-RESEND-SW       PIC  X(01).         03321899
033219                 88  ASC-XCNTL-TO-RESEND           VALUE 'Y'.     03321999
033220                 88  ASC-XCNTL-TO-RESEND-NO        VALUE 'N'.     03322099
033221             15  ASC-ITEMS-LEFT-INDICATOR     PIC  X(01).         03322199
033222                 88  ASC-ITEMS-LEFT-ON-DB          VALUE 'Y'.     03322299
033223                 88  ASC-NO-ITEMS-LEFT-ON-DB       VALUE 'N'.     03322399
033224             15  ASC-TEMP-QUEUE-UPDATE-SW     PIC  X(01).         03322499
033225                 88  ASC-UPDATE-TSQ                VALUE 'Y'.     03322599
033226                 88  ASC-NO-TSQ-UPDATE             VALUE ' '.     03322699
033227             15  ASC-LIST-QUEUE-NAME.                             03322799
033228                 20  ASC-LIST-TERM-ID         PIC  X(04).         03322899
033229                 20  ASC-LIST-TASK-NUMBER     PIC S9(05) COMP-3.  03322999
033230                 20  ASC-LIST-SEQ             PIC  9(01).         03323099
033231                                                                  03323199
033232             15  ASC-START-ITEM-REQUEST.                          03323299
033233                 20  ASC-START-ITEM-REQUEST-N PIC  9(05).         03323399
033234                                                                  03323499
033235             15  ASC-SEL-SUB                  PIC S9(4) COMP.     03323599
033236             15  ASC-SEL-ITEM                 PIC S9(4) COMP.     03323699
033237             15  ASC-CURSOR-SW                PIC  X(03).         03323799
033238                 88  ASC-NO-CURSOR                   VALUE 'Z  '. 03323899
033239                 88  ASC-OPER-UNIT-PO-C1             VALUE 'PO1'. 03323999
033240                 88  ASC-OPER-UNIT-PO-R-C1           VALUE 'RV1'. 03324099
033241                 88  ASC-OPER-UNIT-PO-R-LINE-C1      VALUE 'LN1'. 03324199
033242                 88  ASC-OPER-UNIT-PO-R-PACK-C1      VALUE 'PK1'. 03324299
033243                 88  ASC-AUDIT-CONTROL-NO-C1         VALUE 'AU1'. 03324399
033244                 88  ASC-CARTON-ID-C1                VALUE 'CA1'. 03324499
033245                 88  ASC-OPER-UNIT-DATE-C1           VALUE 'DT1'. 03324599
033246                 88  ASC-OPER-UNIT-CASI-DATE-C1      VALUE 'CS1'. 03324699
033247                 88  ASC-OPER-UNIT-RSN-CODE-C1       VALUE 'DC1'. 03324799
033248                 88  ASC-OPER-UNIT-SETCODE-YR-C1     VALUE 'SC1'. 03324899
033249                 88  ASC-OPER-UNIT-PO-C2             VALUE 'PO2'. 03324999
033250                 88  ASC-OPER-UNIT-PO-R-C2           VALUE 'RV2'. 03325099
033251                 88  ASC-OPER-UNIT-PO-R-LINE-C2      VALUE 'LN2'. 03325199
033252                 88  ASC-OPER-UNIT-PO-R-PACK-C2      VALUE 'PK2'. 03325299
033253                 88  ASC-AUDIT-CONTROL-NO-C2         VALUE 'AU2'. 03325399
033254                 88  ASC-CARTON-ID-C2                VALUE 'CA2'. 03325499
033255                 88  ASC-OPER-UNIT-DATE-C2           VALUE 'DT2'. 03325599
033256                 88  ASC-OPER-UNIT-CASI-DATE-C2      VALUE 'CS2'. 03325699
033257                 88  ASC-OPER-UNIT-RSN-CODE-C2       VALUE 'DC2'. 03325799
033258                 88  ASC-OPER-UNIT-SETCODE-YR-C2     VALUE 'SC2'. 03325899
033259                                                                  03325999
033260             15  ASC-USE-SELECTION-QUEUE-IND  PIC  X(1).          03326099
033261                 88  ASC-USE-SELECTION-QUEUE           VALUE 'Y'. 03326199
033262             15  ASC-SEL-QUEUE-NAME.                              03326299
033270                 20  ASC-SEL-TERM-ID          PIC  X(04).         03327099
033280                 20  ASC-SEL-TASK-NUMBER      PIC S9(05) COMP-3.  03328099
033290                 20  ASC-SEL-SEQ              PIC  9(01).         03329099
033300                                                                  03330099
033400             15  ASC-NUMBER-OF-TS-ITEMS       PIC S9(09) COMP-3.  03340099
033500                                                                  03350099
033600*-----------------------------------------------------------------03360099
033700             15  ASC-BLOCK-ENTRIES OCCURS 2 TIMES.                03370099
033800                 20  ASC-BLOCK-MODIFIED-SW           PIC  X(01).  03380099
033900                     88  ASC-BLOCK-NOT-MODIFIED      VALUE 'N'.   03390099
034000                     88  ASC-BLOCK-MODIFIED          VALUE 'Y'.   03400099
034100                                                                  03410099
034200                 20  ASC-ITEM-ARRAY.                              03420099
034300                     25  ASC-ITEM-ENTRIES OCCURS  9 TIMES.        03430099
034400                         30  ASC-LIST-ITEM-NUMBER                 03440099
034500                                                     PIC S9(09)   03450099
034600                                                     COMP-3.      03460099
034700                         30  ASC-TEMP-SELECTED-SW    PIC  X(01).  03470099
034800                             88  ASC-VALID-SELECT    VALUE ' '    03480099
034900                                                           'S'    03490099
035000                                                           'B'    03500099
035100                                                           'E'.   03510099
035200                             88  ASC-TEMP-NO-SELECT  VALUE ' '.   03520099
035300                             88  ASC-TEMP-SELECT     VALUE 'S'.   03530099
035400                             88  ASC-TEMP-BEGIN      VALUE 'B'.   03540099
035500                             88  ASC-TEMP-END        VALUE 'E'.   03550099
035600                         30  ASC-SELECTED-SW         PIC  X(01).  03560099
035700                             88  ASC-NO-SELECT       VALUE ' '.   03570099
035800                             88  ASC-SELECT          VALUE 'S'.   03580099
035900                             88  ASC-BEGIN           VALUE 'B'.   03590099
036000                             88  ASC-END             VALUE 'E'.   03600099
036100                         30  ASC-ACTION              PIC  X(03).  03610099
036200                         30  ASC-PO-NUMBER           PIC  X(09).  03620099
036300                         30  ASC-LOCKED-OR-NOT       PIC  X(01).  03630099
036400                         30  ASC-RCVR-NUMBER         PIC  X(04).  03640099
036500                         30  ASC-RCVR-NUMBER-N REDEFINES          03650099
036510                             ASC-RCVR-NUMBER                      03651099
036511                                                     PIC  9(04).  03651199
036512                         30  ASC-LINE-NO             PIC  X(04).  03651299
036513                         30  ASC-LINE-NO-N     REDEFINES          03651399
036514                             ASC-LINE-NO                          03651499
036515                                                     PIC  9(04).  03651599
036516                         30  ASC-CARTON-ID           PIC  X(22).  03651699
036517                         30  ASC-CART-ID REDEFINES                03651799
036518                             ASC-CARTON-ID.                       03651899
036519                             35  ASC-CART-ID-P       PIC  9(18).  03651999
036520                             35  FILLER              PIC  9(04).  03652099
036530                         30  ASC-PACK-TYPE           PIC  X(14).  03653099
036540                         30  ASC-PACK-ID             PIC  X(04).  03654099
036550                         30  ASC-PACK-ID-N REDEFINES ASC-PACK-ID  03655099
036560                                                     PIC  9(04).  03656099
036570                         30  ASC-AUDIT-NUMBER        PIC  X(09).  03657099
036580                         30  ASC-AUDIT-NUMBER-N REDEFINES         03658099
036590                                                ASC-AUDIT-NUMBER  03659099
036600                                                     PIC  9(09).  03660099
036700                         30  ASC-SET-NAME            PIC  X(05).  03670099
036800                         30  ASC-SET-YEAR            PIC  X(04).  03680099
036900                         30  ASC-CARTON-CREATE-SRCE  PIC  X(03).  03690099
037000                         30  ASC-DIRECTIVE-TYPE      PIC  X(01).  03700099
037001                         30  ASC-DIRECTIVE-REASON-CDE PIC X(03).  03700199
037002                         30  ASC-LOC-SENT            PIC  X(04).  03700299
037003                         30  ASC-CREATE-DATE         PIC  X(04).  03700399
037004                         30  ASC-CREATE-TIME         PIC  X(05).  03700499
037005                         30  ASC-CASI                PIC  X(01).  03700599
037006                         30  ASC-CRE-PGM-NM          PIC  X(08).  03700699
037007                         30  ASC-CRE-TMST            PIC  X(26).  03700799
037008                         30  ASC-SHIPT-UNT-ID        PIC  X(01).  03700899
037009                                                                  03700999
037010*---------------------------------------------------------------* 03701099
037020*    ABEND PROCESSING COPYBOOK.                                 * 03702099
037030*---------------------------------------------------------------* 03703099
037040     COPY DPWS013.                                                03704099
037050                                                                  03705099
037060*----------------------------------------------------------------*03706099
037070*    DB2 TABLE FOR TRECEIV - RC-RECEIVER - LRECL = 206            03707099
037080*----------------------------------------------------------------*03708099
037090     EXEC SQL                                                     03709099
037100          INCLUDE TRECEIV                                         03710099
037200     END-EXEC.                                                    03720099
037300                                                                  03730099
037400*---------------------------------------------------------------* 03740099
037500*    TVHTRIP - TR-TRIP - LRECL = 96                             * 03750099
037600*---------------------------------------------------------------* 03760099
037700     EXEC SQL                                                     03770099
037800          INCLUDE TVHTRIP                                         03780099
037900     END-EXEC.                                                    03790099
038000                                                                  03800099
038100*---------------------------------------------------------------* 03810099
038200*    TSHIPMT - TR-SHIPMENT - LRECL=288                            03820099
038300*---------------------------------------------------------------* 03830099
038400     EXEC SQL                                                     03840099
038500          INCLUDE TSHIPMT                                         03850099
038600     END-EXEC.                                                    03860099
038700                                                                  03870099
038800*---------------------------------------------------------------* 03880099
038900*    TSHPTPO - TR-SHIPMENT - PO ASSOCIATION - LRECL = 134         03890099
039000*---------------------------------------------------------------* 03900099
039100     EXEC SQL                                                     03910099
039200          INCLUDE TSHPTPO                                         03920099
039300     END-EXEC.                                                    03930099
039400                                                                  03940099
039500*---------------------------------------------------------------* 03950099
039600*    TPKSLIP - RC-PACK SLIP - LRECL=157                           03960099
039700*---------------------------------------------------------------* 03970099
039710     EXEC SQL                                                     03971099
039720          INCLUDE TPKSLIP                                         03972099
039730     END-EXEC.                                                    03973099
039740                                                                  03974099
039750*---------------------------------------------------------------* 03975099
039760*    TINPKSU - SU-INBOUND EDI PACKLIST/VENDOR SHIPMENT          * 03976099
039770*              UNIT ASSOCIATION - LRECL=26                      * 03977099
039771*---------------------------------------------------------------* 03977199
039772     EXEC SQL                                                     03977299
039773          INCLUDE TINPKSU                                         03977399
039774     END-EXEC.                                                    03977499
039775                                                                  03977599
039776*---------------------------------------------------------------* 03977699
039777*    TSHPUNT - SU-SHIPMENT UNIT - LRECL=79                        03977799
039778*---------------------------------------------------------------* 03977899
039779     EXEC SQL                                                     03977999
039780          INCLUDE TSHPUNT                                         03978099
039781     END-EXEC.                                                    03978199
039782                                                                  03978299
039783*CLP 01/27/14                                                     03978399
039784*----------------------------------------------------------------*03978499
039785*    DB2 DCLGEN FOR THE VENDOR PO AUDIT REQUEST TABLE             03978599
039786*    (SUT_PO_AUD_REQ)                                             03978699
039787*----------------------------------------------------------------*03978799
039788     EXEC SQL                                                     03978899
039789          INCLUDE SUT00015                                        03978999
039790     END-EXEC.                                                    03979099
039791*---------------------------------------------------------------* 03979199
039792*    SUT_CART_DIRV_TRKG - SU - CARTON DIRECTIVE TRACKING        * 03979299
039793*                         LRECL=165                             * 03979399
039794*---------------------------------------------------------------* 03979499
039795     EXEC SQL                                                     03979599
039796          INCLUDE SUT00102                                        03979699
039797     END-EXEC.                                                    03979799
039798                                                                  03979899
039799*---------------------------------------------------------------* 03979999
039800*    SUT_OTBND_CART SU-SHIPMENT UNIT - LRECL=82                 * 03980099
039801*                         LRECL=165                             * 03980199
039802*---------------------------------------------------------------* 03980299
039803     EXEC SQL                                                     03980399
039804          INCLUDE SUT00024                                        03980499
039805     END-EXEC.                                                    03980599
039806                                                                  03980699
039807*---------------------------------------------------------------* 03980799
039808*    WST_INTGRTN_TYP - WAREHOUSE SYSTEMS - INTEGRATION TYPE     * 03980899
039809*                      LRECL=78                                 * 03980999
039810*---------------------------------------------------------------* 03981099
039811     EXEC SQL                                                     03981199
039812          INCLUDE WST00008                                        03981299
039813     END-EXEC.                                                    03981399
039814                                                                  03981499
039815*---------------------------------------------------------------* 03981599
039816*    WST_ATTR_DEFN   - WAREHOUSE SYSTEMS - ATTRIBUTE DEFINITION * 03981699
039817*                      LRECL=78                                 * 03981799
039818*---------------------------------------------------------------* 03981899
039819     EXEC SQL                                                     03981999
039820          INCLUDE WST00009                                        03982099
039821     END-EXEC.                                                    03982199
039822                                                                  03982299
039823*---------------------------------------------------------------* 03982399
039824*    WST_ATTR_ELEM   - WAREHOUSE SYSTEMS - ATTRIBUTE ELEMENTS   * 03982499
039825*                      LRECL=97                                 * 03982599
039826*---------------------------------------------------------------* 03982699
039827     EXEC SQL                                                     03982799
039828          INCLUDE WST00010                                        03982899
039829     END-EXEC.                                                    03982999
039830                                                                  03983099
039831*---------------------------------------------------------------* 03983199
039832*---------------------------------------------------------------* 03983299
039833*               C U R S O R S                                   * 03983399
039834*---------------------------------------------------------------* 03983499
039835*    OPER UNIT ID, PO - SORT BY PO, RCVR,PACK,LINE, CART ID       03983599
039836*---------------------------------------------------------------* 03983699
039837*CHG0196894 REMOVE COMMENT FROM A.CRE_TMST LINE --MAX DIRECTIVE   03983799
039838     EXEC SQL                                                     03983899
039839        DECLARE ASC-OPER-UNIT-PO-C1 CURSOR FOR                    03983999
039840          SELECT A.OPER_UNT_ID                                    03984099
039850                ,A.PO_NBR                                         03985099
039860                ,A.RCVR_SEQ_NBR                                   03986099
039870                ,A.PO_LNE_NBR                                     03987099
039880                ,A.PREPK_ID                                       03988099
039890                ,A.BRCDE_NBR                                      03989099
039900                ,A.SEASET_SHRT_NM                                 03990099
040000                ,A.CNVYR_PRC_ACTN_NM                              04000099
040100                ,A.DIRV_RSN_CDE                                   04010099
040200                ,A.LGCL_LOC_NM                                    04020099
040300                ,A.CRE_TMST                                       04030099
040400                ,A.CASI_CDE                                       04040099
040500                ,A.CRE_PGM_NM                                     04050099
040600                ,A.SHIPT_UNT_ID                                   04060099
040610                ,A.AUD_CNTL_NBR                                   04061099
040700           FROM  SUT_CART_DIRV_TRKG  A                            04070099
040800          WHERE  A.OPER_UNT_ID    = :DK-OPER-UNIT-ID              04080099
040900            AND  A.PO_NBR         = :DK-PO-NUMBER                 04090099
041000            AND  A.CRE_TMST       =                               04100099
041100                   ( SELECT MAX (CRE_TMST)                        04110099
041200                     FROM SUT_CART_DIRV_TRKG B                    04120099
041300                     WHERE B.BRCDE_NBR  =  A.BRCDE_NBR            04130099
041400                     )                                            04140099
041500                 ORDER BY A.PO_NBR                                04150099
041600                         ,A.RCVR_SEQ_NBR                          04160099
041700                         ,A.PREPK_ID                              04170099
041800                         ,A.PO_LNE_NBR                            04180099
041900                         ,A.BRCDE_NBR                             04190099
041910          WITH UR                                                 04191099
042000     END-EXEC.                                                    04200099
042100                                                                  04210099
042200*---------------------------------------------------------------* 04220099
042300*    OPER UNIT ID, PO - SORT BY CREATE TIMESTAMP                  04230099
042400*---------------------------------------------------------------* 04240099
042410*CHG0196894 REMOVE COMMENT FROM A.CRE_TMST LINE --MAX DIRECTIVE   04241099
042500     EXEC SQL                                                     04250099
042501        DECLARE ASC-OPER-UNIT-PO-C2 CURSOR FOR                    04250199
042502          SELECT A.OPER_UNT_ID                                    04250299
042503                ,A.PO_NBR                                         04250399
042504                ,A.RCVR_SEQ_NBR                                   04250499
042505                ,A.PO_LNE_NBR                                     04250599
042506                ,A.PREPK_ID                                       04250699
042507                ,A.BRCDE_NBR                                      04250799
042508                ,A.SEASET_SHRT_NM                                 04250899
042509                ,A.CNVYR_PRC_ACTN_NM                              04250999
042510                ,A.DIRV_RSN_CDE                                   04251099
042520                ,A.LGCL_LOC_NM                                    04252099
042530                ,A.CRE_TMST                                       04253099
042540                ,A.CASI_CDE                                       04254099
042550                ,A.CRE_PGM_NM                                     04255099
042560                ,A.SHIPT_UNT_ID                                   04256099
042561                ,A.AUD_CNTL_NBR                                   04256199
042570           FROM  SUT_CART_DIRV_TRKG  A                            04257099
042580          WHERE  A.OPER_UNT_ID    = :DK-OPER-UNIT-ID              04258099
042590            AND  A.PO_NBR         = :DK-PO-NUMBER                 04259099
042600            AND  A.CRE_TMST       =                               04260099
042700                   ( SELECT MAX (CRE_TMST)                        04270099
042800                     FROM SUT_CART_DIRV_TRKG B                    04280099
042900                     WHERE B.BRCDE_NBR  =  A.BRCDE_NBR            04290099
043000                     )                                            04300099
043100                 ORDER BY A.CRE_TMST                              04310099
043110          WITH UR                                                 04311099
043200     END-EXEC.                                                    04320099
043300                                                                  04330099
043400*---------------------------------------------------------------* 04340099
043500*    OPER UNIT, PO, RCVR BY PO, RCVR, PACK,LINE, CART ID          04350099
043600*---------------------------------------------------------------* 04360099
043610*CHG0196894 REMOVE COMMENT FROM A.CRE_TMST LINE --MAX DIRECTIVE   04361099
043700     EXEC SQL                                                     04370099
043701        DECLARE ASC-OPER-UNIT-PO-R-C1 CURSOR FOR                  04370199
043702          SELECT A.OPER_UNT_ID                                    04370299
043703                ,A.PO_NBR                                         04370399
043704                ,A.RCVR_SEQ_NBR                                   04370499
043705                ,A.PO_LNE_NBR                                     04370599
043706                ,A.PREPK_ID                                       04370699
043707                ,A.BRCDE_NBR                                      04370799
043708                ,A.SEASET_SHRT_NM                                 04370899
043709                ,A.CNVYR_PRC_ACTN_NM                              04370999
043710                ,A.DIRV_RSN_CDE                                   04371099
043720                ,A.LGCL_LOC_NM                                    04372099
043730                ,A.CRE_TMST                                       04373099
043740                ,A.CASI_CDE                                       04374099
043750                ,A.CRE_PGM_NM                                     04375099
043760                ,A.SHIPT_UNT_ID                                   04376099
043761                ,A.AUD_CNTL_NBR                                   04376199
043770           FROM  SUT_CART_DIRV_TRKG  A                            04377099
043780          WHERE  A.OPER_UNT_ID    = :DK-OPER-UNIT-ID              04378099
043790            AND  A.PO_NBR         = :DK-PO-NUMBER                 04379099
043800            AND  A.RCVR_SEQ_NBR   = :DK-RCVR-NO                   04380099
043900            AND  A.CRE_TMST       =                               04390099
044000                   ( SELECT MAX (CRE_TMST)                        04400099
044100                     FROM SUT_CART_DIRV_TRKG B                    04410099
044200                     WHERE B.BRCDE_NBR  =  A.BRCDE_NBR            04420099
044300                     )                                            04430099
044400                 ORDER BY A.PO_NBR                                04440099
044500                         ,A.RCVR_SEQ_NBR                          04450099
044600                         ,A.PREPK_ID                              04460099
044700                         ,A.PO_LNE_NBR                            04470099
044800                         ,A.BRCDE_NBR                             04480099
044810          WITH UR                                                 04481099
044900     END-EXEC.                                                    04490099
045000                                                                  04500099
045100*---------------------------------------------------------------* 04510099
045200*    OPER UNIT, PO, RCVR BY CREATE TIME                           04520099
045300*---------------------------------------------------------------* 04530099
045310*CHG0196894 REMOVE COMMENT FROM A.CRE_TMST LINE --MAX DIRECTIVE   04531099
045400     EXEC SQL                                                     04540099
045401        DECLARE ASC-OPER-UNIT-PO-R-C2 CURSOR FOR                  04540199
045402          SELECT A.OPER_UNT_ID                                    04540299
045403                ,A.PO_NBR                                         04540399
045404                ,A.RCVR_SEQ_NBR                                   04540499
045405                ,A.PO_LNE_NBR                                     04540599
045406                ,A.PREPK_ID                                       04540699
045407                ,A.BRCDE_NBR                                      04540799
045408                ,A.SEASET_SHRT_NM                                 04540899
045409                ,A.CNVYR_PRC_ACTN_NM                              04540999
045410                ,A.DIRV_RSN_CDE                                   04541099
045420                ,A.LGCL_LOC_NM                                    04542099
045430                ,A.CRE_TMST                                       04543099
045440                ,A.CASI_CDE                                       04544099
045450                ,A.CRE_PGM_NM                                     04545099
045460                ,A.SHIPT_UNT_ID                                   04546099
045461                ,A.AUD_CNTL_NBR                                   04546199
045470           FROM  SUT_CART_DIRV_TRKG  A                            04547099
045480          WHERE  A.OPER_UNT_ID    = :DK-OPER-UNIT-ID              04548099
045490            AND  A.PO_NBR         = :DK-PO-NUMBER                 04549099
045500            AND  A.RCVR_SEQ_NBR   = :DK-RCVR-NO                   04550099
045600            AND  A.CRE_TMST       =                               04560099
045700                   ( SELECT MAX (CRE_TMST)                        04570099
045800                     FROM SUT_CART_DIRV_TRKG B                    04580099
045900                     WHERE B.BRCDE_NBR  =  A.BRCDE_NBR            04590099
046000                     )                                            04600099
046100                 ORDER BY A.CRE_TMST                              04610099
046110          WITH UR                                                 04611099
046200     END-EXEC.                                                    04620099
046300                                                                  04630099
046400*---------------------------------------------------------------* 04640099
046500*    OPER UNIT, PO, RCVR, LINE BY PO, RCVR, PACK,LINE, CART ID    04650099
046600*---------------------------------------------------------------* 04660099
046610*CHG0196894 REMOVE COMMENT FROM A.CRE_TMST LINE --MAX DIRECTIVE   04661099
046700     EXEC SQL                                                     04670099
046701        DECLARE ASC-OPER-UNIT-PO-R-LINE-C1 CURSOR FOR             04670199
046702          SELECT A.OPER_UNT_ID                                    04670299
046703                ,A.PO_NBR                                         04670399
046704                ,A.RCVR_SEQ_NBR                                   04670499
046705                ,A.PO_LNE_NBR                                     04670599
046706                ,A.PREPK_ID                                       04670699
046707                ,A.BRCDE_NBR                                      04670799
046708                ,A.SEASET_SHRT_NM                                 04670899
046709                ,A.CNVYR_PRC_ACTN_NM                              04670999
046710                ,A.DIRV_RSN_CDE                                   04671099
046720                ,A.LGCL_LOC_NM                                    04672099
046730                ,A.CRE_TMST                                       04673099
046740                ,A.CASI_CDE                                       04674099
046750                ,A.CRE_PGM_NM                                     04675099
046760                ,A.SHIPT_UNT_ID                                   04676099
046761                ,A.AUD_CNTL_NBR                                   04676199
046770           FROM  SUT_CART_DIRV_TRKG  A                            04677099
046780          WHERE  A.OPER_UNT_ID    = :DK-OPER-UNIT-ID              04678099
046790            AND  A.PO_NBR         = :DK-PO-NUMBER                 04679099
046800            AND  A.RCVR_SEQ_NBR   = :DK-RCVR-NO                   04680099
046900            AND  A.PO_LNE_NBR     = :DK-LINE-NO                   04690099
047000            AND  A.CRE_TMST       =                               04700099
047100                   ( SELECT MAX (CRE_TMST)                        04710099
047200                     FROM SUT_CART_DIRV_TRKG B                    04720099
047300                     WHERE B.BRCDE_NBR  =  A.BRCDE_NBR            04730099
047400                     )                                            04740099
047500                 ORDER BY A.PO_NBR                                04750099
047600                         ,A.RCVR_SEQ_NBR                          04760099
047700                         ,A.PREPK_ID                              04770099
047800                         ,A.PO_LNE_NBR                            04780099
047900                         ,A.BRCDE_NBR                             04790099
047910          WITH UR                                                 04791099
048000     END-EXEC.                                                    04800099
048100                                                                  04810099
048200*---------------------------------------------------------------* 04820099
048300*    OPER UNIT, PO, RCVR,LINE BY CREATE TIME                      04830099
048400*---------------------------------------------------------------* 04840099
048410*CHG0196894 REMOVE COMMENT FROM A.CRE_TMST LINE --MAX DIRECTIVE   04841099
048500     EXEC SQL                                                     04850099
048501        DECLARE ASC-OPER-UNIT-PO-R-LINE-C2 CURSOR FOR             04850199
048502          SELECT A.OPER_UNT_ID                                    04850299
048503                ,A.PO_NBR                                         04850399
048504                ,A.RCVR_SEQ_NBR                                   04850499
048505                ,A.PO_LNE_NBR                                     04850599
048506                ,A.PREPK_ID                                       04850699
048507                ,A.BRCDE_NBR                                      04850799
048508                ,A.SEASET_SHRT_NM                                 04850899
048509                ,A.CNVYR_PRC_ACTN_NM                              04850999
048510                ,A.DIRV_RSN_CDE                                   04851099
048520                ,A.LGCL_LOC_NM                                    04852099
048530                ,A.CRE_TMST                                       04853099
048540                ,A.CASI_CDE                                       04854099
048550                ,A.CRE_PGM_NM                                     04855099
048560                ,A.SHIPT_UNT_ID                                   04856099
048561                ,A.AUD_CNTL_NBR                                   04856199
048570           FROM  SUT_CART_DIRV_TRKG  A                            04857099
048580          WHERE  A.OPER_UNT_ID    = :DK-OPER-UNIT-ID              04858099
048590            AND  A.PO_NBR         = :DK-PO-NUMBER                 04859099
048600            AND  A.RCVR_SEQ_NBR   = :DK-RCVR-NO                   04860099
048700            AND  A.PO_LNE_NBR     = :DK-LINE-NO                   04870099
048800            AND  A.CRE_TMST       =                               04880099
048900                   ( SELECT MAX (CRE_TMST)                        04890099
049000                     FROM SUT_CART_DIRV_TRKG B                    04900099
049100                     WHERE B.BRCDE_NBR  =  A.BRCDE_NBR            04910099
049200                     )                                            04920099
049300                 ORDER BY A.CRE_TMST                              04930099
049310          WITH UR                                                 04931099
049400     END-EXEC.                                                    04940099
049500                                                                  04950099
049600*---------------------------------------------------------------* 04960099
049700*    OPER UNIT, PO, RCVR, PACK BY PO, RCVR, PACK,LINE, CART ID    04970099
049800*---------------------------------------------------------------* 04980099
049810*CHG0196894 REMOVE COMMENT FROM A.CRE_TMST LINE --MAX DIRECTIVE   04981099
049900     EXEC SQL                                                     04990099
049901        DECLARE ASC-OPER-UNIT-PO-R-PACK-C1 CURSOR FOR             04990199
049902          SELECT A.OPER_UNT_ID                                    04990299
049903                ,A.PO_NBR                                         04990399
049904                ,A.RCVR_SEQ_NBR                                   04990499
049905                ,A.PO_LNE_NBR                                     04990599
049906                ,A.PREPK_ID                                       04990699
049907                ,A.BRCDE_NBR                                      04990799
049908                ,A.SEASET_SHRT_NM                                 04990899
049909                ,A.CNVYR_PRC_ACTN_NM                              04990999
049910                ,A.DIRV_RSN_CDE                                   04991099
049920                ,A.LGCL_LOC_NM                                    04992099
049930                ,A.CRE_TMST                                       04993099
049940                ,A.CASI_CDE                                       04994099
049950                ,A.CRE_PGM_NM                                     04995099
049960                ,A.SHIPT_UNT_ID                                   04996099
049961                ,A.AUD_CNTL_NBR                                   04996199
049970           FROM  SUT_CART_DIRV_TRKG  A                            04997099
049980          WHERE  A.OPER_UNT_ID    = :DK-OPER-UNIT-ID              04998099
049990            AND  A.PO_NBR         = :DK-PO-NUMBER                 04999099
050000            AND  A.RCVR_SEQ_NBR   = :DK-RCVR-NO                   05000099
050100            AND  A.PREPK_ID       = :DK-PACK-ID                   05010099
050200            AND  A.CRE_TMST       =                               05020099
050300                   ( SELECT MAX (CRE_TMST)                        05030099
050400                     FROM SUT_CART_DIRV_TRKG B                    05040099
050500                     WHERE B.BRCDE_NBR  =  A.BRCDE_NBR            05050099
050600                     )                                            05060099
050700                 ORDER BY A.PO_NBR                                05070099
050800                         ,A.RCVR_SEQ_NBR                          05080099
050900                         ,A.PREPK_ID                              05090099
051000                         ,A.PO_LNE_NBR                            05100099
051100                         ,A.BRCDE_NBR                             05110099
051110          WITH UR                                                 05111099
051200     END-EXEC.                                                    05120099
051300                                                                  05130099
051400*---------------------------------------------------------------* 05140099
051500*    OPER UNIT, PO, RCVR, PACK BY CREATE TIME                     05150099
051600*---------------------------------------------------------------* 05160099
051610*CHG0196894 REMOVE COMMENT FROM A.CRE_TMST LINE --MAX DIRECTIVE   05161099
051700     EXEC SQL                                                     05170099
051701        DECLARE ASC-OPER-UNIT-PO-R-PACK-C2 CURSOR FOR             05170199
051702          SELECT A.OPER_UNT_ID                                    05170299
051703                ,A.PO_NBR                                         05170399
051704                ,A.RCVR_SEQ_NBR                                   05170499
051705                ,A.PO_LNE_NBR                                     05170599
051706                ,A.PREPK_ID                                       05170699
051707                ,A.BRCDE_NBR                                      05170799
051708                ,A.SEASET_SHRT_NM                                 05170899
051709                ,A.CNVYR_PRC_ACTN_NM                              05170999
051710                ,A.DIRV_RSN_CDE                                   05171099
051720                ,A.LGCL_LOC_NM                                    05172099
051730                ,A.CRE_TMST                                       05173099
051740                ,A.CASI_CDE                                       05174099
051750                ,A.CRE_PGM_NM                                     05175099
051760                ,A.SHIPT_UNT_ID                                   05176099
051761                ,A.AUD_CNTL_NBR                                   05176199
051770           FROM  SUT_CART_DIRV_TRKG  A                            05177099
051780          WHERE  A.OPER_UNT_ID    = :DK-OPER-UNIT-ID              05178099
051790            AND  A.PO_NBR         = :DK-PO-NUMBER                 05179099
051800            AND  A.RCVR_SEQ_NBR   = :DK-RCVR-NO                   05180099
051900            AND  A.PREPK_ID       = :DK-PACK-ID                   05190099
052000            AND  A.CRE_TMST       =                               05200099
052100                   ( SELECT MAX (CRE_TMST)                        05210099
052200                     FROM SUT_CART_DIRV_TRKG B                    05220099
052300                     WHERE B.BRCDE_NBR  =  A.BRCDE_NBR            05230099
052400                     )                                            05240099
052500                 ORDER BY A.CRE_TMST                              05250099
052510          WITH UR                                                 05251099
052600     END-EXEC.                                                    05260099
052700                                                                  05270099
052800*---------------------------------------------------------------* 05280099
052900*    AUDIT BY PO, RCVR, PACK,LINE, CART ID                        05290099
053000*---------------------------------------------------------------* 05300099
053010*CHG0196894 REMOVE COMMENT FROM A.CRE_TMST LINE --MAX DIRECTIVE   05301099
053100     EXEC SQL                                                     05310099
053101        DECLARE ASC-AUDIT-CONTROL-NO-C1 CURSOR FOR                05310199
053102          SELECT A.OPER_UNT_ID                                    05310299
053103                ,A.PO_NBR                                         05310399
053104                ,A.RCVR_SEQ_NBR                                   05310499
053105                ,A.PO_LNE_NBR                                     05310599
053106                ,A.PREPK_ID                                       05310699
053107                ,A.BRCDE_NBR                                      05310799
053108                ,A.SEASET_SHRT_NM                                 05310899
053109                ,A.CNVYR_PRC_ACTN_NM                              05310999
053110                ,A.DIRV_RSN_CDE                                   05311099
053120                ,A.LGCL_LOC_NM                                    05312099
053130                ,A.CRE_TMST                                       05313099
053140                ,A.CASI_CDE                                       05314099
053150                ,A.CRE_PGM_NM                                     05315099
053160                ,A.SHIPT_UNT_ID                                   05316099
053161                ,A.AUD_CNTL_NBR                                   05316199
053170           FROM  SUT_CART_DIRV_TRKG  A                            05317099
053180          WHERE  A.AUD_CNTL_NBR   = :DK-AUDIT-NO                  05318099
053190            AND  A.CRE_TMST       =                               05319099
053200                   ( SELECT MAX (CRE_TMST)                        05320099
053300                     FROM SUT_CART_DIRV_TRKG B                    05330099
053400                     WHERE B.BRCDE_NBR  =  A.BRCDE_NBR            05340099
053500                     )                                            05350099
053600                 ORDER BY A.PO_NBR                                05360099
053700                         ,A.RCVR_SEQ_NBR                          05370099
053800                         ,A.PREPK_ID                              05380099
053900                         ,A.PO_LNE_NBR                            05390099
054000                         ,A.BRCDE_NBR                             05400099
054010          WITH UR                                                 05401099
054100     END-EXEC.                                                    05410099
054200                                                                  05420099
054300*---------------------------------------------------------------* 05430099
054400*    AUDIT NUMBER BY CREATE TIME                                  05440099
054500*---------------------------------------------------------------* 05450099
054510*CHG0196894 REMOVE COMMENT FROM A.CRE_TMST LINE --MAX DIRECTIVE   05451099
054600     EXEC SQL                                                     05460099
054601        DECLARE ASC-AUDIT-CONTROL-NO-C2 CURSOR FOR                05460199
054602          SELECT A.OPER_UNT_ID                                    05460299
054603                ,A.PO_NBR                                         05460399
054604                ,A.RCVR_SEQ_NBR                                   05460499
054605                ,A.PO_LNE_NBR                                     05460599
054606                ,A.PREPK_ID                                       05460699
054607                ,A.BRCDE_NBR                                      05460799
054608                ,A.SEASET_SHRT_NM                                 05460899
054609                ,A.CNVYR_PRC_ACTN_NM                              05460999
054610                ,A.DIRV_RSN_CDE                                   05461099
054620                ,A.LGCL_LOC_NM                                    05462099
054630                ,A.CRE_TMST                                       05463099
054640                ,A.CASI_CDE                                       05464099
054650                ,A.CRE_PGM_NM                                     05465099
054660                ,A.SHIPT_UNT_ID                                   05466099
054661                ,A.AUD_CNTL_NBR                                   05466199
054670           FROM  SUT_CART_DIRV_TRKG  A                            05467099
054680          WHERE  A.AUD_CNTL_NBR   = :DK-AUDIT-NO                  05468099
054690            AND  A.CRE_TMST       =                               05469099
054700                   ( SELECT MAX (CRE_TMST)                        05470099
054800                     FROM SUT_CART_DIRV_TRKG B                    05480099
054900                     WHERE B.BRCDE_NBR  =  A.BRCDE_NBR            05490099
055000                     )                                            05500099
055100                 ORDER BY A.CRE_TMST                              05510099
055110          WITH UR                                                 05511099
055200     END-EXEC.                                                    05520099
055300                                                                  05530099
055400*---------------------------------------------------------------* 05540099
055500*    CARTON ID BY PO, RCVR, PACK,LINE, CART ID                    05550099
055600*---------------------------------------------------------------* 05560099
055700     EXEC SQL                                                     05570099
055701        DECLARE ASC-CARTON-ID-C1 CURSOR FOR                       05570199
055702          SELECT A.OPER_UNT_ID                                    05570299
055703                ,A.PO_NBR                                         05570399
055704                ,A.RCVR_SEQ_NBR                                   05570499
055705                ,A.PO_LNE_NBR                                     05570599
055706                ,A.PREPK_ID                                       05570699
055707                ,A.BRCDE_NBR                                      05570799
055708                ,A.SEASET_SHRT_NM                                 05570899
055709                ,A.CNVYR_PRC_ACTN_NM                              05570999
055710                ,A.DIRV_RSN_CDE                                   05571099
055720                ,A.LGCL_LOC_NM                                    05572099
055730                ,A.CRE_TMST                                       05573099
055740                ,A.CASI_CDE                                       05574099
055750                ,A.CRE_PGM_NM                                     05575099
055760                ,A.SHIPT_UNT_ID                                   05576099
055761                ,A.AUD_CNTL_NBR                                   05576199
055770           FROM  SUT_CART_DIRV_TRKG  A                            05577099
055780          WHERE  A.BRCDE_NBR      = :DK-CART-ID                   05578099
055791          ORDER BY CRE_TMST DESC                                  05579199
055792          FETCH FIRST ROW ONLY                                    05579299
055793          WITH UR                                                 05579399
056700     END-EXEC.                                                    05670099
056800                                                                  05680099
056900*---------------------------------------------------------------* 05690099
057000*    CARTON ID BY CREATE TIME                                     05700099
057100*---------------------------------------------------------------* 05710099
057200     EXEC SQL                                                     05720099
057201        DECLARE ASC-CARTON-ID-C2 CURSOR FOR                       05720199
057202          SELECT A.OPER_UNT_ID                                    05720299
057203                ,A.PO_NBR                                         05720399
057204                ,A.RCVR_SEQ_NBR                                   05720499
057205                ,A.PO_LNE_NBR                                     05720599
057206                ,A.PREPK_ID                                       05720699
057207                ,A.BRCDE_NBR                                      05720799
057208                ,A.SEASET_SHRT_NM                                 05720899
057209                ,A.CNVYR_PRC_ACTN_NM                              05720999
057210                ,A.DIRV_RSN_CDE                                   05721099
057220                ,A.LGCL_LOC_NM                                    05722099
057230                ,A.CRE_TMST                                       05723099
057240                ,A.CASI_CDE                                       05724099
057250                ,A.CRE_PGM_NM                                     05725099
057260                ,A.SHIPT_UNT_ID                                   05726099
057261                ,A.AUD_CNTL_NBR                                   05726199
057270           FROM  SUT_CART_DIRV_TRKG  A                            05727099
057280          WHERE  A.BRCDE_NBR      = :DK-CART-ID                   05728099
057281          ORDER BY CRE_TMST DESC                                  05728199
057282          FETCH FIRST ROW ONLY                                    05728299
057283          WITH UR                                                 05728399
057800     END-EXEC.                                                    05780099
057900                                                                  05790099
058000*---------------------------------------------------------------* 05800099
058100*    OPER UNIT ID, DATE - SORT BY PO, RCVR,PACK,LINE, CART ID     05810099
058200*---------------------------------------------------------------* 05820099
058210*CHG0196894 REMOVE COMMENT FROM A.CRE_TMST LINE --MAX DIRECTIVE   05821099
058300     EXEC SQL                                                     05830099
058301        DECLARE ASC-OPER-UNIT-DATE-C1 CURSOR FOR                  05830199
058302          SELECT A.OPER_UNT_ID                                    05830299
058303                ,A.PO_NBR                                         05830399
058304                ,A.RCVR_SEQ_NBR                                   05830499
058305                ,A.PO_LNE_NBR                                     05830599
058306                ,A.PREPK_ID                                       05830699
058307                ,A.BRCDE_NBR                                      05830799
058308                ,A.SEASET_SHRT_NM                                 05830899
058309                ,A.CNVYR_PRC_ACTN_NM                              05830999
058310                ,A.DIRV_RSN_CDE                                   05831099
058320                ,A.LGCL_LOC_NM                                    05832099
058330                ,A.CRE_TMST                                       05833099
058340                ,A.CASI_CDE                                       05834099
058350                ,A.CRE_PGM_NM                                     05835099
058360                ,A.SHIPT_UNT_ID                                   05836099
058361                ,A.AUD_CNTL_NBR                                   05836199
058370           FROM  SUT_CART_DIRV_TRKG  A                            05837099
058380          WHERE  A.OPER_UNT_ID    = :DK-OPER-UNIT-ID              05838099
058390            AND (A.CRE_TMST BETWEEN :DK-BEGIN-DATE                05839099
058400                                AND :DK-END-DATE  )               05840099
058500            AND  A.CRE_TMST       =                               05850099
058600                   ( SELECT MAX (CRE_TMST)                        05860099
058700                     FROM SUT_CART_DIRV_TRKG B                    05870099
058800                     WHERE B.BRCDE_NBR  =  A.BRCDE_NBR            05880099
058900                     )                                            05890099
059000                 ORDER BY A.PO_NBR                                05900099
059100                         ,A.RCVR_SEQ_NBR                          05910099
059200                         ,A.PREPK_ID                              05920099
059300                         ,A.PO_LNE_NBR                            05930099
059400                         ,A.BRCDE_NBR                             05940099
059410          WITH UR                                                 05941099
059500     END-EXEC.                                                    05950099
059600                                                                  05960099
059700*---------------------------------------------------------------* 05970099
059800*    OPER UNIT ID, DATE - SORT BY CREATE TIMESTAMP                05980099
059900*---------------------------------------------------------------* 05990099
059910*CHG0196894 REMOVE COMMENT FROM A.CRE_TMST LINE --MAX DIRECTIVE   05991099
060000     EXEC SQL                                                     06000099
060001        DECLARE ASC-OPER-UNIT-DATE-C2 CURSOR FOR                  06000199
060002          SELECT A.OPER_UNT_ID                                    06000299
060003                ,A.PO_NBR                                         06000399
060004                ,A.RCVR_SEQ_NBR                                   06000499
060005                ,A.PO_LNE_NBR                                     06000599
060006                ,A.PREPK_ID                                       06000699
060007                ,A.BRCDE_NBR                                      06000799
060008                ,A.SEASET_SHRT_NM                                 06000899
060009                ,A.CNVYR_PRC_ACTN_NM                              06000999
060010                ,A.DIRV_RSN_CDE                                   06001099
060020                ,A.LGCL_LOC_NM                                    06002099
060030                ,A.CRE_TMST                                       06003099
060040                ,A.CASI_CDE                                       06004099
060050                ,A.CRE_PGM_NM                                     06005099
060060                ,A.SHIPT_UNT_ID                                   06006099
060061                ,A.AUD_CNTL_NBR                                   06006199
060070           FROM  SUT_CART_DIRV_TRKG  A                            06007099
060080          WHERE  A.OPER_UNT_ID    = :DK-OPER-UNIT-ID              06008099
060090            AND (A.CRE_TMST BETWEEN :DK-BEGIN-DATE                06009099
060100                                AND :DK-END-DATE  )               06010099
060200            AND  A.CRE_TMST       =                               06020099
060300                   ( SELECT MAX (CRE_TMST)                        06030099
060400                     FROM SUT_CART_DIRV_TRKG B                    06040099
060500                     WHERE B.BRCDE_NBR  =  A.BRCDE_NBR            06050099
060600                     )                                            06060099
060700                 ORDER BY A.CRE_TMST                              06070099
060710          WITH UR                                                 06071099
060800     END-EXEC.                                                    06080099
060900                                                                  06090099
061000*---------------------------------------------------------------* 06100099
061100*    OPER UNIT ID, CASI, DATE BY PO, RCVR,PACK,LINE, CART ID      06110099
061200*---------------------------------------------------------------* 06120099
061300     EXEC SQL                                                     06130099
061301        DECLARE ASC-OPER-UNIT-CASI-DATE-C1 CURSOR FOR             06130199
061302          SELECT T4.OPER_UNT_ID                                   06130299
061303                ,T4.PO_NBR                                        06130399
061304                ,T4.RCVR_SEQ_NBR                                  06130499
061305                ,T4.PO_LNE_NBR                                    06130599
061306                ,T4.PREPK_ID                                      06130699
061307                ,T4.BRCDE_NBR                                     06130799
061308                ,T4.SEASET_SHRT_NM                                06130899
061309                ,T4.CNVYR_PRC_ACTN_NM                             06130999
061310                ,T4.DIRV_RSN_CDE                                  06131099
061320                ,T4.LGCL_LOC_NM                                   06132099
061330                ,T4.CRE_TMST                                      06133099
061340                ,T4.CASI_CDE                                      06134099
061350                ,T4.CRE_PGM_NM                                    06135099
061360                ,T4.SHIPT_UNT_ID                                  06136099
061361                ,T4.AUD_CNTL_NBR                                  06136199
061370          FROM   SUT_CART_DIRV_TRKG T4                            06137099
061380          JOIN   (                                                06138099
061390                  SELECT T1.BRCDE_NBR                             06139099
061400                    FROM SUT_CART_DIRV_TRKG T1                    06140099
061500                   WHERE  T1.OPER_UNT_ID = :DK-OPER-UNIT-ID       06150099
061510                     AND  T1.CASI_CDE    = :DK-CASI               06151099
061600                     AND  T1.CRE_TMST    =                        06160099
061700                        (                                         06170099
061800                          SELECT MIN(T0.CRE_TMST)                 06180099
061900                            FROM SUT_CART_DIRV_TRKG T0            06190099
062000                           WHERE  T0.OPER_UNT_ID = T1.OPER_UNT_ID 06200099
062100                             AND  T0.BRCDE_NBR   = T1.BRCDE_NBR   06210099
062300                                                                 )06230099
062400                           ) AS T2                                06240099
062500                                                                  06250099
062600          ON  T4.BRCDE_NBR   = T2.BRCDE_NBR                       06260099
062700         AND  T4.OPER_UNT_ID = :DK-OPER-UNIT-ID                   06270099
062800       WHERE  T4.CRE_TMST    = (                                  06280099
062900              SELECT MAX(T3.CRE_TMST)                             06290099
063000                FROM  SUT_CART_DIRV_TRKG T3                       06300099
063100               WHERE  T3.OPER_UNT_ID = T4.OPER_UNT_ID             06310099
063200                 AND  T3.BRCDE_NBR   = T4.BRCDE_NBR               06320099
063300                                                      )           06330099
063400         AND  T4.CRE_TMST BETWEEN :DK-BEGIN-DATE                  06340099
063500                              AND :DK-END-DATE                    06350099
063600                 ORDER BY T4.PO_NBR                               06360099
063700                         ,T4.RCVR_SEQ_NBR                         06370099
063800                         ,T4.PREPK_ID                             06380099
063900                         ,T4.PO_LNE_NBR                           06390099
064000                         ,T4.BRCDE_NBR                            06400099
064010          WITH UR                                                 06401099
064100     END-EXEC.                                                    06410099
064200                                                                  06420099
064300*---------------------------------------------------------------* 06430099
064400*    OPER UNIT ID, CASI, DATE - SORT BY CREATE TIMESTAMP          06440099
064500*---------------------------------------------------------------* 06450099
064600     EXEC SQL                                                     06460099
064601        DECLARE ASC-OPER-UNIT-CASI-DATE-C2 CURSOR FOR             06460199
064602          SELECT T4.OPER_UNT_ID                                   06460299
064603                ,T4.PO_NBR                                        06460399
064604                ,T4.RCVR_SEQ_NBR                                  06460499
064605                ,T4.PO_LNE_NBR                                    06460599
064606                ,T4.PREPK_ID                                      06460699
064607                ,T4.BRCDE_NBR                                     06460799
064608                ,T4.SEASET_SHRT_NM                                06460899
064609                ,T4.CNVYR_PRC_ACTN_NM                             06460999
064610                ,T4.DIRV_RSN_CDE                                  06461099
064620                ,T4.LGCL_LOC_NM                                   06462099
064630                ,T4.CRE_TMST                                      06463099
064640                ,T4.CASI_CDE                                      06464099
064650                ,T4.CRE_PGM_NM                                    06465099
064660                ,T4.SHIPT_UNT_ID                                  06466099
064661                ,T4.AUD_CNTL_NBR                                  06466199
064670          FROM   SUT_CART_DIRV_TRKG T4                            06467099
064680          JOIN   (                                                06468099
064690                  SELECT T1.BRCDE_NBR                             06469099
064700                    FROM SUT_CART_DIRV_TRKG T1                    06470099
064800                   WHERE  T1.OPER_UNT_ID = :DK-OPER-UNIT-ID       06480099
064810                     AND  T1.CASI_CDE    = :DK-CASI               06481099
064900                     AND  T1.CRE_TMST    =                        06490099
065000                        (                                         06500099
065100                          SELECT MIN(T0.CRE_TMST)                 06510099
065200                            FROM SUT_CART_DIRV_TRKG T0            06520099
065300                           WHERE  T0.OPER_UNT_ID = T1.OPER_UNT_ID 06530099
065400                             AND  T0.BRCDE_NBR   = T1.BRCDE_NBR   06540099
065600                                                                 )06560099
065700                           ) AS T2                                06570099
065800                                                                  06580099
065900          ON  T4.BRCDE_NBR   = T2.BRCDE_NBR                       06590099
066000         AND  T4.OPER_UNT_ID = :DK-OPER-UNIT-ID                   06600099
066100       WHERE  T4.CRE_TMST    = (                                  06610099
066200              SELECT MAX(T3.CRE_TMST)                             06620099
066300                FROM  SUT_CART_DIRV_TRKG T3                       06630099
066400               WHERE  T3.OPER_UNT_ID = T4.OPER_UNT_ID             06640099
066500                 AND  T3.BRCDE_NBR   = T4.BRCDE_NBR               06650099
066600                                                      )           06660099
066700         AND  T4.CRE_TMST BETWEEN :DK-BEGIN-DATE                  06670099
066800                              AND :DK-END-DATE                    06680099
066900                 ORDER BY T4.CRE_TMST                             06690099
066910          WITH UR                                                 06691099
067000     END-EXEC.                                                    06700099
067100                                                                  06710099
067200*---------------------------------------------------------------* 06720099
067300*    OPER UNIT, SETCODE, SET YEAR BY PO, RCVR, PACK,LINE, CART ID 06730099
067400*---------------------------------------------------------------* 06740099
067410*CHG0196894 REMOVE COMMENT FROM A.CRE_TMST LINE --MAX DIRECTIVE   06741099
067500     EXEC SQL                                                     06750099
067501        DECLARE ASC-OPER-UNIT-SETCODE-YR-C1 CURSOR FOR            06750199
067502          SELECT A.OPER_UNT_ID                                    06750299
067503                ,A.PO_NBR                                         06750399
067504                ,A.RCVR_SEQ_NBR                                   06750499
067505                ,A.PO_LNE_NBR                                     06750599
067506                ,A.PREPK_ID                                       06750699
067507                ,A.BRCDE_NBR                                      06750799
067508                ,A.SEASET_SHRT_NM                                 06750899
067509                ,A.CNVYR_PRC_ACTN_NM                              06750999
067510                ,A.DIRV_RSN_CDE                                   06751099
067520                ,A.LGCL_LOC_NM                                    06752099
067530                ,A.CRE_TMST                                       06753099
067540                ,A.CASI_CDE                                       06754099
067550                ,A.CRE_PGM_NM                                     06755099
067560                ,A.SHIPT_UNT_ID                                   06756099
067561                ,A.AUD_CNTL_NBR                                   06756199
067570           FROM  SUT_CART_DIRV_TRKG  A                            06757099
067580          WHERE  A.OPER_UNT_ID    = :DK-OPER-UNIT-ID              06758099
067590            AND  A.SEASET_SHRT_NM = :DK-SET-NAME                  06759099
067600            AND  A.SEASET_YR      = :DK-SET-YEAR                  06760099
067700            AND  A.CRE_TMST       =                               06770099
067800                   ( SELECT MAX (CRE_TMST)                        06780099
067900                     FROM SUT_CART_DIRV_TRKG B                    06790099
068000                     WHERE B.BRCDE_NBR  =  A.BRCDE_NBR            06800099
068100                     )                                            06810099
068200                 ORDER BY A.PO_NBR                                06820099
068300                         ,A.RCVR_SEQ_NBR                          06830099
068400                         ,A.PREPK_ID                              06840099
068500                         ,A.PO_LNE_NBR                            06850099
068600                         ,A.BRCDE_NBR                             06860099
068610          WITH UR                                                 06861099
068700     END-EXEC.                                                    06870099
068800                                                                  06880099
068900*---------------------------------------------------------------* 06890099
069000*    OPER UNIT, SETCODE, SET YEAR BY CREATE TIMESTAMP             06900099
069100*---------------------------------------------------------------* 06910099
069110*CHG0196894 REMOVE COMMENT FROM A.CRE_TMST LINE --MAX DIRECTIVE   06911099
069200     EXEC SQL                                                     06920099
069201        DECLARE ASC-OPER-UNIT-SETCODE-YR-C2 CURSOR FOR            06920199
069202          SELECT A.OPER_UNT_ID                                    06920299
069203                ,A.PO_NBR                                         06920399
069204                ,A.RCVR_SEQ_NBR                                   06920499
069205                ,A.PO_LNE_NBR                                     06920599
069206                ,A.PREPK_ID                                       06920699
069207                ,A.BRCDE_NBR                                      06920799
069208                ,A.SEASET_SHRT_NM                                 06920899
069209                ,A.CNVYR_PRC_ACTN_NM                              06920999
069210                ,A.DIRV_RSN_CDE                                   06921099
069220                ,A.LGCL_LOC_NM                                    06922099
069230                ,A.CRE_TMST                                       06923099
069240                ,A.CASI_CDE                                       06924099
069250                ,A.CRE_PGM_NM                                     06925099
069260                ,A.SHIPT_UNT_ID                                   06926099
069261                ,A.AUD_CNTL_NBR                                   06926199
069270           FROM  SUT_CART_DIRV_TRKG  A                            06927099
069280          WHERE  A.OPER_UNT_ID    = :DK-OPER-UNIT-ID              06928099
069290            AND  A.SEASET_SHRT_NM = :DK-SET-NAME                  06929099
069300            AND  A.SEASET_YR      = :DK-SET-YEAR                  06930099
069400            AND  A.CRE_TMST       =                               06940099
069500                   ( SELECT MAX (CRE_TMST)                        06950099
069600                     FROM SUT_CART_DIRV_TRKG B                    06960099
069700                     WHERE B.BRCDE_NBR  =  A.BRCDE_NBR            06970099
069800                     )                                            06980099
069900                 ORDER BY A.CRE_TMST                              06990099
069910          WITH UR                                                 06991099
070000     END-EXEC.                                                    07000099
070001*---------------------------------------------------------------* 07000199
070002*    OPER UNIT, DIRCODE BY PO, RCVR, PACK,LINE, CART ID           07000299
070003*---------------------------------------------------------------* 07000399
070004*CHG0196894 REMOVE COMMENT FROM A.CRE_TMST LINE --MAX DIRECTIVE   07000499
070005     EXEC SQL                                                     07000599
070006        DECLARE ASC-OPER-UNIT-RSN-CODE-C1 CURSOR FOR              07000699
070007          SELECT A.OPER_UNT_ID                                    07000799
070008                ,A.PO_NBR                                         07000899
070009                ,A.RCVR_SEQ_NBR                                   07000999
070010                ,A.PO_LNE_NBR                                     07001099
070011                ,A.PREPK_ID                                       07001199
070012                ,A.BRCDE_NBR                                      07001299
070013                ,A.SEASET_SHRT_NM                                 07001399
070014                ,A.CNVYR_PRC_ACTN_NM                              07001499
070015                ,A.DIRV_RSN_CDE                                   07001599
070016                ,A.LGCL_LOC_NM                                    07001699
070017                ,A.CRE_TMST                                       07001799
070018                ,A.CASI_CDE                                       07001899
070019                ,A.CRE_PGM_NM                                     07001999
070020                ,A.SHIPT_UNT_ID                                   07002099
070021                ,A.AUD_CNTL_NBR                                   07002199
070022             FROM  SUT_CART_DIRV_TRKG  A                          07002299
070023            WHERE  A.OPER_UNT_ID    = :DK-OPER-UNIT-ID            07002399
070024              AND  A.DIRV_RSN_CDE   = :DK-DIRV-RSN-CDE            07002499
070025              AND (A.CRE_TMST BETWEEN :DK-BEGIN-DATE              07002599
070026                                  AND :DK-END-DATE  )             07002699
070028              AND  A.CRE_TMST       =                             07002899
070030                   ( SELECT MAX (CRE_TMST)                        07003099
070031                     FROM SUT_CART_DIRV_TRKG B                    07003199
070032                     WHERE B.BRCDE_NBR  =  A.BRCDE_NBR            07003299
070033                   )                                              07003399
070034           ORDER BY A.PO_NBR                                      07003499
070035                   ,A.RCVR_SEQ_NBR                                07003599
070036                   ,A.PREPK_ID                                    07003699
070037                   ,A.PO_LNE_NBR                                  07003799
070038                   ,A.BRCDE_NBR                                   07003899
070039           WITH UR                                                07003999
070040     END-EXEC.                                                    07004099
070115*---------------------------------------------------------------* 07011599
070116*    OPER UNIT, DIRCODE. SORT CREATE TIMESTAMP                    07011699
070117*---------------------------------------------------------------* 07011799
070118*CHG0196894 REMOVE COMMENT FROM A.CRE_TMST LINE --MAX DIRECTIVE   07011899
070119     EXEC SQL                                                     07011999
070120        DECLARE ASC-OPER-UNIT-RSN-CODE-C2 CURSOR FOR              07012099
070121          SELECT A.OPER_UNT_ID                                    07012199
070122                ,A.PO_NBR                                         07012299
070123                ,A.RCVR_SEQ_NBR                                   07012399
070124                ,A.PO_LNE_NBR                                     07012499
070125                ,A.PREPK_ID                                       07012599
070126                ,A.BRCDE_NBR                                      07012699
070127                ,A.SEASET_SHRT_NM                                 07012799
070128                ,A.CNVYR_PRC_ACTN_NM                              07012899
070129                ,A.DIRV_RSN_CDE                                   07012999
070130                ,A.LGCL_LOC_NM                                    07013099
070131                ,A.CRE_TMST                                       07013199
070132                ,A.CASI_CDE                                       07013299
070133                ,A.CRE_PGM_NM                                     07013399
070134                ,A.SHIPT_UNT_ID                                   07013499
070135                ,A.AUD_CNTL_NBR                                   07013599
070136          FROM  SUT_CART_DIRV_TRKG  A                             07013699
070137         WHERE  A.OPER_UNT_ID    = :DK-OPER-UNIT-ID               07013799
070138           AND  A.DIRV_RSN_CDE   = :DK-DIRV-RSN-CDE               07013899
070139           AND (A.CRE_TMST BETWEEN :DK-BEGIN-DATE                 07013999
070140                               AND :DK-END-DATE  )                07014099
070142           AND  A.CRE_TMST       =                                07014299
070144                  ( SELECT MAX (CRE_TMST)                         07014499
070145                    FROM SUT_CART_DIRV_TRKG B                     07014599
070146                    WHERE B.BRCDE_NBR  =  A.BRCDE_NBR             07014699
070147                    )                                             07014799
070148                ORDER BY A.CRE_TMST                               07014899
070149          WITH UR                                                 07014999
070150     END-EXEC.                                                    07015099
070160                                                                  07016099
070200                                                                  07020099
070300*---------------------------------------------------------------* 07030099
070400*    DB2 AREA FOR COMMUNICATIONS                                * 07040099
070500*---------------------------------------------------------------* 07050099
070501     EXEC SQL                                                     07050199
070502          INCLUDE SQLCA                                           07050299
070503     END-EXEC.                                                    07050399
070504                                                                  07050499
070505***************************************************************** 07050599
070506 LINKAGE SECTION.                                                 07050699
070507                                                                  07050799
070508 01  DFHCOMMAREA.                                                 07050899
070509     05  FILLER                         OCCURS  1 TO 4072 TIMES   07050999
070510                                        DEPENDING ON EIBCALEN.    07051099
070511         10  FILLER                     PIC X.                    07051199
070512                                                                  07051299
070513                                                                  07051399
070514 PROCEDURE DIVISION.                                              07051499
070515******************************************************************07051599
070516**  THIS MODULE IS THE HIGHEST PROCESSING LEVEL IN THE PROGRAM. **07051699
070517**  FIRST, CALL THE CICS ARCHITECTURE API, F -C1RM THE PROGRAM  **07051799
070518**  PROCESSING AND THEN CALL THE CICS ARCHITECTURE API TO EXIT. **07051899
070519******************************************************************07051999
070520 0000-MAIN-MODULE.                                                07052099
070521     INITIALIZE DP030-CICS-API-FIELDS.                            07052199
070522     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       07052299
070523     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          07052399
070524     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         07052499
070525     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       07052599
070526     MOVE LENGTH OF SUK772I        TO DP030-MAP-LENGTH (1).       07052699
070527     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     07052799
070528     PERFORM 0001-CALL-CICS-ARCH-API.                             07052899
070529*                                                                 07052999
070530     PERFORM 1000-CONTROL-PROCESSING                              07053099
070531*                                                                 07053199
070532     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     07053299
070533     PERFORM 0001-CALL-CICS-ARCH-API.                             07053399
070534                                                                  07053499
070535******************************************************************07053599
070536**  THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE   **07053699
070537**  AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.         **07053799
070538******************************************************************07053899
070539 0001-CALL-CICS-ARCH-API.                                         07053999
070540*    CALL 'DPKCS030' USING DFHEIBLK                               07054099
070540     CALL DP930-CICS-ARCH-API USING DFHEIBLK                      07054199
070541                           DFHCOMMAREA                            07054299
070542                           DP030-CICS-API-FIELDS                  07054399
070543                           DP020-STANDARD-COMMAREA                07054499
070544                           SUK772I.                               07054599
070545*                                                                 07054699
070546     IF  DP030-RC-CALL-SUCCESSFUL                                 07054799
070547         CONTINUE                                                 07054899
070548     ELSE                                                         07054999
070549         SET DP013-NO-ROLLBACK                                    07055099
070550             DP013-XCTL-DISPLAY-RESTART                           07055199
070551             DP013-CICS-ABEND      TO TRUE                        07055299
070552         MOVE '0001-CALL-CICS-ARCH-API'                           07055399
070553                                   TO DP013-PARAGRAPH             07055499
070554*        MOVE 'CALL TO DPKCS030 NOT SUCCESSFUL, RETURN-CODE ON NEX07055599
070555*             'T LINE'             TO DP013-MESSAGE-TEXT (2)      07055699
070554         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O07055799
070555-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      07055899
070556         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      07055999
070557         PERFORM DP013-0000-PROCESS-ABEND                         07056099
070558     END-IF.                                                      07056199
070559                                                                  07056299
070560*----------------------------------------------------------------*07056399
070561* PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT      *07056499
070562* COURSE OF ACTION IS FOR THIS TRANSACTION.                      *07056599
070563*                                                                *07056699
070564* NOTE:  PV-TOP-ITEM IS THE ITEM THAT IS REQUESTED TO BE AT THE  *07056799
070565*  TOP OF THE PANEL.  MOVING ASC-ITEM-AT-TOP-OF-PANEL TO THIS    *07056899
070566*  MEANS THAT POSITION WITHIN THE LIST WILL NOT CHANGE -- THIS   *07056999
070567*  IS THE DEFAULT WHICH WILL BE OVERRIDDEN BY SCROLLING ACTIONS. *07057099
070568*----------------------------------------------------------------*07057199
070569 1000-CONTROL-PROCESSING.                                         07057299
070570     EVALUATE TRUE                                                07057399
070571         WHEN DP020-NEXT-ACT-INITIAL                              07057499
070572             INITIALIZE ASC-SPECIFIC-COMMAREA                     07057599
070573             MOVE EIBTRMID    TO ASC-LIST-TERM-ID                 07057699
070574                                 ASC-SEL-TERM-ID                  07057799
070575             MOVE DP020-SRC-TASK-NUMBER TO ASC-LIST-TASK-NUMBER   07057899
070576                                           ASC-SEL-TASK-NUMBER    07057999
070577             MOVE PC-LIST-QUEUE-SEQ TO ASC-LIST-SEQ               07058099
070578             MOVE PC-SEL-QUEUE-SEQ  TO ASC-SEL-SEQ                07058199
070579             PERFORM 1100-PROCESS-INTER-APPL-COMM                 07058299
070580             MOVE ASC-PO-NUMBER-H      TO  DK-PO-NUMBER           07058399
070581             PERFORM 4000-BUILD-INITIAL-PANEL                     07058499
070582                                                                  07058599
070583         WHEN DP020-NEXT-ACT-READ-MAP                             07058699
070584             MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-TOP-ITEM         07058799
070585             PERFORM 2000-PROCESS-PANEL                           07058899
070586                                                                  07058999
070587         WHEN DP020-NEXT-ACT-RETURN                               07059099
070588             MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-TOP-ITEM         07059199
070589             MOVE ZERO  TO ASC-ITEM-AT-TOP-OF-PANEL               07059299
070590             PERFORM 6000-REFRESH-PANEL-FROM-TEMP                 07059399
070600             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 07060099
070601                                                                  07060199
070602         WHEN OTHER                                               07060299
070603             SET DP013-LOGIC-ABEND TO TRUE                        07060399
070604             SET DP013-NO-ROLLBACK TO TRUE                        07060499
070605             MOVE '1000-CONTROL-PROCESSING' TO DP013-PARAGRAPH    07060599
070606             MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    07060699
070607                                   TO DP013-MESSAGE-TEXT(1)       07060799
070608             PERFORM DP013-0000-PROCESS-ABEND                     07060899
070609     END-EVALUATE.                                                07060999
070610                                                                  07061099
070611*----------------------------------------------------------------*07061199
070612* DETERMINE IF DATA WAS PASSED THROUGH INTER-APPL COMMAREA OR    *07061299
070613* IF THERE IS DATA TO BE USED IN THE NAV-KEY FIELD.              *07061399
070614*----------------------------------------------------------------*07061499
070615 1100-PROCESS-INTER-APPL-COMM.                                    07061599
070616                                                                  07061699
070617     SET PS-COMMAREA-VALID         TO TRUE.                       07061799
070618     MOVE SPACE                    TO ASC-START-ITEM-REQUEST.     07061899
070619                                                                  07061999
070620     IF  DP020-INT-APPL-FORMAT-IND = PC-CRIT-SPEC-FORMAT          07062099
070621         MOVE SU100-CURSOR-SW          TO ASC-CURSOR-SW           07062199
070622         MOVE PC-C1                    TO ASC-SORT-SEQ-SW         07062299
070623         MOVE SU100-FUNCTION           TO ASC-FUNCTION            07062399
070624         MOVE SU100-OPER-UNIT          TO ASC-OPER-UNIT           07062499
070625         MOVE SU100-OPER-NAME          TO ASC-OPER-UNIT-NAME      07062599
070626         MOVE SU100-PO-NUMBER          TO ASC-PO-NUMBER-H         07062699
070627         MOVE SU100-RCVR-SEQ-NO        TO ASC-RCVR-NUMBER-H       07062799
070628         MOVE SU100-RCVR-PACK-TYPE     TO ASC-PACK-TYPE-H         07062899
070629         MOVE SU100-LINE-NO            TO ASC-LINE-NO-H           07062999
070630         MOVE SU100-PACK-ID            TO ASC-PACK-ID-H           07063099
070631         MOVE SU100-AUDIT-NUMBER       TO ASC-AUDIT-NUMBER-H      07063199
070632         MOVE SU100-CARTON-ID          TO ASC-CARTON-ID-H         07063299
070633         MOVE SU100-ORIG-CASI          TO ASC-CASI-H              07063399
070634         MOVE SU100-CRE-PGM-NM         TO ASC-CRE-PGM-NM-H        07063499
070635         MOVE SU100-DIRCODE            TO ASC-DIR-CODE-H          07063599
070636         MOVE SU100-SETCODE            TO ASC-SET-NAME-H          07063699
070637         MOVE SU100-YEAR               TO ASC-SET-YEAR-H          07063799
070638         MOVE SU100-DATE-RANGE-BEGIN   TO ASC-START-DATE          07063899
070639         MOVE '.000000' TO ASC-START-SSSSSS                       07063999
070640         MOVE '.'       TO ASC-START-COL1                         07064099
070641                           ASC-START-COL2                         07064199
070642         MOVE SU100-DATE-RANGE-END     TO ASC-END-DATE            07064299
070643         MOVE '.000000'                TO ASC-END-SSSSSS          07064399
070644         MOVE '.'                      TO ASC-END-COL1            07064499
070645                                          ASC-END-COL2            07064599
070646         MOVE SU100-CURSOR-SW          TO ASC-CURSOR-SW           07064699
070647         SET  ASC-LOCK-MODE-ALL-DIRECT TO TRUE                    07064799
070648         SET  ASC-SORT-SEQ-DEFAULT     TO TRUE                    07064899
070649     ELSE                                                         07064999
070650         MOVE SU100-FUNCTION           TO ASC-FUNCTION            07065099
070651         MOVE SU100-OPER-UNIT          TO ASC-OPER-UNIT           07065199
070652         IF SU101-NUMBER-OF-SELECTED-ITEMS > 0                    07065299
070653            SET  ASC-USE-SELECTION-QUEUE TO TRUE                  07065399
070654            MOVE SU101-NUMBER-OF-SELECTED-ITEMS                   07065499
070655                               TO ASC-NUMBER-OF-SELECTED-ITEMS    07065599
070656            MOVE SU101-NUMBER-OF-TS-ITEMS                         07065699
070657                               TO ASC-NUMBER-OF-TS-ITEMS          07065799
070658            MOVE SU101-SEL-QUEUE-NAME                             07065899
070659                                   TO ASC-SEL-QUEUE-NAME          07065999
070660            MOVE SU101-OPER-UNIT          TO ASC-OPER-UNIT        07066099
070661            PERFORM 1120-PREPARE-LIST-ENTRY                       07066199
070670         END-IF                                                   07067099
070671     END-IF.                                                      07067199
070672                                                                  07067299
070673*----------------------------------------------------------------*07067399
070674* ENTRY IS FROM A LIST.  GET THE MESSAGE NUMBER FROM THE TEMP    *07067499
070675* STORAGE QUEUE PASSED FROM THE LIST.                            *07067599
070676*----------------------------------------------------------------*07067699
070677 1120-PREPARE-LIST-ENTRY.                                         07067799
070678     MOVE SU102-MAX-ITEMS          TO ASC-SEL-SUB.                07067899
070679     MOVE ZERO                     TO ASC-SEL-ITEM.               07067999
070680     PERFORM 1130-GET-NEXT-RECORD.                                07068099
070681                                                                  07068199
070682*---------------------------------------------------------------- 07068299
070683*    GET THE NEXT RECORD IF A LIST OF RECORDS ARE BEING PROCESSED*07068399
070684*---------------------------------------------------------------- 07068499
070685 1130-GET-NEXT-RECORD.                                            07068599
070686     ADD +1                        TO ASC-SEL-SUB.                07068699
070687     SET ASC-UPDATE-TSQ TO TRUE.                                  07068799
070688                                                                  07068899
070689     IF  ASC-SEL-SUB > SU102-MAX-ITEMS                            07068999
070690         ADD +1                    TO ASC-SEL-ITEM                07069099
070691         MOVE +1                   TO ASC-SEL-SUB                 07069199
070692     END-IF.                                                      07069299
070693                                                                  07069399
070694     IF  ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                07069499
070695         PERFORM 9100-READ-SEL-QUEUE                              07069599
070696         IF  SU102-ITEM (ASC-SEL-SUB) > ZERO                      07069699
070697             PERFORM 1160-MOVE-TO-ASC                             07069799
070698             SET SU102-INQ (ASC-SEL-SUB) TO TRUE                  07069899
070699             PERFORM 9200-REWRITE-SEL-QUEUE                       07069999
070700         ELSE                                                     07070099
070701             SUBTRACT +1 FROM ASC-SEL-SUB                         07070199
070702             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            07070299
070703             SET DP020-MSG-INFORMATIONAL                          07070399
070704                 PS-LIST-END       TO TRUE                        07070499
070705         END-IF                                                   07070599
070706     ELSE                                                         07070699
070707         SUBTRACT +1 FROM ASC-SEL-ITEM                            07070799
070708         MOVE SU102-MAX-ITEMS      TO ASC-SEL-SUB                 07070899
070709         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            07070999
070710         SET DP020-MSG-INFORMATIONAL                              07071099
070711                 PS-LIST-END       TO TRUE                        07071199
070712     END-IF.                                                      07071299
070713                                                                  07071399
070714******************************************************************07071499
070715*  GET THE PREVIOUS RECORD IF A LIST OF RECORDS ARE BEING         07071599
070716*  PROCESSED.                                                     07071699
070717******************************************************************07071799
070718 1140-GET-PREV-RECORD.                                            07071899
070719     SUBTRACT +1 FROM ASC-SEL-SUB.                                07071999
070720                                                                  07072099
070721     IF  ASC-SEL-SUB < +1                                         07072199
070722         SUBTRACT +1 FROM ASC-SEL-ITEM                            07072299
070723         MOVE SU102-MAX-ITEMS      TO ASC-SEL-SUB                 07072399
070724     END-IF.                                                      07072499
070725                                                                  07072599
070726     IF  ASC-SEL-ITEM > ZERO                                      07072699
070727         PERFORM 9100-READ-SEL-QUEUE                              07072799
070728         IF  SU102-ITEM (ASC-SEL-SUB) > ZERO                      07072899
070729             PERFORM 1160-MOVE-TO-ASC                             07072999
070730         END-IF                                                   07073099
070731                                                                  07073199
070732         SET SU102-INQ (ASC-SEL-SUB) TO TRUE                      07073299
070733         PERFORM 9200-REWRITE-SEL-QUEUE                           07073399
070734     ELSE                                                         07073499
070735         MOVE +1                   TO ASC-SEL-ITEM                07073599
070736                                      ASC-SEL-SUB                 07073699
070737         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            07073799
070738         SET DP020-MSG-INFORMATIONAL                              07073899
070739             PS-LIST-END             TO TRUE                      07073999
070740     END-IF.                                                      07074099
070741                                                                  07074199
070742 1160-MOVE-TO-ASC.                                                07074299
070743     MOVE SU102-PO-NUMBER    (ASC-SEL-SUB)  TO ASC-PO-NUMBER-H.   07074399
070744     MOVE SU102-RCVR         (ASC-SEL-SUB)  TO ASC-RCVR-NUMBER-H. 07074499
070745     MOVE SU102-LINE-PACK    (ASC-SEL-SUB)  TO ASC-PACK-TYPE-H.   07074599
070746     MOVE SU102-CARTON-ID    (ASC-SEL-SUB)  TO ASC-CARTON-ID-H.   07074699
070747                                                                  07074799
070748*----------------------------------------------------------------*07074899
070749* DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *07074999
070750* ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *07075099
070751* USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *07075199
070752* OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *07075299
070753* FUNCTION KEYS CAN GET THIS FAR.                                *07075399
070754*----------------------------------------------------------------*07075499
070755 2000-PROCESS-PANEL.                                              07075599
070756     EVALUATE TRUE                                                07075699
070757         WHEN DP020-SRC-AID = DP016-CLEAR                         07075799
070759             MOVE ZERO TO ASC-ITEM-AT-TOP-OF-PANEL                07075999
070760             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   07076099
070761             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 07076199
070762                                                                  07076299
070763         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    07076399
070765             PERFORM 2050-DELETE-LIST-QUEUE                       07076599
070766             SET SU100-FUNCTION-NONE  TO TRUE                     07076699
070767             EVALUATE TRUE                                        07076799
070768                WHEN ASC-OPER-UNIT-PO-C1                          07076899
070769                  OR ASC-OPER-UNIT-PO-C2                          07076999
070770                     MOVE ASC-OPER-UNIT       TO DK-OPER-UNIT-ID  07077099
070771                     MOVE ASC-PO-NUMBER-H     TO DK-PO-NUMBER     07077199
070772                WHEN ASC-OPER-UNIT-PO-R-C1                        07077299
070773                  OR ASC-OPER-UNIT-PO-R-C2                        07077399
070775                     MOVE ASC-OPER-UNIT       TO DK-OPER-UNIT-ID  07077599
070776                     MOVE ASC-PO-NUMBER-H     TO DK-PO-NUMBER     07077699
070777                     MOVE ASC-RCVR-NUMBER-H                       07077799
070778                                              TO DK-RCVR-NO       07077899
070779                WHEN ASC-OPER-UNIT-PO-R-LINE-C1                   07077999
070780                  OR ASC-OPER-UNIT-PO-R-LINE-C2                   07078099
070782                     MOVE ASC-OPER-UNIT       TO DK-OPER-UNIT-ID  07078299
070783                     MOVE ASC-PO-NUMBER-H     TO DK-PO-NUMBER     07078399
070784                     MOVE ASC-RCVR-NUMBER-H                       07078499
070790                                              TO DK-RCVR-NO       07079099
070800                     MOVE ASC-LINE-NO-H       TO DK-LINE-NO       07080099
070900                WHEN ASC-OPER-UNIT-PO-R-PACK-C1                   07090099
070910                  OR ASC-OPER-UNIT-PO-R-PACK-C2                   07091099
070920                     MOVE ASC-OPER-UNIT       TO DK-OPER-UNIT-ID  07092099
070930                     MOVE ASC-PO-NUMBER-H     TO DK-PO-NUMBER     07093099
070940                     MOVE ASC-RCVR-NUMBER-H                       07094099
070950                                              TO DK-RCVR-NO       07095099
070951                     MOVE ASC-PACK-ID-H       TO DK-PACK-ID       07095199
070952                WHEN ASC-AUDIT-CONTROL-NO-C1                      07095299
070953                  OR ASC-AUDIT-CONTROL-NO-C2                      07095399
070955                     MOVE ASC-AUDIT-NUMBER-N-H                    07095599
070956                                              TO DK-AUDIT-NO      07095699
070957                WHEN ASC-CARTON-ID-C1                             07095799
070958                  OR ASC-CARTON-ID-C2                             07095899
070960                     MOVE ASC-CARTON-ID-H     TO DK-CART-ID       07096099
070961                WHEN ASC-OPER-UNIT-DATE-C1                        07096199
070962                  OR ASC-OPER-UNIT-DATE-C2                        07096299
070970                     MOVE ASC-OPER-UNIT       TO DK-OPER-UNIT-ID  07097099
070980                     MOVE '.000000' TO ASC-START-SSSSSS           07098099
070990                     MOVE '.'       TO ASC-START-COL1             07099099
071000                                       ASC-START-COL2             07100099
071100                     MOVE ASC-START-DATE-TIMESTAMP                07110099
071200                                              TO DK-BEGIN-DATE    07120099
071300                     MOVE '.000000' TO ASC-END-SSSSSS             07130099
071400                     MOVE '.'       TO ASC-END-COL1               07140099
071500                                       ASC-END-COL2               07150099
071600                     MOVE ASC-DATE-END-TIMESTAMP                  07160099
071601                                              TO DK-END-DATE      07160199
071602                WHEN ASC-OPER-UNIT-CASI-DATE-C1                   07160299
071603                  OR ASC-OPER-UNIT-CASI-DATE-C2                   07160399
071605                     MOVE ASC-OPER-UNIT       TO DK-OPER-UNIT-ID  07160599
071606                     MOVE ASC-CASI-H          TO DK-CASI          07160699
071607                     MOVE '.000000' TO ASC-START-SSSSSS           07160799
071608                     MOVE '.'       TO ASC-START-COL1             07160899
071609                                       ASC-START-COL2             07160999
071610                     MOVE ASC-START-DATE-TIMESTAMP                07161099
071611                                              TO DK-BEGIN-DATE    07161199
071620                     MOVE '.000000' TO ASC-END-SSSSSS             07162099
071630                     MOVE '.'       TO ASC-END-COL1               07163099
071640                                       ASC-END-COL2               07164099
071650                     MOVE ASC-DATE-END-TIMESTAMP                  07165099
071651                                              TO DK-END-DATE      07165199
071652                WHEN ASC-OPER-UNIT-RSN-CODE-C1                    07165299
071653                  OR ASC-OPER-UNIT-RSN-CODE-C2                    07165399
071655                     MOVE ASC-OPER-UNIT       TO DK-OPER-UNIT-ID  07165599
071656                     MOVE ASC-DIR-CODE-H      TO DK-DIRV-RSN-CDE  07165699
071657                     MOVE '.000000' TO ASC-START-SSSSSS           07165799
071658                     MOVE '.'       TO ASC-START-COL1             07165899
071659                                       ASC-START-COL2             07165999
071660                     MOVE ASC-START-DATE-TIMESTAMP                07166099
071661                                              TO DK-BEGIN-DATE    07166199
071662                     MOVE '.000000' TO ASC-END-SSSSSS             07166299
071663                     MOVE '.'       TO ASC-END-COL1               07166399
071664                                       ASC-END-COL2               07166499
071665                     MOVE ASC-DATE-END-TIMESTAMP                  07166599
071666                                              TO DK-END-DATE      07166699
071667                                                                  07166799
071668                WHEN ASC-OPER-UNIT-SETCODE-YR-C1                  07166899
071669                  OR ASC-OPER-UNIT-SETCODE-YR-C2                  07166999
071670                     MOVE ASC-OPER-UNIT       TO DK-OPER-UNIT-ID  07167099
071671                     MOVE ASC-SET-NAME-H      TO DK-SET-NAME      07167199
071672                     MOVE ASC-SET-YEAR-H      TO DK-SET-YEAR      07167299
071673             END-EVALUATE                                         07167399
071674             PERFORM 4000-BUILD-INITIAL-PANEL                     07167499
071675                                                                  07167599
071676         WHEN DP020-FK-DESELECT (DP020-SRC-AID)                   07167699
071677             PERFORM 2140-DESELECT-ALL-ITEMS                      07167799
071678             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 07167899
071679                                                                  07167999
071680         WHEN DP020-FK-SELECT-ALL(DP020-SRC-AID)                  07168099
071681             PERFORM 2150-SELECT-ALL-ITEMS                        07168199
071682             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 07168299
071683         WHEN OTHER                                               07168399
071684             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 07168499
071685             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   07168599
071686             IF  PS-NO-ERROR                                      07168699
071687                 SET DP030-CONTINUE-GO TO TRUE                    07168799
071688                 PERFORM 2100-CHECK-FUNCTION-KEY                  07168899
071689             ELSE                                                 07168999
071690                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             07169099
071691                 SET DP030-OVERRIDE-GO TO TRUE                    07169199
071692             END-IF                                               07169299
071693     END-EVALUATE.                                                07169399
071694                                                                  07169499
071695*----------------------------------------------------------------*07169599
071696*  DELETE THE LIST ITEMS TEMP STORAGE QUEUE.                     *07169699
071697*----------------------------------------------------------------*07169799
071698 2050-DELETE-LIST-QUEUE.                                          07169899
071699                                                                  07169999
071700     EXEC CICS                                                    07170099
071701         DELETEQ TS                                               07170199
071702             QUEUE (ASC-LIST-QUEUE-NAME)                          07170299
071703             RESP  (PV-CICS-RESP)                                 07170399
071704     END-EXEC.                                                    07170499
071705                                                                  07170599
071706     IF (PV-CICS-RESP = DFHRESP(NORMAL)) OR                       07170699
071707        (PV-CICS-RESP = DFHRESP(QIDERR))                          07170799
071708         CONTINUE                                                 07170899
071709     ELSE                                                         07170999
071710         SET DP013-CICS-ABEND      TO TRUE                        07171099
071711         SET DP013-NO-ROLLBACK     TO TRUE                        07171199
071712                                                                  07171299
071713         MOVE '2050-DELETE-LIST-QUEUE' TO DP013-PARAGRAPH         07171399
071714         MOVE 'ERROR TRYING TO DELETE LIST TEMP STORAGE QUEUE'    07171499
071715                                   TO DP013-MESSAGE-TEXT (1)      07171599
071716         PERFORM DP013-0000-PROCESS-ABEND                         07171699
071717     END-IF.                                                      07171799
071718                                                                  07171899
071719     MOVE +0  TO ASC-HIGHEST-BLOCK-WRITTEN.                       07171999
071720                                                                  07172099
071721*----------------------------------------------------------------*07172199
071722* ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED FIRST.*07172299
071723* NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED FROM THE  *07172399
071724* CICS ARCHITECTURE API.                                         *07172499
071725*----------------------------------------------------------------*07172599
071726 2100-CHECK-FUNCTION-KEY.                                         07172699
071727                                                                  07172799
071728     EVALUATE TRUE                                                07172899
071729                                                                  07172999
071730* F16 - CHGLOCK    (LOCAL-FUNC-01)                                07173099
071731         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              07173199
071732             PERFORM 2050-DELETE-LIST-QUEUE                       07173299
071733                                                                  07173399
071734             IF ASC-LOCK-MODE-SW = '1'                            07173499
071735                MOVE '2' TO ASC-LOCK-MODE-SW                      07173599
071736             ELSE                                                 07173699
071737                MOVE '1' TO ASC-LOCK-MODE-SW                      07173799
071738             END-IF                                               07173899
071739             PERFORM 4000-BUILD-INITIAL-PANEL                     07173999
071740                                                                  07174099
071741* F18 - (DIRCDLST) (LOCAL-FUNC-03)                                07174199
071742         WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)              07174299
071743               MOVE SPACE TO ASC-FUNCTION                         07174399
071744               PERFORM 2110-PREPARE-INTER-APPL-COMM               07174499
071745                                                                  07174599
071746* F22 - (CTNRLLST) (LOCAL-FUNC-04)                                07174699
071747*        WHEN DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)              07174799
071750*            IF ASC-NUMBER-OF-SELECTED-ITEMS = 1                  07175099
071760*                SET ASC-USE-SELECTION-QUEUE TO TRUE              07176099
071770*                MOVE ASC-NUMBER-OF-SELECTED-ITEMS                07177099
071780*                           TO SU101-NUMBER-OF-SELECTED-ITEMS     07178099
071790*                MOVE ASC-NUMBER-OF-TS-ITEMS                      07179099
071800*                           TO SU101-NUMBER-OF-TS-ITEMS           07180099
071900*                MOVE ASC-SEL-QUEUE-NAME                          07190099
071901*                           TO  SU101-SEL-QUEUE-NAME              07190199
071902*                MOVE ASC-OPER-UNIT       TO SU101-OPER-UNIT      07190299
071903*                MOVE ASC-OPER-UNIT-NAME  TO SU101-OPER-NAME      07190399
071904*                MOVE ASC-SORT-SEQ-SW     TO SU101-SORT-SEQ       07190499
071905*                MOVE ASC-LOCK-MODE-SW    TO SU101-LOCK-MODE      07190599
071906*                MOVE ASC-CURSOR-SW       TO SU101-CURSOR-SW      07190699
071907*                MOVE ASC-END-DATE        TO SU101-DATE-RANGE-END 07190799
071908*                PERFORM 2110-PREPARE-INTER-APPL-COMM             07190899
071909*            ELSE                                                 07190999
071910*                PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             07191099
071920*                SET DP030-OVERRIDE-GO TO TRUE                    07192099
071930*                MOVE PC-TSYMSG-00057  TO DP020-MSG-NUMBER        07193099
071940*                SET DP020-MSG-FATAL   TO TRUE                    07194099
071950*            END-IF                                               07195099
071951                                                                  07195199
071952* F22 - (CTNRLLST) (LOCAL-FUNC-04)                                07195299
071953         WHEN DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)              07195399
071954             MOVE ASC-OPER-UNIT      TO DK-OPER-UNIT-ID           07195499
071955             IF ASC-OPER-UNIT   = DK-OPER-UNIT-ID                 07195599
071956                 IF ASC-NUMBER-OF-SELECTED-ITEMS > 0              07195699
071957                     SET ASC-USE-SELECTION-QUEUE TO TRUE          07195799
071958                     MOVE ASC-NUMBER-OF-SELECTED-ITEMS            07195899
071959                               TO SU101-NUMBER-OF-SELECTED-ITEMS  07195999
071960                     MOVE ASC-NUMBER-OF-TS-ITEMS                  07196099
071961                               TO SU101-NUMBER-OF-TS-ITEMS        07196199
071962                     MOVE ASC-SEL-QUEUE-NAME                      07196299
071963                               TO SU101-SEL-QUEUE-NAME            07196399
071964                     MOVE ASC-OPER-UNIT       TO SU101-OPER-UNIT  07196499
071965                     MOVE ASC-OPER-UNIT-NAME TO SU101-OPER-NAME   07196599
071966                     MOVE ASC-SORT-SEQ-SW    TO SU101-SORT-SEQ    07196699
071967                     MOVE ASC-LOCK-MODE-SW   TO SU101-LOCK-MODE   07196799
071968                     MOVE ASC-CURSOR-SW      TO SU101-CURSOR-SW   07196899
071969                     MOVE ASC-END-DATE    TO SU101-DATE-RANGE-END 07196999
071970                     MOVE ASC-FUNCTION       TO SU101-FUNCTION    07197099
071980                     PERFORM 5000-PREPARE-SEL-QUEUE               07198099
071981                 ELSE                                             07198199
071982                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         07198299
071983                     SET DP030-OVERRIDE-GO TO TRUE                07198399
071984                     MOVE PC-TSYMSG-00057  TO DP020-MSG-NUMBER    07198499
071985                     SET DP020-MSG-FATAL   TO TRUE                07198599
071986                 END-IF                                           07198699
071987             ELSE                                                 07198799
071988                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             07198899
071989                 SET DP030-OVERRIDE-GO TO TRUE                    07198999
071990                 MOVE PC-TSYMSG-02571  TO DP020-MSG-NUMBER        07199099
071991                 SET PS-ERROR                                     07199199
071992                     DP020-MSG-FATAL   TO TRUE                    07199299
071993             END-IF                                               07199399
071994                                                                  07199499
071995* F23 - (CARTON HISTORY) LOCAL-FUNC-05                            07199599
071996         WHEN DP020-FK-LOCAL-FUNC-05 (DP020-SRC-AID)              07199699
071997             MOVE ASC-OPER-UNIT      TO DK-OPER-UNIT-ID           07199799
071998             IF ASC-OPER-UNIT   = DK-OPER-UNIT-ID                 07199899
071999                 IF ASC-NUMBER-OF-SELECTED-ITEMS > 0              07199999
072000                     SET ASC-USE-SELECTION-QUEUE TO TRUE          07200099
072001                     MOVE ASC-NUMBER-OF-SELECTED-ITEMS            07200199
072002                               TO SU101-NUMBER-OF-SELECTED-ITEMS  07200299
072003                     MOVE ASC-NUMBER-OF-TS-ITEMS                  07200399
072004                               TO SU101-NUMBER-OF-TS-ITEMS        07200499
072005                     MOVE ASC-SEL-QUEUE-NAME                      07200599
072006                               TO SU101-SEL-QUEUE-NAME            07200699
072007                     MOVE ASC-OPER-UNIT       TO SU101-OPER-UNIT  07200799
072008                     MOVE ASC-OPER-UNIT-NAME TO SU101-OPER-NAME   07200899
072009                     MOVE ASC-SORT-SEQ-SW    TO SU101-SORT-SEQ    07200999
072010                     MOVE ASC-LOCK-MODE-SW   TO SU101-LOCK-MODE   07201099
072011                     MOVE ASC-CURSOR-SW      TO SU101-CURSOR-SW   07201199
072012                     MOVE ASC-END-DATE    TO SU101-DATE-RANGE-END 07201299
072013                     MOVE ASC-FUNCTION       TO SU101-FUNCTION    07201399
072014                     PERFORM 5000-PREPARE-SEL-QUEUE               07201499
072015                 ELSE                                             07201599
072016                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         07201699
072017                     SET DP030-OVERRIDE-GO TO TRUE                07201799
072018                     MOVE PC-TSYMSG-00057  TO DP020-MSG-NUMBER    07201899
072019                     SET DP020-MSG-FATAL   TO TRUE                07201999
072020                 END-IF                                           07202099
072030             ELSE                                                 07203099
072040                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             07204099
072050                 SET DP030-OVERRIDE-GO TO TRUE                    07205099
072060                 MOVE PC-TSYMSG-02571  TO DP020-MSG-NUMBER        07206099
072070                 SET PS-ERROR                                     07207099
072080                     DP020-MSG-FATAL   TO TRUE                    07208099
072090             END-IF                                               07209099
072100                                                                  07210099
072200                                                                  07220099
072300* F24 - CHGSORT    (LOCAL-FUNC-06)                                07230099
072400         WHEN DP020-FK-LOCAL-FUNC-06 (DP020-SRC-AID)              07240099
072500             PERFORM 2050-DELETE-LIST-QUEUE                       07250099
072600                                                                  07260099
072700             IF ASC-SORT-SEQ-SW    = '1'                          07270099
072800                MOVE '2'                  TO ASC-SORT-SEQ-SW      07280099
072900                EVALUATE TRUE                                     07290099
073000                   WHEN ASC-OPER-UNIT-PO-C1                       07300099
073100                    SET ASC-OPER-UNIT-PO-C2          TO TRUE      07310099
073200                   WHEN ASC-OPER-UNIT-PO-R-C1                     07320099
073210                    SET ASC-OPER-UNIT-PO-R-C2        TO TRUE      07321099
073211                   WHEN ASC-OPER-UNIT-PO-R-LINE-C1                07321199
073212                    SET ASC-OPER-UNIT-PO-R-LINE-C2   TO TRUE      07321299
073213                   WHEN ASC-OPER-UNIT-PO-R-PACK-C1                07321399
073214                    SET ASC-OPER-UNIT-PO-R-PACK-C2   TO TRUE      07321499
073215                   WHEN ASC-AUDIT-CONTROL-NO-C1                   07321599
073216                    SET ASC-AUDIT-CONTROL-NO-C2      TO TRUE      07321699
073217                   WHEN ASC-CARTON-ID-C1                          07321799
073218                    SET ASC-CARTON-ID-C2             TO TRUE      07321899
073219                   WHEN ASC-OPER-UNIT-DATE-C1                     07321999
073220                    SET ASC-OPER-UNIT-DATE-C2        TO TRUE      07322099
073221                   WHEN ASC-OPER-UNIT-CASI-DATE-C1                07322199
073222                    SET ASC-OPER-UNIT-CASI-DATE-C2   TO TRUE      07322299
073223                   WHEN ASC-OPER-UNIT-RSN-CODE-C1                 07322399
073224                    SET ASC-OPER-UNIT-RSN-CODE-C2    TO TRUE      07322499
073225                   WHEN ASC-OPER-UNIT-SETCODE-YR-C1               07322599
073226                    SET ASC-OPER-UNIT-SETCODE-YR-C2  TO TRUE      07322699
073227                END-EVALUATE                                      07322799
073228             ELSE                                                 07322899
073229                MOVE '1'                  TO ASC-SORT-SEQ-SW      07322999
073230                EVALUATE TRUE                                     07323099
073231                   WHEN ASC-OPER-UNIT-PO-C2                       07323199
073232                    SET ASC-OPER-UNIT-PO-C1          TO TRUE      07323299
073233                   WHEN ASC-OPER-UNIT-PO-R-C2                     07323399
073234                    SET ASC-OPER-UNIT-PO-R-C1        TO TRUE      07323499
073235                   WHEN ASC-OPER-UNIT-PO-R-LINE-C2                07323599
073236                    SET ASC-OPER-UNIT-PO-R-LINE-C1   TO TRUE      07323699
073237                   WHEN ASC-OPER-UNIT-PO-R-PACK-C2                07323799
073238                    SET ASC-OPER-UNIT-PO-R-PACK-C1   TO TRUE      07323899
073239                   WHEN ASC-AUDIT-CONTROL-NO-C2                   07323999
073240                    SET ASC-AUDIT-CONTROL-NO-C1      TO TRUE      07324099
073241                   WHEN ASC-CARTON-ID-C2                          07324199
073242                    SET ASC-CARTON-ID-C1             TO TRUE      07324299
073243                   WHEN ASC-OPER-UNIT-DATE-C2                     07324399
073244                    SET ASC-OPER-UNIT-DATE-C1        TO TRUE      07324499
073245                   WHEN ASC-OPER-UNIT-CASI-DATE-C2                07324599
073246                    SET ASC-OPER-UNIT-CASI-DATE-C1   TO TRUE      07324699
073247                   WHEN ASC-OPER-UNIT-RSN-CODE-C2                 07324799
073248                    SET ASC-OPER-UNIT-RSN-CODE-C1    TO TRUE      07324899
073249                   WHEN ASC-OPER-UNIT-SETCODE-YR-C2               07324999
073250                    SET ASC-OPER-UNIT-SETCODE-YR-C1  TO TRUE      07325099
073251                END-EVALUATE                                      07325199
073252             END-IF                                               07325299
073253             PERFORM 4000-BUILD-INITIAL-PANEL                     07325399
073254                                                                  07325499
073255* F6 - FIRST PAGE                                                 07325599
073256         WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                  07325699
073257             MOVE +1               TO PV-TOP-ITEM                 07325799
073258             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 07325899
073259                                                                  07325999
073260* F7 - PREVIOUS PAGE                                              07326099
073261         WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                   07326199
073262             PERFORM 2110-BROWSE-BACKWARD                         07326299
073263             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 07326399
073264                                                                  07326499
073265* F8 - NEXT PAGE                                                  07326599
073266         WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                   07326699
073267             PERFORM 2120-BROWSE-FORWARD                          07326799
073268             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 07326899
073269                                                                  07326999
073270*F21                                                              07327099
073271         WHEN DP020-FK-SELECT-ALL (DP020-SRC-AID)                 07327199
073272              PERFORM 2150-SELECT-ALL-ITEMS                       07327299
073273              PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                07327399
073274                                                                  07327499
073280* ENTER KEY                                                       07328099
073290         WHEN DP020-SRC-AID = DP016-ENTER                         07329099
073291             PERFORM 2130-CHECK-FOR-JUMP-BROWSE                   07329199
073292             IF  PS-ERROR                                         07329299
073293                 CONTINUE                                         07329399
073294             ELSE                                                 07329499
073295                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             07329599
073296             END-IF                                               07329699
073297                                                                  07329799
073298         WHEN OTHER                                               07329899
073299             SET DP013-NO-ROLLBACK                                07329999
073300                 DP013-XCTL-DISPLAY-RESTART                       07330099
073301                 DP013-CICS-ABEND  TO TRUE                        07330199
073302             MOVE '2100-CHECK-FUNCTION-KEY' TO DP013-PARAGRAPH    07330299
073303             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      07330399
073304                                   TO DP013-MESSAGE-TEXT (1)      07330499
073305             PERFORM DP013-0000-PROCESS-ABEND                     07330599
073306     END-EVALUATE.                                                07330699
073307                                                                  07330799
073308******************************************************************07330899
073309** MOVE DATA NECESSARY TO THE DESTINATION PROGRAM(S) INTO THE   **07330999
073310** INTER-APPLICATION COMMAREA.                                  **07331099
073311******************************************************************07331199
073312 2110-PREPARE-INTER-APPL-COMM.                                    07331299
073313                                                                  07331399
073314     INITIALIZE SU100-INTER-APPL-COMMAREA.                        07331499
073315                                                                  07331599
073316                                                                  07331699
073317*----------------------------------------------------------------*07331799
073318*    IF THE USER HITS THE PAGE BACKWARD KEY, COMPUTE THE TOP     *07331899
073319*    ITEM NUMBER FOR THE NEW PAGE.  IF IT IS ABOVE THE TOP,      *07331999
073320*    SET THE TOP ITEM NUMBER TO +1 AND DISPLAY THE TOP OF LIST   *07332099
073321*    MESSAGE.                                                    *07332199
073322*----------------------------------------------------------------*07332299
073323 2110-BROWSE-BACKWARD.                                            07332399
073324     SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    07332499
073325         GIVING PV-TOP-ITEM.                                      07332599
073326*                                                                 07332699
073327     IF  ((PV-TOP-ITEM < +1)                                      07332799
073328       OR (PV-TOP-ITEM = +1))                                     07332899
073329         MOVE +1                   TO PV-TOP-ITEM                 07332999
073330*        -- TOP OF LIST --                                        07333099
073331         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            07333199
073332         SET DP020-MSG-INFORMATIONAL TO TRUE                      07333299
073333     END-IF.                                                      07333399
073334                                                                  07333499
073335*----------------------------------------------------------------*07333599
073336*    IF THE USER HITS THE PAGE FORWARD KEY, COMPUTE THE TOP      *07333699
073337*    ITEM NUMBER FOR THE NEW PAGE.  IF THE USER ATTEMPTS TO GO   *07333799
073338*    PAST THE END, ISSUE THE BOTTOM OF LIST MESSAGE.             *07333899
073339*----------------------------------------------------------------*07333999
073340 2120-BROWSE-FORWARD.                                             07334099
073341     ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              07334199
073342         GIVING PV-TOP-ITEM.                                      07334299
073343     IF  PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                   07334399
073344         MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-TOP-ITEM             07334499
073345*        -- BOTTOM OF LIST --                                     07334599
073346         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            07334699
073347         SET DP020-MSG-INFORMATIONAL TO TRUE                      07334799
073348     ELSE                                                         07334899
073349         COMPUTE PV-BOTTOM-ITEM =                                 07334999
073350             PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 07335099
073351         IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ            07335199
073352*            -- BOTTOM OF LIST --                                 07335299
073353             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            07335399
073354             SET DP020-MSG-INFORMATIONAL TO TRUE                  07335499
073355         END-IF                                                   07335599
073356     END-IF.                                                      07335699
073357                                                                  07335799
073358*----------------------------------------------------------------*07335899
073359*    THE USER CAN CHANGE THE CURRENT BEGINNING LIST NUMBER SO    *07335999
073360*    THAT THE TRANSACTION WILL JUMP TO THAT POINT IN THE LIST.   *07336099
073361*    THIS IS A FASTER WAY TO GET TO A CERTAIN POINT IN THE LIST  *07336199
073362*    RATHER THAN HITTING NEXT-PAGE TO GET TO THAT POINT.         *07336299
073363*    THE NEW LIST NUMBER ENTERED IS EDITED TO MAKE SURE THAT     *07336399
073364*    IT IS NUMERIC AND FALLS BETWEEN A SPECIFIED RANGE.          *07336499
073365*----------------------------------------------------------------*07336599
073366 2130-CHECK-FOR-JUMP-BROWSE.                                      07336699
073367     SET PS-NO-ERROR               TO TRUE.                       07336799
073368     IF (ASC-START-ITEM-REQUEST = SPACE)                          07336899
073369         MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-TOP-ITEM             07336999
073370     ELSE                                                         07337099
073380         MOVE ASC-START-ITEM-REQUEST TO DP010I-UNEDITED-FIELD     07338099
073390         MOVE PC-MSG-NUMBER-LENGTH TO DP010I-MAXIMUM-DIGITS       07339099
073400         MOVE +0                   TO DP010I-MAXIMUM-DECIMALS     07340099
073500         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  07350099
263968         CALL DP010I-NUMERIC-EDIT-ROUTINE                         07361099
263968              USING DP010I-NUMERIC-EDIT-AREA                      07362099
073700                                                                  07370099
073800         IF  NOT DP010I-ERROR-DETECTED                            07380099
073900             MOVE DP010I-NUMERIC-FIELD TO ASC-START-ITEM-REQUEST-N07390099
074000             IF  ASC-START-ITEM-REQUEST-N > ZERO                  07400099
074100                 IF  ASC-START-ITEM-REQUEST-N >                   07410099
074200                                          ASC-NUMBER-OF-ITEMS-READ07420099
074300                     MOVE SPACE TO ASC-START-ITEM-REQUEST         07430099
074400                     COMPUTE PV-TOP-ITEM =                        07440099
074500                             ASC-NUMBER-OF-ITEMS-READ             07450099
074600                             - PC-ITEMS-PER-PANEL + 1             07460099
074700                     IF  PV-TOP-ITEM < +1                         07470099
074800                         MOVE +1   TO PV-TOP-ITEM                 07480099
074900                         MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER 07490099
075000                         SET DP020-MSG-INFORMATIONAL TO TRUE      07500099
075100                     END-IF                                       07510099
075200                 ELSE                                             07520099
075300                     MOVE ASC-START-ITEM-REQUEST-N                07530099
075400                                   TO PV-TOP-ITEM                 07540099
075500                     MOVE SPACE    TO ASC-START-ITEM-REQUEST      07550099
075600                     COMPUTE PV-BOTTOM-ITEM =                     07560099
075700                         PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1     07570099
075800                     IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ07580099
075900*                        -- BOTTOM OF LIST --                     07590099
076000                         MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER 07600099
076100                         SET DP020-MSG-INFORMATIONAL TO TRUE      07610099
076200                     END-IF                                       07620099
076300                 END-IF                                           07630099
076400             ELSE                                                 07640099
076500*                --- VALUE OUT OF RANGE ----                      07650099
076600                 MOVE PC-TSYMSG-00101 TO DP020-MSG-NUMBER         07660099
076700                 MOVE -1              TO ASTRTITL                 07670099
076800                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              07680099
076900                 MOVE DP015-REVERSE   TO ASTRTITH                 07690099
077000                 MOVE DP015-RED       TO ASTRTITC                 07700099
077100                 MOVE DP015-UNP-NUM-BRT-MDT TO ASTRTITA           07710099
077200                 SET DP020-MSG-FATAL  TO TRUE                     07720099
077300                 SET PS-ERROR         TO TRUE                     07730099
077400             END-IF                                               07740099
077500         ELSE                                                     07750099
077600             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            07760099
077700             MOVE -1               TO ASTRTITL                    07770099
077800             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  07780099
077900             MOVE DP015-REVERSE    TO ASTRTITH                    07790099
078000             MOVE DP015-RED        TO ASTRTITC                    07800099
078100             MOVE DP015-UNP-NUM-BRT-MDT TO ASTRTITA               07810099
078200             SET DP020-MSG-FATAL   TO TRUE                        07820099
078300             SET PS-ERROR          TO TRUE                        07830099
078400         END-IF                                                   07840099
078500     END-IF.                                                      07850099
078600                                                                  07860099
078700*----------------------------------------------------------------*07870099
078800*    IF THE USER HITS THE DESELECT KEY, CLEAR THE SELECTION      *07880099
078900*    SWITCH FOR ALL ITEMS THAT WERE PREVIOUSLY SELECTED.         *07890099
079000*----------------------------------------------------------------*07900099
079100 2140-DESELECT-ALL-ITEMS.                                         07910099
079200     MOVE +1                       TO ASC-BLK-SUB.                07920099
079300                                                                  07930099
079400     PERFORM 2141-CLEAR-SELECTED-INDS                             07940099
079500         VARYING ASC-ITEM-SUB                                     07950099
079600         FROM 1 BY 1                                              07960099
079700         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 07970099
079800                                                                  07980099
079900     ADD +1                        TO ASC-BLK-SUB.                07990099
080000                                                                  08000099
080100     PERFORM 2141-CLEAR-SELECTED-INDS                             08010099
080200         VARYING ASC-ITEM-SUB                                     08020099
080300         FROM 1 BY 1                                              08030099
080400         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 08040099
080500                                                                  08050099
080600     MOVE ASC-LIST-ITEM-NUMBER (1 1)                              08060099
080700                                   TO PV-LIST-ITEM-NUMBER.        08070099
080800                                                                  08080099
080900     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            08090099
081000         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    08100099
081100                                                                  08110099
081200     IF  PV-FIRST-BLOCK-IN-ARRAY  = +1                            08120099
081300         MOVE +1                   TO ASC-BLK-SUB                 08130099
081400                                                                  08140099
081500         PERFORM 5100-WRITE-TEMP-STORAGE                          08150099
081600         MOVE +2                   TO ASC-BLK-SUB                 08160099
081700         PERFORM 5100-WRITE-TEMP-STORAGE                          08170099
081800         MOVE +1                   TO ASC-BLK-SUB                 08180099
081900         MOVE +1                   TO PV-BLOCK-NUMBER             08190099
082000     END-IF.                                                      08200099
082100                                                                  08210099
082200     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     08220099
082300        (ASC-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)      08230099
082400         MOVE +1                   TO ASC-BLK-SUB                 08240099
082500                                                                  08250099
082600         PERFORM 5100-WRITE-TEMP-STORAGE                          08260099
082700         MOVE +2  TO ASC-BLK-SUB                                  08270099
082800         PERFORM 5100-WRITE-TEMP-STORAGE                          08280099
082900         MOVE +1  TO ASC-BLK-SUB                                  08290099
083000         MOVE +1  TO PV-BLOCK-NUMBER                              08300099
083100                                                                  08310099
083200         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         08320099
083300             PV-FIRST-BLOCK-IN-ARRAY - 1                          08330099
083400                                                                  08340099
083500         PERFORM                                                  08350099
083600             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       08360099
083700                                                                  08370099
083800             PERFORM 4410-READ-TEMP-STORAGE                       08380099
083900                                                                  08390099
084000             PERFORM 2141-CLEAR-SELECTED-INDS                     08400099
084100                 VARYING ASC-ITEM-SUB FROM 1 BY 1                 08410099
084200                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          08420099
084300                                                                  08430099
084400             PERFORM 5100-WRITE-TEMP-STORAGE                      08440099
084500                                                                  08450099
084600             ADD +1                TO PV-BLOCK-NUMBER             08460099
084700                                                                  08470099
084800         END-PERFORM                                              08480099
084900                                                                  08490099
085000         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         08500099
085100             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     08510099
085200                                                                  08520099
085300         PERFORM                                                  08530099
085400             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       08540099
085500                   ASC-HIGHEST-BLOCK-WRITTEN                      08550099
085600                                                                  08560099
085700             MOVE PV-NEXT-BLOCK-IN-ARRAY                          08570099
085800                                   TO PV-BLOCK-NUMBER             08580099
085900                                                                  08590099
086000             PERFORM 4410-READ-TEMP-STORAGE                       08600099
086100                                                                  08610099
086200             PERFORM 2141-CLEAR-SELECTED-INDS                     08620099
086300                 VARYING ASC-ITEM-SUB                             08630099
086400                 FROM 1 BY 1                                      08640099
086500                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          08650099
086600                                                                  08660099
086700             PERFORM 5100-WRITE-TEMP-STORAGE                      08670099
086800                                                                  08680099
086900             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      08690099
087000                                                                  08700099
087100         END-PERFORM                                              08710099
087200                                                                  08720099
087300         MOVE PV-FIRST-BLOCK-IN-ARRAY                             08730099
087400                                   TO PV-BLOCK-NUMBER             08740099
087500                                                                  08750099
087600         PERFORM 4410-READ-TEMP-STORAGE                           08760099
087700     END-IF.                                                      08770099
087800                                                                  08780099
087900                                                                  08790099
088000     MOVE +0                     TO ASC-NUMBER-OF-SELECTED-ITEMS. 08800099
088100     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE.08810099
088200     MOVE +0                       TO ASC-END-OF-SELECTED-RANGE.  08820099
088300                                                                  08830099
088400     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        08840099
088500                                                                  08850099
088600*----------------------------------------------------------------*08860099
088700*    MARK EACH ITEM AS BEING NOT SELECTED.                       *08870099
088800*----------------------------------------------------------------*08880099
088900 2141-CLEAR-SELECTED-INDS.                                        08890099
089000     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           08900099
089100             NOT EQUAL ZERO                                       08910099
089200         IF  NOT ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          08920099
089300             SET ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          08930099
089400                 ASC-TEMP-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)    08940099
089500                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB) TO TRUE          08950099
089600         END-IF                                                   08960099
089700     END-IF.                                                      08970099
089800                                                                  08980099
089900*----------------------------------------------------------------*08990099
090000*  IF THE USER HITS THE SELECT-ALL KEY, SET THE SELECTION SWITCH *09000099
090100*  FOR ALL ITEMS.                                                *09010099
090200*----------------------------------------------------------------*09020099
090201 2150-SELECT-ALL-ITEMS.                                           09020199
090202                                                                  09020299
090203     MOVE +1                       TO ASC-BLK-SUB.                09020399
090204                                                                  09020499
090205     PERFORM 2151-SET-SELECTED-INDS                               09020599
090206         VARYING ASC-ITEM-SUB                                     09020699
090207         FROM 1 BY 1                                              09020799
090208         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 09020899
090209                                                                  09020999
090210     ADD +1                        TO ASC-BLK-SUB.                09021099
090220                                                                  09022099
090230     PERFORM 2151-SET-SELECTED-INDS                               09023099
090240         VARYING ASC-ITEM-SUB                                     09024099
090250         FROM 1 BY 1                                              09025099
090260         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 09026099
090270                                                                  09027099
090280     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               09028099
090290                                   TO PV-LIST-ITEM-NUMBER.        09029099
090300                                                                  09030099
090310     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            09031099
090320         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    09032099
090330                                                                  09033099
090340* 2/03/09 - BEGIN                                                 09034099
090350     IF  PV-FIRST-BLOCK-IN-ARRAY  = +1                            09035099
090360         MOVE +1                   TO ASC-BLK-SUB                 09036099
090361                                                                  09036199
090362         PERFORM 5100-WRITE-TEMP-STORAGE                          09036299
090363         MOVE +2                   TO ASC-BLK-SUB                 09036399
090364         PERFORM 5100-WRITE-TEMP-STORAGE                          09036499
090365         MOVE +1                   TO ASC-BLK-SUB                 09036599
090366         MOVE +1                   TO PV-BLOCK-NUMBER             09036699
090367     END-IF.                                                      09036799
090368* 2/03/09 - END                                                   09036899
090369                                                                  09036999
090370     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     09037099
090371        (ASC-HIGHEST-BLOCK-WRITTEN >   PC-MAX-BLOCKS-IN-ARRAY)    09037199
090372         MOVE +1                   TO ASC-BLK-SUB                 09037299
090373                                                                  09037399
090374         PERFORM 5100-WRITE-TEMP-STORAGE                          09037499
090375                                                                  09037599
090376         MOVE +1                   TO PV-BLOCK-NUMBER             09037699
090377                                                                  09037799
090378         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         09037899
090379             PV-FIRST-BLOCK-IN-ARRAY - 1                          09037999
090380                                                                  09038099
090381         PERFORM                                                  09038199
090382             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       09038299
090383                                                                  09038399
090384             PERFORM 4410-READ-TEMP-STORAGE                       09038499
090385                                                                  09038599
090386             PERFORM 2151-SET-SELECTED-INDS                       09038699
090387                 VARYING ASC-ITEM-SUB                             09038799
090388                 FROM 1 BY 1                                      09038899
090389                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          09038999
090390                                                                  09039099
090391             PERFORM 5100-WRITE-TEMP-STORAGE                      09039199
090392                                                                  09039299
090393             ADD +1                TO PV-BLOCK-NUMBER             09039399
090394                                                                  09039499
090395         END-PERFORM                                              09039599
090396                                                                  09039699
090397         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         09039799
090398             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     09039899
090399                                                                  09039999
090400         PERFORM                                                  09040099
090401             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       09040199
090402                   ASC-HIGHEST-BLOCK-WRITTEN                      09040299
090403                                                                  09040399
090404             MOVE PV-NEXT-BLOCK-IN-ARRAY                          09040499
090405                                   TO PV-BLOCK-NUMBER             09040599
090406                                                                  09040699
090407             PERFORM 4410-READ-TEMP-STORAGE                       09040799
090408                                                                  09040899
090409             PERFORM 2151-SET-SELECTED-INDS                       09040999
090410                 VARYING ASC-ITEM-SUB                             09041099
090411                 FROM 1 BY 1                                      09041199
090412                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          09041299
090413                                                                  09041399
090414             PERFORM 5100-WRITE-TEMP-STORAGE                      09041499
090415                                                                  09041599
090416             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      09041699
090417                                                                  09041799
090418         END-PERFORM                                              09041899
090419                                                                  09041999
090420         MOVE PV-FIRST-BLOCK-IN-ARRAY                             09042099
090421                                   TO PV-BLOCK-NUMBER             09042199
090422                                                                  09042299
090423         PERFORM 4410-READ-TEMP-STORAGE                           09042399
090424     END-IF.                                                      09042499
090425                                                                  09042599
090426                                                                  09042699
090427     MOVE ASC-NUMBER-OF-ITEMS-READ TO                             09042799
090428                       ASC-NUMBER-OF-SELECTED-ITEMS.              09042899
090429                                                                  09042999
090430     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        09043099
090431                                                                  09043199
090434 EJECT                                                            09043499
099100                                                                  09910099
099200*----------------------------------------------------------------*09920099
099300*    MARK EACH ITEM AS BEING SELECTED.                           *09930099
099400*----------------------------------------------------------------*09940099
099410 2151-SET-SELECTED-INDS.                                          09941099
099420                                                                  09942099
099430     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           09943099
099440             NOT EQUAL ZERO                                       09944099
099450         IF  NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             09945099
099460             SET ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             09946099
099470                 ASC-TEMP-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)        09947099
099480                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  09948099
099490                               TO  TRUE                           09949099
099491         END-IF                                                   09949199
099492     END-IF.                                                      09949299
099493                                                                  09949399
099500*2151-SET-SELECTED-INDS.                                          09950099
099510                                                                  09951099
099600*GB  MOVE  ASC-LIST-ITEM-NUMBER  (ASC-BLK-SUB ASC-ITEM-SUB)       09960099
099601*GB    TO  DK-LIST-ITEM-NUMBER.                                   09960199
099602*GB  IF  DK-LIST-ITEM-NUMBER-X NOT NUMERIC                        09960299
099611*GB      MOVE +0                  TO DK-LIST-ITEM-NUMBER          09961199
099612*GB      MOVE DK-LIST-ITEM-NUMBER TO                              09961299
099613*GB               ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)  09961399
099614*GB  ELSE                                                         09961499
099620*    IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           09962099
099700*            NOT EQUAL ZERO                                       09970099
099800*GB      IF  NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             09980099
099900*GB          SET ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             09990099
100000*GB              ASC-TEMP-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)        10000099
100100*GB              ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  10010099
100200*GB                            TO  TRUE                           10020099
100300*GB      END-IF                                                   10030099
100400*GB  END-IF.                                                      10040099
100500                                                                  10050099
100600******************************************************************10060099
100700** MOVE ALL OF THE FIELDS THAT WERE ENTERED / CHANGED ON THE    **10070099
100800** SCREEN INTO THE COMMAREA.  ALL EDITTING IS DONE IN THE COMM. **10080099
100900******************************************************************10090099
101000 2200-MOVE-SCREEN-TO-COMMAREA.                                    10100099
101100                                                                  10110099
101200     MOVE PV-TOP-ITEM              TO PV-ITEM-IN-USE.             10120099
101300     MOVE +1                       TO PV-SUB.                     10130099
101400*                                                                 10140099
101500     PERFORM 3100-SET-SUBSCRIPTS.                                 10150099
101600                                                                  10160099
101700     IF  ASTRTITL > ZERO                                          10170099
101800         MOVE ASTRTITI         TO ASC-START-ITEM-REQUEST          10180099
101900     ELSE                                                         10190099
102000         IF  ASTRTITF = DP015-ERASE-EOF                           10200099
102100             INITIALIZE ASC-START-ITEM-REQUEST                    10210099
102200         END-IF                                                   10220099
102300     END-IF.                                                      10230099
102400                                                                  10240099
102500     PERFORM 2210-MOVE-LINES-TO-COMMAREA                          10250099
102600         VARYING PV-SUB FROM 1 BY 1                               10260099
102700         UNTIL PV-SUB > ASC-ITEMS-DISPLAYED.                      10270099
102800                                                                  10280099
102900******************************************************************10290099
103000** MOVE THE ENTERABLE FIELDS OF EACH LIST LINE INTO THE COMMAREA**10300099
103100******************************************************************10310099
103200 2210-MOVE-LINES-TO-COMMAREA.                                     10320099
105100******************************************************************10510099
105120     IF  MR-SELECTL (PV-SUB) > ZERO                               10512099
105130         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE             10513099
105140         MOVE MR-SELECTI (PV-SUB)  TO ASC-TEMP-SELECTED-SW        10514099
105150                                      (ASC-BLK-SUB, ASC-ITEM-SUB) 10515099
105160     ELSE                                                         10516099
105170         IF  MR-SELECTA (PV-SUB) = DP015-ERASE-EOF                10517099
105180                 SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE     10518099
105190                 MOVE SPACE  TO ASC-TEMP-SELECTED-SW              10519099
105191                                      (ASC-BLK-SUB, ASC-ITEM-SUB) 10519199
105192         END-IF                                                   10519299
105193     END-IF.                                                      10519399
105194                                                                  10519499
105195     ADD +1                        TO ASC-ITEM-SUB.               10519599
105196     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        10519699
105197         IF  ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                     10519799
105198             COMPUTE PV-BLOCK-NUMBER  =                           10519899
105199                1 + ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) /         10519999
105200                    PC-ITEMS-PER-PANEL                            10520099
105201             PERFORM 5105-REWRITE-ASC-LISTQ                       10520199
105202         END-IF                                                   10520299
105203         ADD +1                    TO ASC-BLK-SUB                 10520399
105204         MOVE +1                   TO ASC-ITEM-SUB                10520499
105205     ELSE                                                         10520599
105206**GB 2/03/09 IR18399 BEG                                          10520699
105207     IF  PV-SUB = ASC-ITEMS-DISPLAYED                             10520799
105208         IF  ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                     10520899
105209             COMPUTE PV-BLOCK-NUMBER  =                           10520999
105210                1 + ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) /         10521099
105211                    PC-ITEMS-PER-PANEL                            10521199
105212             PERFORM 5105-REWRITE-ASC-LISTQ                       10521299
105213         END-IF                                                   10521399
105214**GB 2/03/09 IR18399 END                                          10521499
105215     END-IF.                                                      10521599
105216******************************************************************10521699
105220** EDIT ALL OF THE DATA ON THE SCREEN AS IT RESIDES IN THE      **10522099
105300** COMMAREA (EDITTING IS NOT DONE AGAINST THE SCREEN DIRECTLY). **10530099
105400******************************************************************10540099
105500 3000-EDIT-DATA-IN-COMMAREA.                                      10550099
105600     PERFORM 3200-RESET-ATTRIBUTES.                               10560099
105700     SET PS-NO-ERROR               TO TRUE.                       10570099
105800     MOVE ASC-ITEMS-DISPLAYED      TO PV-SUB.                     10580099
105900                                                                  10590099
106000* CALCULATE THE POSITION OF THE LAST ITEM DISPLAYED.              10600099
106100* EDITTING IS DONE FROM THE BOTTOM UP.                            10610099
106200**                                                                10620099
106300     COMPUTE PV-ITEM-IN-USE = PV-TOP-ITEM +                       10630099
106400         ASC-ITEMS-DISPLAYED - 1.                                 10640099
106500     PERFORM 3100-SET-SUBSCRIPTS.                                 10650099
106600                                                                  10660099
106700      IF  PS-NO-ERROR                                             10670099
106800          PERFORM 3005-EDIT-COMMAREA-BLOCKS                       10680099
106900      END-IF.                                                     10690099
107000                                                                  10700099
107100     IF  PS-NO-ERROR                                              10710099
107200         PERFORM 3400-CHECK-RANGE-SEQUENCE                        10720099
107300     END-IF.                                                      10730099
107400                                                                  10740099
107500     IF  ((PS-NO-ERROR)                                           10750099
107600       AND (ASC-START-OF-SELECTED-RANGE > ZERO)                   10760099
107700       AND (ASC-END-OF-SELECTED-RANGE > ZERO))                    10770099
107800             PERFORM 3500-MARK-RANGE-AS-SELECTED                  10780099
107900     END-IF.                                                      10790099
108000                                                                  10800099
108100*----------------------------------------------------------------*10810099
108200* 3005-EDIT-COMMAREA-BLOCKS                                      *10820099
108300*----------------------------------------------------------------*10830099
108400 3005-EDIT-COMMAREA-BLOCKS.                                       10840099
108500     MOVE +1                       TO PV-BLOCK-NUMBER.            10850099
108600     MOVE +1                       TO ASC-BLK-SUB.                10860099
108700     MOVE PC-ITEMS-PER-PANEL       TO ASC-ITEM-SUB.               10870099
108800                                                                  10880099
108900     COMPUTE PV-BLOCK-NUMBER  =                                   10890099
109000             1 + ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) /            10900099
109100             PC-ITEMS-PER-PANEL.                                  10910099
109200                                                                  10920099
109300     MOVE  PV-BLOCK-NUMBER         TO PV-ORIGINAL-BLOCK.          10930099
109400                                                                  10940099
109500     PERFORM                                                      10950099
109600        UNTIL PV-BLOCK-NUMBER > ASC-HIGHEST-BLOCK-WRITTEN         10960099
109700           OR PS-ERROR                                            10970099
109800           OR PS-BLOCK-ERROR                                      10980099
109900                                                                  10990099
110000              COMPUTE PV-ITEMS-HOLD  =                            11000099
110100                      ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) +       11010099
110200                      PC-ITEMS-PER-PANEL - 1                      11020099
110300                                                                  11030099
110400               IF  PV-ITEMS-HOLD  >  ASC-NUMBER-OF-ITEMS-READ     11040099
110500                   SUBTRACT  ASC-NUMBER-OF-ITEMS-READ             11050099
110600                       FROM  PV-ITEMS-HOLD                        11060099
110700                     GIVING  PV-ITEMS-DIFF                        11070099
110800                   SUBTRACT  PV-ITEMS-DIFF                        11080099
110900                       FROM  PC-ITEMS-PER-PANEL                   11090099
111000                     GIVING  PV-ITEMS-HOLD                        11100099
111100                       MOVE  PV-ITEMS-HOLD TO PV-SUB              11110099
111200                                              ASC-ITEM-SUB        11120099
111300                                              ASC-ITEMS-DISPLAYED 11130099
111400               ELSE                                               11140099
111500                   MOVE ASC-ITEMS-DISPLAYED  TO PV-SUB            11150099
111600                   MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB      11160099
111700               END-IF                                             11170099
111800                                                                  11180099
111900               PERFORM 3300-EDIT-SELECTIONS                       11190099
112000                       VARYING PV-SUB                             11200099
112100                          FROM PV-SUB BY -1                       11210099
112200                          UNTIL PV-SUB < +1                       11220099
112300                                                                  11230099
112400               MOVE +1               TO ASC-BLK-SUB               11240099
112500                                                                  11250099
112600               PERFORM 5105-REWRITE-ASC-LISTQ                     11260099
112700                                                                  11270099
112800               MOVE +1                TO ASC-BLK-SUB              11280099
112900                                                                  11290099
113000               IF  PS-BLOCK-ERROR                                 11300099
113100                   SET  PS-ERROR     TO TRUE                      11310099
113200                   MOVE ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB 1)      11320099
113300                                     TO PV-TOP-ITEM               11330099
113400               ELSE                                               11340099
113500                   ADD  +1           TO PV-BLOCK-NUMBER           11350099
113600                   IF  PV-BLOCK-NUMBER >                          11360099
113700                       ASC-HIGHEST-BLOCK-WRITTEN                  11370099
113800                       MOVE +2       TO ASC-BLK-SUB               11380099
113900                       PERFORM 4410-READ-TEMP-STORAGE             11390099
114000                       MOVE +1       TO ASC-BLK-SUB               11400099
114100                   ELSE                                           11410099
114200                       PERFORM 4410-READ-TEMP-STORAGE             11420099
114300                       ADD  +1        TO PV-BLOCK-NUMBER          11430099
114400                       MOVE +2        TO ASC-BLK-SUB              11440099
114500                       PERFORM 4410-READ-TEMP-STORAGE             11450099
114600                       SUBTRACT +1  FROM PV-BLOCK-NUMBER          11460099
114700                       MOVE +1        TO ASC-BLK-SUB              11470099
114800               END-IF                                             11480099
114900           END-IF                                                 11490099
115000     END-PERFORM.                                                 11500099
115100                                                                  11510099
115200     IF  (PV-ORIGINAL-BLOCK  = +1   AND                           11520099
115300          ASC-LIST-ITEM-NUMBER (1 1) = 1)  OR                     11530099
115400         PS-ERROR                   OR                            11540099
115500         PS-BLOCK-ERROR                                           11550099
115600             CONTINUE                                             11560099
115700     ELSE                                                         11570099
115800         MOVE +1                 TO PV-BLOCK-NUMBER               11580099
115900         MOVE +1                 TO ASC-BLK-SUB                   11590099
116000         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  11600099
116100         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEMS-DISPLAYED           11610099
116200         PERFORM 4410-READ-TEMP-STORAGE                           11620099
116300                                                                  11630099
116400         PERFORM                                                  11640099
116500            UNTIL PV-BLOCK-NUMBER = PV-ORIGINAL-BLOCK             11650099
116600               OR PS-ERROR                                        11660099
116700               OR PS-BLOCK-ERROR                                  11670099
116800                                                                  11680099
116900                  COMPUTE PV-ITEMS-HOLD  =                        11690099
117000                          ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) +   11700099
117100                          PC-ITEMS-PER-PANEL - 1                  11710099
117200                                                                  11720099
117300                  IF  PV-ITEMS-HOLD > ASC-NUMBER-OF-ITEMS-READ    11730099
117400                      SUBTRACT  ASC-NUMBER-OF-ITEMS-READ          11740099
117500                          FROM  PV-ITEMS-HOLD                     11750099
117600                        GIVING  PV-ITEMS-DIFF                     11760099
117700                      SUBTRACT  PV-ITEMS-DIFF                     11770099
117800                          FROM  PC-ITEMS-PER-PANEL                11780099
117900                        GIVING  PV-ITEMS-HOLD                     11790099
118000                          MOVE  PV-ITEMS-HOLD TO PV-SUB           11800099
118100                                                 ASC-ITEM-SUB     11810099
118200                                              ASC-ITEMS-DISPLAYED 11820099
118300                  ELSE                                            11830099
118400                      MOVE ASC-ITEMS-DISPLAYED  TO PV-SUB         11840099
118500                      MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB   11850099
118600                  END-IF                                          11860099
118700                                                                  11870099
118800                  PERFORM 3300-EDIT-SELECTIONS                    11880099
118900                          VARYING PV-SUB                          11890099
119000                             FROM PV-SUB BY -1                    11900099
119100                            UNTIL PV-SUB < +1                     11910099
119200                                                                  11920099
119300                  MOVE +1               TO ASC-BLK-SUB            11930099
119400                                                                  11940099
119500                  PERFORM 5105-REWRITE-ASC-LISTQ                  11950099
119600                                                                  11960099
119700                  MOVE +1                TO ASC-BLK-SUB           11970099
119800                                                                  11980099
119900                  IF  PS-BLOCK-ERROR                              11990099
120000                      SET  PS-ERROR     TO TRUE                   12000099
120100                      MOVE ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB 1)   12010099
120200                                        TO PV-TOP-ITEM            12020099
120300                  ELSE                                            12030099
120400                      ADD  +1            TO PV-BLOCK-NUMBER       12040099
120500                      IF  PV-BLOCK-NUMBER = PV-ORIGINAL-BLOCK     12050099
120600                          MOVE +2        TO ASC-BLK-SUB           12060099
120700                          PERFORM 4410-READ-TEMP-STORAGE          12070099
120800                          MOVE +1        TO ASC-BLK-SUB           12080099
120900                      ELSE                                        12090099
121000                          PERFORM 4410-READ-TEMP-STORAGE          12100099
121100                          ADD  +1        TO PV-BLOCK-NUMBER       12110099
121200                          MOVE +2        TO ASC-BLK-SUB           12120099
121300                          PERFORM 4410-READ-TEMP-STORAGE          12130099
121400                          SUBTRACT +1  FROM PV-BLOCK-NUMBER       12140099
121500                          MOVE +1        TO ASC-BLK-SUB           12150099
121600                      END-IF                                      12160099
121700                  END-IF                                          12170099
121800     END-PERFORM.                                                 12180099
121900     MOVE +0 TO PV-ITEMS-HOLD.                                    12190099
122000                                                                  12200099
122100*----------------------------------------------------------------*12210099
122200*    DETERMINE THE VALUE OF THE ITEM SUBSCRIPT BASED ON THE ITEM *12220099
122300*    CURRENTLY IN USE AND THE FIRST ITEM IN THE ARRAY.  THIS WILL*12230099
122400*    POSITION US IN THE 1ST BLOCK OF THE ARRAY.                  *12240099
122500*                                                                *12250099
122600*    IF THE ITEM SUBSCRIPT EXCEEDS THE MAXIMUM NUMBER OF ITEMS   *12260099
122700*    IN A BLOCK, RECALCULATE THE SUBSCRIPT BY SUBTRACTING OUT    *12270099
122800*    THE MAXIMUM NUMBER OF ITEMS.  THIS WILL CORRECTLY POSITION  *12280099
122900*    US IN THE 2ND BLOCK OF THE ARRAY.                           *12290099
123000*----------------------------------------------------------------*12300099
123100 3100-SET-SUBSCRIPTS.                                             12310099
123200     COMPUTE ASC-ITEM-SUB =                                       12320099
123300         (PV-ITEM-IN-USE - ASC-LIST-ITEM-NUMBER(1 1)) + 1.        12330099
123400                                                                  12340099
123500     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         12350099
123600         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            12360099
123700         MOVE PC-MAX-BLOCKS-IN-ARRAY TO ASC-BLK-SUB               12370099
123800     ELSE                                                         12380099
123900         MOVE +1                     TO ASC-BLK-SUB               12390099
124000     END-IF.                                                      12400099
124100                                                                  12410099
124200******************************************************************12420099
124300** RESET THE ATTRIBUTES OF ALL ENTERABLE FIELDS ON THE MAP.     **12430099
124400******************************************************************12440099
124500 3200-RESET-ATTRIBUTES.                                           12450099
124600     MOVE DP015-UNP-ALP-NOR-OFF    TO ASTRTITA.                   12460099
124700     MOVE DP015-GREEN              TO ASTRTITC.                   12470099
124800     MOVE DP015-UNDERLINE          TO ASTRTITH.                   12480099
124900                                                                  12490099
125000     PERFORM                                                      12500099
125100         VARYING PV-SUB                                           12510099
125200         FROM 1 BY 1                                              12520099
125300         UNTIL PV-SUB > PC-ITEMS-PER-PANEL                        12530099
125400         MOVE DP015-UNP-ALP-NOR-OFF                               12540099
125500                                   TO MR-SELECTA (PV-SUB)         12550099
125600         MOVE DP015-GREEN          TO MR-SELECTC (PV-SUB)         12560099
125700         MOVE DP015-UNDERLINE      TO MR-SELECTH (PV-SUB)         12570099
125710         MOVE DP015-HL-OFF         TO MR-ACDATH  (PV-SUB)         12571099
125800     END-PERFORM.                                                 12580099
125900                                                                  12590099
126000******************************************************************12600099
126100** EDIT THE SELECTIONS MADE.  NOTE THAT THE 'SELECTED-SW' IS    **12610099
126200** WHAT WAS PREVIOUSLY CHECKED AND CORRECT 'TEMP-SELECTED-SW'   **12620099
126300** IS WHAT HAS JUST BEEN ENTERED AND HAS NOT BEEN EDITTED OR    **12630099
126400** WAS ENTERED EARLIER, BUT DID NOT PASS THE EDITS.             **12640099
126500******************************************************************12650099
126600 3300-EDIT-SELECTIONS.                                            12660099
126700     EVALUATE TRUE                                                12670099
126800         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     12680099
126900             = ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)         12690099
127000                 CONTINUE                                         12700099
127100         WHEN ASC-TEMP-SELECT  (ASC-BLK-SUB ASC-ITEM-SUB)         12710099
127200             IF  NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)        12720099
127300                 ADD +1         TO ASC-NUMBER-OF-SELECTED-ITEMS   12730099
127400                 MOVE ASC-TEMP-SELECTED-SW                        12740099
127500                                      (ASC-BLK-SUB ASC-ITEM-SUB)  12750099
127600                                TO ASC-SELECTED-SW                12760099
127700                                      (ASC-BLK-SUB ASC-ITEM-SUB)  12770099
127800             END-IF                                               12780099
127900         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     12790099
128000                 = SPACE                                          12800099
128100             EVALUATE TRUE                                        12810099
128200                 WHEN ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)       12820099
128300                     SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS12830099
128400                     MOVE SPACE TO ASC-SELECTED-SW                12840099
128500                                      (ASC-BLK-SUB ASC-ITEM-SUB)  12850099
128600                 WHEN ASC-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)        12860099
128700                     MOVE ZERO  TO ASC-START-OF-SELECTED-RANGE    12870099
128800                     MOVE SPACE TO ASC-SELECTED-SW                12880099
128900                                      (ASC-BLK-SUB ASC-ITEM-SUB)  12890099
129000                 WHEN ASC-END (ASC-BLK-SUB ASC-ITEM-SUB)          12900099
129100                     MOVE ZERO  TO ASC-END-OF-SELECTED-RANGE      12910099
129200                     MOVE SPACE TO ASC-SELECTED-SW                12920099
129300                                      (ASC-BLK-SUB ASC-ITEM-SUB)  12930099
129400             END-EVALUATE                                         12940099
129500         WHEN ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)           12950099
129600             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            12960099
129700                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    12970099
129800             END-IF                                               12980099
129900             PERFORM 3310-EDIT-RANGE                              12990099
130000         WHEN ASC-TEMP-END (ASC-BLK-SUB ASC-ITEM-SUB)             13000099
130100             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            13010099
130200                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    13020099
130300             END-IF                                               13030099
130400             PERFORM 3310-EDIT-RANGE                              13040099
130500         WHEN OTHER                                               13050099
130600             MOVE PC-TSYMSG-00005   TO DP020-MSG-NUMBER           13060099
130700             SET DP020-MSG-FATAL    TO TRUE                       13070099
130800             MOVE -1                TO ASTRTITL                   13080099
130900             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  13090099
131000*            MOVE DP015-RED         TO MR-SELECTC (PV-SUB)        13100099
131100*            MOVE DP015-REVERSE     TO MR-SELECTH (PV-SUB)        13110099
131200             SET PS-ERROR TO TRUE                                 13120099
131300             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            13130099
131400                 SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS     13140099
131500                 MOVE SPACE         TO ASC-SELECTED-SW            13150099
131600                                        (ASC-BLK-SUB ASC-ITEM-SUB)13160099
131700             END-IF                                               13170099
131800     END-EVALUATE.                                                13180099
131900                                                                  13190099
132000     SUBTRACT +1             FROM PV-ITEM-IN-USE.                 13200099
132100     SUBTRACT +1 FROM ASC-ITEM-SUB.                               13210099
132200     IF  ASC-ITEM-SUB < 1                                         13220099
132300         SUBTRACT +1 FROM ASC-BLK-SUB                             13230099
132400         MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB                13240099
132500     END-IF.                                                      13250099
132600                                                                  13260099
132700******************************************************************13270099
132800** IF A BEGINNING AND END OF RANGE WAS ENTERED TO SELECT A      **13280099
132900** RANGE OF LINES, MAKE SURE THERE IS ONLY 1 BEGINNING AND 1    **13290099
133000** ENDING AND MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN)**13300099
133100** THE ENDING.                                                  **13310099
133200******************************************************************13320099
133300 3310-EDIT-RANGE.                                                 13330099
133400     IF  ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)                13340099
133500         IF  ASC-START-OF-SELECTED-RANGE = ZERO                   13350099
133600             MOVE ASC-TEMP-SELECTED-SW  (ASC-BLK-SUB ASC-ITEM-SUB)13360099
133700                                   TO ASC-SELECTED-SW             13370099
133800                                        (ASC-BLK-SUB ASC-ITEM-SUB)13380099
133900             MOVE PV-ITEM-IN-USE   TO ASC-START-OF-SELECTED-RANGE 13390099
134000         ELSE                                                     13400099
134100             IF  ASC-START-OF-SELECTED-RANGE = PV-ITEM-IN-USE     13410099
134200                 CONTINUE                                         13420099
134300             ELSE                                                 13430099
134400*                -- ONLY ONE BEGINNING-OF-RANGE-ALLOWED --        13440099
134500                 MOVE PC-TSYMSG-00054                             13450099
134600                                   TO DP020-MSG-NUMBER            13460099
134700                 SET DP020-MSG-FATAL                              13470099
134800                                   TO TRUE                        13480099
134900                 MOVE -1           TO ASTRTITL                    13490099
135000                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              13500099
135100                 MOVE DP015-RED    TO MR-SELECTC (PV-SUB)         13510099
135200                 MOVE DP015-UNDERLINE TO MR-SELECTH (PV-SUB)      13520099
135300                 SET PS-ERROR      TO TRUE                        13530099
135400             END-IF                                               13540099
135500         END-IF                                                   13550099
135600     ELSE                                                         13560099
135700         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     13570099
135800             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 13580099
135900                                   TO ASC-SELECTED-SW             13590099
136000                                     (ASC-BLK-SUB ASC-ITEM-SUB)   13600099
136100             MOVE PV-ITEM-IN-USE   TO ASC-END-OF-SELECTED-RANGE   13610099
136200         ELSE                                                     13620099
136300             IF  ASC-END-OF-SELECTED-RANGE = PV-ITEM-IN-USE       13630099
136400                 CONTINUE                                         13640099
136500             ELSE                                                 13650099
136600*                -- ONLY ONE END-OF-RANGE ALLOWED --              13660099
136700                 MOVE PC-TSYMSG-00055                             13670099
136800                                   TO DP020-MSG-NUMBER            13680099
136900                 SET DP020-MSG-FATAL                              13690099
137000                                   TO TRUE                        13700099
137100                 MOVE -1           TO ASTRTITL                    13710099
137200                 SET DP030-SET-CURSOR-APPL-1                      13720099
137300                                   TO TRUE                        13730099
137400                 SET PS-ERROR      TO TRUE                        13740099
137500             END-IF                                               13750099
137600         END-IF                                                   13760099
137700     END-IF.                                                      13770099
137800*                                                                 13780099
137900******************************************************************13790099
138000** IF BOTH A BEGINNING AND END OF RANGE HAVE BEEN SPECIFIED,    **13800099
138100** MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN) THE END.  **13810099
138200******************************************************************13820099
138300 3400-CHECK-RANGE-SEQUENCE.                                       13830099
138400     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       13840099
138500       AND  ASC-END-OF-SELECTED-RANGE > ZERO                      13850099
138600       AND  ASC-START-OF-SELECTED-RANGE >                         13860099
138700                                         ASC-END-OF-SELECTED-RANGE13870099
138800*        -- END-OF-RANGE BEFORE BEGINNING-OF-RANGE                13880099
138900         MOVE PC-TSYMSG-00052 TO DP020-MSG-NUMBER                 13890099
139000         SET DP020-MSG-FATAL TO TRUE                              13900099
139100         SET PS-ERROR TO TRUE                                     13910099
139200         PERFORM 3410-POSITION-AT-ERROR                           13920099
139300     END-IF.                                                      13930099
139400                                                                  13940099
139500******************************************************************13950099
139600** BECAUSE RANGES CAN SPAN ACROSS MULTIPLE PAGES, A SEPARATE    **13960099
139700** PARAGRAPH (THIS ONE) IS NEEDED TO DETERMINE WHERE THE CURSOR **13970099
139800** SHOULD BE POSITIONED ON A RANGE ERROR.                       **13980099
139900******************************************************************13990099
140000 3410-POSITION-AT-ERROR.                                          14000099
140100     SET DP030-SET-CURSOR-APPL-1   TO TRUE.                       14010099
140200     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 14020099
140300                    - PV-TOP-ITEM + 1.                            14030099
140400     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      14040099
140500         CONTINUE                                                 14050099
140600     ELSE                                                         14060099
140700         MOVE -1                   TO MR-SELECTL (PV-SUB)         14070099
140800         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         14080099
140900         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         14090099
141000     END-IF.                                                      14100099
141100                                                                  14110099
141200     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   14120099
141300                    - PV-TOP-ITEM + 1.                            14130099
141400     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      14140099
141500         CONTINUE                                                 14150099
141600     ELSE                                                         14160099
141700         MOVE -1                   TO MR-SELECTL (PV-SUB)         14170099
141800         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         14180099
141900         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         14190099
142000     END-IF.                                                      14200099
142100                                                                  14210099
142200*----------------------------------------------------------------*14220099
142300*    WHENEVER THE USER SELECTS AN ITEM AS THE BEGINNING RANGE    *14230099
142400*    AND ONE AS THE ENDING RANGE, MARK THESE ITEMS AS WELL AS    *14240099
142500*    THOSE THAT FALL IN THE RANGE AS BEING SELECTED.             *14250099
142600*----------------------------------------------------------------*14260099
142700 3500-MARK-RANGE-AS-SELECTED.                                     14270099
142800     MOVE +1                       TO  ASC-BLK-SUB.               14280099
142900     PERFORM 3510-MARK-SELECTED-INDS                              14290099
143000         VARYING ASC-ITEM-SUB                                     14300099
143100         FROM 1 BY 1                                              14310099
143200         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 14320099
143300                                                                  14330099
143400     ADD +1                        TO ASC-BLK-SUB.                14340099
143500     PERFORM 3510-MARK-SELECTED-INDS                              14350099
143600         VARYING ASC-ITEM-SUB                                     14360099
143700         FROM 1 BY 1                                              14370099
143800         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 14380099
143900                                                                  14390099
144000     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               14400099
144100                                   TO  PV-LIST-ITEM-NUMBER.       14410099
144200     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            14420099
144300         1 + ((PV-LIST-ITEM-NUMBER - 1) /                         14430099
144400               PC-ITEMS-PER-PANEL).                               14440099
144500                                                                  14450099
144600     MOVE ASC-START-OF-SELECTED-RANGE                             14460099
144700                                   TO PV-START-OF-SELECTED-RANGE. 14470099
144800     COMPUTE PV-FIRST-BLOCK-IN-RANGE =                            14480099
144900         1 + ((PV-START-OF-SELECTED-RANGE - 1) /                  14490099
145000               PC-ITEMS-PER-PANEL).                               14500099
145100                                                                  14510099
145200     MOVE ASC-END-OF-SELECTED-RANGE                               14520099
145300                                   TO  PV-END-OF-SELECTED-RANGE.  14530099
145400     COMPUTE PV-LAST-BLOCK-IN-RANGE =                             14540099
145500         1 + ((PV-END-OF-SELECTED-RANGE - 1) /                    14550099
145600               PC-ITEMS-PER-PANEL).                               14560099
145700     COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                             14570099
145800         PV-FIRST-BLOCK-IN-ARRAY + 1.                             14580099
145900                                                                  14590099
146000     IF (PV-FIRST-BLOCK-IN-RANGE < PV-FIRST-BLOCK-IN-ARRAY) OR    14600099
146100        (PV-LAST-BLOCK-IN-RANGE  > PV-NEXT-BLOCK-IN-ARRAY)        14610099
146200         MOVE +1                   TO ASC-BLK-SUB                 14620099
146300         PERFORM 5100-WRITE-TEMP-STORAGE                          14630099
146400         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         14640099
146500             PV-FIRST-BLOCK-IN-ARRAY - 1                          14650099
146600                                                                  14660099
146700         PERFORM                                                  14670099
146800             UNTIL PV-FIRST-BLOCK-IN-RANGE >                      14680099
146900                   PV-PREV-BLOCK-IN-ARRAY                         14690099
147000             MOVE PV-FIRST-BLOCK-IN-RANGE                         14700099
147100                                   TO PV-BLOCK-NUMBER             14710099
147200             PERFORM 4410-READ-TEMP-STORAGE                       14720099
147300             PERFORM 3510-MARK-SELECTED-INDS                      14730099
147400                 VARYING ASC-ITEM-SUB                             14740099
147500                 FROM 1 BY 1                                      14750099
147600                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          14760099
147700             PERFORM 5100-WRITE-TEMP-STORAGE                      14770099
147800             ADD +1                TO PV-FIRST-BLOCK-IN-RANGE     14780099
147900         END-PERFORM                                              14790099
148000                                                                  14800099
148100         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         14810099
148200             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     14820099
148300         PERFORM                                                  14830099
148400             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       14840099
148500                   PV-LAST-BLOCK-IN-RANGE                         14850099
148600             MOVE PV-NEXT-BLOCK-IN-ARRAY                          14860099
148700                                   TO PV-BLOCK-NUMBER             14870099
148800             PERFORM 4410-READ-TEMP-STORAGE                       14880099
148900             PERFORM 3510-MARK-SELECTED-INDS                      14890099
149000                 VARYING ASC-ITEM-SUB                             14900099
149100                 FROM 1 BY 1                                      14910099
149200                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          14920099
149300             PERFORM 5100-WRITE-TEMP-STORAGE                      14930099
149400             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      14940099
149500         END-PERFORM                                              14950099
149600                                                                  14960099
149700         MOVE PV-FIRST-BLOCK-IN-ARRAY                             14970099
149800                                   TO PV-BLOCK-NUMBER             14980099
149900         PERFORM 4410-READ-TEMP-STORAGE                           14990099
150000     END-IF.                                                      15000099
150100                                                                  15010099
150200     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE 15020099
150300                                      ASC-END-OF-SELECTED-RANGE.  15030099
150400                                                                  15040099
150500*----------------------------------------------------------------*15050099
150600* SET THE SELECTION INDICATOR TO 'S' WITHIN THE RANGE.           *15060099
150700*----------------------------------------------------------------*15070099
150800 3510-MARK-SELECTED-INDS.                                         15080099
150900     IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         15090099
151000                                ASC-ITEM-SUB) >                   15100099
151100         ASC-START-OF-SELECTED-RANGE)                             15110099
151200     OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         15120099
151300                                ASC-ITEM-SUB) =                   15130099
151400         ASC-START-OF-SELECTED-RANGE)                             15140099
151500                                                                  15150099
151600         IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     15160099
151700                                    ASC-ITEM-SUB) <               15170099
151800             ASC-END-OF-SELECTED-RANGE)                           15180099
151900         OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     15190099
152000                                    ASC-ITEM-SUB) =               15200099
152100             ASC-END-OF-SELECTED-RANGE)                           15210099
152200                                                                  15220099
152300             IF NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          15230099
152400                 SET ASC-SELECT     (ASC-BLK-SUB  ASC-ITEM-SUB)   15240099
152500                     ASC-TEMP-SELECT(ASC-BLK-SUB  ASC-ITEM-SUB)   15250099
152600                               TO TRUE                            15260099
152700                 SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB)              15270099
152800                               TO TRUE                            15280099
152900                 ADD +1        TO ASC-NUMBER-OF-SELECTED-ITEMS    15290099
153000             END-IF                                               15300099
153100         END-IF                                                   15310099
153200     END-IF.                                                      15320099
153300                                                                  15330099
153400*----------------------------------------------------------------*15340099
153500*    INITIALIZE BOTH BLOCKS IN THE ARRAY.                        *15350099
153600*    INITIALIZE ALL COUNTERS AND FLAGS.                          *15360099
153700*    READ THE DATA BASE FOR THE 1ST TIME AND FILL UP THE ARRAY.  *15370099
153800*    DISPLAY THE PANEL TO USER.                                  *15380099
153900*----------------------------------------------------------------*15390099
154000 4000-BUILD-INITIAL-PANEL.                                        15400099
154100     INITIALIZE                  ASC-BLOCK-ENTRIES (1)            15410099
154200                                 ASC-BLOCK-ENTRIES (2).           15420099
154300     MOVE +1                   TO ASC-BLK-SUB.                    15430099
154400     SET ASC-ITEMS-LEFT-ON-DB  TO TRUE.                           15440099
154500                                                                  15450099
154600     MOVE +0                 TO ASC-ITEM-SUB                      15460099
154700                                ASC-NUMBER-OF-ITEMS-READ          15470099
154800                                ASC-NUMBER-OF-SELECTED-ITEMS      15480099
154900                                ASC-HIGHEST-BLOCK-WRITTEN         15490099
155000                                ASC-START-OF-SELECTED-RANGE       15500099
155100                                ASC-END-OF-SELECTED-RANGE         15510099
155200                                ASC-ITEM-AT-TOP-OF-PANEL.         15520099
155300                                                                  15530099
155400                                                                  15540099
155500     PERFORM 4100-PREPARE-CURSOR                                  15550099
155600     PERFORM 4010-OPEN-CURSOR                                     15560099
155700     PERFORM 4300-READ-ITEMS-FROM-DB                              15570099
155800     PERFORM 4020-CLOSE-CURSOR                                    15580099
155900                                                                  15590099
156000     MOVE +1                   TO  PV-TOP-ITEM.                   15600099
156100     IF  ASC-NUMBER-OF-ITEMS-READ = ZERO                          15610099
156200         MOVE PC-TSYMSG-00050  TO  DP020-MSG-NUMBER               15620099
156300         SET DP020-MSG-WARNING TO TRUE                            15630099
156400         SET PS-ERROR          TO TRUE                            15640099
156410         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                     15641099
156500     ELSE                                                         15650099
156600         MOVE -1               TO MR-SELECTL (1)                  15660099
156700         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      15670099
156800         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                     15680099
156900     END-IF.                                                      15690099
157000                                                                  15700099
157100*----------------------------------------------------------------*15710099
157200* OPEN THE CURSOR.                                               *15720099
157300*   IN THIS PARTICULAR APPLICATION ONE OF 18 DIFFERENT CURSORS   *15730099
157400*   WILL BE OPENED DEPENDING ON THE CRITERIA PASSED FROM SUKCS775*15740099
157500*----------------------------------------------------------------*15750099
157600 4010-OPEN-CURSOR.                                                15760099
157700     PERFORM                                                      15770099
157800         WITH TEST AFTER                                          15780099
157900         VARYING PV-RETRY-COUNTER                                 15790099
158000         FROM 1 BY 1                                              15800099
158100         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               15810099
158200                   OR (SQLCODE = ZERO))                           15820099
158300                                                                  15830099
158400         EVALUATE TRUE                                            15840099
158500             WHEN ASC-OPER-UNIT-PO-C1                             15850099
158600                  MOVE 'ASC-OPER-UNIT-PO-C1          '            15860099
158700                                        TO DP013-MESSAGE-TEXT (2) 15870099
158800                  EXEC SQL                                        15880099
158900                      OPEN ASC-OPER-UNIT-PO-C1                    15890099
159000                  END-EXEC                                        15900099
159100                                                                  15910099
159200             WHEN ASC-OPER-UNIT-PO-C2                             15920099
159300                 MOVE 'ASC-OPER-UNIT-PO-C2           '            15930099
159400                                        TO DP013-MESSAGE-TEXT (2) 15940099
159500                   EXEC SQL                                       15950099
159600                      OPEN ASC-OPER-UNIT-PO-C2                    15960099
159700                   END-EXEC                                       15970099
159800                                                                  15980099
159900             WHEN ASC-OPER-UNIT-PO-R-C1                           15990099
160000                 MOVE 'ASC-OPER-UNIT-PO-R-C1      '               16000099
160100                                        TO DP013-MESSAGE-TEXT (2) 16010099
160200                   EXEC SQL                                       16020099
160300                      OPEN ASC-OPER-UNIT-PO-R-C1                  16030099
160400                   END-EXEC                                       16040099
160500                                                                  16050099
160600             WHEN ASC-OPER-UNIT-PO-R-C2                           16060099
160700                 MOVE 'ASC-OPER-UNIT-PO-R-C2  '                   16070099
160800                                        TO DP013-MESSAGE-TEXT (2) 16080099
160900                   EXEC SQL                                       16090099
161000                      OPEN ASC-OPER-UNIT-PO-R-C2                  16100099
161100                   END-EXEC                                       16110099
161200                                                                  16120099
161300             WHEN ASC-OPER-UNIT-PO-R-LINE-C1                      16130099
161400                 MOVE 'ASC-OPER-UNIT-PO-R-LINE-C1 '               16140099
161500                                        TO DP013-MESSAGE-TEXT (2) 16150099
161600                   EXEC SQL                                       16160099
161700                      OPEN ASC-OPER-UNIT-PO-R-LINE-C1             16170099
161800                   END-EXEC                                       16180099
161900                                                                  16190099
162000             WHEN ASC-OPER-UNIT-PO-R-LINE-C2                      16200099
162010                 MOVE 'ASC-OPER-UNIT-PO-R-LINE-C2 '               16201099
162011                                        TO DP013-MESSAGE-TEXT (2) 16201199
162012                   EXEC SQL                                       16201299
162013                      OPEN ASC-OPER-UNIT-PO-R-LINE-C2             16201399
162014                   END-EXEC                                       16201499
162015                                                                  16201599
162016             WHEN ASC-OPER-UNIT-PO-R-PACK-C1                      16201699
162017                 MOVE 'ASC-OPER-UNIT-PO-R-PACK-C1 '               16201799
162018                                        TO DP013-MESSAGE-TEXT (2) 16201899
162019                   EXEC SQL                                       16201999
162020                      OPEN ASC-OPER-UNIT-PO-R-PACK-C1             16202099
162021                   END-EXEC                                       16202199
162022                                                                  16202299
162023             WHEN ASC-OPER-UNIT-PO-R-PACK-C2                      16202399
162024                 MOVE 'ASC-OPER-UNIT-PO-R-PACK-C2 '               16202499
162025                                        TO DP013-MESSAGE-TEXT (2) 16202599
162026                   EXEC SQL                                       16202699
162027                      OPEN ASC-OPER-UNIT-PO-R-PACK-C2             16202799
162028                   END-EXEC                                       16202899
162029                                                                  16202999
162030             WHEN ASC-AUDIT-CONTROL-NO-C1                         16203099
162031                 MOVE 'ASC-AUDIT-CONTROL-NO-C1       '            16203199
162032                                        TO DP013-MESSAGE-TEXT (2) 16203299
162033                   EXEC SQL                                       16203399
162034                      OPEN ASC-AUDIT-CONTROL-NO-C1                16203499
162035                   END-EXEC                                       16203599
162036                                                                  16203699
162037             WHEN ASC-AUDIT-CONTROL-NO-C2                         16203799
162038                 MOVE 'ASC-AUDIT-CONTROL-NO-C2       '            16203899
162039                                        TO DP013-MESSAGE-TEXT (2) 16203999
162040                   EXEC SQL                                       16204099
162041                      OPEN ASC-AUDIT-CONTROL-NO-C2                16204199
162042                   END-EXEC                                       16204299
162043                                                                  16204399
162044             WHEN ASC-CARTON-ID-C1                                16204499
162045                 MOVE 'ASC-CARTON-ID-C1              '            16204599
162046                                        TO DP013-MESSAGE-TEXT (2) 16204699
162047                   EXEC SQL                                       16204799
162048                      OPEN ASC-CARTON-ID-C1                       16204899
162049                   END-EXEC                                       16204999
162050                                                                  16205099
162051             WHEN ASC-CARTON-ID-C2                                16205199
162052                 MOVE 'ASC-CARTON-ID-C2              '            16205299
162053                                        TO DP013-MESSAGE-TEXT (2) 16205399
162054                   EXEC SQL                                       16205499
162055                      OPEN ASC-CARTON-ID-C2                       16205599
162056                   END-EXEC                                       16205699
162057                                                                  16205799
162058             WHEN ASC-OPER-UNIT-DATE-C1                           16205899
162059                 MOVE 'ASC-OPER-UNIT-DATE-C1         '            16205999
162060                                        TO DP013-MESSAGE-TEXT (2) 16206099
162061                   EXEC SQL                                       16206199
162062                      OPEN ASC-OPER-UNIT-DATE-C1                  16206299
162063                   END-EXEC                                       16206399
162064                                                                  16206499
162065             WHEN ASC-OPER-UNIT-DATE-C2                           16206599
162066                 MOVE 'ASC-OPER-UNIT-DATE-C2         '            16206699
162067                                        TO DP013-MESSAGE-TEXT (2) 16206799
162068                   EXEC SQL                                       16206899
162069                      OPEN ASC-OPER-UNIT-DATE-C2                  16206999
162070                   END-EXEC                                       16207099
162071                                                                  16207199
162072             WHEN ASC-OPER-UNIT-CASI-DATE-C1                      16207299
162073                 MOVE 'ASC-OPER-UNIT-CASI-DATE-C1    '            16207399
162074                                        TO DP013-MESSAGE-TEXT (2) 16207499
162075                   EXEC SQL                                       16207599
162076                      OPEN ASC-OPER-UNIT-CASI-DATE-C1             16207699
162077                   END-EXEC                                       16207799
162078                                                                  16207899
162079             WHEN ASC-OPER-UNIT-CASI-DATE-C2                      16207999
162080                 MOVE 'ASC-OPER-UNIT-CASI-DATE-C2    '            16208099
162081                                        TO DP013-MESSAGE-TEXT (2) 16208199
162082                   EXEC SQL                                       16208299
162083                      OPEN ASC-OPER-UNIT-CASI-DATE-C2             16208399
162084                   END-EXEC                                       16208499
162085                                                                  16208599
162086             WHEN ASC-OPER-UNIT-RSN-CODE-C1                       16208699
162087                 MOVE 'ASC-OPER-UNIT-RSN-CODE-C1'                 16208799
162088                                        TO DP013-MESSAGE-TEXT (2) 16208899
162089                   EXEC SQL                                       16208999
162090                      OPEN ASC-OPER-UNIT-RSN-CODE-C1              16209099
162091                   END-EXEC                                       16209199
162092                                                                  16209299
162093             WHEN ASC-OPER-UNIT-RSN-CODE-C2                       16209399
162094                 MOVE 'ASC-OPER-UNIT-RSN-CODE-C2'                 16209499
162095                                        TO DP013-MESSAGE-TEXT (2) 16209599
162096                   EXEC SQL                                       16209699
162097                      OPEN ASC-OPER-UNIT-RSN-CODE-C2              16209799
162098                   END-EXEC                                       16209899
162099                                                                  16209999
162100             WHEN ASC-OPER-UNIT-SETCODE-YR-C1                     16210099
162101                 MOVE 'ASC-OPER-UNIT-SETCODE-YR-C1 '              16210199
162102                                        TO DP013-MESSAGE-TEXT (2) 16210299
162103                   EXEC SQL                                       16210399
162104                      OPEN ASC-OPER-UNIT-SETCODE-YR-C1            16210499
162105                   END-EXEC                                       16210599
162106                                                                  16210699
162107             WHEN ASC-OPER-UNIT-SETCODE-YR-C2                     16210799
162108                 MOVE 'ASC-OPER-UNIT-SETCODE-YR-C2 '              16210899
162109                                        TO DP013-MESSAGE-TEXT (2) 16210999
162110                   EXEC SQL                                       16211099
162111                      OPEN ASC-OPER-UNIT-SETCODE-YR-C2            16211199
162112                   END-EXEC                                       16211299
162113                                                                  16211399
162114                                                                  16211499
162115         END-EVALUATE                                             16211599
162120                                                                  16212099
162130         EVALUATE TRUE                                            16213099
162140             WHEN SQLCODE = ZERO                                  16214099
162150             WHEN SQLCODE = -904                                  16215099
162160             WHEN SQLCODE = -913                                  16216099
162170                 CONTINUE                                         16217099
162180             WHEN SQLWARN0 NOT = SPACES                           16218099
162190             WHEN SQLCODE < ZERO                                  16219099
162200             WHEN SQLCODE > ZERO                                  16220099
162300                MOVE '4010-OPEN-CURSOR' TO DP013-PARAGRAPH        16230099
162400                MOVE 'UNABLE TO OPEN A CURSOR -'                  16240099
162500                                  TO DP013-MESSAGE-TEXT (1)       16250099
162600                MOVE SQLCA        TO DP013-SQLCA                  16260099
162700                MOVE 'SUT_CART_DIRV_TRKG' TO                      16270099
162800                                          DP013-DB2-TABLE-NAME (1)16280099
162900                SET DP013-DB2-ABEND                               16290099
163000                    DP013-XCTL-DISPLAY-RESTART TO TRUE            16300099
163100                PERFORM DP013-0000-PROCESS-ABEND                  16310099
163200         END-EVALUATE                                             16320099
163300     END-PERFORM.                                                 16330099
163400                                                                  16340099
163500     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        16350099
163600         MOVE '4010-OPEN-CURSOR'   TO DP013-PARAGRAPH             16360099
163700         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR'   16370099
163800                                   TO DP013-MESSAGE-TEXT (1)      16380099
163900         MOVE SQLCA                TO DP013-SQLCA                 16390099
164000         MOVE 'SUT_CART_DIRV_TRKG' TO DP013-DB2-TABLE-NAME (1)    16400099
164100         SET DP013-DB2-ABEND                                      16410099
164200             DP013-XCTL-DISPLAY-RESTART TO TRUE                   16420099
164300         PERFORM DP013-0000-PROCESS-ABEND                         16430099
164400     END-IF.                                                      16440099
164500                                                                  16450099
164600*----------------------------------------------------------------*16460099
164700* CLOSE THE CURSOR                                               *16470099
164800*----------------------------------------------------------------*16480099
164900 4020-CLOSE-CURSOR.                                               16490099
165000     EVALUATE TRUE                                                16500099
165100         WHEN ASC-OPER-UNIT-PO-C1                                 16510099
165200              EXEC SQL                                            16520099
165300                   CLOSE ASC-OPER-UNIT-PO-C1                      16530099
165400              END-EXEC                                            16540099
165500                                                                  16550099
165600         WHEN ASC-OPER-UNIT-PO-C2                                 16560099
165700              EXEC SQL                                            16570099
165800                   CLOSE ASC-OPER-UNIT-PO-C2                      16580099
165900              END-EXEC                                            16590099
166000                                                                  16600099
166100         WHEN ASC-OPER-UNIT-PO-R-C1                               16610099
166200              EXEC SQL                                            16620099
166300                   CLOSE ASC-OPER-UNIT-PO-R-C1                    16630099
166400              END-EXEC                                            16640099
166500                                                                  16650099
166600         WHEN ASC-OPER-UNIT-PO-R-C2                               16660099
166700              EXEC SQL                                            16670099
166800                   CLOSE ASC-OPER-UNIT-PO-R-C2                    16680099
166900              END-EXEC                                            16690099
167000                                                                  16700099
167100         WHEN ASC-OPER-UNIT-PO-R-LINE-C1                          16710099
167200              EXEC SQL                                            16720099
167300                   CLOSE ASC-OPER-UNIT-PO-R-LINE-C1               16730099
167400              END-EXEC                                            16740099
167500                                                                  16750099
167600         WHEN ASC-OPER-UNIT-PO-R-LINE-C2                          16760099
167700              EXEC SQL                                            16770099
167800                   CLOSE ASC-OPER-UNIT-PO-R-LINE-C2               16780099
167900              END-EXEC                                            16790099
168000                                                                  16800099
168100         WHEN ASC-OPER-UNIT-PO-R-PACK-C1                          16810099
168200              EXEC SQL                                            16820099
168300                   CLOSE ASC-OPER-UNIT-PO-R-PACK-C1               16830099
168400              END-EXEC                                            16840099
168500                                                                  16850099
168600         WHEN ASC-OPER-UNIT-PO-R-PACK-C2                          16860099
168700              EXEC SQL                                            16870099
168800                   CLOSE ASC-OPER-UNIT-PO-R-PACK-C2               16880099
168900              END-EXEC                                            16890099
169000                                                                  16900099
169100         WHEN ASC-AUDIT-CONTROL-NO-C1                             16910099
169200              EXEC SQL                                            16920099
169300                   CLOSE ASC-AUDIT-CONTROL-NO-C1                  16930099
169400              END-EXEC                                            16940099
169500                                                                  16950099
169600         WHEN ASC-AUDIT-CONTROL-NO-C2                             16960099
169700              EXEC SQL                                            16970099
169800                   CLOSE ASC-AUDIT-CONTROL-NO-C2                  16980099
169900              END-EXEC                                            16990099
170000                                                                  17000099
170100         WHEN ASC-CARTON-ID-C1                                    17010099
170200              EXEC SQL                                            17020099
170300                   CLOSE ASC-CARTON-ID-C1                         17030099
170400              END-EXEC                                            17040099
170500                                                                  17050099
170600         WHEN ASC-CARTON-ID-C2                                    17060099
170700              EXEC SQL                                            17070099
170800                   CLOSE ASC-CARTON-ID-C2                         17080099
170900              END-EXEC                                            17090099
171000                                                                  17100099
171100         WHEN ASC-OPER-UNIT-DATE-C1                               17110099
171200              EXEC SQL                                            17120099
171300                   CLOSE ASC-OPER-UNIT-DATE-C1                    17130099
171400              END-EXEC                                            17140099
171500                                                                  17150099
171600         WHEN ASC-OPER-UNIT-DATE-C2                               17160099
171700              EXEC SQL                                            17170099
171800                   CLOSE ASC-OPER-UNIT-DATE-C2                    17180099
171900              END-EXEC                                            17190099
172000                                                                  17200099
172100         WHEN ASC-OPER-UNIT-CASI-DATE-C1                          17210099
172200              EXEC SQL                                            17220099
172300                   CLOSE ASC-OPER-UNIT-CASI-DATE-C1               17230099
172400              END-EXEC                                            17240099
172500                                                                  17250099
172600         WHEN ASC-OPER-UNIT-CASI-DATE-C2                          17260099
172700              EXEC SQL                                            17270099
172800                   CLOSE ASC-OPER-UNIT-CASI-DATE-C2               17280099
172900              END-EXEC                                            17290099
173000                                                                  17300099
173010         WHEN ASC-OPER-UNIT-RSN-CODE-C1                           17301099
173020              EXEC SQL                                            17302099
173030                   CLOSE ASC-OPER-UNIT-RSN-CODE-C1                17303099
173040              END-EXEC                                            17304099
173050                                                                  17305099
173060         WHEN ASC-OPER-UNIT-RSN-CODE-C2                           17306099
173070              EXEC SQL                                            17307099
173080                   CLOSE ASC-OPER-UNIT-RSN-CODE-C2                17308099
173090              END-EXEC                                            17309099
173091                                                                  17309199
173100         WHEN ASC-OPER-UNIT-SETCODE-YR-C1                         17310099
173200              EXEC SQL                                            17320099
173300                   CLOSE ASC-OPER-UNIT-SETCODE-YR-C1              17330099
173400              END-EXEC                                            17340099
173500                                                                  17350099
173600         WHEN ASC-OPER-UNIT-SETCODE-YR-C2                         17360099
173700              EXEC SQL                                            17370099
173710                   CLOSE ASC-OPER-UNIT-SETCODE-YR-C2              17371099
173720              END-EXEC                                            17372099
173730                                                                  17373099
173740     END-EVALUATE.                                                17374099
173750                                                                  17375099
173760     EVALUATE TRUE                                                17376099
173770         WHEN SQLCODE = ZERO                                      17377099
173780             CONTINUE                                             17378099
173790         WHEN SQLWARN0 NOT = SPACES                               17379099
173800         WHEN SQLCODE < ZERO                                      17380099
173900         WHEN SQLCODE > ZERO                                      17390099
174000             MOVE '4020-CLOSE-CURSOR' TO DP013-PARAGRAPH          17400099
174100             MOVE 'UNABLE TO CLOSE CURSOR '                       17410099
174200                               TO DP013-MESSAGE-TEXT (1)          17420099
174300             MOVE SQLCA        TO DP013-SQLCA                     17430099
174400             MOVE 'SUT_CART_DIRV_TRKG' TO                         17440099
174500                                       DP013-DB2-TABLE-NAME (1)   17450099
174600             SET DP013-DB2-ABEND                                  17460099
174700                 DP013-XCTL-DISPLAY-RESTART TO TRUE               17470099
174800             PERFORM DP013-0000-PROCESS-ABEND                     17480099
174900     END-EVALUATE.                                                17490099
175000                                                                  17500099
175100*----------------------------------------------------------------*17510099
175200*    SET UP THE HOST VARIABLES.                                  *17520099
175300*----------------------------------------------------------------*17530099
175400 4100-PREPARE-CURSOR.                                             17540099
175500                                                                  17550099
175600     MOVE ASC-OPER-UNIT                 TO  DK-OPER-UNIT-ID.      17560099
175700     EVALUATE TRUE                                                17570099
175800        WHEN ASC-OPER-UNIT-PO-C1                                  17580099
175900          OR ASC-OPER-UNIT-PO-C2                                  17590099
176000             MOVE ASC-OPER-UNIT         TO DK-OPER-UNIT-ID        17600099
176100             MOVE ASC-PO-NUMBER-H       TO DK-PO-NUMBER           17610099
176200        WHEN ASC-OPER-UNIT-PO-R-C1                                17620099
176300          OR ASC-OPER-UNIT-PO-R-C2                                17630099
176400             MOVE ASC-OPER-UNIT         TO DK-OPER-UNIT-ID        17640099
176500             MOVE ASC-PO-NUMBER-H       TO DK-PO-NUMBER           17650099
176600             MOVE ASC-RCVR-NUMBER-H     TO DK-RCVR-NO             17660099
176700        WHEN ASC-OPER-UNIT-PO-R-LINE-C1                           17670099
176800          OR ASC-OPER-UNIT-PO-R-LINE-C2                           17680099
176900             MOVE ASC-OPER-UNIT         TO DK-OPER-UNIT-ID        17690099
177000             MOVE ASC-PO-NUMBER-H       TO DK-PO-NUMBER           17700099
177100             MOVE ASC-RCVR-NUMBER-H     TO DK-RCVR-NO             17710099
177200             MOVE ASC-LINE-NO-H         TO DK-LINE-NO             17720099
177300        WHEN ASC-OPER-UNIT-PO-R-PACK-C1                           17730099
177310         OR ASC-OPER-UNIT-PO-R-PACK-C2                            17731099
177320             MOVE ASC-OPER-UNIT         TO DK-OPER-UNIT-ID        17732099
177330             MOVE ASC-PO-NUMBER-H       TO DK-PO-NUMBER           17733099
177340             MOVE ASC-RCVR-NUMBER-H     TO DK-RCVR-NO             17734099
177350             MOVE ASC-PACK-ID-H         TO DK-PACK-ID             17735099
177360        WHEN ASC-AUDIT-CONTROL-NO-C1                              17736099
177370          OR ASC-AUDIT-CONTROL-NO-C2                              17737099
177380             MOVE ASC-AUDIT-NUMBER-N-H  TO DK-AUDIT-NO            17738099
177390        WHEN ASC-CARTON-ID-C1                                     17739099
177400          OR ASC-CARTON-ID-C2                                     17740099
177402             MOVE ASC-CARTON-ID-H       TO DK-CART-ID             17740299
177403        WHEN ASC-OPER-UNIT-DATE-C1                                17740399
177404          OR ASC-OPER-UNIT-DATE-C2                                17740499
177406             MOVE ASC-OPER-UNIT         TO DK-OPER-UNIT-ID        17740699
177407             MOVE '.000000' TO ASC-START-SSSSSS                   17740799
177408             MOVE ASC-START-DATE-TIMESTAMP                        17740899
177409                                        TO DK-BEGIN-DATE          17740999
177410             MOVE '.000000' TO ASC-END-SSSSSS                     17741099
177411             MOVE '.'       TO ASC-END-COL1                       17741199
177412                               ASC-END-COL2                       17741299
177420             MOVE ASC-DATE-END-TIMESTAMP                          17742099
177430                                        TO DK-END-DATE            17743099
177440        WHEN ASC-OPER-UNIT-CASI-DATE-C1                           17744099
177450          OR ASC-OPER-UNIT-CASI-DATE-C2                           17745099
177460             MOVE ASC-OPER-UNIT       TO DK-OPER-UNIT-ID          17746099
177470             MOVE ASC-CASI-H          TO DK-CASI                  17747099
177480             MOVE '.000000' TO ASC-START-SSSSSS                   17748099
177481             MOVE ASC-START-DATE-TIMESTAMP                        17748199
177482                                      TO DK-BEGIN-DATE            17748299
177483             MOVE '.000000' TO ASC-END-SSSSSS                     17748399
177484             MOVE '.'       TO ASC-END-COL1                       17748499
177485                               ASC-END-COL2                       17748599
177486             MOVE ASC-DATE-END-TIMESTAMP                          17748699
177487                                      TO DK-END-DATE              17748799
177488        WHEN ASC-OPER-UNIT-RSN-CODE-C1                            17748899
177489          OR ASC-OPER-UNIT-RSN-CODE-C2                            17748999
177491             MOVE ASC-OPER-UNIT       TO DK-OPER-UNIT-ID          17749199
177492             MOVE ASC-DIR-CODE-H      TO DK-DIRV-RSN-CDE          17749299
177493             MOVE '.000000'           TO ASC-START-SSSSSS         17749399
177494             MOVE '.'                 TO ASC-START-COL1           17749499
177495                                         ASC-START-COL2           17749599
177496             MOVE ASC-START-DATE-TIMESTAMP                        17749699
177497                                      TO DK-BEGIN-DATE            17749799
177498             MOVE '.000000'           TO ASC-END-SSSSSS           17749899
177499             MOVE '.'                 TO ASC-END-COL1             17749999
177500                                         ASC-END-COL2             17750099
177501             MOVE ASC-DATE-END-TIMESTAMP                          17750199
177502                                      TO DK-END-DATE              17750299
177503                                                                  17750399
177504        WHEN ASC-OPER-UNIT-SETCODE-YR-C1                          17750499
177505          OR ASC-OPER-UNIT-SETCODE-YR-C2                          17750599
177506             MOVE ASC-OPER-UNIT       TO DK-OPER-UNIT-ID          17750699
177510             MOVE ASC-SET-NAME-H      TO DK-SET-NAME              17751099
177600             MOVE ASC-SET-YEAR-H      TO DK-SET-YEAR              17760099
177601     END-EVALUATE.                                                17760199
177602                                                                  17760299
177603                                                                  17760399
177604*----------------------------------------------------------------*17760499
177605*    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE    *17760599
177606*    BLOCKS IN THE ARRAY.  WHENEVER BOTH BLOCKS BECOME FULL,     *17760699
177607*    WRITE OUT THE 1ST BLOCK TO TEMPORARY STORAGE, MOVE THE 2ND  *17760799
177608*    BLOCK IN THE ARRAY TO THE 1ST BLOCK, AND INITIALIZE THE     *17760899
177609*    2ND BLOCK MAKING IT AVAILABLE TO BE USED.                   *17760999
177610*                                                                *17761099
177620*    DUE TO THE SIZE OF THE TABLE, AND THE ORDER IN WHICH THE    *17762099
177630*    ROWS ARE SORTED, THE ENTIRE TABLE IS READ INTO THE PROGRAM  *17763099
177640*    UPON INITIALIZATION.                                        *17764099
177650*----------------------------------------------------------------*17765099
177660 4300-READ-ITEMS-FROM-DB.                                         17766099
177670     PERFORM                                                      17767099
177680         VARYING PV-READ-COUNT                                    17768099
177690         FROM 1 BY 1                                              17769099
177700         UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                    17770099
177800            OR (ASC-NO-ITEMS-LEFT-ON-DB))                         17780099
177900                                                                  17790099
178000        PERFORM 4310-FETCH                                        17800099
178100                                                                  17810099
178200        IF ASC-NO-ITEMS-LEFT-ON-DB                                17820099
178300            CONTINUE                                              17830099
178400        ELSE                                                      17840099
178500            PERFORM 4304-LOCKED-OR-NOT                            17850099
178600            IF SUT00102-CNVYR-PRC-ACTN-NM = 'DELETE'              17860099
178700                MOVE ' ' TO DK-UNIQUE-IND                         17870099
178800            END-IF                                                17880099
178900                                                                  17890099
179000* DK-UNIQUE-IND     = N MEANS THIS LINE ITEM IS LOCKED            17900099
179100* ASC-LOCK-MODE-SW  = 2 MEANS ONLY DISPLAY LOCKED                 17910099
179200            IF (DK-UNIQUE-IND    NOT = 'N')    AND                17920099
179300               (ASC-LOCK-MODE-SW     = '2')                       17930099
179400                CONTINUE                                          17940099
179500            ELSE                                                  17950099
179600                PERFORM 4305-BUILD-ASC                            17960099
179700            END-IF                                                17970099
179800        END-IF                                                    17980099
179900     END-PERFORM.                                                 17990099
180000                                                                  18000099
180100     IF  ASC-NUMBER-OF-ITEMS-READ > ZERO                          18010099
180200         MOVE +1               TO ASC-BLK-SUB                     18020099
180300         PERFORM 5100-WRITE-TEMP-STORAGE                          18030099
180400         ADD +1                TO ASC-BLK-SUB                     18040099
180500         PERFORM 5100-WRITE-TEMP-STORAGE                          18050099
180600                                                                  18060099
180700         MOVE 1                TO ASC-BLK-SUB                     18070099
180800                                  PV-BLOCK-NUMBER                 18080099
180900         PERFORM 4410-READ-TEMP-STORAGE                           18090099
181000         IF  ASC-HIGHEST-BLOCK-WRITTEN GREATER THAN 1             18100099
181100             MOVE 2            TO ASC-BLK-SUB                     18110099
181200                                  PV-BLOCK-NUMBER                 18120099
181300             PERFORM 4410-READ-TEMP-STORAGE                       18130099
181400         END-IF                                                   18140099
181500     END-IF.                                                      18150099
181600                                                                  18160099
181700*----------------------------------------------------------------*18170099
181800*    LOOK UP CARTON-CREATE-SRCE  ON SUT_OTBND_CART                18180099
181900*----------------------------------------------------------------*18190099
182000 4301-GET-CARTON-CREATE-SRCE.                                     18200099
182100                                                                  18210099
182200     MOVE ASC-CARTON-ID (ASC-BLK-SUB ASC-ITEM-SUB) TO DK-CART-ID. 18220099
182300*    MOVE ASC-CART-ID-P (ASC-BLK-SUB ASC-ITEM-SUB)                18230099
182400     MOVE ZEROS        TO DK-CART-ID-PACKED.                      18240099
182500     ADD  DK-CART-ID-N TO DK-CART-ID-PACKED                       18250099
182600                                                                  18260099
182700     EXEC SQL                                                     18270099
182800           SELECT CART_SRC_CDE                                    18280099
182900             INTO :SUT00024-CART-SRC-CDE                          18290099
183000             FROM SUT_OTBND_CART     A                            18300099
183100            WHERE SHIPT_UNT_ID   = :DK-CART-ID-PACKED             18310099
183200           WITH UR                                                18320099
183300       END-EXEC                                                   18330099
183400                                                                  18340099
183500     EVALUATE TRUE                                                18350099
183600         WHEN SQLCODE = ZERO                                      18360099
183601             CONTINUE                                             18360199
183610         WHEN SQLCODE = +100                                      18361099
183620              MOVE SPACES TO SUT00024-CART-SRC-CDE                18362099
183800         WHEN SQLWARN0 NOT = SPACES                               18380099
183900         WHEN SQLCODE < ZERO                                      18390099
184000         WHEN SQLCODE > ZERO                                      18400099
184100             MOVE '4301-GET-CARTON-CREATE-SRCE'                   18410099
184200                                         TO DP013-PARAGRAPH       18420099
184300             MOVE 'SELECT FROM SUT_OTBND_CART'                    18430099
184400                               TO DP013-MESSAGE-TEXT (1)          18440099
184500             MOVE SQLCA        TO DP013-SQLCA                     18450099
184600             MOVE 'SUT_OTBND_CART    '                            18460099
184700                               TO DP013-DB2-TABLE-NAME (1)        18470099
184800             SET DP013-DB2-ABEND                                  18480099
184900                 DP013-XCTL-DISPLAY-RESTART TO TRUE               18490099
185000             PERFORM DP013-0000-PROCESS-ABEND                     18500099
185100     END-EVALUATE.                                                18510099
185200                                                                  18520099
185300*----------------------------------------------------------------*18530099
185400*    LOOK UP CASI CODE ON FIRST CARTON                            18540099
185500*----------------------------------------------------------------*18550099
185600 4302-GET-CASI.                                                   18560099
185700                                                                  18570099
185800     EXEC SQL                                                     18580099
185900             SELECT  CASI_CDE                                     18590099
186000               INTO :SUT00102-CASI-CDE                            18600099
186100               FROM  SUT_CART_DIRV_TRKG                           18610099
186200              WHERE  BRCDE_NBR  = :SUT00102-BRCDE-NBR             18620099
186300              ORDER BY CRE_TMST                                   18630099
186400              FETCH FIRST ROW ONLY                                18640099
186800       END-EXEC                                                   18680099
186900                                                                  18690099
187000     EVALUATE TRUE                                                18700099
187100         WHEN SQLCODE = ZERO                                      18710099
187200             CONTINUE                                             18720099
187300         WHEN SQLWARN0 NOT = SPACES                               18730099
187400         WHEN SQLCODE < ZERO                                      18740099
187500         WHEN SQLCODE > ZERO                                      18750099
187600             MOVE '4302-GET-CASI     '                            18760099
187700                                         TO DP013-PARAGRAPH       18770099
187800             MOVE 'SELECT MIN CASI CODE      '                    18780099
187900                               TO DP013-MESSAGE-TEXT (1)          18790099
188000             MOVE SQLCA        TO DP013-SQLCA                     18800099
188100             MOVE 'SUT_CART_DIRV_TRKG'                            18810099
188200                               TO DP013-DB2-TABLE-NAME (1)        18820099
188300             SET DP013-DB2-ABEND                                  18830099
188400                 DP013-XCTL-DISPLAY-RESTART TO TRUE               18840099
188500             PERFORM DP013-0000-PROCESS-ABEND                     18850099
188600     END-EVALUATE.                                                18860099
188700                                                                  18870099
188800*----------------------------------------------------------------*18880099
188900*    LOOK UP DIRCETIVE REASON CODE TO DETERMIN LOCKED (N) OR NOT  18890099
189000*----------------------------------------------------------------*18900099
189100 4304-LOCKED-OR-NOT.                                              18910099
189200                                                                  18920099
189300     MOVE SUT00102-DIRV-RSN-CDE TO DK-DIRV-RSN-CDE.               18930099
189400                                                                  18940099
189500     EXEC SQL                                                     18950099
189600        SELECT I.ATTR_ELEM_TXT                                    18960099
189700          INTO :DK-UNIQUE-IND                                     18970099
189800          FROM WST_INTGRTN_TYP A                                  18980099
189900             , WST_ATTR_DEFN           B                          18990099
190000             , WST_ATTR_ELEM           C                          19000099
190100             , WST_ATTR_ELEM           D                          19010099
190200             , WST_ATTR_ELEM           E                          19020099
190300             , WST_ATTR_ELEM           F                          19030099
190400             , WST_ATTR_ELEM           G                          19040099
190500             , WST_ATTR_ELEM           H                          19050099
190600             , WST_ATTR_ELEM           I                          19060099
190700             , WST_ATTR_ELEM           J                          19070099
190800             , WST_ATTR_ELEM           K                          19080099
190900             , WST_ATTR_ELEM           L                          19090099
191000          WHERE A.INTGRTN_TYP_CDE    =  'ACAULGDST'               19100099
191100            AND A.INTGRTN_TYP_CDE    =  B.INTGRTN_TYP_CDE         19110099
191200            AND A.INTGRTN_TYP_CDE    =  C.INTGRTN_TYP_CDE         19120099
191300            AND A.INTGRTN_TYP_CDE    =  D.INTGRTN_TYP_CDE         19130099
191400            AND A.INTGRTN_TYP_CDE    =  E.INTGRTN_TYP_CDE         19140099
191500            AND A.INTGRTN_TYP_CDE    =  F.INTGRTN_TYP_CDE         19150099
191600            AND A.INTGRTN_TYP_CDE    =  G.INTGRTN_TYP_CDE         19160099
191700            AND A.INTGRTN_TYP_CDE    =  H.INTGRTN_TYP_CDE         19170099
191800            AND A.INTGRTN_TYP_CDE    =  I.INTGRTN_TYP_CDE         19180099
191900            AND A.INTGRTN_TYP_CDE    =  J.INTGRTN_TYP_CDE         19190099
192000            AND A.INTGRTN_TYP_CDE    =  K.INTGRTN_TYP_CDE         19200099
192100            AND A.INTGRTN_TYP_CDE    =  L.INTGRTN_TYP_CDE         19210099
192200            AND B.ATTR_DEFN_SEQ_NBR  =  1                         19220099
192300            AND C.ATTR_DEFN_SEQ_NBR  =  1                         19230099
192400            AND D.ATTR_DEFN_SEQ_NBR  =  2                         19240099
192500            AND E.ATTR_DEFN_SEQ_NBR  =  3                         19250099
192600            AND F.ATTR_DEFN_SEQ_NBR  =  4                         19260099
192700            AND G.ATTR_DEFN_SEQ_NBR  =  5                         19270099
192800            AND H.ATTR_DEFN_SEQ_NBR  =  6                         19280099
192900            AND I.ATTR_DEFN_SEQ_NBR  =  7                         19290099
193000            AND J.ATTR_DEFN_SEQ_NBR  =  8                         19300099
193100            AND K.ATTR_DEFN_SEQ_NBR  =  9                         19310099
193200            AND L.ATTR_DEFN_SEQ_NBR  =  10                        19320099
193300            AND C.ATTR_ELEM_SEQ_NBR  =  D.ATTR_ELEM_SEQ_NBR       19330099
193400            AND C.ATTR_ELEM_SEQ_NBR  =  E.ATTR_ELEM_SEQ_NBR       19340099
193500            AND C.ATTR_ELEM_SEQ_NBR  =  F.ATTR_ELEM_SEQ_NBR       19350099
193600            AND C.ATTR_ELEM_SEQ_NBR  =  G.ATTR_ELEM_SEQ_NBR       19360099
193700            AND C.ATTR_ELEM_SEQ_NBR  =  H.ATTR_ELEM_SEQ_NBR       19370099
193800            AND C.ATTR_ELEM_SEQ_NBR  =  I.ATTR_ELEM_SEQ_NBR       19380099
193900            AND C.ATTR_ELEM_SEQ_NBR  =  J.ATTR_ELEM_SEQ_NBR       19390099
194000            AND C.ATTR_ELEM_SEQ_NBR  =  K.ATTR_ELEM_SEQ_NBR       19400099
194100            AND C.ATTR_ELEM_SEQ_NBR  =  L.ATTR_ELEM_SEQ_NBR       19410099
194200            AND F.ATTR_ELEM_TXT      =  'Y'                       19420099
194300            AND G.ATTR_ELEM_TMST    <=  CURRENT TIMESTAMP         19430099
194400            AND H.ATTR_ELEM_TMST    >=  CURRENT TIMESTAMP         19440099
194500            AND C.ATTR_ELEM_NBR      =  :DK-OPER-UNIT-ID          19450099
194600            AND D.ATTR_ELEM_TXT      =  :DK-DIRV-RSN-CDE          19460099
194700                                                                  19470099
194800       END-EXEC                                                   19480099
194900                                                                  19490099
195000     EVALUATE TRUE                                                19500099
195100         WHEN SQLCODE = ZERO                                      19510099
195200             CONTINUE                                             19520099
195210         WHEN SQLCODE = +100                                      19521099
195220             MOVE ' ' TO DK-UNIQUE-IND                            19522099
195300         WHEN SQLWARN0 NOT = SPACES                               19530099
195400         WHEN SQLCODE < ZERO                                      19540099
195500         WHEN SQLCODE > ZERO                                      19550099
195600             MOVE '4304-LOCKED-OR-NOT'                            19560099
195700                                         TO DP013-PARAGRAPH       19570099
195800             MOVE 'I.ATTR_ELEM_TXT AS UNIQUE_IND'                 19580099
195900                               TO DP013-MESSAGE-TEXT (1)          19590099
196000             MOVE SQLCA        TO DP013-SQLCA                     19600099
196100             MOVE 'INTGRTN_TYP_CDE   '                            19610099
196200                               TO DP013-DB2-TABLE-NAME (1)        19620099
196300             SET DP013-DB2-ABEND                                  19630099
196400                 DP013-XCTL-DISPLAY-RESTART TO TRUE               19640099
196500             PERFORM DP013-0000-PROCESS-ABEND                     19650099
196600     END-EVALUATE.                                                19660099
196700                                                                  19670099
196800*----------------------------------------------------------------*19680099
196900*    ONLY POPULATE ASC WITH ROWS TO BE DISPLAYED                  19690099
197000*----------------------------------------------------------------*19700099
197100 4305-BUILD-ASC.                                                  19710099
197200     IF  ASC-ITEMS-LEFT-ON-DB                                     19720099
197300       IF ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                       19730099
197400           ADD +1            TO ASC-ITEM-SUB                      19740099
197500       ELSE                                                       19750099
197600           ADD +1            TO ASC-BLK-SUB                       19760099
197700           MOVE +1           TO ASC-ITEM-SUB                      19770099
197800                                                                  19780099
197900           IF  ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY               19790099
198000               MOVE +1       TO ASC-BLK-SUB                       19800099
198100               SET ASC-BLOCK-MODIFIED (1) TO TRUE                 19810099
198200               PERFORM 5100-WRITE-TEMP-STORAGE                    19820099
198300               MOVE ASC-BLOCK-ENTRIES                             19830099
198400                         (PC-MAX-BLOCKS-IN-ARRAY)                 19840099
198500                          TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB)       19850099
198600               ADD +1        TO ASC-BLK-SUB                       19860099
198700               INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)         19870099
198800               SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)            19880099
198900                             TO TRUE                              19890099
199000           END-IF                                                 19900099
199100       END-IF                                                     19910099
199200     ADD +1                TO ASC-NUMBER-OF-ITEMS-READ            19920099
199300     MOVE ASC-NUMBER-OF-ITEMS-READ                                19930099
199400                           TO ASC-LIST-ITEM-NUMBER                19940099
199500                               (ASC-BLK-SUB ASC-ITEM-SUB)         19950099
199600     EVALUATE TRUE                                                19960099
199700              WHEN SU100-FUNCTION-NONE                            19970099
199800                  MOVE SPACES TO ASC-ACTION                       19980099
199900                                   (ASC-BLK-SUB ASC-ITEM-SUB)     19990099
200000     END-EVALUATE                                                 20000099
200100                                                                  20010099
200200     MOVE DK-UNIQUE-IND              TO                           20020099
200300       ASC-LOCKED-OR-NOT        (ASC-BLK-SUB ASC-ITEM-SUB)        20030099
200400                                                                  20040099
200500        MOVE SUT00102-PO-NBR            TO                        20050099
200600          ASC-PO-NUMBER            (ASC-BLK-SUB ASC-ITEM-SUB)     20060099
200700        MOVE SUT00102-RCVR-SEQ-NBR      TO                        20070099
200800          ASC-RCVR-NUMBER-N        (ASC-BLK-SUB ASC-ITEM-SUB)     20080099
200900        MOVE SUT00102-PO-LNE-NBR        TO                        20090099
201000          ASC-LINE-NO-N            (ASC-BLK-SUB ASC-ITEM-SUB)     20100099
201100        MOVE SUT00102-PREPK-ID          TO                        20110099
201200          ASC-PACK-ID              (ASC-BLK-SUB ASC-ITEM-SUB)     20120099
201300        MOVE SU100-RCVR-PACK-TYPE       TO                        20130099
201400          ASC-PACK-TYPE            (ASC-BLK-SUB ASC-ITEM-SUB)     20140099
201500        MOVE SUT00102-BRCDE-NBR         TO                        20150099
201600          ASC-CARTON-ID           (ASC-BLK-SUB ASC-ITEM-SUB)      20160099
201700        MOVE SUT00102-SEASET-SHRT-NM    TO                        20170099
201800          ASC-SET-NAME             (ASC-BLK-SUB ASC-ITEM-SUB)     20180099
201900        MOVE SUT00102-CRE-PGM-NM        TO                        20190099
202000          ASC-CRE-PGM-NM           (ASC-BLK-SUB ASC-ITEM-SUB)     20200099
202100**GB 2/9/09                                                       20210099
202210******* IF ASC-SHIPT-UNT-ID (ASC-BLK-SUB ASC-ITEM-SUB) > 0        20221099
202310        IF SUT00102-SHIPT-UNT-ID > 0                              20231099
202320            PERFORM 4301-GET-CARTON-CREATE-SRCE                   20232099
202400            MOVE SUT00024-CART-SRC-CDE    TO                      20240099
202500               ASC-CARTON-CREATE-SRCE (ASC-BLK-SUB ASC-ITEM-SUB)  20250099
202600        ELSE                                                      20260099
202700            MOVE 'P2L'                    TO                      20270099
202800             ASC-CARTON-CREATE-SRCE (ASC-BLK-SUB ASC-ITEM-SUB)    20280099
202900        END-IF                                                    20290099
203000                                                                  20300099
203100        MOVE SUT00102-CNVYR-PRC-ACTN-NM TO                        20310099
203200          ASC-DIRECTIVE-TYPE       (ASC-BLK-SUB ASC-ITEM-SUB)     20320099
203300        MOVE SUT00102-DIRV-RSN-CDE      TO                        20330099
203400          ASC-DIRECTIVE-REASON-CDE (ASC-BLK-SUB ASC-ITEM-SUB)     20340099
203410                                                                  20341099
203500        MOVE SUT00102-LGCL-LOC-NM       TO DK-LGCL-LOC-NM         20350099
203600        MOVE SUT00102-OPER-UNT-ID       TO DK-OPER-UNIT-ID        20360099
203630        PERFORM 4309-GET-LOC-SENT-DESC                            20363099
203640        MOVE DK-LOC-SENT-DESC           TO ASC-LOC-SENT           20364099
203641                                   (ASC-BLK-SUB ASC-ITEM-SUB)     20364199
203650        IF DK-LOC-SENT-DESC  = 'ALL '                             20365099
203660            MOVE 'BRCD'                 TO ASC-LOC-SENT           20366099
203661                                   (ASC-BLK-SUB ASC-ITEM-SUB)     20366199
203670        END-IF                                                    20367099
203680                                                                  20368099
203700        MOVE SUT00102-CRE-TMST          TO                        20370099
203800          ASC-CRE-TMST             (ASC-BLK-SUB ASC-ITEM-SUB)     20380099
203900                                                                  20390099
204000        PERFORM 4302-GET-CASI                                     20400099
204100        MOVE SUT00102-CASI-CDE          TO                        20410099
204200          ASC-CASI                 (ASC-BLK-SUB ASC-ITEM-SUB)     20420099
204300                                                                  20430099
204400        MOVE SUT00102-SHIPT-UNT-ID      TO                        20440099
204500          ASC-SHIPT-UNT-ID         (ASC-BLK-SUB ASC-ITEM-SUB)     20450099
204501                                                                  20450199
204510        MOVE SUT00102-AUD-CNTL-NBR      TO                        20451099
204520          ASC-AUDIT-NUMBER         (ASC-BLK-SUB ASC-ITEM-SUB)     20452099
204600     END-IF.                                                      20460099
204700                                                                  20470099
204800                                                                  20480099
204900*----------------------------------------------------------------*20490099
205000*   SELECT CART_SRC_CDE FROM SUT_OTBND_CART                       20500099
205100*----------------------------------------------------------------*20510099
205200 4309-GET-LOC-SENT-DESC.                                          20520099
205300     EXEC SQL                                                     20530099
205400          SELECT J.ATTR_ELEM_TXT                                  20540099
205500           INTO :DK-LOC-SENT-DESC                                 20550099
205600           FROM WST_INTGRTN_TYP A                                 20560099
205700              , WST_ATTR_DEFN   B                                 20570099
205800              , WST_ATTR_ELEM   C                                 20580099
205900              , WST_ATTR_ELEM           D                         20590099
206000              , WST_ATTR_ELEM           E                         20600099
206100              , WST_ATTR_ELEM           F                         20610099
206200              , WST_ATTR_ELEM           G                         20620099
206300              , WST_ATTR_ELEM           H                         20630099
206400              , WST_ATTR_ELEM           I                         20640099
206500              , WST_ATTR_ELEM           J                         20650099
206600              , WST_ATTR_ELEM           K                         20660099
206700          WHERE A.INTGRTN_TYP_CDE    =  'ACAULGDST'               20670099
206800            AND A.INTGRTN_TYP_CDE    =  B.INTGRTN_TYP_CDE         20680099
206900            AND A.INTGRTN_TYP_CDE    =  C.INTGRTN_TYP_CDE         20690099
207000            AND A.INTGRTN_TYP_CDE    =  D.INTGRTN_TYP_CDE         20700099
207100            AND A.INTGRTN_TYP_CDE    =  E.INTGRTN_TYP_CDE         20710099
207200            AND A.INTGRTN_TYP_CDE    =  F.INTGRTN_TYP_CDE         20720099
207300            AND A.INTGRTN_TYP_CDE    =  G.INTGRTN_TYP_CDE         20730099
207400            AND A.INTGRTN_TYP_CDE    =  H.INTGRTN_TYP_CDE         20740099
207500            AND A.INTGRTN_TYP_CDE    =  I.INTGRTN_TYP_CDE         20750099
207600            AND A.INTGRTN_TYP_CDE    =  J.INTGRTN_TYP_CDE         20760099
207700            AND A.INTGRTN_TYP_CDE    =  K.INTGRTN_TYP_CDE         20770099
207800            AND B.ATTR_DEFN_SEQ_NBR  =  1                         20780099
207900            AND C.ATTR_DEFN_SEQ_NBR  =  1                         20790099
208000            AND D.ATTR_DEFN_SEQ_NBR  =  2                         20800099
208100            AND E.ATTR_DEFN_SEQ_NBR  =  3                         20810099
208200            AND F.ATTR_DEFN_SEQ_NBR  =  4                         20820099
208300            AND G.ATTR_DEFN_SEQ_NBR  =  5                         20830099
208400            AND H.ATTR_DEFN_SEQ_NBR  =  6                         20840099
208500            AND I.ATTR_DEFN_SEQ_NBR  =  7                         20850099
208600            AND J.ATTR_DEFN_SEQ_NBR  =  8                         20860099
208610            AND K.ATTR_DEFN_SEQ_NBR  =  9                         20861099
208620            AND C.ATTR_ELEM_SEQ_NBR  =  D.ATTR_ELEM_SEQ_NBR       20862099
208630            AND C.ATTR_ELEM_SEQ_NBR  =  E.ATTR_ELEM_SEQ_NBR       20863099
208631            AND C.ATTR_ELEM_SEQ_NBR  =  F.ATTR_ELEM_SEQ_NBR       20863199
208632            AND C.ATTR_ELEM_SEQ_NBR  =  G.ATTR_ELEM_SEQ_NBR       20863299
208633            AND C.ATTR_ELEM_SEQ_NBR  =  H.ATTR_ELEM_SEQ_NBR       20863399
208634            AND C.ATTR_ELEM_SEQ_NBR  =  I.ATTR_ELEM_SEQ_NBR       20863499
208635            AND C.ATTR_ELEM_SEQ_NBR  =  J.ATTR_ELEM_SEQ_NBR       20863599
208636            AND C.ATTR_ELEM_SEQ_NBR  =  K.ATTR_ELEM_SEQ_NBR       20863699
208637            AND F.ATTR_ELEM_TXT      =  'Y'                       20863799
208638            AND G.ATTR_ELEM_TMST    <=  CURRENT TIMESTAMP         20863899
208639            AND H.ATTR_ELEM_TMST    >=  CURRENT TIMESTAMP         20863999
208640            AND C.ATTR_ELEM_NBR      =  :DK-OPER-UNIT-ID          20864099
208641            AND E.ATTR_ELEM_TXT      =  :DK-LGCL-LOC-NM           20864199
208642         WITH UR                                                  20864299
208643            FETCH FIRST ROW ONLY                                  20864399
208644                                                                  20864499
208645     END-EXEC                                                     20864599
208646                                                                  20864699
208647     EVALUATE TRUE                                                20864799
208648         WHEN SQLCODE = ZERO                                      20864899
208649             CONTINUE                                             20864999
208650         WHEN SQLCODE = +100                                      20865099
208651             IF DK-LOC-SENT-DESC = 'ALL '                         20865199
208652                 MOVE 'BRCD'     TO DK-LOC-SENT-DESC              20865299
208653             ELSE                                                 20865399
208654                 MOVE SPACES     TO DK-LOC-SENT-DESC              20865499
208655             END-IF                                               20865599
208656         WHEN SQLWARN0 NOT = SPACES                               20865699
208657         WHEN SQLCODE < ZERO                                      20865799
208658         WHEN SQLCODE > ZERO                                      20865899
208659             MOVE '4309-GET-LOC-SENT-DESC'                        20865999
208660                                         TO DP013-PARAGRAPH       20866099
208661             MOVE 'SELECT FROM WST_INTGRTN_TYP'                   20866199
208662                               TO DP013-MESSAGE-TEXT (1)          20866299
208663             MOVE SQLCA        TO DP013-SQLCA                     20866399
208664             MOVE 'WST_ATTR_DEFN   '                              20866499
208665                               TO DP013-DB2-TABLE-NAME (1)        20866599
208666             SET DP013-DB2-ABEND                                  20866699
208667                 DP013-XCTL-DISPLAY-RESTART TO TRUE               20866799
208668             PERFORM DP013-0000-PROCESS-ABEND                     20866899
208669     END-EVALUATE.                                                20866999
208670                                                                  20867099
208671*----------------------------------------------------------------*20867199
208672*    FETCH THE CURSOR                                             20867299
208673*----------------------------------------------------------------*20867399
208674 4310-FETCH.                                                      20867499
208675       EVALUATE TRUE                                              20867599
208676           WHEN ASC-OPER-UNIT-PO-C1                               20867699
208677               EXEC SQL                                           20867799
208678                    FETCH ASC-OPER-UNIT-PO-C1                     20867899
208679                    INTO  :SUT00102-OPER-UNT-ID                   20867999
208680                        , :SUT00102-PO-NBR                        20868099
208681                        , :SUT00102-RCVR-SEQ-NBR                  20868199
208682                        , :SUT00102-PO-LNE-NBR                    20868299
208683                        , :SUT00102-PREPK-ID                      20868399
208684                        , :SUT00102-BRCDE-NBR                     20868499
208685                        , :SUT00102-SEASET-SHRT-NM                20868599
208686                        , :SUT00102-CNVYR-PRC-ACTN-NM             20868699
208687                        , :SUT00102-DIRV-RSN-CDE                  20868799
208688                        , :SUT00102-LGCL-LOC-NM                   20868899
208689                        , :SUT00102-CRE-TMST                      20868999
208690                        , :SUT00102-CASI-CDE                      20869099
208691                        , :SUT00102-CRE-PGM-NM                    20869199
208692                        , :SUT00102-SHIPT-UNT-ID                  20869299
208693                        , :SUT00102-AUD-CNTL-NBR                  20869399
208694               END-EXEC                                           20869499
208695                                                                  20869599
208696           WHEN ASC-OPER-UNIT-PO-C2                               20869699
208697               EXEC SQL                                           20869799
208698                    FETCH ASC-OPER-UNIT-PO-C2                     20869899
208699                    INTO  :SUT00102-OPER-UNT-ID                   20869999
208700                        , :SUT00102-PO-NBR                        20870099
208701                        , :SUT00102-RCVR-SEQ-NBR                  20870199
208702                        , :SUT00102-PO-LNE-NBR                    20870299
208703                        , :SUT00102-PREPK-ID                      20870399
208704                        , :SUT00102-BRCDE-NBR                     20870499
208705                        , :SUT00102-SEASET-SHRT-NM                20870599
208706                        , :SUT00102-CNVYR-PRC-ACTN-NM             20870699
208707                        , :SUT00102-DIRV-RSN-CDE                  20870799
208708                        , :SUT00102-LGCL-LOC-NM                   20870899
208709                        , :SUT00102-CRE-TMST                      20870999
208710                        , :SUT00102-CASI-CDE                      20871099
208711                        , :SUT00102-CRE-PGM-NM                    20871199
208712                        , :SUT00102-SHIPT-UNT-ID                  20871299
208713                        , :SUT00102-AUD-CNTL-NBR                  20871399
208714               END-EXEC                                           20871499
208715                                                                  20871599
208716           WHEN ASC-OPER-UNIT-PO-R-C1                             20871699
208717               EXEC SQL                                           20871799
208718                    FETCH ASC-OPER-UNIT-PO-R-C1                   20871899
208719                    INTO  :SUT00102-OPER-UNT-ID                   20871999
208720                        , :SUT00102-PO-NBR                        20872099
208721                        , :SUT00102-RCVR-SEQ-NBR                  20872199
208722                        , :SUT00102-PO-LNE-NBR                    20872299
208723                        , :SUT00102-PREPK-ID                      20872399
208724                        , :SUT00102-BRCDE-NBR                     20872499
208725                        , :SUT00102-SEASET-SHRT-NM                20872599
208726                        , :SUT00102-CNVYR-PRC-ACTN-NM             20872699
208727                        , :SUT00102-DIRV-RSN-CDE                  20872799
208728                        , :SUT00102-LGCL-LOC-NM                   20872899
208729                        , :SUT00102-CRE-TMST                      20872999
208730                        , :SUT00102-CASI-CDE                      20873099
208731                        , :SUT00102-CRE-PGM-NM                    20873199
208732                        , :SUT00102-SHIPT-UNT-ID                  20873299
208733                        , :SUT00102-AUD-CNTL-NBR                  20873399
208734               END-EXEC                                           20873499
208735                                                                  20873599
208736           WHEN ASC-OPER-UNIT-PO-R-C2                             20873699
208737               EXEC SQL                                           20873799
208738                    FETCH ASC-OPER-UNIT-PO-R-C2                   20873899
208739                    INTO  :SUT00102-OPER-UNT-ID                   20873999
208740                        , :SUT00102-PO-NBR                        20874099
208741                        , :SUT00102-RCVR-SEQ-NBR                  20874199
208742                        , :SUT00102-PO-LNE-NBR                    20874299
208743                        , :SUT00102-PREPK-ID                      20874399
208744                        , :SUT00102-BRCDE-NBR                     20874499
208745                        , :SUT00102-SEASET-SHRT-NM                20874599
208746                        , :SUT00102-CNVYR-PRC-ACTN-NM             20874699
208747                        , :SUT00102-DIRV-RSN-CDE                  20874799
208748                        , :SUT00102-LGCL-LOC-NM                   20874899
208749                        , :SUT00102-CRE-TMST                      20874999
208750                        , :SUT00102-CASI-CDE                      20875099
208751                        , :SUT00102-CRE-PGM-NM                    20875199
208752                        , :SUT00102-SHIPT-UNT-ID                  20875299
208753                        , :SUT00102-AUD-CNTL-NBR                  20875399
208754               END-EXEC                                           20875499
208755                                                                  20875599
208756           WHEN ASC-OPER-UNIT-PO-R-LINE-C1                        20875699
208757               EXEC SQL                                           20875799
208758                    FETCH ASC-OPER-UNIT-PO-R-LINE-C1              20875899
208759                    INTO  :SUT00102-OPER-UNT-ID                   20875999
208760                        , :SUT00102-PO-NBR                        20876099
208761                        , :SUT00102-RCVR-SEQ-NBR                  20876199
208762                        , :SUT00102-PO-LNE-NBR                    20876299
208763                        , :SUT00102-PREPK-ID                      20876399
208764                        , :SUT00102-BRCDE-NBR                     20876499
208765                        , :SUT00102-SEASET-SHRT-NM                20876599
208766                        , :SUT00102-CNVYR-PRC-ACTN-NM             20876699
208767                        , :SUT00102-DIRV-RSN-CDE                  20876799
208768                        , :SUT00102-LGCL-LOC-NM                   20876899
208769                        , :SUT00102-CRE-TMST                      20876999
208770                        , :SUT00102-CASI-CDE                      20877099
208771                        , :SUT00102-CRE-PGM-NM                    20877199
208772                        , :SUT00102-SHIPT-UNT-ID                  20877299
208773                        , :SUT00102-AUD-CNTL-NBR                  20877399
208774               END-EXEC                                           20877499
208775                                                                  20877599
208776           WHEN ASC-OPER-UNIT-PO-R-LINE-C2                        20877699
208777               EXEC SQL                                           20877799
208778                    FETCH ASC-OPER-UNIT-PO-R-LINE-C2              20877899
208779                    INTO  :SUT00102-OPER-UNT-ID                   20877999
208780                        , :SUT00102-PO-NBR                        20878099
208781                        , :SUT00102-RCVR-SEQ-NBR                  20878199
208782                        , :SUT00102-PO-LNE-NBR                    20878299
208783                        , :SUT00102-PREPK-ID                      20878399
208784                        , :SUT00102-BRCDE-NBR                     20878499
208785                        , :SUT00102-SEASET-SHRT-NM                20878599
208786                        , :SUT00102-CNVYR-PRC-ACTN-NM             20878699
208787                        , :SUT00102-DIRV-RSN-CDE                  20878799
208788                        , :SUT00102-LGCL-LOC-NM                   20878899
208789                        , :SUT00102-CRE-TMST                      20878999
208790                        , :SUT00102-CASI-CDE                      20879099
208791                        , :SUT00102-CRE-PGM-NM                    20879199
208792                        , :SUT00102-SHIPT-UNT-ID                  20879299
208793                        , :SUT00102-AUD-CNTL-NBR                  20879399
208794               END-EXEC                                           20879499
208795                                                                  20879599
208796           WHEN ASC-OPER-UNIT-PO-R-PACK-C1                        20879699
208797               EXEC SQL                                           20879799
208798                    FETCH ASC-OPER-UNIT-PO-R-PACK-C1              20879899
208799                    INTO  :SUT00102-OPER-UNT-ID                   20879999
208800                        , :SUT00102-PO-NBR                        20880099
208801                        , :SUT00102-RCVR-SEQ-NBR                  20880199
208802                        , :SUT00102-PO-LNE-NBR                    20880299
208803                        , :SUT00102-PREPK-ID                      20880399
208804                        , :SUT00102-BRCDE-NBR                     20880499
208805                        , :SUT00102-SEASET-SHRT-NM                20880599
208806                        , :SUT00102-CNVYR-PRC-ACTN-NM             20880699
208807                        , :SUT00102-DIRV-RSN-CDE                  20880799
208808                        , :SUT00102-LGCL-LOC-NM                   20880899
208809                        , :SUT00102-CRE-TMST                      20880999
208810                        , :SUT00102-CASI-CDE                      20881099
208811                        , :SUT00102-CRE-PGM-NM                    20881199
208812                        , :SUT00102-SHIPT-UNT-ID                  20881299
208813                        , :SUT00102-AUD-CNTL-NBR                  20881399
208814               END-EXEC                                           20881499
208815                                                                  20881599
208816           WHEN ASC-OPER-UNIT-PO-R-PACK-C2                        20881699
208817               EXEC SQL                                           20881799
208818                    FETCH ASC-OPER-UNIT-PO-R-PACK-C2              20881899
208819                    INTO  :SUT00102-OPER-UNT-ID                   20881999
208820                        , :SUT00102-PO-NBR                        20882099
208821                        , :SUT00102-RCVR-SEQ-NBR                  20882199
208822                        , :SUT00102-PO-LNE-NBR                    20882299
208823                        , :SUT00102-PREPK-ID                      20882399
208824                        , :SUT00102-BRCDE-NBR                     20882499
208825                        , :SUT00102-SEASET-SHRT-NM                20882599
208826                        , :SUT00102-CNVYR-PRC-ACTN-NM             20882699
208827                        , :SUT00102-DIRV-RSN-CDE                  20882799
208828                        , :SUT00102-LGCL-LOC-NM                   20882899
208829                        , :SUT00102-CRE-TMST                      20882999
208830                        , :SUT00102-CASI-CDE                      20883099
208831                        , :SUT00102-CRE-PGM-NM                    20883199
208832                        , :SUT00102-SHIPT-UNT-ID                  20883299
208833                        , :SUT00102-AUD-CNTL-NBR                  20883399
208834               END-EXEC                                           20883499
208835                                                                  20883599
208836           WHEN ASC-AUDIT-CONTROL-NO-C1                           20883699
208837               EXEC SQL                                           20883799
208838                    FETCH ASC-AUDIT-CONTROL-NO-C1                 20883899
208839                    INTO  :SUT00102-OPER-UNT-ID                   20883999
208840                        , :SUT00102-PO-NBR                        20884099
208841                        , :SUT00102-RCVR-SEQ-NBR                  20884199
208842                        , :SUT00102-PO-LNE-NBR                    20884299
208843                        , :SUT00102-PREPK-ID                      20884399
208844                        , :SUT00102-BRCDE-NBR                     20884499
208845                        , :SUT00102-SEASET-SHRT-NM                20884599
208846                        , :SUT00102-CNVYR-PRC-ACTN-NM             20884699
208847                        , :SUT00102-DIRV-RSN-CDE                  20884799
208848                        , :SUT00102-LGCL-LOC-NM                   20884899
208849                        , :SUT00102-CRE-TMST                      20884999
208850                        , :SUT00102-CASI-CDE                      20885099
208851                        , :SUT00102-CRE-PGM-NM                    20885199
208852                        , :SUT00102-SHIPT-UNT-ID                  20885299
208853                        , :SUT00102-AUD-CNTL-NBR                  20885399
208854               END-EXEC                                           20885499
208855                                                                  20885599
208856           WHEN ASC-AUDIT-CONTROL-NO-C2                           20885699
208857               EXEC SQL                                           20885799
208858                    FETCH ASC-AUDIT-CONTROL-NO-C2                 20885899
208859                    INTO  :SUT00102-OPER-UNT-ID                   20885999
208860                        , :SUT00102-PO-NBR                        20886099
208861                        , :SUT00102-RCVR-SEQ-NBR                  20886199
208862                        , :SUT00102-PO-LNE-NBR                    20886299
208863                        , :SUT00102-PREPK-ID                      20886399
208864                        , :SUT00102-BRCDE-NBR                     20886499
208865                        , :SUT00102-SEASET-SHRT-NM                20886599
208866                        , :SUT00102-CNVYR-PRC-ACTN-NM             20886699
208867                        , :SUT00102-DIRV-RSN-CDE                  20886799
208868                        , :SUT00102-LGCL-LOC-NM                   20886899
208869                        , :SUT00102-CRE-TMST                      20886999
208870                        , :SUT00102-CASI-CDE                      20887099
208871                        , :SUT00102-CRE-PGM-NM                    20887199
208872                        , :SUT00102-SHIPT-UNT-ID                  20887299
208873                        , :SUT00102-AUD-CNTL-NBR                  20887399
208874               END-EXEC                                           20887499
208875                                                                  20887599
208876           WHEN ASC-CARTON-ID-C1                                  20887699
208877               EXEC SQL                                           20887799
208878                    FETCH ASC-CARTON-ID-C1                        20887899
208879                    INTO  :SUT00102-OPER-UNT-ID                   20887999
208880                        , :SUT00102-PO-NBR                        20888099
208881                        , :SUT00102-RCVR-SEQ-NBR                  20888199
208882                        , :SUT00102-PO-LNE-NBR                    20888299
208883                        , :SUT00102-PREPK-ID                      20888399
208884                        , :SUT00102-BRCDE-NBR                     20888499
208885                        , :SUT00102-SEASET-SHRT-NM                20888599
208886                        , :SUT00102-CNVYR-PRC-ACTN-NM             20888699
208887                        , :SUT00102-DIRV-RSN-CDE                  20888799
208888                        , :SUT00102-LGCL-LOC-NM                   20888899
208889                        , :SUT00102-CRE-TMST                      20888999
208890                        , :SUT00102-CASI-CDE                      20889099
208891                        , :SUT00102-CRE-PGM-NM                    20889199
208892                        , :SUT00102-SHIPT-UNT-ID                  20889299
208893                        , :SUT00102-AUD-CNTL-NBR                  20889399
208894               END-EXEC                                           20889499
208895                                                                  20889599
208896           WHEN ASC-CARTON-ID-C2                                  20889699
208897               EXEC SQL                                           20889799
208898                    FETCH ASC-CARTON-ID-C2                        20889899
208899                    INTO  :SUT00102-OPER-UNT-ID                   20889999
208900                        , :SUT00102-PO-NBR                        20890099
208901                        , :SUT00102-RCVR-SEQ-NBR                  20890199
208902                        , :SUT00102-PO-LNE-NBR                    20890299
208903                        , :SUT00102-PREPK-ID                      20890399
208904                        , :SUT00102-BRCDE-NBR                     20890499
208905                        , :SUT00102-SEASET-SHRT-NM                20890599
208906                        , :SUT00102-CNVYR-PRC-ACTN-NM             20890699
208907                        , :SUT00102-DIRV-RSN-CDE                  20890799
208908                        , :SUT00102-LGCL-LOC-NM                   20890899
208909                        , :SUT00102-CRE-TMST                      20890999
208910                        , :SUT00102-CASI-CDE                      20891099
208911                        , :SUT00102-CRE-PGM-NM                    20891199
208912                        , :SUT00102-SHIPT-UNT-ID                  20891299
208913                        , :SUT00102-AUD-CNTL-NBR                  20891399
208914               END-EXEC                                           20891499
208915                                                                  20891599
208916           WHEN ASC-OPER-UNIT-DATE-C1                             20891699
208917               EXEC SQL                                           20891799
208918                    FETCH ASC-OPER-UNIT-DATE-C1                   20891899
208919                    INTO  :SUT00102-OPER-UNT-ID                   20891999
208920                        , :SUT00102-PO-NBR                        20892099
208921                        , :SUT00102-RCVR-SEQ-NBR                  20892199
208922                        , :SUT00102-PO-LNE-NBR                    20892299
208923                        , :SUT00102-PREPK-ID                      20892399
208924                        , :SUT00102-BRCDE-NBR                     20892499
208925                        , :SUT00102-SEASET-SHRT-NM                20892599
208926                        , :SUT00102-CNVYR-PRC-ACTN-NM             20892699
208927                        , :SUT00102-DIRV-RSN-CDE                  20892799
208928                        , :SUT00102-LGCL-LOC-NM                   20892899
208929                        , :SUT00102-CRE-TMST                      20892999
208930                        , :SUT00102-CASI-CDE                      20893099
208931                        , :SUT00102-CRE-PGM-NM                    20893199
208932                        , :SUT00102-SHIPT-UNT-ID                  20893299
208933                        , :SUT00102-AUD-CNTL-NBR                  20893399
208934               END-EXEC                                           20893499
208935                                                                  20893599
208936           WHEN ASC-OPER-UNIT-DATE-C2                             20893699
208937               EXEC SQL                                           20893799
208938                    FETCH ASC-OPER-UNIT-DATE-C2                   20893899
208939                    INTO  :SUT00102-OPER-UNT-ID                   20893999
208940                        , :SUT00102-PO-NBR                        20894099
208941                        , :SUT00102-RCVR-SEQ-NBR                  20894199
208942                        , :SUT00102-PO-LNE-NBR                    20894299
208943                        , :SUT00102-PREPK-ID                      20894399
208944                        , :SUT00102-BRCDE-NBR                     20894499
208945                        , :SUT00102-SEASET-SHRT-NM                20894599
208946                        , :SUT00102-CNVYR-PRC-ACTN-NM             20894699
208947                        , :SUT00102-DIRV-RSN-CDE                  20894799
208948                        , :SUT00102-LGCL-LOC-NM                   20894899
208949                        , :SUT00102-CRE-TMST                      20894999
208950                        , :SUT00102-CASI-CDE                      20895099
208951                        , :SUT00102-CRE-PGM-NM                    20895199
208952                        , :SUT00102-SHIPT-UNT-ID                  20895299
208953                        , :SUT00102-AUD-CNTL-NBR                  20895399
208954               END-EXEC                                           20895499
208955                                                                  20895599
208956           WHEN ASC-OPER-UNIT-CASI-DATE-C1                        20895699
208957               EXEC SQL                                           20895799
208958                    FETCH ASC-OPER-UNIT-CASI-DATE-C1              20895899
208959                    INTO  :SUT00102-OPER-UNT-ID                   20895999
208960                        , :SUT00102-PO-NBR                        20896099
208961                        , :SUT00102-RCVR-SEQ-NBR                  20896199
208962                        , :SUT00102-PO-LNE-NBR                    20896299
208963                        , :SUT00102-PREPK-ID                      20896399
208964                        , :SUT00102-BRCDE-NBR                     20896499
208965                        , :SUT00102-SEASET-SHRT-NM                20896599
208966                        , :SUT00102-CNVYR-PRC-ACTN-NM             20896699
208967                        , :SUT00102-DIRV-RSN-CDE                  20896799
208968                        , :SUT00102-LGCL-LOC-NM                   20896899
208969                        , :SUT00102-CRE-TMST                      20896999
208970                        , :SUT00102-CASI-CDE                      20897099
208971                        , :SUT00102-CRE-PGM-NM                    20897199
208972                        , :SUT00102-SHIPT-UNT-ID                  20897299
208973                        , :SUT00102-AUD-CNTL-NBR                  20897399
208974               END-EXEC                                           20897499
208975                                                                  20897599
208976           WHEN ASC-OPER-UNIT-CASI-DATE-C2                        20897699
208977               EXEC SQL                                           20897799
208978                    FETCH ASC-OPER-UNIT-CASI-DATE-C2              20897899
208979                    INTO  :SUT00102-OPER-UNT-ID                   20897999
208980                        , :SUT00102-PO-NBR                        20898099
208981                        , :SUT00102-RCVR-SEQ-NBR                  20898199
208982                        , :SUT00102-PO-LNE-NBR                    20898299
208983                        , :SUT00102-PREPK-ID                      20898399
208984                        , :SUT00102-BRCDE-NBR                     20898499
208985                        , :SUT00102-SEASET-SHRT-NM                20898599
208986                        , :SUT00102-CNVYR-PRC-ACTN-NM             20898699
208987                        , :SUT00102-DIRV-RSN-CDE                  20898799
208988                        , :SUT00102-LGCL-LOC-NM                   20898899
208989                        , :SUT00102-CRE-TMST                      20898999
208990                        , :SUT00102-CASI-CDE                      20899099
208991                        , :SUT00102-CRE-PGM-NM                    20899199
208992                        , :SUT00102-SHIPT-UNT-ID                  20899299
208993                        , :SUT00102-AUD-CNTL-NBR                  20899399
208994               END-EXEC                                           20899499
208995                                                                  20899599
208996           WHEN ASC-OPER-UNIT-RSN-CODE-C1                         20899699
208997               EXEC SQL                                           20899799
208998                    FETCH ASC-OPER-UNIT-RSN-CODE-C1               20899899
208999                    INTO  :SUT00102-OPER-UNT-ID                   20899999
209000                        , :SUT00102-PO-NBR                        20900099
209001                        , :SUT00102-RCVR-SEQ-NBR                  20900199
209002                        , :SUT00102-PO-LNE-NBR                    20900299
209003                        , :SUT00102-PREPK-ID                      20900399
209004                        , :SUT00102-BRCDE-NBR                     20900499
209005                        , :SUT00102-SEASET-SHRT-NM                20900599
209006                        , :SUT00102-CNVYR-PRC-ACTN-NM             20900699
209007                        , :SUT00102-DIRV-RSN-CDE                  20900799
209008                        , :SUT00102-LGCL-LOC-NM                   20900899
209009                        , :SUT00102-CRE-TMST                      20900999
209010                        , :SUT00102-CASI-CDE                      20901099
209011                        , :SUT00102-CRE-PGM-NM                    20901199
209012                        , :SUT00102-SHIPT-UNT-ID                  20901299
209013                        , :SUT00102-AUD-CNTL-NBR                  20901399
209014               END-EXEC                                           20901499
209015                                                                  20901599
209016           WHEN ASC-OPER-UNIT-RSN-CODE-C2                         20901699
209017               EXEC SQL                                           20901799
209018                    FETCH ASC-OPER-UNIT-RSN-CODE-C2               20901899
209019                    INTO  :SUT00102-OPER-UNT-ID                   20901999
209020                        , :SUT00102-PO-NBR                        20902099
209021                        , :SUT00102-RCVR-SEQ-NBR                  20902199
209022                        , :SUT00102-PO-LNE-NBR                    20902299
209023                        , :SUT00102-PREPK-ID                      20902399
209024                        , :SUT00102-BRCDE-NBR                     20902499
209025                        , :SUT00102-SEASET-SHRT-NM                20902599
209026                        , :SUT00102-CNVYR-PRC-ACTN-NM             20902699
209027                        , :SUT00102-DIRV-RSN-CDE                  20902799
209028                        , :SUT00102-LGCL-LOC-NM                   20902899
209029                        , :SUT00102-CRE-TMST                      20902999
209030                        , :SUT00102-CASI-CDE                      20903099
209031                        , :SUT00102-CRE-PGM-NM                    20903199
209032                        , :SUT00102-SHIPT-UNT-ID                  20903299
209033                        , :SUT00102-AUD-CNTL-NBR                  20903399
209034               END-EXEC                                           20903499
209035                                                                  20903599
209036           WHEN ASC-OPER-UNIT-SETCODE-YR-C1                       20903699
209037               EXEC SQL                                           20903799
209038                    FETCH ASC-OPER-UNIT-SETCODE-YR-C1             20903899
209039                    INTO  :SUT00102-OPER-UNT-ID                   20903999
209040                        , :SUT00102-PO-NBR                        20904099
209041                        , :SUT00102-RCVR-SEQ-NBR                  20904199
209042                        , :SUT00102-PO-LNE-NBR                    20904299
209043                        , :SUT00102-PREPK-ID                      20904399
209044                        , :SUT00102-BRCDE-NBR                     20904499
209045                        , :SUT00102-SEASET-SHRT-NM                20904599
209046                        , :SUT00102-CNVYR-PRC-ACTN-NM             20904699
209047                        , :SUT00102-DIRV-RSN-CDE                  20904799
209048                        , :SUT00102-LGCL-LOC-NM                   20904899
209049                        , :SUT00102-CRE-TMST                      20904999
209050                        , :SUT00102-CASI-CDE                      20905099
209051                        , :SUT00102-CRE-PGM-NM                    20905199
209052                        , :SUT00102-SHIPT-UNT-ID                  20905299
209053                        , :SUT00102-AUD-CNTL-NBR                  20905399
209054               END-EXEC                                           20905499
209055                                                                  20905599
209056           WHEN ASC-OPER-UNIT-SETCODE-YR-C2                       20905699
209057               EXEC SQL                                           20905799
209058                    FETCH ASC-OPER-UNIT-SETCODE-YR-C2             20905899
209059                    INTO  :SUT00102-OPER-UNT-ID                   20905999
209060                        , :SUT00102-PO-NBR                        20906099
209061                        , :SUT00102-RCVR-SEQ-NBR                  20906199
209062                        , :SUT00102-PO-LNE-NBR                    20906299
209063                        , :SUT00102-PREPK-ID                      20906399
209064                        , :SUT00102-BRCDE-NBR                     20906499
209065                        , :SUT00102-SEASET-SHRT-NM                20906599
209066                        , :SUT00102-CNVYR-PRC-ACTN-NM             20906699
209067                        , :SUT00102-DIRV-RSN-CDE                  20906799
209068                        , :SUT00102-LGCL-LOC-NM                   20906899
209069                        , :SUT00102-CRE-TMST                      20906999
209070                        , :SUT00102-CASI-CDE                      20907099
209071                        , :SUT00102-CRE-PGM-NM                    20907199
209072                        , :SUT00102-SHIPT-UNT-ID                  20907299
209073                        , :SUT00102-AUD-CNTL-NBR                  20907399
209074               END-EXEC                                           20907499
209075                                                                  20907599
209076     END-EVALUATE.                                                20907699
209077                                                                  20907799
209078     EVALUATE TRUE                                                20907899
209079         WHEN SQLCODE = ZERO                                      20907999
209080              CONTINUE                                            20908099
209081         WHEN SQLCODE = +100                                      20908199
209082              CONTINUE                                            20908299
209083         WHEN SQLWARN0 NOT = SPACE                                20908399
209084         WHEN SQLCODE NOT = ZERO                                  20908499
209085              MOVE '4310-FETCH-CURSOR' TO DP013-PARAGRAPH         20908599
209086              MOVE 'COULD NOT FETCH CURSOR'                       20908699
209087                               TO DP013-MESSAGE-TEXT (1)          20908799
209088              MOVE SQLCA       TO DP013-SQLCA                     20908899
209089              SET DP013-DB2-ABEND TO TRUE                         20908999
209090              PERFORM DP013-0000-PROCESS-ABEND                    20909099
209091     END-EVALUATE.                                                20909199
209092                                                                  20909299
209093     IF  SQLCODE EQUAL +100                                       20909399
209094         SET ASC-NO-ITEMS-LEFT-ON-DB TO TRUE                      20909499
209095     END-IF.                                                      20909599
209096                                                                  20909699
209097 4400-MOVE-COMMAREA-TO-SCREEN.                                    20909799
209098     IF  (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1))             20909899
209099         AND (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1)))          20909999
209100         OR  (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)))          20910099
209101             MOVE +1    TO ASC-BLK-SUB                            20910199
209102             PERFORM 5100-WRITE-TEMP-STORAGE                      20910299
209103             ADD +1     TO ASC-BLK-SUB                            20910399
209104             PERFORM 5100-WRITE-TEMP-STORAGE                      20910499
209105             DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             20910599
209106                 GIVING PV-BLOCK-NUMBER                           20910699
209107                 REMAINDER PV-REMAINDER                           20910799
209108             IF  PV-REMAINDER > ZERO                              20910899
209109                 ADD +1 TO PV-BLOCK-NUMBER                        20910999
209110             END-IF                                               20911099
209111             MOVE +1    TO ASC-BLK-SUB                            20911199
209112             PERFORM 4410-READ-TEMP-STORAGE                       20911299
209113             ADD +1     TO ASC-BLK-SUB                            20911399
209114                           PV-BLOCK-NUMBER                        20911499
209115             PERFORM 4410-READ-TEMP-STORAGE                       20911599
209116     END-IF.                                                      20911699
209117     MOVE +1            TO ASC-BLK-SUB.                           20911799
209118     COMPUTE ASC-ITEM-SUB =                                       20911899
209119         ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              20911999
209120         + PC-ITEMS-PER-PANEL).                                   20912099
209121*                                                                 20912199
209122     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        20912299
209123         ADD +1         TO ASC-BLK-SUB                            20912399
209124         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            20912499
209125     END-IF.                                                      20912599
209126*                                                                 20912699
209127     COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           20912799
209128         ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                20912899
209129     PERFORM 4430-CHECK-FOR-BEGIN-AND-END.                        20912999
209130     PERFORM 4420-FORMAT-LIST-LINES                               20913099
209131         VARYING PV-SUB                                           20913199
209132         FROM PC-ITEMS-PER-PANEL BY -1                            20913299
209133         UNTIL PV-SUB       < +1                                  20913399
209134*                                                                 20913499
209135     COMPUTE ASC-ITEMS-DISPLAYED =                                20913599
209136         ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).          20913699
209137     MOVE PV-TOP-ITEM              TO ASC-ITEM-AT-TOP-OF-PANEL    20913799
209138                                      ASTRTITO.                   20913899
209139     MOVE ASC-ITEM-AT-BOT-OF-PANEL TO AENDITO.                    20913999
209140     MOVE ASC-NUMBER-OF-ITEMS-READ TO ATOTITO.                    20914099
209141     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            20914199
209142                                   TO ASELITO.                    20914299
209143     MOVE ASC-OPER-UNIT            TO AOPUNITO.                   20914399
209144     MOVE ASC-OPER-UNIT-NAME       TO AOPNAMEO.                   20914499
209145     IF ASC-LOCK-MODE-DIRECT                                      20914599
209146         MOVE 'LOCKED  '           TO ALOCKMDO                    20914699
209147     ELSE                                                         20914799
209148         MOVE 'ALL     '           TO ALOCKMDO.                   20914899
209149     IF ASC-SORT-SEQ-SW = PC-C2                                   20914999
209150         MOVE PC-C2-DESCRIPTION    TO ASORSEQO                    20915099
209151     ELSE                                                         20915199
209152         MOVE PC-C1-DESCRIPTION    TO ASORSEQO                    20915299
209153     END-IF.                                                      20915399
209154                                                                  20915499
209155     IF  DP020-MSG-NUMBER-X = SPACE                               20915599
209156         IF  ASC-ITEM-AT-BOT-OF-PANEL < ASC-NUMBER-OF-ITEMS-READ  20915699
209157*            --- MORE ITEMS TO DISPLAY ----                       20915799
209158             MOVE PC-TSYMSG-00279  TO DP020-MSG-NUMBER            20915899
209159             SET DP020-MSG-INFORMATIONAL TO TRUE                  20915999
209160         END-IF                                                   20916099
209161     END-IF.                                                      20916199
209162                                                                  20916299
209163*----------------------------------------------------------------*20916399
209164*    READ A BLOCK FROM TEMPORARY STORAGE INTO THE ARRAY.         *20916499
209165*----------------------------------------------------------------*20916599
209166 4410-READ-TEMP-STORAGE.                                          20916699
209167     EXEC CICS                                                    20916799
209168         READQ TS                                                 20916899
209169             QUEUE (ASC-LIST-QUEUE-NAME)                          20916999
209170             INTO  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               20917099
209171             ITEM  (PV-BLOCK-NUMBER)                              20917199
209172             RESP  (PV-CICS-RESP)                                 20917299
209173     END-EXEC.                                                    20917399
209174                                                                  20917499
209175     IF  ((PV-CICS-RESP = DFHRESP (NORMAL))                       20917599
209176       OR (PV-CICS-RESP = DFHRESP (ITEMERR)))                     20917699
209177         CONTINUE                                                 20917799
209178     ELSE                                                         20917899
209179         SET DP013-CICS-ABEND     TO TRUE                         20917999
209180         SET DP013-NO-ROLLBACK    TO TRUE                         20918099
209181         MOVE '4410-READ-TEMP-STORAGE' TO DP013-PARAGRAPH         20918199
209182         MOVE 'ERROR TRYING TO READ FROM TEMP STORAGE QUEUE'      20918299
209183                                  TO DP013-MESSAGE-TEXT(1)        20918399
209184         PERFORM DP013-0000-PROCESS-ABEND                         20918499
209185     END-IF.                                                      20918599
209186                                                                  20918699
209187     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             20918799
209188*                                                                 20918899
209189     IF  PV-CICS-RESP = DFHRESP (ITEMERR)                         20918999
209190         INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               20919099
209191     END-IF.                                                      20919199
209192                                                                  20919299
209193*----------------------------------------------------------------*20919399
209194*    PROCESS THE ITEMS IN THE ARRAY AND MOVE THEM TO THE MAP.    *20919499
209195*----------------------------------------------------------------*20919599
209196 4420-FORMAT-LIST-LINES.                                          20919699
209197     IF  ASC-ITEM-AT-BOT-OF-PANEL > ASC-NUMBER-OF-ITEMS-READ      20919799
209198         SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                20919899
209199         MOVE DP015-ASK-DRK-OFF  TO MR-SELECTA (PV-SUB)           20919999
209200         MOVE DP015-HL-OFF       TO MR-SELECTH (PV-SUB)           20920099
209201         MOVE SPACES             TO MR-SELECTI      (PV-SUB)      20920199
209202                                    MR-APON         (PV-SUB)      20920299
209203                                    MR-ARCVR        (PV-SUB)      20920399
209204                                    MR-ALINE        (PV-SUB)      20920499
209205                                    MR-ACART        (PV-SUB)      20920599
209206                                    MR-ASETN        (PV-SUB)      20920699
209207                                    MR-ACSRC        (PV-SUB)      20920799
209208                                    MR-ATYPE        (PV-SUB)      20920899
209209                                    MR-ADIRC        (PV-SUB)      20920999
209210                                    MR-ALOCS        (PV-SUB)      20921099
209211                                    MR-ACDAT        (PV-SUB)      20921199
209212                                    MR-ACTIM        (PV-SUB)      20921299
209213                                    MR-ACASI        (PV-SUB)      20921399
209214         MOVE DP015-BLUE         TO MR-ADIRCC       (PV-SUB)      20921499
209215     ELSE                                                         20921599
209216         IF  ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      20921699
209217                                                   > SPACE        20921799
209218             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 20921899
209219                                          TO MR-SELECTI (PV-SUB)  20921999
209220         ELSE                                                     20922099
209221             MOVE ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      20922199
209222                                           TO MR-SELECTI (PV-SUB) 20922299
209223         END-IF                                                   20922399
209224                                                                  20922499
209225         IF  DP030-SET-CURSOR-TRAILER                             20922599
209226             IF  ((ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)20922699
209227                 > SPACE)                                         20922799
209228               OR (PV-SUB = 1))                                   20922899
209229                SET DP030-SET-CURSOR-APPL-1 TO TRUE               20922999
209230                MOVE -1          TO MR-SELECTL (PV-SUB)           20923099
209231             END-IF                                               20923199
209232         END-IF                                                   20923299
209233*>>>>>>>>                                                         20923399
209234*        MOVE ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)               20923499
209235*                                         TO MR-SELECT   (PV-SUB) 20923599
209236                                                                  20923699
209237         MOVE ASC-PO-NUMBER            (ASC-BLK-SUB ASC-ITEM-SUB) 20923799
209238                                          TO DK-PO-NUMBER-DROP    20923899
209239*CLP 09/25/2014                                                   20923999
209240         MOVE DK-PO-NUMBER-8                                      20924099
209241                                          TO MR-APON     (PV-SUB) 20924199
209242                                                                  20924299
209243         MOVE ASC-RCVR-NUMBER          (ASC-BLK-SUB ASC-ITEM-SUB) 20924399
209244                                        TO MR-ARCVR      (PV-SUB) 20924499
209245         IF   ASC-LINE-NO              (ASC-BLK-SUB ASC-ITEM-SUB) 20924599
209246                          = '0000'                                20924699
209247          AND ASC-PACK-ID              (ASC-BLK-SUB ASC-ITEM-SUB) 20924799
209248                          = '0000'                                20924899
209249             MOVE 'PBS '                  TO MR-ALINE    (PV-SUB) 20924999
209250         ELSE                                                     20925099
209251         IF   ASC-LINE-NO              (ASC-BLK-SUB ASC-ITEM-SUB) 20925199
209252                          = '0000'                                20925299
209253             MOVE ASC-PACK-ID          (ASC-BLK-SUB ASC-ITEM-SUB) 20925399
209254                                          TO MR-ALINE    (PV-SUB) 20925499
209255         ELSE                                                     20925599
209256         IF   ASC-PACK-ID              (ASC-BLK-SUB ASC-ITEM-SUB) 20925699
209257                          = '0000'                                20925799
209258             MOVE ASC-LINE-NO          (ASC-BLK-SUB ASC-ITEM-SUB) 20925899
209259                                          TO MR-ALINE    (PV-SUB) 20925999
209260         END-IF                                                   20926099
209261         END-IF                                                   20926199
209262         END-IF                                                   20926299
209263         MOVE ASC-CARTON-ID            (ASC-BLK-SUB ASC-ITEM-SUB) 20926399
209264                                        TO MR-ACART      (PV-SUB) 20926499
209265*                                                                 20926599
209266*CLP 01/27/14                                                     20926699
209267         PERFORM 4425-CHECK-AUDIT-COMBO                           20926799
209268         IF PS-HIGHLIGHT-CARTON                                   20926899
209269             MOVE DP015-YELLOW          TO MR-ACARTC    (PV-SUB)  20926999
209270         ELSE                                                     20927099
209271             MOVE DP015-BLUE            TO MR-ACARTC    (PV-SUB)  20927199
209272         END-IF                                                   20927299
209273                                                                  20927399
209274         MOVE ASC-SET-NAME             (ASC-BLK-SUB ASC-ITEM-SUB) 20927499
209275                                          TO MR-ASETN    (PV-SUB) 20927599
209276         MOVE ASC-CARTON-CREATE-SRCE   (ASC-BLK-SUB ASC-ITEM-SUB) 20927699
209277                                          TO MR-ACSRC    (PV-SUB) 20927799
209278         MOVE ASC-DIRECTIVE-TYPE       (ASC-BLK-SUB ASC-ITEM-SUB) 20927899
209279                                        TO MR-ATYPE      (PV-SUB) 20927999
209280         MOVE ASC-DIRECTIVE-REASON-CDE                            20928099
209281                                       (ASC-BLK-SUB ASC-ITEM-SUB) 20928199
209282                                        TO MR-ADIRC      (PV-SUB) 20928299
209283                                                                  20928399
209284         MOVE ASC-OPER-UNIT             TO DK-OPER-UNIT-ID        20928499
209285         MOVE ASC-LOC-SENT             (ASC-BLK-SUB ASC-ITEM-SUB) 20928599
209286                                        TO MR-ALOCS      (PV-SUB) 20928699
209287                                                                  20928799
209288         MOVE ASC-CRE-TMST             (ASC-BLK-SUB ASC-ITEM-SUB) 20928899
209289                                        TO PC-TIMESTAMP           20928999
209290         MOVE PC-TS-MM                  TO PC-MM                  20929099
209291         MOVE PC-TS-DD                  TO PC-DD                  20929199
209292         MOVE PC-MMDD                                             20929299
209293                                        TO MR-ACDAT      (PV-SUB) 20929399
209294                                                                  20929499
209295         MOVE '.'                       TO PC-TS-COL              20929599
209296         MOVE PC-TS-HH-COL-MN                                     20929699
209297                                        TO MR-ACTIM      (PV-SUB) 20929799
209298                                                                  20929899
209299*CT BEGIN 02/03/09 IR 18,394                                      20929999
209300         IF ASC-CRE-PGM-NM (ASC-BLK-SUB ASC-ITEM-SUB) = 'RESEND'  20930099
209301*CT END   02/03/09                                                20930199
209302             MOVE DP015-RED             TO MR-ACDATC     (PV-SUB) 20930299
209303         ELSE                                                     20930399
209304             MOVE DP015-BLUE            TO MR-ACDATC    (PV-SUB)  20930499
209305         END-IF                                                   20930599
209306                                                                  20930699
209307         MOVE ASC-CASI                 (ASC-BLK-SUB ASC-ITEM-SUB) 20930799
209308                                        TO MR-ACASI      (PV-SUB) 20930899
209309         IF ASC-LOCKED-OR-NOT          (ASC-BLK-SUB ASC-ITEM-SUB) 20930999
209310                                 = 'N'                            20931099
209311             MOVE DP015-YELLOW          TO MR-ADIRCC    (PV-SUB)  20931199
209312         ELSE                                                     20931299
209313             MOVE DP015-BLUE            TO MR-ADIRCC    (PV-SUB)  20931399
209314         END-IF                                                   20931499
209315                                                                  20931599
209316     END-IF.                                                      20931699
209317                                                                  20931799
209318     SUBTRACT +1 FROM ASC-ITEM-SUB                                20931899
209319                                                                  20931999
209320     IF  ASC-ITEM-SUB < + 1                                       20932099
209321         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  20932199
209322         MOVE +1                 TO ASC-BLK-SUB                   20932299
209323     END-IF.                                                      20932399
209324                                                                  20932499
209325***************************************************************** 20932599
209326* CHECK BY PO AND RECV IF THERE IS A QC AND RFID AUDIT            20932699
209327* IF SO HIGHLIGHT THE SML / P2L DEST # YELLOW                     20932799
209328***************************************************************** 20932899
209329 4425-CHECK-AUDIT-COMBO.                                          20932999
209330     INITIALIZE ASC-COUNT                                         20933099
209331                PS-AUDIT-COMBO-SW.                                20933199
209332                                                                  20933299
209333     MOVE ASC-AUDIT-NUMBER-N(ASC-BLK-SUB ASC-ITEM-SUB) TO         20933399
209334                                SUT00015-AUD-CNTL-NBR.            20933499
209335     EXEC SQL                                                     20933599
209336         SELECT AUD_CNTL_NBR                                      20933699
209337               ,AUD_STAT_CDE                                      20933799
209338               ,PKGNG_TYP_CDE                                     20933899
209339               ,PO_NBR                                            20933999
209340               ,RCVR_SEQ_NBR                                      20934099
209341               ,OPER_UNT_ID                                       20934199
209342          INTO :SUT00015-AUD-CNTL-NBR                             20934299
209343              ,:SUT00015-AUD-STAT-CDE                             20934399
209344              ,:SUT00015-PKGNG-TYP-CDE                            20934499
209345              ,:SUT00015-PO-NBR                                   20934599
209346              ,:SUT00015-RCVR-SEQ-NBR                             20934699
209347              ,:SUT00015-OPER-UNT-ID                              20934799
209348          FROM SUT_PO_AUD_REQ                                     20934899
209349          WHERE AUD_CNTL_NBR   = :SUT00015-AUD-CNTL-NBR           20934999
209350     END-EXEC.                                                    20935099
209351                                                                  20935199
209352     EVALUATE TRUE                                                20935299
209353         WHEN SQLCODE = ZERO                                      20935399
209354             CONTINUE                                             20935499
209355         WHEN SQLCODE = +100                                      20935599
209356             CONTINUE                                             20935699
209357         WHEN SQLWARN0 NOT = SPACES                               20935799
209358         WHEN SQLCODE < ZERO                                      20935899
209359         WHEN SQLCODE > ZERO                                      20935999
209360             MOVE '4425-CHECK-AUDIT-COMBO'                        20936099
209361                                         TO DP013-PARAGRAPH       20936199
209362             MOVE '1ST SELECT FROM SUT_PO_AUD_REQ'                20936299
209363                               TO DP013-MESSAGE-TEXT (1)          20936399
209364             MOVE SQLCA        TO DP013-SQLCA                     20936499
209365             MOVE 'SUT_PO_AUD_REQ    '                            20936599
209366                               TO DP013-DB2-TABLE-NAME (1)        20936699
209367             SET DP013-DB2-ABEND                                  20936799
209368                 DP013-XCTL-DISPLAY-RESTART TO TRUE               20936899
209369             PERFORM DP013-0000-PROCESS-ABEND                     20936999
209370     END-EVALUATE.                                                20937099
209371                                                                  20937199
209372     IF SUT00015-PKGNG-TYP-CDE = PC-RF                            20937299
209373         MOVE SUT00015-AUD-STAT-CDE TO PV-AUD-STAT-CDE            20937399
209374*        ITS RFID - CHECK IF QC AS WELL                           20937499
209375                                                                  20937599
209376         EXEC SQL                                                 20937699
209377           SELECT AUD_STAT_CDE                                    20937799
209378            INTO :SUT00015-AUD-STAT-CDE                           20937899
209379            FROM SUT_PO_AUD_REQ                                   20937999
209380            WHERE RWRK_AUD_CNTL_NBR = :SUT00015-AUD-CNTL-NBR      20938099
209381         END-EXEC                                                 20938199
209382                                                                  20938299
209383         EVALUATE TRUE                                            20938399
209384           WHEN SQLCODE = ZERO                                    20938499
209385              SET PS-COMBO-AUDIT TO TRUE                          20938599
209386*             ITS COMBO - CHECK IF FAILED                         20938699
209387           WHEN SQLCODE = +100                                    20938799
209388           WHEN SQLCODE = -811                                    20938899
209389               CONTINUE                                           20938999
209390           WHEN SQLWARN0 NOT = SPACES                             20939099
209391           WHEN SQLCODE < +0                                      20939199
209392           WHEN SQLCODE > ZERO                                    20939299
209393             MOVE '4425-CHECK-AUDIT-COMBO'                        20939399
209394                                         TO DP013-PARAGRAPH       20939499
209395             MOVE '2ND SELECT FROM SUT_PO_AUD_REQ'                20939599
209396                               TO DP013-MESSAGE-TEXT (1)          20939699
209397             MOVE SQLCA        TO DP013-SQLCA                     20939799
209398             MOVE 'SUT_PO_AUD_REQ    '                            20939899
209399                               TO DP013-DB2-TABLE-NAME (1)        20939999
209400             SET DP013-DB2-ABEND                                  20940099
209401                 DP013-XCTL-DISPLAY-RESTART TO TRUE               20940199
209402             PERFORM DP013-0000-PROCESS-ABEND                     20940299
209403     ELSE                                                         20940399
209404*        CHECK IF QC FAILED                                       20940499
209405         MOVE SUT00015-AUD-STAT-CDE TO PV-AUD-STAT-CDE            20940599
209406*        NOW GO CHECK IF THERE IS A RF THAT FAILED FOR SAME PO    20940699
209407         EXEC SQL                                                 20940799
209408            SELECT  A.AUD_STAT_CDE                                20940899
209409                INTO :SUT00015-AUD-STAT-CDE                       20940999
209410                FROM  SUT_PO_AUD_REQ A                            20941099
209411            WHERE A.PO_NBR        = :SUT00015-PO-NBR              20941199
209412              AND A.RCVR_SEQ_NBR  = :SUT00015-RCVR-SEQ-NBR        20941299
209413              AND A.OPER_UNT_ID   = :SUT00015-OPER-UNT-ID         20941399
209414              AND A.PO_PREPK_ID   < 0                             20941499
209415         END-EXEC                                                 20941599
209416                                                                  20941699
209417         EVALUATE TRUE                                            20941799
209418           WHEN SQLCODE = ZERO                                    20941899
209419              SET PS-COMBO-AUDIT TO TRUE                          20941999
209420           WHEN SQLCODE = +100                                    20942099
209421           WHEN SQLCODE = -811                                    20942199
209422               CONTINUE                                           20942299
209423           WHEN SQLWARN0 NOT = SPACES                             20942399
209424           WHEN SQLCODE < +0                                      20942499
209425           WHEN SQLCODE > ZERO                                    20942599
209426             MOVE '4425-CHECK-AUDIT-COMBO'                        20942699
209427                                         TO DP013-PARAGRAPH       20942799
209428             MOVE '3RD SELECT FROM SUT_PO_AUD_REQ'                20942899
209429                               TO DP013-MESSAGE-TEXT (1)          20942999
209430             MOVE SQLCA        TO DP013-SQLCA                     20943099
209431             MOVE 'SUT_PO_AUD_REQ    '                            20943199
209432                               TO DP013-DB2-TABLE-NAME (1)        20943299
209433             SET DP013-DB2-ABEND                                  20943399
209434                 DP013-XCTL-DISPLAY-RESTART TO TRUE               20943499
209435             PERFORM DP013-0000-PROCESS-ABEND                     20943599
209436                                                                  20943699
209437     END-EVALUATE.                                                20943799
209438                                                                  20943899
209439     SET PS-NOT-HIGHLIGHT-CARTON TO TRUE.                         20943999
209440     IF PS-COMBO-AUDIT                                            20944099
209441        IF PV-AUD-STAT-CDE       = PC-F AND                       20944199
209442           SUT00015-AUD-STAT-CDE = PC-F                           20944299
209443*          NEED TO HIGHLIGHT THE CARTON                           20944399
209444           SET PS-HIGHLIGHT-CARTON TO TRUE                        20944499
209445        END-IF                                                    20944599
209446     END-IF.                                                      20944699
209447                                                                  20944799
209448******************************************************************20944899
209449** IF A BEGINNING OF RANGE WAS SPECIFIED, MAKE SURE AN END OF   **20944999
209450** RANGE WAS SPECIFIED AND VICE-VERSA.  IF ONE IS MISSING,      **20945099
209451** ISSUE A WARNING.                                             **20945199
209452******************************************************************20945299
209453 4430-CHECK-FOR-BEGIN-AND-END.                                    20945399
209454     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       20945499
209455         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     20945599
209456*            -- NO END-OF-RANGE SPECFIED ---                      20945699
209457             MOVE PC-TSYMSG-00051  TO DP020-MSG-NUMBER            20945799
209458             SET DP020-MSG-WARNING TO TRUE                        20945899
209459             PERFORM 4431-POSITION-AT-WARNING                     20945999
209460         END-IF                                                   20946099
209461     ELSE                                                         20946199
209462         IF  ASC-END-OF-SELECTED-RANGE > ZERO                     20946299
209463*            -- NO BEGINNING-OF-RANGE SPECFIED ---                20946399
209464             MOVE PC-TSYMSG-00053  TO DP020-MSG-NUMBER            20946499
209465             SET DP020-MSG-WARNING TO TRUE                        20946599
209466             PERFORM 4431-POSITION-AT-WARNING                     20946699
209467         END-IF                                                   20946799
209468     END-IF.                                                      20946899
209469                                                                  20946999
209470******************************************************************20947099
209471** ONCE IT HAS BEEN DETERMINED THAT A WARNING IS TO BE ISSUED,  **20947199
209472** DETERMINE IF EITHER THE BEGINNING OF RANGE OR END OF RANGE   **20947299
209473** IS ON THE CURRENT SCREEN.  IF IT IS, HIGHLIGHT IT AND        **20947399
209474** POSITION THE CURSOR THERE.                                   **20947499
209475******************************************************************20947599
209476 4431-POSITION-AT-WARNING.                                        20947699
209477     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 20947799
209478                    - PV-TOP-ITEM + 1.                            20947899
209479     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      20947999
209480         CONTINUE                                                 20948099
209481     ELSE                                                         20948199
209482         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      20948299
209483         MOVE -1                     TO MR-SELECTL (PV-SUB)       20948399
209484         MOVE DP015-REVERSE          TO MR-SELECTH (PV-SUB)       20948499
209485         MOVE DP015-GREEN            TO MR-SELECTC (PV-SUB)       20948599
209486     END-IF.                                                      20948699
209487                                                                  20948799
209488     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   20948899
209489                    - PV-TOP-ITEM + 1.                            20948999
209490     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      20949099
209491         CONTINUE                                                 20949199
209492     ELSE                                                         20949299
209493         SET DP030-SET-CURSOR-APPL-1                              20949399
209494                                   TO TRUE                        20949499
209495         MOVE -1                   TO MR-SELECTL (PV-SUB)         20949599
209496         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         20949699
209497         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         20949799
209498     END-IF.                                                      20949899
209499                                                                  20949999
209500*----------------------------------------------------------------*20950099
209501* PREPARE THE SELECTED ITEMS TEMP STORAGE QUEUE.  MOVE ALL SEL-  *20950199
209502* ECTED ITEMS FROM THE LIST TEMP STORAGE QUEUE TO THE LAYOUT     *20950299
209503* FOR THE SELECTED ITEMS QUEUE.                                  *20950399
209504*                                                                *20950499
209505* FIRST, DELETE THE SELECTION QUEUE, NEXT LOAD THE SELECTION     *20950599
209506* QUEUE RECORD.  FINALLY, WRITE THE SELECTION QUEUE ITEM WHEN    *20950699
209507* THE ARRAY IS FULL.                                             *20950799
209508*----------------------------------------------------------------*20950899
209509 5000-PREPARE-SEL-QUEUE.                                          20950999
209510     MOVE +1                   TO  ASC-BLK-SUB.                   20951099
209511     PERFORM 5100-WRITE-TEMP-STORAGE.                             20951199
209512     ADD +1                    TO  ASC-BLK-SUB.                   20951299
209513     PERFORM 5100-WRITE-TEMP-STORAGE.                             20951399
209514                                                                  20951499
209515     MOVE ASC-SEL-QUEUE-NAME   TO  SU101-SEL-QUEUE-NAME.          20951599
209516     PERFORM 6010-DELETE-SEL-QUEUE.                               20951699
209517                                                                  20951799
209518     SET ASC-UPDATE-TSQ        TO  TRUE.                          20951899
209519                                                                  20951999
209520     SET SU102-IDX             TO  1.                             20952099
209521     MOVE ZERO                 TO SU101-NUMBER-OF-TS-ITEMS.       20952199
209522     INITIALIZE SU102-SELECTED-ITEM-ARRAY.                        20952299
209523                                                                  20952399
209524     PERFORM 5200-FILL-SEL-QUEUE-RECORD                           20952499
209525             VARYING PV-ITEM                                      20952599
209526             FROM 1 BY 1                                          20952699
209530             UNTIL PV-ITEM GREATER ASC-HIGHEST-BLOCK-WRITTEN.     20953099
209600                                                                  20960099
209700     IF  SU102-IDX > 1                                            20970099
209800         PERFORM 5205-WRITE-SEL-QUEUE                             20980099
209900         ADD +1                TO SU101-NUMBER-OF-TS-ITEMS        20990099
210000     END-IF.                                                      21000099
210100                                                                  21010099
210200*----------------------------------------------------------------*21020099
210300*    WRITE A NEW BLOCK FROM THE ARRAY TO TEMPORARY STORAGE.      *21030099
210400*    REWRITE AN EXISITING BLOCK ONLY IF IT HAS BEEN MODIFIED.    *21040099
210500*----------------------------------------------------------------*21050099
210600 5100-WRITE-TEMP-STORAGE.                                         21060099
210700     MOVE ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1)                     21070099
210800                                   TO PV-LIST-ITEM-NUMBER.        21080099
210900     COMPUTE PV-BLOCK-NUMBER =                                    21090099
211000         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    21100099
211100                                                                  21110099
211200     IF (PV-BLOCK-NUMBER < ASC-HIGHEST-BLOCK-WRITTEN)             21120099
211300     OR (PV-BLOCK-NUMBER = ASC-HIGHEST-BLOCK-WRITTEN)             21130099
211400         IF  ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                      21140099
211500             PERFORM 5105-REWRITE-ASC-LISTQ                       21150099
211600         END-IF                                                   21160099
211700     ELSE                                                         21170099
211800         COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                       21180099
211900         ASC-HIGHEST-BLOCK-WRITTEN + 1                            21190099
212000         PERFORM 5110-WRITE-ASC-LISTQ                             21200099
212100         ADD +1                    TO ASC-HIGHEST-BLOCK-WRITTEN   21210099
212200     END-IF.                                                      21220099
212300                                                                  21230099
212400     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             21240099
212500                                                                  21250099
212600******************************************************************21260099
212700** REWRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-    **21270099
212800** SPECIFIC COMMAREA.                                           **21280099
212900******************************************************************21290099
213000 5105-REWRITE-ASC-LISTQ.                                          21300099
213100     EXEC CICS                                                    21310099
213200         WRITEQ TS                                                21320099
213300             QUEUE (ASC-LIST-QUEUE-NAME)                          21330099
213400             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               21340099
213500             ITEM  (PV-BLOCK-NUMBER)                              21350099
213600             REWRITE                                              21360099
213700             RESP  (PV-CICS-RESP)                                 21370099
213800     END-EXEC.                                                    21380099
213900                                                                  21390099
214000     IF  PV-CICS-RESP = DFHRESP(NORMAL)                           21400099
214100         CONTINUE                                                 21410099
214200     ELSE                                                         21420099
214300         SET DP013-CICS-ABEND            TO TRUE                  21430099
214400         SET DP013-NO-ROLLBACK           TO TRUE                  21440099
214500         MOVE '5105-REWRITE-ASC-LISTQ'   TO DP013-PARAGRAPH       21450099
214600         MOVE 'ATTEMPTING TO REWRITE LIST TEMP STORAGE QUEUE'     21460099
214700                                     TO DP013-MESSAGE-TEXT(1)     21470099
214800         PERFORM DP013-0000-PROCESS-ABEND                         21480099
214910     END-IF.                                                      21491099
215000                                                                  21500099
215100******************************************************************21510099
215200** WRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-      **21520099
215300** SPECIFIC COMMAREA.                                           **21530099
215400******************************************************************21540099
215500 5110-WRITE-ASC-LISTQ.                                            21550099
215600     EXEC CICS                                                    21560099
215700         WRITEQ TS                                                21570099
215800             QUEUE (ASC-LIST-QUEUE-NAME)                          21580099
215900             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               21590099
216000             ITEM  (PV-BLOCK-NUMBER)                              21600099
216100             RESP  (PV-CICS-RESP)                                 21610099
216200     END-EXEC.                                                    21620099
216300     IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      21630099
216400         SET DP013-CICS-ABEND      TO TRUE                        21640099
216500         SET DP013-NO-ROLLBACK     TO TRUE                        21650099
216600         MOVE '5110-WRITE-ASC-LISTQ'                              21660099
216700                                   TO DP013-PARAGRAPH             21670099
216800         MOVE 'ATTEMPTING TO DELETE TEMP STORAGE QUEUE'           21680099
216900                                   TO DP013-MESSAGE-TEXT(1)       21690099
217000         PERFORM DP013-0000-PROCESS-ABEND                         21700099
217100     END-IF.                                                      21710099
217200                                                                  21720099
217300*----------------------------------------------------------------*21730099
217400* READ A LIST QUEUE RECORD AND MOVE THE KEYS OF SELECTED OBJECTS *21740099
217500* TO THE SELECTED ITEMS TEMP STORAGE QUEUE RECORD.               *21750099
217600*----------------------------------------------------------------*21760099
217700 5200-FILL-SEL-QUEUE-RECORD.                                      21770099
217800     PERFORM 6112-READ-LIST-QUEUE.                                21780099
217900                                                                  21790099
218000     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       21800099
218100         PERFORM VARYING LQW-IDX                                  21810099
218200         FROM 1 BY 1                                              21820099
218300         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            21830099
218400           OR  LQW-LIST-ITEM-NUMBER(LQW-IDX) = ZERO               21840099
218500                                                                  21850099
218600           IF LQW-SELECT (LQW-IDX)                                21860099
218700                 MOVE LQW-LIST-ITEM-NUMBER(LQW-IDX) TO            21870099
218800                                            SU102-ITEM (SU102-IDX)21880099
218900*                MOVE LQW-ACTION      (LQW-IDX)                   21890099
219000                 MOVE PC-INQ                                      21900099
219100                                  TO SU102-ACTION-SW   (SU102-IDX)21910099
219200                 MOVE LQW-LOCKED-OR-NOT (LQW-IDX)                 21920099
219300                                TO SU102-LOCKED-OR-NOT (SU102-IDX)21930099
219400                 MOVE LQW-PO-NUMBER   (LQW-IDX)                   21940099
219500                                  TO SU102-PO-NUMBER   (SU102-IDX)21950099
219600                 MOVE LQW-RECEIVER-NO (LQW-IDX)                   21960099
219700                                  TO SU102-RCVR        (SU102-IDX)21970099
219701                 MOVE LQW-LINE-PACK   (LQW-IDX)                   21970199
219702                                  TO SU102-LINE-PACK   (SU102-IDX)21970299
219703                 MOVE LQW-CARTON-ID   (LQW-IDX)                   21970399
219704                                  TO SU102-CARTON-ID   (SU102-IDX)21970499
219705                 MOVE LQW-SET-NAME    (LQW-IDX)                   21970599
219706                                  TO SU102-SET-NAME    (SU102-IDX)21970699
219707                 MOVE LQW-SET-YEAR    (LQW-IDX)                   21970799
219708                                  TO SU102-SET-YEAR    (SU102-IDX)21970899
219709                 MOVE LQW-CRE-SRC     (LQW-IDX)                   21970999
219710                                  TO SU102-CTN-CRE-SRC (SU102-IDX)21971099
219711                 MOVE LQW-DIR-TYPE    (LQW-IDX)                   21971199
219712                                  TO SU102-TYPE        (SU102-IDX)21971299
219713                 MOVE LQW-DIRECTIVE-REASON-CDE (LQW-IDX)          21971399
219714                                  TO SU102-DIR-CODE    (SU102-IDX)21971499
219715                 MOVE LQW-LOC-SENT    (LQW-IDX)                   21971599
219716                                  TO SU102-LOC-SENT    (SU102-IDX)21971699
219717                 MOVE LQW-CREATE-DATE (LQW-IDX)                   21971799
219718                                  TO SU102-CREATE-DATE (SU102-IDX)21971899
219719                 MOVE LQW-CREATE-TIME (LQW-IDX)                   21971999
219720                                  TO SU102-CREATE-TIME (SU102-IDX)21972099
219721                 MOVE LQW-CASI        (LQW-IDX)                   21972199
219722                                  TO SU102-CASI        (SU102-IDX)21972299
219723                                                                  21972399
219724                 SET SU102-IDX UP BY 1                            21972499
219725                 IF  SU102-IDX > SU102-MAX-ITEMS                  21972599
219726                     PERFORM 5201-END                             21972699
219727*                    SET SU102-IDX TO  1                          21972799
219728*                    PERFORM 5205-WRITE-SEL-QUEUE                 21972899
219729*                    ADD +1        TO SU101-NUMBER-OF-TS-ITEMS    21972999
219730*                    INITIALIZE SU102-SELECTED-ITEM-ARRAY         21973099
219731                 END-IF                                           21973199
219740           END-IF                                                 21974099
219750         END-PERFORM                                              21975099
219760     END-IF.                                                      21976099
219770                                                                  21977099
219771*----------------------------------------------------------------*21977199
219772*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE.                *21977299
219773*----------------------------------------------------------------*21977399
219774 5201-END.                                                        21977499
219776                     PERFORM 5205-WRITE-SEL-QUEUE                 21977699
219777                     ADD +1        TO SU101-NUMBER-OF-TS-ITEMS    21977799
219778                     INITIALIZE SU102-SELECTED-ITEM-ARRAY         21977899
219779                     SET SU102-IDX TO  1.                         21977999
219780*----------------------------------------------------------------*21978099
219790*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE.                *21979099
219800*----------------------------------------------------------------*21980099
219900 5205-WRITE-SEL-QUEUE.                                            21990099
220000     MOVE ASC-NUMBER-OF-SELECTED-ITEMS TO SU102-SELECTED-ITEMS.   22000099
220100                                                                  22010099
220200     EXEC CICS                                                    22020099
220300          WRITEQ TS                                               22030099
220400              QUEUE (ASC-SEL-QUEUE-NAME)                          22040099
220500              FROM  (SU102-SELECT-RECORD)                         22050099
220600              ITEM  (PV-SEL-QUEUE-ITEM)                           22060099
220700              RESP  (PV-CICS-RESP)                                22070099
220800     END-EXEC.                                                    22080099
220900                                                                  22090099
221000     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          22100099
221100         CONTINUE                                                 22110099
221200     ELSE                                                         22120099
221300         SET DP013-CICS-ABEND      TO TRUE                        22130099
221400         SET DP013-NO-ROLLBACK     TO TRUE                        22140099
221500         MOVE '5205-WRITE-SEL-QUEUE'                              22150099
221600                                   TO DP013-PARAGRAPH             22160099
221700         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          22170099
221800                                   TO DP013-MESSAGE-TEXT(1)       22180099
221900         PERFORM DP013-0000-PROCESS-ABEND                         22190099
222000     END-IF.                                                      22200099
222100                                                                  22210099
222200******************************************************************22220099
222300** WHEN RETURNING TO THIS TRANSACTION FROM ANOTHER TRANSACTION, **22230099
222400** SETUP THE ARRAY AS IT WAS WHEN WE HAD LEFT PREVIOUSLY.  EDIT **22240099
222500** THE SELECTIONS MADE AT THAT TIME AND DISPLAY THE PANEL TO    **22250099
222600** THE USER.                                                    **22260099
222700******************************************************************22270099
222800 6000-REFRESH-PANEL-FROM-TEMP.                                    22280099
222900     IF  ASC-UPDATE-TSQ                                           22290099
223000         SET ASC-NO-TSQ-UPDATE TO TRUE                            22300099
223100         MOVE ZERO                 TO PV-SAVE-ITEM                22310099
223200                                      PV-SEL-QUEUE-ITEM           22320099
223300         MOVE ASC-NUMBER-OF-SELECTED-ITEMS                        22330099
223400                                   TO PV-HOLD-SELECTED-ITEMS      22340099
223500         MOVE +1                   TO PV-ITEMS-PROCESSED          22350099
223600         PERFORM 6100-UPDATE-TSQ                                  22360099
223700             UNTIL PV-ITEMS-PROCESSED >                           22370099
223800                                     PV-HOLD-SELECTED-ITEMS       22380099
223900         INITIALIZE ASC-BLOCK-ENTRIES (1)                         22390099
224000                    ASC-BLOCK-ENTRIES (2)                         22400099
224100     END-IF.                                                      22410099
224200                                                                  22420099
224300*----------------------------------------------------------------*22430099
224400*    DELETE THE SELECTED ITEMS TEMP STORAGE QUEUE.               *22440099
224500*----------------------------------------------------------------*22450099
224600 6010-DELETE-SEL-QUEUE.                                           22460099
224700                                                                  22470099
224800     EXEC CICS                                                    22480099
224900         DELETEQ TS                                               22490099
225000             QUEUE (ASC-SEL-QUEUE-NAME)                           22500099
225100             RESP  (PV-CICS-RESP)                                 22510099
225200     END-EXEC.                                                    22520099
225300*                                                                 22530099
225400     IF ((PV-CICS-RESP = DFHRESP(NORMAL)) OR                      22540099
225500        (PV-CICS-RESP = DFHRESP(QIDERR)))                         22550099
225600         CONTINUE                                                 22560099
225700     ELSE                                                         22570099
225800         SET DP013-CICS-ABEND TO TRUE                             22580099
225900         SET DP013-NO-ROLLBACK TO TRUE                            22590099
226000         MOVE '6010-DELETE-SEL-QUEUE' TO DP013-PARAGRAPH          22600099
226100         MOVE 'ERROR TRYING TO DELETE SELECTION TS QUEUE'         22610099
226200                                        TO DP013-MESSAGE-TEXT (1) 22620099
226300         PERFORM DP013-0000-PROCESS-ABEND                         22630099
226400     END-IF.                                                      22640099
226500                                                                  22650099
226600*----------------------------------------------------------------*22660099
226700*    INCREMENT THE TSQ ITEM NUMBER AND READ THE LIST QUEUE.      *22670099
226800*    LOOP THROUGH THE LIST QUEUE TO OBTAIN THE LINE ITEM NUMBER  *22680099
226900*    TO BE USED TO UPDATE (DESELECT) THE CORRECT LINE ITEM IN    *22690099
227000*    THE TEMP QUEUE.                                             *22700099
227100*----------------------------------------------------------------*22710099
227200 6100-UPDATE-TSQ.                                                 22720099
227300                                                                  22730099
227400     ADD 1    TO  PV-SEL-QUEUE-ITEM.                              22740099
227500     PERFORM 6105-READ-SEL-QUEUE.                                 22750099
227600     PERFORM                                                      22760099
227700         VARYING SU102-IDX FROM 1 BY 1                            22770099
227800         UNTIL ((PV-ITEMS-PROCESSED > PV-HOLD-SELECTED-ITEMS)     22780099
227900         OR (SU102-IDX GREATER THAN SU102-MAX-ITEMS))             22790099
228000         IF  SU102-ACTION-SW (SU102-IDX) > SPACE                  22800099
228100             PERFORM 6110-PROCESS-ITEMS                           22810099
228200         END-IF                                                   22820099
228300         ADD +1                TO PV-ITEMS-PROCESSED              22830099
228400     END-PERFORM.                                                 22840099
228500     PERFORM 6111-WRITE-LIST-QUEUE.                               22850099
228600                                                                  22860099
228700*----------------------------------------------------------------*22870099
228800*    READ THE LIST QUEUE RECORD.                                 *22880099
228900*----------------------------------------------------------------*22890099
229000 6105-READ-SEL-QUEUE.                                             22900099
229100                                                                  22910099
229200     EXEC CICS                                                    22920099
229300          READQ TS                                                22930099
229400              QUEUE (ASC-SEL-QUEUE-NAME)                          22940099
229500              INTO  (SU102-SELECT-RECORD)                         22950099
229600              ITEM  (PV-SEL-QUEUE-ITEM)                           22960099
229700              RESP  (PV-CICS-RESP)                                22970099
229800     END-EXEC.                                                    22980099
229900*                                                                 22990099
230000     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          23000099
230100         CONTINUE                                                 23010099
230200     ELSE                                                         23020099
230300         SET DP013-CICS-ABEND      TO  TRUE                       23030099
230400         SET DP013-NO-ROLLBACK     TO  TRUE                       23040099
230500         MOVE '6105-READ-SEL-QUEUE'                               23050099
230600                                   TO  DP013-PARAGRAPH            23060099
230700         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           23070099
230800                                   TO  DP013-MESSAGE-TEXT(1)      23080099
230900         PERFORM DP013-0000-PROCESS-ABEND                         23090099
231000     END-IF.                                                      23100099
231100                                                                  23110099
231200*----------------------------------------------------------------*23120099
231300*    CALCULATE THE TEMP QUEUE ITEM THAT MUST BE READ AND READ IT.*23130099
231400*    REWRITE THE CURRENT TEMP QUEUE ITEM IF NECESSARY.  CALCULATE*23140099
231500*    THE LINE ITEM OCCURENCE AND UPDATE (DESELECT) IT.           *23150099
231600*----------------------------------------------------------------*23160099
231700 6110-PROCESS-ITEMS.                                              23170099
231800                                                                  23180099
231900     COMPUTE PV-ITEM = 1 + ((SU102-ITEM (SU102-IDX) - 1)          23190099
232000                     / PC-ITEMS-PER-PANEL).                       23200099
232100                                                                  23210099
232200     IF  PV-ITEM NOT EQUAL PV-SAVE-ITEM                           23220099
232300         IF  PV-SAVE-ITEM NOT EQUAL ZERO                          23230099
232400             PERFORM 6111-WRITE-LIST-QUEUE                        23240099
232500         END-IF                                                   23250099
232600         MOVE PV-ITEM          TO PV-SAVE-ITEM                    23260099
232700                                                                  23270099
232800         PERFORM 6112-READ-LIST-QUEUE                             23280099
232900         IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)               23290099
233000             CONTINUE                                             23300099
233100         END-IF                                                   23310099
233200     END-IF.                                                      23320099
233300                                                                  23330099
233400     COMPUTE PV-SUB = (SU102-ITEM (SU102-IDX)                     23340099
233500                    - LQW-LIST-ITEM-NUMBER (1)) + 1.              23350099
233600     SET LQW-DESELECT (PV-SUB) TO    TRUE                         23360099
233700     MOVE LQW-SELECTED-SW (PV-SUB)                                23370099
233800                               TO LQW-TEMP-SELECTED-SW (PV-SUB).  23380099
233900     EVALUATE TRUE                                                23390099
234000         WHEN SU102-INQ (SU102-IDX)                               23400099
234100              MOVE PC-INQ      TO LQW-ACTION (PV-SUB)             23410099
234200                                                                  23420099
234300         WHEN SU102-UPD (SU102-IDX)                               23430099
234400              MOVE PC-INQ      TO LQW-ACTION (PV-SUB)             23440099
234500              MOVE SU102-PO-NUMBER                     (SU102-IDX)23450099
234600                               TO LQW-PO-NUMBER          (LQW-IDX)23460099
234700              MOVE SU102-RCVR                          (SU102-IDX)23470099
234800                               TO LQW-RECEIVER-NO        (LQW-IDX)23480099
234900              MOVE SU102-LINE-PACK                     (SU102-IDX)23490099
235000                               TO LQW-LINE-PACK          (LQW-IDX)23500099
235100              MOVE SU102-CARTON-ID                     (SU102-IDX)23510099
235200                               TO LQW-CARTON-ID          (LQW-IDX)23520099
235300              MOVE SU102-SET-NAME                      (SU102-IDX)23530099
235400                               TO LQW-SET-NAME           (LQW-IDX)23540099
235500              MOVE SU102-SET-YEAR                      (SU102-IDX)23550099
235600                               TO LQW-SET-YEAR           (LQW-IDX)23560099
235700              MOVE SU102-CTN-CRE-SRC                   (SU102-IDX)23570099
235800                               TO LQW-CRE-SRC            (LQW-IDX)23580099
235900              MOVE SU102-TYPE                          (SU102-IDX)23590099
236000                               TO LQW-DIR-TYPE           (LQW-IDX)23600099
236100              MOVE SU102-DIR-CODE                      (SU102-IDX)23610099
236200                             TO LQW-DIRECTIVE-REASON-CDE (LQW-IDX)23620099
236300              MOVE SU102-LOC-SENT                      (SU102-IDX)23630099
236400                               TO LQW-LOC-SENT           (LQW-IDX)23640099
236500              MOVE SU102-CREATE-DATE                   (SU102-IDX)23650099
236600                               TO LQW-CREATE-DATE        (LQW-IDX)23660099
236700              MOVE SU102-CREATE-TIME                   (SU102-IDX)23670099
236800                               TO LQW-CREATE-TIME        (LQW-IDX)23680099
236900              MOVE SU102-CASI                          (SU102-IDX)23690099
237000                               TO LQW-CASI               (LQW-IDX)23700099
237100                                                                  23710099
237200         WHEN SU102-ERR (SU102-IDX)                               23720099
237300              MOVE PC-ERR      TO LQW-ACTION (PV-SUB)             23730099
237400                                                                  23740099
237500         WHEN OTHER                                               23750099
237600              MOVE PC-INQ      TO LQW-ACTION (PV-SUB)             23760099
237700                                                                  23770099
237800     END-EVALUATE.                                                23780099
237900                                                                  23790099
238000     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                23800099
238100                                                                  23810099
238200*----------------------------------------------------------------*23820099
238300*    WRITE THE TS QUEUE RECORD JUST UPDATED IN C600.             *23830099
238400*----------------------------------------------------------------*23840099
238500 6111-WRITE-LIST-QUEUE.                                           23850099
238600                                                                  23860099
238700     EXEC CICS                                                    23870099
238800         WRITEQ TS                                                23880099
238900             QUEUE (ASC-LIST-QUEUE-NAME)                          23890099
239000             FROM  (LQW-LIST-QUEUE-WORK-AREA)                     23900099
239100             ITEM  (PV-SAVE-ITEM)                                 23910099
239200             REWRITE                                              23920099
239300             RESP  (PV-CICS-RESP)                                 23930099
239400     END-EXEC.                                                    23940099
239500*                                                                 23950099
239600     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          23960099
239700         CONTINUE                                                 23970099
239800     ELSE                                                         23980099
239900         SET DP013-CICS-ABEND  TO  TRUE                           23990099
240000         SET DP013-NO-ROLLBACK TO  TRUE                           24000099
240100         MOVE '6111-WRITE-LIST-QUEUE' TO  DP013-PARAGRAPH         24010099
240200         MOVE 'ATTEMPTING TO REWRITE LIST QUEUE'                  24020099
240300                               TO  DP013-MESSAGE-TEXT(1)          24030099
240400         PERFORM DP013-0000-PROCESS-ABEND                         24040099
240500     END-IF.                                                      24050099
240600                                                                  24060099
240700*----------------------------------------------------------------*24070099
240800*    READ THE TEMPORARY STORAGE QUEUE INTO A TEMPORARY WORK AREA.*24080099
240900*----------------------------------------------------------------*24090099
241000 6112-READ-LIST-QUEUE.                                            24100099
241100     EXEC CICS                                                    24110099
241200         READQ TS                                                 24120099
241300             QUEUE (ASC-LIST-QUEUE-NAME)                          24130099
241400             INTO  (LQW-LIST-QUEUE-WORK-AREA)                     24140099
241500             ITEM  (PV-ITEM)                                      24150099
241600             RESP  (PV-CICS-RESP)                                 24160099
241700     END-EXEC.                                                    24170099
241800*                                                                 24180099
241900     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          24190099
242000         CONTINUE                                                 24200099
242100     ELSE                                                         24210099
242200         SET DP013-CICS-ABEND        TO TRUE                      24220099
242300         SET DP013-NO-ROLLBACK       TO TRUE                      24230099
242400         MOVE '6112-READ-LIST-QUEUE' TO DP013-PARAGRAPH           24240099
242500         MOVE 'ATTEMPTING TO READQ LIST QUEUE'                    24250099
242600                                     TO DP013-MESSAGE-TEXT(1)     24260099
242700         PERFORM DP013-0000-PROCESS-ABEND                         24270099
242800     END-IF.                                                      24280099
242900*----------------------------------------------------------------*24290099
243000* READ AN ITEM FROM THE SELECTED ITEMS TEMP STORAGE QUEUE.       *24300099
243100*----------------------------------------------------------------*24310099
243200 9100-READ-SEL-QUEUE.                                             24320099
243300     EXEC CICS                                                    24330099
243400         READQ TS                                                 24340099
243500             QUEUE (ASC-SEL-QUEUE-NAME)                           24350099
243600             INTO  (SU102-SELECT-RECORD)                          24360099
243700             ITEM  (ASC-SEL-ITEM)                                 24370099
243800             RESP  (PV-CICS-RESPONSE)                             24380099
243900     END-EXEC.                                                    24390099
244000                                                                  24400099
244100     IF  PV-CICS-RESPONSE = DFHRESP(NORMAL)                       24410099
244200         CONTINUE                                                 24420099
244300     ELSE                                                         24430099
244310         SET DP013-LOGIC-ABEND                                    24431099
244320             DP013-NO-ROLLBACK     TO TRUE                        24432099
244330         MOVE '9100-READ-SEL-QUEUE' TO DP013-PARAGRAPH            24433099
244340         MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   24434099
244350                                   TO DP013-MESSAGE-TEXT (1)      24435099
244360         PERFORM DP013-0000-PROCESS-ABEND                         24436099
244370     END-IF.                                                      24437099
244380                                                                  24438099
244390*----------------------------------------------------------------*24439099
244400* UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE.       *24440099
244401*----------------------------------------------------------------*24440199
244402 9200-REWRITE-SEL-QUEUE.                                          24440299
244403     EXEC CICS                                                    24440399
244404          WRITEQ TS                                               24440499
244405              QUEUE  (ASC-SEL-QUEUE-NAME)                         24440599
244406              FROM   (SU102-SELECT-RECORD)                        24440699
244407              ITEM   (ASC-SEL-ITEM)                               24440799
244408              RESP   (PV-CICS-RESPONSE)                           24440899
244409              REWRITE                                             24440999
244410     END-EXEC.                                                    24441099
244420                                                                  24442099
244430     IF  PV-CICS-RESPONSE NOT = DFHRESP(NORMAL)                   24443099
244440         SET DP013-CICS-ABEND                                     24444099
244450             DP013-NO-ROLLBACK     TO TRUE                        24445099
244460         MOVE '9200-REWRITE-SEL-QUEUE'  TO DP013-PARAGRAPH        24446099
244470         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   24447099
244480                                   TO DP013-MESSAGE-TEXT (1)      24448099
244490         PERFORM DP013-0000-PROCESS-ABEND                         24449099
244491     END-IF.                                                      24449199
244492*----------------------------------------------------------------*24449299
244493*    ABEND PROCESSOR MODULE                                      *24449399
244494*----------------------------------------------------------------*24449499
244495     COPY DPPD013.                                                24449599
244496                                                                  24449699
