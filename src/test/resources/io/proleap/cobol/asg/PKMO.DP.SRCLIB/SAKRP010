000100***************************************************************** 00010042
000200 IDENTIFICATION DIVISION.                                         00020042
000300***************************************************************** 00030042
000400                                                                  00040042
000500 PROGRAM-ID.             SAKRP010.                                00050042
000600 AUTHOR.                 CRAIG VOSKUIL - STRATAGEM.               00060042
000700 INSTALLATION.           KOHLS.                                   00070042
000800 DATE-WRITTEN            MARCH 1999.                              00080042
000900 DATE-COMPILED.                                                   00090042
001000                                                                  00100042
001100***************************************************************** 00110042
001200* * * *>>>   THIS PROGRAM MUST BE COMPILED COBOL/390   <<<* * * * 00120042
001300***************************************************************** 00130042
001400*                                                                 00140042
001500*  THIS PROGRAM WILL CREATE A WEEKLY CASH SALES SUMMARY REPORT.   00150042
001600*                                                                 00160042
001700*   INPUT: INP01 - CONTAINS POS DATE, WHICH IS USED AS THE        00170042
001800*                  PROCESS DATE TO CREATE THE REPORT.             00180042
001900*  OUTPUT: RPT01 - REPORT SHOWING WEEKLY SUMMARY OF CASH SALES    00190042
002000*                  BY STORE.                                      00200042
002100*                                                                 00210042
002200***************************************************************** 00220042
002300*                                                                 00230042
002400*  THE PROGRAM READS A CONTROL CARD FILE TO GET THE POS DATE.     00240042
002500*                                                                 00250042
002600*  THIS DATE IS PASSED TO THE KOHLS CALENDAR ROUTINE.  THE DATE   00260042
002700*  IS VALIDATED AND RETURNED IN DB2 DATE FORMAT.  ALSO, THE DATES 00270042
002800*  OF THE FIRST AND LAST DAYS OF THE WEEK ARE RETURNED. THESE TWO 00280042
002900*  DAYS WILL BE USED IN THE CURSOR FOR THE TSAADSU TABLE.         00290042
003000*                                                                 00300042
003100*  THE TSAADPC AND TSAADDP TABLES WILL ALSO BE PROCESSED TO GET   00310042
003200*  DOLLAR AMOUNTS FOR REPORTING AND CALCULATING ENDING BALANCES.  00320042
003300*                                                                 00330042
003400***************************************************************** 00340042
003500*                                                                 00350042
003600*  CHANGED 08/05/99 BY PAT DOYLE                                  00360042
003700*       MOVED PARENTHESES AROUND (OVER) INSTEAD OF (SHORT) ON     00370042
003800*       REGISTER AND SAFE OVER/SHORT.  ALSO CHANGED REGISTER      00380042
003900*       OVER/SHORT TO KEEP THE SAME SIGN.  BEFORE, THE SIGN       00390042
004000*       WAS BEING FLIPPED ON THIS ONE.                            00400042
004100*                                                                 00410042
004200*  CHANGED 08/06/99 BY PAT DOYLE                                  00420042
004300*       CHANGED PROGRAM TO DISPLAY ADJUSTED AMOUNTS INSTEAD OF    00430042
004400*       ORIGINAL AMOUNTS.                                         00440042
004500*                                                                 00450042
004600*  CHANGED 08/26/99 BY PAT DOYLE                                  00460042
004700*       CHANGED PROGRAM TO BE ABLE TO USE POS DATE CARD.          00470042
004800*       IT WILL BE ABLE TO USE EITHER THE POS DATE CARD OR        00480042
004900*       THE ISO DATE FORMAT, BECAUSE IT WILL BE RUN IN BOTH       00490042
005000*       JOB SAK131 AND JOB SAK110.                                00500042
005100*                                                                 00510042
005200*  CHANGED 10/22/99 BY LIHUA LIANG                                00520042
005300*       REMOVED DPG54-DATE-INVALID.                               00530042
005400*       ADDED HEADING CONTROL CARDS.                              00540042
005500*       CHANGED SAK110 TO READ THE SATURDAY (SACC009) CONTROL     00550042
005600*       CARD. THE FORMAT OF THE CONTROL CARD IS CCYY-MM-DD.       00560042
005700*                                                                 00570042
005800*  CHANGED 01/07/00 BY BARB ERTL - SAFENET CONSULTING             00580042
005900*       ADDED DEBIT AND CREDIT TOTALS BY STORE AND GRAND TOTAL    00590042
006000*                                                                 00600042
006100*  CHANGED 02/03/00 BY BARB ERTL - SAFENET CONSULTING             00610042
006200*       CHANGED TO PRINT DEBITS AND CREDITS BY DAY.               00620042
006300*                                                                 00630042
006400*  CHANGED 12/17/01 BY GAYLE HAUPT     WR# 23086                  00640042
006500*  DEBIT CARD PROJECT--CREATED A NEW BUCKET (DBN--DEBIT CARD NET) 00650042
006600*  THAT NEEDS TO BE PICKED UP BY TSAADSU AND ADDED TO THE REPORT  00660042
006700*  ('DEBIT').                                                     00670042
006800*                                                                 00680042
006900*  CHANGED 09/29/04 BY THOMAS HANSON   WR# 27107                  00690042
007000*  XS DOMAIN CONSTRAINTS PROJECT - REPLACE TSTR000 REFERENCE      00700042
007100*  WITH XST_LOC TABLE REFERENCE WHEN RETRIEVING STORE NAME.       00710042
007200*                                                                 00720042
007300*  CHANGED 12/20/05 BY SCOTT BARTELT   WR# 29912                  00730042
007400*  EMPLOYEE DISCOUNT MARKDOWN PROJECT - STARTING FISCAL 2006,     00740042
007500*  DISCOUNTS FOR EMPLOYEES WILL BE TREATED AS A MARKDOWN INSTEAD  00750042
007600*  OF AS AN EXPENSE.  THEREFORE, THE "EMPLOYEE CASH DISCOUNT"     00760042
007700*  COLUMN IS BEING REMOVED FROM THIS REPORT.                      00770042
007800*                                                                 00780042
N2I201*  CHANGED 04/15/08 BY STEVEN NOWAK    WR# 33714                  00790042
N2I201*  BLACK HAWK CHANGES (THIRD PARTY GIFT CARD) FOR NEXT GEN 2      00800042
N2I201*                                                                 00810042
008200***************************************************************** 00820042
SEPHOR*  CHANGED 05/04/21 BY BARB SCHULTZ  CHG0256426                   00830042
SEPHOR*  REPLACED 'NSF PAYMENTS' WITH 'SEPHORA CHARGES' AND 'NSF' WITH  00840042
SEPHOR*  'SCN'.                                                         00850042
SEPHOR***************************************************************** 00860042
PAYVEN*  CHANGED 05/08/23 BY BARB SCHULTZ  CHG0288283                   00861042
PAYVEN*  REPLACED 'UNCORRECTED VOIDS' WITH 'PAYPAL CHARGES' AND ADDED   00862042
PAYVEN*  'VENMO CHARGES' RIGHT AFTER PAYPAL CHARGES.  THEN MOVED THE    00863042
PAYVEN*  NEXT COLUMNS DOWN ONE.  ALSO DISCOVERED 'CHECKS FROM REGISTERS'00863147
PAYVEN*  WAS THERE BUT NOT BEING USED.  THIS IS COMMENTED OUT FROM THE  00863247
PAYVEN*  PROGRAM.                                                       00863347
PAYVEN***************************************************************** 00863447
008500                                                                  00863547
008500                                                                  00863647
008300 ENVIRONMENT DIVISION.                                            00863747
008600 CONFIGURATION SECTION.                                           00863847
008700                                                                  00863947
008800 SOURCE-COMPUTER.        IBM-3090.                                00864047
009000 OBJECT-COMPUTER.        IBM-3090.                                00864147
009100                                                                  00864247
009200 INPUT-OUTPUT SECTION.                                            00865042
009400 FILE-CONTROL.                                                    00866042
009500                                                                  00867042
009600     SELECT POS-DATE-CARD-FILE                                    00868042
009700         ASSIGN TO INP01.                                         00869042
009800                                                                  00870042
009900     SELECT HEADING-FILE                                          00880042
010000         ASSIGN TO INP02.                                         00890042
010100                                                                  00900042
010200     SELECT SUMMARY-REPORT-FILE                                   00910042
010300         ASSIGN TO RPT01.                                         00920042
010400                                                                  00930042
010600 DATA DIVISION.                                                   00940042
010900 FILE SECTION.                                                    00950042
011000                                                                  00960042
011100 FD  POS-DATE-CARD-FILE                                           00970042
011200     RECORDING MODE IS F                                          00980042
011300     BLOCK CONTAINS 0 RECORDS                                     00990042
011400     LABEL RECORDS ARE STANDARD.                                  01000042
011500                                                                  01010042
011600 01  POS-DATE-CARD-RECORD            PIC X(80).                   01020042
011700                                                                  01030042
011800 FD  HEADING-FILE                                                 01040042
011900     RECORDING MODE IS F                                          01050042
012000     BLOCK CONTAINS 0 RECORDS                                     01060042
012100     LABEL RECORDS ARE STANDARD.                                  01070042
012200                                                                  01080042
012300 01  HEADING-RECORD                  PIC X(80).                   01090042
012400                                                                  01100042
012500 FD  SUMMARY-REPORT-FILE                                          01110042
012600     RECORDING MODE IS F                                          01120042
012700     BLOCK CONTAINS 0  RECORDS.                                   01130042
012800                                                                  01140042
012900 01  SUMMARY-REPORT-RECORD           PIC  X(132).                 01150042
013000                                                                  01160042
013100******************************************************************01170042
013200 WORKING-STORAGE SECTION.                                         01180042
013300******************************************************************01190042
013400 01  FILLER                            PIC X(50)  VALUE           01200042
013500     ' *** WORKING STORAGE STARTS HERE FOR SAKRP010 *** '.        01210042
013600                                                                  01220042
013700******************************************************************01230042
013800* RECORD LAYOUT FOR INPUT DATE CARD                               01240042
013900******************************************************************01250042
014000                                                                  01260042
014100 01  CC-CONTROL-CARD.                                             01270042
014200     05  CC-CONTROL-CARD-DISPLAY.                                 01280042
014300         10  CC-DATE-ISO         PIC X(10).                       01290042
014400         10 FILLER               PIC X(70).                       01300042
014500                                                                  01310042
014600******************************************************************01320042
014700* RECORD LAYOUT FOR INPUT DATE CARD                               01330042
014800******************************************************************01340042
014900                                                                  01350042
015000 01  HEADING-CARD                PIC X(80).                       01360042
015100                                                                  01370042
015200******************************************************************01380042
015300*  PARAMETER LIST FOR THE CALENDAR ROUTINE (DPKUT500)             01390042
015400******************************************************************01400042
015500     COPY DPWS500.                                                01410042
015600 01  AC-ABEND-CODE                     PIC S9(04) VALUE ZERO      01420042
015700                                                  COMP SYNC.      01430042
015800     88  AC-CONTROL-CARD-ERROR                    VALUE +4003.    01440042
015900     88  AC-DB2-ERROR                             VALUE +4013.    01450042
016000     88  AC-CALENDAR-ROUTINE-ERROR                VALUE +4019.    01460042
016100                                                                  01470042
016200 01  PS-PROGRAM-SWITCHES.                                         01480042
016300     05  PS-END-OF-SUM-CURSOR-SW       PIC X(01)  VALUE 'N'.      01490042
016400         88  PS-END-OF-SUM-CURSOR                 VALUE 'Y'.      01500042
016500     05  PS-END-OF-CASH-CURSOR-SW      PIC X(01)  VALUE 'N'.      01510042
016600         88  PS-NOT-END-OF-CASH-CURSOR            VALUE 'N'.      01520042
016700         88  PS-END-OF-CASH-CURSOR                VALUE 'Y'.      01530042
016800     05  PS-END-OF-CARD-FILE-SW        PIC X(01)  VALUE 'N'.      01540042
016900         88  PS-END-OF-CARD-FILE                  VALUE 'Y'.      01550042
017000     05  PS-END-OF-HEADING-SW          PIC X(01)  VALUE 'N'.      01560042
017100         88  PS-END-OF-HEADING                    VALUE 'Y'.      01570042
017200     05  PS-FIRST-TOTAL-SW             PIC X(01)  VALUE 'Y'.      01580042
017300         88  PS-FIRST-TOTAL                       VALUE 'Y'.      01590042
017400         88  PS-NOT-FIRST-TOTAL                   VALUE 'N'.      01600042
017500                                                                  01610042
017600 01  PC-CONSTANTS.                                                01620042
017700     05  PC-LINE-LIMIT               PIC S9(04)  VALUE +60.       01630042
017800     05  PV-SAK110                   PIC  X(51)  VALUE            01640042
017900         'UNAUDITED SUMMARY OF CASH SALES FOR THE WEEK ENDING'.   01650042
018000     05  PC-ROW-NOT-FOUND            PIC S9(04)  VALUE +100       01660042
018100                                                 COMP SYNC.       01670042
018200     05  PC-CURRENT-PROGRAM-NAME     PIC  X(08)  VALUE            01680042
018300                                                 'SAKRP010'.      01690042
018400     05  PC-REPORT-NBR-1             PIC  9(01)  VALUE 1.         01700042
018500     05  PC-TOTALS-LIT               PIC  X(6)   VALUE 'TOTALS'.  01710042
018600     05  PC-ALL-STORES               PIC  X(10)  VALUE            01720042
018700                                                 'ALL STORES'.    01730042
018800     05  PC-LIT-C                    PIC  X      VALUE 'C'.       01740042
018900     05  PC-LIT-D                    PIC  X      VALUE 'D'.       01750042
019000     05  PC-LIT-P                    PIC  X      VALUE 'P'.       01760042
019100     05  PC-LIT-00                   PIC  XX     VALUE '00'.      01770042
019200     05  PC-LIT-01                   PIC  XX     VALUE '01'.      01780042
019300     05  PC-NEG-ONE                  PIC  S9     COMP-3 VALUE -1. 01790042
019400                                                                  01800042
019500 01  PC-NEGATE-TABLE.                                             01810042
019600     05  FILLER                      PIC X(38)                    01820048
019700         VALUE 'NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNYYNNNN'.          01830045
019800                                                                  01840042
019900 01  FILLER REDEFINES PC-NEGATE-TABLE.                            01850042
020000     05  PC-NEGATE-SWITCH            OCCURS 38 TIMES              01860045
020100                                     PIC X.                       01870042
020200         88  NEGATE-VALUE            VALUE 'Y'.                   01880042
020300                                                                  01890042
020400 01  PV-MISC-COUNT-FIELDS            COMP-3.                      01900042
020500     05  PV-PAGE-CNT                 PIC S9(05)    VALUE ZERO.    01910042
020600     05  PV-LINE-CNT                 PIC S9(03)    VALUE ZERO.    01920042
020700     05  PV-LINE-CNT-AHEAD           PIC S9(03)    VALUE ZERO.    01930042
020800     05  PV-SUM-CURSOR-CNT           PIC S9(07)    VALUE ZERO.    01940042
020900                                                                  01950042
021000 01  PV-MISC-FIELDS.                                              01960042
021100     05  PV-PRINT-RECORD             PIC X(200)    VALUE SPACE.   01970042
021200     05  PV-LINE-SPACING             PIC S9(04)    VALUE ZERO     01980042
021300                                                   COMP SYNC.     01990042
021400     05  PV-PARAGRAPH-NAME           PIC  X(30)    VALUE SPACE.   02000042
021500     05  PV-OPERATION-MSG-1          PIC  X(40)    VALUE SPACE.   02010042
021600     05  PV-OPERATION-MSG-2          PIC  X(40)    VALUE SPACE.   02020042
021700     05  PV-DB2-OPERATION            PIC  X(30)    VALUE SPACE.   02030042
021800     05  PV-START-DATE               PIC  X(10).                  02040042
021900     05  PV-END-DATE                 PIC  X(10).                  02050042
022000     05  PV-SAVE-STR-NBR             PIC  S9(4)    COMP.          02060042
022100     05  PV-SAVE-SLS-DTE             PIC  X(10).                  02070042
022200     05  PV-DEBIT-DATE               PIC  X(10).                  02080042
022300     05  PV-NULL-IND1                PIC S9(4)   VALUE ZERO COMP. 02090042
022400     05  PV-EDIT-MASK                PIC  Z,ZZZ,ZZ9.              02100042
022500     05  PV-GIFT-CARD                PIC  S9(7)V9(2)  COMP-3.     02110042
022600     05  PV-MDSE-SALE                PIC  S9(7)V9(2)  COMP-3.     02120042
022700     05  PV-TOT-PAID-OUT             PIC  S9(7)V9(2)  COMP-3.     02130042
022800     05  PV-TOT-CASH                 PIC  S9(7)V9(2)  COMP-3.     02140042
022900     05  PV-ACCUM                    PIC  S9(9)V9(2)  COMP-3      02150042
023000                                                   VALUE ZERO.    02160042
023100     05  PV-TOTAL-DR                 PIC  S9(11)V9(2)  COMP-3     02170042
023200                                                   VALUE ZERO.    02180042
023300     05  PV-TOTAL-CR                 PIC  S9(11)V9(2)  COMP-3     02190042
023400                                                   VALUE ZERO.    02200042
023500 01  PV-DR-CR-ACCUMULATORS.                                       02210042
023600     05  PV-DR-CR-ACCUMS OCCURS 8 TIMES.                          02220042
023700         10  PV-ACCUM-DR             PIC  S9(9)V9(2)  COMP-3      02230042
023800                                                   VALUE ZERO.    02240042
023900         10  PV-ACCUM-CR             PIC  S9(9)V9(2)  COMP-3      02250042
024000                                                   VALUE ZERO.    02260042
024100         10  PV-ACCUM-CP-DR          PIC  S9(9)V9(2)  COMP-3      02270042
024200                                                   VALUE ZERO.    02280042
024300         10  PV-ACCUM-CP-CR          PIC  S9(9)V9(2)  COMP-3      02290042
024400                                                   VALUE ZERO.    02300042
024500         10  PV-ACCUM-CR-CR          PIC  S9(9)V9(2)  COMP-3      02310042
024600                                                   VALUE ZERO.    02320042
024700         10  PV-ACCUM-CR-DR          PIC  S9(9)V9(2)  COMP-3      02330042
024800                                                   VALUE ZERO.    02340042
024900                                                                  02350042
025000 01  PV-SUBSCRIPTS                   COMP.                        02360042
025100     05  PV-SUMM-SUB                 PIC S9(4)     VALUE ZERO.    02370042
025200     05  PV-DATE-SUB                 PIC S9(4)     VALUE ZERO.    02380042
025300     05  PV-LINE-SUB                 PIC S9(4)     VALUE ZERO.    02390042
025400     05  PV-HLIT-SUB                 PIC S9(4)     VALUE ZERO.    02400042
025500     05  PV-PRNT-SUB                 PIC S9(4)     VALUE ZERO.    02410042
025600     05  PV-LOW-LIMIT                PIC S9(4)     VALUE ZERO.    02420042
025700     05  PV-HIGH-LIMIT               PIC S9(4)     VALUE ZERO.    02430042
025800     05  PV-PAID-SUB                 PIC S9(4)     VALUE ZERO.    02440042
025900     05  PV-CASH-SUB                 PIC S9(4)     VALUE ZERO.    02450042
026000     05  PV-TABL-SUB                 PIC S9(4)     VALUE ZERO.    02460042
026100     05  PV-MAX-ENTRIES              PIC S9(4)     VALUE ZERO.    02470042
026200                                                                  02480042
026300 01  PV-DATE-AND-TIME-FIELDS.                                     02490042
026400     05  PV-POS-CCYY-MM-DD           PIC X(10)     VALUE SPACE.   02500042
026500     05  FILLER REDEFINES PV-POS-CCYY-MM-DD.                      02510042
026600         10  PV-POS-CCYY             PIC X(04).                   02520042
026700         10  FILLER                  PIC X(01).                   02530042
026800         10  PV-POS-MM               PIC X(02).                   02540042
026900         10  FILLER                  PIC X(01).                   02550042
027000         10  PV-POS-DD               PIC X(02).                   02560042
027100     05  FILLER REDEFINES PV-POS-CCYY-MM-DD.                      02570042
027200         10  PV-POS-CC               PIC X(02).                   02580042
027300         10  PV-POS-YY               PIC X(02).                   02590042
027400         10  FILLER                  PIC X(06).                   02600042
027500     05  PV-CURR-DATE-CCYYMMDD.                                   02610042
027600         10  PV-CURR-DATE-CCYY       PIC  9(04).                  02620042
027700         10  PV-CURR-DATE-MM         PIC  9(02).                  02630042
027800         10  PV-CURR-DATE-DD         PIC  9(02).                  02640042
027900     05  PV-CURR-TIME.                                            02650042
028000         10  PV-CURR-TIME-HH         PIC  9(02)    VALUE ZERO.    02660042
028100         10  PV-CURR-TIME-MM         PIC  9(02)    VALUE ZERO.    02670042
028200         10  PV-CURR-TIME-SSHH       PIC  9(04)    VALUE ZERO.    02680042
028300     05  PV-PRINT-DATE.                                           02690042
028400         10  PV-PRINT-MM             PIC XX.                      02700042
028500         10  PV-PRINT-SLASH          PIC X.                       02710042
028600         10  PV-PRINT-DD             PIC XX.                      02720042
028700     05  PV-HEADER-DATE.                                          02730042
028800         10  PV-HEADER-MM            PIC XX.                      02740042
028900         10  PV-HEADER-SLASH-1       PIC X.                       02750042
029000         10  PV-HEADER-DD            PIC XX.                      02760042
029100         10  PV-HEADER-SLASH-2       PIC X.                       02770042
029200         10  PV-HEADER-YY            PIC XX.                      02780042
029300     05  PV-POS-OPN-CCYY-MM-DD       PIC X(10)     VALUE SPACE.   02790042
029400                                                                  02800042
029500******************************************************************02810042
029600*  TABLES FOR REPORT                                              02820042
029700******************************************************************02830042
029800                                                                  02840042
029900 01  DATE-TABLE.                                                  02850042
030000     05  DATE-TABLE-ENTRY            OCCURS 7 TIMES.              02860042
030100         10  SUMMARY-DATE            PIC X(10).                   02870042
030200                                                                  02880042
030300 01  SUMMARY-TABLE                   COMP-3.                      02890042
030400     05  SUMMARY-LEVEL               OCCURS 8 TIMES.              02900042
030500         10  SUMMARY                 OCCURS 38 TIMES              02910045
030600                                     PIC S9(9)V99.                02920042
030700                                                                  02930042
030800 01  TOTAL-SUMMARY-TABLE             COMP-3.                      02940042
030900     05  TOTAL-SUMMARY-LEVEL         OCCURS 8 TIMES.              02950042
031000         10  TOTAL-SUMMARY           OCCURS 38 TIMES              02960045
031100                                     PIC S9(9)V99.                02970042
031200                                                                  02980042
031300 01  CASH-TABLE.                                                  02990042
031400     05  CASH-ENTRY-ELEMENT          OCCURS 200 TIMES.            03000042
031500         10  PAID-OUT-ENTRY          PIC X(58).                   03010042
031600         10  CASH-ENTRY              PIC X(58).                   03020042
031700                                                                  03030042
031800 01  CASH-TABLE-EDIT.                                             03040042
031900     05  FILLER                      PIC X.                       03050042
032000     05  CASH-TBL-DATE               PIC X(5).                    03060042
032100     05  FILLER                      PIC X.                       03070042
032200     05  CASH-TBL-AMT                PIC ---,---.99.              03080042
032300     05  FILLER                      PIC XX.                      03090042
032400     05  CASH-TBL-LOC-CHRGD          PIC 9(4).                    03100042
032500     05  FILLER                      PIC XX.                      03110042
032600     05  CASH-TBL-RSN-CDE            PIC XXX.                     03120042
032700     05  FILLER                      PIC X.                       03130042
032800     05  CASH-TBL-CMNT-TXT           PIC X(30).                   03140042
032900******************************************************************03150042
033000*  TOP OF PAGE HEADING LINE FOR PRINTING A 132 CHARACTER REPORT.  03160042
033100******************************************************************03170042
033200     COPY DPWS132.                                                03180042
033300                                                                  03190042
033400******************************************************************03200042
033500*  HEADING LINES FOR THE CORPORATE SUMMARY REPORT.                03210042
033600******************************************************************03220042
033700                                                                  03230042
033800 01  H2-HEADING-LINE-2.                                           03240042
PAYVEN     05  FILLER                  PIC X(36)   VALUE SPACE.         03250052
PAYVEN     05  H2-HEADING-NAME-1       PIC X(52)   VALUE SPACE.         03260052
034100     05  H2-ENDING-DATE-1        PIC X(08)   VALUE SPACE.         03270042
PAYVEN     05  FILLER                  PIC X(36)   VALUE SPACES.        03280052
034300                                                                  03290042
034400 01  FILLER                      REDEFINES H2-HEADING-LINE-2.     03300042
034500     05  H2-FILLER-1             PIC X(36).                       03310042
034600     05  H2-HEADING-NAME-2       PIC X(52).                       03320042
034700     05  H2-ENDING-DATE-2        PIC X(08).                       03330042
034800     05  H2-FILLER-2             PIC X(36).                       03340042
034900                                                                  03350042
035000 01  H3-HEADING-LINE-3.                                           03360042
035100     05  FILLER                  PIC X       VALUE SPACE.         03370042
035200     05  FILLER                  PIC X(5)    VALUE SPACES.        03380042
035300     05  HDR3-PRINT-AREA.                                         03390042
035400         10  HDR3-STORE-NBR      PIC 9(4)    VALUE ZERO.          03400042
035500         10  FILLER              PIC X       VALUE SPACE.         03410042
035600         10  FILLER              PIC X       VALUE '-'.           03420042
035700         10  FILLER              PIC X       VALUE SPACE.         03430042
035800         10  HDR3-STORE-NAME     PIC X(20)   VALUE SPACES.        03440042
035900     05  FILLER                  PIC X(100)  VALUE SPACES.        03450042
036000                                                                  03460042
036100 01  H4-HEADING-LINE-4.                                           03470042
036200     05  FILLER                  PIC X       VALUE SPACE.         03480042
036300     05  FILLER                  PIC X(7)    VALUE SPACES.        03490042
036400     05  HDR4-COLUMN-HEADING     OCCURS 8 TIMES.                  03500042
036500         10  FILLER              PIC X.                           03510042
036600         10  HDR4-COLUMN         PIC X(14)   JUST RIGHT.          03520042
036700     05  FILLER                  PIC X(5)    VALUE SPACES.        03530042
036800                                                                  03540042
036900******************************************************************03550042
037000*  DETAIL LINE PRINTED FIRST ON THE CORPORATE SUMMARY REPORT.     03560042
037100******************************************************************03570042
037200                                                                  03580042
037300 01  D1-DETAIL-LINE-1.                                            03590042
037400     05  FILLER                  PIC XX.                          03600042
037500     05  DTL1-DATE               PIC X(6)    JUST RIGHT.          03610042
037600     05  DTL1-SUMMARY-AREA       OCCURS 8 TIMES.                  03620042
037700         10  DTL1-SUMMARY        PIC ----,---,---.99.             03630042
037800     05  FILLER                  PIC X(5).                        03640042
037900 01  D2-DETAIL-LINE-2.                                            03650042
038000     05  FILLER                  PIC X(4).                        03660042
038100     05  DTL2-PAID-OUT           PIC X(59).                       03670042
038200     05  FILLER                  PIC X(5).                        03680042
038300     05  DTL2-CASH               PIC X(59).                       03690042
038400     05  FILLER                  PIC X(5).                        03700042
038500 01  D1-DASH-LINE-1.                                              03710042
038600     05  FILLER                  PIC XX      VALUE SPACES.        03720042
038700     05  FILLER                  PIC X(6)    VALUE ALL '-'.       03730042
038800     05  DTL1-DASH-AREA.                                          03740042
038900         10  DTL1-DASH-ELEMENT   OCCURS 8 TIMES.                  03750042
039000             15  FILLER          PIC X.                           03760042
039100             15  DTL1-DASH       PIC X(14).                       03770042
039200     05  FILLER                  PIC X(5)    VALUE SPACES.        03780042
039300 01  D1-DR-CR-LINE.                                               03790042
039400     05  FILLER                  PIC XX      VALUE SPACES.        03800042
039500     05  DTL1-DR-CR-DATE         PIC X(6)    JUST RIGHT.          03810042
039600     05  FILLER                  PIC X(15)   VALUE                03820042
039700            '      DEBITS'.                                       03830042
039800     05  DTL1-DEBIT-AMT          PIC ---,---,---,---.99.          03840042
039900     05  FILLER                  PIC X(5)    VALUE SPACES.        03850042
040000     05  FILLER                  PIC X(15)   VALUE                03860042
040100            '      CREDITS'.                                      03870042
040200     05  DTL1-CREDIT-AMT         PIC ---,---,---,---.99.          03880042
040300     05  FILLER                  PIC X(60)   VALUE SPACES.        03890042
040400 01  WARNING-LINE.                                                03900042
040500     05  FILLER                  PIC X(132)  VALUE                03910042
040600         '*** WARNING - DEBITS DO NOT EQUAL CREDITS ***'.         03920042
040700 01  HEADER-LITERALS.                                             03930042
040800     05  FILLER              PIC X(14)   VALUE SPACES.            03940042
040900     05  FILLER              PIC X(14)   VALUE '         GROSS'.  03950042
041000     05  FILLER              PIC X(14)   VALUE '         SALES'.  03960042
041100     05  FILLER              PIC X(14)   VALUE SPACES.            03970042
041200     05  FILLER              PIC X(14)   VALUE '         SALES'.  03980042
041300     05  FILLER              PIC X(14)   VALUE '          MDSE'.  03990042
041400     05  FILLER              PIC X(14)   VALUE SPACES.            04000042
041500     05  FILLER              PIC X(14)   VALUE '         STATE'.  04010042
041600     05  FILLER              PIC X(14)   VALUE '           TAX'.  04020042
041700     05  FILLER              PIC X(14)   VALUE SPACES.            04030042
N2I201     05  FILLER              PIC X(14)   VALUE '   THIRD PARTY'.  04040042
N2I201     05  FILLER              PIC X(14)   VALUE '    CARD SALES'.  04050042
042000     05  FILLER              PIC X(14)   VALUE SPACES.            04060042
042100     05  FILLER              PIC X(14)   VALUE '     GIFT CARD'.  04070042
042200     05  FILLER              PIC X(14)   VALUE '         SALES'.  04080042
042300     05  FILLER              PIC X(14)   VALUE SPACES.            04090042
042400     05  FILLER              PIC X(14)   VALUE '         TOTAL'.  04100042
042500     05  FILLER              PIC X(14)   VALUE '       RETURNS'.  04110042
042600     05  FILLER              PIC X(14)   VALUE SPACES.            04120042
042700     05  FILLER              PIC X(14)   VALUE '     CORPORATE'.  04130042
042800     05  FILLER              PIC X(14)   VALUE '        REFUND'.  04140042
042900     05  FILLER              PIC X(14)   VALUE SPACES.            04150042
043000     05  FILLER              PIC X(14)   VALUE '          KMRC'.  04160042
043100     05  FILLER              PIC X(14)   VALUE '        ISSUED'.  04170042
043200     05  FILLER              PIC X(14)   VALUE SPACES.            04180042
043300     05  FILLER              PIC X(14)   VALUE '          P.O.'.  04190042
043400     05  FILLER              PIC X(14)   VALUE '       RETURNS'.  04200042
043500     05  FILLER              PIC X(14)   VALUE SPACES.            04210042
043600     05  FILLER              PIC X(14)   VALUE '       COUNTED'.  04220042
043700     05  FILLER              PIC X(14)   VALUE '          CASH'.  04230042
043800     05  FILLER              PIC X(14)   VALUE SPACES.            04240042
043900     05  FILLER              PIC X(14)   VALUE '     TRAVELERS'.  04250042
044000     05  FILLER              PIC X(14)   VALUE '        CHECKS'.  04260042
044100     05  FILLER              PIC X(14)   VALUE SPACES.            04270042
044200     05  FILLER              PIC X(14)   VALUE '        VENDOR'.  04280042
044300     05  FILLER              PIC X(14)   VALUE '        CHECKS'.  04290042
044400     05  FILLER              PIC X(14)   VALUE SPACES.            04300042
044500     05  FILLER              PIC X(14)   VALUE '          MALL'.  04310042
044600     05  FILLER              PIC X(14)   VALUE '     GIFT CERT'.  04320042
044700     05  FILLER              PIC X(14)   VALUE SPACES.            04330042
044800     05  FILLER              PIC X(14)   VALUE SPACES.            04340042
044900     05  FILLER              PIC X(14)   VALUE '        CHECKS'.  04350042
045000     05  FILLER              PIC X(14)   VALUE SPACES.            04360042
045100     05  FILLER              PIC X(14)   VALUE '     GIFT CERT'.  04370042
045200     05  FILLER              PIC X(14)   VALUE '      TENDERED'.  04380042
045300     05  FILLER              PIC X(14)   VALUE SPACES.            04390042
045400     05  FILLER              PIC X(14)   VALUE '     GIFT CARD'.  04400042
045500     05  FILLER              PIC X(14)   VALUE '      TENDERED'.  04410042
045600     05  FILLER              PIC X(14)   VALUE SPACES.            04420042
045700     05  FILLER              PIC X(14)   VALUE '          KMRC'.  04430042
045800     05  FILLER              PIC X(14)   VALUE '      TENDERED'.  04440042
045900     05  FILLER              PIC X(14)   VALUE SPACES.            04450042
046000     05  FILLER              PIC X(14)   VALUE '          P.O.'.  04460042
046100     05  FILLER              PIC X(14)   VALUE '         SALES'.  04470042
046200     05  FILLER              PIC X(14)   VALUE SPACES.            04480042
046300     05  FILLER              PIC X(14)   VALUE SPACES.            04490042
046400     05  FILLER              PIC X(14)   VALUE '      BANKCARD'.  04500042
046500     05  FILLER              PIC X(14)   VALUE SPACES.            04510042
046600     05  FILLER              PIC X(14)   VALUE SPACES.            04520042
046700     05  FILLER              PIC X(14)   VALUE '         NOVUS'.  04530042
046800     05  FILLER              PIC X(14)   VALUE SPACES.            04540042
046900     05  FILLER              PIC X(14)   VALUE SPACES.            04550042
047000     05  FILLER              PIC X(14)   VALUE '          AMEX'.  04560042
047100     05  FILLER              PIC X(14)   VALUE SPACES.            04570042
047200     05  FILLER              PIC X(14)   VALUE SPACES.            04580042
047300     05  FILLER              PIC X(14)   VALUE '         DEBIT'.  04590042
047400     05  FILLER              PIC X(14)   VALUE SPACES.            04600042
047500     05  FILLER              PIC X(14)   VALUE '         KOHLS'.  04610042
047600     05  FILLER              PIC X(14)   VALUE '        CHARGE'.  04620042
047700     05  FILLER              PIC X(14)   VALUE SPACES.            04630042
047800     05  FILLER              PIC X(14)   VALUE '         KOHLS'.  04640042
047900     05  FILLER              PIC X(14)   VALUE '      PAYMENTS'.  04650042
048000     05  FILLER              PIC X(14)   VALUE SPACES.            04660042
SEPHOR     05  FILLER              PIC X(14)   VALUE '       SEPHORA'.  04670042
SEPHOR     05  FILLER              PIC X(14)   VALUE '       CHARGES'.  04680042
048300     05  FILLER              PIC X(14)   VALUE SPACES.            04690042
PAYVEN*    05  FILLER              PIC X(14)   VALUE '   UNCORRECTED'.  04700052
PAYVEN*    05  FILLER              PIC X(14)   VALUE '         VOIDS'.  04710052
PAYVEN*    05  FILLER              PIC X(14)   VALUE SPACES.            04720052
PAYVEN     05  FILLER              PIC X(14)   VALUE '        PAYPAL'.  04730042
PAYVEN     05  FILLER              PIC X(14)   VALUE '       CHARGES'.  04740042
PAYVEN     05  FILLER              PIC X(14)   VALUE SPACES.            04750042
PAYVEN     05  FILLER              PIC X(14)   VALUE '         VENMO'.  04760042
PAYVEN     05  FILLER              PIC X(14)   VALUE '       CHARGES'.  04770042
048600     05  FILLER              PIC X(14)   VALUE SPACES.            04780042
048700     05  FILLER              PIC X(14)   VALUE '      REGISTER'.  04790042
048800     05  FILLER              PIC X(14)   VALUE '   (OVER)SHORT'.  04800042
048900     05  FILLER              PIC X(14)   VALUE SPACES.            04810042
049000     05  FILLER              PIC X(14)   VALUE '     BEGINNING'.  04820042
049100     05  FILLER              PIC X(14)   VALUE '       BALANCE'.  04830042
049200     05  FILLER              PIC X(14)   VALUE SPACES.            04840042
049300     05  FILLER              PIC X(14)   VALUE '      CURRENCY'.  04850042
049400     05  FILLER              PIC X(14)   VALUE '      DELIVERY'.  04860042
049500     05  FILLER              PIC X(14)   VALUE SPACES.            04870042
049600     05  FILLER              PIC X(14)   VALUE '         KOHLS'.  04880042
049700     05  FILLER              PIC X(14)   VALUE '         DEBIT'.  04890042
049800* REQUESTED BY CORENE PRAH, REPLACE WITH 'CSH' AMOUNTS            04900042
049900*    05  FILLER              PIC X(14)   VALUE SPACES.            04910042
050000*    05  FILLER              PIC X(14)   VALUE '     CASH FROM'.  04920042
050100*    05  FILLER              PIC X(14)   VALUE '     REGISTERS'.  04930042
PAYVEN* WASN'T BEING USED ANYMORE 05/09/23 SO I COMMENTED IT OUT.       04931052
PAYVEN*    05  FILLER              PIC X(14)   VALUE SPACES.            04940045
PAYVEN*    05  FILLER              PIC X(14)   VALUE '   CHECKS FROM'.  04950045
PAYVEN*    05  FILLER              PIC X(14)   VALUE '     REGISTERS'.  04960045
050500     05  FILLER              PIC X(14)   VALUE SPACES.            04970042
050600     05  FILLER              PIC X(14)   VALUE '     MISC CASH'.  04980042
050700     05  FILLER              PIC X(14)   VALUE '      RECEIVED'.  04990042
050800     05  FILLER              PIC X(14)   VALUE SPACES.            05000042
050900     05  FILLER              PIC X(14)   VALUE '          CASH'.  05010042
051000     05  FILLER              PIC X(14)   VALUE '       DEPOSIT'.  05020042
051100     05  FILLER              PIC X(14)   VALUE SPACES.            05030042
051200     05  FILLER              PIC X(14)   VALUE '         CHECK'.  05040042
051300     05  FILLER              PIC X(14)   VALUE '       DEPOSIT'.  05050042
051400     05  FILLER              PIC X(14)   VALUE SPACES.            05060042
051500     05  FILLER              PIC X(14)   VALUE '          MISC'.  05070042
051600     05  FILLER              PIC X(14)   VALUE '      PAID-OUT'.  05080042
051700     05  FILLER              PIC X(14)   VALUE SPACES.            05090042
051800     05  FILLER              PIC X(14)   VALUE '        ENDING'.  05100042
051900     05  FILLER              PIC X(14)   VALUE '       BALANCE'.  05110042
052000     05  FILLER              PIC X(14)   VALUE SPACES.            05120042
052100     05  FILLER              PIC X(14)   VALUE '          SAFE'.  05130042
052200     05  FILLER              PIC X(14)   VALUE '   (OVER)SHORT'.  05140042
052300     05  FILLER              PIC X(14)   VALUE SPACES.            05150042
052400     05  FILLER              PIC X(14)   VALUE '          CASH'.  05160042
052500     05  FILLER              PIC X(14)   VALUE '       ON HAND'.  05170042
052600                                                                  05180042
052700 01  FILLER REDEFINES HEADER-LITERALS.                            05190042
052800     05  FILLER              OCCURS 38 TIMES.                     05201045
052900         10  HEADER-LITERAL  OCCURS 3 TIMES                       05210042
053000                             PIC X(14).                           05220042
053100                                                                  05230042
053200 01  PAID-OUT-HEADER.                                             05240042
053300     05  FILLER              PIC X(22)   VALUE SPACES.            05250042
053400     05  FILLER              PIC X(9)    VALUE 'PAID-OUT '.       05260042
053500     05  FILLER              PIC X(6)    VALUE 'DETAIL'.          05270042
053600     05  FILLER              PIC X(22)   VALUE SPACES.            05280042
053700                                                                  05290042
053800 01  CASH-HEADER.                                                 05300042
053900     05  FILLER              PIC X(20)   VALUE SPACES.            05310042
054000     05  FILLER              PIC X(5)    VALUE 'CASH '.           05320042
054100     05  FILLER              PIC X(9)    VALUE 'RECEIVED '.       05330042
054200     05  FILLER              PIC X(6)    VALUE 'DETAIL'.          05340042
054300     05  FILLER              PIC X(19)   VALUE SPACES.            05350042
054400                                                                  05360042
054500 01  PAID-OUT-CASH-HEADER-1.                                      05370042
054600     05  FILLER              PIC X(20)   VALUE SPACES.            05380042
054700     05  FILLER              PIC X(3)    VALUE 'LOC'.             05390042
054800     05  FILLER              PIC X(36)   VALUE SPACES.            05400042
054900                                                                  05410042
055000 01  PAID-OUT-CASH-HEADER-2.                                      05420042
055100     05  FILLER              PIC X(11)   VALUE SPACES.            05430042
055200     05  FILLER              PIC X(6)    VALUE 'AMOUNT'.          05440042
055300     05  FILLER              PIC XX      VALUE SPACES.            05450042
055400     05  FILLER              PIC X(4)    VALUE 'CHRG'.            05460042
055500     05  FILLER              PIC XX      VALUE SPACES.            05470042
055600     05  FILLER              PIC XX      VALUE 'RC'.              05480042
055700     05  FILLER              PIC X(4)    VALUE SPACES.            05490042
055800     05  FILLER              PIC X(8)    VALUE 'COMMENTS'.        05500042
055900     05  FILLER              PIC X(20)   VALUE SPACES.            05510042
056000                                                                  05520042
056100 01  PAID-OUT-CASH-TOTAL.                                         05530042
056200     05  FILLER              PIC X(6)    VALUE 'TOTALS'.          05540042
056300     05  FILLER              PIC X       VALUE SPACE.             05550042
056400     05  PAID-OUT-CASH-TOT   PIC ---,---.99.                      05560042
056500     05  FILLER              PIC X(42)   VALUE SPACES.            05570042
056600******************************************************************05580042
056700*  WS FIELDS FOR SQLCA MESSAGE ROUTINE                            05590042
056800******************************************************************05600042
056900     COPY DPWS004.                                                05610042
057000******************************************************************05620042
057100*  DB2 COMMUNICATION AREA.                                        05630042
057200******************************************************************05640042
057300     EXEC SQL                                                     05650042
057400          INCLUDE SQLCA                                           05660042
057500     END-EXEC.                                                    05670042
057600******************************************************************05680042
057700*  DB2 TABLE DB2PDBA.TSAADSU - ADJUSTED SUMMARY TABLE             05690042
057800******************************************************************05700042
057900     EXEC SQL                                                     05710042
058000          INCLUDE TSAADSU                                         05720042
058100     END-EXEC.                                                    05730042
058200******************************************************************05740042
058300*  DB2 TABLE DB2PDBA.TEPPART - PARTITION CONTROL TABLE            05750042
058400******************************************************************05760042
058500     EXEC SQL                                                     05770042
058600          INCLUDE TEPPART                                         05780042
058700     END-EXEC.                                                    05790042
058800******************************************************************05800042
058900*  DB2 TABLE DB2PDBA.TSAADPC - ADJUSTED PAID OUT/CASH RECEIVED    05810042
059000******************************************************************05820042
059100     EXEC SQL                                                     05830042
059200          INCLUDE TSAADPC                                         05840042
059300     END-EXEC.                                                    05850042
059400******************************************************************05860042
059500*  DB2 TABLE DB2PDBA.TSAADDP - ADJUSTED DEPOSITS                  05870042
059600******************************************************************05880042
059700     EXEC SQL                                                     05890042
059800          INCLUDE TSAADDP                                         05900042
059900     END-EXEC.                                                    05910042
060000******************************************************************05920042
060100*  DB2 TABLE DB2PDBA.XST_LOC - STORE LOCATION TABLE               05930042
060200******************************************************************05940042
060300     EXEC SQL                                                     05950042
060400          INCLUDE XST00001                                        05960042
060500     END-EXEC.                                                    05970042
060600******************************************************************05980042
060700*  DB2 TABLE DB2PDBA.EPT_DR_CRD_TNDR DEBIT CARD TENDER TABLE      05990042
060800******************************************************************06000042
060900     EXEC SQL                                                     06010042
061000          INCLUDE EPT00002                                        06020042
061100     END-EXEC.                                                    06030042
061200******************************************************************06040042
061300*  DB2 TABLE DB2PDBA.TEPDKEY - PROCESSING DAY KEY TABLE           06050042
061400******************************************************************06060042
061500     EXEC SQL                                                     06070042
061600          INCLUDE TEPDKEY                                         06080042
061700     END-EXEC.                                                    06090042
061800******************************************************************06100042
061900*  DB2 TABLE DB2PDBA.TEPCRD  - CREDIT CARD TABLE                  06110042
062000******************************************************************06120042
062100     EXEC SQL                                                     06130042
062200          INCLUDE TEPCRD                                          06140042
062300     END-EXEC.                                                    06150042
062400******************************************************************06160042
062500*  DB2 TABLE DB2PDBA.TEPTND  - TENDER TABLE                       06170042
062600******************************************************************06180042
062700     EXEC SQL                                                     06190042
062800          INCLUDE TEPTND                                          06200042
062900     END-EXEC.                                                    06210042
063000******************************************************************06220042
063100*  DB2 TABLE DB2PDBA.TEPTRN  - TRANSACTION TABLE                  06230042
063200******************************************************************06240042
063300     EXEC SQL                                                     06250042
063400          INCLUDE TEPTRN                                          06260042
063500     END-EXEC.                                                    06270042
063600******************************************************************06280042
063700*  CURSOR FOR FETCHING TSAADSU                                    06290042
063800******************************************************************06300042
063900     EXEC SQL                                                     06310042
064000         DECLARE SUMMARY-CURSOR CURSOR                            06320042
064100         FOR SELECT SLS_DTE                                       06330042
064200                   ,STR_NBR                                       06340042
064300                   ,SUM_CTG_CDE                                   06350042
064400                   ,ADJ_AMT                                       06360042
064500         FROM TSAADSU DSU                                         06370042
064600             ,XST_LOC LOC                                         06380042
064700         WHERE SLS_DTE BETWEEN :PV-START-DATE AND :PV-END-DATE    06390042
064800         AND   DSU.STR_NBR   = LOC.LOC_NBR                        06400042
064900         AND   DSU.SLS_DTE  >= LOC.OPN_DTE                        06410042
065000         AND   LOC.OPN_DTE  <= :PV-END-DATE                       06420042
065100         AND  (LOC.CLO_DTE  >= :PV-END-DATE                       06430042
065200         OR    LOC.CLO_DTE   IS NULL)                             06440042
065300         ORDER BY STR_NBR, SLS_DTE                                06450042
065400         WITH UR                                                  06460042
065500     END-EXEC.                                                    06470042
065600******************************************************************06480042
065700*  CURSOR FOR FETCHING TSAADPC                                    06490042
065800******************************************************************06500042
065900     EXEC SQL                                                     06510042
066000         DECLARE CASH-CURSOR CURSOR                               06520042
066100         FOR SELECT SLS_DTE                                       06530042
066200                   ,TYP_CDE                                       06540042
066300                   ,ADJ_CSH_AMT                                   06550042
066400                   ,STR_CHRGD_NBR                                 06560042
066500                   ,RSN_CDE                                       06570042
066600                   ,CMNT_TXT                                      06580042
066700         FROM TSAADPC DPC                                         06590042
066800             ,XST_LOC LOC                                         06600042
066900         WHERE SLS_DTE BETWEEN :PV-START-DATE AND :PV-END-DATE    06610042
067000         AND STR_NBR = :PV-SAVE-STR-NBR                           06620042
067100         AND DPC.STR_NBR     = LOC.LOC_NBR                        06630042
067200         AND DPC.SLS_DTE    >= LOC.OPN_DTE                        06640042
067300         AND  LOC.OPN_DTE   <= :PV-END-DATE                       06650042
067400         AND (LOC.CLO_DTE   >= :PV-END-DATE                       06660042
067500         OR   LOC.CLO_DTE   IS NULL)                              06670042
067600         ORDER BY SLS_DTE                                         06680042
067700         WITH UR                                                  06690042
067800     END-EXEC.                                                    06700042
067900                                                                  06710042
068000                                                                  06720042
068100 PROCEDURE DIVISION.                                              06730042
068200******************************************************************06740042
068300* 0000-MAINLINE-PARAGRAPH                                         06750042
068400*      PRODUCE CORPORATE SUMMARY REPORT                           06760042
068500******************************************************************06770042
068600 0000-MAINLINE-PARAGRAPH.                                         06780042
068700                                                                  06790042
068800     PERFORM 1000-INITIALIZE-PROGRAM.                             06800042
068900                                                                  06810042
069000     PERFORM 2700-OPEN-SUMMARY-CURSOR.                            06820042
069100                                                                  06830042
069200     PERFORM 2800-FETCH-SUMMARY-CURSOR.                           06840042
069300                                                                  06850042
069400     PERFORM 2000-CASH-SALES-REPORT                               06860042
069500       UNTIL PS-END-OF-SUM-CURSOR.                                06870042
069600                                                                  06880042
069700     MOVE PC-ALL-STORES          TO HDR3-PRINT-AREA               06890042
069800                                                                  06900042
069900     MOVE TOTAL-SUMMARY-TABLE    TO SUMMARY-TABLE.                06910042
070000                                                                  06920042
070100     PERFORM 8000-PRINT-ROUTINE.                                  06930042
070200                                                                  06940042
070300     PERFORM 6000-DR-CR-ALL-STORES.                               06950042
070400                                                                  06960042
070500     PERFORM 2900-CLOSE-SUMMARY-CURSOR.                           06970042
070600                                                                  06980042
070700     DISPLAY '****************************************'           06990042
070800     DISPLAY '*************** SAKRP010 ***************'           07000042
070900     DISPLAY '****************************************'           07010042
071000     MOVE PV-SUM-CURSOR-CNT      TO PV-EDIT-MASK                  07020042
071100     INSPECT PV-EDIT-MASK REPLACING LEADING SPACE BY '.'          07030042
071200     DISPLAY 'SUMMARY ROWS FETCHED...........'                    07040042
071300         PV-EDIT-MASK                                             07050042
071400     DISPLAY '****************************************'           07060042
071500     DISPLAY '****************************************'           07070042
071600     DISPLAY '****************************************'           07080042
071700                                                                  07090042
071800     GOBACK.                                                      07100042
071900                                                                  07110042
072000******************************************************************07120042
072100* 1000-INITIALIZE-PROGRAM                                         07130042
072200*     OPEN FILES, PROCESS CONTROL CARD, FORMAT REPORT HEADINGS,   07140042
072300*     OPEN SUMMARY-CURSOR, ATTEMPT FIRST FETCH OF CURSOR.         07150042
072400******************************************************************07160042
072500                                                                  07170042
072600 1000-INITIALIZE-PROGRAM.                                         07180042
072700                                                                  07190042
072800     OPEN INPUT  POS-DATE-CARD-FILE                               07200042
072900                 HEADING-FILE                                     07210042
073000          OUTPUT SUMMARY-REPORT-FILE.                             07220042
073100                                                                  07230042
073200     PERFORM 1100-PROCESS-CONTROL-CARD.                           07240042
073300                                                                  07250042
073400     PERFORM 1400-POPULATE-DATE-TABLE                             07260042
073500         VARYING PV-SUMM-SUB FROM 2 BY 1                          07270042
073600             UNTIL PV-SUMM-SUB GREATER THAN 6                     07280042
073700                                                                  07290042
073800*    PERFORM                                                      07300042
073900*        VARYING PV-DATE-SUB FROM 1 BY 1                          07310042
074000*            UNTIL PV-DATE-SUB GREATER THAN 7                     07320042
074100*        DISPLAY 'SUBSCRIPT - ' PV-DATE-SUB ' DATE - '            07330042
074200*            SUMMARY-DATE (PV-DATE-SUB)                           07340042
074300*    END-PERFORM                                                  07350042
074400                                                                  07360042
074500     INITIALIZE TOTAL-SUMMARY-TABLE.                              07370042
074600                                                                  07380042
074700     PERFORM 1900-FORMAT-HEADINGS.                                07390042
074800******************************************************************07400042
074900* 1100-PROCESS-CONTROL-CARD                                       07410042
075000*     READ CONTROL CARD TO GET POS DATE IN MMDDYY FORMAT.  CALL   07420042
075100*     DATE ROUTINE TO CONVERT DATE TO A CCYY-MM-DD PROCESS DATE.  07430042
075200******************************************************************07440042
075300                                                                  07450042
075400 1100-PROCESS-CONTROL-CARD.                                       07460042
075500                                                                  07470042
075600     PERFORM 1200-READ-CONTROL-CARD.                              07480042
075700                                                                  07490042
075800     IF PS-END-OF-CARD-FILE OR                                    07500042
075900        PS-END-OF-HEADING                                         07510042
076000         MOVE '1100-PROCESS-CONTROL-CARD'  TO PV-PARAGRAPH-NAME   07520042
076100         MOVE 'NO CONTROL CARD TO PROCESS' TO PV-OPERATION-MSG-1  07530042
076200         SET AC-CONTROL-CARD-ERROR TO TRUE                        07540042
076300         PERFORM 9999-ABEND                                       07550042
076400     END-IF.                                                      07560042
076500                                                                  07570042
076600     DISPLAY PC-CURRENT-PROGRAM-NAME                              07580042
076700             ' - CONTROL CARD = (' CC-CONTROL-CARD-DISPLAY  ')'.  07590042
076800                                                                  07600042
076900     PERFORM 1300-CONVERT-INPUT-DATE.                             07610042
077000******************************************************************07620042
077100* 1200-READ-CONTROL-CARD                                          07630042
077200*     READ DATE CONTROL CARD.                                     07640042
077300******************************************************************07650042
077400                                                                  07660042
077500 1200-READ-CONTROL-CARD.                                          07670042
077600                                                                  07680042
077700     READ POS-DATE-CARD-FILE INTO CC-CONTROL-CARD                 07690042
077800        AT END                                                    07700042
077900           SET PS-END-OF-CARD-FILE TO TRUE.                       07710042
078000                                                                  07720042
078100     READ HEADING-FILE       INTO HEADING-CARD                    07730042
078200        AT END                                                    07740042
078300           SET PS-END-OF-HEADING   TO TRUE.                       07750042
078400                                                                  07760042
078500     CLOSE POS-DATE-CARD-FILE                                     07770042
078600           HEADING-FILE.                                          07780042
078700                                                                  07790042
078800******************************************************************07800042
078900* 1300-CONVERT-INPUT-DATE                                         07810042
079000*     CALL KOHLS CALENDAR ROUTINE:                                07820042
079100*         PASS: CONTROL CARD POS DATE (MMDDYY FORMAT).            07830042
079200*       RETURN: ACTUAL CALENDAR DB2 ISO DATE (CCYY-MM-DD FORMAT). 07840042
079300******************************************************************07850042
079400                                                                  07860042
079500 1300-CONVERT-INPUT-DATE.                                         07870042
079600                                                                  07880042
079700     INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              07890042
079800                                                                  07900042
079900     SET  DPG51-ACTUAL-CALENDAR-ONLY   TO TRUE.                   07910042
080000     SET  DPG51-DO-NOT-INCR-DECR-DATE  TO TRUE.                   07920042
080100     SET  DPG52-LK-DTE-ISO-FMT         TO TRUE.                   07930042
080200     MOVE CC-DATE-ISO                  TO DPG52-LK-DATE-INPUT.    07940042
080300                                                                  07950042
080400     CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51 DPG52 DPG53    07960042
080500                                             DPG54 DPG55 DPG56.   07970042
080600                                                                  07980042
080700     EVALUATE TRUE                                                07990042
080800         WHEN DPG54-SEVERE-ERROR                                  08000042
080900             MOVE '1300-CONVERT-INPUT-DATE'                       08010042
081000                                           TO PV-PARAGRAPH-NAME   08020042
081100             MOVE 'ERROR CONVERTING INPUT CARD DATE'              08030042
081200                                           TO PV-OPERATION-MSG-1  08040042
081300             SET AC-CALENDAR-ROUTINE-ERROR TO TRUE                08050042
081400             MOVE DPG54-ERROR-MESSAGE      TO PV-OPERATION-MSG-2  08060042
081500             PERFORM 9999-ABEND                                   08070042
081600     END-EVALUATE.                                                08080042
081700                                                                  08090042
081800     MOVE DPG55-DB2-ISO-DATE-FMT       TO PV-POS-CCYY-MM-DD.      08100042
081900     MOVE DPG55-1ST-WKDY-DB2ISO-FMT    TO SUMMARY-DATE (1).       08110042
082000     MOVE DPG55-1ST-WKDY-DB2ISO-FMT    TO PV-START-DATE           08120042
082100     MOVE DPG55-LAST-WKDY-DB2ISO-FMT   TO SUMMARY-DATE (7).       08130042
082200     MOVE DPG55-LAST-WKDY-DB2ISO-FMT   TO PV-END-DATE.            08140042
082300******************************************************************08150042
082400* 1400-POPULATE-DATE-TABLE                                        08160042
082500*     CALL KOHLS CALENDAR ROUTINE:                                08170042
082600*         PASS: DATE IN CCYY-MM-DD                                08180042
082700*       RETURN: NEXT CALENDAR DB2 ISO DATE (CCYY-MM-DD FORMAT).   08190042
082800******************************************************************08200042
082900                                                                  08210042
083000 1400-POPULATE-DATE-TABLE.                                        08220042
083100                                                                  08230042
083200     INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              08240042
083300                                                                  08250042
083400     COMPUTE PV-DATE-SUB = PV-SUMM-SUB - 1.                       08260042
083500                                                                  08270042
083600     MOVE SUMMARY-DATE (PV-DATE-SUB)   TO DPG52-LK-DATE-INPUT.    08280042
083700     SET  DPG52-LK-DTE-ISO-FMT         TO TRUE.                   08290042
083800     SET  DPG51-ACTUAL-CALENDAR-ONLY   TO TRUE.                   08300042
083900     SET  DPG51-INCREMENT-DATE         TO TRUE.                   08310042
084000     MOVE 1                            TO DPG51-INCR-DECR-DAYS-9. 08320042
084100                                                                  08330042
084200     CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51 DPG52 DPG53    08340042
084300                                             DPG54 DPG55 DPG56.   08350042
084400                                                                  08360042
084500     EVALUATE TRUE                                                08370042
084600         WHEN DPG54-SEVERE-ERROR                                  08380042
084700         WHEN DPG54-DATE-INVALID                                  08390042
084800             MOVE '1400-POPULATE-DATE-TABLE'                      08400042
084900                                           TO PV-PARAGRAPH-NAME   08410042
085000             MOVE 'ERROR POPULATING DATE TABLE'                   08420042
085100                                           TO PV-OPERATION-MSG-1  08430042
085200             SET AC-CALENDAR-ROUTINE-ERROR TO TRUE                08440042
085300             MOVE DPG54-ERROR-MESSAGE      TO PV-OPERATION-MSG-2  08450042
085400             PERFORM 9999-ABEND                                   08460042
085500     END-EVALUATE.                                                08470042
085600                                                                  08480042
085700     MOVE DPG55-DB2-ISO-DATE-FMT TO SUMMARY-DATE (PV-SUMM-SUB).   08490042
085800                                                                  08500042
085900******************************************************************08510042
086000* 1900-FORMAT-HEADINGS                                            08520042
086100*     GET CURRENT DATE AND TIME FROM SYSTEM.                      08530042
086200*     FORMAT REPORT FIELDS IN THE TOP PAGE HEADING LINE.          08540042
086300*     FORMAT HEADING LINE 2 WITH CONVERTED POS DATE.              08550042
086400******************************************************************08560042
086500 1900-FORMAT-HEADINGS.                                            08570042
086600                                                                  08580042
086700     MOVE FUNCTION CURRENT-DATE (1:8) TO PV-CURR-DATE-CCYYMMDD.   08590042
086800     ACCEPT PV-CURR-TIME FROM TIME.                               08600042
086900                                                                  08610042
087000     MOVE PV-CURR-DATE-MM             TO DP132-RUN-MONTH.         08620042
087100     MOVE PV-CURR-DATE-DD             TO DP132-RUN-DAY.           08630042
087200     MOVE PV-CURR-DATE-CCYY           TO DP132-RUN-YEAR.          08640042
087300                                                                  08650042
087400     MOVE PV-CURR-TIME-HH             TO DP132-RUN-HOUR.          08660042
087500     MOVE PV-CURR-TIME-MM             TO DP132-RUN-MINUTE.        08670042
087600     MOVE PC-CURRENT-PROGRAM-NAME     TO DP132-PROGRAM-NAME.      08680042
087700     MOVE PC-REPORT-NBR-1             TO DP132-REPORT-NUMBER.     08690042
087800                                                                  08700042
087900     MOVE SUMMARY-DATE (7)            TO PV-POS-CCYY-MM-DD.       08710042
088000     MOVE PV-POS-MM                   TO PV-HEADER-MM.            08720042
088100     MOVE '/'                         TO PV-HEADER-SLASH-1.       08730042
088200     MOVE PV-POS-DD                   TO PV-HEADER-DD.            08740042
088300     MOVE '/'                         TO PV-HEADER-SLASH-2.       08750042
088400     MOVE PV-POS-YY                   TO PV-HEADER-YY.            08760042
088500                                                                  08770042
088600                                                                  08780042
088700     IF HEADING-CARD                  =  PV-SAK110                08790042
088800        MOVE HEADING-CARD             TO H2-HEADING-NAME-2        08800042
088900        MOVE SPACES                   TO H2-FILLER-1              08810042
089000                                         H2-FILLER-2              08820042
089100        MOVE PV-HEADER-DATE           TO H2-ENDING-DATE-2         08830042
089200     ELSE                                                         08840042
089300        MOVE HEADING-CARD             TO H2-HEADING-NAME-1        08850042
089400        MOVE PV-HEADER-DATE           TO H2-ENDING-DATE-1         08860042
089500     END-IF.                                                      08870042
089600                                                                  08880042
089700******************************************************************08890042
089800* 2000-CASH-SALES-REPORT.                                         08900042
089900*     CREATE THE WEEKLY CASH SALES REPORT                         08910042
090000******************************************************************08920042
090100 2000-CASH-SALES-REPORT.                                          08930042
090200                                                                  08940042
090300     INITIALIZE SUMMARY-TABLE.                                    08950042
090400                                                                  08960042
090500     INITIALIZE PV-DR-CR-ACCUMULATORS.                            08970042
090600                                                                  08980042
090700     PERFORM 7000-GET-STORE-NAME                                  08990042
090800                                                                  09000042
090900     MOVE SAADSU-STR-NBR         TO HDR3-STORE-NBR                09010042
091000     MOVE XST00001-LOC-NM        TO HDR3-STORE-NAME               09020042
091100                                                                  09030042
091200     MOVE SAADSU-STR-NBR         TO PV-SAVE-STR-NBR               09040042
091300     MOVE SAADSU-SLS-DTE         TO PV-SAVE-SLS-DTE               09050042
091400                                                                  09060042
091500     PERFORM                                                      09070042
091600         VARYING PV-DATE-SUB FROM 1 BY 1                          09080042
091700             UNTIL SUMMARY-DATE (PV-DATE-SUB)                     09090042
091800                     EQUAL PV-SAVE-SLS-DTE                        09100042
091900                 OR PV-DATE-SUB GREATER THAN 7                    09110042
092000     END-PERFORM                                                  09120042
092100                                                                  09130042
092200     PERFORM 2100-LOAD-SUMMARY                                    09140042
092300         UNTIL SAADSU-STR-NBR NOT EQUAL PV-SAVE-STR-NBR           09150042
092400             OR PS-END-OF-SUM-CURSOR.                             09160042
092500                                                                  09170042
092600     PERFORM 3000-GET-MISC-CASH-RECEIVED                          09180042
092700         VARYING PV-DATE-SUB FROM 1 BY 1                          09190042
092800             UNTIL PV-DATE-SUB GREATER THAN 7                     09200042
092900                                                                  09210042
093000     PERFORM 3100-GET-MISC-CASH-PAID-OUT                          09220042
093100         VARYING PV-DATE-SUB FROM 1 BY 1                          09230042
093200             UNTIL PV-DATE-SUB GREATER THAN 7                     09240042
093300                                                                  09250042
093400     PERFORM 3200-GET-CASH-DEPOSIT                                09260042
093500         VARYING PV-DATE-SUB FROM 1 BY 1                          09270042
093600             UNTIL PV-DATE-SUB GREATER THAN 7                     09280042
093700                                                                  09290042
093800     PERFORM 3300-GET-CHECK-DEPOSIT                               09300042
093900         VARYING PV-DATE-SUB FROM 1 BY 1                          09310042
094000             UNTIL PV-DATE-SUB GREATER THAN 7                     09320042
094100                                                                  09330042
094200     PERFORM 2030-NEGATE-SUMMARY                                  09340042
094300         VARYING PV-DATE-SUB FROM 1 BY 1                          09350042
094400             UNTIL PV-DATE-SUB GREATER THAN 7                     09360042
094500         AFTER PV-SUMM-SUB FROM 1 BY 1                            09370042
094600             UNTIL PV-SUMM-SUB GREATER THAN 38.                   09380045
094700                                                                  09390042
094800     PERFORM 8000-PRINT-ROUTINE.                                  09400042
094900                                                                  09410042
095000     PERFORM 2020-TOTAL-SUMMARY                                   09420042
095100         VARYING PV-DATE-SUB FROM 1 BY 1                          09430042
095200             UNTIL PV-DATE-SUB GREATER THAN 7                     09440042
095300         AFTER PV-SUMM-SUB FROM 1 BY 1                            09450042
095400             UNTIL PV-SUMM-SUB GREATER THAN 38.                   09460045
095500                                                                  09470042
095600     MOVE SPACES                 TO CASH-TABLE                    09480042
095700                                                                  09490042
095800     MOVE ZERO                   TO PV-PAID-SUB                   09500042
095900                                                                  09510042
096000     MOVE ZERO                   TO PV-CASH-SUB                   09520042
096100                                                                  09530042
096200     MOVE ZERO                   TO PV-TOT-PAID-OUT               09540042
096300                                                                  09550042
096400     MOVE ZERO                   TO PV-TOT-CASH                   09560042
096500                                                                  09570042
096600     PERFORM 4700-OPEN-CASH-CURSOR                                09580042
096700                                                                  09590042
096800     PERFORM 4800-FETCH-CASH-CURSOR                               09600042
096900                                                                  09610042
097000     SET PS-NOT-END-OF-CASH-CURSOR TO TRUE                        09620042
097100                                                                  09630042
097200     PERFORM 4000-CASH-DETAIL-REPORT                              09640042
097300         UNTIL PS-END-OF-CASH-CURSOR                              09650042
097400                                                                  09660042
097500     PERFORM 4900-CLOSE-CASH-CURSOR                               09670042
097600                                                                  09680042
097700     IF PV-PAID-SUB GREATER THAN PV-CASH-SUB                      09690042
097800         MOVE PV-PAID-SUB        TO PV-MAX-ENTRIES                09700042
097900     ELSE                                                         09710042
098000         MOVE PV-CASH-SUB        TO PV-MAX-ENTRIES                09720042
098100     END-IF                                                       09730042
098200                                                                  09740042
098300     ADD PC-LINE-LIMIT 1         GIVING PV-LINE-CNT               09750042
098400                                                                  09760042
098500     PERFORM 4100-PRINT-TABLE                                     09770042
098600         VARYING PV-TABL-SUB FROM 1 BY 1                          09780042
098700             UNTIL PV-TABL-SUB GREATER THAN PV-MAX-ENTRIES        09790042
098800                                                                  09800042
098900     IF PV-MAX-ENTRIES NOT EQUAL ZERO                             09810042
099000         MOVE ALL '-'            TO DTL2-PAID-OUT                 09820042
099100         MOVE ALL '-'            TO DTL2-CASH                     09830042
099200         MOVE +1                 TO PV-LINE-SPACING               09840042
099300         MOVE D2-DETAIL-LINE-2   TO PV-PRINT-RECORD               09850042
099400         PERFORM 9900-WRITE-REPORT-LINE                           09860042
099500         MOVE PV-TOT-PAID-OUT    TO PAID-OUT-CASH-TOT             09870042
099600         MOVE PAID-OUT-CASH-TOTAL                                 09880042
099700                                 TO DTL2-PAID-OUT                 09890042
099800         MOVE PV-TOT-CASH        TO PAID-OUT-CASH-TOT             09900042
099900         MOVE PAID-OUT-CASH-TOTAL                                 09910042
100000                                 TO DTL2-CASH                     09920042
100100         MOVE +1                 TO PV-LINE-SPACING               09930042
100200         MOVE D2-DETAIL-LINE-2   TO PV-PRINT-RECORD               09940042
100300         PERFORM 9900-WRITE-REPORT-LINE                           09950042
100400     END-IF.                                                      09960042
100500                                                                  09970042
100600     SET PS-FIRST-TOTAL TO TRUE.                                  09980042
100700                                                                  09990042
100800     PERFORM 5000-DR-CR-TOTALS                                    10000042
100900         VARYING PV-DATE-SUB FROM 1 BY 1                          10010042
101000             UNTIL PV-DATE-SUB GREATER THAN 8.                    10020042
101100                                                                  10030042
101200******************************************************************10040042
101300* 2020-TOTAL-SUMMARY                                              10050042
101400*     ADD STORE SUMMARY TO TOTAL SUMMARY                          10060042
101500******************************************************************10070042
101600                                                                  10080042
101700 2020-TOTAL-SUMMARY.                                              10090042
101800                                                                  10100042
101900     ADD SUMMARY (PV-DATE-SUB, PV-SUMM-SUB)                       10110042
102000                     TO TOTAL-SUMMARY (PV-DATE-SUB, PV-SUMM-SUB). 10120042
102100                                                                  10130042
102200******************************************************************10140042
102300* 2030-NEGATE-SUMMARY                                             10150042
102400*     NEGATE SUMMARY TO PRINT AS POSITIVE                         10160042
102500******************************************************************10170042
102600                                                                  10180042
102700 2030-NEGATE-SUMMARY.                                             10190042
102800                                                                  10200042
102900     IF NEGATE-VALUE (PV-SUMM-SUB)                                10210042
103000         COMPUTE SUMMARY (PV-DATE-SUB, PV-SUMM-SUB)               10220042
103100             = SUMMARY (PV-DATE-SUB, PV-SUMM-SUB) * PC-NEG-ONE    10230042
103200     END-IF.                                                      10240042
103300                                                                  10250042
103400******************************************************************10260042
103500* 2100-LOAD-SUMMARY.                                              10270042
103600*     LOAD SUMMARY ROWS TO TABLE.                                 10280042
103700******************************************************************10290042
103800 2100-LOAD-SUMMARY.                                               10300042
103900                                                                  10310042
104000     IF SAADSU-SLS-DTE NOT EQUAL PV-SAVE-SLS-DTE                  10320042
104100         PERFORM                                                  10330042
104200             VARYING PV-DATE-SUB FROM 1 BY 1                      10340042
104300                 UNTIL SUMMARY-DATE (PV-DATE-SUB)                 10350042
104400                         EQUAL SAADSU-SLS-DTE                     10360042
104500                     OR PV-DATE-SUB GREATER THAN 7                10370042
104600         END-PERFORM                                              10380042
104700         MOVE SAADSU-SLS-DTE     TO PV-SAVE-SLS-DTE               10390042
104800     END-IF                                                       10400042
104900                                                                  10410042
105000     EVALUATE SAADSU-SUM-CTG-CDE                                  10420042
105100         WHEN 'STM'                                               10430042
105200             MOVE SAADSU-ADJ-AMT                                  10440042
105300                                 TO SUMMARY (PV-DATE-SUB, 2)      10450042
105400         WHEN 'TAX'                                               10460042
105500             MOVE SAADSU-ADJ-AMT                                  10470042
105600                                 TO SUMMARY (PV-DATE-SUB, 3)      10480042
N2I201         WHEN 'TPC'                                               10490042
105800             MOVE SAADSU-ADJ-AMT                                  10500042
105900                                 TO SUMMARY (PV-DATE-SUB, 4)      10510042
106000         WHEN 'GDS'                                               10520042
106100             MOVE SAADSU-ADJ-AMT                                  10530042
106200                                 TO SUMMARY (PV-DATE-SUB, 5)      10540042
106300         WHEN 'TMR'                                               10550042
106400             MOVE SAADSU-ADJ-AMT                                  10560042
106500                                 TO SUMMARY (PV-DATE-SUB, 6)      10570042
106600         WHEN 'CRI'                                               10580042
106700             MOVE SAADSU-ADJ-AMT                                  10590042
106800                                 TO SUMMARY (PV-DATE-SUB, 7)      10600042
106900         WHEN 'KMI'                                               10610042
107000             MOVE SAADSU-ADJ-AMT                                  10620042
107100                                 TO SUMMARY (PV-DATE-SUB, 8)      10630042
107200         WHEN 'POR'                                               10640042
107300             MOVE SAADSU-ADJ-AMT                                  10650042
107400                                 TO SUMMARY (PV-DATE-SUB, 9)      10660042
107500         WHEN 'CSH'                                               10670042
107600             MOVE SAADSU-ADJ-AMT                                  10680042
107700                                 TO SUMMARY (PV-DATE-SUB, 10)     10690042
107800         WHEN 'TCK'                                               10700042
107900             MOVE SAADSU-ADJ-AMT                                  10710042
108000                                 TO SUMMARY (PV-DATE-SUB, 11)     10720042
108100         WHEN 'VCK'                                               10730042
108200             MOVE SAADSU-ADJ-AMT                                  10740042
108300                                 TO SUMMARY (PV-DATE-SUB, 12)     10750042
108400         WHEN 'MGT'                                               10760042
108500             MOVE SAADSU-ADJ-AMT                                  10770042
108600                                 TO SUMMARY (PV-DATE-SUB, 13)     10780042
108700         WHEN 'CHK'                                               10790042
108800             MOVE SAADSU-ADJ-AMT                                  10800042
108900                                 TO SUMMARY (PV-DATE-SUB, 14)     10810042
109000         WHEN 'GTT'                                               10820042
109100             MOVE SAADSU-ADJ-AMT                                  10830042
109200                                 TO SUMMARY (PV-DATE-SUB, 15)     10840042
109300         WHEN 'GDT'                                               10850042
109400             MOVE SAADSU-ADJ-AMT                                  10860042
109500                                 TO SUMMARY (PV-DATE-SUB, 16)     10870042
109600         WHEN 'KMT'                                               10880042
109700             MOVE SAADSU-ADJ-AMT                                  10890042
109800                                 TO SUMMARY (PV-DATE-SUB, 17)     10900042
109900         WHEN 'POS'                                               10910042
110000             MOVE SAADSU-ADJ-AMT                                  10920042
110100                                 TO SUMMARY (PV-DATE-SUB, 18)     10930042
110200         WHEN 'BCN'                                               10940042
110300             MOVE SAADSU-ADJ-AMT                                  10950042
110400                                 TO SUMMARY (PV-DATE-SUB, 19)     10960042
110500         WHEN 'NCN'                                               10970042
110600             MOVE SAADSU-ADJ-AMT                                  10980042
110700                                 TO SUMMARY (PV-DATE-SUB, 20)     10990042
110800         WHEN 'AEN'                                               11000042
110900             MOVE SAADSU-ADJ-AMT                                  11010042
111000                                 TO SUMMARY (PV-DATE-SUB, 21)     11020042
111100         WHEN 'DBN'                                               11030042
111200             MOVE SAADSU-ADJ-AMT                                  11040042
111300                                 TO SUMMARY (PV-DATE-SUB, 22)     11050042
111400         WHEN 'KCN'                                               11060042
111500             MOVE SAADSU-ADJ-AMT                                  11070042
111600                                 TO SUMMARY (PV-DATE-SUB, 23)     11080042
111700         WHEN 'KCP'                                               11090042
111800             MOVE SAADSU-ADJ-AMT                                  11100042
111900                                 TO SUMMARY (PV-DATE-SUB, 24)     11110042
SEPHOR         WHEN 'SCN'                                               11120042
112100             MOVE SAADSU-ADJ-AMT                                  11130042
112200                                 TO SUMMARY (PV-DATE-SUB, 25)     11140042
PAYVEN         WHEN 'PPN'                                               11150042
PAYVEN             MOVE SAADSU-ADJ-AMT                                  11160042
PAYVEN                                 TO SUMMARY (PV-DATE-SUB, 26)     11170042
PAYVEN*        WHEN 'UCV'                                               11180052
PAYVEN*            MOVE SAADSU-ADJ-AMT                                  11190052
PAYVEN*                                TO SUMMARY (PV-DATE-SUB, 26)     11200052
PAYVEN         WHEN 'VMN'                                               11210042
PAYVEN             MOVE SAADSU-ADJ-AMT                                  11220042
PAYVEN                                 TO SUMMARY (PV-DATE-SUB, 27)     11230042
112600         WHEN 'ROS'                                               11240042
112700             MOVE SAADSU-ADJ-AMT                                  11250042
PAYVEN                                 TO SUMMARY (PV-DATE-SUB, 28)     11260049
112900         WHEN 'BB '                                               11270042
113000             MOVE SAADSU-ADJ-AMT                                  11280042
PAYVEN                                 TO SUMMARY (PV-DATE-SUB, 29)     11290048
113200         WHEN 'CUD'                                               11300042
113300             MOVE SAADSU-ADJ-AMT                                  11310042
PAYVEN                                 TO SUMMARY (PV-DATE-SUB, 30)     11320048
113500* REQUESTED BY CORENE PRAH, REPLACE WITH 'CSH' AMOUNTS            11330042
113600*        WHEN 'CSR'                                               11340042
113700*            MOVE SAADSU-ADJ-AMT                                  11350042
113800*                                TO SUMMARY (PV-DATE-SUB, 29)     11360042
PAYVEN*  THIS IS NOT BEING USED BELOW 05/09/23                          11370046
PAYVEN*        WHEN 'CHR'                                               11371046
PAYVEN*            MOVE SAADSU-ADJ-AMT                                  11380045
PAYVEN*                                TO SUMMARY (PV-DATE-SUB, 32)     11390045
114200         WHEN 'EB '                                               11400042
114300             MOVE SAADSU-ADJ-AMT                                  11410042
114400                                 TO SUMMARY (PV-DATE-SUB, 36)     11420045
114500         WHEN 'SOS'                                               11430042
114600             MOVE SAADSU-ADJ-AMT                                  11440042
114700                                 TO SUMMARY (PV-DATE-SUB, 37)     11450045
114800         WHEN 'COH'                                               11460042
114900             MOVE SAADSU-ADJ-AMT                                  11470042
115000                                 TO SUMMARY (PV-DATE-SUB, 38)     11480045
115100     END-EVALUATE                                                 11490042
115200                                                                  11500042
115300     PERFORM 2800-FETCH-SUMMARY-CURSOR.                           11510042
115400******************************************************************11520042
115500* 2700-OPEN-SUMMARY-CURSOR.                                       11530042
115600*     OPEN SUMMARY CURSOR                                         11540042
115700******************************************************************11550042
115800 2700-OPEN-SUMMARY-CURSOR.                                        11560042
115900                                                                  11570042
116000     EXEC SQL                                                     11580042
116100          OPEN SUMMARY-CURSOR                                     11590042
116200     END-EXEC.                                                    11600042
116300                                                                  11610042
116400     EVALUATE TRUE                                                11620042
116500         WHEN SQLCODE = ZERO                                      11630042
116600              CONTINUE                                            11640042
116700         WHEN SQLWARN0 NOT EQUAL SPACE                            11650042
116800         WHEN SQLCODE NOT EQUAL ZERO                              11660042
116900             MOVE '2700-OPEN-SUMMARY-CURSOR'                      11670042
117000                                            TO PV-PARAGRAPH-NAME  11680042
117100             MOVE 'ERROR ON OPEN OF SUMMARY-CURSOR'               11690042
117200                                            TO PV-DB2-OPERATION   11700042
117300             PERFORM 9100-SQL-ABEND                               11710042
117400     END-EVALUATE.                                                11720042
117500******************************************************************11730042
117600* 2800-FETCH-SUMMARY-CURSOR                                       11740042
117700******************************************************************11750042
117800 2800-FETCH-SUMMARY-CURSOR.                                       11760042
117900                                                                  11770042
118000     EXEC SQL                                                     11780042
118100          FETCH SUMMARY-CURSOR                                    11790042
118200           INTO :SAADSU-SLS-DTE                                   11800042
118300               ,:SAADSU-STR-NBR                                   11810042
118400               ,:SAADSU-SUM-CTG-CDE                               11820042
118500               ,:SAADSU-ADJ-AMT                                   11830042
118600     END-EXEC.                                                    11840042
118700                                                                  11850042
118800     EVALUATE TRUE                                                11860042
118900         WHEN SQLCODE = ZERO                                      11870042
119000             ADD 1               TO PV-SUM-CURSOR-CNT             11880042
119100         WHEN SQLCODE = PC-ROW-NOT-FOUND                          11890042
119200             SET PS-END-OF-SUM-CURSOR TO TRUE                     11900042
119300         WHEN SQLWARN0 NOT EQUAL SPACE                            11910042
119400         WHEN SQLCODE NOT EQUAL ZERO                              11920042
119500             MOVE '2800-FETCH-SUMMARY-CURSOR'                     11930042
119600                                            TO PV-PARAGRAPH-NAME  11940042
119700             MOVE 'ERROR ON FETCH OF SETTLEMENT-CURSOR'           11950042
119800                                            TO PV-DB2-OPERATION   11960042
119900             PERFORM 9100-SQL-ABEND                               11970042
120000     END-EVALUATE.                                                11980042
120100******************************************************************11990042
120200* 2900-CLOSE-SUMMARY-CURSOR                                       12000042
120300******************************************************************12010042
120400 2900-CLOSE-SUMMARY-CURSOR.                                       12020042
120500                                                                  12030042
120600     EXEC SQL                                                     12040042
120700          CLOSE SUMMARY-CURSOR                                    12050042
120800     END-EXEC.                                                    12060042
120900                                                                  12070042
121000     EVALUATE TRUE                                                12080042
121100         WHEN SQLCODE = ZERO                                      12090042
121200              CONTINUE                                            12100042
121300         WHEN SQLWARN0 NOT EQUAL SPACE                            12110042
121400         WHEN SQLCODE NOT EQUAL ZERO                              12120042
121500             MOVE '2900-CLOSE-SUMMARY-CURSOR'                     12130042
121600                                            TO PV-PARAGRAPH-NAME  12140042
121700             MOVE 'ERROR ON CLOSE OF SUMMARY-CURSOR'              12150042
121800                                            TO PV-DB2-OPERATION   12160042
121900             PERFORM 9100-SQL-ABEND                               12170042
122000     END-EVALUATE.                                                12180042
122100 3000-GET-MISC-CASH-RECEIVED.                                     12190042
122200                                                                  12200042
122300     MOVE ZERO                   TO SAADPC-ADJ-CSH-AMT            12210042
122400                                                                  12220042
122500     MOVE SUMMARY-DATE (PV-DATE-SUB)                              12230042
122600                                 TO SAADPC-SLS-DTE                12240042
122700     MOVE PV-SAVE-STR-NBR        TO SAADPC-STR-NBR                12250042
122800     MOVE PC-LIT-C               TO SAADPC-TYP-CDE                12260042
122900                                                                  12270042
123000     EXEC SQL                                                     12280042
123100         SELECT SUM(ADJ_CSH_AMT)                                  12290042
123200         INTO   :SAADPC-ADJ-CSH-AMT                               12300042
123300         FROM  TSAADPC                                            12310042
123400         WHERE SLS_DTE = :SAADPC-SLS-DTE                          12320042
123500           AND STR_NBR = :SAADPC-STR-NBR                          12330042
123600           AND TYP_CDE = :SAADPC-TYP-CDE                          12340042
123700           AND ADJ_CSH_AMT < 0                                    12350042
123800         WITH UR                                                  12360042
123900     END-EXEC                                                     12370042
124000                                                                  12380042
124100                                                                  12390042
124200     EVALUATE TRUE                                                12400042
124300         WHEN SQLCODE = ZERO                                      12410042
124400             ADD  SAADPC-ADJ-CSH-AMT                              12420042
124500                    TO PV-ACCUM-CR-DR (PV-DATE-SUB)               12430042
124600         WHEN SQLCODE = -305                                      12440042
124700             CONTINUE                                             12450042
124800         WHEN SQLWARN0 NOT EQUAL SPACE                            12460042
124900         WHEN SQLCODE NOT EQUAL ZERO                              12470042
125000             MOVE '3000-GET-MISC-CASH-RECEIVED'                   12480042
125100                                            TO PV-PARAGRAPH-NAME  12490042
125200             MOVE 'ERROR ON SELECT FROM TSAADPC  '                12500042
125300                                            TO PV-DB2-OPERATION   12510042
125400             PERFORM 9100-SQL-ABEND                               12520042
125500     END-EVALUATE.                                                12530042
125600                                                                  12540042
125700     MOVE ZERO                   TO SAADPC-ADJ-CSH-AMT            12550042
125800                                                                  12560042
125900     EXEC SQL                                                     12570042
126000         SELECT SUM(ADJ_CSH_AMT)                                  12580042
126100         INTO   :SAADPC-ADJ-CSH-AMT                               12590042
126200         FROM  TSAADPC                                            12600042
126300         WHERE SLS_DTE = :SAADPC-SLS-DTE                          12610042
126400           AND STR_NBR = :SAADPC-STR-NBR                          12620042
126500           AND TYP_CDE = :SAADPC-TYP-CDE                          12630042
126600           AND ADJ_CSH_AMT > 0                                    12640042
126700         WITH UR                                                  12650042
126800     END-EXEC                                                     12660042
126900                                                                  12670042
127000     EVALUATE TRUE                                                12680042
127100         WHEN SQLCODE = ZERO                                      12690042
127200             ADD  SAADPC-ADJ-CSH-AMT                              12700042
127300                           TO PV-ACCUM-CR-CR (PV-DATE-SUB)        12710042
127400         WHEN SQLCODE = -305                                      12720042
127500             CONTINUE                                             12730042
127600         WHEN SQLWARN0 NOT EQUAL SPACE                            12740042
127700         WHEN SQLCODE NOT EQUAL ZERO                              12750042
127800             MOVE '3000-GET-MISC-CASH-RECEIVED'                   12760042
127900                                            TO PV-PARAGRAPH-NAME  12770042
128000             MOVE 'ERROR ON SELECT FROM TSAADPC  '                12780042
128100                                            TO PV-DB2-OPERATION   12790042
128200             PERFORM 9100-SQL-ABEND                               12800042
128300     END-EVALUATE.                                                12810042
128400                                                                  12820042
128500     COMPUTE SUMMARY (PV-DATE-SUB, 32)                            12830045
128600                               = PV-ACCUM-CR-CR (PV-DATE-SUB)     12850042
128700                               + PV-ACCUM-CR-DR (PV-DATE-SUB).    12860042
128800 3100-GET-MISC-CASH-PAID-OUT.                                     12870042
128900                                                                  12880042
129000     MOVE ZERO                   TO SAADPC-ADJ-CSH-AMT            12890042
129100                                                                  12900042
129200     MOVE SUMMARY-DATE (PV-DATE-SUB)                              12910042
129300                                 TO SAADPC-SLS-DTE                12920042
129400     MOVE PV-SAVE-STR-NBR        TO SAADPC-STR-NBR                12930042
129500     MOVE PC-LIT-P               TO SAADPC-TYP-CDE                12940042
129600                                                                  12950042
129700     EXEC SQL                                                     12960042
129800         SELECT SUM(ADJ_CSH_AMT)                                  12970042
129900         INTO   :SAADPC-ADJ-CSH-AMT                               12980042
130000         FROM  TSAADPC                                            12990042
130100         WHERE SLS_DTE = :SAADPC-SLS-DTE                          13000042
130200           AND STR_NBR = :SAADPC-STR-NBR                          13010042
130300           AND TYP_CDE = :SAADPC-TYP-CDE                          13020042
130400           AND ADJ_CSH_AMT < 0                                    13030042
130500         WITH UR                                                  13040042
130600     END-EXEC                                                     13050042
130700                                                                  13060042
130800                                                                  13070042
130900     EVALUATE TRUE                                                13080042
131000         WHEN SQLCODE = ZERO                                      13090042
131100             ADD  SAADPC-ADJ-CSH-AMT                              13100042
131200                      TO PV-ACCUM-CP-DR (PV-DATE-SUB)             13110042
131300         WHEN SQLCODE = -305                                      13120042
131400             CONTINUE                                             13130042
131500         WHEN SQLWARN0 NOT EQUAL SPACE                            13140042
131600         WHEN SQLCODE NOT EQUAL ZERO                              13150042
131700             MOVE '3100-GET-MISC-CASH-PAID-OUT'                   13160042
131800                                            TO PV-PARAGRAPH-NAME  13170042
131900             MOVE 'ERROR ON SELECT FROM TSAADPC  '                13180042
132000                                            TO PV-DB2-OPERATION   13190042
132100             PERFORM 9100-SQL-ABEND                               13200042
132200     END-EVALUATE.                                                13210042
132300                                                                  13220042
132400     MOVE ZERO                   TO SAADPC-ADJ-CSH-AMT            13230042
132500                                                                  13240042
132600     EXEC SQL                                                     13250042
132700         SELECT SUM(ADJ_CSH_AMT)                                  13260042
132800         INTO   :SAADPC-ADJ-CSH-AMT                               13270042
132900         FROM  TSAADPC                                            13280042
133000         WHERE SLS_DTE = :SAADPC-SLS-DTE                          13290042
133100           AND STR_NBR = :SAADPC-STR-NBR                          13300042
133200           AND TYP_CDE = :SAADPC-TYP-CDE                          13310042
133300           AND ADJ_CSH_AMT > 0                                    13320042
133400         WITH UR                                                  13330042
133500     END-EXEC                                                     13340042
133600                                                                  13350042
133700     EVALUATE TRUE                                                13360042
133800         WHEN SQLCODE = ZERO                                      13370042
133900             ADD  SAADPC-ADJ-CSH-AMT                              13380042
134000                       TO PV-ACCUM-CP-CR (PV-DATE-SUB)            13390042
134100         WHEN SQLCODE = -305                                      13400042
134200             CONTINUE                                             13410042
134300         WHEN SQLWARN0 NOT EQUAL SPACE                            13420042
134400         WHEN SQLCODE NOT EQUAL ZERO                              13430042
134500             MOVE '3100-GET-MISC-CASH-PAID-OUT'                   13440042
134600                                            TO PV-PARAGRAPH-NAME  13450042
134700             MOVE 'ERROR ON SELECT FROM TSAADPC  '                13460042
134800                                            TO PV-DB2-OPERATION   13470042
134900             PERFORM 9100-SQL-ABEND                               13480042
135000     END-EVALUATE.                                                13490042
135100                                                                  13500042
135200     COMPUTE SUMMARY (PV-DATE-SUB, 35)                            13510045
135300                               = PV-ACCUM-CP-CR (PV-DATE-SUB)     13512042
135400                               + PV-ACCUM-CP-DR (PV-DATE-SUB).    13513042
135500 3200-GET-CASH-DEPOSIT.                                           13514042
135600                                                                  13515042
135700     MOVE ZERO                   TO SAADDP-TNDR-AMT               13516042
135800                                                                  13517042
135900     MOVE SUMMARY-DATE (PV-DATE-SUB)                              13518042
136000                                 TO SAADDP-SLS-DTE                13519042
136100     MOVE PV-SAVE-STR-NBR        TO SAADDP-STR-NBR                13520042
136200     MOVE PC-LIT-00              TO SAADDP-TNDR-TYP-CDE           13530042
136300                                                                  13540042
136400     EXEC SQL                                                     13550042
136500         SELECT SUM(TNDR_AMT)                                     13560042
136600         INTO   :SAADDP-TNDR-AMT                                  13570042
136700         FROM  TSAADDP                                            13580042
136800         WHERE SLS_DTE = :SAADDP-SLS-DTE                          13590042
136900           AND STR_NBR = :SAADDP-STR-NBR                          13600042
137000           AND TNDR_TYP_CDE = :SAADDP-TNDR-TYP-CDE                13610042
137100         WITH UR                                                  13620042
137200     END-EXEC                                                     13630042
137300                                                                  13640042
137400     EVALUATE TRUE                                                13650042
137500         WHEN SQLCODE = ZERO                                      13660042
137600             MOVE SAADDP-TNDR-AMT                                 13670042
137700                                 TO SUMMARY (PV-DATE-SUB, 33)     13680045
137800         WHEN SQLCODE = -305                                      13700042
137900             CONTINUE                                             13710042
138000         WHEN SQLWARN0 NOT EQUAL SPACE                            13720042
138100         WHEN SQLCODE NOT EQUAL ZERO                              13730042
138200             MOVE '3200-GET-CASH-DEPOSIT'                         13740042
138300                                            TO PV-PARAGRAPH-NAME  13750042
138400             MOVE 'ERROR ON SELECT FROM TSAADDP  '                13760042
138500                                            TO PV-DB2-OPERATION   13770042
138600             PERFORM 9100-SQL-ABEND                               13780042
138700     END-EVALUATE.                                                13790042
138800 3300-GET-CHECK-DEPOSIT.                                          13800042
138900                                                                  13810042
139000     MOVE ZERO                   TO SAADDP-TNDR-AMT               13820042
139100                                                                  13830042
139200     MOVE SUMMARY-DATE (PV-DATE-SUB)                              13840042
139300                                 TO SAADDP-SLS-DTE                13850042
139400     MOVE PV-SAVE-STR-NBR        TO SAADDP-STR-NBR                13860042
139500     MOVE PC-LIT-01              TO SAADDP-TNDR-TYP-CDE           13870042
139600                                                                  13880042
139700     EXEC SQL                                                     13890042
139800         SELECT SUM(TNDR_AMT)                                     13900042
139900         INTO   :SAADDP-TNDR-AMT                                  13910042
140000         FROM  TSAADDP                                            13920042
140100         WHERE SLS_DTE = :SAADDP-SLS-DTE                          13930042
140200           AND STR_NBR = :SAADDP-STR-NBR                          13940042
140300           AND TNDR_TYP_CDE = :SAADDP-TNDR-TYP-CDE                13950042
140400         WITH UR                                                  13960042
140500     END-EXEC                                                     13970042
140600                                                                  13980042
140700     EVALUATE TRUE                                                13990042
140800         WHEN SQLCODE = ZERO                                      14000042
140900             MOVE SAADDP-TNDR-AMT                                 14010042
141000                                 TO SUMMARY (PV-DATE-SUB, 34)     14020045
141100         WHEN SQLCODE = -305                                      14040042
141200             CONTINUE                                             14050042
141300         WHEN SQLWARN0 NOT EQUAL SPACE                            14060042
141400         WHEN SQLCODE NOT EQUAL ZERO                              14070042
141500             MOVE '3200-GET-CHECK-DEPOSIT'                        14080042
141600                                            TO PV-PARAGRAPH-NAME  14090042
141700             MOVE 'ERROR ON SELECT FROM TSAADDP  '                14100042
141800                                            TO PV-DB2-OPERATION   14110042
141900             PERFORM 9100-SQL-ABEND                               14120042
142000     END-EVALUATE.                                                14130042
142100                                                                  14140042
142200******************************************************************14150042
142300* 4000-CASH-DETAIL-REPORT                                         14160042
142400*     CREATE A REPORT SHOWING DETAIL ADJUSTED PAID OUT AND        14170042
142500*     CASH RECEIVED                                               14180042
142600******************************************************************14190042
142700 4000-CASH-DETAIL-REPORT.                                         14200042
142800                                                                  14210042
142900     MOVE SPACES                 TO CASH-TABLE-EDIT               14220042
143000                                                                  14230042
143100     IF SAADPC-ADJ-CSH-AMT  NOT EQUAL ZERO                        14240042
143200         MOVE SAADPC-SLS-DTE     TO PV-POS-CCYY-MM-DD             14250042
143300         MOVE PV-POS-MM          TO PV-PRINT-MM                   14260042
143400         MOVE '/'                TO PV-PRINT-SLASH                14270042
143500         MOVE PV-POS-DD          TO PV-PRINT-DD                   14280042
143600         MOVE PV-PRINT-DATE      TO CASH-TBL-DATE                 14290042
143700         MOVE SAADPC-ADJ-CSH-AMT TO CASH-TBL-AMT                  14300042
143800         MOVE SAADPC-STR-CHRGD-NBR                                14310042
143900                                 TO CASH-TBL-LOC-CHRGD            14320042
144000         MOVE SAADPC-RSN-CDE     TO CASH-TBL-RSN-CDE              14330042
144100         MOVE SAADPC-CMNT-TXT    TO CASH-TBL-CMNT-TXT             14340042
144200                                                                  14350042
144300         IF SAADPC-TYP-CDE EQUAL 'P'                              14360042
144400             ADD 1               TO PV-PAID-SUB                   14370042
144500             MOVE CASH-TABLE-EDIT                                 14380042
144600                                 TO PAID-OUT-ENTRY (PV-PAID-SUB)  14390042
144700             ADD SAADPC-ADJ-CSH-AMT                               14400042
144800                                 TO PV-TOT-PAID-OUT               14410042
144900         ELSE                                                     14420042
145000             ADD 1               TO PV-CASH-SUB                   14430042
145100             MOVE CASH-TABLE-EDIT                                 14440042
145200                                 TO CASH-ENTRY (PV-CASH-SUB)      14450042
145300             ADD SAADPC-ADJ-CSH-AMT                               14460042
145400                                 TO PV-TOT-CASH                   14470042
145500         END-IF                                                   14480042
145600     END-IF                                                       14490042
145700                                                                  14500042
145800     PERFORM 4800-FETCH-CASH-CURSOR.                              14510042
145900                                                                  14520042
146000******************************************************************14530042
146100* 4100-PRINT-TABLE                                                14540042
146200*     PRINT THE ENTRIES IN THE TABLE OF PAID OUT AND              14550042
146300*     RECEIVED CASH                                               14560042
146400******************************************************************14570042
146500 4100-PRINT-TABLE.                                                14580042
146600                                                                  14590042
146700     IF PV-LINE-CNT GREATER THAN PC-LINE-LIMIT                    14600042
146800         PERFORM 9000-HEADER-ROUTINE                              14610042
146900         MOVE SPACES             TO D2-DETAIL-LINE-2              14620042
147000         MOVE PAID-OUT-HEADER    TO DTL2-PAID-OUT                 14630042
147100         MOVE CASH-HEADER        TO DTL2-CASH                     14640042
147200         MOVE +2                 TO PV-LINE-SPACING               14650042
147300         MOVE D2-DETAIL-LINE-2   TO PV-PRINT-RECORD               14660042
147400         PERFORM 9900-WRITE-REPORT-LINE                           14670042
147500         MOVE ALL '-'            TO DTL2-PAID-OUT                 14680042
147600         MOVE ALL '-'            TO DTL2-CASH                     14690042
147700         MOVE +1                 TO PV-LINE-SPACING               14700042
147800         MOVE D2-DETAIL-LINE-2   TO PV-PRINT-RECORD               14710042
147900         PERFORM 9900-WRITE-REPORT-LINE                           14720042
148000         MOVE PAID-OUT-CASH-HEADER-1                              14730042
148100                                 TO DTL2-PAID-OUT                 14740042
148200         MOVE PAID-OUT-CASH-HEADER-1                              14750042
148300                                 TO DTL2-CASH                     14760042
148400         MOVE +1                 TO PV-LINE-SPACING               14770042
148500         MOVE D2-DETAIL-LINE-2   TO PV-PRINT-RECORD               14780042
148600         MOVE PAID-OUT-CASH-HEADER-2                              14790042
148700                                 TO DTL2-PAID-OUT                 14800042
148800         MOVE PAID-OUT-CASH-HEADER-2                              14810042
148900                                 TO DTL2-CASH                     14820042
149000         MOVE +1                 TO PV-LINE-SPACING               14830042
149100         MOVE D2-DETAIL-LINE-2   TO PV-PRINT-RECORD               14840042
149200     END-IF                                                       14850042
149300                                                                  14860042
149400     MOVE SPACES                 TO D2-DETAIL-LINE-2              14870042
149500     MOVE PAID-OUT-ENTRY (PV-TABL-SUB)                            14880042
149600                                 TO DTL2-PAID-OUT                 14890042
149700     MOVE CASH-ENTRY (PV-TABL-SUB)                                14900042
149800                                 TO DTL2-CASH                     14910042
149900     MOVE +1                     TO PV-LINE-SPACING               14920042
150000     MOVE D2-DETAIL-LINE-2       TO PV-PRINT-RECORD.              14930042
150100     PERFORM 9900-WRITE-REPORT-LINE.                              14940042
150200******************************************************************14950042
150300* 4700-OPEN-CASH-CURSOR.                                          14960042
150400*     OPEN CASH CURSOR                                            14970042
150500******************************************************************14980042
150600 4700-OPEN-CASH-CURSOR.                                           14990042
150700                                                                  15000042
150800     EXEC SQL                                                     15010042
150900          OPEN CASH-CURSOR                                        15020042
151000     END-EXEC.                                                    15030042
151100                                                                  15040042
151200     EVALUATE TRUE                                                15050042
151300         WHEN SQLCODE = ZERO                                      15060042
151400              CONTINUE                                            15070042
151500         WHEN SQLWARN0 NOT EQUAL SPACE                            15080042
151600         WHEN SQLCODE NOT EQUAL ZERO                              15090042
151700             MOVE '4700-OPEN-CASH-CURSOR'                         15100042
151800                                            TO PV-PARAGRAPH-NAME  15110042
151900             MOVE 'ERROR ON OPEN OF CASH-CURSOR'                  15120042
152000                                            TO PV-DB2-OPERATION   15130042
152100             PERFORM 9100-SQL-ABEND                               15140042
152200     END-EVALUATE.                                                15150042
152300******************************************************************15160042
152400* 4800-FETCH-CASH-CURSOR                                          15170042
152500******************************************************************15180042
152600 4800-FETCH-CASH-CURSOR.                                          15190042
152700                                                                  15200042
152800     EXEC SQL                                                     15210042
152900          FETCH CASH-CURSOR                                       15220042
153000           INTO :SAADPC-SLS-DTE                                   15230042
153100               ,:SAADPC-TYP-CDE                                   15240042
153200               ,:SAADPC-ADJ-CSH-AMT                               15250042
153300               ,:SAADPC-STR-CHRGD-NBR                             15260042
153400               ,:SAADPC-RSN-CDE                                   15270042
153500               ,:SAADPC-CMNT-TXT                                  15280042
153600     END-EXEC.                                                    15290042
153700                                                                  15300042
153800     EVALUATE TRUE                                                15310042
153900         WHEN SQLCODE = ZERO                                      15320042
154000             ADD 1               TO PV-SUM-CURSOR-CNT             15330042
154100         WHEN SQLCODE = PC-ROW-NOT-FOUND                          15340042
154200             SET PS-END-OF-CASH-CURSOR TO TRUE                    15350042
154300         WHEN SQLWARN0 NOT EQUAL SPACE                            15360042
154400         WHEN SQLCODE NOT EQUAL ZERO                              15370042
154500             MOVE '4800-FETCH-CASH-CURSOR'                        15380042
154600                                            TO PV-PARAGRAPH-NAME  15390042
154700             MOVE 'ERROR ON FETCH OF SETTLEMENT-CURSOR'           15400042
154800                                            TO PV-DB2-OPERATION   15410042
154900             PERFORM 9100-SQL-ABEND                               15420042
155000     END-EVALUATE.                                                15430042
155100******************************************************************15440042
155200* 4900-CLOSE-CASH-CURSOR                                          15450042
155300******************************************************************15460042
155400 4900-CLOSE-CASH-CURSOR.                                          15470042
155500                                                                  15480042
155600     EXEC SQL                                                     15490042
155700          CLOSE CASH-CURSOR                                       15500042
155800     END-EXEC.                                                    15510042
155900                                                                  15520042
156000     EVALUATE TRUE                                                15530042
156100         WHEN SQLCODE = ZERO                                      15540042
156200              CONTINUE                                            15550042
156300         WHEN SQLWARN0 NOT EQUAL SPACE                            15560042
156400         WHEN SQLCODE NOT EQUAL ZERO                              15570042
156500             MOVE '4900-CLOSE-CASH-CURSOR'                        15580042
156600                                            TO PV-PARAGRAPH-NAME  15590042
156700             MOVE 'ERROR ON CLOSE OF CASH-CURSOR'                 15600042
156800                                            TO PV-DB2-OPERATION   15610042
156900             PERFORM 9100-SQL-ABEND                               15620042
157000     END-EVALUATE.                                                15630042
157100******************************************************************15640042
157200* 5000-DR-CR-TOTALS                                               15650042
157300*     PRINT THE DEBIT AND CREDIT TOTALS LINE                      15660042
157400******************************************************************15670042
157500 5000-DR-CR-TOTALS.                                               15680042
157600                                                                  15690042
157700     IF PV-DATE-SUB = 8                                           15700042
157800         ADD PV-ACCUM-DR (PV-DATE-SUB) TO PV-TOTAL-DR             15710042
157900         ADD PV-ACCUM-CR (PV-DATE-SUB) TO PV-TOTAL-CR             15720042
158000     ELSE                                                         15730042
158100         IF PV-ACCUM-DR (PV-DATE-SUB)                             15740042
158200                                   = PV-ACCUM-CR (PV-DATE-SUB)    15750042
158300             CONTINUE                                             15760042
158400         ELSE                                                     15770042
158500             IF PV-LINE-CNT GREATER THAN PC-LINE-LIMIT            15780042
158600                 PERFORM 9000-HEADER-ROUTINE                      15790042
158700             END-IF                                               15800042
158800                                                                  15810042
158900             IF PS-FIRST-TOTAL                                    15820042
159000                 MOVE +2 TO PV-LINE-SPACING                       15830042
159100             ELSE                                                 15840042
159200                 MOVE +1 TO PV-LINE-SPACING                       15850042
159300                 SET PS-NOT-FIRST-TOTAL TO TRUE                   15860042
159400             END-IF                                               15870042
159500                                                                  15880042
159600             MOVE WARNING-LINE       TO PV-PRINT-RECORD           15890042
159700             PERFORM 9900-WRITE-REPORT-LINE                       15900042
159800                                                                  15910042
159900             MOVE PV-ACCUM-DR (PV-DATE-SUB) TO DTL1-DEBIT-AMT     15920042
160000             MOVE PV-ACCUM-CR (PV-DATE-SUB) TO DTL1-CREDIT-AMT    15930042
160100                                                                  15940042
160200             MOVE SUMMARY-DATE (PV-DATE-SUB)                      15950042
160300                                TO PV-POS-CCYY-MM-DD              15960042
160400             MOVE PV-POS-MM     TO PV-PRINT-MM                    15970042
160500             MOVE '/'           TO PV-PRINT-SLASH                 15980042
160600             MOVE PV-POS-DD     TO PV-PRINT-DD                    15990042
160700             MOVE PV-PRINT-DATE TO DTL1-DR-CR-DATE                16000042
160800                                                                  16010042
160900             MOVE D1-DR-CR-LINE             TO PV-PRINT-RECORD    16020042
161000             PERFORM 9900-WRITE-REPORT-LINE                       16030042
161100         END-IF                                                   16040042
161200     END-IF.                                                      16050042
161300******************************************************************16060042
161400* 6000-DR-CR-ALL-STORES                                           16070042
161500*     PRINT THE DEBIT AND CREDIT TOTALS LINE                      16080042
161600******************************************************************16090042
161700 6000-DR-CR-ALL-STORES.                                           16100042
161800                                                                  16110042
161900     IF PV-LINE-CNT GREATER THAN PC-LINE-LIMIT                    16120042
162000         PERFORM 9000-HEADER-ROUTINE                              16130042
162100     END-IF                                                       16140042
162200                                                                  16150042
162300     IF PV-TOTAL-DR = PV-TOTAL-CR                                 16160042
162400         CONTINUE                                                 16170042
162500     ELSE                                                         16180042
162600         MOVE +2                 TO PV-LINE-SPACING               16190042
162700         MOVE WARNING-LINE       TO PV-PRINT-RECORD               16200042
162800         PERFORM 9900-WRITE-REPORT-LINE                           16210042
162900     END-IF.                                                      16220042
163000                                                                  16230042
163100     MOVE PC-TOTALS-LIT      TO DTL1-DR-CR-DATE.                  16240042
163200     MOVE PV-TOTAL-DR        TO DTL1-DEBIT-AMT.                   16250042
163300     MOVE PV-TOTAL-CR        TO DTL1-CREDIT-AMT.                  16260042
163400     MOVE +2                 TO PV-LINE-SPACING.                  16270042
163500     MOVE D1-DR-CR-LINE      TO PV-PRINT-RECORD.                  16280042
163600     PERFORM 9900-WRITE-REPORT-LINE.                              16290042
163700                                                                  16300042
163800 7000-GET-STORE-NAME.                                             16310042
163900                                                                  16320042
164000     MOVE SAADSU-STR-NBR TO XST00001-LOC-NBR.                     16330042
164100     MOVE CC-DATE-ISO    TO PV-POS-OPN-CCYY-MM-DD.                16340042
164200                                                                  16350042
164300     EXEC SQL                                                     16370042
164400          SELECT LOC.LOC_NM                                       16380042
164500          INTO  :XST00001-LOC-NM                                  16390042
164600          FROM   XST_LOC LOC                                      16400042
164700          WHERE LOC.LOC_NBR = :XST00001-LOC-NBR                   16410042
164800            AND OPN_DTE <= :PV-POS-OPN-CCYY-MM-DD                 16420042
164900            AND CLO_DTE >= :PV-POS-OPN-CCYY-MM-DD                 16430042
165000            WITH UR                                               16440042
165100     END-EXEC.                                                    16450042
165200                                                                  16460042
165300     EVALUATE TRUE                                                16470042
165400         WHEN SQLCODE = ZERO                                      16480042
165500             CONTINUE                                             16490042
165600         WHEN SQLWARN0 NOT EQUAL SPACE                            16500042
165700         WHEN SQLCODE NOT EQUAL ZERO                              16510042
165800             MOVE '7000-GET-STORE-NAME'                           16520042
165900                                            TO PV-PARAGRAPH-NAME  16530042
166000             MOVE 'ERROR ON SELECT FROM XST_LOC  '                16540042
166100                                            TO PV-DB2-OPERATION   16550042
166200             PERFORM 9100-SQL-ABEND                               16560042
166300     END-EVALUATE.                                                16570042
166400                                                                  16580042
166500 8000-PRINT-ROUTINE.                                              16590042
166600                                                                  16600042
166700     PERFORM 8100-CALCULATE-GROSS-SALES                           16610042
166800         VARYING PV-DATE-SUB FROM 1 BY 1                          16620042
166900             UNTIL PV-DATE-SUB GREATER THAN 7                     16630048
167000                                                                  16640042
167100     PERFORM 8200-TOTAL-SUMMARY                                   16650042
167200         VARYING PV-DATE-SUB FROM 1 BY 1                          16660042
167300             UNTIL PV-DATE-SUB GREATER THAN 7                     16670043
167400         AFTER PV-SUMM-SUB FROM 1 BY 1                            16680042
167500             UNTIL PV-SUMM-SUB GREATER THAN 38                    16690048
167600                                                                  16700042
167700     PERFORM 8300-ACCUM-DR-CR                                     16710042
167800         VARYING PV-DATE-SUB FROM 1 BY 1                          16720042
167900             UNTIL PV-DATE-SUB GREATER THAN 7                     16730043
168000           AFTER PV-SUMM-SUB FROM 1 BY 1                          16740042
168100             UNTIL PV-SUMM-SUB GREATER THAN 38.                   16750045
168200                                                                  16760042
168300     PERFORM 8400-ACCUM-DR-CR-TOT                                 16770042
168400         VARYING PV-SUMM-SUB FROM 1 BY 1                          16780042
168500             UNTIL PV-SUMM-SUB GREATER THAN 38.                   16790045
168600                                                                  16800042
168700     PERFORM 9000-HEADER-ROUTINE.                                 16810042
168800                                                                  16820042
168900     MOVE 1                      TO PV-LOW-LIMIT                  16830042
169000     MOVE 5                      TO PV-HIGH-LIMIT                 16840042
169100                                                                  16850042
169200     PERFORM 9700-WRITE-COLUMN-HEADINGS                           16860042
169300         VARYING PV-HLIT-SUB FROM 1 BY 1                          16870042
169400             UNTIL PV-HLIT-SUB GREATER THAN 3                     16880042
169500                                                                  16890042
169600     MOVE SPACES                 TO DTL1-DASH-AREA                16900042
169700                                                                  16910042
169800     PERFORM 9620-LOAD-DASHES                                     16920042
169900         VARYING PV-LINE-SUB FROM 1 BY 1                          16930042
170000             UNTIL PV-LINE-SUB GREATER THAN 5                     16940042
170100                                                                  16950042
170200     PERFORM 9600-WRITE-SUMMMARY-DETAIL                           16960042
170300         VARYING PV-DATE-SUB FROM 1 BY 1                          16970042
170400             UNTIL PV-DATE-SUB GREATER THAN 8                     16980042
170500                                                                  16990042
170600     MOVE 6                      TO PV-LOW-LIMIT                  17000042
170700     MOVE 13                     TO PV-HIGH-LIMIT                 17010042
170800                                                                  17020042
170900     PERFORM 9700-WRITE-COLUMN-HEADINGS                           17030042
171000         VARYING PV-HLIT-SUB FROM 1 BY 1                          17040042
171100             UNTIL PV-HLIT-SUB GREATER THAN 3                     17050042
171200                                                                  17060042
171300     MOVE SPACES                 TO DTL1-DASH-AREA                17070042
171400                                                                  17080042
171500     PERFORM 9620-LOAD-DASHES                                     17090042
171600         VARYING PV-LINE-SUB FROM 1 BY 1                          17100042
171700             UNTIL PV-LINE-SUB GREATER THAN 8                     17110042
171800                                                                  17120042
171900     PERFORM 9600-WRITE-SUMMMARY-DETAIL                           17130042
172000         VARYING PV-DATE-SUB FROM 1 BY 1                          17140042
172100             UNTIL PV-DATE-SUB GREATER THAN 8                     17150042
172200                                                                  17160042
172300     MOVE 15                     TO PV-LOW-LIMIT                  17170042
172400     MOVE 22                     TO PV-HIGH-LIMIT                 17180042
172500                                                                  17190042
172600     PERFORM 9700-WRITE-COLUMN-HEADINGS                           17200042
172700         VARYING PV-HLIT-SUB FROM 1 BY 1                          17210042
172800             UNTIL PV-HLIT-SUB GREATER THAN 3                     17220042
172900                                                                  17230042
173000     MOVE SPACES                 TO DTL1-DASH-AREA                17240042
173100                                                                  17250042
173200     PERFORM 9620-LOAD-DASHES                                     17260042
173300         VARYING PV-LINE-SUB FROM 1 BY 1                          17270042
173400             UNTIL PV-LINE-SUB GREATER THAN 8                     17280042
173500                                                                  17290042
173600     PERFORM 9600-WRITE-SUMMMARY-DETAIL                           17300042
173700         VARYING PV-DATE-SUB FROM 1 BY 1                          17310042
173800             UNTIL PV-DATE-SUB GREATER THAN 8                     17320042
173900                                                                  17330042
174000     PERFORM 9000-HEADER-ROUTINE.                                 17340042
174100                                                                  17350042
174200     MOVE 23                     TO PV-LOW-LIMIT                  17360042
PAYVEN     MOVE 30                     TO PV-HIGH-LIMIT                 17370042
174400                                                                  17390042
174500     PERFORM 9700-WRITE-COLUMN-HEADINGS                           17400042
174600         VARYING PV-HLIT-SUB FROM 1 BY 1                          17410042
174700             UNTIL PV-HLIT-SUB GREATER THAN 3                     17420042
174800                                                                  17430042
174900     MOVE SPACES                 TO DTL1-DASH-AREA                17440042
175000                                                                  17450042
175100     PERFORM 9620-LOAD-DASHES                                     17460042
175200         VARYING PV-LINE-SUB FROM 1 BY 1                          17470042
175300             UNTIL PV-LINE-SUB GREATER THAN 8                     17480042
175400                                                                  17490042
175500     PERFORM 9600-WRITE-SUMMMARY-DETAIL                           17500042
175600         VARYING PV-DATE-SUB FROM 1 BY 1                          17510042
175700             UNTIL PV-DATE-SUB GREATER THAN 8                     17520042
175800                                                                  17530042
175900     MOVE 32                     TO PV-LOW-LIMIT                  17541045
176000     MOVE 38                     TO PV-HIGH-LIMIT                 17550045
176100                                                                  17580042
176200     PERFORM 9700-WRITE-COLUMN-HEADINGS                           17590042
176300         VARYING PV-HLIT-SUB FROM 1 BY 1                          17600042
176400             UNTIL PV-HLIT-SUB GREATER THAN 3                     17610042
176500                                                                  17620042
176600     MOVE SPACES                 TO DTL1-DASH-AREA                17630042
176700                                                                  17640042
176800     PERFORM 9620-LOAD-DASHES                                     17650042
176900         VARYING PV-LINE-SUB FROM 1 BY 1                          17660042
177000             UNTIL PV-LINE-SUB GREATER THAN 7                     17670042
177100                                                                  17680042
177200     PERFORM 9600-WRITE-SUMMMARY-DETAIL                           17690042
177300         VARYING PV-DATE-SUB FROM 1 BY 1                          17700042
177400             UNTIL PV-DATE-SUB GREATER THAN 8                     17710042
177500     .                                                            17720042
177600******************************************************************17730042
177700* 8100-CALCULATE-GROSS-SALES                                      17740042
177800*     CALCULATE GROSS SALES FROM SALES MERCHANDISE, STATE TAX,    17750042
177900*     GIFT CERTIFICATE AND GIFT CARD SALES                        17760042
178000******************************************************************17770042
178100                                                                  17780042
178200 8100-CALCULATE-GROSS-SALES.                                      17790042
178300                                                                  17800042
178400     COMPUTE SUMMARY (PV-DATE-SUB, 1) = SUMMARY (PV-DATE-SUB, 2)  17810042
178500                                      + SUMMARY (PV-DATE-SUB, 3)  17820042
178600                                      + SUMMARY (PV-DATE-SUB, 4)  17830042
178700                                      + SUMMARY (PV-DATE-SUB, 5)  17840042
178800     .                                                            17850042
178900******************************************************************17860042
179000* 8200-TOTAL-SUMMARY                                              17870042
179100*     TOTAL THE VALUES FOR THE WEEKLY FIGURE                      17880042
179200******************************************************************17890042
179300                                                                  17900042
179400 8200-TOTAL-SUMMARY.                                              17910042
179500                                                                  17920042
179600     ADD SUMMARY (PV-DATE-SUB, PV-SUMM-SUB)                       17930042
179700                         TO SUMMARY (8, PV-SUMM-SUB).             17940042
179800******************************************************************17950042
179900* 8300-ACCUM-DR-CR.                                               17960042
180000*     ACCUMULATE DEBITS AND CREDITS                               17970042
180100******************************************************************17980042
180200 8300-ACCUM-DR-CR.                                                17990042
180300                                                                  18000042
180400     EVALUATE TRUE                                                18010042
180500         WHEN PV-SUMM-SUB = 2                                     18020042
180600         WHEN PV-SUMM-SUB = 3                                     18030042
180700         WHEN PV-SUMM-SUB = 4                                     18040042
180800         WHEN PV-SUMM-SUB = 5                                     18050042
180900             IF SUMMARY (PV-DATE-SUB, PV-SUMM-SUB) < ZERO         18060042
181000                 COMPUTE PV-ACCUM =                               18070042
181100                           SUMMARY(PV-DATE-SUB, PV-SUMM-SUB)      18080042
181200                                  * PC-NEG-ONE                    18090042
181300                 ADD PV-ACCUM TO PV-ACCUM-DR (PV-DATE-SUB)        18100042
181400             ELSE                                                 18110042
181500                 ADD SUMMARY(PV-DATE-SUB, PV-SUMM-SUB)            18120042
181600                                 TO PV-ACCUM-CR (PV-DATE-SUB)     18130042
181700             END-IF                                               18140042
181800         WHEN PV-SUMM-SUB = 32                                    18150045
181900             ADD PV-ACCUM-CR-CR (PV-DATE-SUB)                     18170042
182000                                 TO PV-ACCUM-CR (PV-DATE-SUB)     18180042
182100                                    PV-ACCUM-CR (8)               18190042
182200             COMPUTE PV-ACCUM-CR-DR (PV-DATE-SUB)                 18200042
182300                                 = PV-ACCUM-CR-DR (PV-DATE-SUB)   18210042
182400                                 * PC-NEG-ONE                     18220042
182500             ADD PV-ACCUM-CR-DR (PV-DATE-SUB)                     18230042
182600                                 TO PV-ACCUM-DR (PV-DATE-SUB)     18240042
182700                                    PV-ACCUM-DR (8)               18250042
182800         WHEN PV-SUMM-SUB = 35                                    18260045
182900             ADD PV-ACCUM-CP-CR (PV-DATE-SUB)                     18280042
183000                                 TO PV-ACCUM-CR (PV-DATE-SUB)     18290042
183100                                    PV-ACCUM-CR (8)               18300042
183200             COMPUTE PV-ACCUM-CP-DR (PV-DATE-SUB)                 18310042
183300                                 = PV-ACCUM-CP-DR (PV-DATE-SUB)   18320042
183400                                 * PC-NEG-ONE                     18330042
183500             ADD PV-ACCUM-CP-DR (PV-DATE-SUB)                     18340042
183600                                 TO PV-ACCUM-DR (PV-DATE-SUB)     18350042
183700                                    PV-ACCUM-DR (8)               18360042
183800         WHEN PV-SUMM-SUB = 15                                    18370042
183900         WHEN PV-SUMM-SUB = 16                                    18380042
184000         WHEN PV-SUMM-SUB = 17                                    18390042
184100         WHEN PV-SUMM-SUB = 18                                    18400042
184200             ADD SUMMARY(PV-DATE-SUB, PV-SUMM-SUB)                18410042
184300                                TO PV-ACCUM-DR (PV-DATE-SUB)      18420042
184400                                   PV-ACCUM-DR (8)                18430042
184500         WHEN PV-SUMM-SUB = 6                                     18440042
184600         WHEN PV-SUMM-SUB = 33                                    18450045
184700         WHEN PV-SUMM-SUB = 34                                    18452045
184800             COMPUTE PV-ACCUM                                     18454042
184900                           = SUMMARY(PV-DATE-SUB, PV-SUMM-SUB)    18455042
185000                           * PC-NEG-ONE                           18456042
185100             ADD PV-ACCUM TO PV-ACCUM-DR (PV-DATE-SUB)            18457042
185200                             PV-ACCUM-DR (8)                      18458042
185300         WHEN PV-SUMM-SUB = 7                                     18459042
185400         WHEN PV-SUMM-SUB = 8                                     18460042
185500         WHEN PV-SUMM-SUB = 9                                     18470042
185600             COMPUTE PV-ACCUM                                     18480042
185700                          = SUMMARY(PV-DATE-SUB, PV-SUMM-SUB)     18490042
185800                          * PC-NEG-ONE                            18500042
185900             ADD PV-ACCUM TO PV-ACCUM-CR (PV-DATE-SUB)            18510042
186000                             PV-ACCUM-CR (8)                      18520042
186100         WHEN PV-SUMM-SUB = 24                                    18530042
PAYVEN         WHEN PV-SUMM-SUB = 30                                    18550042
186400             ADD SUMMARY(PV-DATE-SUB, PV-SUMM-SUB)                18560042
186500                          TO PV-ACCUM-CR (PV-DATE-SUB)            18570042
186600                             PV-ACCUM-CR (8)                      18580042
186700         WHEN PV-SUMM-SUB = 19                                    18590042
186800         WHEN PV-SUMM-SUB = 20                                    18600042
186900         WHEN PV-SUMM-SUB = 21                                    18610042
187000         WHEN PV-SUMM-SUB = 22                                    18620042
187100         WHEN PV-SUMM-SUB = 23                                    18630042
SEPHOR         WHEN PV-SUMM-SUB = 25                                    18640042
PAYVEN         WHEN PV-SUMM-SUB = 26                                    18650042
PAYVEN         WHEN PV-SUMM-SUB = 27                                    18660042
PAYVEN         WHEN PV-SUMM-SUB = 28                                    18670042
PAYVEN         WHEN PV-SUMM-SUB = 31                                    18680042
187400         WHEN PV-SUMM-SUB = 37                                    18690045
187500         WHEN PV-SUMM-SUB = 38                                    18691045
187600             IF SUMMARY (PV-DATE-SUB, PV-SUMM-SUB) < ZERO         18710042
187700                 COMPUTE PV-ACCUM                                 18720042
187800                        = SUMMARY(PV-DATE-SUB, PV-SUMM-SUB)       18730042
187900                        * PC-NEG-ONE                              18740042
188000                 ADD PV-ACCUM TO PV-ACCUM-CR (PV-DATE-SUB)        18750042
188100             ELSE                                                 18760042
188200                 ADD SUMMARY(PV-DATE-SUB, PV-SUMM-SUB)            18770042
188300                              TO PV-ACCUM-DR (PV-DATE-SUB)        18780042
188400             END-IF                                               18790042
188500     END-EVALUATE.                                                18800042
188600                                                                  18810042
188700******************************************************************18820042
188800*     ACCUMULATE TOTAL DEBITS AND CREDITS FOR COLUMNS THAT USE    18830042
188900*     THE TOTAL FOR THE WEEK.                                     18840042
189000******************************************************************18850042
189100 8400-ACCUM-DR-CR-TOT.                                            18860042
189200                                                                  18870042
189300     EVALUATE TRUE                                                18880042
189400         WHEN PV-SUMM-SUB = 2                                     18890042
189500         WHEN PV-SUMM-SUB = 3                                     18900042
189600         WHEN PV-SUMM-SUB = 4                                     18910042
189700         WHEN PV-SUMM-SUB = 5                                     18920042
189800             IF SUMMARY (8, PV-SUMM-SUB) < ZERO                   18930042
189900                 COMPUTE PV-ACCUM =                               18940042
190000                           SUMMARY(8, PV-SUMM-SUB)                18950042
190100                                  * PC-NEG-ONE                    18960042
190200                 ADD PV-ACCUM TO PV-ACCUM-DR (8)                  18970042
190300             ELSE                                                 18980042
190400                 ADD SUMMARY(8, PV-SUMM-SUB)                      18990042
190500                                 TO PV-ACCUM-CR (8)               19000042
190600             END-IF                                               19010042
190700         WHEN PV-SUMM-SUB = 19                                    19020042
190800         WHEN PV-SUMM-SUB = 20                                    19030042
190900         WHEN PV-SUMM-SUB = 21                                    19040042
191000         WHEN PV-SUMM-SUB = 22                                    19050042
191100         WHEN PV-SUMM-SUB = 23                                    19060042
PAYVEN         WHEN PV-SUMM-SUB = 28                                    19080042
PAYVEN         WHEN PV-SUMM-SUB = 31                                    19100042
191400         WHEN PV-SUMM-SUB = 37                                    19110045
191500         WHEN PV-SUMM-SUB = 38                                    19120045
191600             IF SUMMARY (8, PV-SUMM-SUB) < ZERO                   19150042
191700                 COMPUTE PV-ACCUM                                 19160042
191800                        = SUMMARY(8, PV-SUMM-SUB)                 19170042
191900                        * PC-NEG-ONE                              19180042
192000                 ADD PV-ACCUM TO PV-ACCUM-CR (8)                  19190042
192100             ELSE                                                 19200042
192200                 ADD SUMMARY(8, PV-SUMM-SUB)                      19210042
192300                              TO PV-ACCUM-DR (8)                  19220042
192400             END-IF                                               19230042
192500     END-EVALUATE.                                                19240042
192600                                                                  19250042
192700******************************************************************19260042
192800* 9000-HEADER-ROUTINE                                             19270042
192900*     PRINT THE HEADINGS FOR THE REPORT.                          19280042
193000******************************************************************19290042
193100                                                                  19300042
193200 9000-HEADER-ROUTINE.                                             19310042
193300                                                                  19320042
193400     ADD +1                      TO PV-PAGE-CNT.                  19330042
193500     MOVE PV-PAGE-CNT TO DP132-PAGE-NUMBER.                       19340042
193600     MOVE DP132-STANDRD-HEADER-132-COLS                           19350042
193700                                 TO PV-PRINT-RECORD.              19360042
193800     PERFORM 9800-WRITE-RPT-TOP-OF-PAGE.                          19370042
193900                                                                  19380042
194000     MOVE H2-HEADING-LINE-2      TO PV-PRINT-RECORD.              19390042
194100     MOVE +1                     TO PV-LINE-SPACING.              19400042
194200     PERFORM 9900-WRITE-REPORT-LINE.                              19410042
194300                                                                  19420042
194400     MOVE H3-HEADING-LINE-3      TO PV-PRINT-RECORD.              19430042
194500     MOVE +3                     TO PV-LINE-SPACING.              19440042
194600     PERFORM 9900-WRITE-REPORT-LINE.                              19450042
194700 9600-WRITE-SUMMMARY-DETAIL.                                      19460042
194800                                                                  19470042
194900     MOVE SPACES                 TO D1-DETAIL-LINE-1              19480042
195000                                                                  19490042
195100     IF PV-DATE-SUB EQUAL 8                                       19500042
195200         MOVE PC-TOTALS-LIT      TO DTL1-DATE                     19510042
195300     ELSE                                                         19520042
195400         MOVE SUMMARY-DATE (PV-DATE-SUB)                          19530042
195500                                 TO PV-POS-CCYY-MM-DD             19540042
195600         MOVE PV-POS-MM          TO PV-PRINT-MM                   19550042
195700         MOVE '/'                TO PV-PRINT-SLASH                19560042
195800         MOVE PV-POS-DD          TO PV-PRINT-DD                   19570042
195900         MOVE PV-PRINT-DATE      TO DTL1-DATE                     19580042
196000     END-IF                                                       19590042
196100                                                                  19600042
196200     MOVE ZERO                   TO PV-PRNT-SUB                   19610042
196300                                                                  19620042
196400     PERFORM 9610-LOAD-SUMMARY                                    19630042
196500         VARYING PV-LINE-SUB FROM PV-LOW-LIMIT BY 1               19640042
196600             UNTIL PV-LINE-SUB GREATER THAN PV-HIGH-LIMIT         19650042
196700                                                                  19660042
196800     IF PV-DATE-SUB EQUAL 8                                       19670042
196900         MOVE +1                 TO PV-LINE-SPACING               19680042
197000         MOVE D1-DASH-LINE-1     TO PV-PRINT-RECORD               19690042
197100         PERFORM 9900-WRITE-REPORT-LINE                           19700042
197200     ELSE                                                         19710042
197300         MOVE +2                 TO PV-LINE-SPACING               19720042
197400     END-IF                                                       19730042
197500     MOVE D1-DETAIL-LINE-1       TO PV-PRINT-RECORD.              19740042
197600     PERFORM 9900-WRITE-REPORT-LINE.                              19750042
197700                                                                  19760042
197800******************************************************************19770042
197900* 9610-LOAD-SUMMARY                                               19780042
198000*     MOVE SUMMARY TO DETAIL LINE FOR PRINTING                    19790042
198100******************************************************************19800042
198200                                                                  19810042
198300 9610-LOAD-SUMMARY.                                               19820042
198400                                                                  19830042
198500     ADD 1                       TO PV-PRNT-SUB                   19840042
198600                                                                  19850042
198700     MOVE SUMMARY (PV-DATE-SUB, PV-LINE-SUB)                      19860042
198800                                 TO DTL1-SUMMARY (PV-PRNT-SUB).   19870042
198900                                                                  19880042
199000******************************************************************19890042
199100* 9620-LOAD-DASHES                                                19900042
199200*     MOVE DASHES TO DETAIL LINE FOR PRINTING                     19910042
199300******************************************************************19920042
199400                                                                  19930042
199500 9620-LOAD-DASHES.                                                19940042
199600                                                                  19950042
199700     MOVE ALL '-'                TO DTL1-DASH (PV-LINE-SUB).      19960042
199800                                                                  19970042
199900******************************************************************19980042
200000* 9700-WRITE-COLUMN-HEADINGS                                      19990042
200100*     WRITE FIRST REPORT LINE AFTER PAGE BREAK.                   20000042
200200******************************************************************20010042
200300                                                                  20020042
200400 9700-WRITE-COLUMN-HEADINGS.                                      20030042
200500                                                                  20040042
200600     MOVE SPACES                 TO H4-HEADING-LINE-4             20050042
200700                                                                  20060042
200800     MOVE ZERO                   TO PV-PRNT-SUB                   20070042
200900                                                                  20080042
201000     PERFORM 9710-LOAD-LITERALS                                   20090042
201100         VARYING PV-LINE-SUB FROM PV-LOW-LIMIT BY 1               20100042
201200             UNTIL PV-LINE-SUB GREATER THAN PV-HIGH-LIMIT         20110042
201300                                                                  20120042
201400     MOVE H4-HEADING-LINE-4      TO PV-PRINT-RECORD.              20130042
201500     IF PV-HLIT-SUB EQUAL 1                                       20140042
201600         MOVE +2                 TO PV-LINE-SPACING               20150042
201700     ELSE                                                         20160042
201800         MOVE +1                 TO PV-LINE-SPACING               20170042
201900     END-IF                                                       20180042
202000     PERFORM 9900-WRITE-REPORT-LINE.                              20190042
202100                                                                  20200042
202200******************************************************************20210042
202300* 9710-LOAD-LITERALS                                              20220042
202400*     MOVE COLUMN LITERALS TO HEADER LINE FOR PRINTING            20230042
202500******************************************************************20240042
202600                                                                  20250042
202700 9710-LOAD-LITERALS.                                              20260042
202800                                                                  20270042
202900     ADD 1                       TO PV-PRNT-SUB                   20280042
203000                                                                  20290042
203100     MOVE HEADER-LITERAL (PV-LINE-SUB, PV-HLIT-SUB)               20300042
203200                                 TO HDR4-COLUMN (PV-PRNT-SUB).    20310042
203300                                                                  20320042
203400******************************************************************20330042
203500* 9800-WRITE-RPT-TOP-OF-PAGE                                      20340042
203600*     WRITE FIRST REPORT LINE AFTER PAGE BREAK.                   20350042
203700******************************************************************20360042
203800 9800-WRITE-RPT-TOP-OF-PAGE.                                      20370042
203900                                                                  20380042
204000     WRITE SUMMARY-REPORT-RECORD                                  20390042
204100       FROM PV-PRINT-RECORD                                       20400042
204200         AFTER ADVANCING PAGE.                                    20410042
204300     MOVE +1             TO PV-LINE-CNT.                          20420042
204400******************************************************************20430042
204500* 9900-WRITE-REPORT-LINE                                          20440042
204600*     WRITE REPORT LINE AFTER ADVANCING LINE SPACING.             20450042
204700******************************************************************20460042
204800 9900-WRITE-REPORT-LINE.                                          20470042
204900                                                                  20480042
205000     WRITE SUMMARY-REPORT-RECORD                                  20490042
205100       FROM PV-PRINT-RECORD                                       20500042
205200         AFTER ADVANCING PV-LINE-SPACING.                         20510042
205300                                                                  20520042
205400     ADD PV-LINE-SPACING TO PV-LINE-CNT.                          20530042
205500******************************************************************20540042
205600* 9100-SQL-ABEND                                                  20550042
205700*     ABEND PROGRAM WHEN AN SQL ERROR CODE OR WARNING CODE OCCURS.20560042
205800******************************************************************20570042
205900 9100-SQL-ABEND.                                                  20580042
206000     DISPLAY '** ABEND     **'.                                   20590042
206100     DISPLAY '** PROGRAM   ** = ' PC-CURRENT-PROGRAM-NAME.        20600042
206200     DISPLAY '** PARAGRAPH ** = ' PV-PARAGRAPH-NAME.              20610042
206300     DISPLAY '** OPERATION ** = ' PV-DB2-OPERATION.               20620042
206400     DISPLAY '** STORE NBR ** = ' XST00001-LOC-NBR.               20630042
206500     DISPLAY '** POS OPN DATE ** '  PV-POS-OPN-CCYY-MM-DD.        20640042
206600                                                                  20650042
206700******************************************************************20660042
206800* COPY BOOK CONTAINING PROCEDURE DIVISION STATEMENTS REQUIRED     20670042
206900* TO UTILIZE SQLCA MESSAGE DISPLAY MODULE 'DSNTIAR' FOLLOWS.      20680042
207000******************************************************************20690042
207100     COPY DPPD004.                                                20700042
207200                                                                  20710042
207300     SET AC-DB2-ERROR TO TRUE.                                    20720042
207400     CALL 'ILBOABN0' USING AC-ABEND-CODE.                         20730042
207500                                                                  20740042
207600******************************************************************20750042
207700* 9999-ABEND                                                      20760042
207800*     ABEND PROGRAM WHEN A NON-DB2 ERROR OCCURS.                  20770042
207900******************************************************************20780042
208000 9999-ABEND.                                                      20790042
208100     DISPLAY '** ABEND           **'.                             20800042
208200     DISPLAY '** PROGRAM         ** = ' PC-CURRENT-PROGRAM-NAME.  20810042
208300     DISPLAY '** PARAGRAPH       ** = ' PV-PARAGRAPH-NAME.        20820042
208400     DISPLAY '** OPERATION       ** = ' PV-OPERATION-MSG-1.       20830042
208500     DISPLAY '**                 ** = ' PV-OPERATION-MSG-2.       20840042
208600     CALL 'ILBOABN0' USING AC-ABEND-CODE.                         20850042
