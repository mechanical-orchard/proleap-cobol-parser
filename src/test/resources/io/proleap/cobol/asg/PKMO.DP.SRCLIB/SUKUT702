000100******************************************************************00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300******************************************************************00030000
000400                                                                  00040000
000500 PROGRAM-ID.             SUKUT702.                                00050000
000600 AUTHOR.                 LARRY SCHLEICHER.                        00060000
000700 INSTALLATION.           KOHLS.                                   00070000
000800 DATE-WRITTEN            JANUARY, 2003.                           00080000
000900 DATE-COMPILED.                                                   00090000
001000                                                                  00100000
001100******************************************************************00110000
001200* THIS PROGRAM WILL PROCESS THE UNIT ADJUSTMENTS AT A STORE LEVEL 00120000
001300* THAT WILL EVENTUALLY BE PASSED TO FASHION SALES.                00130000
001400******************************************************************00140000
001500                                                                  00150000
001600******************************************************************00160000
001700 ENVIRONMENT DIVISION.                                            00170000
001800******************************************************************00180000
001900                                                                  00190000
002000******************************************************************00200000
002100 DATA DIVISION.                                                   00210000
002200******************************************************************00220000
002300                                                                  00230000
002400******************************************************************00240000
002500 WORKING-STORAGE SECTION.                                         00250000
002600******************************************************************00260000
002700*----------------------------------------------------------------*00270000
002800*    COMMAREA FOR TMKCS520.                                      *00280000
002900*----------------------------------------------------------------*00290000
003000                                                                  00300000
003100     COPY TMWS500.                                                00310000
003200                                                                  00320000
003300     COPY SUWS035.                                                00330000
003400                                                                  00340000
003500******************************************************************00350000
003600*  TEMPORARY STORAGE QUEUE - STORE UNIT ADJUSTMENTS TO BE SENT   *00360000
003700*  TO RMS PO BY PCKCS759.                                        *00370000
003800******************************************************************00380000
003900     COPY PCWS241.                                                00390000
004000                                                                  00400000
004100     COPY RCWS031.                                                00410000
004200*----------------------------------------------------------------*00420000
004300*    CURRENT DATE COPYBOOK.                                      *00430000
004400*----------------------------------------------------------------*00440000
004500                                                                  00450000
004600     COPY DPWS017.                                                00460000
004700*----------------------------------------------------------------*00470000
004800*    COPY BOOK FOR CALENDAR SUBROUTINE (DPKUT500)                 00480000
004900*----------------------------------------------------------------*00490000
005000                                                                  00500000
005100     COPY DPWS500.                                                00510000
005200                                                                  00520000
005300******************************************************************00530000
005400*  COMMAREA LAYOUT FOR THE UNITS WORKED MODULE (PCKCS756)        *00540000
005500******************************************************************00550000
005600     COPY PCWS238.                                                00560000
005700*----------------------------------------------------------------*00570000
005800*  COPYBOOK FOR LOCATION CALL MODULE                              00580000
005900*-----------------------------------------------------------------00590000
006000     COPY XLWS071.                                                00600000
006100                                                                  00610000
006200*                                                                 00620000
006300 01  DK-DB2-KEYS.                                                 00630000
006400     05  DK-STR-DEST-NBR                 PIC S9(4) COMP VALUE +0. 00640000
006500     05  DK-PACK-ID                      PIC S9(4) COMP VALUE +0. 00650000
006600     05  DK-AUDIT-CNTL-NBR               PIC S9(09) COMP.         00660000
006700     05  DK-SHIPT-UNT-ID                 PIC S9(18) COMP-3.       00670000
006800     05  DK-OPER-UNT-ID                  PIC S9(04) COMP.         00680000
006900     05  DK-FCLTY-ID                     PIC S9(04) COMP.         00690000
007000     05  DK-PO                           PIC S9(09) COMP SYNC.    00700000
007100     05  DK-PO-LNE-NBR                   PIC S9(09) COMP SYNC.    00710000
007200     05  DK-STR-NBR                      PIC S9(04) COMP SYNC.    00720000
007300     05  DK-REC-SEQ-NBR                  PIC S9(09) COMP SYNC.    00730000
007400     05  DK-PKSL-LNE-NBR                 PIC S9(09) COMP SYNC.    00740000
007500     05  DK-TRN-TYP-CDE                  PIC  X(02).              00750000
007600     05  DK-UPC-NBR                      PIC S9(15)V COMP-3.      00760000
007700     05  DK-STR-NBR-N                    PIC 9(4).                00770000
007800     05  DK-NULL                         PIC S9(04)  VALUE +0     00780000
007900                                              COMP SYNC.          00790000
008000                                                                  00800000
008100 01  DN-DB2-NULL-INDICATORS.                                      00810000
008200     05  DN-AUDIT-IND               PIC S9(04) COMP VALUE ZEROES. 00820000
008300     05  DN-SHIPT-IND               PIC S9(04) COMP VALUE ZEROES. 00830000
008400     05  DN-PROB-IND                PIC S9(04) COMP VALUE ZEROES. 00840000
008500     05  DN-ADJ-IND                 PIC S9(04) COMP VALUE ZEROES. 00850000
008600                                                                  00860000
008700 01  PC-PROGRAM-CONSTANTS.                                        00870000
008800     05  PC-TMKCS520               PIC X(08)  VALUE  'TMKCS520'.  00880000
008900     05  PC-DEFAULT-TMST           PIC X(26)  VALUE               00890000
009000                                  '9999-09-09-09.09.09.999999'.   00900000
009100     05  PC-PCKCS756               PIC X(08)  VALUE 'PCKCS756'.   00910000
009200     05  PC-AUDIT-RTN              PIC X(08)  VALUE 'RCKCS290'.   00920000
009300     05  PC-CALENDAR-ROUTINE       PIC X(08)  VALUE 'RCKCS290'.   00930000
009400     05  PC-CURRENT-PROGRAM-NAME   PIC X(08)  VALUE 'SUKUT702'.   00940000
009500     05  PC-LOGGING-PROGRAM-NAME   PIC X(08)  VALUE 'SUKPV702'.   00950000
009600     05  PC-AUDIT-RTN-LENGTH       PIC S9(4)  VALUE  +300         00960000
009700                                                COMP SYNC.        00970000
009800     05  PC-DEFAULT-DATE           PIC X(10)  VALUE '9999-09-09'. 00980000
009900                                                                  00990000
010000                                                                  01000000
010100 01  PS-PROGRAM-SWITCHES.                                         01010000
010200     05  PS-SYSTEM-AUDIT-FOUND-SW       PIC X(01)    VALUE 'N'.   01020000
010300         88  PS-SYSTEM-AUDIT-NOT-FOUND               VALUE 'N'.   01030000
010400         88  PS-SYSTEM-AUDIT-FOUND                   VALUE 'Y'.   01040000
010500     05  PS-TDISTDT-TRECDIS-ADD-SW      PIC X(01)    VALUE 'N'.   01050000
010600         88  PS-TDISTDT-ADD                          VALUE 'Y'.   01060000
010700         88  PS-TRECDIS-ADD                          VALUE 'N'.   01070000
010800     05  PS-MORE-RECITM-SW              PIC X(01)    VALUE 'N'.   01080000
010900         88  PS-MORE-RECITM-YES                      VALUE 'Y'.   01090000
011000         88  PS-MORE-RECITM-NO                       VALUE 'N'.   01100000
011100     05  PS-SUT-OTBND-WRTN-SW           PIC  X       VALUE 'N'.   01110000
011200         88  PS-SUT-OTBND-WRTN                       VALUE 'Y'.   01120000
011300         88  PS-NO-SUT-OTBND-WRTN                    VALUE 'N'.   01130000
011400     05  PS-STORE-NOT-FOUND-SW          PIC  X       VALUE 'N'.   01140000
011500         88  PS-STORE-FOUND                          VALUE 'Y'.   01150000
011600         88  PS-STORE-NOT-FOUND                      VALUE 'N'.   01160000
011700     05  PS-LOG-MESSAGE-SW              PIC  X       VALUE 'N'.   01170000
011800         88  PS-LOG-MESSAGE                          VALUE 'Y'.   01180000
011900         88  PS-NO-LOG-MESSAGE                       VALUE 'N'.   01190000
012000     05  PS-PROCESS-ODD-UNITS-SW        PIC  X       VALUE 'N'.   01200000
012100         88  PS-PROCESS-ODD-UNITS                    VALUE 'Y'.   01210000
012200         88  PS-NOT-PROCESS-ODD-UNITS                VALUE 'N'.   01220000
012300     05  PS-BEFORE-ONLY-LOGGING-SW      PIC  X       VALUE 'N'.   01230000
012400         88  PS-BEFORE-ONLY-LOGGING                  VALUE 'Y'.   01240000
012500         88  PS-NOT-BEFORE-ONLY-LOGGING              VALUE 'N'.   01250000
012600     05  PS-TRBL-EXISTS-SW              PIC  X       VALUE 'Y'.   01260000
012700         88  PS-NO-TRBL-EXISTS                       VALUE 'N'.   01270000
012800         88  PS-TRBL-EXISTS                          VALUE 'Y'.   01280000
012900     05  PS-NOT-VERIFIED-STATUS-SW      PIC  X       VALUE 'Y'.   01290000
013000         88  PS-NOT-VERIFIED-STATUS                  VALUE 'N'.   01300000
013100         88  PS-VERIFIED-STATUS                      VALUE 'Y'.   01310000
013200     05  PS-NOT-POST-VERIFIED-STATUS-SW PIC  X       VALUE 'Y'.   01320000
013300         88  PS-NOT-POST-VERIFIED-STATUS             VALUE 'N'.   01330000
013400         88  PS-POST-VERIFIED-STATUS                 VALUE 'Y'.   01340000
013500     05  PS-OUTBND-CART-FOUND-SW        PIC  X       VALUE 'Y'.   01350000
013600         88  PS-NO-OUTBND-CART-FOUND                 VALUE 'N'.   01360000
013700         88  PS-OUTBND-CART-FOUND                    VALUE 'Y'.   01370000
013800     05  PS-DISTHD-FOUND-SW             PIC  X       VALUE 'Y'.   01380000
013900         88  PS-NO-DISTHD-FOUND                      VALUE 'N'.   01390000
014000         88  PS-DISTHD-FOUND                         VALUE 'Y'.   01400000
014100     05  PS-DISTDT-FOUND-SW             PIC  X       VALUE 'Y'.   01410000
014200         88  PS-NO-DISTDT-FOUND                      VALUE 'N'.   01420000
014300         88  PS-DISTDT-FOUND                         VALUE 'Y'.   01430000
014400     05  PS-UPDATE-TRECDIS-SW           PIC  X       VALUE 'N'.   01440000
014500         88  PS-NO-UPDATE-TRECDIS                    VALUE 'N'.   01450000
014600         88  PS-UPDATE-TRECDIS                       VALUE 'Y'.   01460000
014700     05  PS-UPDATE-TDISTDT-IND           PIC X(01)   VALUE 'N'.   01470000
014800         88  PS-NO-UPDATE-TDISTDT                    VALUE 'N'.   01480000
014900         88  PS-UPDATE-TDISTDT                       VALUE 'Y'.   01490000
015000     05  PS-AUTO-APPLY-SW               PIC  X       VALUE 'Y'.   01500000
015100         88  PS-NO-AUTO-APPLY                        VALUE 'N'.   01510000
015200         88  PS-AUTO-APPLY                           VALUE 'Y'.   01520000
015300     05  PS-USE-VERIFIED-QTY-SW         PIC  X       VALUE 'N'.   01530000
015400         88  PS-USE-AP-VERIFIED-QTY                  VALUE 'N'.   01540000
015500         88  PS-USE-VERIFIED-QTY                     VALUE 'Y'.   01550000
015600     05  PS-ERROR-SW                    PIC  X       VALUE 'N'.   01560000
015700         88  PS-NO-ERROR                             VALUE 'N'.   01570000
015800         88  PS-ERROR                                VALUE 'Y'.   01580000
015900     05  PS-UPDATE-STORE-SW             PIC X(01).                01590000
016000         88  PS-UPDATE-YES                           VALUE 'Y'.   01600000
016100         88  PS-UPDATE-NO                            VALUE 'N'.   01610000
016200     05  PS-STORE-TYPE-SW               PIC  X(01).               01620000
016300         88  PS-NOT-DC-STORE-TYPE                    VALUE 'N'.   01630000
016400         88  PS-DC-STORE-TYPE                        VALUE 'D'.   01640000
016500     05  PS-RECEIVER-FOUND-SW           PIC  X(01)   VALUE 'N'.   01650000
016600         88  PS-RECEIVER-FOUND                       VALUE 'Y'.   01660000
016700         88  PS-RECEIVER-NOT-FOUND                   VALUE 'N'.   01670000
016800     05  PS-LINE-FOUND-SW               PIC  X(01)   VALUE 'N'.   01680000
016900         88  PS-LINE-FOUND                           VALUE 'Y'.   01690000
017000         88  PS-LINE-NOT-FOUND                       VALUE 'N'.   01700000
017100     05  PS-RECDIS-FOUND-SW             PIC  X(01)   VALUE 'N'.   01710000
017200         88  PS-RECDIS-FOUND                         VALUE 'Y'.   01720000
017300         88  PS-RECDIS-NOT-FOUND                     VALUE 'N'.   01730000
017310     05  PS-DC-FLUSH-SW                  PIC  X(01)  VALUE 'N'.   01731011
017320         88  PS-DC-FLUSH-YES                         VALUE 'Y'.   01732012
017330         88  PS-DC-FLUSH-NO                          VALUE 'N'.   01733012
017400                                                                  01740000
017500 01  PV-PROGRAM-VARIABLES.                                        01750000
017600     05  PV-NULL-IND                    PIC S9(04)  VALUE +0      01760000
017700                                                    COMP SYNC.    01770000
017800     05  PV-VRFY-ADJ-QUEUE-NAME.                                  01780000
017900         10  PV-VRFY-ADJ-TERM-ID             PIC X(4).            01790000
018000         10  PV-VRFY-ADJ-TASK-NUMBER         PIC S9(5)            01800000
018100                                             COMP-3.              01810000
018200         10  PV-VRFY-ADJ-SEQ                 PIC 9.               01820000
018300     05  PV-VRFY-ITEM                    PIC S9(4) VALUE ZERO     01830000
018400                                                COMP SYNC.        01840000
018500     05  PV-TRBL-RSN-CDE                 PIC S9(4) VALUE ZERO     01850000
018600                                                COMP SYNC.        01860000
018700     05  PV-CICS-MSG-AREA                PIC  X(100) VALUE SPACE. 01870000
018800     05  PV-NOTIF-NBR                    PIC S9(9) VALUE ZERO     01880000
018900                                                COMP SYNC.        01890000
019000     05  PV-CYC-ADJ-NBR                  PIC S9(9) VALUE ZERO     01900000
019100                                                COMP SYNC.        01910000
019200     05  PV-CURRENT-TIMESTAMP            PIC X(26)   VALUE SPACES.01920000
019300     05  PV-CASEPACK-DELETED-IND         PIC X(01)   VALUE 'N'.   01930000
019400     05  PV-LK-DTE-ISO.                                           01940000
019500         10  PV-LK-DTE-CCYY              PIC  X(04)  VALUE SPACE. 01950000
019600         10  PV-LK-DTE-MO                PIC  X(02)  VALUE SPACE. 01960000
019700         10  PV-LK-DTE-DD                PIC  X(02)  VALUE SPACE. 01970000
019800     05  PV-ACTL-CTOFF-YYYYMMDD          PIC  X(08).              01980000
019900     05  PV-VERIFY-DTE-YYYYMMDD          PIC  X(08).              01990000
020000     05  PV-CURRENT-DTE-YYYYMMDD         PIC  X(08).              02000000
020100     05  PV-RECEIPT-DTE-YYYYMMDD        PIC  X(08).               02010000
020200     05  PV-DB2-INV-FORMAT               PIC X(10).               02020000
020300     05  PV-BEFORE-QTY                   PIC  S9(9) COMP.         02030000
020400     05  PV-AFTER-QTY                    PIC  S9(9) COMP.         02040000
020500     05  PV-ADJUST-QTY                   PIC  S9(9) COMP.         02050000
020600     05  PV-PO-LNE-NBR                   PIC  S9(9) COMP.         02060000
020700     05  PV-ITM-QTY                      PIC  S9(9) COMP.         02070000
020800     05  PV-ODD-QTY                      PIC  S9(9) COMP.         02080000
020900     05  PV-ODD-DIF                      PIC  S9(9) COMP.         02090000
021000     05  PV-QTY-DIF                      PIC  S9(9) COMP.         02100000
021100     05  PV-ITEM-COUNT-CARTON            PIC S9(09)  VALUE ZERO   02110000
021200                                                     COMP SYNC.   02120000
021300     05  PV-ITEM-COUNT-AUDIT             PIC S9(09)  VALUE ZERO   02130000
021400                                                     COMP SYNC.   02140000
021500     05  PV-AUDIT-INTR-UPC               PIC  S9(9)  COMP.        02150000
021600     05  PV-EXPECT-INTR-UPC              PIC  S9(9)  COMP.        02160000
021700     05  PV-SCND-UNT-QTY                 PIC  S9(9)  COMP.        02170000
021800     05  PV-DIFF-UNT-QTY                 PIC  S9(9)  COMP.        02180000
021900     05  PV-AUDIT-UPC-NBR                PIC  S9(15)V COMP-3.     02190000
022000     05  PV-AUDIT-SHPD-QTY               PIC  S9(9)V COMP-3.      02200000
022100     05  PV-CARTON-UPC-NBR               PIC  S9(15)V COMP-3.     02210000
022200     05  PV-CARTON-SHPD-QTY              PIC  S9(9)V COMP-3.      02220000
022300     05  PV-TODAYS-FISCAL-PERIOD         PIC  9(2).               02230000
022400     05  PV-VERIFY-FISCAL-PERIOD         PIC  9(2).               02240000
022500     05  PV-INPUT-DATE.                                           02250000
022600         10  PV-INPUT-DATE-MM            PIC 9(2)  VALUE ZEROES.  02260000
022700         10  FILLER                      PIC X(1)  VALUE SPACES.  02270000
022800         10  PV-INPUT-DATE-DD            PIC 9(2)  VALUE ZEROES.  02280000
022900         10  FILLER                      PIC X(1)  VALUE SPACES.  02290000
023000         10  PV-INPUT-DATE-CCY           PIC 9(4)  VALUE ZEROES.  02300000
023100     05  PV-COMP-DATE-JULIAN             PIC X(08).               02310000
023200     05  PV-END-DATE-JULIAN              PIC X(08).               02320000
023300     05  PV-VFY-DATE-JULIAN              PIC X(08).               02330000
023400     05  PV-FROM-PARAGRAPH               PIC X(35) VALUE SPACES.  02340000
023500     05  PV-COMMAREA-LENGTH              PIC S9(04)  VALUE +0     02350000
023600                                                COMP SYNC.        02360000
023700     05  PV-CICS-RESPONSE                PIC S9(04)  VALUE +0     02370000
023800                                                COMP SYNC.        02380000
023900     05  PV-DISPLAY-SQLCODE              PIC -9(05) VALUE ZEROES. 02390000
024000     05  PV-DISP-FINCL-ADJ-ID            PIC  9(09) VALUE ZEROES. 02400000
024100     05  PV-DISPLAY-UPC-NBR              PIC   9(15).             02410000
024200     05  PV-DISPLAY-INTR-UPC             PIC   9(9).              02420000
024300     05  PV-DISPLAY-AUDIT-CNTL-NBR       PIC   9(09).             02430000
024400     05  PV-DISP-OPER-UNT-ID             PIC   9(04).             02440000
024500     05  PV-DISPLAY-ADJ-ERR-CDE          PIC   9(04).             02450000
024600     05  PV-DISP-SHIPT-UNT-ID            PIC 9(18).               02460000
024700     05  PV-DISP-PO                      PIC 9(09).               02470000
024800     05  PV-DISP-RCVR-SEQ-NBR            PIC 9(04).               02480000
024900     05  PV-DISP-PACK-ID                 PIC 9(04).               02490000
025000     05  PV-DISP-PO-LNE-NBR              PIC 9(04).               02500000
025100     05  PV-DISP-PROB-RSN-CDE            PIC 9(04).               02510000
025200     05  PV-DISP-TRN-TYP-CDE             PIC X(02).               02520000
025300     05  PV-DISP-UPC-NBR                 PIC 9(15).               02530000
025400     05  PV-DISP-STR-NBR                 PIC 9(04).               02540000
025500     05  PV-DISPLAY-CICS-RESP            PIC 999999999-           02550000
025600                                                 VALUE ZEROS.     02560000
025700     05  PV-WORK-TMST.                                            02570000
025800         10  PV-WORK-TMST-1.                                      02580000
025900             15  PV-WK-CCYY           PIC  X(04)  VALUE SPACE.    02590000
026000             15  FILLER                   PIC  X(01)  VALUE SPACE.02600000
026100             15  PV-WK-MO                 PIC  X(02)  VALUE SPACE.02610000
026200             15  FILLER                   PIC  X(01)  VALUE SPACE.02620000
026300             15  PV-WK-DA                 PIC  X(02)  VALUE SPACE.02630000
026400         10  PV-WORK-TMST-2.                                      02640000
026500             15  FILLER                   PIC  X(01)  VALUE SPACE.02650000
026600             15  PV-WK-HH                 PIC  X(02)  VALUE SPACE.02660000
026700             15  FILLER                   PIC  X(01)  VALUE SPACE.02670000
026800             15  PV-WK-MM                 PIC  X(02)  VALUE SPACE.02680000
026900             15  FILLER                   PIC  X(01)  VALUE SPACE.02690000
027000             15  PV-WK-SS                 PIC  X(02)  VALUE SPACE.02700000
027100             15  FILLER                   PIC  X(01)  VALUE SPACE.02710000
027200             15  FILLER                   PIC  X(06)  VALUE ZERO. 02720000
027300     05  PV-TMST                      PIC X(26).                  02730000
027400     05  FILLER REDEFINES PV-TMST.                                02740000
027500         10  PV-CCYY                  PIC X(04).                  02750000
027600         10  FILLER                   PIC X(01).                  02760000
027700         10  PV-MM                    PIC X(02).                  02770000
027800         10  FILLER                   PIC X(01).                  02780000
027900         10  PV-DD                    PIC X(02).                  02790000
028000         10  FILLER                   PIC X(01).                  02800000
028100         10  PV-HH                    PIC X(02).                  02810000
028200         10  FILLER                   PIC X(01).                  02820000
028300         10  PV-MIN                   PIC X(02).                  02830000
028400         10  FILLER                   PIC X(01).                  02840000
028500         10  PV-SEC                   PIC X(02).                  02850000
028600         10  FILLER                   PIC X(01).                  02860000
028700         10  FILLER                   PIC X(06).                  02870000
028800                                                                  02880000
028900******************************************************************02890000
029000*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE SHIPPING UNIT      02900000
029100*  AUDIT TABLE (TSUNAUD)                                          02910000
029200******************************************************************02920000
029300     EXEC SQL                                                     02930000
029400         INCLUDE TSUNAUD                                          02940000
029500     END-EXEC.                                                    02950000
029600                                                                  02960000
029700*---------------------------------------------------------------* 02970000
029800*    DB2 AREA FOR RECEIPT VERIFIED ODD UNITS TABLE              * 02980000
029900*    (RCT_VRFD_ODD_UNT)                                         * 02990000
030000*---------------------------------------------------------------* 03000000
030100     EXEC SQL                                                     03010000
030200          INCLUDE RCT00009                                        03020000
030300     END-EXEC.                                                    03030000
030400*----------------------------------------------------------------*03040000
030500*    DB2 DCLGEN FOR THE TROUBLE NOTIFICATION TABLE                03050000
030600*----------------------------------------------------------------*03060000
030700     EXEC SQL                                                     03070000
030800          INCLUDE TTRBNTF                                         03080000
030900     END-EXEC.                                                    03090000
031000/                                                                 03100000
031100*----------------------------------------------------------------*03110000
031200*    DB2 DCLGEN FOR THE TROUBLE REASON TABLE                      03120000
031300*----------------------------------------------------------------*03130000
031400     EXEC SQL                                                     03140000
031500          INCLUDE TTRBRSN                                         03150000
031600     END-EXEC.                                                    03160000
031700*                                                                 03170000
031800******************************************************************03180000
031900*    DB2 AREA FOR THE OUTBOUND CARTON TABLE (SUT_OTBND_CART)      03190000
032000******************************************************************03200000
032100     EXEC SQL                                                     03210000
032200          INCLUDE SUT00024                                        03220000
032300     END-EXEC.                                                    03230000
032400                                                                  03240000
032500******************************************************************03250000
032600*  SQL AND COBOL DECLARATIONS FOR THE KOHLS/RETEK PARMS (TKRPRPM) 03260000
032700******************************************************************03270000
032800     EXEC SQL                                                     03280000
032900          INCLUDE TKRPRPM                                         03290000
033000     END-EXEC.                                                    03300000
033100                                                                  03310000
033200******************************************************************03320000
033300*    DB2 AREA FOR COMPANY CONTROL TABLE                           03330000
033400******************************************************************03340000
033500                                                                  03350000
033600     EXEC SQL                                                     03360000
033700          INCLUDE TCOCNTL                                         03370000
033800     END-EXEC.                                                    03380000
033900                                                                  03390000
034000******************************************************************03400000
034100* DB2 AREA FOR THE RECEIVER ITEM TABLE                            03410000
034200******************************************************************03420000
034300     EXEC SQL                                                     03430000
034400          INCLUDE TRECITM                                         03440000
034500     END-EXEC.                                                    03450000
034600                                                                  03460000
034700******************************************************************03470000
034800* DB2 AREA FOR THE RECEIVER DISTRIBUTION TABLE                    03480000
034900******************************************************************03490000
035000     EXEC SQL                                                     03500000
035100          INCLUDE TRECDIS                                         03510000
035200     END-EXEC.                                                    03520000
035300                                                                  03530000
035400******************************************************************03540000
035500* DB2 AREA FOR THE RECEIVER TABLE                                 03550000
035600******************************************************************03560000
035700     EXEC SQL                                                     03570000
035800          INCLUDE TRECEIV                                         03580000
035900     END-EXEC.                                                    03590000
036000                                                                  03600000
036100******************************************************************03610000
036200* DB2 AREA FOR THE RECEIVER DIST HEADER TABLE                     03620000
036300******************************************************************03630000
036400     EXEC SQL                                                     03640000
036500          INCLUDE TDISTHD                                         03650000
036600     END-EXEC.                                                    03660000
036700                                                                  03670000
036800******************************************************************03680000
036900*    DB2 DCLGEN FOR DISTRIBUTION DETAIL TABLE                     03690000
037000******************************************************************03700000
037100     EXEC SQL                                                     03710000
037200          INCLUDE TDISTDT                                         03720000
037300     END-EXEC.                                                    03730000
037400                                                                  03740000
037500******************************************************************03750000
037600*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE SHIPPING UNIT      03760000
037700*  AUDIT TRANSATIONS(CARTONS) TABLE (TSUATRN)                     03770000
037800******************************************************************03780000
037900     EXEC SQL                                                     03790000
038000         INCLUDE TSUATRN                                          03800000
038100     END-EXEC.                                                    03810000
038200                                                                  03820000
038300******************************************************************03830000
038400*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE SHIPPING UNIT      03840000
038500*  AUDIT CONTENT TABLE - UPC'S  (TSUAUPC)                         03850000
038600******************************************************************03860000
038700     EXEC SQL                                                     03870000
038800         INCLUDE TSUAUPC                                          03880000
038900     END-EXEC.                                                    03890000
039000                                                                  03900000
039100******************************************************************03910000
039200*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE UPC TABLE (XLT_UPC)03920000
039300******************************************************************03930000
039400     EXEC SQL                                                     03940000
039500         INCLUDE XLT00006                                         03950000
039600     END-EXEC.                                                    03960000
039700                                                                  03970000
039800                                                                  03980000
039900******************************************************************03990000
040000*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE ADJUSTMENTS        04000000
040100*  TABLE (SUT_FINCL_ADJ)                                          04010000
040200******************************************************************04020000
040300     EXEC SQL                                                     04030000
040400         INCLUDE SUT00030                                         04040000
040500     END-EXEC.                                                    04050000
040600                                                                  04060000
040700******************************************************************04070000
040800*    DB2 AREA FOR THE PO AUDIT REQUEST TABLE (SUT_PO_AUD_REQ)   * 04080000
040900******************************************************************04090000
041000     EXEC SQL                                                     04100000
041100         INCLUDE SUT00015                                         04110000
041200     END-EXEC.                                                    04120000
041300                                                                  04130000
041400*----------------------------------------------------------------*04140000
041500*    INVENTORY PARAMETERS TABLE                                  *04150000
041600*----------------------------------------------------------------*04160000
041700                                                                  04170000
041800     EXEC SQL                                                     04180000
041900          INCLUDE XLT00025                                        04190010
042000     END-EXEC.                                                    04200000
042100                                                                  04210000
042200*---------------------------------------------------------------* 04220000
042300*    DB2 AREA FOR PURCHASE ORDER ITEM TABLE                     * 04230000
042400*---------------------------------------------------------------* 04240000
042500     EXEC SQL                                                     04250000
042600          INCLUDE TPURITM                                         04260000
042700     END-EXEC.                                                    04270000
042800******************************************************************04280000
042900******************************************************************04290000
043000*  COMMUNICATIONS AREA FOR DB2                                    04300000
043100******************************************************************04310000
043200     EXEC SQL                                                     04320000
043300         INCLUDE SQLCA                                            04330000
043400     END-EXEC.                                                    04340000
043500                                                                  04350000
043600*----------------------------------------------------------------*04360000
043700*    DB2 CURSOR DEFINITION FOR RETRIEVAL OF RECITMS FOR A PACK-ID 04370000
043800*----------------------------------------------------------------*04380000
043900     EXEC SQL                                                     04390000
044000         DECLARE RECITM-CURSOR CURSOR FOR                         04400000
044100          SELECT ORD_LNE_NBR                                      04410000
044200               , PREPK_RATO_QTY                                   04420000
044300            FROM TRECITM                                          04430000
044400           WHERE ORD_NBR        = :DK-PO                          04440000
044500             AND REC_SEQ_NBR    = :DK-REC-SEQ-NBR                 04450000
044600             AND FCLTY_ID       = 1                               04460000
044700             AND PREPK_ID       = :DK-PACK-ID                     04470000
044800             AND VER_STATUS_CDE = 'A'                             04480000
044900     END-EXEC.                                                    04490000
045000                                                                  04500000
045100******************************************************************04510000
045200 LINKAGE SECTION.                                                 04520000
045300 01  DFHCOMMAREA.                                                 04530000
045400     05  FILLER                         OCCURS  1 TO 4072 TIMES   04540000
045500                                      DEPENDING ON EIBCALEN.      04550000
045600         10  FILLER                   PIC X.                      04560000
045700******************************************************************04570000
045800                                                                  04580000
045900******************************************************************04590000
046000 PROCEDURE DIVISION.                                              04600000
046100******************************************************************04610000
046200 0000-PROGRAM-MAINLINE.                                           04620000
046300     INITIALIZE PV-PROGRAM-VARIABLES                              04630000
046400                PS-PROGRAM-SWITCHES                               04640000
046500                SU035-COMM-AREA.                                  04650000
046600     MOVE DFHCOMMAREA              TO  SU035-COMM-AREA.           04660000
046700     SET PS-NO-ERROR TO TRUE.                                     04670000
046800     MOVE SU035-ORIG-OPER-UNT-ID   TO DK-OPER-UNT-ID.             04680000
046900     PERFORM 7100-CHECK-FOR-LOGGING.                              04690000
047000     IF PS-LOG-MESSAGE                                            04700000
047100         MOVE SU035-PO            TO PV-DISP-PO                   04710000
047200         MOVE SU035-REC-SEQ-NBR   TO PV-DISP-RCVR-SEQ-NBR         04720000
047300         MOVE SU035-PO-LNE-NBR    TO PV-DISP-PO-LNE-NBR           04730000
047400         STRING   ' SUKUT702 PROGRAM STARTED -'                   04740000
047500                  ' CALLED BY-'                                   04750000
047600                  SU035-PROGRAM-NAME                              04760000
047700                  ' PO='                                          04770000
047800                  PV-DISP-PO                                      04780000
047900                  ' RCVR='                                        04790000
048000                  PV-DISP-RCVR-SEQ-NBR                            04800000
048100                  ' LNE='                                         04810000
048200                  PV-DISP-PO-LNE-NBR                              04820000
048300                  DELIMITED BY SIZE                               04830000
048400                                  INTO PV-CICS-MSG-AREA           04840000
048500         MOVE PV-CICS-MSG-AREA      TO SU035-CRA-RET-MSG          04850000
048600         PERFORM 9999-WRITE-TO-CSSL                               04860000
048700     END-IF.                                                      04870000
048800     PERFORM 1000-PROCESS-ADJUSTMENT.                             04880000
048900                                                                  04890000
049000     MOVE PV-CYC-ADJ-NBR                TO SU035-CYC-ADJ-NBR.     04900000
049100     MOVE SU035-COMM-AREA               TO DFHCOMMAREA.           04910000
049200     GOBACK.                                                      04920000
049300                                                                  04930000
049400 1000-PROCESS-ADJUSTMENT.                                         04940000
049500                                                                  04950000
049600     INITIALIZE DCLSUT00030.                                      04960000
049700     SET  PS-RECEIVER-NOT-FOUND                                   04970000
049800          PS-NO-SUT-OTBND-WRTN                                    04980000
049900          PS-USE-VERIFIED-QTY                                     04990000
050000          PS-LINE-FOUND                                           05000000
050100          PS-AUTO-APPLY                                           05010000
050200          PS-NOT-POST-VERIFIED-STATUS                             05020000
050300          PS-NOT-VERIFIED-STATUS TO TRUE.                         05030000
050400     IF SU035-PROGRAM-NAME = 'SUKRF512' OR                        05040000
050500        SU035-PROGRAM-NAME = 'SUKRF515'                           05050000
050600         PERFORM 7500-CHECK-IF-SYSTEM-GEN                         05060000
050700         PERFORM 7600-SELECT-TSUNAUD-AUD-TYPE                     05070000
050800     END-IF.                                                      05080000
050900     PERFORM 1100-PROCESS-RECEIVER.                               05090000
051000     IF PS-AUTO-APPLY                                             05100000
051100         PERFORM 1200-PROCESS-REC-ITEM                            05110000
051200     END-IF.                                                      05120000
051300     PERFORM 5700-GET-TDISTHD.                                    05130000
051400     PERFORM 5800-GET-TDISTDT.                                    05140000
051500     IF PS-AUTO-APPLY                                             05150000
051600         PERFORM 1300-PROCESS-REC-DIS                             05160000
051700     END-IF.                                                      05170000
051800     IF SU035-LOG-ONLY OR                                         05180000
051900        SU035-LOG-AS-FAIL                                         05190000
052000         IF SU035-LOG-ONLY AND                                    05200005
052100            PS-LINE-FOUND                                         05210005
052200             IF PS-RECDIS-NOT-FOUND                               05220003
052300                 IF PS-NO-DISTDT-FOUND AND                        05230003
052400                    RECEIV-PACK-BY-ST-IND NOT EQUAL 'Y'           05240003
052500                     PERFORM 5900-INSERT-TRANS-DTL-REC            05250003
052600                 END-IF                                           05260003
052700                 PERFORM 6300-INSERT-TRECDIS                      05270003
052800             ELSE                                                 05280003
052900                 IF PS-NO-DISTDT-FOUND AND                        05290003
053000                    RECEIV-PACK-BY-ST-IND NOT EQUAL 'Y'           05300003
053100                     PERFORM 5900-INSERT-TRANS-DTL-REC            05310003
053200                 END-IF                                           05320003
053300             END-IF                                               05330003
053400         END-IF                                                   05340000
053500         SET SU035-SUCCESSFUL TO TRUE                             05350000
053600         IF SU035-PROGRAM-NAME = 'PCCS722B' OR                    05360000
053700            SU035-PROGRAM-NAME = 'PCCS722D' OR                    05370000
053800            SU035-PROGRAM-NAME = 'PCCS107B' OR                    05380000
053900            SU035-PROGRAM-NAME = 'PCCS107D' OR                    05390000
054000            SU035-PROGRAM-NAME = 'PCCS766B' OR                    05400000
054100            SU035-PROGRAM-NAME = 'PCCS766D'                       05410000
054200             MOVE 23 TO SUT00030-ADJ-ERR-CDE                      05420000
054300         ELSE                                                     05430000
054400             IF SU035-PROGRAM-NAME = 'PCCS722E' OR                05440000
054500                SU035-PROGRAM-NAME = 'PCCS107E' OR                05450000
054600                SU035-PROGRAM-NAME = 'PCCS766E'                   05460000
054700                 MOVE 24 TO SUT00030-ADJ-ERR-CDE                  05470000
054800             END-IF                                               05480000
054900         END-IF                                                   05490000
055000         IF PS-NO-SUT-OTBND-WRTN AND                              05500000
055100            SU035-BEFORE-QTY NOT EQUAL SU035-AFTER-QTY            05510000
055200             PERFORM 6100-MOVE-TO-FINCL-ADJ                       05520000
055300             PERFORM 6150-INSERT-FINCL-ADJ                        05530000
055400         END-IF                                                   05540000
055500     ELSE                                                         05550000
055600         IF PS-AUTO-APPLY                                         05560000
055700             IF PS-VERIFIED-STATUS                                05570000
055800                 PERFORM 1400-PROCESS-VERIFIED-RECEIVER           05580000
055900             ELSE                                                 05590000
056000                 PERFORM 1700-UPDATE-STORE-QUANTITIES             05600000
056100             END-IF                                               05610000
056200             IF PS-AUTO-APPLY                                     05620000
056300                 SET SU035-SUCCESSFUL TO TRUE                     05630000
056400                 IF PS-NO-SUT-OTBND-WRTN AND                      05640000
056500                    SU035-BEFORE-QTY NOT EQUAL SU035-AFTER-QTY    05650000
056600                     PERFORM 6100-MOVE-TO-FINCL-ADJ               05660000
056700                     PERFORM 6150-INSERT-FINCL-ADJ                05670000
056800                 END-IF                                           05680000
056900             END-IF                                               05690000
057000         ELSE                                                     05700000
057100             IF PS-NO-SUT-OTBND-WRTN AND                          05710000
057200                SU035-BEFORE-QTY NOT EQUAL SU035-AFTER-QTY        05720000
057300                 PERFORM 6100-MOVE-TO-FINCL-ADJ                   05730000
057400                 PERFORM 6150-INSERT-FINCL-ADJ                    05740000
057500             END-IF                                               05750000
057600         END-IF                                                   05760000
057700     END-IF.                                                      05770000
057800                                                                  05780000
057900 1100-PROCESS-RECEIVER.                                           05790000
058000     PERFORM 5000-CHECK-RECEIVER.                                 05800000
058100     IF PS-RECEIVER-FOUND                                         05810000
058200         MOVE RECEIV-OPER-UNT-ID   TO DK-OPER-UNT-ID              05820000
058300         IF RECEIV-STATUS-CDE = 'DE'                              05830000
058400             MOVE 'DELETED RECEIVER'  TO SU035-CRA-RET-MSG        05840000
058500             MOVE 14 TO SUT00030-ADJ-ERR-CDE                      05850000
058600             SET PS-NO-AUTO-APPLY TO TRUE                         05860000
058700             MOVE 371              TO  PV-TRBL-RSN-CDE            05870000
058800             IF PS-NO-SUT-OTBND-WRTN                              05880000
058900                 PERFORM 1600-CREATE-TROUBLE                      05890000
059000                 PERFORM 6100-MOVE-TO-FINCL-ADJ                   05900000
059100                 PERFORM 6150-INSERT-FINCL-ADJ                    05910000
059200             END-IF                                               05920000
059300             SET SU035-NO-CHANGE  TO TRUE                         05930000
059400             SET SU035-ERROR      TO TRUE                         05940000
059500         ELSE                                                     05950000
059600             IF RECEIV-STATUS-CDE NOT = 'VE'                      05960000
059700                 SET PS-NOT-VERIFIED-STATUS  TO TRUE              05970000
059800             ELSE                                                 05980000
059900                 SET PS-VERIFIED-STATUS TO TRUE                   05990000
060000                 IF RECEIV-ML-POST-TMST NOT = PC-DEFAULT-TMST     06000000
060100                     SET PS-POST-VERIFIED-STATUS TO TRUE          06010000
060200                 END-IF                                           06020000
060300             END-IF                                               06030000
060400         END-IF                                                   06040000
060500     ELSE                                                         06050000
060600         MOVE 'NO RECEIVER FOUND'     TO SU035-CRA-RET-MSG        06060000
060700         MOVE 15 TO SUT00030-ADJ-ERR-CDE                          06070000
060800         SET PS-NO-AUTO-APPLY TO TRUE                             06080000
060900         MOVE 371              TO  PV-TRBL-RSN-CDE                06090000
061000         IF PS-NO-SUT-OTBND-WRTN                                  06100000
061100             PERFORM 1600-CREATE-TROUBLE                          06110000
061200             PERFORM 6100-MOVE-TO-FINCL-ADJ                       06120000
061300             PERFORM 6150-INSERT-FINCL-ADJ                        06130000
061400         END-IF                                                   06140000
061500         SET SU035-ERROR      TO TRUE                             06150000
061600         SET SU035-NO-CHANGE  TO TRUE                             06160000
061700     END-IF.                                                      06170000
061800                                                                  06180000
061900 1200-PROCESS-REC-ITEM.                                           06190000
062000     PERFORM 5100-CHECK-TRECITM.                                  06200000
062100     IF PS-LINE-FOUND                                             06210000
062200         IF RECITM-VER-STATUS-CDE = 'I'                           06220000
062300             MOVE 'INACTIVE ITEM'     TO SU035-CRA-RET-MSG        06230000
062400             MOVE 16 TO SUT00030-ADJ-ERR-CDE                      06240000
062500             SET PS-NO-AUTO-APPLY TO TRUE                         06250000
062600             MOVE 371              TO  PV-TRBL-RSN-CDE            06260000
062700             IF PS-NO-SUT-OTBND-WRTN                              06270000
062800                 IF PS-NOT-VERIFIED-STATUS                        06280000
062900                     PERFORM 1600-CREATE-TROUBLE                  06290000
063000                 END-IF                                           06300000
063100                 PERFORM 6100-MOVE-TO-FINCL-ADJ                   06310000
063200                 PERFORM 6150-INSERT-FINCL-ADJ                    06320000
063300             END-IF                                               06330000
063400             SET SU035-ERROR      TO TRUE                         06340000
063500             SET SU035-NO-CHANGE  TO TRUE                         06350000
063600         ELSE                                                     06360000
063700             IF RECITM-STATUS-CDE = 'DE'                          06370000
063800                 MOVE 'DELETED ITEM'  TO SU035-CRA-RET-MSG        06380000
063900                 MOVE 17 TO SUT00030-ADJ-ERR-CDE                  06390000
064000                 SET PS-NO-AUTO-APPLY TO TRUE                     06400000
064100                 MOVE 371          TO  PV-TRBL-RSN-CDE            06410000
064200                 IF PS-NO-SUT-OTBND-WRTN                          06420000
064300                     IF PS-NOT-VERIFIED-STATUS                    06430000
064400                         PERFORM 1600-CREATE-TROUBLE              06440000
064500                     END-IF                                       06450000
064600                     PERFORM 6100-MOVE-TO-FINCL-ADJ               06460000
064700                     PERFORM 6150-INSERT-FINCL-ADJ                06470000
064800                 END-IF                                           06480000
064900                 SET SU035-ERROR      TO TRUE                     06490000
065000                 SET SU035-NO-CHANGE  TO TRUE                     06500000
065100             END-IF                                               06510000
065200         END-IF                                                   06520000
065300     ELSE                                                         06530000
065400         MOVE 'NO REC ITEM FOUND'     TO SU035-CRA-RET-MSG        06540000
065500         MOVE 18 TO SUT00030-ADJ-ERR-CDE                          06550000
065600         SET PS-NO-AUTO-APPLY TO TRUE                             06560000
065700         MOVE 371          TO  PV-TRBL-RSN-CDE                    06570000
065800         IF PS-NO-SUT-OTBND-WRTN                                  06580000
065900             IF PS-NOT-VERIFIED-STATUS                            06590000
066000                 PERFORM 1600-CREATE-TROUBLE                      06600000
066100             END-IF                                               06610000
066200             PERFORM 6100-MOVE-TO-FINCL-ADJ                       06620000
066300             PERFORM 6150-INSERT-FINCL-ADJ                        06630000
066400         END-IF                                                   06640000
066500         SET SU035-ERROR      TO TRUE                             06650000
066600         SET SU035-NO-CHANGE  TO TRUE                             06660000
066700     END-IF.                                                      06670000
066800                                                                  06680000
066900 1300-PROCESS-REC-DIS.                                            06690000
067000     PERFORM 5200-SELECT-RECDIS.                                  06700000
067100     IF (PS-VERIFIED-STATUS AND                                   06710000
067200        RECEIV-ML-POST-TMST NOT = PC-DEFAULT-TMST)                06720000
067300         SET PS-USE-AP-VERIFIED-QTY TO TRUE                       06730000
067400     END-IF.                                                      06740000
067500     IF SU035-LOG-ONLY OR                                         06750000
067600        SU035-LOG-AS-FAIL                                         06760000
067700         CONTINUE                                                 06770000
067800     ELSE                                                         06780000
067900         PERFORM 6000-GET-OUTBOUND-CART                           06790000
068000         IF PS-RECDIS-FOUND                                       06800000
068100                                                                  06810000
068200             IF PS-USE-AP-VERIFIED-QTY                            06820000
068300                 COMPUTE PV-ITM-QTY = RECDIS-AP-VERIFY-ITM-QTY    06830000
068400                     + SU035-ADJUST-QTY                           06840000
068500             ELSE                                                 06850000
068600                 IF PS-NOT-VERIFIED-STATUS AND                    06860000
068700                    RECITM-STATUS-CDE NOT = 'VE' AND              06870000
068800                    PS-DISTHD-FOUND AND                           06880000
068900                    DISTHD-TOT-CART-CNT > 0 AND                   06890000
069000                    DISTHD-VRFD-TMST = PC-DEFAULT-TMST AND        06900000
069100                    SU035-UPDATE-DISTDT                           06910000
069200                                                                  06920000
069300                     IF PS-NO-OUTBND-CART-FOUND                   06930000
069400                         MOVE 'NO OUTBOUND CART'                  06940000
069500                                TO SU035-CRA-RET-MSG              06950000
069600                         MOVE 20 TO SUT00030-ADJ-ERR-CDE          06960000
069700                         SET PS-NO-AUTO-APPLY TO TRUE             06970000
069800                         MOVE 371          TO  PV-TRBL-RSN-CDE    06980000
069900                         IF PS-NO-SUT-OTBND-WRTN                  06990000
070000                             IF PS-NOT-VERIFIED-STATUS            07000000
070100                                 PERFORM 1600-CREATE-TROUBLE      07010000
070200                             END-IF                               07020000
070300                             PERFORM 6100-MOVE-TO-FINCL-ADJ       07030000
070400                             PERFORM 6150-INSERT-FINCL-ADJ        07040000
070500                         END-IF                                   07050000
070600                         SET SU035-ERROR      TO TRUE             07060000
070700                         SET SU035-NO-CHANGE  TO TRUE             07070000
070800                                                                  07080000
070900                     ELSE                                         07090000
071000                         MOVE 0        TO PV-ITM-QTY              07100000
071100                                          PV-ODD-QTY              07110000
071200                                          PV-ODD-DIF              07120000
071300                                          PV-QTY-DIF              07130000
071400                         IF SU035-ODD-UNIT-NO                     07140000
071500                             COMPUTE PV-ITM-QTY =                 07150000
071600                                 DISTDT-FCSE-ACTL-UNT-QTY +       07160000
071700                                         SU035-ADJUST-QTY         07170000
071800                         ELSE                                     07180000
071900                             IF SU035-BEFORE-QTY =                07190000
072000                                  SU035-BEFORE-ODD-UNT-QTY AND    07200000
072100                                SU035-AFTER-QTY =                 07210000
072200                                 SU035-AFTER-ODD-UNT-QTY          07220000
072300****                ADJUSTMENTS ONLY TO ODD UNITS                 07230000
072400                                 COMPUTE PV-ODD-DIF =             07240000
072500                                   SU035-AFTER-ODD-UNT-QTY -      07250000
072600                                   SU035-BEFORE-ODD-UNT-QTY       07260000
072700                                 COMPUTE PV-ODD-QTY =             07270000
072800                                   DISTDT-PREPK-ODD-UNT-QTY +     07280000
072900                                        PV-ODD-DIF                07290000
073000                             ELSE                                 07300000
073100                                 COMPUTE PV-ODD-DIF =             07310000
073200                                   SU035-AFTER-ODD-UNT-QTY -      07320000
073300                                   SU035-BEFORE-ODD-UNT-QTY       07330000
073400                                 COMPUTE PV-ODD-QTY =             07340000
073500                                   DISTDT-PREPK-ODD-UNT-QTY +     07350000
073600                                        PV-ODD-DIF                07360000
073700                                 COMPUTE PV-QTY-DIF =             07370000
073800                                  (SU035-AFTER-QTY -              07380000
073900                                   SU035-AFTER-ODD-UNT-QTY) -     07390000
074000                                  (SU035-BEFORE-QTY -             07400000
074100                                   SU035-BEFORE-ODD-UNT-QTY)      07410000
074200                                 COMPUTE PV-ITM-QTY =             07420000
074300                                    DISTDT-FCSE-ACTL-UNT-QTY +    07430000
074400                                         PV-QTY-DIF               07440000
074500                             END-IF                               07450000
074600                         END-IF                                   07460000
074700                     END-IF                                       07470000
074800                 ELSE                                             07480000
074900                     COMPUTE PV-ITM-QTY = RECDIS-VERIFY-ITM-QTY   07490000
075000                         + SU035-ADJUST-QTY                       07500000
075100                 END-IF                                           07510000
075200             END-IF                                               07520000
075300             IF PV-ITM-QTY < 0 OR                                 07530000
075400                PV-ODD-QTY < 0                                    07540000
075500                 MOVE                                             07550000
075600                 'ADJUSTMENT AMOUNT EXCEEDS AVAILABLE BALANCE'    07560000
075700                              TO SU035-CRA-RET-MSG                07570000
075800                 MOVE 10 TO SUT00030-ADJ-ERR-CDE                  07580000
075900                 SET PS-NO-AUTO-APPLY TO TRUE                     07590000
076000                 MOVE 371          TO  PV-TRBL-RSN-CDE            07600000
076100                 IF PS-NO-SUT-OTBND-WRTN                          07610000
076200                     IF PS-NOT-VERIFIED-STATUS                    07620000
076300                         PERFORM 1600-CREATE-TROUBLE              07630000
076400                     END-IF                                       07640000
076500                     PERFORM 6100-MOVE-TO-FINCL-ADJ               07650000
076600                     PERFORM 6150-INSERT-FINCL-ADJ                07660000
076700                 END-IF                                           07670000
076800                 SET SU035-ERROR      TO TRUE                     07680000
076900                 SET SU035-NO-CHANGE  TO TRUE                     07690000
077000             END-IF                                               07700000
077100         ELSE                                                     07710000
077200             IF SU035-ADJUST-QTY < 0                              07720000
077300                 MOVE 'NO RECDIS AND ADJUSTMENT QTY IS NEGATIVE'  07730000
077400                                        TO SU035-CRA-RET-MSG      07740000
077500                 MOVE 14 TO SUT00030-ADJ-ERR-CDE                  07750000
077600                 SET PS-NO-AUTO-APPLY TO TRUE                     07760000
077700                 MOVE 371          TO  PV-TRBL-RSN-CDE            07770000
077800                 IF PS-NO-SUT-OTBND-WRTN                          07780000
077900                     IF PS-NOT-VERIFIED-STATUS                    07790000
078000                         PERFORM 1600-CREATE-TROUBLE              07800000
078100                     END-IF                                       07810000
078200                     PERFORM 6100-MOVE-TO-FINCL-ADJ               07820000
078300                     PERFORM 6150-INSERT-FINCL-ADJ                07830000
078400                 END-IF                                           07840000
078500                 SET SU035-ERROR      TO TRUE                     07850000
078600                 SET SU035-NO-CHANGE  TO TRUE                     07860000
078700             ELSE                                                 07870000
078800                 SET PS-STORE-FOUND TO TRUE                       07880000
078900                 INITIALIZE XL071-COMMAREA-REC                    07890000
079000                 MOVE DK-STR-NBR     TO XL071-LOCATION-NUMBER     07900000
079100                 PERFORM 8500-SELECT-STORE                        07910000
079200                 IF PS-STORE-NOT-FOUND                            07920000
079300                     MOVE 'INACTIVE STORE'  TO SU035-CRA-RET-MSG  07930000
079400                     MOVE  9 TO SUT00030-ADJ-ERR-CDE              07940000
079500                     SET PS-NO-AUTO-APPLY TO TRUE                 07950000
079600                     MOVE 371          TO  PV-TRBL-RSN-CDE        07960000
079700                     IF PS-NO-SUT-OTBND-WRTN                      07970000
079800                         IF PS-NOT-VERIFIED-STATUS                07980000
079900                             PERFORM 1600-CREATE-TROUBLE          07990000
080000                         END-IF                                   08000000
080100                         PERFORM 6100-MOVE-TO-FINCL-ADJ           08010000
080200                         PERFORM 6150-INSERT-FINCL-ADJ            08020000
080300                     END-IF                                       08030000
080400                     SET SU035-ERROR      TO TRUE                 08040000
080500                     SET SU035-NO-CHANGE  TO TRUE                 08050000
080600                 END-IF                                           08060000
080700             END-IF                                               08070000
080800         END-IF                                                   08080000
080900     END-IF.                                                      08090000
081000                                                                  08100000
081100 1400-PROCESS-VERIFIED-RECEIVER.                                  08110000
081200**   IF RECEIV-REC-TMST = PC-DEFAULT-TMST                         08120000
081300**       SET PS-PRE-RECVR-STAT TO TRUE                            08130000
081400**   ELSE                                                         08140000
081500                                                                  08150000
081600     IF RECEIV-ML-POST-TMST = PC-DEFAULT-TMST                     08160000
081700         IF PS-RECDIS-NOT-FOUND                                   08170000
081800             IF PS-NO-DISTDT-FOUND AND                            08180000
081900                RECEIV-PACK-BY-ST-IND NOT EQUAL 'Y'               08190000
082000                 PERFORM 5900-INSERT-TRANS-DTL-REC                08200000
082100             END-IF                                               08210000
082200             PERFORM 6300-INSERT-TRECDIS                          08220000
082300         ELSE                                                     08230000
082400             IF PS-NO-DISTDT-FOUND AND                            08240004
082500                RECEIV-PACK-BY-ST-IND NOT EQUAL 'Y'               08250004
082600                 PERFORM 5900-INSERT-TRANS-DTL-REC                08260004
082700             END-IF                                               08270004
082800             SET PS-BEFORE-ONLY-LOGGING   TO TRUE                 08280000
082900             INITIALIZE RC031-FIELDS                              08290000
083000             MOVE SU035-PO-LNE-NBR        TO RC031-PO-LNE-NBR     08300000
083100             PERFORM 6600-ADD-TO-RECD-AUDIT-BEFORE                08310000
083200         END-IF                                                   08320000
083300         COMPUTE RECDIS-VERIFY-ITM-QTY =                          08330000
083400             RECDIS-VERIFY-ITM-QTY + SU035-ADJUST-QTY             08340000
083500         COMPUTE RECDIS-AP-VERIFY-ITM-QTY =                       08350000
083600             RECDIS-AP-VERIFY-ITM-QTY + SU035-ADJUST-QTY          08360000
083700         PERFORM 6200-UPDATE-TRECDIS                              08370000
083800         IF SU035-ODD-UNIT-YES                                    08380000
083900             PERFORM 7200-UPDATE-ODD-REC                          08390000
084000         END-IF                                                   08400000
084100         IF SU035-UPDATE-UNTS-WORKED-IND = 'Y'                    08410000
084200             INITIALIZE PC238-COMM-AREA                           08420000
084300             SET  PC238-TRANS-POST-VRFY-ADJ TO TRUE               08430000
084400             SET  PC238-MANUAL-VERIFY     TO TRUE                 08440000
084500             PERFORM 8000-UNITS-WORK-ROUTINE                      08450000
084600         END-IF                                                   08460000
084700         SET PS-UPDATE-TRECDIS TO TRUE                            08470000
084800     ELSE                                                         08480000
084900         PERFORM 2100-DETERMINE-FISCAL-PERIOD                     08490000
085000         IF PS-AUTO-APPLY                                         08500000
085100             PERFORM 2300-CHECK-INVENTORY-DATE                    08510000
085200         END-IF                                                   08520000
085300         IF PS-AUTO-APPLY                                         08530000
085400             PERFORM 2600-CALC-DAYS-SINCE-VERFD                   08540000
085500         END-IF                                                   08550000
085600         IF PS-AUTO-APPLY                                         08560000
085700             IF (RECEIV-AP-PRC-CDE = 'W' OR 'J' OR 'M') OR        08570000
085800                (RECDIS-AP-PRC-CDE = 'W' OR 'J' OR 'M')           08580000
085900                 SET PS-UPDATE-NO       TO TRUE                   08590000
086000                 SET PS-NO-AUTO-APPLY TO TRUE                     08600000
086100                 MOVE 3  TO SUT00030-ADJ-ERR-CDE                  08610000
086200                 MOVE 'INVOICE HAS ALREADY BEEN MATCHED'          08620000
086300                              TO SU035-CRA-RET-MSG                08630000
086400                 MOVE 371          TO  PV-TRBL-RSN-CDE            08640000
086500                 IF PS-NO-SUT-OTBND-WRTN                          08650000
086600                     PERFORM 1600-CREATE-TROUBLE                  08660000
086700                     PERFORM 6100-MOVE-TO-FINCL-ADJ               08670000
086800                     PERFORM 6150-INSERT-FINCL-ADJ                08680000
086900                 END-IF                                           08690000
087000                 SET SU035-ERROR      TO TRUE                     08700000
087100                 SET SU035-NO-CHANGE  TO TRUE                     08710000
087200             END-IF                                               08720000
087300         END-IF                                                   08730000
087400         IF PS-AUTO-APPLY                                         08740000
087500             PERFORM 1500-PROCESS-TROUBLE                         08750000
087600             IF PS-RECDIS-NOT-FOUND                               08760000
087700                 IF PS-NO-DISTDT-FOUND AND                        08770000
087800                    RECEIV-PACK-BY-ST-IND NOT EQUAL 'Y'           08780000
087900                     PERFORM 5900-INSERT-TRANS-DTL-REC            08790000
088000                 END-IF                                           08800000
088100                 PERFORM 6300-INSERT-TRECDIS                      08810000
088200             ELSE                                                 08820004
088300                 IF PS-NO-DISTDT-FOUND AND                        08830004
088400                    RECEIV-PACK-BY-ST-IND NOT EQUAL 'Y'           08840004
088500                     PERFORM 5900-INSERT-TRANS-DTL-REC            08850004
088600                 END-IF                                           08860004
088700             END-IF                                               08870000
088800             SET PS-NOT-BEFORE-ONLY-LOGGING TO TRUE               08880000
088900             INITIALIZE RC031-FIELDS                              08890000
089000             MOVE SU035-PO-LNE-NBR    TO RC031-PO-LNE-NBR         08900000
089100             PERFORM 6600-ADD-TO-RECD-AUDIT-BEFORE                08910000
089200             COMPUTE RECDIS-AP-VERIFY-ITM-QTY =                   08920000
089300                 RECDIS-AP-VERIFY-ITM-QTY + SU035-ADJUST-QTY      08930000
089400             PERFORM 6200-UPDATE-TRECDIS                          08940000
089500             PERFORM 6800-ADD-TO-RECD-AUDIT-AFTER                 08950000
089600             IF SU035-ODD-UNIT-YES                                08960000
089700                 PERFORM 7200-UPDATE-ODD-REC                      08970000
089800             END-IF                                               08980000
089900             IF SU035-UPDATE-UNTS-WORKED-IND = 'Y'                08990000
090000                 INITIALIZE PC238-COMM-AREA                       09000000
090100                 SET  PC238-TRANS-POST-VRFY-ADJ TO TRUE           09010000
090200                 SET  PC238-MANUAL-VERIFY     TO TRUE             09020000
090300                 PERFORM 8000-UNITS-WORK-ROUTINE                  09030000
090400             END-IF                                               09040000
090500             SET PS-UPDATE-TRECDIS TO TRUE                        09050000
090600         END-IF                                                   09060000
090700     END-IF.                                                      09070000
090800                                                                  09080000
090900 1500-PROCESS-TROUBLE.                                            09090000
091000     PERFORM 6900-GET-TRECITM-DATA.                               09100000
091100**   PERFORM 7000-LOOK-FOR-TROUBLE.                               09110000
091200**   IF PS-TRBL-EXISTS                                            09120000
091300**       MOVE TRBNTF-NOTIF-NBR   TO PV-NOTIF-NBR                  09130000
091400**                                  PV-CYC-ADJ-NBR                09140000
091500**   ELSE                                                         09150000
091600         MOVE 602                  TO  PV-TRBL-RSN-CDE            09160000
091700         PERFORM 1600-CREATE-TROUBLE                              09170000
091800         MOVE TM500-NOTIF-NBR    TO PV-NOTIF-NBR                  09180000
091900         IF SU035-CYC-ADJ-NBR > 0                                 09190000
092000             MOVE SU035-CYC-ADJ-NBR  TO PV-CYC-ADJ-NBR            09200000
092100         ELSE                                                     09210000
092200             MOVE TM500-NOTIF-NBR    TO PV-CYC-ADJ-NBR            09220000
092300         END-IF.                                                  09230000
092400**   END-IF.                                                      09240000
092500                                                                  09250000
092600 1600-CREATE-TROUBLE.                                             09260000
092700                                                                  09270000
092800     INITIALIZE TM500-FIELDS.                                     09280000
092900     SET TM500-ADD-DETAILS                                        09290000
093000         TM500-CREATE-MANUAL       TO  TRUE.                      09300000
093100                                                                  09310000
093200     MOVE 0                        TO  TM500-NOTIF-NBR.           09320000
093300     MOVE SU035-ORIG-OPER-UNT-ID   TO  TM500-OPER-UNT-ID.         09330002
093400     MOVE 1                        TO  TM500-FCLTY-ID.            09340000
093500                                                                  09350000
093600     MOVE SU035-PO                 TO  TM500-PO-NBR.              09360000
093700                                                                  09370000
093800     SET TM500-LINE-LEVEL          TO  TRUE.                      09380000
093900     IF PS-LINE-FOUND                                             09390000
094000         MOVE SU035-PO-LNE-NBR     TO  TM500-PO-LNE-NBR           09400000
094100     ELSE                                                         09410000
094200         MOVE ZERO                 TO  TM500-PO-LNE-NBR           09420000
094300     END-IF.                                                      09430000
094400                                                                  09440000
094500     MOVE SU035-REC-SEQ-NBR        TO  TM500-REC-SEQ-NBR.         09450000
094600     MOVE PV-TRBL-RSN-CDE          TO  TM500-TRBL-RSN-CDE.        09460000
094700                                                                  09470000
094800     MOVE SU035-CREATE-USER-ID     TO  TM500-CRE-UID              09480000
094900                                       TM500-NOTIF-UID.           09490000
095000                                                                  09500000
095100     MOVE SU035-FINCL-ADJ-ID    TO PV-DISP-FINCL-ADJ-ID.          09510000
095200     IF PV-TRBL-RSN-CDE = 602                                     09520000
095300         STRING 'POST VERIFICATION AUTOMATED STORE ADJUSTMENT '   09530000
095400              'IS COMPLETED SUCCESSFULLY'                         09540000
095500              DELIMITED BY SIZE                                   09550000
095600            INTO TM500-FREEFORM-TEXT                              09560000
095700     ELSE                                                         09570000
095800         STRING 'THERE IS AT LEAST ONE FAILED STORE UNIT '        09580000
095900              'ADJUSTMENT'                                        09590000
096000              DELIMITED BY SIZE                                   09600000
096100            INTO TM500-FREEFORM-TEXT                              09610000
096200     END-IF.                                                      09620000
096300                                                                  09630000
096400     PERFORM 8200-LINK-TO-UPDATE.                                 09640000
096500     IF TM500-CALL-SUCCESSFUL                                     09650000
096600      OR TM500-DUPLICATE-TROUBLE                                  09660000
096700***   OR TM500-TPURCHS-SELECT-NOT-FND OR                          09670000
096800***      TM500-TTRBNTF-UPDATE-NOT-FND OR                          09680000
096900***      TM500-DIDNT-ALLOC-DUE-TO-TRBL                            09690000
097000             CONTINUE                                             09700000
097100     ELSE                                                         09710000
097200         SET PS-ERROR                                             09720000
097300             SU035-INVALID-SQL    TO TRUE                         09730000
097400         MOVE SU035-PO            TO PV-DISP-PO                   09740000
097500         MOVE SU035-REC-SEQ-NBR   TO PV-DISP-RCVR-SEQ-NBR         09750000
097600         MOVE SU035-PO-LNE-NBR    TO PV-DISP-PO-LNE-NBR           09760000
097700         STRING   ' SUKUT702-1600-'                               09770000
097800                  ' CALLED BY-'                                   09780000
097900                  SU035-PROGRAM-NAME                              09790000
098000                  ' RET CODE='                                    09800000
098100                  TM500-RETURN-CODE                               09810000
098200                  ' PO='                                          09820000
098300                  PV-DISP-PO                                      09830000
098400                  ' RCV='                                         09840000
098500                  PV-DISP-RCVR-SEQ-NBR                            09850000
098600                  ' LNE='                                         09860000
098700                  PV-DISP-PO-LNE-NBR                              09870000
098800                  DELIMITED BY SIZE                               09880000
098900                                  INTO PV-CICS-MSG-AREA           09890000
099000         PERFORM 9999-WRITE-TO-CSSL                               09900000
099100         MOVE '1600-'                TO SU035-CRA-REQ-ID          09910000
099200         MOVE PV-CICS-MSG-AREA      TO SU035-CRA-RET-MSG          09920000
099300         MOVE TM500-TRBL-RSN-CDE    TO PV-DISPLAY-SQLCODE         09930000
099400         STRING   ' SUKUT702-1600-'                               09940000
099500                  ' CALLED BY-'                                   09950000
099600                  SU035-PROGRAM-NAME                              09960000
099700                  ' SQL CODE='                                    09970000
099800                  TM500-SQLCODE                                   09980000
099900                  ' TRB RSN CDE='                                 09990000
100000                  PV-DISPLAY-SQLCODE                              10000000
100100                  DELIMITED BY SIZE                               10010000
100200                                  INTO PV-CICS-MSG-AREA           10020000
100300         PERFORM 9999-WRITE-TO-CSSL                               10030000
100400         PERFORM 9998-RETURN                                      10040000
100500     END-IF.                                                      10050000
100600                                                                  10060000
100700                                                                  10070000
100800 1700-UPDATE-STORE-QUANTITIES.                                    10080000
100900     IF RECITM-STATUS-CDE = 'VE'                                  10090000
101000         IF PS-RECDIS-NOT-FOUND                                   10100000
101100             IF PS-NO-DISTDT-FOUND AND                            10110000
101200                RECEIV-PACK-BY-ST-IND NOT EQUAL 'Y'               10120000
101300                 PERFORM 5900-INSERT-TRANS-DTL-REC                10130000
101400             END-IF                                               10140000
101500             PERFORM 6300-INSERT-TRECDIS                          10150000
101600         ELSE                                                     10160000
101700             IF PS-NO-DISTDT-FOUND AND                            10170004
101800                RECEIV-PACK-BY-ST-IND NOT EQUAL 'Y'               10180004
101900                 PERFORM 5900-INSERT-TRANS-DTL-REC                10190004
102000             END-IF                                               10200004
102100             SET PS-BEFORE-ONLY-LOGGING  TO TRUE                  10210000
102200             INITIALIZE RC031-FIELDS                              10220000
102300             MOVE SU035-PO-LNE-NBR    TO RC031-PO-LNE-NBR         10230000
102400             PERFORM 6600-ADD-TO-RECD-AUDIT-BEFORE                10240000
102500         END-IF                                                   10250000
102600         COMPUTE RECDIS-VERIFY-ITM-QTY =                          10260000
102700             RECDIS-VERIFY-ITM-QTY + SU035-ADJUST-QTY             10270000
102800         COMPUTE RECDIS-AP-VERIFY-ITM-QTY =                       10280000
102900             RECDIS-AP-VERIFY-ITM-QTY + SU035-ADJUST-QTY          10290000
103000         PERFORM 6200-UPDATE-TRECDIS                              10300000
103100         IF SU035-ODD-UNIT-YES                                    10310000
103200             PERFORM 7200-UPDATE-ODD-REC                          10320000
103300         END-IF                                                   10330000
103400         IF SU035-UPDATE-UNTS-WORKED-IND = 'Y'                    10340000
103500             INITIALIZE PC238-COMM-AREA                           10350000
103600             SET  PC238-TRANS-VERIFY-ADJ  TO TRUE                 10360000
103700             SET  PC238-MANUAL-VERIFY     TO TRUE                 10370000
103800             PERFORM 8000-UNITS-WORK-ROUTINE                      10380000
103900         END-IF                                                   10390000
104000         SET PS-UPDATE-TRECDIS TO TRUE                            10400000
104100     ELSE                                                         10410000
104200         IF RECEIV-PACK-BY-ST-IND EQUAL 'Y'                       10420000
104300             IF PS-RECDIS-NOT-FOUND                               10430000
104400                 PERFORM 6300-INSERT-TRECDIS                      10440000
104500             ELSE                                                 10450000
104600                 SET PS-BEFORE-ONLY-LOGGING  TO TRUE              10460000
104700                 INITIALIZE RC031-FIELDS                          10470000
104800                 MOVE SU035-PO-LNE-NBR    TO RC031-PO-LNE-NBR     10480000
104900                 PERFORM 6600-ADD-TO-RECD-AUDIT-BEFORE            10490000
105000             END-IF                                               10500000
105100             COMPUTE RECDIS-VERIFY-ITM-QTY =                      10510000
105200                 RECDIS-VERIFY-ITM-QTY + SU035-ADJUST-QTY         10520000
105300             PERFORM 6200-UPDATE-TRECDIS                          10530000
105400             IF SU035-ODD-UNIT-YES                                10540000
105500                 PERFORM 7200-UPDATE-ODD-REC                      10550000
105600             END-IF                                               10560000
105700             SET PS-UPDATE-TRECDIS TO TRUE                        10570000
105800         ELSE                                                     10580000
105900             IF PS-DISTHD-FOUND                                   10590000
106000                 PERFORM 1800-PROCESS-TDISTHD                     10600000
106100             ELSE                                                 10610000
106200                 IF PS-RECDIS-NOT-FOUND                           10620000
106300                     PERFORM 6300-INSERT-TRECDIS                  10630000
106400                 ELSE                                             10640000
106500                     SET PS-BEFORE-ONLY-LOGGING  TO TRUE          10650000
106600                     INITIALIZE RC031-FIELDS                      10660000
106700                     MOVE SU035-PO-LNE-NBR    TO RC031-PO-LNE-NBR 10670000
106800                     PERFORM 6600-ADD-TO-RECD-AUDIT-BEFORE        10680000
106900                 END-IF                                           10690000
107000                 COMPUTE RECDIS-VERIFY-ITM-QTY =                  10700000
107100                     RECDIS-VERIFY-ITM-QTY + SU035-ADJUST-QTY     10710000
107200                 PERFORM 6200-UPDATE-TRECDIS                      10720000
107300                 IF SU035-ODD-UNIT-YES                            10730000
107400                     PERFORM 7200-UPDATE-ODD-REC                  10740000
107500                 END-IF                                           10750000
107600                 SET PS-UPDATE-TRECDIS TO TRUE                    10760000
107700             END-IF                                               10770000
107800         END-IF                                                   10780000
107900     END-IF.                                                      10790000
108000                                                                  10800000
108100 1800-PROCESS-TDISTHD.                                            10810000
108200     IF DISTHD-TOT-CART-CNT = 0                                   10820000
108300******      CASEPACK HAS BEEN DELETED     ************            10830000
108400         MOVE 1   TO SUT00030-PROB-RSN-CDE                        10840000
108500         IF PS-RECDIS-NOT-FOUND                                   10850000
108600             IF PS-NO-DISTDT-FOUND                                10860000
108700                 PERFORM 5900-INSERT-TRANS-DTL-REC                10870000
108800             END-IF                                               10880000
108900             PERFORM 6300-INSERT-TRECDIS                          10890000
109000         ELSE                                                     10900000
109100             IF PS-NO-DISTDT-FOUND                                10910004
109200                 PERFORM 5900-INSERT-TRANS-DTL-REC                10920004
109300             END-IF                                               10930004
109400             SET PS-BEFORE-ONLY-LOGGING  TO TRUE                  10940000
109500             INITIALIZE RC031-FIELDS                              10950000
109600             MOVE SU035-PO-LNE-NBR    TO RC031-PO-LNE-NBR         10960000
109700             PERFORM 6600-ADD-TO-RECD-AUDIT-BEFORE                10970000
109800         END-IF                                                   10980000
109900         COMPUTE RECDIS-VERIFY-ITM-QTY =                          10990000
110000             RECDIS-VERIFY-ITM-QTY + SU035-ADJUST-QTY             11000000
110100         PERFORM 6200-UPDATE-TRECDIS                              11010000
110200         IF SU035-ODD-UNIT-YES                                    11020000
110300             PERFORM 7200-UPDATE-ODD-REC                          11030000
110400         END-IF                                                   11040000
110500         SET PS-UPDATE-TRECDIS TO TRUE                            11050000
110600     ELSE                                                         11060000
110700         IF DISTHD-TOT-CART-CNT > 0                               11070000
110800             IF DISTHD-VRFD-TMST = PC-DEFAULT-TMST AND            11080000
110900*******           NOT VERIFIED        **********                  11090000
111000                SU035-UPDATE-DISTDT                               11100000
111100                 PERFORM 5800-GET-TDISTDT                         11110000
111200                 IF PS-NO-DISTDT-FOUND                            11120000
111300                     PERFORM 5900-INSERT-TRANS-DTL-REC            11130000
111400                     PERFORM 6300-INSERT-TRECDIS                  11140000
111500                 END-IF                                           11150000
111600                 IF SUT00024-CART-SRC-CDE = 'P2L'                 11160000
111700                     COMPUTE DISTDT-ACTL-ALLOC-QTY =              11170000
111800                         DISTDT-ACTL-ALLOC-QTY +                  11180000
111900                                         SU035-ADJUST-QTY         11190000
112000                     IF DISTDT-ACTL-ALLOC-QTY < 0                 11200000
112100                         SET PS-ERROR                             11210000
112200                             SU035-NO-CHANGE      TO TRUE         11220000
112300                         MOVE DK-PO          TO PV-DISP-PO        11230000
112400                         MOVE DK-REC-SEQ-NBR                      11240000
112500                                 TO PV-DISP-RCVR-SEQ-NBR          11250000
112600                         MOVE DK-PO-LNE-NBR                       11260000
112700                                 TO PV-DISP-PO-LNE-NBR            11270000
112800                         MOVE DK-STR-NBR     TO PV-DISP-STR-NBR   11280000
112900                         MOVE  SQLCODE       TO PV-DISPLAY-SQLCODE11290000
113000                         STRING   ' SUKUT702-1800-'               11300000
113100                                  ' CALLED BY-'                   11310000
113200                                  SU035-PROGRAM-NAME              11320000
113300                                  '  SQLCODE='                    11330000
113400                                  PV-DISPLAY-SQLCODE              11340000
113500                                  ' PO='                          11350000
113600                                  PV-DISP-PO                      11360000
113700                                  ' RCV='                         11370000
113800                                  PV-DISP-RCVR-SEQ-NBR            11380000
113900                                  ' LNE='                         11390000
114000                                  PV-DISP-PO-LNE-NBR              11400000
114100                                  ' STR='                         11410000
114200                                  PV-DISP-STR-NBR                 11420000
114300                                  DELIMITED BY SIZE               11430000
114400                                      INTO PV-CICS-MSG-AREA       11440000
114500                         PERFORM 9999-WRITE-TO-CSSL               11450000
114600                         MOVE SPACES    TO PV-CICS-MSG-AREA       11460000
114700                         MOVE DK-SHIPT-UNT-ID                     11470000
114800                                      TO PV-DISP-SHIPT-UNT-ID     11480000
114900                         STRING   ' SUKUT702-1800-'               11490000
115000                                  ' CALLED BY-'                   11500000
115100                                  SU035-PROGRAM-NAME              11510000
115200                                  '  DISTDT-ACTL-ALLOC-QTY < 0 '  11520000
115300                                  PV-DISP-SHIPT-UNT-ID            11530000
115400                                  DELIMITED BY SIZE               11540000
115500                                      INTO PV-CICS-MSG-AREA       11550000
115600                         PERFORM 9999-WRITE-TO-CSSL               11560000
115700                         MOVE PV-CICS-MSG-AREA  TO                11570000
115800                                       SU035-CRA-RET-MSG          11580000
115900                         MOVE '1800-'       TO SU035-CRA-REQ-ID   11590000
116000                         PERFORM 9998-RETURN                      11600000
116100                     ELSE                                         11610000
116200                         PERFORM 6400-UPDATE-TDISTDT              11620000
116300                         SET PS-UPDATE-TDISTDT TO TRUE            11630000
116400                     END-IF                                       11640000
116500                 ELSE                                             11650000
116600                     COMPUTE DISTDT-FCSE-ACTL-UNT-QTY =           11660000
116700                             DISTDT-FCSE-ACTL-UNT-QTY +           11670000
116800                             SU035-ADJUST-QTY                     11680000
116900                     IF SU035-ODD-UNIT-YES                        11690000
117000                         COMPUTE DISTDT-FCSE-ACTL-UNT-QTY =       11700000
117100                               ((DISTDT-FCSE-ACTL-UNT-QTY +       11710000
117200                                 SU035-BEFORE-ODD-UNT-QTY) -      11720000
117300                                 SU035-AFTER-ODD-UNT-QTY)         11730000
117400                         COMPUTE DISTDT-PREPK-ODD-UNT-QTY =       11740000
117500                                (DISTDT-PREPK-ODD-UNT-QTY +       11750000
117600                                (SU035-AFTER-ODD-UNT-QTY  -       11760000
117700                                 SU035-BEFORE-ODD-UNT-QTY))       11770000
117800*                         MOVE SU035-AFTER-ODD-UNT-QTY TO         11780000
117900*                                 DISTDT-PREPK-ODD-UNT-QTY        11790000
118000                     END-IF                                       11800000
118100                     IF DISTDT-FCSE-ACTL-UNT-QTY < 0 OR           11810000
118200                        DISTDT-PREPK-ODD-UNT-QTY < 0              11820000
118300                         SET PS-ERROR                             11830000
118400                             SU035-NO-CHANGE      TO TRUE         11840000
118500                         MOVE DK-PO          TO PV-DISP-PO        11850000
118600                         MOVE DK-REC-SEQ-NBR                      11860000
118700                                 TO PV-DISP-RCVR-SEQ-NBR          11870000
118800                         MOVE DK-PO-LNE-NBR                       11880000
118900                                 TO PV-DISP-PO-LNE-NBR            11890000
119000                         MOVE DK-STR-NBR     TO PV-DISP-STR-NBR   11900000
119100                         MOVE DK-SHIPT-UNT-ID                     11910000
119200                                      TO PV-DISP-SHIPT-UNT-ID     11920000
119300                         MOVE  SQLCODE       TO PV-DISPLAY-SQLCODE11930000
119400                         STRING   ' SUKUT702-1800-'               11940000
119500                                  ' CALLED BY-'                   11950000
119600                                  SU035-PROGRAM-NAME              11960000
119700                                  '  SQLCODE='                    11970000
119800                                  PV-DISPLAY-SQLCODE              11980000
119900                                  ' '                             11990000
120000                                  PV-DISP-SHIPT-UNT-ID            12000000
120100                                  ' PO='                          12010000
120200                                  PV-DISP-PO                      12020000
120300                                  ' RCV='                         12030000
120400                                  PV-DISP-RCVR-SEQ-NBR            12040000
120500                                  ' LNE='                         12050000
120600                                  PV-DISP-PO-LNE-NBR              12060000
120700                                  ' STR='                         12070000
120800                                  PV-DISP-STR-NBR                 12080000
120900                                  DELIMITED BY SIZE               12090000
121000                                      INTO PV-CICS-MSG-AREA       12100000
121100                         PERFORM 9999-WRITE-TO-CSSL               12110000
121200                         MOVE SPACES    TO PV-CICS-MSG-AREA       12120000
121300                         STRING   ' SUKUT702-1800-'               12130000
121400                                  ' CALLED BY-'                   12140000
121500                                  SU035-PROGRAM-NAME              12150000
121600                                  ' DISTDT-FCSE-ACTL-UNT-QTY < 0 '12160000
121700                                  '  OR  '                        12170000
121800                                  ' DISTDT-PREPK-ODD-UNT-QTY < 0 '12180000
121900                                  DELIMITED BY SIZE               12190000
122000                                      INTO PV-CICS-MSG-AREA       12200000
122100                         PERFORM 9999-WRITE-TO-CSSL               12210000
122200                         MOVE PV-CICS-MSG-AREA  TO                12220000
122300                                       SU035-CRA-RET-MSG          12230000
122400                         MOVE '1800-'       TO SU035-CRA-REQ-ID   12240000
122500                         PERFORM 9998-RETURN                      12250000
122600                     ELSE                                         12260000
122700                         PERFORM 6500-UPDATE-TDISTDT              12270000
122800                         SET PS-UPDATE-TDISTDT TO TRUE            12280000
122900                     END-IF                                       12290000
123000                 END-IF                                           12300000
123100             ELSE                                                 12310000
123200                 IF PS-RECDIS-NOT-FOUND                           12320000
123300                     IF PS-NO-DISTDT-FOUND                        12330000
123400                         PERFORM 5900-INSERT-TRANS-DTL-REC        12340000
123500                     END-IF                                       12350000
123600                     PERFORM 6300-INSERT-TRECDIS                  12360000
123700                 ELSE                                             12370000
123800                     IF PS-NO-DISTDT-FOUND                        12380004
123900                         PERFORM 5900-INSERT-TRANS-DTL-REC        12390004
124000                     END-IF                                       12400004
124100                     SET PS-BEFORE-ONLY-LOGGING TO TRUE           12410000
124200                     INITIALIZE RC031-FIELDS                      12420000
124300                     MOVE SU035-PO-LNE-NBR    TO RC031-PO-LNE-NBR 12430000
124400                     PERFORM 6600-ADD-TO-RECD-AUDIT-BEFORE        12440000
124500                 END-IF                                           12450000
124600                 COMPUTE RECDIS-VERIFY-ITM-QTY =                  12460000
124700                     RECDIS-VERIFY-ITM-QTY + SU035-ADJUST-QTY     12470000
124800                 PERFORM 6200-UPDATE-TRECDIS                      12480000
124900                 IF SU035-ODD-UNIT-YES                            12490000
125000                     PERFORM 7200-UPDATE-ODD-REC                  12500000
125100                 END-IF                                           12510000
125200                 SET PS-UPDATE-TRECDIS TO TRUE                    12520000
125300             END-IF                                               12530000
125400**?      ELSE                                                     12540000
125500**?          MOVE 'TOTAL CARTON COUNT < 0'                        12550000
125600**?                   TO SU035-CRA-RET-MSG                        12560000
125700**?          MOVE ?? TO SUT00030-ADJ-ERR-CDE                      12570000
125800**?          SET PS-NO-AUTO-APPLY TO TRUE                         12580000
125900**?          IF PS-NO-SUT-OTBND-WRTN AND                          12590000
126000**?             SU035-BEFORE-QTY NOT EQUAL SU035-AFTER-QTY        12600000
126100**?              PERFORM 6100-MOVE-TO-FINCL-ADJ                   12610000
126200**?              PERFORM 6150-INSERT-FINCL-ADJ                    12620000
126300**?          END-IF                                               12630000
126400**?          SET SU035-ERROR      TO TRUE                         12640000
126500**?          SET SU035-NO-CHANGE  TO TRUE                         12650000
126600         END-IF                                                   12660000
126700     END-IF.                                                      12670000
126800                                                                  12680000
126900******************************************************************12690000
127000*   DETERMINE IF VERIFICATION OCCURRED IN THE SAME FISCAL MONTH   12700000
127100*   AS THE CURRENT FISCAL MONTH                                   12710000
127200******************************************************************12720000
127300                                                                  12730000
127400 2100-DETERMINE-FISCAL-PERIOD.                                    12740000
127500     PERFORM 2200-GET-FISCAL-PERIODS.                             12750000
127600     IF PV-TODAYS-FISCAL-PERIOD NOT =                             12760000
127700                                 PV-VERIFY-FISCAL-PERIOD          12770000
127800         MOVE 'INVALID FISCAL PERIOD'  TO SU035-CRA-RET-MSG       12780000
127900         SET PS-NO-AUTO-APPLY TO TRUE                             12790000
128000         SET PS-ERROR              TO  TRUE                       12800000
128100         MOVE 1  TO SUT00030-ADJ-ERR-CDE                          12810000
128200         MOVE 371          TO  PV-TRBL-RSN-CDE                    12820000
128300         IF PS-NO-SUT-OTBND-WRTN                                  12830000
128400             PERFORM 6100-MOVE-TO-FINCL-ADJ                       12840000
128500             PERFORM 6150-INSERT-FINCL-ADJ                        12850000
128600         END-IF                                                   12860000
128700         SET SU035-NO-CHANGE  TO TRUE                             12870000
128800     END-IF.                                                      12880000
128900                                                                  12890000
129000/                                                                 12900000
129100 2200-GET-FISCAL-PERIODS.                                         12910000
129200******************************************************************12920000
129300*    THIS PARAGRAPH RETREIVES THE FISCAL PERIODS OF THE CURRENT   12930000
129400*    DATE AND THE RECEIVER VERIFIED DATE.                         12940000
129500******************************************************************12950000
129600                                                                  12960000
129700     EXEC SQL                                                     12970000
129800          SET :PV-CURRENT-TIMESTAMP = CURRENT TIMESTAMP           12980000
129900     END-EXEC.                                                    12990000
130000                                                                  13000000
130100     MOVE PV-CURRENT-TIMESTAMP       TO PV-WORK-TMST.             13010000
130200     MOVE PV-WK-CCYY                 TO PV-LK-DTE-CCYY.           13020000
130300     MOVE PV-WK-MO                   TO PV-LK-DTE-MO              13030000
130400     MOVE PV-WK-DA                   TO PV-LK-DTE-DD              13040000
130500                                                                  13050000
130600     INITIALIZE  DPG51 DPG52                                      13060000
130700                 DPG53 DPG54                                      13070000
130800                 DPG55 DPG56.                                     13080000
130900                                                                  13090000
131000     MOVE PV-LK-DTE-ISO              TO DPG52-LK-DATE-INPUT.      13100000
131100                                                                  13110000
131200     SET DPG51-DO-NOT-INCR-DECR-DATE TO TRUE.                     13120000
131300     SET DPG51-FISCAL-454-CALENDAR   TO TRUE.                     13130000
131400     SET DPG52-LK-DTE-ISO            TO TRUE.                     13140000
131500                                                                  13150000
131600     MOVE '2200-GET-FISCAL-PERIODS'                               13160000
131700       TO PV-FROM-PARAGRAPH.                                      13170000
131800     PERFORM 3000-CALL-CALENDAR-ROUTINE.                          13180000
131900                                                                  13190000
132000     MOVE DPG56-FISCAL-PERIOD-NBR    TO PV-TODAYS-FISCAL-PERIOD.  13200000
132100                                                                  13210000
132200     MOVE RECEIV-VERFYD-TMST         TO PV-WORK-TMST.             13220000
132300     MOVE PV-WK-CCYY                 TO PV-LK-DTE-CCYY.           13230000
132400     MOVE PV-WK-MO                   TO PV-LK-DTE-MO              13240000
132500     MOVE PV-WK-DA                   TO PV-LK-DTE-DD              13250000
132600                                                                  13260000
132700     INITIALIZE  DPG51 DPG52                                      13270000
132800                 DPG53 DPG54                                      13280000
132900                 DPG55 DPG56.                                     13290000
133000                                                                  13300000
133100     MOVE PV-LK-DTE-ISO              TO DPG52-LK-DATE-INPUT.      13310000
133200                                                                  13320000
133300     SET DPG51-DO-NOT-INCR-DECR-DATE TO TRUE.                     13330000
133400     SET DPG51-FISCAL-454-CALENDAR   TO TRUE.                     13340000
133500     SET DPG52-LK-DTE-ISO            TO TRUE.                     13350000
133600                                                                  13360000
133700     MOVE '2200-GET-FISCAL-PERIODS'                               13370000
133800       TO PV-FROM-PARAGRAPH.                                      13380000
133900     PERFORM 3000-CALL-CALENDAR-ROUTINE.                          13390000
134000                                                                  13400000
134100     MOVE DPG56-FISCAL-PERIOD-NBR    TO PV-VERIFY-FISCAL-PERIOD.  13410000
134200                                                                  13420000
134300                                                                  13430000
134400 2300-CHECK-INVENTORY-DATE.                                       13440000
134500                                                                  13450000
134600     SET PS-UPDATE-YES          TO TRUE.                          13460000
134700     INITIALIZE XL071-COMMAREA-REC.                               13470000
134800     MOVE RECEIV-OPER-UNT-ID    TO XL071-LOCATION-NUMBER.         13480000
134900     PERFORM 8500-SELECT-STORE.                                   13490000
134910     PERFORM 5400A-CHK4-DC-FLUSH-PARM.                            13491012
134920     IF PS-DC-FLUSH-YES                                           13492007
135000         PERFORM 5400-READ-INV-PARM                               13500007
135100         IF DK-NULL = 0                                           13510007
135200             PERFORM 2400-FMT-CUTOFF-DTS-FOR-CMPARE               13520007
135300             PERFORM 2500-CHCK-INV-DATE-FOR-UPDATE                13530007
135400         ELSE                                                     13540007
135500             CONTINUE                                             13550007
135600         END-IF                                                   13560007
135610     END-IF.                                                      13561007
135700                                                                  13570000
135800                                                                  13580000
135900 2400-FMT-CUTOFF-DTS-FOR-CMPARE.                                  13590000
136000     PERFORM DP017-0000-GET-CURR-DATE-TIME.                       13600000
136100     MOVE DP017-CURRENT-DATE-YMD      TO DPG51-SYSTEM-DATE.       13610000
136200     SET  DPG51-ACTUAL-CALENDAR-ONLY  TO TRUE.                    13620000
136300     SET  DPG51-DO-NOT-INCR-DECR-DATE TO TRUE.                    13630000
136400     MOVE ZERO                      TO DPG51-INCR-DECR-DAYS-9     13640000
136500                                       DPG51-INCR-DECR-BUS-DAYS-9.13650000
136600     SET  DPG52-LK-DTE-ISO-FMT        TO TRUE.                    13660000
136700                                                                  13670000
136800                                                                  13680000
136900*    *------------------------------------------------------------13690000
137000*    * FORMAT THE VERIFY DATE FORM TRECEIV.                       13700000
137100*    *------------------------------------------------------------13710000
137200     MOVE RECEIV-VERFYD-TMST  TO      PV-WORK-TMST.               13720000
137300     MOVE PV-WORK-TMST-1      TO      DPG52-LK-DATE-INPUT.        13730000
137400                                                                  13740000
137500     PERFORM 3000-CALL-CALENDAR-ROUTINE.                          13750000
137600     MOVE DPG55-DB2-ISO-DATE TO PV-VERIFY-DTE-YYYYMMDD.           13760000
137700                                                                  13770000
137800*    *------------------------------------------------------------13780000
137900*    * FORMAT THE CUTOFF DATE DATE FROM TINVPAR                   13790000
138000*    *------------------------------------------------------------13800000
138100     MOVE XLT00025-DC-CTOFF-DTE TO DPG52-LK-DATE-INPUT.           13810000
138200                                                                  13820000
138300     IF  XLT00025-DC-CTOFF-DTE EQUAL '9999-09-09'                 13830000
138400         MOVE XLT00025-DC-CTOFF-DTE                               13840000
138500           TO PV-ACTL-CTOFF-YYYYMMDD                              13850000
138600     ELSE                                                         13860000
138700         PERFORM 3000-CALL-CALENDAR-ROUTINE                       13870000
138800         MOVE DPG55-DB2-ISO-DATE TO PV-ACTL-CTOFF-YYYYMMDD        13880000
138900     END-IF.                                                      13890000
139000                                                                  13900000
139100*    *------------------------------------------------------------13910000
139200*    * FORMAT THE CURRENT SYSTEM DATE.                            13920000
139300*    *------------------------------------------------------------13930000
139400     MOVE DP017-EDITED-DATE-YYYYMMDD TO DPG52-LK-DATE-INPUT.      13940000
139500                                                                  13950000
139600     PERFORM 3000-CALL-CALENDAR-ROUTINE.                          13960000
139700     MOVE DPG55-DB2-ISO-DATE TO PV-CURRENT-DTE-YYYYMMDD.          13970000
139800                                                                  13980000
139900*    *------------------------------------------------------------13990000
140000*    * FORMAT THE RECEIPT DATE FOR TRECEIV.                       14000000
140100*    *------------------------------------------------------------14010000
140200     MOVE RECEIV-REC-TMST     TO      PV-WORK-TMST.               14020000
140300     MOVE PV-WORK-TMST-1      TO      DPG52-LK-DATE-INPUT.        14030000
140400     PERFORM 3000-CALL-CALENDAR-ROUTINE.                          14040000
140500     MOVE DPG55-DB2-ISO-DATE TO PV-RECEIPT-DTE-YYYYMMDD.          14050000
140600                                                                  14060000
140700                                                                  14070000
140800 2500-CHCK-INV-DATE-FOR-UPDATE.                                   14080000
140900                                                                  14090000
141000     IF PS-DC-STORE-TYPE                                          14100000
141100         IF ((PV-VERIFY-DTE-YYYYMMDD < PV-ACTL-CTOFF-YYYYMMDD     14110000
141200         OR  PV-VERIFY-DTE-YYYYMMDD = PV-ACTL-CTOFF-YYYYMMDD)     14120000
141300         AND PV-CURRENT-DTE-YYYYMMDD > PV-ACTL-CTOFF-YYYYMMDD)    14130000
141400             SET PS-UPDATE-NO TO TRUE                             14140000
141500             SET PS-NO-AUTO-APPLY TO TRUE                         14150000
141600             MOVE 'DC CUTOFF PHY INV' TO SU035-CRA-RET-MSG        14160000
141700             SET SU035-ERROR      TO TRUE                         14170000
141800             PERFORM 6700-ADD-TRIGGER-AUDIT-BEFORE                14180000
141900             MOVE 11 TO SUT00030-ADJ-ERR-CDE                      14190000
142000             MOVE 371          TO  PV-TRBL-RSN-CDE                14200000
142100             IF PS-NO-SUT-OTBND-WRTN                              14210000
142200                 PERFORM 6100-MOVE-TO-FINCL-ADJ                   14220000
142300                 PERFORM 6150-INSERT-FINCL-ADJ                    14230000
142400             END-IF                                               14240000
142500             SET SU035-NO-CHANGE  TO TRUE                         14250000
142600         END-IF                                                   14260000
142700     END-IF.                                                      14270000
142800     IF PS-NOT-DC-STORE-TYPE                                      14280000
142900         IF ((PV-RECEIPT-DTE-YYYYMMDD < PV-ACTL-CTOFF-YYYYMMDD    14290000
143000         OR  PV-RECEIPT-DTE-YYYYMMDD  =   PV-ACTL-CTOFF-YYYYMMDD) 14300000
143100         AND PV-CURRENT-DTE-YYYYMMDD > PV-ACTL-CTOFF-YYYYMMDD)    14310000
143200             SET PS-UPDATE-NO  TO TRUE                            14320000
143300             SET PS-NO-AUTO-APPLY TO TRUE                         14330000
143400             MOVE 'DC CUTOFF PHY INV' TO SU035-CRA-RET-MSG        14340000
143500             SET SU035-ERROR      TO TRUE                         14350000
143600             PERFORM 6700-ADD-TRIGGER-AUDIT-BEFORE                14360000
143700             MOVE 11 TO SUT00030-ADJ-ERR-CDE                      14370000
143800             MOVE 371          TO  PV-TRBL-RSN-CDE                14380000
143900             IF PS-NO-SUT-OTBND-WRTN                              14390000
144000                 PERFORM 6100-MOVE-TO-FINCL-ADJ                   14400000
144100                 PERFORM 6150-INSERT-FINCL-ADJ                    14410000
144200             END-IF                                               14420000
144300             SET SU035-NO-CHANGE  TO TRUE                         14430000
144400         END-IF                                                   14440000
144500     END-IF.                                                      14450000
144600                                                                  14460000
144700******************************************************************14470000
144800*    THIS PARAGRAPH CALCULATES IF THE RECEIVER CAN BE VERIFIED    14480000
144900*    BASED ON THE THE NUMBER OF DAYS FOUND IN THE                 14490000
145000*    DAYS-ALWD-ADJ-QTY OF COCNTL TABLE.  THIS NUMBER IS SUBTRACTED14500000
145100*    FROM THE CURRENT DATE.  IF THE VERIFY DATE IS GREATER THAN   14510000
145200*    THE COMPUTED DATE THAN THE RECEIVER CAN BE ADJUSTED.         14520000
145300******************************************************************14530000
145400 2600-CALC-DAYS-SINCE-VERFD.                                      14540000
145500     PERFORM 5500-SELECT-TCOCNTL.                                 14550000
145600     IF  PV-VFY-DATE-JULIAN = PV-COMP-DATE-JULIAN                 14560000
145700     OR  PV-VFY-DATE-JULIAN > PV-COMP-DATE-JULIAN                 14570000
145800         CONTINUE                                                 14580000
145900     ELSE                                                         14590000
146000         SET PS-ERROR              TO  TRUE                       14600000
146100         SET PS-NO-AUTO-APPLY TO TRUE                             14610000
146200         MOVE 'TOO MANY DAYS SINCE VERIFICATION'                  14620000
146300                                         TO SU035-CRA-RET-MSG     14630000
146400         SET SU035-ERROR      TO TRUE                             14640000
146500         MOVE 2  TO SUT00030-ADJ-ERR-CDE                          14650000
146600         MOVE 371          TO  PV-TRBL-RSN-CDE                    14660000
146700         IF PS-NO-SUT-OTBND-WRTN                                  14670000
146800             PERFORM 6100-MOVE-TO-FINCL-ADJ                       14680000
146900             PERFORM 6150-INSERT-FINCL-ADJ                        14690000
147000         END-IF                                                   14700000
147100         SET SU035-NO-CHANGE  TO TRUE                             14710000
147200     END-IF.                                                      14720000
147300                                                                  14730000
147400 3000-CALL-CALENDAR-ROUTINE.                                      14740000
147500     CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51                14750000
147600                                             DPG52                14760000
147700                                             DPG53                14770000
147800                                             DPG54                14780000
147900                                             DPG55                14790000
148000                                             DPG56.               14800000
148100     EVALUATE TRUE                                                14810000
148200         WHEN DPG54-SEVERE-ERROR                                  14820000
148300         WHEN DPG54-DATE-INVALID                                  14830000
148400             SET SU035-INVALID-SQL     TO TRUE                    14840000
148500             SET PS-NO-AUTO-APPLY TO TRUE                         14850000
148600             STRING   ' SUKUT702-3000-'                           14860000
148700                      ' CALLED BY-'                               14870000
148800                      SU035-PROGRAM-NAME                          14880000
148900                      ' DATE='                                    14890000
149000                      DPG52-LK-DATE-INPUT                         14900000
149100                      DELIMITED BY SIZE                           14910000
149200                                      INTO PV-CICS-MSG-AREA       14920000
149300             PERFORM 9999-WRITE-TO-CSSL                           14930000
149400             MOVE PV-CICS-MSG-AREA      TO SU035-CRA-RET-MSG      14940000
149500             SET SU035-UPDATE-ERROR TO TRUE                       14950000
149600     END-EVALUATE.                                                14960000
149700                                                                  14970000
149800*                                                                 14980000
149900 5000-CHECK-RECEIVER.                                             14990000
150000                                                                  15000000
150100     MOVE SU035-PO               TO  DK-PO.                       15010000
150200     MOVE SU035-REC-SEQ-NBR      TO  DK-REC-SEQ-NBR.              15020000
150300                                                                  15030000
150400     EXEC SQL                                                     15040000
150500         SELECT  STATUS_CDE                                       15050000
150600              ,  ML_POST_TMST                                     15060000
150700              ,  REC_TMST                                         15070000
150800              ,  VERFYD_TMST                                      15080000
150900              ,  OPER_UNT_ID                                      15090000
151000              ,  CURR_OPER_UNT_ID                                 15100000
151100              ,  PACK_BY_ST_IND                                   15110000
151200              ,  AP_PRC_CDE                                       15120000
151300           INTO :RECEIV-STATUS-CDE                                15130000
151400              , :RECEIV-ML-POST-TMST                              15140000
151500              , :RECEIV-REC-TMST                                  15150000
151600              , :RECEIV-VERFYD-TMST                               15160000
151700              , :RECEIV-OPER-UNT-ID                               15170000
151800              , :RECEIV-CURR-OPER-UNT-ID                          15180000
151900              , :RECEIV-PACK-BY-ST-IND                            15190000
152000              , :RECEIV-AP-PRC-CDE                                15200000
152100           FROM TRECEIV                                           15210000
152200          WHERE ORD_NBR        = :DK-PO                           15220000
152300            AND REC_SEQ_NBR    = :DK-REC-SEQ-NBR                  15230000
152400            AND VER_STATUS_CDE = 'A'                              15240000
152500     END-EXEC.                                                    15250000
152600                                                                  15260000
152700     EVALUATE TRUE                                                15270000
152800         WHEN SQLCODE = ZERO                                      15280000
152900             SET PS-RECEIVER-FOUND     TO TRUE                    15290000
153000         WHEN SQLCODE = +100                                      15300000
153100             SET PS-RECEIVER-NOT-FOUND TO TRUE                    15310000
153200         WHEN SQLWARN0 NOT = SPACES                               15320000
153300         WHEN SQLCODE  NOT = ZERO                                 15330000
153400             SET SU035-INVALID-SQL     TO TRUE                    15340000
153500             SET PS-NO-AUTO-APPLY TO TRUE                         15350000
153600             MOVE SU035-PO        TO  PV-DISP-PO                  15360000
153700             MOVE SU035-REC-SEQ-NBR   TO PV-DISP-RCVR-SEQ-NBR     15370000
153800             STRING   ' SUKUT702-5000-'                           15380000
153900                      ' CALLED BY-'                               15390000
154000                      SU035-PROGRAM-NAME                          15400000
154100                      ' PO='                                      15410000
154200                      PV-DISP-PO                                  15420000
154300                      ' RCVR='                                    15430000
154400                      PV-DISP-RCVR-SEQ-NBR                        15440000
154500                      DELIMITED BY SIZE                           15450000
154600                                      INTO PV-CICS-MSG-AREA       15460000
154700             PERFORM 9999-WRITE-TO-CSSL                           15470000
154800             MOVE PV-CICS-MSG-AREA      TO SU035-CRA-RET-MSG      15480000
154900             SET SU035-UPDATE-ERROR TO TRUE                       15490000
155000     END-EVALUATE.                                                15500000
155100                                                                  15510000
155200 5100-CHECK-TRECITM.                                              15520000
155300                                                                  15530000
155400     MOVE SU035-PO-LNE-NBR            TO DK-PO-LNE-NBR.           15540000
155500     MOVE 1                           TO DK-FCLTY-ID.             15550000
155600                                                                  15560000
155700     EXEC SQL                                                     15570000
155800          SELECT  STATUS_CDE                                      15580000
155900              ,   VER_STATUS_CDE                                  15590000
156000            INTO  :RECITM-STATUS-CDE                              15600000
156100              ,   :RECITM-VER-STATUS-CDE                          15610000
156200            FROM  TRECITM                                         15620000
156300           WHERE  ORD_NBR          =  :DK-PO                      15630000
156400             AND  ORD_LNE_NBR      =  :DK-PO-LNE-NBR              15640000
156500             AND  REC_SEQ_NBR      =  :DK-REC-SEQ-NBR             15650000
156600     END-EXEC.                                                    15660000
156700                                                                  15670000
156800     EVALUATE TRUE                                                15680000
156900         WHEN SQLCODE = ZERO                                      15690000
157000             SET PS-LINE-FOUND         TO TRUE                    15700000
157100         WHEN SQLCODE = +100                                      15710000
157200             SET PS-LINE-NOT-FOUND     TO TRUE                    15720000
157300                                                                  15730000
157400         WHEN SQLWARN0 NOT = SPACES                               15740000
157500         WHEN SQLCODE  NOT = ZERO                                 15750000
157600             SET SU035-INVALID-SQL     TO TRUE                    15760000
157700             SET PS-NO-AUTO-APPLY TO TRUE                         15770000
157800             MOVE SU035-PO        TO  PV-DISP-PO                  15780000
157900             MOVE SU035-REC-SEQ-NBR   TO PV-DISP-RCVR-SEQ-NBR     15790000
158000             MOVE SU035-PO-LNE-NBR    TO PV-DISP-PO-LNE-NBR       15800000
158100             STRING   ' SUKUT702-5100-'                           15810000
158200                      ' CALLED BY-'                               15820000
158300                      SU035-PROGRAM-NAME                          15830000
158400                      ' PO='                                      15840000
158500                      PV-DISP-PO                                  15850000
158600                      ' RCVR='                                    15860000
158700                      PV-DISP-RCVR-SEQ-NBR                        15870000
158800                      ' LINE='                                    15880000
158900                      PV-DISP-PO-LNE-NBR                          15890000
159000                      DELIMITED BY SIZE                           15900000
159100                                      INTO PV-CICS-MSG-AREA       15910000
159200             PERFORM 9999-WRITE-TO-CSSL                           15920000
159300             MOVE PV-CICS-MSG-AREA      TO SU035-CRA-RET-MSG      15930000
159400             SET SU035-UPDATE-ERROR TO TRUE                       15940000
159500     END-EVALUATE.                                                15950000
159600                                                                  15960000
159700 5200-SELECT-RECDIS.                                              15970000
159800                                                                  15980000
159900     MOVE SU035-DEST-LOC-NBR            TO DK-STR-NBR.            15990000
160000                                                                  16000000
160100     EXEC SQL                                                     16010000
160200         SELECT EXPTED_ITM_QTY                                    16020000
160300             ,  VERIFY_ITM_QTY                                    16030000
160400             ,  AP_VERIFY_ITM_QTY                                 16040000
160500             ,  AP_PRC_CDE                                        16050000
160600             ,  STR_NBR                                           16060000
160700             ,  VER_STATUS_CDE                                    16070000
160800          INTO  :RECDIS-EXPTED-ITM-QTY                            16080000
160900             ,  :RECDIS-VERIFY-ITM-QTY                            16090000
161000             ,  :RECDIS-AP-VERIFY-ITM-QTY                         16100000
161100             ,  :RECDIS-AP-PRC-CDE                                16110000
161200             ,  :RECDIS-STR-NBR                                   16120000
161300             ,  :RECDIS-VER-STATUS-CDE                            16130000
161400           FROM TRECDIS                                           16140000
161500          WHERE ORD_NBR        = :DK-PO                           16150000
161600            AND ORD_LNE_NBR    = :DK-PO-LNE-NBR                   16160000
161700            AND REC_SEQ_NBR    = :DK-REC-SEQ-NBR                  16170000
161800            AND STR_NBR        = :DK-STR-NBR                      16180000
161900     END-EXEC.                                                    16190000
162000                                                                  16200000
162100     EVALUATE TRUE                                                16210000
162200         WHEN SQLCODE = ZERO                                      16220000
162300              SET PS-RECDIS-FOUND                                 16230000
162400                             TO TRUE                              16240000
162500         WHEN SQLCODE = +100                                      16250000
162600              SET PS-RECDIS-NOT-FOUND                             16260000
162700                             TO TRUE                              16270000
162800                                                                  16280000
162900         WHEN SQLWARN0 NOT = SPACES                               16290000
163000         WHEN SQLCODE  NOT = ZERO                                 16300000
163100             SET SU035-INVALID-SQL     TO TRUE                    16310000
163200             SET PS-NO-AUTO-APPLY TO TRUE                         16320000
163300             MOVE SU035-PO        TO  PV-DISP-PO                  16330000
163400             MOVE SU035-REC-SEQ-NBR   TO PV-DISP-RCVR-SEQ-NBR     16340000
163500             MOVE SU035-PO-LNE-NBR    TO PV-DISP-PO-LNE-NBR       16350000
163600             MOVE SU035-DEST-LOC-NBR  TO PV-DISP-STR-NBR          16360000
163700             STRING   ' SUKUT702-5200-'                           16370000
163800                      ' CALLED BY-'                               16380000
163900                      SU035-PROGRAM-NAME                          16390000
164000                      ' PO='                                      16400000
164100                      PV-DISP-PO                                  16410000
164200                      ' RCVR='                                    16420000
164300                      PV-DISP-RCVR-SEQ-NBR                        16430000
164400                      ' LINE='                                    16440000
164500                      PV-DISP-PO-LNE-NBR                          16450000
164600                      ' STR='                                     16460000
164700                      PV-DISP-STR-NBR                             16470000
164800                      DELIMITED BY SIZE                           16480000
164900                                      INTO PV-CICS-MSG-AREA       16490000
165000             PERFORM 9999-WRITE-TO-CSSL                           16500000
165100             MOVE PV-CICS-MSG-AREA      TO SU035-CRA-RET-MSG      16510000
165200             SET SU035-UPDATE-ERROR TO TRUE                       16520000
165300     END-EVALUATE.                                                16530000
165400                                                                  16540000
165410*-----------------------------------------------------------------16541007
165420*  CHECK TKRPRPM TO SEE IF THE DC'S NEED TO BE FLUSHED.           16542007
165421*-----------------------------------------------------------------16542107
165440 5400A-CHK4-DC-FLUSH-PARM.                                        16544007
165450                                                                  16545007
165460     EXEC SQL                                                     16546007
165470          SELECT  FUNC_TXT                                        16547007
165480          INTO   :KRPRPM-FUNC-TXT                                 16548007
165490          FROM  TKRPRPM                                           16549007
165491          WHERE LOC_ID            =  90                           16549107
165492            AND SYS_PRC_FUNC_CDE  =  'FLUSH'                      16549207
165493            AND FUNC_PRC_STAT_CDE =  'AC'                         16549307
165494     END-EXEC.                                                    16549407
165495                                                                  16549507
165496     EVALUATE TRUE                                                16549607
165497         WHEN SQLCODE = +0                                        16549707
165498            IF KRPRPM-FUNC-TXT = 'N'                              16549807
165499                SET PS-DC-FLUSH-NO  TO TRUE                       16549907
165500            ELSE                                                  16550007
165501                SET PS-DC-FLUSH-YES TO TRUE                       16550107
165502            END-IF                                                16550207
165503         WHEN OTHER                                               16550307
165504                SET PS-DC-FLUSH-NO  TO TRUE                       16550407
165505     END-EVALUATE.                                                16550507
165506                                                                  16550607
165510*----------------------------------------------------------------*16551000
165600*    GET THE STORE TYPE.                                         *16560000
165700*----------------------------------------------------------------*16570000
165800 5400-READ-INV-PARM.                                              16580000
165900                                                                  16590000
166000         EXEC SQL                                                 16600000
166100             SELECT                                               16610000
166200                    MAX (INV_DTE)                                 16620000
166300             INTO                                                 16630000
166400                    :XLT00025-INV-DTE :DK-NULL                    16640000
166500             FROM                                                 16650000
166600                    XLT_MDSE_INV_PARM                             16660010
166700             WHERE                                                16670000
166800                    LOC_NBR           =  :DK-STR-NBR              16680008
166810               AND  ACTV_IND          =  'Y'                      16681009
166820               AND  LOC_INV_STAT_CDE  =  'IN'                     16682008
166900         END-EXEC.                                                16690000
167000                                                                  16700000
167100         EVALUATE TRUE                                            16710000
167200             WHEN SQLCODE = ZERO                                  16720000
167300                  IF DK-NULL = 0                                  16730000
167400                      MOVE XLT00025-INV-DTE                       16740000
167500                         TO PV-DB2-INV-FORMAT                     16750000
167600                  END-IF                                          16760000
167700             WHEN SQLCODE = +100                                  16770000
167800                  SET PS-ERROR    TO  TRUE                        16780000
167900             WHEN SQLWARN0 NOT = SPACES                           16790000
168000             WHEN SQLCODE NOT EQUAL ZERO                          16800000
168100                 SET SU035-INVALID-SQL     TO TRUE                16810000
168200                 SET PS-NO-AUTO-APPLY TO TRUE                     16820000
168300                 MOVE DK-STR-NBR          TO PV-DISP-STR-NBR      16830000
168400                 STRING   ' SUKUT702-5400-'                       16840000
168500                          ' CALLED BY-'                           16850000
168600                          SU035-PROGRAM-NAME                      16860000
168700                          ' STR='                                 16870000
168800                          PV-DISP-STR-NBR                         16880000
168900                          DELIMITED BY SIZE                       16890000
169000                                          INTO PV-CICS-MSG-AREA   16900000
169100                 PERFORM 9999-WRITE-TO-CSSL                       16910000
169200                 MOVE PV-CICS-MSG-AREA      TO SU035-CRA-RET-MSG  16920000
169300                 SET SU035-UPDATE-ERROR TO TRUE                   16930000
169400         END-EVALUATE.                                            16940000
169500                                                                  16950000
169600     IF  SQLCODE EQUAL ZERO AND                                   16960000
169700         DK-NULL = 0                                              16970000
169800                                                                  16980000
169900         EXEC SQL                                                 16990000
170000             SELECT                                               17000000
170100                    DC_CTOFF_DTE                                  17010000
170200             INTO                                                 17020000
170300                    :XLT00025-DC-CTOFF-DTE                        17030000
170400             FROM                                                 17040000
170500                    XLT_MDSE_INV_PARM                             17050010
170600             WHERE                                                17060000
170700                     LOC_NBR    =  :DK-STR-NBR                    17070000
170900             AND     INV_DTE    =  :PV-DB2-INV-FORMAT             17090008
170910             AND     ACTV_IND   =  'Y'                            17091009
170920             AND     LOC_INV_STAT_CDE = 'IN'                      17092008
171000         END-EXEC                                                 17100000
171100                                                                  17110000
171200         EVALUATE TRUE                                            17120000
171300             WHEN SQLCODE = ZERO                                  17130000
171400             WHEN SQLCODE = +100                                  17140000
171500                 CONTINUE                                         17150000
171600             WHEN SQLWARN0 NOT = SPACES                           17160000
171700             WHEN SQLCODE NOT EQUAL ZERO                          17170000
171800                 SET SU035-INVALID-SQL     TO TRUE                17180000
171900                 SET PS-NO-AUTO-APPLY TO TRUE                     17190000
172000                 MOVE DK-STR-NBR          TO PV-DISP-STR-NBR      17200000
172100                 STRING   ' SUKUT702-5400-'                       17210000
172200                          ' CALLED BY-'                           17220000
172300                          SU035-PROGRAM-NAME                      17230000
172400                          ' STR='                                 17240000
172500                          PV-DISP-STR-NBR                         17250000
172600                          DELIMITED BY SIZE                       17260000
172700                                          INTO PV-CICS-MSG-AREA   17270000
172800                 PERFORM 9999-WRITE-TO-CSSL                       17280000
172900                 MOVE PV-CICS-MSG-AREA      TO SU035-CRA-RET-MSG  17290000
173000                 SET SU035-UPDATE-ERROR TO TRUE                   17300000
173100         END-EVALUATE                                             17310000
173200     END-IF.                                                      17320000
173300*----------------------------------------------------------------*17330000
173400*    FIND THE DAYS ALLOWED AFTER VERIFICATION TO ADJUST THE      *17340000
173500*    QUANTITY.                                                   *17350000
173600*----------------------------------------------------------------*17360000
173700                                                                  17370000
173800 5500-SELECT-TCOCNTL.                                             17380000
173900                                                                  17390000
174000     INITIALIZE DCLTCOCNTL.                                       17400000
174100                                                                  17410000
174200     EXEC SQL                                                     17420000
174300         SELECT                                                   17430000
174400                 DAYS_ALWD_ADJ_QTY                                17440000
174500                ,CURRENT TIMESTAMP                                17450000
174600         INTO                                                     17460000
174700                :COCNTL-DAYS-ALWD-ADJ-QTY                         17470000
174800               ,:PV-CURRENT-TIMESTAMP                             17480000
174900         FROM                                                     17490000
175000                 TCOCNTL                                          17500000
175100         WHERE                                                    17510000
175200                 OPER_UNT_ID        =  :RECEIV-CURR-OPER-UNT-ID   17520000
175300          AND    FCLTY_ID           =  1                          17530000
175400     END-EXEC.                                                    17540000
175500                                                                  17550000
175600     EVALUATE TRUE                                                17560000
175700         WHEN SQLCODE = ZERO                                      17570000
175800             PERFORM 5600-GET-DATE-RANGE                          17580000
175900         WHEN SQLCODE = +100                                      17590000
176000             CONTINUE                                             17600000
176100         WHEN SQLWARN0 NOT = SPACES                               17610000
176200         WHEN SQLCODE NOT EQUAL ZERO                              17620000
176300             SET SU035-INVALID-SQL     TO TRUE                    17630000
176400             SET PS-NO-AUTO-APPLY TO TRUE                         17640000
176500             MOVE RECEIV-CURR-OPER-UNT-ID                         17650000
176600                                      TO PV-DISP-OPER-UNT-ID      17660000
176700             STRING   ' SUKUT702-5500-'                           17670000
176800                      ' CALLED BY-'                               17680000
176900                      SU035-PROGRAM-NAME                          17690000
177000                      ' OPER='                                    17700000
177100                      PV-DISP-OPER-UNT-ID                         17710000
177200                      DELIMITED BY SIZE                           17720000
177300                                      INTO PV-CICS-MSG-AREA       17730000
177400             PERFORM 9999-WRITE-TO-CSSL                           17740000
177500             MOVE PV-CICS-MSG-AREA      TO SU035-CRA-RET-MSG      17750000
177600             SET SU035-UPDATE-ERROR TO TRUE                       17760000
177700     END-EVALUATE.                                                17770000
177800                                                                  17780000
177900 5600-GET-DATE-RANGE.                                             17790000
178000                                                                  17800000
178100                                                                  17810000
178200     MOVE PV-CURRENT-TIMESTAMP       TO PV-WORK-TMST.             17820000
178300     MOVE PV-WK-CCYY                 TO PV-LK-DTE-CCYY.           17830000
178400     MOVE PV-WK-MO                   TO PV-LK-DTE-MO              17840000
178500     MOVE PV-WK-DA                   TO PV-LK-DTE-DD              17850000
178600                                                                  17860000
178700     INITIALIZE  DPG51 DPG52                                      17870000
178800                 DPG53 DPG54                                      17880000
178900                 DPG55 DPG56.                                     17890000
179000                                                                  17900000
179100     MOVE PV-LK-DTE-ISO              TO DPG52-LK-DATE-INPUT.      17910000
179200                                                                  17920000
179300     MOVE COCNTL-DAYS-ALWD-ADJ-QTY   TO DPG51-INCR-DECR-DAYS-9.   17930000
179400                                                                  17940000
179500     SET DPG51-DECREMENT-DATE        TO TRUE.                     17950000
179600     SET DPG51-ACTUAL-CALENDAR-ONLY  TO TRUE.                     17960000
179700     SET DPG52-LK-DTE-ISO            TO TRUE.                     17970000
179800                                                                  17980000
179900*    CALL 'DPKUT500' USING DPG51 DPG52                            17990000
180000*                          DPG53 DPG54                            18000000
180100*                          DPG55 DPG56.                           18010000
180200     MOVE '5600-GET-DATE-RANGE'                                   18020000
180300       TO PV-FROM-PARAGRAPH.                                      18030000
180400     PERFORM 3000-CALL-CALENDAR-ROUTINE.                          18040000
180500                                                                  18050000
180600     MOVE DPG55-JULIAN-DATE-CCYYDDD  TO PV-COMP-DATE-JULIAN.      18060000
180700     MOVE DPG55-GREG-CC-DATE-FMT     TO PV-INPUT-DATE             18070000
180800                                                                  18080000
180900     MOVE RECEIV-VERFYD-TMST         TO PV-WORK-TMST.             18090000
181000     MOVE PV-WK-CCYY                 TO PV-LK-DTE-CCYY.           18100000
181100     MOVE PV-WK-MO                   TO PV-LK-DTE-MO              18110000
181200     MOVE PV-WK-DA                   TO PV-LK-DTE-DD              18120000
181300                                                                  18130000
181400     INITIALIZE  DPG51 DPG52                                      18140000
181500                 DPG53 DPG54                                      18150000
181600                 DPG55 DPG56.                                     18160000
181700                                                                  18170000
181800     MOVE PV-LK-DTE-ISO              TO DPG52-LK-DATE-INPUT.      18180000
181900                                                                  18190000
182000     SET DPG51-DO-NOT-INCR-DECR-DATE TO TRUE.                     18200000
182100     SET DPG51-ACTUAL-CALENDAR-ONLY  TO TRUE.                     18210000
182200     SET DPG52-LK-DTE-ISO            TO TRUE.                     18220000
182300                                                                  18230000
182400     MOVE '5600-GET-DATE-RANGE'                                   18240000
182500       TO PV-FROM-PARAGRAPH.                                      18250000
182600     PERFORM 3000-CALL-CALENDAR-ROUTINE.                          18260000
182700                                                                  18270000
182800     MOVE DPG55-JULIAN-DATE-CCYYDDD  TO PV-VFY-DATE-JULIAN.       18280000
182900                                                                  18290000
183000 5700-GET-TDISTHD.                                                18300000
183100                                                                  18310000
183200     MOVE SU035-PO               TO  DK-PO.                       18320000
183300     MOVE SU035-REC-SEQ-NBR      TO  DK-REC-SEQ-NBR.              18330000
183400     MOVE SU035-PO-LNE-NBR       TO DK-PO-LNE-NBR.                18340000
183500                                                                  18350000
183600     EXEC SQL                                                     18360000
183700          SELECT   FCSE_CNFRMN_TMST                               18370000
183800               ,   VRFD_TMST                                      18380000
183900               ,   TOT_CART_CNT                                   18390000
184000            INTO  :DISTHD-FCSE-CNFRMN-TMST                        18400000
184100               ,  :DISTHD-VRFD-TMST                               18410000
184200               ,  :DISTHD-TOT-CART-CNT                            18420000
184300            FROM                                                  18430000
184400                  TDISTHD                                         18440000
184500            WHERE                                                 18450000
184600                  ORD_NBR          = :DK-PO                       18460000
184700              AND RCVR_SEQ_NBR     = :DK-REC-SEQ-NBR              18470000
184800              AND ORD_LNE_NBR      = :DK-PO-LNE-NBR               18480000
184900     END-EXEC.                                                    18490000
185000                                                                  18500000
185100     EVALUATE TRUE                                                18510000
185200         WHEN SQLCODE = ZERO                                      18520000
185300              SET PS-DISTHD-FOUND TO TRUE                         18530000
185400         WHEN SQLCODE = +100                                      18540000
185500              SET PS-NO-DISTHD-FOUND TO TRUE                      18550000
185600         WHEN SQLWARN0 NOT = SPACES                               18560000
185700         WHEN SQLCODE  NOT = ZERO                                 18570000
185800             SET SU035-INVALID-SQL     TO TRUE                    18580000
185900             SET PS-NO-AUTO-APPLY TO TRUE                         18590000
186000             MOVE SU035-PO        TO  PV-DISP-PO                  18600000
186100             MOVE SU035-REC-SEQ-NBR   TO PV-DISP-RCVR-SEQ-NBR     18610000
186200             MOVE SU035-PO-LNE-NBR    TO PV-DISP-PO-LNE-NBR       18620000
186300             STRING   ' SUKUT702-5100-'                           18630000
186400                      ' CALLED BY-'                               18640000
186500                      SU035-PROGRAM-NAME                          18650000
186600                      ' PO='                                      18660000
186700                      PV-DISP-PO                                  18670000
186800                      ' RCVR='                                    18680000
186900                      PV-DISP-RCVR-SEQ-NBR                        18690000
187000                      ' LINE='                                    18700000
187100                      PV-DISP-PO-LNE-NBR                          18710000
187200                      DELIMITED BY SIZE                           18720000
187300                                      INTO PV-CICS-MSG-AREA       18730000
187400             PERFORM 9999-WRITE-TO-CSSL                           18740000
187500             MOVE PV-CICS-MSG-AREA      TO SU035-CRA-RET-MSG      18750000
187600             SET SU035-UPDATE-ERROR TO TRUE                       18760000
187700     END-EVALUATE.                                                18770000
187800                                                                  18780000
187900                                                                  18790000
188000 5800-GET-TDISTDT.                                                18800000
188100     MOVE SU035-PO               TO  DK-PO.                       18810000
188200     MOVE SU035-REC-SEQ-NBR      TO  DK-REC-SEQ-NBR.              18820000
188300     MOVE SU035-PO-LNE-NBR       TO DK-PO-LNE-NBR.                18830000
188400     MOVE SU035-DEST-LOC-NBR     TO DK-STR-NBR.                   18840000
188500                                                                  18850000
188600     EXEC SQL                                                     18860000
188700          SELECT  ACTL_ALLOC_QTY                                  18870000
188800                , P2L_SPLT_UNT_QTY                                18880000
188900                , FCSE_SPLT_UNT_QTY                               18890000
189000                , INPK_SPLT_UNT_QTY                               18900000
189100                , FCSE_ACTL_UNT_QTY                               18910000
189200                , PREPK_ODD_UNT_QTY                               18920000
189300            INTO  :DISTDT-ACTL-ALLOC-QTY                          18930000
189400                , :DISTDT-P2L-SPLT-UNT-QTY                        18940000
189500                , :DISTDT-FCSE-SPLT-UNT-QTY                       18950000
189600                , :DISTDT-INPK-SPLT-UNT-QTY                       18960000
189700                , :DISTDT-FCSE-ACTL-UNT-QTY                       18970000
189800                , :DISTDT-PREPK-ODD-UNT-QTY                       18980000
189900            FROM                                                  18990000
190000                  TDISTDT                                         19000000
190100            WHERE                                                 19010000
190200                  ORD_NBR          = :DK-PO                       19020000
190300              AND RCVR_SEQ_NBR     = :DK-REC-SEQ-NBR              19030000
190400              AND ORD_LNE_NBR      = :DK-PO-LNE-NBR               19040000
190500              AND STR_NBR          = :DK-STR-NBR                  19050000
190600     END-EXEC.                                                    19060000
190700                                                                  19070000
190800     EVALUATE TRUE                                                19080000
190900         WHEN SQLCODE = ZERO                                      19090000
191000              SET PS-DISTDT-FOUND TO TRUE                         19100000
191100         WHEN SQLCODE = +100                                      19110000
191200              SET PS-NO-DISTDT-FOUND TO TRUE                      19120000
191300         WHEN SQLWARN0 NOT = SPACES                               19130000
191400         WHEN SQLCODE  NOT = ZERO                                 19140000
191500             SET SU035-INVALID-SQL     TO TRUE                    19150000
191600             SET PS-NO-AUTO-APPLY TO TRUE                         19160000
191700             MOVE SU035-PO        TO  PV-DISP-PO                  19170000
191800             MOVE SU035-REC-SEQ-NBR   TO PV-DISP-RCVR-SEQ-NBR     19180000
191900             MOVE SU035-PO-LNE-NBR    TO PV-DISP-PO-LNE-NBR       19190000
192000             MOVE DK-STR-NBR          TO PV-DISP-STR-NBR          19200000
192100             STRING   ' SUKUT702-5800-'                           19210000
192200                      ' CALLED BY-'                               19220000
192300                      SU035-PROGRAM-NAME                          19230000
192400                      ' PO='                                      19240000
192500                      PV-DISP-PO                                  19250000
192600                      ' RCVR='                                    19260000
192700                      PV-DISP-RCVR-SEQ-NBR                        19270000
192800                      ' LINE='                                    19280000
192900                      PV-DISP-PO-LNE-NBR                          19290000
193000                      ' STR ='                                    19300000
193100                      PV-DISP-STR-NBR                             19310000
193200                      DELIMITED BY SIZE                           19320000
193300                                      INTO PV-CICS-MSG-AREA       19330000
193400             PERFORM 9999-WRITE-TO-CSSL                           19340000
193500             MOVE PV-CICS-MSG-AREA      TO SU035-CRA-RET-MSG      19350000
193600             SET SU035-UPDATE-ERROR TO TRUE                       19360000
193700     END-EVALUATE.                                                19370000
193800                                                                  19380000
193900*----------------------------------------------------------------*19390000
194000*  INSERT A ROW ON THE TRANSACTION DETAIL TABLE.                 *19400000
194100*----------------------------------------------------------------*19410000
194200 5900-INSERT-TRANS-DTL-REC.                                       19420000
194300                                                                  19430000
194400     MOVE 0          TO DISTDT-ACTL-ALLOC-QTY                     19440000
194500                        DISTDT-EXPTED-ALLOC-QTY                   19450000
194600                        DISTDT-P2L-SPLT-UNT-QTY                   19460000
194700                        DISTDT-FCSE-SPLT-UNT-QTY                  19470000
194800                        DISTDT-INPK-SPLT-UNT-QTY                  19480000
194900                        DISTDT-FCSE-ACTL-UNT-QTY.                 19490000
195000                                                                  19500000
195100     MOVE 1          TO DISTDT-WRK-ORD-SEQ-NBR.                   19510000
195200                                                                  19520000
195300     MOVE SPACE      TO DISTDT-ODD-CART-IND.                      19530000
195400     MOVE ZEROES     TO DISTDT-PREPK-ODD-UNT-QTY.                 19540000
195500     MOVE 'N'        TO DISTDT-RCVG-PSTD-STAT-CDE.                19550000
195600                                                                  19560000
195700     IF SU035-PACK-YES                                            19570000
195800         MOVE SU035-PACK-ID TO DK-PACK-ID                         19580000
195900         SET PS-TDISTDT-ADD   TO TRUE                             19590000
196000         PERFORM 6310-OPEN-RECITM-CURSOR                          19600000
196100         PERFORM 6330-GET-RECITMS                                 19610000
196200           UNTIL PS-MORE-RECITM-NO                                19620000
196300         PERFORM 6320-CLOSE-RECITM-CURSOR                         19630000
196400     ELSE                                                         19640000
196500         PERFORM 5930-INSERT-TDISTDT                              19650000
196600     END-IF.                                                      19660000
196700                                                                  19670000
196800 5930-INSERT-TDISTDT.                                             19680000
196900                                                                  19690000
197000     EXEC SQL                                                     19700000
197100          INSERT                                                  19710000
197200          INTO  TDISTDT                                           19720000
197300               (ORD_NBR                                           19730000
197400               ,RCVR_SEQ_NBR                                      19740000
197500               ,ORD_LNE_NBR                                       19750000
197600               ,WRK_ORD_SEQ_NBR                                   19760000
197700               ,STR_NBR                                           19770000
197800               ,EXPTED_ALLOC_QTY                                  19780000
197900               ,ACTL_ALLOC_QTY                                    19790000
198000               ,RCVG_PSTD_STAT_CDE                                19800000
198100               ,P2L_SPLT_UNT_QTY                                  19810000
198200               ,FCSE_SPLT_UNT_QTY                                 19820000
198300               ,INPK_SPLT_UNT_QTY                                 19830000
198400               ,FCSE_ACTL_UNT_QTY                                 19840000
198500               ,ODD_CART_IND                                      19850000
198600               ,PREPK_ODD_UNT_QTY)                                19860000
198700        VALUES                                                    19870000
198800              (:DK-PO                                             19880000
198900              ,:DK-REC-SEQ-NBR                                    19890000
199000              ,:DK-PO-LNE-NBR                                     19900000
199100              ,:DISTDT-WRK-ORD-SEQ-NBR                            19910000
199200              ,:DK-STR-NBR                                        19920000
199300              ,:DISTDT-EXPTED-ALLOC-QTY                           19930000
199400              ,:DISTDT-ACTL-ALLOC-QTY                             19940000
199500              ,:DISTDT-RCVG-PSTD-STAT-CDE                         19950000
199600              ,:DISTDT-P2L-SPLT-UNT-QTY                           19960000
199700              ,:DISTDT-FCSE-SPLT-UNT-QTY                          19970000
199800              ,:DISTDT-INPK-SPLT-UNT-QTY                          19980000
199900              ,:DISTDT-FCSE-ACTL-UNT-QTY                          19990000
200000              ,:DISTDT-ODD-CART-IND                               20000000
200100              ,:DISTDT-PREPK-ODD-UNT-QTY)                         20010000
200200     END-EXEC.                                                    20020000
200300                                                                  20030000
200400     EVALUATE TRUE                                                20040000
200500         WHEN SQLCODE = ZERO                                      20050000
200600             CONTINUE                                             20060000
200700         WHEN SQLWARN0 NOT = SPACES                               20070000
200800         WHEN SQLCODE NOT EQUAL ZERO                              20080000
200900             MOVE DK-PO        TO PV-DISP-PO                      20090000
201000             MOVE DK-REC-SEQ-NBR                                  20100000
201100                               TO PV-DISP-RCVR-SEQ-NBR            20110000
201200             MOVE DK-PO-LNE-NBR                                   20120000
201300                               TO PV-DISP-PO-LNE-NBR              20130000
201400             MOVE DK-STR-NBR   TO PV-DISP-STR-NBR                 20140000
201500             STRING ' RCVR: '            DELIMITED BY SIZE        20150000
201600                  PV-DISP-PO             DELIMITED BY SIZE        20160000
201700                  '-'                    DELIMITED BY SIZE        20170000
201800                  PV-DISP-RCVR-SEQ-NBR   DELIMITED BY SIZE        20180000
201900                  '  LINE: '             DELIMITED BY SIZE        20190000
202000                  PV-DISP-PO-LNE-NBR     DELIMITED BY SIZE        20200000
202100                  '  STORE: '            DELIMITED BY SIZE        20210000
202200                  PV-DISP-STR-NBR        DELIMITED BY SIZE        20220000
202300                                  INTO PV-CICS-MSG-AREA           20230000
202400              PERFORM 9999-WRITE-TO-CSSL                          20240000
202500              MOVE PV-CICS-MSG-AREA      TO SU035-CRA-RET-MSG     20250000
202600     END-EVALUATE.                                                20260000
202700                                                                  20270000
202800 6000-GET-OUTBOUND-CART.                                          20280000
202900                                                                  20290000
203000     MOVE SU035-SHIPT-UNT-ID     TO DK-SHIPT-UNT-ID.              20300000
203100                                                                  20310000
203200     EXEC SQL                                                     20320000
203300          SELECT  CART_SRC_CDE                                    20330000
203400            INTO  :SUT00024-CART-SRC-CDE                          20340000
203500            FROM  SUT_OTBND_CART                                  20350000
203600            WHERE SHIPT_UNT_ID     = :DK-SHIPT-UNT-ID             20360000
203700     END-EXEC.                                                    20370000
203800                                                                  20380000
203900     EVALUATE TRUE                                                20390000
204000         WHEN SQLCODE = ZERO                                      20400000
204100              MOVE SUT00024-CART-SRC-CDE  TO SU035-CART-CREATE-SRC20410000
204200              SET PS-OUTBND-CART-FOUND TO TRUE                    20420000
204300         WHEN SQLCODE = +100                                      20430000
204400              SET PS-NO-OUTBND-CART-FOUND TO TRUE                 20440000
204500         WHEN SQLWARN0 NOT = SPACES                               20450000
204600         WHEN SQLCODE  NOT = ZERO                                 20460000
204700             SET SU035-INVALID-SQL     TO TRUE                    20470000
204800             SET PS-NO-AUTO-APPLY TO TRUE                         20480000
204900             MOVE DK-SHIPT-UNT-ID     TO PV-DISP-SHIPT-UNT-ID     20490000
205000             STRING   ' SUKUT702-6000-'                           20500000
205100                      ' CALLED BY-'                               20510000
205200                      SU035-PROGRAM-NAME                          20520000
205300                      ' SHIPT UNIT = '                            20530000
205400                      PV-DISP-SHIPT-UNT-ID                        20540000
205500                      DELIMITED BY SIZE                           20550000
205600                                      INTO PV-CICS-MSG-AREA       20560000
205700             PERFORM 9999-WRITE-TO-CSSL                           20570000
205800             MOVE PV-CICS-MSG-AREA      TO SU035-CRA-RET-MSG      20580000
205900             SET SU035-UPDATE-ERROR TO TRUE                       20590000
206000     END-EVALUATE.                                                20600000
206100                                                                  20610000
206200 6100-MOVE-TO-FINCL-ADJ.                                          20620000
206300     MOVE SU035-FINCL-ADJ-ID    TO SUT00030-FINCL-ADJ-ID.         20630000
206400     MOVE SU035-PO              TO SUT00030-PO-NBR.               20640000
206500     IF PS-LINE-FOUND                                             20650000
206600         MOVE SU035-PO-LNE-NBR  TO SUT00030-RCVR-LNE-NBR          20660000
206700     ELSE                                                         20670000
206800         MOVE ZERO              TO SUT00030-RCVR-LNE-NBR          20680000
206900     END-IF.                                                      20690000
207000     MOVE SU035-REC-SEQ-NBR     TO SUT00030-RCVR-SEQ-NBR.         20700000
207100     MOVE SU035-DEST-LOC-NBR    TO SUT00030-DEST-LOC-NBR.         20710000
207200     MOVE SU035-UPC-NBR         TO SUT00030-UPC-NBR.              20720000
207300     IF SU035-SHIPT-UNT-ID > 0                                    20730000
207400         MOVE SU035-SHIPT-UNT-ID    TO SUT00030-SHIPT-UNT-ID      20740000
207500         MOVE 0                 TO DN-SHIPT-IND                   20750000
207600     ELSE                                                         20760000
207700         MOVE -1                TO DN-SHIPT-IND                   20770000
207800     END-IF.                                                      20780000
207900     MOVE SU035-PRC-RSN-CDE     TO SUT00030-PRC-RSN-CDE.          20790000
208000     IF SU035-ADJ-AUDIT-CNTL-NBR > 0                              20800000
208100         MOVE SU035-ADJ-AUDIT-CNTL-NBR                            20810000
208200                                TO SUT00030-AUD-CNTL-NBR          20820000
208300         MOVE 0                 TO DN-AUDIT-IND                   20830000
208400     ELSE                                                         20840000
208500         MOVE -1                TO DN-AUDIT-IND                   20850000
208600     END-IF.                                                      20860000
208700     MOVE SU035-ORIG-OPER-UNT-ID                                  20870000
208800                                TO SUT00030-ORGN-LOC-NBR.         20880000
208900     IF RECEIV-STATUS-CDE = 'VE'                                  20890000
209000         IF RECEIV-ML-POST-TMST = PC-DEFAULT-TMST                 20900000
209100             MOVE 'V'           TO SUT00030-AUD-ADJ-STAT-CDE      20910000
209200             SET SU035-VERIFIED TO TRUE                           20920000
209300         ELSE                                                     20930000
209400             MOVE 'P'           TO SUT00030-AUD-ADJ-STAT-CDE      20940000
209500             SET SU035-POST-VERIFIED TO TRUE                      20950000
209600         END-IF                                                   20960000
209700     ELSE                                                         20970000
209800         IF RECITM-STATUS-CDE = 'VE' OR                           20980000
209900            RECEIV-PACK-BY-ST-IND EQUAL 'Y'                       20990000
210000             MOVE 'V'           TO SUT00030-AUD-ADJ-STAT-CDE      21000000
210100             SET SU035-VERIFIED TO TRUE                           21010000
210200         ELSE                                                     21020000
210300             MOVE 'C'           TO SUT00030-AUD-ADJ-STAT-CDE      21030000
210400             SET SU035-COMPLETE TO TRUE                           21040000
210500         END-IF                                                   21050000
210600     END-IF.                                                      21060000
210700     IF SU035-PROGRAM-NAME = 'PCCS722C' OR                        21070000
210800        SU035-PROGRAM-NAME = 'PCCS107C' OR                        21080000
210900        SU035-PROGRAM-NAME = 'PCCS766C'                           21090000
211000             MOVE 'Q'           TO SUT00030-AUD-ADJ-STAT-CDE      21100000
211100     END-IF.                                                      21110000
211200     IF PS-NO-AUTO-APPLY OR                                       21120000
211300        SU035-LOG-AS-FAIL                                         21130000
211400         MOVE 'N'               TO SUT00030-AUTO-APL-IND          21140000
211500     ELSE                                                         21150000
211600         MOVE 'Y'               TO SUT00030-AUTO-APL-IND          21160000
211700     END-IF.                                                      21170000
211800     MOVE SU035-CREATE-USER-ID  TO SUT00030-CRE-BY-USR-ID.        21180000
211900     IF SU035-PROGRAM-NAME = 'SUKRF512' OR                        21190000
212000        SU035-PROGRAM-NAME = 'SUKRF515'                           21200000
212100         IF PS-SYSTEM-AUDIT-FOUND                                 21210000
212200             IF SU035-PROGRAM-NAME = 'SUKRF512'                   21220000
212300                 MOVE 'SUKR512S'    TO SUT00030-CRE-PGM-NM        21230000
212400             ELSE                                                 21240000
212500                 MOVE 'SUKR515S'    TO SUT00030-CRE-PGM-NM        21250000
212600             END-IF                                               21260000
212700         ELSE                                                     21270000
212800             IF SUNAUD-AUD-TYP-CDE = '01'                         21280000
212900                 IF SU035-PROGRAM-NAME = 'SUKRF512'               21290000
213000                     MOVE 'SUKR512H'    TO SUT00030-CRE-PGM-NM    21300000
213100                 ELSE                                             21310000
213200                     MOVE 'SUKR515H'    TO SUT00030-CRE-PGM-NM    21320000
213300                 END-IF                                           21330000
213400             ELSE                                                 21340000
213500             IF SUNAUD-AUD-TYP-CDE = '02'                         21350000
213600                 IF SU035-PROGRAM-NAME = 'SUKRF512'               21360000
213700                     MOVE 'SUKR512P'    TO SUT00030-CRE-PGM-NM    21370000
213800                 ELSE                                             21380000
213900                     MOVE 'SUKR515P'    TO SUT00030-CRE-PGM-NM    21390000
214000                 END-IF                                           21400000
214100             ELSE                                                 21410000
214200             IF SUNAUD-AUD-TYP-CDE = '03'                         21420000
214300                 IF SU035-PROGRAM-NAME = 'SUKRF512'               21430000
214400                     MOVE 'SUKR512R'    TO SUT00030-CRE-PGM-NM    21440000
214500                 ELSE                                             21450000
214600                     MOVE 'SUKR515R'    TO SUT00030-CRE-PGM-NM    21460000
214700                 END-IF                                           21470000
214800             END-IF                                               21480000
214900             END-IF                                               21490000
215000             END-IF                                               21500000
215100         END-IF                                                   21510000
215200     ELSE                                                         21520000
215300         MOVE SU035-PROGRAM-NAME    TO SUT00030-CRE-PGM-NM        21530000
215400     END-IF.                                                      21540000
215500     MOVE SU035-BEFORE-QTY      TO SUT00030-FINCL-BEF-QTY.        21550000
215600     MOVE SU035-AFTER-QTY       TO SUT00030-FINCL-AFT-QTY.        21560000
215700     MOVE SU035-ADJUST-QTY      TO SUT00030-ADJ-QTY.              21570000
215800     MOVE SPACES                TO SUT00030-RSLV-BY-USR-ID.       21580000
215900     MOVE PC-DEFAULT-TMST       TO SUT00030-RSLV-TMST.            21590000
216000                                                                  21600000
216100     EXEC SQL                                                     21610000
216200         SET :SUT00030-CRE-TMST = CURRENT TIMESTAMP               21620000
216300     END-EXEC.                                                    21630000
216400                                                                  21640000
216500     IF SUT00030-PROB-RSN-CDE = 1                                 21650000
216600         MOVE 0      TO DN-PROB-IND                               21660000
216700     ELSE                                                         21670000
216800         MOVE -1     TO DN-PROB-IND                               21680000
216900     END-IF.                                                      21690000
217000     IF SUT00030-ADJ-ERR-CDE > 0                                  21700000
217100         MOVE 0      TO DN-ADJ-IND                                21710000
217200     ELSE                                                         21720000
217300         MOVE -1     TO DN-ADJ-IND                                21730000
217400     END-IF.                                                      21740000
217500                                                                  21750000
217600 6150-INSERT-FINCL-ADJ.                                           21760000
217700     EXEC SQL                                                     21770000
217800         INSERT INTO SUT_FINCL_ADJ                                21780000
217900         (                                                        21790000
218000            FINCL_ADJ_ID                                          21800000
218100         ,  ADJ_ERR_CDE                                           21810000
218200         ,  PO_NBR                                                21820000
218300         ,  RCVR_LNE_NBR                                          21830000
218400         ,  RCVR_SEQ_NBR                                          21840000
218500         ,  DEST_LOC_NBR                                          21850000
218600         ,  CRE_TMST                                              21860000
218700         ,  UPC_NBR                                               21870000
218800         ,  SHIPT_UNT_ID                                          21880000
218900         ,  PRC_RSN_CDE                                           21890000
219000         ,  AUD_CNTL_NBR                                          21900000
219100         ,  ORGN_LOC_NBR                                          21910000
219200         ,  AUD_ADJ_STAT_CDE                                      21920000
219300         ,  AUTO_APL_IND                                          21930000
219400         ,  CRE_BY_USR_ID                                         21940000
219500         ,  CRE_PGM_NM                                            21950000
219600         ,  FINCL_BEF_QTY                                         21960000
219700         ,  FINCL_AFT_QTY                                         21970000
219800         ,  RSLV_BY_USR_ID                                        21980000
219900         ,  RSLV_TMST                                             21990000
220000         ,  PROB_RSN_CDE                                          22000000
220100         ,  ADJ_QTY                                               22010000
220200         )                                                        22020000
220300         VALUES                                                   22030000
220400         (                                                        22040000
220500            :SUT00030-FINCL-ADJ-ID                                22050000
220600         ,  :SUT00030-ADJ-ERR-CDE :DN-ADJ-IND                     22060000
220700         ,  :SUT00030-PO-NBR                                      22070000
220800         ,  :SUT00030-RCVR-LNE-NBR                                22080000
220900         ,  :SUT00030-RCVR-SEQ-NBR                                22090000
221000         ,  :SUT00030-DEST-LOC-NBR                                22100000
221100         ,  :SUT00030-CRE-TMST                                    22110000
221200         ,  :SUT00030-UPC-NBR                                     22120000
221300         ,  :SUT00030-SHIPT-UNT-ID :DN-SHIPT-IND                  22130000
221400         ,  :SUT00030-PRC-RSN-CDE                                 22140000
221500         ,  :SUT00030-AUD-CNTL-NBR :DN-AUDIT-IND                  22150000
221600         ,  :SUT00030-ORGN-LOC-NBR                                22160000
221700         ,  :SUT00030-AUD-ADJ-STAT-CDE                            22170000
221800         ,  :SUT00030-AUTO-APL-IND                                22180000
221900         ,  :SUT00030-CRE-BY-USR-ID                               22190000
222000         ,  :SUT00030-CRE-PGM-NM                                  22200000
222100         ,  :SUT00030-FINCL-BEF-QTY                               22210000
222200         ,  :SUT00030-FINCL-AFT-QTY                               22220000
222300         ,  :SUT00030-RSLV-BY-USR-ID                              22230000
222400         ,  :SUT00030-RSLV-TMST                                   22240000
222500         ,  :SUT00030-PROB-RSN-CDE :DN-PROB-IND                   22250000
222600         ,  :SUT00030-ADJ-QTY                                     22260000
222700         )                                                        22270000
222800     END-EXEC.                                                    22280000
222900                                                                  22290000
223000     EVALUATE TRUE                                                22300000
223100         WHEN SQLCODE = +0                                        22310000
223200             SET PS-SUT-OTBND-WRTN TO TRUE                        22320000
223300         WHEN SQLWARN0 NOT = SPACES                               22330000
223400         WHEN SQLCODE < +0                                        22340000
223500         WHEN SQLCODE > +0                                        22350000
223600             SET PS-ERROR                                         22360000
223700                 SU035-INVALID-SQL    TO TRUE                     22370000
223800             MOVE SUT00030-PO-NBR     TO PV-DISP-PO               22380000
223900             MOVE SUT00030-RCVR-LNE-NBR                           22390000
224000                                      TO PV-DISP-PO-LNE-NBR       22400000
224100             MOVE SUT00030-RCVR-SEQ-NBR                           22410000
224200                                      TO PV-DISP-RCVR-SEQ-NBR     22420000
224300             STRING   ' SUKUT702-6150-'                           22430000
224400                      ' PO= '                                     22440000
224500                      PV-DISP-PO                                  22450000
224600                      ' RCVR SEQ='                                22460000
224700                      PV-DISP-RCVR-SEQ-NBR                        22470000
224800                      ' LINE= '                                   22480000
224900                      PV-DISP-PO-LNE-NBR                          22490000
225000                      ' SHIPT='                                   22500000
225100                      PV-DISP-SHIPT-UNT-ID                        22510000
225200                      DELIMITED BY SIZE                           22520000
225300                                      INTO PV-CICS-MSG-AREA       22530000
225400             PERFORM 9999-WRITE-TO-CSSL                           22540000
225500             MOVE SUT00030-AUD-CNTL-NBR                           22550000
225600                                      TO PV-DISPLAY-AUDIT-CNTL-NBR22560000
225700             MOVE SUT00030-PROB-RSN-CDE                           22570000
225800                                      TO PV-DISP-PROB-RSN-CDE     22580000
225900             STRING   ' SUKUT702-6150-'                           22590000
226000                      ' AUDIT= '                                  22600000
226100                      PV-DISPLAY-AUDIT-CNTL-NBR                   22610000
226200                      ' RSN CDE= '                                22620000
226300                       PV-DISP-PROB-RSN-CDE                       22630000
226400                      ' STAT CDE= '                               22640000
226500                       SUT00030-AUD-ADJ-STAT-CDE                  22650000
226600                      ' APL IND= '                                22660000
226700                       SUT00030-AUTO-APL-IND                      22670000
226800                      DELIMITED BY SIZE                           22680000
226900                                      INTO PV-CICS-MSG-AREA       22690000
227000             PERFORM 9999-WRITE-TO-CSSL                           22700000
227100             MOVE SUT00030-FINCL-ADJ-ID                           22710000
227200                                      TO PV-DISP-FINCL-ADJ-ID     22720000
227300             MOVE SUT00030-SHIPT-UNT-ID                           22730000
227400                                      TO PV-DISP-SHIPT-UNT-ID     22740000
227500             MOVE SUT00030-AUD-CNTL-NBR                           22750000
227600                                      TO PV-DISPLAY-AUDIT-CNTL-NBR22760000
227700             MOVE SUT00030-ADJ-ERR-CDE                            22770000
227800                                      TO PV-DISPLAY-ADJ-ERR-CDE   22780000
227900             MOVE  SQLCODE            TO PV-DISPLAY-SQLCODE       22790000
228000             STRING   ' SUKUT702-6150-'                           22800000
228100                      ' CALLED BY-'                               22810000
228200                      SU035-PROGRAM-NAME                          22820000
228300                      '  SQLCODE='                                22830000
228400                      PV-DISPLAY-SQLCODE                          22840000
228500                      ' REASON='                                  22850000
228600                      PV-DISPLAY-ADJ-ERR-CDE                      22860000
228700                      ' ADJ-ID ='                                 22870000
228800                      PV-DISP-FINCL-ADJ-ID                        22880000
228900                      ' '                                         22890000
229000                      SUT00030-PRC-RSN-CDE                        22900000
229100                      ' '                                         22910000
229200                      PV-DISPLAY-AUDIT-CNTL-NBR                   22920000
229300                      DELIMITED BY SIZE                           22930000
229400                                      INTO PV-CICS-MSG-AREA       22940000
229500             PERFORM 9999-WRITE-TO-CSSL                           22950000
229600             MOVE '6150-'                TO SU035-CRA-REQ-ID      22960000
229700             MOVE PV-CICS-MSG-AREA      TO SU035-CRA-RET-MSG      22970000
229800             PERFORM 9998-RETURN                                  22980000
229900     END-EVALUATE.                                                22990000
230000                                                                  23000000
230100 6200-UPDATE-TRECDIS.                                             23010000
230200                                                                  23020001
230300     MOVE SU035-PO-LNE-NBR            TO DK-PO-LNE-NBR.           23030001
230400                                                                  23040001
230500     EXEC SQL                                                     23050000
230600       UPDATE TRECDIS                                             23060000
230700          SET AP_VERIFY_ITM_QTY  = :RECDIS-AP-VERIFY-ITM-QTY      23070000
230800             ,VERIFY_ITM_QTY     = :RECDIS-VERIFY-ITM-QTY         23080000
230900        WHERE ORD_NBR            = :DK-PO                         23090000
231000          AND ORD_LNE_NBR        = :DK-PO-LNE-NBR                 23100000
231100          AND REC_SEQ_NBR        = :DK-REC-SEQ-NBR                23110000
231200          AND STR_NBR            = :RECDIS-STR-NBR                23120000
231300          AND STR_FCLTY_ID       = 1                              23130000
231500     END-EXEC.                                                    23150000
231600                                                                  23160000
231700     EVALUATE TRUE                                                23170000
231800         WHEN SQLCODE = +0                                        23180000
231900             CONTINUE                                             23190000
232000         WHEN SQLWARN0 NOT = SPACES                               23200000
232100         WHEN SQLCODE < +0                                        23210000
232200         WHEN SQLCODE > +0                                        23220000
232300             SET PS-ERROR                                         23230000
232400                 SU035-INVALID-SQL    TO TRUE                     23240000
232500             MOVE DK-PO               TO PV-DISP-PO               23250000
232600             MOVE DK-REC-SEQ-NBR      TO PV-DISP-RCVR-SEQ-NBR     23260000
232700             MOVE DK-PO-LNE-NBR       TO PV-DISP-PO-LNE-NBR       23270000
232800             MOVE RECDIS-STR-NBR      TO PV-DISP-STR-NBR          23280000
232900             MOVE  SQLCODE            TO PV-DISPLAY-SQLCODE       23290000
233000             STRING   ' SUKUT702-6200-'                           23300000
233100                      ' CALLED BY-'                               23310000
233200                      SU035-PROGRAM-NAME                          23320000
233300                      '  SQLCODE='                                23330000
233400                      PV-DISPLAY-SQLCODE                          23340000
233500                      ' PO='                                      23350000
233600                      PV-DISP-PO                                  23360000
233700                      ' RCV='                                     23370000
233800                      PV-DISP-RCVR-SEQ-NBR                        23380000
233900                      ' LNE='                                     23390000
234000                      PV-DISP-PO-LNE-NBR                          23400000
234100                      ' '                                         23410000
234200                      PV-DISP-STR-NBR                             23420000
234300                      DELIMITED BY SIZE                           23430000
234400                                      INTO PV-CICS-MSG-AREA       23440000
234500             PERFORM 9999-WRITE-TO-CSSL                           23450000
234600             MOVE '6200-'                TO SU035-CRA-REQ-ID      23460000
234700             MOVE PV-CICS-MSG-AREA      TO SU035-CRA-RET-MSG      23470000
234800             PERFORM 9998-RETURN                                  23480000
234900     END-EVALUATE.                                                23490000
235000                                                                  23500000
235100                                                                  23510000
235200 6300-INSERT-TRECDIS.                                             23520000
235300     INITIALIZE DCLTRECDIS.                                       23530000
235400     MOVE ZERO                      TO RECDIS-EXPTED-ITM-QTY      23540000
235500                                       RECDIS-VERIFY-ITM-QTY      23550000
235600                                       RECDIS-AP-VERIFY-ITM-QTY.  23560000
235700     MOVE SU035-DEST-LOC-NBR        TO RECDIS-STR-NBR.            23570000
235800     MOVE 1                         TO RECDIS-STR-FCLTY-ID.       23580000
235900     MOVE PC-DEFAULT-DATE           TO RECDIS-AP-PRC-DTE.         23590000
236000     MOVE 'A'                       TO RECDIS-VER-STATUS-CDE.     23600000
236100                                                                  23610000
236200     IF SU035-PACK-YES                                            23620000
236300         MOVE SU035-PACK-ID TO DK-PACK-ID                         23630000
236400         SET PS-TRECDIS-ADD   TO TRUE                             23640000
236500         PERFORM 6310-OPEN-RECITM-CURSOR                          23650000
236600         PERFORM 6330-GET-RECITMS                                 23660000
236700           UNTIL PS-MORE-RECITM-NO                                23670000
236800         PERFORM 6320-CLOSE-RECITM-CURSOR                         23680000
236900     ELSE                                                         23690000
237000         MOVE DK-PO-LNE-NBR      TO DK-PKSL-LNE-NBR               23700000
237100         MOVE SU035-DEST-LOC-NBR TO DK-STR-DEST-NBR               23710000
237200         PERFORM 6350-CHECK-FOR-EXISTING                          23720000
237300         IF PS-RECDIS-FOUND                                       23730000
237400             CONTINUE                                             23740000
237500         ELSE                                                     23750000
237600             MOVE DK-PO-LNE-NBR   TO RECDIS-ORD-LNE-NBR           23760000
237700             PERFORM 6370-INSERT-RECDIS                           23770000
237800             SET PS-BEFORE-ONLY-LOGGING TO TRUE                   23780000
237900             INITIALIZE RC031-FIELDS                              23790000
238000             MOVE SU035-PO-LNE-NBR    TO RC031-PO-LNE-NBR         23800000
238100             PERFORM 6600-ADD-TO-RECD-AUDIT-BEFORE                23810000
238200         END-IF                                                   23820000
238300     END-IF.                                                      23830000
238400                                                                  23840000
238500 6310-OPEN-RECITM-CURSOR.                                         23850000
238600                                                                  23860000
238700     EXEC SQL                                                     23870000
238800         OPEN RECITM-CURSOR                                       23880000
238900     END-EXEC.                                                    23890000
239000                                                                  23900000
239100     EVALUATE TRUE                                                23910000
239200       WHEN SQLCODE = ZERO                                        23920000
239300           SET PS-MORE-RECITM-YES TO TRUE                         23930000
239400                                                                  23940000
239500       WHEN SQLWARN0 NOT = SPACES                                 23950000
239600       WHEN SQLCODE  NOT = ZERO                                   23960000
239700           MOVE DK-PO          TO PV-DISP-PO                      23970000
239800           MOVE DK-REC-SEQ-NBR TO PV-DISP-RCVR-SEQ-NBR            23980000
239900           MOVE DK-PACK-ID     TO PV-DISP-PACK-ID                 23990000
240000           MOVE SQLCODE        TO PV-DISPLAY-SQLCODE              24000000
240100           STRING   ' SUKUT702-6310-'                             24010000
240200                      ' CALLED BY-'                               24020000
240300                      SU035-PROGRAM-NAME                          24030000
240400                      '  SQLCODE='                                24040000
240500                      PV-DISPLAY-SQLCODE                          24050000
240600                      ' PO= '                                     24060000
240700                      PV-DISP-PO                                  24070000
240800                      ' RCV= '                                    24080000
240900                      PV-DISP-RCVR-SEQ-NBR                        24090000
241000                      ' PACK= '                                   24100000
241100                      PV-DISP-PACK-ID                             24110000
241200                      DELIMITED BY SIZE                           24120000
241300                                      INTO PV-CICS-MSG-AREA       24130000
241400           PERFORM 9999-WRITE-TO-CSSL                             24140000
241500           MOVE '6310-'                TO SU035-CRA-REQ-ID        24150000
241600           MOVE PV-CICS-MSG-AREA      TO SU035-CRA-RET-MSG        24160000
241700           PERFORM 9998-RETURN                                    24170000
241800     END-EVALUATE.                                                24180000
241900                                                                  24190000
242000 6320-CLOSE-RECITM-CURSOR.                                        24200000
242100                                                                  24210000
242200     EXEC SQL                                                     24220000
242300         CLOSE RECITM-CURSOR                                      24230000
242400     END-EXEC.                                                    24240000
242500                                                                  24250000
242600     EVALUATE TRUE                                                24260000
242700       WHEN SQLCODE = ZERO                                        24270000
242800           CONTINUE                                               24280000
242900                                                                  24290000
243000       WHEN SQLWARN0 NOT = SPACES                                 24300000
243100       WHEN SQLCODE  NOT = ZERO                                   24310000
243200           MOVE DK-PO          TO PV-DISP-PO                      24320000
243300           MOVE DK-REC-SEQ-NBR TO PV-DISP-RCVR-SEQ-NBR            24330000
243400           MOVE DK-PACK-ID     TO PV-DISP-PACK-ID                 24340000
243500           MOVE SQLCODE        TO PV-DISPLAY-SQLCODE              24350000
243600           STRING   ' SUKUT702-6320-'                             24360000
243700                      ' CALLED BY-'                               24370000
243800                      SU035-PROGRAM-NAME                          24380000
243900                      '  SQLCODE='                                24390000
244000                      PV-DISPLAY-SQLCODE                          24400000
244100                      ' PO= '                                     24410000
244200                      PV-DISP-PO                                  24420000
244300                      ' RCV= '                                    24430000
244400                      PV-DISP-RCVR-SEQ-NBR                        24440000
244500                      ' PACK= '                                   24450000
244600                      PV-DISP-PACK-ID                             24460000
244700                      DELIMITED BY SIZE                           24470000
244800                                      INTO PV-CICS-MSG-AREA       24480000
244900           PERFORM 9999-WRITE-TO-CSSL                             24490000
245000           MOVE '6320-'                TO SU035-CRA-REQ-ID        24500000
245100           MOVE PV-CICS-MSG-AREA      TO SU035-CRA-RET-MSG        24510000
245200           PERFORM 9998-RETURN                                    24520000
245300     END-EVALUATE.                                                24530000
245400                                                                  24540000
245500 6330-GET-RECITMS.                                                24550000
245600                                                                  24560000
245700     PERFORM 6340-FETCH-RECITM.                                   24570000
245800                                                                  24580000
245900     IF PS-MORE-RECITM-YES                                        24590000
246000         IF PS-TRECDIS-ADD                                        24600000
246100             MOVE RECITM-ORD-LNE-NBR TO DK-PKSL-LNE-NBR           24610000
246200             MOVE RECDIS-STR-NBR     TO DK-STR-DEST-NBR           24620000
246300             PERFORM 6350-CHECK-FOR-EXISTING                      24630000
246400             IF PS-RECDIS-FOUND                                   24640000
246500                 CONTINUE                                         24650000
246600             ELSE                                                 24660000
246700                 INITIALIZE RC031-FIELDS                          24670000
246800                 MOVE RECITM-ORD-LNE-NBR TO RECDIS-ORD-LNE-NBR    24680000
246900                                            RC031-PO-LNE-NBR      24690000
247000                 PERFORM 6370-INSERT-RECDIS                       24700000
247100                 SET PS-BEFORE-ONLY-LOGGING TO TRUE               24710000
247200                 PERFORM 6600-ADD-TO-RECD-AUDIT-BEFORE            24720000
247300             END-IF                                               24730000
247400         ELSE                                                     24740000
247500             MOVE RECITM-ORD-LNE-NBR TO DK-PO-LNE-NBR             24750000
247600             PERFORM 6390-SELECT-TDISTDT                          24760000
247700             IF PS-NO-DISTDT-FOUND                                24770000
247800                 PERFORM 5930-INSERT-TDISTDT                      24780000
247900             END-IF                                               24790000
248000         END-IF                                                   24800000
248100     END-IF.                                                      24810000
248200                                                                  24820000
248300 6340-FETCH-RECITM.                                               24830000
248400                                                                  24840000
248500     EXEC SQL                                                     24850000
248600         FETCH  RECITM-CURSOR                                     24860000
248700          INTO :RECITM-ORD-LNE-NBR                                24870000
248800           ,   :RECITM-PREPK-RATO-QTY                             24880000
248900     END-EXEC.                                                    24890000
249000                                                                  24900000
249100     EVALUATE TRUE                                                24910000
249200       WHEN SQLCODE = ZERO                                        24920000
249300           CONTINUE                                               24930000
249400                                                                  24940000
249500       WHEN SQLCODE = +100                                        24950000
249600           SET PS-MORE-RECITM-NO TO TRUE                          24960000
249700                                                                  24970000
249800       WHEN SQLWARN0 NOT = SPACES                                 24980000
249900       WHEN SQLCODE  NOT = ZERO                                   24990000
250000           MOVE DK-PO          TO PV-DISP-PO                      25000000
250100           MOVE DK-REC-SEQ-NBR TO PV-DISP-RCVR-SEQ-NBR            25010000
250200           MOVE DK-PACK-ID     TO PV-DISP-PACK-ID                 25020000
250300           MOVE SQLCODE        TO PV-DISPLAY-SQLCODE              25030000
250400           STRING   ' SUKUT702-6340-'                             25040000
250500                      ' CALLED BY-'                               25050000
250600                      SU035-PROGRAM-NAME                          25060000
250700                      '  SQLCODE='                                25070000
250800                      PV-DISPLAY-SQLCODE                          25080000
250900                      ' PO= '                                     25090000
251000                      PV-DISP-PO                                  25100000
251100                      ' RCV= '                                    25110000
251200                      PV-DISP-RCVR-SEQ-NBR                        25120000
251300                      ' PACK= '                                   25130000
251400                      PV-DISP-PACK-ID                             25140000
251500                      DELIMITED BY SIZE                           25150000
251600                                      INTO PV-CICS-MSG-AREA       25160000
251700           PERFORM 9999-WRITE-TO-CSSL                             25170000
251800           MOVE '6340-'                TO SU035-CRA-REQ-ID        25180000
251900           MOVE PV-CICS-MSG-AREA      TO SU035-CRA-RET-MSG        25190000
252000           PERFORM 9998-RETURN                                    25200000
252100     END-EVALUATE.                                                25210000
252200                                                                  25220000
252300 6350-CHECK-FOR-EXISTING.                                         25230000
252400                                                                  25240000
252500     EXEC SQL                                                     25250000
252600         SELECT STR_NBR                                           25260000
252700          INTO  :RECDIS-STR-NBR                                   25270000
252800           FROM TRECDIS                                           25280000
252900          WHERE ORD_NBR        = :DK-PO                           25290000
253000            AND ORD_LNE_NBR    = :DK-PKSL-LNE-NBR                 25300000
253100            AND REC_SEQ_NBR    = :DK-REC-SEQ-NBR                  25310000
253200            AND STR_NBR        = :DK-STR-DEST-NBR                 25320000
253300            AND STR_FCLTY_ID   = 1                                25330000
253500     END-EXEC.                                                    25350000
253600                                                                  25360000
253700     EVALUATE TRUE                                                25370000
253800       WHEN SQLCODE = ZERO                                        25380000
253900           SET PS-RECDIS-FOUND TO TRUE                            25390000
254000                                                                  25400000
254100       WHEN SQLCODE = +100                                        25410000
254200           SET PS-RECDIS-NOT-FOUND TO TRUE                        25420000
254300                                                                  25430000
254400       WHEN SQLWARN0 NOT = SPACES                                 25440000
254500       WHEN SQLCODE  NOT = ZERO                                   25450000
254600           MOVE DK-PO          TO PV-DISP-PO                      25460000
254700           MOVE DK-REC-SEQ-NBR TO PV-DISP-RCVR-SEQ-NBR            25470000
254800           MOVE DK-PKSL-LNE-NBR                                   25480000
254900                               TO PV-DISP-PO-LNE-NBR              25490000
255000           MOVE DK-STR-DEST-NBR                                   25500000
255100                               TO PV-DISP-STR-NBR                 25510000
255200           MOVE SQLCODE        TO PV-DISPLAY-SQLCODE              25520000
255300           STRING   ' SUKUT702-6350-'                             25530000
255400                      ' CALLED BY-'                               25540000
255500                      SU035-PROGRAM-NAME                          25550000
255600                      '  SQLCODE='                                25560000
255700                      PV-DISPLAY-SQLCODE                          25570000
255800                      ' PO= '                                     25580000
255900                      PV-DISP-PO                                  25590000
256000                      ' RCV= '                                    25600000
256100                      PV-DISP-RCVR-SEQ-NBR                        25610000
256200                      ' LINE= '                                   25620000
256300                      PV-DISP-PO-LNE-NBR                          25630000
256400                      ' STR= '                                    25640000
256500                      PV-DISP-STR-NBR                             25650000
256600                      DELIMITED BY SIZE                           25660000
256700                                      INTO PV-CICS-MSG-AREA       25670000
256800           PERFORM 9999-WRITE-TO-CSSL                             25680000
256900           MOVE '6350-'                TO SU035-CRA-REQ-ID        25690000
257000           MOVE PV-CICS-MSG-AREA      TO SU035-CRA-RET-MSG        25700000
257100           PERFORM 9998-RETURN                                    25710000
257200     END-EVALUATE.                                                25720000
257300                                                                  25730000
257400                                                                  25740000
257500 6370-INSERT-RECDIS.                                              25750000
257600     EXEC SQL                                                     25760000
257700         INSERT INTO TRECDIS                                      25770000
257800         (   ORD_NBR                                              25780000
257900          ,  ORD_LNE_NBR                                          25790000
258000          ,  REC_SEQ_NBR                                          25800000
258100          ,  OPER_UNT_ID                                          25810000
258200          ,  FCLTY_ID                                             25820000
258300          ,  CRE_TMST                                             25830000
258400          ,  CRE_UID                                              25840000
258500          ,  VER_STATUS_CDE                                       25850000
258600          ,  EXPTED_ITM_QTY                                       25860000
258700          ,  VERIFY_ITM_QTY                                       25870000
258800          ,  AP_VERIFY_ITM_QTY                                    25880000
258900          ,  STR_NBR                                              25890000
259000          ,  STR_FCLTY_ID                                         25900000
259100          ,  PLAN_ITM_QTY                                         25910000
259200          ,  AP_PRC_CDE                                           25920000
259300          ,  AP_PRC_DTE)                                          25930000
259400         VALUES                                                   25940000
259500         (   :DK-PO                                               25950000
259600          ,  :RECDIS-ORD-LNE-NBR                                  25960000
259700          ,  :DK-REC-SEQ-NBR                                      25970000
259800          ,  :DK-OPER-UNT-ID                                      25980000
259900          ,  :DK-FCLTY-ID                                         25990000
260000          ,  CURRENT TIMESTAMP                                    26000000
260100          ,  :SU035-CREATE-USER-ID                                26010000
260200          ,  :RECDIS-VER-STATUS-CDE                               26020000
260300          ,  :RECDIS-EXPTED-ITM-QTY                               26030000
260400          ,  :RECDIS-VERIFY-ITM-QTY                               26040000
260500          ,  :RECDIS-AP-VERIFY-ITM-QTY                            26050000
260600          ,  :RECDIS-STR-NBR                                      26060000
260700          ,  :RECDIS-STR-FCLTY-ID                                 26070000
260800          ,  :RECDIS-PLAN-ITM-QTY                                 26080000
260900          ,  :RECDIS-AP-PRC-CDE                                   26090000
261000          ,  :RECDIS-AP-PRC-DTE)                                  26100000
261100     END-EXEC.                                                    26110000
261200                                                                  26120000
261300     EVALUATE TRUE                                                26130000
261400         WHEN SQLCODE = +0                                        26140000
261500             CONTINUE                                             26150000
261600         WHEN SQLWARN0 NOT = SPACES                               26160000
261700         WHEN SQLCODE < +0                                        26170000
261800         WHEN SQLCODE > +0                                        26180000
261900             SET PS-ERROR                                         26190000
262000                 SU035-INVALID-SQL    TO TRUE                     26200000
262100             MOVE DK-PO               TO PV-DISP-PO               26210000
262200             MOVE DK-PO-LNE-NBR       TO PV-DISP-PO-LNE-NBR       26220000
262300             MOVE DK-REC-SEQ-NBR      TO PV-DISP-RCVR-SEQ-NBR     26230000
262400             MOVE DK-OPER-UNT-ID      TO PV-DISP-OPER-UNT-ID      26240000
262500             MOVE RECDIS-STR-NBR      TO PV-DISP-STR-NBR          26250000
262600             MOVE  SQLCODE            TO PV-DISPLAY-SQLCODE       26260000
262700             STRING   ' SUKUT702-6370-'                           26270000
262800                      ' CALLED BY-'                               26280000
262900                      SU035-PROGRAM-NAME                          26290000
263000                      '  SQLCODE='                                26300000
263100                      PV-DISPLAY-SQLCODE                          26310000
263200                      ' PO='                                      26320000
263300                      PV-DISP-PO                                  26330000
263400                      ' LNE='                                     26340000
263500                      PV-DISP-PO-LNE-NBR                          26350000
263600                      ' RCV='                                     26360000
263700                      PV-DISP-RCVR-SEQ-NBR                        26370000
263800                      ' STR='                                     26380000
263900                      PV-DISP-STR-NBR                             26390000
264000                      ' OP='                                      26400000
264100                      PV-DISP-OPER-UNT-ID                         26410000
264200                      DELIMITED BY SIZE                           26420000
264300                                      INTO PV-CICS-MSG-AREA       26430000
264400             PERFORM 9999-WRITE-TO-CSSL                           26440000
264500             MOVE '6370-'                TO SU035-CRA-REQ-ID      26450000
264600             MOVE PV-CICS-MSG-AREA      TO SU035-CRA-RET-MSG      26460000
264700             PERFORM 9998-RETURN                                  26470000
264800     END-EVALUATE.                                                26480000
264900                                                                  26490000
265000 6390-SELECT-TDISTDT.                                             26500000
265100                                                                  26510000
265200     EXEC SQL                                                     26520000
265300          SELECT  ACTL_ALLOC_QTY                                  26530000
265400                , P2L_SPLT_UNT_QTY                                26540000
265500                , FCSE_SPLT_UNT_QTY                               26550000
265600                , INPK_SPLT_UNT_QTY                               26560000
265700                , FCSE_ACTL_UNT_QTY                               26570000
265800                , PREPK_ODD_UNT_QTY                               26580000
265900            INTO  :DISTDT-ACTL-ALLOC-QTY                          26590000
266000                , :DISTDT-P2L-SPLT-UNT-QTY                        26600000
266100                , :DISTDT-FCSE-SPLT-UNT-QTY                       26610000
266200                , :DISTDT-INPK-SPLT-UNT-QTY                       26620000
266300                , :DISTDT-FCSE-ACTL-UNT-QTY                       26630000
266400                , :DISTDT-PREPK-ODD-UNT-QTY                       26640000
266500            FROM                                                  26650000
266600                  TDISTDT                                         26660000
266700            WHERE                                                 26670000
266800                  ORD_NBR          = :DK-PO                       26680000
266900              AND RCVR_SEQ_NBR     = :DK-REC-SEQ-NBR              26690000
267000              AND ORD_LNE_NBR      = :DK-PO-LNE-NBR               26700000
267100              AND STR_NBR          = :DK-STR-NBR                  26710000
267200     END-EXEC.                                                    26720000
267300                                                                  26730000
267400     EVALUATE TRUE                                                26740000
267500         WHEN SQLCODE = ZERO                                      26750000
267600              SET PS-DISTDT-FOUND TO TRUE                         26760000
267700         WHEN SQLCODE = +100                                      26770000
267800              SET PS-NO-DISTDT-FOUND TO TRUE                      26780000
267900         WHEN SQLWARN0 NOT = SPACES                               26790000
268000         WHEN SQLCODE  NOT = ZERO                                 26800000
268100             SET SU035-INVALID-SQL     TO TRUE                    26810000
268200             SET PS-NO-AUTO-APPLY TO TRUE                         26820000
268300             MOVE DK-PO           TO  PV-DISP-PO                  26830000
268400             MOVE DK-REC-SEQ-NBR      TO PV-DISP-RCVR-SEQ-NBR     26840000
268500             MOVE DK-PO-LNE-NBR       TO PV-DISP-PO-LNE-NBR       26850000
268600             MOVE DK-STR-NBR          TO PV-DISP-STR-NBR          26860000
268700             STRING   ' SUKUT702-6390-'                           26870000
268800                      ' CALLED BY-'                               26880000
268900                      SU035-PROGRAM-NAME                          26890000
269000                      ' PO='                                      26900000
269100                      PV-DISP-PO                                  26910000
269200                      ' RCVR='                                    26920000
269300                      PV-DISP-RCVR-SEQ-NBR                        26930000
269400                      ' LINE='                                    26940000
269500                      PV-DISP-PO-LNE-NBR                          26950000
269600                      ' STR ='                                    26960000
269700                      PV-DISP-STR-NBR                             26970000
269800                      DELIMITED BY SIZE                           26980000
269900                                      INTO PV-CICS-MSG-AREA       26990000
270000             PERFORM 9999-WRITE-TO-CSSL                           27000000
270100             MOVE PV-CICS-MSG-AREA      TO SU035-CRA-RET-MSG      27010000
270200             SET SU035-UPDATE-ERROR TO TRUE                       27020000
270300     END-EVALUATE.                                                27030000
270400                                                                  27040000
270500 6400-UPDATE-TDISTDT.                                             27050000
270600     EXEC SQL                                                     27060000
270700       UPDATE TDISTDT                                             27070000
270800          SET ACTL_ALLOC_QTY     = :DISTDT-ACTL-ALLOC-QTY         27080000
270900        WHERE ORD_NBR            = :DK-PO                         27090000
271000          AND ORD_LNE_NBR        = :DK-PO-LNE-NBR                 27100000
271100          AND RCVR_SEQ_NBR       = :DK-REC-SEQ-NBR                27110000
271200          AND STR_NBR            = :DK-STR-NBR                    27120000
271300     END-EXEC.                                                    27130000
271400                                                                  27140000
271500     EVALUATE TRUE                                                27150000
271600         WHEN SQLCODE = +0                                        27160000
271700             CONTINUE                                             27170000
271800         WHEN SQLWARN0 NOT = SPACES                               27180000
271900         WHEN SQLCODE < +0                                        27190000
272000         WHEN SQLCODE > +0                                        27200000
272100             SET PS-ERROR                                         27210000
272200                 SU035-INVALID-SQL    TO TRUE                     27220000
272300             MOVE DK-PO               TO PV-DISP-PO               27230000
272400             MOVE DK-REC-SEQ-NBR      TO PV-DISP-RCVR-SEQ-NBR     27240000
272500             MOVE DK-PO-LNE-NBR       TO PV-DISP-PO-LNE-NBR       27250000
272600             MOVE RECDIS-STR-NBR      TO PV-DISP-STR-NBR          27260000
272700             MOVE  SQLCODE            TO PV-DISPLAY-SQLCODE       27270000
272800             STRING   ' SUKUT702-6400-'                           27280000
272900                      ' CALLED BY-'                               27290000
273000                      SU035-PROGRAM-NAME                          27300000
273100                      '  SQLCODE='                                27310000
273200                      PV-DISPLAY-SQLCODE                          27320000
273300                      ' PO='                                      27330000
273400                      PV-DISP-PO                                  27340000
273500                      ' RCV='                                     27350000
273600                      PV-DISP-RCVR-SEQ-NBR                        27360000
273700                      ' LNE='                                     27370000
273800                      PV-DISP-PO-LNE-NBR                          27380000
273900                      ' STR='                                     27390000
274000                      PV-DISP-STR-NBR                             27400000
274100                      DELIMITED BY SIZE                           27410000
274200                                      INTO PV-CICS-MSG-AREA       27420000
274300             PERFORM 9999-WRITE-TO-CSSL                           27430000
274400             MOVE '6400-'                TO SU035-CRA-REQ-ID      27440000
274500             MOVE PV-CICS-MSG-AREA      TO SU035-CRA-RET-MSG      27450000
274600             PERFORM 9998-RETURN                                  27460000
274700     END-EVALUATE.                                                27470000
274800                                                                  27480000
274900                                                                  27490000
275000 6500-UPDATE-TDISTDT.                                             27500000
275100                                                                  27510000
275200     EXEC SQL                                                     27520000
275300       UPDATE TDISTDT                                             27530000
275400          SET FCSE_ACTL_UNT_QTY  = :DISTDT-FCSE-ACTL-UNT-QTY      27540000
275500          ,   PREPK_ODD_UNT_QTY  = :DISTDT-PREPK-ODD-UNT-QTY      27550000
275600        WHERE ORD_NBR            = :DK-PO                         27560000
275700          AND ORD_LNE_NBR        = :DK-PO-LNE-NBR                 27570000
275800          AND RCVR_SEQ_NBR       = :DK-REC-SEQ-NBR                27580000
275900          AND STR_NBR            = :DK-STR-NBR                    27590000
276000     END-EXEC.                                                    27600000
276100                                                                  27610000
276200     EVALUATE TRUE                                                27620000
276300         WHEN SQLCODE = +0                                        27630000
276400             CONTINUE                                             27640000
276500         WHEN SQLWARN0 NOT = SPACES                               27650000
276600         WHEN SQLCODE < +0                                        27660000
276700         WHEN SQLCODE > +0                                        27670000
276800             SET PS-ERROR                                         27680000
276900                 SU035-INVALID-SQL    TO TRUE                     27690000
277000             MOVE DK-PO               TO PV-DISP-PO               27700000
277100             MOVE DK-REC-SEQ-NBR      TO PV-DISP-RCVR-SEQ-NBR     27710000
277200             MOVE DK-PO-LNE-NBR       TO PV-DISP-PO-LNE-NBR       27720000
277300             MOVE RECDIS-STR-NBR      TO PV-DISP-STR-NBR          27730000
277400             MOVE  SQLCODE            TO PV-DISPLAY-SQLCODE       27740000
277500             STRING   ' SUKUT702-6500-'                           27750000
277600                      ' CALLED BY-'                               27760000
277700                      SU035-PROGRAM-NAME                          27770000
277800                      '  SQLCODE='                                27780000
277900                      PV-DISPLAY-SQLCODE                          27790000
278000                      ' PO='                                      27800000
278100                      PV-DISP-PO                                  27810000
278200                      ' RCV='                                     27820000
278300                      PV-DISP-RCVR-SEQ-NBR                        27830000
278400                      ' LNE='                                     27840000
278500                      PV-DISP-PO-LNE-NBR                          27850000
278600                      ' STR='                                     27860000
278700                      PV-DISP-STR-NBR                             27870000
278800                      DELIMITED BY SIZE                           27880000
278900                                      INTO PV-CICS-MSG-AREA       27890000
279000             PERFORM 9999-WRITE-TO-CSSL                           27900000
279100             MOVE PV-CICS-MSG-AREA      TO SU035-CRA-RET-MSG      27910000
279200             MOVE '6500-'                TO SU035-CRA-REQ-ID      27920000
279300             PERFORM 9998-RETURN                                  27930000
279400     END-EVALUATE.                                                27940000
279500                                                                  27950000
279600 6600-ADD-TO-RECD-AUDIT-BEFORE.                                   27960000
279700     EXEC SQL                                                     27970000
279800          SET :PV-CURRENT-TIMESTAMP = CURRENT TIMESTAMP           27980000
279900     END-EXEC.                                                    27990000
280000     MOVE 'D'                     TO RC031-TABLE-TO-AUDIT.        28000000
280100     MOVE 'B'                     TO RC031-AUD-TYP-CDE.           28010000
280200     MOVE 'U'                     TO RC031-AUD-FUNC-CDE.          28020000
280300     MOVE DK-OPER-UNT-ID          TO RC031-OPER-UNT-ID.           28030000
280400     MOVE 1                       TO RC031-FCLTY-ID.              28040000
280500     MOVE SU035-PO                TO RC031-PO-NBR.                28050000
280600     MOVE SU035-REC-SEQ-NBR       TO RC031-REC-SEQ-NBR.           28060000
280700     MOVE SU035-DEST-LOC-NBR      TO RC031-STR-NBR.               28070000
280800     IF PS-BEFORE-ONLY-LOGGING                                    28080000
280900         MOVE PC-CURRENT-PROGRAM-NAME TO RC031-UPD-PGM-ID         28090000
281000     ELSE                                                         28100000
281100         MOVE PC-LOGGING-PROGRAM-NAME TO RC031-UPD-PGM-ID         28110000
281200     END-IF.                                                      28120000
281300     MOVE SU035-CREATE-USER-ID    TO RC031-UPD-UID.               28130000
281400     MOVE PV-CURRENT-TIMESTAMP    TO RC031-UPD-TMST.              28140000
281500     MOVE PV-NOTIF-NBR            TO RC031-NOTIF-NBR.             28150000
281600     MOVE PV-CYC-ADJ-NBR          TO RC031-ADJ-CYC-NBR.           28160000
281700                                                                  28170000
281800     EXEC CICS                                                    28180000
281900          LINK PROGRAM  (PC-AUDIT-RTN)                            28190000
282000          COMMAREA (RC031-FIELDS)                                 28200000
282100          LENGTH   (PC-AUDIT-RTN-LENGTH)                          28210000
282200     END-EXEC.                                                    28220000
282300                                                                  28230000
282400     EVALUATE TRUE                                                28240000
282500         WHEN RC031-CALL-SUCCESSFUL                               28250000
282600             CONTINUE                                             28260000
282700         WHEN OTHER                                               28270000
282800             STRING ' SUKUT702 - '      DELIMITED BY SIZE         28280000
282900                    ' 6600-ADD-TO-RECD-AUDIT-BEFORE'              28290000
283000                                        DELIMITED BY SIZE         28300000
283100                    'UNSUCCESSFUL CALL TO AUDIT RTN'              28310000
283200                                        DELIMITED BY SIZE         28320000
283300                    RC031-RETURN-CODE  DELIMITED BY SIZE          28330000
283400                    ' '                DELIMITED BY SIZE          28340000
283500                    RC031-RETURN-DESC  DELIMITED BY SIZE          28350000
283600                                  INTO PV-CICS-MSG-AREA           28360000
283700             PERFORM 9999-WRITE-TO-CSSL                           28370000
283800             SET SU035-INVALID-SQL     TO TRUE                    28380000
283900             MOVE PV-CICS-MSG-AREA      TO SU035-CRA-RET-MSG      28390000
284000             SET PS-NO-AUTO-APPLY TO TRUE                         28400000
284100             SET SU035-UPDATE-ERROR TO TRUE                       28410000
284200     END-EVALUATE.                                                28420000
284300                                                                  28430000
284400 6700-ADD-TRIGGER-AUDIT-BEFORE.                                   28440000
284500     INITIALIZE RC031-FIELDS.                                     28450000
284600                                                                  28460000
284700     EXEC SQL                                                     28470000
284800          SET :PV-CURRENT-TIMESTAMP = CURRENT TIMESTAMP           28480000
284900     END-EXEC.                                                    28490000
285000     MOVE 'D'                      TO RC031-TABLE-TO-AUDIT.       28500000
285100     MOVE 'B'                      TO RC031-AUD-TYP-CDE.          28510000
285200     MOVE 'T'                      TO RC031-AUD-FUNC-CDE.         28520000
285300     MOVE SU035-PO                 TO RC031-PO-NBR.               28530000
285400     MOVE SU035-PO-LNE-NBR         TO RC031-PO-LNE-NBR.           28540000
285500     MOVE SU035-REC-SEQ-NBR        TO RC031-REC-SEQ-NBR.          28550000
285600     MOVE DK-OPER-UNT-ID           TO RC031-OPER-UNT-ID.          28560000
285700     MOVE 1                        TO RC031-FCLTY-ID.             28570000
285800     MOVE SU035-DEST-LOC-NBR       TO RC031-STR-NBR.              28580000
285900     MOVE SU035-CREATE-USER-ID     TO RC031-UPD-UID.              28590000
286000     MOVE PC-CURRENT-PROGRAM-NAME  TO RC031-UPD-PGM-ID.           28600000
286100     MOVE PV-CURRENT-TIMESTAMP     TO RC031-UPD-TMST.             28610000
286200     MOVE PV-NOTIF-NBR             TO RC031-NOTIF-NBR.            28620000
286300     MOVE PV-CYC-ADJ-NBR           TO RC031-ADJ-CYC-NBR.          28630000
286400                                                                  28640000
286500     EXEC CICS                                                    28650000
286600         LINK PROGRAM  (PC-AUDIT-RTN)                             28660000
286700              COMMAREA (RC031-FIELDS)                             28670000
286800              LENGTH   (PC-AUDIT-RTN-LENGTH)                      28680000
286900     END-EXEC.                                                    28690000
287000     EVALUATE TRUE                                                28700000
287100         WHEN RC031-CALL-SUCCESSFUL                               28710000
287200             CONTINUE                                             28720000
287300                                                                  28730000
287400         WHEN OTHER                                               28740000
287500             STRING ' SUKUT702 - '      DELIMITED BY SIZE         28750000
287600                    '6700-ADD-TRIGGER-AUDIT-BEFORE'               28760000
287700                                        DELIMITED BY SIZE         28770000
287800                    'UNSUCCESSFUL CALL TO AUDIT RTN'              28780000
287900                                        DELIMITED BY SIZE         28790000
288000                    RC031-RETURN-CODE  DELIMITED BY SIZE          28800000
288100                    ' '                DELIMITED BY SIZE          28810000
288200                    RC031-RETURN-DESC  DELIMITED BY SIZE          28820000
288300                                 INTO PV-CICS-MSG-AREA            28830000
288400             PERFORM 9999-WRITE-TO-CSSL                           28840000
288500             SET SU035-INVALID-SQL     TO TRUE                    28850000
288600             MOVE PV-CICS-MSG-AREA      TO SU035-CRA-RET-MSG      28860000
288700             SET PS-NO-AUTO-APPLY TO TRUE                         28870000
288800             SET SU035-UPDATE-ERROR TO TRUE                       28880000
288900     END-EVALUATE.                                                28890000
289000                                                                  28900000
289100*   UPDATE RECEIVING AUDIT TABLES                                 28910000
289200                                                                  28920000
289300 6800-ADD-TO-RECD-AUDIT-AFTER.                                    28930000
289400                                                                  28940000
289500     INITIALIZE RC031-FIELDS.                                     28950000
289600     MOVE 'D'                      TO RC031-TABLE-TO-AUDIT.       28960000
289700     MOVE 'A'                      TO RC031-AUD-TYP-CDE.          28970000
289800     MOVE 'U'                      TO RC031-AUD-FUNC-CDE.         28980000
289900     MOVE SU035-PO                 TO RC031-PO-NBR.               28990000
290000     MOVE SU035-PO-LNE-NBR         TO RC031-PO-LNE-NBR.           29000000
290100     MOVE SU035-REC-SEQ-NBR        TO RC031-REC-SEQ-NBR.          29010000
290200     MOVE DK-OPER-UNT-ID           TO RC031-OPER-UNT-ID.          29020000
290300     MOVE 1                        TO RC031-FCLTY-ID.             29030000
290400     MOVE SU035-DEST-LOC-NBR       TO RC031-STR-NBR.              29040000
290500     MOVE SU035-CREATE-USER-ID     TO RC031-UPD-UID.              29050000
290600     MOVE PC-LOGGING-PROGRAM-NAME  TO RC031-UPD-PGM-ID            29060000
290700     MOVE PV-CURRENT-TIMESTAMP     TO RC031-UPD-TMST.             29070000
290800     MOVE PV-NOTIF-NBR             TO RC031-NOTIF-NBR.            29080000
290900     MOVE PV-CYC-ADJ-NBR           TO RC031-ADJ-CYC-NBR.          29090000
291000                                                                  29100000
291100     EXEC CICS                                                    29110000
291200         LINK PROGRAM  (PC-AUDIT-RTN)                             29120000
291300              COMMAREA (RC031-FIELDS)                             29130000
291400              LENGTH   (PC-AUDIT-RTN-LENGTH)                      29140000
291500     END-EXEC.                                                    29150000
291600     EVALUATE TRUE                                                29160000
291700         WHEN RC031-CALL-SUCCESSFUL                               29170000
291800             CONTINUE                                             29180000
291900                                                                  29190000
292000         WHEN OTHER                                               29200000
292100             STRING ' SUKUT702 - '      DELIMITED BY SIZE         29210000
292200                    '6800-ADD-TO-RECD-AUDIT-AFTER'                29220000
292300                                        DELIMITED BY SIZE         29230000
292400                    'UNSUCCESSFUL CALL TO AUDIT RTN'              29240000
292500                                        DELIMITED BY SIZE         29250000
292600                    RC031-RETURN-CODE  DELIMITED BY SIZE          29260000
292700                    ' '                DELIMITED BY SIZE          29270000
292800                    RC031-RETURN-DESC  DELIMITED BY SIZE          29280000
292900                                 INTO PV-CICS-MSG-AREA            29290000
293000             PERFORM 9999-WRITE-TO-CSSL                           29300000
293100             SET SU035-INVALID-SQL     TO TRUE                    29310000
293200             MOVE PV-CICS-MSG-AREA      TO SU035-CRA-RET-MSG      29320000
293300             SET PS-NO-AUTO-APPLY TO TRUE                         29330000
293400             SET SU035-UPDATE-ERROR TO TRUE                       29340000
293500     END-EVALUATE.                                                29350000
293600                                                                  29360000
293700 6900-GET-TRECITM-DATA.                                           29370000
293800     MOVE 1                           TO DK-FCLTY-ID.             29380000
293900                                                                  29390000
294000     EXEC SQL                                                     29400000
294100           SELECT PREPK_ID                                        29410000
294200             INTO :RECITM-PREPK-ID                                29420000
294300             FROM TRECITM                                         29430000
294400            WHERE ORD_NBR            = :DK-PO                     29440000
294500              AND ORD_LNE_NBR        = :DK-PO-LNE-NBR             29450000
294600              AND REC_SEQ_NBR        = :DK-REC-SEQ-NBR            29460000
294700              AND VER_STATUS_CDE     = 'A'                        29470000
294800     END-EXEC.                                                    29480000
294900                                                                  29490000
295000     EVALUATE TRUE                                                29500000
295100         WHEN SQLCODE = ZERO                                      29510000
295200         WHEN SQLCODE = +100                                      29520000
295300              CONTINUE                                            29530000
295400         WHEN SQLWARN0 NOT = SPACES                               29540000
295500         WHEN SQLCODE < +0                                        29550000
295600         WHEN SQLCODE > +0                                        29560000
295700             SET PS-ERROR                                         29570000
295800                 SU035-INVALID-SQL    TO TRUE                     29580000
295900             MOVE DK-PO               TO PV-DISP-PO               29590000
296000             MOVE DK-REC-SEQ-NBR      TO PV-DISP-RCVR-SEQ-NBR     29600000
296100             MOVE DK-PO-LNE-NBR       TO PV-DISP-PO-LNE-NBR       29610000
296200             MOVE  SQLCODE            TO PV-DISPLAY-SQLCODE       29620000
296300             STRING   ' SUKUT702-6900-'                           29630000
296400                      ' CALLED BY-'                               29640000
296500                      SU035-PROGRAM-NAME                          29650000
296600                      '  SQLCODE='                                29660000
296700                      PV-DISPLAY-SQLCODE                          29670000
296800                      ' PO='                                      29680000
296900                      PV-DISP-PO                                  29690000
297000                      ' RCV='                                     29700000
297100                      PV-DISP-RCVR-SEQ-NBR                        29710000
297200                      ' LNE='                                     29720000
297300                      PV-DISP-PO-LNE-NBR                          29730000
297400                      DELIMITED BY SIZE                           29740000
297500                                      INTO PV-CICS-MSG-AREA       29750000
297600             PERFORM 9999-WRITE-TO-CSSL                           29760000
297700             MOVE '6900-'                TO SU035-CRA-REQ-ID      29770000
297800             MOVE PV-CICS-MSG-AREA      TO SU035-CRA-RET-MSG      29780000
297900             PERFORM 9998-RETURN                                  29790000
298000     END-EVALUATE.                                                29800000
298100                                                                  29810000
298200 7000-LOOK-FOR-TROUBLE.                                           29820000
298300                                                                  29830000
298400     EXEC SQL                                                     29840000
298500         SELECT A.NOTIF_NBR                                       29850000
298600         INTO :TRBNTF-NOTIF-NBR                                   29860000
298700         FROM  TTRBNTF A                                          29870000
298800              ,TTRBRSN B                                          29880000
298900         WHERE  A.PO_NBR           =   :DK-PO                     29890000
299000         AND    A.REC_SEQ_NBR      =   :DK-REC-SEQ-NBR            29900000
299100         AND  ((A.PO_LNE_NBR       =   :DK-PO-LNE-NBR             29910000
299200         AND    B.TRBL_LVL_IND      <> 'M')                       29920000
299300         OR    (A.PREPK_ID         =   :RECITM-PREPK-ID           29930000
299400         AND    B.TRBL_LVL_IND      =  'M'))                      29940000
299500         AND    A.RESOLVED_IND     IN ('N', 'I')                  29950000
299600         AND    A.TRBL_RSN_CDE     =    B.TRBL_RSN_CDE            29960000
299700         AND    B.PO_UPD_IND       =   'A'                        29970000
299800     END-EXEC                                                     29980000
299900                                                                  29990000
300000     EVALUATE TRUE                                                30000000
300100         WHEN SQLCODE = ZERO                                      30010000
300200             SET PS-TRBL-EXISTS           TO TRUE                 30020000
300300         WHEN SQLCODE = -811                                      30030000
300400         WHEN SQLCODE = +100                                      30040000
300500             SET PS-NO-TRBL-EXISTS        TO TRUE                 30050000
300600         WHEN SQLWARN0 NOT = SPACES                               30060000
300700         WHEN SQLCODE < +0                                        30070000
300800         WHEN SQLCODE > +0                                        30080000
300900             SET PS-ERROR                                         30090000
301000                 SU035-INVALID-SQL    TO TRUE                     30100000
301100             MOVE DK-PO               TO PV-DISP-PO               30110000
301200             MOVE DK-REC-SEQ-NBR      TO PV-DISP-RCVR-SEQ-NBR     30120000
301300             MOVE DK-PO-LNE-NBR       TO PV-DISP-PO-LNE-NBR       30130000
301400             MOVE RECITM-PREPK-ID     TO PV-DISP-STR-NBR          30140000
301500             MOVE  SQLCODE            TO PV-DISPLAY-SQLCODE       30150000
301600             STRING   ' SUKUT702-7000-'                           30160000
301700                      ' CALLED BY-'                               30170000
301800                      SU035-PROGRAM-NAME                          30180000
301900                      '  SQLCODE='                                30190000
302000                      PV-DISPLAY-SQLCODE                          30200000
302100                      ' PO='                                      30210000
302200                      PV-DISP-PO                                  30220000
302300                      ' RCV='                                     30230000
302400                      PV-DISP-RCVR-SEQ-NBR                        30240000
302500                      ' LNE='                                     30250000
302600                      PV-DISP-PO-LNE-NBR                          30260000
302700                      ' STR='                                     30270000
302800                      PV-DISP-STR-NBR                             30280000
302900                      DELIMITED BY SIZE                           30290000
303000                                      INTO PV-CICS-MSG-AREA       30300000
303100             PERFORM 9999-WRITE-TO-CSSL                           30310000
303200             MOVE '7000-'                TO SU035-CRA-REQ-ID      30320000
303300             MOVE PV-CICS-MSG-AREA      TO SU035-CRA-RET-MSG      30330000
303400             PERFORM 9998-RETURN                                  30340000
303500     END-EVALUATE.                                                30350000
303600                                                                  30360000
303700 7100-CHECK-FOR-LOGGING.                                          30370000
303800                                                                  30380000
303900     EXEC SQL                                                     30390000
304000          SELECT FUNC_TXT                                         30400000
304100            INTO :KRPRPM-FUNC-TXT                                 30410000
304200            FROM TKRPRPM                                          30420000
304300           WHERE LOC_ID            = :DK-OPER-UNT-ID              30430000
304400             AND INTFC_SYS_CDE    = 'KHL'                         30440000
304500             AND SYS_PRC_FUNC_CDE = 'SU702D'                      30450000
304600             AND FUNC_PRC_STAT_CDE = 'AC'                         30460000
304700     END-EXEC.                                                    30470000
304800                                                                  30480000
304900     EVALUATE TRUE                                                30490000
305000         WHEN SQLCODE = ZERO                                      30500000
305100             IF KRPRPM-FUNC-TXT = 'Y'                             30510000
305200                 SET PS-LOG-MESSAGE  TO TRUE                      30520000
305300             ELSE                                                 30530000
305400                 SET PS-NO-LOG-MESSAGE  TO TRUE                   30540000
305500             END-IF                                               30550000
305600         WHEN SQLCODE = +100                                      30560000
305700             SET PS-NO-LOG-MESSAGE  TO TRUE                       30570000
305800         WHEN SQLWARN0 NOT = SPACES                               30580000
305900         WHEN SQLCODE NOT EQUAL ZERO                              30590000
306000             SET PS-ERROR                                         30600000
306100                 SU035-INVALID-SQL    TO TRUE                     30610000
306200             MOVE  SQLCODE            TO PV-DISPLAY-SQLCODE       30620000
306300             STRING   ' SUKUT702-7100-'                           30630000
306400                      ' CALLED BY-'                               30640000
306500                      SU035-PROGRAM-NAME                          30650000
306600                      '  SQLCODE='                                30660000
306700                      PV-DISPLAY-SQLCODE                          30670000
306800                      ' '                                         30680000
306900                      DELIMITED BY SIZE                           30690000
307000                                      INTO PV-CICS-MSG-AREA       30700000
307100             PERFORM 9999-WRITE-TO-CSSL                           30710000
307200             MOVE '7100-'                TO SU035-CRA-REQ-ID      30720000
307300             MOVE PV-CICS-MSG-AREA      TO SU035-CRA-RET-MSG      30730000
307400             SET SU035-INVALID-SQL TO TRUE                        30740000
307500             PERFORM 9998-RETURN                                  30750000
307600     END-EVALUATE.                                                30760000
307700                                                                  30770000
307800                                                                  30780000
307900 7200-UPDATE-ODD-REC.                                             30790000
308000                                                                  30800000
308100     PERFORM 7400-SELECT-ODD-UNITS.                               30810000
308200                                                                  30820000
308300     IF RECITM-STATUS-CDE = 'VE'                                  30830000
308400         IF PS-POST-VERIFIED-STATUS                               30840000
308500             CONTINUE                                             30850000
308600         ELSE                                                     30860000
308700             COMPUTE RCT00009-DC-VRFY-ODU-QTY =                   30870000
308800                    (RCT00009-DC-VRFY-ODU-QTY +                   30880000
308900                    (SU035-AFTER-ODD-UNT-QTY  -                   30890000
309000                     SU035-BEFORE-ODD-UNT-QTY))                   30900000
309100*            MOVE SU035-AFTER-ODD-UNT-QTY                         30910000
309200*                                     TO RCT00009-DC-VRFY-ODU-QTY 30920000
309300         END-IF                                                   30930000
309400         COMPUTE RCT00009-AP-VRFY-ODU-QTY =                       30940000
309500                (RCT00009-AP-VRFY-ODU-QTY +                       30950000
309600                (SU035-AFTER-ODD-UNT-QTY  -                       30960000
309700                 SU035-BEFORE-ODD-UNT-QTY))                       30970000
309800*        MOVE SU035-AFTER-ODD-UNT-QTY TO                          30980000
309900*                                        RCT00009-AP-VRFY-ODU-QTY 30990000
310000     ELSE                                                         31000000
310100         COMPUTE RCT00009-DC-VRFY-ODU-QTY =                       31010000
310200                (RCT00009-DC-VRFY-ODU-QTY +                       31020000
310300                (SU035-AFTER-ODD-UNT-QTY  -                       31030000
310400                 SU035-BEFORE-ODD-UNT-QTY))                       31040000
310500*        MOVE SU035-AFTER-ODD-UNT-QTY TO RCT00009-DC-VRFY-ODU-QTY 31050000
310600         MOVE 0                       TO RCT00009-AP-VRFY-ODU-QTY 31060000
310700     END-IF.                                                      31070000
310800                                                                  31080000
310900     EXEC SQL                                                     31090000
311000          UPDATE RCT_VRFD_ODD_UNT                                 31100000
311100          SET    DC_VRFY_ODU_QTY     = :RCT00009-DC-VRFY-ODU-QTY  31110000
311200             ,   AP_VRFY_ODU_QTY     = :RCT00009-AP-VRFY-ODU-QTY  31120000
311300          WHERE                                                   31130000
311400                PO_NBR           =  :DK-PO                        31140000
311500           AND  PO_LNE_NBR       =  :DK-PO-LNE-NBR                31150000
311600           AND  RCVR_SEQ_NBR     =  :DK-REC-SEQ-NBR               31160000
311700           AND  STR_NBR          =  :RECDIS-STR-NBR               31170000
311800     END-EXEC.                                                    31180000
311900                                                                  31190000
312000     EVALUATE TRUE                                                31200000
312100         WHEN SQLCODE = ZERO                                      31210000
312200             CONTINUE                                             31220000
312300         WHEN SQLCODE = +100                                      31230000
312400              PERFORM 7300-INSERT-ODD-REC                         31240000
312500         WHEN SQLWARN0 NOT = SPACES                               31250000
312600         WHEN SQLCODE NOT EQUAL ZERO                              31260000
312700             SET PS-ERROR                                         31270000
312800                 SU035-INVALID-SQL    TO TRUE                     31280000
312900             MOVE  SQLCODE            TO PV-DISPLAY-SQLCODE       31290000
313000             MOVE DK-PO            TO PV-DISP-PO                  31300000
313100             MOVE DK-REC-SEQ-NBR   TO PV-DISP-RCVR-SEQ-NBR        31310000
313200             MOVE DK-PO-LNE-NBR    TO PV-DISP-PO-LNE-NBR          31320000
313300             MOVE RECDIS-STR-NBR   TO PV-DISP-STR-NBR             31330000
313400             STRING   ' SUKUT702-7200-'                           31340000
313500                      ' CALLED BY-'                               31350000
313600                      SU035-PROGRAM-NAME                          31360000
313700                      '  SQLCODE='                                31370000
313800                      PV-DISPLAY-SQLCODE                          31380000
313900                      ' PO = '                                    31390000
314000                      PV-DISP-PO                                  31400000
314100                      ' RECV ='                                   31410000
314200                      PV-DISP-RCVR-SEQ-NBR                        31420000
314300                      ' LINE ='                                   31430000
314400                      PV-DISP-PO-LNE-NBR                          31440000
314500                      ' STORE = '                                 31450000
314600                      PV-DISP-STR-NBR                             31460000
314700                                         DELIMITED BY SIZE        31470000
314800                                      INTO PV-CICS-MSG-AREA       31480000
314900             PERFORM 9999-WRITE-TO-CSSL                           31490000
315000             MOVE '7200-'               TO SU035-CRA-REQ-ID       31500000
315100             MOVE PV-CICS-MSG-AREA      TO SU035-CRA-RET-MSG      31510000
315200             SET SU035-INVALID-SQL TO TRUE                        31520000
315300             PERFORM 9998-RETURN                                  31530000
315400     END-EVALUATE.                                                31540000
315500                                                                  31550000
315600                                                                  31560000
315700 7300-INSERT-ODD-REC.                                             31570000
315800     EXEC SQL INSERT                                              31580000
315900          INTO  RCT_VRFD_ODD_UNT                                  31590000
316000               (PO_NBR                                            31600000
316100             ,  PO_LNE_NBR                                        31610000
316200             ,  RCVR_SEQ_NBR                                      31620000
316300             ,  STR_NBR                                           31630000
316400             ,  DC_VRFY_ODU_QTY                                   31640000
316500             ,  AP_VRFY_ODU_QTY)                                  31650000
316600          VALUES                                                  31660000
316700               (:DK-PO                                            31670000
316800             ,  :DK-PO-LNE-NBR                                    31680000
316900             ,  :DK-REC-SEQ-NBR                                   31690000
317000             ,  :RECDIS-STR-NBR                                   31700000
317100             ,  :RCT00009-DC-VRFY-ODU-QTY                         31710000
317200             ,  :RCT00009-AP-VRFY-ODU-QTY)                        31720000
317300     END-EXEC.                                                    31730000
317400                                                                  31740000
317500     EVALUATE TRUE                                                31750000
317600         WHEN SQLCODE = ZERO                                      31760000
317700              CONTINUE                                            31770000
317800         WHEN SQLWARN0 NOT = SPACE                                31780000
317900         WHEN SQLCODE NOT = ZERO                                  31790000
318000             SET PS-ERROR                                         31800000
318100                 SU035-INVALID-SQL    TO TRUE                     31810000
318200             MOVE  SQLCODE            TO PV-DISPLAY-SQLCODE       31820000
318300             MOVE DK-PO            TO PV-DISP-PO                  31830000
318400             MOVE DK-REC-SEQ-NBR   TO PV-DISP-RCVR-SEQ-NBR        31840000
318500             MOVE DK-PO-LNE-NBR    TO PV-DISP-PO-LNE-NBR          31850000
318600             MOVE DK-STR-NBR       TO PV-DISP-STR-NBR             31860000
318700             STRING   ' SUKUT702-7300-'                           31870000
318800                      ' CALLED BY-'                               31880000
318900                      SU035-PROGRAM-NAME                          31890000
319000                      '  SQLCODE='                                31900000
319100                      PV-DISPLAY-SQLCODE                          31910000
319200                      ' PO = '                                    31920000
319300                      PV-DISP-PO                                  31930000
319400                      ' RECV ='                                   31940000
319500                      PV-DISP-RCVR-SEQ-NBR                        31950000
319600                      ' LINE ='                                   31960000
319700                      PV-DISP-PO-LNE-NBR                          31970000
319800                      ' STORE = '                                 31980000
319900                      PV-DISP-STR-NBR                             31990000
320000                                         DELIMITED BY SIZE        32000000
320100                                      INTO PV-CICS-MSG-AREA       32010000
320200             PERFORM 9999-WRITE-TO-CSSL                           32020000
320300             MOVE '7300-'               TO SU035-CRA-REQ-ID       32030000
320400             MOVE PV-CICS-MSG-AREA      TO SU035-CRA-RET-MSG      32040000
320500             SET SU035-INVALID-SQL TO TRUE                        32050000
320600             PERFORM 9998-RETURN                                  32060000
320700     END-EVALUATE.                                                32070000
320800                                                                  32080000
320900 7400-SELECT-ODD-UNITS.                                           32090000
321000     MOVE 0   TO RCT00009-DC-VRFY-ODU-QTY                         32100000
321100                 RCT00009-AP-VRFY-ODU-QTY.                        32110000
321200                                                                  32120000
321300     EXEC SQL                                                     32130000
321400          SELECT                                                  32140000
321500                 SUM(DC_VRFY_ODU_QTY)                             32150000
321600             ,   SUM(AP_VRFY_ODU_QTY)                             32160000
321700          INTO                                                    32170000
321800                :RCT00009-DC-VRFY-ODU-QTY :PV-NULL-IND            32180000
321900             ,  :RCT00009-AP-VRFY-ODU-QTY :PV-NULL-IND            32190000
322000          FROM                                                    32200000
322100                 RCT_VRFD_ODD_UNT                                 32210000
322200          WHERE                                                   32220000
322300                PO_NBR           =  :DK-PO                        32230000
322400           AND  PO_LNE_NBR       =  :DK-PO-LNE-NBR                32240000
322500           AND  RCVR_SEQ_NBR     =  :DK-REC-SEQ-NBR               32250000
322600           AND  STR_NBR          =  :RECDIS-STR-NBR               32260000
322700     END-EXEC.                                                    32270000
322800                                                                  32280000
322900     EVALUATE TRUE                                                32290000
323000         WHEN SQLCODE = ZERO                                      32300000
323100              CONTINUE                                            32310000
323200         WHEN SQLWARN0 NOT = SPACE                                32320000
323300         WHEN SQLCODE NOT = ZERO                                  32330000
323400             SET PS-ERROR                                         32340000
323500                 SU035-INVALID-SQL    TO TRUE                     32350000
323600             MOVE  SQLCODE            TO PV-DISPLAY-SQLCODE       32360000
323700             MOVE DK-PO            TO PV-DISP-PO                  32370000
323800             MOVE DK-REC-SEQ-NBR   TO PV-DISP-RCVR-SEQ-NBR        32380000
323900             MOVE DK-PO-LNE-NBR    TO PV-DISP-PO-LNE-NBR          32390000
324000             MOVE DK-STR-NBR       TO PV-DISP-STR-NBR             32400000
324100             STRING   ' SUKUT702-7400-'                           32410000
324200                      ' CALLED BY-'                               32420000
324300                      SU035-PROGRAM-NAME                          32430000
324400                      '  SQLCODE='                                32440000
324500                      PV-DISPLAY-SQLCODE                          32450000
324600                      ' PO = '                                    32460000
324700                      PV-DISP-PO                                  32470000
324800                      ' RECV ='                                   32480000
324900                      PV-DISP-RCVR-SEQ-NBR                        32490000
325000                      ' LINE ='                                   32500000
325100                      PV-DISP-PO-LNE-NBR                          32510000
325200                      ' STORE = '                                 32520000
325300                      PV-DISP-STR-NBR                             32530000
325400                                         DELIMITED BY SIZE        32540000
325500                                      INTO PV-CICS-MSG-AREA       32550000
325600             PERFORM 9999-WRITE-TO-CSSL                           32560000
325700             MOVE '7400-'               TO SU035-CRA-REQ-ID       32570000
325800             MOVE PV-CICS-MSG-AREA      TO SU035-CRA-RET-MSG      32580000
325900             SET SU035-INVALID-SQL TO TRUE                        32590000
326000             PERFORM 9998-RETURN                                  32600000
326100     END-EVALUATE.                                                32610000
326200                                                                  32620000
326300 7500-CHECK-IF-SYSTEM-GEN.                                        32630000
326400                                                                  32640000
326500     MOVE SU035-ADJ-AUDIT-CNTL-NBR TO DK-AUDIT-CNTL-NBR.          32650000
326600                                                                  32660000
326700     EXEC SQL                                                     32670000
326800       SELECT AUD_CNTL_NBR                                        32680000
326900       INTO   :SUT00015-AUD-CNTL-NBR                              32690000
327000       FROM   SUT_PO_AUD_REQ                                      32700000
327100       WHERE  AUD_CNTL_NBR    =  :DK-AUDIT-CNTL-NBR               32710000
327200     END-EXEC.                                                    32720000
327300                                                                  32730000
327400     EVALUATE TRUE                                                32740000
327500         WHEN SQLCODE = ZERO                                      32750000
327600             SET PS-SYSTEM-AUDIT-FOUND TO TRUE                    32760000
327700                                                                  32770000
327800         WHEN SQLCODE = +100                                      32780000
327900             SET PS-SYSTEM-AUDIT-NOT-FOUND TO TRUE                32790000
328000                                                                  32800000
328100         WHEN OTHER                                               32810000
328200             SET PS-ERROR                                         32820000
328300                 SU035-INVALID-SQL    TO TRUE                     32830000
328400             MOVE DK-AUDIT-CNTL-NBR   TO PV-DISPLAY-AUDIT-CNTL-NBR32840000
328500             MOVE  SQLCODE            TO PV-DISPLAY-SQLCODE       32850000
328600             STRING   ' SUKUT702-7500-'                           32860000
328700                      ' CALLED BY-'                               32870000
328800                      SU035-PROGRAM-NAME                          32880000
328900                      '  SQLCODE='                                32890000
329000                      PV-DISPLAY-SQLCODE                          32900000
329100                      ' '                                         32910000
329200                      PV-DISPLAY-AUDIT-CNTL-NBR                   32920000
329300                      DELIMITED BY SIZE                           32930000
329400                                      INTO SU035-CRA-RET-MSG      32940000
329500             PERFORM 9999-WRITE-TO-CSSL                           32950000
329600             MOVE '7500-'                TO SU035-CRA-REQ-ID      32960000
329700             SET SU035-INVALID-SQL TO TRUE                        32970000
329800             PERFORM 9998-RETURN                                  32980000
329900     END-EVALUATE.                                                32990000
330000                                                                  33000000
330100 7600-SELECT-TSUNAUD-AUD-TYPE.                                    33010000
330200                                                                  33020000
330300     EXEC SQL                                                     33030000
330400         SELECT  AUD_TYP_CDE                                      33040000
330500           INTO  :SUNAUD-AUD-TYP-CDE                              33050000
330600           FROM  TSUNAUD                                          33060000
330700          WHERE  AUD_CNTL_NBR      =  :DK-AUDIT-CNTL-NBR          33070000
330800     END-EXEC.                                                    33080000
330900                                                                  33090000
331000     EVALUATE TRUE                                                33100000
331100        WHEN SQLCODE = ZERO                                       33110000
331200           CONTINUE                                               33120000
331300        WHEN OTHER                                                33130000
331400             SET PS-ERROR                                         33140000
331500                 SU035-INVALID-SQL    TO TRUE                     33150000
331600             MOVE DK-AUDIT-CNTL-NBR   TO PV-DISPLAY-AUDIT-CNTL-NBR33160000
331700             MOVE  SQLCODE            TO PV-DISPLAY-SQLCODE       33170000
331800             STRING   ' SUKUT702-7600-'                           33180000
331900                      ' CALLED BY-'                               33190000
332000                      SU035-PROGRAM-NAME                          33200000
332100                      '  SQLCODE='                                33210000
332200                      PV-DISPLAY-SQLCODE                          33220000
332300                      ' '                                         33230000
332400                      PV-DISPLAY-AUDIT-CNTL-NBR                   33240000
332500                      DELIMITED BY SIZE                           33250000
332600                                      INTO SU035-CRA-RET-MSG      33260000
332700             PERFORM 9999-WRITE-TO-CSSL                           33270000
332800             MOVE '7600-'                TO SU035-CRA-REQ-ID      33280000
332900             SET SU035-INVALID-SQL TO TRUE                        33290000
333000             PERFORM 9998-RETURN                                  33300000
333100     END-EVALUATE.                                                33310000
333200                                                                  33320000
333300******************************************************************33330000
333400* THIS PARAGRAPH WILL FORMAT ALL OF THE DATA NEEDED FOR THE      *33340000
333500* UNITS WORKED ROUTINE AND WILL THEN CALL THE ROUTINE AND        *33350000
333600* THE RESULTS RETURNED FROM THE ROUTINE. (PCKCS756)              *33360000
333700******************************************************************33370000
333800 8000-UNITS-WORK-ROUTINE.                                         33380000
333900     PERFORM 8600-RECEIV-PURITM-JOIN.                             33390000
334000                                                                  33400000
334100     MOVE  0                      TO PV-VRFY-ITEM.                33410000
334200                                                                  33420000
334300     EXEC SQL                                                     33430000
334400         SET :PV-TMST =  CURRENT_TIMESTAMP                        33440000
334500     END-EXEC                                                     33450000
334600                                                                  33460000
334700     MOVE PV-TMST                 TO PC238-WRKD-TMST.             33470000
334800                                                                  33480000
334900     IF SU035-DRIVE-LINE                                          33490000
335000         SET  PC238-DRIVE-LINE        TO TRUE                     33500000
335100         PERFORM 8300-WRITE-PROCESS-TS-QUEUE                      33510000
335200     ELSE                                                         33520000
335300         IF SU035-PACK-NO                                         33530000
335400             PERFORM 8300-WRITE-PROCESS-TS-QUEUE                  33540000
335500         END-IF                                                   33550000
335600     END-IF.                                                      33560000
335700     SET  PC238-ODD-UNIT-NO   TO TRUE.                            33570000
335800     MOVE SU035-ORIG-OPER-UNT-ID  TO PC238-WRKD-OPER-UNT-ID.      33580000
335900     MOVE DK-PO                   TO PC238-PO-NBR.                33590000
336000     MOVE DK-REC-SEQ-NBR          TO PC238-RCVR-SEQ-NBR.          33600000
336100     MOVE DK-PO-LNE-NBR           TO PC238-PO-LNE-NBR.            33610000
336200                                                                  33620000
336300     IF SU035-ODD-UNIT-YES                                        33630000
336400         MOVE 0                   TO PC238-WRKD-UNT-QTY           33640000
336500     ELSE                                                         33650000
336600         MOVE SU035-ADJUST-QTY    TO PC238-WRKD-UNT-QTY           33660000
336700     END-IF.                                                      33670000
336800     MOVE PURITM-UNT-RTL-PR-AMT   TO PC238-UNT-RETAIL-PRC.        33680000
336900     MOVE PV-VRFY-ADJ-QUEUE-NAME  TO PC238-VRFY-ADJ-QUEUE-NAME.   33690000
337000     MOVE PV-VRFY-ITEM            TO PC238-TOT-QUEUE-ITEMS.       33700000
337100                                                                  33710000
337200     IF SU035-ODD-UNIT-YES AND                                    33720000
337300        SU035-PACK-ADJUST-QTY = 0                                 33730000
337400         IF SU035-PACK-YES                                        33740000
337500             PERFORM 8050-UNITS-WORK-ROUTINE                      33750000
337600         END-IF                                                   33760000
337700     ELSE                                                         33770000
337800         PERFORM 8020-LINK-UNITS-WORK-ROUTINE                     33780000
337900     END-IF.                                                      33790000
338000                                                                  33800000
338100 8020-LINK-UNITS-WORK-ROUTINE.                                    33810000
338200                                                                  33820000
338300     MOVE LENGTH OF PC238-COMM-AREA                               33830000
338400                                  TO PV-COMMAREA-LENGTH.          33840000
338500                                                                  33850000
338600     EXEC CICS                                                    33860000
338700         LINK PROGRAM  (PC-PCKCS756)                              33870000
338800              COMMAREA (PC238-COMM-AREA)                          33880000
338900              LENGTH   (PV-COMMAREA-LENGTH)                       33890000
339000              RESP     (PV-CICS-RESPONSE)                         33900000
339100     END-EXEC.                                                    33910000
339200                                                                  33920000
339300                                                                  33930000
339400     EVALUATE TRUE                                                33940000
339500         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 33950000
339600              IF  PC238-MOD-UNSUCCESSFUL                          33960000
339700                  PERFORM 8100-MOD-UNSUCCESSFUL                   33970000
339800              ELSE                                                33980000
339900                  IF SU035-PACK-YES AND                           33990000
340000                     SU035-ODD-UNIT-YES                           34000000
340100                      PERFORM 8050-UNITS-WORK-ROUTINE             34010000
340200                  END-IF                                          34020000
340300              END-IF                                              34030000
340400         WHEN OTHER                                               34040000
340500              MOVE PC238-PO-NBR       TO PV-DISP-PO               34050000
340600              MOVE PC238-RCVR-SEQ-NBR TO PV-DISP-RCVR-SEQ-NBR     34060000
340700              MOVE PC238-PO-LNE-NBR   TO PV-DISP-PO-LNE-NBR       34070000
340800              MOVE PC238-WRKD-OPER-UNT-ID                         34080000
340900                                      TO PV-DISP-OPER-UNT-ID      34090000
341000              MOVE PC238-BAD-SQL-CDE  TO PV-DISPLAY-SQLCODE       34100000
341100              MOVE PV-CICS-RESPONSE   TO PV-DISPLAY-CICS-RESP     34110000
341200              STRING ' SUKUT702 - '      DELIMITED BY SIZE        34120000
341300                     ' 8020-UNITS-WORK-ROUTINE '                  34130000
341400                                         DELIMITED BY SIZE        34140000
341500                     ' BAD CALL TO UNITS WORKED MODULE '          34150000
341600                                         DELIMITED BY SIZE        34160000
341700                     ' - CICS RESP '                              34170000
341800                                         DELIMITED BY SIZE        34180000
341900                     PV-DISPLAY-CICS-RESP                         34190000
342000                                         DELIMITED BY SIZE        34200000
342100                                 INTO PV-CICS-MSG-AREA            34210000
342200              PERFORM 9999-WRITE-TO-CSSL                          34220000
342300              STRING ' SUKUT702 - '      DELIMITED BY SIZE        34230000
342400                     ' 8020-UNITS-WORK-ROUTINE '                  34240000
342500                                         DELIMITED BY SIZE        34250000
342600                     ' KEY INFO - '      DELIMITED BY SIZE        34260000
342700                     PV-DISP-PO          DELIMITED BY SIZE        34270000
342800                     ' - '               DELIMITED BY SIZE        34280000
342900                     PV-DISP-RCVR-SEQ-NBR DELIMITED BY SIZE       34290000
343000                     ' - '               DELIMITED BY SIZE        34300000
343100                     PV-DISP-PO-LNE-NBR DELIMITED BY SIZE         34310000
343200                                 INTO PV-CICS-MSG-AREA            34320000
343300              PERFORM 9999-WRITE-TO-CSSL                          34330000
343400              MOVE PV-CICS-MSG-AREA      TO SU035-CRA-RET-MSG     34340000
343500     END-EVALUATE.                                                34350000
343600**   THE UNITS WORKED MODULE IS CALLED TWICE WHEN A LINE HAS      34360000
343700**   UPDATES FOR THE PACK COUNT AND THE ODD UNITS COUNT           34370000
343800**   THIS IS THE SECOND CALL FOR ODD UNITS.                       34380000
343900                                                                  34390000
344000 8050-UNITS-WORK-ROUTINE.                                         34400000
344100     PERFORM 8600-RECEIV-PURITM-JOIN.                             34410000
344200                                                                  34420000
344300     SET PS-PROCESS-ODD-UNITS TO TRUE.                            34430000
344400                                                                  34440000
344500     MOVE  0                      TO PV-VRFY-ITEM.                34450000
344600                                                                  34460000
344700     PERFORM 8300-WRITE-PROCESS-TS-QUEUE.                         34470000
344800                                                                  34480000
344900     EXEC SQL                                                     34490000
345000         SET :PV-TMST =  CURRENT_TIMESTAMP                        34500000
345100     END-EXEC                                                     34510000
345200                                                                  34520000
345300     MOVE PV-TMST                 TO PC238-WRKD-TMST.             34530000
345400                                                                  34540000
345500     SET  PC238-ODD-UNIT-YES  TO TRUE.                            34550000
345600     MOVE SU035-ORIG-OPER-UNT-ID  TO PC238-WRKD-OPER-UNT-ID.      34560000
345700     MOVE DK-PO                   TO PC238-PO-NBR.                34570000
345800     MOVE DK-REC-SEQ-NBR          TO PC238-RCVR-SEQ-NBR.          34580000
345900     MOVE DK-PO-LNE-NBR           TO PC238-PO-LNE-NBR.            34590000
346000                                                                  34600000
346100     MOVE SU035-ADJUST-QTY        TO PC238-WRKD-UNT-QTY.          34610000
346200     MOVE PURITM-UNT-RTL-PR-AMT   TO PC238-UNT-RETAIL-PRC.        34620000
346300     MOVE PV-VRFY-ADJ-QUEUE-NAME  TO PC238-VRFY-ADJ-QUEUE-NAME.   34630000
346400     MOVE PV-VRFY-ITEM            TO PC238-TOT-QUEUE-ITEMS.       34640000
346500                                                                  34650000
346600                                                                  34660000
346700     MOVE LENGTH OF PC238-COMM-AREA                               34670000
346800                                  TO PV-COMMAREA-LENGTH.          34680000
346900                                                                  34690000
347000     EXEC CICS                                                    34700000
347100         LINK PROGRAM  (PC-PCKCS756)                              34710000
347200              COMMAREA (PC238-COMM-AREA)                          34720000
347300              LENGTH   (PV-COMMAREA-LENGTH)                       34730000
347400              RESP     (PV-CICS-RESPONSE)                         34740000
347500     END-EXEC.                                                    34750000
347600                                                                  34760000
347700                                                                  34770000
347800     EVALUATE TRUE                                                34780000
347900         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 34790000
348000              IF  PC238-MOD-UNSUCCESSFUL                          34800000
348100                  PERFORM 8100-MOD-UNSUCCESSFUL                   34810000
348200              END-IF                                              34820000
348300         WHEN OTHER                                               34830000
348400              MOVE PC238-PO-NBR       TO PV-DISP-PO               34840000
348500              MOVE PC238-RCVR-SEQ-NBR TO PV-DISP-RCVR-SEQ-NBR     34850000
348600              MOVE PC238-PO-LNE-NBR   TO PV-DISP-PO-LNE-NBR       34860000
348700              MOVE PC238-WRKD-OPER-UNT-ID                         34870000
348800                                      TO PV-DISP-OPER-UNT-ID      34880000
348900              MOVE PC238-BAD-SQL-CDE  TO PV-DISPLAY-SQLCODE       34890000
349000              MOVE PV-CICS-RESPONSE   TO PV-DISPLAY-CICS-RESP     34900000
349100              STRING ' SUKUT702 - '      DELIMITED BY SIZE        34910000
349200                     ' 8050-UNITS-WORK-ROUTINE '                  34920000
349300                                         DELIMITED BY SIZE        34930000
349400                     ' BAD CALL TO UNITS WORKED MODULE '          34940000
349500                                         DELIMITED BY SIZE        34950000
349600                     ' - CICS RESP '                              34960000
349700                                         DELIMITED BY SIZE        34970000
349800                     PV-DISPLAY-CICS-RESP                         34980000
349900                                         DELIMITED BY SIZE        34990000
350000                                 INTO PV-CICS-MSG-AREA            35000000
350100              PERFORM 9999-WRITE-TO-CSSL                          35010000
350200              STRING ' SUKUT702 - '      DELIMITED BY SIZE        35020000
350300                     ' 8050-UNITS-WORK-ROUTINE '                  35030000
350400                                         DELIMITED BY SIZE        35040000
350500                     ' KEY INFO - '      DELIMITED BY SIZE        35050000
350600                     PV-DISP-PO          DELIMITED BY SIZE        35060000
350700                     ' - '               DELIMITED BY SIZE        35070000
350800                     PV-DISP-RCVR-SEQ-NBR DELIMITED BY SIZE       35080000
350900                     ' - '               DELIMITED BY SIZE        35090000
351000                     PV-DISP-PO-LNE-NBR DELIMITED BY SIZE         35100000
351100                                 INTO PV-CICS-MSG-AREA            35110000
351200              PERFORM 9999-WRITE-TO-CSSL                          35120000
351300              MOVE PV-CICS-MSG-AREA      TO SU035-CRA-RET-MSG     35130000
351400     END-EVALUATE.                                                35140000
351500                                                                  35150000
351600******************************************************************35160000
351700* THIS PARAGRAPH WILL MANAGE THE DISPLAY OF INFORMATION TO CSSL  *35170000
351800* FOR WHEN THE UNITS WORKED ROUTINE WAS UNSUCCESSFUL.  THIS      *35180000
351900* PARAGRAPH WILL FORMAT A MESSAGE AND GET IT WRITTEN TO THE      *35190000
352000* CICS LOG AND THEN SOFT ABORT THE PROGRAM.                      *35200000
352100******************************************************************35210000
352200 8100-MOD-UNSUCCESSFUL.                                           35220000
352300                                                                  35230000
352400     MOVE PC238-PO-NBR              TO PV-DISP-PO.                35240000
352500     MOVE PC238-RCVR-SEQ-NBR        TO PV-DISP-RCVR-SEQ-NBR.      35250000
352600     MOVE PC238-PO-LNE-NBR          TO PV-DISP-PO-LNE-NBR.        35260000
352700     MOVE PC238-WRKD-OPER-UNT-ID    TO PV-DISP-OPER-UNT-ID.       35270000
352800     MOVE PC238-BAD-SQL-CDE         TO PV-DISPLAY-SQLCODE.        35280000
352900                                                                  35290000
353000     IF  PC238-MOD-BAD-TMST                                       35300000
353100         STRING ' SUKUT702 - '      DELIMITED BY SIZE             35310000
353200                ' 8020-UNITS-WORK-ROUTINE '                       35320000
353300                                    DELIMITED BY SIZE             35330000
353400                ' BAD TIMESTAMP '   DELIMITED BY SIZE             35340000
353500                PC238-WRKD-TMST     DELIMITED BY SIZE             35350000
353600                                 INTO PV-CICS-MSG-AREA            35360000
353700         PERFORM 9999-WRITE-TO-CSSL                               35370000
353800         STRING ' SUKUT702 - '      DELIMITED BY SIZE             35380000
353900                ' 8020-UNITS-WORK-ROUTINE '                       35390000
354000                                    DELIMITED BY SIZE             35400000
354100                ' KEY INFO - '      DELIMITED BY SIZE             35410000
354200                PV-DISP-PO          DELIMITED BY SIZE             35420000
354300                ' - '               DELIMITED BY SIZE             35430000
354400                PV-DISP-RCVR-SEQ-NBR DELIMITED BY SIZE            35440000
354500                ' - '               DELIMITED BY SIZE             35450000
354600                PV-DISP-PO-LNE-NBR DELIMITED BY SIZE              35460000
354700                                 INTO PV-CICS-MSG-AREA            35470000
354800         PERFORM 9999-WRITE-TO-CSSL                               35480000
354900         MOVE PV-CICS-MSG-AREA      TO SU035-CRA-RET-MSG          35490000
355000     ELSE                                                         35500000
355100     IF  PC238-MOD-BAD-OPER                                       35510000
355200         STRING ' SUKUT702 - '      DELIMITED BY SIZE             35520000
355300                ' 8020-UNITS-WORK-ROUTINE '                       35530000
355400                                    DELIMITED BY SIZE             35540000
355500                ' BAD OPER UNIT '   DELIMITED BY SIZE             35550000
355600                PV-DISP-OPER-UNT-ID DELIMITED BY SIZE             35560000
355700                                 INTO PV-CICS-MSG-AREA            35570000
355800         PERFORM 9999-WRITE-TO-CSSL                               35580000
355900         STRING ' SUKUT702 - '      DELIMITED BY SIZE             35590000
356000                ' 8020-UNITS-WORK-ROUTINE '                       35600000
356100                                    DELIMITED BY SIZE             35610000
356200                ' KEY INFO - '      DELIMITED BY SIZE             35620000
356300                PV-DISP-PO          DELIMITED BY SIZE             35630000
356400                ' - '               DELIMITED BY SIZE             35640000
356500                PV-DISP-RCVR-SEQ-NBR DELIMITED BY SIZE            35650000
356600                ' - '               DELIMITED BY SIZE             35660000
356700                PV-DISP-PO-LNE-NBR DELIMITED BY SIZE              35670000
356800                                 INTO PV-CICS-MSG-AREA            35680000
356900         PERFORM 9999-WRITE-TO-CSSL                               35690000
357000         MOVE PV-CICS-MSG-AREA      TO SU035-CRA-RET-MSG          35700000
357100     ELSE                                                         35710000
357200     IF  PC238-MOD-BAD-TRANS-TYPE                                 35720000
357300         STRING ' SUKUT702 - '      DELIMITED BY SIZE             35730000
357400                ' 8020-UNITS-WORK-ROUTINE '                       35740000
357500                                    DELIMITED BY SIZE             35750000
357600                ' BAD TRAN TYPE '   DELIMITED BY SIZE             35760000
357700                PC238-TRANS-TYPE-CDE                              35770000
357800                                    DELIMITED BY SIZE             35780000
357900                                 INTO PV-CICS-MSG-AREA            35790000
358000         PERFORM 9999-WRITE-TO-CSSL                               35800000
358100         STRING ' SUKUT702 - '      DELIMITED BY SIZE             35810000
358200                ' 8020-UNITS-WORK-ROUTINE '                       35820000
358300                                    DELIMITED BY SIZE             35830000
358400                ' KEY INFO - '      DELIMITED BY SIZE             35840000
358500                PV-DISP-PO          DELIMITED BY SIZE             35850000
358600                ' - '               DELIMITED BY SIZE             35860000
358700                PV-DISP-RCVR-SEQ-NBR DELIMITED BY SIZE            35870000
358800                ' - '               DELIMITED BY SIZE             35880000
358900                PV-DISP-PO-LNE-NBR DELIMITED BY SIZE              35890000
359000                                 INTO PV-CICS-MSG-AREA            35900000
359100         PERFORM 9999-WRITE-TO-CSSL                               35910000
359200         MOVE PV-CICS-MSG-AREA      TO SU035-CRA-RET-MSG          35920000
359300     ELSE                                                         35930000
359400     IF  PC238-MOD-BAD-PO                                         35940000
359500         STRING ' SUKUT702 - '      DELIMITED BY SIZE             35950000
359600                ' 8020-UNITS-WORK-ROUTINE '                       35960000
359700                                    DELIMITED BY SIZE             35970000
359800                ' BAD PO NUMBER '   DELIMITED BY SIZE             35980000
359900                PV-DISP-PO          DELIMITED BY SIZE             35990000
360000                                 INTO PV-CICS-MSG-AREA            36000000
360100         PERFORM 9999-WRITE-TO-CSSL                               36010000
360200         STRING ' SUKUT702 - '      DELIMITED BY SIZE             36020000
360300                ' 8020-UNITS-WORK-ROUTINE '                       36030000
360400                                    DELIMITED BY SIZE             36040000
360500                ' KEY INFO - '      DELIMITED BY SIZE             36050000
360600                PV-DISP-PO          DELIMITED BY SIZE             36060000
360700                ' - '               DELIMITED BY SIZE             36070000
360800                PV-DISP-RCVR-SEQ-NBR DELIMITED BY SIZE            36080000
360900                ' - '               DELIMITED BY SIZE             36090000
361000                PV-DISP-PO-LNE-NBR DELIMITED BY SIZE              36100000
361100                                 INTO PV-CICS-MSG-AREA            36110000
361200         PERFORM 9999-WRITE-TO-CSSL                               36120000
361300         MOVE PV-CICS-MSG-AREA      TO SU035-CRA-RET-MSG          36130000
361400     ELSE                                                         36140000
361500     IF  PC238-MOD-BAD-RCVR                                       36150000
361600         STRING ' SUKUT702 - '      DELIMITED BY SIZE             36160000
361700                ' 8020-UNITS-WORK-ROUTINE '                       36170000
361800                                    DELIMITED BY SIZE             36180000
361900                ' BAD RCVR NBR  '   DELIMITED BY SIZE             36190000
362000                PV-DISP-RCVR-SEQ-NBR DELIMITED BY SIZE            36200000
362100                                 INTO PV-CICS-MSG-AREA            36210000
362200         PERFORM 9999-WRITE-TO-CSSL                               36220000
362300         STRING ' SUKUT702 - '      DELIMITED BY SIZE             36230000
362400                ' 8020-UNITS-WORK-ROUTINE '                       36240000
362500                                    DELIMITED BY SIZE             36250000
362600                ' KEY INFO - '      DELIMITED BY SIZE             36260000
362700                PV-DISP-PO          DELIMITED BY SIZE             36270000
362800                ' - '               DELIMITED BY SIZE             36280000
362900                PV-DISP-RCVR-SEQ-NBR DELIMITED BY SIZE            36290000
363000                ' - '               DELIMITED BY SIZE             36300000
363100                PV-DISP-PO-LNE-NBR DELIMITED BY SIZE              36310000
363200                                 INTO PV-CICS-MSG-AREA            36320000
363300         PERFORM 9999-WRITE-TO-CSSL                               36330000
363400         MOVE PV-CICS-MSG-AREA      TO SU035-CRA-RET-MSG          36340000
363500     ELSE                                                         36350000
363600     IF  PC238-MOD-BAD-LINE                                       36360000
363700         STRING ' SUKUT702 - '      DELIMITED BY SIZE             36370000
363800                ' 8020-UNITS-WORK-ROUTINE '                       36380000
363900                                    DELIMITED BY SIZE             36390000
364000                ' BAD LINE NBR  '   DELIMITED BY SIZE             36400000
364100                PV-DISP-PO-LNE-NBR DELIMITED BY SIZE              36410000
364200                                 INTO PV-CICS-MSG-AREA            36420000
364300         PERFORM 9999-WRITE-TO-CSSL                               36430000
364400         STRING ' SUKUT702 - '      DELIMITED BY SIZE             36440000
364500                ' 8020-UNITS-WORK-ROUTINE '                       36450000
364600                                    DELIMITED BY SIZE             36460000
364700                ' KEY INFO - '      DELIMITED BY SIZE             36470000
364800                PV-DISP-PO          DELIMITED BY SIZE             36480000
364900                ' - '               DELIMITED BY SIZE             36490000
365000                PV-DISP-RCVR-SEQ-NBR DELIMITED BY SIZE            36500000
365100                ' - '               DELIMITED BY SIZE             36510000
365200                PV-DISP-PO-LNE-NBR DELIMITED BY SIZE              36520000
365300                                 INTO PV-CICS-MSG-AREA            36530000
365400         PERFORM 9999-WRITE-TO-CSSL                               36540000
365500         MOVE PV-CICS-MSG-AREA      TO SU035-CRA-RET-MSG          36550000
365600     ELSE                                                         36560000
365700     IF  PC238-MOD-BAD-NO-SHIFT                                   36570000
365800         STRING ' SUKUT702 - '      DELIMITED BY SIZE             36580000
365900                ' 8020-UNITS-WORK-ROUTINE '                       36590000
366000                                    DELIMITED BY SIZE             36600000
366100                ' SHIFT NOT FOUND ' DELIMITED BY SIZE             36610000
366200                PC238-WRKD-TMST     DELIMITED BY SIZE             36620000
366300                ' FOR OPER '        DELIMITED BY SIZE             36630000
366400                PV-DISP-OPER-UNT-ID DELIMITED BY SIZE             36640000
366500                                 INTO PV-CICS-MSG-AREA            36650000
366600         PERFORM 9999-WRITE-TO-CSSL                               36660000
366700         STRING ' SUKUT702 - '      DELIMITED BY SIZE             36670000
366800                ' 8020-UNITS-WORK-ROUTINE '                       36680000
366900                                    DELIMITED BY SIZE             36690000
367000                ' KEY INFO - '      DELIMITED BY SIZE             36700000
367100                PV-DISP-PO          DELIMITED BY SIZE             36710000
367200                ' - '               DELIMITED BY SIZE             36720000
367300                PV-DISP-RCVR-SEQ-NBR DELIMITED BY SIZE            36730000
367400                ' - '               DELIMITED BY SIZE             36740000
367500                PV-DISP-PO-LNE-NBR DELIMITED BY SIZE              36750000
367600                                 INTO PV-CICS-MSG-AREA            36760000
367700         PERFORM 9999-WRITE-TO-CSSL                               36770000
367800         MOVE PV-CICS-MSG-AREA      TO SU035-CRA-RET-MSG          36780000
367900     ELSE                                                         36790000
368000         STRING ' SUKUT702 - '      DELIMITED BY SIZE             36800000
368100                ' 8020-UNITS-WORK-ROUTINE '                       36810000
368200                                    DELIMITED BY SIZE             36820000
368300                ' DB ERROR - SQL CODE '                           36830000
368400                                    DELIMITED BY SIZE             36840000
368500                PV-DISPLAY-SQLCODE DELIMITED BY SIZE              36850000
368600                ' FUNC: '           DELIMITED BY SIZE             36860000
368700                PC238-BAD-TABLE-FUNCTION                          36870000
368800                                    DELIMITED BY SIZE             36880000
368900                ' TABLE: '          DELIMITED BY SIZE             36890000
369000                PC238-BAD-TABLE-NAME                              36900000
369100                                    DELIMITED BY SIZE             36910000
369200                                 INTO PV-CICS-MSG-AREA            36920000
369300         PERFORM 9999-WRITE-TO-CSSL                               36930000
369400         STRING ' SUKUT702 - '      DELIMITED BY SIZE             36940000
369500                ' 8020-UNITS-WORK-ROUTINE '                       36950000
369600                                    DELIMITED BY SIZE             36960000
369700                ' KEY INFO - '      DELIMITED BY SIZE             36970000
369800                PV-DISP-PO          DELIMITED BY SIZE             36980000
369900                ' - '               DELIMITED BY SIZE             36990000
370000                PV-DISP-RCVR-SEQ-NBR DELIMITED BY SIZE            37000000
370100                ' - '               DELIMITED BY SIZE             37010000
370200                PV-DISP-PO-LNE-NBR DELIMITED BY SIZE              37020000
370300                                 INTO PV-CICS-MSG-AREA            37030000
370400         PERFORM 9999-WRITE-TO-CSSL                               37040000
370500         MOVE PV-CICS-MSG-AREA      TO SU035-CRA-RET-MSG          37050000
370600     END-IF                                                       37060000
370700     END-IF                                                       37070000
370800     END-IF                                                       37080000
370900     END-IF                                                       37090000
371000     END-IF                                                       37100000
371100     END-IF                                                       37110000
371200     END-IF.                                                      37120000
371300                                                                  37130000
371400 8200-LINK-TO-UPDATE.                                             37140000
371500                                                                  37150000
371600     EXEC CICS LINK                                               37160000
371700          PROGRAM (PC-TMKCS520)                                   37170000
371800          COMMAREA(TM500-FIELDS)                                  37180000
371900          RESP    (PV-CICS-RESPONSE)                              37190000
372000     END-EXEC.                                                    37200000
372100                                                                  37210000
372200     IF  PV-CICS-RESPONSE NOT EQUAL DFHRESP(NORMAL)               37220000
372300         SET SU035-INVALID-SQL     TO TRUE                        37230000
372400         SET PS-NO-AUTO-APPLY TO TRUE                             37240000
372500         MOVE PV-CICS-RESPONSE     TO PV-DISP-OPER-UNT-ID         37250000
372600         STRING   ' SUKUT702-8200-'                               37260000
372700                  ' CALLED BY-'                                   37270000
372800                  SU035-PROGRAM-NAME                              37280000
372900                  ' CICS RESP='                                   37290000
373000                  PV-DISP-OPER-UNT-ID                             37300000
373100                  DELIMITED BY SIZE                               37310000
373200                                  INTO PV-CICS-MSG-AREA           37320000
373300         PERFORM 9999-WRITE-TO-CSSL                               37330000
373400         MOVE PV-CICS-MSG-AREA      TO SU035-CRA-RET-MSG          37340000
373500         SET SU035-UPDATE-ERROR TO TRUE                           37350000
373600     END-IF.                                                      37360000
373700                                                                  37370000
373800 8300-WRITE-PROCESS-TS-QUEUE.                                     37380000
373900     MOVE ZEROES                  TO PC241-STR-ADJ-QTY.           37390000
374000     MOVE EIBTRMID                TO PV-VRFY-ADJ-TERM-ID.         37400000
374100     MOVE EIBTASKN                TO PV-VRFY-ADJ-TASK-NUMBER      37410000
374200     MOVE 6                       TO PV-VRFY-ADJ-SEQ.             37420000
374300     MOVE SU035-PO                TO PC241-PO-NBR.                37430000
374400     MOVE SU035-PO-LNE-NBR        TO PC241-PO-LNE-NBR.            37440000
374500     MOVE SU035-REC-SEQ-NBR       TO PC241-REC-SEQ-NBR.           37450000
374600     MOVE SU035-ORIG-OPER-UNT-ID  TO PC241-OPER-UNT-ID.           37460000
374700     MOVE 1                       TO PC241-FCLTY-ID.              37470000
374800     MOVE SU035-DEST-LOC-NBR      TO PC241-STR-NBR.               37480000
374900     IF SU035-PACK-YES                                            37490000
375000         IF PS-PROCESS-ODD-UNITS                                  37500000
375100             COMPUTE PC241-STR-ADJ-QTY =                          37510000
375200                SU035-AFTER-ODD-UNT-QTY - SU035-BEFORE-ODD-UNT-QTY37520000
375300         ELSE                                                     37530000
375400             MOVE SU035-PACK-ADJUST-QTY   TO PC241-STR-ADJ-QTY    37540000
375500         END-IF                                                   37550000
375600     ELSE                                                         37560000
375700         MOVE SU035-ADJUST-QTY        TO PC241-STR-ADJ-QTY        37570000
375800     END-IF.                                                      37580000
375900     ADD   1                      TO PV-VRFY-ITEM.                37590000
376000     PERFORM 8400-WRITE-VRFY-ADJ-QUEUE.                           37600000
376100                                                                  37610000
376200******************************************************************37620000
376300* WRITE ENTRIES TO VERIFY ADJUSTMENT QUEUE                       *37630000
376400******************************************************************37640000
376500 8400-WRITE-VRFY-ADJ-QUEUE.                                       37650000
376600                                                                  37660000
376700     EXEC CICS WRITEQ TS                                          37670000
376800               QUEUE (PV-VRFY-ADJ-QUEUE-NAME)                     37680000
376900               FROM  (PC241-FIELDS)                               37690000
377000               ITEM  (PV-VRFY-ITEM)                               37700000
377100               RESP  (PV-CICS-RESPONSE)                           37710011
377200     END-EXEC.                                                    37720000
377300                                                                  37730000
377400     IF PV-CICS-RESPONSE NOT = DFHRESP (NORMAL)                   37740000
377500         SET SU035-INVALID-SQL     TO TRUE                        37750000
377600         SET PS-NO-AUTO-APPLY TO TRUE                             37760000
377700         MOVE PV-CICS-RESPONSE     TO PV-DISP-OPER-UNT-ID         37770000
377800         MOVE PV-VRFY-ITEM         TO PV-DISP-STR-NBR             37780000
377900         STRING   ' SUKUT702-8400-'                               37790000
378000                  ' CALLED BY-'                                   37800000
378100                  SU035-PROGRAM-NAME                              37810000
378200                  ' RESPONSE = '                                  37820000
378300                  PV-DISP-OPER-UNT-ID                             37830000
378400                  ' ITEM  = '                                     37840000
378500                  PV-DISP-STR-NBR                                 37850000
378600                  ' QUEUE = '                                     37860000
378700                  PV-VRFY-ADJ-QUEUE-NAME                          37870000
378800                  DELIMITED BY SIZE                               37880000
378900                                  INTO PV-CICS-MSG-AREA           37890000
379000         PERFORM 9999-WRITE-TO-CSSL                               37900000
379100         MOVE '8400-'               TO SU035-CRA-REQ-ID           37910000
379200         MOVE PV-CICS-MSG-AREA      TO SU035-CRA-RET-MSG          37920000
379300         SET SU035-UPDATE-ERROR TO TRUE                           37930000
379400         PERFORM 9998-RETURN                                      37940000
379500     END-IF.                                                      37950000
379600                                                                  37960000
379700                                                                  37970000
379800 8500-SELECT-STORE.                                               37980000
379900                                                                  37990000
380000     CALL XL071-LOCATION-MODULE  USING  DFHEIBLK                  38000000
380100                                        XL071-COMMAREA            38010000
380200                                        XL071-COMMAREA-REC.       38020000
380300                                                                  38030000
380400     EVALUATE TRUE                                                38040000
380500         WHEN XL071-NO-ERRORS                                     38050000
380600              CONTINUE                                            38060000
380700         WHEN XL071-LOC-NOT-FOUND                                 38070000
380800              SET PS-STORE-NOT-FOUND TO TRUE                      38080000
380900         WHEN OTHER                                               38090000
381000              INITIALIZE PV-CICS-MSG-AREA                         38100000
381100              SET PS-ERROR                                        38110000
381200                  SU035-INVALID-SQL    TO TRUE                    38120000
381300              MOVE XL071-SQLCODE       TO PV-DISPLAY-SQLCODE      38130000
381400              MOVE DK-STR-NBR          TO PV-DISP-STR-NBR         38140000
381500              STRING   ' SUKUT702-8500- CALL XLKUT071 -'          38150000
381600                       ' CALLED BY-'                              38160000
381700                       SU035-PROGRAM-NAME                         38170000
381800                       '  SQLCODE='                               38180000
381900                       PV-DISPLAY-SQLCODE                         38190000
382000                       ' STORE= '                                 38200000
382100                       PV-DISP-STR-NBR                            38210000
382200                                          DELIMITED BY SIZE       38220000
382300                                       INTO PV-CICS-MSG-AREA      38230000
382400              PERFORM 9999-WRITE-TO-CSSL                          38240000
382500              MOVE '8500-'               TO SU035-CRA-REQ-ID      38250000
382600              MOVE PV-CICS-MSG-AREA      TO SU035-CRA-RET-MSG     38260000
382700              SET SU035-INVALID-SQL TO TRUE                       38270000
382800              PERFORM 9998-RETURN                                 38280000
382900     END-EVALUATE.                                                38290000
383000                                                                  38300000
383100     IF XL071-LOC-TYP-CDE = 'DC'                                  38310000
383200        SET PS-DC-STORE-TYPE        TO TRUE                       38320000
383300     ELSE                                                         38330000
383400        SET PS-NOT-DC-STORE-TYPE    TO TRUE                       38340000
383500     END-IF.                                                      38350000
383600                                                                  38360000
383700 8600-RECEIV-PURITM-JOIN.                                         38370000
383800                                                                  38380000
383900     EXEC SQL                                                     38390000
384000     SELECT C.UNT_RTL_PR_AMT                                      38400000
384100         INTO :PURITM-UNT-RTL-PR-AMT                              38410000
384200         FROM                                                     38420000
384300             TRECEIV A                                            38430000
384400         ,   TRECITM B                                            38440000
384500         ,   TPURITM C                                            38450000
384600         WHERE A.ORD_NBR          = :DK-PO                        38460000
384700           AND A.REC_SEQ_NBR      = :DK-REC-SEQ-NBR               38470000
384800           AND B.ORD_NBR          = A.ORD_NBR                     38480000
384900           AND B.REC_SEQ_NBR      = A.REC_SEQ_NBR                 38490000
385000           AND B.ORD_LNE_NBR      = :DK-PO-LNE-NBR                38500000
385100           AND C.PO_NBR           = B.ORD_NBR                     38510000
385200           AND C.APP_PO_LNE_NBR   = B.ORD_LNE_NBR                 38520000
385300           AND C.VER_NBR          = B.PO_VER_NBR                  38530000
385400     END-EXEC.                                                    38540000
385500                                                                  38550000
385600     EVALUATE TRUE                                                38560000
385700         WHEN SQLCODE = ZERO                                      38570000
385800              CONTINUE                                            38580000
385900         WHEN SQLWARN0 NOT = SPACE                                38590000
386000         WHEN SQLCODE NOT = ZERO                                  38600000
386100             SET PS-ERROR                                         38610000
386200                 SU035-INVALID-SQL    TO TRUE                     38620000
386300             MOVE  SQLCODE            TO PV-DISPLAY-SQLCODE       38630000
386400             MOVE DK-PO            TO PV-DISP-PO                  38640000
386500             MOVE DK-REC-SEQ-NBR   TO PV-DISP-RCVR-SEQ-NBR        38650000
386600             MOVE DK-PO-LNE-NBR    TO PV-DISP-PO-LNE-NBR          38660000
386700             STRING   ' SUKUT702-8600-'                           38670000
386800                      ' CALLED BY-'                               38680000
386900                      SU035-PROGRAM-NAME                          38690000
387000                      '  SQLCODE='                                38700000
387100                      PV-DISPLAY-SQLCODE                          38710000
387200                      ' PO= '                                     38720000
387300                      PV-DISP-PO                                  38730000
387400                      ' REV= '                                    38740000
387500                      PV-DISP-RCVR-SEQ-NBR                        38750000
387600                      ' LNE= '                                    38760000
387700                      PV-DISP-PO-LNE-NBR                          38770000
387800                                         DELIMITED BY SIZE        38780000
387900                                      INTO PV-CICS-MSG-AREA       38790000
388000             PERFORM 9999-WRITE-TO-CSSL                           38800000
388100             MOVE '8600-'               TO SU035-CRA-REQ-ID       38810000
388200             MOVE PV-CICS-MSG-AREA      TO SU035-CRA-RET-MSG      38820000
388300             SET SU035-INVALID-SQL TO TRUE                        38830000
388400             PERFORM 9998-RETURN                                  38840000
388500     END-EVALUATE.                                                38850000
388600                                                                  38860000
388700*----------------------------------------------------------------*38870000
388800*    CURRENT SYSTEM DATE/TIME MODULE                              38880000
388900*----------------------------------------------------------------*38890000
389000                                                                  38900000
389100     COPY DPPD017.                                                38910000
389200                                                                  38920000
389300*-----------------------------------------------------------------38930000
389400*  RETURN TO CALLING PROGRAM                                      38940000
389500*-----------------------------------------------------------------38950000
389600 9998-RETURN.                                                     38960000
389700                                                                  38970000
389800     MOVE SQLCA                         TO SU035-SQLCA            38980000
389900                                           PV-CICS-MSG-AREA.      38990000
390000     PERFORM 9999-WRITE-TO-CSSL.                                  39000000
390100     MOVE SU035-COMM-AREA               TO DFHCOMMAREA.           39010000
390200                                                                  39020000
390300     EXEC CICS                                                    39030000
390400          RETURN                                                  39040000
390500     END-EXEC.                                                    39050000
390600                                                                  39060000
390700 9999-WRITE-TO-CSSL.                                              39070000
390800                                                                  39080000
390900     MOVE LENGTH OF PV-CICS-MSG-AREA  TO PV-COMMAREA-LENGTH.      39090000
391000                                                                  39100000
391100     EXEC CICS                                                    39110000
391200          WRITEQ TD                                               39120000
391300           QUEUE   ('CSSL')                                       39130000
391400            FROM   (PV-CICS-MSG-AREA)                             39140000
391500          LENGTH   (PV-COMMAREA-LENGTH)                           39150000
391600            RESP   (PV-CICS-RESPONSE)                             39160000
391700     END-EXEC.                                                    39170000
391800                                                                  39180000
