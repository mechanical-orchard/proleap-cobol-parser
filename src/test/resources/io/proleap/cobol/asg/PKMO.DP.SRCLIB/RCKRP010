000100******************************************************************00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300******************************************************************00030000
000400                                                                  00040000
000500 PROGRAM-ID.    RCKRP010.                                         00050000
000600 AUTHOR.        BETH A. BILSKI.                                   00060000
000700 INSTALLATION.  KOHLS.                                            00070000
000800 DATE-WRITTEN   DECEMBER, 1995.                                   00080000
000900 DATE-COMPILED.                                                   00090000
001000                                                                  00100000
001100******************************************************************00110000
001200*  THIS PROGRAM CREATES THE "PACK TO STORE REVIEW" REPORT         00120000
001300******************************************************************00130000
001400                                                                  00140000
001500******************************************************************00150000
001600 ENVIRONMENT DIVISION.                                            00160000
001700******************************************************************00170000
001800                                                                  00180000
001900 CONFIGURATION SECTION.                                           00190000
002000                                                                  00200000
002100 SOURCE-COMPUTER.        IBM-3090.                                00210000
002200 OBJECT-COMPUTER.        IBM-3090.                                00220000
002300                                                                  00230000
002400 INPUT-OUTPUT SECTION.                                            00240000
002500                                                                  00250000
002600 FILE-CONTROL.                                                    00260000
002700                                                                  00270000
002800     SELECT PBS-FILE                                              00280000
002900         ASSIGN TO INP01.                                         00290000
003000                                                                  00300000
003100     SELECT PBS-REVIEW-RPT-FILE                                   00310000
003200         ASSIGN TO RPT01.                                         00320000
003300                                                                  00330000
003400******************************************************************00340000
003500 DATA DIVISION.                                                   00350000
003600******************************************************************00360000
003700                                                                  00370000
003800 FILE SECTION.                                                    00380000
003900                                                                  00390000
004000 FD  PBS-FILE                                                     00400000
004100     RECORDING MODE IS F                                          00410000
004200     LABEL RECORDS ARE STANDARD                                   00420000
004300     BLOCK CONTAINS 0 RECORDS.                                    00430000
004400                                                                  00440000
004500 01  PBS-RECORD                       PIC  X(80).                 00450000
004600                                                                  00460000
004700                                                                  00470000
004800 FD  PBS-REVIEW-RPT-FILE                                          00480000
004900     RECORDING MODE IS F                                          00490000
005000     LABEL RECORDS ARE STANDARD                                   00500000
005100     BLOCK CONTAINS 0 RECORDS.                                    00510000
005200                                                                  00520000
005300 01  PBS-REVIEW-RECORD                PIC  X(132).                00530000
005400*                                                                 00540000
005500*                                                                 00550000
005600******************************************************************00560000
005700 WORKING-STORAGE SECTION.                                         00570000
005800******************************************************************00580000
005900*                                                                 00590000
006000******************************************************************00600000
006100***  PBS RECORD                                                   00610000
006200******************************************************************00620000
006300     COPY RCRD050.                                                00630000
006400*                                                                 00640000
006500*                                                                 00650000
006600*                                                                 00660000
006700*                                                                 00670000
006800 01  DC-TABLE.                                                    00680000
006900     05  DC-TBL          OCCURS 50 TIMES                          00690000
007000                         INDEXED BY DC-IDX.                       00700000
007100         10 DC-NBR               PIC  S9(4) COMP.                 00710000
007200                                                                  00720000
007300 01  CC-CONTROL-CARD.                                             00730000
007400     05  CC-START-DATE               PIC  X(10)      VALUE SPACE. 00740000
007500     05  FILLER  REDEFINES  CC-START-DATE.                        00750000
007600         10  CC-START-CENTURY-YEAR   PIC  9(04).                  00760000
007700         10  FILLER  REDEFINES  CC-START-CENTURY-YEAR.            00770000
007800             15  CC-START-CENTURY    PIC  9(02).                  00780000
007900             15  CC-START-YEAR       PIC  9(02).                  00790000
008000         10  FILLER                  PIC  X(01).                  00800000
008100         10  CC-START-MONTH          PIC  9(02).                  00810000
008200             88  CC-VALID-START-MONTH                VALUE 01     00820000
008300                                                      THRU 12.    00830000
008400         10  FILLER                  PIC  X(01).                  00840000
008500         10  CC-START-DAY            PIC  9(02).                  00850000
008600             88  CC-VALID-START-DAY                  VALUE 01     00860000
008700                                                      THRU 31.    00870000
008800     05  FILLER                      PIC  X(01)      VALUE SPACE. 00880000
008900     05  CC-END-DATE                 PIC  X(10)      VALUE SPACE. 00890000
009000     05  FILLER  REDEFINES  CC-END-DATE.                          00900000
009100         10  CC-END-CENTURY-YEAR     PIC  9(04).                  00910000
009200         10  FILLER  REDEFINES  CC-END-CENTURY-YEAR.              00920000
009300             15  CC-END-CENTURY      PIC  9(02).                  00930000
009400             15  CC-END-YEAR         PIC  9(02).                  00940000
009500         10  FILLER                  PIC  X(01).                  00950000
009600         10  CC-END-MONTH            PIC  9(02).                  00960000
009700             88  CC-VALID-END-MONTH                VALUE 01       00970000
009800                                                      THRU 12.    00980000
009900         10  FILLER                  PIC  X(01).                  00990000
010000         10  CC-END-DAY              PIC  9(02).                  01000000
010100             88  CC-VALID-END-DAY                    VALUE 01     01010000
010200                                                      THRU 31.    01020000
010300                                                                  01030000
010400                                                                  01040000
010500******************************************************************01050000
010600***  STANDARD REPORT HEADER FOR 132 COLUMN REPORT                 01060000
010700******************************************************************01070000
010800                                                                  01080000
010900     COPY DPWS132O.                                               01090000
011000                                                                  01100000
011100 01  HL1-HEADING-LINE-1.                                          01110000
011200     05  FILLER                      PIC  X(54)      VALUE SPACE. 01120000
011300     05  FILLER                      PIC  X(29)      VALUE        01130000
011400         'PACKED TO STORE REVIEW REPORT'.                         01140000
011500     05  FILLER                      PIC  X(49)      VALUE SPACE. 01150000
011600*                                                                 01160000
011700 01  HL2-HEADING-LINE-2.                                          01170000
011800     05  FILLER                      PIC  X(53)      VALUE SPACE. 01180000
011900     05  FILLER                      PIC  X(04)      VALUE        01190000
012000         'FOR '.                                                  01200000
012100     05  HL2-START-DATE.                                          01210000
012200         10  HL2-START-MONTH         PIC  X(02)      VALUE SPACE. 01220000
012300         10  FILLER                  PIC  X(01)      VALUE '/'.   01230000
012400         10  HL2-START-DAY           PIC  X(02)      VALUE SPACE. 01240000
012500         10  FILLER                  PIC  X(01)      VALUE '/'.   01250000
012600         10  HL2-START-YEAR          PIC  X(02)      VALUE SPACE. 01260000
012700     05  FILLER                      PIC  X(06)      VALUE        01270000
012800         ' THRU '.                                                01280000
012900     05  HL2-END-DATE.                                            01290000
013000         10  HL2-END-MONTH           PIC  X(02)      VALUE SPACE. 01300000
013100         10  FILLER                  PIC  X(01)      VALUE '/'.   01310000
013200         10  HL2-END-DAY             PIC  X(02)      VALUE SPACE. 01320000
013300         10  FILLER                  PIC  X(01)      VALUE '/'.   01330000
013400         10  HL2-END-YEAR            PIC  X(02)      VALUE SPACE. 01340000
013500     05  FILLER                      PIC  X(53)      VALUE SPACE. 01350000
013600                                                                  01360000
013700 01  DH1-DETAIL-HEADING-LINE-1.                                   01370000
013800     05  FILLER                      PIC  X(50)      VALUE        01380000
013900     'P.O.NUMBER/          OPER   P.O.PIECES/           '.        01390000
014000     05  FILLER                      PIC  X(49)      VALUE        01400000
014100         'P.O.       RECEIVED             RECEIVED         '.     01410000
014200     05  FILLER                      PIC  X(33)      VALUE        01420000
014300         'OVER                 OVER        '.                     01430000
014400*                                                                 01440000
014500 01  DH2-DETAIL-HEADING-LINE-2.                                   01450000
014600     05  FILLER                      PIC  X(49)      VALUE        01460000
014700     'REC SEQ/ VENDOR       ID    ORDERED PCS          '.         01470000
014800     05  FILLER                      PIC  X(49)      VALUE        01480000
014900         'RETAIL       PIECES               RETAIL         '.     01490000
015000     05  FILLER                      PIC  X(34)      VALUE        01500000
015100         'PIECES               RETAIL       '.                    01510000
015200*                                                                 01520000
015300*                                                                 01530000
015400                                                                  01540000
015500 01  DL-DETAIL-LINE1.                                             01550000
015600     05  DL-PO-NBR                   PIC  ZZZZZZZ9   VALUE ZEROS. 01560000
015700     05  FILLER                      PIC  X(01)      VALUE SPACES.01570000
015800     05  DL-VENDOR                   PIC  X(30)      VALUE SPACES.01580000
015900     05  FILLER                      PIC  X(93)      VALUE SPACES.01590000
016000                                                                  01600000
016100 01  DL-DETAIL-LINE2.                                             01610000
016200*    05  DL-PO-NBR                   PIC  ZZZZZZZ9   VALUE ZEROS. 01620000
016300*    05  FILLER                      PIC  X(01)      VALUE SPACES.01630000
016400*    05  DL-VENDOR                   PIC  X(15)      VALUE SPACES.01640000
016500     05  FILLER                      PIC  X(25)      VALUE SPACES.01650000
016600     05  DL-PO-PIECES                PIC  ZZZ,ZZZ,ZZ9             01660000
016700                                                     VALUE ZEROS. 01670000
016800     05  FILLER                      PIC  X(05)      VALUE SPACES.01680000
016900     05  DL-PO-RETAIL                PIC  ZZZ,ZZZ,ZZ9.99          01690000
017000                                                     VALUE ZEROS. 01700000
017100     05  FILLER                      PIC  X(03)      VALUE SPACES.01710000
017200     05  DL-REC-PIECES               PIC  ZZZ,ZZZ,ZZ9             01720000
017300                                                     VALUE ZEROS. 01730000
017400     05  FILLER                      PIC  X(03)      VALUE SPACES.01740000
017500     05  DL-REC-RETAIL               PIC  ZZZ,ZZZ,ZZZ,ZZ9.99      01750000
017600                                                     VALUE ZEROS. 01760000
017700     05  FILLER                      PIC  X(03)      VALUE SPACES.01770000
017800     05  DL-VAR-PIECES               PIC  ZZZ,ZZZ,ZZ9-            01780000
017900                                                     VALUE ZEROS. 01790000
018000     05  FILLER                      PIC  X(02)      VALUE SPACES.01800000
018100     05  DL-VAR-RETAIL               PIC  ZZZ,ZZZ,ZZZ,ZZ9.99-     01810000
018200                                                     VALUE ZEROS. 01820000
018300     05  FILLER                      PIC  X(08)      VALUE SPACES.01830000
018400*                                                                 01840000
018500 01  DL-DETAIL-LINE3.                                             01850000
018600     05  FILLER                      PIC  X(15)      VALUE SPACES.01860000
018700     05  DL-DASH2                    PIC  X(01)      VALUE SPACES.01870000
018800     05  DL-REC-SEQ2                 PIC  9(03)      VALUE ZEROS. 01880000
018900     05  FILLER                      PIC  X(02)      VALUE SPACES.01890000
019000     05  DL-OPER-ID2                 PIC  9(04)      VALUE ZEROS. 01900000
019100     05  FILLER                      PIC  X(33)      VALUE SPACES.01910000
019200     05  DL-REC-PIECES2              PIC  ZZZ,ZZZ,ZZ9             01920000
019300                                                     VALUE ZEROS. 01930000
019400     05  FILLER                      PIC  X(03)      VALUE SPACES.01940000
019500     05  DL-REC-RETAIL2              PIC  ZZZ,ZZZ,ZZZ,ZZ9.99      01950000
019600                                                     VALUE ZEROS. 01960000
019700     05  FILLER                      PIC  X(41)      VALUE SPACES.01970000
019800 01  DL-DETAIL-LINE4.                                             01980000
019900     05  DL-MSG4                     PIC  X(12)      VALUE SPACES.01990000
020000     05  FILLER                      PIC  X(09)      VALUE SPACES.02000000
020100     05  DL-OPER-ID4                 PIC  9(04)      VALUE ZEROS. 02010000
020200     05  DL-TALLPLN-QTY              PIC  ZZZ,ZZZ,ZZ9             02020000
020300                                                     VALUE ZEROS. 02030000
020400     05  FILLER                      PIC  X(57)      VALUE SPACES.02040000
020500     05  DL-DIFFER4                  PIC  ZZZ,ZZZ,ZZ9-            02050000
020600                                                     VALUE ZEROS. 02060000
020700     05  FILLER                      PIC  X(27)      VALUE SPACES.02070000
020800*                                                                 02080000
020900*                                                                 02090000
021000 01  CO-DETAIL-LINE.                                              02100000
021100     05  FILLER                      PIC  X(03)      VALUE SPACE. 02110000
021200     05  FILLER                      PIC  X(23)      VALUE        02120000
021300         'COMPANY TOTALS:        '.                               02130000
021400     05  DL-COMP-PO-PIECES           PIC  ZZZ,ZZZ,ZZ9             02140000
021500                                                     VALUE ZEROS. 02150000
021600     05  FILLER                      PIC  X(04)      VALUE SPACES.02160000
021700     05  DL-COMP-PO-RETAIL           PIC  ZZZ,ZZZ,ZZ9.99          02170000
021800                                                     VALUE ZEROS. 02180000
021900     05  FILLER                      PIC  X(02)      VALUE SPACES.02190000
022000     05  DL-COMP-REC-PIECES          PIC  ZZZ,ZZZ,ZZ9             02200000
022100                                                     VALUE ZEROS. 02210000
022200     05  FILLER                      PIC  X(04)      VALUE SPACES.02220000
022300     05  DL-COMP-REC-RETAIL          PIC  ZZZ,ZZZ,ZZZ,ZZ9.99      02230000
022400                                                     VALUE ZEROS. 02240000
022500     05  FILLER                      PIC  X(03)      VALUE SPACES.02250000
022600     05  DL-COMP-VAR-PIECES          PIC  ZZZ,ZZZ,ZZ9-            02260000
022700                                                     VALUE ZEROS. 02270000
022800     05  FILLER                      PIC  X(01)      VALUE SPACES.02280000
022900     05  DL-COMP-VAR-RETAIL          PIC  ZZZ,ZZZ,ZZZ,ZZ9.99-     02290000
023000                                                     VALUE ZEROS. 02300000
023100     05  FILLER                      PIC  X(10)      VALUE SPACES.02310000
023200*                                                                 02320000
023300 01  ER-END-OF-REPORT-LINE.                                       02330000
023400     05  FILLER                      PIC  X(54)      VALUE SPACE. 02340000
023500     05  FILLER                      PIC  X(25)      VALUE        02350000
023600         '***** END OF REPORT *****'.                             02360000
023700     05  FILLER                      PIC  X(53)      VALUE SPACE. 02370000
023800*                                                                 02380000
023900*                                                                 02390000
024000 01  ER-END-OF-REPORT-LINE1.                                      02400000
024100     05  FILLER                      PIC  X(03)      VALUE SPACE. 02410000
024200     05  FILLER                      PIC  X(40)      VALUE        02420000
024300         'TOTAL PBS VERIFIED PO S FOR THE MONTH:  '.              02430000
024400     05  ER-TOTAL-VE                 PIC  ZZZZZZ9    VALUE ZEROS. 02440000
024500     05  FILLER                      PIC  X(82)      VALUE SPACE. 02450000
024600*                                                                 02460000
024700*                                                                 02470000
024800 01  ER-END-OF-REPORT-LINE2.                                      02480000
024900     05  FILLER                      PIC  X(03)      VALUE SPACE. 02490000
025000     05  FILLER                      PIC  X(40)      VALUE        02500000
025100         ' OVER PBS VERIFIED PO S FOR THE MONTH:  '.              02510000
025200     05  ER-DIFF-VE                  PIC  ZZZZZZ9    VALUE ZEROS. 02520000
025300     05  FILLER                      PIC  X(82)      VALUE SPACE. 02530000
025400*                                                                 02540000
025500*                                                                 02550000
025600 01  PS-PROGRAM-SWITCHES.                                         02560000
025700     05  PS-EOF-PBS-FILE-SW          PIC  X(01)    VALUE SPACE.   02570000
025800         88  PS-EOF-PBS-FILE                       VALUE 'Y'.     02580000
025900     05  PS-EOF-SW                   PIC  X(01)    VALUE SPACE.   02590000
026000         88  PS-EOF                                VALUE 'Y'.     02600000
026100     05  PS-PRINT-BLANK-LINE-SW      PIC  X(01)    VALUE SPACE.   02610000
026200         88  PS-PRINT-BLANK-LINE                   VALUE 'Y'.     02620000
026300         88  PS-DONT-PRINT-BLANK-LINE              VALUE 'N'.     02630000
026400     05  PS-XLT00010-CSR-SW           PIC X(01)  VALUE 'N'.       02640000
026500         88  PS-EOF-XLT00010-CSR                 VALUE 'Y'.       02650000
026600*                                                                 02660000
026700*                                                                 02670000
026800                                                                  02680000
026900 01 PC-PROGRAM-CONSTANTS.                                         02690000
027000     05  PC-MAX-RETRIES               PIC S9(04) VALUE +3         02700000
027100                                                 COMP SYNC.       02710000
027200     05  PC-PAGE-SIZE-066            PIC S9(04)    VALUE +066     02720000
027300                                                   COMP SYNC.     02730000
027400     05  PC-HEADING-SIZE             PIC S9(04)    VALUE +010     02740000
027500                                                   COMP SYNC.     02750000
027600     05  PC-MAX-TABLE-ENTRIES        PIC S9(04)    VALUE +20      02760000
027700                                                   COMP SYNC.     02770000
027800     05  PC-CURRENT-OPERATING-COMPANY                             02780000
027900                                     PIC  X(02)    VALUE '03'.    02790000
028000     05  PC-CURRENT-PROGRAM-NAME     PIC  X(08)    VALUE          02800000
028100         'RCKRP010'.                                              02810000
028200     05  PC-DASH                     PIC  X(01)    VALUE '-'.     02820000
028300     05  PC-SLASH                    PIC  X(01)    VALUE '/'.     02830000
028400     05  PC-COLON                    PIC  X(01)    VALUE ':'.     02840000
028500     05  PC-SPACE                    PIC  X(01)    VALUE ' '.     02850000
028600     05  PC-DC-MSG                   PIC  X(12)    VALUE          02860000
028700         'DC SPLIT QTY'.                                          02870000
028800*                                                                 02880000
028900*                                                                 02890000
029000 01  PV-PROGRAM-VARIABLES.                                        02900000
029100     05  PV-OPER-ID-QTY              PIC S9(09)    VALUE +0       02910000
029200                                                   COMP-3.        02920000
029300     05  PV-DIFFERENCE               PIC S9(09)    VALUE ZERO     02930000
029400                                                   COMP.          02940000
029500     05  PV-CURR-SPLIT-QTY           PIC S9(09)    VALUE ZERO     02950000
029600                                                   COMP.          02960000
029700     05  PV-DC-NBR                   PIC S9(04)    VALUE ZERO     02970000
029800                                                   COMP.          02980000
029900     05  PV-PO-NBR                   PIC S9(09)    VALUE ZERO     02990000
030000                                                   COMP.          03000000
030100     05  PV-PO-NBR-9                 PIC  9(08).                  03010000
030200     05  PV-PO-NBR-R REDEFINES PV-PO-NBR-9.                       03020000
030300         10  PV-PO-NBR-X             PIC  X(8).                   03030000
030400     05  PV-COMP-PO-QTY              PIC S9(11)    VALUE +0       03040000
030500                                                   COMP-3.        03050000
030600     05  PV-COMP-REC-QTY             PIC S9(11)    VALUE +0       03060000
030700                                                   COMP-3.        03070000
030800     05  PV-COMP-PO-AMT              PIC S9(12)V9(02) VALUE +0    03080000
030900                                                   COMP-3.        03090000
031000     05  PV-COMP-REC-AMT             PIC S9(12)V9(02) VALUE +0    03100000
031100                                                   COMP-3.        03110000
031200     05  PV-COMP-VAR-QTY             PIC S9(11)    VALUE +0       03120000
031300                                                   COMP-3.        03130000
031400     05  PV-COMP-VAR-AMT             PIC S9(10)V9(02) VALUE +0    03140000
031500                                                   COMP-3.        03150000
031600     05  PV-DIFF-QTY                 PIC S9(09)    VALUE +0       03160000
031700                                                   COMP-3.        03170000
031800     05  PV-TOTAL-QTY                PIC S9(09)    VALUE +0       03180000
031900                                                   COMP-3.        03190000
032000     05  PV-QTY                      PIC S9(09)    VALUE +0       03200000
032100                                                   COMP-3.        03210000
032200     05  PV-AMT                      PIC S9(08)V9(02) VALUE +0    03220000
032300                                                   COMP-3.        03230000
032400     05  PV-VAR-QTY                  PIC S9(09)    VALUE +0       03240000
032500                                                   COMP-3.        03250000
032600     05  PV-VAR-AMT                  PIC S9(08)V9(02) VALUE +0    03260000
032700                                                   COMP-3.        03270000
032800     05  PV-ABEND-CODE               PIC S9(04)      VALUE +0     03280000
032900                                                     COMP SYNC.   03290000
033000                                                                  03300000
033100     05  PV-DEPT                      PIC  X(03)  VALUE SPACES.   03310000
033200     05  PV-PURCHS-ENT-ID             PIC S9(09)  COMP            03320000
033300                                                  VALUE +0.       03330000
033400     05  PV-RETRY-COUNT               PIC S9(04)  VALUE +0        03340000
033500                                                  COMP SYNC.      03350000
033600     05  PV-LINES-USED               PIC S9(04)    VALUE ZERO     03360000
033700                                                   COMP SYNC.     03370000
033800     05  PV-BLANK-LINE               PIC  X(132)   VALUE SPACES.  03380000
033900*                                                                 03390000
034000     05  PV-PAGE-COUNT               PIC  9(05)    VALUE ZERO.    03400000
034100     05  PV-ABEND-PROGRAM             PIC X(8)   VALUE 'RCKUT004'.03410000
034200     05  PV-ABEND-PARAGRAPH           PIC X(50)  VALUE SPACES.    03420000
034300     05  PV-ABEND-OPERATION           PIC X(50)  VALUE SPACES.    03430000
034400     05  PV-ABEND-STRUCTURE-1         PIC X(8)   VALUE SPACES.    03440000
034500     05  PV-ABEND-STRUCTURE-2         PIC X(8)   VALUE SPACES.    03450000
034600     05  PV-ABEND-STRUCTURE-3         PIC X(8)   VALUE SPACES.    03460000
034700     05  PV-ABEND-STATUS              PIC XX     VALUE SPACES.    03470000
034800     05  PV-DB2-OPERATION-MESSAGE-1   PIC  X(79) VALUE SPACES.    03480000
034900     05  PV-DB2-OPERATION-MESSAGE-2   PIC  X(79) VALUE SPACES.    03490000
035000     05  PV-DB2-OPERATION-MESSAGE-3   PIC  X(79) VALUE SPACES.    03500000
035100     05  PV-DB2-OPERATION-MESSAGE-4   PIC  X(79) VALUE SPACES.    03510000
035200     05  PV-PARAGRAPH-NAME            PIC  X(30)  VALUE SPACES.   03520000
035300     05  PV-ERROR-MESSAGE-1           PIC  X(60)  VALUE SPACES.   03530000
035400     05  PV-ERROR-MESSAGE-2           PIC  X(60)  VALUE SPACES.   03540000
035500     05  PV-SQLCODE                   PIC 9(9)  VALUE ZERO.       03550000
035600/                                                                 03560000
035700*                                                                 03570000
035800*                                                                 03580000
035900 01  SD-SYSTEM-DATE.                                              03590000
036000     05  SD-SYSTEM-DATE-YY           PIC  9(02)      VALUE ZERO.  03600000
036100     05  SD-SYSTEM-DATE-MM           PIC  9(02)      VALUE ZERO.  03610000
036200     05  SD-SYSTEM-DATE-DD           PIC  9(02)      VALUE ZERO.  03620000
036300*                                                                 03630000
036400*                                                                 03640000
036500 01  ST-SYSTEM-TIME.                                              03650000
036600     05  ST-SYSTEM-HOUR              PIC  9(02)      VALUE ZERO.  03660000
036700     05  ST-SYSTEM-MINUTE            PIC  9(02)      VALUE ZERO.  03670000
036800     05  FILLER                      PIC  9(04)      VALUE ZERO.  03680000
036900*                                                                 03690000
037000*                                                                 03700000
037100 01  PBS-TABLE.                                                   03710000
037200     05  PBS-PO-TABLE    OCCURS 150 TIMES                         03720000
037300                         INDEXED BY PBS-IDX.                      03730000
037400         10 PBS-OPER-ID              PIC S9(09) COMP.             03740000
037500         10 PBS-PO-NBR               PIC S9(09) COMP.             03750000
037600         10 PBS-REC-SEQ              PIC S9(09) COMP.             03760000
037700         10 PBS-TRECDIS-QTY          PIC S9(09) COMP-3.           03770000
037800         10 PBS-TRECDIS-AMT          PIC S9(08)V9(02) COMP-3.     03780000
037900*                                                                 03790000
038000/                                                                 03800000
038100*                                                                 03810000
038200******************************************************************03820000
038300*  USED FOR DB2 ERROR MESSAGE BUILDING                            03830000
038400******************************************************************03840000
038500     COPY DPWS004.                                                03850000
038600*                                                                 03860000
038700/                                                                 03870000
038800******************************************************************03880000
038900*   DB2 SQL COMMUNICATION AREA                                    03890000
039000******************************************************************03900000
039100     EXEC SQL                                                     03910000
039200          INCLUDE SQLCA                                           03920000
039300     END-EXEC.                                                    03930000
039400                                                                  03940000
039500******************************************************************03950000
039600*  DCLGEN FOR THE DB2 PURCHASE ORDER TABLE                        03960000
039700******************************************************************03970000
039800     EXEC SQL                                                     03980000
039900         INCLUDE TPURCHS                                          03990000
040000     END-EXEC.                                                    04000000
040100                                                                  04010000
040200******************************************************************04020000
040300*   DB2 DCLGEN FOR TVNDDPT TABLE                                  04030000
040400******************************************************************04040000
040500     EXEC SQL                                                     04050000
040600          INCLUDE TVNDDPT                                         04060000
040700     END-EXEC.                                                    04070000
040800                                                                  04080000
040900******************************************************************04090000
041000*   DB2 DCLGEN FOR TEXTENT TABLE                                  04100000
041100******************************************************************04110000
041200     EXEC SQL                                                     04120000
041300          INCLUDE TEXTENT                                         04130000
041400     END-EXEC.                                                    04140000
041500                                                                  04150000
041600******************************************************************04160000
041700*   DB2 DCLGEN FOR TENTNME TABLE                                  04170000
041800******************************************************************04180000
041900     EXEC SQL                                                     04190000
042000          INCLUDE TENTNME                                         04200000
042100     END-EXEC.                                                    04210000
042200                                                                  04220000
042300******************************************************************04230000
042400*   DB2 DCLGEN FOR TSK TABLE                                      04240000
042500******************************************************************04250000
042600     EXEC SQL                                                     04260000
042700          INCLUDE TSK                                             04270000
042800     END-EXEC.                                                    04280000
042900                                                                  04290000
043000******************************************************************04300000
043100*   DB2 DCLGEN FOR TALLPLN TABLE                                  04310000
043200******************************************************************04320000
043300     EXEC SQL                                                     04330000
043400          INCLUDE TALLPLN                                         04340000
043500     END-EXEC.                                                    04350000
043600                                                                  04360000
043700******************************************************************04370000
043800*  DCLGEN FOR THE LOCATION TABLE                                  04380000
043900******************************************************************04390000
044000     EXEC SQL                                                     04400000
044100         INCLUDE XLT00010                                         04410000
044200     END-EXEC.                                                    04420000
044300                                                                  04430000
044400******************************************************************04440000
044500*  XLT00010 CURSOR                                                04450000
044600******************************************************************04460000
044700     EXEC SQL                                                     04470000
044800          DECLARE XLT00010-CSR CURSOR WITH HOLD FOR               04480000
044900           SELECT LOC_NBR                                         04490000
045000           FROM   XLT_LOC                                         04500000
045100          WHERE LOC_TYP_CDE = 'DC'                                04510000
045200           AND  CLO_DTE     >= CURRENT DATE                       04520000
045300     END-EXEC.                                                    04530000
045400                                                                  04540000
045500******************************************************************04550000
045600 PROCEDURE DIVISION.                                              04560000
045700******************************************************************04570000
045800                                                                  04580000
045900 0000-PROGRAM-MAINLINE.                                           04590000
046000******************************************************************04600000
046100* 0000-PROGRAM-MAINLINE - CONTROLS THE MAIN PROCESSING OF THE     04610000
046200*      PROGRAM.                                                   04620000
046300******************************************************************04630000
046400                                                                  04640000
046500     INITIALIZE DC-TABLE.                                         04650000
046600     PERFORM 1000-INITIALIZE.                                     04660000
046700                                                                  04670000
046800     PERFORM 2000-LOOP                                            04680000
046900       UNTIL PS-EOF-PBS-FILE.                                     04690000
047000                                                                  04700000
047100     PERFORM 4000-GET-PO-INFO.                                    04710000
047200     IF  PV-QTY > PURCHS-TOT-UNT-QTY                              04720000
047300         COMPUTE PV-VAR-QTY = PV-QTY - PURCHS-TOT-UNT-QTY         04730000
047400         MOVE PV-VAR-QTY TO DL-VAR-PIECES                         04740000
047500         COMPUTE PV-VAR-AMT = PV-AMT - PURCHS-TOT-VAL-RTL-AMT     04750000
047600         MOVE PV-VAR-AMT TO DL-VAR-RETAIL                         04760000
047700         ADD +1                      TO PV-DIFF-QTY               04770000
047800                                        PV-TOTAL-QTY              04780000
047900         MOVE PV-PO-NBR              TO PV-PO-NBR-9               04790000
048000         MOVE PV-PO-NBR-X            TO DL-PO-NBR                 04800000
048100         MOVE PURCHS-TOT-UNT-QTY     TO DL-PO-PIECES              04810000
048200         MOVE PURCHS-TOT-VAL-RTL-AMT TO DL-PO-RETAIL              04820000
048300         MOVE PV-QTY                 TO DL-REC-PIECES             04830000
048400         MOVE PV-AMT                 TO DL-REC-RETAIL             04840000
048500                                                                  04850000
048600         ADD PURCHS-TOT-UNT-QTY      TO PV-COMP-PO-QTY            04860000
048700         ADD PURCHS-TOT-VAL-RTL-AMT  TO PV-COMP-PO-AMT            04870000
048800         ADD PV-QTY                  TO PV-COMP-REC-QTY           04880000
048900         ADD PV-AMT                  TO PV-COMP-REC-AMT           04890000
049000                                                                  04900000
049100         PERFORM 6000-GET-VENDOR-INFO                             04910000
049200         PERFORM 8100-WRITE-PBS-REVIEW-DETAIL                     04920000
049300         MOVE '-'                    TO DL-DASH2                  04930000
049400         PERFORM 5000-WRITE-DETAIL                                04940000
049500            VARYING PBS-IDX FROM 1 BY 1                           04950000
049600            UNTIL (PBS-IDX > 150                                  04960000
049700            OR PBS-PO-NBR (PBS-IDX) = ZERO)                       04970000
049800         PERFORM 8300-WRITE-BLANK-LINE                            04980000
049900         MOVE PC-DC-MSG TO DL-MSG4                                04990000
050000         PERFORM 6500-TALLPLN-INFO                                05000000
050100             VARYING DC-IDX FROM 1 BY 1                           05010000
050200             UNTIL (DC-IDX > 50                                   05020000
050300             OR DC-NBR (DC-IDX) = ZERO)                           05030000
050400     END-IF.                                                      05040000
050500                                                                  05050000
050600     PERFORM 9000-EOJ-ROUTINE.                                    05060000
050700     STOP RUN.                                                    05070000
050800*0000-EXIT.                                                       05080000
050900*                                                                 05090000
051000*                                                                 05100000
051100 1000-INITIALIZE.                                                 05110000
051200******************************************************************05120000
051300*  DO FIRST TIME PROGRAM INITIALIZATION TASKS.                    05130000
051400*    -- OPEN FILES                                                05140000
051500*    -- SET UP AND PRINT REPORT HEADINGS                          05150000
051600******************************************************************05160000
051700     OPEN INPUT  PBS-FILE                                         05170000
051800          OUTPUT PBS-REVIEW-RPT-FILE.                             05180000
051900*                                                                 05190000
052000     ACCEPT CC-CONTROL-CARD FROM SYSIN.                           05200000
052100     PERFORM 1100-VALIDATE-CONTROL-CARD.                          05210000
052200     MOVE CC-START-MONTH         TO  HL2-START-MONTH.             05220000
052300     MOVE CC-START-DAY           TO  HL2-START-DAY.               05230000
052400     MOVE CC-START-YEAR          TO  HL2-START-YEAR.              05240000
052500                                                                  05250000
052600     MOVE CC-END-MONTH           TO  HL2-END-MONTH.               05260000
052700     MOVE CC-END-DAY             TO  HL2-END-DAY.                 05270000
052800     MOVE CC-END-YEAR            TO  HL2-END-YEAR.                05280000
052900                                                                  05290000
053000     ACCEPT SD-SYSTEM-DATE FROM DATE.                             05300000
053100     ACCEPT ST-SYSTEM-TIME FROM TIME.                             05310000
053200     MOVE SD-SYSTEM-DATE-YY      TO DP132O-RUN-YEAR.              05320000
053300     MOVE SD-SYSTEM-DATE-MM      TO DP132O-RUN-MONTH.             05330000
053400     MOVE SD-SYSTEM-DATE-DD      TO DP132O-RUN-DAY.               05340000
053500     MOVE ST-SYSTEM-HOUR         TO DP132O-RUN-HOUR.              05350000
053600     MOVE ST-SYSTEM-MINUTE       TO DP132O-RUN-MINUTE.            05360000
053700     MOVE PC-CURRENT-PROGRAM-NAME                                 05370000
053800                                 TO DP132O-PROGRAM-NAME.          05380000
053900     MOVE 1                      TO DP132O-REPORT-NUMBER.         05390000
054000     PERFORM 8000-WRITE-PAGE-HEADINGS.                            05400000
054100     PERFORM 7000-READ-PBS-FILE.                                  05410000
054200     IF  PS-EOF-PBS-FILE                                          05420000
054300         CONTINUE                                                 05430000
054400     ELSE                                                         05440000
054500         MOVE RC050-PO-NBR TO PV-PO-NBR                           05450000
054600         INITIALIZE PBS-TABLE                                     05460000
054700     END-IF.                                                      05470000
054800                                                                  05480000
054900     PERFORM 7600-OPEN-XLT00010-CSR.                              05490000
055000     PERFORM 7610-FETCH-XLT00010-CSR.                             05500000
055100     PERFORM 1005-PROCESS-DC-TBL                                  05510000
055200        VARYING DC-IDX FROM 1 BY 1                                05520000
055300         UNTIL PS-EOF-XLT00010-CSR                                05530000
055400            OR DC-IDX > 50.                                       05540000
055500     PERFORM 7620-CLOSE-XLT00010-CSR.                             05550000
055600                                                                  05560000
055700*                                                                 05570000
055800*-----------------------------------------------------------------05580000
055900 1005-PROCESS-DC-TBL.                                             05590000
056000     MOVE XLT00010-LOC-NBR TO DC-NBR (DC-IDX).                    05600000
056100     PERFORM 7610-FETCH-XLT00010-CSR.                             05610000
056200                                                                  05620000
056300******************************************************************05630000
056400*  VALIDATES CONTROL CARD INFORMATION, INSURING ALL DATA          05640000
056500*  SUPPLIED IS WITHIN VALID VALUES.                               05650000
056600******************************************************************05660000
056700 1100-VALIDATE-CONTROL-CARD.                                      05670000
056800     IF CC-START-MONTH NUMERIC                                    05680000
056900         IF CC-VALID-START-MONTH                                  05690000
057000             CONTINUE                                             05700000
057100         ELSE                                                     05710000
057200             DISPLAY '** ABEND **'                                05720000
057300             DISPLAY '** PROGRAM   = ' PC-CURRENT-PROGRAM-NAME    05730000
057400             DISPLAY '** PARAGRAPH = 1100-VALIDATE-CONTROL-CARD'  05740000
057500             DISPLAY '** INVALID START MONTH ENTERED'             05750000
057600             DISPLAY '** START MONTH ENTERED = ' CC-START-MONTH   05760000
057700             DISPLAY '** VALID MONTH VALUES ARE 01 THRU 12'       05770000
057800             PERFORM 9200-ABEND                                   05780000
057900         END-IF                                                   05790000
058000     ELSE                                                         05800000
058100         DISPLAY '** ABEND **'                                    05810000
058200         DISPLAY '** PROGRAM   = ' PC-CURRENT-PROGRAM-NAME        05820000
058300         DISPLAY '** PARAGRAPH = 1100-VALIDATE-CONTROL-CARD'      05830000
058400         DISPLAY '** START MONTH ENTERED IS NOT NUMERIC'          05840000
058500         DISPLAY '** START MONTH ENTERED = ' CC-START-MONTH       05850000
058600         DISPLAY '** VALID MONTH VALUES ARE 01 THRU 12'           05860000
058700         PERFORM 9200-ABEND                                       05870000
058800     END-IF.                                                      05880000
058900                                                                  05890000
059000     IF CC-START-DAY NUMERIC                                      05900000
059100         IF CC-VALID-START-DAY                                    05910000
059200             CONTINUE                                             05920000
059300         ELSE                                                     05930000
059400             DISPLAY '** ABEND **'                                05940000
059500             DISPLAY '** PROGRAM   = ' PC-CURRENT-PROGRAM-NAME    05950000
059600             DISPLAY '** PARAGRAPH = 1100-VALIDATE-CONTROL-CARD'  05960000
059700             DISPLAY '** INVALID START DAY ENTERED'               05970000
059800             DISPLAY '** START DAY ENTERED = ' CC-START-DAY       05980000
059900             DISPLAY '** VALID DAY VALUES ARE 01 THRU 31'         05990000
060000             PERFORM 9200-ABEND                                   06000000
060100         END-IF                                                   06010000
060200     ELSE                                                         06020000
060300         DISPLAY '** ABEND **'                                    06030000
060400         DISPLAY '** PROGRAM   = ' PC-CURRENT-PROGRAM-NAME        06040000
060500         DISPLAY '** PARAGRAPH = 1100-VALIDATE-CONTROL-CARD'      06050000
060600         DISPLAY '** START DAY ENTERED IS NOT NUMERIC'            06060000
060700         DISPLAY '** START DAY ENTERED = ' CC-START-DAY           06070000
060800         DISPLAY '** VALID DAY VALUES ARE 01 THRU 31'             06080000
060900         PERFORM 9200-ABEND                                       06090000
061000     END-IF.                                                      06100000
061100                                                                  06110000
061200     IF CC-START-YEAR NUMERIC                                     06120000
061300         CONTINUE                                                 06130000
061400     ELSE                                                         06140000
061500         DISPLAY '** ABEND **'                                    06150000
061600         DISPLAY '** PROGRAM   = ' PC-CURRENT-PROGRAM-NAME        06160000
061700         DISPLAY '** PARAGRAPH = 1100-VALIDATE-CONTROL-CARD'      06170000
061800         DISPLAY '** START YEAR ENTERED IS NOT NUMERIC'           06180000
061900         DISPLAY '** START YEAR ENTERED = ' CC-START-YEAR         06190000
062000         DISPLAY '** CHANGE TO A VALID YEAR VALUE'                06200000
062100         PERFORM 9200-ABEND                                       06210000
062200     END-IF.                                                      06220000
062300                                                                  06230000
062400     IF CC-END-MONTH NUMERIC                                      06240000
062500         IF CC-VALID-END-MONTH                                    06250000
062600             CONTINUE                                             06260000
062700         ELSE                                                     06270000
062800             DISPLAY '** ABEND **'                                06280000
062900             DISPLAY '** PROGRAM   = ' PC-CURRENT-PROGRAM-NAME    06290000
063000             DISPLAY '** PARAGRAPH = 1100-VALIDATE-CONTROL-CARD'  06300000
063100             DISPLAY '** INVALID END MONTH ENTERED'               06310000
063200             DISPLAY '** END MONTH ENTERED = ' CC-END-MONTH       06320000
063300             DISPLAY '** VALID MONTH VALUES ARE 01 THRU 12'       06330000
063400             PERFORM 9200-ABEND                                   06340000
063500         END-IF                                                   06350000
063600     ELSE                                                         06360000
063700         DISPLAY '** ABEND **'                                    06370000
063800         DISPLAY '** PROGRAM   = ' PC-CURRENT-PROGRAM-NAME        06380000
063900         DISPLAY '** PARAGRAPH = 1100-VALIDATE-CONTROL-CARD'      06390000
064000         DISPLAY '** END MONTH ENTERED IS NOT NUMERIC'            06400000
064100         DISPLAY '** END MONTH ENTERED = ' CC-END-MONTH           06410000
064200         DISPLAY '** VALID MONTH VALUES ARE 01 THRU 12'           06420000
064300         PERFORM 9200-ABEND                                       06430000
064400     END-IF.                                                      06440000
064500                                                                  06450000
064600     IF CC-END-DAY NUMERIC                                        06460000
064700         IF CC-VALID-END-DAY                                      06470000
064800             CONTINUE                                             06480000
064900         ELSE                                                     06490000
065000             DISPLAY '** ABEND **'                                06500000
065100             DISPLAY '** PROGRAM   = ' PC-CURRENT-PROGRAM-NAME    06510000
065200             DISPLAY '** PARAGRAPH = 1100-VALIDATE-CONTROL-CARD'  06520000
065300             DISPLAY '** INVALID END DAY ENTERED'                 06530000
065400             DISPLAY '** END DAY ENTERED = ' CC-END-DAY           06540000
065500             DISPLAY '** VALID DAY VALUES ARE 01 THRU 31'         06550000
065600             PERFORM 9200-ABEND                                   06560000
065700         END-IF                                                   06570000
065800     ELSE                                                         06580000
065900         DISPLAY '** ABEND **'                                    06590000
066000         DISPLAY '** PROGRAM   = ' PC-CURRENT-PROGRAM-NAME        06600000
066100         DISPLAY '** PARAGRAPH = 1100-VALIDATE-CONTROL-CARD'      06610000
066200         DISPLAY '** END DAY ENTERED IS NOT NUMERIC'              06620000
066300         DISPLAY '** END DAY ENTERED = ' CC-END-DAY               06630000
066400         DISPLAY '** VALID DAY VALUES ARE 01 THRU 31'             06640000
066500         PERFORM 9200-ABEND                                       06650000
066600     END-IF.                                                      06660000
066700                                                                  06670000
066800     IF CC-END-YEAR NUMERIC                                       06680000
066900         CONTINUE                                                 06690000
067000     ELSE                                                         06700000
067100         DISPLAY '** ABEND **'                                    06710000
067200         DISPLAY '** PROGRAM   = ' PC-CURRENT-PROGRAM-NAME        06720000
067300         DISPLAY '** PARAGRAPH = 1100-VALIDATE-CONTROL-CARD'      06730000
067400         DISPLAY '** END YEAR ENTERED IS NOT NUMERIC'             06740000
067500         DISPLAY '** END YEAR ENTERED = ' CC-END-YEAR             06750000
067600         DISPLAY '** CHANGE TO A VALID YEAR VALUE'                06760000
067700         PERFORM 9200-ABEND                                       06770000
067800     END-IF.                                                      06780000
067900*1100-EXIT.                                                       06790000
068000*                                                                 06800000
068100*                                                                 06810000
068200*                                                                 06820000
068300 2000-LOOP.                                                       06830000
068400******************************************************************06840000
068500*  BUILD THE LINES FOR THE REPORT.                                06850000
068600******************************************************************06860000
068700                                                                  06870000
068800     IF RC050-PO-NBR = PV-PO-NBR                                  06880000
068900        PERFORM 3000-PO-LOOP                                      06890000
069000           VARYING PBS-IDX FROM 1 BY 1                            06900000
069100           UNTIL (PBS-IDX > 150                                   06910000
069200           OR PS-EOF-PBS-FILE                                     06920000
069300           OR RC050-PO-NBR NOT = PV-PO-NBR)                       06930000
069400     ELSE                                                         06940000
069500         PERFORM 4000-GET-PO-INFO                                 06950000
069600         IF  PV-QTY > PURCHS-TOT-UNT-QTY                          06960000
069700             COMPUTE PV-VAR-QTY = PV-QTY - PURCHS-TOT-UNT-QTY     06970000
069800             MOVE PV-VAR-QTY TO DL-VAR-PIECES                     06980000
069900             COMPUTE PV-VAR-AMT = PV-AMT - PURCHS-TOT-VAL-RTL-AMT 06990000
070000             MOVE PV-VAR-AMT TO DL-VAR-RETAIL                     07000000
070100             ADD +1                      TO PV-DIFF-QTY           07010000
070200                                            PV-TOTAL-QTY          07020000
070300             MOVE PV-PO-NBR              TO PV-PO-NBR-9           07030000
070400             MOVE PV-PO-NBR-X            TO DL-PO-NBR             07040000
070500             MOVE PURCHS-TOT-UNT-QTY     TO DL-PO-PIECES          07050000
070600             MOVE PURCHS-TOT-VAL-RTL-AMT TO DL-PO-RETAIL          07060000
070700             MOVE PV-QTY                 TO DL-REC-PIECES         07070000
070800             MOVE PV-AMT                 TO DL-REC-RETAIL         07080000
070900                                                                  07090000
071000             ADD PURCHS-TOT-VAL-RTL-AMT TO PV-COMP-PO-AMT         07100000
071100             ADD PURCHS-TOT-UNT-QTY TO PV-COMP-PO-QTY             07110000
071200             ADD PV-AMT TO PV-COMP-REC-AMT                        07120000
071300             ADD PV-QTY TO PV-COMP-REC-QTY                        07130000
071400                                                                  07140000
071500             PERFORM 6000-GET-VENDOR-INFO                         07150000
071600             PERFORM 8100-WRITE-PBS-REVIEW-DETAIL                 07160000
071700             MOVE '-'                    TO DL-DASH2              07170000
071800             PERFORM 5000-WRITE-DETAIL                            07180000
071900                VARYING PBS-IDX FROM 1 BY 1                       07190000
072000                UNTIL (PBS-IDX > 150                              07200000
072100                OR PBS-PO-NBR (PBS-IDX) = ZERO)                   07210000
072200             PERFORM 8300-WRITE-BLANK-LINE                        07220000
072300             MOVE PC-DC-MSG TO DL-MSG4                            07230000
072400             PERFORM 6500-TALLPLN-INFO                            07240000
072500                 VARYING DC-IDX FROM 1 BY 1                       07250000
072600                 UNTIL (DC-IDX > 50                               07260000
072700                 OR DC-NBR (DC-IDX) = ZERO)                       07270000
072800             INITIALIZE PBS-TABLE                                 07280000
072900             MOVE +0 TO PV-QTY                                    07290000
073000                        PV-AMT                                    07300000
073100             MOVE RC050-PO-NBR TO PV-PO-NBR                       07310000
073200         ELSE                                                     07320000
073300             ADD +1 TO PV-TOTAL-QTY                               07330000
073400             INITIALIZE PBS-TABLE                                 07340000
073500             MOVE +0 TO PV-QTY                                    07350000
073600                        PV-AMT                                    07360000
073700             MOVE RC050-PO-NBR TO PV-PO-NBR                       07370000
073800         END-IF                                                   07380000
073900     END-IF.                                                      07390000
074000                                                                  07400000
074100*                                                                 07410000
074200*                                                                 07420000
074300*2000-EXIT.                                                       07430000
074400*                                                                 07440000
074500*                                                                 07450000
074600 3000-PO-LOOP.                                                    07460000
074700                                                                  07470000
074800     MOVE RC050-OPER-ID     TO PBS-OPER-ID (PBS-IDX)              07480000
074900     MOVE RC050-PO-NBR      TO PBS-PO-NBR (PBS-IDX)               07490000
075000     MOVE RC050-REC-SEQ-NBR TO PBS-REC-SEQ (PBS-IDX)              07500000
075100     MOVE RC050-TRECDIS-QTY TO PBS-TRECDIS-QTY (PBS-IDX)          07510000
075200     MOVE RC050-TRECDIS-AMT TO PBS-TRECDIS-AMT (PBS-IDX)          07520000
075300     ADD RC050-TRECDIS-QTY  TO PV-QTY.                            07530000
075400     ADD RC050-TRECDIS-AMT  TO PV-AMT.                            07540000
075500                                                                  07550000
075600     PERFORM 7000-READ-PBS-FILE.                                  07560000
075700*                                                                 07570000
075800*                                                                 07580000
075900 4000-GET-PO-INFO.                                                07590000
076000     PERFORM                                                      07600000
076100         WITH TEST AFTER                                          07610000
076200         VARYING PV-RETRY-COUNT                                   07620000
076300         FROM 1 BY 1                                              07630000
076400         UNTIL ((PV-RETRY-COUNT > PC-MAX-RETRIES)                 07640000
076500             OR (SQLCODE = +0)                                    07650000
076600             OR (SQLCODE = +100))                                 07660000
076700                                                                  07670000
076800**                                                                07680000
076900         EXEC SQL                                                 07690000
077000              SELECT TOT_UNT_QTY                                  07700000
077100                    ,TOT_VAL_RTL_AMT                              07710000
077200                    ,DEPT_NBR                                     07720000
077300                    ,ENT_ID                                       07730000
077400              INTO   :PURCHS-TOT-UNT-QTY                          07740000
077500                    ,:PURCHS-TOT-VAL-RTL-AMT                      07750000
077600                    ,:PV-DEPT                                     07760000
077700                    ,:PV-PURCHS-ENT-ID                            07770000
077800                                                                  07780000
077900              FROM  TPURCHS                                       07790000
078000              WHERE PO_NBR         = :PV-PO-NBR                   07800000
078100                AND VER_STATUS_CDE = 'A'                          07810000
078200         END-EXEC                                                 07820000
078300                                                                  07830000
078400         EVALUATE TRUE                                            07840000
078500             WHEN SQLCODE = ZERO                                  07850000
078600                  CONTINUE                                        07860000
078700*            WHEN SQLCODE = +100                                  07870000
078800             WHEN OTHER                                           07880000
078900                  MOVE '4000-GET-PO-INFO'                         07890000
079000                               TO PV-ABEND-PARAGRAPH              07900000
079100                  MOVE 'SELECT TPURCHS'                           07910000
079200                               TO PV-ABEND-OPERATION              07920000
079300                  MOVE 'TPURCHS'   TO PV-ABEND-STRUCTURE-1        07930000
079400                  MOVE SPACES      TO PV-ABEND-STRUCTURE-2        07940000
079500                  MOVE 'CURRENT PO BEING PROCESSED ID:         '  07950000
079600                                 TO PV-DB2-OPERATION-MESSAGE-1    07960000
079700                  MOVE PV-PO-NBR                                  07970000
079800                                   TO PV-DB2-OPERATION-MESSAGE-2  07980000
079900                  PERFORM 9900-DB2-ABEND                          07990000
080000         END-EVALUATE                                             08000000
080100     END-PERFORM.                                                 08010000
080200                                                                  08020000
080300     IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          08030000
080400         MOVE '4000-GET-PO-INFO'                                  08040000
080500                                 TO PV-ABEND-PARAGRAPH            08050000
080600         MOVE 'MAX RETRIES EXCEEDED'                              08060000
080700                                 TO PV-ABEND-OPERATION            08070000
080800         PERFORM 9900-DB2-ABEND                                   08080000
080900     END-IF.                                                      08090000
081000                                                                  08100000
081100*                                                                 08110000
081200/                                                                 08120000
081300 5000-WRITE-DETAIL.                                               08130000
081400     MOVE PBS-OPER-ID (PBS-IDX)        TO DL-OPER-ID2.            08140000
081500     MOVE PBS-REC-SEQ (PBS-IDX)        TO DL-REC-SEQ2.            08150000
081600     MOVE PBS-TRECDIS-QTY (PBS-IDX)    TO DL-REC-PIECES2.         08160000
081700     MOVE PBS-TRECDIS-AMT (PBS-IDX)    TO DL-REC-RETAIL2.         08170000
081800     PERFORM 8200-WRITE-PBS-REVIEW-DETAIL3.                       08180000
081900*                                                                 08190000
082000 5500-ADD-OPER-ID.                                                08200000
082100     IF  PBS-OPER-ID (PBS-IDX) = DC-NBR (DC-IDX)                  08210000
082200         ADD PBS-TRECDIS-QTY (PBS-IDX) TO PV-OPER-ID-QTY          08220000
082300     END-IF.                                                      08230000
082400/                                                                 08240000
082500 6000-GET-VENDOR-INFO.                                            08250000
082600                                                                  08260000
082700     EXEC SQL                                                     08270000
082800          SELECT ENT_ID                                           08280000
082900          INTO :VNDDPT-ENT-ID                                     08290000
083000          FROM TVNDDPT                                            08300000
083100          WHERE DEPT_NBR       = :PV-DEPT                         08310000
083200            AND  ENT_ID        = :PV-PURCHS-ENT-ID                08320000
083300     END-EXEC.                                                    08330000
083400                                                                  08340000
083500     EVALUATE TRUE                                                08350000
083600         WHEN SQLCODE = +0                                        08360000
083700             PERFORM 6200-TENTNME-INFO                            08370000
083800         WHEN SQLCODE = +100                                      08380000
083900             MOVE SPACES                TO DL-VENDOR              08390000
084000         WHEN OTHER                                               08400000
084100              MOVE '6000-GET-VENDOR-INFO'                         08410000
084200                           TO PV-ABEND-PARAGRAPH                  08420000
084300              MOVE 'SELECT TENTNME CURSOR'                        08430000
084400                           TO PV-ABEND-OPERATION                  08440000
084500              MOVE 'TVNDDPT'   TO PV-ABEND-STRUCTURE-1            08450000
084600              MOVE PV-DEPT     TO PV-ABEND-STRUCTURE-2            08460000
084700              PERFORM 9900-DB2-ABEND                              08470000
084800     END-EVALUATE.                                                08480000
084900/                                                                 08490000
085000 6200-TENTNME-INFO.                                               08500000
085100                                                                  08510000
085200     EXEC SQL                                                     08520000
085300          SELECT ENT_NAME_DESC                                    08530000
085400          INTO :ENTNME-ENT-NAME-DESC                              08540000
085500          FROM TENTNME                                            08550000
085600          WHERE ENT_ID         = :PV-PURCHS-ENT-ID                08560000
085700            AND TYPE_CDE       = '01'                             08570000
085800     END-EXEC.                                                    08580000
085900                                                                  08590000
086000     EVALUATE TRUE                                                08600000
086100         WHEN SQLCODE = +0                                        08610000
086200             MOVE ENTNME-ENT-NAME-DESC  TO DL-VENDOR              08620000
086300         WHEN SQLCODE = +100                                      08630000
086400             MOVE SPACES                TO DL-VENDOR              08640000
086500         WHEN OTHER                                               08650000
086600              MOVE '6200-TENTNME-INFO'                            08660000
086700                           TO PV-ABEND-PARAGRAPH                  08670000
086800              MOVE 'SELECT TENTNME CURSOR'                        08680000
086900                           TO PV-ABEND-OPERATION                  08690000
087000              MOVE 'TENTNME'   TO PV-ABEND-STRUCTURE-1            08700000
087100              MOVE PV-DEPT     TO PV-ABEND-STRUCTURE-2            08710000
087200              PERFORM 9900-DB2-ABEND                              08720000
087300     END-EVALUATE.                                                08730000
087400/                                                                 08740000
087500 6500-TALLPLN-INFO.                                               08750000
087600                                                                  08760000
087700     MOVE DC-NBR (DC-IDX) TO PV-DC-NBR.                           08770000
087800                                                                  08780000
087900     EXEC SQL                                                     08790000
088000          SELECT SUM(CURR_SPLIT_QTY)                              08800000
088100          INTO :PV-CURR-SPLIT-QTY                                 08810000
088200          FROM TALLPLN                                            08820000
088300          WHERE PO_NBR         = :PV-PO-NBR                       08830000
088400            AND DEST_NBR       = :PV-DC-NBR                       08840000
088500     END-EXEC.                                                    08850000
088600                                                                  08860000
088700     EVALUATE TRUE                                                08870000
088800         WHEN SQLCODE = +0                                        08880000
088900             MOVE DC-NBR (DC-IDX)       TO DL-OPER-ID4            08890000
089000             MOVE PV-CURR-SPLIT-QTY     TO DL-TALLPLN-QTY         08900000
089100             MOVE +0 TO PV-OPER-ID-QTY                            08910000
089200             PERFORM 5500-ADD-OPER-ID                             08920000
089300                VARYING PBS-IDX FROM 1 BY 1                       08930000
089400                UNTIL (PBS-IDX > 150                              08940000
089500                OR PBS-PO-NBR (PBS-IDX) = ZERO)                   08950000
089600             COMPUTE PV-DIFFERENCE = PV-OPER-ID-QTY               08960000
089700                                   - PV-CURR-SPLIT-QTY            08970000
089800             MOVE PV-DIFFERENCE TO DL-DIFFER4                     08980000
089900             PERFORM  8150-WRITE-PBS-REVIEW-DETAIL                08990000
090000             MOVE SPACES TO DL-MSG4                               09000000
090100         WHEN SQLCODE = -305                                      09010000
090200              CONTINUE                                            09020000
090300*        WHEN SQLCODE = +100                                      09030000
090400         WHEN OTHER                                               09040000
090500              MOVE '6500-TALLPLN-INFO'                            09050000
090600                           TO PV-ABEND-PARAGRAPH                  09060000
090700              MOVE 'SELECT TALLPLN CURSOR'                        09070000
090800                           TO PV-ABEND-OPERATION                  09080000
090900              MOVE 'TALLPLN'   TO PV-ABEND-STRUCTURE-1            09090000
091000              MOVE PV-PO-NBR   TO PV-ABEND-STRUCTURE-2            09100000
091100              PERFORM 9900-DB2-ABEND                              09110000
091200     END-EVALUATE.                                                09120000
091300/                                                                 09130000
091400*                                                                 09140000
091500 7000-READ-PBS-FILE.                                              09150000
091600******************************************************************09160000
091700*  READ THE PBS FILE                                             *09170000
091800******************************************************************09180000
091900     READ PBS-FILE                                                09190000
092000       INTO RC050-RECORD                                          09200000
092100         AT END                                                   09210000
092200           SET PS-EOF-PBS-FILE TO TRUE.                           09220000
092300*                                                                 09230000
092400*                                                                 09240000
092500                                                                  09250000
092600 7600-OPEN-XLT00010-CSR.                                          09260000
092700     PERFORM                                                      09270000
092800         WITH TEST AFTER                                          09280000
092900         VARYING PV-RETRY-COUNT                                   09290000
093000         FROM 1 BY 1                                              09300000
093100         UNTIL ((PV-RETRY-COUNT > PC-MAX-RETRIES)                 09310000
093200            OR  (SQLCODE = +0))                                   09320000
093300                                                                  09330000
093400         EXEC SQL                                                 09340000
093500             OPEN XLT00010-CSR                                    09350000
093600         END-EXEC                                                 09360000
093700                                                                  09370000
093800         EVALUATE TRUE                                            09380000
093900             WHEN SQLCODE = +0                                    09390000
094000             WHEN SQLCODE = -904                                  09400000
094100             WHEN SQLCODE = -913                                  09410000
094200                  CONTINUE                                        09420000
094300             WHEN SQLWARN0 NOT = SPACE                            09430000
094400             WHEN SQLCODE  NOT = +0                               09440000
094500                  MOVE '7600-OPEN-XLT00010-CURSOR'                09450000
094600                                 TO PV-ABEND-PARAGRAPH            09460000
094700                  MOVE 'OPEN XLT00010 CURSOR'                     09470000
094800                                 TO PV-ABEND-OPERATION            09480000
094900                  MOVE 'XLT_LOC '  TO PV-ABEND-STRUCTURE-1        09490000
095000                  MOVE SPACES      TO PV-ABEND-STRUCTURE-2        09500000
095100                  PERFORM 9900-DB2-ABEND                          09510000
095200         END-EVALUATE                                             09520000
095300     END-PERFORM.                                                 09530000
095400                                                                  09540000
095500     IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          09550000
095600         MOVE '7600-OPEN-XLT00010-CURSOR'                         09560000
095700                                 TO PV-ABEND-PARAGRAPH            09570000
095800         MOVE 'MAX RETRIES EXCEEDED'                              09580000
095900                                 TO PV-ABEND-OPERATION            09590000
096000         PERFORM 9900-DB2-ABEND                                   09600000
096100     END-IF.                                                      09610000
096200                                                                  09620000
096300 7610-FETCH-XLT00010-CSR.                                         09630000
096400                                                                  09640000
096500     EXEC SQL                                                     09650000
096600          FETCH XLT00010-CSR                                      09660000
096700           INTO   :XLT00010-LOC-NBR                               09670000
096800     END-EXEC.                                                    09680000
096900                                                                  09690000
097000     EVALUATE TRUE                                                09700000
097100         WHEN SQLCODE = +0                                        09710000
097200              CONTINUE                                            09720000
097300         WHEN SQLCODE = +100                                      09730000
097400              SET  PS-EOF-XLT00010-CSR TO TRUE                    09740000
097500         WHEN SQLWARN0 NOT = SPACE                                09750000
097600         WHEN SQLCODE  NOT = +0                                   09760000
097700              MOVE '7610-FETCH-XLT00010-CSR'                      09770000
097800                                   TO PV-ABEND-PARAGRAPH          09780000
097900              MOVE 'FETCH XLT00010 CURSOR'                        09790000
098000                                   TO PV-ABEND-OPERATION          09800000
098100              MOVE 'XLT_LOC '      TO PV-ABEND-STRUCTURE-1        09810000
098200              MOVE SPACES          TO PV-ABEND-STRUCTURE-2        09820000
098300              PERFORM 9900-DB2-ABEND                              09830000
098400     END-EVALUATE.                                                09840000
098500                                                                  09850000
098600 7620-CLOSE-XLT00010-CSR.                                         09860000
098700                                                                  09870000
098800     PERFORM                                                      09880000
098900         WITH TEST AFTER                                          09890000
099000         VARYING PV-RETRY-COUNT                                   09900000
099100         FROM 1 BY 1                                              09910000
099200         UNTIL ((PV-RETRY-COUNT > PC-MAX-RETRIES)                 09920000
099300            OR  (SQLCODE = +0))                                   09930000
099400                                                                  09940000
099500            EXEC SQL                                              09950000
099600                CLOSE XLT00010-CSR                                09960000
099700            END-EXEC                                              09970000
099800                                                                  09980000
099900            EVALUATE TRUE                                         09990000
100000                WHEN SQLCODE = 0                                  10000000
100100                    CONTINUE                                      10010000
100200                WHEN SQLCODE = -911                               10020000
100300                WHEN SQLCODE = -904                               10030000
100400                    CONTINUE                                      10040000
100500                WHEN SQLCODE  NOT = +0                            10050000
100600                     MOVE '7620-CLOSE-XLT00010-CSR'               10060000
100700                                  TO PV-ABEND-PARAGRAPH           10070000
100800                     MOVE 'CLOSE XLT00010 CURSOR'                 10080000
100900                                  TO PV-ABEND-OPERATION           10090000
101000                     MOVE 'XLT_LOC '  TO PV-ABEND-STRUCTURE-1     10100000
101100                     MOVE SPACES      TO PV-ABEND-STRUCTURE-2     10110000
101200                     PERFORM 9900-DB2-ABEND                       10120000
101300            END-EVALUATE                                          10130000
101400                                                                  10140000
101500     END-PERFORM.                                                 10150000
101600                                                                  10160000
101700     IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          10170000
101800         MOVE '7620-CLOSE-XLT00010-CSR'                           10180000
101900                                 TO PV-ABEND-PARAGRAPH            10190000
102000         MOVE 'MAX RETRIES EXCEEDED'                              10200000
102100                                 TO PV-ABEND-OPERATION            10210000
102200         PERFORM 9900-DB2-ABEND                                   10220000
102300     END-IF.                                                      10230000
102400                                                                  10240000
102500 8000-WRITE-PAGE-HEADINGS.                                        10250000
102600***************************************************************** 10260000
102700*  PRINT THE HEADINGS ON EACH PAGE.                             * 10270000
102800***************************************************************** 10280000
102900     ADD 1                         TO PV-PAGE-COUNT.              10290000
103000     MOVE PV-PAGE-COUNT            TO DP132O-PAGE-NUMBER.         10300000
103100*                                                                 10310000
103200     WRITE PBS-REVIEW-RECORD                                      10320000
103300       FROM DP132O-STANDRD-HEADER-132-COLS                        10330000
103400         AFTER ADVANCING PAGE.                                    10340000
103500*                                                                 10350000
103600     WRITE PBS-REVIEW-RECORD                                      10360000
103700       FROM HL1-HEADING-LINE-1                                    10370000
103800         AFTER ADVANCING 1 LINE.                                  10380000
103900*                                                                 10390000
104000     WRITE PBS-REVIEW-RECORD                                      10400000
104100       FROM HL2-HEADING-LINE-2                                    10410000
104200         AFTER ADVANCING 1 LINE.                                  10420000
104300*                                                                 10430000
104400     WRITE PBS-REVIEW-RECORD                                      10440000
104500       FROM DH1-DETAIL-HEADING-LINE-1                             10450000
104600         AFTER ADVANCING 2 LINES.                                 10460000
104700*                                                                 10470000
104800     WRITE PBS-REVIEW-RECORD                                      10480000
104900       FROM DH2-DETAIL-HEADING-LINE-2                             10490000
105000         AFTER ADVANCING 1 LINE.                                  10500000
105100*                                                                 10510000
105200     MOVE +9 TO PV-LINES-USED.                                    10520000
105300*                                                                 10530000
105400*8000-EXIT.                                                       10540000
105500*                                                                 10550000
105600*                                                                 10560000
105700 8100-WRITE-PBS-REVIEW-DETAIL.                                    10570000
105800******************************************************************10580000
105900*  WRITE THE STYLE SUMMARY DETAIL RECORD.                         10590000
106000******************************************************************10600000
106100     IF PV-LINES-USED > PC-PAGE-SIZE-066                          10610000
106200        PERFORM 8000-WRITE-PAGE-HEADINGS                          10620000
106300     END-IF.                                                      10630000
106400                                                                  10640000
106500     WRITE PBS-REVIEW-RECORD                                      10650000
106600         FROM DL-DETAIL-LINE1                                     10660000
106700             AFTER ADVANCING 2 LINE.                              10670000
106800                                                                  10680000
106900                                                                  10690000
107000     WRITE PBS-REVIEW-RECORD                                      10700000
107100         FROM DL-DETAIL-LINE2                                     10710000
107200             AFTER ADVANCING 1 LINE.                              10720000
107300                                                                  10730000
107400                                                                  10740000
107500     ADD 3 TO PV-LINES-USED.                                      10750000
107600                                                                  10760000
107700*8100-EXIT.                                                       10770000
107800*                                                                 10780000
107900 8150-WRITE-PBS-REVIEW-DETAIL.                                    10790000
108000******************************************************************10800000
108100*  WRITE THE STYLE SUMMARY DETAIL RECORD.                         10810000
108200******************************************************************10820000
108300     IF PV-LINES-USED > PC-PAGE-SIZE-066                          10830000
108400        PERFORM 8000-WRITE-PAGE-HEADINGS                          10840000
108500     END-IF.                                                      10850000
108600                                                                  10860000
108700     WRITE PBS-REVIEW-RECORD                                      10870000
108800         FROM DL-DETAIL-LINE4                                     10880000
108900             AFTER ADVANCING 1 LINE.                              10890000
109000                                                                  10900000
109100     ADD 1 TO PV-LINES-USED.                                      10910000
109200                                                                  10920000
109300*8150-EXIT.                                                       10930000
109400*                                                                 10940000
109500*                                                                 10950000
109600*                                                                 10960000
109700 8200-WRITE-PBS-REVIEW-DETAIL3.                                   10970000
109800******************************************************************10980000
109900*                                                                 10990000
110000******************************************************************11000000
110100     IF PV-LINES-USED > PC-PAGE-SIZE-066                          11010000
110200        PERFORM 8000-WRITE-PAGE-HEADINGS                          11020000
110300     END-IF.                                                      11030000
110400                                                                  11040000
110500     WRITE PBS-REVIEW-RECORD                                      11050000
110600         FROM DL-DETAIL-LINE3                                     11060000
110700             AFTER ADVANCING 1 LINE.                              11070000
110800                                                                  11080000
110900     ADD 1 TO PV-LINES-USED.                                      11090000
111000                                                                  11100000
111100*8200-EXIT.                                                       11110000
111200*                                                                 11120000
111300 8300-WRITE-BLANK-LINE.                                           11130000
111400******************************************************************11140000
111500*  WRITE A BLANK LINE.                                            11150000
111600******************************************************************11160000
111700     IF PV-LINES-USED > PC-PAGE-SIZE-066                          11170000
111800        PERFORM 8000-WRITE-PAGE-HEADINGS                          11180000
111900     END-IF.                                                      11190000
112000                                                                  11200000
112100     WRITE PBS-REVIEW-RECORD                                      11210000
112200         FROM PV-BLANK-LINE                                       11220000
112300             AFTER ADVANCING 1 LINE.                              11230000
112400                                                                  11240000
112500     ADD 1 TO PV-LINES-USED.                                      11250000
112600                                                                  11260000
112700*8300-EXIT.                                                       11270000
112800*                                                                 11280000
112900*                                                                 11290000
113000 9000-EOJ-ROUTINE.                                                11300000
113100******************************************************************11310000
113200*  PRINT END OF REPORT MESSAGE, CLOSE THE OUTPUT FILE, AND CLOSE  11320000
113300*  THE CURSOR.                                                    11330000
113400******************************************************************11340000
113500*    ADD 2 TO PV-LINES-USED.                                      11350000
113600                                                                  11360000
113700*    IF PV-LINES-USED > PC-PAGE-SIZE-066                          11370000
113800        PERFORM 8000-WRITE-PAGE-HEADINGS.                         11380000
113900*    END-IF.                                                      11390000
114000                                                                  11400000
114100     MOVE PV-COMP-PO-QTY       TO DL-COMP-PO-PIECES.              11410000
114200     MOVE PV-COMP-PO-AMT       TO DL-COMP-PO-RETAIL               11420000
114300     MOVE PV-COMP-REC-QTY      TO DL-COMP-REC-PIECES.             11430000
114400     MOVE PV-COMP-REC-AMT      TO DL-COMP-REC-RETAIL.             11440000
114500     MOVE PV-TOTAL-QTY         TO ER-TOTAL-VE.                    11450000
114600     COMPUTE PV-COMP-VAR-QTY = PV-COMP-REC-QTY -                  11460000
114700                               PV-COMP-PO-QTY.                    11470000
114800     MOVE PV-COMP-VAR-QTY      TO DL-COMP-VAR-PIECES.             11480000
114900     COMPUTE PV-COMP-VAR-AMT = PV-COMP-REC-AMT -                  11490000
115000                               PV-COMP-PO-AMT.                    11500000
115100     MOVE PV-COMP-VAR-AMT      TO DL-COMP-VAR-RETAIL.             11510000
115200                                                                  11520000
115300     WRITE PBS-REVIEW-RECORD                                      11530000
115400         FROM CO-DETAIL-LINE                                      11540000
115500             AFTER ADVANCING 2 LINES.                             11550000
115600                                                                  11560000
115700     MOVE PV-DIFF-QTY          TO ER-DIFF-VE.                     11570000
115800     WRITE PBS-REVIEW-RECORD                                      11580000
115900         FROM ER-END-OF-REPORT-LINE1                              11590000
116000             AFTER ADVANCING 2 LINES.                             11600000
116100                                                                  11610000
116200     WRITE PBS-REVIEW-RECORD                                      11620000
116300         FROM ER-END-OF-REPORT-LINE2                              11630000
116400             AFTER ADVANCING 2 LINES.                             11640000
116500                                                                  11650000
116600     WRITE PBS-REVIEW-RECORD                                      11660000
116700         FROM ER-END-OF-REPORT-LINE                               11670000
116800             AFTER ADVANCING 2 LINES.                             11680000
116900                                                                  11690000
117000     CLOSE PBS-FILE                                               11700000
117100           PBS-REVIEW-RPT-FILE.                                   11710000
117200*                                                                 11720000
117300*                                                                 11730000
117400*9000-EXIT.                                                       11740000
117500                                                                  11750000
117600 9900-DB2-ABEND.                                                  11760000
117700                                                                  11770000
117800     MOVE SQLCODE TO PV-SQLCODE.                                  11780000
117900     DISPLAY '*** DB2 ERROR '.                                    11790000
118000     DISPLAY '*** SQLCODE   = ' PV-SQLCODE.                       11800000
118100     DISPLAY '*** PROGRAM   = ' PV-ABEND-PROGRAM.                 11810000
118200     DISPLAY '*** PARAGRAPH = ' PV-ABEND-PARAGRAPH.               11820000
118300     DISPLAY '*** OPERATION = ' PV-ABEND-OPERATION.               11830000
118400     DISPLAY '*** MESSAGE   = ' PV-DB2-OPERATION-MESSAGE-1.       11840000
118500     DISPLAY '***           = ' PV-DB2-OPERATION-MESSAGE-2.       11850000
118600     DISPLAY '***           = ' PV-DB2-OPERATION-MESSAGE-3.       11860000
118700     DISPLAY '*** TABLE 1   = ' PV-ABEND-STRUCTURE-1.             11870000
118800                                                                  11880000
118900     IF PV-ABEND-STRUCTURE-2 > SPACES                             11890000
119000         DISPLAY '*** TABLE 2   = ' PV-ABEND-STRUCTURE-2          11900000
119100     END-IF.                                                      11910000
119200                                                                  11920000
119300                                                                  11930000
119400     COPY DPPD004.                                                11940000
119500                                                                  11950000
119600     IF SQLCODE NOT = -911                                        11960000
119700         EXEC SQL                                                 11970000
119800              ROLLBACK                                            11980000
119900         END-EXEC                                                 11990000
120000     END-IF.                                                      12000000
120100                                                                  12010000
120200     MOVE +4013                  TO PV-ABEND-CODE.                12020000
120300     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         12030000
120400*                                                                 12040000
120500 9200-ABEND.                                                      12050000
120600******************************************************************12060000
120700*  PERFORMS A NON-SQL ABEND FOR THE PROGRAM                       12070000
120800******************************************************************12080000
120900     DISPLAY '***************************'.                       12090000
121000     DISPLAY '**       ABEND           **'.                       12100000
121100     DISPLAY '**  IN PROGRAM RVKCS001  **'.                       12110000
121200     DISPLAY '***************************'.                       12120000
121300     DISPLAY '** PARAGRAPH       ** = ' PV-PARAGRAPH-NAME.        12130000
121400     DISPLAY '**                 ** = ' PV-ERROR-MESSAGE-1.       12140000
121500     DISPLAY '**                 ** = ' PV-ERROR-MESSAGE-2.       12150000
121600                                                                  12160000
121700     MOVE +4014                  TO PV-ABEND-CODE.                12170000
121800     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         12180000
121900*                                                                 12190000
