000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.      SNKUP001.                                       00020000
000300 AUTHOR.          PAT LEE.                                        00030000
000400 DATE-WRITTEN.    05/28/91.                                       00040000
000500                                                                  00050000
000600******************************************************************00060000
000700*  READ ADVANCED SHIP NOTICE DETAIL FILE AND FORMAT THE DB2      *00070000
000800*    ADVANCED SHIP NOTICE TABLES..                               *00080000
001200******************************************************************00120000
001300*    P R O G R A M   M O D I F I C A T I O N   H I S T O  R Y    *00130000
001400******************************************************************00140000
001500*    DATE       PROGRAMMER      DESCRIPTION                      *00150000
001600******************************************************************00160000
001700*  07/28/92     C CHARLESWORTH  HARD CODED A NUMERIC EDIT ROUTINE*00170000
001800*                               FOR THE UPC NUMBER BECAUSE THE   *00180000
001900*                               FIELD IS TOO LARGE FOR THE COMMON*00190000
002000*                               EDIT ROUTINE.                    *00200000
002100*                               CHANGED PARAGRAPH K100 AND       *00210000
002200*                                 ADDED PARAGRAPH K700.          *00220000
002300*                               LOOK FOR ** 07/28/92 **          *00230000
002400*  08/05/92     C CHARLESWORTH  CHANGED THE FIELD MOVED INTO     *00240000
002500*                               PW-ASNDTL-PKG-QTY FROM           *00250000
002600*                               SN001I-PO401-PKG-SIZE-QTY    TO  *00260000
002700*                               SN001I-PO402-SIZE-MSMT.          *00270000
002800*                               LOOK FOR ** 08/05/92 **          *00280000
002900*  08/13/92     C CHARLESWORTH  ADDED A PARM CONTROL TO DESIGNATE*00290000
003000*                               WHETHER THIS IS A PRODUCTION OR  *00300000
003100*                               TEST RUN OF ASNS.  THIS WILL BE  *00310000
003200*                               USED TO DETERMINE IF THE         *00320000
003300*                               REC_MTHD_IND WILL BE UPDATED WITH*00330000
003400*                               A "T" FOR TEST OR "Y" FOR PRO-   *00340000
003500*                               DUCTION.                         *00350000
003600*                               LOOK FOR ** 08/13/92 **          *00360000
003700*  09/15/92     PAT LEE       - ADDED MSG-06 AND ASSOCIATED LOGIC*00370000
003800*                               TO HANDLE DUPLICATE ASN'S (-803  *00380000
003900*                               ON INSERT OF TASNHDR)            *00390000
004000*                             - ADDED MSG-07 WHICH INDICATES THE *00400000
004100*                               ASN THAT WAS INSERTED            *00410000
004200*                             - ADDED LOGIC TO HANDLE UP TO A 6  *00420000
004300*                               DIGIT DEPARTMENT NUMBER          *00430000
004400*                             - ADDED LOGIC TO HANDLE UP TO A 6  *00440000
004500*                               DIGIT STORE NUMBER               *00450000
004600*                             - ADDED SEQ-NBR-IND TO TASNORD TBL *00460000
004700*                               AND ASSOCIATED LOGIC TO LOAD IT  *00470000
004800*  10/12/92     ANNE YEKO     - IF SELR_INV_NBR IS NOT SENT,     *00480000
004900*                               MOVE SPACES TO THE FIELD.        *00490000
005000*  11/03/92     CHRIS FOLEY   - ADD LOGIC TO INITIALIZE NUMERIC  *00500000
005100*                               EDIT FIELDS FOR UPC NUMBER.      *00510000
005200*  09/15/92     PAT LEE       - ADDED LOGIC TO HANDLE ONE AND    *00520000
005300*                               TWO DIGIT SEQ-NBR-IND            *00530000
005400*  04/27/93     CHUCK ALBERTY - ADDED LOGIC TO MOVE INITIAL VALUE*00540000
005500*                               TO NEW COLUMN DC_PRT_IND WHEN    *00550000
005600*                               INSERTING A ROW.                 *00560000
005700*  04/27/93     PAT LEE       - ADDED LOGIC TO BYPASS THE SHIP-  *00570000
005800*                               LEVEL RECORDS AND CONTINUE PRO-  *00580000
005900*                               CESSING AT THE NEXT ORDER, WHEN  *00590000
006000*                               THE VENDOR SENDS MULTIPLE SHIP-  *00600000
006100*                               MENT SEGEMENTS IN AN ISA ENVELOPE*00610000
006200*  05/04/93    N. PALATNIK      INCORPORATE CHANGES WHICH WILL   *00620000
006300*                               PROVIDE FOR THE CORRECT          *00630000
006400*                               PROCESSING WHEN THE REFERENTIAL  *00640000
006500*                               INTEGRITY IS REMOVED FROM THE    *00650000
006600*                               ASN TABLES.                      *00660000
006700*  01/28/99    BUDDY BARNES     CHANGE TO DISPLAY ASNHDR-ID AND  *00670000
006800*                               EDI-VEND ON SYSOUT.              *00680000
006900*  02/18/99    BUDDY BARNES     CHANGES FOR VERSION 4010.        *00690000
007000*                               (SN001I-STRUC-CDE,               *00700000
007100*                                SN001I-DTM03-SHIP-TIME,         *00710000
007200*                                SN001I-PO414-INPK-EA-QTY)       *00720000
007300*  05/03/00    M. MACHNIK       CHANGES FOR WR#20682             *00730000
007400*                               SN001I-ISA-CNTL-NBR,             *00740000
007500*                               SN001I-GS-CNTL-NBR,              *00750000
007600*                               SN001I-ST-CNTL-NBR,              *00760000
007700*                               SN001I-ISA-TMST INTO TASNHDR     *00770000
007800*  07/11/00    M. MACHNIK       CHANGES FOR WR#20868             *00780000
007900*                               MOVED CONTAINER FROM EDI INPUT   *00790000
008000*                               TO TASNHDR COLUMN                 00800000
008100*  09/19/00    M. MACHNIK       CHANGES FOR WR#09900             *00810000
008200*                               GENERATED ERROR FOR REPORT WHEN  *00820000
008300*                               STD FORMAT USED AND NO 'PO4' IS   00830000
008400*                               SENT. USED FOR CARTON QTY.        00840000
008500*  12/19/00    M. MACHNIK       CHANGES FOR WR#09900             *00850000
008600*                               CORRECTED SQLCODE CHECK FOR -181 *00860000
008700*                               IF DETECTED, ASN INVALID AND WILL 00870000
008800*                               SHOW ON ERROR REPORT.             00880000
008900*  01/21/2003  M. MACHNIK       CHANGES FOR P00520295             00890000
009000*                               CORRECTED PROCESSING OF N1 SEG.   00900000
009100*                               NUMERIC EDIT OF STORE/DC NUMBER.  00910000
009200*  04/02/2003  M. MACHNIK       CHANGES FOR HUDD DISTRIB. TRADING 00920000
009300*                               PARTNER TABLE IN WS.  WR24583     00930000
009400*  12/01/11    CHRISTINE TWIEHAUS                                 00940000
009500*              WR# 40574 POPULATE CARR-AUTH-ID ON TASNHDR         00950000
009600*                                                                 00960000
009700*  11/07/14    PRITHIVIRAJ SUBRAMANIAN (COGNIZANT)                00970000
009800*              CHANGES THRU OUT THE PROGRAM TO INCREASE SIZE OF   00980000
009900*              PO# FROM 7 DIGITS TO 8 DIGITS.                     00990000
010000*              CHANGE TAGGED WITH *PS 11/07/2014                  01000000
010100*                                                                 01010000
010110*  03/07/16    DENISE HAHN                                        01011000
010120*              CHANGES TO CREATE A FLAT FILE (RCRD093 FORMAT)     01012000
010130*              WITH THE SSCC AND THE CARRIER TRACKING NUMBER.     01013000
010140*              THIS FLAT FILE WILL BE USED IN RCK010 TO           01014000
010141*              UPDATE THE NEW CARRIER TRACKING TABLES.            01014100
010142*                                                                 01014200
010143*  06/14/21    CHANGES MADE BY TKMA4MB                            01014300
010144*              ADDED AT WHAT LEVEL THE INVALID RECORD FOR SHIPMENT01014400
010145*              FOLLOWING RECORD WAS BYPASSED MESSAGE IS GENERATED 01014500
010146*                                                                 01014600
010147*  10/12/21    CHANGES MADE BY TKMA236 (RON KRIER)                01014700
010148*              ADDED LOGIC TO THE PROGRAM TO ALLOW THE ASN DATA   01014800
010149*              AT THE PO ITEM LEVEL TO MATCH EVEN IF THE LINE ON  01014900
010150*              PO IS IN A CANCELED STATUS.                        01015000
010151*                                                                 01015105
010152*  12/02/22    CHANGES MADE BY TKMA236 (RON KRIER)                01015205
010153*              ADDED THE WST_ TABLES FOR PARM ASNVTRDPRT TO       01015305
010154*              REPLACE HARD CODED IMPORT SHIP VALUES.  CHANGE     01015405
010155*              NEEDED TO INCLUDE KOHLSDECON AS A VALID IMPORT     01015505
010156*              SHIP PARTNER.                                      01015605
010157******************************************************************01015705
010158 ENVIRONMENT DIVISION.                                            01015805
010159 CONFIGURATION SECTION.                                           01015905
010160 SOURCE-COMPUTER. IBM-3090.                                       01016005
010161 OBJECT-COMPUTER. IBM-3090.                                       01016105
010162                                                                  01016205
010163 INPUT-OUTPUT SECTION.                                            01016305
010164 FILE-CONTROL.                                                    01016405
010165                                                                  01016505
010166     SELECT ADV-SHIP-NOTICE-FILE                                  01016605
010167         ASSIGN                       TO INP01.                   01016705
010168                                                                  01016805
010169     SELECT ADV-SHIP-NOTICE-REPORT                                01016905
010170         ASSIGN                       TO RPT01.                   01017005
010171                                                                  01017105
010172     SELECT ASN-ERROR-LOG                                         01017205
010173         ASSIGN                       TO OUT01.                   01017305
010174                                                                  01017405
010175     SELECT ASN-CARR-TRACKING                                     01017505
010176         ASSIGN                       TO OUT02.                   01017605
010180/                                                                 01018000
010190***************                                                   01019000
010200 DATA DIVISION.                                                   01020000
010300***************                                                   01030000
010400 FILE SECTION.                                                    01040000
010500                                                                  01050000
010600 FD  ADV-SHIP-NOTICE-FILE                                         01060000
010700     RECORDING MODE F                                             01070000
010800     BLOCK CONTAINS 0 RECORDS                                     01080000
010900     RECORD CONTAINS 350 CHARACTERS                               01090000
011000     LABEL RECORDS ARE STANDARD                                   01100000
011100     DATA RECORD IS ADV-SHIP-NOTICE-RECORD.                       01110000
011200 01  ADV-SHIP-NOTICE-RECORD              PIC X(350).              01120000
011300                                                                  01130000
011400 FD  ADV-SHIP-NOTICE-REPORT                                       01140000
011500     RECORDING MODE F                                             01150000
011600     BLOCK CONTAINS 0 RECORDS                                     01160000
011700     RECORD CONTAINS 132 CHARACTERS                               01170000
011800     LABEL RECORDS ARE OMITTED                                    01180000
011900     DATA RECORD IS ADV-SHIP-NOTICE-LINE.                         01190000
012000 01  ADV-SHIP-NOTICE-LINE                PIC X(132).              01200000
012100                                                                  01210000
012200 FD  ASN-ERROR-LOG                                                01220000
012300     RECORDING MODE F                                             01230000
012400     RECORD CONTAINS 130 CHARACTERS                               01240000
012500     LABEL RECORDS ARE STANDARD                                   01250000
012600     BLOCK CONTAINS 0 RECORDS                                     01260000
012700     DATA RECORD IS ASN-LOG-REC.                                  01270000
012800 01  ASN-LOG-REC                         PIC X(130).              01280000
012900                                                                  01290000
013000                                                                  01300000
013100 FD  ASN-CARR-TRACKING                                            01310000
013200     RECORDING MODE F                                             01320000
013300     RECORD CONTAINS 150 CHARACTERS                               01330000
013400     LABEL RECORDS ARE STANDARD                                   01340000
013500     BLOCK CONTAINS 0 RECORDS                                     01350000
013600     DATA RECORD IS ASN-CARR-TRACK-REC.                           01360000
013700 01  ASN-CARR-TRACK-REC                   PIC X(150).             01370000
013800                                                                  01380000
013900/                                                                 01390000
014000 WORKING-STORAGE SECTION.                                         01400000
014100/                                                                 01410000
014200****************************************************************  01420000
014300 01  FILLER                           PIC X(08) VALUE 'BEGIN WS'. 01430000
014400****************************************************************  01440000
014500/                                                                 01450000
014600*                                                                 01460000
014700*  STANDARD HEADER LINE - KOHLS 132 COL                           01470000
014800*                                                                 01480000
014900     COPY DPWS132O.                                               01490000
015000/                                                                 01500000
015100*                                                                 01510000
015200*  RANDOM NUMBER WORK AREA                                        01520000
015300*                                                                 01530000
015400     COPY DPWS902.                                                01540000
015500/                                                                 01550000
015600 01  H2-HEADING-LINE2.                                            01560000
015700     05  FILLER                       PIC X(46)      VALUE SPACE. 01570000
015800     05  FILLER                       PIC X(42)      VALUE        01580000
015900         'ADVANCE SHIP NOTICE WARNING/ERROR REPORT'.              01590000
016000     05  FILLER                       PIC X(10)      VALUE SPACE. 01600000
016100     05  FILLER                       PIC X(03)      VALUE        01610000
016200         '** '.                                                   01620000
016300     05  H2-TEST-PROD                 PIC X(04)      VALUE SPACE. 01630000
016400     05  FILLER                       PIC X(13)      VALUE        01640000
016500         ' DATA ONLY **'.                                         01650000
016600     05  FILLER                       PIC X(14)      VALUE SPACE. 01660000
016700                                                                  01670000
016800 01  H3-HEADING-LINE3.                                            01680000
016900     05  FILLER                       PIC X(02)      VALUE SPACE. 01690000
017000     05  FILLER                       PIC X(13)      VALUE        01700000
017100         'ERROR MESSAGE'.                                         01710000
017200     05  FILLER                       PIC X(117)     VALUE SPACE. 01720000
017300                                                                  01730000
017400/                                                                 01740000
017500 01  END-OF-REPORT-LINE.                                          01750000
017600     05  FILLER                       PIC X(132)     VALUE        01760000
017700         '  ** END OF REPORT **         '.                        01770000
017800/                                                                 01780000
017900 01  CC-CONTROL-CARD.                                             01790000
018000     05  CC-JOBNAME                   PIC X(08)  VALUE SPACES.    01800000
018100     05  CC-PARM-TYPE                 PIC X(04)  VALUE SPACES.    01810000
018200         88  CC-PARM-VALID                       VALUE 'TEST'     01820000
018300                                                       'PROD'.    01830000
018400         88  CC-PARM-TEST                        VALUE 'TEST'.    01840000
018500         88  CC-PARM-PROD                        VALUE 'PROD'.    01850000
018600/                                                                 01860000
018700 01  PV-PROCESS-TMST                  PIC X(26)  VALUE SPACES.    01870000
018800 01  PV-UPC-TRACK-COUNT               PIC 9(09)  VALUE ZEROES.    01880000
018900 01  PV-UPC-TRACK-DISP                PIC ZZZ,ZZZ,ZZ9.            01890004
018910 01  PV-PREV-PARTNER-ID               PIC X(15)  VALUE SPACES.    01891005
018920 01  PV-ELEM-PARTNER-ID               PIC X(15)  VALUE SPACES.    01892005
019000                                                                  01900000
019100 01  CD-CPU-DATE.                                                 01910000
019200     05  CD-CPU-DATE-YY               PIC 9(02)      VALUE ZEROS. 01920000
019300     05  CD-CPU-DATE-MM               PIC 9(02)      VALUE ZEROS. 01930000
019400     05  CD-CPU-DATE-DD               PIC 9(02)      VALUE ZEROS. 01940000
019500                                                                  01950000
019600 01  CT-CPU-TIME.                                                 01960000
019700     05  CT-CPU-TIME-HH               PIC 9(02)      VALUE ZEROS. 01970000
019800     05  CT-CPU-TIME-MM               PIC 9(02)      VALUE ZEROS. 01980000
019900     05  CT-CPU-TIME-SS               PIC 9(02)      VALUE ZEROS. 01990000
020000     05  CT-CPU-TIME-HS               PIC 9(02)      VALUE ZEROS. 02000000
020100 01  PV-CD-TIME.                                                  02010000
020200     05  PV-CD-SS                     PIC 9(02)      VALUE ZEROS. 02020000
020300     05  PV-CD-HS                     PIC 9(02)      VALUE ZEROS. 02030000
020400 01  PV-RANDOM-NUMBER                 PIC S9(09)     VALUE ZEROES 02040000
020500                                                     COMP.        02050000
020600 01  PV-ASNHDR-ID                    PIC S9(09)   VALUE ZERO      02060000
020700                                                   COMP.          02070000
020800 01  PV-CHECK-RANDOM                 PIC S9(09)   VALUE ZERO.     02080000
020900 01  WAIT-COUNT                      PIC S9(09)    VALUE +0       02090000
021000                                                   COMP SYNC.     02100000
021100 01  PV-DISPLAY-FIELDS.                                           02110000
021110     05  PV-DISPLAY-PO-NBR           PIC 99999999    VALUE ZERO.  02111000
021120     05  PV-DISPLAY-UPC-NBR          PIC 999999999999999          02112000
021130                                                     VALUE ZERO.  02113000
021131     05  PV-DISPLAY-REC-NBR          PIC ZZZ,ZZZ,ZZ9 VALUE ZERO.  02113108
021132                                                                  02113205
021133 01  PV-READ-WRITE-COUNTS.                                        02113305
021134     05  PV-INPUT-READ-COUNT         PIC 9(09)       VALUE ZERO.  02113405
021135     05  PV-ASN-ERROR-LOG-COUNT      PIC 9(09)       VALUE ZERO.  02113505
021136     05  PV-ASN-CARR-TRACK-COUNT     PIC 9(09)       VALUE ZERO.  02113605
021140                                                                  02114000
021150 01  PA-PROGRAM-ACCUMULATORS.                                     02115000
021160                                                                  02116000
021170     05  PA-LINE-CNT                  PIC S9(03)     VALUE +99    02117000
021180                                                     COMP-3.      02118000
021190     05  PA-PAGE-CNT                  PIC 9(03)      VALUE ZEROS  02119000
021200                                                     COMP-3.      02120000
021300     05  PA-ASNHDR-INSERTED           PIC S9(06)     COMP-3       02130000
021400                                                     VALUE ZERO.  02140000
021500     05  PA-ASNHDR-DELETED            PIC S9(06)     COMP-3       02150000
021600                                                     VALUE ZERO.  02160000
021700     05  PA-TASCRIT-CNT               PIC  9(07)     VALUE 0.     02170000
021800     05  PA-SEQ-NBR-ZERO-CNT          PIC S9(03)     COMP-3       02180000
021900                                                     VALUE ZERO.  02190000
022000                                                                  02200000
022100                                                                  02210000
022200 01  PC-PROGRAM-CONTROLS.                                         02220000
022300**   05  PC-DPKUT105                  PIC X(10)      VALUE        02230000
022400**       'DPKUT105  '.                                            02240000
022500     05  PC-DPKUT500                  PIC X(10)      VALUE        02250000
022600         'DPKUT500  '.                                            02260000
022700     05  PC-MAX-LINES                 PIC S9(03)     VALUE +48    02270000
022800                                                     COMP-3.      02280000
022900     05  PC-SNKUP023                  PIC X(8)       VALUE        02290000
023000         'SNKUP023'.                                              02300000
023100     05  PC-DELAY-INTERVAL.                                       02310000
023200         10  FILLER                   PIC X(2)  VALUE SPACES.     02320000
023300         10  PC-DELAY-TIME            PIC 9(8)  VALUE 33.         02330000
023400     05  PC-MAX-ASN-RETRY             PIC 9(5)  VALUE 100.        02340000
023500     05  PC-RAND-PGM                  PIC X(08)      VALUE        02350000
023600                                                    'DPKUT902'.   02360000
023700     05  PC-OPERCO-NBR                PIC  X(02)     VALUE '03'.  02370000
023800     05  PC-REC-MTHD-IND-TEST         PIC  X(01)     VALUE 'T'.   02380000
023900     05  PC-REC-MTHD-IND-PROD         PIC  X(01)     VALUE 'Y'.   02390000
024000     05  PC-Y                         PIC  X(01)     VALUE 'Y'.   02400000
024100     05  PC-PRINT-IND                 PIC  X(01)     VALUE 'N'.   02410000
024200     05  PC-MTCH-PO-CDE               PIC  X(01)     VALUE 'N'.   02420000
024300     05  PC-NEG-1                     PIC S9(03)     VALUE -1     02430000
024400                                                     COMP-3.      02440000
024500     05  PC-NEG-180                   PIC S9(03)     VALUE -180   02450000
024600                                                     COMP SYNC.   02460000
024700     05  PC-NEG-181                   PIC S9(03)     VALUE -181   02470000
024800                                                     COMP SYNC.   02480000
024900     05  PC-NEG-803                   PIC S9(03)     VALUE -803   02490000
025000                                                     COMP-3.      02500000
025100     05  PC-POS-1                     PIC S9(03)     VALUE +1     02510000
025200                                                     COMP-3.      02520000
025300     05  PC-POS-2                     PIC S9(03)     VALUE +2     02530000
025400                                                     COMP-3.      02540000
025500     05  PC-POS-3                     PIC S9(03)     VALUE +3     02550000
025600                                                     COMP-3.      02560000
025700     05  PC-POS-4                     PIC S9(03)     VALUE +4     02570000
025800                                                     COMP-3.      02580000
025900     05  PC-POS-7                     PIC S9(03)     VALUE +7     02590000
026000                                                     COMP-3.      02600000
026100     05  PC-POS-10                    PIC S9(03)     VALUE +10    02610000
026200                                                     COMP-3.      02620000
026300     05  PC-POS-19                    PIC S9(03)     VALUE +19    02630000
026400                                                     COMP-3.      02640000
026500     05  PC-POS-20                    PIC S9(03)     VALUE +20    02650000
026600                                                     COMP-3.      02660000
026700     05  PC-POS-30                    PIC S9(04)     VALUE +30    02670000
026800                                                     COMP-3.      02680000
026900     05  PC-POS-54                    PIC S9(04)     VALUE +54    02690000
027000                                                     COMP-3.      02700000
027100     05  PC-POS-100                   PIC S9(04)     VALUE +100   02710000
027200                                                     COMP-3.      02720000
027300     05  PC-POS-2400                  PIC S9(04)     VALUE +2400  02730000
027400                                                     COMP-3.      02740000
027500     05  PC-POINT-5                   PIC S9(01)V99  VALUE +.5    02750000
027600                                                     COMP-3.      02760000
027700     05  PC-MAX-RETRIES               PIC S9(03)     VALUE +5     02770000
027800                                                     COMP-3.      02780000
027900     05  PC-ROW-NOT-FOUND             PIC S9(04)     VALUE +100   02790000
028000                                                     COMP SYNC.   02800000
028100     05  PC-NEG-904                   PIC S9(04)     VALUE -904   02810000
028200                                                     COMP SYNC.   02820000
028300     05  PC-NEG-913                   PIC S9(04)     VALUE -913   02830000
028400                                                     COMP SYNC.   02840000
028500     05  PC-STARTING-SEQ-NBR          PIC S9(03)     VALUE +100   02850000
028600                                                     COMP-3.      02860000
028700     05  PC-AMC-EDI-VEND-ID           PIC  X(09)     VALUE        02870000
028800         '000359612'.                                             02880000
028900     05  PC-NO-DUNNS-NBR              PIC  X(09)     VALUE        02890000
029000         '*********'.                                             02900000
029100     05  PC-NO-DUNNS-NAME             PIC  X(30)     VALUE        02910000
029200         '* NOT SUPPLIED OR NOT FOUND * '.                        02920000
029300     05  PV-PO4-FOUND-CNT             PIC 9(7)       VALUE 0.     02930000
029400     05  PV-PO4-NOT-FOUND-CNT         PIC 9(7)       VALUE 0.     02940000
029500                                                                  02950000
029600 01  PSRL-PROGRAM-STD-REPORT-LINES.                               02960000
029700     05  PSRL-REPORT-LINE-1.                                      02970000
029800         10  FILLER                   PIC X(02)      VALUE SPACE. 02980000
029900         10  FILLER                   PIC X(08)      VALUE        02990000
030000             'VENDOR: '.                                          03000000
030100         10  PSRL-DUNNS-NBR           PIC X(09)      VALUE SPACE. 03010000
030200         10  FILLER                   PIC X(03)      VALUE        03020000
030300             ' - '.                                               03030000
030400         10  PSRL-VENDOR-NAME         PIC X(30)      VALUE SPACE. 03040000
030500         10  FILLER                   PIC X(14)      VALUE        03050000
030600             '  ASNHDR NBR: '.                                    03060000
030700         10  PSRL-ASNHDR-NBR          PIC X(30)      VALUE SPACE. 03070000
030800         10  FILLER                   PIC X(5)       VALUE SPACE. 03080000
030900         10  FILLER                   PIC X(7)       VALUE        03090000
031000             'ISA #: '.                                           03100000
031100         10  PSRL-ISA-NBR             PIC X(9)       VALUE SPACE. 03110000
031200         10  FILLER                   PIC X(15)      VALUE SPACE. 03120000
031300                                                                  03130000
031400     05  PSRL-REPORT-LINE-2.                                      03140000
031500         10  FILLER                   PIC X(10)      VALUE SPACE. 03150000
031600         10  PSRL-RPT-LINE-2          PIC X(122)     VALUE SPACE. 03160000
031700                                                                  03170000
031800 01  PR-PROGRAM-REPORT-LINES.                                     03180000
031900*RSC 05  PR-HEADER.                                               03190000
032000*        10  FILLER                   PIC X(48)      VALUE SPACES.03200000
032100*        10  FILLER                   PIC X(36)      VALUE        03210000
032200*            '* * * VENDOR DATA ERROR REPORT * * *'.              03220000
032300*        10  FILLER                   PIC X(48)      VALUE SPACES.03230000
032400*RSC                                                              03240000
032500     05  PR-DATE-TIME-MSG.                                        03250000
032600         10  FILLER                   PIC X(20)      VALUE        03260000
032700             'INVALID DATE OR TIME'.                              03270000
032800         10  FILLER                   PIC X(102)     VALUE SPACES.03280000
032900                                                                  03290000
033000     05  PR-DUP-ASN-MSG.                                          03300000
033100         10  FILLER                   PIC X(13)      VALUE        03310000
033200             'DUPLICATE ASN'.                                     03320000
033300         10  FILLER                   PIC X(109)     VALUE SPACES.03330000
033400                                                                  03340000
033500     05  PR-DUP-CARTON-MSG.                                       03350000
033600         10  FILLER                   PIC X(37)      VALUE        03360000
033700             'DUPLICATE CARTON ERROR IN MAN SEGMENT'.             03370000
033800         10  FILLER                   PIC X(18)      VALUE        03380000
033900             '     CARTON NBR = '.                                03390000
034000         10  PR-CARTON-NBR            PIC X(45).                  03400000
034100         10  FILLER                   PIC X(22)      VALUE SPACES.03410000
034200                                                                  03420000
034300 01  DK-DATABASE-KEYS.                                            03430000
034400     05  DK-PO-NBR                    PIC S9(09)     COMP         03440000
034500                                                     VALUE ZEROS. 03450000
034510     05  DK-PARTNER-ID                PIC  X(15)     VALUE SPACES.03451005
034600                                                                  03460000
034700 01  PS-PROGRAM-SWITCHES.                                         03470000
034800     05  PS-PO-SW                     PIC X(01)      VALUE 'N'.   03480000
034900         88  PO-FOUND                                VALUE 'Y'.   03490000
035000         88  PO-NOT-FOUND                            VALUE 'N'.   03500000
035100     05  PS-INP01-SW                  PIC X(01)      VALUE 'N'.   03510000
035200         88  END-OF-INP01                            VALUE 'Y'.   03520000
035300     05  PS-END-OF-ISA-SW             PIC X(01)      VALUE 'N'.   03530000
035400         88  END-OF-ISA                              VALUE 'Y'.   03540000
035500         88  NEW-ISA                                 VALUE 'N'.   03550000
035600     05  PS-ISA-COMPLETE-SW           PIC X(01)      VALUE 'N'.   03560000
035700         88  ISA-COMPLETE                            VALUE 'Y'.   03570000
035800         88  ISA-NOT-COMPLETE                        VALUE 'N'.   03580000
035900     05  PS-SHIPMENT-COMPLETE-SW      PIC X(01)      VALUE 'N'.   03590000
036000         88  SHIPMENT-COMPLETE                       VALUE 'Y'.   03600000
036100         88  SHIPMENT-NOT-COMPLETE                   VALUE 'N'.   03610000
036200     05  PS-ORDER-COMPLETE-SW         PIC X(01)      VALUE 'N'.   03620000
036300         88  ORDER-COMPLETE                          VALUE 'Y'.   03630000
036400         88  ORDER-NOT-COMPLETE                      VALUE 'N'.   03640000
036500     05  PS-ITEM-COMPLETE-SW          PIC X(01)      VALUE 'N'.   03650000
036600         88  ITEM-COMPLETE                           VALUE 'Y'.   03660000
036700         88  ITEM-NOT-COMPLETE                       VALUE 'N'.   03670000
036800     05  PS-NEW-N1-REC-SW             PIC X(01)      VALUE 'N'.   03680000
036900         88  NEW-N1-REC                              VALUE 'Y'.   03690000
037000         88  OLD-N1-REC                              VALUE 'N'.   03700000
037100     05  PS-TD5-FOUND-SW              PIC X(01)      VALUE 'N'.   03710000
037200         88  TD5-FOUND                               VALUE 'Y'.   03720000
037300         88  TD5-NOT-FOUND                           VALUE 'N'.   03730000
037400     05  PS-N1-FOUND-SW               PIC X(01)      VALUE 'N'.   03740000
037500         88  N1-FOUND                                VALUE 'Y'.   03750000
037600         88  N1-NOT-FOUND                            VALUE 'N'.   03760000
037700     05  PS-PO4-FOUND-SW              PIC X(01)      VALUE 'N'.   03770000
037800         88  PO4-FOUND                               VALUE 'Y'.   03780000
037900         88  PO4-NOT-FOUND                           VALUE 'N'.   03790000
038000     05  PS-N2-FOUND-SW               PIC X(01)      VALUE 'N'.   03800000
038100         88  N2-FOUND                                VALUE 'Y'.   03810000
038200         88  N2-NOT-FOUND                            VALUE 'N'.   03820000
038300     05  PS-N3-FOUND-SW               PIC X(01)      VALUE 'N'.   03830000
038400         88  N3-FOUND                                VALUE 'Y'.   03840000
038500         88  N3-NOT-FOUND                            VALUE 'N'.   03850000
038600     05  PS-N4-FOUND-SW               PIC X(01)      VALUE 'N'.   03860000
038700         88  N4-FOUND                                VALUE 'Y'.   03870000
038800         88  N4-NOT-FOUND                            VALUE 'N'.   03880000
038900     05  PS-PRF-FOUND-SW              PIC X(01)      VALUE 'N'.   03890000
039000         88  PRF-FOUND                               VALUE 'Y'.   03900000
039100         88  PRF-NOT-FOUND                           VALUE 'N'.   03910000
039200     05  PS-MAN-FOUND-SW              PIC X(01)      VALUE 'N'.   03920000
039300         88  MAN-FOUND                               VALUE 'Y'.   03930000
039400         88  MAN-NOT-FOUND                           VALUE 'N'.   03940000
039500     05  PS-UPC-FOUND-SW              PIC X(01)      VALUE 'N'.   03950000
039600         88  UPC-FOUND                               VALUE 'Y'.   03960000
039700         88  UPC-NOT-FOUND                           VALUE 'N'.   03970000
039800     05  PS-LIN-EOF-SW                PIC X(01)      VALUE 'N'.   03980000
039900         88  LIN-EOF                                 VALUE 'Y'.   03990000
040000         88  LIN-NOT-EOF                             VALUE 'N'.   04000000
040100     05  PS-CHAR-FOUND-SW             PIC X(01)      VALUE 'N'.   04010000
040200         88  CHAR-FOUND                              VALUE 'Y'.   04020000
040300         88  CHAR-NOT-FOUND                          VALUE 'N'.   04030000
040400     05  PS-VA-FOUND-SW               PIC X(01)      VALUE 'N'.   04040000
040500         88  VA-FOUND                                VALUE 'Y'.   04050000
040600         88  VA-NOT-FOUND                            VALUE 'N'.   04060000
040700     05  PS-UP-FOUND-SW               PIC X(01)      VALUE 'N'.   04070000
040800         88  UP-FOUND                                VALUE 'Y'.   04080000
040900         88  UP-NOT-FOUND                            VALUE 'N'.   04090000
041000     05  PS-EDIT-ERROR-SW             PIC X(01)      VALUE 'N'.   04100000
041100         88  EDIT-ERROR-DETECTED                     VALUE 'Y'.   04110000
041200     05  PS-DUPLICATE-SHIPMENT-SW     PIC X(01)      VALUE 'N'.   04120000
041300         88  DUPLICATE-SHIPMENT                      VALUE 'Y'.   04130000
041400         88  NOT-DUPLICATE-SHIPMENT                  VALUE 'N'.   04140000
041500     05  PS-DUNNS-NBR-SW              PIC X(01)      VALUE 'N'.   04150000
041600         88  DUNNS-NBR                               VALUE 'Y'.   04160000
041700         88  NO-DUNNS-NBR                            VALUE 'N'.   04170000
041800     05  PS-FIRST-ERROR-SW            PIC X(01)      VALUE 'Y'.   04180000
041900         88 PS-FIRST-ERROR                           VALUE 'Y'.   04190000
042000         88 PS-NOT-FIRST-ERROR                       VALUE 'N'.   04200000
042100     05  PS-BAD-ASN-SW                PIC X(01)      VALUE 'N'.   04210000
042200         88 PS-BAD-ASN                               VALUE 'Y'.   04220000
042300         88 PS-NOT-BAD-ASN                           VALUE 'N'.   04230000
042400     05  PS-LEVEL-SW                  PIC X(01)      VALUE 'N'.   04240000
042410         88 PS-SHIPMENT                              VALUE 'Y'.   04241000
042420         88 PS-ORDER                                 VALUE 'N'.   04242000
042430     05  PS-BUILD-NAME-ID-CDE-SW      PIC X(01)      VALUE 'N'.   04243000
042440         88  PS-BUILD-NAME-ID-CDE                    VALUE 'Y'.   04244000
042450         88  PS-NO-BUILD-NAME-ID-CDE                 VALUE 'N'.   04245000
042460     05  PS-VALID-NAME-ID-CDE-SW      PIC X(01)      VALUE 'N'.   04246000
042470         88  PS-VALID-NAME-ID-CDE                    VALUE 'Y'.   04247000
042480         88  PS-INVALID-NAME-ID-CDE                  VALUE 'N'.   04248000
042490     05  PS-ASN-VERSION-4010          PIC X(01)      VALUE 'N'.   04249000
042500         88  PS-VERSION-4010                         VALUE 'Y'.   04250000
042600         88  PS-NOT-VERSION-4010                     VALUE 'N'.   04260000
042700     05  PS-ASN-STRUC-CODE            PIC X(04)  VALUE '    '.    04270000
042800         88  NO-CARTON-4010                      VALUE '0001'.    04280000
042900         88  STD-PACK-4010                       VALUE '0002'.    04290000
043000     05  PS-CHK-EXIST-LOC-NBR-SW      PIC X(01)      VALUE 'N'.   04300000
043100         88  PS-CHK-EXIST-LOC-NBR-YES                VALUE 'Y'.   04310000
043200         88  PS-CHK-EXIST-LOC-NBR-NO                 VALUE 'N'.   04320000
043300     05  PS-MSG-1G-SW                 PIC X(01)      VALUE 'N'.   04330000
043400         88  PS-MSG-1G-YES                           VALUE 'Y'.   04340000
043500         88  PS-MSG-1G-NO                            VALUE 'N'.   04350000
043501     05  PS-VALID-IMPORT-SHIP-SW      PIC X(01)      VALUE 'N'.   04350105
043502         88  PS-VALID-IMPORT-SHIP                    VALUE 'Y'.   04350205
043503         88  PS-NOT-VALID-IMPORT-SHIP                VALUE 'N'.   04350305
043510                                                                  04351005
043600*    05  PS-PARTNER-ID                PIC X(15).                  04360005
043700*        88  VALID-IMPORT-SHIP                 VALUE              04370005
043800*                                           '3056851047     '     04380005
043900*                                           '6152560988     '     04390005
044000*                                           '8004268560     '     04400005
044100*                                           '7045970923     '     04410005
044200*                                           '2013323333     '     04420005
044300*                                           '3054064423     '     04430005
044400*                                           '3108861300     '     04440005
044500*                                           '5623452200     '     04450005
044600*                                           '9093934777     '     04460005
044700*                                           'HUDDKOHL       '     04470005
044800*                                           'APSSAV         '     04480005
044900*                                           'SCHNEIDERPROD  '     04490005
045000*                                           'OCSNY          '.    04500005
045010                                                                  04501005
045100 01  PV-NULLS-TABLE.                                              04510000
045200     05  PV-PRO-NBR-NULL              PIC S9(04)     VALUE +0     04520000
045300                                                     COMP SYNC.   04530000
045400     05  PV-GRO-WGHT-MSMT-NULL        PIC S9(04)     VALUE +0     04540000
045500                                                     COMP SYNC.   04550000
045600     05  PV-ANTC-DELY-DTE-NULL        PIC S9(04)     VALUE +0     04560000
045700                                                     COMP SYNC.   04570000
045800     05  PV-SHIPT-STATUS-CDE-NULL     PIC S9(04)     VALUE +0     04580000
045900                                                     COMP SYNC.   04590000
046000     05  PV-ASNHDR-CARR-NAME-NULL     PIC S9(04)     VALUE +0     04600000
046100                                                     COMP SYNC.   04610000
046200     05  PV-TRANS-MTHD-CDE-NULL       PIC S9(04)     VALUE +0     04620000
046300                                                     COMP SYNC.   04630000
046400     05  PV-CARR-ID-CDE-NULL          PIC S9(04)     VALUE +0     04640000
046500                                                     COMP SYNC.   04650000
046600     05  PV-CARR-ID-QUAL-CDE-NULL     PIC S9(04)     VALUE +0     04660000
046700                                                     COMP SYNC.   04670000
046800     05  PV-RTE-SEQ-CDE-NULL          PIC S9(04)     VALUE +0     04680000
046900                                                     COMP SYNC.   04690000
047000     05  PV-SHPT-VOL-MSMT-NULL        PIC S9(04)     VALUE +0     04700000
047100                                                     COMP SYNC.   04710000
047200     05  PV-EQUIP-INIT-CDE-NULL       PIC S9(04)     VALUE +0     04720000
047300                                                     COMP SYNC.   04730000
047400     05  PV-EQUIP-NBR-NULL            PIC S9(04)     VALUE +0     04740000
047500                                                     COMP SYNC.   04750000
047600     05  PV-SCHD-SHIP-DTE-NULL        PIC S9(04)     VALUE +0     04760000
047700                                                     COMP SYNC.   04770000
047800     05  PV-SHPT-VOL-UM-CDE-NULL      PIC S9(04)     VALUE +0     04780000
047900                                                     COMP SYNC.   04790000
048000     05  PV-GRO-WGHT-UM-CDE-NULL      PIC S9(04)     VALUE +0     04800000
048100                                                     COMP SYNC.   04810000
048200     05  PV-SHIP-PAYT-TERM-CDE-NULL   PIC S9(04)     VALUE +0     04820000
048300                                                     COMP SYNC.   04830000
048400     05  PV-RESPBL-LOC-CDE-NULL       PIC S9(04)     VALUE +0     04840000
048500                                                     COMP SYNC.   04850000
048600     05  PV-RESPBL-LOC-DESC-NULL      PIC S9(04)     VALUE +0     04860000
048700                                                     COMP SYNC.   04870000
048800     05  PV-NAME-ID-CDE-NULL          PIC S9(04)     VALUE +0     04880000
048900                                                     COMP SYNC.   04890000
049000     05  PV-NAME-ID-QUAL-CDE-NULL     PIC S9(04)     VALUE +0     04900000
049100                                                     COMP SYNC.   04910000
049200     05  PV-CTY-NAME-NULL             PIC S9(04)     VALUE +0     04920000
049300                                                     COMP SYNC.   04930000
049400     05  PV-ST-CDE-NULL               PIC S9(04)     VALUE +0     04940000
049500                                                     COMP SYNC.   04950000
049600     05  PV-ZIP-CDE-NULL              PIC S9(04)     VALUE +0     04960000
049700                                                     COMP SYNC.   04970000
049800     05  PV-CNTRY-CDE-NULL            PIC S9(04)     VALUE +0     04980000
049900                                                     COMP SYNC.   04990000
050000     05  PV-VEND-ORD-NBR-NULL         PIC S9(04)     VALUE +0     05000000
050100                                                     COMP SYNC.   05010000
050200     05  PV-CUST-NBR-NULL             PIC S9(04)     VALUE +0     05020000
050300                                                     COMP SYNC.   05030000
050400     05  PV-PROMO-NBR-NULL            PIC S9(04)     VALUE +0     05040000
050500                                                     COMP SYNC.   05050000
050600     05  PV-VEND-NBR-NULL             PIC S9(04)     VALUE +0     05060000
050700                                                     COMP SYNC.   05070000
050800     05  PV-ORD-STATUS-CDE-NULL       PIC S9(04)     VALUE +0     05080000
050900                                                     COMP SYNC.   05090000
051000     05  PV-CHG-ORD-SEQ-NBR-NULL      PIC S9(04)     VALUE +0     05100000
051100                                                     COMP SYNC.   05110000
051200     05  PV-PO-DTE-NULL               PIC S9(04)     VALUE +0     05120000
051300                                                     COMP SYNC.   05130000
051400     05  PV-EXCH-FCTR-NULL            PIC S9(04)     VALUE +0     05140000
051500                                                     COMP SYNC.   05150000
051600     05  PV-SELR-CUR-CDE-NULL         PIC S9(04)     VALUE +0     05160000
051700                                                     COMP SYNC.   05170000
051800     05  PV-VOL-MSMT-NULL             PIC S9(04)     VALUE +0     05180000
051900                                                     COMP SYNC.   05190000
052000     05  PV-WGHT-MSMT-NULL            PIC S9(04)     VALUE +0     05200000
052100                                                     COMP SYNC.   05210000
052200     05  PV-NBR-QUAL-CDE-NULL         PIC S9(04)     VALUE +0     05220000
052300                                                     COMP SYNC.   05230000
052400     05  PV-ASNCAR-PKG-QTY-NULL       PIC S9(04)     VALUE +0     05240000
052500                                                     COMP SYNC.   05250000
052600     05  PV-ASNDTL-PKG-QTY-NULL       PIC S9(04)     VALUE +0     05260000
052700                                                     COMP SYNC.   05270000
052800     05  PV-PKG-QTY-UM-CDE-NULL       PIC S9(04)     VALUE +0     05280000
052900                                                     COMP SYNC.   05290000
053000     05  PV-WGHT-UM-CDE-NULL          PIC S9(04)     VALUE +0     05300000
053100                                                     COMP SYNC.   05310000
053200     05  PV-VOL-UM-CDE-NULL           PIC S9(04)     VALUE +0     05320000
053300                                                     COMP SYNC.   05330000
053400     05  PV-PKG-CDE-NULL              PIC S9(04)     VALUE +0     05340000
053500                                                     COMP SYNC.   05350000
053600     05  PV-LEN-MSMT-NULL             PIC S9(04)     VALUE +0     05360000
053700                                                     COMP SYNC.   05370000
053800     05  PV-HT-MSMT-NULL              PIC S9(04)     VALUE +0     05380000
053900                                                     COMP SYNC.   05390000
054000     05  PV-WDTH-MSMT-NULL            PIC S9(04)     VALUE +0     05400000
054100                                                     COMP SYNC.   05410000
054200     05  PV-SIZE-UM-CDE-NULL          PIC S9(04)     VALUE +0     05420000
054300                                                     COMP SYNC.   05430000
054400     05  PV-PKG-SIZE-QTY-NULL         PIC S9(04)     VALUE +0     05440000
054500                                                     COMP SYNC.   05450000
054600     05  PV-ALT-PROD1-CDE-NULL,       PIC S9(04)     VALUE +0     05460000
054700                                                     COMP SYNC.   05470000
054800     05  PV-ALT-PROD1-ID-NULL,        PIC S9(04)     VALUE +0     05480000
054900                                                     COMP SYNC.   05490000
055000     05  PV-ALT-PROD2-CDE-NULL,       PIC S9(04)     VALUE +0     05500000
055100                                                     COMP SYNC.   05510000
055200     05  PV-ALT-PROD2-ID-NULL,        PIC S9(04)     VALUE +0     05520000
055300                                                     COMP SYNC.   05530000
055400     05  PV-SHIPT-DTE-QTY-NULL,       PIC S9(04)     VALUE +0     05540000
055500                                                     COMP SYNC.   05550000
055600     05  PV-ITM-STATUS-CDE-NULL,      PIC S9(04)     VALUE +0     05560000
055700                                                     COMP SYNC.   05570000
055800     05  PV-ITM-ERR-CDE-NULL,         PIC S9(04)     VALUE +0     05580000
055900                                                     COMP SYNC.   05590000
056000     05  PV-ITM-ERR-QTY-NULL,         PIC S9(04)     VALUE +0     05600000
056100                                                     COMP SYNC.   05610000
056200     05  PV-ITM-ERR-QTY-UM-CDE-NULL,  PIC S9(04)     VALUE +0     05620000
056300                                                     COMP SYNC.   05630000
056400     05  PV-VEND-ORD-QTY-NULL,        PIC S9(04)     VALUE +0     05640000
056500                                                     COMP SYNC.   05650000
056600     05  PV-ORD-QTY-UM-CDE-NULL,      PIC S9(04)     VALUE +0     05660000
056700                                                     COMP SYNC.   05670000
056800     05  PV-WGT-MSMT-NULL,            PIC S9(04)     VALUE +0     05680000
056900                                                     COMP SYNC.   05690000
057000     05  PV-ITM-SUBST-UPC-NBR-NULL,   PIC S9(04)     VALUE +0     05700000
057100                                                     COMP SYNC.   05710000
057200     05  PV-INPK-EA-QTY-NULL,         PIC S9(04)     VALUE +0     05720000
057300                                                     COMP SYNC.   05730000
057400     05  PV-SHIP-TM-NULL,             PIC S9(04)     VALUE +0     05740000
057500                                                     COMP SYNC.   05750000
057600     05  PV-LINE-CNT                  PIC S9(03)     VALUE +0     05760000
057700                                                     COMP-3.      05770000
057800     05  PV-PAGE-CNT                  PIC 9(03)      VALUE ZERO   05780000
057900                                                     COMP-3.      05790000
058000     05 PV-NAME-ID-OUT-CDE            PIC X(4).                   05800000
058100     05 FILLER REDEFINES PV-NAME-ID-OUT-CDE.                      05810000
058200        10 PV-NAME-ID-OUT-TABLE  OCCURS 4 TIMES.                  05820000
058300           15  PV-NAME-ID-OUT         PIC X.                      05830000
058400                                                                  05840000
058500     05 PV-NAME-ID-CDE                PIC X(17).                  05850000
058600     05 FILLER REDEFINES PV-NAME-ID-CDE.                          05860000
058700        10 PV-NAME-ID-TABLE OCCURS 17 TIMES.                      05870000
058800           15  PV-NAME-ID-CHAR        PIC X.                      05880000
058900     05  PV-ID-CTR                    PIC 99         VALUE ZEROES.05890000
059000     05  PV-OUT-CTR                   PIC 9          VALUE ZERO.  05900000
059100     05  PV-STR-NBR-CTR               PIC 99         VALUE ZERO.  05910000
059200/                                                                 05920000
059300 01  PW-PROGRAM-WORKAREA.                                         05930000
059400     05  PW-RETRY-COUNTER             PIC S9(04)     VALUE +0     05940000
059500                                                     COMP SYNC.   05950000
059600     05  PW-RETRY-CNT                 PIC S9(04)     VALUE +0     05960000
059700                                                     COMP SYNC.   05970000
059800     05  PW-RETRY-CNT-9               PIC 9(04)      VALUE ZERO.  05980000
059900     05  PW-SUB                       PIC S9(03)     COMP-3       05990000
060000                                                     VALUE ZERO.  06000000
060100     05  PW-SQLCODE                   PIC  9(06)     VALUE ZERO.  06010000
060200     05  PW-ASNPKG-SUB                PIC S9(03)     COMP-3       06020000
060300                                                     VALUE ZERO.  06030000
060400     05  PW-NAME-SUB                  PIC S9(03)     COMP-3       06040000
060500                                                     VALUE ZERO.  06050000
060600     05  PW-ADDR-SUB                  PIC S9(03)     COMP-3       06060000
060700                                                     VALUE ZERO.  06070000
060800     05  PW-LIN-SUB                   PIC S9(03)     COMP-3       06080000
060900                                                     VALUE ZERO.  06090000
061000     05  PW-PO-SEQ-SUB                PIC S9(03)     COMP-3       06100000
061100                                                     VALUE ZERO.  06110000
061200     05  PW-NUMERIC-VEND-NO           PIC 9(03)      VALUE ZEROS. 06120000
061300     05  PW-NUMERIC-SEQ-NBR           PIC 9(04)      VALUE ZEROS. 06130000
061400     05  PW-VEND-NO.                                              06140000
061500         10  PW-VEND-NO-1-3           PIC X(03)      VALUE SPACE. 06150000
061600         10  PW-VEND-NO-4-30          PIC X(27)      VALUE SPACE. 06160000
061700     05  PW-DATE-YYMMDD.                                          06170000
061800         10  PW-DATE-YY               PIC 9(02)       VALUE ZEROS.06180000
061900         10  PW-DATE-MM               PIC 9(02)       VALUE ZEROS.06190000
062000         10  PW-DATE-DD               PIC 9(02)       VALUE ZEROS.06200000
062100     05 PW-NUMERIC-MDSEDP-NBR         PIC 9(03)       VALUE ZEROS.06210000
062200     05 PW-PKG-QTY-NUMERIC            PIC 9(11)       VALUE ZEROS.06220000
062300     05 PW-PKG-QTY-NUM REDEFINES PW-PKG-QTY-NUMERIC.              06230000
062400        10 PW-PKG-QTY-NUM-2           PIC 9(02).                  06240000
062500        10 PW-PKG-QTY-NUM-9           PIC 9(09).                  06250000
062600*    05  PW-SEQ-NBR                   PIC S9(4)       VALUE +0    06260000
062700*                                                     COMP-3.     06270000
062800     05  PW-PO-NBR-SEQ-NBR-TBL.                                   06280000
062900         10  PW-PO-SEQ OCCURS 1000 TIMES.                         06290000
063000             15  PW-PO-NBR            PIC X(22).                  06300000
063100             15  PW-SEQ-NBR           PIC S9(3)       COMP-3.     06310000
063200     05  PW-DISPLAY-SEQ-NBR           PIC 9(4).                   06320000
063300     05  PW-ASN-PO-NBR9               PIC 9(10)       VALUE ZEROS.06330000
063400     05  PW-HOST-PO-NBR               PIC S9(9)       COMP.       06340000
063500*PS 11/07/2014 CHANGE STARTS                                      06350000
063600     05  PW-PO-NBR-N                  PIC 9(8).                   06360000
063700*PS 11/07/2014 CHANGE ENDS                                        06370000
063800     05  PW-UPC-NBR-N                 PIC 9(17).                  06380000
063900     05  PW-EDI-VENDOR.                                           06390000
064000         10  PW-DUNNS-NBR             PIC X(9).                   06400000
064100         10  FILLER                   PIC X(8)        VALUE SPACE.06410000
064200                                                                  06420000
064300 01  PW-CURRENT-PARA                  PIC X(35)       VALUE SPACE.06430000
064400                                                                  06440000
064500 01  PW-ADV-SHIP-NOTICE-LINE          PIC X(132).                 06450000
064600/                                                                 06460000
064700 01  MSG-LINES.                                                   06470000
064800     05  MSG-1S.                                                  06480000
064900         10  FILLER                   PIC X(28)       VALUE       06490000
065000             'INVALID RECORD FOR SHIPMENT,'.                      06500000
065100         10  FILLER                   PIC X(35)       VALUE       06510000
065200             ' THE FOLLOWING RECORD WAS BYPASSED'.                06520000
065300         10  FILLER                   PIC X(20)       VALUE       06530000
065400             ' AT SHIPMENT LEVEL'.                                06540000
065500         10  FILLER                   PIC X(39)       VALUE SPACE.06550000
065600                                                                  06560000
065700     05  MSG-1O.                                                  06570000
065800         10  FILLER                   PIC X(28)       VALUE       06580000
065900             'INVALID RECORD FOR SHIPMENT,'.                      06590000
066000         10  FILLER                   PIC X(35)       VALUE       06600000
066010             ' THE FOLLOWING RECORD WAS BYPASSED'.                06601000
066020         10  FILLER                   PIC X(20)       VALUE       06602000
066030             ' AT ORDER LEVEL'.                                   06603000
066040         10  FILLER                   PIC X(39)       VALUE SPACE.06604000
066050                                                                  06605000
066060     05  MSG-1I.                                                  06606000
066061         10  FILLER                   PIC X(28)       VALUE       06606100
066062             'INVALID RECORD FOR SHIPMENT,'.                      06606200
066063         10  FILLER                   PIC X(35)       VALUE       06606300
066064             ' THE FOLLOWING RECORD WAS BYPASSED'.                06606400
066065         10  FILLER                   PIC X(20)       VALUE       06606500
066066             ' AT ITEM LEVEL'.                                    06606600
066067         10  FILLER                   PIC X(39)       VALUE SPACE.06606700
066068                                                                  06606800
066069     05  MSG-1P.                                                  06606900
066070         10  FILLER                   PIC X(28)       VALUE       06607000
066080             'INVALID RECORD FOR SHIPMENT,'.                      06608000
066090         10  FILLER                   PIC X(35)       VALUE       06609000
066091             ' THE FOLLOWING RECORD WAS BYPASSED'.                06609100
066092         10  FILLER                   PIC X(20)       VALUE       06609200
066093             ' AT PACK LEVEL'.                                    06609300
066094         10  FILLER                   PIC X(39)       VALUE SPACE.06609400
066095                                                                  06609500
066096     05  MSG-1B.                                                  06609600
066097         10  MSG-1B-DTL               PIC X(122).                 06609700
066098                                                                  06609800
066099     05  MSG-1C.                                                  06609900
066100         10  FILLER                   PIC X(28)       VALUE       06610000
066200             'INVALID RECORD FOR SHIPMENT,'.                      06620000
066300         10  FILLER                   PIC X(48)       VALUE       06630000
066400             ' TEXT 1 OF THE FOLLOWING RECORD WAS BYPASSED'.      06640000
066500         10  FILLER                   PIC X(46)       VALUE SPACE.06650000
066600                                                                  06660000
066700     05  MSG-1D.                                                  06670000
066800         10  FILLER                   PIC X(28)       VALUE       06680000
066900             'INVALID RECORD FOR SHIPMENT,'.                      06690000
067000         10  FILLER                   PIC X(48)       VALUE       06700000
067100             ' TEXT 2 OF THE FOLLOWING RECORD WAS BYPASSED'.      06710000
067200         10  FILLER                   PIC X(46)       VALUE SPACE.06720000
067300                                                                  06730000
067400     05  MSG-1E.                                                  06740000
067500         10  FILLER                   PIC X(28)       VALUE       06750000
067600             'INVALID RECORD FOR SHIPMENT,'.                      06760000
067700         10  FILLER                   PIC X(45)       VALUE       06770000
067800             ' THE FOLLOWING HL AND ITS ASSOCIATED DETAIL '.      06780000
067900         10  FILLER                   PIC X(24)       VALUE       06790000
068000             'RECS WILL BE BYPASSED'.                             06800000
068100         10  FILLER                   PIC X(25)       VALUE SPACE.06810000
068200                                                                  06820000
068300     05  MSG-1F.                                                  06830000
068400         10  FILLER                   PIC X(31)       VALUE       06840000
068500             'DUPLICATE DC OR STORE NUMBER = '.                   06850000
068600         10  MSG-1F-STORE-NBR         PIC X(04).                  06860000
068700         10  FILLER                   PIC X(08)       VALUE       06870000
068800             ' FOR PO '.                                          06880000
068900         10  MSG-1F-PO-NBR            PIC X(22).                  06890000
069000         10  FILLER                   PIC X(57)       VALUE SPACE.06900000
069100     05  MSG-1G.                                                  06910000
069200         10  FILLER                   PIC X(15)       VALUE       06920000
069300             'STORE NUMBER = '.                                   06930000
069400         10  MSG-1G-STORE-NBR         PIC X(04).                  06940000
069500         10  FILLER                   PIC X(08)       VALUE       06950000
069600             ' FOR PO '.                                          06960000
069700         10  MSG-1G-PO-NBR            PIC X(22).                  06970000
069800         10  FILLER                   PIC X(73)       VALUE       06980000
069900             ' NOT ADDED.  TOTAL STORES FOR THIS PO > 1,000'.     06990000
070000                                                                  07000000
070100     05  MSG-02.                                                  07010000
070200         10  FILLER                   PIC X(30)       VALUE       07020000
070300             'ITEM DETAIL INCOMPLETE FOR PO '.                    07030000
070400         10  MSG-02-ASNORD-PO-NBR     PIC X(22).                  07040000
070500         10  FILLER                   PIC X(18)       VALUE       07050000
070600             ' AT ITEM LEVEL    '.                                07060000
070700         10  FILLER                   PIC X(52)       VALUE SPACE.07070000
070800                                                                  07080000
070900     05  MSG-03.                                                  07090000
071000         10  FILLER                   PIC X(30)       VALUE       07100000
071100             'ITEM DETAIL INCOMPLETE FOR PO '.                    07110000
071200         10  MSG-03-ASNORD-PO-NBR     PIC X(22).                  07120000
071300         10  FILLER                   PIC X(18)       VALUE       07130000
071400             ' AT ORDER LEVEL   '.                                07140000
071500         10  FILLER                   PIC X(52)       VALUE SPACE.07150000
071600                                                                  07160000
071700     05  MSG-04.                                                  07170000
071800         10  FILLER                   PIC X(30)       VALUE       07180000
071900             'ITEM DETAIL INCOMPLETE FOR PO '.                    07190000
072000         10  MSG-04-ASNORD-PO-NBR     PIC X(22).                  07200000
072100         10  FILLER                   PIC X(18)       VALUE       07210000
072200             ' AT SHIPMENT LEVEL'.                                07220000
072300         10  FILLER                   PIC X(52)       VALUE SPACE.07230000
072400                                                                  07240000
072500     05  MSG-05.                                                  07250000
072600         10  FILLER                   PIC X(13)       VALUE       07260000
072700             'DUPLICATE ASN'.                                     07270000
072800         10  FILLER                   PIC X(109)      VALUE SPACE.07280000
072900                                                                  07290000
073000     05  MSG-06.                                                  07300000
073100         10  FILLER                   PIC X(17)       VALUE       07310000
073200             'SHIPMENT INSERTED'.                                 07320000
073300         10  FILLER                   PIC X(105)      VALUE SPACE.07330000
073400                                                                  07340000
073500     05  MSG-07.                                                  07350000
073600         10  FILLER                   PIC X(34)       VALUE       07360000
073700             'MULTIPLE SHIPMENT LOOPS - RECORDS '.                07370000
073800         10  FILLER                   PIC X(31)       VALUE       07380000
073900             'BYPASSED UNTIL NEXT ORDER LEVEL'.                   07390000
074000         10  FILLER                   PIC X(57)       VALUE SPACE.07400000
074100                                                                  07410000
074200     05  MSG-08.                                                  07420000
074300         10  FILLER                   PIC X(31)       VALUE       07430000
074400             'MAN SEGMENT NOT FOUND - CARTON '.                   07440000
074500         10  FILLER                   PIC X(20)       VALUE       07450000
074600             'INFO NOT PROCESSED. '.                              07460000
074700         10  FILLER                   PIC X(37)       VALUE       07470000
074800             'REMAINING CARTONS PROCESSED NORMALLY.'.             07480000
074900         10  FILLER                   PIC X(34)       VALUE SPACE.07490000
075000                                                                  07500000
075100     05  MSG-09.                                                  07510000
075200         10  FILLER                   PIC X(46)       VALUE       07520000
075300             'ITEM DETAIL NOT FOUND WITH MAN SEGMENT FOR PO '.    07530000
075400         10  MSG-09-ASNORD-PO-NBR     PIC X(22).                  07540000
075500         10  FILLER                   PIC X(23)       VALUE       07550000
075600             ' ASN HAS BEEN REJECTED.'.                           07560000
075700         10  FILLER                   PIC X(41)       VALUE SPACE.07570000
075800                                                                  07580000
075900     05  MSG-10.                                                  07590000
076000         10  FILLER                   PIC X(46)       VALUE       07600000
076100             'PO4 SEGMENT MISSING FOR ONE OR MORE CARTONS - '.    07610000
076200         10  FILLER                   PIC X(46)       VALUE       07620000
076300             'STANDARD PACK FORMAT - WARNING ONLY ...       '.    07630000
076400         10  FILLER                   PIC X(40)       VALUE SPACE.07640000
076500     05  MSG-11.                                                  07650000
076600         10  FILLER                   PIC X(28)       VALUE       07660000
076700             'PACK UPC VALID FOR CARTON - '.                      07670000
076800         10  WS-CARTON-NBR            PIC X(20)      VALUE SPACES.07680000
076900         10  FILLER                   PIC X(3)       VALUE '.  '. 07690000
077000         10  FILLER                   PIC X(16)      VALUE        07700000
077100             'COMPONENT UPC - '.                                  07710000
077200         10  WS-COMP-UPC-NBR          PIC 9(17)      VALUE 0.     07720000
077300         10  FILLER                   PIC X(3)       VALUE '.  '. 07730000
077400         10  FILLER                   PIC X(34)      VALUE        07740000
077500             'SENT WITH ZERO QTY - WARNING ONLY.'.                07750000
077600*PS 11/07/2014 CHANGE STARTS                                      07760000
077700         10  WS-PO                    PIC X(8)       VALUE SPACES.07770000
077800         10  FILLER                   PIC X(8)       VALUE SPACES.07780000
077900*PS 11/07/2014 CHANGE ENDS                                        07790000
078000     05  MSG-12.                                                  07800000
078100         10  FILLER                   PIC X(28)      VALUE        07810000
078200             'PACK UPC VALID FOR CARTON - '.                      07820000
078300         10  WS-CARTON-NBR2           PIC X(20)      VALUE SPACES.07830000
078400         10  FILLER                   PIC X(3)       VALUE '.  '. 07840000
078500         10  FILLER                   PIC X(16)      VALUE        07850000
078600             'COMPONENT UPC - '.                                  07860000
078700         10  WS-COMP-UPC-NBR2         PIC 9(17)      VALUE 0.     07870000
078800         10  FILLER                   PIC X(3)       VALUE '.  '. 07880000
078900         10  FILLER                   PIC X(38)      VALUE        07890000
079000             'COMPONENT UPC MISSING IN TRANSMISSION.'.            07900000
079100*PS 11/07/2014 CHANGE STARTS                                      07910000
079200         10  WS-PO2                   PIC X(8)       VALUE SPACES.07920000
079300         10  FILLER                   PIC X(4)       VALUE SPACES.07930000
079400*PS 11/07/2014 CHANGE ENDS                                        07940000
079500     05  MSG-13.                                                  07950000
079600         10  FILLER                   PIC X(28)      VALUE        07960000
079700             'PACK UPC VALID FOR CARTON - '.                      07970000
079800         10  WS-CARTON-NBR3           PIC X(20)      VALUE SPACES.07980000
079900         10  FILLER                   PIC X(3)       VALUE '.  '. 07990000
080000         10  FILLER                   PIC X(16)      VALUE        08000000
080100             'COMPONENT UPC - '.                                  08010000
080200         10  WS-COMP-UPC-NBR3         PIC 9(17)      VALUE 0.     08020000
080300         10  FILLER                   PIC X(3)       VALUE '.  '. 08030000
080400         10  FILLER                   PIC X(38)      VALUE        08040000
080500             'COMPONENT NOT IN SYSTEM IMAGE OF PACK.'.            08050000
080600*PS 11/07/2014 CHANGE STARTS                                      08060000
080700         10  WS-PO3                   PIC X(8)       VALUE SPACES.08070000
080800         10  FILLER                   PIC X(4)       VALUE SPACES.08080000
080900*PS 11/07/2014 CHANGE ENDS                                        08090000
081000     05  MSG-14.                                                  08100000
081100         10  FILLER                   PIC X(28)       VALUE       08110000
081200             'PACK UPC VALID FOR CARTON - '.                      08120000
081300         10  WS-CARTON-NBR4           PIC X(20)      VALUE SPACES.08130000
081400         10  FILLER                   PIC X(3)       VALUE '.  '. 08140000
081500         10  FILLER                   PIC X(16)       VALUE       08150000
081600             'COMPONENT UPC - '.                                  08160000
081700         10  WS-COMP-UPC-NBR4         PIC 9(17)      VALUE 0.     08170000
081800         10  FILLER                   PIC X(3)       VALUE '.  '. 08180000
081900         10  FILLER                   PIC X(38)       VALUE       08190000
082000             'UPC TYPE NOT FND - CAN NOT BUILD PACK.'.            08200000
082100         10  FILLER                   PIC X(12)     VALUE SPACES. 08210000
082200     05  MSG-15.                                                  08220000
082300         10  FILLER                   PIC X(30)       VALUE       08230000
082400             'PACK UPC VALID FOR CARTON -   '.                    08240000
082500         10  WS-CARTON-NBR5           PIC X(20)      VALUE SPACES.08250000
082600         10  FILLER                   PIC X(3)       VALUE '.  '. 08260000
082700         10  FILLER                   PIC X(44)       VALUE       08270000
082800             'COMPONENTS NOT SENT - GENERATED FROM SYSTEM.'.      08280000
082900*PS 11/07/2014 CHANGE STARTS                                      08290000
083000         10  WS-PO5                   PIC X(8)       VALUE SPACES.08300000
083100         10  FILLER                   PIC X(29)      VALUE SPACES.08310000
083200*PS 11/07/2014 CHANGE ENDS                                        08320000
083300     05  MSG-16.                                                  08330000
083400         10  FILLER                   PIC X(26)       VALUE       08340000
083500             'COMPOUND PACK UPC INVALID-'.                        08350000
083600*PS 11/07/2014 CHANGE STARTS                                      08360000
083700         10  WS-PO6                   PIC X(8)       VALUE SPACES.08370000
083800         10  FILLER                   PIC X(1)       VALUE '.'.   08380000
083900*PS 11/07/2014 CHANGE ENDS                                        08390000
084000         10  FILLER                   PIC X(9)        VALUE       08400000
084100             'PACK UPC-'.                                         08410000
084200         10  WS-PACK-UPC-NBR6         PIC 9(17)      VALUE 0.     08420000
084300         10  FILLER                   PIC X(1)       VALUE SPACES.08430000
084400         10  FILLER                   PIC X(9)        VALUE       08440000
084500             'COMP UPC-'.                                         08450000
084600         10  WS-COMP-UPC-NBR6         PIC 9(17)      VALUE 0.     08460000
084700         10  FILLER                   PIC X(3)       VALUE '. '.  08470000
084800         10  FILLER                   PIC X(31)       VALUE       08480000
084900             'MULT LINES RESOLVED-DISCARDED. '.                   08490000
085000         10  FILLER                   PIC X(4)       VALUE        08500000
085100             'DC- '.                                              08510000
085200         10  WS-STORE6                PIC 9(5)      VALUE 0.      08520000
085300     05  MSG-17.                                                  08530000
085400         10  FILLER                   PIC X(30)       VALUE       08540000
085500             'LIN NOT PACK UPC FOR CARTON - '.                    08550000
085600         10  WS-CARTON-NBR7           PIC X(20)      VALUE SPACES.08560000
085700         10  FILLER                   PIC X(3)       VALUE '.  '. 08570000
085800         10  FILLER                   PIC X(11)       VALUE       08580000
085900             'LIN UPC  - '.                                       08590000
086000         10  WS-COMP-UPC-NBR7         PIC 9(17)      VALUE 0.     08600000
086100         10  FILLER                   PIC X(3)       VALUE '.  '. 08610000
086200         10  FILLER                   PIC X(26)       VALUE       08620000
086300             'MULTIPLE LINES RESOLVED.  '.                        08630000
086400*PS 11/07/2014 CHANGE STARTS                                      08640000
086500         10  WS-PO7                   PIC X(8)       VALUE SPACES.08650000
086600         10  FILLER                   PIC X(19)      VALUE SPACES.08660000
086700*PS 11/07/2014 CHANGE ENDS                                        08670000
086800     05  MSG-18.                                                  08680000
086900         10  FILLER                   PIC X(25)       VALUE       08690000
087000             'BAD COMP UPC IN CARTON - '.                         08700000
087100         10  WS-CARTON-NBR8           PIC X(20)      VALUE SPACES.08710000
087200         10  FILLER                   PIC X(3)       VALUE '.  '. 08720000
087300         10  FILLER                   PIC X(11)       VALUE       08730000
087400             'COMP UPC - '.                                       08740000
087500         10  WS-COMP-UPC-NBR8         PIC 9(17)      VALUE 0.     08750000
087600         10  FILLER                   PIC X(3)       VALUE '-  '. 08760000
087700         10  FILLER                   PIC X(38)     VALUE         08770000
087800             'MAY BE CANCELLED LINE OR NOT EXIST - '.             08780000
087900*PS 11/07/2014 CHANGE STARTS                                      08790000
088000         10  WS-PO8                   PIC X(8)      VALUE SPACES. 08800000
088100         10  FILLER                   PIC X(09)     VALUE SPACES. 08810000
088200*PS 11/07/2014 CHANGE ENDS                                        08820000
088300                                                                  08830000
088400*CHG107105 - START                                                08840000
088500     05  MSG-19.                                                  08850000
088600         10  FILLER                   PIC X(38)       VALUE       08860000
088700             'TWO TD1 SEGMENTS PRESENT IN THE ASN - '.            08870000
088800         10  FILLER                   PIC X(20)       VALUE       08880000
088900             'ASN NOT PROCESSED - '.                              08890000
089000         10  FILLER                   PIC X(22)       VALUE       08900000
089100             'PLEASE CONTACT VENDOR.'.                            08910000
089200         10  FILLER                   PIC X(52)       VALUE SPACE.08920000
089300*CHG107105 - END                                                  08930000
089310/                                                                 08931000
089320 01  TL1-TOTAL-LINE1.                                             08932000
089330     05  FILLER                       PIC X(30)       VALUE       08933000
089340         '  ASN SHIPMENTS INSERTED      '.                        08934000
089350     05  TL1-ASNHDR-INSERTED          PIC ZZZ,ZZ9.                08935000
089360     05  FILLER                       PIC X(95)       VALUE SPACE.08936000
089370/                                                                 08937000
089380 01  TL2-TOTAL-LINE2.                                             08938000
089390     05  FILLER                       PIC X(30)       VALUE       08939000
089400         '  ASN SHIPMENTS DELETED       '.                        08940000
089500     05  TL2-ASNHDR-DELETED           PIC ZZZ,ZZ9.                08950000
089600     05  FILLER                       PIC X(95)       VALUE SPACE.08960000
089700/                                                                 08970000
089800 01  PW-HOLD-AREA.                                                08980000
089900     05  PW-HOLD-EDI-VEND-ID          PIC X(17)       VALUE SPACE.08990000
090000     05  PW-HOLD-VEND-DUNNS-NBR       PIC X(09)       VALUE SPACE.09000000
090100     05  PW-HOLD-VENDOR-NAME          PIC X(30)       VALUE SPACE.09010000
090200     05  PW-HOLD-TRANS-CDE            PIC X(02)       VALUE SPACE.09020000
090300     05  PW-HOLD-CRE-DTE              PIC 9(06)       VALUE ZEROS.09030000
090400     05  PW-HOLD-CRE-DTE-CCYYMMDD.                                09040000
090500         10  PW-HOLD-CRE-DTE-CC       PIC 9(02)       VALUE ZEROS.09050000
090600         10  PW-HOLD-CRE-DTE-YY       PIC 9(02)       VALUE ZEROS.09060000
090700         10  FILLER                   PIC X(01)       VALUE '-'.  09070000
090800         10  PW-HOLD-CRE-DTE-MM       PIC 9(02)       VALUE ZEROS.09080000
090900         10  FILLER                   PIC X(01)       VALUE '-'.  09090000
091000         10  PW-HOLD-CRE-DTE-DD       PIC 9(02)       VALUE ZEROS.09100000
091100     05  PW-HOLD-CRE-DTE-REDF REDEFINES                           09110000
091200         PW-HOLD-CRE-DTE-CCYYMMDD     PIC  X(10).                 09120000
091300     05  PW-HOLD-CRE-TIME.                                        09130000
091400         10  PW-HOLD-CRE-TIME-HH      PIC  9(02)      VALUE ZEROS.09140000
091500         10  PW-HOLD-CRE-TIME-MM      PIC  9(02)      VALUE ZEROS.09150000
091600     05  PW-HOLD-CRE-TIME-REDF.                                   09160000
091700         10  PW-HOLD-CRE-TIME-HH-REDF PIC  9(02)      VALUE ZEROS.09170000
091800         10  FILLER                   PIC  X(01)      VALUE '.'.  09180000
091900         10  PW-HOLD-CRE-TIME-MM-REDF PIC  9(02)      VALUE ZEROS.09190000
092000         10  FILLER                   PIC  X(01)      VALUE '.'.  09200000
092100         10  PW-HOLD-CRE-TIME-SS-REDF PIC  9(02)      VALUE ZEROS.09210000
092200     05  PW-SAVE-CRE-TIME             PIC  X(08)    VALUE SPACES. 09220000
092300     05  PW-HOLD-SHIP-TIME.                                       09230000
092400         10  PW-HOLD-SHIP-TIME-HH     PIC  9(02)      VALUE ZEROS.09240000
092500         10  PW-HOLD-SHIP-TIME-MM     PIC  9(02)      VALUE ZEROS.09250000
092600     05  PW-HOLD-SHIP-TIME-REDF.                                  09260000
092700         10  PW-HOLD-SHIP-TIME-HH-REDF PIC  9(02)     VALUE ZEROS.09270000
092800         10  FILLER                    PIC  X(01)     VALUE '.'.  09280000
092900         10  PW-HOLD-SHIP-TIME-MM-REDF PIC  9(02)     VALUE ZEROS.09290000
093000         10  FILLER                    PIC  X(01)     VALUE '.'.  09300000
093100         10  PW-HOLD-SHIP-TIME-SS-REDF PIC  9(02)     VALUE ZEROS.09310000
093200     05  PW-SAVE-SHIP-TIME           PIC  X(08)    VALUE SPACES.  09320000
093300     05  PW-HOLD-ANTC-DELY-DTE        PIC  9(06)      VALUE ZEROS.09330000
093400     05  PW-HOLD-ANTC-DELY-DTE-CCYYMMDD.                          09340000
093500         10  PW-HOLD-ANTC-DELY-DTE-CC PIC 9(02)       VALUE ZEROS.09350000
093600         10  PW-HOLD-ANTC-DELY-DTE-YY PIC 9(02)       VALUE ZEROS.09360000
093700         10  FILLER                   PIC X(01)       VALUE '-'.  09370000
093800         10  PW-HOLD-ANTC-DELY-DTE-MM PIC 9(02)       VALUE ZEROS.09380000
093900         10  FILLER                   PIC X(01)       VALUE '-'.  09390000
094000         10  PW-HOLD-ANTC-DELY-DTE-DD PIC 9(02)       VALUE ZEROS.09400000
094100     05  PW-HOLD-ANTC-DELY-DTE-REDF REDEFINES                     09410000
094200         PW-HOLD-ANTC-DELY-DTE-CCYYMMDD PIC X(10).                09420000
094300     05  PW-HOLD-SHIP-DTE             PIC  9(06)      VALUE ZEROS.09430000
094400     05  PW-HOLD-SHIP-DTE-CCYYMMDD.                               09440000
094500         10  PW-HOLD-SHIP-DTE-CC      PIC 9(02)       VALUE ZEROS.09450000
094600         10  PW-HOLD-SHIP-DTE-YY      PIC 9(02)       VALUE ZEROS.09460000
094700         10  FILLER                   PIC X(01)       VALUE '-'.  09470000
094800         10  PW-HOLD-SHIP-DTE-MM      PIC 9(02)       VALUE ZEROS.09480000
094900         10  FILLER                   PIC X(01)       VALUE '-'.  09490000
095000         10  PW-HOLD-SHIP-DTE-DD      PIC 9(02)       VALUE ZEROS.09500000
095100     05  PW-HOLD-SHIP-DTE-REDF REDEFINES                          09510000
095200         PW-HOLD-SHIP-DTE-CCYYMMDD    PIC  X(10).                 09520000
095300     05  PW-HOLD-SCHD-SHIP-DTE        PIC  9(06)      VALUE ZEROS.09530000
095400     05  PW-HOLD-SCHD-SHIP-DTE-CCYYMMDD.                          09540000
095500         10  PW-HOLD-SCHD-SHIP-DTE-CC PIC 9(02)       VALUE ZEROS.09550000
095600         10  PW-HOLD-SCHD-SHIP-DTE-YY PIC 9(02)       VALUE ZEROS.09560000
095700         10  FILLER                   PIC X(01)       VALUE '-'.  09570000
095800         10  PW-HOLD-SCHD-SHIP-DTE-MM PIC 9(02)       VALUE ZEROS.09580000
095900         10  FILLER                   PIC X(01)       VALUE '-'.  09590000
096000         10  PW-HOLD-SCHD-SHIP-DTE-DD PIC 9(02)       VALUE ZEROS.09600000
096100     05  PW-HOLD-SCHD-SHIP-DTE-REDF REDEFINES                     09610000
096200         PW-HOLD-SCHD-SHIP-DTE-CCYYMMDD PIC X(10).                09620000
096300     05  PW-HOLD-NAME-CDE             PIC X(02)       VALUE SPACE.09630000
096400     05  PW-HOLD-CUST-NAME            PIC X(35)       VALUE SPACE.09640000
096500     05  PW-HOLD-NAME-ID-CDE          PIC X(17)       VALUE SPACE.09650000
096600     05  PW-HOLD-NAME-ID-CDE-NUM REDEFINES PW-HOLD-NAME-ID-CDE.   09660000
096700         10  PW-HOLD-NAME-ID-CDE-999  PIC 9(4).                   09670000
096800         10  PW-HOLD-NAME-ID-CDE-X    PIC X(13).                  09680000
096900     05  PW-HOLD-NAME-ID-QUAL-CDE     PIC X(02)       VALUE SPACE.09690000
097000     05  PW-HOLD-CTY-NAME             PIC X(35)       VALUE SPACE.09700000
097100     05  PW-HOLD-ST-CDE               PIC X(02)       VALUE SPACE.09710000
097200     05  PW-HOLD-CNTRY-CDE            PIC X(02)       VALUE SPACE.09720000
097300     05  PW-HOLD-ZIP-CDE              PIC X(09)       VALUE SPACE.09730000
097400     05  PW-HOLD-PO-DTE               PIC  9(06)      VALUE ZEROS.09740000
097500     05  PW-HOLD-PO-DTE-CCYYMMDD.                                 09750000
097600         10  PW-HOLD-PO-DTE-CC        PIC 9(02)       VALUE ZEROS.09760000
097700         10  PW-HOLD-PO-DTE-YY        PIC 9(02)       VALUE ZEROS.09770000
097800         10  FILLER                   PIC X(01)       VALUE '-'.  09780000
097900         10  PW-HOLD-PO-DTE-MM        PIC 9(02)       VALUE ZEROS.09790000
098000         10  FILLER                   PIC X(01)       VALUE '-'.  09800000
098100         10  PW-HOLD-PO-DTE-DD        PIC 9(02)       VALUE ZEROS.09810000
098200     05  PW-HOLD-PO-DTE-REDF REDEFINES                            09820000
098300         PW-HOLD-PO-DTE-CCYYMMDD      PIC  X(10).                 09830000
098400     05  PW-KOHLS-ASNCAR-NBR.                                     09840000
098500         10  PW-KOHLS-ASNCAR-ID       PIC X(15)       VALUE       09850000
098600             'KOHLS-ASSIGNED-'.                                   09860000
098700         10  PW-KOHLS-ASNCAR-CNT      PIC 9(06)       VALUE ZEROS.09870000
098800     05  PW-HOLD-ASNDTL-NBR           PIC S9(07)      COMP-3      09880000
098900                                                      VALUE +1.   09890000
099000     05  PW-HOLD-ISA-CNTL-NBR         PIC S9(9)V VALUE 0 COMP-3.  09900000
099100     05  PW-HOLD-GS-CNTL-NBR          PIC S9(9)V VALUE 0 COMP-3.  09910000
099200     05  PW-HOLD-ST-CNTL-NBR          PIC X(9)     VALUE SPACES.  09920000
099300     05  PW-HOLD-ISA-TMST             PIC X(26)    VALUE SPACES.  09930000
099400 01  PW-ASNHDR-RECORD.                                            09940000
099500     05  PW-ASNHDR-NBR                PIC  X(30)      VALUE SPACE.09950000
099600     05  PW-ASNHDR-BOL-NBR            PIC  X(30)      VALUE SPACE.09960000
099700     05  PW-ASNHDR-PRO-NBR            PIC  X(30)      VALUE SPACE.09970000
099800* CLT WR40574 START 01-10-12                                ***** 09980000
099900     05  PW-ASNHDR-CARR-AUTH-ID       PIC  X(30)      VALUE SPACE.09990000
100000* CLT WR40574 END   01-10-12                                ***** 10000000
100100     05  PW-ASNHDR-CART-SHIP-QTY      PIC S9(07)      COMP-3      10010000
100200                                                      VALUE ZEROS.10020000
100300     05  PW-ASNHDR-GRO-WGHT-MSMT      PIC S9(09)V9(2) COMP-3      10030000
100400                                                      VALUE ZEROS.10040000
100500     05  PW-ASNHDR-REC-MTHD-IND       PIC  X(01)      VALUE SPACE.10050000
100600     05  PW-ASNHDR-SHIPT-STATUS-CDE   PIC  X(02)      VALUE SPACE.10060000
100700     05  PW-ASNHDR-CARR-NAME          PIC  X(35)      VALUE SPACE.10070000
100800     05  PW-ASNHDR-TRANS-MTHD-CDE     PIC  X(02)      VALUE SPACE.10080000
100900     05  PW-ASNHDR-CARR-ID-CDE        PIC  X(17)      VALUE SPACE.10090000
101000     05  PW-ASNHDR-CARR-ID-QUAL-CDE   PIC  X(02)      VALUE SPACE.10100000
101100     05  PW-ASNHDR-RTE-SEQ-CDE        PIC  X(02)      VALUE SPACE.10110000
101200     05  PW-ASNHDR-SHPT-VOL-MSMT      PIC S9(09)V9(2) COMP-3      10120000
101300                                                      VALUE ZEROS.10130000
101400     05  PW-ASNHDR-EQUIP-INIT-CDE     PIC  X(04)      VALUE SPACE.10140000
101500     05  PW-ASNHDR-EQUIP-NBR          PIC  X(10)      VALUE SPACE.10150000
101600     05  PW-ASNHDR-REJ-SHIPT-CDE      PIC  X(01)      VALUE SPACE.10160000
101700     05  PW-ASNHDR-SHPT-VOL-UM-CDE    PIC  X(02)      VALUE SPACE.10170000
101800     05  PW-ASNHDR-GRO-WGHT-UM-CDE    PIC  X(02)      VALUE SPACE.10180000
101900     05  PW-ASNHDR-PRINT-IND          PIC  X(01)      VALUE SPACE.10190000
102000     05  PW-ASNHDR-SHIP-PAYT-TERM-CDE PIC  X(02)      VALUE SPACE.10200000
102100     05  PW-ASNHDR-RESPBL-LOC-CDE     PIC  X(02)      VALUE SPACE.10210000
102200     05  PW-ASNHDR-RESPBL-LOC-DESC    PIC  X(80)      VALUE SPACE.10220000
102300                                                                  10230000
102400 01  PW-ASNPKG-TABLE.                                             10240000
102500     05  PW-ASNPKG-RECORD OCCURS 20 TIMES.                        10250000
102600         10  PW-ASNPKG-PACK-CDE       PIC  X(05)      VALUE SPACE.10260000
102700         10  PW-ASNPKG-CART-SHIP-QTY  PIC S9(07)      COMP-3      10270000
102800                                                      VALUE ZEROS.10280000
102900         10  PW-ASNPKG-GRO-WGHT-MSMT  PIC S9(09)V9(2) COMP-3      10290000
103000                                                      VALUE ZEROS.10300000
103100         10  PW-ASNPKG-GRO-WGHT-UM-CDE PIC X(02)      VALUE SPACE.10310000
103200                                                                  10320000
103300 01  PW-ASNORD-RECORD.                                            10330000
103400     05 PW-ASNORD-PO-NBR              PIC  X(22)      VALUE SPACE.10340000
103500     05 PW-ASNORD-SEQ-NBR             PIC S9(03)      COMP-3      10350000
103600                                                      VALUE ZEROS.10360000
103700     05 PW-ASNORD-VEND-ORD-NBR        PIC  X(30)      VALUE SPACE.10370000
103800     05 PW-ASNORD-CUST-NBR            PIC  X(30)      VALUE SPACE.10380000
103900     05 PW-ASNORD-SELR-INV-NBR        PIC  X(30)      VALUE SPACE.10390000
104000     05 PW-ASNORD-PROMO-NBR           PIC  X(30)      VALUE SPACE.10400000
104100     05 PW-ASNORD-VEND-NBR            PIC S9(03)      COMP-3      10410000
104200                                                      VALUE ZEROS.10420000
104300     05 PW-ASNORD-MDSEDP-NBR          PIC  X(03)      VALUE SPACE.10430000
104400     05 PW-ASNORD-ORD-STATUS-CDE      PIC  X(02)      VALUE SPACE.10440000
104500     05 PW-ASNORD-CHG-ORD-SEQ-NBR     PIC  X(08)      VALUE SPACE.10450000
104600     05 PW-ASNORD-PO-DTE              PIC  X(10)      VALUE SPACE.10460000
104700     05 PW-ASNORD-LTE-CHG-AMT         PIC S9(06)V99   COMP-3      10470000
104800                                                      VALUE ZEROS.10480000
104900     05 PW-ASNORD-EXCH-FCTR           PIC S9(06)V9(4) COMP-3      10490000
105000                                                      VALUE ZEROS.10500000
105100     05 PW-ASNORD-SELR-CUR-CDE        PIC  X(03)      VALUE SPACE.10510000
105200     05 PW-ASNORD-EARLY-LTE-CDE       PIC  X(01)      VALUE SPACE.10520000
105300     05 PW-ASNORD-SEQ-NBR-IND         PIC  X(01)      VALUE SPACE.10530000
105400         88 ASNORD-SEQ-NMBR                           VALUE 'Y'.  10540000
105500         88 ASNORD-STR-NMBR                           VALUE 'N'.  10550000
105600     05 PW-ASNORD-CART-SHIP-QTY       PIC S9(07)      COMP-3      10560000
105700                                                      VALUE ZEROS.10570000
105800     05 PW-ASNORD-LOC-NBR             PIC S9(4)       COMP        10580000
105900                                                      VALUE 0.    10590000
106000 01  PW-ADDITIONAL-ADDRESS-TABLE.                                 10600000
106100     05  PW-ADDR-TXT  OCCURS 4 TIMES  PIC  X(35)      VALUE SPACE.10610000
106200                                                                  10620000
106300 01  PW-ADDITIONAL-NAME-TABLE.                                    10630000
106400     05  PW-NAME-TXT  OCCURS 4 TIMES  PIC  X(35)      VALUE SPACE.10640000
106500                                                                  10650000
106600 01  PW-ASNCAR-RECORD.                                            10660000
106700     05  PW-ASNCAR-ASNCAR-NBR         PIC  X(45)      VALUE SPACE.10670000
106800     05  PW-ASNCAR-VOL-MSMT           PIC S9(09)V9(2) COMP-3      10680000
106900                                                      VALUE ZEROS.10690000
107000     05  PW-ASNCAR-WGHT-MSMT          PIC S9(09)V9(2) COMP-3      10700000
107100                                                      VALUE ZEROS.10710000
107200     05  PW-ASNCAR-NBR-QUAL-CDE       PIC  X(02)      VALUE SPACE.10720000
107300     05  PW-ASNCAR-PKG-QTY            PIC S9(07)      COMP-3      10730000
107400                                                      VALUE ZEROS.10740000
107500     05  PW-ASNCAR-PKG-QTY-UM-CDE     PIC  X(02)      VALUE SPACE.10750000
107600     05  PW-ASNCAR-WGHT-UM-CDE        PIC  X(02)      VALUE SPACE.10760000
107700     05  PW-ASNCAR-VOL-UM-CDE         PIC  X(02)      VALUE SPACE.10770000
107800     05  PW-ASNCAR-PKG-CDE            PIC  X(03)      VALUE SPACE.10780000
107900     05  PW-ASNCAR-LEN-MSMT           PIC S9(09)V9(2) COMP-3      10790000
108000                                                      VALUE ZEROS.10800000
108100     05  PW-ASNCAR-HT-MSMT            PIC S9(09)V9(2) COMP-3      10810000
108200                                                      VALUE ZEROS.10820000
108300     05  PW-ASNCAR-WDTH-MSMT          PIC S9(09)V9(2) COMP-3      10830000
108400                                                      VALUE ZEROS.10840000
108500     05  PW-ASNCAR-SIZE-UM-CDE        PIC  X(02)      VALUE SPACE.10850000
108600     05  PW-ASNCAR-PKG-SIZE-QTY       PIC S9(07)      COMP-3      10860000
108700                                                      VALUE ZEROS.10870000
108800     05  PW-ASNCAR-HOLD-INPK-EA-QTY   PIC S9(04)      COMP        10880000
108900                                                      VALUE +0.   10890000
109000     05  PW-ASNCAR-COMP-INPK-TOT-QTY  PIC S9(09)      COMP-3      10900000
109100                                                      VALUE +0.   10910000
109200*                                                                 10920000
109300* DMH 03/07/16 BEGIN (ADDED FOR OUTLET CARRIER TRACKING)          10930000
109400     05  PW-ASNCAR-NBR-QUAL-CDE-CARR  PIC  X(02)      VALUE SPACE.10940000
109500     05  PW-ASNCAR-NBR-CARR-TRACKING  PIC  X(45)      VALUE SPACE.10950000
109600* DMH 03/07/16 END   (ADDED FOR OUTLET CARRIER TRACKING)          10960000
109700*                                                                 10970000
109800                                                                  10980000
109900 01  PW-ITEM-IDENTIFICATION-TABLE.                                10990000
110000     05  PW-LIN-RECORD OCCURS 10 TIMES.                           11000000
110010         10  PW-LIN-PROD-CDE          PIC  X(02)      VALUE SPACE.11001000
110020         10  PW-LIN-PROD-ID           PIC  X(30)      VALUE SPACE.11002000
110030                                                                  11003000
110040 01  PW-ASNDTL-RECORD.                                            11004000
110050     05  PW-ASNDTL-UPC-NBR            PIC S9(15)      COMP-3      11005000
110060                                                      VALUE ZEROS.11006000
110070     05  PW-ASNDTL-ALT-PROD1-CDE      PIC  X(02)      VALUE SPACE.11007000
110080     05  PW-ASNDTL-ALT-PROD1-ID       PIC  X(30)      VALUE SPACE.11008000
110090     05  PW-ASNDTL-ALT-PROD2-CDE      PIC  X(02)      VALUE SPACE.11009000
110100     05  PW-ASNDTL-ALT-PROD2-ID       PIC  X(30)      VALUE SPACE.11010000
110200     05  PW-ASNDTL-SHIPT-QTY          PIC S9(07)      COMP-3      11020000
110300                                                      VALUE ZEROS.11030000
110400     05  PW-ASNDTL-SHIPT-DTE-QTY      PIC S9(07)      COMP-3      11040000
110500                                                      VALUE ZEROS.11050000
110600     05  PW-ASNDTL-SHIPT-UM-CDE       PIC  X(02)      VALUE SPACE.11060000
110700     05  PW-ASNDTL-ITM-STATUS-CDE     PIC  X(02)      VALUE SPACE.11070000
110800     05  PW-ASNDTL-ITM-ERR-CDE        PIC  X(01)      VALUE SPACE.11080000
110900     05  PW-ASNDTL-ITM-ERR-QTY        PIC S9(07)      COMP-3      11090000
111000                                                      VALUE ZEROS.11100000
111100     05  PW-ASNDTL-ITM-ERR-QTY-UM-CDE PIC  X(02)      VALUE SPACE.11110000
111200     05  PW-ASNDTL-PKG-QTY            PIC S9(07)      COMP-3      11120000
111300                                                      VALUE ZEROS.11130000
111400     05  PW-ASNDTL-PKG-QTY-UM-CDE     PIC  X(02)      VALUE SPACE.11140000
111500     05  PW-ASNDTL-VEND-ORD-QTY       PIC S9(07)      COMP-3      11150000
111600                                                      VALUE ZEROS.11160000
111700     05  PW-ASNDTL-ORD-QTY-UM-CDE     PIC X(02)       VALUE SPACE.11170000
111800     05  PW-ASNDTL-WGT-MSMT           PIC S9(09)V9(2) COMP-3      11180000
111900                                                      VALUE ZEROS.11190000
112000     05  PW-ASNDTL-WGT-UM-CDE         PIC  X(02)      VALUE SPACE.11200000
112100     05  PW-ASNDTL-VOL-MSMT           PIC S9(09)V9(2) COMP-3      11210000
112200                                                      VALUE ZEROS.11220000
112300     05  PW-ASNDTL-VOL-UM-CDE         PIC  X(02)      VALUE SPACE.11230000
112400     05  PW-ASNDTL-LEN-MSMT           PIC S9(09)V9(2) COMP-3      11240000
112500                                                      VALUE ZEROS.11250000
112600     05  PW-ASNDTL-HT-MSMT            PIC S9(09)V9(2) COMP-3      11260000
112700                                                      VALUE ZEROS.11270000
112800     05  PW-ASNDTL-WDTH-MSMT          PIC S9(09)V9(2) COMP-3      11280000
112900                                                      VALUE ZEROS.11290000
113000     05  PW-ASNDTL-SIZE-UM-CDE        PIC  X(02)      VALUE SPACE.11300000
113100     05  PW-ASNDTL-ITM-SUBST-UPC-NBR  PIC  X(12)      VALUE SPACE.11310000
113200     05  PW-ASNDTL-TKT-ERR-CDE        PIC  X(04)      VALUE SPACE.11320000
113300     05  PW-ASNDTL-HOLD-INPK-EA-QTY   PIC S9(04)      COMP        11330000
113400                                                      VALUE +0.   11340000
113500     05  PW-ASNDTL-COMP-INPK-TOT-QTY  PIC S9(09)      COMP-3      11350000
113600                                                      VALUE +0.   11360000
113700 01  WS-PACK-TABLE.                                               11370000
113800     05 WS-PACK-IDENT OCCURS 1000 TIMES.                          11380000
113900        10  WS-PACK-ID                PIC 9(7)     VALUE 0.       11390000
114000        10  WS-PACK-TBL OCCURS 1000 TIMES.                        11400000
114100            15  WS-PACK-LN-UPC        PIC 9(17)    VALUE 0.       11410000
114200            15  WS-PACK-LN-RATIO      PIC 9(7)     VALUE 0.       11420000
114300            15  WS-PACK-MATCH         PIC X(1)     VALUE SPACES.  11430000
114400 01  WS-PRPK-TABLE.                                               11440000
114500     05  WS-PRPK-TBL OCCURS 1000 TIMES.                           11450000
114600         10  WS-PRPK-PACK-ID          PIC 9(12) VALUE 0.          11460000
114700         10  WS-PRPK-COMP-UPC         PIC 9(17) VALUE 0.          11470000
114800         10  WS-PRPK-RATIO            PIC S9(7) VALUE 0.          11480000
114900         10  WS-PRPK-MATCH            PIC X(1)  VALUE SPACES.     11490000
115000 01  WS-PUBLISH-TABLE.                                            11500000
115100     05  WS-PUB-TBL OCCURS 10000 TIMES.                           11510000
115200         10  WS-PUB-SKU               PIC 9(8).                   11520000
115300*PS 11/07/2014 CHANGE STARTS                                      11530000
115400         10  WS-PUB-PO                PIC 9(8).                   11540000
115500*PS 11/07/2014 CHANGE ENDS                                        11550000
115600 01  WS-PUBLISH-TABLE-2.                                          11560000
115700     05  WS-PUB-TBL OCCURS 10000 TIMES.                           11570000
115800*PS 11/07/2014 CHANGE STARTS                                      11580000
115900         10  WS-PUB-PO-2              PIC 9(8).                   11590000
116000*PS 11/07/2014 CHANGE ENDS                                        11600000
116100 01  WS-TRANSFER.                                                 11610000
116200     05  WS-TABLE-PUB.                                            11620000
116300         10  WS-PUBLISH OCCURS 10000 TIMES.                       11630000
116400             15  WS-TRAN-SKU          PIC 9(8).                   11640000
116500*PS 11/07/2014 CHANGE STARTS                                      11650000
116600             15  WS-TRAN-PO           PIC 9(8).                   11660000
116700*PS 11/07/2014 CHANGE ENDS                                        11670000
116800     05  WS-ASNORD-PO-NBR             PIC X(22).                  11680000
116900     05  WS-ASNDTL-UPC-NBR            PIC S9(17) COMP-3.          11690000
117000 01  WS-PACK-INVALID-TABLE.                                       11700000
117100     05  WS-PACK-TBL OCCURS 10000 TIMES.                          11710000
117200         10  WS-PACK-PACK-UPC         PIC 9(17) VALUE 0.          11720000
117300         10  WS-PACK-COMP-UPC         PIC 9(17) VALUE 0.          11730000
117400 01  WS-COMP-INVALID-TABLE.                                       11740000
117500     05  WS-COMP-TBL OCCURS 10000 TIMES.                          11750000
117600*PS 11/07/2014 CHANGE STARTS                                      11760000
117700         10  WS-COMP-PO-UPC           PIC 9(8) VALUE 0.           11770000
117800*PS 11/07/2014 CHANGE ENDS                                        11780000
117900         10  WS-COMP-COMP-UPC         PIC 9(17) VALUE 0.          11790000
118000 01  WS-CARTON-DETAIL-TABLE.                                      11800000
118100     05  WS-CAR-DTL-TBL OCCURS 500 TIMES.                         11810000
118200         10  WS-CAR-DTL-HDR-ID        PIC S9(9)  COMP.            11820000
118300         10  WS-CAR-DTL-DTL           PIC S9(7)V COMP-3.          11830000
118400         10  WS-CAR-DTL-CAR           PIC X(45).                  11840000
118500         10  WS-CAR-DTL-UPC           PIC S9(17)V COMP-3.         11850000
118600         10  WS-CAR-DTL-QTY           PIC S9(7)V COMP-3.          11860000
118700 01  WS-ITEM-DTL-SW.                                              11870000
118800     05  ITEM-DETAIL-DUP              PIC X  VALUE 'N'.           11880000
118900         88  DUPLICATE-DETAIL                VALUE 'Y'.           11890000
119000         88  NOT-DUP-DETAIL                  VALUE 'N'.           11900000
119100 01  WS-VARIABLES.                                                11910000
119200     05  WS-DTL-COUNT                 PIC 9(5)  VALUE 0.          11920000
119300     05  WS-DTL-SUB                   PIC 9(5)  VALUE 0.          11930000
119400     05  WS-SUB1                      PIC 9(5)  VALUE 0.          11940000
119500     05  WS-SUB2                      PIC 9(5)  VALUE 0.          11950000
119600     05  WS-SUB3                      PIC 9(5)  VALUE 0.          11960000
119700     05  WS-SUB4                      PIC 9(5)  VALUE 0.          11970000
119800     05  WS-SUB5                      PIC 9(5)  VALUE 0.          11980000
119900     05  WS-SUB6                      PIC 9(5)  VALUE 0.          11990000
120000     05  WS-CURR-PACK                 PIC 9(7)  VALUE 0.          12000000
120100     05  WS-CURR-ELEMENT              PIC 9(7)  VALUE 0.          12010000
120200     05  WS-CURR-UPC-TYPE             PIC X(1)  VALUE SPACES.     12020000
120300     05  WS-OTHER-UPC-TYPE            PIC X(1)  VALUE SPACES.     12030000
120400     05  WS-COMPONENTS                PIC 9(5)  VALUE 0.          12040000
120500     05  WS-PACK-COMPONENTS           PIC 9(5)  VALUE 0.          12050000
120600     05  WS-SHIPT-QTY                 PIC 9(5)  VALUE 0.          12060000
120700*PS 11/07/2014 CHANGE STARTS                                      12070000
120800     05  WS-HOLD-PO                   PIC 9(8)  VALUE 0.          12080000
120900*PS 11/07/2014 CHANGE ENDS                                        12090000
121000     05  WS-CARTON-COUNT              PIC S9(4) COMP VALUE 0.     12100000
121100     05  WS-SNKUP001                  PIC X(8)  VALUE 'SNKUP001'. 12110000
121200     05  WS-PUBLISH-MESSAGE.                                      12120000
121300         10  FILLER                   PIC X(9)  VALUE 'SNKUP001 '.12130000
121400         10  WS-PUBLISH-PO            PIC 9(8)  VALUE 0.          12140000
121500         10  FILLER                   PIC X(14) VALUE             12150000
121600             'ASNPCK        '.                                    12160000
121700         10  WS-PUBLISH-LABEL         PIC X(20) VALUE SPACES.     12170000
121800         10  WS-PUBLISH-SKU           PIC 9(8)  VALUE 0.          12180000
121900 01  PC-PROGRAM-CONSTANTS.                                        12190000
122000     05  PC-CURRENT-PROGRAM-NAME    PIC X(08)  VALUE 'SNKUP001'.  12200000
122100     05  PC-ASNPCK                  PIC X(06)  VALUE 'ASNPCK'.    12210000
122200     05  PC-SODTL                   PIC X(06)  VALUE 'SODTL '.    12220000
122300     05  PC-READY                   PIC X(06)  VALUE 'READY '.    12230000
122400     05  PC-N                       PIC X(01)  VALUE 'N'.         12240000
122500     05  PC-DEFAULT-TMST            PIC X(26)  VALUE              12250000
122600         '0001-01-01-00.00.00.000000'.                            12260000
122700     05  PV-VERSION-CNTL-NBR        PIC S9(02)V9(02) COMP-3.      12270000
122800     05  PV-HOLD-LOCATION           PIC S9(04) VALUE +0 COMP.     12280000
122900     05  PV-REC-SEQ-NBR             PIC S9(09) VALUE +0 COMP.     12290000
123000     05  HOLD-PACK-UPC-NBR          PIC 9(17) VALUE 0.            12300000
123100     05  HOLD-COMP-UPC-NBR          PIC 9(17) VALUE 0.            12310000
123200*PS 11/07/2014 CHANGE STARTS                                      12320000
123300     05  HOLD-COMP-PO-NBR           PIC 9(8) VALUE 0.             12330000
123400*PS 11/07/2014 CHANGE ENDS                                        12340000
123500                                                                  12350000
123600 01  WS-SWITCHES.                                                 12360000
123700     05  WS-COMPONENT-SW              PIC X     VALUE 'N'.        12370000
123800         88  COMPONENT-SENT                     VALUE 'Y'.        12380000
123900         88  NO-COMPONENT-SENT                  VALUE 'N'.        12390000
124000     05  WS-ID-SW                     PIC X     VALUE 'N'.        12400000
124100         88  PACK-ID-FOUND                      VALUE 'Y'.        12410000
124200         88  PACK-ID-NOT-FOUND                  VALUE 'N'.        12420000
124300     05  WS-END-OF-TBL-SW             PIC X     VALUE 'N'.        12430000
124400         88  END-OF-TBL                         VALUE 'Y'.        12440000
124500         88  NOT-END-OF-TBL                     VALUE 'N'.        12450000
124600     05  WS-PRPK-SW                   PIC X     VALUE 'N'.        12460000
124700         88  PREPACK-PO                         VALUE 'Y'.        12470000
124800         88  NOT-PREPACK-PO                     VALUE 'N'.        12480000
124900     05  WS-COMP-SW                   PIC X     VALUE 'N'.        12490000
125000         88  PACK-PACK-FOUND                    VALUE 'Y'.        12500000
125100         88  PACK-PACK-NOT-FOUND                VALUE 'N'.        12510000
125200     05  WS-COMP-SW                   PIC X     VALUE 'N'.        12520000
125300         88  PO-COMP-FOUND                      VALUE 'Y'.        12530000
125400         88  PO-COMP-NOT-FOUND                  VALUE 'N'.        12540000
125500     05  WS-SINGLE-SW                 PIC X     VALUE 'N'.        12550000
125600         88  SINGLE-COMP-UPC                    VALUE 'Y'.        12560000
125700         88  NOT-SINGLE-COMP-UPC                VALUE 'N'.        12570000
125800     05  WS-MULT-SW                   PIC X     VALUE 'N'.        12580000
125900         88  MULT-COMP-UPC                      VALUE 'Y'.        12590000
126000         88  NOT-MULT-COMP-UPC                  VALUE 'N'.        12600000
126100     05  WS-GOOD-SW                   PIC X     VALUE 'N'.        12610000
126200         88  GOOD-COMP-UPC                      VALUE 'Y'.        12620000
126300         88  NOT-GOOD-COMP-UPC                  VALUE 'N'.        12630000
126400     05  WS-COMP-SW                   PIC X     VALUE 'N'.        12640000
126500         88  COMP-UPC                           VALUE 'Y'.        12650000
126600         88  NOT-COMP-UPC                       VALUE 'N'.        12660000
126700     05  WS-PACK-SW                   PIC X     VALUE 'N'.        12670000
126800         88  PACK-UPC                           VALUE 'Y'.        12680000
126900         88  NOT-PACK-UPC                       VALUE 'N'.        12690000
127000     05  WS-PACK-FOUND-SW             PIC X     VALUE 'N'.        12700000
127100         88  PACK-FOUND                         VALUE 'Y'.        12710000
127200         88  PACK-NOT-FOUND                     VALUE 'N'.        12720000
127300     05  WS-COMPONENT-SW              PIC X     VALUE 'N'.        12730000
127400         88  BAD-COMPONENT                      VALUE 'Y'.        12740000
127500         88  NOT-BAD-COMPONENT                  VALUE 'N'.        12750000
127600     05  WS-GOOD-SW                   PIC X     VALUE 'N'.        12760000
127700         88  PACK-UPC-GOOD                      VALUE 'Y'.        12770000
127800         88  PACK-UPC-NOT-GOOD                  VALUE 'N'.        12780000
127900     05  WS-PACK-COMP-SW              PIC X     VALUE 'N'.        12790000
128000         88  END-OF-PACK-COMP                   VALUE 'Y'.        12800000
128100         88  NOT-END-OF-PACK-COMP               VALUE 'N'.        12810000
128200     05  WS-END1-SW                   PIC X     VALUE 'N'.        12820000
128300         88  END-OF-COMP                        VALUE 'Y'.        12830000
128400         88  NOT-END-OF-COMP                    VALUE 'N'.        12840000
128500     05  WS-END-SW                    PIC X     VALUE 'N'.        12850000
128600         88  END-OF-PACK                        VALUE 'Y'.        12860000
128700         88  NOT-END-OF-PACK                    VALUE 'N'.        12870000
128800     05  WS-END-COMP-SW               PIC X     VALUE 'N'.        12880000
128900         88  END-OF-COMPONENTS                  VALUE 'Y'.        12890000
129000         88  NOT-END-OF-COMPONENTS              VALUE 'N'.        12900000
129100     05  WS-SKU-ITM-SW                PIC X     VALUE 'N'.        12910000
129200         88  SKU-ITM-FOUND                      VALUE 'Y'.        12920000
129300         88  SKU-ITM-NOT-FOUND                  VALUE 'N'.        12930000
129400     05  WS-COMP-FOUND-SW             PIC X     VALUE 'N'.        12940000
129500         88  COMP-FOUND                         VALUE 'Y'.        12950000
129600         88  NOT-COMP-FOUND                     VALUE 'N'.        12960000
129700     05  WS-MISMATCH-SW               PIC X     VALUE 'N'.        12970000
129800         88  COMPONENT-MISMATCH                 VALUE 'Y'.        12980000
129900         88  NOT-COMPONENT-MISMATCH             VALUE 'N'.        12990000
130000                                                                  13000000
130100/                                                                 13010000
130200 01  LOG-MESSAGE-1.                                               13020000
130300     05  FILLER                     PIC X(4)   VALUE 'PACK'.      13030000
130400     05  FILLER                     PIC X(1)   VALUE SPACES.      13040000
130500*PS 11/07/2014 CHANGE STARTS                                      13050000
130600     05  LOG-PO                     PIC 9(8)   VALUE 0.           13060000
130700*PS 11/07/2014 CHANGE ENDS                                        13070000
130800     05  FILLER                     PIC X(1)   VALUE SPACES.      13080000
130900     05  LOG-PACK-ID                PIC 9(7)   VALUE 0.           13090000
131000     05  FILLER                     PIC X(1)   VALUE SPACES.      13100000
131100     05  LOG-SUB                    PIC 9(5)   VALUE 0.           13110000
131200     05  FILLER                     PIC X(1)   VALUE SPACES.      13120000
131300     05  LOG-TYPE                   PIC X(1)   VALUE SPACES.      13130000
131400 01  LOG-MESSAGE-2.                                               13140000
131500     05  FILLER                     PIC X(4)   VALUE 'COMP'.      13150000
131600     05  FILLER                     PIC X(1)   VALUE SPACES.      13160000
131700     05  LOG-COMP-UPC               PIC 9(17)  VALUE 0.           13170000
131800     05  FILLER                     PIC X(1)   VALUE SPACES.      13180000
131900     05  LOG-COMP-RATIO             PIC 9(7)   VALUE 0.           13190000
132000 01  LOG-MESSAGE-3.                                               13200000
132100     05  FILLER                     PIC X(4)   VALUE 'CART'.      13210000
132200     05  FILLER                     PIC X(1)   VALUE SPACES.      13220000
132300     05  LOG-CARTON                 PIC X(20)  VALUE SPACES.      13230000
132400 01  LOG-MESSAGE-4.                                               13240000
132500     05  FILLER                     PIC X(4)   VALUE 'LOCK'.      13250000
132600     05  FILLER                     PIC X(1)   VALUE SPACES.      13260000
132700     05  LOG-LOCK-SKU               PIC 9(8)   VALUE 0.           13270000
132800*CHG107105 - START                                                13280000
132900 01  LOG-MESSAGE-5.                                               13290000
133000     05  FILLER                     PIC X(12)  VALUE              13300000
133100         'ASNHDR NBR: '.                                          13310000
133200     05  LOG-ASNHDR-NBR             PIC X(30)  VALUE SPACES.      13320000
133300     05  FILLER                     PIC X(3)   VALUE ' - '.       13330000
133400     05  FILLER                     PIC X(38)  VALUE              13340000
133500         'TWO TD1 SEGMENTS PRESENT IN THE ASN - '.                13350000
133600     05  FILLER                     PIC X(20)  VALUE              13360000
133700         'ASN NOT PROCESSED - '.                                  13370000
133800     05  FILLER                     PIC X(22)  VALUE              13380000
133900         'PLEASE CONTACT VENDOR.'.                                13390000
133910     05  FILLER                     PIC X(5)   VALUE SPACES.      13391000
133920*CHG107105 - END                                                  13392000
133930/                                                                 13393000
133940 01  ABEND-CODE                       PIC S9(04)     VALUE +0     13394000
133950                                                     COMP SYNC.   13395000
133960     88  ABEND-4001-WRITE-ERROR                      VALUE +4001. 13396000
133970     88  ABEND-4002-READ-ERROR                       VALUE +4002. 13397000
133980     88  ABEND-4003-CTRL-CARD-ERROR                  VALUE +4003. 13398000
133990     88  ABEND-4004-TABLE-ERROR                      VALUE +4004. 13399000
134000     88  ABEND-4005-OPEN-ERROR                       VALUE +4005. 13400000
134100     88  ABEND-4006-CLOSE-ERROR                      VALUE +4006. 13410000
134200     88  ABEND-4007-SEQUENCE-ERROR                   VALUE +4007. 13420000
134300     88  ABEND-4008-DATS-ERROR                       VALUE +4008. 13430000
134400     88  ABEND-4009-KEY-DATS-ERROR                   VALUE +4009. 13440000
134500     88  ABEND-4013-DB2-ERROR                        VALUE +4013. 13450000
134600/                                                                 13460000
134700*                                                                 13470000
134800*  NUMERIC EDIT LAYOUT                                            13480000
134900*                                                                 13490000
135000     COPY DPWS010I.                                               13500000
135100/                                                                 13510000
135200*  ADV-SHIP-NOTICE MASTER RECORD LAYOUT                           13520000
135300*                                                                 13530000
135400     COPY SNRD001I.                                               13540000
135500/                                                                 13550000
135600* DMH 03/07/16 BEGIN (ADDED FOR OUTLET CARRIER TRACKING)          13560000
135700*  CARRIER CARTON TRACKING RECORD LAYOUT                          13570000
135800*                                                                 13580000
135900     COPY RCRD093.                                                13590000
136000* DMH 03/07/16 END   (ADDED FOR OUTLET CARRIER TRACKING)          13600000
136100/                                                                 13610000
136200*  WORK AREA PASSED IN CALL TO DPKUT105                           13620000
136210*                                                                 13621000
136220*    COPY DPWS105.                                                13622000
136230*                                                                 13623000
136240*  WORK AREA PASSED IN CALL TO DPKUT500                           13624000
136250*                                                                 13625000
136260     COPY DPWS500.                                                13626000
136270/                                                                 13627000
136280*  VE ADVANCE SHIP NOTICE TABLE LAYOUT                            13628000
136290*                                                                 13629000
136300     EXEC SQL                                                     13630000
136400         INCLUDE TASNHDR                                          13640000
136500     END-EXEC.                                                    13650000
136600/                                                                 13660000
136700*  VE ASN PACKING DETAILS TABLE LAYOUT                            13670000
136800*                                                                 13680000
136900     EXEC SQL                                                     13690000
137000         INCLUDE TASNPKG                                          13700000
137100     END-EXEC.                                                    13710000
137200/                                                                 13720000
137300*  VE ASN NAME AND ADDRESS DTL TABLE LAYOUT                       13730000
137400*                                                                 13740000
137500     EXEC SQL                                                     13750000
137600         INCLUDE TASHADR                                          13760000
137700     END-EXEC.                                                    13770000
137800/                                                                 13780000
137900*  VE ASN ADDITIONAL NAME TEXT TABLE LAYOUT                       13790000
138000*                                                                 13800000
138100     EXEC SQL                                                     13810000
138200         INCLUDE TASHANM                                          13820000
138300     END-EXEC.                                                    13830000
138400/                                                                 13840000
138500*  VE ASN ADDITIONAL ADDRESS TEXT TABLE LAYOUT                    13850000
138600*                                                                 13860000
138700     EXEC SQL                                                     13870000
138800         INCLUDE TASHADT                                          13880000
138900     END-EXEC.                                                    13890000
139000/                                                                 13900000
139100*  VE ASN SHIPPED ORDER TABLE LAYOUT                              13910000
139200*                                                                 13920000
139300     EXEC SQL                                                     13930000
139400         INCLUDE TASNORD                                          13940000
139500     END-EXEC.                                                    13950000
139600/                                                                 13960000
139700*  VE ASN ORDER NAME AND ADDR DTL TABLE LAYOUT                    13970000
139800*                                                                 13980000
139900     EXEC SQL                                                     13990000
140000         INCLUDE TASOADR                                          14000000
140100     END-EXEC.                                                    14010000
140200/                                                                 14020000
140300*  VE ASN ORDER ADDITIONAL NAME TABLE LAYOUT                      14030000
140400*                                                                 14040000
140500     EXEC SQL                                                     14050000
140600         INCLUDE TASOANM                                          14060000
140700     END-EXEC.                                                    14070000
140800/                                                                 14080000
140900*  VE ASN ORDER ADDITIONAL ADDR TABLE LAYOUT                      14090000
141000*                                                                 14100000
141100     EXEC SQL                                                     14110000
141200         INCLUDE TASOADT                                          14120000
141300     END-EXEC.                                                    14130000
141400/                                                                 14140000
141500*  VE ASN CARTON TABLE LAYOUT                                     14150000
141600*                                                                 14160000
141700     EXEC SQL                                                     14170000
141800         INCLUDE TASNCAR                                          14180000
141900     END-EXEC.                                                    14190000
142000/                                                                 14200000
142100*  VE ASN ITEM TABLE LAYOUT                                       14210000
142200*                                                                 14220000
142300     EXEC SQL                                                     14230000
142400         INCLUDE TASNDTL                                          14240000
142500     END-EXEC.                                                    14250000
142600/                                                                 14260000
142700*  VE ASN CARTON:ITEM XREF TABLE LAYOUT                           14270000
142800*                                                                 14280000
142900     EXEC SQL                                                     14290000
143000         INCLUDE TASCRIT                                          14300000
143100     END-EXEC.                                                    14310000
143200/                                                                 14320000
143300*  PURCHASE ORDER HEADER  TABLE                                   14330000
143400*                                                                 14340000
143500     EXEC SQL                                                     14350000
143600         INCLUDE TPURCHS                                          14360000
143700     END-EXEC.                                                    14370000
143800/                                                                 14380000
143900*  EXTERNAL ENTITY  TABLE                                         14390000
144000*                                                                 14400000
144100     EXEC SQL                                                     14410000
144200         INCLUDE TEXTENT                                          14420000
144300     END-EXEC.                                                    14430000
144400     EXEC SQL                                                     14440000
144500         INCLUDE TPOPRPK                                          14450000
144600     END-EXEC.                                                    14460000
144700     EXEC SQL                                                     14470000
144800         INCLUDE TPURITM                                          14480000
144900     END-EXEC.                                                    14490000
145000     EXEC SQL                                                     14500000
145100         INCLUDE XLT00003                                         14510000
145200     END-EXEC.                                                    14520000
145300     EXEC SQL                                                     14530000
145400         INCLUDE WFT00001                                         14540000
145500     END-EXEC.                                                    14550000
145600     EXEC SQL                                                     14560000
145700         INCLUDE WFT00002                                         14570000
145800     END-EXEC.                                                    14580000
145900     EXEC SQL                                                     14590000
146000         INCLUDE XLT00001                                         14600000
146100     END-EXEC.                                                    14610000
146200     EXEC SQL                                                     14620000
146300         INCLUDE XLT00006                                         14630000
146400     END-EXEC.                                                    14640000
146500     EXEC SQL                                                     14650000
146600         INCLUDE XLT00009                                         14660000
146700     END-EXEC.                                                    14670000
146800/                                                                 14680000
146900*  ENTITY  TABLE                                                  14690000
147000*                                                                 14700000
147100     EXEC SQL                                                     14710000
147200         INCLUDE TENTNME                                          14720000
147300     END-EXEC.                                                    14730000
147400/                                                                 14740000
147500***************************************************************** 14750000
147600*    DB2 AREA FOR THE SYSIBM SYSDUMMY TABLE                     * 14760000
147700***************************************************************** 14770000
147800     EXEC SQL                                                     14780000
147900          INCLUDE SYSDUMMY                                        14790000
148000     END-EXEC.                                                    14800000
148100                                                                  14810000
148101***************************************************************** 14810105
148102*    WST_INTGRTN_TYP TABLE                                        14810205
148103***************************************************************** 14810305
148104     EXEC SQL                                                     14810405
148105          INCLUDE WST00008                                        14810505
148106     END-EXEC.                                                    14810605
148107                                                                  14810705
148108***************************************************************** 14810805
148109*    WST_ATTR_ELEM TABLE                                          14810905
148110***************************************************************** 14811005
148111     EXEC SQL                                                     14811105
148112          INCLUDE WST00009                                        14811205
148113     END-EXEC.                                                    14811305
148114                                                                  14811405
148115***************************************************************** 14811505
148116*    WST_ATTR_DEFN TABLE                                          14811605
148117***************************************************************** 14811705
148118     EXEC SQL                                                     14811805
148119          INCLUDE WST00010                                        14811905
148120     END-EXEC.                                                    14812005
148121                                                                  14812105
148130                                                                  14813005
148200* DB2 COMMUNICATION AREA.                                         14820000
148300*                                                                 14830000
148400     EXEC SQL                                                     14840000
148500         INCLUDE SQLCA                                            14850000
148600     END-EXEC.                                                    14860000
148700/                                                                 14870000
148800* DB2 COMMUNICATION AREA 2                                        14880000
148900*                                                                 14890000
149000     COPY SQLCA2.                                                 14900000
149100/                                                                 14910000
149200*    EXEC SQL                                                     14920000
149300*       DECLARE PACK_CURSOR CURSOR FOR                            14930000
149400*       SELECT B.PO_NBR,                                          14940000
149500*              B.PO_PREPK_ID,                                     14950000
149600*              C.ITM_NBR,                                         14960000
149700*              C.PREPK_RATO_QTY                                   14970000
149800*         FROM XLT_PK_UPC A,                                      14980000
149900*              TPOPRPK B,                                         14990000
150000*              TPURITM C                                          15000000
150100*         WHERE A.UPC_NBR     = :XLT00009-UPC-NBR      AND        15010000
150200*               A.PK_SKU_NBR  = B.PK_SKU_NBR           AND        15020000
150300*               B.PO_NBR      = :POPRPK-PO-NBR         AND        15030000
150400*               B.PO_NBR      = C.PO_NBR               AND        15040000
150500*               B.PO_PREPK_ID = C.PO_PREPK_ID          AND        15050000
150600*               C.VER_STATUS_CDE   = 'A'                          15060000
150700*    END-EXEC.                                                    15070000
150800     EXEC SQL                                                     15080000
150900        DECLARE PACK_CURSOR CURSOR FOR                            15090000
151000        SELECT A.PO_NBR,                                          15100000
151100               A.PO_PREPK_ID,                                     15110000
151200               B.ITM_NBR,                                         15120000
151300               B.PREPK_RATO_QTY                                   15130000
151400          FROM TPOPRPK A,                                         15140000
151500               TPURITM B                                          15150000
151600          WHERE A.PREPK_UPC_NBR   = :POPRPK-PREPK-UPC-NBR  AND    15160000
151700                A.PO_NBR          = :POPRPK-PO-NBR         AND    15170000
151800                A.PO_NBR          = B.PO_NBR               AND    15180000
151900                A.PO_PREPK_ID     = B.PO_PREPK_ID          AND    15190000
152000                B.VER_STATUS_CDE   = 'A'                          15200000
152100     END-EXEC.                                                    15210000
152200     EXEC SQL                                                     15220000
152300        DECLARE COMP_CURSOR CURSOR FOR                            15230000
152400        SELECT B.UPC_NBR                                          15240000
152500          FROM XLT_SKU A,                                         15250000
152600               XLT_UPC B                                          15260000
152700          WHERE A.ITM_NBR     = :PURITM-ITM-NBR  AND              15270000
152800                A.INTR_UPC_ID = B.INTR_UPC_ID AND                 15280000
152900                B.UPC_TYP_CDE = :WS-CURR-UPC-TYPE                 15290000
153000     END-EXEC.                                                    15300000
153100 PROCEDURE DIVISION.                                              15310000
153200                                                                  15320000
153300 0000-MAINLINE.                                                   15330000
153310                                                                  15331003
153320     DISPLAY 'EXECUTING VERSION OF SNKUP001 PROGRAM THAT '        15332003
153330             'WAS CHANGED IN DECEMBER OF 2022'.                   15333007
153340                                                                  15334003
153400     MOVE '0000-MAINLINE                  '                       15340000
153500                                 TO PW-CURRENT-PARA.              15350000
153600*    DISPLAY '0000-MAINLINE'.                                     15360000
153700                                                                  15370000
153800     PERFORM A000-PRE-PROCESSING.                                 15380000
153900     PERFORM B000-PROCESS-ASN-RECORDS                             15390000
154000       UNTIL END-OF-INP01.                                        15400000
154100     PERFORM T000-PROCESS-TOTAL-LINES.                            15410000
154200     CLOSE ADV-SHIP-NOTICE-FILE                                   15420000
154300           ADV-SHIP-NOTICE-REPORT                                 15430000
154400           ASN-ERROR-LOG                                          15440000
154500           ASN-CARR-TRACKING.                                     15450000
154510                                                                  15451005
154520     MOVE PV-INPUT-READ-COUNT TO PV-DISPLAY-REC-NBR.              15452005
154530     DISPLAY ' '.                                                 15453005
154540     DISPLAY 'INPUT READ COUNT IS........................: '      15454005
154550             PV-DISPLAY-REC-NBR.                                  15455005
154560     MOVE PV-ASN-ERROR-LOG-COUNT TO PV-DISPLAY-REC-NBR.           15456005
154570     DISPLAY 'ASN ERROR LOG FILE OUT01 WRITE COUNT IS....: '      15457005
154580             PV-DISPLAY-REC-NBR.                                  15458005
154590     MOVE PV-ASN-CARR-TRACK-COUNT TO PV-DISPLAY-REC-NBR.          15459005
154591     DISPLAY 'ASN CARRIER TRACK FILE OUT02 WRITE COUNT IS: '      15459105
154592             PV-DISPLAY-REC-NBR.                                  15459205
154593                                                                  15459305
154600     STOP RUN.                                                    15460000
154700/                                                                 15470000
154800****************************************************************  15480000
154900*     PRE PROCESSING                                           *  15490000
155000*                                                              *  15500000
155100*   - OPEN FILES                                               *  15510000
155200*   - ACCEPT CURRENT DATE                                      *  15520000
155300*   - ACCEPT CURRENT TIME                                      *  15530000
155400*   - READ THE FIRST ADV-SHIP-NOTICE REC                       *  15540000
155500*   - CREATE HEADING LINES                                     *  15550000
155600****************************************************************  15560000
155700 A000-PRE-PROCESSING.                                             15570000
155800     MOVE 'A000-PRE-PROCESSING            '                       15580000
155900                                 TO PW-CURRENT-PARA.              15590000
156000*    DISPLAY 'A000-PRE-PROCESSING'.                               15600000
156100                                                                  15610000
156200     OPEN INPUT  ADV-SHIP-NOTICE-FILE                             15620000
156300          OUTPUT ADV-SHIP-NOTICE-REPORT                           15630000
156400                 ASN-ERROR-LOG                                    15640000
156500                 ASN-CARR-TRACKING.                               15650000
156600                                                                  15660000
156700     PERFORM A100-ACCEPT-CURR-DATE-TIME.                          15670000
156800                                                                  15680000
156900*  ** 08/XX132 **  CHANGE                                         15690000
157000     ACCEPT CC-CONTROL-CARD.                                      15700000
157100     DISPLAY 'CONTROL CARD ' CC-CONTROL-CARD.                     15710000
157200     IF NOT CC-PARM-VALID                                         15720000
157300         DISPLAY '** ABEND ** IN PROGRAM SNKUP001'                15730000
157400         DISPLAY 'SNKUP001 - CONTROL-CARD ERROR = '               15740000
157500                  CC-CONTROL-CARD                                 15750000
157600         MOVE 4003 TO ABEND-CODE                                  15760000
157700         CALL 'ILBOABN0' USING ABEND-CODE                         15770000
157800     END-IF.                                                      15780000
157900*  ** 08/13/92 **  CHANGE END                                     15790000
158000                                                                  15800000
158100     PERFORM Z000-READ-ADV-SHIP-NOTICE                            15810000
158200                                                                  15820000
158300     IF END-OF-INP01                                              15830000
158400         DISPLAY '** ABEND **'                                    15840000
158500         DISPLAY '** PROGRAM    = SNKUP001'                       15850000
158600         DISPLAY '** PARAGRAPH  = A000-PRE-PROCESSING'            15860000
158700         DISPLAY '** EOF ENCOUNTERED WHEN READING **'             15870000
158800         DISPLAY '** ADVANCE SHIPMENT NOTICE FILE **'             15880000
158900         SET ABEND-4008-DATS-ERROR                                15890000
159000                                 TO TRUE                          15900000
159100         CALL 'ILBOABN0' USING ABEND-CODE                         15910000
159200     END-IF.                                                      15920000
159300                                                                  15930000
159400     IF NOT ID-IDENTIFICATION-REC                                 15940000
159500         DISPLAY '** ABEND **'                                    15950000
159600         DISPLAY '** PROGRAM    = SNKUP001'                       15960000
159700         DISPLAY '** PARAGRAPH  = A000-PRE-PROCESSING'            15970000
159800         DISPLAY '** INVALID RECORD SEQUENCING    **'             15980000
159900         DISPLAY '** ADVANCE SHIPMENT NOTICE FILE **'             15990000
160000         SET ABEND-4007-SEQUENCE-ERROR                            16000000
160100                                 TO TRUE                          16010000
160200         CALL 'ILBOABN0' USING ABEND-CODE                         16020000
160300     END-IF.                                                      16030000
160400/                                                                 16040000
160500***************************************************************** 16050000
160600*     ACCEPT-CURR-DATE-TIME                                     * 16060000
160700*                                                               * 16070000
160800***************************************************************** 16080000
160900 A100-ACCEPT-CURR-DATE-TIME.                                      16090000
161000     MOVE 'A100-ACCEPT-CURR-DATE-TIME     '                       16100000
161100                                 TO PW-CURRENT-PARA.              16110000
161200*    DISPLAY 'A100-ACCEPT-CURR-DATE-TIME'.                        16120000
161300                                                                  16130000
161400     ACCEPT CT-CPU-TIME FROM TIME.                                16140000
161500     MOVE CT-CPU-TIME-HH         TO DP132O-RUN-HOUR.              16150000
161600     MOVE CT-CPU-TIME-MM         TO DP132O-RUN-MINUTE.            16160000
161700                                                                  16170000
161800     ACCEPT CD-CPU-DATE FROM DATE.                                16180000
161900     MOVE CD-CPU-DATE-MM         TO DP132O-RUN-MONTH.             16190000
162000     MOVE CD-CPU-DATE-DD         TO DP132O-RUN-DAY.               16200000
162100     MOVE CD-CPU-DATE-YY         TO DP132O-RUN-YEAR.              16210000
162200                                                                  16220000
162300                                                                  16230000
162400* DMH 03/07/16 BEGIN                                              16240000
162500     EXEC SQL                                                     16250000
162600          SELECT CURRENT TIMESTAMP                                16260000
162700            INTO :PV-PROCESS-TMST                                 16270000
162800            FROM SYSIBM.SYSDUMMY1                                 16280000
162900            WITH UR                                               16290000
162910     END-EXEC.                                                    16291000
162920* DMH 03/07/16 END                                                16292000
162921                                                                  16292100
162922/                                                                 16292200
162923***************************************************************** 16292300
162924*     ACCEPT-CURR-TIME  FOR ASN HEADER ID NUMBER                * 16292400
162925*                                                               * 16292500
162926***************************************************************** 16292600
162927 A150-GENERATE-ASNHDR-ID.                                         16292700
162928     MOVE 'A150-GENERATE-ASNHDR-ID   '                            16292800
162929                                 TO PW-CURRENT-PARA.              16292900
162930*    DISPLAY 'A150-GENERATE-ASNHDR-ID'.                           16293000
162940                                                                  16294000
162950     INITIALIZE DP902-RANDNBR-ROUTINE-FIELDS.                     16295000
162960                                                                  16296000
162970     CALL PC-RAND-PGM USING DP902-RANDNBR-ROUTINE-FIELDS.         16297000
162980                                                                  16298000
162990     IF DP902-SUCCESSFUL                                          16299000
163000        MOVE DP902-RANDOM-NUMBER TO PV-ASNHDR-ID                  16300000
163100     ELSE                                                         16310000
163200        DISPLAY '****** RANDOM NUMBER ERROR ***'                  16320000
163300        DISPLAY '*                             '                  16330000
163400        DISPLAY '* PROBLEM WHEN CALLING RANDOM NBR'               16340000
163500        DISPLAY '* ROUTINE TO GENERATE ASNHDR-ID'                 16350000
163600        DISPLAY '* (DPKUT902) BATCH/CICS CALLED MOD'              16360000
163700        DISPLAY '*                             '                  16370000
163800        DISPLAY '* DP902-RETURN-CODE = ' DP902-RETURN-CODE        16380000
163900        DISPLAY '******************************'                  16390000
164000        MOVE +4013 TO ABEND-CODE                                  16400000
164100        CALL 'ILBOABN0' USING ABEND-CODE                          16410000
164200     END-IF.                                                      16420000
164300                                                                  16430000
164400     DISPLAY 'ASNHDR-ID = ' PV-ASNHDR-ID '  '                     16440000
164500             'EDI-VEND = ' PW-HOLD-EDI-VEND-ID '  '               16450000
164600             'ASNHDR-NBR = ' PW-ASNHDR-NBR.                       16460000
164700                                                                  16470000
164800     PERFORM U000-UPDATE-ASNHDR.                                  16480000
164900                                                                  16490000
165000     IF SQLCODE = PC-NEG-803                                      16500000
165100        INITIALIZE  PW-RETRY-CNT                                  16510000
165200        PERFORM UNTIL SQLCODE = ZERO OR                           16520000
165300                                PW-RETRY-CNT > PC-MAX-ASN-RETRY   16530000
165400           DISPLAY 'DUPLICATE ASNHDR-ID CREATED'                  16540000
165500           DISPLAY 'TRYING AGAIN ... WAITING'                     16550000
165600                                                                  16560000
165700****  WAIT 1/3 SEC BETWEEN TRIES. DELAY IN MILLISECONDS.          16570000
165800           CALL 'SYSWAIT' USING PC-DELAY-INTERVAL                 16580000
165900                                                                  16590000
166000           INITIALIZE DP902-RANDNBR-ROUTINE-FIELDS                16600000
166100                                                                  16610000
166200           CALL PC-RAND-PGM USING DP902-RANDNBR-ROUTINE-FIELDS    16620000
166300                                                                  16630000
166400           IF DP902-SUCCESSFUL                                    16640000
166500              MOVE DP902-RANDOM-NUMBER TO PV-ASNHDR-ID            16650000
166600              MOVE DP902-RANDOM-NUMBER TO PV-CHECK-RANDOM         16660000
166700           ELSE                                                   16670000
166800              DISPLAY '****** RANDOM NUMBER ERROR ***'            16680000
166900              DISPLAY '*                             '            16690000
167000              DISPLAY '* PROBLEM WHEN CALLING RANDOM NBR'         16700000
167100              DISPLAY '* ROUTINE TO GENERATE ASNHDR-ID'           16710000
167200              DISPLAY '* (DPKUT902) BATCH/CICS CALLED MOD'        16720000
167300              DISPLAY '*                             '            16730000
167400              DISPLAY '* DP902-RETURN-CODE = ' DP902-RETURN-CODE  16740000
167500              DISPLAY '******************************'            16750000
167600              MOVE +4013 TO ABEND-CODE                            16760000
167700              CALL 'ILBOABN0' USING ABEND-CODE                    16770000
167800           END-IF                                                 16780000
167900                                                                  16790000
168000           DISPLAY 'ASNHDR-ID => ' PV-ASNHDR-ID                   16800000
168100                                                                  16810000
168200           PERFORM U000-UPDATE-ASNHDR                             16820000
168300                                                                  16830000
168400           ADD 1 TO PW-RETRY-CNT                                  16840000
168500                                                                  16850000
168600        END-PERFORM                                               16860000
168700        IF PW-RETRY-CNT > PC-MAX-ASN-RETRY                        16870000
168800           DISPLAY '**************************************'       16880000
168900           DISPLAY '*   CANNOT CREATE UNIQUE ASNHDR-ID   *'       16890000
169000           DISPLAY '**************************************'       16900000
169100           PERFORM Z900-SQL-ERROR                                 16910000
169200        END-IF                                                    16920000
169300        MOVE PW-RETRY-CNT TO PW-RETRY-CNT-9                       16930000
169400        DISPLAY 'RETRY-COUNTER = ' PW-RETRY-CNT-9                 16940000
169500     END-IF.                                                      16950000
169600                                                                  16960000
169700*                                                                 16970000
169800/                                                                 16980000
169900***************************************************************** 16990000
170000*     PROCESS ASN RECORDS                                       * 17000000
170100*                                                               * 17010000
170200*     CONTROL THE PROCESSING OF THE ADVANCE SHIPPING NOTICE     * 17020000
170300*     RECORDS. THIS PROCESS WILL FORMAT AND INSERT THE ADVANCED * 17030000
170400*     SHIP NOTICE RECEIVED FROM A VENDOR INTO THE ADVANCED SHIP * 17040000
170500*     NOTICE DB2 TABLES.                                        * 17050000
170600*                                                               * 17060000
170700*     -  READ THE ADVANCE SHIP NOTICE FILE                      * 17070000
170800*     -  IF A SHIPMENT SEGMENT IS FOUND PROCESS THE ISA         * 17080000
170900*     -  IF THE ISA IS COMPLETE, UPDATE THE ASNHDR WITH         * 17090000
171000*        THE CORRECT CART-SHIP-QTY CALCULATED.                  * 17100000
171100***************************************************************** 17110000
171200 B000-PROCESS-ASN-RECORDS.                                        17120000
171300     MOVE 'B000-PROCESS-ASN-RECORDS       '                       17130000
171400                                 TO PW-CURRENT-PARA.              17140000
171500*    DISPLAY 'B000-PROCESS-ASN-RECORDS'.                          17150000
171600                                                                  17160000
171700     PERFORM B100-INITIALIZE.                                     17170000
171800                                                                  17180000
171900     PERFORM Z000-READ-ADV-SHIP-NOTICE.                           17190000
172000                                                                  17200000
172100     IF  END-OF-INP01 OR ID-IDENTIFICATION-REC                    17210000
172200         SET END-OF-ISA          TO TRUE                          17220000
172300     ELSE                                                         17230000
172400         IF  HL-HIERARCHICAL-REC                                  17240000
172500         AND SHIPMENT-LEVEL                                       17250000
172600             CONTINUE                                             17260000
172700         ELSE                                                     17270000
172800             SET END-OF-ISA      TO TRUE                          17280000
172900         END-IF                                                   17290000
173000     END-IF.                                                      17300000
173100                                                                  17310000
173200     PERFORM B200-CREATE-ASN-RECORDS                              17320000
173300       UNTIL (END-OF-INP01                                        17330000
173400          OR  END-OF-ISA                                          17340000
173500          OR  PS-BAD-ASN                                          17350000
173600          OR  DUPLICATE-SHIPMENT).                                17360000
173700                                                                  17370000
173800     IF PS-BAD-ASN                                                17380000
173900         CONTINUE                                                 17390000
174000     ELSE                                                         17400000
174100     IF DUPLICATE-SHIPMENT                                        17410000
174200         MOVE PW-ASNHDR-NBR       TO PSRL-ASNHDR-NBR              17420000
174300         MOVE PW-HOLD-VEND-DUNNS-NBR                              17430000
174400                                  TO PSRL-DUNNS-NBR               17440000
174500         MOVE PW-HOLD-VENDOR-NAME TO PSRL-VENDOR-NAME             17450000
174600         MOVE PW-HOLD-ISA-CNTL-NBR                                17460000
174700                                  TO PSRL-ISA-NBR                 17470000
174800         MOVE PSRL-REPORT-LINE-1  TO PW-ADV-SHIP-NOTICE-LINE      17480000
174900         PERFORM Z510-WRITE-REPORT-LINE                           17490000
175000         MOVE MSG-05              TO PSRL-RPT-LINE-2              17500000
175100         MOVE PSRL-REPORT-LINE-2  TO PW-ADV-SHIP-NOTICE-LINE      17510000
175200         PERFORM Z500-WRITE-REPORT-LINE                           17520000
175300     ELSE                                                         17530000
175400         IF SHIPMENT-COMPLETE                                     17540000
175500             IF ORDER-COMPLETE                                    17550000
175600                 IF ITEM-COMPLETE                                 17560000
175700                     SET ISA-COMPLETE                             17570000
175800                                  TO TRUE                         17580000
175900                 ELSE                                             17590000
176000                     SET END-OF-ISA                               17600000
176100                                  TO TRUE                         17610000
176200                     MOVE PW-ASNHDR-NBR                           17620000
176300                                  TO PSRL-ASNHDR-NBR              17630000
176400                     MOVE PW-HOLD-VEND-DUNNS-NBR                  17640000
176500                                  TO PSRL-DUNNS-NBR               17650000
176600                     MOVE PW-HOLD-VENDOR-NAME                     17660000
176700                                  TO PSRL-VENDOR-NAME             17670000
176800                     MOVE PW-HOLD-ISA-CNTL-NBR                    17680000
176900                                  TO PSRL-ISA-NBR                 17690000
177000                     MOVE PSRL-REPORT-LINE-1                      17700000
177100                                  TO PW-ADV-SHIP-NOTICE-LINE      17710000
177200                     PERFORM Z510-WRITE-REPORT-LINE               17720000
177300                     MOVE PW-ASNORD-PO-NBR                        17730000
177400                                  TO MSG-02-ASNORD-PO-NBR         17740000
177500                     MOVE MSG-02  TO PSRL-RPT-LINE-2              17750000
177600                     MOVE PSRL-REPORT-LINE-2                      17760000
177700                                  TO PW-ADV-SHIP-NOTICE-LINE      17770000
177800                     PERFORM Z500-WRITE-REPORT-LINE               17780000
177900                 END-IF                                           17790000
178000             ELSE                                                 17800000
178100                 MOVE PW-ASNHDR-NBR TO PSRL-ASNHDR-NBR            17810000
178200                 MOVE PW-HOLD-VEND-DUNNS-NBR                      17820000
178300                                    TO PSRL-DUNNS-NBR             17830000
178400                 MOVE PW-HOLD-VENDOR-NAME                         17840000
178500                                    TO PSRL-VENDOR-NAME           17850000
178600                 MOVE PW-HOLD-ISA-CNTL-NBR                        17860000
178700                                    TO PSRL-ISA-NBR               17870000
178800                 MOVE PSRL-REPORT-LINE-1                          17880000
178900                                    TO PW-ADV-SHIP-NOTICE-LINE    17890000
179000                 PERFORM Z510-WRITE-REPORT-LINE                   17900000
179100                 MOVE PW-ASNORD-PO-NBR                            17910000
179200                                    TO MSG-03-ASNORD-PO-NBR       17920000
179300                 MOVE MSG-03        TO PSRL-RPT-LINE-2            17930000
179400                 MOVE PSRL-REPORT-LINE-2                          17940000
179500                                    TO PW-ADV-SHIP-NOTICE-LINE    17950000
179600                 PERFORM Z500-WRITE-REPORT-LINE                   17960000
179700             END-IF                                               17970000
179800         ELSE                                                     17980000
179900             MOVE PW-ASNHDR-NBR        TO PSRL-ASNHDR-NBR         17990000
180000             MOVE PW-HOLD-VEND-DUNNS-NBR                          18000000
180100                                       TO PSRL-DUNNS-NBR          18010000
180200             MOVE PW-HOLD-VENDOR-NAME  TO PSRL-VENDOR-NAME        18020000
180300             MOVE PW-HOLD-ISA-CNTL-NBR                            18030000
180400                                       TO PSRL-ISA-NBR            18040000
180500             MOVE PSRL-REPORT-LINE-1   TO PW-ADV-SHIP-NOTICE-LINE 18050000
180600             PERFORM Z510-WRITE-REPORT-LINE                       18060000
180700             MOVE PW-ASNORD-PO-NBR     TO MSG-04-ASNORD-PO-NBR    18070000
180800             MOVE MSG-04               TO PSRL-RPT-LINE-2         18080000
180900             MOVE PSRL-REPORT-LINE-2   TO PW-ADV-SHIP-NOTICE-LINE 18090000
181000             PERFORM Z500-WRITE-REPORT-LINE                       18100000
181100         END-IF                                                   18110000
181200     END-IF                                                       18120000
181300     END-IF.                                                      18130000
181400                                                                  18140000
181500     IF PV-PO4-NOT-FOUND-CNT > 0                                  18150000
181600        MOVE PW-ASNHDR-NBR        TO PSRL-ASNHDR-NBR              18160000
181700        MOVE PW-HOLD-VEND-DUNNS-NBR                               18170000
181800                                  TO PSRL-DUNNS-NBR               18180000
181900        MOVE PW-HOLD-VENDOR-NAME  TO PSRL-VENDOR-NAME             18190000
182000        MOVE PW-HOLD-ISA-CNTL-NBR                                 18200000
182100                                  TO PSRL-ISA-NBR                 18210000
182200        MOVE PSRL-REPORT-LINE-1   TO PW-ADV-SHIP-NOTICE-LINE      18220000
182300        PERFORM Z510-WRITE-REPORT-LINE                            18230000
182400        MOVE MSG-10               TO PSRL-RPT-LINE-2              18240000
182500        MOVE PSRL-REPORT-LINE-2   TO PW-ADV-SHIP-NOTICE-LINE      18250000
182600        PERFORM Z500-WRITE-REPORT-LINE                            18260000
182700        SET PO4-NOT-FOUND TO TRUE                                 18270000
182800        MOVE 0 TO PV-PO4-FOUND-CNT                                18280000
182900        MOVE 0 TO PV-PO4-NOT-FOUND-CNT                            18290000
183000     END-IF.                                                      18300000
183100     IF PS-BAD-ASN                                                18310000
183200         CONTINUE                                                 18320000
183300     ELSE                                                         18330000
183400     IF ISA-COMPLETE                                              18340000
183500         PERFORM B300-UPDATE-ASNHDR                               18350000
183600***      MOVE PW-ASNHDR-NBR       TO PSRL-ASNHDR-NBR              18360000
183700***      MOVE PW-HOLD-VEND-DUNNS-NBR                              18370000
183800***                               TO PSRL-DUNNS-NBR               18380000
183900***      MOVE PW-HOLD-VENDOR-NAME TO PSRL-VENDOR-NAME             18390000
184000***      MOVE PW-HOLD-ISA-CNTL-NBR                                18400000
184100***                               TO PSRL-ISA-NBR                 18410000
184200***      MOVE PSRL-REPORT-LINE-1  TO PW-ADV-SHIP-NOTICE-LINE      18420000
184300***      PERFORM Z510-WRITE-REPORT-LINE                           18430000
184400***      MOVE MSG-06              TO PSRL-RPT-LINE-2              18440000
184500***      MOVE PSRL-REPORT-LINE-2  TO PW-ADV-SHIP-NOTICE-LINE      18450000
184600***      PERFORM Z500-WRITE-REPORT-LINE                           18460000
184700                                                                  18470000
184800         PERFORM Z700-COMMIT                                      18480000
184900     ELSE                                                         18490000
185000         IF (ID-IDENTIFICATION-REC                                18500000
185100         OR  END-OF-INP01)                                        18510000
185200             CONTINUE                                             18520000
185300         ELSE                                                     18530000
185400             PERFORM Z000-READ-ADV-SHIP-NOTICE                    18540000
185500               UNTIL (ID-IDENTIFICATION-REC                       18550000
185600                  OR  END-OF-INP01)                               18560000
185700         END-IF                                                   18570000
185800                                                                  18580000
185900         IF DUPLICATE-SHIPMENT                                    18590000
186000             CONTINUE                                             18600000
186100         ELSE                                                     18610000
186200*                                                                 18620000
186300             EXEC SQL                                             18630000
186400                 ROLLBACK                                         18640000
186500             END-EXEC                                             18650000
186600             DISPLAY '*********************'                      18660000
186700             DISPLAY '*  R O L L B A C K  *'                      18670000
186800             DISPLAY '*********************'                      18680000
186900              ADD  1          TO PA-ASNHDR-DELETED                18690000
187000*                                                                 18700000
187100         END-IF                                                   18710000
187200     END-IF                                                       18720000
187300     END-IF.                                                      18730000
187400                                                                  18740000
187500/                                                                 18750000
187600****************************************************************  18760000
187700*     INITIALIZATION                                           *  18770000
187800*                                                              *  18780000
187900*     -  MOVE IDENTIFICATION RECORD FIELDS TO WS               *  18790000
188000*     -  INITIALIZE SWITCHES                                   *  18800000
188100*     -  INITIALIZE WS TRANSACTION HOLD TABLES                 *  18810000
188200****************************************************************  18820000
188300 B100-INITIALIZE.                                                 18830000
188400     MOVE 'B100-INITIALIZE                '                       18840000
188500                                 TO PW-CURRENT-PARA.              18850000
188600*    DISPLAY 'B100-INITIALIZE'.                                   18860000
188700                                                                  18870000
188800     SET ISA-NOT-COMPLETE        TO TRUE.                         18880000
188900     SET SHIPMENT-NOT-COMPLETE   TO TRUE.                         18890000
189000     SET ORDER-NOT-COMPLETE      TO TRUE.                         18900000
189100     SET ITEM-NOT-COMPLETE       TO TRUE.                         18910000
189200     SET NEW-ISA                 TO TRUE.                         18920000
189300     SET NOT-DUPLICATE-SHIPMENT  TO TRUE.                         18930000
189400     SET MAN-NOT-FOUND           TO TRUE.                         18940000
189500     SET PS-NOT-BAD-ASN          TO TRUE.                         18950000
189600                                                                  18960000
189700     INITIALIZE PV-NULLS-TABLE.                                   18970000
189800     INITIALIZE PW-HOLD-AREA.                                     18980000
189900     INITIALIZE PW-ASNHDR-RECORD.                                 18990000
190000     INITIALIZE PW-ASNPKG-TABLE.                                  19000000
190100     INITIALIZE PW-ASNORD-RECORD.                                 19010000
190200     INITIALIZE PW-ADDITIONAL-NAME-TABLE.                         19020000
190300     INITIALIZE PW-ADDITIONAL-ADDRESS-TABLE.                      19030000
190400     INITIALIZE PW-ASNCAR-RECORD.                                 19040000
190500     INITIALIZE PW-ITEM-IDENTIFICATION-TABLE.                     19050000
190600     INITIALIZE PW-ASNDTL-RECORD.                                 19060000
190700     INITIALIZE PW-PO-NBR-SEQ-NBR-TBL.                            19070000
190800                                                                  19080000
190900     INITIALIZE PW-KOHLS-ASNCAR-CNT.                              19090000
191000                                                                  19100000
191100     MOVE PC-POS-1               TO PW-HOLD-ASNDTL-NBR.           19110000
191200*    MOVE PC-STARTING-SEQ-NBR    TO PW-SEQ-NBR.                   19120000
191420                                                                  19142005
191421     IF  SN001I-ISA-ID = PV-PREV-PARTNER-ID                       19142106
191422         CONTINUE                                                 19142205
191423     ELSE                                                         19142305
191424         MOVE SN001I-ISA-ID      TO PV-PREV-PARTNER-ID            19142405
191425                                    DK-PARTNER-ID                 19142505
191426         SET PS-NOT-VALID-IMPORT-SHIP TO TRUE                     19142605
191430         PERFORM B120-CHECK-VALID-IMPORT-SHIP                     19143005
191431     END-IF.                                                      19143105
191440                                                                  19144005
191500     IF SN001I-EDI-VEND-ID (1:9) <= SPACES OR                     19150000
191600        PS-VALID-IMPORT-SHIP                                      19160005
191700         SET NO-DUNNS-NBR        TO TRUE                          19170000
191800         MOVE PC-NO-DUNNS-NBR    TO PW-HOLD-VEND-DUNNS-NBR        19180000
191900         MOVE PC-NO-DUNNS-NAME   TO PW-HOLD-VENDOR-NAME           19190000
192000     ELSE                                                         19200000
192100         SET DUNNS-NBR           TO TRUE                          19210000
192200         MOVE SN001I-EDI-VEND-ID TO PW-HOLD-EDI-VEND-ID           19220000
192300         MOVE SN001I-VEND-DUNNS-NBR                               19230000
192400                                 TO PW-HOLD-VEND-DUNNS-NBR        19240000
192500         PERFORM B150-SELECT-DUNNS-NAME                           19250000
192600     END-IF.                                                      19260000
192700                                                                  19270000
192800     MOVE SN001I-BSN01-TRANS-CDE TO PW-HOLD-TRANS-CDE.            19280000
192900     MOVE SN001I-BSN02-SHIPT-ID  TO PW-ASNHDR-NBR.                19290000
193000     MOVE SN001I-BSN03-SHIPT-DTE TO PW-DATE-YYMMDD                19300000
193100                                    PW-HOLD-CRE-DTE.              19310000
193200     IF PW-DATE-YY > 90                                           19320000
193300         MOVE PC-POS-19          TO PW-HOLD-CRE-DTE-CC            19330000
193400     ELSE                                                         19340000
193500         MOVE PC-POS-20          TO PW-HOLD-CRE-DTE-CC            19350000
193600     END-IF.                                                      19360000
193700     MOVE PW-DATE-YY             TO PW-HOLD-CRE-DTE-YY.           19370000
193800     MOVE PW-DATE-MM             TO PW-HOLD-CRE-DTE-MM.           19380000
193900     MOVE PW-DATE-DD             TO PW-HOLD-CRE-DTE-DD.           19390000
194000     MOVE SN001I-BSN04-SHIPT-TIME                                 19400000
194100                                 TO PW-HOLD-CRE-TIME.             19410000
194200     MOVE  PW-HOLD-CRE-TIME-HH   TO PW-HOLD-CRE-TIME-HH-REDF.     19420000
194300     MOVE  PW-HOLD-CRE-TIME-MM   TO PW-HOLD-CRE-TIME-MM-REDF.     19430000
194400     MOVE  PW-HOLD-CRE-TIME-REDF TO PW-SAVE-CRE-TIME.             19440000
194500     MOVE SN001I-ISA-CNTL-NBR    TO PW-HOLD-ISA-CNTL-NBR.         19450000
194600     MOVE SN001I-GS-CNTL-NBR     TO PW-HOLD-GS-CNTL-NBR.          19460000
194700     MOVE SN001I-ST-CNTL-NBR     TO PW-HOLD-ST-CNTL-NBR.          19470000
194800     MOVE SN001I-ISA-TMST        TO PW-HOLD-ISA-TMST.             19480000
194801                                                                  19480105
194802****************************************************************  19480205
194803*     THIS PARAGRAPH WILL ACCESS A WST PARM TO SEE IF THE      *  19480305
194804*     EDI VENDOR ID FOR THE ASN IS DEFINED AS A VALID TRADING  *  19480405
194805*     PARTNER - THIS PARM CHECK REPLACED HARDCODING OF THE     *  19480505
194806*     VALID EDI VENDOR ID WITHIN THIS PROGRAM.                 *  19480605
194807****************************************************************  19480705
194810 B120-CHECK-VALID-IMPORT-SHIP.                                    19481005
194811                                                                  19481105
194820     MOVE 'B120-CHECK-VALID-IMPORT-SHIP   '                       19482005
194830                                 TO PW-CURRENT-PARA.              19483005
194840*    DISPLAY 'B120-CHECK-VALID-IMPORT-SHIP'.                      19484009
194850                                                                  19485005
194860     PERFORM                                                      19486005
194870       WITH TEST AFTER                                            19487005
194880       VARYING PW-RETRY-COUNTER FROM 1 BY 1                       19488005
194890       UNTIL   PW-RETRY-COUNTER > PC-MAX-RETRIES  OR              19489005
194891               SQLCODE = ZERO  OR                                 19489105
194892               SQLCODE = +100  OR                                 19489205
194893               SQLCODE = -811                                     19489305
194894                                                                  19489405
194895         EXEC SQL                                                 19489505
194896           SELECT C.ATTR_ELEM_TXT                                 19489605
194897             INTO :PV-ELEM-PARTNER-ID                             19489705
194898             FROM WST_INTGRTN_TYP A                               19489805
194899                , WST_ATTR_DEFN   B                               19489905
194900                , WST_ATTR_ELEM   C                               19490005
194901                , WST_ATTR_ELEM   D                               19490105
194902                , WST_ATTR_ELEM   E                               19490205
194903                , WST_ATTR_ELEM   F                               19490305
194904            WHERE A.INTGRTN_TYP_CDE   = 'ASNVTRDPRT'              19490405
194905              AND A.INTGRTN_TYP_CDE   = B.INTGRTN_TYP_CDE         19490505
194906              AND B.ATTR_DEFN_SEQ_NBR = 1                         19490605
194907              AND B.INTGRTN_TYP_CDE   = C.INTGRTN_TYP_CDE         19490705
194908              AND C.ATTR_DEFN_SEQ_NBR = 1                         19490805
194909              AND B.INTGRTN_TYP_CDE   = D.INTGRTN_TYP_CDE         19490905
194910              AND D.ATTR_DEFN_SEQ_NBR = 2                         19491005
194911              AND B.INTGRTN_TYP_CDE   = E.INTGRTN_TYP_CDE         19491105
194912              AND E.ATTR_DEFN_SEQ_NBR = 3                         19491205
194913              AND B.INTGRTN_TYP_CDE   = F.INTGRTN_TYP_CDE         19491305
194914              AND F.ATTR_DEFN_SEQ_NBR = 4                         19491405
194915              AND C.ATTR_ELEM_SEQ_NBR = D.ATTR_ELEM_SEQ_NBR       19491505
194916              AND C.ATTR_ELEM_SEQ_NBR = E.ATTR_ELEM_SEQ_NBR       19491605
194917              AND C.ATTR_ELEM_SEQ_NBR = F.ATTR_ELEM_SEQ_NBR       19491705
194918              AND C.ATTR_ELEM_TXT     = :DK-PARTNER-ID            19491805
194919              AND E.ATTR_ELEM_TXT     = 'Y'                       19491905
194920              AND F.ATTR_ELEM_TMST   <=  CURRENT TIMESTAMP        19492005
194921            WITH UR                                               19492105
194929         END-EXEC                                                 19492905
194930                                                                  19493005
194931         EVALUATE TRUE                                            19493105
194932           WHEN SQLCODE = ZERO                                    19493205
194933           WHEN SQLCODE = -811                                    19493305
194936                SET PS-VALID-IMPORT-SHIP TO TRUE                  19493605
194937                                                                  19493705
194938           WHEN SQLCODE = +100                                    19493805
194939                SET PS-NOT-VALID-IMPORT-SHIP TO TRUE              19493905
194940                MOVE SPACES TO PV-ELEM-PARTNER-ID                 19494005
194941                                                                  19494105
194942           WHEN OTHER                                             19494205
194943               DISPLAY '**************************************'   19494305
194944               DISPLAY 'ERROR ISSUED ON SELECT OF WST PARM '      19494405
194945                       'TABLE FOR PARM:  ASNVTRDPRT'              19494505
194946               DISPLAY 'DK-PARTNER-ID BEING PROCESSED IS: '       19494605
194947                        DK-PARTNER-ID                             19494705
194948               MOVE PV-INPUT-READ-COUNT TO PV-DISPLAY-REC-NBR     19494805
194949               DISPLAY 'INPUT RECORD NUMBER BEING PROCESSED '     19494905
194950                        ' IS: ' PV-DISPLAY-REC-NBR                19495005
194952               DISPLAY '**************************************'   19495205
194953               PERFORM Z900-SQL-ERROR                             19495305
194954                                                                  19495405
194955         END-EVALUATE                                             19495505
194956                                                                  19495605
194957     END-PERFORM.                                                 19495705
194960                                                                  19496005
195000****************************************************************  19500000
195100*     SELECT THE DUNNS NAME                                    *  19510000
195200****************************************************************  19520000
195300 B150-SELECT-DUNNS-NAME.                                          19530000
195400     MOVE 'B150-SELECT-DUNNS-NAME         '                       19540000
195500                                 TO PW-CURRENT-PARA.              19550000
195600*    DISPLAY 'B150-SELECT-DUNNS-NAME'.                            19560000
195700                                                                  19570000
195800     PERFORM                                                      19580000
195900       WITH TEST AFTER                                            19590000
196000       VARYING PW-RETRY-COUNTER FROM 1 BY 1                       19600000
196100       UNTIL   PW-RETRY-COUNTER > PC-MAX-RETRIES  OR              19610000
196200               SQLCODE = ZERO  OR                                 19620000
196300               SQLCODE = +100                                     19630000
196400                                                                  19640000
196500         EXEC SQL                                                 19650000
196600           SELECT ENT_NAME_DESC                                   19660000
196700            INTO :ENTNME-ENT-NAME-DESC                            19670000
196800            FROM  TEXTENT A                                       19680000
196900                 ,TENTNME B                                       19690000
197000           WHERE A.DUN_NBR  = :PW-HOLD-VEND-DUNNS-NBR             19700000
197100             AND A.ENT_ID   = B.ENT_ID                            19710000
197200             AND B.TYPE_CDE = '01'                                19720000
197300           WITH UR                                                19730000
197400         END-EXEC                                                 19740000
197500                                                                  19750000
197600         EVALUATE TRUE                                            19760000
197700           WHEN SQLCODE = ZERO                                    19770000
197800           WHEN SQLCODE = PC-NEG-904                              19780000
197900           WHEN SQLCODE = PC-NEG-913                              19790000
198000               MOVE ENTNME-ENT-NAME-DESC TO PW-HOLD-VENDOR-NAME   19800000
198100                                                                  19810000
198200           WHEN SQLCODE = +100                                    19820000
198300               MOVE PC-NO-DUNNS-NAME TO PW-HOLD-VENDOR-NAME       19830000
198400                                                                  19840000
198500           WHEN OTHER                                             19850000
198600               DISPLAY '**************************************'   19860000
198700               DISPLAY 'ERROR ISSUED ON SELECT OF TENTNME     '   19870000
198800               DISPLAY 'PW-HOLD-VEND-DUNNS-NBR = '                19880000
198900                        PW-HOLD-VEND-DUNNS-NBR                    19890000
199000               DISPLAY '**************************************'   19900000
199100               PERFORM Z900-SQL-ERROR                             19910000
199200                                                                  19920000
199300         END-EVALUATE                                             19930000
199400                                                                  19940000
199500     END-PERFORM.                                                 19950000
199600                                                                  19960000
199700/                                                                 19970000
199800***************************************************************** 19980000
199900*     CREATE ASN RECORDS                                        * 19990000
200000*                                                               * 20000000
200100*   - CONTROL THE FORMATTING OF ALL THE ADVANCE SHIP NOTICE     * 20010000
200200*     TABLE RECORDS.                                            * 20020000
200300***************************************************************** 20030000
200400 B200-CREATE-ASN-RECORDS.                                         20040000
200500     MOVE 'B200-CREATE-ASN-RECORDS        '                       20050000
200600                                 TO PW-CURRENT-PARA.              20060000
200700*    DISPLAY 'B200-CREATE-ASN-RECORDS'.                           20070000
200800                                                                  20080000
200900     EVALUATE TRUE                                                20090000
201000                                                                  20100000
201100       WHEN SHIPMENT-LEVEL                                        20110000
201200         MOVE ZEROES             TO PW-ASNPKG-SUB                 20120000
201300         SET TD5-NOT-FOUND       TO TRUE                          20130000
201400                                                                  20140000
201500         PERFORM Z000-READ-ADV-SHIP-NOTICE                        20150000
201600                                                                  20160000
201700         IF ID-IDENTIFICATION-REC                                 20170000
201800             SET END-OF-ISA      TO TRUE                          20180000
201900         END-IF                                                   20190000
202000                                                                  20200000
202100         PERFORM C000-PROCESS-SHIPMENT                            20210000
202200           UNTIL ID-IDENTIFICATION-REC                            20220000
202300              OR HL-HIERARCHICAL-REC                              20230000
202400              OR N1-NAME-REC                                      20240000
202500         PERFORM D000-COMPLETE-SHIPMENT                           20250000
202600                                                                  20260000
202700*      CHECK TO SEE IF A PRIOR ORDER LEVEL EXISTS AND THAT        20270000
202800*      IT'S ASSOCIATED ITEM LEVEL IS COMPLETE BEFORE PROCESS-     20280000
202900*      ING THE NEW ORDER LEVEL. THIS IS NECESSARY BECAUSE         20290000
203000*      MULTIPLE ORDER LEVELS WAY EXIST FOR A SHIPMENT.            20300000
203100                                                                  20310000
203200       WHEN ORDER-LEVEL                                           20320000
203300         IF ORDER-COMPLETE                                        20330000
203400           IF ITEM-COMPLETE                                       20340000
203500               SET ORDER-NOT-COMPLETE                             20350000
203600                                 TO TRUE                          20360000
203700               SET ITEM-NOT-COMPLETE                              20370000
203800                                 TO TRUE                          20380000
203900                                                                  20390000
204000               PERFORM Z000-READ-ADV-SHIP-NOTICE                  20400000
204100                                                                  20410000
204200               IF ID-IDENTIFICATION-REC                           20420000
204300                   SET END-OF-ISA TO TRUE                         20430000
204400               END-IF                                             20440000
204500                                                                  20450000
204600               PERFORM E000-PROCESS-ORDER                         20460000
204700                 UNTIL ID-IDENTIFICATION-REC                      20470000
204800                    OR HL-HIERARCHICAL-REC                        20480000
204900                    OR N1-NAME-REC                                20490000
205000                    OR PS-BAD-ASN                                 20500000
205100               IF PS-BAD-ASN                                      20510000
205200                   CONTINUE                                       20520000
205300               ELSE                                               20530000
205400                   PERFORM F000-COMPLETE-ORDER                    20540000
205500               END-IF                                             20550000
205600           ELSE                                                   20560000
205700               SET END-OF-ISA    TO TRUE                          20570000
205800           END-IF                                                 20580000
205900         ELSE                                                     20590000
206000             SET ITEM-NOT-COMPLETE TO TRUE                        20600000
206100                                                                  20610000
206200             PERFORM Z000-READ-ADV-SHIP-NOTICE                    20620000
206300                                                                  20630000
206400             IF ID-IDENTIFICATION-REC                             20640000
206500                 SET END-OF-ISA  TO TRUE                          20650000
206600             END-IF                                               20660000
206700                                                                  20670000
206800             PERFORM E000-PROCESS-ORDER                           20680000
206900               UNTIL ID-IDENTIFICATION-REC                        20690000
207000                  OR HL-HIERARCHICAL-REC                          20700000
207100                  OR N1-NAME-REC                                  20710000
207200                  OR PS-BAD-ASN                                   20720000
207300             IF PS-BAD-ASN                                        20730000
207400                 CONTINUE                                         20740000
207500             ELSE                                                 20750000
207600                 PERFORM F000-COMPLETE-ORDER                      20760000
207700             END-IF                                               20770000
207800         END-IF                                                   20780000
207900*                                                                 20790000
208000*      NO CHECK IS PERFORMED TO DETERMINE IF A COMBINATION OF     20800000
208100*           PACK LEVEL                                            20810000
208200*           ITEM LEVEL - STD PACK                                 20820000
208300*           ITEM LEVEL - NO CARTON                                20830000
208400*      EXIST. BUT ONLY ONE TYPE SHOULD EXIST FOR A SINGLE ISA.    20840000
208500*                                                                 20850000
208600*      CHECK TO SEE IF AN ORDER LEVEL EXISTS BEFORE PROCESSING THE20860000
208700*           PACK LEVEL                                            20870000
208800*           ITEM LEVEL - STD PACK                                 20880000
208900*           ITEM LEVEL - NO CARTON                                20890000
209000                                                                  20900000
209100       WHEN PACK-LEVEL                                            20910000
209200         IF ORDER-COMPLETE                                        20920000
209300             PERFORM Z000-READ-ADV-SHIP-NOTICE                    20930000
209400             PERFORM G000-PROCESS-PICK-PACK                       20940000
209500         ELSE                                                     20950000
209600             SET END-OF-ISA      TO TRUE                          20960000
209700         END-IF                                                   20970000
209800                                                                  20980000
209900       WHEN ITEM-LEVEL                                            20990000
210000        AND (STD-PACK OR STD-PACK-4010)                           21000000
210100         IF ORDER-COMPLETE                                        21010000
210200             PERFORM Z000-READ-ADV-SHIP-NOTICE                    21020000
210300             PERFORM H000-PROCESS-STD-PACK                        21030000
210400         ELSE                                                     21040000
210500             SET END-OF-ISA      TO TRUE                          21050000
210600         END-IF                                                   21060000
210700                                                                  21070000
210800       WHEN ITEM-LEVEL                                            21080000
210900        AND (NO-CARTON OR NO-CARTON-4010)                         21090000
211000         IF ORDER-COMPLETE                                        21100000
211100             PERFORM I000-PROCESS-NO-CARTON                       21110000
211200         ELSE                                                     21120000
211300             SET END-OF-ISA      TO TRUE                          21130000
211400         END-IF                                                   21140000
211500                                                                  21150000
211600       WHEN OTHER                                                 21160000
211700         MOVE PW-ASNHDR-NBR          TO PSRL-ASNHDR-NBR           21170000
211800         MOVE PW-HOLD-VEND-DUNNS-NBR TO PSRL-DUNNS-NBR            21180000
211900         MOVE PW-HOLD-VENDOR-NAME    TO PSRL-VENDOR-NAME          21190000
212000         MOVE PW-HOLD-ISA-CNTL-NBR                                21200000
212100                                     TO PSRL-ISA-NBR              21210000
212200         MOVE PSRL-REPORT-LINE-1     TO PW-ADV-SHIP-NOTICE-LINE   21220000
212300         PERFORM Z510-WRITE-REPORT-LINE                           21230000
212400         MOVE MSG-1E                 TO PSRL-RPT-LINE-2           21240000
212500         MOVE PSRL-REPORT-LINE-2     TO PW-ADV-SHIP-NOTICE-LINE   21250000
212600         PERFORM Z500-WRITE-REPORT-LINE                           21260000
212700         MOVE ADVANCE-SHIP-NOTICE-DTL-RECORD                      21270000
212800                                     TO MSG-1B-DTL                21280000
212900         MOVE MSG-1B                 TO PSRL-RPT-LINE-2           21290000
213000         MOVE PSRL-REPORT-LINE-2     TO PW-ADV-SHIP-NOTICE-LINE   21300000
213100         PERFORM Z500-WRITE-REPORT-LINE                           21310000
213200                                                                  21320000
213300         PERFORM Z000-READ-ADV-SHIP-NOTICE                        21330000
213400           WITH TEST AFTER                                        21340000
213500           UNTIL HL-HIERARCHICAL-REC                              21350000
213600              OR ID-IDENTIFICATION-REC                            21360000
213700              OR END-OF-INP01                                     21370000
213800                                                                  21380000
213900         IF ID-IDENTIFICATION-REC                                 21390000
214000             SET END-OF-ISA      TO TRUE                          21400000
214100         END-IF                                                   21410000
214200                                                                  21420000
214300     END-EVALUATE.                                                21430000
214400     IF PS-BAD-ASN                                                21440000
214500         PERFORM M000-READ-UNTIL-ID-REC                           21450000
214600     END-IF.                                                      21460000
214700/                                                                 21470000
214800***************************************************************** 21480000
214900*     UPDATE HEADER                                             * 21490000
215000*                                                               * 21500000
215100*     -  THIS PROCESS WILL UPDATE THE CARTON SHIP QUANTITY ON   * 21510000
215200*        THE ASNHDR TABLE.                                      * 21520000
215300***************************************************************** 21530000
215400 B300-UPDATE-ASNHDR.                                              21540000
215500     MOVE 'B300-UPDATE-ASNHDR             '                       21550000
215600                                 TO PW-CURRENT-PARA.              21560000
215700*    DISPLAY 'B300-UPDATE-ASNHDR'.                                21570000
215800                                                                  21580000
215900     IF PW-ASNHDR-CART-SHIP-QTY > ZERO                            21590000
216000         PERFORM Z310-SQL-UPDATE-ASNHDR                           21600000
216100     END-IF.                                                      21610000
216200/                                                                 21620000
216300***************************************************************** 21630000
216400*     PROCESS SHIPMENT                                          * 21640000
216500*                                                               * 21650000
216600*     -  CREATE A TEMPORARY ASNHDR & ASNPKG RECORD IN WS,       * 21660000
216700*        THIS IS BECAUSE IT TAKES MULTIPLE ADVANCE SHIP         * 21670000
216800*        NOTICE RECORDS TO COMPLETE THEM.                       * 21680000
216900***************************************************************** 21690000
217000 C000-PROCESS-SHIPMENT.                                           21700000
217100     MOVE 'C000-PROCESS-SHIPMENT          '                       21710000
217200                                 TO PW-CURRENT-PARA.              21720000
217300*    DISPLAY 'C000-PROCESS-SHIPMENT'.                             21730000
217400                                                                  21740000
217500     EVALUATE TRUE                                                21750000
217600                                                                  21760000
217700       WHEN PO4-ITEM-PHYSICAL-DTL-REC                             21770000
217800         PERFORM C100-SAVE-PO4-FIELDS                             21780000
217900                                                                  21790000
218000       WHEN TD1-CARRIER-QTY-WGHT-REC                              21800000
218100         PERFORM C200-SAVE-TD1-FIELDS                             21810000
218200                                                                  21820000
218300       WHEN TD5-CARRIER-RTE-TRNST-REC                             21830000
218400         PERFORM C300-SAVE-TD5-FIELDS                             21840000
218500                                                                  21850000
218600       WHEN TD3-CARRIER-EQUIPMENT-REC                             21860000
218700         PERFORM C400-SAVE-TD3-FIELDS                             21870000
218800                                                                  21880000
218900       WHEN REF-REFERENCE-NUMBERS-REC                             21890000
219000         PERFORM C500-SAVE-REF-FIELDS                             21900000
219100                                                                  21910000
219200       WHEN DTM-DTE-TME-REFERENCE-REC                             21920000
219300         PERFORM C600-SAVE-DTM-FIELDS                             21930000
219400                                                                  21940000
219500       WHEN FOB-FOB-RELATED-INSTR-REC                             21950000
219600         PERFORM C700-SAVE-FOB-FIELDS                             21960000
219700                                                                  21970000
219800       WHEN OTHER                                                 21980000
219900         MOVE PW-ASNHDR-NBR          TO PSRL-ASNHDR-NBR           21990000
220000         MOVE PW-HOLD-VEND-DUNNS-NBR TO PSRL-DUNNS-NBR            22000000
220100         MOVE PW-HOLD-VENDOR-NAME    TO PSRL-VENDOR-NAME          22010000
220200         MOVE PW-HOLD-ISA-CNTL-NBR                                22020000
220300                                     TO PSRL-ISA-NBR              22030000
220400         MOVE PSRL-REPORT-LINE-1     TO PW-ADV-SHIP-NOTICE-LINE   22040000
220500         PERFORM Z510-WRITE-REPORT-LINE                           22050000
220600         MOVE MSG-1S                 TO PSRL-RPT-LINE-2           22060000
220700         MOVE PSRL-REPORT-LINE-2     TO PW-ADV-SHIP-NOTICE-LINE   22070000
220800         PERFORM Z500-WRITE-REPORT-LINE                           22080000
220900         MOVE ADVANCE-SHIP-NOTICE-DTL-RECORD                      22090000
221000                                     TO MSG-1B-DTL                22100000
221100         MOVE MSG-1B                 TO PSRL-RPT-LINE-2           22110000
221200         MOVE PSRL-REPORT-LINE-2     TO PW-ADV-SHIP-NOTICE-LINE   22120000
221300         PERFORM Z500-WRITE-REPORT-LINE                           22130000
221400     END-EVALUATE.                                                22140000
221500                                                                  22150000
221600     PERFORM Z000-READ-ADV-SHIP-NOTICE.                           22160000
221700                                                                  22170000
221800     IF ID-IDENTIFICATION-REC                                     22180000
221900         SET END-OF-ISA          TO TRUE                          22190000
222000     END-IF.                                                      22200000
222100/                                                                 22210000
222200***************************************************************** 22220000
222300*     SAVE PO4 FIELDS                                           * 22230000
222400*                                                               * 22240000
222500*     -  SAVE SHIPMENT LEVEL PO4 RECORD FIELDS IN THE ASNHDR    * 22250000
222600*        RECORD IN WS                                           * 22260000
222700***************************************************************** 22270000
222800 C100-SAVE-PO4-FIELDS.                                            22280000
222900     MOVE 'C100-SAVE-PO4-FIELDS           '                       22290000
223000                                 TO PW-CURRENT-PARA.              22300000
223100*    DISPLAY 'C100-SAVE-PO4-FIELDS'.                              22310000
223200                                                                  22320000
223300                                                                  22330000
223400     IF SN001I-PO405-WGHT-QUAL-CDE = 'GR'                         22340000
223500         MOVE SN001I-PO406-GRO-WGHT-MSMT                          22350000
223600                                 TO PW-ASNHDR-GRO-WGHT-MSMT       22360000
223700         MOVE SN001I-PO407-WGHT-UM-CDE                            22370000
223800                                 TO PW-ASNHDR-GRO-WGHT-UM-CDE     22380000
223900     END-IF.                                                      22390000
224000     MOVE SN001I-PO408-GRO-VOL-MSMT                               22400000
224100                                 TO PW-ASNHDR-SHPT-VOL-MSMT.      22410000
224200     MOVE SN001I-PO409-VOL-UM-CDE                                 22420000
224300                                 TO PW-ASNHDR-SHPT-VOL-UM-CDE.    22430000
224400/                                                                 22440000
224500***************************************************************** 22450000
224600*     SAVE TD1 FIELDS                                           * 22460000
224700*                                                               * 22470000
224800*     -  SAVE SHIPMENT LEVEL TD1 RECORD FIELDS IN THE ASNPKG    * 22480000
224900*        RECORD IN WS                                           * 22490000
225000***************************************************************** 22500000
225100 C200-SAVE-TD1-FIELDS.                                            22510000
225200     MOVE 'C200-SAVE-TD1-FIELDS           '                       22520000
225300                                 TO PW-CURRENT-PARA.              22530000
225400*    DISPLAY 'C200-SAVE-TD1-FIELDS'.                              22540000
225500                                                                  22550000
225600     ADD PC-POS-1                TO PW-ASNPKG-SUB.                22560000
225700                                                                  22570000
225800     MOVE SN001I-TD101-PKG-CDE   TO PW-ASNPKG-PACK-CDE            22580000
225900                                    (PW-ASNPKG-SUB).              22590000
226000     MOVE SN001I-TD102-SHIPT-QTY TO PW-ASNPKG-CART-SHIP-QTY       22600000
226100                                    (PW-ASNPKG-SUB).              22610000
226200                                                                  22620000
226300     IF SN001I-TD106-WGHT-QUAL-CDE = 'G '                         22630000
226400         MOVE SN001I-TD107-WGHT-MSMT                              22640000
226500                                 TO PW-ASNPKG-GRO-WGHT-MSMT       22650000
226600                                    (PW-ASNPKG-SUB)               22660000
226700         MOVE SN001I-TD108-UM-CDE                                 22670000
226800                                 TO PW-ASNPKG-GRO-WGHT-UM-CDE     22680000
226900                                    (PW-ASNPKG-SUB)               22690000
227000     END-IF.                                                      22700000
227100/                                                                 22710000
227200***************************************************************** 22720000
227300*     SAVE TD1 FIELDS                                           * 22730000
227400*                                                               * 22740000
227500*     -  SAVE ORDER    LEVEL TD1 RECORD FIELDS IN THE ASNORD    * 22750000
227600*        RECORD IN WS                                           * 22760000
227700***************************************************************** 22770000
227800 C210-SAVE-TD1-FIELDS.                                            22780000
227900     MOVE 'C210-SAVE-TD1-FIELDS           '                       22790000
228000                                 TO PW-CURRENT-PARA.              22800000
228100*    DISPLAY 'C210-SAVE-TD1-FIELDS'.                              22810000
228200                                                                  22820000
228300     MOVE SN001I-TD102-SHIPT-QTY TO PW-ASNORD-CART-SHIP-QTY.      22830000
228400*                                                                 22840000
228500/                                                                 22850000
228600***************************************************************** 22860000
228700*     SAVE TD5 FIELDS                                           * 22870000
228800*                                                               * 22880000
228900*     -  CONTROL THE SAVING OF SHIPMENT LEVEL TD5 REC FIELDS    * 22890000
229000***************************************************************** 22900000
229100 C300-SAVE-TD5-FIELDS.                                            22910000
229200     MOVE 'C300-SAVE-TD5-FIELDS           '                       22920000
229300                                 TO PW-CURRENT-PARA.              22930000
229400*    DISPLAY 'C300-SAVE-TD5-FIELDS'.                              22940000
229500                                                                  22950000
229600     EVALUATE TRUE                                                22960000
229700       WHEN TD5-FOUND                                             22970000
229800         CONTINUE                                                 22980000
229900       WHEN SN001I-TD501-RTE-SEQ-CDE = 'B '                       22990000
230000         SET TD5-FOUND           TO TRUE                          23000000
230100         PERFORM C350-LOAD-TD5-WS                                 23010000
230200       WHEN OTHER                                                 23020000
230300         PERFORM C350-LOAD-TD5-WS                                 23030000
230400     END-EVALUATE.                                                23040000
230500/                                                                 23050000
230600***************************************************************** 23060000
230700*     LOAD TD5 WS                                               * 23070000
230800*                                                               * 23080000
230900*     -  SAVE SHIPMENT LEVEL TD5 RECORD FIELDS IN THE ASNHDR    * 23090000
231000*        RECORD IN WS                                           * 23100000
231100***************************************************************** 23110000
231200 C350-LOAD-TD5-WS.                                                23120000
231300     MOVE 'C350-LOAD-TD5-WS               '                       23130000
231400                                 TO PW-CURRENT-PARA.              23140000
231500*    DISPLAY 'C350-LOAD-TD5-WS'.                                  23150000
231600                                                                  23160000
231700     MOVE SN001I-TD501-RTE-SEQ-CDE                                23170000
231800                                 TO PW-ASNHDR-RTE-SEQ-CDE.        23180000
231900     MOVE SN001I-TD502-CARR-ID-QUAL-CDE                           23190000
232000                                 TO PW-ASNHDR-CARR-ID-QUAL-CDE.   23200000
232100     MOVE SN001I-TD503-CARR-ID-CDE                                23210000
232200                                 TO PW-ASNHDR-CARR-ID-CDE.        23220000
232300     MOVE SN001I-TD504-TRANS-MTHD-CDE                             23230000
232400                                 TO PW-ASNHDR-TRANS-MTHD-CDE.     23240000
232500     MOVE SN001I-TD505-CARR-NME  TO PW-ASNHDR-CARR-NAME.          23250000
232600     MOVE SN001I-TD506-STATUS-CDE                                 23260000
232700                                 TO PW-ASNHDR-SHIPT-STATUS-CDE.   23270000
232800                                                                  23280000
232900     EVALUATE TRUE                                                23290000
233000                                                                  23300000
233100       WHEN SN001I-TD510-TRNS-TME-QUAL-CDE = 'CD'                 23310000
233200         INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56           23320000
233300         SET DPG51-ACTUAL-CALENDAR-ONLY   TO TRUE                 23330000
233400         SET DPG51-INCREMENT-DATE         TO TRUE                 23340000
233500         MOVE SN001I-TD511-TRNST-TIME TO DPG51-INCR-DECR-DAYS-9   23350000
233600         MOVE ZEROS TO DPG51-INCR-DECR-BUS-DAYS-9                 23360000
233700         MOVE PW-HOLD-CRE-DTE-CCYYMMDD    TO DPG52-LK-DATE-INPUT  23370000
233800         SET DPG52-LK-DTE-ISO-FMT         TO TRUE                 23380000
233900         CALL PC-DPKUT500                                         23390000
234000                    USING DPG51 DPG52 DPG53 DPG54 DPG55 DPG56     23400000
234100         IF DPG54-SEVERE-ERROR                                    23410000
234200             DISPLAY '***     S N K U P 0 0 1    ***'             23420000
234300             DISPLAY '*** ERROR CALLING DPUT500 - TYPE (CD) ***'  23430000
234400             DISPLAY DPG54-ERROR-MESSAGE                          23440000
234500         ELSE                                                     23450000
234600             MOVE DPG55-DB2-ISO-DATE-FMT                          23460000
234700                                 TO PW-HOLD-ANTC-DELY-DTE-CCYYMMDD23470000
234800             MOVE PW-HOLD-CRE-DTE    TO PW-HOLD-ANTC-DELY-DTE     23480000
234900         END-IF                                                   23490000
235000                                                                  23500000
235100       WHEN SN001I-TD510-TRNS-TME-QUAL-CDE = 'HO'                 23510000
235200         INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56           23520000
235300         SET DPG51-ACTUAL-CALENDAR-ONLY   TO TRUE                 23530000
235400         SET DPG51-INCREMENT-DATE         TO TRUE                 23540000
235500         COMPUTE  DPG51-INCR-DECR-DAYS-9 ROUNDED                  23550000
235600               = (SN001I-TD511-TRNST-TIME                         23560000
235700               /  PC-POS-2400)                                    23570000
235800               +  PC-POINT-5                                      23580000
235900         MOVE ZEROS TO DPG51-INCR-DECR-BUS-DAYS-9                 23590000
236000         MOVE PW-HOLD-CRE-DTE-CCYYMMDD    TO DPG52-LK-DATE-INPUT  23600000
236100         SET DPG52-LK-DTE-ISO-FMT         TO TRUE                 23610000
236200         CALL PC-DPKUT500                                         23620000
236300                    USING DPG51 DPG52 DPG53 DPG54 DPG55 DPG56     23630000
236400         IF DPG54-SEVERE-ERROR                                    23640000
236500             DISPLAY '***     S N K U P 0 0 1    ***'             23650000
236600             DISPLAY '*** ERROR CALLING DPUT500 - TYPE (HO) ***'  23660000
236700             DISPLAY DPG54-ERROR-MESSAGE                          23670000
236800         ELSE                                                     23680000
236900             MOVE DPG55-DB2-ISO-DATE-FMT                          23690000
237000                                 TO PW-HOLD-ANTC-DELY-DTE-CCYYMMDD23700000
237100             MOVE PW-HOLD-CRE-DTE    TO PW-HOLD-ANTC-DELY-DTE     23710000
237200         END-IF                                                   23720000
237300                                                                  23730000
237400       WHEN OTHER                                                 23740000
237500         MOVE ZEROES             TO PW-HOLD-ANTC-DELY-DTE         23750000
237600     END-EVALUATE.                                                23760000
237700                                                                  23770000
237800***************************************************************   23780000
237900*       OLD DATE ROUTINE  REPLACE BY DPKUT500                 *   23790000
238000***************************************************************   23800000
238100**   EVALUATE TRUE                                                23810000
238200**                                                                23820000
238300**     WHEN SN001I-TD510-TRNS-TME-QUAL-CDE = 'CD'                 23830000
238400**       MOVE 'A'                TO DP105-FUNCTION-CODE           23840000
238500**       MOVE 'M'                TO DP105-DATE-ORIENTATION        23850000
238600**       MOVE SN001I-TD511-TRNST-TIME                             23860000
238700**                               TO DP105-DATE-ADD-DAYS           23870000
238800**       MOVE PW-HOLD-CRE-DTE    TO DP105-DATE1                   23880000
238900**       CALL PC-DPKUT105 USING DP105-CALENDAR-PARAMETERS         23890000
239000**       MOVE DP105-RETURN-DATE  TO PW-DATE-YYMMDD                23900000
239100**                                  PW-HOLD-ANTC-DELY-DTE         23910000
239200**       MOVE DP105-RETURN-CENTURY                                23920000
239300**                               TO PW-HOLD-ANTC-DELY-DTE-CC      23930000
239400**       MOVE PW-DATE-YY         TO PW-HOLD-ANTC-DELY-DTE-YY      23940000
239500**       MOVE PW-DATE-MM         TO PW-HOLD-ANTC-DELY-DTE-MM      23950000
239600**       MOVE PW-DATE-DD         TO PW-HOLD-ANTC-DELY-DTE-DD      23960000
239700**                                                                23970000
239800**     WHEN SN001I-TD510-TRNS-TME-QUAL-CDE = 'HO'                 23980000
239900**       MOVE 'A'                TO DP105-FUNCTION-CODE           23990000
240000**       MOVE 'M'                TO DP105-DATE-ORIENTATION        24000000
240100**       COMPUTE  DP105-DATE-ADD-DAYS ROUNDED                     24010000
240200**             = (SN001I-TD511-TRNST-TIME                         24020000
240300**             /  PC-POS-2400)                                    24030000
240400**             +  PC-POINT-5                                      24040000
240500**       MOVE PW-HOLD-CRE-DTE    TO DP105-DATE1                   24050000
240600**       CALL PC-DPKUT105 USING DP105-CALENDAR-PARAMETERS         24060000
240700**       MOVE DP105-RETURN-DATE  TO PW-DATE-YYMMDD                24070000
240800**                                  PW-HOLD-ANTC-DELY-DTE         24080000
240900**       MOVE DP105-RETURN-CENTURY                                24090000
241000**                               TO PW-HOLD-ANTC-DELY-DTE-CC      24100000
241100**       MOVE PW-DATE-YY         TO PW-HOLD-ANTC-DELY-DTE-YY      24110000
241200**       MOVE PW-DATE-MM         TO PW-HOLD-ANTC-DELY-DTE-MM      24120000
241300**       MOVE PW-DATE-DD         TO PW-HOLD-ANTC-DELY-DTE-DD      24130000
241400**                                                                24140000
241500**     WHEN OTHER                                                 24150000
241600**       MOVE ZEROES             TO PW-HOLD-ANTC-DELY-DTE         24160000
241700**   END-EVALUATE.                                                24170000
241800/                                                                 24180000
241900***************************************************************** 24190000
242000*     SAVE TD3 FIELDS                                           * 24200000
242100*                                                               * 24210000
242200*     -  SAVE SHIPMENT LEVEL TD3 RECORD FIELDS IN THE ASNHDR    * 24220000
242300*        RECORD IN WS                                           * 24230000
242400***************************************************************** 24240000
242500 C400-SAVE-TD3-FIELDS.                                            24250000
242600     MOVE 'C400-SAVE-TD3-FIELDS           '                       24260000
242700                                 TO PW-CURRENT-PARA.              24270000
242800*    DISPLAY 'C400-SAVE-TD3-FIELDS'.                              24280000
242900                                                                  24290000
243000     IF SN001I-TD301-EQUIP-CDE = 'CN'                             24300000
243100         MOVE SN001I-TD302-EQUIP-INIT-CDE                         24310000
243200                                 TO PW-ASNHDR-EQUIP-INIT-CDE      24320000
243300         MOVE SN001I-TD303-EQUIP-NBR                              24330000
243400                                 TO PW-ASNHDR-EQUIP-NBR           24340000
243500     END-IF.                                                      24350000
243600/                                                                 24360000
243700***************************************************************** 24370000
243800*     SAVE REF FIELDS                                           * 24380000
243900*                                                               * 24390000
244000*     -  SAVE SHIPMENT LEVEL REF RECORD FIELDS IN THE ASNHDR    * 24400000
244100*        RECORD IN WS                                           * 24410000
244200***************************************************************** 24420000
244300 C500-SAVE-REF-FIELDS.                                            24430000
244400     MOVE 'C500-SAVE-REF-FIELDS           '                       24440000
244500                                 TO PW-CURRENT-PARA.              24450000
244600*    DISPLAY 'C500-SAVE-REF-FIELDS'.                              24460000
244700                                                                  24470000
244800     EVALUATE TRUE                                                24480000
244900       WHEN SN001I-REF01-NBR-QUAL-CDE = 'BM'                      24490000
245000         MOVE SN001I-REF02-NBR   TO PW-ASNHDR-BOL-NBR             24500000
245100       WHEN SN001I-REF01-NBR-QUAL-CDE = 'CN'                      24510000
245200         MOVE SN001I-REF02-NBR   TO PW-ASNHDR-PRO-NBR             24520000
245300* CLT WR40574 START 01-10-12                                ***** 24530000
245400       WHEN SN001I-REF01-NBR-QUAL-CDE = '06'                      24540000
245500         MOVE SN001I-REF02-NBR   TO PW-ASNHDR-CARR-AUTH-ID        24550000
245600* CLT WR40574 END   01-10-12                                ***** 24560000
245700       WHEN OTHER                                                 24570000
245800         CONTINUE                                                 24580000
245900     END-EVALUATE.                                                24590000
246000/                                                                 24600000
246100***************************************************************** 24610000
246200*     SAVE DTM FIELDS                                           * 24620000
246300*                                                               * 24630000
246400*     -  SAVE SHIPMENT LEVEL DTM RECORD FIELDS IN WS            * 24640000
246500***************************************************************** 24650000
246600 C600-SAVE-DTM-FIELDS.                                            24660000
246700     MOVE 'C600-SAVE-DTM-FIELDS           '                       24670000
246800                                 TO PW-CURRENT-PARA.              24680000
246900*    DISPLAY 'C600-SAVE-DTM-FIELDS'.                              24690000
247000                                                                  24700000
247100     IF PS-VERSION-4010                                           24710000
247200         MOVE SN001I-DTM03-SHIP-TIME TO PW-HOLD-SHIP-TIME         24720000
247300         MOVE PW-HOLD-SHIP-TIME-HH   TO PW-HOLD-SHIP-TIME-HH-REDF 24730000
247400         MOVE PW-HOLD-SHIP-TIME-MM   TO PW-HOLD-SHIP-TIME-MM-REDF 24740000
247500     ELSE                                                         24750000
247600         MOVE ZEROS                  TO PW-HOLD-SHIP-TIME-HH-REDF 24760000
247700         MOVE ZEROS                  TO PW-HOLD-SHIP-TIME-MM-REDF 24770000
247800     END-IF.                                                      24780000
247900                                                                  24790000
248000     MOVE PW-HOLD-SHIP-TIME-REDF     TO PW-SAVE-SHIP-TIME.        24800000
248100                                                                  24810000
248200     EVALUATE TRUE                                                24820000
248300       WHEN SN001I-DTM01-DTE-QUAL-CDE = '011'                     24830000
248400         MOVE SN001I-DTM02-DTE   TO PW-DATE-YYMMDD                24840000
248500                                    PW-HOLD-SHIP-DTE              24850000
248600         IF PW-DATE-YY > 90                                       24860000
248700             MOVE PC-POS-19      TO PW-HOLD-SHIP-DTE-CC           24870000
248800         ELSE                                                     24880000
248900             MOVE PC-POS-20      TO PW-HOLD-SHIP-DTE-CC           24890000
249000         END-IF                                                   24900000
249100         MOVE PW-DATE-YY         TO PW-HOLD-SHIP-DTE-YY           24910000
249200         MOVE PW-DATE-MM         TO PW-HOLD-SHIP-DTE-MM           24920000
249300         MOVE PW-DATE-DD         TO PW-HOLD-SHIP-DTE-DD           24930000
249400       WHEN SN001I-DTM01-DTE-QUAL-CDE = '067'                     24940000
249500         MOVE SN001I-DTM02-DTE   TO PW-DATE-YYMMDD                24950000
249600                                    PW-HOLD-SCHD-SHIP-DTE         24960000
249700         IF PW-DATE-YY > 90                                       24970000
249800             MOVE PC-POS-19      TO PW-HOLD-SCHD-SHIP-DTE-CC      24980000
249900         ELSE                                                     24990000
250000             MOVE PC-POS-20      TO PW-HOLD-SCHD-SHIP-DTE-CC      25000000
250100         END-IF                                                   25010000
250200         MOVE PW-DATE-YY         TO PW-HOLD-SCHD-SHIP-DTE-YY      25020000
250300         MOVE PW-DATE-MM         TO PW-HOLD-SCHD-SHIP-DTE-MM      25030000
250400         MOVE PW-DATE-DD         TO PW-HOLD-SCHD-SHIP-DTE-DD      25040000
250500       WHEN SN001I-DTM01-DTE-QUAL-CDE = '068'                     25050000
250600         MOVE SN001I-DTM02-DTE   TO PW-DATE-YYMMDD                25060000
250700                                    PW-HOLD-ANTC-DELY-DTE         25070000
250800         IF PW-DATE-YY > 90                                       25080000
250900             MOVE PC-POS-19      TO PW-HOLD-ANTC-DELY-DTE-CC      25090000
251000         ELSE                                                     25100000
251100             MOVE PC-POS-20      TO PW-HOLD-ANTC-DELY-DTE-CC      25110000
251200         END-IF                                                   25120000
251300         MOVE PW-DATE-YY         TO PW-HOLD-ANTC-DELY-DTE-YY      25130000
251400         MOVE PW-DATE-MM         TO PW-HOLD-ANTC-DELY-DTE-MM      25140000
251500         MOVE PW-DATE-DD         TO PW-HOLD-ANTC-DELY-DTE-DD      25150000
251600       WHEN OTHER                                                 25160000
251700         CONTINUE                                                 25170000
251800     END-EVALUATE.                                                25180000
251900/                                                                 25190000
252000***************************************************************** 25200000
252100*     SAVE FOB FIELDS                                           * 25210000
252200*                                                               * 25220000
252300*     -  SAVE SHIPMENT LEVEL FOB RECORD FIELDS IN THE ASNHDR    * 25230000
252400*        RECORD IN WS                                           * 25240000
252500***************************************************************** 25250000
252600 C700-SAVE-FOB-FIELDS.                                            25260000
252700     MOVE 'C700-SAVE-FOB-FIELDS           '                       25270000
252800                                 TO PW-CURRENT-PARA.              25280000
252900*    DISPLAY 'C700-SAVE-FOB-FIELDS'.                              25290000
253000                                                                  25300000
253100     MOVE SN001I-FOB01-SHIP-PAYT-TRM-CDE                          25310000
253200                                 TO PW-ASNHDR-SHIP-PAYT-TERM-CDE. 25320000
253300     MOVE SN001I-FOB02-RESPBL-LOC-CDE                             25330000
253400                                 TO PW-ASNHDR-RESPBL-LOC-CDE.     25340000
253500     MOVE SN001I-FOB03-RESPBL-LOC-DESC                            25350000
253600                               TO PW-ASNHDR-RESPBL-LOC-DESC.      25360000
253700/                                                                 25370000
253800***************************************************************** 25380000
253900*     COMPLETE SHIPMENT                                         * 25390000
254000*                                                               * 25400000
254100*     -  SET THE ASNHDR NULL FIELD INDICATORS                   * 25410000
254200*     -  INSERT THE ASNHDR RECORD                               * 25420000
254300*     -  PROCESS THE NAME AND ADDRESS LINES                     * 25430000
254400***************************************************************** 25440000
254500 D000-COMPLETE-SHIPMENT.                                          25450000
254600     MOVE 'D000-COMPLETE-SHIPMENT           '                     25460000
254700                                 TO PW-CURRENT-PARA.              25470000
254800*    DISPLAY 'D000-COMPLETE-SHIPMENT'.                            25480000
254900                                                                  25490000
255000     IF CC-PARM-TEST                                              25500000
255100         MOVE PC-REC-MTHD-IND-TEST TO PW-ASNHDR-REC-MTHD-IND      25510000
255200     ELSE                                                         25520000
255300         MOVE PC-REC-MTHD-IND-PROD TO PW-ASNHDR-REC-MTHD-IND      25530000
255400     END-IF.                                                      25540000
255500                                                                  25550000
255600     PERFORM X110-SET-NULLS-ASNHDR.                               25560000
255700     PERFORM Z110-SQL-INSERT-ASNHDR.                              25570000
255800                                                                  25580000
255900     IF DUPLICATE-SHIPMENT OR PS-BAD-ASN                          25590000
256000         CONTINUE                                                 25600000
256100     ELSE                                                         25610000
256200         PERFORM A150-GENERATE-ASNHDR-ID                          25620000
256300         SET SHIPMENT-COMPLETE       TO TRUE                      25630000
256400                                                                  25640000
256500*CHG107105 - START                                                25650000
256600         PERFORM Z120-SQL-INSERT-ASNPKG                           25660000
256700           VARYING PW-SUB FROM 1 BY 1                             25670000
256800           UNTIL PW-SUB > PW-ASNPKG-SUB                           25680000
256900              OR PS-BAD-ASN                                       25690000
257000                                                                  25700000
257100         IF PS-BAD-ASN                                            25710000
257200            CONTINUE                                              25720000
257300         ELSE                                                     25730000
257400*CHG107105 - END                                                  25740000
257500            PERFORM UNTIL END-OF-INP01                            25750000
257600                       OR ID-IDENTIFICATION-REC                   25760000
257700                       OR HL-HIERARCHICAL-REC                     25770000
257800                PERFORM D100-INITIALIZE                           25780000
257900                PERFORM UNTIL END-OF-INP01                        25790000
258000                           OR ID-IDENTIFICATION-REC               25800000
258100                           OR HL-HIERARCHICAL-REC                 25810000
258200                           OR NEW-N1-REC                          25820000
258300*************************************************************     25830000
258400*************** D000-COMPLETE-SHIPMENT **********************     25840000
258500*************************************************************     25850000
258600                    EVALUATE TRUE                                 25860000
258700                      WHEN N1-NAME-REC                            25870000
258800                        PERFORM S100-SAVE-N1-FIELDS               25880000
258900                      WHEN N2-ADDITIONAL-NAME-REC                 25890000
259000                        PERFORM S200-SAVE-N2-FIELDS               25900000
259100                      WHEN N3-ADDRESS-REC                         25910000
259200                        PERFORM S300-SAVE-N3-FIELDS               25920000
259300                      WHEN N4-GEOGRAPHIC-LOC-REC                  25930000
259400                        SET PS-SHIPMENT TO TRUE                   25940000
259500                        PERFORM S400-SAVE-N4-FIELDS               25950000
259600                      WHEN OTHER                                  25960000
259700                          MOVE PW-ASNHDR-NBR                      25970000
259800                                        TO PSRL-ASNHDR-NBR        25980000
259810                          MOVE PW-HOLD-VEND-DUNNS-NBR             25981000
259820                                        TO PSRL-DUNNS-NBR         25982000
259830                          MOVE PW-HOLD-VENDOR-NAME                25983000
259840                                        TO PSRL-VENDOR-NAME       25984000
259850                          MOVE PW-HOLD-ISA-CNTL-NBR               25985000
259860                                        TO PSRL-ISA-NBR           25986000
259870                          MOVE PSRL-REPORT-LINE-1                 25987000
259880                                        TO PW-ADV-SHIP-NOTICE-LINE25988000
259890                          PERFORM Z510-WRITE-REPORT-LINE          25989000
259900                          MOVE MSG-1S   TO PSRL-RPT-LINE-2        25990000
260000                          MOVE PSRL-REPORT-LINE-2                 26000000
260100                                        TO PW-ADV-SHIP-NOTICE-LINE26010000
260200                          PERFORM Z500-WRITE-REPORT-LINE          26020000
260300                          MOVE ADVANCE-SHIP-NOTICE-DTL-RECORD     26030000
260400                                        TO MSG-1B-DTL             26040000
260500                          MOVE MSG-1B   TO PSRL-RPT-LINE-2        26050000
260600                          MOVE PSRL-REPORT-LINE-2                 26060000
260700                                        TO PW-ADV-SHIP-NOTICE-LINE26070000
260800                          PERFORM Z500-WRITE-REPORT-LINE          26080000
260900                    END-EVALUATE                                  26090000
261000                                                                  26100000
261100                    PERFORM Z000-READ-ADV-SHIP-NOTICE             26110000
261200                                                                  26120000
261300                    IF N1-NAME-REC                                26130000
261400                        SET NEW-N1-REC                            26140000
261500                                    TO TRUE                       26150000
261600                    END-IF                                        26160000
261700                                                                  26170000
261800                    IF ID-IDENTIFICATION-REC                      26180000
261900                        SET END-OF-ISA                            26190000
262000                                    TO TRUE                       26200000
262100                    END-IF                                        26210000
262200                                                                  26220000
262300                END-PERFORM                                       26230000
262400                                                                  26240000
262500                IF N1-FOUND                                       26250000
262600                    PERFORM X130-SET-NULLS-ASHADR                 26260000
262700                    PERFORM Z130-SQL-INSERT-ASHADR                26270000
262800                    IF N2-FOUND                                   26280000
262900                        PERFORM Z140-SQL-INSERT-ASHANM            26290000
263000                          VARYING PW-SUB FROM 1 BY 1              26300000
263100                          UNTIL PW-SUB > PW-NAME-SUB              26310000
263200                    END-IF                                        26320000
263300                    IF N3-FOUND                                   26330000
263400                        PERFORM Z150-SQL-INSERT-ASHADT            26340000
263500                          VARYING PW-SUB FROM 1 BY 1              26350000
263600                          UNTIL PW-SUB > PW-ADDR-SUB              26360000
263700                    END-IF                                        26370000
263800                END-IF                                            26380000
263900                                                                  26390000
264000            END-PERFORM                                           26400000
264100                                                                  26410000
264200*CHG107105 - START                                                26420000
264300         END-IF                                                   26430000
264400                                                                  26440000
264500*CHG107105 - END                                                  26450000
264600     END-IF.                                                      26460000
264700/                                                                 26470000
264800***************************************************************** 26480000
264900*     INITIALIZE                                                * 26490000
265000*                                                               * 26500000
265100*     -  INITIALIZE NAME AND ADDRESS WS SWITCHES AND HOLD FIELDS* 26510000
265200***************************************************************** 26520000
265300 D100-INITIALIZE.                                                 26530000
265400     MOVE 'D100-INITIALIZE                '                       26540000
265500                                 TO PW-CURRENT-PARA.              26550000
265600*    DISPLAY 'D100-INITIALIZE'.                                   26560000
265700                                                                  26570000
265800     SET OLD-N1-REC              TO TRUE.                         26580000
265900     SET N1-NOT-FOUND            TO TRUE.                         26590000
266000     SET N2-NOT-FOUND            TO TRUE.                         26600000
266100     SET N3-NOT-FOUND            TO TRUE.                         26610000
266200     SET N4-NOT-FOUND            TO TRUE.                         26620000
266300                                                                  26630000
266400     MOVE ZEROES                 TO PW-NAME-SUB.                  26640000
266500     MOVE ZEROES                 TO PW-ADDR-SUB.                  26650000
266600                                                                  26660000
266700     INITIALIZE PW-ADDITIONAL-NAME-TABLE.                         26670000
266800     INITIALIZE PW-ADDITIONAL-ADDRESS-TABLE.                      26680000
266900     INITIALIZE PW-HOLD-CTY-NAME.                                 26690000
267000     INITIALIZE PW-HOLD-ST-CDE.                                   26700000
267100     INITIALIZE PW-HOLD-CNTRY-CDE.                                26710000
267200     INITIALIZE PW-HOLD-ZIP-CDE.                                  26720000
267300/                                                                 26730000
267400***************************************************************** 26740000
267500*     PROCESS ORDER                                             * 26750000
267600*                                                               * 26760000
267700*     -  CREATE TEMPORARY ASNORD RECORD IN WS, THIS IS          * 26770000
267800*        BECAUSE IT TAKES MULTIPLE ADVANCE SHIP NOTICE          * 26780000
267900*        RECORDS TO COMPLETE IT.                                * 26790000
268000***************************************************************** 26800000
268100 E000-PROCESS-ORDER.                                              26810000
268200     MOVE 'E000-PROCESS-ORDER             '                       26820000
268300                                 TO PW-CURRENT-PARA.              26830000
268400*    DISPLAY 'E000-PROCESS-ORDER'.                                26840000
268500                                                                  26850000
268600     EVALUATE TRUE                                                26860000
268700                                                                  26870000
268800       WHEN PRF-PURCHASE-ORDER-REF-REC                            26880000
268900         PERFORM E100-SAVE-PRF-FIELDS                             26890000
269000                                                                  26900000
269100       WHEN TD1-CARRIER-QTY-WGHT-REC                              26910000
269200         PERFORM C210-SAVE-TD1-FIELDS                             26920000
269300                                                                  26930000
269400       WHEN TD5-CARRIER-RTE-TRNST-REC                             26940000
269500         PERFORM E200-SAVE-TD5-FIELDS                             26950000
269600                                                                  26960000
269700       WHEN REF-REFERENCE-NUMBERS-REC                             26970000
269800         PERFORM E300-SAVE-REF-FIELDS                             26980000
269900                                                                  26990000
270000       WHEN OTHER                                                 27000000
270100         MOVE PW-ASNHDR-NBR          TO PSRL-ASNHDR-NBR           27010000
270200         MOVE PW-HOLD-VEND-DUNNS-NBR TO PSRL-DUNNS-NBR            27020000
270300         MOVE PW-HOLD-VENDOR-NAME    TO PSRL-VENDOR-NAME          27030000
270400         MOVE PW-HOLD-ISA-CNTL-NBR                                27040000
270500                                     TO PSRL-ISA-NBR              27050000
270600         MOVE PSRL-REPORT-LINE-1     TO PW-ADV-SHIP-NOTICE-LINE   27060000
270700         PERFORM Z510-WRITE-REPORT-LINE                           27070000
270800         MOVE MSG-1O                 TO PSRL-RPT-LINE-2           27080000
270900         MOVE PSRL-REPORT-LINE-2     TO PW-ADV-SHIP-NOTICE-LINE   27090000
271000         PERFORM Z500-WRITE-REPORT-LINE                           27100000
271100         MOVE ADVANCE-SHIP-NOTICE-DTL-RECORD                      27110000
271200                                     TO MSG-1B-DTL                27120000
271300         MOVE MSG-1B                 TO PSRL-RPT-LINE-2           27130000
271400         MOVE PSRL-REPORT-LINE-2     TO PW-ADV-SHIP-NOTICE-LINE   27140000
271500         PERFORM Z500-WRITE-REPORT-LINE                           27150000
271600     END-EVALUATE.                                                27160000
271700                                                                  27170000
271800     IF PS-BAD-ASN                                                27180000
271900         CONTINUE                                                 27190000
272000     ELSE                                                         27200000
272100         PERFORM Z000-READ-ADV-SHIP-NOTICE                        27210000
272200                                                                  27220000
272300         IF ID-IDENTIFICATION-REC                                 27230000
272400             SET END-OF-ISA          TO TRUE                      27240000
272500         END-IF                                                   27250000
272600     END-IF.                                                      27260000
272700/                                                                 27270000
272800***************************************************************** 27280000
272900*     SAVE PRF FIELDS                                           * 27290000
273000*                                                               * 27300000
273100*     -  SAVE ORDER LEVEL PRF RECORD FIELDS IN THE ASNORD       * 27310000
273200*        RECORD IN WS                                           * 27320000
273300***************************************************************** 27330000
273400 E100-SAVE-PRF-FIELDS.                                            27340000
273500     MOVE 'E100-SAVE-PRF-FIELDS           '                       27350000
273600                                 TO PW-CURRENT-PARA.              27360000
273700*    DISPLAY 'E100-SAVE-PRF-FIELDS'.                              27370000
273800                                                                  27380000
273900     SET PRF-FOUND               TO TRUE.                         27390000
274000                                                                  27400000
274100     MOVE SPACES                    TO PW-ASNORD-PO-NBR.          27410000
274200     IF PW-HOLD-EDI-VEND-ID  =  PC-AMC-EDI-VEND-ID                27420000
274300        MOVE SN001I-PRF01-PO-NBR    TO PW-ASNORD-VEND-ORD-NBR     27430000
274400                                                                  27440000
274500     ELSE                                                         27450000
274600        MOVE SN001I-PRF01-PO-NBR    TO PW-ASNORD-PO-NBR           27460000
274700                                                                  27470000
274800     END-IF.                                                      27480000
274900                                                                  27490000
275000     IF NO-DUNNS-NBR                                              27500000
275100         MOVE SN001I-PRF01-PO-NBR (1:21) TO DP010I-UNEDITED-FIELD 27510000
275200*PS 11/07/2014 CHANGE STARTS                                      27520000
275300         MOVE 8                          TO DP010I-MAXIMUM-DIGITS 27530000
275400*PS 11/07/2014 CHANGE ENDS                                        27540000
275500         MOVE ZERO                   TO DP010I-MAXIMUM-DECIMALS   27550000
275600         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  27560000
275710         CALL DP010I-NUMERIC-EDIT-ROUTINE                         27571001
275720              USING DP010I-NUMERIC-EDIT-AREA                      27572001
275800         IF DP010I-ERROR-DETECTED                                 27580000
275900             MOVE ZERO           TO PW-PO-NBR-N                   27590000
276000         ELSE                                                     27600000
276100             MOVE DP010I-NUMERIC-FIELD                            27610000
276200                                 TO PW-PO-NBR-N                   27620000
276300         END-IF                                                   27630000
276400         MOVE PW-PO-NBR-N        TO PW-HOST-PO-NBR                27640000
276500         PERFORM E150-RETRIEVE-DUNNS-NBR                          27650000
276600         MOVE EXTENT-DUN-NBR        TO PW-DUNNS-NBR               27660000
276700         MOVE PW-EDI-VENDOR         TO PW-HOLD-EDI-VEND-ID        27670000
276800         PERFORM U100-UPDATE-ASNHDR                               27680000
276900     END-IF.                                                      27690000
277000                                                                  27700000
277100     IF PS-BAD-ASN                                                27710000
277200         CONTINUE                                                 27720000
277300     ELSE                                                         27730000
277400         MOVE SN001I-PRF03-PO-SEQ-NBR                             27740000
277500                                 TO PW-ASNORD-CHG-ORD-SEQ-NBR     27750000
277600         IF SN001I-PRF04-PO-DTE = ZEROES OR PS-VERSION-4010       27760000
277700             MOVE ZEROES          TO PW-DATE-YYMMDD               27770000
277800                                     PW-HOLD-PO-DTE               27780000
277900         ELSE                                                     27790000
278000             MOVE SN001I-PRF04-PO-DTE TO PW-DATE-YYMMDD           27800000
278100                                         PW-HOLD-PO-DTE           27810000
278200         END-IF                                                   27820000
278300                                                                  27830000
278400         IF PW-DATE-YY > 90                                       27840000
278500             MOVE PC-POS-19          TO PW-HOLD-PO-DTE-CC         27850000
278600         ELSE                                                     27860000
278700             MOVE PC-POS-20          TO PW-HOLD-PO-DTE-CC         27870000
278800         END-IF                                                   27880000
278900         MOVE PW-DATE-YY             TO PW-HOLD-PO-DTE-YY         27890000
279000         MOVE PW-DATE-MM             TO PW-HOLD-PO-DTE-MM         27900000
279100         MOVE PW-DATE-DD             TO PW-HOLD-PO-DTE-DD         27910000
279200     END-IF.                                                      27920000
279300     SET NOT-PREPACK-PO TO TRUE.                                  27930000
279400     MOVE SN001I-PRF01-PO-NBR (1:21) TO DP010I-UNEDITED-FIELD.    27940000
279500     PERFORM K925-GET-PO-NUMERIC.                                 27950000
279600     PERFORM K850-CHECK-PREPACK.                                  27960000
279700     IF PREPACK-PO                                                27970000
279800        INITIALIZE WS-PACK-INVALID-TABLE                          27980000
279900        INITIALIZE WS-PACK-TABLE                                  27990000
280000        MOVE SPACES TO ASN-LOG-REC                                28000000
280100        MOVE 'INITIALIZE PACK TABLE' TO ASN-LOG-REC               28010000
280200        WRITE ASN-LOG-REC                                         28020000
280210        ADD 1 TO PV-ASN-ERROR-LOG-COUNT                           28021005
280300     END-IF.                                                      28030000
280400                                                                  28040000
280500***************************************************************** 28050000
280600*     RETRIEVE DUNNS NUMBER WHEN IT IS NOT TRANSMITTED ON THE   * 28060000
280700*     EDI FILE                                                  * 28070000
280800***************************************************************** 28080000
280900 E150-RETRIEVE-DUNNS-NBR.                                         28090000
281000                                                                  28100000
281100     PERFORM                                                      28110000
281200       WITH TEST AFTER                                            28120000
281300       VARYING PW-RETRY-COUNTER FROM 1 BY 1                       28130000
281400       UNTIL   PW-RETRY-COUNTER > PC-MAX-RETRIES  OR              28140000
281500               SQLCODE = ZERO  OR                                 28150000
281600               SQLCODE = +100                                     28160000
281700                                                                  28170000
281800         EXEC SQL                                                 28180000
281900             SELECT DUN_NBR                                       28190000
282000             INTO  :EXTENT-DUN-NBR                                28200000
282100             FROM TPURCHS A,                                      28210000
282200                  TEXTENT B                                       28220000
282300             WHERE A.PO_NBR = :PW-HOST-PO-NBR                     28230000
282400               AND A.VER_STATUS_CDE = 'A'                         28240000
282500               AND A.ENT_ID = B.ENT_ID                            28250000
282600             WITH UR                                              28260000
282700         END-EXEC                                                 28270000
282800                                                                  28280000
282900         EVALUATE TRUE                                            28290000
283000           WHEN SQLCODE = ZERO                                    28300000
283100           WHEN SQLCODE = PC-NEG-904                              28310000
283200           WHEN SQLCODE = PC-NEG-913                              28320000
283300                 CONTINUE                                         28330000
283400                                                                  28340000
283500           WHEN SQLCODE = +100                                    28350000
283600                MOVE SPACES TO EXTENT-DUN-NBR                     28360000
283700                                                                  28370000
283800           WHEN OTHER                                             28380000
283900                 DISPLAY '**************************************' 28390000
284000                 DISPLAY 'ERROR ISSUED ON SELECT OF TEXTENT     ' 28400000
284100                 DISPLAY 'PW-HOST-PO-NBR:      '                  28410000
284200                          PW-HOST-PO-NBR                          28420000
284300                 DISPLAY '**************************************' 28430000
284400                 PERFORM Z900-SQL-ERROR                           28440000
284500                                                                  28450000
284600         END-EVALUATE                                             28460000
284700                                                                  28470000
284800     END-PERFORM.                                                 28480000
284900                                                                  28490000
285000     EVALUATE TRUE                                                28500000
285100       WHEN SQLCODE = ZERO                                        28510000
285200       WHEN SQLCODE = +100                                        28520000
285300         SET DUNNS-NBR TO TRUE                                    28530000
285400       WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                    28540000
285500             DISPLAY '******************************************' 28550000
285600             DISPLAY 'WARNING ISSUED ON SELECT OF TEXTENT       ' 28560000
285700             DISPLAY 'PW-HOST-PO-NBR:          '                  28570000
285800                      PW-HOST-PO-NBR                              28580000
285900             DISPLAY '******************************************' 28590000
286000             PERFORM Z800-SQL-WARNING                             28600000
286100                                                                  28610000
286200       WHEN  SQLCODE < ZERO                                       28620000
286300             DISPLAY '******************************************' 28630000
286400             DISPLAY 'ERROR ISSUED ON SELECT OF TEXTENT         ' 28640000
286500             DISPLAY 'PW-HOST-PO-NBR:          '                  28650000
286600                      PW-HOST-PO-NBR                              28660000
286700             DISPLAY '******************************************' 28670000
286800             PERFORM Z900-SQL-ERROR                               28680000
286900                                                                  28690000
287000     END-EVALUATE.                                                28700000
287100/                                                                 28710000
287200***************************************************************** 28720000
287300*     SAVE TD5 FIELDS                                           * 28730000
287400*                                                               * 28740000
287500*     -  SAVE ORDER LEVEL TD5 RECORD FIELDS IN THE ASNORD       * 28750000
287600*        RECORD IN WS                                           * 28760000
287700***************************************************************** 28770000
287800 E200-SAVE-TD5-FIELDS.                                            28780000
287900     MOVE 'E200-SAVE-TD5-FIELDS           '                       28790000
288000                                 TO PW-CURRENT-PARA.              28800000
288100*    DISPLAY 'E200-SAVE-TD5-FIELDS'.                              28810000
288200                                                                  28820000
288300     IF SN001I-TD505-CARR-NME = 'X'                               28830000
288400         MOVE SN001I-TD506-STATUS-CDE                             28840000
288500                                 TO PW-ASNORD-ORD-STATUS-CDE      28850000
288600     END-IF.                                                      28860000
288700/                                                                 28870000
288800***************************************************************** 28880000
288900*     SAVE REF FIELDS                                           * 28890000
289000*                                                               * 28900000
289100*     -  SAVE ORDER LEVEL REF RECORD FIELDS IN THE ASNORD       * 28910000
289200*        RECORD IN WS                                           * 28920000
289300***************************************************************** 28930000
289400 E300-SAVE-REF-FIELDS.                                            28940000
289500     MOVE 'E300-SAVE-REF-FIELDS           '                       28950000
289600                                 TO PW-CURRENT-PARA.              28960000
289700*    DISPLAY 'E300-SAVE-REF-FIELDS'.                              28970000
289800                                                                  28980000
289900     EVALUATE TRUE                                                28990000
290000                                                                  29000000
290100       WHEN SN001I-REF01-NBR-QUAL-CDE = 'DP'                      29010000
290200         IF SN001I-REF02-NBR (6:1) = SPACE                        29020000
290300             IF SN001I-REF02-NBR (5:1) = SPACE                    29030000
290400                 IF SN001I-REF02-NBR (4:1) = SPACE                29040000
290500                     MOVE SN001I-REF02-NBR (1:3)                  29050000
290600                                 TO DP010I-UNEDITED-FIELD         29060000
290700                 ELSE                                             29070000
290800                     MOVE SN001I-REF02-NBR (2:3)                  29080000
290900                                 TO DP010I-UNEDITED-FIELD         29090000
291000                 END-IF                                           29100000
291100             ELSE                                                 29110000
291200                 MOVE SN001I-REF02-NBR (3:3)                      29120000
291300                             TO DP010I-UNEDITED-FIELD             29130000
291400             END-IF                                               29140000
291500         ELSE                                                     29150000
291600             MOVE SN001I-REF02-NBR (4:3)                          29160000
291700                         TO DP010I-UNEDITED-FIELD                 29170000
291800         END-IF                                                   29180000
291900         MOVE PC-POS-3           TO DP010I-MAXIMUM-DIGITS         29190000
292000         MOVE ZERO               TO DP010I-MAXIMUM-DECIMALS       29200000
292100         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  29210000
292210         CALL DP010I-NUMERIC-EDIT-ROUTINE                         29221001
292220              USING DP010I-NUMERIC-EDIT-AREA                      29222001
292300         IF DP010I-ERROR-DETECTED                                 29230000
292400             MOVE SPACES         TO PW-ASNORD-MDSEDP-NBR          29240000
292500         ELSE                                                     29250000
292600             MOVE DP010I-NUMERIC-FIELD                            29260000
292700                                 TO PW-NUMERIC-MDSEDP-NBR         29270000
292800             MOVE PW-NUMERIC-MDSEDP-NBR                           29280000
292900                                 TO PW-ASNORD-MDSEDP-NBR          29290000
293000         END-IF                                                   29300000
293100                                                                  29310000
293200       WHEN SN001I-REF01-NBR-QUAL-CDE = 'IT'                      29320000
293300         MOVE SN001I-REF02-NBR   TO PW-ASNORD-CUST-NBR            29330000
293400                                                                  29340000
293500       WHEN SN001I-REF01-NBR-QUAL-CDE = 'PD'                      29350000
293600         MOVE SN001I-REF02-NBR   TO PW-ASNORD-PROMO-NBR           29360000
293700                                                                  29370000
293800       WHEN SN001I-REF01-NBR-QUAL-CDE = 'IV'                      29380000
293900         MOVE SN001I-REF02-NBR   TO PW-ASNORD-SELR-INV-NBR        29390000
294000                                                                  29400000
294100       WHEN SN001I-REF01-NBR-QUAL-CDE = 'IA'                      29410000
294200         MOVE SN001I-REF02-NBR   TO PW-VEND-NO                    29420000
294300         MOVE PW-VEND-NO-1-3     TO DP010I-UNEDITED-FIELD         29430000
294400         MOVE PC-POS-3           TO DP010I-MAXIMUM-DIGITS         29440000
294500         MOVE ZERO               TO DP010I-MAXIMUM-DECIMALS       29450000
294600         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  29460000
294710         CALL DP010I-NUMERIC-EDIT-ROUTINE                         29471001
294720              USING DP010I-NUMERIC-EDIT-AREA                      29472001
294800         IF DP010I-ERROR-DETECTED                                 29480000
294900             MOVE ZEROS          TO PW-NUMERIC-VEND-NO            29490000
295000         ELSE                                                     29500000
295100             MOVE DP010I-NUMERIC-FIELD                            29510000
295200                                 TO PW-NUMERIC-VEND-NO            29520000
295300         END-IF                                                   29530000
295400         MOVE PW-NUMERIC-VEND-NO TO PW-ASNORD-VEND-NBR            29540000
295500                                                                  29550000
295600       WHEN SN001I-REF01-NBR-QUAL-CDE = 'VN'                      29560000
295700         MOVE SN001I-REF02-NBR   TO PW-ASNORD-VEND-ORD-NBR        29570000
295800                                                                  29580000
295900       WHEN SN001I-REF01-NBR-QUAL-CDE = 'CO'                      29590000
296000         MOVE SN001I-REF02-NBR   TO PW-ASNORD-PO-NBR              29600000
296100                                                                  29610000
296200     END-EVALUATE.                                                29620000
296300/                                                                 29630000
296400***************************************************************** 29640000
296500*     COMPLETE ORDER                                            * 29650000
296600*                                                               * 29660000
296700*     -  SET THE ASNORD NULL FIELD INDICATORS                   * 29670000
296800*     -  INSERT THE ASNORD RECORD                               * 29680000
296900*     -  PROCESS THE NAME AND ADDRESS LINES                     * 29690000
297000*     -  THE CURRENCY RECORD FOLLOWS THE ORDER NAME AND ADDRESS * 29700000
297100*        LINES, IF IT EXISTS UPDATE THE ASNORD RECORD.          * 29710000
297200***************************************************************** 29720000
297300 F000-COMPLETE-ORDER.                                             29730000
297400     MOVE 'F000-COMPLETE-ORDER            '                       29740000
297500                                 TO PW-CURRENT-PARA.              29750000
297600*    DISPLAY 'F000-COMPLETE-ORDER'.                               29760000
297700                                                                  29770000
297800     IF  PW-ASNORD-PO-NBR   = SPACES  AND                         29780000
297900         PW-HOLD-EDI-VEND-ID  =  PC-AMC-EDI-VEND-ID               29790000
298000                                                                  29800000
298100          PERFORM  Z400-GET-KOHLS-PO-NBR                          29810000
298200                                                                  29820000
298300          IF SQLCODE = ZERO                                       29830000
298400             MOVE PURCHS-PO-NBR TO PW-ASN-PO-NBR9                 29840000
298500             MOVE PW-ASN-PO-NBR9(4:7) TO PW-ASNORD-PO-NBR         29850000
298600          ELSE                                                    29860000
298700             STRING 'AMC' DELIMITED BY SIZE                       29870000
298800                     PW-ASNORD-VEND-ORD-NBR   DELIMITED BY SIZE   29880000
298900             INTO    PW-ASNORD-PO-NBR                             29890000
299000          END-IF                                                  29900000
299100                                                                  29910000
299200     END-IF.                                                      29920000
299300                                                                  29930000
299400     INITIALIZE PW-NUMERIC-SEQ-NBR.                               29940000
299500                                                                  29950000
299600     IF  N1-NAME-REC                                              29960000
299700     AND SN001I-N101-ID-CDE = 'BY'                                29970000
299800     AND SN001I-N103-NME-ID-QUAL-CDE = '92'                       29980000
299900         PERFORM F050-INSPECT-NAME-ID-CODE                        29990000
300000         MOVE PW-NUMERIC-SEQ-NBR TO PW-ASNORD-LOC-NBR             30000000
300100*        ADD +1                  TO PW-SEQ-NBR                    30010000
300200*        MOVE PW-SEQ-NBR         TO PW-ASNORD-SEQ-NBR             30020000
300300                                                                  30030000
300400         SET ASNORD-STR-NMBR     TO TRUE                          30040000
300500     ELSE                                                         30050000
300600*        ADD +1                  TO PW-SEQ-NBR                    30060000
300700*        MOVE PW-SEQ-NBR         TO PW-ASNORD-SEQ-NBR             30070000
300800         SET ASNORD-SEQ-NMBR     TO TRUE                          30080000
300900     END-IF.                                                      30090000
301000                                                                  30100000
301100     IF PW-PO-NBR (1) = SPACES                                    30110000
301200         MOVE PW-ASNORD-PO-NBR  TO PW-PO-NBR (1)                  30120000
301300         MOVE +1                TO PW-SEQ-NBR (1)                 30130000
301400                                   PW-ASNORD-SEQ-NBR              30140000
301500         SET PS-CHK-EXIST-LOC-NBR-NO                              30150000
301600             PS-MSG-1G-NO           TO TRUE                       30160000
301700     ELSE                                                         30170000
301800     PERFORM                                                      30180000
301900        WITH TEST AFTER                                           30190000
302000        VARYING PW-PO-SEQ-SUB                                     30200000
302100           FROM 1 BY 1                                            30210000
302200             UNTIL PW-PO-NBR (PW-PO-SEQ-SUB) = PW-ASNORD-PO-NBR   30220000
302300                OR PW-PO-NBR (PW-PO-SEQ-SUB) = SPACES             30230000
302400                OR PW-PO-SEQ-SUB > +200                           30240000
302500         IF PW-PO-NBR (PW-PO-SEQ-SUB) = PW-ASNORD-PO-NBR          30250000
302600             ADD +1                 TO PW-SEQ-NBR (PW-PO-SEQ-SUB) 30260000
302700             MOVE PW-SEQ-NBR (PW-PO-SEQ-SUB)                      30270000
302800                                    TO PW-ASNORD-SEQ-NBR          30280000
302900         ELSE                                                     30290000
303000         IF PW-PO-NBR (PW-PO-SEQ-SUB) = SPACES                    30300000
303100             MOVE PW-ASNORD-PO-NBR  TO PW-PO-NBR (PW-PO-SEQ-SUB)  30310000
303200             MOVE +1                TO PW-SEQ-NBR (PW-PO-SEQ-SUB) 30320000
303300                                       PW-ASNORD-SEQ-NBR          30330000
303400             SET PS-CHK-EXIST-LOC-NBR-NO                          30340000
303500                 PS-MSG-1G-NO       TO TRUE                       30350000
303600         ELSE                                                     30360000
303700         IF PW-PO-SEQ-SUB > +200                                  30370000
303800             ADD +1                 TO PW-SEQ-NBR (200)           30380000
303900             MOVE PW-SEQ-NBR (200)  TO PW-ASNORD-SEQ-NBR          30390000
304000         END-IF                                                   30400000
304100         END-IF                                                   30410000
304200         END-IF                                                   30420000
304300     END-PERFORM                                                  30430000
304400     END-IF.                                                      30440000
304500                                                                  30450000
304600     PERFORM X160-SET-NULLS-ASNORD.                               30460000
304700     PERFORM Z160-SQL-INSERT-ASNORD.                              30470000
304800** THE FOLLOWING IS FOR TESTING                                   30480000
304900*    MOVE PW-RETRY-CNT TO PW-RETRY-CNT-9                          30490000
305000*    MOVE SQLCODE TO SQLCODE2                                     30500000
305100*    MOVE PW-ASNORD-SEQ-NBR TO PW-DISPLAY-SEQ-NBR                 30510000
305200*    DISPLAY '**  TEST ' PW-ASNORD-PO-NBR PW-DISPLAY-SEQ-NBR ' '  30520000
305300*                  SQLCODE2                                       30530000
305400** END OF TEST                                                    30540000
305500     SET ORDER-COMPLETE          TO TRUE.                         30550000
305600                                                                  30560000
305700     IF SQLCODE = PC-NEG-803                                      30570000
305800                                                                  30580000
305900* * *  DID WE 'WRAP AROUND'?  DID WE EXCEED SEQ NBR 999           30590000
306000* * *                         AND GO TO ZERO?                     30600000
306100         IF PW-ASNORD-SEQ-NBR = 1                                 30610000
306200             PERFORM Z161-CHK-ASNORD-SEQ-NBR-ZERO                 30620000
306300             IF SQLCODE = ZERO                                    30630000
306400                 SET PS-CHK-EXIST-LOC-NBR-YES                     30640000
306500                                     TO TRUE                      30650000
306600             END-IF                                               30660000
306700         END-IF                                                   30670000
306800* * *  IF WE DID 'WRAP AROUND', ARE WE NOW DROPPING STORES?       30680000
306900         IF PS-CHK-EXIST-LOC-NBR-YES                              30690000
307000             PERFORM Z162-CHK-EXIST-LOC-NBR                       30700000
307100             IF SQLCODE = ZERO                                    30710000
307200                 SET PS-MSG-1G-NO    TO TRUE                      30720000
307300             ELSE                                                 30730000
307400                 SET PS-MSG-1G-YES   TO TRUE                      30740000
307500             END-IF                                               30750000
307600         ELSE                                                     30760000
307700             SET PS-MSG-1G-NO        TO TRUE                      30770000
307800         END-IF                                                   30780000
307900                                                                  30790000
308000         MOVE PW-ASNHDR-NBR          TO PSRL-ASNHDR-NBR           30800000
308100         MOVE PW-HOLD-VEND-DUNNS-NBR TO PSRL-DUNNS-NBR            30810000
308200         MOVE PW-HOLD-VENDOR-NAME    TO PSRL-VENDOR-NAME          30820000
308300         MOVE PW-HOLD-ISA-CNTL-NBR                                30830000
308400                                     TO PSRL-ISA-NBR              30840000
308500         MOVE PSRL-REPORT-LINE-1     TO PW-ADV-SHIP-NOTICE-LINE   30850000
308600         PERFORM Z510-WRITE-REPORT-LINE                           30860000
308700         IF PS-MSG-1G-YES                                         30870000
308800             MOVE PW-ASNORD-LOC-NBR  TO MSG-1G-STORE-NBR          30880000
308900             MOVE PW-ASNORD-PO-NBR   TO MSG-1G-PO-NBR             30890000
309000             MOVE MSG-1G             TO PSRL-RPT-LINE-2           30900000
309100         ELSE                                                     30910000
309200             MOVE PW-ASNORD-LOC-NBR  TO MSG-1F-STORE-NBR          30920000
309300             MOVE PW-ASNORD-PO-NBR   TO MSG-1F-PO-NBR             30930000
309400             MOVE MSG-1F             TO PSRL-RPT-LINE-2           30940000
309500         END-IF                                                   30950000
309600         MOVE PSRL-REPORT-LINE-2     TO PW-ADV-SHIP-NOTICE-LINE   30960000
309700         PERFORM Z500-WRITE-REPORT-LINE                           30970000
309800******CHANGE*******                                               30980000
309900         PERFORM Z000-READ-ADV-SHIP-NOTICE                        30990000
310000            UNTIL END-OF-INP01                                    31000000
310100               OR ID-IDENTIFICATION-REC                           31010000
310200               OR HL-HIERARCHICAL-REC                             31020000
310300******CHANGE*******                                               31030000
310400     END-IF.                                                      31040000
310500                                                                  31050000
310600     PERFORM UNTIL END-OF-INP01                                   31060000
310700                OR ID-IDENTIFICATION-REC                          31070000
310800                OR HL-HIERARCHICAL-REC                            31080000
310900                OR CUR-CURRENCY-REC                               31090000
311000                                                                  31100000
311100         PERFORM F100-INITIALIZE                                  31110000
311200                                                                  31120000
311300         PERFORM UNTIL END-OF-INP01                               31130000
311400                    OR ID-IDENTIFICATION-REC                      31140000
311500                    OR HL-HIERARCHICAL-REC                        31150000
311600                    OR CUR-CURRENCY-REC                           31160000
311700                    OR NEW-N1-REC                                 31170000
311800                                                                  31180000
311900****************************************************************  31190000
312000************* F000-COMPLETE-ORDER ******************************  31200000
312100****************************************************************  31210000
312200             EVALUATE TRUE                                        31220000
312300               WHEN N1-NAME-REC                                   31230000
312400                 PERFORM S100-SAVE-N1-FIELDS                      31240000
312500               WHEN N2-ADDITIONAL-NAME-REC                        31250000
312600                 PERFORM S200-SAVE-N2-FIELDS                      31260000
312700               WHEN N3-ADDRESS-REC                                31270000
312800                 PERFORM S300-SAVE-N3-FIELDS                      31280000
312900               WHEN N4-GEOGRAPHIC-LOC-REC                         31290000
313000                 SET PS-ORDER TO TRUE                             31300000
313100                 PERFORM S400-SAVE-N4-FIELDS                      31310000
313200               WHEN OTHER                                         31320000
313300                   MOVE PW-ASNHDR-NBR                             31330000
313400                                     TO PSRL-ASNHDR-NBR           31340000
313500                   MOVE PW-HOLD-VEND-DUNNS-NBR                    31350000
313600                                     TO PSRL-DUNNS-NBR            31360000
313700                   MOVE PW-HOLD-VENDOR-NAME                       31370000
313800                                     TO PSRL-VENDOR-NAME          31380000
313900                   MOVE PW-HOLD-ISA-CNTL-NBR                      31390000
314000                                            TO PSRL-ISA-NBR       31400000
314100                   MOVE PSRL-REPORT-LINE-1                        31410000
314200                                     TO PW-ADV-SHIP-NOTICE-LINE   31420000
314300                   PERFORM Z510-WRITE-REPORT-LINE                 31430000
314400                   MOVE MSG-1O       TO PSRL-RPT-LINE-2           31440000
314500                   MOVE PSRL-REPORT-LINE-2                        31450000
314600                                     TO PW-ADV-SHIP-NOTICE-LINE   31460000
314700                   PERFORM Z500-WRITE-REPORT-LINE                 31470000
314800                   MOVE ADVANCE-SHIP-NOTICE-DTL-RECORD            31480000
314900                                     TO MSG-1B-DTL                31490000
315000                   MOVE MSG-1B       TO PSRL-RPT-LINE-2           31500000
315100                   MOVE PSRL-REPORT-LINE-2                        31510000
315200                                     TO PW-ADV-SHIP-NOTICE-LINE   31520000
315300                   PERFORM Z500-WRITE-REPORT-LINE                 31530000
315400             END-EVALUATE                                         31540000
315500                                                                  31550000
315600             PERFORM Z000-READ-ADV-SHIP-NOTICE                    31560000
315700                                                                  31570000
315800             IF N1-NAME-REC                                       31580000
315900                 SET NEW-N1-REC  TO TRUE                          31590000
316000             END-IF                                               31600000
316100                                                                  31610000
316200             IF ID-IDENTIFICATION-REC                             31620000
316300                 SET END-OF-ISA  TO TRUE                          31630000
316400             END-IF                                               31640000
316500                                                                  31650000
316600         END-PERFORM                                              31660000
316700                                                                  31670000
316800         IF N1-FOUND                                              31680000
316900             PERFORM X170-SET-NULLS-ASOADR                        31690000
317000             PERFORM Z170-SQL-INSERT-ASOADR                       31700000
317100             IF N2-FOUND                                          31710000
317200                 PERFORM Z180-SQL-INSERT-ASOANM                   31720000
317300                   VARYING PW-SUB FROM 1 BY 1                     31730000
317400                   UNTIL PW-SUB > PW-NAME-SUB                     31740000
317500             END-IF                                               31750000
317600             IF N3-FOUND                                          31760000
317700                 PERFORM Z190-SQL-INSERT-ASOADT                   31770000
317800                   VARYING PW-SUB FROM 1 BY 1                     31780000
317900                   UNTIL PW-SUB > PW-ADDR-SUB                     31790000
318000             END-IF                                               31800000
318100         END-IF                                                   31810000
318200                                                                  31820000
318300     END-PERFORM.                                                 31830000
318400                                                                  31840000
318500     IF CUR-CURRENCY-REC                                          31850000
318600         PERFORM F500-UPDATE-ASNORD                               31860000
318700                                                                  31870000
318800         PERFORM Z000-READ-ADV-SHIP-NOTICE                        31880000
318900                                                                  31890000
319000         IF ID-IDENTIFICATION-REC                                 31900000
319100             SET END-OF-ISA      TO TRUE                          31910000
319200         END-IF                                                   31920000
319300     END-IF.                                                      31930000
319400                                                                  31940000
319500*----------------------------------------------------------------*31950000
319600*    VERIFY THE NAME ID CODE IS IN A VALID DC/STORE NUMBER       *31960000
319700*    FORMAT.                                                     *31970000
319800*                                                                *31980000
319900*    VALID FORMATS                          INVALID FORMATS      *31990000
320000*    -------------                          ---------------      *32000000
320100*    85,085,0085,00085,_85, ETC             8500, 85 0, DC085    *32010000
320200*----------------------------------------------------------------*32020000
320300                                                                  32030000
320400 F050-INSPECT-NAME-ID-CODE.                                       32040000
320500                                                                  32050000
320600     MOVE SPACES             TO PV-NAME-ID-CDE                    32060000
320700                                PV-NAME-ID-OUT-CDE.               32070000
320800     MOVE ZEROES             TO PV-ID-CTR                         32080000
320900                                PV-STR-NBR-CTR                    32090000
321000                                PV-OUT-CTR.                       32100000
321100     SET PS-NO-BUILD-NAME-ID-CDE TO TRUE.                         32110000
321200     SET PS-VALID-NAME-ID-CDE     TO TRUE.                        32120000
321300                                                                  32130000
321400     MOVE SN001I-N104-NME-ID-CDE  TO PV-NAME-ID-CDE.              32140000
321500                                                                  32150000
321600     INSPECT PV-NAME-ID-CDE                                       32160000
321700         REPLACING LEADING SPACES                                 32170000
321800             BY '0'.                                              32180000
321900                                                                  32190000
322000     PERFORM                                                      32200000
322100         VARYING PV-ID-CTR                                        32210000
322200         FROM 1 BY 1                                              32220000
322300         UNTIL PV-ID-CTR > 17 OR                                  32230000
322400               PS-INVALID-NAME-ID-CDE                             32240000
322500                                                                  32250000
322600         IF PV-NAME-ID-CHAR (PV-ID-CTR) < ZEROES AND              32260000
322700            PV-NAME-ID-CHAR (PV-ID-CTR) NOT = SPACES              32270000
322800             SET PS-INVALID-NAME-ID-CDE TO TRUE                   32280000
322900         ELSE                                                     32290000
323000             IF PV-NAME-ID-CHAR (PV-ID-CTR) > 0 OR                32300000
323100                PS-BUILD-NAME-ID-CDE                              32310000
323200                 SET PS-BUILD-NAME-ID-CDE TO TRUE                 32320000
323300                 ADD 1 TO PV-STR-NBR-CTR                          32330000
323400                 IF PV-STR-NBR-CTR > 4                            32340000
323500                     IF PV-NAME-ID-CHAR (PV-ID-CTR) = SPACES      32350000
323600                         CONTINUE                                 32360000
323700                     ELSE                                         32370000
323800                         SET PS-INVALID-NAME-ID-CDE TO TRUE       32380000
323900                     END-IF                                       32390000
324000                 ELSE                                             32400000
324100                     ADD 1 TO PV-OUT-CTR                          32410000
324200                     MOVE PV-NAME-ID-CHAR (PV-ID-CTR) TO          32420000
324300                          PV-NAME-ID-OUT (PV-OUT-CTR)             32430000
324400                 END-IF                                           32440000
324500             END-IF                                               32450000
324600         END-IF                                                   32460000
324700     END-PERFORM.                                                 32470000
324800                                                                  32480000
324900     IF PS-INVALID-NAME-ID-CDE OR PS-NO-BUILD-NAME-ID-CDE         32490000
325000         MOVE ZEROES TO PW-NUMERIC-SEQ-NBR                        32500000
325100     ELSE                                                         32510000
325200         MOVE PV-NAME-ID-CDE TO DP010I-UNEDITED-FIELD             32520000
325300         MOVE 5 TO DP010I-MAXIMUM-DIGITS                          32530000
325400         MOVE 0 TO DP010I-MAXIMUM-DECIMALS                        32540000
325500         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  32550000
325610         CALL DP010I-NUMERIC-EDIT-ROUTINE                         32561001
325620              USING DP010I-NUMERIC-EDIT-AREA                      32562001
325700         IF DP010I-ERROR-DETECTED                                 32570000
325800             MOVE ZEROES TO PW-NUMERIC-SEQ-NBR                    32580000
325900         ELSE                                                     32590000
326000             MOVE DP010I-NUMERIC-FIELD TO PW-NUMERIC-SEQ-NBR      32600000
326100         END-IF                                                   32610000
326200     END-IF.                                                      32620000
326300                                                                  32630000
326400/                                                                 32640000
326500***************************************************************** 32650000
326600*     INITIALIZE                                                * 32660000
326700*                                                               * 32670000
326800*     -  INITIALIZE NAME AND ADDRESS WS SWITCHES AND HOLD FIELDS* 32680000
326900***************************************************************** 32690000
327000 F100-INITIALIZE.                                                 32700000
327100     MOVE 'F100-INITIALIZE                '                       32710000
327200                                 TO PW-CURRENT-PARA.              32720000
327300*    DISPLAY 'F100-INITIALIZE'.                                   32730000
327400                                                                  32740000
327500     SET OLD-N1-REC              TO TRUE.                         32750000
327600     SET N1-NOT-FOUND            TO TRUE.                         32760000
327700     SET N2-NOT-FOUND            TO TRUE.                         32770000
327800     SET N3-NOT-FOUND            TO TRUE.                         32780000
327900     SET N4-NOT-FOUND            TO TRUE.                         32790000
328000                                                                  32800000
328100     MOVE ZEROES                 TO PW-NAME-SUB.                  32810000
328200     MOVE ZEROES                 TO PW-ADDR-SUB.                  32820000
328300                                                                  32830000
328400     INITIALIZE PW-ADDITIONAL-NAME-TABLE.                         32840000
328500     INITIALIZE PW-ADDITIONAL-ADDRESS-TABLE.                      32850000
328600     INITIALIZE PW-HOLD-CTY-NAME.                                 32860000
328700     INITIALIZE PW-HOLD-ST-CDE.                                   32870000
328800     INITIALIZE PW-HOLD-CNTRY-CDE.                                32880000
328900     INITIALIZE PW-HOLD-ZIP-CDE.                                  32890000
329000/                                                                 32900000
329100***************************************************************** 32910000
329200*     UPDATE ASNORD                                             * 32920000
329300*                                                               * 32930000
329400*     -  THIS PROCESS WILL UPDATE THE EXCHANGE FACTOR AND THE   * 32940000
329500*        SELLER CURRENCY CDE ON THE ASNORD TABLE.               * 32950000
329600***************************************************************** 32960000
329700 F500-UPDATE-ASNORD.                                              32970000
329800     MOVE 'F500-UPDATE-ASNODR             '                       32980000
329900                                 TO PW-CURRENT-PARA.              32990000
330000*    DISPLAY 'F500-UPDATE-ASNODR'.                                33000000
330100                                                                  33010000
330200     IF  SN001I-CUR01-ID-CDE   = 'BY'                             33020000
330300     AND SN001I-CUR02-CURR-CDE = 'USD'                            33030000
330400     AND SN001I-CUR04-ID-CDE   = 'SE'                             33040000
330500         MOVE SN001I-CUR03-EXCH-FCTR                              33050000
330600                                 TO PW-ASNORD-EXCH-FCTR           33060000
330700         MOVE SN001I-CUR05-CURR-CDE                               33070000
330800                                 TO PW-ASNORD-SELR-CUR-CDE        33080000
330900         PERFORM Z320-SQL-UPDATE-ASNORD                           33090000
331000     END-IF.                                                      33100000
331100                                                                  33110000
331200/                                                                 33120000
331300***************************************************************** 33130000
331400*     PROCESS PICK PACK                                         * 33140000
331500*                                                               * 33150000
331600*     -  INITIALIZE WS HOLD FIELDS                              * 33160000
331700*     -  FORMAT ASNCAR WS RECORD                                * 33170000
331800*     -  SET THE ASNCAR NULL FIELD INDICATORS                   * 33180000
331900*     -  INSERT THE ASNCAR RECORD                               * 33190000
332000*     -  PROCESS ALL THE ASNDTL RECORDS FOR THIS CARTON         * 33200000
332100*          INITIALIZE WS HOLD FIELDS                            * 33210000
332200*          FORMAT ASNDTL WS RECORD                              * 33220000
332300*          SET THE ASNDTL NULL FIELD INDICATORS                 * 33230000
332400*          INSERT THE ASNDTL RECORD                             * 33240000
332500***************************************************************** 33250000
332600 G000-PROCESS-PICK-PACK.                                          33260000
332700     MOVE 'G000-PROCESS-PICK-PACK         '                       33270000
332800                                 TO PW-CURRENT-PARA.              33280000
332900*    DISPLAY 'G000-PROCESS-PICK-PACK'.                            33290000
333000                                                                  33300000
333100     PERFORM L100-INIT-ASNCAR-REC.                                33310000
333200     PERFORM L200-INIT-ASNDTL-REC.                                33320000
333300     PERFORM L300-INIT-LIN-TABLE.                                 33330000
333400                                                                  33340000
333500     PERFORM J000-FORMAT-ASNCAR                                   33350000
333600       UNTIL ID-IDENTIFICATION-REC                                33360000
333700             OR HL-HIERARCHICAL-REC                               33370000
333800             OR END-OF-INP01.                                     33380000
333900                                                                  33390000
334000     IF  HL-HIERARCHICAL-REC                                      33400000
334100     AND ITEM-LEVEL                                               33410000
334200                                                                  33420000
334300         IF MAN-NOT-FOUND                                         33430000
334400             ADD +1              TO PW-KOHLS-ASNCAR-CNT           33440000
334500             MOVE PW-KOHLS-ASNCAR-NBR                             33450000
334600                                 TO PW-ASNCAR-ASNCAR-NBR          33460000
334700         END-IF                                                   33470000
334800                                                                  33480000
334900         PERFORM X200-SET-NULLS-ASNCAR                            33490000
335000                                                                  33500000
335100         MOVE PW-ASNORD-PO-NBR  TO DP010I-UNEDITED-FIELD          33510000
335200         PERFORM K925-GET-PO-NUMERIC                              33520000
335300         PERFORM K850-CHECK-PREPACK                               33530000
335400                                                                  33540000
335500         IF PREPACK-PO                                            33550000
335600            CONTINUE                                              33560000
335700         ELSE                                                     33570000
335800            PERFORM Z200-SQL-INSERT-ASNCAR                        33580000
335900         END-IF                                                   33590000
336000         SET NO-COMPONENT-SENT TO TRUE                            33600000
336100                                                                  33610000
336200         PERFORM                                                  33620000
336300           UNTIL (HL-HIERARCHICAL-REC AND NOT ITEM-LEVEL)         33630000
336400              OR ID-IDENTIFICATION-REC                            33640000
336500              OR END-OF-INP01                                     33650000
336600              OR PS-BAD-ASN                                       33660000
336700                                                                  33670000
336800             PERFORM L200-INIT-ASNDTL-REC                         33680000
336900             PERFORM L300-INIT-LIN-TABLE                          33690000
337000                                                                  33700000
337100             PERFORM Z000-READ-ADV-SHIP-NOTICE                    33710000
337200                                                                  33720000
337300             IF ID-IDENTIFICATION-REC                             33730000
337400                 SET END-OF-ISA  TO TRUE                          33740000
337500             END-IF                                               33750000
337600                                                                  33760000
337700             MOVE 'I' TO WS-CURR-UPC-TYPE                         33770000
337800                                                                  33780000
337900             PERFORM K000-FORMAT-ASNDTL                           33790000
338000               UNTIL HL-HIERARCHICAL-REC                          33800000
338100                  OR ID-IDENTIFICATION-REC                        33810000
338200                  OR END-OF-INP01                                 33820000
338300             IF PACK-UPC                                          33830000
338400                PERFORM K815-CHECK-IF-PACK-BUILT                  33840000
338500                IF PACK-FOUND                                     33850000
338600                   CONTINUE                                       33860000
338700                ELSE                                              33870000
338800                   PERFORM K805-FIND-LAST-PACK                    33880000
338900                   MOVE PW-ASNORD-PO-NBR  TO DP010I-UNEDITED-FIELD33890000
339000                   PERFORM K925-GET-PO-NUMERIC                    33900000
339100                   MOVE PW-PO-NBR-N TO POPRPK-PO-NBR              33910000
339200******             MOVE PW-ASNDTL-UPC-NBR TO XLT00009-UPC-NBR     33920000
339300                   MOVE PW-ASNDTL-UPC-NBR TO POPRPK-PREPK-UPC-NBR 33930000
339400                   PERFORM K803-COUNT-COMPONENTS                  33940000
339500                   PERFORM K810-BUILD-PACK                        33950000
339600                END-IF                                            33960000
339700             END-IF                                               33970000
339800             IF PREPACK-PO                                        33980000
339900                MOVE PW-ASNCAR-ASNCAR-NBR TO LOG-CARTON           33990000
340000                MOVE SPACES TO ASN-LOG-REC                        34000000
340100                MOVE LOG-MESSAGE-3 TO ASN-LOG-REC                 34010000
340200                WRITE ASN-LOG-REC                                 34020000
340210                ADD 1 TO PV-ASN-ERROR-LOG-COUNT                   34021005
340300                PERFORM K803-COUNT-COMPONENTS                     34030000
340400                IF PACK-UPC                                       34040000
340500                   PERFORM K802-COUNT-PACK-COMPONENTS             34050000
340600                   PERFORM K902-COMPARE                           34060000
340700                END-IF                                            34070000
340800                IF PW-ASNDTL-PKG-QTY > 0                          34080000
340900                   IF PW-ASNDTL-SHIPT-QTY = PW-ASNDTL-PKG-QTY     34090000
341000                      MOVE PW-ASNDTL-PKG-QTY TO WS-SHIPT-QTY      34100000
341100                   ELSE                                           34110000
341200                      MOVE PW-ASNDTL-SHIPT-QTY TO WS-SHIPT-QTY    34120000
341300                   END-IF                                         34130000
341400                ELSE                                              34140000
341500                   MOVE PW-ASNDTL-SHIPT-QTY TO WS-SHIPT-QTY       34150000
341600                END-IF                                            34160000
341700                IF PACK-UPC AND WS-COMPONENTS <= 0                34170000
341800                   PERFORM                                        34180000
341900                      VARYING WS-SUB2 FROM 1 BY 1                 34190000
342000                      UNTIL WS-SUB2 > 1000 OR                     34200000
342100                        WS-PACK-LN-UPC(WS-CURR-PACK, WS-SUB2) <= 034210000
342200                         COMPUTE PW-ASNDTL-SHIPT-QTY =            34220000
342300                         WS-SHIPT-QTY *                           34230000
342400                         WS-PACK-LN-RATIO(WS-CURR-PACK, WS-SUB2)  34240000
342500                         END-COMPUTE                              34250000
342600                         MOVE                                     34260000
342700                         WS-PACK-LN-UPC(WS-CURR-PACK, WS-SUB2) TO 34270000
342800                         PW-ASNDTL-UPC-NBR                        34280000
342900                         MOVE WS-PACK-ID(WS-CURR-PACK) TO         34290000
343000                         PW-ASNDTL-ITM-SUBST-UPC-NBR              34300000
343100                         MOVE PW-ASNORD-PO-NBR  TO                34310000
343200                            DP010I-UNEDITED-FIELD                 34320000
343300                         PERFORM K925-GET-PO-NUMERIC              34330000
343400                         MOVE PW-PO-NBR-N TO PURITM-PO-NBR        34340000
343500                         MOVE                                     34350000
343600                            WS-PACK-LN-UPC(WS-CURR-PACK, WS-SUB2) 34360000
343700                            TO XLT00006-UPC-NBR                   34370000
343800                         SET COMPONENT-SENT TO TRUE               34380000
343900                         PERFORM X210-SET-NULLS-ASNDTL            34390000
344000                         PERFORM Z209-CHECK-ASNDTL                34400000
344100                         IF DUPLICATE-DETAIL                      34410000
344200                            SET NOT-DUP-DETAIL TO TRUE            34420000
344300                         ELSE                                     34430000
344400                            PERFORM Z210-SQL-INSERT-ASNDTL        34440000
344500                            PERFORM Z220-SQL-INSERT-ASCRIT        34450000
344600                         END-IF                                   34460000
344700                         ADD +1 TO PW-HOLD-ASNDTL-NBR             34470000
344800                         MOVE PW-PO-NBR-N TO  POPRPK-PO-NBR       34480000
344900                         MOVE WS-PACK-ID(WS-CURR-PACK) TO         34490000
345000                            POPRPK-PO-PREPK-ID                    34500000
345100                         PERFORM K907-GET-PACK-SKU                34510000
345200                         PERFORM K906-FIND                        34520000
345300                         IF PACK-ID-FOUND                         34530000
345400                            CONTINUE                              34540000
345500                         ELSE                                     34550000
345600                            PERFORM K905-FIND-LAST                34560000
345700                            MOVE PW-PO-NBR-N TO                   34570000
345800                               WS-PUB-PO(WS-CURR-ELEMENT)         34580000
345900                            MOVE POPRPK-PK-SKU-NBR TO             34590000
346000                               WS-PUB-SKU(WS-CURR-ELEMENT)        34600000
346100                            MOVE PW-PO-NBR-N TO WS-PUBLISH-PO     34610000
346200                            MOVE POPRPK-PK-SKU-NBR TO             34620000
346300                               WS-PUBLISH-SKU                     34630000
346400                            MOVE POPRPK-PK-SKU-NBR TO             34640000
346500                               LOG-LOCK-SKU                       34650000
346600                            MOVE SPACES TO ASN-LOG-REC            34660000
346700                            MOVE LOG-MESSAGE-4 TO ASN-LOG-REC     34670000
346800                            WRITE ASN-LOG-REC                     34680000
346810                            ADD 1 TO PV-ASN-ERROR-LOG-COUNT       34681005
346900                            MOVE 'ASN PACK RECEIPT    ' TO        34690000
347000                               WS-PUBLISH-LABEL                   34700000
347100                            IF CC-PARM-PROD                       34710000
347200                               PERFORM Z104-INSERT-WFT-LOD-XFER   34720000
347300                               PERFORM Z103-INSERT-WFT-LOD-CNTL   34730000
347400                            END-IF                                34740000
347500                            IF CC-PARM-TEST                       34750000
347600                               DISPLAY '* TEST * '                34760000
347700                                  WS-PUBLISH-MESSAGE              34770000
347800                            END-IF                                34780000
347900                         END-IF                                   34790000
348000                   END-PERFORM                                    34800000
348100                   PERFORM K926-MSG-15PP                          34810000
348200                END-IF                                            34820000
348300                IF NOT-PACK-UPC AND NOT-COMP-UPC AND              34830000
348400                   WS-COMPONENTS <= 0                             34840000
348500                   PERFORM K926-MSG-17PP                          34850000
348600                END-IF                                            34860000
348700                IF NOT-PACK-UPC AND WS-COMPONENTS > 0             34870000
348800                   MOVE 0 TO HOLD-PACK-UPC-NBR                    34880000
348900                   MOVE PW-ASNDTL-UPC-NBR TO                      34890000
349000                      HOLD-PACK-UPC-NBR                           34900000
349100                   PERFORM                                        34910000
349200                      VARYING WS-SUB2 FROM 1 BY 1                 34920000
349300                      UNTIL WS-SUB2 > WS-COMPONENTS OR            34930000
349400                            WS-SUB2 > 1000                        34940000
349500                      COMPUTE PW-ASNDTL-SHIPT-QTY =               34950000
349600                         WS-SHIPT-QTY *                           34960000
349700                         WS-PRPK-RATIO(WS-SUB2)                   34970000
349800                      END-COMPUTE                                 34980000
349900                      MOVE WS-PRPK-COMP-UPC(WS-SUB2) TO           34990000
350000                         PW-ASNDTL-UPC-NBR                        35000000
350100                      IF PW-ASNDTL-ITM-SUBST-UPC-NBR =            35010000
350200                         'SIMPLE--PACK'                           35020000
350300                         CONTINUE                                 35030000
350400                      ELSE                                        35040000
350500                         MOVE WS-PRPK-PACK-ID(WS-SUB2) TO         35050000
350600                            PW-ASNDTL-ITM-SUBST-UPC-NBR           35060000
350700                      END-IF                                      35070000
350800                      MOVE PW-ASNORD-PO-NBR  TO                   35080000
350900                         DP010I-UNEDITED-FIELD                    35090000
351000                      PERFORM K925-GET-PO-NUMERIC                 35100000
351100                      MOVE PW-PO-NBR-N TO PURITM-PO-NBR           35110000
351200                      MOVE PW-PO-NBR-N TO HOLD-COMP-PO-NBR        35120000
351300                      MOVE WS-PRPK-COMP-UPC(WS-SUB2) TO           35130000
351400                         XLT00006-UPC-NBR                         35140000
351500                      MOVE WS-PRPK-COMP-UPC(WS-SUB2) TO           35150000
351600                         HOLD-COMP-UPC-NBR                        35160000
351700                      PERFORM K901-CHK-GOOD-COMP-UPC              35170000
351800                      EVALUATE TRUE                               35180000
351900                         WHEN GOOD-COMP-UPC                       35190000
352000                         WHEN NOT-GOOD-COMP-UPC                   35200000
352100                            SET COMPONENT-SENT TO TRUE            35210000
352200                            IF NOT-GOOD-COMP-UPC                  35220000
352300                               PERFORM K911-FIND-UPC              35230000
352400                               IF PO-COMP-FOUND                   35240000
352500                                  CONTINUE                        35250000
352600                               ELSE                               35260000
352700                                  PERFORM K910-FIND-LAST-UPC      35270000
352800                                  MOVE HOLD-COMP-PO-NBR TO        35280000
352900                                   WS-COMP-PO-UPC                 35290000
353000                                   (WS-CURR-ELEMENT)              35300000
353100                                  MOVE HOLD-COMP-UPC-NBR TO       35310000
353200                                    WS-COMP-COMP-UPC              35320000
353300                                    (WS-CURR-ELEMENT)             35330000
353400                               END-IF                             35340000
353500                              PERFORM K926-MSG-18PP               35350000
353600                              MOVE 'SIMPLE--PACK' TO              35360000
353700                                 PW-ASNDTL-ITM-SUBST-UPC-NBR      35370000
353800                            END-IF                                35380000
353900                            PERFORM X210-SET-NULLS-ASNDTL         35390000
354000                            PERFORM Z209-CHECK-ASNDTL             35400000
354100                            IF DUPLICATE-DETAIL                   35410000
354200                               SET NOT-DUP-DETAIL TO TRUE         35420000
354300                            ELSE                                  35430000
354400                               PERFORM Z210-SQL-INSERT-ASNDTL     35440000
354500                               PERFORM Z220-SQL-INSERT-ASCRIT     35450000
354600                            END-IF                                35460000
354700                            ADD +1 TO PW-HOLD-ASNDTL-NBR          35470000
354800                         WHEN MULT-COMP-UPC                       35480000
354900                            PERFORM K908-FIND-PACK                35490000
355000                            IF PACK-PACK-FOUND                    35500000
355100                               CONTINUE                           35510000
355200                            ELSE                                  35520000
355300                               PERFORM K909-FIND-LAST-PACK        35530000
355400                               MOVE HOLD-PACK-UPC-NBR TO          35540000
355500                                 WS-PACK-PACK-UPC(WS-CURR-ELEMENT)35550000
355600                               MOVE HOLD-COMP-UPC-NBR TO          35560000
355700                                 WS-PACK-COMP-UPC(WS-CURR-ELEMENT)35570000
355800                               PERFORM K926-MSG-16PP              35580000
355900                            END-IF                                35590000
356000                      END-EVALUATE                                35600000
356100                   END-PERFORM                                    35610000
356200*                  PERFORM K904-CHECK-COMPONENT-ERRORS            35620000
356300                END-IF                                            35630000
356400                IF PACK-UPC AND WS-COMPONENTS > 0                 35640000
356500                   PERFORM                                        35650000
356600                      VARYING WS-SUB2 FROM 1 BY 1                 35660000
356700                      UNTIL WS-SUB2 > WS-COMPONENTS OR            35670000
356800                            WS-SUB2 > 1000                        35680000
356900                         COMPUTE PW-ASNDTL-SHIPT-QTY =            35690000
357000                         WS-SHIPT-QTY * WS-PRPK-RATIO(WS-SUB2)    35700000
357100                         END-COMPUTE                              35710000
357200                         MOVE WS-PRPK-COMP-UPC(WS-SUB2) TO        35720000
357300                            PW-ASNDTL-UPC-NBR                     35730000
357400                         IF PW-ASNDTL-ITM-SUBST-UPC-NBR =         35740000
357500                            'SIMPLE--PACK'                        35750000
357600                            CONTINUE                              35760000
357700                         ELSE                                     35770000
357800                            MOVE WS-PRPK-PACK-ID(WS-SUB2) TO      35780000
357900                               PW-ASNDTL-ITM-SUBST-UPC-NBR        35790000
358000                         END-IF                                   35800000
358100                         MOVE PW-ASNORD-PO-NBR  TO                35810000
358200                            DP010I-UNEDITED-FIELD                 35820000
358300                         PERFORM K925-GET-PO-NUMERIC              35830000
358400                         MOVE PW-PO-NBR-N TO PURITM-PO-NBR        35840000
358500                         MOVE WS-PRPK-COMP-UPC(WS-SUB2) TO        35850000
358600                            XLT00006-UPC-NBR                      35860000
358700                         MOVE PW-PO-NBR-N TO HOLD-COMP-PO-NBR     35870000
358800                         MOVE WS-PRPK-COMP-UPC(WS-SUB2) TO        35880000
358900                            HOLD-COMP-UPC-NBR                     35890000
359000                         PERFORM K901-CHK-GOOD-COMP-UPC           35900000
359100                         IF GOOD-COMP-UPC OR MULT-COMP-UPC        35910000
359200                            SET COMPONENT-SENT TO TRUE            35920000
359300                            PERFORM X210-SET-NULLS-ASNDTL         35930000
359400                            PERFORM Z209-CHECK-ASNDTL             35940000
359500                            IF DUPLICATE-DETAIL                   35950000
359600                               SET NOT-DUP-DETAIL TO TRUE         35960000
359700                            ELSE                                  35970000
359800                               PERFORM Z210-SQL-INSERT-ASNDTL     35980000
359900                               PERFORM Z220-SQL-INSERT-ASCRIT     35990000
360000                            END-IF                                36000000
360100                            ADD +1 TO PW-HOLD-ASNDTL-NBR          36010000
360200                            MOVE PW-PO-NBR-N TO  POPRPK-PO-NBR    36020000
360300                            MOVE WS-PRPK-PACK-ID(WS-SUB2) TO      36030000
360400                               POPRPK-PO-PREPK-ID                 36040000
360500                            PERFORM K907-GET-PACK-SKU             36050000
360600                            PERFORM K906-FIND                     36060000
360700                            IF PACK-ID-FOUND                      36070000
360800                               CONTINUE                           36080000
360900                            ELSE                                  36090000
361000                               PERFORM K905-FIND-LAST             36100000
361100                               MOVE PW-PO-NBR-N TO                36110000
361200                                  WS-PUB-PO(WS-CURR-ELEMENT)      36120000
361300                               MOVE POPRPK-PK-SKU-NBR TO          36130000
361400                                  WS-PUB-SKU(WS-CURR-ELEMENT)     36140000
361500                               MOVE PW-PO-NBR-N TO                36150000
361600                                  WS-PUBLISH-PO                   36160000
361700                               MOVE POPRPK-PK-SKU-NBR TO          36170000
361800                                  WS-PUBLISH-SKU                  36180000
361900                               MOVE POPRPK-PK-SKU-NBR TO          36190000
362000                                  LOG-LOCK-SKU                    36200000
362100                               MOVE SPACES TO ASN-LOG-REC         36210000
362200                               MOVE LOG-MESSAGE-4 TO              36220000
362300                                  ASN-LOG-REC                     36230000
362400                               WRITE ASN-LOG-REC                  36240000
362410                               ADD 1 TO PV-ASN-ERROR-LOG-COUNT    36241005
362500                               MOVE 'ASN PACK RECEIPT    ' TO     36250000
362600                                  WS-PUBLISH-LABEL                36260000
362700                               IF CC-PARM-PROD                    36270000
362800                                  PERFORM Z104-INSERT-WFT-LOD-XFER36280000
362900                                  PERFORM Z103-INSERT-WFT-LOD-CNTL36290000
363000                               END-IF                             36300000
363100                               IF CC-PARM-TEST                    36310000
363200                                  DISPLAY '* TEST * '             36320000
363300                                     WS-PUBLISH-MESSAGE           36330000
363400                               END-IF                             36340000
363500                            END-IF                                36350000
363600                         ELSE                                     36360000
363700                            SET COMPONENT-SENT TO TRUE            36370000
363800                            IF NOT-GOOD-COMP-UPC                  36380000
363900                               PERFORM K911-FIND-UPC              36390000
364000                               IF PO-COMP-FOUND                   36400000
364100                                  CONTINUE                        36410000
364200                               ELSE                               36420000
364300                                  PERFORM K910-FIND-LAST-UPC      36430000
364400                                  MOVE HOLD-COMP-PO-NBR TO        36440000
364500                                   WS-COMP-PO-UPC                 36450000
364600                                   (WS-CURR-ELEMENT)              36460000
364700                                  MOVE HOLD-COMP-UPC-NBR TO       36470000
364800                                    WS-COMP-COMP-UPC              36480000
364900                                    (WS-CURR-ELEMENT)             36490000
365000                               END-IF                             36500000
365100                              PERFORM K926-MSG-18PP               36510000
365200                              MOVE 'SIMPLE--PACK' TO              36520000
365300                                 PW-ASNDTL-ITM-SUBST-UPC-NBR      36530000
365400                            END-IF                                36540000
365500                            PERFORM X210-SET-NULLS-ASNDTL         36550000
365600                            PERFORM Z209-CHECK-ASNDTL             36560000
365700                            IF DUPLICATE-DETAIL                   36570000
365800                               SET NOT-DUP-DETAIL TO TRUE         36580000
365900                            ELSE                                  36590000
366000                               PERFORM Z210-SQL-INSERT-ASNDTL     36600000
366100                               PERFORM Z220-SQL-INSERT-ASCRIT     36610000
366200                            END-IF                                36620000
366300                            ADD +1 TO PW-HOLD-ASNDTL-NBR          36630000
366400                         END-IF                                   36640000
366500                   END-PERFORM                                    36650000
366600                   PERFORM K903-CHECK-PACK-ERRORS                 36660000
366700                   PERFORM K904-CHECK-COMPONENT-ERRORS            36670000
366800                END-IF                                            36680000
366900             ELSE                                                 36690000
367000                IF COMPONENT-SENT                                 36700000
367100                   PERFORM Z200-SQL-INSERT-ASNCAR                 36710000
367200                END-IF                                            36720000
367300                PERFORM X210-SET-NULLS-ASNDTL                     36730000
367400                PERFORM Z209-CHECK-ASNDTL                         36740000
367500                IF DUPLICATE-DETAIL                               36750000
367600                   SET NOT-DUP-DETAIL TO TRUE                     36760000
367700                ELSE                                              36770000
367800                   PERFORM Z210-SQL-INSERT-ASNDTL                 36780000
367900                   PERFORM Z220-SQL-INSERT-ASCRIT                 36790000
368000                END-IF                                            36800000
368100                ADD +1 TO PW-HOLD-ASNDTL-NBR                      36810000
368200             END-IF                                               36820000
368300                                                                  36830000
368400             SET ITEM-COMPLETE   TO TRUE                          36840000
368500                                                                  36850000
368600                                                                  36860000
368700                                                                  36870000
368800         END-PERFORM                                              36880000
368900                                                                  36890000
369000         IF COMPONENT-SENT AND PREPACK-PO                         36900000
369100            PERFORM Z200-SQL-INSERT-ASNCAR                        36910000
369200         END-IF                                                   36920000
369300                                                                  36930000
369400     ELSE                                                         36940000
369500     IF  HL-HIERARCHICAL-REC                                      36950000
369600     AND PACK-LEVEL                                               36960000
369700                     SET PS-BAD-ASN TO TRUE                       36970000
369800                     SET END-OF-ISA                               36980000
369900                                  TO TRUE                         36990000
370000                     MOVE PW-ASNHDR-NBR                           37000000
370100                                  TO PSRL-ASNHDR-NBR              37010000
370200                     MOVE PW-HOLD-VEND-DUNNS-NBR                  37020000
370300                                  TO PSRL-DUNNS-NBR               37030000
370400                     MOVE PW-HOLD-VENDOR-NAME                     37040000
370500                                  TO PSRL-VENDOR-NAME             37050000
370600                     MOVE PW-HOLD-ISA-CNTL-NBR                    37060000
370700                                  TO PSRL-ISA-NBR                 37070000
370800                     MOVE PSRL-REPORT-LINE-1                      37080000
370900                                  TO PW-ADV-SHIP-NOTICE-LINE      37090000
371000                     PERFORM Z510-WRITE-REPORT-LINE               37100000
371100                     MOVE PW-ASNORD-PO-NBR                        37110000
371200                                  TO MSG-09-ASNORD-PO-NBR         37120000
371300                     MOVE MSG-09  TO PSRL-RPT-LINE-2              37130000
371400                     MOVE PSRL-REPORT-LINE-2                      37140000
371500                                  TO PW-ADV-SHIP-NOTICE-LINE      37150000
371600                     PERFORM Z500-WRITE-REPORT-LINE               37160000
371700                     EXEC SQL                                     37170000
371800                         ROLLBACK                                 37180000
371900                     END-EXEC                                     37190000
372000                     DISPLAY '*********************'              37200000
372100                     DISPLAY '*  R O L L B A C K  *'              37210000
372200                     DISPLAY '*********************'              37220000
372300                     ADD  1          TO PA-ASNHDR-DELETED         37230000
372400                                                                  37240000
372500     ELSE                                                         37250000
372600                                                                  37260000
372700         PERFORM Z000-READ-ADV-SHIP-NOTICE                        37270000
372800           UNTIL ID-IDENTIFICATION-REC                            37280000
372900              OR END-OF-INP01                                     37290000
373000                                                                  37300000
373100         IF ID-IDENTIFICATION-REC                                 37310000
373200             SET END-OF-ISA      TO TRUE                          37320000
373300         END-IF                                                   37330000
373400                                                                  37340000
373500     END-IF.                                                      37350000
373600                                                                  37360000
373700/                                                                 37370000
373800***************************************************************** 37380000
373900*     PROCESS STD PACK                                          * 37390000
374000*                                                               * 37400000
374100*     -  INITIALIZE WS HOLD FIELDS                              * 37410000
374200*     -  FORMAT ASNDTL WS RECORD                                * 37420000
374300*     -  SET THE ASNDTL NULL FIELD INDICATORS                   * 37430000
374400*     -  INSERT THE ASNDTL RECORD                               * 37440000
374500*     -  PROCESS ALL THE ASNCAR RECORDS FOR THIS CARTON         * 37450000
374600*          INITIALIZE WS HOLD FIELDS                            * 37460000
374700*          FORMAT ASNCAR WS RECORD                              * 37470000
374800*          SET THE ASNCAR NULL FIELD INDICATORS                 * 37480000
374900*          INSERT THE ASNCAR RECORD                             * 37490000
375000***************************************************************** 37500000
375100 H000-PROCESS-STD-PACK.                                           37510000
375200     MOVE 'H000-PROCESS-STD-PACK          '                       37520000
375300                                 TO PW-CURRENT-PARA.              37530000
375400*    DISPLAY 'H000-PROCESS-STD-PACK'.                             37540000
375500                                                                  37550000
375600     SET MAN-NOT-FOUND           TO TRUE.                         37560000
375700                                                                  37570000
375800     PERFORM L100-INIT-ASNCAR-REC.                                37580000
375900     PERFORM L200-INIT-ASNDTL-REC.                                37590000
376000     PERFORM L300-INIT-LIN-TABLE.                                 37600000
376100                                                                  37610000
376200     PERFORM K000-FORMAT-ASNDTL                                   37620000
376300       UNTIL ID-IDENTIFICATION-REC                                37630000
376400             OR HL-HIERARCHICAL-REC                               37640000
376500             OR END-OF-INP01                                      37650000
376600                                                                  37660000
376700     IF  HL-HIERARCHICAL-REC                                      37670000
376800     AND PACK-LEVEL                                               37680000
376900                                                                  37690000
377000         PERFORM X210-SET-NULLS-ASNDTL                            37700000
377100         PERFORM Z210-SQL-INSERT-ASNDTL                           37710000
377200         SET ITEM-COMPLETE       TO TRUE                          37720000
377300                                                                  37730000
377400         PERFORM                                                  37740000
377500           UNTIL (HL-HIERARCHICAL-REC AND NOT PACK-LEVEL)         37750000
377600              OR ID-IDENTIFICATION-REC                            37760000
377700              OR END-OF-INP01                                     37770000
377800              OR PS-BAD-ASN                                       37780000
377900                                                                  37790000
378000             PERFORM L100-INIT-ASNCAR-REC                         37800000
378100             PERFORM Z000-READ-ADV-SHIP-NOTICE                    37810000
378200                                                                  37820000
378300             IF ID-IDENTIFICATION-REC                             37830000
378400                 SET END-OF-ISA  TO TRUE                          37840000
378500             END-IF                                               37850000
378600                                                                  37860000
378700             PERFORM J000-FORMAT-ASNCAR                           37870000
378800               UNTIL HL-HIERARCHICAL-REC                          37880000
378900                  OR ID-IDENTIFICATION-REC                        37890000
379000                  OR END-OF-INP01                                 37900000
379100                                                                  37910000
379200             IF PO4-FOUND                                         37920000
379300                ADD 1 TO PV-PO4-FOUND-CNT                         37930000
379400             ELSE                                                 37940000
379500                ADD 1 TO PV-PO4-NOT-FOUND-CNT                     37950000
379600             END-IF                                               37960000
379700                                                                  37970000
379800             SET PO4-NOT-FOUND TO TRUE                            37980000
379900                                                                  37990000
380000             IF MAN-NOT-FOUND                                     38000000
380100                 ADD +1          TO PW-KOHLS-ASNCAR-CNT           38010000
380200                 MOVE PW-KOHLS-ASNCAR-NBR                         38020000
380300                                 TO PW-ASNCAR-ASNCAR-NBR          38030000
380400             END-IF                                               38040000
380500                                                                  38050000
380600             PERFORM X200-SET-NULLS-ASNCAR                        38060000
380700             PERFORM Z200-SQL-INSERT-ASNCAR                       38070000
380800                                                                  38080000
380900             IF PS-BAD-ASN                                        38090000
381000                 CONTINUE                                         38100000
381100             ELSE                                                 38110000
381200                 PERFORM Z220-SQL-INSERT-ASCRIT                   38120000
381300             END-IF                                               38130000
381400         END-PERFORM                                              38140000
381500                                                                  38150000
381600     ELSE                                                         38160000
381700                                                                  38170000
381800         PERFORM Z000-READ-ADV-SHIP-NOTICE                        38180000
381900           UNTIL ID-IDENTIFICATION-REC                            38190000
382000              OR END-OF-INP01                                     38200000
382100                                                                  38210000
382200         IF ID-IDENTIFICATION-REC                                 38220000
382300             SET END-OF-ISA      TO TRUE                          38230000
382400         END-IF                                                   38240000
382500                                                                  38250000
382600     END-IF.                                                      38260000
382700                                                                  38270000
382800     IF PS-BAD-ASN                                                38280000
382900         CONTINUE                                                 38290000
383000     ELSE                                                         38300000
383100         IF ITEM-COMPLETE                                         38310000
383200             ADD +1              TO PW-HOLD-ASNDTL-NBR            38320000
383300         END-IF                                                   38330000
383400     END-IF.                                                      38340000
383500/                                                                 38350000
383600***************************************************************** 38360000
383700*     PROCESS NO CARTON                                         * 38370000
383800*                                                               * 38380000
383900*     -  INITIALIZE WS HOLD FIELDS                              * 38390000
384000*     -  PROCESS ALL THE ASNDTL RECORDS FOR THIS CARTON         * 38400000
384100*          FORMAT ASNDTL WS RECORD                              * 38410000
384200*          SET THE ASNDTL NULL FIELD INDICATORS                 * 38420000
384300*          INSERT THE ASNDTL RECORD                             * 38430000
384400***************************************************************** 38440000
384500 I000-PROCESS-NO-CARTON.                                          38450000
384600     MOVE 'I000-PROCESS-NO-CARTON         '                       38460000
384700                                 TO PW-CURRENT-PARA.              38470000
384800*    DISPLAY 'I000-PROCESS-NO-CARTON'.                            38480000
384900                                                                  38490000
385000     PERFORM L200-INIT-ASNDTL-REC.                                38500000
385100     PERFORM L300-INIT-LIN-TABLE.                                 38510000
385200                                                                  38520000
385300     PERFORM                                                      38530000
385400       UNTIL (HL-HIERARCHICAL-REC AND NOT ITEM-LEVEL)             38540000
385500          OR ID-IDENTIFICATION-REC                                38550000
385600          OR END-OF-INP01                                         38560000
385700                                                                  38570000
385800         PERFORM L200-INIT-ASNDTL-REC                             38580000
385900         PERFORM L300-INIT-LIN-TABLE                              38590000
386000                                                                  38600000
386100         PERFORM Z000-READ-ADV-SHIP-NOTICE                        38610000
386200                                                                  38620000
386300         PERFORM K000-FORMAT-ASNDTL                               38630000
386400           UNTIL HL-HIERARCHICAL-REC                              38640000
386500              OR ID-IDENTIFICATION-REC                            38650000
386600              OR END-OF-INP01                                     38660000
386700                                                                  38670000
386800         PERFORM X210-SET-NULLS-ASNDTL                            38680000
386900         PERFORM Z210-SQL-INSERT-ASNDTL                           38690000
387000                                                                  38700000
387100         IF (HL-HIERARCHICAL-REC AND PACK-LEVEL)                  38710000
387200         PERFORM Z000-READ-ADV-SHIP-NOTICE                        38720000
387300           UNTIL (HL-HIERARCHICAL-REC AND ORDER-LEVEL)            38730000
387400              OR ID-IDENTIFICATION-REC                            38740000
387500              OR END-OF-INP01                                     38750000
387600         ELSE                                                     38760000
387700              SET ITEM-COMPLETE       TO TRUE                     38770000
387800         END-IF                                                   38780000
387900         ADD +1                  TO PW-HOLD-ASNDTL-NBR            38790000
388000                                                                  38800000
388100     END-PERFORM.                                                 38810000
388200                                                                  38820000
388300     IF ID-IDENTIFICATION-REC                                     38830000
388400         SET END-OF-ISA          TO TRUE                          38840000
388500     END-IF.                                                      38850000
388600                                                                  38860000
388700/                                                                 38870000
388800***************************************************************** 38880000
388900*     FORMAT ASNCAR                                             * 38890000
389000*                                                               * 38900000
389100*     -  CONTROL THE SAVING OF THE ADVANCE SHIP NOTICE RECORDS  * 38910000
389200*        FOR A CARTON.                                          * 38920000
389300***************************************************************** 38930000
389400 J000-FORMAT-ASNCAR.                                              38940000
389500     MOVE 'J000-FORMAT-ASNCAR             '                       38950000
389600                                 TO PW-CURRENT-PARA.              38960000
389700*    DISPLAY 'J000-FORMAT-ASNCAR'.                                38970000
389800                                                                  38980000
389900     EVALUATE TRUE                                                38990000
390000                                                                  39000000
390100       WHEN PO4-ITEM-PHYSICAL-DTL-REC                             39010000
390200         PERFORM J100-SAVE-PO4-FIELDS                             39020000
390300                                                                  39030000
390400       WHEN PKG-MRKG-PCKG-LDG-REC                                 39040000
390500         PERFORM J200-SAVE-PKG-FIELDS                             39050000
390600                                                                  39060000
390700       WHEN MAN-MARKS-NUMBERS-REC                                 39070000
390800         PERFORM J300-SAVE-MAN-FIELDS                             39080000
390900                                                                  39090000
391000       WHEN OTHER                                                 39100000
391100         MOVE PW-ASNHDR-NBR          TO PSRL-ASNHDR-NBR           39110000
391200         MOVE PW-HOLD-VEND-DUNNS-NBR TO PSRL-DUNNS-NBR            39120000
391300         MOVE PW-HOLD-VENDOR-NAME    TO PSRL-VENDOR-NAME          39130000
391400         MOVE PW-HOLD-ISA-CNTL-NBR                                39140000
391500                                     TO PSRL-ISA-NBR              39150000
391600         MOVE PSRL-REPORT-LINE-1     TO PW-ADV-SHIP-NOTICE-LINE   39160000
391700         PERFORM Z510-WRITE-REPORT-LINE                           39170000
391800         MOVE MSG-1P                 TO PSRL-RPT-LINE-2           39180000
391900         MOVE PSRL-REPORT-LINE-2     TO PW-ADV-SHIP-NOTICE-LINE   39190000
392000         PERFORM Z500-WRITE-REPORT-LINE                           39200000
392100         MOVE ADVANCE-SHIP-NOTICE-DTL-RECORD                      39210000
392200                                     TO MSG-1B-DTL                39220000
392300         MOVE MSG-1B                 TO PSRL-RPT-LINE-2           39230000
392400         MOVE PSRL-REPORT-LINE-2     TO PW-ADV-SHIP-NOTICE-LINE   39240000
392500         PERFORM Z500-WRITE-REPORT-LINE                           39250000
392600     END-EVALUATE.                                                39260000
392700                                                                  39270000
392800     PERFORM Z000-READ-ADV-SHIP-NOTICE.                           39280000
392900                                                                  39290000
393000     IF HL-HIERARCHICAL-REC AND SHIPMENT-LEVEL                    39300000
393100         MOVE PW-ASNHDR-NBR       TO PSRL-ASNHDR-NBR              39310000
393200         MOVE PW-HOLD-VEND-DUNNS-NBR                              39320000
393300                                  TO PSRL-DUNNS-NBR               39330000
393400         MOVE PW-HOLD-VENDOR-NAME TO PSRL-VENDOR-NAME             39340000
393500         MOVE PW-HOLD-ISA-CNTL-NBR                                39350000
393600                                  TO PSRL-ISA-NBR                 39360000
393700         MOVE PSRL-REPORT-LINE-1  TO PW-ADV-SHIP-NOTICE-LINE      39370000
393800         PERFORM Z510-WRITE-REPORT-LINE                           39380000
393900         MOVE MSG-07              TO PSRL-RPT-LINE-2              39390000
394000         MOVE PSRL-REPORT-LINE-2  TO PW-ADV-SHIP-NOTICE-LINE      39400000
394100         PERFORM Z500-WRITE-REPORT-LINE                           39410000
394200     END-IF.                                                      39420000
394300                                                                  39430000
394400     IF ID-IDENTIFICATION-REC                                     39440000
394500         SET END-OF-ISA  TO TRUE                                  39450000
394600     END-IF.                                                      39460000
394700                                                                  39470000
394800/                                                                 39480000
394900***************************************************************** 39490000
395000*     SAVE PO4 FIELDS                                           * 39500000
395100*                                                               * 39510000
395200*     -  SAVE CARTON LEVEL PO4 RECORD FIELDS IN THE ASNCAR      * 39520000
395300*        RECORD IN WS                                           * 39530000
395400***************************************************************** 39540000
395500 J100-SAVE-PO4-FIELDS.                                            39550000
395600     MOVE 'J100-SAVE-PO4-FIELDS           '                       39560000
395700                                 TO PW-CURRENT-PARA.              39570000
395800*    DISPLAY 'J100-SAVE-PO4-FIELDS'.                              39580000
395900                                                                  39590000
396000     IF PS-ASN-STRUC-CODE = '0002'                                39600000
396100        IF PS-VERSION-4010                                        39610000
396200            IF SN001I-PO401-PKG-SIZE-QTY EQUAL +0 OR              39620000
396300               SN001I-PO414-INPK-EA-QTY EQUAL ZERO                39630000
396400                MOVE SN001I-PO414-INPK-EA-QTY TO                  39640000
396500                                  PW-ASNCAR-HOLD-INPK-EA-QTY      39650000
396600                MOVE SN001I-PO401-PKG-SIZE-QTY                    39660000
396700                                  TO PW-ASNCAR-PKG-SIZE-QTY       39670000
396800                MOVE SN001I-PO401-PKG-SIZE-QTY                    39680000
396900                                  TO PW-ASNCAR-PKG-QTY            39690000
397000            ELSE                                                  39700000
397100                COMPUTE PW-ASNCAR-COMP-INPK-TOT-QTY =             39710000
397200                        SN001I-PO401-PKG-SIZE-QTY *               39720000
397300                        SN001I-PO414-INPK-EA-QTY                  39730000
397400                MOVE PW-ASNCAR-COMP-INPK-TOT-QTY                  39740000
397500                                         TO PW-ASNCAR-PKG-QTY     39750000
397600                MOVE SN001I-PO414-INPK-EA-QTY TO                  39760000
397700                                      PW-ASNCAR-HOLD-INPK-EA-QTY  39770000
397800                MOVE SN001I-PO401-PKG-SIZE-QTY                    39780000
397900                                        TO PW-ASNCAR-PKG-SIZE-QTY 39790000
398000        ELSE                                                      39800000
398100            MOVE +0                TO  PW-ASNCAR-HOLD-INPK-EA-QTY 39810000
398200            MOVE SN001I-PO401-PKG-SIZE-QTY                        39820000
398300                                        TO PW-ASNCAR-PKG-SIZE-QTY 39830000
398400            MOVE SN001I-PO402-SIZE-MSMT TO PW-ASNCAR-PKG-QTY      39840000
398500        END-IF                                                    39850000
398600     END-IF.                                                      39860000
398700                                                                  39870000
398800     MOVE SN001I-PO403-SIZE-UM-CDE                                39880000
398900                                 TO PW-ASNCAR-PKG-QTY-UM-CDE.     39890000
399000     MOVE SN001I-PO406-GRO-WGHT-MSMT                              39900000
399100                                 TO PW-ASNCAR-WGHT-MSMT.          39910000
399200     MOVE SN001I-PO407-WGHT-UM-CDE                                39920000
399300                                 TO PW-ASNCAR-WGHT-UM-CDE.        39930000
399400     MOVE SN001I-PO408-GRO-VOL-MSMT                               39940000
399500                                 TO PW-ASNCAR-VOL-MSMT.           39950000
399600     MOVE SN001I-PO409-VOL-UM-CDE                                 39960000
399700                                 TO PW-ASNCAR-VOL-UM-CDE.         39970000
399800     MOVE SN001I-PO410-LEN-MSMT  TO PW-ASNCAR-LEN-MSMT.           39980000
399900     MOVE SN001I-PO411-WDTH-MSMT TO PW-ASNCAR-WDTH-MSMT.          39990000
400000     MOVE SN001I-PO412-HT-MSMT   TO PW-ASNCAR-HT-MSMT.            40000000
400100     MOVE SN001I-PO413-UM-CDE    TO PW-ASNCAR-SIZE-UM-CDE.        40010000
400200     SET PO4-FOUND               TO TRUE.                         40020000
400300/                                                                 40030000
400400***************************************************************** 40040000
400500*     SAVE PKG FIELDS                                           * 40050000
400600*                                                               * 40060000
400700*     -  SAVE CARTON LEVEL PKG RECORD FIELDS IN THE ASNCAR      * 40070000
400800*        RECORD IN WS                                           * 40080000
400900***************************************************************** 40090000
401000 J200-SAVE-PKG-FIELDS.                                            40100000
401100     MOVE 'J200-SAVE-PKG-FIELDS             '                     40110000
401200                                 TO PW-CURRENT-PARA.              40120000
401300*    DISPLAY 'J200-SAVE-PKG-FIELDS'.                              40130000
401400                                                                  40140000
401500     IF  SN001I-PKG01-TYP-CDE  = 'S'                              40150000
401600     AND SN001I-PKG02-PKG-CDE  = '36'                             40160000
401700     AND SN001I-PKG03-QUAL-CDE = 'VI'                             40170000
401800         MOVE SN001I-PKG04-DESC-CDE                               40180000
401900                                 TO PW-ASNCAR-PKG-CDE             40190000
402000     END-IF.                                                      40200000
402100/                                                                 40210000
402200***************************************************************** 40220000
402300*     SAVE MAN FIELDS                                           * 40230000
402400*                                                               * 40240000
402500*     -  SAVE CARTON LEVEL MAN RECORD FIELDS IN THE ASNCAR      * 40250000
402600*        RECORD IN WS                                           * 40260000
402700***************************************************************** 40270000
402800 J300-SAVE-MAN-FIELDS.                                            40280000
402900     MOVE 'J300-SAVE-MAN-FIELDS             '                     40290000
403000                                 TO PW-CURRENT-PARA.              40300000
403100*    DISPLAY 'J300-SAVE-MAN-FIELDS'.                              40310000
403200                                                                  40320000
403300     SET MAN-FOUND               TO TRUE.                         40330000
403400     MOVE SN001I-MAN01-NBR-QUAL-CDE                               40340000
403500                                 TO PW-ASNCAR-NBR-QUAL-CDE.       40350000
403600     MOVE SN001I-MAN02-NBR       TO PW-ASNCAR-ASNCAR-NBR.         40360000
403700*                                                                 40370000
403800* DMH 03/07/16 BEGIN (ADDED FOR OUTLET CARRIER TRACKING)          40380000
403900     MOVE SN001I-MAN04-NBR-QUAL-CDE                               40390000
404000                                 TO PW-ASNCAR-NBR-QUAL-CDE-CARR.  40400000
404100     MOVE SN001I-MAN05-NBR       TO PW-ASNCAR-NBR-CARR-TRACKING.  40410000
404200* DMH 03/07/16 END   (ADDED FOR OUTLET CARRIER TRACKING)          40420000
404300*                                                                 40430000
404400/                                                                 40440000
404500***************************************************************** 40450000
404600*     FORMAT ASNDTL                                             * 40460000
404700*                                                               * 40470000
404800*     -  CONTROL THE SAVING OF THE ADVANCE SHIP NOTICE RECORDS  * 40480000
404810*        FOR A ITEM DETAIL.                                     * 40481000
404820***************************************************************** 40482000
404830 K000-FORMAT-ASNDTL.                                              40483000
404840     MOVE 'K000-FORMAT-ASNDTL             '                       40484000
404850                                 TO PW-CURRENT-PARA.              40485000
404860                                                                  40486000
404870*    DISPLAY 'K000-FORMAT-ASNDTL'.                                40487000
404880                                                                  40488000
404890     EVALUATE TRUE                                                40489000
404900                                                                  40490000
405000       WHEN LIN-ITEM-IDENTIFICATION-REC                           40500000
405100         PERFORM K100-SAVE-LIN-FIELDS                             40510000
405200                                                                  40520000
405300       WHEN SN1-ITEM-DETAIL-REC                                   40530000
405400         PERFORM K200-SAVE-SN1-FIELDS                             40540000
405500                                                                  40550000
405600       WHEN SLN-SUBITEM-DETAIL-REC                                40560000
405700         PERFORM K300-SAVE-SLN-FIELDS                             40570000
405800                                                                  40580000
405900       WHEN PO4-ITEM-PHYSICAL-DTL-REC                             40590000
406000         PERFORM K400-SAVE-PO4-FIELDS                             40600000
406100                                                                  40610000
406200       WHEN PKG-MRKG-PCKG-LDG-REC                                 40620000
406300         PERFORM K500-SAVE-PKG-FIELDS                             40630000
406400                                                                  40640000
406500       WHEN TD5-CARRIER-RTE-TRNST-REC                             40650000
406600         PERFORM K600-SAVE-TD5-FIELDS                             40660000
406700                                                                  40670000
406800       WHEN OTHER                                                 40680000
406900         MOVE PW-ASNHDR-NBR          TO PSRL-ASNHDR-NBR           40690000
407000         MOVE PW-HOLD-VEND-DUNNS-NBR TO PSRL-DUNNS-NBR            40700000
407100         MOVE PW-HOLD-VENDOR-NAME    TO PSRL-VENDOR-NAME          40710000
407200         MOVE PW-HOLD-ISA-CNTL-NBR                                40720000
407300                                     TO PSRL-ISA-NBR              40730000
407400         MOVE PSRL-REPORT-LINE-1     TO PW-ADV-SHIP-NOTICE-LINE   40740000
407500         PERFORM Z510-WRITE-REPORT-LINE                           40750000
407600         MOVE MSG-1I                 TO PSRL-RPT-LINE-2           40760000
407700         MOVE PSRL-REPORT-LINE-2     TO PW-ADV-SHIP-NOTICE-LINE   40770000
407800         PERFORM Z500-WRITE-REPORT-LINE                           40780000
407900         MOVE ADVANCE-SHIP-NOTICE-DTL-RECORD                      40790000
408000                                     TO MSG-1B-DTL                40800000
408100         MOVE MSG-1B                 TO PSRL-RPT-LINE-2           40810000
408200         MOVE PSRL-REPORT-LINE-2     TO PW-ADV-SHIP-NOTICE-LINE   40820000
408300         PERFORM Z500-WRITE-REPORT-LINE                           40830000
408400     END-EVALUATE.                                                40840000
408500                                                                  40850000
408600     PERFORM Z000-READ-ADV-SHIP-NOTICE.                           40860000
408700                                                                  40870000
408800     IF HL-HIERARCHICAL-REC AND SHIPMENT-LEVEL                    40880000
408900         MOVE PW-ASNHDR-NBR       TO PSRL-ASNHDR-NBR              40890000
409000         MOVE PW-HOLD-VEND-DUNNS-NBR                              40900000
409100                                  TO PSRL-DUNNS-NBR               40910000
409200         MOVE PW-HOLD-VENDOR-NAME TO PSRL-VENDOR-NAME             40920000
409300         MOVE PW-HOLD-ISA-CNTL-NBR                                40930000
409400                                  TO PSRL-ISA-NBR                 40940000
409500         MOVE PSRL-REPORT-LINE-1  TO PW-ADV-SHIP-NOTICE-LINE      40950000
409600         PERFORM Z510-WRITE-REPORT-LINE                           40960000
409700         MOVE MSG-07              TO PSRL-RPT-LINE-2              40970000
409800         MOVE PSRL-REPORT-LINE-2  TO PW-ADV-SHIP-NOTICE-LINE      40980000
409900         PERFORM Z500-WRITE-REPORT-LINE                           40990000
410000     END-IF.                                                      41000000
410100                                                                  41010000
410200     IF ID-IDENTIFICATION-REC                                     41020000
410300         SET END-OF-ISA  TO TRUE                                  41030000
410400     END-IF.                                                      41040000
410500                                                                  41050000
410600/                                                                 41060000
410700***************************************************************** 41070000
410800*     SAVE LIN FIELDS                                           * 41080000
410900*                                                               * 41090000
411000*     -  SAVE ITEM LEVEL LIN RECORD FIELDS IN WS                * 41100000
411100***************************************************************** 41110000
411200 K100-SAVE-LIN-FIELDS.                                            41120000
411300     MOVE 'K100-SAVE-LIN-FIELDS             '                     41130000
411400                                 TO PW-CURRENT-PARA.              41140000
411500*    DISPLAY 'K100-SAVE-LIN-FIELDS'.                              41150000
411600                                                                  41160000
411700     MOVE PC-POS-1               TO PW-SUB.                       41170000
411800     MOVE ZEROES                 TO PW-LIN-SUB.                   41180000
411900                                                                  41190000
412000     PERFORM                                                      41200000
412100       UNTIL PW-SUB > PC-POS-10                                   41210000
412200          OR SN001I-LIN02-PROD-ID-QUAL-CDE (PW-SUB) = SPACES      41220000
412300                                                                  41230000
412400         IF SN001I-LIN02-PROD-ID-QUAL-CDE (PW-SUB) = 'UP' OR 'EN' 41240000
412500            MOVE SN001I-LIN03-PROD-ID (PW-SUB) TO                 41250000
412600               DP010I-UNEDITED-FIELD                              41260000
412700                                                                  41270000
412800            PERFORM K700-EDIT-FOR-NUMERIC                         41280000
412900                                                                  41290000
413000            IF DP010I-ERROR-DETECTED                              41300000
413100                MOVE PC-Y TO PS-EDIT-ERROR-SW                     41310000
413200            END-IF                                                41320000
413300                                                                  41330000
413400             IF EDIT-ERROR-DETECTED                               41340000
413500                 ADD PC-POS-1    TO PW-LIN-SUB                    41350000
413600                 MOVE SN001I-LIN02-PROD-ID-QUAL-CDE (PW-SUB)      41360000
413700                                 TO PW-LIN-PROD-CDE (PW-LIN-SUB)  41370000
413800                 MOVE SN001I-LIN03-PROD-ID (PW-SUB)               41380000
413900                                 TO PW-LIN-PROD-ID  (PW-LIN-SUB)  41390000
414000             ELSE                                                 41400000
414100                 MOVE PW-UPC-NBR-N TO PW-ASNDTL-UPC-NBR           41410000
414200             END-IF                                               41420000
414300         ELSE                                                     41430000
414400             ADD PC-POS-1        TO PW-LIN-SUB                    41440000
414500             MOVE SN001I-LIN02-PROD-ID-QUAL-CDE (PW-SUB)          41450000
414600                                 TO PW-LIN-PROD-CDE (PW-LIN-SUB)  41460000
414700             MOVE SN001I-LIN03-PROD-ID (PW-SUB)                   41470000
414800                                 TO PW-LIN-PROD-ID  (PW-LIN-SUB)  41480000
414900         END-IF                                                   41490000
415000         ADD PC-POS-1            TO PW-SUB                        41500000
415100     END-PERFORM.                                                 41510000
415200                                                                  41520000
415300     IF PREPACK-PO                                                41530000
415400        MOVE 0 TO WS-SUB1                                         41540000
415500        INITIALIZE WS-PRPK-TABLE                                  41550000
415600        MOVE SPACES TO ASN-LOG-REC                                41560000
415700        MOVE 'INITIALIZE SLN COMP TABLE' TO ASN-LOG-REC           41570000
415800        WRITE ASN-LOG-REC                                         41580000
415810        ADD 1 TO PV-ASN-ERROR-LOG-COUNT                           41581005
415900     END-IF.                                                      41590000
416000                                                                  41600000
416100     MOVE PW-ASNORD-PO-NBR  TO DP010I-UNEDITED-FIELD.             41610000
416200     PERFORM K925-GET-PO-NUMERIC.                                 41620000
416300     PERFORM K850-CHECK-PREPACK.                                  41630000
416400     IF PREPACK-PO                                                41640000
416500        MOVE PW-PO-NBR-N TO POPRPK-PO-NBR                         41650000
416600*       MOVE PW-ASNDTL-UPC-NBR TO XLT00009-UPC-NBR                41660000
416700        MOVE PW-ASNDTL-UPC-NBR TO POPRPK-PREPK-UPC-NBR            41670000
416800        IF PW-ASNDTL-UPC-NBR > 0                                  41680000
416900           PERFORM K800-CHECK-PACK-UPC                            41690000
417000        ELSE                                                      41700000
417100           SET NOT-PACK-UPC TO TRUE                               41710000
417200        END-IF                                                    41720000
417300        IF PACK-UPC                                               41730000
417400           CONTINUE                                               41740000
417500        ELSE                                                      41750000
417600           SET NOT-PACK-UPC TO TRUE                               41760000
417700           MOVE PW-ASNORD-PO-NBR  TO DP010I-UNEDITED-FIELD        41770000
417800           PERFORM K925-GET-PO-NUMERIC                            41780000
417900           MOVE PW-PO-NBR-N TO PURITM-PO-NBR                      41790000
418000           MOVE PW-ASNDTL-UPC-NBR TO XLT00006-UPC-NBR             41800000
418100           IF PW-ASNDTL-UPC-NBR > 0                               41810000
418200              SET NOT-COMP-UPC TO TRUE                            41820000
418300              PERFORM K900-CHECK-COMPONENT-UPC                    41830000
418400           ELSE                                                   41840000
418500              SET COMP-UPC TO TRUE                                41850000
418600           END-IF                                                 41860000
418700           IF COMP-UPC                                            41870000
418800              SET NOT-PREPACK-PO TO TRUE                          41880000
418900              PERFORM K860-CHECK-CARTON                           41890000
419000              MOVE SPACES TO PW-ASNDTL-ITM-SUBST-UPC-NBR          41900000
419100              MOVE 'SIMPLE--PACK' TO                              41910000
419200                 PW-ASNDTL-ITM-SUBST-UPC-NBR                      41920000
419300           ELSE                                                   41930000
419400              MOVE SPACES TO PW-ASNDTL-ITM-SUBST-UPC-NBR          41940000
419500              MOVE 'SIMPLE--PACK' TO PW-ASNDTL-ITM-SUBST-UPC-NBR  41950000
419600           END-IF                                                 41960000
419700        END-IF                                                    41970000
419800     END-IF.                                                      41980000
419900/                                                                 41990000
420000***************************************************************** 42000000
420100*     SAVE SN1 FIELDS                                           * 42010000
420200*                                                               * 42020000
420300*     -  SAVE ITEM LEVEL LIN RECORD FIELDS IN THE ASNDTL        * 42030000
420400*        RECORD IN WS                                           * 42040000
420500***************************************************************** 42050000
420600 K200-SAVE-SN1-FIELDS.                                            42060000
420700     MOVE 'K200-SAVE-SN1-FIELDS             '                     42070000
420800                                 TO PW-CURRENT-PARA.              42080000
420900*    DISPLAY 'K200-SAVE-SN1-FIELDS'.                              42090000
421000                                                                  42100000
421100     MOVE SN001I-SN102-SHIP-QTY  TO PW-ASNDTL-SHIPT-QTY.          42110000
421200     MOVE SN001I-SN103-SHIP-UM-CDE                                42120000
421300                                 TO PW-ASNDTL-SHIPT-UM-CDE.       42130000
421400     MOVE SN001I-SN104-SHIPT-DTE-QTY                              42140000
421500                                 TO PW-ASNDTL-SHIPT-DTE-QTY.      42150000
421600     MOVE SN001I-SN105-ORD-QTY   TO PW-ASNDTL-VEND-ORD-QTY.       42160000
421700     MOVE SN001I-SN106-ORD-UM-CDE                                 42170000
421800                                 TO PW-ASNDTL-ORD-QTY-UM-CDE.     42180000
421900/                                                                 42190000
422000***************************************************************** 42200000
422100*     SAVE SLN FIELDS                                           * 42210000
422200*                                                               * 42220000
422300*     -  SAVE ITEM LEVEL SLN RECORD FIELDS IN THE ASNDTL        * 42230000
422400*        RECORD IN WS                                           * 42240000
422500***************************************************************** 42250000
422600 K300-SAVE-SLN-FIELDS.                                            42260000
422700     MOVE 'K300-SAVE-SLN-FIELDS             '                     42270000
422800                                 TO PW-CURRENT-PARA.              42280000
422900*    DISPLAY 'K300-SAVE-SLN-FIELDS'.                              42290000
423000                                                                  42300000
423100     MOVE PC-POS-1               TO PW-SUB.                       42310000
423200     SET LIN-NOT-EOF             TO TRUE.                         42320000
423300     SET UPC-NOT-FOUND           TO TRUE.                         42330000
423400                                                                  42340000
423500                                                                  42350000
423600     PERFORM                                                      42360000
423700       UNTIL UPC-FOUND                                            42370000
423800          OR LIN-EOF                                              42380000
423900          OR PW-SUB > PC-POS-10                                   42390000
424000         IF SN001I-SLN09-PROD-ID-QUAL-CDE (PW-SUB) = 'UP' OR 'EN' 42400000
424100             IF PREPACK-PO                                        42410000
424200                CONTINUE                                          42420000
424300             ELSE                                                 42430000
424400                MOVE PW-ASNORD-PO-NBR  TO DP010I-UNEDITED-FIELD   42440000
424500                PERFORM K925-GET-PO-NUMERIC                       42450000
424600                PERFORM K850-CHECK-PREPACK                        42460000
424700                IF PREPACK-PO                                     42470000
424800                   SET NOT-PACK-UPC TO TRUE                       42480000
424900                   SET NO-COMPONENT-SENT TO TRUE                  42490000
425000                END-IF                                            42500000
425100             END-IF                                               42510000
425200             SET UPC-FOUND       TO TRUE                          42520000
425300             IF PREPACK-PO                                        42530000
425400                ADD 1 TO WS-SUB1                                  42540000
425500                MOVE SN001I-SLN04-QTY                             42550000
425600                                 TO WS-PRPK-RATIO(WS-SUB1)        42560000
425700                 MOVE SN001I-SLN10-PROD-ID (PW-SUB) TO            42570000
425800                    DP010I-UNEDITED-FIELD                         42580000
425900                 PERFORM K700-EDIT-FOR-NUMERIC                    42590000
426000                 MOVE PW-UPC-NBR-N TO                             42600000
426100                    WS-PRPK-COMP-UPC(WS-SUB1)                     42610000
426200                 IF PACK-UPC                                      42620000
426300                    IF WS-SUB1 = 1                                42630000
426400                       MOVE PW-UPC-NBR-N TO                       42640000
426500                          XLT00006-UPC-NBR                        42650000
426600                       PERFORM K806-GET-UPC-TYPE                  42660000
426700                    END-IF                                        42670000
426800                 END-IF                                           42680000
426900             ELSE                                                 42690000
427000                IF PW-ASNDTL-ITM-SUBST-UPC-NBR = 'SIMPLE--PACK'   42700000
427100                   CONTINUE                                       42710000
427200                ELSE                                              42720000
427300                   MOVE '000000000000' TO                         42730000
427400                      PW-ASNDTL-ITM-SUBST-UPC-NBR                 42740000
427500                END-IF                                            42750000
427600             END-IF                                               42760000
427700         END-IF                                                   42770000
427800         IF SN001I-SLN09-PROD-ID-QUAL-CDE (PW-SUB) = SPACES       42780000
427900             SET LIN-EOF         TO TRUE                          42790000
428000         END-IF                                                   42800000
428100         ADD PC-POS-1            TO PW-SUB                        42810000
428200     END-PERFORM.                                                 42820000
428300/                                                                 42830000
428400***************************************************************** 42840000
428500*     SAVE PO4 FIELDS                                           * 42850000
428600*                                                               * 42860000
428700*     -  SAVE ITEM LEVEL PO4 RECORD FIELDS IN THE ASNDTL        * 42870000
428800*        RECORD IN WS                                           * 42880000
428900***************************************************************** 42890000
429000 K400-SAVE-PO4-FIELDS.                                            42900000
429100     MOVE 'K400-SAVE-PO4-FIELDS             '                     42910000
429200                                 TO PW-CURRENT-PARA.              42920000
429300                                                                  42930000
429400*    DISPLAY 'K400-SAVE-PO4-FIELDS'.                              42940000
429500                                                                  42950000
429600     IF PS-ASN-STRUC-CODE = '0002'                                42960000
429700        IF PS-VERSION-4010                                        42970000
429800            IF SN001I-PO401-PKG-SIZE-QTY EQUAL +0 OR              42980000
429900               SN001I-PO414-INPK-EA-QTY EQUAL ZERO                42990000
430000                MOVE SN001I-PO414-INPK-EA-QTY                     43000000
430100                                     TO PW-ASNDTL-HOLD-INPK-EA-QTY43010000
430200                MOVE SN001I-PO401-PKG-SIZE-QTY                    43020000
430300                                           TO PW-PKG-QTY-NUMERIC  43030000
430400                MOVE PW-PKG-QTY-NUM-9      TO PW-ASNDTL-PKG-QTY   43040000
430500            ELSE                                                  43050000
430600                COMPUTE PW-ASNDTL-COMP-INPK-TOT-QTY =             43060000
430700                        SN001I-PO401-PKG-SIZE-QTY *               43070000
430800                        SN001I-PO414-INPK-EA-QTY                  43080000
430900                MOVE PW-ASNDTL-COMP-INPK-TOT-QTY                  43090000
431000                                      TO PW-PKG-QTY-NUMERIC       43100000
431100                MOVE PW-PKG-QTY-NUM-9      TO PW-ASNDTL-PKG-QTY   43110000
431200                MOVE SN001I-PO414-INPK-EA-QTY                     43120000
431300                                     TO PW-ASNDTL-HOLD-INPK-EA-QTY43130000
431400        ELSE                                                      43140000
431500            MOVE +0                  TO PW-ASNDTL-HOLD-INPK-EA-QTY43150000
431600            MOVE SN001I-PO402-SIZE-MSMT    TO PW-PKG-QTY-NUMERIC  43160000
431700            MOVE PW-PKG-QTY-NUM-9          TO PW-ASNDTL-PKG-QTY   43170000
431800        END-IF                                                    43180000
431900     END-IF.                                                      43190000
432000*                                                                 43200000
432100*                                                                 43210000
432200     MOVE SN001I-PO403-SIZE-UM-CDE                                43220000
432300                                 TO PW-ASNDTL-PKG-QTY-UM-CDE.     43230000
432400     MOVE SN001I-PO406-GRO-WGHT-MSMT                              43240000
432500                                 TO PW-ASNDTL-WGT-MSMT.           43250000
432600     MOVE SN001I-PO407-WGHT-UM-CDE                                43260000
432700                                 TO PW-ASNDTL-WGT-UM-CDE.         43270000
432800     MOVE SN001I-PO408-GRO-VOL-MSMT                               43280000
432900                                 TO PW-ASNDTL-VOL-MSMT.           43290000
433000     MOVE SN001I-PO409-VOL-UM-CDE                                 43300000
433100                                 TO PW-ASNDTL-VOL-UM-CDE.         43310000
433200     MOVE SN001I-PO410-LEN-MSMT  TO PW-ASNDTL-LEN-MSMT.           43320000
433300     MOVE SN001I-PO411-WDTH-MSMT TO PW-ASNDTL-WDTH-MSMT.          43330000
433400     MOVE SN001I-PO412-HT-MSMT   TO PW-ASNDTL-HT-MSMT.            43340000
433500     MOVE SN001I-PO413-UM-CDE    TO PW-ASNDTL-SIZE-UM-CDE.        43350000
433600/                                                                 43360000
433700***************************************************************** 43370000
433800*     SAVE PKG FIELDS                                           * 43380000
433900*                                                               * 43390000
434000*     -  SAVE ITEM LEVEL PKG RECORD FIELDS IN THE ASNDTL        * 43400000
434100*        RECORD IN WS                                           * 43410000
434200***************************************************************** 43420000
434300 K500-SAVE-PKG-FIELDS.                                            43430000
434400     MOVE 'K500-SAVE-PKG-FIELDS             '                     43440000
434500                                 TO PW-CURRENT-PARA.              43450000
434600*    DISPLAY 'K500-SAVE-PKG-FIELDS'.                              43460000
434700                                                                  43470000
434800     IF  SN001I-PKG01-TYP-CDE  = 'S'                              43480000
434900     AND SN001I-PKG02-PKG-CDE  = '34'                             43490000
435000     AND SN001I-PKG03-QUAL-CDE = 'VI'                             43500000
435100         MOVE SN001I-PKG04-DESC-CDE                               43510000
435200                                 TO PW-ASNDTL-TKT-ERR-CDE         43520000
435300     END-IF.                                                      43530000
435400/                                                                 43540000
435500***************************************************************** 43550000
435600*     SAVE TD5 FIELDS                                           * 43560000
435700*                                                               * 43570000
435800*     -  SAVE ITEM LEVEL TD5 RECORD FIELDS IN THE ASNDTL        * 43580000
435900*        RECORD IN WS                                           * 43590000
436000***************************************************************** 43600000
436100 K600-SAVE-TD5-FIELDS.                                            43610000
436200     MOVE 'K600-SAVE-TD5-FIELDS             '                     43620000
436300                                 TO PW-CURRENT-PARA.              43630000
436400*    DISPLAY 'K600-SAVE-TD5-FIELDS'.                              43640000
436500                                                                  43650000
436600     IF SN001I-TD505-CARR-NME = 'X'                               43660000
436700         MOVE SN001I-TD506-STATUS-CDE                             43670000
436800                                 TO PW-ASNDTL-ITM-STATUS-CDE      43680000
436900     END-IF.                                                      43690000
437000/                                                                 43700000
437100***************************************************************** 43710000
437200*     EDIT ROUTINE FOR NUMERIC UPC                              * 43720000
437300*                                                               * 43730000
437400***************************************************************** 43740000
437500 K700-EDIT-FOR-NUMERIC.                                           43750000
437600                                                                  43760000
437700     MOVE PC-N TO PS-EDIT-ERROR-SW.                               43770000
437800     MOVE 17 TO DP010I-MAXIMUM-DIGITS                             43780000
437900     MOVE ZERO TO DP010I-MAXIMUM-DECIMALS                         43790000
438000     SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                      43800000
438110     CALL DP010I-NUMERIC-EDIT-ROUTINE                             43811001
438120          USING DP010I-NUMERIC-EDIT-AREA                          43812001
438200     IF DP010I-ERROR-DETECTED                                     43820000
438300         MOVE ZERO TO PW-UPC-NBR-N                                43830000
438400         MOVE PC-Y TO PS-EDIT-ERROR-SW                            43840000
438500     ELSE                                                         43850000
438600         MOVE DP010I-NUM-FIELD-17-DIG-0-DEC                       43860000
438700                             TO PW-UPC-NBR-N                      43870000
438800     END-IF.                                                      43880000
438900                                                                  43890000
439000***************************************************************** 43900000
439100*     CHECK PACK UPC                                              43910000
439200***************************************************************** 43920000
439300 K800-CHECK-PACK-UPC.                                             43930000
439400                                                                  43940000
439500*    EXEC SQL                                                     43950000
439600*       SELECT B.PO_PREPK_ID, A.PK_SKU_NBR                        43960000
439700*         INTO :POPRPK-PO-PREPK-ID,                               43970000
439800*              :XLT00009-PK-SKU-NBR                               43980000
439900*         FROM XLT_PK_UPC A,                                      43990000
440000*              TPOPRPK B                                          44000000
440100*         WHERE A.UPC_NBR = :XLT00009-UPC-NBR    AND              44010000
440200*               A.PK_SKU_NBR = B.PK_SKU_NBR                       44020000
440300*    END-EXEC.                                                    44030000
440400     EXEC SQL                                                     44040000
440500        SELECT A.PO_PREPK_ID, A.PK_SKU_NBR                        44050000
440600          INTO :POPRPK-PO-PREPK-ID,                               44060000
440700               :POPRPK-PK-SKU-NBR                                 44070000
440800          FROM TPOPRPK A                                          44080000
440900          WHERE A.PREPK_UPC_NBR = :POPRPK-PREPK-UPC-NBR AND       44090000
441000                A.PO_NBR = :POPRPK-PO-NBR                         44100000
441100     END-EXEC.                                                    44110000
441200                                                                  44120000
441300     MOVE SQLCODE    TO SQLCODE2.                                 44130000
441400                                                                  44140000
441500     EVALUATE TRUE                                                44150000
441600        WHEN SQLCODE = 0                                          44160000
441700        WHEN SQLCODE = -811                                       44170000
441800           SET PACK-UPC TO TRUE                                   44180000
441900        WHEN SQLCODE = +100                                       44190000
442000           SET NOT-PACK-UPC TO TRUE                               44200000
442100        WHEN OTHER                                                44210000
442200             DISPLAY '******************************************' 44220000
442300             DISPLAY 'ERROR ISSUED ON SELECT   '                  44230000
442400             DISPLAY 'PACK ID      :           '                  44240000
442500                      POPRPK-PO-PREPK-ID                          44250000
442600             DISPLAY 'PACK SKU     :           '                  44260000
442700*                     XLT00009-PK-SKU-NBR                         44270000
442800                      POPRPK-PREPK-UPC-NBR                        44280000
442900             DISPLAY 'CARTON       :           '                  44290000
443000                      PW-ASNCAR-ASNCAR-NBR                        44300000
443100             DISPLAY 'ASN             :        '                  44310000
443200                      PW-ASNHDR-NBR                               44320000
443300             DISPLAY '******************************************' 44330000
443400             PERFORM Z900-SQL-ERROR                               44340000
443500     END-EVALUATE.                                                44350000
443600*                                                                 44360000
443700***************************************************************** 44370000
443800*     COUNT PACK COMPONENTS                                       44380000
443900***************************************************************** 44390000
444000*                                                                 44400000
444100 K802-COUNT-PACK-COMPONENTS.                                      44410000
444200     MOVE 0 TO WS-PACK-COMPONENTS.                                44420000
444300     SET NOT-END-OF-PACK-COMP TO TRUE.                            44430000
444400     PERFORM                                                      44440000
444500        VARYING WS-SUB3 FROM 1 BY 1                               44450000
444600        UNTIL WS-SUB3 > 1000                                      44460000
444700        IF WS-PACK-LN-UPC(WS-CURR-PACK, WS-SUB3) > 0              44470000
444800           ADD 1 TO WS-PACK-COMPONENTS                            44480000
444900        ELSE                                                      44490000
445000           SET END-OF-PACK-COMP TO TRUE                           44500000
445100        END-IF                                                    44510000
445200     END-PERFORM.                                                 44520000
445300*                                                                 44530000
445400***************************************************************** 44540000
445500*     COUNT COMPONENTS                                            44550000
445600***************************************************************** 44560000
445700*                                                                 44570000
445800 K803-COUNT-COMPONENTS.                                           44580000
445900     MOVE 0 TO WS-COMPONENTS.                                     44590000
446000     SET NOT-END-OF-COMPONENTS TO TRUE.                           44600000
446100     PERFORM                                                      44610000
446200        VARYING WS-SUB3 FROM 1 BY 1                               44620000
446300        UNTIL WS-SUB3 > 1000                                      44630000
446400        IF WS-PRPK-COMP-UPC(WS-SUB3) > 0                          44640000
446500           ADD 1 TO WS-COMPONENTS                                 44650000
446600           IF WS-PRPK-RATIO(WS-SUB3) > 0                          44660000
446700              CONTINUE                                            44670000
446800           ELSE                                                   44680000
446900              PERFORM K926-MSG-11PP                               44690000
447000           END-IF                                                 44700000
447100        ELSE                                                      44710000
447200           SET END-OF-COMPONENTS TO TRUE                          44720000
447300        END-IF                                                    44730000
447400     END-PERFORM.                                                 44740000
447500*                                                                 44750000
447600***************************************************************** 44760000
447700*     GET COMPONENT UPC                                           44770000
447800*                                                                 44780000
447900***************************************************************** 44790000
448000 K804-GET-COMPONENT-UPC.                                          44800000
448100                                                                  44810000
448200     EXEC SQL                                                     44820000
448300        SELECT B.UPC_NBR                                          44830000
448400          INTO :XLT00006-UPC-NBR                                  44840000
448500          FROM XLT_SKU A,                                         44850000
448600               XLT_UPC B                                          44860000
448700          WHERE A.ITM_NBR     = :PURITM-ITM-NBR  AND              44870000
448800                A.INTR_UPC_ID = B.INTR_UPC_ID AND                 44880000
448900                B.UPC_TYP_CDE = :WS-CURR-UPC-TYPE                 44890000
449000     END-EXEC.                                                    44900000
449100                                                                  44910000
449200     MOVE SQLCODE    TO SQLCODE2.                                 44920000
449300                                                                  44930000
449400     EVALUATE TRUE                                                44940000
449500        WHEN SQLCODE = 0                                          44950000
449600           CONTINUE                                               44960000
449700        WHEN SQLCODE = +100                                       44970000
449800           MOVE SPACES TO WS-OTHER-UPC-TYPE                       44980000
449900           IF WS-CURR-UPC-TYPE = 'V'                              44990000
450000              MOVE 'I' TO WS-OTHER-UPC-TYPE                       45000000
450100           ELSE                                                   45010000
450200              IF WS-CURR-UPC-TYPE = 'I'                           45020000
450300                 MOVE 'V' TO WS-OTHER-UPC-TYPE                    45030000
450400              END-IF                                              45040000
450500           END-IF                                                 45050000
450600           DISPLAY  WS-CURR-UPC-TYPE ' TRYING OTHER UPC TYPE'     45060000
450700           PERFORM K804A-GET-COMPONENT-UPC                        45070000
450800        WHEN SQLCODE = -811                                       45080000
450900           PERFORM K804-TRY-AGAIN                                 45090000
451000        WHEN OTHER                                                45100000
451100             DISPLAY '******************************************' 45110000
451200             DISPLAY 'K804-GET-COMPONENT-UPC'                     45120000
451300             DISPLAY 'ERROR ISSUED ON SELECT   '                  45130000
451400             DISPLAY 'PACK ID      :           '                  45140000
451500                      POPRPK-PO-PREPK-ID                          45150000
451600             DISPLAY 'PACK SKU     :           '                  45160000
451700*                     XLT00009-PK-SKU-NBR                         45170000
451800                      POPRPK-PREPK-UPC-NBR                        45180000
451900             DISPLAY 'CARTON       :           '                  45190000
452000                      PW-ASNCAR-ASNCAR-NBR                        45200000
452100             DISPLAY 'ASN             :        '                  45210000
452200                      PW-ASNHDR-NBR                               45220000
452300             DISPLAY '******************************************' 45230000
452400             PERFORM Z900-SQL-ERROR                               45240000
452500     END-EVALUATE.                                                45250000
452600*                                                                 45260000
452700 K804A-GET-COMPONENT-UPC.                                         45270000
452800                                                                  45280000
452900     EXEC SQL                                                     45290000
453000        SELECT B.UPC_NBR                                          45300000
453100          INTO :XLT00006-UPC-NBR                                  45310000
453200          FROM XLT_SKU A,                                         45320000
453300               XLT_UPC B                                          45330000
453400          WHERE A.ITM_NBR     = :PURITM-ITM-NBR  AND              45340000
453500                A.INTR_UPC_ID = B.INTR_UPC_ID AND                 45350000
453600                B.UPC_TYP_CDE = :WS-OTHER-UPC-TYPE                45360000
453700     END-EXEC.                                                    45370000
453800                                                                  45380000
453900     MOVE SQLCODE    TO SQLCODE2.                                 45390000
454000                                                                  45400000
454100     EVALUATE TRUE                                                45410000
454200        WHEN SQLCODE = 0                                          45420000
454300           CONTINUE                                               45430000
454400        WHEN SQLCODE = +100                                       45440000
454500           MOVE 1 TO XLT00006-UPC-NBR                             45450000
454600        WHEN SQLCODE = -811                                       45460000
454700           PERFORM K804-TRY-AGAIN                                 45470000
454800        WHEN OTHER                                                45480000
454900             DISPLAY '******************************************' 45490000
455000             DISPLAY 'K804A-GET-COMPONENT-UPC'                    45500000
455100             DISPLAY 'ERROR ISSUED ON SELECT   '                  45510000
455200             DISPLAY 'PACK ID      :           '                  45520000
455300                      POPRPK-PO-PREPK-ID                          45530000
455400             DISPLAY 'PACK SKU     :           '                  45540000
455500*                     XLT00009-PK-SKU-NBR                         45550000
455600                      POPRPK-PREPK-UPC-NBR                        45560000
455700             DISPLAY 'CARTON       :           '                  45570000
455800                      PW-ASNCAR-ASNCAR-NBR                        45580000
455900             DISPLAY 'ASN             :        '                  45590000
456000                      PW-ASNHDR-NBR                               45600000
456100             DISPLAY '******************************************' 45610000
456200             PERFORM Z900-SQL-ERROR                               45620000
456300     END-EVALUATE.                                                45630000
456400*                                                                 45640000
456500***************************************************************** 45650000
456600*     K804-TRY-AGAIN                                              45660000
456700***************************************************************** 45670000
456800*                                                                 45680000
456900 K804-TRY-AGAIN.                                                  45690000
457000     SET NOT-END-OF-COMP TO TRUE.                                 45700000
457100     PERFORM Z105-OPEN-COMP-CURSOR.                               45710000
457200     PERFORM Z106-FETCH-COMP-CURSOR                               45720000
457300        UNTIL END-OF-COMP.                                        45730000
457400     PERFORM Z107-CLOSE-COMP-CURSOR.                              45740000
457500***************************************************************** 45750000
457600*     FIND LAST PACK                                              45760000
457700***************************************************************** 45770000
457800*                                                                 45780000
457900 K805-FIND-LAST-PACK.                                             45790000
458000     SET NOT-END-OF-PACK TO TRUE.                                 45800000
458100     MOVE 0 TO WS-CURR-PACK.                                      45810000
458200     PERFORM                                                      45820000
458300        VARYING WS-SUB3 FROM 1 BY 1                               45830000
458400        UNTIL END-OF-PACK OR                                      45840000
458500              WS-SUB3 > 1000                                      45850000
458600        IF WS-PACK-ID(WS-SUB3) > 0                                45860000
458700           ADD 1 TO WS-CURR-PACK                                  45870000
458800        ELSE                                                      45880000
458900           SET END-OF-PACK TO TRUE                                45890000
459000        END-IF                                                    45900000
459100     END-PERFORM.                                                 45910000
459200     ADD 1 TO WS-CURR-PACK.                                       45920000
459300*                                                                 45930000
459400***************************************************************** 45940000
459500* GET UPC TYPE                                                    45950000
459600***************************************************************** 45960000
459700 K806-GET-UPC-TYPE.                                               45970000
459800                                                                  45980000
459900     EXEC SQL                                                     45990000
460000        SELECT A.UPC_TYP_CDE                                      46000000
460100          INTO :XLT00006-UPC-TYP-CDE                              46010000
460200          FROM XLT_UPC A                                          46020000
460300          WHERE A.UPC_NBR = :XLT00006-UPC-NBR                     46030000
460400     END-EXEC.                                                    46040000
460500                                                                  46050000
460600     MOVE SQLCODE    TO SQLCODE2.                                 46060000
460700                                                                  46070000
460800     EVALUATE TRUE                                                46080000
460900        WHEN SQLCODE = 0                                          46090000
461000           MOVE XLT00006-UPC-TYP-CDE TO                           46100000
461100              WS-CURR-UPC-TYPE                                    46110000
461200        WHEN SQLCODE = +100                                       46120000
461300           SET NOT-PACK-UPC TO TRUE                               46130000
461400           PERFORM K926-MSG-14PP                                  46140000
461500           MOVE SPACES TO WS-CURR-UPC-TYPE                        46150000
461600        WHEN OTHER                                                46160000
461700             DISPLAY '******************************************' 46170000
461800             DISPLAY 'K806-GET-UPC-TYPE'                          46180000
461900             DISPLAY 'ERROR ISSUED ON SELECT   '                  46190000
462000             DISPLAY 'PACK ID      :           '                  46200000
462100                      POPRPK-PO-PREPK-ID                          46210000
462200             DISPLAY 'PACK SKU     :           '                  46220000
462300                      XLT00006-UPC-NBR                            46230000
462400             DISPLAY 'CARTON       :           '                  46240000
462500                      PW-ASNCAR-ASNCAR-NBR                        46250000
462600             DISPLAY 'ASN             :        '                  46260000
462700                      PW-ASNHDR-NBR                               46270000
462800             DISPLAY '******************************************' 46280000
462900             PERFORM Z900-SQL-ERROR                               46290000
463000     END-EVALUATE.                                                46300000
463100*                                                                 46310000
463200***************************************************************** 46320000
463300*     BUILD PACK                                                  46330000
463400***************************************************************** 46340000
463500 K810-BUILD-PACK.                                                 46350000
463600*                                                                 46360000
463700     SET NOT-END-OF-PACK TO TRUE.                                 46370000
463800     PERFORM Z100-OPEN-PACK-CURSOR.                               46380000
463900     MOVE POPRPK-PO-PREPK-ID TO                                   46390000
464000        WS-PACK-ID(WS-CURR-PACK).                                 46400000
464100     MOVE POPRPK-PO-NBR TO LOG-PO.                                46410000
464200     MOVE POPRPK-PO-PREPK-ID TO LOG-PACK-ID.                      46420000
464300     MOVE WS-CURR-PACK TO LOG-SUB.                                46430000
464400     MOVE WS-CURR-UPC-TYPE TO LOG-TYPE.                           46440000
464500     MOVE SPACES TO ASN-LOG-REC.                                  46450000
464600     MOVE LOG-MESSAGE-1 TO ASN-LOG-REC.                           46460000
464700     WRITE ASN-LOG-REC.                                           46470000
464710     ADD 1 TO PV-ASN-ERROR-LOG-COUNT.                             46471005
464800     PERFORM                                                      46480000
464900        VARYING WS-SUB3 FROM 1 BY 1                               46490000
465000        UNTIL END-OF-PACK OR                                      46500000
465100              WS-SUB3 > 1000                                      46510000
465200        PERFORM Z101-FETCH-PACK-CURSOR                            46520000
465300        IF END-OF-PACK                                            46530000
465400           CONTINUE                                               46540000
465500*          MOVE 0 TO WS-PACK-ID(WS-CURR-PACK)                     46550000
465600        ELSE                                                      46560000
465700           MOVE PURITM-ITM-NBR TO XLT00003-ITM-NBR                46570000
465800           PERFORM K804-GET-COMPONENT-UPC                         46580000
465900           MOVE XLT00006-UPC-NBR  TO                              46590000
466000              WS-PACK-LN-UPC(WS-CURR-PACK, WS-SUB3)               46600000
466100           MOVE PURITM-PREPK-RATO-QTY TO                          46610000
466200              WS-PACK-LN-RATIO(WS-CURR-PACK, WS-SUB3)             46620000
466300           MOVE XLT00006-UPC-NBR TO LOG-COMP-UPC                  46630000
466400           MOVE PURITM-PREPK-RATO-QTY TO LOG-COMP-RATIO           46640000
466500           MOVE SPACES TO ASN-LOG-REC                             46650000
466600           MOVE LOG-MESSAGE-2 TO ASN-LOG-REC                      46660000
466700           WRITE ASN-LOG-REC                                      46670000
466710           ADD 1 TO PV-ASN-ERROR-LOG-COUNT                        46671005
466800        END-IF                                                    46680000
466900     END-PERFORM.                                                 46690000
467000     PERFORM Z102-CLOSE-PACK-CURSOR.                              46700000
467100*                                                                 46710000
467200***************************************************************** 46720000
467300*     CHECK IF PACK BUILT                                         46730000
467400***************************************************************** 46740000
467500*                                                                 46750000
467600 K815-CHECK-IF-PACK-BUILT.                                        46760000
467700     SET PACK-NOT-FOUND TO TRUE.                                  46770000
467800     PERFORM                                                      46780000
467900        VARYING WS-SUB3 FROM 1 BY 1                               46790000
468000        UNTIL PACK-FOUND OR                                       46800000
468100              WS-SUB3 > 1000                                      46810000
468200        IF POPRPK-PO-PREPK-ID = WS-PACK-ID(WS-SUB3)               46820000
468300           SET PACK-FOUND TO TRUE                                 46830000
468400           MOVE WS-SUB3 TO WS-CURR-PACK                           46840000
468500        END-IF                                                    46850000
468600     END-PERFORM.                                                 46860000
468700*                                                                 46870000
468800***************************************************************** 46880000
468900*     CHECK PREPACK                                               46890000
469000*                                                                 46900000
469100***************************************************************** 46910000
469200 K850-CHECK-PREPACK.                                              46920000
469300                                                                  46930000
469400     MOVE PW-PO-NBR-N TO DK-PO-NBR                                46940000
469500                         POPRPK-PO-NBR.                           46950000
469600     SET NOT-PREPACK-PO TO TRUE.                                  46960000
469610                                                                  46961000
469620     EXEC SQL                                                     46962000
469630        SELECT A.PKGNG_CDE                                        46963000
469640          INTO :PURCHS-PKGNG-CDE                                  46964000
469650          FROM TPURCHS A                                          46965000
469660          WHERE A.PO_NBR         = :DK-PO-NBR                     46966000
469670            AND A.VER_STATUS_CDE = 'A'                            46967000
469680     END-EXEC.                                                    46968000
469690                                                                  46969000
469700     MOVE SQLCODE    TO SQLCODE2.                                 46970000
469800                                                                  46980000
469900     EVALUATE TRUE                                                46990000
470000        WHEN SQLCODE = 0                                          47000000
470100        WHEN SQLCODE = -811                                       47010000
470200           IF  PURCHS-PKGNG-CDE = 'M'                             47020000
470300           OR  PURCHS-PKGNG-CDE = 'I'                             47030000
470400               SET PREPACK-PO TO TRUE                             47040000
470500           END-IF                                                 47050000
470600        WHEN SQLCODE = +100                                       47060000
470700           SET NOT-PREPACK-PO TO TRUE                             47070000
470800        WHEN OTHER                                                47080000
470900             DISPLAY '******************************************' 47090000
471000             DISPLAY 'K850-CHECK-PREPACK'                         47100000
471100             DISPLAY 'ERROR ISSUED ON SELECT   '                  47110000
471200             DISPLAY 'PACK ID      :           '                  47120000
471300                      POPRPK-PO-PREPK-ID                          47130000
471400             DISPLAY 'PACK SKU     :           '                  47140000
471500*                     XLT00009-PK-SKU-NBR                         47150000
471600                      POPRPK-PREPK-UPC-NBR                        47160000
471700             DISPLAY 'CARTON       :           '                  47170000
471800                      PW-ASNCAR-ASNCAR-NBR                        47180000
471900             DISPLAY 'ASN             :        '                  47190000
472000                      PW-ASNHDR-NBR                               47200000
472100             DISPLAY 'PO NUMBER       :        '                  47210000
472200                      PW-PO-NBR-N                                 47220000
472300             DISPLAY '******************************************' 47230000
472400             PERFORM Z900-SQL-ERROR                               47240000
472500     END-EVALUATE.                                                47250000
472600*                                                                 47260000
472700***************************************************************** 47270000
472800*     CHECK CARTON                                                47280000
472900*                                                                 47290000
473000***************************************************************** 47300000
473100 K860-CHECK-CARTON.                                               47310000
473200*GB 01/21/15 CHANGE TO USE CHAR FIELD RATHER THAN NUMERIC         47320000
473300     MOVE PW-ASNORD-PO-NBR TO ASNCAR-PO-NBR.                      47330000
473400*GB 01/21/15                                                      47340000
473500     MOVE PW-ASNCAR-ASNCAR-NBR TO ASNCAR-ASNCAR-NBR.              47350000
473600     EXEC SQL                                                     47360000
473700        SELECT COUNT(*)                                           47370000
473800          INTO :WS-CARTON-COUNT                                   47380000
473900          FROM TASNCAR                                            47390000
474000          WHERE PO_NBR = :ASNCAR-PO-NBR AND                       47400000
474100                ASNCAR_NBR = :ASNCAR-ASNCAR-NBR AND               47410000
474200                ASNHDR_ID = :PV-ASNHDR-ID                         47420000
474300     END-EXEC.                                                    47430000
474400                                                                  47440000
474500     MOVE SQLCODE    TO SQLCODE2.                                 47450000
474600                                                                  47460000
474700     EVALUATE TRUE                                                47470000
474800        WHEN SQLCODE = 0                                          47480000
474900           IF WS-CARTON-COUNT > 0                                 47490000
475000              SET NO-COMPONENT-SENT TO TRUE                       47500000
475100           ELSE                                                   47510000
475200              SET COMPONENT-SENT TO TRUE                          47520000
475300           END-IF                                                 47530000
475400        WHEN OTHER                                                47540000
475500             DISPLAY '******************************************' 47550000
475600             DISPLAY 'K860-CHECK-CARTON'                          47560000
475700             DISPLAY 'ERROR ISSUED ON SELECT   '                  47570000
475800             DISPLAY 'CARTON       :           '                  47580000
475900                      PW-ASNCAR-ASNCAR-NBR                        47590000
476000             DISPLAY 'ASN             :        '                  47600000
476100                      PW-ASNHDR-NBR                               47610000
476200             DISPLAY '******************************************' 47620000
476300             PERFORM Z900-SQL-ERROR                               47630000
476400     END-EVALUATE.                                                47640000
476500*                                                                 47650000
476600***************************************************************** 47660000
476700*     CHECK COMPONENT UPC                                         47670000
476800*       THIS PARAGRAPH WILL JOIN TO TPURITM BUT WILL BYPASS ANY   47680000
476900*       CANCELED LINES IN THE JOIN.  IF NO DATA IS FOUND WHEN     47690000
477000*       EXECUTING THIS SQL (+100), THEN PARAGRAPH                 47700000
477010*       K900-CHECK-COMPONENT-UPC WILL BE EXECUTED AND TAKE INTO   47701000
477020*       CONSIDERATION CANCELED LINES TO FIND A MATCH.             47702000
477030***************************************************************** 47703000
477040 K900-CHECK-COMPONENT-UPC.                                        47704000
477050     EXEC SQL                                                     47705000
477060        SELECT B.SKU_NBR, B.ITM_NBR, C.PO_PREPK_ID                47706000
477070          INTO :XLT00003-SKU-NBR,                                 47707000
477080               :XLT00003-ITM-NBR,                                 47708000
477090               :PURITM-PO-PREPK-ID                                47709000
477100          FROM XLT_UPC A,                                         47710000
477200               XLT_SKU B,                                         47720000
477300               TPURITM C                                          47730000
477400          WHERE A.UPC_NBR         = :XLT00006-UPC-NBR             47740000
477500            AND B.INTR_UPC_ID     = A.INTR_UPC_ID                 47750000
477600            AND C.PO_NBR          = :PURITM-PO-NBR                47760000
477700            AND C.VER_STATUS_CDE  = 'A'                           47770000
477800            AND C.STATUS_CDE     <> 'CA'                          47780000
477900            AND C.ITM_NBR         = B.ITM_NBR                     47790000
478000     END-EXEC.                                                    47800000
478100                                                                  47810000
478200     MOVE SQLCODE    TO SQLCODE2.                                 47820000
478300                                                                  47830000
478400     EVALUATE TRUE                                                47840000
478500        WHEN SQLCODE = 0                                          47850000
478600           SET COMP-UPC TO TRUE                                   47860000
478700        WHEN SQLCODE = -811                                       47870000
478800           SET COMP-UPC TO TRUE                                   47880000
478900        WHEN SQLCODE = +100                                       47890000
479000           PERFORM K900A-CHECK-COMPONENT-UPC                      47900000
479100        WHEN OTHER                                                47910000
479200             DISPLAY '******************************************' 47920000
479300             DISPLAY 'K900-CHECK-COMPONENT-UPC'                   47930000
479400             DISPLAY 'ERROR ISSUED ON SELECT   '                  47940000
479500             MOVE XLT00006-UPC-NBR TO PV-DISPLAY-UPC-NBR          47950000
479600             DISPLAY 'LIN  UPC     :           '                  47960000
479700                      PV-DISPLAY-UPC-NBR                          47970000
479800             DISPLAY 'CARTON       :           '                  47980000
479900                      PW-ASNCAR-ASNCAR-NBR                        47990000
480000             DISPLAY 'ASN             :        '                  48000000
480100                      PW-ASNHDR-NBR                               48010000
480200             MOVE PURITM-PO-NBR TO PV-DISPLAY-PO-NBR              48020000
480300             DISPLAY 'PO NUMBER       :        '                  48030000
480400                      PV-DISPLAY-PO-NBR                           48040000
480500             DISPLAY '******************************************' 48050000
480600             PERFORM Z900-SQL-ERROR                               48060000
480700     END-EVALUATE.                                                48070000
480800*                                                                 48080000
480900***************************************************************** 48090000
481000*     CHECK COMPONENT UPC                                         48100000
481001*       THIS PARAGRAPH WILL JOIN TO TPURITM BUT WILL TAKE INTO    48100100
481002*       CONSIDERATION TRYING TO MATCH THE PO/ITEM TO A CANCELED   48100200
481003*       LINE IN THE TPURITM TABLE FROM A PREPACK.                 48100300
481004*                                                                 48100401
481005*     NOTE:  IN THE EVALUATE STATEMENT FOR THIS SQL, REGARDLESS   48100501
481006*            IF THERE IS A SQL CODE OF 0, -811 OR +100, THE       48100601
481007*            88 LEVEL COMP-UPC GETS SET TO TRUE.  WHILE THIS      48100701
481008*            DOES NOT SEEM RIGHT, THIS IS THE WAY THE PROGRAM     48100801
481009*            NEEDS TO BE CODED SO THAT THE PROPER LOGIC IS        48100901
481010*            EXECUTED FOLLOWING THE K900 PARAGRAPH TO SEND THE    48101001
481011*            PROGRAM THRU LOGIC TO ENSURE THAT ENTRIES ARE        48101101
481012*            WRITTEN TO THE TASNDTL TABLE FOR THE PREPACK PO ASN  48101201
481013*            WHERE THE UPC NUMBER IS NOT A VALID UPC - THIS WILL  48101301
481014*            ENSURE THAT DATA IS WRITTEN PROPERLY TO THE          48101401
481015*            SNKRP006 AND RCKUP006 REPORTS LATER IN THE ASN BATCH 48101501
481016*            CYCLE.                                               48101601
481017***************************************************************** 48101701
481018 K900A-CHECK-COMPONENT-UPC.                                       48101801
481019     EXEC SQL                                                     48101901
481020        SELECT B.SKU_NBR, B.ITM_NBR, C.PO_PREPK_ID                48102001
481021          INTO :XLT00003-SKU-NBR,                                 48102101
481022               :XLT00003-ITM-NBR,                                 48102201
481023               :PURITM-PO-PREPK-ID                                48102301
481024          FROM XLT_UPC A,                                         48102401
481025               XLT_SKU B,                                         48102501
481026               TPURITM C                                          48102601
481027          WHERE A.UPC_NBR         = :XLT00006-UPC-NBR             48102701
481028            AND B.INTR_UPC_ID     = A.INTR_UPC_ID                 48102801
481029            AND C.PO_NBR          = :PURITM-PO-NBR                48102901
481030            AND C.VER_STATUS_CDE  = 'A'                           48103001
481031            AND C.PO_PREPK_ID     > 0                             48103101
481032            AND C.ITM_NBR         = B.ITM_NBR                     48103201
481033     END-EXEC.                                                    48103301
481034                                                                  48103401
481035     MOVE SQLCODE    TO SQLCODE2.                                 48103501
481036                                                                  48103601
481037     EVALUATE TRUE                                                48103701
481038        WHEN SQLCODE = 0                                          48103801
481039           SET COMP-UPC TO TRUE                                   48103901
481040        WHEN SQLCODE = -811                                       48104001
481041           SET COMP-UPC TO TRUE                                   48104101
481042        WHEN SQLCODE = +100                                       48104201
481043           SET COMP-UPC TO TRUE                                   48104301
481044        WHEN OTHER                                                48104401
481045             DISPLAY '******************************************' 48104501
481046             DISPLAY 'K900A-CHECK-COMPONENT-UPC'                  48104601
481047             DISPLAY 'ERROR ISSUED ON SELECT   '                  48104701
481048             MOVE XLT00006-UPC-NBR TO PV-DISPLAY-UPC-NBR          48104801
481049             DISPLAY 'LIN  UPC     :           '                  48104901
481050                      PV-DISPLAY-UPC-NBR                          48105001
481051             DISPLAY 'CARTON       :           '                  48105101
481052                      PW-ASNCAR-ASNCAR-NBR                        48105201
481053             DISPLAY 'ASN             :        '                  48105301
481054                      PW-ASNHDR-NBR                               48105401
481055             MOVE PURITM-PO-NBR TO PV-DISPLAY-PO-NBR              48105501
481056             DISPLAY 'PO NUMBER       :        '                  48105601
481057                      PV-DISPLAY-PO-NBR                           48105701
481058             DISPLAY '******************************************' 48105801
481059             PERFORM Z900-SQL-ERROR                               48105901
481060     END-EVALUATE.                                                48106001
481061*                                                                 48106101
481062***************************************************************** 48106201
481063*     CHK GOOD COMP UPC                                           48106301
481064*       THIS PARAGRAPH WILL JOIN TO TPURITM BUT WILL BYPASS ANY   48106401
481070*       CANCELED LINES IN THE JOIN.  IF NO DATA IS FOUND WHEN     48107000
481080*       EXECUTING THIS SQL (+100), THEN PARAGRAPH                 48108000
481090*       K901A-CHK-GOOD-COMP-UPC WILL BE EXECUTED IF THE PO IS     48109000
481100*       A PREPACK PO OR PARAGRAPH K901B-CHK-GOOD-COMP-UPC         48110000
481200*       WILL BE EXECUTED IF THE IS NOT A PREPACK PO AND WILL      48120000
481210*       TAKE INTO CONSIDERATION CANCELED LINES TO FIND A MATCH.   48121000
481220*                                                                 48122000
481230***************************************************************** 48123000
481240 K901-CHK-GOOD-COMP-UPC.                                          48124000
481250                                                                  48125000
481260     SET NOT-GOOD-COMP-UPC TO TRUE.                               48126000
481270     SET NOT-MULT-COMP-UPC TO TRUE.                               48127000
481280                                                                  48128000
481290     EXEC SQL                                                     48129000
481300        SELECT B.SKU_NBR, B.ITM_NBR                               48130000
481400          INTO :XLT00003-SKU-NBR,                                 48140000
481500               :XLT00003-ITM-NBR                                  48150000
481600          FROM XLT_UPC A,                                         48160000
481700               XLT_SKU B,                                         48170000
481800               TPURITM C                                          48180000
481900          WHERE A.UPC_NBR         = :XLT00006-UPC-NBR             48190000
482000            AND B.INTR_UPC_ID     = A.INTR_UPC_ID                 48200000
482100            AND C.PO_NBR          = :PURITM-PO-NBR                48210000
482200            AND C.VER_STATUS_CDE  = 'A'                           48220000
482300            AND C.STATUS_CDE     <> 'CA'                          48230000
482400            AND C.ITM_NBR         = B.ITM_NBR                     48240000
482500     END-EXEC.                                                    48250000
482600                                                                  48260000
482700     MOVE SQLCODE    TO SQLCODE2.                                 48270000
482800                                                                  48280000
482900     EVALUATE TRUE                                                48290000
483000        WHEN SQLCODE = 0                                          48300000
483100           SET GOOD-COMP-UPC TO TRUE                              48310000
483200        WHEN SQLCODE = -811                                       48320000
483300           SET MULT-COMP-UPC TO TRUE                              48330000
483400        WHEN SQLCODE = +100                                       48340000
483500           IF  PREPACK-PO                                         48350000
483600               PERFORM K901A-CHK-GOOD-COMP-UPC                    48360000
483700           ELSE                                                   48370000
483800               PERFORM K901B-CHK-GOOD-COMP-UPC                    48380000
483900           END-IF                                                 48390000
484000        WHEN OTHER                                                48400000
484100             DISPLAY '******************************************' 48410000
484200             DISPLAY 'K901-CHK-GOOD-COMP-UPC'                     48420000
484300             DISPLAY 'ERROR ISSUED ON SELECT '                    48430000
484400             MOVE XLT00006-UPC-NBR TO PV-DISPLAY-UPC-NBR          48440000
484500             DISPLAY 'COMP UPC     :           '                  48450000
484600                      PV-DISPLAY-UPC-NBR                          48460000
484700             DISPLAY 'CARTON       :           '                  48470000
484800                      PW-ASNCAR-ASNCAR-NBR                        48480000
484900             DISPLAY 'ASN             :        '                  48490000
485000                      PW-ASNHDR-NBR                               48500000
485100             MOVE PURITM-PO-NBR TO PV-DISPLAY-PO-NBR              48510000
485200             DISPLAY 'PO NUMBER       :        '                  48520000
485210                      PV-DISPLAY-PO-NBR                           48521000
485220             DISPLAY '******************************************' 48522000
485230             PERFORM Z900-SQL-ERROR                               48523000
485240     END-EVALUATE.                                                48524000
485250*                                                                 48525000
485260***************************************************************** 48526000
485270*     CHK GOOD COMP UPC - PREPACK PO ONLY                         48527000
485280*       THIS PARAGRAPH WILL JOIN TO TPURITM BUT WILL TAKE INTO    48528000
485290*       CONSIDERATION TRYING TO MATCH THE PO/ITEM TO A CANCELED   48529000
485300*       LINE IN THE TPURITM TABLE FROM A PREPACK.                 48530000
485400*                                                                 48540000
485500***************************************************************** 48550000
485510 K901A-CHK-GOOD-COMP-UPC.                                         48551000
485520                                                                  48552000
485530     EXEC SQL                                                     48553000
485540        SELECT B.SKU_NBR, B.ITM_NBR                               48554000
485550          INTO :XLT00003-SKU-NBR,                                 48555000
485560               :XLT00003-ITM-NBR                                  48556000
485570          FROM XLT_UPC A,                                         48557000
485580               XLT_SKU B,                                         48558000
485590               TPURITM C                                          48559000
485600          WHERE A.UPC_NBR         = :XLT00006-UPC-NBR             48560000
485601            AND B.INTR_UPC_ID     = A.INTR_UPC_ID                 48560100
485602            AND C.PO_NBR          = :PURITM-PO-NBR                48560200
485603            AND C.VER_STATUS_CDE  = 'A'                           48560300
485604            AND C.PO_PREPK_ID     > 0                             48560400
485605            AND C.ITM_NBR         = B.ITM_NBR                     48560500
485606     END-EXEC.                                                    48560600
485607                                                                  48560700
485608     MOVE SQLCODE    TO SQLCODE2.                                 48560800
485609                                                                  48560900
485610     EVALUATE TRUE                                                48561000
485611        WHEN SQLCODE = 0                                          48561100
485612           SET GOOD-COMP-UPC TO TRUE                              48561200
485613        WHEN SQLCODE = -811                                       48561300
485614           SET MULT-COMP-UPC TO TRUE                              48561400
485615        WHEN SQLCODE = +100                                       48561500
485616           SET NOT-GOOD-COMP-UPC TO TRUE                          48561600
485617        WHEN OTHER                                                48561700
485618             DISPLAY '******************************************' 48561800
485619             DISPLAY 'K901A-CHK-GOOD-COMP-UPC'                    48561900
485620             DISPLAY 'ERROR ISSUED ON SELECT '                    48562000
485630             MOVE XLT00006-UPC-NBR TO PV-DISPLAY-UPC-NBR          48563000
485631             DISPLAY 'COMP UPC     :           '                  48563100
485632                      PV-DISPLAY-UPC-NBR                          48563200
485633             DISPLAY 'CARTON       :           '                  48563300
485634                      PW-ASNCAR-ASNCAR-NBR                        48563400
485635             DISPLAY 'ASN             :        '                  48563500
485636                      PW-ASNHDR-NBR                               48563600
485637             MOVE PURITM-PO-NBR TO PV-DISPLAY-PO-NBR              48563700
485638             DISPLAY 'PO NUMBER       :        '                  48563800
485639                      PV-DISPLAY-PO-NBR                           48563900
485640             DISPLAY '******************************************' 48564000
485641             PERFORM Z900-SQL-ERROR                               48564100
485642     END-EVALUATE.                                                48564200
485643*                                                                 48564300
485644***************************************************************** 48564400
485645*     CHK GOOD COMP UPC - NON-PREPACK PO ONLY                     48564500
485646*       THIS PARAGRAPH WILL JOIN TO TPURITM BUT WILL TAKE INTO    48564600
485647*       CONSIDERATION TRYING TO MATCH THE PO/ITEM TO A CANCELED   48564700
485648*       LINE IN THE TPURITM TABLE FROM A PREPACK.                 48564800
485649*                                                                 48564900
485650***************************************************************** 48565000
485651 K901B-CHK-GOOD-COMP-UPC.                                         48565100
485652                                                                  48565200
485653     EXEC SQL                                                     48565300
485654        SELECT B.SKU_NBR, B.ITM_NBR                               48565400
485655          INTO :XLT00003-SKU-NBR,                                 48565500
485656               :XLT00003-ITM-NBR                                  48565600
485657          FROM XLT_UPC A,                                         48565700
485658               XLT_SKU B,                                         48565800
485659               TPURITM C                                          48565900
485660          WHERE A.UPC_NBR         = :XLT00006-UPC-NBR             48566000
485661            AND B.INTR_UPC_ID     = A.INTR_UPC_ID                 48566100
485662            AND C.PO_NBR          = :PURITM-PO-NBR                48566200
485663            AND C.VER_STATUS_CDE  = 'A'                           48566300
485664            AND C.PO_PREPK_ID     = 0                             48566400
485665            AND C.ITM_NBR         = B.ITM_NBR                     48566500
485666     END-EXEC.                                                    48566600
485667                                                                  48566700
485668     MOVE SQLCODE    TO SQLCODE2.                                 48566800
485669                                                                  48566900
485670     EVALUATE TRUE                                                48567000
485671        WHEN SQLCODE = 0                                          48567100
485672           SET GOOD-COMP-UPC TO TRUE                              48567200
485673        WHEN SQLCODE = -811                                       48567300
485674           SET MULT-COMP-UPC TO TRUE                              48567400
485675        WHEN SQLCODE = +100                                       48567500
485676           SET NOT-GOOD-COMP-UPC TO TRUE                          48567600
485677        WHEN OTHER                                                48567700
485678             DISPLAY '******************************************' 48567800
485679             DISPLAY 'K901B-CHK-GOOD-COMP-UPC'                    48567900
485680             DISPLAY 'ERROR ISSUED ON SELECT '                    48568000
485681             MOVE XLT00006-UPC-NBR TO PV-DISPLAY-UPC-NBR          48568100
485682             DISPLAY 'COMP UPC     :           '                  48568200
485683                      PV-DISPLAY-UPC-NBR                          48568300
485684             DISPLAY 'CARTON       :           '                  48568400
485685                      PW-ASNCAR-ASNCAR-NBR                        48568500
485686             DISPLAY 'ASN             :        '                  48568600
485687                      PW-ASNHDR-NBR                               48568700
485688             MOVE PURITM-PO-NBR TO PV-DISPLAY-PO-NBR              48568800
485689             DISPLAY 'PO NUMBER       :        '                  48568900
485690                      PV-DISPLAY-PO-NBR                           48569000
485691             DISPLAY '******************************************' 48569100
485692             PERFORM Z900-SQL-ERROR                               48569200
485693     END-EVALUATE.                                                48569300
485694***************************************************************** 48569400
485695*     COMPARE PACK VS COMPONENTS                                  48569500
485696***************************************************************** 48569600
485697*                                                                 48569700
485698 K902-COMPARE.                                                    48569800
485699     PERFORM                                                      48569900
485700        VARYING WS-SUB3 FROM 1 BY 1                               48570000
485800        UNTIL WS-PACK-LN-UPC(WS-CURR-PACK, WS-SUB3) NOT > 0 OR    48580000
485900              WS-SUB3 > 1000                                      48590000
486000        PERFORM                                                   48600000
486100           VARYING WS-SUB4 FROM 1 BY 1                            48610000
486200           UNTIL WS-PRPK-COMP-UPC(WS-SUB4) NOT > 0 OR             48620000
486300                 WS-SUB4 > 1000                                   48630000
486400           IF WS-PACK-LN-UPC(WS-CURR-PACK, WS-SUB3) =             48640000
486500              WS-PRPK-COMP-UPC(WS-SUB4)                           48650000
486600              MOVE 'X' TO WS-PACK-MATCH(WS-CURR-PACK, WS-SUB3)    48660000
486700              MOVE 'X' TO WS-PRPK-MATCH(WS-SUB4)                  48670000
486800              MOVE WS-PACK-ID(WS-CURR-PACK) TO                    48680000
486900                 WS-PRPK-PACK-ID(WS-SUB4)                         48690000
487000           ELSE                                                   48700000
487100              MOVE WS-PACK-ID(WS-CURR-PACK) TO                    48710000
487200                 WS-PRPK-PACK-ID(WS-SUB4)                         48720000
487300           END-IF                                                 48730000
487400        END-PERFORM                                               48740000
487500     END-PERFORM.                                                 48750000
487600                                                                  48760000
487700***************************************************************** 48770000
487800*     CHECK PACK ERRORS                                           48780000
487900***************************************************************** 48790000
488000*                                                                 48800000
488100 K903-CHECK-PACK-ERRORS.                                          48810000
488200     SET NOT-END-OF-PACK-COMP TO TRUE.                            48820000
488300     PERFORM                                                      48830000
488400        VARYING WS-SUB3 FROM 1 BY 1                               48840000
488500        UNTIL WS-SUB3 > 1000 OR                                   48850000
488600              WS-SUB3 > WS-PACK-COMPONENTS                        48860000
488700        IF WS-PACK-MATCH(WS-CURR-PACK, WS-SUB3) = 'X'             48870000
488800           MOVE ' ' TO WS-PACK-MATCH(WS-CURR-PACK, WS-SUB3)       48880000
488900        ELSE                                                      48890000
489000           PERFORM K926-MSG-12PP                                  48900000
489100        END-IF                                                    48910000
489200     END-PERFORM.                                                 48920000
489300*                                                                 48930000
489400***************************************************************** 48940000
489500*     CHECK COMPONENT ERRORS                                      48950000
489600***************************************************************** 48960000
489700*                                                                 48970000
489800 K904-CHECK-COMPONENT-ERRORS.                                     48980000
489900     SET NOT-END-OF-COMPONENTS TO TRUE.                           48990000
490000     PERFORM                                                      49000000
490100        VARYING WS-SUB3 FROM 1 BY 1                               49010000
490200        UNTIL WS-SUB3 > 1000 OR                                   49020000
490300              WS-SUB3 > WS-COMPONENTS                             49030000
490400        IF WS-PRPK-MATCH(WS-SUB3) = 'X'                           49040000
490500           MOVE ' ' TO WS-PRPK-MATCH(WS-SUB3)                     49050000
490600        ELSE                                                      49060000
490700           PERFORM K926-MSG-13PP                                  49070000
490800        END-IF                                                    49080000
490900     END-PERFORM.                                                 49090000
491000*                                                                 49100000
491100***************************************************************** 49110000
491200*     FIND LAST                                                   49120000
491300***************************************************************** 49130000
491400*                                                                 49140000
491500 K905-FIND-LAST.                                                  49150000
491600     SET NOT-END-OF-TBL TO TRUE.                                  49160000
491700     MOVE 0 TO WS-CURR-ELEMENT.                                   49170000
491800     PERFORM                                                      49180000
491900        VARYING WS-SUB3 FROM 1 BY 1                               49190000
492000        UNTIL END-OF-TBL OR                                       49200000
492100              WS-SUB3 > 10000                                     49210000
492200        ADD 1 TO WS-CURR-ELEMENT                                  49220000
492300        IF WS-PUB-SKU(WS-SUB3) > 0                                49230000
492400           CONTINUE                                               49240000
492500        ELSE                                                      49250000
492600           SET END-OF-TBL TO TRUE                                 49260000
492700        END-IF                                                    49270000
492800     END-PERFORM.                                                 49280000
492900*                                                                 49290000
493000***************************************************************** 49300000
493100*     FIND                                                        49310000
493200***************************************************************** 49320000
493300*                                                                 49330000
493400 K906-FIND.                                                       49340000
493500     SET PACK-ID-NOT-FOUND TO TRUE.                               49350000
493600     PERFORM                                                      49360000
493700        VARYING WS-SUB3 FROM 1 BY 1                               49370000
493800        UNTIL (WS-PUB-PO(WS-SUB3) = 0 AND                         49380000
493900               WS-PUB-SKU(WS-SUB3) = 0)    OR                     49390000
494000              PACK-ID-FOUND                OR                     49400000
494100              WS-SUB3 > 10000                                     49410000
494200        IF WS-PUB-PO(WS-SUB3) = PW-PO-NBR-N AND                   49420000
494300           WS-PUB-SKU(WS-SUB3) = POPRPK-PK-SKU-NBR                49430000
494400           SET PACK-ID-FOUND TO TRUE                              49440000
494500        END-IF                                                    49450000
494600     END-PERFORM.                                                 49460000
494700                                                                  49470000
494800***************************************************************** 49480000
494900*    GET PACK SKU                                                 49490000
495000***************************************************************** 49500000
495100 K907-GET-PACK-SKU.                                               49510000
495200                                                                  49520000
495300     EXEC SQL                                                     49530000
495400        SELECT A.PK_SKU_NBR                                       49540000
495500          INTO :POPRPK-PK-SKU-NBR                                 49550000
495600          FROM TPOPRPK A                                          49560000
495700          WHERE A.PO_NBR     = :POPRPK-PO-NBR      AND            49570000
495800                A.PO_PREPK_ID = :POPRPK-PO-PREPK-ID               49580000
495900     END-EXEC.                                                    49590000
496000                                                                  49600000
496100     MOVE SQLCODE    TO SQLCODE2.                                 49610000
496200                                                                  49620000
496300     EVALUATE TRUE                                                49630000
496400        WHEN SQLCODE = 0                                          49640000
496500           CONTINUE                                               49650000
496600        WHEN OTHER                                                49660000
496700             DISPLAY '******************************************' 49670000
496800             DISPLAY 'K907-GET-PACK-SKU'                          49680000
496900             DISPLAY 'SQLCODE => ' SQLCODE2                       49690000
497000             DISPLAY 'ERROR ISSUED ON SELECT   '                  49700000
497100             DISPLAY 'PACK ID      :           '                  49710000
497200                      POPRPK-PO-PREPK-ID                          49720000
497300             DISPLAY 'PO           :           '                  49730000
497400                      POPRPK-PO-NBR                               49740000
497500             DISPLAY '******************************************' 49750000
497600             PERFORM Z900-SQL-ERROR                               49760000
497700     END-EVALUATE.                                                49770000
497800*                                                                 49780000
497900***************************************************************** 49790000
498000*     FIND PACK                                                   49800000
498100***************************************************************** 49810000
498200*                                                                 49820000
498300 K908-FIND-PACK.                                                  49830000
498400     SET PACK-PACK-NOT-FOUND TO TRUE.                             49840000
498500     PERFORM                                                      49850000
498600        VARYING WS-SUB3 FROM 1 BY 1                               49860000
498700        UNTIL (WS-PACK-PACK-UPC(WS-SUB3)  = 0) OR                 49870000
498800              PACK-PACK-FOUND                  OR                 49880000
498900              WS-SUB3 > 10000                                     49890000
499000        IF WS-PACK-PACK-UPC(WS-SUB3) = HOLD-PACK-UPC-NBR AND      49900000
499100           WS-PACK-COMP-UPC(WS-SUB3) = HOLD-COMP-UPC-NBR          49910000
499200           SET PACK-PACK-FOUND TO TRUE                            49920000
499300        END-IF                                                    49930000
499400     END-PERFORM.                                                 49940000
499500*                                                                 49950000
499600***************************************************************** 49960000
499700*     FIND LAST PACK                                              49970000
499800***************************************************************** 49980000
499900*                                                                 49990000
500000 K909-FIND-LAST-PACK.                                             50000000
500100     SET NOT-END-OF-TBL TO TRUE.                                  50010000
500200     MOVE 0 TO WS-CURR-ELEMENT.                                   50020000
500300     PERFORM                                                      50030000
500400        VARYING WS-SUB3 FROM 1 BY 1                               50040000
500500        UNTIL END-OF-TBL OR                                       50050000
500600              WS-SUB3 > 10000                                     50060000
500700        ADD 1 TO WS-CURR-ELEMENT                                  50070000
500800        IF WS-PACK-PACK-UPC(WS-SUB3) > 0                          50080000
500900           CONTINUE                                               50090000
501000        ELSE                                                      50100000
501100           SET END-OF-TBL TO TRUE                                 50110000
501200        END-IF                                                    50120000
501300     END-PERFORM.                                                 50130000
501400*                                                                 50140000
501500***************************************************************** 50150000
501600*     FIND LAST UPC                                               50160000
501700***************************************************************** 50170000
501800*                                                                 50180000
501900 K910-FIND-LAST-UPC.                                              50190000
502000     SET NOT-END-OF-TBL TO TRUE.                                  50200000
502100     MOVE 0 TO WS-CURR-ELEMENT.                                   50210000
502200     PERFORM                                                      50220000
502300        VARYING WS-SUB3 FROM 1 BY 1                               50230000
502400        UNTIL END-OF-TBL OR                                       50240000
502500              WS-SUB3 > 10000                                     50250000
502600        ADD 1 TO WS-CURR-ELEMENT                                  50260000
502700        IF WS-COMP-COMP-UPC(WS-SUB3) > 0                          50270000
502800           CONTINUE                                               50280000
502900        ELSE                                                      50290000
503000           SET END-OF-TBL TO TRUE                                 50300000
503100        END-IF                                                    50310000
503200     END-PERFORM.                                                 50320000
503300*                                                                 50330000
503400***************************************************************** 50340000
503500*     FIND UPC                                                    50350000
503600***************************************************************** 50360000
503700*                                                                 50370000
503800 K911-FIND-UPC.                                                   50380000
503900     SET PO-COMP-NOT-FOUND TO TRUE.                               50390000
504000     PERFORM                                                      50400000
504100        VARYING WS-SUB3 FROM 1 BY 1                               50410000
504200        UNTIL (WS-COMP-COMP-UPC(WS-SUB3)  = 0) OR                 50420000
504300              PO-COMP-FOUND                  OR                   50430000
504400              WS-SUB3 > 10000                                     50440000
504500        IF WS-COMP-COMP-UPC(WS-SUB3) = HOLD-COMP-UPC-NBR AND      50450000
504600           WS-COMP-PO-UPC(WS-SUB3) = HOLD-COMP-PO-NBR             50460000
504700           SET PO-COMP-FOUND TO TRUE                              50470000
504800        END-IF                                                    50480000
504900     END-PERFORM.                                                 50490000
505000*                                                                 50500000
505100***************************************************************** 50510000
505200*     FIND PO                                                     50520000
505300***************************************************************** 50530000
505400*                                                                 50540000
505500 K912-FIND-PO.                                                    50550000
505600     SET PO-NOT-FOUND TO TRUE.                                    50560000
505700     PERFORM                                                      50570000
505800        VARYING WS-SUB3 FROM 1 BY 1                               50580000
505900        UNTIL WS-PUB-PO(WS-SUB3) = 0    OR                        50590000
506000              PO-FOUND                  OR                        50600000
506100              WS-SUB3 > 10000                                     50610000
506200        IF WS-PUB-PO-2(WS-SUB3) = PW-PO-NBR-N                     50620000
506300           SET PO-FOUND TO TRUE                                   50630000
506400        END-IF                                                    50640000
506500     END-PERFORM.                                                 50650000
506600*                                                                 50660000
506700***************************************************************** 50670000
506800*     FIND LAST PO                                                50680000
506900***************************************************************** 50690000
507000*                                                                 50700000
507100 K913-FIND-LAST-PO.                                               50710000
507200     SET NOT-END-OF-TBL TO TRUE.                                  50720000
507300     MOVE 0 TO WS-CURR-ELEMENT.                                   50730000
507400     PERFORM                                                      50740000
507500        VARYING WS-SUB3 FROM 1 BY 1                               50750000
507600        UNTIL END-OF-TBL OR                                       50760000
507700              WS-SUB3 > 10000                                     50770000
507800        ADD 1 TO WS-CURR-ELEMENT                                  50780000
507900        IF WS-PUB-PO-2(WS-SUB3) > 0                               50790000
508000           CONTINUE                                               50800000
508100        ELSE                                                      50810000
508200           SET END-OF-TBL TO TRUE                                 50820000
508300        END-IF                                                    50830000
508400     END-PERFORM.                                                 50840000
508500/                                                                 50850000
508600***************************************************************** 50860000
508700*     GET PO NUMERIC                                              50870000
508800*                                                                 50880000
508900***************************************************************** 50890000
509000 K925-GET-PO-NUMERIC.                                             50900000
509100                                                                  50910000
509200*PS 11/07/2014 CHANGE STARTS                                      50920000
509300     MOVE 8                      TO DP010I-MAXIMUM-DIGITS.        50930000
509400*PS 11/07/2014 CHANGE ENDS                                        50940000
509500     MOVE ZERO                   TO DP010I-MAXIMUM-DECIMALS.      50950000
509600     SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE.                     50960000
509710     CALL DP010I-NUMERIC-EDIT-ROUTINE                             50971001
509720          USING DP010I-NUMERIC-EDIT-AREA.                         50972002
509800     IF DP010I-ERROR-DETECTED                                     50980000
509900         MOVE ZERO           TO PW-PO-NBR-N                       50990000
510000     ELSE                                                         51000000
510100         MOVE DP010I-NUMERIC-FIELD                                51010000
510200                             TO PW-PO-NBR-N                       51020000
510300     END-IF.                                                      51030000
510400*                                                                 51040000
510500***************************************************************** 51050000
510600*     MSG-11                                                      51060000
510700*                                                                 51070000
510800***************************************************************** 51080000
510900 K926-MSG-11PP.                                                   51090000
511000      MOVE PW-ASNHDR-NBR       TO PSRL-ASNHDR-NBR.                51100000
511100      MOVE PW-HOLD-VEND-DUNNS-NBR                                 51110000
511200                               TO PSRL-DUNNS-NBR.                 51120000
511300      MOVE PW-HOLD-VENDOR-NAME TO PSRL-VENDOR-NAME.               51130000
511400      MOVE PW-HOLD-ISA-CNTL-NBR                                   51140000
511500                               TO PSRL-ISA-NBR.                   51150000
511600      MOVE PSRL-REPORT-LINE-1  TO PW-ADV-SHIP-NOTICE-LINE.        51160000
511700*     PERFORM Z510-WRITE-REPORT-LINE.                             51170000
511800      MOVE PW-ADV-SHIP-NOTICE-LINE (1:130) TO ASN-LOG-REC.        51180000
511900      WRITE ASN-LOG-REC.                                          51190000
511910      ADD 1 TO PV-ASN-ERROR-LOG-COUNT.                            51191005
512000      MOVE PW-ASNCAR-ASNCAR-NBR TO WS-CARTON-NBR.                 51200000
512100      MOVE WS-PRPK-COMP-UPC(WS-SUB3) TO                           51210000
512200         WS-COMP-UPC-NBR.                                         51220000
512300      MOVE PW-ASNORD-PO-NBR TO WS-PO.                             51230000
512400      MOVE MSG-11              TO PSRL-RPT-LINE-2.                51240000
512500      MOVE PSRL-REPORT-LINE-2  TO PW-ADV-SHIP-NOTICE-LINE.        51250000
512600*     PERFORM Z500-WRITE-REPORT-LINE.                             51260000
512700      MOVE PW-ADV-SHIP-NOTICE-LINE (1:130) TO ASN-LOG-REC.        51270000
512800      WRITE ASN-LOG-REC.                                          51280000
512810      ADD 1 TO PV-ASN-ERROR-LOG-COUNT.                            51281005
512900***************************************************************** 51290000
513000*     MSG-12                                                      51300000
513100*                                                                 51310000
513200***************************************************************** 51320000
513300 K926-MSG-12PP.                                                   51330000
513400      MOVE PW-ASNHDR-NBR       TO PSRL-ASNHDR-NBR.                51340000
513500      MOVE PW-HOLD-VEND-DUNNS-NBR                                 51350000
513600                               TO PSRL-DUNNS-NBR.                 51360000
513700      MOVE PW-HOLD-VENDOR-NAME TO PSRL-VENDOR-NAME.               51370000
513800      MOVE PW-HOLD-ISA-CNTL-NBR                                   51380000
513900                               TO PSRL-ISA-NBR.                   51390000
514000      MOVE PSRL-REPORT-LINE-1  TO PW-ADV-SHIP-NOTICE-LINE.        51400000
514100*     PERFORM Z510-WRITE-REPORT-LINE.                             51410000
514200      MOVE PW-ADV-SHIP-NOTICE-LINE (1:130) TO ASN-LOG-REC.        51420000
514300      WRITE ASN-LOG-REC.                                          51430000
514310      ADD 1 TO PV-ASN-ERROR-LOG-COUNT.                            51431005
514400      MOVE PW-ASNCAR-ASNCAR-NBR TO WS-CARTON-NBR2.                51440000
514500      MOVE WS-PACK-LN-UPC(WS-CURR-PACK, WS-SUB3) TO               51450000
514600         WS-COMP-UPC-NBR2.                                        51460000
514700      MOVE PW-ASNORD-PO-NBR TO WS-PO2.                            51470000
514800      MOVE MSG-12              TO PSRL-RPT-LINE-2.                51480000
514900      MOVE PSRL-REPORT-LINE-2  TO PW-ADV-SHIP-NOTICE-LINE.        51490000
515000*     PERFORM Z500-WRITE-REPORT-LINE.                             51500000
515100      MOVE PW-ADV-SHIP-NOTICE-LINE (1:130) TO ASN-LOG-REC.        51510000
515200      WRITE ASN-LOG-REC.                                          51520000
515210      ADD 1 TO PV-ASN-ERROR-LOG-COUNT.                            51521005
515300***************************************************************** 51530000
515400*     MSG-13                                                      51540000
515500*                                                                 51550000
515600***************************************************************** 51560000
515700 K926-MSG-13PP.                                                   51570000
515800      MOVE PW-ASNHDR-NBR       TO PSRL-ASNHDR-NBR.                51580000
515900      MOVE PW-HOLD-VEND-DUNNS-NBR                                 51590000
516000                               TO PSRL-DUNNS-NBR.                 51600000
516100      MOVE PW-HOLD-VENDOR-NAME TO PSRL-VENDOR-NAME.               51610000
516200      MOVE PW-HOLD-ISA-CNTL-NBR                                   51620000
516300                               TO PSRL-ISA-NBR.                   51630000
516400      MOVE PSRL-REPORT-LINE-1  TO PW-ADV-SHIP-NOTICE-LINE.        51640000
516500*     PERFORM Z510-WRITE-REPORT-LINE.                             51650000
516600      MOVE PW-ADV-SHIP-NOTICE-LINE (1:130) TO ASN-LOG-REC.        51660000
516700      WRITE ASN-LOG-REC.                                          51670000
516710      ADD 1 TO PV-ASN-ERROR-LOG-COUNT.                            51671005
516800      MOVE PW-ASNCAR-ASNCAR-NBR TO WS-CARTON-NBR3.                51680000
516900      MOVE WS-PRPK-COMP-UPC(WS-SUB3) TO                           51690000
517000         WS-COMP-UPC-NBR3.                                        51700000
517100      MOVE PW-ASNORD-PO-NBR TO WS-PO3.                            51710000
517200      MOVE MSG-13              TO PSRL-RPT-LINE-2.                51720000
517300      MOVE PSRL-REPORT-LINE-2  TO PW-ADV-SHIP-NOTICE-LINE.        51730000
517400*     PERFORM Z500-WRITE-REPORT-LINE.                             51740000
517500      MOVE PW-ADV-SHIP-NOTICE-LINE (1:130) TO ASN-LOG-REC.        51750000
517600      WRITE ASN-LOG-REC.                                          51760000
517610      ADD 1 TO PV-ASN-ERROR-LOG-COUNT.                            51761005
517700***************************************************************** 51770000
517800*     MSG-14                                                      51780000
517900*                                                                 51790000
518000***************************************************************** 51800000
518100 K926-MSG-14PP.                                                   51810000
518200      MOVE PW-ASNHDR-NBR       TO PSRL-ASNHDR-NBR.                51820000
518300      MOVE PW-HOLD-VEND-DUNNS-NBR                                 51830000
518400                               TO PSRL-DUNNS-NBR.                 51840000
518500      MOVE PW-HOLD-VENDOR-NAME TO PSRL-VENDOR-NAME.               51850000
518600      MOVE PW-HOLD-ISA-CNTL-NBR                                   51860000
518700                               TO PSRL-ISA-NBR.                   51870000
518800      MOVE PSRL-REPORT-LINE-1  TO PW-ADV-SHIP-NOTICE-LINE.        51880000
518900*     PERFORM Z510-WRITE-REPORT-LINE.                             51890000
519000      MOVE PW-ADV-SHIP-NOTICE-LINE (1:130) TO ASN-LOG-REC.        51900000
519100      WRITE ASN-LOG-REC.                                          51910000
519110      ADD 1 TO PV-ASN-ERROR-LOG-COUNT.                            51911005
519200      MOVE PW-ASNCAR-ASNCAR-NBR TO WS-CARTON-NBR4.                51920000
519300      MOVE XLT00006-UPC-NBR TO                                    51930000
519400         WS-COMP-UPC-NBR4.                                        51940000
519500      MOVE MSG-14              TO PSRL-RPT-LINE-2.                51950000
519600      MOVE PSRL-REPORT-LINE-2  TO PW-ADV-SHIP-NOTICE-LINE.        51960000
519700*     PERFORM Z500-WRITE-REPORT-LINE.                             51970000
519800      MOVE PW-ADV-SHIP-NOTICE-LINE (1:130) TO ASN-LOG-REC.        51980000
519900      WRITE ASN-LOG-REC.                                          51990000
519910      ADD 1 TO PV-ASN-ERROR-LOG-COUNT.                            51991005
520000***************************************************************** 52000000
520100*     MSG-15                                                      52010000
520200*                                                                 52020000
520300***************************************************************** 52030000
520400 K926-MSG-15PP.                                                   52040000
520500      MOVE PW-ASNHDR-NBR       TO PSRL-ASNHDR-NBR.                52050000
520600      MOVE PW-HOLD-VEND-DUNNS-NBR                                 52060000
520700                               TO PSRL-DUNNS-NBR.                 52070000
520800      MOVE PW-HOLD-VENDOR-NAME TO PSRL-VENDOR-NAME.               52080000
520900      MOVE PW-HOLD-ISA-CNTL-NBR                                   52090000
521000                               TO PSRL-ISA-NBR.                   52100000
521100      MOVE PSRL-REPORT-LINE-1  TO PW-ADV-SHIP-NOTICE-LINE.        52110000
521200*     PERFORM Z510-WRITE-REPORT-LINE.                             52120000
521300      MOVE PW-ADV-SHIP-NOTICE-LINE (1:130) TO ASN-LOG-REC.        52130000
521400      WRITE ASN-LOG-REC.                                          52140000
521410      ADD 1 TO PV-ASN-ERROR-LOG-COUNT.                            52141005
521500      MOVE PW-ASNCAR-ASNCAR-NBR TO WS-CARTON-NBR5.                52150000
521600      MOVE PW-ASNORD-PO-NBR TO WS-PO5.                            52160000
521700      MOVE MSG-15              TO PSRL-RPT-LINE-2.                52170000
521800      MOVE PSRL-REPORT-LINE-2  TO PW-ADV-SHIP-NOTICE-LINE.        52180000
521900*     PERFORM Z500-WRITE-REPORT-LINE.                             52190000
522000      MOVE PW-ADV-SHIP-NOTICE-LINE (1:130) TO ASN-LOG-REC.        52200000
522100      WRITE ASN-LOG-REC.                                          52210000
522110      ADD 1 TO PV-ASN-ERROR-LOG-COUNT.                            52211005
522200***************************************************************** 52220000
522300*     MSG-16                                                      52230000
522400*                                                                 52240000
522500***************************************************************** 52250000
522600 K926-MSG-16PP.                                                   52260000
522700      MOVE PW-ASNHDR-NBR       TO PSRL-ASNHDR-NBR.                52270000
522800      MOVE PW-HOLD-VEND-DUNNS-NBR                                 52280000
522900                               TO PSRL-DUNNS-NBR.                 52290000
523000      MOVE PW-HOLD-VENDOR-NAME TO PSRL-VENDOR-NAME.               52300000
523100      MOVE PW-HOLD-ISA-CNTL-NBR                                   52310000
523200                               TO PSRL-ISA-NBR.                   52320000
523300      MOVE PSRL-REPORT-LINE-1  TO PW-ADV-SHIP-NOTICE-LINE.        52330000
523400      IF MULT-COMP-UPC                                            52340000
523500         PERFORM Z510-WRITE-REPORT-LINE                           52350000
523600      END-IF.                                                     52360000
523700      MOVE PW-ADV-SHIP-NOTICE-LINE (1:130) TO ASN-LOG-REC.        52370000
523800      WRITE ASN-LOG-REC.                                          52380000
523810      ADD 1 TO PV-ASN-ERROR-LOG-COUNT.                            52381005
523900      MOVE PW-ASNORD-LOC-NBR TO WS-STORE6.                        52390000
524000      MOVE HOLD-PACK-UPC-NBR TO WS-PACK-UPC-NBR6.                 52400000
524100      MOVE XLT00006-UPC-NBR TO WS-COMP-UPC-NBR6.                  52410000
524200      MOVE PW-ASNORD-PO-NBR TO WS-PO6.                            52420000
524300      MOVE MSG-16              TO PSRL-RPT-LINE-2.                52430000
524400      MOVE PSRL-REPORT-LINE-2  TO PW-ADV-SHIP-NOTICE-LINE.        52440000
524500      IF MULT-COMP-UPC                                            52450000
524600         PERFORM Z510-WRITE-REPORT-LINE                           52460000
524700      END-IF.                                                     52470000
524800      MOVE PW-ADV-SHIP-NOTICE-LINE (1:130) TO ASN-LOG-REC.        52480000
524900      WRITE ASN-LOG-REC.                                          52490000
524910      ADD 1 TO PV-ASN-ERROR-LOG-COUNT.                            52491005
525000***************************************************************** 52500000
525100*     MSG-17                                                      52510000
525200*                                                                 52520000
525300***************************************************************** 52530000
525400 K926-MSG-17PP.                                                   52540000
525500      MOVE PW-ASNHDR-NBR       TO PSRL-ASNHDR-NBR.                52550000
525600      MOVE PW-HOLD-VEND-DUNNS-NBR                                 52560000
525700                               TO PSRL-DUNNS-NBR.                 52570000
525800      MOVE PW-HOLD-VENDOR-NAME TO PSRL-VENDOR-NAME.               52580000
525900      MOVE PW-HOLD-ISA-CNTL-NBR                                   52590000
526000                               TO PSRL-ISA-NBR.                   52600000
526100      MOVE PSRL-REPORT-LINE-1  TO PW-ADV-SHIP-NOTICE-LINE.        52610000
526200*     PERFORM Z510-WRITE-REPORT-LINE.                             52620000
526300      MOVE PW-ADV-SHIP-NOTICE-LINE (1:130) TO ASN-LOG-REC.        52630000
526400      WRITE ASN-LOG-REC.                                          52640000
526410      ADD 1 TO PV-ASN-ERROR-LOG-COUNT.                            52641005
526500      MOVE PW-ASNCAR-ASNCAR-NBR TO WS-CARTON-NBR7.                52650000
526600      MOVE PW-ASNDTL-UPC-NBR TO                                   52660000
526700         WS-COMP-UPC-NBR7.                                        52670000
526800      MOVE PW-ASNORD-PO-NBR TO WS-PO7.                            52680000
526900      MOVE MSG-17              TO PSRL-RPT-LINE-2.                52690000
527000      MOVE PSRL-REPORT-LINE-2  TO PW-ADV-SHIP-NOTICE-LINE.        52700000
527100      MOVE PW-ADV-SHIP-NOTICE-LINE (1:130) TO ASN-LOG-REC.        52710000
527200      WRITE ASN-LOG-REC.                                          52720000
527210      ADD 1 TO PV-ASN-ERROR-LOG-COUNT.                            52721005
527300***************************************************************** 52730000
527400*     MSG-18                                                      52740000
527500*                                                                 52750000
527600***************************************************************** 52760000
527700 K926-MSG-18PP.                                                   52770000
527800      MOVE PW-ASNHDR-NBR       TO PSRL-ASNHDR-NBR.                52780000
527900      MOVE PW-HOLD-VEND-DUNNS-NBR                                 52790000
528000                               TO PSRL-DUNNS-NBR.                 52800000
528100      MOVE PW-HOLD-VENDOR-NAME TO PSRL-VENDOR-NAME.               52810000
528200      MOVE PW-HOLD-ISA-CNTL-NBR                                   52820000
528300                               TO PSRL-ISA-NBR.                   52830000
528400      MOVE PSRL-REPORT-LINE-1  TO PW-ADV-SHIP-NOTICE-LINE.        52840000
528500      IF PO-COMP-NOT-FOUND                                        52850000
528600         PERFORM Z510-WRITE-REPORT-LINE                           52860000
528700      END-IF.                                                     52870000
528800      MOVE PW-ADV-SHIP-NOTICE-LINE (1:130) TO ASN-LOG-REC.        52880000
528900      WRITE ASN-LOG-REC.                                          52890000
528910      ADD 1 TO PV-ASN-ERROR-LOG-COUNT.                            52891005
529000      MOVE PW-ASNCAR-ASNCAR-NBR TO WS-CARTON-NBR8.                52900000
529100      MOVE XLT00006-UPC-NBR TO WS-COMP-UPC-NBR8.                  52910000
529200      MOVE PW-ASNORD-PO-NBR TO WS-PO8.                            52920000
529300      MOVE MSG-18              TO PSRL-RPT-LINE-2.                52930000
529400      MOVE PSRL-REPORT-LINE-2  TO PW-ADV-SHIP-NOTICE-LINE.        52940000
529500      IF PO-COMP-NOT-FOUND                                        52950000
529600         PERFORM Z500-WRITE-REPORT-LINE                           52960000
529700      END-IF.                                                     52970000
529800      MOVE PW-ADV-SHIP-NOTICE-LINE (1:130) TO ASN-LOG-REC.        52980000
529900      WRITE ASN-LOG-REC.                                          52990000
529910      ADD 1 TO PV-ASN-ERROR-LOG-COUNT.                            52991005
530000/                                                                 53000000
530100***************************************************************** 53010000
530200*     INIT ASNCAR REC                                           * 53020000
530300*                                                               * 53030000
530400*     -  SAVE ITEM LEVEL TD5 RECORD FIELDS IN THE ASNDTL        * 53040000
530500*        RECORD IN WS                                           * 53050000
530600***************************************************************** 53060000
530700 L100-INIT-ASNCAR-REC.                                            53070000
530800     MOVE 'L100-INIT-ASNCAR-REC             '                     53080000
530900                                 TO PW-CURRENT-PARA.              53090000
531000*    DISPLAY 'L100-INIT-ASNCAR-REC'.                              53100000
531100                                                                  53110000
531200     INITIALIZE PW-ASNCAR-RECORD.                                 53120000
531300/                                                                 53130000
531400***************************************************************** 53140000
531500*     INIT LIN TABLE                                            * 53150000
531600*                                                               * 53160000
531700*   -                                                           * 53170000
531800*                                                               * 53180000
531900***************************************************************** 53190000
532000 L200-INIT-ASNDTL-REC.                                            53200000
532100     MOVE 'L200-INIT-ASNDTL-REC             '                     53210000
532200                                 TO PW-CURRENT-PARA.              53220000
532300*    DISPLAY 'L200-INIT-ASNDTL-REC'.                              53230000
532400                                                                  53240000
532500     INITIALIZE PW-ASNDTL-RECORD.                                 53250000
532600/                                                                 53260000
532700***************************************************************** 53270000
532800*     INIT LIN TABLE                                            * 53280000
532900*                                                               * 53290000
533000*   -                                                           * 53300000
533100*                                                               * 53310000
533200***************************************************************** 53320000
533300 L300-INIT-LIN-TABLE.                                             53330000
533400     MOVE 'L300-INIT-LIN-TABLE              '                     53340000
533500                                 TO PW-CURRENT-PARA.              53350000
533600*    DISPLAY 'L300-INIT-LIN-TABLE'.                               53360000
533700                                                                  53370000
533800     INITIALIZE PW-ITEM-IDENTIFICATION-TABLE.                     53380000
533900                                                                  53390000
534000***************************************************************** 53400000
534100*     READ UNTIL ID REC                                         * 53410000
534200*                                                               * 53420000
534300*     AN ERROR IN THE CURRENT ASN HAS BEEN DETECTED. THIS       * 53430000
534400*     PARAGRAPH WILL READ THE FILE UNTIL THE NEXT ASN IS FOUND  * 53440000
534500***************************************************************** 53450000
534600                                                                  53460000
534700 M000-READ-UNTIL-ID-REC.                                          53470000
534800                                                                  53480000
534900     PERFORM Z000-READ-ADV-SHIP-NOTICE                            53490000
535000       UNTIL ID-IDENTIFICATION-REC                                53500000
535100          OR END-OF-INP01.                                        53510000
535200/                                                                 53520000
535300***************************************************************** 53530000
535400*     SAVE N1 FIELDS                                            * 53540000
535500*                                                               * 53550000
535600*     -  SAVE THE SHIPMENT OR ORDER LEVEL NAME FIELDS IN WS     * 53560000
535700***************************************************************** 53570000
535800 S100-SAVE-N1-FIELDS.                                             53580000
535900     MOVE 'S100-SAVE-N1-FIELDS            '                       53590000
536000                                 TO PW-CURRENT-PARA.              53600000
536100*    DISPLAY 'S100-SAVE-N1-FIELDS'.                               53610000
536200                                                                  53620000
536300     SET N1-FOUND                TO TRUE.                         53630000
536400                                                                  53640000
536500     MOVE SN001I-N101-ID-CDE     TO PW-HOLD-NAME-CDE.             53650000
536600     MOVE SN001I-N102-CUST-NME   TO PW-HOLD-CUST-NAME.            53660000
536700     MOVE SN001I-N103-NME-ID-QUAL-CDE                             53670000
536800                                 TO PW-HOLD-NAME-ID-QUAL-CDE.     53680000
536900     IF SN001I-N101-ID-CDE = 'ST' OR 'BY'                         53690000
537000        PERFORM F050-INSPECT-NAME-ID-CODE                         53700000
537100        MOVE PW-NUMERIC-SEQ-NBR     TO PW-HOLD-NAME-ID-CDE-999    53710000
537200        MOVE SPACES                 TO PW-HOLD-NAME-ID-CDE-X      53720000
537300     ELSE                                                         53730000
537400        MOVE SN001I-N104-NME-ID-CDE TO PW-HOLD-NAME-ID-CDE        53740000
537500     END-IF.                                                      53750000
537600/                                                                 53760000
537700***************************************************************** 53770000
537800*     SAVE N2 FIELDS                                            * 53780000
537900*                                                               * 53790000
538000*     -  SAVE THE SHIPMENT OR ORDER LEVEL ADDITIONAL NAME       * 53800000
538100*        FIELDS IN A WS TABLE.                                  * 53810000
538200***************************************************************** 53820000
538300 S200-SAVE-N2-FIELDS.                                             53830000
538400     MOVE 'S200-SAVE-N2-FIELDS            '                       53840000
538500                                 TO PW-CURRENT-PARA.              53850000
538600*    DISPLAY 'S200-SAVE-N2-FIELDS'.                               53860000
538700                                                                  53870000
538800     IF SN001I-N201-NME1-TXT = SPACES                             53880000
538900         CONTINUE                                                 53890000
539000     ELSE                                                         53900000
539100         IF PW-NAME-SUB = PC-POS-4                                53910000
539200             MOVE PW-ASNHDR-NBR          TO PSRL-ASNHDR-NBR       53920000
539300             MOVE PW-HOLD-VEND-DUNNS-NBR TO PSRL-DUNNS-NBR        53930000
539400             MOVE PW-HOLD-VENDOR-NAME    TO PSRL-VENDOR-NAME      53940000
539500             MOVE PW-HOLD-ISA-CNTL-NBR                            53950000
539600                                         TO PSRL-ISA-NBR          53960000
539700             MOVE PSRL-REPORT-LINE-1   TO PW-ADV-SHIP-NOTICE-LINE 53970000
539800             PERFORM Z510-WRITE-REPORT-LINE                       53980000
539900             MOVE MSG-1C                 TO PSRL-RPT-LINE-2       53990000
540000             MOVE PSRL-REPORT-LINE-2   TO PW-ADV-SHIP-NOTICE-LINE 54000000
540100             PERFORM Z500-WRITE-REPORT-LINE                       54010000
540200             MOVE ADVANCE-SHIP-NOTICE-DTL-RECORD                  54020000
540300                                         TO MSG-1B-DTL            54030000
540400             MOVE MSG-1B                 TO PSRL-RPT-LINE-2       54040000
540500             MOVE PSRL-REPORT-LINE-2   TO PW-ADV-SHIP-NOTICE-LINE 54050000
540600             PERFORM Z500-WRITE-REPORT-LINE                       54060000
540700         ELSE                                                     54070000
540800             SET N2-FOUND        TO TRUE                          54080000
540900             ADD PC-POS-1        TO PW-NAME-SUB                   54090000
541000             MOVE SN001I-N201-NME1-TXT                            54100000
541100                                 TO PW-NAME-TXT (PW-NAME-SUB)     54110000
541200         END-IF                                                   54120000
541300     END-IF.                                                      54130000
541400                                                                  54140000
541500     IF SN001I-N202-NME2-TXT = SPACES                             54150000
541600         CONTINUE                                                 54160000
541700     ELSE                                                         54170000
541800         IF PW-NAME-SUB = PC-POS-4                                54180000
541900             MOVE PW-ASNHDR-NBR          TO PSRL-ASNHDR-NBR       54190000
542000             MOVE PW-HOLD-VEND-DUNNS-NBR TO PSRL-DUNNS-NBR        54200000
542100             MOVE PW-HOLD-VENDOR-NAME    TO PSRL-VENDOR-NAME      54210000
542200             MOVE PSRL-REPORT-LINE-1   TO PW-ADV-SHIP-NOTICE-LINE 54220000
542300             PERFORM Z510-WRITE-REPORT-LINE                       54230000
542400             MOVE MSG-1D                 TO PSRL-RPT-LINE-2       54240000
542500             MOVE PSRL-REPORT-LINE-2   TO PW-ADV-SHIP-NOTICE-LINE 54250000
542600             PERFORM Z500-WRITE-REPORT-LINE                       54260000
542700             MOVE ADVANCE-SHIP-NOTICE-DTL-RECORD                  54270000
542800                                         TO MSG-1B-DTL            54280000
542900             MOVE MSG-1B                 TO PSRL-RPT-LINE-2       54290000
543000             MOVE PSRL-REPORT-LINE-2   TO PW-ADV-SHIP-NOTICE-LINE 54300000
543100             PERFORM Z500-WRITE-REPORT-LINE                       54310000
543200         ELSE                                                     54320000
543300             SET N2-FOUND        TO TRUE                          54330000
543400             ADD PC-POS-1        TO PW-NAME-SUB                   54340000
543500             MOVE SN001I-N202-NME2-TXT                            54350000
543600                                 TO PW-NAME-TXT (PW-NAME-SUB)     54360000
543700         END-IF                                                   54370000
543800     END-IF.                                                      54380000
543900/                                                                 54390000
544000***************************************************************** 54400000
544100*     SAVE N3 FIELDS                                            * 54410000
544200*                                                               * 54420000
544300*     -  SAVE THE SHIPMENT OR ORDER LEVEL ADDITIONAL ADDRESS    * 54430000
544400*        FIELDS IN A WS TABLE.                                  * 54440000
544500***************************************************************** 54450000
544600 S300-SAVE-N3-FIELDS.                                             54460000
544700     MOVE 'S300-SAVE-N3-FIELDS            '                       54470000
544800                                 TO PW-CURRENT-PARA.              54480000
544900*    DISPLAY 'S300-SAVE-N3-FIELDS'.                               54490000
545000                                                                  54500000
545100     IF SN001I-N301-ADR1-TXT = SPACES                             54510000
545200         CONTINUE                                                 54520000
545300     ELSE                                                         54530000
545400         IF PW-ADDR-SUB = PC-POS-4                                54540000
545500             MOVE PW-ASNHDR-NBR          TO PSRL-ASNHDR-NBR       54550000
545600             MOVE PW-HOLD-VEND-DUNNS-NBR TO PSRL-DUNNS-NBR        54560000
545700             MOVE PW-HOLD-VENDOR-NAME    TO PSRL-VENDOR-NAME      54570000
545800             MOVE PW-HOLD-ISA-CNTL-NBR                            54580000
545900                                         TO PSRL-ISA-NBR          54590000
546000             MOVE PSRL-REPORT-LINE-1   TO PW-ADV-SHIP-NOTICE-LINE 54600000
546100             PERFORM Z510-WRITE-REPORT-LINE                       54610000
546200             MOVE MSG-1C                 TO PSRL-RPT-LINE-2       54620000
546300             MOVE PSRL-REPORT-LINE-2   TO PW-ADV-SHIP-NOTICE-LINE 54630000
546400             PERFORM Z500-WRITE-REPORT-LINE                       54640000
546500             MOVE ADVANCE-SHIP-NOTICE-DTL-RECORD                  54650000
546600                                         TO MSG-1B-DTL            54660000
546700             MOVE MSG-1B                 TO PSRL-RPT-LINE-2       54670000
546800             MOVE PSRL-REPORT-LINE-2   TO PW-ADV-SHIP-NOTICE-LINE 54680000
546900             PERFORM Z500-WRITE-REPORT-LINE                       54690000
547000         ELSE                                                     54700000
547100             SET N3-FOUND        TO TRUE                          54710000
547200             ADD PC-POS-1        TO PW-ADDR-SUB                   54720000
547300             MOVE SN001I-N301-ADR1-TXT                            54730000
547400                                 TO PW-ADDR-TXT (PW-ADDR-SUB)     54740000
547500         END-IF                                                   54750000
547600     END-IF.                                                      54760000
547700                                                                  54770000
547800     IF SN001I-N202-NME2-TXT = SPACES                             54780000
547900         CONTINUE                                                 54790000
548000     ELSE                                                         54800000
548100         IF PW-ADDR-SUB = PC-POS-4                                54810000
548200             MOVE PW-ASNHDR-NBR          TO PSRL-ASNHDR-NBR       54820000
548300             MOVE PW-HOLD-VEND-DUNNS-NBR TO PSRL-DUNNS-NBR        54830000
548400             MOVE PW-HOLD-VENDOR-NAME    TO PSRL-VENDOR-NAME      54840000
548500             MOVE PW-HOLD-ISA-CNTL-NBR                            54850000
548600                                         TO PSRL-ISA-NBR          54860000
548700             MOVE PSRL-REPORT-LINE-1   TO PW-ADV-SHIP-NOTICE-LINE 54870000
548800             PERFORM Z510-WRITE-REPORT-LINE                       54880000
548900             MOVE MSG-1D                 TO PSRL-RPT-LINE-2       54890000
549000             MOVE PSRL-REPORT-LINE-2   TO PW-ADV-SHIP-NOTICE-LINE 54900000
549100             PERFORM Z500-WRITE-REPORT-LINE                       54910000
549200             MOVE ADVANCE-SHIP-NOTICE-DTL-RECORD                  54920000
549300                                         TO MSG-1B-DTL            54930000
549400             MOVE MSG-1B                 TO PSRL-RPT-LINE-2       54940000
549500             MOVE PSRL-REPORT-LINE-2   TO PW-ADV-SHIP-NOTICE-LINE 54950000
549600             PERFORM Z500-WRITE-REPORT-LINE                       54960000
549700         ELSE                                                     54970000
549800             SET N3-FOUND        TO TRUE                          54980000
549900             ADD PC-POS-1        TO PW-ADDR-SUB                   54990000
550000             MOVE SN001I-N302-ADR2-TXT                            55000000
550100                                 TO PW-ADDR-TXT (PW-ADDR-SUB)     55010000
550200         END-IF                                                   55020000
550300     END-IF.                                                      55030000
550400/                                                                 55040000
550500***************************************************************** 55050000
550600*     SAVE N4 FIELDS                                            * 55060000
550700*                                                               * 55070000
550800*     -  SAVE THE SHIPMENT OR ORDER LEVEL GEOGRAPHICAL LOCATION * 55080000
550900*        FIELDS IN WS.                                          * 55090000
551000***************************************************************** 55100000
551100 S400-SAVE-N4-FIELDS.                                             55110000
551200     MOVE 'S400-SAVE-N4-FIELDS            '                       55120000
551300                                 TO PW-CURRENT-PARA.              55130000
551400*    DISPLAY 'S400-SAVE-N4-FIELDS'.                               55140000
551500                                                                  55150000
551600     IF N4-FOUND                                                  55160000
551700         MOVE PW-ASNHDR-NBR          TO PSRL-ASNHDR-NBR           55170000
551800         MOVE PW-HOLD-VEND-DUNNS-NBR TO PSRL-DUNNS-NBR            55180000
551900         MOVE PW-HOLD-VENDOR-NAME    TO PSRL-VENDOR-NAME          55190000
552000         MOVE PW-HOLD-ISA-CNTL-NBR                                55200000
552100                                     TO PSRL-ISA-NBR              55210000
552200         MOVE PSRL-REPORT-LINE-1     TO PW-ADV-SHIP-NOTICE-LINE   55220000
552300         PERFORM Z510-WRITE-REPORT-LINE                           55230000
552400         IF PS-SHIPMENT                                           55240000
552500            MOVE MSG-1S                 TO PSRL-RPT-LINE-2        55250000
552600            MOVE PSRL-REPORT-LINE-2     TO PW-ADV-SHIP-NOTICE-LINE55260000
552700            PERFORM Z500-WRITE-REPORT-LINE                        55270000
552800            MOVE ADVANCE-SHIP-NOTICE-DTL-RECORD                   55280000
552810                                        TO MSG-1B-DTL             55281000
552820            MOVE MSG-1B                 TO PSRL-RPT-LINE-2        55282000
552830            MOVE PSRL-REPORT-LINE-2     TO PW-ADV-SHIP-NOTICE-LINE55283000
552840            PERFORM Z500-WRITE-REPORT-LINE                        55284000
552850         ELSE                                                     55285000
552860         IF PS-ORDER                                              55286000
552870            MOVE MSG-1O                 TO PSRL-RPT-LINE-2        55287000
552880            MOVE PSRL-REPORT-LINE-2     TO PW-ADV-SHIP-NOTICE-LINE55288000
552890            PERFORM Z500-WRITE-REPORT-LINE                        55289000
552900            MOVE ADVANCE-SHIP-NOTICE-DTL-RECORD                   55290000
553000                                        TO MSG-1B-DTL             55300000
553100            MOVE MSG-1B                 TO PSRL-RPT-LINE-2        55310000
553200            MOVE PSRL-REPORT-LINE-2     TO PW-ADV-SHIP-NOTICE-LINE55320000
553300            PERFORM Z500-WRITE-REPORT-LINE                        55330000
553400         END-IF                                                   55340000
553500         END-IF                                                   55350000
553600     ELSE                                                         55360000
553610         SET N4-FOUND            TO TRUE                          55361000
553620                                                                  55362000
553630         MOVE SN001I-N401-CTY-NAME                                55363000
553640                                 TO PW-HOLD-CTY-NAME              55364000
553650         MOVE SN001I-N402-ST-CDE TO PW-HOLD-ST-CDE                55365000
553660         MOVE SN001I-N403-ZIP-CDE                                 55366000
553670                                 TO PW-HOLD-ZIP-CDE               55367000
553680         MOVE SN001I-N404-CNTRY-CDE                               55368000
553690                                 TO PW-HOLD-CNTRY-CDE             55369000
553700     END-IF.                                                      55370000
553800/                                                                 55380000
553900****************************************************************  55390000
554000*     PROCESS-TOTAL-LINE                                       *  55400000
554100*                                                              *  55410000
554200*     -  CONTROL THE LOADING AND PRINTING OF TOTAL LINE        *  55420000
554300****************************************************************  55430000
554400 T000-PROCESS-TOTAL-LINES.                                        55440000
554500     MOVE 'T000-PROCESS-TOTAL-LINES       '                       55450000
554600                                 TO PW-CURRENT-PARA.              55460000
554700*    DISPLAY 'T000-PROCESS-TOTAL-LINES'.                          55470000
554800                                                                  55480000
554900     MOVE PA-ASNHDR-INSERTED     TO TL1-ASNHDR-INSERTED.          55490000
555000     MOVE PA-ASNHDR-DELETED      TO TL2-ASNHDR-DELETED.           55500000
555100                                                                  55510000
555200     MOVE TL1-TOTAL-LINE1        TO PW-ADV-SHIP-NOTICE-LINE.      55520000
555300     PERFORM Z510-WRITE-REPORT-LINE.                              55530000
555400                                                                  55540000
555500     MOVE TL2-TOTAL-LINE2        TO PW-ADV-SHIP-NOTICE-LINE.      55550000
555600     PERFORM Z500-WRITE-REPORT-LINE.                              55560000
555700                                                                  55570000
555800     MOVE END-OF-REPORT-LINE     TO PW-ADV-SHIP-NOTICE-LINE.      55580000
555900     PERFORM Z510-WRITE-REPORT-LINE.                              55590000
556000                                                                  55600000
556100* DMH 03/07/16 BEGIN                                              55610000
556200     MOVE  PV-UPC-TRACK-COUNT      TO  PV-UPC-TRACK-DISP.         55620000
556300     DISPLAY ' PROCESS TMST:         '  PV-PROCESS-TMST.          55630000
556400     DISPLAY ' CARRIER TRACKING RECS:'  PV-UPC-TRACK-DISP.        55640000
556500* DMH 03/07/16 BEGIN                                              55650000
556600                                                                  55660000
556700                                                                  55670000
556800*RSC                                                              55680000
556900************************************************************      55690000
557000*     WRITE-REPORT-LINE                                           55700000
557100************************************************************      55710000
557200*W000-WRITE-REPORT-LINE.                                          55720000
557300*    MOVE 'W000-WRITE-REPORT-LINE     '                           55730000
557400*                                TO PW-CURRENT-PARA.              55740000
557500*                                                                 55750000
557600*    ADD 1                       TO PV-LINE-CNT.                  55760000
557700*                                                                 55770000
557800*    IF PV-LINE-CNT > PC-POS-54                                   55780000
557900*        PERFORM W100-PROCESS-HEADING-LINES                       55790000
558000*    END-IF.                                                      55800000
558100*                                                                 55810000
558200*    WRITE ASN-REPORT                                             55820000
558300*      AFTER ADVANCING 1 LINES.                                   55830000
558400*                                                                 55840000
558500************************************************************      55850000
558600*     PROCESS-HEADING-LINES                                       55860000
558700************************************************************      55870000
558800*W100-PROCESS-HEADING-LINES.                                      55880000
558900*    MOVE 'W100-PROCESS-HEADING-LINES '                           55890000
559000*                                TO PW-CURRENT-PARA.              55900000
559100*                                                                 55910000
559200*    MOVE 'SNKRP001'             TO DP132O-PROGRAM-NAME.          55920000
559300*    MOVE 2                      TO DP132O-REPORT-NUMBER.         55930000
559400*                                                                 55940000
559500*    ADD 1                       TO PV-PAGE-CNT.                  55950000
559600*    MOVE PV-PAGE-CNT            TO DP132O-PAGE-NUMBER.           55960000
559700*                                                                 55970000
559800*    WRITE ASN-REPORT                                             55980000
559900*       FROM DP132O-STANDRD-HEADER-132-COLS                       55990000
560000*       AFTER ADVANCING PAGE.                                     56000000
560100*                                                                 56010000
560200*    MOVE PR-HEADER TO ASN-REPORT.                                56020000
560300*                                                                 56030000
560400*    WRITE ASN-REPORT                                             56040000
560500*        AFTER ADVANCING 1 LINE.                                  56050000
560600*                                                                 56060000
560700*    MOVE 1                      TO PV-LINE-CNT.                  56070000
560800*                                                                 56080000
560900*RSC                                                              56090000
561000***************************************************************** 56100000
561100*     SET NULLS ASNHDR                                          * 56110000
561200*                                                               * 56120000
561300*     -  SET ALL ASNHDR RECORD NULL INDICATORS                  * 56130000
561400***************************************************************** 56140000
561500 X110-SET-NULLS-ASNHDR.                                           56150000
561600     MOVE 'X110-SET-NULLS-ASNHDR             '                    56160000
561700                                 TO PW-CURRENT-PARA.              56170000
561800*    DISPLAY 'X110-SET-NULLS-ASNHDR'.                             56180000
561900                                                                  56190000
562000     IF PW-ASNHDR-PRO-NBR = SPACES                                56200000
562100         MOVE PC-NEG-1           TO PV-PRO-NBR-NULL               56210000
562200     ELSE                                                         56220000
562300         MOVE ZEROES             TO PV-PRO-NBR-NULL               56230000
562400     END-IF.                                                      56240000
562500                                                                  56250000
562600     IF PW-ASNHDR-GRO-WGHT-MSMT = ZEROES                          56260000
562700         MOVE PC-NEG-1           TO PV-GRO-WGHT-MSMT-NULL         56270000
562800     ELSE                                                         56280000
562900         MOVE ZEROES             TO PV-GRO-WGHT-MSMT-NULL         56290000
563000     END-IF.                                                      56300000
563100                                                                  56310000
563200     IF PW-HOLD-ANTC-DELY-DTE = ZEROES                            56320000
563300         MOVE PC-NEG-1           TO PV-ANTC-DELY-DTE-NULL         56330000
563400     ELSE                                                         56340000
563500         MOVE ZEROES             TO PV-ANTC-DELY-DTE-NULL         56350000
563600     END-IF.                                                      56360000
563700                                                                  56370000
563800     IF PW-ASNHDR-SHIPT-STATUS-CDE = SPACES                       56380000
563900         MOVE PC-NEG-1           TO PV-SHIPT-STATUS-CDE-NULL      56390000
564000     ELSE                                                         56400000
564100         MOVE ZEROES             TO PV-SHIPT-STATUS-CDE-NULL      56410000
564200     END-IF.                                                      56420000
564300                                                                  56430000
564400     IF PW-ASNHDR-CARR-NAME = SPACES                              56440000
564500         MOVE PC-NEG-1           TO PV-ASNHDR-CARR-NAME-NULL      56450000
564600     ELSE                                                         56460000
564700         MOVE ZEROES             TO PV-ASNHDR-CARR-NAME-NULL      56470000
564800     END-IF.                                                      56480000
564900                                                                  56490000
565000     IF PW-ASNHDR-TRANS-MTHD-CDE = SPACES                         56500000
565100         MOVE PC-NEG-1           TO PV-TRANS-MTHD-CDE-NULL        56510000
565200     ELSE                                                         56520000
565300         MOVE ZEROES             TO PV-TRANS-MTHD-CDE-NULL        56530000
565400     END-IF.                                                      56540000
565500                                                                  56550000
565600     IF PW-ASNHDR-CARR-ID-CDE = SPACES                            56560000
565700         MOVE PC-NEG-1           TO PV-CARR-ID-CDE-NULL           56570000
565800     ELSE                                                         56580000
565900         MOVE ZEROES             TO PV-CARR-ID-CDE-NULL           56590000
566000     END-IF.                                                      56600000
566100                                                                  56610000
566200     IF PW-ASNHDR-CARR-ID-QUAL-CDE = SPACES                       56620000
566300         MOVE PC-NEG-1           TO PV-CARR-ID-QUAL-CDE-NULL      56630000
566400     ELSE                                                         56640000
566500         MOVE ZEROES             TO PV-CARR-ID-QUAL-CDE-NULL      56650000
566600     END-IF.                                                      56660000
566700                                                                  56670000
566800     IF PW-ASNHDR-RTE-SEQ-CDE = SPACES                            56680000
566900         MOVE PC-NEG-1           TO PV-RTE-SEQ-CDE-NULL           56690000
567000     ELSE                                                         56700000
567100         MOVE ZEROES             TO PV-RTE-SEQ-CDE-NULL           56710000
567200     END-IF.                                                      56720000
567300                                                                  56730000
567400     IF PW-ASNHDR-SHPT-VOL-MSMT = ZEROES                          56740000
567500         MOVE PC-NEG-1           TO PV-SHPT-VOL-MSMT-NULL         56750000
567600     ELSE                                                         56760000
567700         MOVE ZEROES             TO PV-SHPT-VOL-MSMT-NULL         56770000
567800     END-IF.                                                      56780000
567900                                                                  56790000
568000     IF PW-ASNHDR-EQUIP-INIT-CDE = SPACES                         56800000
568100         MOVE PC-NEG-1           TO PV-EQUIP-INIT-CDE-NULL        56810000
568200     ELSE                                                         56820000
568300         MOVE ZEROES             TO PV-EQUIP-INIT-CDE-NULL        56830000
568400     END-IF.                                                      56840000
568500                                                                  56850000
568600     IF PW-ASNHDR-EQUIP-NBR = SPACES                              56860000
568700         MOVE PC-NEG-1           TO PV-EQUIP-NBR-NULL             56870000
568800     ELSE                                                         56880000
568900         MOVE ZEROES             TO PV-EQUIP-NBR-NULL             56890000
569000     END-IF.                                                      56900000
569100                                                                  56910000
569200     IF PW-HOLD-SCHD-SHIP-DTE = ZEROES                            56920000
569300         MOVE PC-NEG-1           TO PV-SCHD-SHIP-DTE-NULL         56930000
569400     ELSE                                                         56940000
569500         MOVE ZEROES             TO PV-SCHD-SHIP-DTE-NULL         56950000
569600     END-IF.                                                      56960000
569700                                                                  56970000
569800     IF PW-ASNHDR-SHPT-VOL-UM-CDE = SPACES                        56980000
569900         MOVE PC-NEG-1           TO PV-SHPT-VOL-UM-CDE-NULL       56990000
570000     ELSE                                                         57000000
570100         MOVE ZEROES             TO PV-SHPT-VOL-UM-CDE-NULL       57010000
570200     END-IF.                                                      57020000
570300                                                                  57030000
570400     IF PW-ASNHDR-GRO-WGHT-UM-CDE = SPACES                        57040000
570500         MOVE PC-NEG-1           TO PV-GRO-WGHT-UM-CDE-NULL       57050000
570600     ELSE                                                         57060000
570700         MOVE ZEROES             TO PV-GRO-WGHT-UM-CDE-NULL       57070000
570800     END-IF.                                                      57080000
570900                                                                  57090000
571000     IF PW-ASNHDR-SHIP-PAYT-TERM-CDE = SPACES                     57100000
571100         MOVE PC-NEG-1           TO PV-SHIP-PAYT-TERM-CDE-NULL    57110000
571200     ELSE                                                         57120000
571300         MOVE ZEROES             TO PV-SHIP-PAYT-TERM-CDE-NULL    57130000
571400     END-IF.                                                      57140000
571500                                                                  57150000
571600     IF PW-ASNHDR-RESPBL-LOC-CDE = SPACES                         57160000
571700         MOVE PC-NEG-1           TO PV-RESPBL-LOC-CDE-NULL        57170000
571800     ELSE                                                         57180000
571900         MOVE ZEROES             TO PV-RESPBL-LOC-CDE-NULL        57190000
572000     END-IF.                                                      57200000
572100                                                                  57210000
572200     IF PW-ASNHDR-RESPBL-LOC-DESC = SPACES                        57220000
572300         MOVE PC-NEG-1           TO PV-RESPBL-LOC-DESC-NULL       57230000
572400     ELSE                                                         57240000
572500         MOVE ZEROES             TO PV-RESPBL-LOC-DESC-NULL       57250000
572600     END-IF.                                                      57260000
572700/                                                                 57270000
572800***************************************************************** 57280000
572900*     SET NULLS ASHADR                                          * 57290000
573000*                                                               * 57300000
573100*     -  SET ALL ASHADR RECORD NULL INDICATORS                  * 57310000
573200***************************************************************** 57320000
573300 X130-SET-NULLS-ASHADR.                                           57330000
573400     MOVE 'X130-SET-NULLS-ASHADR             '                    57340000
573500                                 TO PW-CURRENT-PARA.              57350000
573600*    DISPLAY 'X130-SET-NULLS-ASHADR'.                             57360000
573700                                                                  57370000
573800     IF PW-HOLD-NAME-ID-CDE = SPACES                              57380000
573900         MOVE PC-NEG-1           TO PV-NAME-ID-CDE-NULL           57390000
574000     ELSE                                                         57400000
574100         MOVE ZEROES             TO PV-NAME-ID-CDE-NULL           57410000
574200     END-IF.                                                      57420000
574300                                                                  57430000
574400     IF PW-HOLD-NAME-ID-QUAL-CDE = SPACES                         57440000
574500         MOVE PC-NEG-1           TO PV-NAME-ID-QUAL-CDE-NULL      57450000
574600     ELSE                                                         57460000
574700         MOVE ZEROES             TO PV-NAME-ID-QUAL-CDE-NULL      57470000
574800     END-IF.                                                      57480000
574900                                                                  57490000
575000     IF PW-HOLD-CTY-NAME = SPACES                                 57500000
575100         MOVE PC-NEG-1           TO PV-CTY-NAME-NULL              57510000
575200     ELSE                                                         57520000
575300         MOVE ZEROES             TO PV-CTY-NAME-NULL              57530000
575400     END-IF.                                                      57540000
575500                                                                  57550000
575600     IF PW-HOLD-ST-CDE = SPACES                                   57560000
575700         MOVE PC-NEG-1           TO PV-ST-CDE-NULL                57570000
575800     ELSE                                                         57580000
575900         MOVE ZEROES             TO PV-ST-CDE-NULL                57590000
576000     END-IF.                                                      57600000
576100                                                                  57610000
576200     IF PW-HOLD-ZIP-CDE = SPACES                                  57620000
576300         MOVE PC-NEG-1           TO PV-ZIP-CDE-NULL               57630000
576400     ELSE                                                         57640000
576500         MOVE ZEROES             TO PV-ZIP-CDE-NULL               57650000
576600     END-IF.                                                      57660000
576700                                                                  57670000
576800     IF PW-HOLD-CNTRY-CDE = SPACES                                57680000
576900         MOVE PC-NEG-1           TO PV-CNTRY-CDE-NULL             57690000
577000     ELSE                                                         57700000
577100         MOVE ZEROES             TO PV-CNTRY-CDE-NULL             57710000
577200     END-IF.                                                      57720000
577300/                                                                 57730000
577400***************************************************************** 57740000
577500*     SET NULLS ASNORD                                          * 57750000
577600*                                                               * 57760000
577700*     -  SET ALL ASNORD RECORD NULL INDICATORS                  * 57770000
577800***************************************************************** 57780000
577900 X160-SET-NULLS-ASNORD.                                           57790000
578000     MOVE 'X160-SET-NULLS-ASNORD             '                    57800000
578100                                 TO PW-CURRENT-PARA.              57810000
578200*    DISPLAY 'X160-SET-NULLS-ASNORD'.                             57820000
578300                                                                  57830000
578400     IF PW-ASNORD-VEND-ORD-NBR = SPACES                           57840000
578500         MOVE PC-NEG-1           TO PV-VEND-ORD-NBR-NULL          57850000
578600     ELSE                                                         57860000
578700         MOVE ZEROES             TO PV-VEND-ORD-NBR-NULL          57870000
578800     END-IF.                                                      57880000
578900                                                                  57890000
579000     IF PW-ASNORD-CUST-NBR = SPACES                               57900000
579100         MOVE PC-NEG-1           TO PV-CUST-NBR-NULL              57910000
579200     ELSE                                                         57920000
579300         MOVE ZEROES             TO PV-CUST-NBR-NULL              57930000
579400     END-IF.                                                      57940000
579500                                                                  57950000
579600     IF PW-ASNORD-PROMO-NBR = SPACES                              57960000
579700         MOVE PC-NEG-1           TO PV-PROMO-NBR-NULL             57970000
579800     ELSE                                                         57980000
579900         MOVE ZEROES             TO PV-PROMO-NBR-NULL             57990000
580000     END-IF.                                                      58000000
580100                                                                  58010000
580200     IF PW-ASNORD-VEND-NBR = ZEROES                               58020000
580300         MOVE PC-NEG-1           TO PV-VEND-NBR-NULL              58030000
580400     ELSE                                                         58040000
580500         MOVE ZEROES             TO PV-VEND-NBR-NULL              58050000
580600     END-IF.                                                      58060000
580700                                                                  58070000
580800     IF PW-ASNORD-ORD-STATUS-CDE = SPACES                         58080000
580900         MOVE PC-NEG-1           TO PV-ORD-STATUS-CDE-NULL        58090000
581000     ELSE                                                         58100000
581100         MOVE ZEROES             TO PV-ORD-STATUS-CDE-NULL        58110000
581200     END-IF.                                                      58120000
581300                                                                  58130000
581400     IF PW-ASNORD-CHG-ORD-SEQ-NBR = SPACES                        58140000
581500         MOVE PC-NEG-1           TO PV-CHG-ORD-SEQ-NBR-NULL       58150000
581600     ELSE                                                         58160000
581700         MOVE ZEROES             TO PV-CHG-ORD-SEQ-NBR-NULL       58170000
581800     END-IF.                                                      58180000
581900                                                                  58190000
582000     IF PW-HOLD-PO-DTE = ZEROES                                   58200000
582100         MOVE PC-NEG-1           TO PV-PO-DTE-NULL                58210000
582200     ELSE                                                         58220000
582300         MOVE ZEROES             TO PV-PO-DTE-NULL                58230000
582400     END-IF.                                                      58240000
582500                                                                  58250000
582600     IF PW-ASNORD-EXCH-FCTR = ZEROES                              58260000
582700         MOVE PC-NEG-1           TO PV-EXCH-FCTR-NULL             58270000
582800     ELSE                                                         58280000
582900         MOVE ZEROES             TO PV-EXCH-FCTR-NULL             58290000
583000     END-IF.                                                      58300000
583100                                                                  58310000
583200     IF PW-ASNORD-SELR-CUR-CDE = SPACES                           58320000
583300         MOVE PC-NEG-1           TO PV-SELR-CUR-CDE-NULL          58330000
583400     ELSE                                                         58340000
583500         MOVE ZEROES             TO PV-SELR-CUR-CDE-NULL          58350000
583600     END-IF.                                                      58360000
583700/                                                                 58370000
583800***************************************************************** 58380000
583900*     SET NULLS ASOADR                                          * 58390000
584000*                                                               * 58400000
584100*     -  SET ALL ASOADR RECORD NULL INDICATORS                  * 58410000
584200***************************************************************** 58420000
584300 X170-SET-NULLS-ASOADR.                                           58430000
584400     MOVE 'X170-SET-NULLS-ASOADR             '                    58440000
584500                                 TO PW-CURRENT-PARA.              58450000
584600*    DISPLAY 'X170-SET-NULLS-ASOADR'.                             58460000
584700                                                                  58470000
584800     IF PW-HOLD-NAME-ID-CDE = SPACES                              58480000
584900         MOVE PC-NEG-1           TO PV-NAME-ID-CDE-NULL           58490000
585000     ELSE                                                         58500000
585100         MOVE ZEROES             TO PV-NAME-ID-CDE-NULL           58510000
585200     END-IF.                                                      58520000
585300                                                                  58530000
585400     IF PW-HOLD-NAME-ID-QUAL-CDE = SPACES                         58540000
585500         MOVE PC-NEG-1           TO PV-NAME-ID-QUAL-CDE-NULL      58550000
585600     ELSE                                                         58560000
585700         MOVE ZEROES             TO PV-NAME-ID-QUAL-CDE-NULL      58570000
585800     END-IF.                                                      58580000
585900                                                                  58590000
586000     IF PW-HOLD-CTY-NAME = SPACES                                 58600000
586100         MOVE PC-NEG-1           TO PV-CTY-NAME-NULL              58610000
586200     ELSE                                                         58620000
586300         MOVE ZEROES             TO PV-CTY-NAME-NULL              58630000
586400     END-IF.                                                      58640000
586500                                                                  58650000
586600     IF PW-HOLD-ST-CDE = SPACES                                   58660000
586700         MOVE PC-NEG-1           TO PV-ST-CDE-NULL                58670000
586800     ELSE                                                         58680000
586900         MOVE ZEROES             TO PV-ST-CDE-NULL                58690000
587000     END-IF.                                                      58700000
587100                                                                  58710000
587200     IF PW-HOLD-ZIP-CDE = SPACES                                  58720000
587300         MOVE PC-NEG-1           TO PV-ZIP-CDE-NULL               58730000
587400     ELSE                                                         58740000
587500         MOVE ZEROES             TO PV-ZIP-CDE-NULL               58750000
587600     END-IF.                                                      58760000
587700                                                                  58770000
587800     IF PW-HOLD-CNTRY-CDE = SPACES                                58780000
587900         MOVE PC-NEG-1           TO PV-CNTRY-CDE-NULL             58790000
588000     ELSE                                                         58800000
588100         MOVE ZEROES             TO PV-CNTRY-CDE-NULL             58810000
588200     END-IF.                                                      58820000
588300/                                                                 58830000
588400***************************************************************** 58840000
588500*     SET NULLS ASNCAR                                          * 58850000
588600*                                                               * 58860000
588700*     -  SET ALL ASNCAR RECORD NULL INDICATORS                  * 58870000
588800***************************************************************** 58880000
588900 X200-SET-NULLS-ASNCAR.                                           58890000
589000     MOVE 'X200-SET-NULLS-ASNCAR             '                    58900000
589100                                 TO PW-CURRENT-PARA.              58910000
589200*    DISPLAY 'X200-SET-NULLS-ASNCAR'.                             58920000
589300                                                                  58930000
589400     IF PW-ASNCAR-VOL-MSMT = ZEROES                               58940000
589500         MOVE PC-NEG-1           TO PV-VOL-MSMT-NULL              58950000
589600     ELSE                                                         58960000
589700         MOVE ZEROES             TO PV-VOL-MSMT-NULL              58970000
589800     END-IF.                                                      58980000
589900                                                                  58990000
590000     IF PW-ASNCAR-WGHT-MSMT = ZEROES                              59000000
590100         MOVE PC-NEG-1           TO PV-WGHT-MSMT-NULL             59010000
590200     ELSE                                                         59020000
590300         MOVE ZEROES             TO PV-WGHT-MSMT-NULL             59030000
590400     END-IF.                                                      59040000
590500                                                                  59050000
590600     IF PW-ASNCAR-NBR-QUAL-CDE = SPACES                           59060000
590700         MOVE PC-NEG-1           TO PV-NBR-QUAL-CDE-NULL          59070000
590800     ELSE                                                         59080000
590900         MOVE ZEROES             TO PV-NBR-QUAL-CDE-NULL          59090000
591000     END-IF.                                                      59100000
591100                                                                  59110000
591200     IF PW-ASNCAR-PKG-QTY = ZEROES                                59120000
591300         MOVE PC-NEG-1           TO PV-ASNCAR-PKG-QTY-NULL        59130000
591400     ELSE                                                         59140000
591500         MOVE ZEROES             TO PV-ASNCAR-PKG-QTY-NULL        59150000
591600     END-IF.                                                      59160000
591700                                                                  59170000
591800     IF PW-ASNCAR-PKG-QTY-UM-CDE = SPACES                         59180000
591900         MOVE PC-NEG-1           TO PV-PKG-QTY-UM-CDE-NULL        59190000
592000     ELSE                                                         59200000
592100         MOVE ZEROES             TO PV-PKG-QTY-UM-CDE-NULL        59210000
592200     END-IF.                                                      59220000
592300                                                                  59230000
592400     IF PW-ASNCAR-WGHT-UM-CDE = SPACES                            59240000
592500         MOVE PC-NEG-1           TO PV-WGHT-UM-CDE-NULL           59250000
592600     ELSE                                                         59260000
592700         MOVE ZEROES             TO PV-WGHT-UM-CDE-NULL           59270000
592800     END-IF.                                                      59280000
592900                                                                  59290000
593000     IF PW-ASNCAR-VOL-UM-CDE = SPACES                             59300000
593100         MOVE PC-NEG-1           TO PV-VOL-UM-CDE-NULL            59310000
593200     ELSE                                                         59320000
593300         MOVE ZEROES             TO PV-VOL-UM-CDE-NULL            59330000
593400     END-IF.                                                      59340000
593500                                                                  59350000
593600     IF PW-ASNCAR-PKG-CDE = SPACES                                59360000
593700         MOVE PC-NEG-1           TO PV-PKG-CDE-NULL               59370000
593800     ELSE                                                         59380000
593900         MOVE ZEROES             TO PV-PKG-CDE-NULL               59390000
594000     END-IF.                                                      59400000
594100                                                                  59410000
594200     IF PW-ASNCAR-LEN-MSMT = ZEROES                               59420000
594300         MOVE PC-NEG-1           TO PV-LEN-MSMT-NULL              59430000
594400     ELSE                                                         59440000
594500         MOVE ZEROES             TO PV-LEN-MSMT-NULL              59450000
594600     END-IF.                                                      59460000
594700                                                                  59470000
594800     IF PW-ASNCAR-HT-MSMT = ZEROES                                59480000
594900         MOVE PC-NEG-1           TO PV-HT-MSMT-NULL               59490000
595000     ELSE                                                         59500000
595100         MOVE ZEROES             TO PV-HT-MSMT-NULL               59510000
595200     END-IF.                                                      59520000
595300                                                                  59530000
595400     IF PW-ASNCAR-WDTH-MSMT = ZEROES                              59540000
595500         MOVE PC-NEG-1           TO PV-WDTH-MSMT-NULL             59550000
595600     ELSE                                                         59560000
595700         MOVE ZEROES             TO PV-WDTH-MSMT-NULL             59570000
595800     END-IF.                                                      59580000
595900                                                                  59590000
596000     IF PW-ASNCAR-SIZE-UM-CDE = SPACES                            59600000
596100         MOVE PC-NEG-1           TO PV-SIZE-UM-CDE-NULL           59610000
596200     ELSE                                                         59620000
596300         MOVE ZEROES             TO PV-SIZE-UM-CDE-NULL           59630000
596400     END-IF.                                                      59640000
596500                                                                  59650000
596600     IF PW-ASNCAR-PKG-SIZE-QTY = ZEROES                           59660000
596700         MOVE PC-NEG-1           TO PV-PKG-SIZE-QTY-NULL          59670000
596800     ELSE                                                         59680000
596900         MOVE ZEROES             TO PV-PKG-SIZE-QTY-NULL          59690000
597000     END-IF.                                                      59700000
597100/                                                                 59710000
597200***************************************************************** 59720000
597300*     SET NULLS ASNDTL                                          * 59730000
597400*                                                               * 59740000
597500*     -  SET ALL ASNDTL RECORD NULL INDICATORS                  * 59750000
597600***************************************************************** 59760000
597700 X210-SET-NULLS-ASNDTL.                                           59770000
597800     MOVE 'X210-SET-NULLS-ASNDTL             '                    59780000
597900                                 TO PW-CURRENT-PARA.              59790000
598000*    DISPLAY 'X210-SET-NULLS-ASNDTL'.                             59800000
598100                                                                  59810000
598200     MOVE ZEROES                 TO PV-ALT-PROD1-CDE-NULL         59820000
598300                                    PV-ALT-PROD1-ID-NULL          59830000
598400                                    PV-ALT-PROD2-CDE-NULL         59840000
598500                                    PV-ALT-PROD2-ID-NULL.         59850000
598600                                                                  59860000
598700     EVALUATE TRUE                                                59870000
598800       WHEN PW-LIN-SUB = ZERO                                     59880000
598900         MOVE PC-NEG-1           TO PV-ALT-PROD1-CDE-NULL         59890000
599000                                    PV-ALT-PROD1-ID-NULL          59900000
599100                                    PV-ALT-PROD2-CDE-NULL         59910000
599200                                    PV-ALT-PROD2-ID-NULL          59920000
599300       WHEN PW-LIN-SUB = PC-POS-1                                 59930000
599400         MOVE PW-LIN-PROD-CDE(PC-POS-1)                           59940000
599500                                 TO PW-ASNDTL-ALT-PROD1-CDE       59950000
599600         MOVE PW-LIN-PROD-ID (PC-POS-1)                           59960000
599700                                 TO PW-ASNDTL-ALT-PROD1-ID        59970000
599800         MOVE PC-NEG-1           TO PV-ALT-PROD2-CDE-NULL         59980000
599900                                    PV-ALT-PROD2-ID-NULL          59990000
600000       WHEN PW-LIN-SUB = PC-POS-2                                 60000000
600100         MOVE PW-LIN-PROD-CDE(PC-POS-1)                           60010000
600200                                 TO PW-ASNDTL-ALT-PROD1-CDE       60020000
600300         MOVE PW-LIN-PROD-ID (PC-POS-1)                           60030000
600400                                 TO PW-ASNDTL-ALT-PROD1-ID        60040000
600500         MOVE PW-LIN-PROD-CDE(PC-POS-2)                           60050000
600600                                 TO PW-ASNDTL-ALT-PROD2-CDE       60060000
600700         MOVE PW-LIN-PROD-ID (PC-POS-2)                           60070000
600800                                 TO PW-ASNDTL-ALT-PROD2-ID        60080000
600900       WHEN OTHER                                                 60090000
601000         PERFORM                                                  60100000
601100           VARYING PW-SUB FROM 1 BY 1                             60110000
601200           UNTIL PW-SUB > PW-LIN-SUB                              60120000
601300              OR VA-FOUND                                         60130000
601400             EVALUATE TRUE                                        60140000
601500               WHEN PW-LIN-PROD-CDE(PW-SUB) = 'VA'                60150000
601600                 MOVE PW-LIN-PROD-CDE(PW-SUB)                     60160000
601700                                 TO PW-ASNDTL-ALT-PROD1-CDE       60170000
601800                 MOVE PW-LIN-PROD-ID (PW-SUB)                     60180000
601900                                 TO PW-ASNDTL-ALT-PROD1-ID        60190000
602000                 SET VA-FOUND    TO TRUE                          60200000
602100             END-EVALUATE                                         60210000
602200         END-PERFORM                                              60220000
602300                                                                  60230000
602400         PERFORM                                                  60240000
602500           VARYING PW-SUB FROM 1 BY 1                             60250000
602600           UNTIL PW-SUB > PW-LIN-SUB                              60260000
602700              OR UP-FOUND                                         60270000
602800             EVALUATE TRUE                                        60280000
602900               WHEN PW-LIN-PROD-CDE(PW-SUB) = 'UP'                60290000
603000                 SET UP-FOUND    TO TRUE                          60300000
603100                 IF VA-FOUND                                      60310000
603200                     MOVE PW-LIN-PROD-CDE(PW-SUB)                 60320000
603300                                 TO PW-ASNDTL-ALT-PROD2-CDE       60330000
603400                     MOVE PW-LIN-PROD-ID (PW-SUB)                 60340000
603500                                 TO PW-ASNDTL-ALT-PROD2-ID        60350000
603600                 ELSE                                             60360000
603700                     MOVE PW-LIN-PROD-CDE(PW-SUB)                 60370000
603800                                 TO PW-ASNDTL-ALT-PROD1-CDE       60380000
603900                     MOVE PW-LIN-PROD-ID (PW-SUB)                 60390000
604000                                 TO PW-ASNDTL-ALT-PROD1-ID        60400000
604100                 END-IF                                           60410000
604200             END-EVALUATE                                         60420000
604300         END-PERFORM                                              60430000
604400                                                                  60440000
604500         IF VA-FOUND                                              60450000
604600             IF UP-FOUND                                          60460000
604700                 CONTINUE                                         60470000
604800             ELSE                                                 60480000
604900                 PERFORM                                          60490000
605000                   VARYING PW-SUB FROM 1 BY 1                     60500000
605100                   UNTIL PW-SUB > PW-LIN-SUB                      60510000
605200                      OR PW-LIN-PROD-CDE (PW-SUB) NOT = 'VA'      60520000
605300                     EVALUATE TRUE                                60530000
605400                       WHEN PW-LIN-PROD-CDE(PW-SUB) = 'VA'        60540000
605500                         CONTINUE                                 60550000
605600                       WHEN OTHER                                 60560000
605700                         MOVE PW-LIN-PROD-CDE(PW-SUB)             60570000
605800                                 TO PW-ASNDTL-ALT-PROD2-CDE       60580000
605900                         MOVE PW-LIN-PROD-ID (PW-SUB)             60590000
606000                                 TO PW-ASNDTL-ALT-PROD2-ID        60600000
606100                     END-EVALUATE                                 60610000
606200                 END-PERFORM                                      60620000
606300             END-IF                                               60630000
606400         ELSE                                                     60640000
606500             IF UP-FOUND                                          60650000
606600                 PERFORM                                          60660000
606700                   VARYING PW-SUB FROM 1 BY 1                     60670000
606800                   UNTIL PW-SUB > PW-LIN-SUB                      60680000
606900                      OR PW-LIN-PROD-CDE (PW-SUB) NOT = 'UP'      60690000
607000                     EVALUATE TRUE                                60700000
607100                       WHEN PW-LIN-PROD-CDE(PW-SUB) = 'UP'        60710000
607200                         CONTINUE                                 60720000
607300                       WHEN OTHER                                 60730000
607400                         MOVE PW-LIN-PROD-CDE(PW-SUB)             60740000
607500                                 TO PW-ASNDTL-ALT-PROD2-CDE       60750000
607600                         MOVE PW-LIN-PROD-ID (PW-SUB)             60760000
607700                                 TO PW-ASNDTL-ALT-PROD2-ID        60770000
607800                     END-EVALUATE                                 60780000
607900                 END-PERFORM                                      60790000
608000             ELSE                                                 60800000
608100                 MOVE PW-LIN-PROD-CDE(PC-POS-1)                   60810000
608200                                 TO PW-ASNDTL-ALT-PROD1-CDE       60820000
608300                 MOVE PW-LIN-PROD-ID (PC-POS-1)                   60830000
608400                                 TO PW-ASNDTL-ALT-PROD1-ID        60840000
608500                 MOVE PW-LIN-PROD-CDE(PC-POS-2)                   60850000
608600                                 TO PW-ASNDTL-ALT-PROD2-CDE       60860000
608700                 MOVE PW-LIN-PROD-ID (PC-POS-2)                   60870000
608800                                 TO PW-ASNDTL-ALT-PROD2-ID        60880000
608900             END-IF                                               60890000
609000         END-IF                                                   60900000
609100     END-EVALUATE.                                                60910000
609200                                                                  60920000
609300     IF PW-ASNDTL-SHIPT-DTE-QTY = ZEROES                          60930000
609400         MOVE PC-NEG-1           TO PV-SHIPT-DTE-QTY-NULL         60940000
609500     ELSE                                                         60950000
609600         MOVE ZEROES             TO PV-SHIPT-DTE-QTY-NULL         60960000
609700     END-IF.                                                      60970000
609800                                                                  60980000
609900     IF PW-ASNDTL-ITM-STATUS-CDE = SPACES                         60990000
610000         MOVE PC-NEG-1           TO PV-ITM-STATUS-CDE-NULL        61000000
610100     ELSE                                                         61010000
610200         MOVE ZEROES             TO PV-ITM-STATUS-CDE-NULL        61020000
610300     END-IF.                                                      61030000
610400                                                                  61040000
610500     IF PW-ASNDTL-ITM-ERR-CDE = SPACES                            61050000
610600         MOVE PC-NEG-1           TO PV-ITM-ERR-CDE-NULL           61060000
610700     ELSE                                                         61070000
610800         MOVE ZEROES             TO PV-ITM-ERR-CDE-NULL           61080000
610900     END-IF.                                                      61090000
611000                                                                  61100000
611100     IF PW-ASNDTL-ITM-ERR-QTY = ZEROES                            61110000
611200         MOVE PC-NEG-1           TO PV-ITM-ERR-QTY-NULL           61120000
611300     ELSE                                                         61130000
611400         MOVE ZEROES             TO PV-ITM-ERR-QTY-NULL           61140000
611500     END-IF.                                                      61150000
611600                                                                  61160000
611700     IF PW-ASNDTL-ITM-ERR-QTY-UM-CDE = SPACES                     61170000
611800         MOVE PC-NEG-1           TO PV-ITM-ERR-QTY-UM-CDE-NULL    61180000
611900     ELSE                                                         61190000
612000         MOVE ZEROES             TO PV-ITM-ERR-QTY-UM-CDE-NULL    61200000
612100     END-IF.                                                      61210000
612200                                                                  61220000
612300     IF PW-ASNDTL-PKG-QTY = ZEROES                                61230000
612400         MOVE PC-NEG-1           TO PV-ASNDTL-PKG-QTY-NULL        61240000
612500     ELSE                                                         61250000
612600         MOVE ZEROES             TO PV-ASNDTL-PKG-QTY-NULL        61260000
612700     END-IF.                                                      61270000
612800                                                                  61280000
612900     IF PW-ASNDTL-PKG-QTY-UM-CDE = SPACES                         61290000
613000         MOVE PC-NEG-1           TO PV-PKG-QTY-UM-CDE-NULL        61300000
613100     ELSE                                                         61310000
613200         MOVE ZEROES             TO PV-PKG-QTY-UM-CDE-NULL        61320000
613300     END-IF.                                                      61330000
613400                                                                  61340000
613500     IF PW-ASNDTL-VEND-ORD-QTY = ZEROES                           61350000
613600         MOVE PC-NEG-1           TO PV-VEND-ORD-QTY-NULL          61360000
613700     ELSE                                                         61370000
613800         MOVE ZEROES             TO PV-VEND-ORD-QTY-NULL          61380000
613900     END-IF.                                                      61390000
614000                                                                  61400000
614100     IF PW-ASNDTL-ORD-QTY-UM-CDE = SPACES                         61410000
614200         MOVE PC-NEG-1           TO PV-ORD-QTY-UM-CDE-NULL        61420000
614300     ELSE                                                         61430000
614400         MOVE ZEROES             TO PV-ORD-QTY-UM-CDE-NULL        61440000
614500     END-IF.                                                      61450000
614600                                                                  61460000
614700     IF PW-ASNDTL-WGT-MSMT = ZEROES                               61470000
614800         MOVE PC-NEG-1           TO PV-WGT-MSMT-NULL              61480000
614900     ELSE                                                         61490000
615000         MOVE ZEROES             TO PV-WGT-MSMT-NULL              61500000
615100     END-IF.                                                      61510000
615200                                                                  61520000
615300     IF PW-ASNDTL-VOL-MSMT = ZEROES                               61530000
615400         MOVE PC-NEG-1           TO PV-VOL-MSMT-NULL              61540000
615500     ELSE                                                         61550000
615600         MOVE ZEROES             TO PV-VOL-MSMT-NULL              61560000
615700     END-IF.                                                      61570000
615800                                                                  61580000
615900     IF PW-ASNDTL-VOL-UM-CDE = SPACES                             61590000
616000         MOVE PC-NEG-1           TO PV-VOL-UM-CDE-NULL            61600000
616100     ELSE                                                         61610000
616200         MOVE ZEROES             TO PV-VOL-UM-CDE-NULL            61620000
616300     END-IF.                                                      61630000
616400                                                                  61640000
616500     IF PW-ASNDTL-LEN-MSMT = ZEROES                               61650000
616600         MOVE PC-NEG-1           TO PV-LEN-MSMT-NULL              61660000
616700     ELSE                                                         61670000
616800         MOVE ZEROES             TO PV-LEN-MSMT-NULL              61680000
616900     END-IF.                                                      61690000
617000                                                                  61700000
617100     IF PW-ASNDTL-HT-MSMT = ZEROES                                61710000
617200         MOVE PC-NEG-1           TO PV-HT-MSMT-NULL               61720000
617300     ELSE                                                         61730000
617400         MOVE ZEROES             TO PV-HT-MSMT-NULL               61740000
617500     END-IF.                                                      61750000
617600                                                                  61760000
617700     IF PW-ASNDTL-WDTH-MSMT = ZEROES                              61770000
617800         MOVE PC-NEG-1           TO PV-WDTH-MSMT-NULL             61780000
617900     ELSE                                                         61790000
618000         MOVE ZEROES             TO PV-WDTH-MSMT-NULL             61800000
618100     END-IF.                                                      61810000
618200                                                                  61820000
618300     IF PW-ASNDTL-SIZE-UM-CDE = SPACES                            61830000
618400         MOVE PC-NEG-1           TO PV-SIZE-UM-CDE-NULL           61840000
618500     ELSE                                                         61850000
618600         MOVE ZEROES             TO PV-SIZE-UM-CDE-NULL           61860000
618700     END-IF.                                                      61870000
618800                                                                  61880000
618900     IF PW-ASNDTL-ITM-SUBST-UPC-NBR = SPACES                      61890000
619000         MOVE PC-NEG-1           TO PV-ITM-SUBST-UPC-NBR-NULL     61900000
619100     ELSE                                                         61910000
619200         MOVE ZEROES             TO PV-ITM-SUBST-UPC-NBR-NULL     61920000
619300     END-IF.                                                      61930000
619400                                                                  61940000
619500/                                                                 61950000
619600****************************************************************  61960000
619700*     READ-ADV-SHIP-NOTICE                                     *  61970000
619800*                                                              *  61980000
619900*     -  READ ADV-SHIP-NOTICE RECORD                           *  61990000
620000****************************************************************  62000000
620100 Z000-READ-ADV-SHIP-NOTICE.                                       62010000
620200     MOVE 'Z000-READ-ADV-SHIP-NOTICE      '                       62020000
620300                                 TO PW-CURRENT-PARA.              62030000
620400*    DISPLAY 'Z000-READ-ADV-SHIP-NOTICE'.                         62040000
620500                                                                  62050000
620600     READ ADV-SHIP-NOTICE-FILE                                    62060000
620700         INTO ADVANCE-SHIP-NOTICE-DTL-RECORD                      62070000
620800         AT END SET END-OF-INP01 TO TRUE.                         62080000
620810                                                                  62081005
620820     IF  END-OF-INP01                                             62082005
620830         CONTINUE                                                 62083005
620840     ELSE                                                         62084005
620850         ADD 1 TO PV-INPUT-READ-COUNT                             62085005
620860     END-IF.                                                      62086005
620900                                                                  62090000
621000     IF ID-IDENTIFICATION-REC                                     62100000
621100         IF SN001I-STRUC-CDE = '0001' OR '0002' OR '0004'         62110000
621200             MOVE 'Y'              TO PS-ASN-VERSION-4010         62120000
621300             MOVE SN001I-STRUC-CDE TO PS-ASN-STRUC-CODE           62130000
621400         ELSE                                                     62140000
621500             MOVE 'N'              TO PS-ASN-VERSION-4010         62150000
621600             MOVE SPACES           TO PS-ASN-STRUC-CODE           62160000
621700         END-IF.                                                  62170000
621800                                                                  62180000
621900     IF ID-IDENTIFICATION-REC AND PS-VERSION-4010                 62190000
622000         DISPLAY 'VERSION 4010 - ID = ' SN001I-BSN02-SHIPT-ID     62200000
622100                 '   STRUCTURE CODE = ' SN001I-STRUC-CDE          62210000
622200         END-IF.                                                  62220000
622300                                                                  62230000
622400*    DISPLAY 'ADVANCE-SHIP-NOTICE-DTL-RECORD:'                    62240000
622500*    DISPLAY  ADVANCE-SHIP-NOTICE-DTL-RECORD.                     62250000
622600/                                                                 62260000
622700***************************************************************** 62270000
622800*     SQL INSERT ASNHDR                                         * 62280000
622900*                                                               * 62290000
623000***************************************************************** 62300000
623100 Z110-SQL-INSERT-ASNHDR.                                          62310000
623200     MOVE 'Z110-SQL-INSERT-ASNHDR             '                   62320000
623300                                 TO PW-CURRENT-PARA.              62330000
623400*    DISPLAY 'Z110-SQL-INSERT-ASNHDR'.                            62340000
623500     MOVE ZERO TO PV-ASNHDR-ID.                                   62350000
623600                                                                  62360000
623700* CLT WR40574       01-10-12ADD CARR-AUTH-ID BELOW          ***** 62370000
623800     PERFORM                                                      62380000
623900       WITH TEST AFTER                                            62390000
624000       VARYING PW-RETRY-COUNTER FROM 1 BY 1                       62400000
624100       UNTIL ((PW-RETRY-COUNTER > PC-MAX-RETRIES) OR              62410000
624200              (SQLCODE = ZERO) OR (SQLCODE = PC-NEG-180)          62420000
624300                               OR (SQLCODE = PC-NEG-181)          62430000
624400                               OR (SQLCODE = PC-NEG-803))         62440000
624500                                                                  62450000
624600         EXEC SQL                                                 62460000
624700         INSERT INTO TASNHDR                                      62470000
624800         (OPERCO_NBR,                                             62480000
624900          EDI_VEND_ID,                                            62490000
625000          ASNHDR_NBR,                                             62500000
625100          CRE_DTE,                                                62510000
625200          SHIP_DTE,                                               62520000
625300          BOL_NBR,                                                62530000
625400          PRO_NBR,                                                62540000
625500          CART_SHIP_QTY,                                          62550000
625600          GRO_WGHT_MSMT,                                          62560000
625700          ANTC_DELY_DTE,                                          62570000
625800          REC_MTHD_IND,                                           62580000
625900          SHIPT_STATUS_CDE,                                       62590000
626000          CARR_NAME,                                              62600000
626100          TRANS_MTHD_CDE,                                         62610000
626200          CARR_ID_CDE,                                            62620000
626300          CARR_ID_QUAL_CDE,                                       62630000
626400          RTE_SEQ_CDE,                                            62640000
626500          SHPT_VOL_MSMT,                                          62650000
626600          EQUIP_INIT_CDE,                                         62660000
626700          EQUIP_NBR,                                              62670000
626800          SCHD_SHIP_DTE,                                          62680000
626900          CRE_TM,                                                 62690000
627000          REJ_SHIPT_CDE,                                          62700000
627100          SHPT_VOL_UM_CDE,                                        62710000
627200          GRO_WGHT_UM_CDE,                                        62720000
627300          PRINT_IND,                                              62730000
627400          SHIP_PAYT_TERM_CDE,                                     62740000
627500          RESPBL_LOC_CDE,                                         62750000
627600          RESPBL_LOC_DESC,                                        62760000
627700          DC_PRT_IND,                                             62770000
627800          ASNHDR_ID,                                              62780000
627900          SHIP_TM,                                                62790000
628000          EDIISA_CNTL_NBR,                                        62800000
628100          EDIGS_CNTL_NBR,                                         62810000
628200          EDIST_CNTL_NBR,                                         62820000
628300          EDIISA_CNTL_TMST,                                       62830000
628400          CARR_AUTH_ID    )                                       62840000
628500         VALUES                                                   62850000
628600        (:PC-OPERCO-NBR,                                          62860000
628700         :PW-HOLD-EDI-VEND-ID,                                    62870000
628800         :PW-ASNHDR-NBR,                                          62880000
628900         :PW-HOLD-CRE-DTE-REDF,                                   62890000
629000         :PW-HOLD-SHIP-DTE-REDF,                                  62900000
629100         :PW-ASNHDR-BOL-NBR,                                      62910000
629200         :PW-ASNHDR-PRO-NBR:PV-PRO-NBR-NULL,                      62920000
629300         :PW-ASNHDR-CART-SHIP-QTY,                                62930000
629400         :PW-ASNHDR-GRO-WGHT-MSMT:PV-GRO-WGHT-MSMT-NULL,          62940000
629500         :PW-HOLD-ANTC-DELY-DTE-REDF:PV-ANTC-DELY-DTE-NULL,       62950000
629600         :PW-ASNHDR-REC-MTHD-IND,                                 62960000
629700         :PW-ASNHDR-SHIPT-STATUS-CDE:PV-SHIPT-STATUS-CDE-NULL,    62970000
629800         :PW-ASNHDR-CARR-NAME:PV-ASNHDR-CARR-NAME-NULL,           62980000
629900         :PW-ASNHDR-TRANS-MTHD-CDE:PV-TRANS-MTHD-CDE-NULL,        62990000
630000         :PW-ASNHDR-CARR-ID-CDE:PV-CARR-ID-CDE-NULL,              63000000
630100         :PW-ASNHDR-CARR-ID-QUAL-CDE:PV-CARR-ID-QUAL-CDE-NULL,    63010000
630200         :PW-ASNHDR-RTE-SEQ-CDE:PV-RTE-SEQ-CDE-NULL,              63020000
630300         :PW-ASNHDR-SHPT-VOL-MSMT:PV-SHPT-VOL-MSMT-NULL,          63030000
630400         :PW-ASNHDR-EQUIP-INIT-CDE:PV-EQUIP-INIT-CDE-NULL,        63040000
630500         :PW-ASNHDR-EQUIP-NBR:PV-EQUIP-NBR-NULL,                  63050000
630600         :PW-HOLD-SCHD-SHIP-DTE-REDF:PV-SCHD-SHIP-DTE-NULL,       63060000
630700         :PW-SAVE-CRE-TIME,                                       63070000
630800         :PW-ASNHDR-REJ-SHIPT-CDE,                                63080000
630900         :PW-ASNHDR-SHPT-VOL-UM-CDE:PV-SHPT-VOL-UM-CDE-NULL,      63090000
631000         :PW-ASNHDR-GRO-WGHT-UM-CDE:PV-GRO-WGHT-UM-CDE-NULL,      63100000
631100         :PC-PRINT-IND,                                           63110000
631200         :PW-ASNHDR-SHIP-PAYT-TERM-CDE:PV-SHIP-PAYT-TERM-CDE-NULL,63120000
631300         :PW-ASNHDR-RESPBL-LOC-CDE:PV-RESPBL-LOC-CDE-NULL,        63130000
631400         :PW-ASNHDR-RESPBL-LOC-DESC:PV-RESPBL-LOC-DESC-NULL,      63140000
631500         :PC-PRINT-IND,                                           63150000
631600         :PV-ASNHDR-ID,                                           63160000
631700         :PW-SAVE-SHIP-TIME,                                      63170000
631800         :PW-HOLD-ISA-CNTL-NBR,                                   63180000
631900         :PW-HOLD-GS-CNTL-NBR,                                    63190000
632000         :PW-HOLD-ST-CNTL-NBR,                                    63200000
632100         :PW-HOLD-ISA-TMST,                                       63210000
632200         :PW-ASNHDR-CARR-AUTH-ID)                                 63220000
632300         END-EXEC                                                 63230000
632400                                                                  63240000
632500         EVALUATE TRUE                                            63250000
632600           WHEN SQLCODE = ZERO                                    63260000
632700                 ADD  1          TO PA-ASNHDR-INSERTED            63270000
632800                                                                  63280000
632900           WHEN SQLCODE = PC-NEG-803                              63290000
633000                 SET DUPLICATE-SHIPMENT                           63300000
633100                                 TO TRUE                          63310000
633200                                                                  63320000
633300           WHEN SQLCODE = PC-NEG-904                              63330000
633400           WHEN SQLCODE = PC-NEG-913                              63340000
633500                 CONTINUE                                         63350000
633600                                                                  63360000
633700           WHEN SQLCODE = PC-NEG-180                              63370000
633800           WHEN SQLCODE = PC-NEG-181                              63380000
633900*RSC             IF PS-FIRST-ERROR                                63390000
634000*                    SET PS-NOT-FIRST-ERROR TO TRUE               63400000
634100*                    PERFORM W100-PROCESS-HEADING-LINES           63410000
634200*RSC             END-IF                                           63420000
634300                 MOVE PW-ASNHDR-NBR          TO PSRL-ASNHDR-NBR   63430000
634400                 MOVE PW-HOLD-VEND-DUNNS-NBR TO PSRL-DUNNS-NBR    63440000
634500                 MOVE PW-HOLD-VENDOR-NAME    TO PSRL-VENDOR-NAME  63450000
634600                 MOVE PW-HOLD-ISA-CNTL-NBR                        63460000
634700                                             TO PSRL-ISA-NBR      63470000
634800*RSC             MOVE PSRL-REPORT-LINE-1     TO ASN-REPORT        63480000
634900*RSC             PERFORM W000-WRITE-REPORT-LINE                   63490000
635000                 MOVE PSRL-REPORT-LINE-1     TO                   63500000
635100                                          PW-ADV-SHIP-NOTICE-LINE 63510000
635200                 PERFORM Z510-WRITE-REPORT-LINE                   63520000
635300                 MOVE PR-DATE-TIME-MSG       TO PSRL-RPT-LINE-2   63530000
635400*RSC             MOVE PSRL-REPORT-LINE-2     TO ASN-REPORT        63540000
635500*RSC             PERFORM W000-WRITE-REPORT-LINE                   63550000
635600                 MOVE PSRL-REPORT-LINE-2     TO                   63560000
635700                                          PW-ADV-SHIP-NOTICE-LINE 63570000
635800                 PERFORM Z500-WRITE-REPORT-LINE                   63580000
635900                 SET PS-BAD-ASN              TO TRUE              63590000
636000                                                                  63600000
636100                 EXEC SQL                                         63610000
636200                      ROLLBACK                                    63620000
636300                 END-EXEC                                         63630000
636400                 DISPLAY '*********************'                  63640000
636500                 DISPLAY '*  R O L L B A C K  *'                  63650000
636600                 DISPLAY '*********************'                  63660000
636700           WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                63670000
636800                 DISPLAY '**************************************' 63680000
636900                 DISPLAY 'WARNING ISSUED ON INSERT OF TASNHDR   ' 63690000
637000                 DISPLAY 'PC-OPERCO-NBR:         '                63700000
637100                          PC-OPERCO-NBR                           63710000
637200                 DISPLAY 'PW-HOLD-EDI-VEND-ID:   '                63720000
637300                          PW-HOLD-EDI-VEND-ID                     63730000
637400                 DISPLAY 'PW-ASNHDR-NBR:         '                63740000
637500                          PW-ASNHDR-NBR                           63750000
637600                 DISPLAY '**********************************'     63760000
637700                 PERFORM Z800-SQL-WARNING                         63770000
637800                                                                  63780000
637900           WHEN  SQLCODE < ZERO                                   63790000
638000                 DISPLAY '**************************************' 63800000
638100                 DISPLAY 'ERROR ISSUED ON INSERT OF TASNHDR     ' 63810000
638200                 DISPLAY 'PC-OPERCO-NBR:         '                63820000
638300                          PC-OPERCO-NBR                           63830000
638400                 DISPLAY 'PW-HOLD-EDI-VEND-ID:   '                63840000
638500                          PW-HOLD-EDI-VEND-ID                     63850000
638600                 DISPLAY 'PW-ASNHDR-NBR:         '                63860000
638700                          PW-ASNHDR-NBR                           63870000
638800                 DISPLAY '**************************************' 63880000
638900                 PERFORM Z900-SQL-ERROR                           63890000
639000                                                                  63900000
639100         END-EVALUATE                                             63910000
639200                                                                  63920000
639300     END-PERFORM.                                                 63930000
639400                                                                  63940000
639500     EVALUATE TRUE                                                63950000
639600       WHEN SQLCODE = ZERO                                        63960000
639700       WHEN SQLCODE = PC-NEG-803                                  63970000
639800       WHEN SQLCODE = PC-NEG-180                                  63980000
639900       WHEN SQLCODE = PC-NEG-181                                  63990000
640000         CONTINUE                                                 64000000
640100       WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                    64010000
640200             DISPLAY '******************************************' 64020000
640300             DISPLAY 'WARNING ISSUED ON INSERT OF TASNHDR       ' 64030000
640400             DISPLAY 'PC-OPERCO-NBR:         '                    64040000
640500                      PC-OPERCO-NBR                               64050000
640600             DISPLAY 'PW-HOLD-EDI-VEND-ID:   '                    64060000
640700                      PW-HOLD-EDI-VEND-ID                         64070000
640800             DISPLAY 'PW-ASNHDR-NBR:         '                    64080000
640900                      PW-ASNHDR-NBR                               64090000
641000             DISPLAY '******************************************' 64100000
641100             PERFORM Z800-SQL-WARNING                             64110000
641200                                                                  64120000
641300       WHEN  SQLCODE < ZERO                                       64130000
641400             DISPLAY '******************************************' 64140000
641500             DISPLAY 'ERROR ISSUED ON INSERT OF TASNHDR         ' 64150000
641600             DISPLAY 'PC-OPERCO-NBR:         '                    64160000
641700                      PC-OPERCO-NBR                               64170000
641800             DISPLAY 'PW-HOLD-EDI-VEND-ID:   '                    64180000
641900                      PW-HOLD-EDI-VEND-ID                         64190000
642000             DISPLAY 'PW-ASNHDR-NBR:         '                    64200000
642100                      PW-ASNHDR-NBR                               64210000
642200             DISPLAY 'PW-HOLD-CRE-DTE-REDF:  '                    64220000
642300                      PW-HOLD-CRE-DTE-REDF                        64230000
642400             DISPLAY 'PW-HOLD-SHIP-DTE-REDF: '                    64240000
642500                      PW-HOLD-SHIP-DTE-REDF                       64250000
642600             DISPLAY 'PW-HOLD-CRE-TIME-REDF:      '               64260000
642700                      PW-HOLD-CRE-TIME-REDF                       64270000
642800             DISPLAY '******************************************' 64280000
642900             PERFORM Z900-SQL-ERROR                               64290000
643000                                                                  64300000
643100     END-EVALUATE.                                                64310000
643200/                                                                 64320000
643300*CHG107105 - START                                                64330000
643400***************************************************************** 64340000
643500*     SQL DELETE ASNHDR                                         * 64350000
643600*                                                               * 64360000
643700***************************************************************** 64370000
643800 Z115-SQL-DELETE-ASNHDR.                                          64380000
643900                                                                  64390000
644000         EXEC SQL                                                 64400000
644100           DELETE FROM TASNHDR                                    64410000
644200            WHERE ASNHDR_ID    = :PV-ASNHDR-ID                    64420000
644300         END-EXEC                                                 64430000
644310                                                                  64431000
644320         EVALUATE TRUE                                            64432000
644330           WHEN SQLCODE = ZERO                                    64433000
644340                 CONTINUE                                         64434000
644350                                                                  64435000
644360           WHEN OTHER                                             64436000
644370                 DISPLAY '**************************************' 64437000
644380                 DISPLAY 'ERROR ISSUED ON DELETE OF TASNHDR     ' 64438000
644390                 DISPLAY 'PC-OPERCO-NBR:         '                64439000
644400                          PC-OPERCO-NBR                           64440000
644410                 DISPLAY 'PW-HOLD-EDI-VEND-ID:   '                64441000
644411                          PW-HOLD-EDI-VEND-ID                     64441100
644412                 DISPLAY 'PW-ASNHDR-NBR:         '                64441200
644413                          PW-ASNHDR-NBR                           64441300
644414                 DISPLAY 'PV-ASNHDR-ID:          '                64441400
644415                          PV-ASNHDR-ID                            64441500
644416                 DISPLAY '**************************************' 64441600
644417                 PERFORM Z900-SQL-ERROR                           64441700
644418                                                                  64441800
644419         END-EVALUATE.                                            64441900
644420*CHG107105 - END                                                  64442000
644421***************************************************************** 64442100
644422*     SQL INSERT ASNPKG                                         * 64442200
644423*                                                               * 64442300
644424***************************************************************** 64442400
644425 Z120-SQL-INSERT-ASNPKG.                                          64442500
644426     MOVE 'Z120-SQL-INSERT-ASNPKG             '                   64442600
644427                                 TO PW-CURRENT-PARA.              64442700
644428*    DISPLAY 'Z120-SQL-INSERT-ASNPKG'.                            64442800
644429                                                                  64442900
644430     MOVE PW-ASNPKG-PACK-CDE (PW-SUB)                             64443000
644440                                 TO ASNPKG-ASNPKG-CDE.            64444000
644450     MOVE PW-ASNPKG-CART-SHIP-QTY (PW-SUB)                        64445000
644460                                 TO ASNPKG-CART-SHIP-QTY.         64446000
644470     MOVE PW-ASNPKG-GRO-WGHT-MSMT (PW-SUB)                        64447000
644480                                 TO ASNPKG-GRO-WGHT-MSMT.         64448000
644490     MOVE PW-ASNPKG-GRO-WGHT-UM-CDE (PW-SUB)                      64449000
644500                                 TO ASNPKG-GRO-WGHT-UM-CDE.       64450000
644600                                                                  64460000
644700     PERFORM                                                      64470000
644800       WITH TEST AFTER                                            64480000
644900       VARYING PW-RETRY-COUNTER FROM 1 BY 1                       64490000
645000       UNTIL   PW-RETRY-COUNTER > PC-MAX-RETRIES  OR              64500000
645100               SQLCODE = ZERO                                     64510000
645200*CHG107105 - START                                                64520000
645300               OR (SQLCODE = PC-NEG-803)                          64530000
645400*CHG107105 - END                                                  64540000
645500                                                                  64550000
645600         EXEC SQL                                                 64560000
645700         INSERT INTO TASNPKG                                      64570000
645800         (ASNPKG_CDE,                                             64580000
645900          CART_SHIP_QTY,                                          64590000
646000          GRO_WGHT_MSMT,                                          64600000
646100          GRO_WGHT_UM_CDE,                                        64610000
646200          ASNHDR_ID)                                              64620000
646300         VALUES                                                   64630000
646400        (:ASNPKG-ASNPKG-CDE,                                      64640000
646500         :ASNPKG-CART-SHIP-QTY,                                   64650000
646600         :ASNPKG-GRO-WGHT-MSMT,                                   64660000
646700         :ASNPKG-GRO-WGHT-UM-CDE,                                 64670000
646800         :PV-ASNHDR-ID)                                           64680000
646900         END-EXEC                                                 64690000
647000                                                                  64700000
647100         EVALUATE TRUE                                            64710000
647200           WHEN SQLCODE = ZERO                                    64720000
647300           WHEN SQLCODE = PC-NEG-904                              64730000
647400           WHEN SQLCODE = PC-NEG-913                              64740000
647500                 CONTINUE                                         64750000
647600                                                                  64760000
647700*CHG107105 - START                                                64770000
647800           WHEN SQLCODE = PC-NEG-803                              64780000
647900                 MOVE PW-ASNHDR-NBR          TO PSRL-ASNHDR-NBR   64790000
648000                 MOVE PW-HOLD-VEND-DUNNS-NBR TO PSRL-DUNNS-NBR    64800000
648100                 MOVE PW-HOLD-VENDOR-NAME    TO PSRL-VENDOR-NAME  64810000
648200                 MOVE PW-HOLD-ISA-CNTL-NBR                        64820000
648300                                             TO PSRL-ISA-NBR      64830000
648400                 MOVE PSRL-REPORT-LINE-1     TO                   64840000
648500                                          PW-ADV-SHIP-NOTICE-LINE 64850000
648600                 PERFORM Z510-WRITE-REPORT-LINE                   64860000
648700                 MOVE MSG-19                 TO PSRL-RPT-LINE-2   64870000
648800                 MOVE PSRL-REPORT-LINE-2     TO                   64880000
648810                                          PW-ADV-SHIP-NOTICE-LINE 64881000
648820                 PERFORM Z500-WRITE-REPORT-LINE                   64882000
648830                 MOVE SPACES                 TO ASN-LOG-REC       64883000
648840                 MOVE PW-ASNHDR-NBR          TO LOG-ASNHDR-NBR    64884000
648850                 MOVE LOG-MESSAGE-5          TO ASN-LOG-REC       64885000
648860                 WRITE ASN-LOG-REC                                64886000
648861                 ADD 1 TO PV-ASN-ERROR-LOG-COUNT                  64886105
648870                 SET PS-BAD-ASN              TO TRUE              64887000
648880                 PERFORM Z115-SQL-DELETE-ASNHDR                   64888000
648890                 PERFORM Z125-SQL-DELETE-ASNPKG                   64889000
648900                 SUBTRACT 1 FROM PA-ASNHDR-INSERTED               64890000
648901                                                                  64890100
648902*CHG107105 - END                                                  64890200
648903           WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                64890300
648904                 DISPLAY '**************************************' 64890400
648905                 DISPLAY 'WARNING ISSUED ON INSERT OF TASNPKG   ' 64890500
648906                 DISPLAY 'PC-OPERCO-NBR:         '                64890600
648907                          PC-OPERCO-NBR                           64890700
648908                 DISPLAY 'PW-HOLD-EDI-VEND-ID:   '                64890800
648909                          PW-HOLD-EDI-VEND-ID                     64890900
648910                 DISPLAY 'PW-ASNHDR-NBR:         '                64891000
648920                          PW-ASNHDR-NBR                           64892000
648930                 DISPLAY 'ASNPKG-ASNPKG-CDE:     '                64893000
648940                          ASNPKG-ASNPKG-CDE                       64894000
648950                 DISPLAY '**********************************'     64895000
648960                 PERFORM Z800-SQL-WARNING                         64896000
648970                                                                  64897000
648980           WHEN  SQLCODE < ZERO                                   64898000
648990                 DISPLAY '**************************************' 64899000
649000                 DISPLAY 'ERROR ISSUED ON INSERT OF TASNPKG     ' 64900000
649100                 DISPLAY 'PC-OPERCO-NBR:         '                64910000
649200                          PC-OPERCO-NBR                           64920000
649300                 DISPLAY 'PW-HOLD-EDI-VEND-ID:   '                64930000
649400                          PW-HOLD-EDI-VEND-ID                     64940000
649500                 DISPLAY 'PW-ASNHDR-NBR:         '                64950000
649600                          PW-ASNHDR-NBR                           64960000
649700                 DISPLAY 'ASNPKG-ASNPKG-CDE:     '                64970000
649800                          ASNPKG-ASNPKG-CDE                       64980000
649900                 DISPLAY '**************************************' 64990000
650000                 PERFORM Z900-SQL-ERROR                           65000000
650100                                                                  65010000
650200         END-EVALUATE                                             65020000
650300                                                                  65030000
650400     END-PERFORM.                                                 65040000
650500                                                                  65050000
650600     EVALUATE TRUE                                                65060000
650700       WHEN SQLCODE = ZERO                                        65070000
650800*CHG107105 - START                                                65080000
650900       WHEN SQLCODE = PC-NEG-803                                  65090000
651000*CHG107105 - END                                                  65100000
651100         CONTINUE                                                 65110000
651200       WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                    65120000
651300             DISPLAY '******************************************' 65130000
651400             DISPLAY 'WARNING ISSUED ON INSERT OF TASNPKG       ' 65140000
651500             DISPLAY 'PC-OPERCO-NBR:         '                    65150000
651600                      PC-OPERCO-NBR                               65160000
651700             DISPLAY 'PW-HOLD-EDI-VEND-ID:   '                    65170000
651800                      PW-HOLD-EDI-VEND-ID                         65180000
651900             DISPLAY 'PW-ASNHDR-NBR:         '                    65190000
652000                      PW-ASNHDR-NBR                               65200000
652100             DISPLAY 'ASNPKG-ASNPKG-CDE:     '                    65210000
652200                      ASNPKG-ASNPKG-CDE                           65220000
652300             DISPLAY '******************************************' 65230000
652400             PERFORM Z800-SQL-WARNING                             65240000
652500                                                                  65250000
652600       WHEN  SQLCODE < ZERO                                       65260000
652700             DISPLAY '******************************************' 65270000
652800             DISPLAY 'ERROR ISSUED ON INSERT OF TASNPKG         ' 65280000
652900             DISPLAY 'PC-OPERCO-NBR:         '                    65290000
653000                      PC-OPERCO-NBR                               65300000
653100             DISPLAY 'PW-HOLD-EDI-VEND-ID:   '                    65310000
653200                      PW-HOLD-EDI-VEND-ID                         65320000
653300             DISPLAY 'PW-ASNHDR-NBR:         '                    65330000
653400                      PW-ASNHDR-NBR                               65340000
653500             DISPLAY 'ASNPKG-ASNPKG-CDE:     '                    65350000
653600                      ASNPKG-ASNPKG-CDE                           65360000
653700             DISPLAY '******************************************' 65370000
653800             PERFORM Z900-SQL-ERROR                               65380000
653900                                                                  65390000
654000     END-EVALUATE.                                                65400000
654100/                                                                 65410000
654200*CHG107105 - START                                                65420000
654300***************************************************************** 65430000
654400*     SQL DELETE ASNPKG                                         * 65440000
654500*                                                               * 65450000
654600***************************************************************** 65460000
654700 Z125-SQL-DELETE-ASNPKG.                                          65470000
654800                                                                  65480000
654900         EXEC SQL                                                 65490000
655000           DELETE FROM TASNPKG                                    65500000
655100            WHERE ASNHDR_ID    = :PV-ASNHDR-ID                    65510000
655200         END-EXEC                                                 65520000
655300                                                                  65530000
655310         EVALUATE TRUE                                            65531000
655320           WHEN SQLCODE = ZERO                                    65532000
655330                 CONTINUE                                         65533000
655340                                                                  65534000
655350           WHEN OTHER                                             65535000
655360                 DISPLAY '**************************************' 65536000
655370                 DISPLAY 'ERROR ISSUED ON DELETE OF TASNPKG     ' 65537000
655380                 DISPLAY 'PV-ASNHDR-ID:          '                65538000
655390                          PV-ASNHDR-ID                            65539000
655400                 DISPLAY 'ASNPKG-ASNPKG-CDE:     '                65540000
655410                          ASNPKG-ASNPKG-CDE                       65541000
655420                 DISPLAY '**************************************' 65542000
655430                 PERFORM Z900-SQL-ERROR                           65543000
655431                                                                  65543100
655432         END-EVALUATE.                                            65543200
655433*CHG107105 - END                                                  65543300
655434***************************************************************** 65543400
655435*     SQL INSERT ASHADR                                         * 65543500
655436*                                                               * 65543600
655437***************************************************************** 65543700
655438 Z130-SQL-INSERT-ASHADR.                                          65543800
655439     MOVE 'Z130-SQL-INSERT-ASHADR             '                   65543900
655440                                 TO PW-CURRENT-PARA.              65544000
655450*    DISPLAY 'Z130-SQL-INSERT-ASHADR'.                            65545000
655460                                                                  65546000
655470     PERFORM                                                      65547000
655480       WITH TEST AFTER                                            65548000
655490       VARYING PW-RETRY-COUNTER FROM 1 BY 1                       65549000
655500         UNTIL PW-RETRY-COUNTER > PC-MAX-RETRIES                  65550000
655600            OR SQLCODE = ZERO                                     65560000
655700            OR SQLCODE = PC-NEG-803                               65570000
655800                                                                  65580000
655900         EXEC SQL                                                 65590000
656000         INSERT INTO TASHADR                                      65600000
656100                                                                  65610000
656200         (NAME_CDE,                                               65620000
656300          CUST_NAME,                                              65630000
656400          NAME_ID_CDE,                                            65640000
656500          NAME_ID_QUAL_CDE,                                       65650000
656600          CTY_NAME,                                               65660000
656700          ST_CDE,                                                 65670000
656800          ZIP_CDE,                                                65680000
656900          CNTRY_CDE,                                              65690000
657000          ASNHDR_ID)                                              65700000
657100         VALUES                                                   65710000
657200        (:PW-HOLD-NAME-CDE,                                       65720000
657300         :PW-HOLD-CUST-NAME,                                      65730000
657400         :PW-HOLD-NAME-ID-CDE:PV-NAME-ID-CDE-NULL,                65740000
657500         :PW-HOLD-NAME-ID-QUAL-CDE:PV-NAME-ID-QUAL-CDE-NULL,      65750000
657600         :PW-HOLD-CTY-NAME:PV-CTY-NAME-NULL,                      65760000
657700         :PW-HOLD-ST-CDE:PV-ST-CDE-NULL,                          65770000
657800         :PW-HOLD-ZIP-CDE:PV-ZIP-CDE-NULL,                        65780000
657900         :PW-HOLD-CNTRY-CDE:PV-CNTRY-CDE-NULL,                    65790000
658000         :PV-ASNHDR-ID)                                           65800000
658100         END-EXEC                                                 65810000
658200                                                                  65820000
658300         EVALUATE TRUE                                            65830000
658400           WHEN SQLCODE = ZERO                                    65840000
658500           WHEN SQLCODE = PC-NEG-904                              65850000
658600           WHEN SQLCODE = PC-NEG-913                              65860000
658700           WHEN SQLCODE = PC-NEG-803                              65870000
658800                 CONTINUE                                         65880000
658900                                                                  65890000
659000           WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                65900000
659100                 DISPLAY '**************************************' 65910000
659200                 DISPLAY 'WARNING ISSUED ON INSERT OF TASHADR   ' 65920000
659300                 DISPLAY 'PC-OPERCO-NBR:         '                65930000
659400                          PC-OPERCO-NBR                           65940000
659500                 DISPLAY 'PW-HOLD-EDI-VEND-ID:   '                65950000
659600                          PW-HOLD-EDI-VEND-ID                     65960000
659700                 DISPLAY 'PW-ASNHDR-NBR:         '                65970000
659800                          PW-ASNHDR-NBR                           65980000
659900                 DISPLAY 'PW-HOLD-NAME-CDE:      '                65990000
660000                          PW-HOLD-NAME-CDE                        66000000
660100                 DISPLAY '**********************************'     66010000
660200                 PERFORM Z800-SQL-WARNING                         66020000
660300                                                                  66030000
660400           WHEN  SQLCODE < ZERO                                   66040000
660500                 DISPLAY '**************************************' 66050000
660600                 DISPLAY 'ERROR ISSUED ON INSERT OF TASHADR     ' 66060000
660700                 DISPLAY 'PC-OPERCO-NBR:         '                66070000
660800                          PC-OPERCO-NBR                           66080000
660900                 DISPLAY 'PW-HOLD-EDI-VEND-ID:   '                66090000
661000                          PW-HOLD-EDI-VEND-ID                     66100000
661100                 DISPLAY 'PW-ASNHDR-NBR:         '                66110000
661200                          PW-ASNHDR-NBR                           66120000
661300                 DISPLAY 'PW-HOLD-NAME-CDE:      '                66130000
661400                          PW-HOLD-NAME-CDE                        66140000
661500                 DISPLAY '**************************************' 66150000
661600                 PERFORM Z900-SQL-ERROR                           66160000
661700                                                                  66170000
661800         END-EVALUATE                                             66180000
661900                                                                  66190000
662000     END-PERFORM.                                                 66200000
662100                                                                  66210000
662200     EVALUATE TRUE                                                66220000
662300       WHEN SQLCODE = ZERO                                        66230000
662400       WHEN SQLCODE = PC-NEG-803                                  66240000
662500         CONTINUE                                                 66250000
662600       WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                    66260000
662700             DISPLAY '******************************************' 66270000
662800             DISPLAY 'WARNING ISSUED ON INSERT OF TASHADR       ' 66280000
662900             DISPLAY 'PC-OPERCO-NBR:         '                    66290000
663000                      PC-OPERCO-NBR                               66300000
663100             DISPLAY 'PW-HOLD-EDI-VEND-ID:   '                    66310000
663200                      PW-HOLD-EDI-VEND-ID                         66320000
663300             DISPLAY 'PW-ASNHDR-NBR:         '                    66330000
663400                      PW-ASNHDR-NBR                               66340000
663500             DISPLAY 'PW-HOLD-NAME-CDE:      '                    66350000
663600                      PW-HOLD-NAME-CDE                            66360000
663700             DISPLAY '******************************************' 66370000
663800             PERFORM Z800-SQL-WARNING                             66380000
663900                                                                  66390000
664000       WHEN  SQLCODE < ZERO AND SQLCODE NOT = PC-NEG-803          66400000
664100             DISPLAY '******************************************' 66410000
664200             DISPLAY 'ERROR ISSUED ON INSERT OF TASHADR         ' 66420000
664300             DISPLAY 'PC-OPERCO-NBR:         '                    66430000
664400                      PC-OPERCO-NBR                               66440000
664500             DISPLAY 'PW-HOLD-EDI-VEND-ID:   '                    66450000
664600                      PW-HOLD-EDI-VEND-ID                         66460000
664700             DISPLAY 'PW-ASNHDR-NBR:         '                    66470000
664800                      PW-ASNHDR-NBR                               66480000
664900             DISPLAY 'PW-HOLD-NAME-CDE:      '                    66490000
665000                      PW-HOLD-NAME-CDE                            66500000
665100             DISPLAY '******************************************' 66510000
665200             PERFORM Z900-SQL-ERROR                               66520000
665300                                                                  66530000
665400     END-EVALUATE.                                                66540000
665500/                                                                 66550000
665600***************************************************************** 66560000
665700*     SQL INSERT ASHANM                                         * 66570000
665800*                                                               * 66580000
665900***************************************************************** 66590000
666000 Z140-SQL-INSERT-ASHANM.                                          66600000
666100     MOVE 'Z140-SQL-INSERT-ASHANM             '                   66610000
666200                                 TO PW-CURRENT-PARA.              66620000
666300*    DISPLAY 'Z140-SQL-INSERT-ASHANM'.                            66630000
666400                                                                  66640000
666500     MOVE PW-SUB                 TO ASHANM-ASHANM-NBR.            66650000
666600     MOVE PW-NAME-TXT (PW-SUB)   TO ASHANM-ASHANM-TXT.            66660000
666700                                                                  66670000
666800     PERFORM                                                      66680000
666900       WITH TEST AFTER                                            66690000
667000       VARYING PW-RETRY-COUNTER FROM 1 BY 1                       66700000
667100       UNTIL   PW-RETRY-COUNTER > PC-MAX-RETRIES  OR              66710000
667200               SQLCODE = ZERO                                     66720000
667300            OR SQLCODE = PC-NEG-803                               66730000
667400                                                                  66740000
667500         EXEC SQL                                                 66750000
667600         INSERT INTO TASHANM                                      66760000
667700                                                                  66770000
667800         (NAME_CDE,                                               66780000
667900          ASHANM_NBR,                                             66790000
668000          ASHANM_TXT,                                             66800000
668100          ASNHDR_ID)                                              66810000
668200         VALUES                                                   66820000
668300        (:PW-HOLD-NAME-CDE,                                       66830000
668400         :ASHANM-ASHANM-NBR,                                      66840000
668500         :ASHANM-ASHANM-TXT,                                      66850000
668600         :PV-ASNHDR-ID)                                           66860000
668700         END-EXEC                                                 66870000
668800                                                                  66880000
668900         EVALUATE TRUE                                            66890000
669000           WHEN SQLCODE = ZERO                                    66900000
669100           WHEN SQLCODE = PC-NEG-904                              66910000
669200           WHEN SQLCODE = PC-NEG-913                              66920000
669300           WHEN SQLCODE = PC-NEG-803                              66930000
669400                 CONTINUE                                         66940000
669500                                                                  66950000
669600           WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                66960000
669700                 DISPLAY '**************************************' 66970000
669800                 DISPLAY 'WARNING ISSUED ON INSERT OF TASHANM   ' 66980000
669900                 DISPLAY 'PC-OPERCO-NBR:         '                66990000
670000                          PC-OPERCO-NBR                           67000000
670100                 DISPLAY 'PW-HOLD-EDI-VEND-ID:   '                67010000
670200                          PW-HOLD-EDI-VEND-ID                     67020000
670300                 DISPLAY 'PW-ASNHDR-NBR:         '                67030000
670400                          PW-ASNHDR-NBR                           67040000
670500                 DISPLAY 'PW-HOLD-NAME-CDE:      '                67050000
670600                          PW-HOLD-NAME-CDE                        67060000
670700                 DISPLAY 'ASHANM-ASHANM-NBR:     '                67070000
670800                          ASHANM-ASHANM-NBR                       67080000
670900                 DISPLAY '**********************************'     67090000
671000                 PERFORM Z800-SQL-WARNING                         67100000
671100                                                                  67110000
671200           WHEN  SQLCODE < ZERO                                   67120000
671300                 DISPLAY '**************************************' 67130000
671400                 DISPLAY 'ERROR ISSUED ON INSERT OF TASHANM     ' 67140000
671500                 DISPLAY 'PC-OPERCO-NBR:         '                67150000
671600                          PC-OPERCO-NBR                           67160000
671700                 DISPLAY 'PW-HOLD-EDI-VEND-ID:   '                67170000
671800                          PW-HOLD-EDI-VEND-ID                     67180000
671900                 DISPLAY 'PW-ASNHDR-NBR:         '                67190000
672000                          PW-ASNHDR-NBR                           67200000
672100                 DISPLAY 'PW-HOLD-NAME-CDE:      '                67210000
672200                          PW-HOLD-NAME-CDE                        67220000
672300                 DISPLAY 'ASHANM-ASHANM-NBR:     '                67230000
672400                          ASHANM-ASHANM-NBR                       67240000
672500                 DISPLAY '**************************************' 67250000
672600                 PERFORM Z900-SQL-ERROR                           67260000
672700                                                                  67270000
672800         END-EVALUATE                                             67280000
672900                                                                  67290000
673000     END-PERFORM.                                                 67300000
673100                                                                  67310000
673200     EVALUATE TRUE                                                67320000
673300       WHEN SQLCODE = ZERO                                        67330000
673400       WHEN SQLCODE = PC-NEG-803                                  67340000
673500         CONTINUE                                                 67350000
673600       WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                    67360000
673700             DISPLAY '******************************************' 67370000
673800             DISPLAY 'WARNING ISSUED ON INSERT OF TASHANM       ' 67380000
673900             DISPLAY 'PC-OPERCO-NBR:         '                    67390000
674000                      PC-OPERCO-NBR                               67400000
674100             DISPLAY 'PW-HOLD-EDI-VEND-ID:   '                    67410000
674200                      PW-HOLD-EDI-VEND-ID                         67420000
674300             DISPLAY 'PW-ASNHDR-NBR:         '                    67430000
674400                      PW-ASNHDR-NBR                               67440000
674500             DISPLAY 'PW-HOLD-NAME-CDE:      '                    67450000
674600                      PW-HOLD-NAME-CDE                            67460000
674700             DISPLAY 'ASHANM-ASHANM-NBR:     '                    67470000
674800                      ASHANM-ASHANM-NBR                           67480000
674900             DISPLAY '******************************************' 67490000
675000             PERFORM Z800-SQL-WARNING                             67500000
675100                                                                  67510000
675200       WHEN  SQLCODE < ZERO AND SQLCODE NOT = PC-NEG-803          67520000
675300             DISPLAY '******************************************' 67530000
675400             DISPLAY 'ERROR ISSUED ON INSERT OF TASHANM         ' 67540000
675500             DISPLAY 'PC-OPERCO-NBR:         '                    67550000
675600                      PC-OPERCO-NBR                               67560000
675700             DISPLAY 'PW-HOLD-EDI-VEND-ID:   '                    67570000
675800                      PW-HOLD-EDI-VEND-ID                         67580000
675900             DISPLAY 'PW-ASNHDR-NBR:         '                    67590000
676000                      PW-ASNHDR-NBR                               67600000
676100             DISPLAY 'PW-HOLD-NAME-CDE:      '                    67610000
676200                      PW-HOLD-NAME-CDE                            67620000
676300             DISPLAY 'ASHANM-ASHANM-NBR:     '                    67630000
676400                      ASHANM-ASHANM-NBR                           67640000
676500             DISPLAY '******************************************' 67650000
676600             PERFORM Z900-SQL-ERROR                               67660000
676700                                                                  67670000
676800     END-EVALUATE.                                                67680000
676900/                                                                 67690000
677000***************************************************************** 67700000
677100*     SQL INSERT ASHADT                                         * 67710000
677200*                                                               * 67720000
677300***************************************************************** 67730000
677400 Z150-SQL-INSERT-ASHADT.                                          67740000
677500     MOVE 'Z150-SQL-INSERT-ASHADT             '                   67750000
677600                                 TO PW-CURRENT-PARA.              67760000
677700*    DISPLAY 'Z150-SQL-INSERT-ASHADT'.                            67770000
677800                                                                  67780000
677900     MOVE PW-SUB                 TO ASHADT-ASHADT-NBR.            67790000
678000     MOVE PW-ADDR-TXT (PW-SUB)   TO ASHADT-ASHADT-TXT.            67800000
678100                                                                  67810000
678200     PERFORM                                                      67820000
678300       WITH TEST AFTER                                            67830000
678400       VARYING PW-RETRY-COUNTER FROM 1 BY 1                       67840000
678500       UNTIL   PW-RETRY-COUNTER > PC-MAX-RETRIES  OR              67850000
678600               SQLCODE = ZERO                                     67860000
678700            OR SQLCODE = PC-NEG-803                               67870000
678800                                                                  67880000
678900         EXEC SQL                                                 67890000
679000         INSERT INTO TASHADT                                      67900000
679100                                                                  67910000
679200         (NAME_CDE,                                               67920000
679300          ASHADT_NBR,                                             67930000
679400          ASHADT_TXT,                                             67940000
679500          ASNHDR_ID)                                              67950000
679600         VALUES                                                   67960000
679700        (:PW-HOLD-NAME-CDE,                                       67970000
679800         :ASHADT-ASHADT-NBR,                                      67980000
679900         :ASHADT-ASHADT-TXT,                                      67990000
680000         :PV-ASNHDR-ID)                                           68000000
680100         END-EXEC                                                 68010000
680200                                                                  68020000
680300         EVALUATE TRUE                                            68030000
680400           WHEN SQLCODE = ZERO                                    68040000
680500           WHEN SQLCODE = PC-NEG-904                              68050000
680600           WHEN SQLCODE = PC-NEG-913                              68060000
680700           WHEN SQLCODE = PC-NEG-803                              68070000
680800                 CONTINUE                                         68080000
680900                                                                  68090000
681000           WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                68100000
681100                 DISPLAY '**************************************' 68110000
681200                 DISPLAY 'WARNING ISSUED ON INSERT OF TASHADT   ' 68120000
681300                 DISPLAY 'PC-OPERCO-NBR:         '                68130000
681400                          PC-OPERCO-NBR                           68140000
681500                 DISPLAY 'PW-HOLD-EDI-VEND-ID:   '                68150000
681600                          PW-HOLD-EDI-VEND-ID                     68160000
681700                 DISPLAY 'PW-ASNHDR-NBR:         '                68170000
681800                          PW-ASNHDR-NBR                           68180000
681900                 DISPLAY 'PW-HOLD-NAME-CDE:      '                68190000
682000                          PW-HOLD-NAME-CDE                        68200000
682100                 DISPLAY 'ASHADT-ASHADT-NBR:     '                68210000
682200                          ASHADT-ASHADT-NBR                       68220000
682300                 DISPLAY '**********************************'     68230000
682400                 PERFORM Z800-SQL-WARNING                         68240000
682500                                                                  68250000
682600           WHEN  SQLCODE < ZERO                                   68260000
682700                 DISPLAY '**************************************' 68270000
682800                 DISPLAY 'ERROR ISSUED ON INSERT OF TASHADT     ' 68280000
682900                 DISPLAY 'PC-OPERCO-NBR:         '                68290000
683000                          PC-OPERCO-NBR                           68300000
683100                 DISPLAY 'PW-HOLD-EDI-VEND-ID:   '                68310000
683200                          PW-HOLD-EDI-VEND-ID                     68320000
683300                 DISPLAY 'PW-ASNHDR-NBR:         '                68330000
683400                          PW-ASNHDR-NBR                           68340000
683500                 DISPLAY 'PW-HOLD-NAME-CDE:      '                68350000
683600                          PW-HOLD-NAME-CDE                        68360000
683700                 DISPLAY 'ASHADT-ASHADT-NBR:     '                68370000
683800                          ASHADT-ASHADT-NBR                       68380000
683900                 DISPLAY '**************************************' 68390000
684000                 PERFORM Z900-SQL-ERROR                           68400000
684100                                                                  68410000
684200         END-EVALUATE                                             68420000
684300                                                                  68430000
684400     END-PERFORM.                                                 68440000
684500                                                                  68450000
684600     EVALUATE TRUE                                                68460000
684700       WHEN SQLCODE = ZERO                                        68470000
684800       WHEN SQLCODE = PC-NEG-803                                  68480000
684900         CONTINUE                                                 68490000
685000       WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                    68500000
685100             DISPLAY '******************************************' 68510000
685200             DISPLAY 'WARNING ISSUED ON INSERT OF TASHADT       ' 68520000
685300             DISPLAY 'PC-OPERCO-NBR:         '                    68530000
685400                      PC-OPERCO-NBR                               68540000
685500             DISPLAY 'PW-HOLD-EDI-VEND-ID:   '                    68550000
685600                      PW-HOLD-EDI-VEND-ID                         68560000
685700             DISPLAY 'PW-ASNHDR-NBR:         '                    68570000
685800                      PW-ASNHDR-NBR                               68580000
685900             DISPLAY 'PW-HOLD-NAME-CDE:      '                    68590000
686000                      PW-HOLD-NAME-CDE                            68600000
686100             DISPLAY 'ASHADT-ASHADT-NBR:     '                    68610000
686200                      ASHADT-ASHADT-NBR                           68620000
686300             DISPLAY '******************************************' 68630000
686400             PERFORM Z800-SQL-WARNING                             68640000
686500                                                                  68650000
686600       WHEN  SQLCODE < ZERO AND SQLCODE NOT = PC-NEG-803          68660000
686700             DISPLAY '******************************************' 68670000
686800             DISPLAY 'ERROR ISSUED ON INSERT OF TASHADT         ' 68680000
686900             DISPLAY 'PC-OPERCO-NBR:         '                    68690000
687000                      PC-OPERCO-NBR                               68700000
687100             DISPLAY 'PW-HOLD-EDI-VEND-ID:   '                    68710000
687200                      PW-HOLD-EDI-VEND-ID                         68720000
687300             DISPLAY 'PW-ASNHDR-NBR:         '                    68730000
687400                      PW-ASNHDR-NBR                               68740000
687500             DISPLAY 'PW-HOLD-NAME-CDE:      '                    68750000
687600                      PW-HOLD-NAME-CDE                            68760000
687700             DISPLAY 'ASHADT-ASHADT-NBR:     '                    68770000
687800                      ASHADT-ASHADT-NBR                           68780000
687900             DISPLAY '******************************************' 68790000
688000             PERFORM Z900-SQL-ERROR                               68800000
688100                                                                  68810000
688200     END-EVALUATE.                                                68820000
688300/                                                                 68830000
688400***************************************************************** 68840000
688500*     SQL INSERT ASNORD                                         * 68850000
688600*                                                               * 68860000
688700***************************************************************** 68870000
688800 Z160-SQL-INSERT-ASNORD.                                          68880000
688900     MOVE 'Z160-SQL-INSERT-ASNORD             '                   68890000
689000                                 TO PW-CURRENT-PARA.              68900000
689100*    DISPLAY 'Z160-SQL-INSERT-ASNORD'.                            68910000
689200                                                                  68920000
689300     PERFORM                                                      68930000
689400       WITH TEST AFTER                                            68940000
689500       VARYING PW-RETRY-COUNTER FROM 1 BY 1                       68950000
689600       UNTIL   PW-RETRY-COUNTER > PC-MAX-RETRIES  OR              68960000
689700               SQLCODE = ZERO OR PC-NEG-803                       68970000
689800                                                                  68980000
689900         EXEC SQL                                                 68990000
690000         INSERT INTO TASNORD                                      69000000
690100                                                                  69010000
690200         (ASNHDR_ID,                                              69020000
690300          PO_NBR,                                                 69030000
690400          SEQ_NBR,                                                69040000
690500          SELR_INV_NBR,                                           69050000
690600          VEND_ORD_NBR,                                           69060000
690700          CUST_NBR,                                               69070000
690800          PROMO_NBR,                                              69080000
690900          VEND_NBR,                                               69090000
691000          MDSEDP_NBR,                                             69100000
691100          ORD_STATUS_CDE,                                         69110000
691200          CHG_ORD_SEQ_NBR,                                        69120000
691300          PO_DTE,                                                 69130000
691400          LTE_CHG_AMT,                                            69140000
691500          EXCH_FCTR,                                              69150000
691600          SELR_CUR_CDE,                                           69160000
691700          MTCH_PO_CDE,                                            69170000
691800          EARLY_LTE_CDE,                                          69180000
691900          SEQ_NBR_IND,                                            69190000
692000          CART_SHIP_QTY,                                          69200000
692100          LOC_NBR)                                                69210000
692200         VALUES                                                   69220000
692300        (:PV-ASNHDR-ID,                                           69230000
692400         :PW-ASNORD-PO-NBR,                                       69240000
692500         :PW-ASNORD-SEQ-NBR,                                      69250000
692600         :PW-ASNORD-SELR-INV-NBR,                                 69260000
692700         :PW-ASNORD-VEND-ORD-NBR:PV-VEND-ORD-NBR-NULL,            69270000
692800         :PW-ASNORD-CUST-NBR:PV-CUST-NBR-NULL,                    69280000
692900         :PW-ASNORD-PROMO-NBR:PV-PROMO-NBR-NULL,                  69290000
693000         :PW-ASNORD-VEND-NBR:PV-VEND-NBR-NULL,                    69300000
693100         :PW-ASNORD-MDSEDP-NBR,                                   69310000
693200         :PW-ASNORD-ORD-STATUS-CDE:PV-ORD-STATUS-CDE-NULL,        69320000
693300         :PW-ASNORD-CHG-ORD-SEQ-NBR:PV-CHG-ORD-SEQ-NBR-NULL,      69330000
693400         :PW-HOLD-PO-DTE-REDF:PV-PO-DTE-NULL,                     69340000
693500         :PW-ASNORD-LTE-CHG-AMT,                                  69350000
693600         :PW-ASNORD-EXCH-FCTR:PV-EXCH-FCTR-NULL,                  69360000
693700         :PW-ASNORD-SELR-CUR-CDE:PV-SELR-CUR-CDE-NULL,            69370000
693800         :PC-MTCH-PO-CDE,                                         69380000
693900         :PW-ASNORD-EARLY-LTE-CDE,                                69390000
694000         :PW-ASNORD-SEQ-NBR-IND,                                  69400000
694100         :PW-ASNORD-CART-SHIP-QTY,                                69410000
694200         :PW-ASNORD-LOC-NBR)                                      69420000
694300         END-EXEC                                                 69430000
694400                                                                  69440000
694500         EVALUATE TRUE                                            69450000
694600           WHEN SQLCODE = ZERO                                    69460000
694700           WHEN SQLCODE = PC-NEG-803                              69470000
694800           WHEN SQLCODE = PC-NEG-904                              69480000
694900           WHEN SQLCODE = PC-NEG-913                              69490000
695000                 CONTINUE                                         69500000
695100                                                                  69510000
695200           WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                69520000
695300                 DISPLAY '**************************************' 69530000
695400                 DISPLAY 'WARNING ISSUED ON INSERT OF TASNORD   ' 69540000
695500                 DISPLAY 'PC-OPERCO-NBR:         '                69550000
695600                          PC-OPERCO-NBR                           69560000
695700                 DISPLAY 'PW-HOLD-EDI-VEND-ID:   '                69570000
695800                          PW-HOLD-EDI-VEND-ID                     69580000
695900                 DISPLAY 'PW-ASNHDR-NBR:         '                69590000
696000                          PW-ASNHDR-NBR                           69600000
696100                 DISPLAY 'PW-ASNORD-PO-NBR:      '                69610000
696200                          PW-ASNORD-PO-NBR                        69620000
696300                 DISPLAY 'PW-ASNORD-LOC-NBR:     '                69630000
696400                          PW-ASNORD-LOC-NBR                       69640000
696500                 DISPLAY 'PW-ASNORD-SEQ-NBR:     '                69650000
696600                          PW-ASNORD-SEQ-NBR                       69660000
696700                 DISPLAY 'PW-ASNORD-SELR-INV-NBR: '               69670000
696800                          PW-ASNORD-SELR-INV-NBR                  69680000
696900                 DISPLAY '**********************************'     69690000
697000                 PERFORM Z800-SQL-WARNING                         69700000
697100                                                                  69710000
697200           WHEN  SQLCODE < ZERO                                   69720000
697300                 DISPLAY '**************************************' 69730000
697400                 DISPLAY 'ERROR ISSUED ON INSERT OF TASNORD     ' 69740000
697500                 DISPLAY 'PC-OPERCO-NBR:         '                69750000
697600                          PC-OPERCO-NBR                           69760000
697700                 DISPLAY 'PW-HOLD-EDI-VEND-ID:   '                69770000
697800                          PW-HOLD-EDI-VEND-ID                     69780000
697900                 DISPLAY 'PW-ASNHDR-NBR:         '                69790000
698000                          PW-ASNHDR-NBR                           69800000
698100                 DISPLAY 'PW-ASNORD-PO-NBR:      '                69810000
698200                          PW-ASNORD-PO-NBR                        69820000
698300                 DISPLAY 'PW-ASNORD-LOC-NBR:     '                69830000
698400                          PW-ASNORD-LOC-NBR                       69840000
698500                 DISPLAY 'PW-ASNORD-SEQ-NBR:     '                69850000
698600                          PW-ASNORD-SEQ-NBR                       69860000
698700                 DISPLAY 'PW-ASNORD-SELR-INV-NBR: '               69870000
698800                          PW-ASNORD-SELR-INV-NBR                  69880000
698900                 DISPLAY '**************************************' 69890000
699000                 PERFORM Z900-SQL-ERROR                           69900000
699100                                                                  69910000
699200         END-EVALUATE                                             69920000
699300                                                                  69930000
699400     END-PERFORM.                                                 69940000
699500                                                                  69950000
699600     EVALUATE TRUE                                                69960000
699700       WHEN SQLCODE = ZERO                                        69970000
699800       WHEN SQLCODE = PC-NEG-803                                  69980000
699900         CONTINUE                                                 69990000
700000       WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                    70000000
700100             DISPLAY '******************************************' 70010000
700200             DISPLAY 'WARNING ISSUED ON INSERT OF TASNORD       ' 70020000
700300             DISPLAY 'PC-OPERCO-NBR:         '                    70030000
700400                      PC-OPERCO-NBR                               70040000
700500             DISPLAY 'PW-HOLD-EDI-VEND-ID:   '                    70050000
700600                      PW-HOLD-EDI-VEND-ID                         70060000
700700             DISPLAY 'PW-ASNHDR-NBR:         '                    70070000
700800                      PW-ASNHDR-NBR                               70080000
700900             DISPLAY 'PW-ASNORD-PO-NBR:      '                    70090000
701000                      PW-ASNORD-PO-NBR                            70100000
701100             DISPLAY 'PW-ASNORD-LOC-NBR:     '                    70110000
701200                      PW-ASNORD-LOC-NBR                           70120000
701300             DISPLAY 'PW-ASNORD-SEQ-NBR:     '                    70130000
701400                      PW-ASNORD-SEQ-NBR                           70140000
701500             DISPLAY 'PW-ASNORD-SELR-INV-NBR: '                   70150000
701600                      PW-ASNORD-SELR-INV-NBR                      70160000
701700             DISPLAY '******************************************' 70170000
701800             PERFORM Z800-SQL-WARNING                             70180000
701900                                                                  70190000
702000       WHEN  SQLCODE < ZERO                                       70200000
702100             DISPLAY '******************************************' 70210000
702200             DISPLAY 'ERROR ISSUED ON INSERT OF TASNORD         ' 70220000
702300             DISPLAY 'PC-OPERCO-NBR:         '                    70230000
702400                      PC-OPERCO-NBR                               70240000
702500             DISPLAY 'PW-HOLD-EDI-VEND-ID:   '                    70250000
702600                      PW-HOLD-EDI-VEND-ID                         70260000
702700             DISPLAY 'PW-ASNHDR-NBR:         '                    70270000
702800                      PW-ASNHDR-NBR                               70280000
702900             DISPLAY 'PW-ASNORD-PO-NBR:      '                    70290000
703000                      PW-ASNORD-PO-NBR                            70300000
703100             DISPLAY 'PW-ASNORD-LOC-NBR:     '                    70310000
703200                      PW-ASNORD-LOC-NBR                           70320000
703300             DISPLAY 'PW-ASNORD-SEQ-NBR:     '                    70330000
703400                      PW-ASNORD-SEQ-NBR                           70340000
703500             DISPLAY 'PW-ASNORD-SELR-INV-NBR: '                   70350000
703600                      PW-ASNORD-SELR-INV-NBR                      70360000
703700             DISPLAY '******************************************' 70370000
703800             PERFORM Z900-SQL-ERROR                               70380000
703900                                                                  70390000
704000     END-EVALUATE.                                                70400000
704100/                                                                 70410000
704200 Z161-CHK-ASNORD-SEQ-NBR-ZERO.                                    70420000
704300     MOVE 'Z161-CHK-ASNORD-SEQ-NBR-ZERO'                          70430000
704400                                 TO PW-CURRENT-PARA.              70440000
704500                                                                  70450000
704600     PERFORM                                                      70460000
704700       WITH TEST AFTER                                            70470000
704800       VARYING PW-RETRY-COUNTER FROM 1 BY 1                       70480000
704900       UNTIL   PW-RETRY-COUNTER > PC-MAX-RETRIES  OR              70490000
705000               SQLCODE = ZERO  OR                                 70500000
705100               SQLCODE = PC-POS-100                               70510000
705200         EXEC SQL                                                 70520000
705300              SELECT 1                                            70530000
705400                INTO :PA-SEQ-NBR-ZERO-CNT                         70540000
705500                FROM SYSIBM.SYSDUMMY1 X                           70550000
705600               WHERE EXISTS (SELECT 1                             70560000
705700                   FROM TASNORD                                   70570000
705800                  WHERE X.IBMREQD > ' '                           70580000
705900                    AND ASNHDR_ID    = :PV-ASNHDR-ID              70590000
706000                    AND PO_NBR       = :PW-ASNORD-PO-NBR          70600000
706100                    AND SEQ_NBR      = 0)                         70610000
706200         END-EXEC                                                 70620000
706300                                                                  70630000
706400         EVALUATE TRUE                                            70640000
706500             WHEN SQLCODE = ZERO                                  70650000
706600             WHEN SQLCODE = PC-POS-100                            70660000
706700             WHEN SQLCODE = PC-NEG-904                            70670000
706800             WHEN SQLCODE = PC-NEG-913                            70680000
706900                 CONTINUE                                         70690000
707000             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')              70700000
707100                 DISPLAY '**************************************' 70710000
707200                 DISPLAY 'WARNING ISSUED ON SELECT OF TASNORD   ' 70720000
707300                 DISPLAY 'PC-OPERCO-NBR:         '                70730000
707400                          PC-OPERCO-NBR                           70740000
707500                 DISPLAY 'PW-HOLD-EDI-VEND-ID:   '                70750000
707600                          PW-HOLD-EDI-VEND-ID                     70760000
707700                 DISPLAY 'PV-ASNHDR-ID:          '                70770000
707800                          PV-ASNHDR-ID                            70780000
707900                 DISPLAY 'PW-ASNORD-PO-NBR:      '                70790000
708000                          PW-ASNORD-PO-NBR                        70800000
708100                 DISPLAY 'PW-ASNORD-LOC-NBR:     '                70810000
708200                          PW-ASNORD-LOC-NBR                       70820000
708300                 DISPLAY 'PW-ASNORD-SEQ-NBR:     '                70830000
708400                          PW-ASNORD-SEQ-NBR                       70840000
708500                 DISPLAY 'PW-ASNORD-SELR-INV-NBR: '               70850000
708600                          PW-ASNORD-SELR-INV-NBR                  70860000
708700                 DISPLAY '**********************************'     70870000
708800                 PERFORM Z800-SQL-WARNING                         70880000
708900                                                                  70890000
709000             WHEN  SQLCODE < ZERO                                 70900000
709100                 DISPLAY '**************************************' 70910000
709200                 DISPLAY 'ERROR ISSUED ON SELECT OF TASNORD     ' 70920000
709300                 DISPLAY 'PC-OPERCO-NBR:         '                70930000
709400                          PC-OPERCO-NBR                           70940000
709500                 DISPLAY 'PW-HOLD-EDI-VEND-ID:   '                70950000
709600                          PW-HOLD-EDI-VEND-ID                     70960000
709700                 DISPLAY 'PV-ASNHDR-ID:          '                70970000
709800                          PV-ASNHDR-ID                            70980000
709900                 DISPLAY 'PW-ASNORD-PO-NBR:      '                70990000
710000                          PW-ASNORD-PO-NBR                        71000000
710100                 DISPLAY 'PW-ASNORD-LOC-NBR:     '                71010000
710200                          PW-ASNORD-LOC-NBR                       71020000
710300                 DISPLAY 'PW-ASNORD-SEQ-NBR:     '                71030000
710400                          PW-ASNORD-SEQ-NBR                       71040000
710500                 DISPLAY 'PW-ASNORD-SELR-INV-NBR: '               71050000
710600                          PW-ASNORD-SELR-INV-NBR                  71060000
710700                 DISPLAY '**************************************' 71070000
710800                 PERFORM Z900-SQL-ERROR                           71080000
710900         END-EVALUATE                                             71090000
711000     END-PERFORM.                                                 71100000
711100 Z162-CHK-EXIST-LOC-NBR.                                          71110000
711200     MOVE 'Z162-CHK-EXIST-LOC-NBR'                                71120000
711300                                 TO PW-CURRENT-PARA.              71130000
711400                                                                  71140000
711500     PERFORM                                                      71150000
711600       WITH TEST AFTER                                            71160000
711700       VARYING PW-RETRY-COUNTER FROM 1 BY 1                       71170000
711800       UNTIL   PW-RETRY-COUNTER > PC-MAX-RETRIES  OR              71180000
711900               SQLCODE = ZERO  OR                                 71190000
712000               SQLCODE = PC-POS-100                               71200000
712100         EXEC SQL                                                 71210000
712200              SELECT 1                                            71220000
712300                INTO :PA-SEQ-NBR-ZERO-CNT                         71230000
712400                FROM SYSIBM.SYSDUMMY1 X                           71240000
712500               WHERE EXISTS (SELECT 1                             71250000
712600                   FROM TASNORD                                   71260000
712700                  WHERE X.IBMREQD > ' '                           71270000
712800                    AND ASNHDR_ID    = :PV-ASNHDR-ID              71280000
712900                    AND PO_NBR       = :PW-ASNORD-PO-NBR          71290000
713000                    AND LOC_NBR      = :PW-ASNORD-LOC-NBR)        71300000
713100         END-EXEC                                                 71310000
713200                                                                  71320000
713300         EVALUATE TRUE                                            71330000
713400             WHEN SQLCODE = ZERO                                  71340000
713500             WHEN SQLCODE = PC-POS-100                            71350000
713600             WHEN SQLCODE = PC-NEG-904                            71360000
713700             WHEN SQLCODE = PC-NEG-913                            71370000
713800                 CONTINUE                                         71380000
713900             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')              71390000
714000                 DISPLAY '**************************************' 71400000
714100                 DISPLAY 'WARNING ISSUED ON SELECT OF TASNORD   ' 71410000
714200                 DISPLAY 'PC-OPERCO-NBR:         '                71420000
714300                          PC-OPERCO-NBR                           71430000
714400                 DISPLAY 'PW-HOLD-EDI-VEND-ID:   '                71440000
714500                          PW-HOLD-EDI-VEND-ID                     71450000
714600                 DISPLAY 'PV-ASNHDR-ID:          '                71460000
714700                          PV-ASNHDR-ID                            71470000
714800                 DISPLAY 'PW-ASNORD-PO-NBR:      '                71480000
714900                          PW-ASNORD-PO-NBR                        71490000
715000                 DISPLAY 'PW-ASNORD-LOC-NBR:     '                71500000
715100                          PW-ASNORD-LOC-NBR                       71510000
715200                 DISPLAY 'PW-ASNORD-SEQ-NBR:     '                71520000
715300                          PW-ASNORD-SEQ-NBR                       71530000
715400                 DISPLAY 'PW-ASNORD-SELR-INV-NBR: '               71540000
715500                          PW-ASNORD-SELR-INV-NBR                  71550000
715600                 DISPLAY '**********************************'     71560000
715700                 PERFORM Z800-SQL-WARNING                         71570000
715800                                                                  71580000
715900             WHEN  SQLCODE < ZERO                                 71590000
716000                 DISPLAY '**************************************' 71600000
716100                 DISPLAY 'ERROR ISSUED ON SELECT OF TASNORD     ' 71610000
716200                 DISPLAY 'PC-OPERCO-NBR:         '                71620000
716300                          PC-OPERCO-NBR                           71630000
716400                 DISPLAY 'PW-HOLD-EDI-VEND-ID:   '                71640000
716500                          PW-HOLD-EDI-VEND-ID                     71650000
716600                 DISPLAY 'PV-ASNHDR-ID:          '                71660000
716700                          PV-ASNHDR-ID                            71670000
716800                 DISPLAY 'PW-ASNORD-PO-NBR:      '                71680000
716900                          PW-ASNORD-PO-NBR                        71690000
717000                 DISPLAY 'PW-ASNORD-LOC-NBR:     '                71700000
717100                          PW-ASNORD-LOC-NBR                       71710000
717200                 DISPLAY 'PW-ASNORD-SEQ-NBR:     '                71720000
717300                          PW-ASNORD-SEQ-NBR                       71730000
717400                 DISPLAY 'PW-ASNORD-SELR-INV-NBR: '               71740000
717500                          PW-ASNORD-SELR-INV-NBR                  71750000
717600                 DISPLAY '**************************************' 71760000
717700                 PERFORM Z900-SQL-ERROR                           71770000
717800         END-EVALUATE                                             71780000
717900     END-PERFORM.                                                 71790000
718000                                                                  71800000
718100***************************************************************** 71810000
718200*     SQL INSERT ASOADR                                         * 71820000
718300*                                                               * 71830000
718400***************************************************************** 71840000
718500 Z170-SQL-INSERT-ASOADR.                                          71850000
718600     MOVE 'Z170-SQL-INSERT-ASOADR             '                   71860000
718700                                 TO PW-CURRENT-PARA.              71870000
718800*    DISPLAY 'Z170-SQL-INSERT-ASOADR'.                            71880000
718900                                                                  71890000
719000     PERFORM                                                      71900000
719100       WITH TEST AFTER                                            71910000
719200       VARYING PW-RETRY-COUNTER FROM 1 BY 1                       71920000
719300       UNTIL   PW-RETRY-COUNTER > PC-MAX-RETRIES  OR              71930000
719400               SQLCODE = ZERO                                     71940000
719500            OR SQLCODE = PC-NEG-803                               71950000
719600                                                                  71960000
719700         EXEC SQL                                                 71970000
719800         INSERT INTO TASOADR                                      71980000
719900                                                                  71990000
720000         (PO_NBR,                                                 72000000
720100          SEQ_NBR,                                                72010000
720200          SELR_INV_NBR,                                           72020000
720300          NAME_CDE,                                               72030000
720400          CUST_NAME,                                              72040000
720500          NAME_ID_CDE,                                            72050000
720600          NAME_ID_QUAL_CDE,                                       72060000
720700          CTY_NAME,                                               72070000
720800          ST_CDE,                                                 72080000
720900          ZIP_CDE,                                                72090000
721000          CNTRY_CDE,                                              72100000
721100          ASNHDR_ID,                                              72110000
721200          LOC_NBR)                                                72120000
721300         VALUES                                                   72130000
721400        (:PW-ASNORD-PO-NBR,                                       72140000
721500         :PW-ASNORD-SEQ-NBR,                                      72150000
721600         :PW-ASNORD-SELR-INV-NBR,                                 72160000
721700         :PW-HOLD-NAME-CDE,                                       72170000
721800         :PW-HOLD-CUST-NAME,                                      72180000
721900         :PW-HOLD-NAME-ID-CDE:PV-NAME-ID-CDE-NULL,                72190000
722000         :PW-HOLD-NAME-ID-QUAL-CDE:PV-NAME-ID-QUAL-CDE-NULL,      72200000
722100         :PW-HOLD-CTY-NAME:PV-CTY-NAME-NULL,                      72210000
722200         :PW-HOLD-ST-CDE:PV-ST-CDE-NULL,                          72220000
722300         :PW-HOLD-ZIP-CDE:PV-ZIP-CDE-NULL,                        72230000
722400         :PW-HOLD-CNTRY-CDE:PV-CNTRY-CDE-NULL,                    72240000
722500         :PV-ASNHDR-ID,                                           72250000
722600         :PW-ASNORD-LOC-NBR)                                      72260000
722700         END-EXEC                                                 72270000
722800                                                                  72280000
722900         EVALUATE TRUE                                            72290000
723000           WHEN SQLCODE = ZERO                                    72300000
723100           WHEN SQLCODE = PC-NEG-904                              72310000
723200           WHEN SQLCODE = PC-NEG-913                              72320000
723300           WHEN SQLCODE = PC-NEG-803                              72330000
723400                 CONTINUE                                         72340000
723500                                                                  72350000
723600           WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                72360000
723700                 DISPLAY '**************************************' 72370000
723800                 DISPLAY 'WARNING ISSUED ON INSERT OF TASOADR   ' 72380000
723900                 DISPLAY 'PC-OPERCO-NBR:         '                72390000
724000                          PC-OPERCO-NBR                           72400000
724100                 DISPLAY 'PW-HOLD-EDI-VEND-ID:   '                72410000
724200                          PW-HOLD-EDI-VEND-ID                     72420000
724300                 DISPLAY 'PW-ASNHDR-NBR:         '                72430000
724400                          PW-ASNHDR-NBR                           72440000
724500                 DISPLAY 'PW-ASNORD-PO-NBR:      '                72450000
724600                          PW-ASNORD-PO-NBR                        72460000
724700                 DISPLAY 'PW-ASNORD-LOC-NBR:     '                72470000
724800                          PW-ASNORD-LOC-NBR                       72480000
724900                 DISPLAY 'PW-ASNORD-SEQ-NBR:     '                72490000
725000                          PW-ASNORD-SEQ-NBR                       72500000
725100                 DISPLAY 'PW-HOLD-NAME-CDE:      '                72510000
725200                          PW-HOLD-NAME-CDE                        72520000
725300                 DISPLAY 'PW-ASNORD-SELR-INV-NBR: '               72530000
725400                          PW-ASNORD-SELR-INV-NBR                  72540000
725500                 DISPLAY '**********************************'     72550000
725600                 PERFORM Z800-SQL-WARNING                         72560000
725700                                                                  72570000
725800           WHEN  SQLCODE < ZERO                                   72580000
725900                 DISPLAY '**************************************' 72590000
726000                 DISPLAY 'ERROR ISSUED ON INSERT OF TASOADR     ' 72600000
726100                 DISPLAY 'PC-OPERCO-NBR:         '                72610000
726200                          PC-OPERCO-NBR                           72620000
726300                 DISPLAY 'PW-HOLD-EDI-VEND-ID:   '                72630000
726400                          PW-HOLD-EDI-VEND-ID                     72640000
726500                 DISPLAY 'PW-ASNHDR-NBR:         '                72650000
726600                          PW-ASNHDR-NBR                           72660000
726700                 DISPLAY 'PW-ASNORD-PO-NBR:      '                72670000
726800                          PW-ASNORD-PO-NBR                        72680000
726900                 DISPLAY 'PW-ASNORD-LOC-NBR:     '                72690000
727000                          PW-ASNORD-LOC-NBR                       72700000
727100                 DISPLAY 'PW-ASNORD-SEQ-NBR:     '                72710000
727200                          PW-ASNORD-SEQ-NBR                       72720000
727300                 DISPLAY 'PW-HOLD-NAME-CDE:      '                72730000
727400                          PW-HOLD-NAME-CDE                        72740000
727500                 DISPLAY 'PW-ASNORD-SELR-INV-NBR: '               72750000
727600                          PW-ASNORD-SELR-INV-NBR                  72760000
727700                 DISPLAY '**************************************' 72770000
727800                 PERFORM Z900-SQL-ERROR                           72780000
727900                                                                  72790000
728000         END-EVALUATE                                             72800000
728100                                                                  72810000
728200     END-PERFORM.                                                 72820000
728300                                                                  72830000
728400     EVALUATE TRUE                                                72840000
728500       WHEN SQLCODE = ZERO                                        72850000
728600       WHEN SQLCODE = PC-NEG-803                                  72860000
728700         CONTINUE                                                 72870000
728800       WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                    72880000
728900             DISPLAY '******************************************' 72890000
729000             DISPLAY 'WARNING ISSUED ON INSERT OF TASOADR       ' 72900000
729100             DISPLAY 'PC-OPERCO-NBR:         '                    72910000
729200                      PC-OPERCO-NBR                               72920000
729300             DISPLAY 'PW-HOLD-EDI-VEND-ID:   '                    72930000
729400                      PW-HOLD-EDI-VEND-ID                         72940000
729500             DISPLAY 'PW-ASNHDR-NBR:         '                    72950000
729600                      PW-ASNHDR-NBR                               72960000
729700             DISPLAY 'PW-ASNORD-PO-NBR:      '                    72970000
729800                      PW-ASNORD-PO-NBR                            72980000
729900             DISPLAY 'PW-ASNORD-LOC-NBR:     '                    72990000
730000                      PW-ASNORD-LOC-NBR                           73000000
730100             DISPLAY 'PW-ASNORD-SEQ-NBR:     '                    73010000
730200                      PW-ASNORD-SEQ-NBR                           73020000
730300             DISPLAY 'PW-HOLD-NAME-CDE:      '                    73030000
730400                      PW-HOLD-NAME-CDE                            73040000
730500             DISPLAY 'PW-ASNORD-SELR-INV-NBR: '                   73050000
730600                      PW-ASNORD-SELR-INV-NBR                      73060000
730700             DISPLAY '******************************************' 73070000
730800             PERFORM Z800-SQL-WARNING                             73080000
730900                                                                  73090000
731000       WHEN  SQLCODE < ZERO AND SQLCODE NOT = PC-NEG-803          73100000
731100             DISPLAY '******************************************' 73110000
731200             DISPLAY 'ERROR ISSUED ON INSERT OF TASOADR         ' 73120000
731300             DISPLAY 'PC-OPERCO-NBR:         '                    73130000
731400                      PC-OPERCO-NBR                               73140000
731500             DISPLAY 'PW-HOLD-EDI-VEND-ID:   '                    73150000
731600                      PW-HOLD-EDI-VEND-ID                         73160000
731700             DISPLAY 'PW-ASNHDR-NBR:         '                    73170000
731800                      PW-ASNHDR-NBR                               73180000
731900             DISPLAY 'PW-ASNORD-PO-NBR:      '                    73190000
732000                      PW-ASNORD-PO-NBR                            73200000
732100             DISPLAY 'PW-ASNORD-LOC-NBR:     '                    73210000
732200                      PW-ASNORD-LOC-NBR                           73220000
732300             DISPLAY 'PW-ASNORD-SEQ-NBR:     '                    73230000
732400                      PW-ASNORD-SEQ-NBR                           73240000
732500             DISPLAY 'PW-HOLD-NAME-CDE:      '                    73250000
732600                      PW-HOLD-NAME-CDE                            73260000
732700             DISPLAY 'PW-ASNORD-SELR-INV-NBR: '                   73270000
732800                      PW-ASNORD-SELR-INV-NBR                      73280000
732900             DISPLAY '******************************************' 73290000
733000             PERFORM Z900-SQL-ERROR                               73300000
733100                                                                  73310000
733200     END-EVALUATE.                                                73320000
733300/                                                                 73330000
733400***************************************************************** 73340000
733500*     SQL INSERT ASOANM                                         * 73350000
733600*                                                               * 73360000
733700***************************************************************** 73370000
733800 Z180-SQL-INSERT-ASOANM.                                          73380000
733900     MOVE 'Z180-SQL-INSERT-ASOANM             '                   73390000
734000                                 TO PW-CURRENT-PARA.              73400000
734100*    DISPLAY 'Z180-SQL-INSERT-ASOANM'.                            73410000
734200                                                                  73420000
734300     MOVE PW-SUB                 TO ASOANM-ASOANM-NBR.            73430000
734400     MOVE PW-NAME-TXT (PW-SUB)   TO ASOANM-ASOANM-TXT.            73440000
734500                                                                  73450000
734600     PERFORM                                                      73460000
734700       WITH TEST AFTER                                            73470000
734800       VARYING PW-RETRY-COUNTER FROM 1 BY 1                       73480000
734900       UNTIL   PW-RETRY-COUNTER > PC-MAX-RETRIES  OR              73490000
735000               SQLCODE = ZERO                                     73500000
735100            OR SQLCODE = PC-NEG-803                               73510000
735200                                                                  73520000
735300         EXEC SQL                                                 73530000
735400         INSERT INTO TASOANM                                      73540000
735500                                                                  73550000
735600         (PO_NBR,                                                 73560000
735700          SEQ_NBR,                                                73570000
735800          SELR_INV_NBR,                                           73580000
735900          NAME_CDE,                                               73590000
736000          ASOANM_NBR,                                             73600000
736100          ASOANM_TXT,                                             73610000
736200          ASNHDR_ID)                                              73620000
736300         VALUES                                                   73630000
736400        (:PW-ASNORD-PO-NBR,                                       73640000
736500         :PW-ASNORD-SEQ-NBR,                                      73650000
736600         :PW-ASNORD-SELR-INV-NBR,                                 73660000
736700         :PW-HOLD-NAME-CDE,                                       73670000
736800         :ASOANM-ASOANM-NBR,                                      73680000
736900         :ASOANM-ASOANM-TXT,                                      73690000
737000         :PV-ASNHDR-ID)                                           73700000
737100         END-EXEC                                                 73710000
737200                                                                  73720000
737300         EVALUATE TRUE                                            73730000
737400           WHEN SQLCODE = ZERO                                    73740000
737500           WHEN SQLCODE = PC-NEG-904                              73750000
737600           WHEN SQLCODE = PC-NEG-913                              73760000
737700           WHEN SQLCODE = PC-NEG-803                              73770000
737800                 CONTINUE                                         73780000
737900                                                                  73790000
738000           WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                73800000
738100                 DISPLAY '**************************************' 73810000
738200                 DISPLAY 'WARNING ISSUED ON INSERT OF TASOANM   ' 73820000
738300                 DISPLAY 'PC-OPERCO-NBR:         '                73830000
738400                          PC-OPERCO-NBR                           73840000
738500                 DISPLAY 'PW-HOLD-EDI-VEND-ID:   '                73850000
738600                          PW-HOLD-EDI-VEND-ID                     73860000
738700                 DISPLAY 'PW-ASNHDR-NBR:         '                73870000
738800                          PW-ASNHDR-NBR                           73880000
738900                 DISPLAY 'PW-ASNORD-PO-NBR:      '                73890000
739000                          PW-ASNORD-PO-NBR                        73900000
739100                 DISPLAY 'PW-ASNORD-SEQ-NBR:     '                73910000
739200                          PW-ASNORD-SEQ-NBR                       73920000
739300                 DISPLAY 'PW-HOLD-NAME-CDE:      '                73930000
739400                          PW-HOLD-NAME-CDE                        73940000
739500                 DISPLAY 'ASOANM-ASOANM-NBR:     '                73950000
739600                          ASOANM-ASOANM-NBR                       73960000
739700                 DISPLAY 'PW-ASNORD-SELR-INV-NBR: '               73970000
739800                          PW-ASNORD-SELR-INV-NBR                  73980000
739900                 DISPLAY '**********************************'     73990000
740000                 PERFORM Z800-SQL-WARNING                         74000000
740100                                                                  74010000
740200           WHEN  SQLCODE < ZERO                                   74020000
740300                 DISPLAY '**************************************' 74030000
740400                 DISPLAY 'ERROR ISSUED ON INSERT OF TASOANM     ' 74040000
740500                 DISPLAY 'PC-OPERCO-NBR:         '                74050000
740600                          PC-OPERCO-NBR                           74060000
740700                 DISPLAY 'PW-HOLD-EDI-VEND-ID:   '                74070000
740800                          PW-HOLD-EDI-VEND-ID                     74080000
740900                 DISPLAY 'PW-ASNHDR-NBR:         '                74090000
741000                          PW-ASNHDR-NBR                           74100000
741100                 DISPLAY 'PW-ASNORD-PO-NBR:      '                74110000
741200                          PW-ASNORD-PO-NBR                        74120000
741300                 DISPLAY 'PW-ASNORD-SEQ-NBR:     '                74130000
741400                          PW-ASNORD-SEQ-NBR                       74140000
741500                 DISPLAY 'PW-HOLD-NAME-CDE:      '                74150000
741600                          PW-HOLD-NAME-CDE                        74160000
741700                 DISPLAY 'ASOANM-ASOANM-NBR:     '                74170000
741800                          ASOANM-ASOANM-NBR                       74180000
741900                 DISPLAY 'PW-ASNORD-SELR-INV-NBR: '               74190000
742000                          PW-ASNORD-SELR-INV-NBR                  74200000
742100                 DISPLAY '**************************************' 74210000
742200                 PERFORM Z900-SQL-ERROR                           74220000
742300                                                                  74230000
742400         END-EVALUATE                                             74240000
742500                                                                  74250000
742600     END-PERFORM.                                                 74260000
742700                                                                  74270000
742800     EVALUATE TRUE                                                74280000
742900       WHEN SQLCODE = ZERO                                        74290000
743000       WHEN SQLCODE = PC-NEG-803                                  74300000
743100         CONTINUE                                                 74310000
743200       WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                    74320000
743300             DISPLAY '******************************************' 74330000
743400             DISPLAY 'WARNING ISSUED ON INSERT OF TASOANM       ' 74340000
743500             DISPLAY 'PC-OPERCO-NBR:         '                    74350000
743600                      PC-OPERCO-NBR                               74360000
743700             DISPLAY 'PW-HOLD-EDI-VEND-ID:   '                    74370000
743800                      PW-HOLD-EDI-VEND-ID                         74380000
743900             DISPLAY 'PW-ASNHDR-NBR:         '                    74390000
744000                      PW-ASNHDR-NBR                               74400000
744100             DISPLAY 'PW-ASNORD-PO-NBR:      '                    74410000
744200                      PW-ASNORD-PO-NBR                            74420000
744300             DISPLAY 'PW-ASNORD-SEQ-NBR:     '                    74430000
744400                      PW-ASNORD-SEQ-NBR                           74440000
744500             DISPLAY 'PW-HOLD-NAME-CDE:      '                    74450000
744600                      PW-HOLD-NAME-CDE                            74460000
744700             DISPLAY 'ASOANM-ASOANM-NBR:     '                    74470000
744800                      ASOANM-ASOANM-NBR                           74480000
744900             DISPLAY 'PW-ASNORD-SELR-INV-NBR: '                   74490000
745000                      PW-ASNORD-SELR-INV-NBR                      74500000
745100             DISPLAY '******************************************' 74510000
745200             PERFORM Z800-SQL-WARNING                             74520000
745300                                                                  74530000
745400       WHEN  SQLCODE < ZERO AND SQLCODE NOT = PC-NEG-803          74540000
745500             DISPLAY '******************************************' 74550000
745600             DISPLAY 'ERROR ISSUED ON INSERT OF TASOANM         ' 74560000
745700             DISPLAY 'PC-OPERCO-NBR:         '                    74570000
745800                      PC-OPERCO-NBR                               74580000
745900             DISPLAY 'PW-HOLD-EDI-VEND-ID:   '                    74590000
746000                      PW-HOLD-EDI-VEND-ID                         74600000
746100             DISPLAY 'PW-ASNHDR-NBR:         '                    74610000
746200                      PW-ASNHDR-NBR                               74620000
746300             DISPLAY 'PW-ASNORD-PO-NBR:      '                    74630000
746400                      PW-ASNORD-PO-NBR                            74640000
746500             DISPLAY 'PW-ASNORD-SEQ-NBR:     '                    74650000
746600                      PW-ASNORD-SEQ-NBR                           74660000
746700             DISPLAY 'PW-HOLD-NAME-CDE:      '                    74670000
746800                      PW-HOLD-NAME-CDE                            74680000
746900             DISPLAY 'ASOANM-ASOANM-NBR:     '                    74690000
747000                      ASOANM-ASOANM-NBR                           74700000
747100             DISPLAY 'PW-ASNORD-SELR-INV-NBR: '                   74710000
747200                      PW-ASNORD-SELR-INV-NBR                      74720000
747300             DISPLAY '******************************************' 74730000
747400             PERFORM Z900-SQL-ERROR                               74740000
747500                                                                  74750000
747600     END-EVALUATE.                                                74760000
747700/                                                                 74770000
747800***************************************************************** 74780000
747900*     SQL INSERT ASOADT                                         * 74790000
748000*                                                               * 74800000
748100***************************************************************** 74810000
748200 Z190-SQL-INSERT-ASOADT.                                          74820000
748300     MOVE 'Z190-SQL-INSERT-ASOADT             '                   74830000
748400                                 TO PW-CURRENT-PARA.              74840000
748500*    DISPLAY 'Z190-SQL-INSERT-ASOADT'.                            74850000
748600                                                                  74860000
748700     MOVE PW-SUB                 TO ASOADT-ASOADT-NBR.            74870000
748800     MOVE PW-ADDR-TXT (PW-SUB)   TO ASOADT-ASOADT-TXT.            74880000
748900                                                                  74890000
749000     PERFORM                                                      74900000
749100       WITH TEST AFTER                                            74910000
749200       VARYING PW-RETRY-COUNTER FROM 1 BY 1                       74920000
749300       UNTIL   PW-RETRY-COUNTER > PC-MAX-RETRIES  OR              74930000
749400               SQLCODE = ZERO                                     74940000
749500            OR SQLCODE = PC-NEG-803                               74950000
749600                                                                  74960000
749700         EXEC SQL                                                 74970000
749800         INSERT INTO TASOADT                                      74980000
749900                                                                  74990000
750000         (PO_NBR,                                                 75000000
750100          SEQ_NBR,                                                75010000
750200          SELR_INV_NBR,                                           75020000
750300          NAME_CDE,                                               75030000
750400          ASOADT_NBR,                                             75040000
750500          ASOADT_TXT,                                             75050000
750600          ASNHDR_ID)                                              75060000
750700         VALUES                                                   75070000
750800        (:PW-ASNORD-PO-NBR,                                       75080000
750900         :PW-ASNORD-SEQ-NBR,                                      75090000
751000         :PW-ASNORD-SELR-INV-NBR,                                 75100000
751100         :PW-HOLD-NAME-CDE,                                       75110000
751200         :ASOADT-ASOADT-NBR,                                      75120000
751300         :ASOADT-ASOADT-TXT,                                      75130000
751400         :PV-ASNHDR-ID)                                           75140000
751500         END-EXEC                                                 75150000
751600                                                                  75160000
751700         EVALUATE TRUE                                            75170000
751800           WHEN SQLCODE = ZERO                                    75180000
751900           WHEN SQLCODE = PC-NEG-904                              75190000
752000           WHEN SQLCODE = PC-NEG-913                              75200000
752100           WHEN SQLCODE = PC-NEG-803                              75210000
752200                 CONTINUE                                         75220000
752300                                                                  75230000
752400           WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                75240000
752500                 DISPLAY '**************************************' 75250000
752600                 DISPLAY 'WARNING ISSUED ON INSERT OF TASOADT   ' 75260000
752700                 DISPLAY 'PC-OPERCO-NBR:         '                75270000
752800                          PC-OPERCO-NBR                           75280000
752900                 DISPLAY 'PW-HOLD-EDI-VEND-ID:   '                75290000
753000                          PW-HOLD-EDI-VEND-ID                     75300000
753100                 DISPLAY 'PW-ASNHDR-NBR:         '                75310000
753200                          PW-ASNHDR-NBR                           75320000
753300                 DISPLAY 'PW-ASNORD-PO-NBR:      '                75330000
753400                          PW-ASNORD-PO-NBR                        75340000
753500                 DISPLAY 'PW-ASNORD-SEQ-NBR:      '               75350000
753600                          PW-ASNORD-SEQ-NBR                       75360000
753700                 DISPLAY 'PW-HOLD-NAME-CDE:      '                75370000
753800                          PW-HOLD-NAME-CDE                        75380000
753900                 DISPLAY 'ASOADT-ASOADT-NBR:     '                75390000
754000                          ASOADT-ASOADT-NBR                       75400000
754100                 DISPLAY 'PW-ASNORD-SELR-INV-NBR: '               75410000
754200                          PW-ASNORD-SELR-INV-NBR                  75420000
754300                 DISPLAY '**********************************'     75430000
754400                 PERFORM Z800-SQL-WARNING                         75440000
754500                                                                  75450000
754600           WHEN  SQLCODE < ZERO                                   75460000
754700                 DISPLAY '**************************************' 75470000
754800                 DISPLAY 'ERROR ISSUED ON INSERT OF TASOADT     ' 75480000
754900                 DISPLAY 'PC-OPERCO-NBR:         '                75490000
755000                          PC-OPERCO-NBR                           75500000
755100                 DISPLAY 'PW-HOLD-EDI-VEND-ID:   '                75510000
755200                          PW-HOLD-EDI-VEND-ID                     75520000
755300                 DISPLAY 'PW-ASNHDR-NBR:         '                75530000
755400                          PW-ASNHDR-NBR                           75540000
755500                 DISPLAY 'PW-ASNORD-PO-NBR:      '                75550000
755600                          PW-ASNORD-PO-NBR                        75560000
755700                 DISPLAY 'PW-ASNORD-SEQ-NBR:      '               75570000
755800                          PW-ASNORD-SEQ-NBR                       75580000
755900                 DISPLAY 'PW-HOLD-NAME-CDE:      '                75590000
756000                          PW-HOLD-NAME-CDE                        75600000
756100                 DISPLAY 'ASOADT-ASOADT-NBR:     '                75610000
756200                          ASOADT-ASOADT-NBR                       75620000
756300                 DISPLAY 'PW-ASNORD-SELR-INV-NBR: '               75630000
756400                          PW-ASNORD-SELR-INV-NBR                  75640000
756500                 DISPLAY '**************************************' 75650000
756600                 PERFORM Z900-SQL-ERROR                           75660000
756700                                                                  75670000
756800         END-EVALUATE                                             75680000
756900                                                                  75690000
757000     END-PERFORM.                                                 75700000
757100                                                                  75710000
757200     EVALUATE TRUE                                                75720000
757300       WHEN SQLCODE = ZERO                                        75730000
757400       WHEN SQLCODE = PC-NEG-803                                  75740000
757500         CONTINUE                                                 75750000
757600       WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                    75760000
757700             DISPLAY '******************************************' 75770000
757800             DISPLAY 'WARNING ISSUED ON INSERT OF TASOADT       ' 75780000
757900             DISPLAY 'PC-OPERCO-NBR:         '                    75790000
758000                      PC-OPERCO-NBR                               75800000
758100             DISPLAY 'PW-HOLD-EDI-VEND-ID:   '                    75810000
758200                      PW-HOLD-EDI-VEND-ID                         75820000
758300             DISPLAY 'PW-ASNHDR-NBR:         '                    75830000
758400                      PW-ASNHDR-NBR                               75840000
758500             DISPLAY 'PW-ASNORD-PO-NBR:      '                    75850000
758600                      PW-ASNORD-PO-NBR                            75860000
758700             DISPLAY 'PW-ASNORD-SEQ-NBR:      '                   75870000
758800                      PW-ASNORD-SEQ-NBR                           75880000
758900             DISPLAY 'PW-HOLD-NAME-CDE:      '                    75890000
759000                      PW-HOLD-NAME-CDE                            75900000
759100             DISPLAY 'ASOADT-ASOADT-NBR:     '                    75910000
759200                      ASOADT-ASOADT-NBR                           75920000
759300             DISPLAY 'PW-ASNORD-SELR-INV-NBR: '                   75930000
759400                      PW-ASNORD-SELR-INV-NBR                      75940000
759500             DISPLAY '******************************************' 75950000
759600             PERFORM Z800-SQL-WARNING                             75960000
759700                                                                  75970000
759800       WHEN  SQLCODE < ZERO AND SQLCODE NOT = PC-NEG-803          75980000
759900             DISPLAY '******************************************' 75990000
760000             DISPLAY 'ERROR ISSUED ON INSERT OF TASOADT         ' 76000000
760100             DISPLAY 'PC-OPERCO-NBR:         '                    76010000
760200                      PC-OPERCO-NBR                               76020000
760300             DISPLAY 'PW-HOLD-EDI-VEND-ID:   '                    76030000
760400                      PW-HOLD-EDI-VEND-ID                         76040000
760500             DISPLAY 'PW-ASNHDR-NBR:         '                    76050000
760600                      PW-ASNHDR-NBR                               76060000
760700             DISPLAY 'PW-ASNORD-PO-NBR:      '                    76070000
760800                      PW-ASNORD-PO-NBR                            76080000
760900             DISPLAY 'PW-ASNORD-SEQ-NBR:      '                   76090000
761000                      PW-ASNORD-SEQ-NBR                           76100000
761100             DISPLAY 'PW-HOLD-NAME-CDE:      '                    76110000
761200                      PW-HOLD-NAME-CDE                            76120000
761300             DISPLAY 'ASOADT-ASOADT-NBR:     '                    76130000
761400                      ASOADT-ASOADT-NBR                           76140000
761500             DISPLAY 'PW-ASNORD-SELR-INV-NBR: '                   76150000
761600                      PW-ASNORD-SELR-INV-NBR                      76160000
761700             DISPLAY '******************************************' 76170000
761800             PERFORM Z900-SQL-ERROR                               76180000
761900                                                                  76190000
762000     END-EVALUATE.                                                76200000
762100/                                                                 76210000
762200***************************************************************** 76220000
762300*     SQL INSERT ASNCAR                                         * 76230000
762400*                                                               * 76240000
762500***************************************************************** 76250000
762600 Z200-SQL-INSERT-ASNCAR.                                          76260000
762700     MOVE 'Z200-SQL-INSERT-ASNCAR             '                   76270000
762800                                 TO PW-CURRENT-PARA.              76280000
762900*    DISPLAY 'Z200-SQL-INSERT-ASNCAR'.                            76290000
763000                                                                  76300000
763100     IF PW-ASNCAR-ASNCAR-NBR = SPACES                             76310000
763200         MOVE PW-ASNHDR-NBR       TO PSRL-ASNHDR-NBR              76320000
763300         MOVE PW-HOLD-VEND-DUNNS-NBR                              76330000
763400                                  TO PSRL-DUNNS-NBR               76340000
763500         MOVE PW-HOLD-VENDOR-NAME TO PSRL-VENDOR-NAME             76350000
763600         MOVE PW-HOLD-ISA-CNTL-NBR                                76360000
763700                                  TO PSRL-ISA-NBR                 76370000
763800         MOVE PSRL-REPORT-LINE-1  TO PW-ADV-SHIP-NOTICE-LINE      76380000
763900         PERFORM Z510-WRITE-REPORT-LINE                           76390000
764000         MOVE MSG-08              TO PSRL-RPT-LINE-2              76400000
764100         MOVE PSRL-REPORT-LINE-2  TO PW-ADV-SHIP-NOTICE-LINE      76410000
764200         PERFORM Z500-WRITE-REPORT-LINE                           76420000
764300     ELSE                                                         76430000
764400         ADD 1                   TO PW-ASNHDR-CART-SHIP-QTY       76440000
764500                                                                  76450000
764600         PERFORM                                                  76460000
764700           WITH TEST AFTER                                        76470000
764800           VARYING PW-RETRY-COUNTER FROM 1 BY 1                   76480000
764900           UNTIL   PW-RETRY-COUNTER > PC-MAX-RETRIES  OR          76490000
765000                   (SQLCODE = ZERO) OR (SQLCODE = PC-NEG-803)     76500000
765100                                                                  76510000
765200             EXEC SQL                                             76520000
765300             INSERT INTO TASNCAR                                  76530000
765400                                                                  76540000
765500             (ASNCAR_NBR,                                         76550000
765600              PO_NBR,                                             76560000
765700              SEQ_NBR,                                            76570000
765800              SELR_INV_NBR,                                       76580000
765900              VOL_MSMT,                                           76590000
766000              WGHT_MSMT,                                          76600000
766100              NBR_QUAL_CDE,                                       76610000
766200              PKG_QTY,                                            76620000
766300              PKG_QTY_UM_CDE,                                     76630000
766400              WGHT_UM_CDE,                                        76640000
766500              VOL_UM_CDE,                                         76650000
766600              PKG_CDE,                                            76660000
766700              LEN_MSMT,                                           76670000
766800              HT_MSMT,                                            76680000
766900              WDTH_MSMT,                                          76690000
767000              SIZE_UM_CDE,                                        76700000
767100              PKG_SIZE_QTY,                                       76710000
767200              ASNHDR_ID,                                          76720000
767300              INPK_EA_QTY,                                        76730000
767400              LOC_NBR)                                            76740000
767500             VALUES                                               76750000
767600            (:PW-ASNCAR-ASNCAR-NBR,                               76760000
767700             :PW-ASNORD-PO-NBR,                                   76770000
767800             :PW-ASNORD-SEQ-NBR,                                  76780000
767900             :PW-ASNORD-SELR-INV-NBR,                             76790000
768000             :PW-ASNCAR-VOL-MSMT:PV-VOL-MSMT-NULL,                76800000
768100             :PW-ASNCAR-WGHT-MSMT:PV-WGHT-MSMT-NULL,              76810000
768200             :PW-ASNCAR-NBR-QUAL-CDE:PV-NBR-QUAL-CDE-NULL,        76820000
768300             :PW-ASNCAR-PKG-QTY:PV-ASNCAR-PKG-QTY-NULL,           76830000
768400             :PW-ASNCAR-PKG-QTY-UM-CDE:PV-PKG-QTY-UM-CDE-NULL,    76840000
768500             :PW-ASNCAR-WGHT-UM-CDE:PV-WGHT-UM-CDE-NULL,          76850000
768600             :PW-ASNCAR-VOL-UM-CDE:PV-VOL-UM-CDE-NULL,            76860000
768700             :PW-ASNCAR-PKG-CDE:PV-PKG-CDE-NULL,                  76870000
768800             :PW-ASNCAR-LEN-MSMT:PV-LEN-MSMT-NULL,                76880000
768900             :PW-ASNCAR-HT-MSMT:PV-HT-MSMT-NULL,                  76890000
769000             :PW-ASNCAR-WDTH-MSMT:PV-WDTH-MSMT-NULL,              76900000
769100             :PW-ASNCAR-SIZE-UM-CDE:PV-SIZE-UM-CDE-NULL,          76910000
769200             :PW-ASNCAR-PKG-SIZE-QTY:PV-PKG-SIZE-QTY-NULL,        76920000
769300             :PV-ASNHDR-ID,                                       76930000
769400             :PW-ASNCAR-HOLD-INPK-EA-QTY,                         76940000
769500             :PW-ASNORD-LOC-NBR)                                  76950000
769600             END-EXEC                                             76960000
769700                                                                  76970000
769800             EVALUATE TRUE                                        76980000
769900               WHEN SQLCODE = ZERO                                76990000
770000*                                                                 77000000
770100* DMH 03/07/16 BEGIN (ADDED FOR OUTLET CARRIER TRACKING)          77010000
770200              IF  PW-ASNCAR-NBR-QUAL-CDE-CARR  =  'CP'  AND       77020000
770300                  PW-ASNCAR-NBR-CARR-TRACKING  >   SPACES         77030000
770400                  PERFORM Z205-WRITE-CARRIER-TRACK                77040000
770500              END-IF                                              77050000
770600* DMH 03/07/16 END   (ADDED FOR OUTLET CARRIER TRACKING)          77060000
770700                                                                  77070000
770800                     CONTINUE                                     77080000
770900                                                                  77090000
771000               WHEN SQLCODE = PC-NEG-904                          77100000
771100               WHEN SQLCODE = PC-NEG-913                          77110000
771200                     CONTINUE                                     77120000
771300                                                                  77130000
771400               WHEN SQLCODE = PC-NEG-803                          77140000
771500*RSC               IF PS-FIRST-ERROR                              77150000
771600*                      SET PS-NOT-FIRST-ERROR TO TRUE             77160000
771700*                      PERFORM W100-PROCESS-HEADING-LINES         77170000
771800*RSC               END-IF                                         77180000
771900                   COMPUTE PA-ASNHDR-INSERTED =                   77190000
772000                          (PA-ASNHDR-INSERTED - 1)                77200000
772100                   MOVE PW-ASNHDR-NBR TO PSRL-ASNHDR-NBR          77210000
772200                   MOVE PW-HOLD-VEND-DUNNS-NBR TO PSRL-DUNNS-NBR  77220000
772300                   MOVE PW-HOLD-VENDOR-NAME TO PSRL-VENDOR-NAME   77230000
772400                   MOVE PW-HOLD-ISA-CNTL-NBR                      77240000
772500                                            TO PSRL-ISA-NBR       77250000
772600*RSC               MOVE PSRL-REPORT-LINE-1 TO ASN-REPORT          77260000
772700*RSC               PERFORM W000-WRITE-REPORT-LINE                 77270000
772800                   MOVE PSRL-REPORT-LINE-1 TO                     77280000
772900                                          PW-ADV-SHIP-NOTICE-LINE 77290000
773000                   PERFORM Z510-WRITE-REPORT-LINE                 77300000
773100                   MOVE PW-ASNCAR-ASNCAR-NBR TO PR-CARTON-NBR     77310000
773200                   MOVE PR-DUP-CARTON-MSG TO PSRL-RPT-LINE-2      77320000
773300*RSC               MOVE PSRL-REPORT-LINE-2 TO ASN-REPORT          77330000
773400*RSC               PERFORM W000-WRITE-REPORT-LINE                 77340000
773500                   MOVE PSRL-REPORT-LINE-2 TO                     77350000
773600                                          PW-ADV-SHIP-NOTICE-LINE 77360000
773700                   PERFORM Z500-WRITE-REPORT-LINE                 77370000
773800                   SET PS-BAD-ASN TO TRUE                         77380000
773900                                                                  77390000
774000                   EXEC SQL                                       77400000
774100                        ROLLBACK                                  77410000
774200                   END-EXEC                                       77420000
774300                   DISPLAY '*********************'                77430000
774400                   DISPLAY '*  R O L L B A C K  *'                77440000
774500                   DISPLAY '*********************'                77450000
774600               WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')            77460000
774700                 DISPLAY '**************************************' 77470000
774800                 DISPLAY 'WARNING ISSUED ON INSERT OF TASNCAR   ' 77480000
774900                 DISPLAY 'PC-OPERCO-NBR:         '                77490000
775000                          PC-OPERCO-NBR                           77500000
775100                 DISPLAY 'PW-HOLD-EDI-VEND-ID:   '                77510000
775200                          PW-HOLD-EDI-VEND-ID                     77520000
775300                 DISPLAY 'PW-ASNHDR-NBR:         '                77530000
775400                          PW-ASNHDR-NBR                           77540000
775500                 DISPLAY 'PW-ASNCAR-ASNCAR-NBR:  '                77550000
775600                          PW-ASNCAR-ASNCAR-NBR                    77560000
775700                 DISPLAY '**********************************'     77570000
775800                 PERFORM Z800-SQL-WARNING                         77580000
775900                                                                  77590000
776000               WHEN  SQLCODE < ZERO                               77600000
776100                 DISPLAY '**************************************' 77610000
776200                 DISPLAY 'ERROR ISSUED ON INSERT OF TASNCAR     ' 77620000
776300                 DISPLAY 'PC-OPERCO-NBR:         '                77630000
776400                          PC-OPERCO-NBR                           77640000
776500                 DISPLAY 'PW-HOLD-EDI-VEND-ID:   '                77650000
776600                          PW-HOLD-EDI-VEND-ID                     77660000
776700                 DISPLAY 'PW-ASNHDR-NBR:         '                77670000
776800                          PW-ASNHDR-NBR                           77680000
776900                 DISPLAY 'PW-ASNCAR-ASNCAR-NBR:  '                77690000
777000                          PW-ASNCAR-ASNCAR-NBR                    77700000
777100                 DISPLAY '**************************************' 77710000
777200                 PERFORM Z900-SQL-ERROR                           77720000
777300                                                                  77730000
777400             END-EVALUATE                                         77740000
777500                                                                  77750000
777600         END-PERFORM                                              77760000
777700                                                                  77770000
777800     END-IF.                                                      77780000
777900                                                                  77790000
778000     EVALUATE TRUE                                                77800000
778100       WHEN SQLCODE = ZERO OR PW-ASNCAR-ASNCAR-NBR = SPACES       77810000
778200         CONTINUE                                                 77820000
778300       WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                    77830000
778400             DISPLAY '******************************************' 77840000
778500             DISPLAY 'WARNING ISSUED ON INSERT OF TASNCAR       ' 77850000
778600             DISPLAY 'PC-OPERCO-NBR:         '                    77860000
778700                      PC-OPERCO-NBR                               77870000
778800             DISPLAY 'PW-HOLD-EDI-VEND-ID:   '                    77880000
778900                      PW-HOLD-EDI-VEND-ID                         77890000
779000             DISPLAY 'PW-ASNHDR-NBR:         '                    77900000
779100                      PW-ASNHDR-NBR                               77910000
779200             DISPLAY 'PW-ASNCAR-ASNCAR-NBR:  '                    77920000
779300                      PW-ASNCAR-ASNCAR-NBR                        77930000
779400             DISPLAY '******************************************' 77940000
779500             PERFORM Z800-SQL-WARNING                             77950000
779600                                                                  77960000
779700       WHEN  SQLCODE < ZERO                                       77970000
779800             DISPLAY '******************************************' 77980000
779900             DISPLAY 'ERROR ISSUED ON INSERT OF TASNCAR         ' 77990000
780000             DISPLAY 'PC-OPERCO-NBR:         '                    78000000
780100                      PC-OPERCO-NBR                               78010000
780200             DISPLAY 'PW-HOLD-EDI-VEND-ID:   '                    78020000
780300                      PW-HOLD-EDI-VEND-ID                         78030000
780400             DISPLAY 'PW-ASNHDR-NBR:         '                    78040000
780500                      PW-ASNHDR-NBR                               78050000
780600             DISPLAY 'PW-ASNCAR-ASNCAR-NBR:  '                    78060000
780700                      PW-ASNCAR-ASNCAR-NBR                        78070000
780800             DISPLAY '******************************************' 78080000
780900             PERFORM Z900-SQL-ERROR                               78090000
781000                                                                  78100000
781100     END-EVALUATE.                                                78110000
781200/                                                                 78120000
781300***************************************************************** 78130000
781310*     WRITE CARRIER TRACKING RECORD                             * 78131000
781320* DMH 03/07/16   (ADDED FOR OUTLET CARRIER TRACKING)            * 78132000
781330***************************************************************** 78133000
781340 Z205-WRITE-CARRIER-TRACK.                                        78134000
781350                                                                  78135000
781360     MOVE PW-ASNCAR-ASNCAR-NBR        TO RC093-ASNCAR-NBR.        78136000
781370     MOVE PW-ASNCAR-NBR-CARR-TRACKING TO RC093-CARR-TRACKING-NBR. 78137000
781380     MOVE PV-PROCESS-TMST             TO RC093-PROCESS-TMST.      78138000
781390                                                                  78139000
781391     WRITE ASN-CARR-TRACK-REC                                     78139100
781392      FROM RC093-CARR-SSCC-TRACK-REC.                             78139200
781393                                                                  78139300
781394     ADD  1  TO  PV-ASN-CARR-TRACK-COUNT.                         78139405
781395     ADD  1  TO  PV-UPC-TRACK-COUNT.                              78139505
781396                                                                  78139605
781397                                                                  78139705
781398***************************************************************** 78139805
781399*     CHECK ASNDTL                                                78139905
781400***************************************************************** 78140005
781410 Z209-CHECK-ASNDTL.                                               78141005
781500     IF WS-CAR-DTL-CAR(WS-DTL-COUNT) = PW-ASNCAR-ASNCAR-NBR AND   78150000
781600        WS-CAR-DTL-HDR-ID(WS-DTL-COUNT) = PV-ASNHDR-ID            78160000
781700        PERFORM                                                   78170000
781800           VARYING WS-DTL-SUB FROM 1 BY 1                         78180000
781900           UNTIL WS-DTL-SUB > WS-DTL-COUNT                        78190000
782000           IF PW-ASNDTL-UPC-NBR = WS-CAR-DTL-UPC(WS-DTL-SUB)      78200000
782100              SET DUPLICATE-DETAIL TO TRUE                        78210000
782200              COMPUTE PW-ASNDTL-SHIPT-QTY =                       78220000
782300                 PW-ASNDTL-SHIPT-QTY + WS-CAR-DTL-QTY(WS-DTL-SUB) 78230000
782400              END-COMPUTE                                         78240000
782500              MOVE WS-CAR-DTL-HDR-ID(WS-DTL-SUB) TO               78250000
782600                 ASNDTL-ASNHDR-ID                                 78260000
782700              MOVE WS-CAR-DTL-DTL(WS-DTL-SUB) TO                  78270000
782800                 ASNDTL-ASNDTL-NBR                                78280000
782900              COMPUTE PW-HOLD-ASNDTL-NBR =                        78290000
783000                 PW-HOLD-ASNDTL-NBR - 1                           78300000
783100              END-COMPUTE                                         78310000
783200              PERFORM Z211-SQL-UPDATE-ASNDTL                      78320000
783300              MOVE PW-ASNDTL-SHIPT-QTY  TO                        78330000
783400                 WS-CAR-DTL-QTY(WS-DTL-COUNT)                     78340000
783500           END-IF                                                 78350000
783600        END-PERFORM                                               78360000
783700        IF DUPLICATE-DETAIL                                       78370000
783800           CONTINUE                                               78380000
783900        ELSE                                                      78390000
784000           ADD 1 TO WS-DTL-COUNT                                  78400000
784100        END-IF                                                    78410000
784200     ELSE                                                         78420000
784300        INITIALIZE WS-CARTON-DETAIL-TABLE                         78430000
784400        MOVE 1 TO WS-DTL-COUNT                                    78440000
784500     END-IF.                                                      78450000
784600     IF DUPLICATE-DETAIL                                          78460000
784700        DISPLAY '******************'                              78470000
784800        DISPLAY 'DUPLICATE DETAIL: '                              78480000
784900        DISPLAY PW-ASNCAR-ASNCAR-NBR ' ' PW-ASNDTL-UPC-NBR        78490000
785000        DISPLAY '******************'                              78500000
785100     ELSE                                                         78510000
785200        MOVE PV-ASNHDR-ID  TO WS-CAR-DTL-HDR-ID(WS-DTL-COUNT)     78520000
785300        MOVE PW-HOLD-ASNDTL-NBR   TO WS-CAR-DTL-DTL(WS-DTL-COUNT) 78530000
785400        MOVE PW-ASNCAR-ASNCAR-NBR TO WS-CAR-DTL-CAR(WS-DTL-COUNT) 78540000
785500        MOVE PW-ASNDTL-UPC-NBR    TO WS-CAR-DTL-UPC(WS-DTL-COUNT) 78550000
785600*       DISPLAY PW-ASNCAR-ASNCAR-NBR ' 'PW-ASNDTL-UPC-NBR         78560000
785700        MOVE PW-ASNDTL-SHIPT-QTY  TO WS-CAR-DTL-QTY(WS-DTL-COUNT) 78570000
785800     END-IF.                                                      78580000
785900/                                                                 78590000
786000***************************************************************** 78600000
786100*     SQL INSERT ASNDTL                                         * 78610000
786200*                                                               * 78620000
786300***************************************************************** 78630000
786400 Z210-SQL-INSERT-ASNDTL.                                          78640000
786500     MOVE 'Z210-SQL-INSERT-ASNDTL             '                   78650000
786600                                 TO PW-CURRENT-PARA.              78660000
786700*    DISPLAY 'Z210-SQL-INSERT-ASNDTL'.                            78670000
786800                                                                  78680000
786900     MOVE WS-PUBLISH-TABLE TO WS-TABLE-PUB.                       78690000
787000     MOVE PW-ASNORD-PO-NBR TO  WS-ASNORD-PO-NBR.                  78700000
787100     MOVE PW-ASNDTL-UPC-NBR TO WS-ASNDTL-UPC-NBR.                 78710000
787200     IF PW-ASNDTL-ITM-SUBST-UPC-NBR = 'SIMPLE--PACK'              78720000
787300        CALL PC-SNKUP023 USING WS-TRANSFER                        78730000
787400        MOVE WS-TABLE-PUB TO WS-PUBLISH-TABLE                     78740000
787500     END-IF.                                                      78750000
787600     PERFORM K912-FIND-PO                                         78760000
787700     IF PO-FOUND                                                  78770000
787800        CONTINUE                                                  78780000
787900     ELSE                                                         78790000
788000        PERFORM K913-FIND-LAST-PO                                 78800000
788100        MOVE PW-PO-NBR-N TO                                       78810000
788200           WS-PUB-PO-2(WS-CURR-ELEMENT)                           78820000
788300        MOVE PW-PO-NBR-N TO WS-PUBLISH-PO                         78830000
788400        MOVE 0 TO WS-PUBLISH-SKU                                  78840000
788500        MOVE 'ASN PO RECEIPT      ' TO                            78850000
788600           WS-PUBLISH-LABEL                                       78860000
788700        IF CC-PARM-PROD                                           78870000
788800           PERFORM Z104-INSERT-WFT-LOD-XFER                       78880000
788900           PERFORM Z103-INSERT-WFT-LOD-CNTL                       78890000
789000        END-IF                                                    78900000
789100        IF CC-PARM-TEST                                           78910000
789200           DISPLAY '* TEST * '                                    78920000
789300              WS-PUBLISH-MESSAGE                                  78930000
789400        END-IF                                                    78940000
789500     END-IF                                                       78950000
789600     PERFORM                                                      78960000
789700       WITH TEST AFTER                                            78970000
789800       VARYING PW-RETRY-COUNTER FROM 1 BY 1                       78980000
789900       UNTIL   PW-RETRY-COUNTER > PC-MAX-RETRIES  OR              78990000
790000               SQLCODE = ZERO                                     79000000
790100                                                                  79010000
790200         EXEC SQL                                                 79020000
790300         INSERT INTO TASNDTL                                      79030000
790400                                                                  79040000
790500         (ASNDTL_NBR,                                             79050000
790600          PO_NBR,                                                 79060000
790700          SEQ_NBR,                                                79070000
790800          SELR_INV_NBR,                                           79080000
790900          UPC_NBR,                                                79090000
791000          ALT_PROD1_CDE,                                          79100000
791100          ALT_PROD1_ID,                                           79110000
791200          ALT_PROD2_CDE,                                          79120000
791300          ALT_PROD2_ID,                                           79130000
791400          SHIPT_QTY,                                              79140000
791500          SHIPT_DTE_QTY,                                          79150000
791600          SHIPT_UM_CDE,                                           79160000
791700          ITM_STATUS_CDE,                                         79170000
791800          ITM_ERR_CDE,                                            79180000
791900          ITM_ERR_QTY,                                            79190000
792000          ITM_ERR_QTY_UM_CDE,                                     79200000
792100          PKG_QTY,                                                79210000
792200          PKG_QTY_UM_CDE,                                         79220000
792300          VEND_ORD_QTY,                                           79230000
792400          ORD_QTY_UM_CDE,                                         79240000
792500          WGT_MSMT,                                               79250000
792600          VOL_MSMT,                                               79260000
792700          VOL_UM_CDE,                                             79270000
792800          LEN_MSMT,                                               79280000
792900          HT_MSMT,                                                79290000
793000          WDTH_MSMT,                                              79300000
793100          SIZE_UM_CDE,                                            79310000
793200          ITM_SUBST_UPC_NBR,                                      79320000
793300          TKT_ERR_CDE,                                            79330000
793400          ASNHDR_ID,                                              79340000
793500          INPK_EA_QTY,                                            79350000
793600          LOC_NBR)                                                79360000
793700         VALUES                                                   79370000
793800        (:PW-HOLD-ASNDTL-NBR,                                     79380000
793900         :PW-ASNORD-PO-NBR,                                       79390000
794000         :PW-ASNORD-SEQ-NBR,                                      79400000
794100         :PW-ASNORD-SELR-INV-NBR,                                 79410000
794200         :PW-ASNDTL-UPC-NBR,                                      79420000
794300         :PW-ASNDTL-ALT-PROD1-CDE:PV-ALT-PROD1-CDE-NULL,          79430000
794400         :PW-ASNDTL-ALT-PROD1-ID:PV-ALT-PROD1-ID-NULL,            79440000
794500         :PW-ASNDTL-ALT-PROD2-CDE:PV-ALT-PROD2-CDE-NULL,          79450000
794600         :PW-ASNDTL-ALT-PROD2-ID:PV-ALT-PROD2-ID-NULL,            79460000
794700         :PW-ASNDTL-SHIPT-QTY,                                    79470000
794800         :PW-ASNDTL-SHIPT-DTE-QTY:PV-SHIPT-DTE-QTY-NULL,          79480000
794900         :PW-ASNDTL-SHIPT-UM-CDE,                                 79490000
795000         :PW-ASNDTL-ITM-STATUS-CDE:PV-ITM-STATUS-CDE-NULL,        79500000
795100         :PW-ASNDTL-ITM-ERR-CDE:PV-ITM-ERR-CDE-NULL,              79510000
795200         :PW-ASNDTL-ITM-ERR-QTY:PV-ITM-ERR-QTY-NULL,              79520000
795300         :PW-ASNDTL-ITM-ERR-QTY-UM-CDE:PV-ITM-ERR-QTY-UM-CDE-NULL,79530000
795400         :PW-ASNDTL-PKG-QTY:PV-ASNDTL-PKG-QTY-NULL,               79540000
795500         :PW-ASNDTL-PKG-QTY-UM-CDE:PV-PKG-QTY-UM-CDE-NULL,        79550000
795600         :PW-ASNDTL-VEND-ORD-QTY:PV-VEND-ORD-QTY-NULL,            79560000
795700         :PW-ASNDTL-ORD-QTY-UM-CDE:PV-ORD-QTY-UM-CDE-NULL,        79570000
795800         :PW-ASNDTL-WGT-MSMT:PV-WGT-MSMT-NULL,                    79580000
795900         :PW-ASNDTL-VOL-MSMT:PV-VOL-MSMT-NULL,                    79590000
796000         :PW-ASNDTL-VOL-UM-CDE:PV-VOL-UM-CDE-NULL,                79600000
796100         :PW-ASNDTL-LEN-MSMT:PV-LEN-MSMT-NULL,                    79610000
796200         :PW-ASNDTL-HT-MSMT:PV-HT-MSMT-NULL,                      79620000
796300         :PW-ASNDTL-WDTH-MSMT:PV-WDTH-MSMT-NULL,                  79630000
796400         :PW-ASNDTL-SIZE-UM-CDE:PV-SIZE-UM-CDE-NULL,              79640000
796500         :PW-ASNDTL-ITM-SUBST-UPC-NBR:PV-ITM-SUBST-UPC-NBR-NULL,  79650000
796600         :PW-ASNDTL-TKT-ERR-CDE,                                  79660000
796700         :PV-ASNHDR-ID,                                           79670000
796800         :PW-ASNDTL-HOLD-INPK-EA-QTY,                             79680000
796900         :PW-ASNORD-LOC-NBR)                                      79690000
797000         END-EXEC                                                 79700000
797100                                                                  79710000
797200         EVALUATE TRUE                                            79720000
797300           WHEN SQLCODE = ZERO                                    79730000
797400           WHEN SQLCODE = PC-NEG-904                              79740000
797500           WHEN SQLCODE = PC-NEG-913                              79750000
797600                 CONTINUE                                         79760000
797700                                                                  79770000
797800           WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                79780000
797900                 DISPLAY '**************************************' 79790000
798000                 DISPLAY 'WARNING ISSUED ON INSERT OF TASNDTL   ' 79800000
798100                 DISPLAY 'PC-OPERCO-NBR:         '                79810000
798200                          PC-OPERCO-NBR                           79820000
798300                 DISPLAY 'PW-HOLD-EDI-VEND-ID:   '                79830000
798400                          PW-HOLD-EDI-VEND-ID                     79840000
798500                 DISPLAY 'PW-ASNHDR-NBR:         '                79850000
798600                          PW-ASNHDR-NBR                           79860000
798700                 DISPLAY 'PW-HOLD-ASNDTL-NBR:  '                  79870000
798800                          PW-HOLD-ASNDTL-NBR                      79880000
798900                 DISPLAY '**********************************'     79890000
799000                 PERFORM Z800-SQL-WARNING                         79900000
799100                                                                  79910000
799200           WHEN  SQLCODE < ZERO                                   79920000
799300                 DISPLAY '**************************************' 79930000
799400                 DISPLAY 'ERROR ISSUED ON INSERT OF TASNDTL     ' 79940000
799500                 DISPLAY 'PC-OPERCO-NBR:         '                79950000
799600                          PC-OPERCO-NBR                           79960000
799700                 DISPLAY 'PW-HOLD-EDI-VEND-ID:   '                79970000
799800                          PW-HOLD-EDI-VEND-ID                     79980000
799900                 DISPLAY 'PW-ASNHDR-NBR:         '                79990000
800000                          PW-ASNHDR-NBR                           80000000
800100                 DISPLAY 'PW-HOLD-ASNDTL-NBR:  '                  80010000
800200                          PW-HOLD-ASNDTL-NBR                      80020000
800300                 DISPLAY '**************************************' 80030000
800400                 PERFORM Z900-SQL-ERROR                           80040000
800500                                                                  80050000
800600         END-EVALUATE                                             80060000
800700                                                                  80070000
800800     END-PERFORM.                                                 80080000
800900                                                                  80090000
801000     EVALUATE TRUE                                                80100000
801100       WHEN SQLCODE = ZERO                                        80110000
801200         CONTINUE                                                 80120000
801300       WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                    80130000
801400             DISPLAY '******************************************' 80140000
801500             DISPLAY 'WARNING ISSUED ON INSERT OF TASNDTL       ' 80150000
801600             DISPLAY 'PC-OPERCO-NBR:         '                    80160000
801700                      PC-OPERCO-NBR                               80170000
801800             DISPLAY 'PW-HOLD-EDI-VEND-ID:   '                    80180000
801900                      PW-HOLD-EDI-VEND-ID                         80190000
802000             DISPLAY 'PW-ASNHDR-NBR:         '                    80200000
802100                      PW-ASNHDR-NBR                               80210000
802200             DISPLAY 'PW-HOLD-ASNDTL-NBR:  '                      80220000
802300                      PW-HOLD-ASNDTL-NBR                          80230000
802400             DISPLAY '******************************************' 80240000
802500             PERFORM Z800-SQL-WARNING                             80250000
802600                                                                  80260000
802700       WHEN  SQLCODE < ZERO                                       80270000
802800             DISPLAY '******************************************' 80280000
802900             DISPLAY 'ERROR ISSUED ON INSERT OF TASNDTL         ' 80290000
803000             DISPLAY 'PC-OPERCO-NBR:         '                    80300000
803100                      PC-OPERCO-NBR                               80310000
803200             DISPLAY 'PW-HOLD-EDI-VEND-ID:   '                    80320000
803300                      PW-HOLD-EDI-VEND-ID                         80330000
803400             DISPLAY 'PW-ASNHDR-NBR:         '                    80340000
803500                      PW-ASNHDR-NBR                               80350000
803600             DISPLAY 'PW-HOLD-ASNDTL-NBR:  '                      80360000
803700                      PW-HOLD-ASNDTL-NBR                          80370000
803800             DISPLAY '******************************************' 80380000
803900             PERFORM Z900-SQL-ERROR                               80390000
804000                                                                  80400000
804100     END-EVALUATE.                                                80410000
804200/                                                                 80420000
804300***************************************************************** 80430000
804400*     SQL UPDATE ASNDTL                                         * 80440000
804500*                                                               * 80450000
804600***************************************************************** 80460000
804700 Z211-SQL-UPDATE-ASNDTL.                                          80470000
804800     MOVE 'Z211-SQL-UPDATE-ASNDTL             '                   80480000
804900                                 TO PW-CURRENT-PARA.              80490000
805000*    DISPLAY 'Z211-SQL-UPDATE-ASNDTL'.                            80500000
805100                                                                  80510000
805200     PERFORM                                                      80520000
805300       WITH TEST AFTER                                            80530000
805400       VARYING PW-RETRY-COUNTER FROM 1 BY 1                       80540000
805500       UNTIL   PW-RETRY-COUNTER > PC-MAX-RETRIES  OR              80550000
805600               SQLCODE = ZERO                                     80560000
805700                                                                  80570000
805800         EXEC SQL                                                 80580000
805900             UPDATE TASNDTL                                       80590000
806000             SET SHIPT_QTY = :PW-ASNDTL-SHIPT-QTY                 80600000
806100             WHERE ASNHDR_ID    =  :ASNDTL-ASNHDR-ID              80610000
806200               AND ASNDTL_NBR   =  :ASNDTL-ASNDTL-NBR             80620000
806300               AND PO_NBR       =  :PW-ASNORD-PO-NBR              80630000
806400               AND UPC_NBR      =  :PW-ASNDTL-UPC-NBR             80640000
806500         END-EXEC                                                 80650000
806600                                                                  80660000
806700         EVALUATE TRUE                                            80670000
806800           WHEN SQLCODE = ZERO                                    80680000
806900           WHEN SQLCODE = PC-NEG-904                              80690000
807000           WHEN SQLCODE = PC-NEG-913                              80700000
807100                 CONTINUE                                         80710000
807200                                                                  80720000
807300           WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                80730000
807400                 DISPLAY '**************************************' 80740000
807500                 DISPLAY 'WARNING ISSUED ON UPDATE OF TASNDTL   ' 80750000
807600                 DISPLAY 'ASNDTL-ASNDTL-NBR:       '              80760000
807700                          ASNDTL-ASNDTL-NBR                       80770000
807800                 DISPLAY 'PW-ASNDTL-UPC-NBR:       '              80780000
807900                          PW-ASNDTL-UPC-NBR                       80790000
808000                 DISPLAY 'PW-ASNHDR-NBR:           '              80800000
808100                          PW-ASNHDR-NBR                           80810000
808200                 DISPLAY 'PW-ASNORD-PO-NBR:        '              80820000
808300                          PW-ASNORD-PO-NBR                        80830000
808400                 DISPLAY '**********************************'     80840000
808500                 PERFORM Z800-SQL-WARNING                         80850000
808600                                                                  80860000
808700           WHEN  SQLCODE < ZERO                                   80870000
808800                 DISPLAY '**************************************' 80880000
808900                 DISPLAY 'ERROR ISSUED ON UPDATE OF TASNDTL     ' 80890000
809000                 DISPLAY 'ASNDTL-ASNDTL-NBR:       '              80900000
809100                          ASNDTL-ASNDTL-NBR                       80910000
809200                 DISPLAY 'PW-ASNDTL-UPC-NBR:       '              80920000
809300                          PW-ASNDTL-UPC-NBR                       80930000
809400                 DISPLAY 'PW-ASNHDR-NBR:           '              80940000
809500                          PW-ASNHDR-NBR                           80950000
809600                 DISPLAY 'PW-ASNORD-PO-NBR:        '              80960000
809700                          PW-ASNORD-PO-NBR                        80970000
809800                 DISPLAY '**************************************' 80980000
809900                 PERFORM Z900-SQL-ERROR                           80990000
810000                                                                  81000000
810100         END-EVALUATE                                             81010000
810200                                                                  81020000
810300     END-PERFORM.                                                 81030000
810400                                                                  81040000
810500     EVALUATE TRUE                                                81050000
810600       WHEN SQLCODE = ZERO                                        81060000
810700         CONTINUE                                                 81070000
810800       WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                    81080000
810900             DISPLAY '******************************************' 81090000
811000             DISPLAY 'WARNING ISSUED ON UPDATE OF TASNORD       ' 81100000
811100                 DISPLAY 'ASNDTL-ASNDTL-NBR:       '              81110000
811200                          ASNDTL-ASNDTL-NBR                       81120000
811300                 DISPLAY 'PW-ASNDTL-UPC-NBR:       '              81130000
811400                          PW-ASNDTL-UPC-NBR                       81140000
811500                 DISPLAY 'PW-ASNHDR-NBR:           '              81150000
811600                          PW-ASNHDR-NBR                           81160000
811700                 DISPLAY 'PW-ASNORD-PO-NBR:        '              81170000
811800                          PW-ASNORD-PO-NBR                        81180000
811900             DISPLAY '******************************************' 81190000
812000             PERFORM Z800-SQL-WARNING                             81200000
812100                                                                  81210000
812200       WHEN  SQLCODE < ZERO                                       81220000
812300             DISPLAY '******************************************' 81230000
812400             DISPLAY 'ERROR ISSUED ON UPDATE OF TASNORD         ' 81240000
812500                 DISPLAY 'ASNDTL-ASNDTL-NBR:       '              81250000
812600                          ASNDTL-ASNDTL-NBR                       81260000
812700                 DISPLAY 'PW-ASNDTL-UPC-NBR:       '              81270000
812800                          PW-ASNDTL-UPC-NBR                       81280000
812900                 DISPLAY 'PW-ASNHDR-NBR:           '              81290000
813000                          PW-ASNHDR-NBR                           81300000
813100                 DISPLAY 'PW-ASNORD-PO-NBR:        '              81310000
813200                          PW-ASNORD-PO-NBR                        81320000
813300             DISPLAY '******************************************' 81330000
813400             PERFORM Z900-SQL-ERROR                               81340000
813500                                                                  81350000
813600     END-EVALUATE.                                                81360000
813700                                                                  81370000
813800***************************************************************** 81380000
813900*     SQL INSERT ASCRIT                                         * 81390000
814000*                                                               * 81400000
814100***************************************************************** 81410000
814200 Z220-SQL-INSERT-ASCRIT.                                          81420000
814300     MOVE 'Z220-SQL-INSERT-ASCRIT             '                   81430000
814400                                 TO PW-CURRENT-PARA.              81440000
814500*    DISPLAY 'Z220-SQL-INSERT-ASCRIT'.                            81450000
814600     MOVE 0 TO SQLCODE.                                           81460000
814700     PERFORM                                                      81470000
814800       WITH TEST AFTER                                            81480000
814900       VARYING PW-RETRY-COUNTER FROM 1 BY 1                       81490000
815000       UNTIL   PW-RETRY-COUNTER > PC-MAX-RETRIES  OR              81500000
815100               SQLCODE = ZERO                                     81510000
815200                                                                  81520000
815300         EXEC SQL                                                 81530000
815400         INSERT INTO TASCRIT                                      81540000
815500                                                                  81550000
815600         (ASNCAR_NBR,                                             81560000
815700          ASNDTL_NBR,                                             81570000
815800          ASNHDR_ID)                                              81580000
815900         VALUES                                                   81590000
816000        (:PW-ASNCAR-ASNCAR-NBR,                                   81600000
816100         :PW-HOLD-ASNDTL-NBR,                                     81610000
816200         :PV-ASNHDR-ID)                                           81620000
816300         END-EXEC                                                 81630000
816400                                                                  81640000
816500         EVALUATE TRUE                                            81650000
816600           WHEN SQLCODE = ZERO                                    81660000
816700              ADD 1 TO PA-TASCRIT-CNT                             81670000
816800              IF PA-TASCRIT-CNT > 10000                           81680000
816900                 PERFORM Z700-COMMIT                              81690000
817000              END-IF                                              81700000
817100           WHEN SQLCODE = PC-NEG-904                              81710000
817200           WHEN SQLCODE = PC-NEG-913                              81720000
817300                 CONTINUE                                         81730000
817400                                                                  81740000
817500           WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                81750000
817600                 DISPLAY '**************************************' 81760000
817700                 DISPLAY 'WARNING ISSUED ON INSERT OF TASCRIT   ' 81770000
817800                 DISPLAY 'PC-OPERCO-NBR:         '                81780000
817900                          PC-OPERCO-NBR                           81790000
818000                 DISPLAY 'PW-HOLD-EDI-VEND-ID:   '                81800000
818100                          PW-HOLD-EDI-VEND-ID                     81810000
818200                 DISPLAY 'PW-ASNHDR-NBR:         '                81820000
818300                          PW-ASNHDR-NBR                           81830000
818400                 DISPLAY 'PW-ASNCAR-ASNCAR-NBR:  '                81840000
818500                          PW-ASNCAR-ASNCAR-NBR                    81850000
818600                 DISPLAY 'PW-HOLD-ASNDTL-NBR:  '                  81860000
818700                          PW-HOLD-ASNDTL-NBR                      81870000
818800                 DISPLAY '**********************************'     81880000
818900                 PERFORM Z800-SQL-WARNING                         81890000
819000                                                                  81900000
819100           WHEN  SQLCODE < ZERO                                   81910000
819200                 DISPLAY '**************************************' 81920000
819300                 DISPLAY 'ERROR ISSUED ON INSERT OF TASCRIT     ' 81930000
819400                 DISPLAY 'PC-OPERCO-NBR:         '                81940000
819500                          PC-OPERCO-NBR                           81950000
819600                 DISPLAY 'PW-HOLD-EDI-VEND-ID:   '                81960000
819700                          PW-HOLD-EDI-VEND-ID                     81970000
819800                 DISPLAY 'PW-ASNHDR-NBR:         '                81980000
819900                          PW-ASNHDR-NBR                           81990000
820000                 DISPLAY 'PW-ASNCAR-ASNCAR-NBR:  '                82000000
820100                          PW-ASNCAR-ASNCAR-NBR                    82010000
820200                 DISPLAY 'PW-HOLD-ASNDTL-NBR:  '                  82020000
820300                          PW-HOLD-ASNDTL-NBR                      82030000
820400                 DISPLAY '**************************************' 82040000
820500                 PERFORM Z900-SQL-ERROR                           82050000
820600                                                                  82060000
820700         END-EVALUATE                                             82070000
820800                                                                  82080000
820900     END-PERFORM.                                                 82090000
821000                                                                  82100000
821100     EVALUATE TRUE                                                82110000
821200       WHEN SQLCODE = ZERO                                        82120000
821300         CONTINUE                                                 82130000
821400       WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                    82140000
821500             DISPLAY '******************************************' 82150000
821600             DISPLAY 'WARNING ISSUED ON INSERT OF TASCRIT       ' 82160000
821700             DISPLAY 'PC-OPERCO-NBR:         '                    82170000
821800                      PC-OPERCO-NBR                               82180000
821900             DISPLAY 'PW-HOLD-EDI-VEND-ID:   '                    82190000
822000                      PW-HOLD-EDI-VEND-ID                         82200000
822100             DISPLAY 'PW-ASNHDR-NBR:         '                    82210000
822200                      PW-ASNHDR-NBR                               82220000
822300             DISPLAY 'PW-ASNCAR-ASNCAR-NBR:  '                    82230000
822400                      PW-ASNCAR-ASNCAR-NBR                        82240000
822500             DISPLAY 'PW-HOLD-ASNDTL-NBR:  '                      82250000
822600                      PW-HOLD-ASNDTL-NBR                          82260000
822700             DISPLAY '******************************************' 82270000
822800             PERFORM Z800-SQL-WARNING                             82280000
822900                                                                  82290000
823000       WHEN  SQLCODE < ZERO                                       82300000
823100             DISPLAY '******************************************' 82310000
823200             DISPLAY 'ERROR ISSUED ON INSERT OF TASCRIT         ' 82320000
823300             DISPLAY 'PC-OPERCO-NBR:         '                    82330000
823400                      PC-OPERCO-NBR                               82340000
823500             DISPLAY 'PW-HOLD-EDI-VEND-ID:   '                    82350000
823600                      PW-HOLD-EDI-VEND-ID                         82360000
823700             DISPLAY 'PW-ASNHDR-NBR:         '                    82370000
823800                      PW-ASNHDR-NBR                               82380000
823900             DISPLAY 'PW-ASNCAR-ASNCAR-NBR:  '                    82390000
824000                      PW-ASNCAR-ASNCAR-NBR                        82400000
824100             DISPLAY 'PW-HOLD-ASNDTL-NBR:  '                      82410000
824200                      PW-HOLD-ASNDTL-NBR                          82420000
824300             DISPLAY '******************************************' 82430000
824400             PERFORM Z900-SQL-ERROR                               82440000
824500                                                                  82450000
824600     END-EVALUATE.                                                82460000
824700/                                                                 82470000
824800***************************************************************** 82480000
824900*     SQL UPDATE ASNHDR                                         * 82490000
825000*                                                               * 82500000
825100***************************************************************** 82510000
825200 Z310-SQL-UPDATE-ASNHDR.                                          82520000
825300     MOVE 'Z310-SQL-UPDATE-ASNHDR             '                   82530000
825400                                 TO PW-CURRENT-PARA.              82540000
825500*    DISPLAY 'Z310-SQL-UPDATE-ASNHDR'.                            82550000
825600                                                                  82560000
825700     PERFORM                                                      82570000
825800       WITH TEST AFTER                                            82580000
825900       VARYING PW-RETRY-COUNTER FROM 1 BY 1                       82590000
826000       UNTIL   PW-RETRY-COUNTER > PC-MAX-RETRIES  OR              82600000
826100               SQLCODE = ZERO                                     82610000
826200                                                                  82620000
826300         EXEC SQL                                                 82630000
826400             UPDATE TASNHDR                                       82640000
826500             SET CART_SHIP_QTY = :PW-ASNHDR-CART-SHIP-QTY         82650000
826600             WHERE ASNHDR_ID   = :PV-ASNHDR-ID                    82660000
826700         END-EXEC                                                 82670000
826800                                                                  82680000
826900         EVALUATE TRUE                                            82690000
827000           WHEN SQLCODE = ZERO                                    82700000
827100           WHEN SQLCODE = PC-NEG-904                              82710000
827200           WHEN SQLCODE = PC-NEG-913                              82720000
827300                 CONTINUE                                         82730000
827400                                                                  82740000
827500           WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                82750000
827600                 DISPLAY '**************************************' 82760000
827700                 DISPLAY 'WARNING ISSUED ON UPDATE OF TASNHDR   ' 82770000
827800                 DISPLAY  PW-CURRENT-PARA                         82780000
827900                 DISPLAY 'PC-OPERCO-NBR:           '              82790000
828000                          PC-OPERCO-NBR                           82800000
828100                 DISPLAY 'PW-HOLD-EDI-VEND-ID:     '              82810000
828200                          PW-HOLD-EDI-VEND-ID                     82820000
828300                 DISPLAY 'PW-ASNHDR-NBR:           '              82830000
828400                          PW-ASNHDR-NBR                           82840000
828500                 DISPLAY 'PW-ASNHDR-CART-SHIP-QTY: '              82850000
828600                          PW-ASNHDR-CART-SHIP-QTY                 82860000
828700                 DISPLAY '**********************************'     82870000
828800                 PERFORM Z800-SQL-WARNING                         82880000
828900                                                                  82890000
829000           WHEN  SQLCODE < ZERO                                   82900000
829100                 DISPLAY '**************************************' 82910000
829200                 DISPLAY 'ERROR ISSUED ON UPDATE OF TASNHDR     ' 82920000
829300                 DISPLAY  PW-CURRENT-PARA                         82930000
829400                 DISPLAY 'PC-OPERCO-NBR:           '              82940000
829500                          PC-OPERCO-NBR                           82950000
829600                 DISPLAY 'PW-HOLD-EDI-VEND-ID:     '              82960000
829700                          PW-HOLD-EDI-VEND-ID                     82970000
829800                 DISPLAY 'PW-ASNHDR-NBR:           '              82980000
829900                          PW-ASNHDR-NBR                           82990000
830000                 DISPLAY 'PW-ASNHDR-CART-SHIP-QTY: '              83000000
830100                          PW-ASNHDR-CART-SHIP-QTY                 83010000
830200                 DISPLAY '**************************************' 83020000
830300                 PERFORM Z900-SQL-ERROR                           83030000
830400                                                                  83040000
830500         END-EVALUATE                                             83050000
830600                                                                  83060000
830700     END-PERFORM.                                                 83070000
830800                                                                  83080000
830900     EVALUATE TRUE                                                83090000
831000       WHEN SQLCODE = ZERO                                        83100000
831100         CONTINUE                                                 83110000
831200       WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                    83120000
831300             DISPLAY '******************************************' 83130000
831400             DISPLAY 'WARNING ISSUED ON UPDATE OF TASNHDR       ' 83140000
831500             DISPLAY  PW-CURRENT-PARA                             83150000
831600             DISPLAY 'PC-OPERCO-NBR:           '                  83160000
831700                      PC-OPERCO-NBR                               83170000
831800             DISPLAY 'PW-HOLD-EDI-VEND-ID:     '                  83180000
831900                      PW-HOLD-EDI-VEND-ID                         83190000
832000             DISPLAY 'PW-ASNHDR-NBR:           '                  83200000
832100                      PW-ASNHDR-NBR                               83210000
832200             DISPLAY 'PW-ASNHDR-CART-SHIP-QTY: '                  83220000
832300                      PW-ASNHDR-CART-SHIP-QTY                     83230000
832400             DISPLAY '******************************************' 83240000
832500             PERFORM Z800-SQL-WARNING                             83250000
832600                                                                  83260000
832700       WHEN  SQLCODE < ZERO                                       83270000
832800             DISPLAY '******************************************' 83280000
832900             DISPLAY 'ERROR ISSUED ON UPDATE OF TASNHDR         ' 83290000
833000             DISPLAY  PW-CURRENT-PARA                             83300000
833100             DISPLAY 'PC-OPERCO-NBR:           '                  83310000
833200                      PC-OPERCO-NBR                               83320000
833300             DISPLAY 'PW-HOLD-EDI-VEND-ID:     '                  83330000
833400                      PW-HOLD-EDI-VEND-ID                         83340000
833500             DISPLAY 'PW-ASNHDR-NBR:           '                  83350000
833600                      PW-ASNHDR-NBR                               83360000
833700             DISPLAY 'PW-ASNHDR-CART-SHIP-QTY: '                  83370000
833800                      PW-ASNHDR-CART-SHIP-QTY                     83380000
833900             DISPLAY '******************************************' 83390000
834000             PERFORM Z900-SQL-ERROR                               83400000
834100                                                                  83410000
834200     END-EVALUATE.                                                83420000
834300/                                                                 83430000
834400******************************************************************83440000
834500*  UPDATES THE ASN HEADER ID                                     *83450000
834600******************************************************************83460000
834700 U000-UPDATE-ASNHDR.                                              83470000
834800                                                                  83480000
834900     MOVE 'U000-UPDATE-ASNHDR'                                    83490000
835000                                 TO PW-CURRENT-PARA.              83500000
835100                                                                  83510000
835200     PERFORM                                                      83520000
835300       WITH TEST AFTER                                            83530000
835400       VARYING PW-RETRY-COUNTER FROM 1 BY 1                       83540000
835500       UNTIL   PW-RETRY-COUNTER > PC-MAX-RETRIES  OR              83550000
835600               SQLCODE = ZERO                                     83560000
835700                                                                  83570000
835800         EXEC SQL                                                 83580000
835900           UPDATE TASNHDR                                         83590000
836000              SET ASNHDR_ID    = :PV-ASNHDR-ID                    83600000
836100            WHERE OPERCO_NBR   = :PC-OPERCO-NBR                   83610000
836200              AND EDI_VEND_ID  = :PW-HOLD-EDI-VEND-ID             83620000
836300              AND ASNHDR_NBR   = :PW-ASNHDR-NBR                   83630000
836400         END-EXEC                                                 83640000
836500                                                                  83650000
836600         EVALUATE TRUE                                            83660000
836700           WHEN SQLCODE = ZERO                                    83670000
836800           WHEN SQLCODE = PC-NEG-904                              83680000
836900           WHEN SQLCODE = PC-NEG-913                              83690000
837000           WHEN SQLCODE = PC-NEG-803                              83700000
837100                 CONTINUE                                         83710000
837200                                                                  83720000
837300           WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                83730000
837400                 DISPLAY '**************************************' 83740000
837500                 DISPLAY  PW-CURRENT-PARA                         83750000
837600                 DISPLAY 'WARNING ISSUED ON UPDATE OF TASNHDR   ' 83760000
837700                 DISPLAY 'ASNHDR-OPERCO-NBR:       '              83770000
837800                          PC-OPERCO-NBR                           83780000
837900                 DISPLAY 'PW-HOLD-EDI-VEND-ID:     '              83790000
838000                          PW-HOLD-EDI-VEND-ID                     83800000
838100                 DISPLAY 'PW-ASNHDR-NBR:       '                  83810000
838200                          PW-ASNHDR-NBR                           83820000
838300                 DISPLAY '**************************************' 83830000
838400                 PERFORM Z800-SQL-WARNING                         83840000
838500                                                                  83850000
838600           WHEN  SQLCODE < ZERO                                   83860000
838700                 DISPLAY '**************************************' 83870000
838800                 DISPLAY  PW-CURRENT-PARA                         83880000
838900                 DISPLAY 'ERROR ISSUED ON UPDATE OF TASNHDR     ' 83890000
839000                 DISPLAY 'ASNHDR-OPERCO-NBR:       '              83900000
839100                          PC-OPERCO-NBR                           83910000
839200                 DISPLAY 'PW-HOLD-EDI-VEND-ID:     '              83920000
839300                          PW-HOLD-EDI-VEND-ID                     83930000
839400                 DISPLAY 'PW-ASNHDR-NBR:       '                  83940000
839500                          PW-ASNHDR-NBR                           83950000
839600                 DISPLAY '**************************************' 83960000
839700                 PERFORM Z900-SQL-ERROR                           83970000
839800                                                                  83980000
839900         END-EVALUATE                                             83990000
840000                                                                  84000000
840100     END-PERFORM.                                                 84010000
840200                                                                  84020000
840300******************************************************************84030000
840400*  UPDATES THE ASN HEADER ID                                     *84040000
840500******************************************************************84050000
840600 U100-UPDATE-ASNHDR.                                              84060000
840700                                                                  84070000
840800     MOVE 'U100-UPDATE-ASNHDR'                                    84080000
840900                                 TO PW-CURRENT-PARA.              84090000
841000                                                                  84100000
841100     PERFORM                                                      84110000
841200       WITH TEST AFTER                                            84120000
841300       VARYING PW-RETRY-COUNTER FROM 1 BY 1                       84130000
841400       UNTIL   PW-RETRY-COUNTER > PC-MAX-RETRIES  OR              84140000
841500               SQLCODE = ZERO                                     84150000
841600                                                                  84160000
841700         EXEC SQL                                                 84170000
841800           UPDATE TASNHDR                                         84180000
841900              SET EDI_VEND_ID  = :PW-HOLD-EDI-VEND-ID             84190000
842000            WHERE OPERCO_NBR   = :PC-OPERCO-NBR                   84200000
842100              AND ASNHDR_ID    = :PV-ASNHDR-ID                    84210000
842200         END-EXEC                                                 84220000
842300                                                                  84230000
842400         EVALUATE TRUE                                            84240000
842500           WHEN SQLCODE = ZERO                                    84250000
842600           WHEN SQLCODE = PC-NEG-904                              84260000
842700           WHEN SQLCODE = PC-NEG-913                              84270000
842800                 CONTINUE                                         84280000
842900           WHEN SQLCODE = PC-NEG-803                              84290000
843000*RSC             IF PS-FIRST-ERROR                                84300000
843100*                    SET PS-NOT-FIRST-ERROR TO TRUE               84310000
843200*                    PERFORM W100-PROCESS-HEADING-LINES           84320000
843300*RSC             END-IF                                           84330000
843400                 COMPUTE PA-ASNHDR-INSERTED =                     84340000
843500                        (PA-ASNHDR-INSERTED - 1)                  84350000
843600                 MOVE PW-ASNHDR-NBR          TO PSRL-ASNHDR-NBR   84360000
843700                 MOVE PW-HOLD-VEND-DUNNS-NBR TO PSRL-DUNNS-NBR    84370000
843800                 MOVE PW-HOLD-VENDOR-NAME    TO PSRL-VENDOR-NAME  84380000
843900                 MOVE PW-HOLD-ISA-CNTL-NBR                        84390000
844000                                          TO PSRL-ISA-NBR         84400000
844100*RSC             MOVE PSRL-REPORT-LINE-1     TO ASN-REPORT        84410000
844200*RSC             PERFORM W000-WRITE-REPORT-LINE                   84420000
844300                 MOVE PSRL-REPORT-LINE-1     TO                   84430000
844400                                          PW-ADV-SHIP-NOTICE-LINE 84440000
844500                 PERFORM Z510-WRITE-REPORT-LINE                   84450000
844600                 MOVE PR-DUP-ASN-MSG        TO PSRL-RPT-LINE-2    84460000
844700*RSC             MOVE PSRL-REPORT-LINE-2    TO ASN-REPORT         84470000
844800*RSC             PERFORM W000-WRITE-REPORT-LINE                   84480000
844900                 MOVE PSRL-REPORT-LINE-2     TO                   84490000
845000                                          PW-ADV-SHIP-NOTICE-LINE 84500000
845100                 PERFORM Z500-WRITE-REPORT-LINE                   84510000
845200                 SET PS-BAD-ASN             TO TRUE               84520000
845300                                                                  84530000
845400                 EXEC SQL                                         84540000
845500                      ROLLBACK                                    84550000
845600                 END-EXEC                                         84560000
845700                 DISPLAY '*********************'                  84570000
845800                 DISPLAY '*  R O L L B A C K  *'                  84580000
845900                 DISPLAY '*********************'                  84590000
846000                                                                  84600000
846100           WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                84610000
846200                 DISPLAY '**************************************' 84620000
846300                 DISPLAY  PW-CURRENT-PARA                         84630000
846400                 DISPLAY 'WARNING ISSUED ON UPDATE OF TASNHDR   ' 84640000
846500                 DISPLAY 'ASNHDR-OPERCO-NBR:       '              84650000
846600                          PC-OPERCO-NBR                           84660000
846700                 DISPLAY 'PW-HOLD-EDI-VEND-ID:     '              84670000
846800                          PW-HOLD-EDI-VEND-ID                     84680000
846900                 DISPLAY 'PV-ASNHDR-ID:       '                   84690000
847000                          PV-ASNHDR-ID                            84700000
847100                 DISPLAY '**************************************' 84710000
847200                 PERFORM Z800-SQL-WARNING                         84720000
847300                                                                  84730000
847400           WHEN  SQLCODE < ZERO                                   84740000
847500                 DISPLAY '**************************************' 84750000
847600                 DISPLAY  PW-CURRENT-PARA                         84760000
847700                 DISPLAY 'ERROR ISSUED ON UPDATE OF TASNHDR     ' 84770000
847800                 DISPLAY 'ASNHDR-OPERCO-NBR:       '              84780000
847900                          PC-OPERCO-NBR                           84790000
848000                 DISPLAY 'PW-HOLD-EDI-VEND-ID:     '              84800000
848100                          PW-HOLD-EDI-VEND-ID                     84810000
848200                 DISPLAY 'PV-ASNHDR-ID:       '                   84820000
848300                          PV-ASNHDR-ID                            84830000
848400                 DISPLAY '**************************************' 84840000
848500                 PERFORM Z900-SQL-ERROR                           84850000
848600                                                                  84860000
848700         END-EVALUATE                                             84870000
848800                                                                  84880000
848900     END-PERFORM.                                                 84890000
849000                                                                  84900000
849100******************************************************************84910000
849200*     OPENS THE PACK_CURSOR                                       84920000
849300******************************************************************84930000
849400 Z100-OPEN-PACK-CURSOR.                                           84940000
849500*                                                                 84950000
849600     MOVE 'Z100-OPEN-PACK-CURSOR'                                 84960000
849700                                  TO PW-CURRENT-PARA.             84970000
849800*    DISPLAY PW-CURRENT-PARA.                                     84980000
849900*                                                                 84990000
850000     EXEC SQL                                                     85000000
850100         OPEN PACK_CURSOR                                         85010000
850200     END-EXEC.                                                    85020000
850300*                                                                 85030000
850400     MOVE SQLCODE    TO SQLCODE2.                                 85040000
850500*                                                                 85050000
850600     EVALUATE TRUE                                                85060000
850700       WHEN SQLCODE         = ZERO                                85070000
850800         CONTINUE                                                 85080000
850900       WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                    85090000
851000         DISPLAY '******************************************'     85100000
851100         DISPLAY 'WARNING ISSUED ON OPEN OF PACK CURSOR     '     85110000
851200         DISPLAY '******************************************'     85120000
851300         DISPLAY  PW-CURRENT-PARA                                 85130000
851400         PERFORM  Z800-SQL-WARNING                                85140000
851500       WHEN  SQLCODE < ZERO                                       85150000
851600         DISPLAY '******************************************'     85160000
851700         DISPLAY 'ERROR ISSUED ON OPEN OF PACK  CURSOR      '     85170000
851800         DISPLAY '******************************************'     85180000
851900         DISPLAY  PW-CURRENT-PARA                                 85190000
852000         PERFORM  Z900-SQL-ERROR                                  85200000
852100     END-EVALUATE.                                                85210000
852200*                                                                 85220000
852300/                                                                 85230000
852400******************************************************************85240000
852500*  FETCHES THE PACK_CURSOR                                        85250000
852600******************************************************************85260000
852700 Z101-FETCH-PACK-CURSOR.                                          85270000
852800*                                                                 85280000
852900     MOVE 'Z101-FETCH-PACK-CURSOR'                                85290000
853000                                  TO PW-CURRENT-PARA.             85300000
853100*    DISPLAY PW-CURRENT-PARA.                                     85310000
853200*                                                                 85320000
853300     EXEC SQL                                                     85330000
853400         FETCH PACK_CURSOR                                        85340000
853500          INTO  :POPRPK-PO-NBR,                                   85350000
853600                :POPRPK-PO-PREPK-ID,                              85360000
853700                :PURITM-ITM-NBR,                                  85370000
853800                :PURITM-PREPK-RATO-QTY                            85380000
853900     END-EXEC.                                                    85390000
854000*                                                                 85400000
854100     MOVE SQLCODE    TO SQLCODE2.                                 85410000
854200*                                                                 85420000
854300     EVALUATE TRUE                                                85430000
854400       WHEN SQLCODE = ZEROS                                       85440000
854500         CONTINUE                                                 85450000
854600       WHEN SQLCODE = PC-ROW-NOT-FOUND                            85460000
854700         SET END-OF-PACK       TO TRUE                            85470000
854800       WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                    85480000
854900         DISPLAY '******************************************'     85490000
855000         DISPLAY 'WARNING ISSUED ON FETCH OF PACK_CURSOR    '     85500000
855100         DISPLAY '******************************************'     85510000
855200         DISPLAY  PW-CURRENT-PARA                                 85520000
855300         PERFORM  Z800-SQL-WARNING                                85530000
855400       WHEN  SQLCODE < ZERO                                       85540000
855500         DISPLAY '******************************************'     85550000
855600         DISPLAY 'ERROR ISSUED ON FETCH OF PACK CURSOR      '     85560000
855700         DISPLAY '******************************************'     85570000
855800         DISPLAY  PW-CURRENT-PARA                                 85580000
855900         PERFORM  Z900-SQL-ERROR                                  85590000
856000     END-EVALUATE.                                                85600000
856100*                                                                 85610000
856200/                                                                 85620000
856300******************************************************************85630000
856400*     CLOSES THE PACK_CURSOR                                      85640000
856500******************************************************************85650000
856600 Z102-CLOSE-PACK-CURSOR.                                          85660000
856700*                                                                 85670000
856800     MOVE 'Z102-CLOSE-PACK-CURSOR'                                85680000
856900                                  TO PW-CURRENT-PARA.             85690000
857000*    DISPLAY PW-CURRENT-PARA.                                     85700000
857100*                                                                 85710000
857200     EXEC SQL                                                     85720000
857300         CLOSE PACK_CURSOR                                        85730000
857400     END-EXEC.                                                    85740000
857500*                                                                 85750000
857600     MOVE SQLCODE    TO SQLCODE2.                                 85760000
857700*                                                                 85770000
857800     EVALUATE TRUE                                                85780000
857900       WHEN SQLCODE         = ZERO                                85790000
858000         CONTINUE                                                 85800000
858100       WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                    85810000
858200         DISPLAY '******************************************'     85820000
858300         DISPLAY 'WARNING ISSUED ON CLOSE OF PACK CURSOR     '    85830000
858400         DISPLAY '******************************************'     85840000
858500         DISPLAY  PW-CURRENT-PARA                                 85850000
858600         PERFORM  Z800-SQL-WARNING                                85860000
858700       WHEN  SQLCODE < ZERO                                       85870000
858800         DISPLAY '******************************************'     85880000
858900         DISPLAY 'ERROR ISSUED ON CLOSE OF PACK  CURSOR      '    85890000
859000         DISPLAY '******************************************'     85900000
859100         DISPLAY  PW-CURRENT-PARA                                 85910000
859200         PERFORM  Z900-SQL-ERROR                                  85920000
859300     END-EVALUATE.                                                85930000
859400                                                                  85940000
859500 Z103-INSERT-WFT-LOD-CNTL.                                        85950000
859600                                                                  85960000
859700     MOVE 'Z103-INSERT-WFT-LOD-CNTL'                              85970000
859800                                  TO PW-CURRENT-PARA.             85980000
859900     EXEC SQL                                                     85990000
860000         INSERT INTO WFT_LOD_CNTL                                 86000000
860100             ( PRC_CNTL_TMST                                      86010000
860200              ,TRN_TYP_CDE                                        86020000
860300              ,STAT_CDE                                           86030000
860400              ,INIT_PRCG_BEG_TMST                                 86040000
860500              ,END_TMST                                           86050000
860600              ,ARCH_DAT_IND                                       86060000
860700              ,DAT_LOD_VER_NBR                                    86070000
860800              ,STR_NBR                                            86080000
860900             )                                                    86090000
861000         VALUES                                                   86100000
861100             (:WFT00002-PRC-CNTL-TMST                             86110000
861200             ,'ASNPCK'                                            86120000
861300             ,'READY'                                             86130000
861400             ,:PC-DEFAULT-TMST                                    86140000
861500             ,:PC-DEFAULT-TMST                                    86150000
861600             ,'N'                                                 86160000
861700             ,10.01                                               86170000
861800             ,0900                                                86180000
861900             )                                                    86190000
862000     END-EXEC.                                                    86200000
862100                                                                  86210000
862200     MOVE SQLCODE    TO SQLCODE2.                                 86220000
862300                                                                  86230000
862400     EVALUATE TRUE                                                86240000
862500       WHEN SQLCODE = ZERO                                        86250000
862600           CONTINUE                                               86260000
862700       WHEN OTHER                                                 86270000
862800             DISPLAY '******************************************' 86280000
862900             DISPLAY 'SQLCODE => ' SQLCODE2                       86290000
863000             DISPLAY 'Z103-INSERT-WFT-LOD-CNTL'                   86300000
863100             DISPLAY 'ERROR ISSUED ON INSERT   '                  86310000
863200             DISPLAY '******************************************' 86320000
863300             PERFORM  Z900-SQL-ERROR                              86330000
863400     END-EVALUATE.                                                86340000
863500                                                                  86350000
863600 Z104-INSERT-WFT-LOD-XFER.                                        86360000
863700                                                                  86370000
863800     MOVE 'Z104-INSERT-WFT-LOD-XFER'                              86380000
863900                                  TO PW-CURRENT-PARA.             86390000
864000     INITIALIZE WFT00002-LOD-DAT-TXT.                             86400000
864100                                                                  86410000
864200     EXEC SQL                                                     86420000
864300         SET :WFT00002-PRC-CNTL-TMST = CURRENT TIMESTAMP          86430000
864400     END-EXEC.                                                    86440000
864500                                                                  86450000
864600     MOVE LENGTH OF WS-PUBLISH-MESSAGE TO                         86460000
864700        WFT00002-LOD-DAT-TXT-LEN.                                 86470000
864800                                                                  86480000
864900     MOVE WS-PUBLISH-MESSAGE TO                                   86490000
865000        WFT00002-LOD-DAT-TXT-TEXT.                                86500000
865100                                                                  86510000
865200     EXEC SQL                                                     86520000
865300         INSERT INTO WFT_LOD_XFER                                 86530000
865400             ( PRC_CNTL_TMST                                      86540000
865500              ,TRN_TYP_CDE                                        86550000
865600              ,BTCH_LOD_SEQ_ID                                    86560000
865700              ,LOD_DAT_TXT                                        86570000
865800             )                                                    86580000
865900         VALUES                                                   86590000
866000             (:WFT00002-PRC-CNTL-TMST                             86600000
866100             ,'ASNPCK'                                            86610000
866200             ,1                                                   86620000
866300             ,:WFT00002-LOD-DAT-TXT                               86630000
866400             )                                                    86640000
866500     END-EXEC.                                                    86650000
866600                                                                  86660000
866700     EVALUATE TRUE                                                86670000
866800       WHEN SQLCODE = ZERO                                        86680000
866900          DISPLAY WS-PUBLISH-MESSAGE                              86690000
867000       WHEN OTHER                                                 86700000
867100             DISPLAY '******************************************' 86710000
867200             DISPLAY 'SQLCODE => ' SQLCODE2                       86720000
867300             DISPLAY 'Z104-INSERT-WFT-DAT-XFER'                   86730000
867400             DISPLAY 'ERROR ISSUED ON INSERT   '                  86740000
867500             DISPLAY WS-PUBLISH-MESSAGE                           86750000
867600             DISPLAY '******************************************' 86760000
867700     END-EVALUATE.                                                86770000
867800******************************************************************86780000
867900*     OPENS THE COMP_CURSOR                                       86790000
868000******************************************************************86800000
868100 Z105-OPEN-COMP-CURSOR.                                           86810000
868200*                                                                 86820000
868300     MOVE 'Z105-COMP-PACK-CURSOR'                                 86830000
868400                                  TO PW-CURRENT-PARA.             86840000
868500*    DISPLAY PW-CURRENT-PARA.                                     86850000
868600*                                                                 86860000
868700     EXEC SQL                                                     86870000
868800         OPEN COMP_CURSOR                                         86880000
868900     END-EXEC.                                                    86890000
869000*                                                                 86900000
869100     MOVE SQLCODE    TO SQLCODE2.                                 86910000
869200*                                                                 86920000
869300     EVALUATE TRUE                                                86930000
869400       WHEN SQLCODE         = ZERO                                86940000
869500         CONTINUE                                                 86950000
869600       WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                    86960000
869700         DISPLAY '******************************************'     86970000
869800         DISPLAY 'WARNING ISSUED ON OPEN OF COMP CURSOR     '     86980000
869900         DISPLAY '******************************************'     86990000
870000         DISPLAY  PW-CURRENT-PARA                                 87000000
870100         PERFORM  Z800-SQL-WARNING                                87010000
870200       WHEN  SQLCODE < ZERO                                       87020000
870300         DISPLAY '******************************************'     87030000
870400         DISPLAY 'ERROR ISSUED ON OPEN OF COMP  CURSOR      '     87040000
870500         DISPLAY '******************************************'     87050000
870600         DISPLAY  PW-CURRENT-PARA                                 87060000
870700         PERFORM  Z900-SQL-ERROR                                  87070000
870800     END-EVALUATE.                                                87080000
870900*                                                                 87090000
871000/                                                                 87100000
871100******************************************************************87110000
871200*  FETCHES THE COMP_CURSOR                                        87120000
871300******************************************************************87130000
871400 Z106-FETCH-COMP-CURSOR.                                          87140000
871500*                                                                 87150000
871600     MOVE 'Z106-FETCH-COMP-CURSOR'                                87160000
871700                                  TO PW-CURRENT-PARA.             87170000
871800*    DISPLAY PW-CURRENT-PARA.                                     87180000
871900*                                                                 87190000
872000     EXEC SQL                                                     87200000
872100         FETCH COMP_CURSOR                                        87210000
872200          INTO  :XLT00006-UPC-NBR                                 87220000
872300     END-EXEC.                                                    87230000
872400*                                                                 87240000
872500     MOVE SQLCODE    TO SQLCODE2.                                 87250000
872600*                                                                 87260000
872700     EVALUATE TRUE                                                87270000
872800       WHEN SQLCODE = 0                                           87280000
872900          SET NOT-END-OF-COMPONENTS TO TRUE                       87290000
873000          SET NOT-COMP-FOUND TO TRUE                              87300000
873100          PERFORM                                                 87310000
873200             VARYING WS-SUB5 FROM 1 BY 1                          87320000
873300             UNTIL WS-SUB5 > WS-COMPONENTS OR                     87330000
873400                   END-OF-COMPONENTS                              87340000
873500             IF WS-PRPK-COMP-UPC(WS-SUB5) = XLT00006-UPC-NBR      87350000
873600                SET END-OF-COMPONENTS TO TRUE                     87360000
873700                SET END-OF-COMP       TO TRUE                     87370000
873800                SET COMP-FOUND        TO TRUE                     87380000
873900             END-IF                                               87390000
874000          END-PERFORM                                             87400000
874100          IF NOT-COMP-FOUND                                       87410000
874200             MOVE 1 TO XLT00006-UPC-NBR                           87420000
874300          END-IF                                                  87430000
874400       WHEN SQLCODE = PC-ROW-NOT-FOUND                            87440000
874500         SET END-OF-COMP       TO TRUE                            87450000
874600       WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                    87460000
874700         DISPLAY '******************************************'     87470000
874800         DISPLAY 'WARNING ISSUED ON FETCH OF COMP_CURSOR    '     87480000
874900         DISPLAY '******************************************'     87490000
875000         DISPLAY  PW-CURRENT-PARA                                 87500000
875100         PERFORM  Z800-SQL-WARNING                                87510000
875200       WHEN  SQLCODE < ZERO                                       87520000
875300         DISPLAY '******************************************'     87530000
875400         DISPLAY 'ERROR ISSUED ON FETCH OF COMP CURSOR      '     87540000
875500         DISPLAY '******************************************'     87550000
875600         DISPLAY  PW-CURRENT-PARA                                 87560000
875700         PERFORM  Z900-SQL-ERROR                                  87570000
875800     END-EVALUATE.                                                87580000
875900*                                                                 87590000
876000/                                                                 87600000
876100******************************************************************87610000
876200*     CLOSES THE COMP_CURSOR                                      87620000
876300******************************************************************87630000
876400 Z107-CLOSE-COMP-CURSOR.                                          87640000
876500*                                                                 87650000
876600     MOVE 'Z107-CLOSE-COMP-CURSOR'                                87660000
876700                                  TO PW-CURRENT-PARA.             87670000
876800*    DISPLAY PW-CURRENT-PARA.                                     87680000
876900*                                                                 87690000
877000     EXEC SQL                                                     87700000
877100         CLOSE COMP_CURSOR                                        87710000
877200     END-EXEC.                                                    87720000
877300*                                                                 87730000
877400     MOVE SQLCODE    TO SQLCODE2.                                 87740000
877500*                                                                 87750000
877600     EVALUATE TRUE                                                87760000
877700       WHEN SQLCODE         = ZERO                                87770000
877800         CONTINUE                                                 87780000
877900       WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                    87790000
878000         DISPLAY '******************************************'     87800000
878100         DISPLAY 'WARNING ISSUED ON CLOSE OF COMP CURSOR     '    87810000
878200         DISPLAY '******************************************'     87820000
878300         DISPLAY  PW-CURRENT-PARA                                 87830000
878400         PERFORM  Z800-SQL-WARNING                                87840000
878500       WHEN  SQLCODE < ZERO                                       87850000
878600         DISPLAY '******************************************'     87860000
878700         DISPLAY 'ERROR ISSUED ON CLOSE OF COMP  CURSOR      '    87870000
878800         DISPLAY '******************************************'     87880000
878900         DISPLAY  PW-CURRENT-PARA                                 87890000
879000         PERFORM  Z900-SQL-ERROR                                  87900000
879100     END-EVALUATE.                                                87910000
879200***************************************************************** 87920000
879300*     SQL UPDATE ASNORD                                         * 87930000
879400*                                                               * 87940000
879500***************************************************************** 87950000
879600 Z320-SQL-UPDATE-ASNORD.                                          87960000
879700     MOVE 'Z320-SQL-UPDATE-ASNORD             '                   87970000
879800                                 TO PW-CURRENT-PARA.              87980000
879900*    DISPLAY 'Z320-SQL-UPDATE-ASNORD'.                            87990000
880000                                                                  88000000
880100     PERFORM                                                      88010000
880200       WITH TEST AFTER                                            88020000
880300       VARYING PW-RETRY-COUNTER FROM 1 BY 1                       88030000
880400       UNTIL   PW-RETRY-COUNTER > PC-MAX-RETRIES  OR              88040000
880500               SQLCODE = ZERO                                     88050000
880600                                                                  88060000
880700         EXEC SQL                                                 88070000
880800             UPDATE TASNORD                                       88080000
880900             SET   EXCH_FCTR    =  :PW-ASNORD-EXCH-FCTR,          88090000
881000                   SELR_CUR_CDE =  :PW-ASNORD-SELR-CUR-CDE        88100000
881100             WHERE PO_NBR       =  :PW-ASNORD-PO-NBR              88110000
881200               AND SELR_INV_NBR =  :PW-ASNORD-SELR-INV-NBR        88120000
881300               AND ASNHDR_ID    =  :PV-ASNHDR-ID                  88130000
881400         END-EXEC                                                 88140000
881500                                                                  88150000
881600         EVALUATE TRUE                                            88160000
881700           WHEN SQLCODE = ZERO                                    88170000
881800           WHEN SQLCODE = PC-NEG-904                              88180000
881900           WHEN SQLCODE = PC-NEG-913                              88190000
882000                 CONTINUE                                         88200000
882100                                                                  88210000
882200           WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                88220000
882300                 DISPLAY '**************************************' 88230000
882400                 DISPLAY 'WARNING ISSUED ON UPDATE OF TASNORD   ' 88240000
882500                 DISPLAY 'PC-OPERCO-NBR:           '              88250000
882600                          PC-OPERCO-NBR                           88260000
882700                 DISPLAY 'PW-HOLD-EDI-VEND-ID:     '              88270000
882800                          PW-HOLD-EDI-VEND-ID                     88280000
882900                 DISPLAY 'PW-ASNHDR-NBR:           '              88290000
883000                          PW-ASNHDR-NBR                           88300000
883100                 DISPLAY 'PW-ASNORD-PO-NBR:        '              88310000
883200                          PW-ASNORD-PO-NBR                        88320000
883300                 DISPLAY 'PW-ASNORD-SELR-INV-NBR:  '              88330000
883400                          PW-ASNORD-SELR-INV-NBR                  88340000
883500                 DISPLAY '**********************************'     88350000
883600                 PERFORM Z800-SQL-WARNING                         88360000
883700                                                                  88370000
883800           WHEN  SQLCODE < ZERO                                   88380000
883900                 DISPLAY '**************************************' 88390000
884000                 DISPLAY 'ERROR ISSUED ON UPDATE OF TASNORD     ' 88400000
884100                 DISPLAY 'PC-OPERCO-NBR:           '              88410000
884200                          PC-OPERCO-NBR                           88420000
884300                 DISPLAY 'PW-HOLD-EDI-VEND-ID:     '              88430000
884400                          PW-HOLD-EDI-VEND-ID                     88440000
884500                 DISPLAY 'PW-ASNHDR-NBR:           '              88450000
884600                          PW-ASNHDR-NBR                           88460000
884700                 DISPLAY 'PW-ASNORD-PO-NBR:        '              88470000
884800                          PW-ASNORD-PO-NBR                        88480000
884900                 DISPLAY 'PW-ASNORD-SELR-INV-NBR:  '              88490000
885000                          PW-ASNORD-SELR-INV-NBR                  88500000
885100                 DISPLAY '**************************************' 88510000
885200                 PERFORM Z900-SQL-ERROR                           88520000
885300                                                                  88530000
885400         END-EVALUATE                                             88540000
885500                                                                  88550000
885600     END-PERFORM.                                                 88560000
885700                                                                  88570000
885800     EVALUATE TRUE                                                88580000
885900       WHEN SQLCODE = ZERO                                        88590000
886000         CONTINUE                                                 88600000
886100       WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                    88610000
886200             DISPLAY '******************************************' 88620000
886300             DISPLAY 'WARNING ISSUED ON UPDATE OF TASNORD       ' 88630000
886400             DISPLAY 'PC-OPERCO-NBR:           '                  88640000
886500                      PC-OPERCO-NBR                               88650000
886600             DISPLAY 'PW-HOLD-EDI-VEND-ID:     '                  88660000
886700                      PW-HOLD-EDI-VEND-ID                         88670000
886800             DISPLAY 'PW-ASNHDR-NBR:           '                  88680000
886900                      PW-ASNHDR-NBR                               88690000
887000             DISPLAY 'PW-ASNORD-PO-NBR:        '                  88700000
887100                      PW-ASNORD-PO-NBR                            88710000
887200             DISPLAY 'PW-ASNORD-SELR-INV-NBR:  '                  88720000
887300                      PW-ASNORD-SELR-INV-NBR                      88730000
887400             DISPLAY '******************************************' 88740000
887500             PERFORM Z800-SQL-WARNING                             88750000
887600                                                                  88760000
887700       WHEN  SQLCODE < ZERO                                       88770000
887800             DISPLAY '******************************************' 88780000
887900             DISPLAY 'ERROR ISSUED ON UPDATE OF TASNORD         ' 88790000
888000             DISPLAY 'PC-OPERCO-NBR:           '                  88800000
888100                      PC-OPERCO-NBR                               88810000
888200             DISPLAY 'PW-HOLD-EDI-VEND-ID:     '                  88820000
888300                      PW-HOLD-EDI-VEND-ID                         88830000
888400             DISPLAY 'PW-ASNHDR-NBR:           '                  88840000
888500                      PW-ASNHDR-NBR                               88850000
888600             DISPLAY 'PW-ASNORD-PO-NBR:        '                  88860000
888700                      PW-ASNORD-PO-NBR                            88870000
888800             DISPLAY 'PW-ASNORD-SELR-INV-NBR:  '                  88880000
888900                      PW-ASNORD-SELR-INV-NBR                      88890000
889000             DISPLAY '******************************************' 88900000
889100             PERFORM Z900-SQL-ERROR                               88910000
889200                                                                  88920000
889300     END-EVALUATE.                                                88930000
889400/                                                                 88940000
889500***************************************************************** 88950000
889600*                                                               * 88960000
889700*                                                               * 88970000
889800***************************************************************** 88980000
889900 Z400-GET-KOHLS-PO-NBR.                                           88990000
890000                                                                  89000000
890100     MOVE PW-ASNORD-VEND-ORD-NBR (1:7) TO DP010I-UNEDITED-FIELD.  89010000
890200     MOVE 7                      TO DP010I-MAXIMUM-DIGITS.        89020000
890300     MOVE ZERO                   TO DP010I-MAXIMUM-DECIMALS.      89030000
890400     SET DP010I-NEGATIVE-NOT-ALLOWED                              89040000
890500                                 TO TRUE.                         89050000
890610     CALL DP010I-NUMERIC-EDIT-ROUTINE                             89061001
890620          USING DP010I-NUMERIC-EDIT-AREA.                         89062001
890700     MOVE DP010I-NUMERIC-FIELD   TO PURCHS-IMPRT-AGNT-PO-NBR.     89070000
890800                                                                  89080000
890900     IF DP010I-ERROR-DETECTED                                     89090000
891000         DISPLAY 'ERROR EDITING PO NUMBER: '                      89100000
891100             ASNORD-PO-NBR                                        89110000
891200     END-IF.                                                      89120000
891300                                                                  89130000
891400     PERFORM                                                      89140000
891500       WITH TEST AFTER                                            89150000
891600       VARYING PW-RETRY-COUNTER FROM 1 BY 1                       89160000
891700       UNTIL   PW-RETRY-COUNTER > PC-MAX-RETRIES  OR              89170000
891800               SQLCODE = ZERO  OR                                 89180000
891900               SQLCODE = +100                                     89190000
892000                                                                  89200000
892100         EXEC SQL                                                 89210000
892200             SELECT PO_NBR                                        89220000
892300             INTO  :PURCHS-PO-NBR                                 89230000
892400             FROM TPURCHS                                         89240000
892500             WHERE IMPRT_AGNT_PO_NBR = :PURCHS-IMPRT-AGNT-PO-NBR  89250000
892600               AND VER_STATUS_CDE = 'A'                           89260000
892700         END-EXEC                                                 89270000
892800                                                                  89280000
892900         EVALUATE TRUE                                            89290000
893000           WHEN SQLCODE = ZERO                                    89300000
893100           WHEN SQLCODE = +100                                    89310000
893200           WHEN SQLCODE = PC-NEG-904                              89320000
893300           WHEN SQLCODE = PC-NEG-913                              89330000
893400                 CONTINUE                                         89340000
893500                                                                  89350000
893600           WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                89360000
893700                 DISPLAY '**************************************' 89370000
893800                 DISPLAY 'WARNING ISSUED ON UPDATE OF TASNORD   ' 89380000
893900                 DISPLAY 'PC-OPERCO-NBR:           '              89390000
894000                          PC-OPERCO-NBR                           89400000
894100                 DISPLAY 'PW-HOLD-EDI-VEND-ID:     '              89410000
894200                          PW-HOLD-EDI-VEND-ID                     89420000
894300                 DISPLAY 'PW-ASNHDR-NBR:           '              89430000
894400                          PW-ASNHDR-NBR                           89440000
894500                 DISPLAY 'PW-ASNORD-PO-NBR:        '              89450000
894600                          PW-ASNORD-PO-NBR                        89460000
894700                 DISPLAY 'PW-ASNORD-SELR-INV-NBR:  '              89470000
894800                          PW-ASNORD-SELR-INV-NBR                  89480000
894900                 DISPLAY '**********************************'     89490000
895000                 PERFORM Z800-SQL-WARNING                         89500000
895100                                                                  89510000
895200           WHEN  SQLCODE < ZERO                                   89520000
895300                 DISPLAY '**************************************' 89530000
895400                 DISPLAY 'ERROR ISSUED ON UPDATE OF TASNORD     ' 89540000
895500                 DISPLAY 'PC-OPERCO-NBR:           '              89550000
895600                          PC-OPERCO-NBR                           89560000
895700                 DISPLAY 'PW-HOLD-EDI-VEND-ID:     '              89570000
895800                          PW-HOLD-EDI-VEND-ID                     89580000
895900                 DISPLAY 'PW-ASNHDR-NBR:           '              89590000
896000                          PW-ASNHDR-NBR                           89600000
896100                 DISPLAY 'PW-ASNORD-PO-NBR:        '              89610000
896200                          PW-ASNORD-PO-NBR                        89620000
896300                 DISPLAY 'PW-ASNORD-SELR-INV-NBR:  '              89630000
896400                          PW-ASNORD-SELR-INV-NBR                  89640000
896500                 DISPLAY '**************************************' 89650000
896600                 PERFORM Z900-SQL-ERROR                           89660000
896700                                                                  89670000
896800         END-EVALUATE                                             89680000
896900                                                                  89690000
897000     END-PERFORM.                                                 89700000
897100                                                                  89710000
897200     EVALUATE TRUE                                                89720000
897300       WHEN SQLCODE = ZERO                                        89730000
897400       WHEN SQLCODE = +100                                        89740000
897500         CONTINUE                                                 89750000
897600       WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                    89760000
897700             DISPLAY '******************************************' 89770000
897800             DISPLAY 'WARNING ISSUED ON UPDATE OF TASNORD       ' 89780000
897900             DISPLAY 'PC-OPERCO-NBR:           '                  89790000
898000                      PC-OPERCO-NBR                               89800000
898100             DISPLAY 'PW-HOLD-EDI-VEND-ID:     '                  89810000
898200                      PW-HOLD-EDI-VEND-ID                         89820000
898300             DISPLAY 'PW-ASNHDR-NBR:           '                  89830000
898400                      PW-ASNHDR-NBR                               89840000
898500             DISPLAY 'PW-ASNORD-PO-NBR:        '                  89850000
898600                      PW-ASNORD-PO-NBR                            89860000
898700             DISPLAY 'PW-ASNORD-SELR-INV-NBR:  '                  89870000
898800                      PW-ASNORD-SELR-INV-NBR                      89880000
898900             DISPLAY '******************************************' 89890000
899000             PERFORM Z800-SQL-WARNING                             89900000
899100                                                                  89910000
899200       WHEN  SQLCODE < ZERO                                       89920000
899300             DISPLAY '******************************************' 89930000
899400             DISPLAY 'ERROR ISSUED ON UPDATE OF TASNORD         ' 89940000
899500             DISPLAY 'PC-OPERCO-NBR:           '                  89950000
899600                      PC-OPERCO-NBR                               89960000
899700             DISPLAY 'PW-HOLD-EDI-VEND-ID:     '                  89970000
899800                      PW-HOLD-EDI-VEND-ID                         89980000
899900             DISPLAY 'PW-ASNHDR-NBR:           '                  89990000
900000                      PW-ASNHDR-NBR                               90000000
900100             DISPLAY 'PW-ASNORD-PO-NBR:        '                  90010000
900200                      PW-ASNORD-PO-NBR                            90020000
900300             DISPLAY 'PW-ASNORD-SELR-INV-NBR:  '                  90030000
900400                      PW-ASNORD-SELR-INV-NBR                      90040000
900500             DISPLAY '******************************************' 90050000
900600             PERFORM Z900-SQL-ERROR                               90060000
900700                                                                  90070000
900800     END-EVALUATE.                                                90080000
900900****************************************************************  90090000
901000*     WRITE-REPORT-LINE                                        *  90100000
901100*                                                              *  90110000
901200*     -  WRITE THE REPORT LINE AFTER ADVANCING ONE LINE        *  90120000
901300****************************************************************  90130000
901400 Z500-WRITE-REPORT-LINE.                                          90140000
901500     MOVE 'Z500-WRITE-REPORT-LINE         '                       90150000
901600                                 TO PW-CURRENT-PARA.              90160000
901700*    DISPLAY 'Z500-WRITE-REPORT-LINE'.                            90170000
901800                                                                  90180000
901900     ADD 1                       TO PA-LINE-CNT.                  90190000
902000                                                                  90200000
902100     IF PA-LINE-CNT > PC-POS-54                                   90210000
902200         PERFORM Z600-PROCESS-HEADING-LINES                       90220000
902300     END-IF.                                                      90230000
902400                                                                  90240000
902500     WRITE ADV-SHIP-NOTICE-LINE                                   90250000
902600       FROM PW-ADV-SHIP-NOTICE-LINE                               90260000
902700       AFTER ADVANCING 1 LINE.                                    90270000
902800/                                                                 90280000
902900****************************************************************  90290000
903000*     WRITE-REPORT-LINE                                        *  90300000
903100*                                                              *  90310000
903200*     -  WRITE THE REPORT LINE AFTER ADVANCING ONE LINE        *  90320000
903300****************************************************************  90330000
903400 Z510-WRITE-REPORT-LINE.                                          90340000
903500     MOVE 'Z510-WRITE-REPORT-LINE         '                       90350000
903600                                 TO PW-CURRENT-PARA.              90360000
903700*    DISPLAY 'Z510-WRITE-REPORT-LINE'.                            90370000
903800                                                                  90380000
903900     ADD 2                       TO PA-LINE-CNT.                  90390000
904000                                                                  90400000
904100     IF PA-LINE-CNT > PC-POS-54                                   90410000
904200         PERFORM Z600-PROCESS-HEADING-LINES                       90420000
904300     END-IF.                                                      90430000
904400                                                                  90440000
904500     WRITE ADV-SHIP-NOTICE-LINE                                   90450000
904600       FROM PW-ADV-SHIP-NOTICE-LINE                               90460000
904700       AFTER ADVANCING 2 LINE.                                    90470000
904800/                                                                 90480000
904900****************************************************************  90490000
905000*     PROCESS-HEADING-LINES                                    *  90500000
905100*                                                              *  90510000
905200*     -  CONTROL THE LOADING AND PRINTING OF THE HEADING LINES *  90520000
905300****************************************************************  90530000
905400 Z600-PROCESS-HEADING-LINES.                                      90540000
905500     MOVE 'Z600-PROCESS-HEADING-LINES     '                       90550000
905600                                 TO PW-CURRENT-PARA.              90560000
905700*    DISPLAY 'Z600-PROCESS-HEADING-LINES'.                        90570000
905800                                                                  90580000
905900     MOVE 'SNKRP001'             TO DP132O-PROGRAM-NAME.          90590000
906000     MOVE 1                      TO DP132O-REPORT-NUMBER.         90600000
906100                                                                  90610000
906200     ADD 1                       TO PA-PAGE-CNT.                  90620000
906300     MOVE PA-PAGE-CNT            TO DP132O-PAGE-NUMBER.           90630000
906400                                                                  90640000
906500     WRITE ADV-SHIP-NOTICE-LINE                                   90650000
906600        FROM DP132O-STANDRD-HEADER-132-COLS                       90660000
906700        AFTER ADVANCING PAGE.                                     90670000
906800                                                                  90680000
906900     MOVE CC-PARM-TYPE           TO H2-TEST-PROD.                 90690000
907000     WRITE ADV-SHIP-NOTICE-LINE                                   90700000
907100         FROM H2-HEADING-LINE2                                    90710000
907200         AFTER ADVANCING 1 LINE.                                  90720000
907300                                                                  90730000
907400     WRITE ADV-SHIP-NOTICE-LINE                                   90740000
907500         FROM H3-HEADING-LINE3                                    90750000
907600         AFTER ADVANCING 2 LINE.                                  90760000
907700                                                                  90770000
907800     MOVE 1                      TO PA-LINE-CNT.                  90780000
907900/                                                                 90790000
908000***************************************************************** 90800000
908100* DB2 COMMIT                                                      90810000
908200***************************************************************** 90820000
908300 Z700-COMMIT.                                                     90830000
908400                                                                  90840000
908500     EXEC SQL                                                     90850000
908600         COMMIT                                                   90860000
908700     END-EXEC.                                                    90870000
908800                                                                  90880000
908900     EVALUATE TRUE                                                90890000
909000        WHEN SQLCODE = 0                                          90900000
909100           DISPLAY '* DB2 COMMIT - *' PA-TASCRIT-CNT              90910000
909200           MOVE 0 TO PA-TASCRIT-CNT                               90920000
909300        WHEN OTHER                                                90930000
909400           DISPLAY '**************************************'       90940000
909500           DISPLAY 'ERROR ISSUED ON COMMIT'                       90950000
909600           DISPLAY 'PA-TASCRIT-CNT         '                      90960000
909700                    PA-TASCRIT-CNT                                90970000
909800           DISPLAY '***********************'                      90980000
909900           PERFORM Z900-SQL-ERROR                                 90990000
910000        END-EVALUATE.                                             91000000
910100                                                                  91010000
910200 Z800-SQL-WARNING.                                                91020000
910300******************************************************************91030000
910400*  THIS MODULE PERFORMS THE SQL WARNING.                         *91040000
910500******************************************************************91050000
910600      MOVE SQLCODE               TO SQLCODE2.                     91060000
910700      MOVE SQLERRD(3)            TO SQLERRD3.                     91070000
910800      DISPLAY '** ABEND **       ** = SQLWARNING'.                91080000
910900      DISPLAY '** PROGRAM        ** = SNKUP001'.                  91090000
911000      DISPLAY '** SQLCODE        ** = ' SQLCODE2.                 91100000
911100      DISPLAY '** ROWS PROCESSED ** = ' SQLERRD3.                 91110000
911200      DISPLAY '** SQLWARN0       ** = ' SQLWARN0.                 91120000
911300      DISPLAY '** SQLWARN1       ** = ' SQLWARN1.                 91130000
911400      DISPLAY '** SQLWARN2       ** = ' SQLWARN2.                 91140000
911500      DISPLAY '** SQLWARN3       ** = ' SQLWARN3.                 91150000
911600      DISPLAY '** SQLWARN4       ** = ' SQLWARN4.                 91160000
911700      DISPLAY '** SQLWARN5       ** = ' SQLWARN5.                 91170000
911800      DISPLAY '** SQLWARN6       ** = ' SQLWARN6.                 91180000
911900      DISPLAY '** SQLWARN7       ** = ' SQLWARN7.                 91190000
912000                                                                  91200000
912100      EXEC SQL                                                    91210000
912200          ROLLBACK                                                91220000
912300      END-EXEC.                                                   91230000
912400      DISPLAY '*********************'                             91240000
912500      DISPLAY '*  R O L L B A C K  *'                             91250000
912600      DISPLAY '*********************'                             91260000
912700                                                                  91270000
912800      SET ABEND-4013-DB2-ERROR   TO TRUE                          91280000
912900      CALL 'ILBOABN0' USING ABEND-CODE.                           91290000
913000/                                                                 91300000
913100 Z900-SQL-ERROR.                                                  91310000
913200******************************************************************91320000
913300* THIS MODULE PERFORMS THE SQL ERROR.                            *91330000
913400******************************************************************91340000
913500      MOVE SQLCODE               TO SQLCODE2.                     91350000
913600      MOVE SQLERRD(3)            TO SQLERRD3.                     91360000
913700      DISPLAY '** ABEND **       ** = SQLERROR'.                  91370000
913800      DISPLAY '** PROGRAM        ** = SNKUP001'.                  91380000
913900      DISPLAY '** SQLCODE        ** = ' SQLCODE2.                 91390000
914000      DISPLAY '** ROWS PROCESSED ** = ' SQLERRD3.                 91400000
914100      DISPLAY '** SQLERRM        ** = ' SQLERRM.                  91410000
914200      DISPLAY '** SQLERRMC       ** = ' SQLERRMC.                 91420000
914300                                                                  91430000
914400      EXEC SQL                                                    91440000
914500          ROLLBACK                                                91450000
914600      END-EXEC.                                                   91460000
914700      DISPLAY '*********************'                             91470000
914800      DISPLAY '*  R O L L B A C K  *'                             91480000
914900      DISPLAY '*********************'                             91490000
915000                                                                  91500000
915100      SET ABEND-4013-DB2-ERROR   TO TRUE                          91510000
915200      CALL 'ILBOABN0' USING ABEND-CODE.                           91520000
915300*                                                                 91530000
