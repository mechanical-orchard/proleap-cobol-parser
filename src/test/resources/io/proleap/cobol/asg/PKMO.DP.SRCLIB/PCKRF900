000100 IDENTIFICATION DIVISION.                                         00010029
000200                                                                  00020029
000300 PROGRAM-ID.             PCKRF900.                                00030029
000400 AUTHOR.                 DENNIS STEFFEN.                          00040029
000500 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00050029
000600 DATE-WRITTEN            OCTOBER, 2003.                           00060029
000700 DATE-COMPILED.                                                   00070029
000800 ENVIRONMENT DIVISION.                                            00080029
000900 DATA DIVISION.                                                   00090029
001000 WORKING-STORAGE SECTION.                                         00100029
001100                                                                  00110029
001200 01  DK-DB2-KEYS.                                                 00120029
001300     05  DK-SHIPT-UNT-ID                 PIC  S9(18)V COMP-3.     00130029
001400     05  DK-UPC-NBR                      PIC  S9(15)V COMP-3.     00140029
001500     05  DK-ADJ-TO-QTY                   PIC  S9(4)   COMP.       00150029
001600     05  DK-SKU-NBR                      PIC S9(08)V  COMP-3      00160029
001700                                                VALUE ZERO.       00170029
001800     05  DK-RCVR-SEQ-NBR                 PIC S9(09) COMP          00180029
001900                                                VALUE ZERO.       00190029
002000                                                                  00200029
002100* PROGRAM CONSTANTS                                               00210029
002200 01  PC-PROGRAM-CONSTANTS.                                        00220029
002300     05  PC-TRANID                       PIC  X(04)  VALUE 'G900'.00230029
002400     05  PC-MAX-RETRIES                  PIC S9(04)  VALUE +3     00240029
002500                                                     COMP SYNC.   00250029
002600     05  PC-COMMAREA-LENGTH              PIC S9(04)  VALUE +0     00260029
002700                                                     COMP SYNC.   00270029
002800     05  PC-RECEIVE-LENGTH               PIC S9(04)  VALUE +1     00280029
002900                                                     COMP SYNC.   00290029
003000     05  PC-CURRENT-PROGRAM-NAME    PIC X(08) VALUE 'PCKRF900'.   00300029
003100     05  PC-MANIFEST-MENU-PGM       PIC X(08) VALUE 'PCKRF850'.   00310029
003200     05  PC-DC-RF-APPL-PGM          PIC X(08) VALUE 'MPKCS027'.   00320029
003300     05  PC-ADJUST-CRTN-UNTS-PGM    PIC X(08) VALUE 'PCKRF861'.   00330029
003400     05  PC-ALTER-REASON-PGM        PIC X(08) VALUE 'PCKRF862'.   00340029
003500     05  PC-ADJUSTED-QTY-PGM        PIC X(08) VALUE 'PCKRF900'.   00350029
003600     05  PC-SUKUT702                PIC X(08) VALUE 'SUKUT702'.   00360029
003700     05  PC-RANDOM-NBR-GENERATOR    PIC X(08) VALUE 'DPKCS902'.   00370029
003800*                                                                 00380029
003900* SYSTEM/ERROR MESSAGES                                           00390029
004000     05  PC-UNRECOGNIZED-PF-KEY-MSG PIC X(19)                     00400029
004100                                    VALUE  'UNRECOGNIZED PF KEY'. 00410029
004200     05  PC-ENTER-THROUGH-MENU-MSG  PIC X(19)                     00420029
004300                                    VALUE  'ENTER THROUGH MENU '. 00430029
004400     05  PC-TRANS-UNAVAILABLE-MSG   PIC X(19)                     00440029
004500                                    VALUE  'TRANS NOT AVAILABLE'. 00450029
004600     05  PC-PLS-ENT-FLD-MSG         PIC X(19)                     00460029
004700                                    VALUE  'PLEASE ENTER FIELD '. 00470029
004800     05  PC-ENT-UPC-OR-SKU-MSG      PIC X(19)                     00480029
004900                                    VALUE  'ENTER UPC OR SKU   '. 00490029
005000     05  PC-MUST-BE-NUM-MSG         PIC X(19) VALUE               00500029
005100                                           'MUST BE NUMERIC    '. 00510029
005200     05  PC-INVALID-UPC-NBR-MSG     PIC X(19) VALUE               00520029
005300                                           'INVALID UPC NUMBER '. 00530029
005400     05  PC-INVALID-SKU-NBR-MSG     PIC X(19) VALUE               00540029
005500                                           'INVALID SKU NUMBER '. 00550029
005600     05  PC-UPC-NOT-IN-CTN-MSG      PIC X(19) VALUE               00560029
005700                                           'UPC NOT IN CTN/SKU '. 00570029
005800     05  PC-SKU-NOT-IN-CTN-MSG      PIC X(19) VALUE               00580029
005900                                           'SKU NOT IN CARTON  '. 00590029
006000     05  PC-UPD-SUCCESSFUL-MSG      PIC X(19) VALUE               00600029
006100                                           'UPDATE SUCCESSFUL  '. 00610029
006200* PROGRAM SWITCHES                                                00620029
006300*                                                                 00630029
006400 01  PS-PROGRAM-SWITCHES.                                         00640029
006500*                                                                 00650029
006600     05  PS-VALID-INPUT-SW               PIC  X(01)  VALUE 'Y'.   00660029
006700         88  PS-VALID-INPUT                          VALUE 'Y'.   00670029
006800         88  PS-INVALID-INPUT                        VALUE 'N'.   00680029
006900     05  PS-PACK-LINE-ENTRY-SW        PIC X(01) VALUE SPACE.      00690029
007000         88  PS-PACK-ENTRY                      VALUE 'P'.        00700029
007100         88  PS-LINE-ENTRY                      VALUE 'L'.        00710029
007200     05  PS-REMAINDER-SW                 PIC  X(01)  VALUE 'Y'.   00720029
007300         88  PS-REMAINDER                            VALUE 'Y'.   00730029
007400         88  PS-NO-REMAINDER                         VALUE 'N'.   00740029
007500*                                                                 00750029
007600     05  PS-UPC-FOUND-IN-CTN-SW          PIC  X(01)  VALUE 'Y'.   00760029
007700         88  PS-UPC-FOUND-IN-CTN                     VALUE 'Y'.   00770029
007800         88  PS-UPC-NOT-FOUND-IN-CTN                 VALUE 'N'.   00780029
007900     05  PS-SKU-FOUND-IN-CTN-SW          PIC  X(01)  VALUE 'Y'.   00790029
008000         88  PS-SKU-FOUND-IN-CTN                     VALUE 'Y'.   00800029
008100         88  PS-SKU-NOT-FOUND-IN-CTN                 VALUE 'N'.   00810029
008200*                                                                 00820029
008300     05  PS-TSUQADJ-INSERTED-SW          PIC  X(01).              00830029
008400         88  PS-TSUQADJ-INSERTED                     VALUE  'Y'.  00840029
008500         88  PS-TSUQADJ-NOT-INSERTED                 VALUE  'N'.  00850029
008600     05  PS-CART-UPC-UPDATED-SW          PIC  X(01).              00860029
008700         88  PS-CART-UPC-UPDATED                     VALUE  'Y'.  00870029
008800         88  PS-CART-UPC-NOT-UPDATED                 VALUE  'N'.  00880029
008900                                                                  00890029
009000     05  PS-JEWELRY-SW                PIC  X(01)  VALUE SPACE.    00900029
009100         88  PS-JEWELRY-NO                        VALUE 'N'.      00910029
009200         88  PS-JEWELRY-YES                       VALUE 'Y'.      00920029
009300                                                                  00930029
009400     05  PS-DO-UNIT-ADJ-SW            PIC X(01)   VALUE SPACE.    00940029
009500         88  PS-DO-UNIT-ADJ-YES                   VALUE 'Y'.      00950029
009600         88  PS-DO-UNIT-ADJ-NO                    VALUE 'N'.      00960029
009700*                                                                 00970029
009800*                                                                 00980029
009900* PROGRAM VARIABLES                                               00990029
010000*                                                                 01000029
010100 01  PV-PROGRAM-VARIABLES.                                        01010029
010200     05  PV-COMMAREA-LENGTH           PIC S9(04)  VALUE +0        01020029
010300                                                     COMP SYNC.   01030029
010400**  CHG0094517 CHANGED PO-NBR LENGTH FROM 7 TO 8                  01040032
010500     05  PV-PO-NBR                    PIC X(08) VALUE ZERO.       01050032
010600     05  PV-RCVR-SEQ-NBR              PIC X(04) VALUE ZERO.       01060029
010700     05  PV-PACK-NBR                  PIC X(04) VALUE ZERO.       01070029
010800     05  PV-LINE-NBR                  PIC X(04) VALUE ZERO.       01080029
010900     05  PV-UPC-DISP                  PIC 9(15).                  01090029
011000                                                                  01100029
011100     05  PV-CICS-MSG-AREA.                                        01110029
011200         10  PV-CICS-MSG-AREA1           PIC  X(80)  VALUE SPACE. 01120029
011300         10  PV-CICS-MSG-AREA2           PIC  X(80)  VALUE SPACE. 01130029
011400         10  PV-CICS-MSG-AREA3           PIC  X(80)  VALUE SPACE. 01140029
011500         10  PV-CICS-MSG-AREA4           PIC  X(80)  VALUE SPACE. 01150029
011600         10  PV-CICS-MSG-AREA5           PIC  X(80)  VALUE SPACE. 01160029
011700         10  PV-CICS-MSG-AREA6           PIC  X(80)  VALUE SPACE. 01170029
011800     05  PV-MESSAGE-AREA                 PIC  X(19)  VALUE SPACE. 01180029
011900     05  PV-RECEIVE-DATA                 PIC  X(01)  VALUE SPACE. 01190029
012000     05  PV-CICS-RESPONSE                PIC S9(09)  VALUE ZEROS  01200029
012100                                                     COMP SYNC.   01210029
012200     05  PV-TRANSFER-PROGRAM             PIC  X(08)  VALUE SPACE. 01220029
012300     05  PV-LEADING-0-COUNT              PIC S9(04)  VALUE ZERO   01230029
012400                                                     COMP.        01240029
012500     05  PV-UPC-LENGTH                   PIC S9(04)  VALUE ZERO   01250029
012600                                                     COMP.        01260029
012700     05  PV-UPC-E                        PIC  9(06)  VALUE ZERO.  01270029
012800     05  PV-RECORD-COUNT                 PIC S9(09)  VALUE ZEROS  01280029
012900                                                     COMP SYNC.   01290029
013000     05  PV-COUNT-IND                    PIC S9(04)  VALUE ZEROS  01300029
013100                                                     COMP SYNC.   01310029
013200     05  PV-SELECT-COUNTER               PIC S9(04)  VALUE ZEROS  01320029
013300                                                     COMP SYNC.   01330029
013400     05  PV-CHAR-COUNT                   PIC S9(04)  VALUE ZEROS  01340029
013500                                                     COMP SYNC.   01350029
013600     05  PV-WRITE-LENGTH                 PIC  9(04)  VALUE  80    01360029
013700                                                     COMP SYNC.   01370029
013800     05  PV-UNTS-IN-SKU                  PIC S9(09)  VALUE +0     01380029
013900                                                     COMP-3.      01390029
014000     05  PV-UNTS-IN-UPC                  PIC S9(09)  VALUE +0     01400029
014100                                                     COMP-3.      01410029
014200     05  PV-TOT-UNTS-IN-CTN              PIC S9(09)  VALUE +0     01420029
014300                                                     COMP-3.      01430029
014400     05  PV-SHIPT-UNT-ID                 PIC  S9(18) COMP-3.      01440029
014500     05  PV-REMAINDER                    PIC S9(04)  VALUE ZEROS  01450029
014600                                                     COMP SYNC.   01460029
014700     05  PV-ADJ-QTY                      PIC S9(4) COMP           01470029
014800                                              VALUE ZERO.         01480029
014900     05  PV-CURRENT-TMST                 PIC X(026).              01490029
015000     05  PV-ADJ-BY-QTY                   PIC S9(04)  VALUE ZEROS  01500029
015100                                                     COMP SYNC.   01510029
015200     05  PV-ADJ-TO-QTY                   PIC S9(04)  VALUE ZEROS  01520029
015300                                                     COMP SYNC.   01530029
015400*REDEFINE-NEED TO USE TEXT FIELD IN NUMERIC EDIT ROUTINE          01540029
015500     05  PV-ADJ-ENTERED-QTY              PIC  X(04) VALUE SPACE.  01550029
015600     05  PV-ADJ-ENTERED-QTY-R REDEFINES                           01560029
015700                                PV-ADJ-ENTERED-QTY.               01570029
015800         10  PV-ADJ-ENTERED-QUANTITY     PIC  ZZZ9.               01580029
015900                                                                  01590029
016000     05  PV-ADJ-ENTERED-QTY-N            PIC  9(04).              01600029
016100*                                                                 01610029
016200     05  PV-SKU-NBR.                                              01620029
016300         10  PV-SKU-NBR-N                PIC  9(08) VALUE ZEROES. 01630029
016400     05  PV-SKU-DESC                     PIC  X(15) VALUE SPACES. 01640029
016500     05  PV-PRC-RSN-CDE                  PIC  X(08).              01650029
016600     05  PV-USER-ID                      PIC  X(08).              01660029
016700     05  PV-OPER-UNT-ID                  PIC  S9(04) COMP.        01670029
016800     05  PV-ADJ-FUNC-CDE                 PIC  X(01).              01680029
016900     05  PV-ADJ-BEF-QTY                  PIC  S9(04) COMP.        01690029
017000     05  PV-SHPD-UNT-QTY                 PIC  S9(9)V  COMP-3.     01700029
017100     05  PV-NUMERIC-DUMMY                PIC  S9(03) COMP-3.      01710029
017200                                                                  01720029
017300     05  PV-FINCL-ADJ-ID                 PIC S9(9)   COMP SYNC.   01730029
017400                                                                  01740029
017500 01  PV-LOG-MSG.                                                  01750029
017600     05  FILLER                       PIC X(12) VALUE             01760029
017700         ' G900 ERROR '.                                          01770029
017800     05  FILLER                       PIC X(09) VALUE             01780029
017900         'SQLCODE= '.                                             01790029
018000     05  PV-SQLCODE                   PIC -9(03).                 01800029
018100     05  FILLER                       PIC X(06) VALUE             01810029
018200         ' ERR= '.                                                01820029
018300     05  PV-ERROR-NBR                 PIC 9(03) VALUE ZERO.       01830029
018400     05  FILLER                       PIC X(07) VALUE             01840029
018500         ' SML= '.                                                01850029
018600     05  PV-DISPLAY-SML               PIC X(18) VALUE ZEROES.     01860030
018700                                                                  01870029
018800     05  PV-ERROR-OPER                   PIC  9(04)  VALUE ZEROS. 01880029
018900     05  PV-ERROR-ORD-NBR                PIC  9(08)  VALUE ZEROS. 01890029
019000     05  PV-ERROR-RCVR-SEQ-NBR           PIC  9(04)  VALUE ZEROS. 01900029
019100     05  PV-ERROR-ORD-LNE-NBR            PIC  9(04)  VALUE ZEROS. 01910029
019200     05  PV-ERROR-STR-NBR                PIC  9(04)  VALUE ZEROS. 01920029
019300     05  PV-ERROR-QTY                    PIC  Z(09)  VALUE ZEROS. 01930029
019400     05  PV-ERROR-BEFORE                 PIC  Z(09)- VALUE ZEROS. 01940029
019500     05  PV-ERROR-AFTER                  PIC  Z(09)- VALUE ZEROS. 01950029
019600     05  PV-ERROR-ADJUST                 PIC  Z(09)- VALUE ZEROS. 01960029
019700                                                                  01970029
019800                                                                  01980029
019900*                                                                 01990029
020000*                                                                 02000029
020100* COMMAREA LAYOUT FOR PCRF85X SCREENS                             02010029
020200 01  CA-COMMAREA.                                                 02020029
020300     COPY PCWS033.                                                02030029
020400                                                                  02040029
020500* MAP LAYOUT                                                      02050029
020600     COPY PCKM900.                                                02060029
020700                                                                  02070029
020800*    RANDOM NUMBER GENERATOR                                      02080029
020900     COPY DPWS902.                                                02090029
021000                                                                  02100029
021100* HELP SCREEN COMMAREA                                            02110029
021200     COPY PCWS192.                                                02120029
021300                                                                  02130029
021400* HELP SCREEN WORK AREA                                           02140029
021500     COPY PCWS188.                                                02150029
021600                                                                  02160029
021700*    UNIT ADJUSTMENT MODULE SUKUT702                              02170029
021800     COPY SUWS035.                                                02180029
021900                                                                  02190029
022000* DOMAIN ITEM MODULE                                              02200029
022100     COPY XLWS001.                                                02210029
022200                                                                  02220029
022300* SENDING/RECEIVING AREA FOR THE NUMERIC EDIT ROUTINE (DPKUT100)  02230029
022400     COPY DPWS010I.                                               02240029
022500                                                                  02250029
022600* LAYOUT FOR THE ABEND MODULE COMMUNICATIONS AREA.                02260029
022700     COPY DPWS013.                                                02270029
022800                                                                  02280029
022900* KOHL'S STANDARD ATTRIBUTE AND PRINTER CONTROL CHARACTER LIST    02290029
023000     COPY DPWS015.                                                02300029
023100                                                                  02310029
023200* KOHL'S STANDARD ATTENTION IDENTIFIER LIST                       02320029
023300     COPY DFHAID.                                                 02330029
023400                                                                  02340029
023500* RECEIVER MASTER                                                 02350029
023600     EXEC SQL                                                     02360029
023700          INCLUDE TRECEIV                                         02370029
023800     END-EXEC.                                                    02380029
023900                                                                  02390029
024000* RECEIVER ITEM MASTER                                            02400029
024100     EXEC SQL                                                     02410029
024200          INCLUDE TRECITM                                         02420029
024300     END-EXEC.                                                    02430029
024400                                                                  02440029
024500* PACKSLIP MASTER                                                 02450029
024600     EXEC SQL                                                     02460029
024700          INCLUDE TPKSLIP                                         02470029
024800     END-EXEC.                                                    02480029
024900                                                                  02490029
025000* SHIPMENT OTBND-VND TABLE                                        02500029
025100     EXEC SQL                                                     02510029
025200          INCLUDE SUT00026                                        02520029
025300     END-EXEC.                                                    02530029
025400                                                                  02540029
025500* SHIPMENT OTBND-UPC TABLE                                        02550029
025600     EXEC SQL                                                     02560029
025700          INCLUDE SUT00028                                        02570029
025800     END-EXEC.                                                    02580029
025900                                                                  02590029
026000* XLT_SKU                                                         02600029
026100     EXEC SQL                                                     02610029
026200          INCLUDE XLT00003                                        02620029
026300     END-EXEC.                                                    02630029
026400                                                                  02640029
026500* XLT_UPC                                                         02650029
026600     EXEC SQL                                                     02660029
026700          INCLUDE XLT00006                                        02670029
026800     END-EXEC.                                                    02680029
026900                                                                  02690029
027000* PARM TABLE                                                      02700029
027100*    EXEC SQL                                                     02710029
027200*         INCLUDE TKRPRPM                                         02720029
027300*    END-EXEC.                                                    02730029
027400                                                                  02740029
027500* COMMUNICATIONS AREA FOR DB2                                     02750029
027600     EXEC SQL                                                     02760029
027700         INCLUDE SQLCA                                            02770029
027800     END-EXEC.                                                    02780029
027900*                                                                 02790029
028000 LINKAGE SECTION.                                                 02800029
028100 01  DFHCOMMAREA.                                                 02810029
028200     05  FILLER                       OCCURS 1 TO 4072 TIMES      02820029
028300                                      DEPENDING ON EIBCALEN.      02830029
028400         10  FILLER                   PIC X.                      02840029
028500/                                                                 02850029
028600 PROCEDURE DIVISION.                                              02860029
028700 0000-PROGRAM-MAINLINE.                                           02870029
028800                                                                  02880029
028900     INITIALIZE CA-COMMAREA                                       02890029
029000     MOVE DFHCOMMAREA                 TO CA-COMMAREA              02900029
029100                                                                  02910029
029200     EVALUATE TRUE                                                02920029
029300         WHEN EIBCALEN = ZERO                                     02930029
029400             MOVE PC-ENTER-THROUGH-MENU-MSG TO PV-MESSAGE-AREA    02940029
029500             PERFORM 8300-RETURN                                  02950029
029600                                                                  02960029
029700         WHEN EIBTRNID = 'Z278'                                   02970029
029800             MOVE DFHCOMMAREA         TO PC192-COMMAREA           02980029
029900             MOVE PC192-HOST-SAVE-AREA                            02990029
030000                                      TO CA-COMMAREA              03000029
030100             SET PC033-PROCESS-SCREEN TO TRUE                     03010029
030200             MOVE PC192-HOST-SAVE-MAP TO PC900AO                  03020029
030300             MOVE -1                  TO APOL                     03030029
030400             PERFORM 8000-SEND-MAP                                03040029
030500             PERFORM 8200-RETURN-TRANID                           03050029
030600                                                                  03060029
030700         WHEN PC033-INITIALIZE-SCREEN                             03070029
030800         WHEN EIBAID = DFHCLEAR                                   03080029
030900              SET PC033-PROCESS-SCREEN TO TRUE                    03090029
031000              PERFORM 1000-INITIALIZE                             03100029
031100              MOVE PC-CURRENT-PROGRAM-NAME                        03110029
031200                                    TO PC033-LAST-PROGRAM         03120029
031300              MOVE -1               TO APOL                       03130029
031400              PERFORM 8000-SEND-MAP                               03140029
031500              PERFORM 8200-RETURN-TRANID                          03150029
031600                                                                  03160029
031700         WHEN EIBAID = DFHENTER                                   03170029
031800             PERFORM 7000-SELECT-TRECEIV                          03180029
031900             IF RECEIV-PKGNG-CDE = 'M' OR 'I'                     03190029
032000                 MOVE 'PACK'                  TO AHDGO            03200029
032100                 SET PS-PACK-ENTRY            TO TRUE             03210029
032200             ELSE                                                 03220029
032300                 MOVE 'LINE'                  TO AHDGO            03230029
032400                 SET PS-LINE-ENTRY            TO TRUE             03240029
032500             END-IF                                               03250029
032600             PERFORM 2000-PROCESS-SCREEN-FIELDS                   03260029
032700             IF PS-INVALID-INPUT                                  03270029
032800                 PERFORM 8100-SEND-DATA-ONLY                      03280029
032900                 PERFORM 8200-RETURN-TRANID                       03290029
033000             ELSE                                                 03300029
033100                 MOVE 'PCKRF863'      TO PV-TRANSFER-PROGRAM      03310029
033200                 PERFORM 8220-XCTL-TO-SELECTED-PROGRAM            03320029
033300             END-IF                                               03330029
033400                                                                  03340029
033500         WHEN EIBAID = DFHPF1                                     03350029
033600             PERFORM 8010-RECEIVE-MAP                             03360029
033700             MOVE PC900AO             TO PC192-HOST-SAVE-MAP      03370029
033800             PERFORM 1200-HELP-SCREEN                             03380029
033900                                                                  03390029
034000*   RETURN TO PCKRF863                                            03400029
034100         WHEN EIBAID = DFHPF3                                     03410029
034200             MOVE 'PCKRF863'          TO PV-TRANSFER-PROGRAM      03420029
034300             PERFORM 8220-XCTL-TO-SELECTED-PROGRAM                03430029
034400                                                                  03440029
034500         WHEN OTHER                                               03450029
034600              MOVE PC-UNRECOGNIZED-PF-KEY-MSG TO AMSGLNO          03460029
034700              PERFORM 8100-SEND-DATA-ONLY                         03470029
034800              PERFORM 8200-RETURN-TRANID                          03480029
034900     END-EVALUATE.                                                03490029
035000                                                                  03500029
035100     GOBACK.                                                      03510029
035200*                                                                 03520029
035300*                                                                 03530029
035400 1000-INITIALIZE.                                                 03540029
035500     MOVE PC-TRANID                   TO PC033-TRAN-ID            03550029
035600                                                                  03560029
035700     IF PC033-UPC-ENTERED                                         03570029
035800         MOVE PC033-UPC-NBR           TO PV-UPC-DISP              03580029
035900         STRING 'UPC ' PV-UPC-DISP                                03590029
036000                 DELIMITED BY SIZE  INTO ATITLEO                  03600029
036100     ELSE                                                         03610029
036200         STRING 'SKU ' PC033-SKU-NBR                              03620029
036300                 DELIMITED BY SIZE  INTO ATITLEO                  03630029
036400     END-IF                                                       03640029
036500                                                                  03650029
036600     MOVE -1       TO APOL.                                       03660029
036700     MOVE PC033-PO-NBR                TO APOO                     03670029
036800                                                                  03680029
036900*    PC033-RCVR-SEQ-NBR-CTN IS THE ACTUAL RCVR VALUE IN           03690029
037000*               SUT_OTBND_UPC.  SOMETIMES THIS IS ZERO            03700029
037100*    PC033-RCVR-SEQ-NBR IS DERIVED FROM                           03710029
037200*               TPKSLIP WHEN PC033-RCVR-SEQ-NBR-CTN IS ZERO.      03720029
037300*    RC033-RCVR-SEQ-NBR-MAP IS WHAT IS SHOWN ON THE SCREEN        03730029
037400                                                                  03740029
037500     IF PC033-RCVR-SEQ-NBR-CTN = ZERO                             03750029
037600         MOVE PC033-RCVR-SEQ-NBR      TO ARCVRO                   03760029
037700                                         PC033-RCVR-SEQ-NBR-MAP   03770029
037800                                         DK-RCVR-SEQ-NBR          03780029
037900     ELSE                                                         03790029
038000         MOVE PC033-RCVR-SEQ-NBR-CTN  TO ARCVRO                   03800029
038100                                         PC033-RCVR-SEQ-NBR-MAP   03810029
038200                                         DK-RCVR-SEQ-NBR          03820029
038300     END-IF                                                       03830029
038400                                                                  03840029
038500     MOVE PC033-PO-LINE-NBR           TO  ALINEO.                 03850029
038600     PERFORM 7000-SELECT-TRECEIV                                  03860029
038700     IF RECEIV-PKGNG-CDE = 'M' OR 'I'                             03870029
038800         MOVE 'PACK'                  TO AHDGO                    03880029
038900         SET PS-PACK-ENTRY            TO TRUE                     03890029
039000     ELSE                                                         03900029
039100         MOVE 'LINE'                  TO AHDGO                    03910029
039200         SET PS-LINE-ENTRY            TO TRUE                     03920029
039300     END-IF.                                                      03930029
039400                                                                  03940029
039500*                                                                 03950029
039600*                                                                 03960029
039700 1200-HELP-SCREEN.                                                03970029
039800     MOVE 'DPKRF278'                  TO PV-TRANSFER-PROGRAM      03980029
039900     MOVE 'PCKRF900'                  TO PC192-PROGRAM-NAME       03990029
040000     COPY PCPD188.                                                04000029
040100     MOVE PC188-DISPLAY-DATE          TO PC192-DISPLAY-DATE.      04010029
040200     MOVE CA-COMMAREA                 TO PC192-HOST-SAVE-AREA     04020029
040300     PERFORM 8400-XCTL-TO-HELP.                                   04030029
040400*                                                                 04040029
040500*                                                                 04050029
040600 2000-PROCESS-SCREEN-FIELDS.                                      04060029
040700     PERFORM 8010-RECEIVE-MAP.                                    04070029
040800     PERFORM 2100-RECEIVE-SCREEN-FIELDS                           04080029
040900     PERFORM 2200-EDIT-INPUT.                                     04090029
041000     IF PS-VALID-INPUT                                            04100029
041100         PERFORM 3000-PROCESS                                     04110029
041200     END-IF.                                                      04120029
041300*                                                                 04130029
041400 2100-RECEIVE-SCREEN-FIELDS.                                      04140029
041500     IF  APOL > ZERO                                              04150029
041600         MOVE APOI                    TO PV-PO-NBR                04160029
041700     ELSE                                                         04170029
041800         IF APOA = DP015-ERASE-EOF                                04180029
041900             MOVE SPACES TO PV-PO-NBR                             04190029
042000         END-IF                                                   04200029
042100     END-IF.                                                      04210029
042200                                                                  04220029
042300     IF  ARCVRL > ZERO                                            04230029
042400         MOVE ARCVRI                  TO PV-RCVR-SEQ-NBR          04240029
042500     ELSE                                                         04250029
042600         IF ARCVRA = DP015-ERASE-EOF                              04260029
042700             MOVE SPACES              TO PV-RCVR-SEQ-NBR          04270029
042800         END-IF                                                   04280029
042900     END-IF.                                                      04290029
043000                                                                  04300029
043100     IF PS-LINE-ENTRY                                             04310029
043200         IF  ALINEL > ZERO                                        04320029
043300             MOVE ALINEI                  TO PV-LINE-NBR          04330029
043400         ELSE                                                     04340029
043500             IF ALINEA = DP015-ERASE-EOF                          04350029
043600                 MOVE SPACES              TO PV-LINE-NBR          04360029
043700             END-IF                                               04370029
043800         END-IF                                                   04380029
043900     ELSE                                                         04390029
044000         IF  ALINEL > ZERO                                        04400029
044100             MOVE ALINEI                  TO PV-PACK-NBR          04410029
044200         ELSE                                                     04420029
044300             IF ALINEA = DP015-ERASE-EOF                          04430029
044400                 MOVE SPACES              TO PV-PACK-NBR          04440029
044500             END-IF                                               04450029
044600         END-IF                                                   04460029
044700     END-IF.                                                      04470029
044800*                                                                 04480029
044900*                                                                 04490029
045000 2200-EDIT-INPUT.                                                 04500029
045100                                                                  04510029
045200     SET PS-VALID-INPUT   TO TRUE                                 04520029
045300     PERFORM 2210-EDIT-PO                                         04530029
045400                                                                  04540029
045500     PERFORM 2220-EDIT-RCVR                                       04550029
045600                                                                  04560029
045700     IF PS-PACK-ENTRY                                             04570029
045800         PERFORM 2230-EDIT-PACK                                   04580029
045900     ELSE                                                         04590029
046000         PERFORM 2240-EDIT-LINE                                   04600029
046100     END-IF.                                                      04610029
046200                                                                  04620029
046300     IF PS-INVALID-INPUT                                          04630029
046400         PERFORM 8100-SEND-DATA-ONLY                              04640029
046500         PERFORM 8200-RETURN-TRANID                               04650029
046600     END-IF.                                                      04660029
046700                                                                  04670029
046800/                                                                 04680029
046900 2210-EDIT-PO.                                                    04690029
047000     INITIALIZE DP010I-NUMERIC-EDIT-AREA                          04700029
047100     MOVE PV-PO-NBR                  TO DP010I-UNEDITED-FIELD     04710029
047200** CHG0094517  CHANGED NEXT LINE FROM 7 TO 8                      04720032
047300     MOVE 8                          TO DP010I-MAXIMUM-DIGITS     04730031
047400     MOVE 0                          TO DP010I-MAXIMUM-DECIMALS   04740029
047500     SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                      04750029
047600                                                                  04760029
047710     CALL DP010I-NUMERIC-EDIT-ROUTINE                             04771033
047720                         USING DP010I-NUMERIC-EDIT-AREA           04772033
047800     IF  DP010I-ERROR-DETECTED                                    04780029
047900         SET PS-INVALID-INPUT        TO TRUE                      04790029
048000         MOVE DP015-UNP-ALP-BRT-MDT  TO APOA                      04800029
048100         MOVE -1                     TO APOL                      04810029
048200         MOVE PC-MUST-BE-NUM-MSG     TO AMSGLNO                   04820029
048300*        PERFORM 8100-SEND-DATA-ONLY                              04830029
048400*        PERFORM 8200-RETURN-TRANID                               04840029
048500     ELSE                                                         04850029
048600         MOVE DP010I-NUMERIC-FIELD   TO PC033-PO-NBR              04860029
048700     END-IF.                                                      04870029
048800                                                                  04880029
048900     IF PC033-PO-NBR = ZERO                                       04890029
049000         SET PS-INVALID-INPUT        TO TRUE                      04900029
049100         MOVE DP015-UNP-ALP-BRT-MDT  TO APOA                      04910029
049200         MOVE -1                     TO APOL                      04920029
049300         MOVE 'REQUIRED ENTRY'       TO AMSGLNO                   04930029
049400     END-IF.                                                      04940029
049500                                                                  04950029
049600 2220-EDIT-RCVR.                                                  04960029
049700                                                                  04970029
049800     INITIALIZE DP010I-NUMERIC-EDIT-AREA                          04980029
049900     MOVE PV-RCVR-SEQ-NBR            TO DP010I-UNEDITED-FIELD     04990029
050000     MOVE 4                          TO DP010I-MAXIMUM-DIGITS     05000029
050100     MOVE 0                          TO DP010I-MAXIMUM-DECIMALS   05010029
050200     SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                      05020029
050300                                                                  05030029
050410     CALL DP010I-NUMERIC-EDIT-ROUTINE                             05041033
050420                         USING DP010I-NUMERIC-EDIT-AREA           05042033
050500     IF  DP010I-ERROR-DETECTED                                    05050029
050600         SET PS-INVALID-INPUT        TO TRUE                      05060029
050700         MOVE DP015-UNP-ALP-BRT-MDT  TO ARCVRA                    05070029
050800         MOVE -1                     TO ARCVRL                    05080029
050900         MOVE PC-MUST-BE-NUM-MSG TO AMSGLNO                       05090029
051000*        PERFORM 8100-SEND-DATA-ONLY                              05100029
051100*        PERFORM 8200-RETURN-TRANID                               05110029
051200     ELSE                                                         05120029
051300         MOVE DP010I-NUMERIC-FIELD   TO PC033-RCVR-SEQ-NBR-MAP    05130029
051400                                        DK-RCVR-SEQ-NBR           05140029
051500     END-IF.                                                      05150029
051600                                                                  05160029
051700     IF PC033-RCVR-SEQ-NBR-MAP = ZERO                             05170029
051800         SET PS-INVALID-INPUT        TO TRUE                      05180029
051900         MOVE DP015-UNP-ALP-BRT-MDT  TO ARCVRA                    05190029
052000         MOVE -1                     TO ARCVRL                    05200029
052100         MOVE 'REQUIRED ENTRY'       TO AMSGLNO                   05210029
052200     ELSE                                                         05220029
052300         MOVE PC033-RCVR-SEQ-NBR-MAP TO PC033-RCVR-SEQ-NBR        05230029
052400     END-IF.                                                      05240029
052500                                                                  05250029
052600                                                                  05260029
052700 2230-EDIT-PACK.                                                  05270029
052800                                                                  05280029
052900     INITIALIZE DP010I-NUMERIC-EDIT-AREA                          05290029
053000     MOVE PV-PACK-NBR                TO DP010I-UNEDITED-FIELD     05300029
053100     MOVE 4                          TO DP010I-MAXIMUM-DIGITS     05310029
053200     MOVE 0                          TO DP010I-MAXIMUM-DECIMALS   05320029
053300     SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                      05330029
053400                                                                  05340029
053510     CALL DP010I-NUMERIC-EDIT-ROUTINE                             05351033
053520                         USING DP010I-NUMERIC-EDIT-AREA           05352033
053600     IF  DP010I-ERROR-DETECTED                                    05360029
053700         SET PS-INVALID-INPUT        TO TRUE                      05370029
053800         MOVE DP015-UNP-ALP-BRT-MDT  TO ALINEA                    05380029
053900         MOVE -1                     TO ALINEL                    05390029
054000         MOVE PC-MUST-BE-NUM-MSG TO AMSGLNO                       05400029
054100     ELSE                                                         05410029
054200         MOVE DP010I-NUMERIC-FIELD   TO PC033-PO-PREPK-ID         05420029
054300     END-IF.                                                      05430029
054400                                                                  05440029
054500     IF PC033-PO-PREPK-ID = ZERO                                  05450029
054600         SET PS-INVALID-INPUT        TO TRUE                      05460029
054700         MOVE DP015-UNP-ALP-BRT-MDT  TO ALINEA                    05470029
054800         MOVE -1                     TO ALINEL                    05480029
054900         MOVE 'REQUIRED ENTRY'       TO AMSGLNO                   05490029
055000     END-IF.                                                      05500029
055100                                                                  05510029
055200                                                                  05520029
055300 2240-EDIT-LINE.                                                  05530029
055400                                                                  05540029
055500     INITIALIZE DP010I-NUMERIC-EDIT-AREA                          05550029
055600     MOVE PV-LINE-NBR                TO DP010I-UNEDITED-FIELD     05560029
055700     MOVE 4                          TO DP010I-MAXIMUM-DIGITS     05570029
055800     MOVE 0                          TO DP010I-MAXIMUM-DECIMALS   05580029
055900     SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                      05590029
056000                                                                  05600029
056110     CALL DP010I-NUMERIC-EDIT-ROUTINE                             05611033
056120                         USING DP010I-NUMERIC-EDIT-AREA           05612033
056200     IF  DP010I-ERROR-DETECTED                                    05620029
056300         SET PS-INVALID-INPUT        TO TRUE                      05630029
056400         MOVE DP015-UNP-ALP-BRT-MDT  TO ALINEA                    05640029
056500         MOVE -1                     TO ALINEL                    05650029
056600         MOVE PC-MUST-BE-NUM-MSG TO AMSGLNO                       05660029
056700     ELSE                                                         05670029
056800         MOVE DP010I-NUMERIC-FIELD   TO PC033-PO-LINE-NBR         05680029
056900     END-IF.                                                      05690029
057000                                                                  05700029
057100     IF PC033-PO-LINE-NBR = ZERO                                  05710029
057200         SET PS-INVALID-INPUT        TO TRUE                      05720029
057300         MOVE DP015-UNP-ALP-BRT-MDT  TO ALINEA                    05730029
057400         MOVE -1                     TO ALINEL                    05740029
057500         MOVE 'REQUIRED ENTRY'       TO AMSGLNO                   05750029
057600     END-IF.                                                      05760029
057700                                                                  05770029
057800 3000-PROCESS.                                                    05780029
057900     IF PS-PACK-ENTRY                                             05790029
058000         IF PC033-PO-PREPK-ID > ZERO                              05800029
058100             PERFORM 3100-GET-SKU                                 05810029
058200         END-IF                                                   05820029
058300     END-IF.                                                      05830029
058400                                                                  05840029
058500     IF PC033-UPC-ENTERED                                         05850029
058600         IF PC033-RCVR-SEQ-NBR-CTN = ZERO                         05860029
058700*            FIND THE RCVR-NBR IN THE INBOUND TABLES              05870029
058800*            THE RESULT GOES TO PC033-RCVR-SEQ-NBR                05880029
058900             PERFORM 7200-SELECT-TPKSLIP                          05890029
059000*            IF PC033-RCVR-SEQ-NBR-MAP NOT = PC033-RCVR-SEQ-NBR   05900029
059100*                SET PS-INVALID-INPUT        TO TRUE              05910029
059200*                MOVE DP015-UNP-ALP-BRT-MDT  TO ARCVRA            05920029
059300*                MOVE -1                     TO ARCVRL            05930029
059400*                MOVE 'REQUIRED ENTRY'       TO AMSGLNO           05940029
059500*            ELSE                                                 05950029
059600                 PERFORM 7100-SELECT-OTBND-UPC                    05960029
059700*            END-IF                                               05970029
059800         ELSE                                                     05980029
059900             PERFORM 7100-SELECT-OTBND-UPC                        05990029
060000         END-IF                                                   06000029
060100     ELSE                                                         06010029
060200         PERFORM 3200-FIND-SKU-IN-CTN                             06020029
060300     END-IF.                                                      06030029
060400                                                                  06040029
060500 3100-GET-SKU.                                                    06050029
060600                                                                  06060029
060700     INITIALIZE XL001-ITEM-COMMAREA                               06070029
060800     SET XL001-SELECT-SKU                                         06080029
060900         XL001-SELECT-UPC                                         06090029
061000         XL001-BY-NUMERIC-SKU         TO TRUE                     06100029
061100                                                                  06110029
061200     MOVE PC033-SKU-NBR-N             TO XL001-KEY-SKU            06120029
061300                                                                  06130029
061400     PERFORM 8600-CALL-XLKUT001.                                  06140029
061500                                                                  06150029
061600     EVALUATE TRUE                                                06160029
061700         WHEN XL001-SKU-SQLCODE = ZERO                            06170029
061800         WHEN XL001-SKU-SQLCODE = -811                            06180029
061900         WHEN XL001-SKU-SQLCODE = +100                            06190029
062000             MOVE XL001-ITM-NBR       TO RECITM-ITM-NBR           06200029
062100         WHEN OTHER                                               06210029
062200             MOVE 1                   TO PV-ERROR-NBR             06220029
062300                                         PC033-ERROR-NBR          06230029
062400             PERFORM 9903-WRITE-CICS-LOG                          06240029
062500             MOVE '3100-GET-SKU'      TO PC033-PARAGRAPH          06250029
062600             MOVE 'PCKRF900 '         TO PC033-MESSAGE-TEXT(1)    06260029
062700             MOVE 'XLKUT001'          TO PC033-MESSAGE-TEXT(2)    06270029
062800             MOVE SQLCA               TO PC033-SQLCA              06280029
062900             SET PC033-ABEND          TO TRUE                     06290029
063000             MOVE 99                  TO PC033-PGM-MSG-NBR        06300029
063100             PERFORM 8210-XCTL-ERROR-SCREEN                       06310029
063200     END-EVALUATE.                                                06320029
063300                                                                  06330029
063400     MOVE PC033-PO-PREPK-ID           TO RECITM-PREPK-ID          06340029
063500     PERFORM 7050-SELECT-TRECITM.                                 06350029
063600                                                                  06360029
063700 3200-FIND-SKU-IN-CTN.                                            06370029
063800                                                                  06380029
063900     INITIALIZE XL001-ITEM-COMMAREA                               06390029
064000     SET XL001-SELECT-UPC                                         06400029
064100         XL001-BY-NUMERIC-SKU         TO TRUE                     06410029
064200                                                                  06420029
064300     MOVE PC033-SKU-NBR-N             TO XL001-KEY-SKU            06430029
064400                                                                  06440029
064500     PERFORM 8600-CALL-XLKUT001.                                  06450029
064600                                                                  06460029
064700     EVALUATE TRUE                                                06470029
064800         WHEN XL001-SKU-SQLCODE = ZERO                            06480029
064900         WHEN XL001-SKU-SQLCODE = -811                            06490029
065000             MOVE XL001-UPC-NBR       TO PC033-UPC-NBR            06500029
065100             PERFORM 7150-SELECT-OTBND-UPC                        06510029
065200             IF SQLCODE = +100                                    06520029
065300                 PERFORM 7200-SELECT-TPKSLIP                      06530029
065400                 IF SQLCODE = +100                                06540029
065500                     SET PS-INVALID-INPUT        TO TRUE          06550029
065600                     MOVE DP015-UNP-ALP-BRT-MDT  TO ALINEA        06560029
065700                     MOVE -1                     TO ALINEL        06570029
065800                     MOVE PC-SKU-NOT-IN-CTN-MSG  TO AMSGLNO       06580029
065900                     PERFORM 8100-SEND-DATA-ONLY                  06590029
066000                     PERFORM 8200-RETURN-TRANID                   06600029
066100                 END-IF                                           06610029
066200             END-IF                                               06620029
066300         WHEN XL001-SKU-SQLCODE = +100                            06630029
066400             CONTINUE                                             06640029
066500         WHEN OTHER                                               06650029
066600             MOVE 2                   TO PV-ERROR-NBR             06660029
066700                                         PC033-ERROR-NBR          06670029
066800             PERFORM 9903-WRITE-CICS-LOG                          06680029
066900             MOVE '3100-GET-SKU'      TO PC033-PARAGRAPH          06690029
067000             MOVE 'PCKRF900 '         TO PC033-MESSAGE-TEXT(1)    06700029
067100             MOVE 'XLKUT001'          TO PC033-MESSAGE-TEXT(2)    06710029
067200             MOVE SQLCA               TO PC033-SQLCA              06720029
067300             SET PC033-ABEND          TO TRUE                     06730029
067400             MOVE 99                  TO PC033-PGM-MSG-NBR        06740029
067500             PERFORM 8210-XCTL-ERROR-SCREEN                       06750029
067600     END-EVALUATE.                                                06760029
067700                                                                  06770029
067800 7000-SELECT-TRECEIV.                                             06780029
067900                                                                  06790029
068000     EXEC SQL                                                     06800029
068100         SELECT PKGNG_CDE                                         06810029
068200         INTO :RECEIV-PKGNG-CDE                                   06820029
068300         FROM TRECEIV                                             06830029
068400         WHERE                                                    06840029
068500                 ORD_NBR              = :PC033-PO-NBR             06850029
068600             AND REC_SEQ_NBR          = :DK-RCVR-SEQ-NBR          06860029
068700             AND VER_STATUS_CDE       = 'A'                       06870029
068800     END-EXEC.                                                    06880029
068900                                                                  06890029
069000     EVALUATE TRUE                                                06900029
069100         WHEN SQLCODE = ZERO                                      06910029
069200         WHEN SQLCODE = +100                                      06920029
069300             CONTINUE                                             06930029
069400         WHEN SQLCODE = -904                                      06940029
069500         WHEN SQLCODE = -913                                      06950029
069600         WHEN SQLCODE = -911                                      06960029
069700             MOVE 03                  TO PV-ERROR-NBR             06970029
069800             PERFORM 9903-WRITE-CICS-LOG                          06980029
069900             PERFORM 9000-SOFT-ABORT                              06990029
070000         WHEN SQLWARN0 NOT = SPACES                               07000029
070100         WHEN SQLCODE < +0                                        07010029
070200         WHEN SQLCODE > +0                                        07020029
070300             MOVE 04                  TO PV-ERROR-NBR             07030029
070400                                         PC033-ERROR-NBR          07040029
070500             PERFORM 9903-WRITE-CICS-LOG                          07050029
070600             MOVE '7000-SELECT-TRECEIV'                           07060029
070700                                      TO PC033-PARAGRAPH          07070029
070800             MOVE 'PCKRF900 - ERROR SELECTING PKGNG-TYPE'         07080029
070900                                      TO PC033-MESSAGE-TEXT(1)    07090029
071000             MOVE SQLCA               TO PC033-SQLCA              07100029
071100             MOVE 'TRECEIV'           TO PC033-DB2-TABLE-NAME(1)  07110029
071200             SET PC033-ABEND          TO TRUE                     07120029
071300             MOVE 99                  TO PC033-PGM-MSG-NBR        07130029
071400             PERFORM 8210-XCTL-ERROR-SCREEN                       07140029
071500     END-EVALUATE.                                                07150029
071600                                                                  07160029
071700 7050-SELECT-TRECITM.                                             07170029
071800                                                                  07180029
071900     INITIALIZE RECITM-ORD-LNE-NBR                                07190029
072000                                                                  07200029
072100     EXEC SQL                                                     07210029
072200         SELECT ORD_LNE_NBR                                       07220029
072300         INTO :RECITM-ORD-LNE-NBR                                 07230029
072400         FROM TRECITM                                             07240029
072500         WHERE                                                    07250029
072600                 ORD_NBR              = :PC033-PO-NBR             07260029
072700             AND REC_SEQ_NBR          = :DK-RCVR-SEQ-NBR          07270029
072800             AND ITM_NBR              = :RECITM-ITM-NBR           07280029
072900             AND PREPK_ID             = :RECITM-PREPK-ID          07290029
073000             AND VER_STATUS_CDE       = 'A'                       07300029
073100     END-EXEC.                                                    07310029
073200                                                                  07320029
073300     EVALUATE TRUE                                                07330029
073400         WHEN SQLCODE = ZERO                                      07340029
073500             MOVE RECITM-ORD-LNE-NBR    TO PC033-PO-LINE-NBR      07350029
073600                                                                  07360029
073700         WHEN SQLCODE = +100                                      07370029
073800             SET PS-INVALID-INPUT        TO TRUE                  07380029
073900             MOVE DP015-UNP-ALP-BRT-MDT  TO ALINEA                07390029
074000             MOVE -1                     TO ALINEL                07400029
074100             MOVE 'ITM NOT PART OF PACK' TO AMSGLNO               07410029
074200             PERFORM 8100-SEND-DATA-ONLY                          07420029
074300             PERFORM 8200-RETURN-TRANID                           07430029
074400                                                                  07440029
074500         WHEN SQLCODE = -904                                      07450029
074600         WHEN SQLCODE = -913                                      07460029
074700         WHEN SQLCODE = -911                                      07470029
074800             MOVE 05                  TO PV-ERROR-NBR             07480029
074900             PERFORM 9903-WRITE-CICS-LOG                          07490029
075000             PERFORM 9000-SOFT-ABORT                              07500029
075100         WHEN SQLWARN0 NOT = SPACES                               07510029
075200         WHEN SQLCODE < +0                                        07520029
075300         WHEN SQLCODE > +0                                        07530029
075400             MOVE 06                  TO PV-ERROR-NBR             07540029
075500                                         PC033-ERROR-NBR          07550029
075600             PERFORM 9903-WRITE-CICS-LOG                          07560029
075700             MOVE '7050-SELECT-TRECITM'                           07570029
075800                                      TO PC033-PARAGRAPH          07580029
075900             MOVE 'PCKRF900 - ERROR SELECTING LINE NBR'           07590029
076000                                      TO PC033-MESSAGE-TEXT(1)    07600029
076100             MOVE SQLCA               TO PC033-SQLCA              07610029
076200             MOVE 'TRECITM'           TO PC033-DB2-TABLE-NAME(1)  07620029
076300             SET PC033-ABEND          TO TRUE                     07630029
076400             MOVE 99                  TO PC033-PGM-MSG-NBR        07640029
076500             PERFORM 8210-XCTL-ERROR-SCREEN                       07650029
076600     END-EVALUATE.                                                07660029
076700                                                                  07670029
076800 7100-SELECT-OTBND-UPC.                                           07680029
076900                                                                  07690029
077000     EXEC SQL                                                     07700029
077100         SELECT UPC_NBR                                           07710029
077200         INTO :SUT00028-UPC-NBR                                   07720029
077300         FROM SUT_OTBND_UPC                                       07730029
077400         WHERE                                                    07740029
077500                 SHIPT_UNT_ID         = :PC033-CARTON             07750029
077600             AND TRN_NBR              = :PC033-PO-NBR             07760029
077700             AND RCVR_SEQ_NBR         = :DK-RCVR-SEQ-NBR          07770029
077800             AND TRN_LNE_NBR          = :PC033-PO-LINE-NBR        07780029
077900             AND UPC_NBR              = :PC033-UPC-NBR            07790029
078000     END-EXEC.                                                    07800029
078100                                                                  07810029
078200     EVALUATE TRUE                                                07820029
078300         WHEN SQLCODE = ZERO                                      07830029
078400             MOVE PC033-RCVR-SEQ-NBR    TO PC033-RCVR-SEQ-NBR-CTN 07840029
078500                                                                  07850029
078600         WHEN SQLCODE = +100                                      07860029
078700             SET PS-INVALID-INPUT        TO TRUE                  07870029
078800             MOVE DP015-UNP-ALP-BRT-MDT  TO APOA                  07880029
078900                                            ARCVRA                07890029
079000                                            ALINEA                07900029
079100             MOVE -1                     TO ALINEL                07910029
079200             MOVE 'ITM NOT IN CARTON'    TO AMSGLNO               07920029
079300             PERFORM 8100-SEND-DATA-ONLY                          07930029
079400             PERFORM 8200-RETURN-TRANID                           07940029
079500                                                                  07950029
079600         WHEN SQLCODE = -904                                      07960029
079700         WHEN SQLCODE = -913                                      07970029
079800         WHEN SQLCODE = -911                                      07980029
079900             MOVE 07                  TO PV-ERROR-NBR             07990029
080000             PERFORM 9903-WRITE-CICS-LOG                          08000029
080100             PERFORM 9000-SOFT-ABORT                              08010029
080200         WHEN SQLWARN0 NOT = SPACES                               08020029
080300         WHEN SQLCODE < +0                                        08030029
080400         WHEN SQLCODE > +0                                        08040029
080500             MOVE 08                  TO PV-ERROR-NBR             08050029
080600                                         PC033-ERROR-NBR          08060029
080700             PERFORM 9903-WRITE-CICS-LOG                          08070029
080800             MOVE '7100-SELECT-OTBND-UPC'                         08080029
080900                                      TO PC033-PARAGRAPH          08090029
081000             MOVE 'PCKRF900 - ERROR SELECTING LINE NBR'           08100029
081100                                      TO PC033-MESSAGE-TEXT(1)    08110029
081200             MOVE SQLCA               TO PC033-SQLCA              08120029
081300             MOVE 'SUT_OTBND_UPC'     TO PC033-DB2-TABLE-NAME(1)  08130029
081400             SET PC033-ABEND          TO TRUE                     08140029
081500             MOVE 99                  TO PC033-PGM-MSG-NBR        08150029
081600             PERFORM 8210-XCTL-ERROR-SCREEN                       08160029
081700     END-EVALUATE.                                                08170029
081800/                                                                 08180029
081900 7150-SELECT-OTBND-UPC.                                           08190029
082000                                                                  08200029
082100     EXEC SQL                                                     08210029
082200         SELECT                                                   08220029
082300             UPC_NBR                                              08230029
082400         INTO                                                     08240029
082500             :SUT00028-UPC-NBR                                    08250029
082600         FROM SUT_OTBND_UPC                                       08260029
082700         WHERE                                                    08270029
082800                 SHIPT_UNT_ID         = :PC033-CARTON             08280029
082900             AND TRN_NBR              = :PC033-PO-NBR             08290029
083000             AND RCVR_SEQ_NBR         = :DK-RCVR-SEQ-NBR          08300029
083100             AND TRN_LNE_NBR          = :PC033-PO-LINE-NBR        08310029
083200             AND UPC_NBR              = :PC033-UPC-NBR            08320029
083300     END-EXEC.                                                    08330029
083400                                                                  08340029
083500     EVALUATE TRUE                                                08350029
083600         WHEN SQLCODE = ZERO                                      08360029
083700             MOVE PC033-RCVR-SEQ-NBR TO PC033-RCVR-SEQ-NBR-CTN    08370029
083800         WHEN SQLCODE = -811                                      08380029
083900             CONTINUE                                             08390029
084000                                                                  08400029
084100         WHEN SQLCODE = +100                                      08410029
084200             CONTINUE                                             08420029
084300*            SET PS-INVALID-INPUT        TO TRUE                  08430029
084400*            MOVE DP015-UNP-ALP-BRT-MDT  TO ALINEA                08440029
084500*            MOVE -1                     TO ALINEL                08450029
084600*            MOVE 'ITM NOT IN CARTON'    TO AMSGLNO               08460029
084700*            PERFORM 8100-SEND-DATA-ONLY                          08470029
084800*            PERFORM 8200-RETURN-TRANID                           08480029
084900                                                                  08490029
085000         WHEN SQLCODE = -904                                      08500029
085100         WHEN SQLCODE = -913                                      08510029
085200         WHEN SQLCODE = -911                                      08520029
085300             MOVE 09                  TO PV-ERROR-NBR             08530029
085400             PERFORM 9903-WRITE-CICS-LOG                          08540029
085500             PERFORM 9000-SOFT-ABORT                              08550029
085600         WHEN SQLWARN0 NOT = SPACES                               08560029
085700         WHEN SQLCODE < +0                                        08570029
085800         WHEN SQLCODE > +0                                        08580029
085900             MOVE 10                  TO PV-ERROR-NBR             08590029
086000                                         PC033-ERROR-NBR          08600029
086100             PERFORM 9903-WRITE-CICS-LOG                          08610029
086200             MOVE '7150-SELECT-OTBND-UPC'                         08620029
086300                                      TO PC033-PARAGRAPH          08630029
086400             MOVE 'PCKRF900 - ERROR SELECTING LINE NBR'           08640029
086500                                      TO PC033-MESSAGE-TEXT(1)    08650029
086600             MOVE SQLCA               TO PC033-SQLCA              08660029
086700             MOVE 'SUT_OTBND_UPC'     TO PC033-DB2-TABLE-NAME(1)  08670029
086800             SET PC033-ABEND          TO TRUE                     08680029
086900             MOVE 99                  TO PC033-PGM-MSG-NBR        08690029
087000             PERFORM 8210-XCTL-ERROR-SCREEN                       08700029
087100     END-EVALUATE.                                                08710029
087200                                                                  08720029
087300 7200-SELECT-TPKSLIP.                                             08730029
087400                                                                  08740029
087500     INITIALIZE PKSLIP-REC-SEQ-NBR                                08750029
087600                                                                  08760029
087700     EXEC SQL                                                     08770029
087800         SELECT C.REC_SEQ_NBR                                     08780029
087900         INTO :PKSLIP-REC-SEQ-NBR                                 08790029
088000         FROM                                                     08800029
088100             SUT_OTBND_UPC A                                      08810029
088200         ,   SUT_OTBND_VND B                                      08820029
088300         ,   TPKSLIP       C                                      08830029
088400*        ,   XLT_UPC       D                                      08840029
088500         WHERE                                                    08850029
088600                 A.SHIPT_UNT_ID       = :PC033-CARTON             08860029
088700             AND A.TRN_NBR            = :PC033-PO-NBR             08870029
088800             AND A.TRN_LNE_NBR        = :PC033-PO-LINE-NBR        08880029
088900             AND A.UPC_NBR            = :PC033-UPC-NBR            08890029
089000             AND A.SHIPT_UNT_ID       = B.SHIPT_UNT_ID            08900029
089100             AND B.PO_NBR             = C.PO_NBR                  08910029
089200             AND B.PKSL_SEQ_NBR       = C.SEQ_NBR                 08920029
089300             AND C.VER_STAT_CDE       = 'A'                       08930029
089400*            AND A.UPC_NBR              = D.UPC_NBR               08940029
089500*            AND D.INTR_UPC_ID          = :XL001-INTR-UPC-ID      08950029
089600     END-EXEC.                                                    08960029
089700                                                                  08970029
089800     EVALUATE TRUE                                                08980029
089900         WHEN SQLCODE = ZERO                                      08990029
090000             MOVE PKSLIP-REC-SEQ-NBR  TO PC033-RCVR-SEQ-NBR       09000029
090100                                                                  09010029
090200         WHEN SQLCODE = +100                                      09020029
090300             CONTINUE                                             09030029
090400             SET PS-INVALID-INPUT        TO TRUE                  09040029
090500             MOVE DP015-UNP-ALP-BRT-MDT  TO ALINEA                09050029
090600             MOVE -1                     TO ALINEL                09060029
090700             MOVE PC-SKU-NOT-IN-CTN-MSG  TO AMSGLNO               09070029
090800             PERFORM 8100-SEND-DATA-ONLY                          09080029
090900             PERFORM 8200-RETURN-TRANID                           09090029
091000                                                                  09100029
091100         WHEN SQLCODE = -904                                      09110029
091200         WHEN SQLCODE = -913                                      09120029
091300         WHEN SQLCODE = -911                                      09130029
091400             MOVE 11                  TO PV-ERROR-NBR             09140029
091500             PERFORM 9903-WRITE-CICS-LOG                          09150029
091600             PERFORM 9000-SOFT-ABORT                              09160029
091700         WHEN SQLWARN0 NOT = SPACES                               09170029
091800         WHEN SQLCODE < +0                                        09180029
091900         WHEN SQLCODE > +0                                        09190029
092000             MOVE 12                  TO PV-ERROR-NBR             09200029
092100                                         PC033-ERROR-NBR          09210029
092200             PERFORM 9903-WRITE-CICS-LOG                          09220029
092300             MOVE '7200-SELECT-TPKSLIP'                           09230029
092400                                      TO PC033-PARAGRAPH          09240029
092500             MOVE 'PCKRF900 - ERROR SELECTING LINE NBR'           09250029
092600                                      TO PC033-MESSAGE-TEXT(1)    09260029
092700             MOVE SQLCA               TO PC033-SQLCA              09270029
092800             MOVE 'SUT_OTBND_UPC'     TO PC033-DB2-TABLE-NAME(1)  09280029
092900             SET PC033-ABEND          TO TRUE                     09290029
093000             MOVE 99                  TO PC033-PGM-MSG-NBR        09300029
093100             PERFORM 8210-XCTL-ERROR-SCREEN                       09310029
093200     END-EVALUATE.                                                09320029
093300/                                                                 09330029
093400 8000-SEND-MAP.                                                   09340029
093500     EXEC CICS                                                    09350029
093600         SEND MAP       ('PC900A')                                09360029
093700              MAPSET    ('PCKM900')                               09370029
093800              ERASE                                               09380029
093900              CURSOR                                              09390029
094000              RESP      (PV-CICS-RESPONSE)                        09400029
094100     END-EXEC.                                                    09410029
094200                                                                  09420029
094300     EVALUATE TRUE                                                09430029
094400         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 09440029
094500             CONTINUE                                             09450029
094600         WHEN OTHER                                               09460029
094700             MOVE '8000-SEND-MAP'      TO DP013-PARAGRAPH         09470029
094800             MOVE 'UNABLE TO SEND MAP' TO DP013-MESSAGE-TEXT (1)  09480029
094900             SET DP013-CICS-ABEND      TO TRUE                    09490029
095000             SET DP013-NO-ROLLBACK     TO TRUE                    09500029
095100             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               09510029
095200     END-EVALUATE.                                                09520029
095300                                                                  09530029
095400 8010-RECEIVE-MAP.                                                09540029
095500     EXEC CICS                                                    09550029
095600         RECEIVE MAP    ('PC900A')                                09560029
095700                 MAPSET ('PCKM900')                               09570029
095800                 RESP   (PV-CICS-RESPONSE)                        09580029
095900     END-EXEC.                                                    09590029
096000                                                                  09600029
096100     EVALUATE TRUE                                                09610029
096200         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 09620029
096300             CONTINUE                                             09630029
096400         WHEN PV-CICS-RESPONSE = DFHRESP (MAPFAIL)                09640029
096500             CONTINUE                                             09650029
096600         WHEN OTHER                                               09660029
096700            MOVE '8010-RECEIVE-MAP'      TO DP013-PARAGRAPH       09670029
096800            MOVE 'UNABLE TO RECEIVE MAP' TO DP013-MESSAGE-TEXT (1)09680029
096900            SET DP013-LOGIC-ABEND        TO TRUE                  09690029
097000            SET DP013-NO-ROLLBACK        TO TRUE                  09700029
097100            PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG                09710029
097200     END-EVALUATE.                                                09720029
097300*                                                                 09730029
097400*                                                                 09740029
097500*                                                                 09750029
097600 8100-SEND-DATA-ONLY.                                             09760029
097700     EXEC CICS                                                    09770029
097800         SEND MAP       ('PC900A')                                09780029
097900              MAPSET    ('PCKM900')                               09790029
098000              CURSOR                                              09800029
098100              DATAONLY                                            09810029
098200              RESP      (PV-CICS-RESPONSE)                        09820029
098300     END-EXEC.                                                    09830029
098400                                                                  09840029
098500     EVALUATE TRUE                                                09850029
098600         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 09860029
098700             CONTINUE                                             09870029
098800         WHEN OTHER                                               09880029
098900             MOVE '8100-SEND-DATA-ONLY' TO DP013-PARAGRAPH        09890029
099000             MOVE 'UNABLE TO SEND DATA' TO DP013-MESSAGE-TEXT (1) 09900029
099100             SET DP013-CICS-ABEND       TO TRUE                   09910029
099200             SET DP013-NO-ROLLBACK      TO TRUE                   09920029
099300             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               09930029
099400     END-EVALUATE.                                                09940029
099500*                                                                 09950029
099600*                                                                 09960029
099700 8200-RETURN-TRANID.                                              09970029
099800     MOVE LENGTH OF CA-COMMAREA TO PC-COMMAREA-LENGTH             09980029
099900     EXEC CICS                                                    09990029
100000         RETURN TRANSID  (PC-TRANID)                              10000029
100100                COMMAREA (CA-COMMAREA)                            10010029
100200                LENGTH   (PC-COMMAREA-LENGTH)                     10020029
100300                RESP     (PV-CICS-RESPONSE)                       10030029
100400     END-EXEC.                                                    10040029
100500                                                                  10050029
100600     EVALUATE TRUE                                                10060029
100700         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 10070029
100800             CONTINUE                                             10080029
100900         WHEN OTHER                                               10090029
101000             MOVE '8200-RETURN-TRANIND' TO DP013-PARAGRAPH        10100029
101100             MOVE 'UNABLE TO RETURN TO TRANID'                    10110029
101200                 TO DP013-MESSAGE-TEXT (1)                        10120029
101300             SET DP013-CICS-ABEND       TO TRUE                   10130029
101400             SET DP013-NO-ROLLBACK      TO TRUE                   10140029
101500             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               10150029
101600     END-EVALUATE.                                                10160029
101700*                                                                 10170029
101800*                                                                 10180029
101900 8210-XCTL-ERROR-SCREEN.                                          10190029
102000     IF NOT PC033-ABEND                                           10200029
102100         SET PC033-INITIALIZE-SCREEN  TO TRUE                     10210029
102200     END-IF                                                       10220029
102300     MOVE DFHEIBLK                    TO PC033-DFHEIBLK.          10230029
102400     MOVE PC-CURRENT-PROGRAM-NAME     TO PC033-LAST-PROGRAM.      10240029
102500     MOVE LENGTH OF CA-COMMAREA       TO PV-COMMAREA-LENGTH       10250029
102600     MOVE 'PCKRF852'                  TO PV-TRANSFER-PROGRAM      10260029
102700     IF PC033-PGM-MSG-NBR = ZERO                                  10270029
102800         MOVE 3                       TO PC033-PGM-MSG-NBR        10280029
102900     END-IF                                                       10290029
103000                                                                  10300029
103100     EXEC CICS                                                    10310029
103200         XCTL  PROGRAM   (PV-TRANSFER-PROGRAM)                    10320029
103300               COMMAREA  (CA-COMMAREA)                            10330029
103400               LENGTH    (PV-COMMAREA-LENGTH)                     10340029
103500               RESP      (PV-CICS-RESPONSE)                       10350029
103600     END-EXEC.                                                    10360029
103700                                                                  10370029
103800     EVALUATE TRUE                                                10380029
103900         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 10390029
104000             CONTINUE                                             10400029
104100         WHEN OTHER                                               10410029
104200             MOVE '8200-XCTL'                                     10420029
104300                                      TO DP013-PARAGRAPH          10430029
104400             MOVE 'PCKRF900 - UNABLE TO XCTL TO PROGRAM: '        10440029
104500                                      TO DP013-MESSAGE-TEXT (1)   10450029
104600             MOVE PV-TRANSFER-PROGRAM TO DP013-MESSAGE-TEXT (2)   10460029
104700             SET DP013-CICS-ABEND                                 10470029
104800                 DP013-ROLLBACK       TO TRUE                     10480029
104900             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               10490029
105000             MOVE PC-TRANS-UNAVAILABLE-MSG                        10500029
105100                                      TO AMSGLNO                  10510029
105200             SET PC033-PROCESS-SCREEN TO TRUE                     10520029
105300             PERFORM 8000-SEND-MAP                                10530029
105400             PERFORM 8200-RETURN-TRANID                           10540029
105500     END-EVALUATE.                                                10550029
105600                                                                  10560029
105700                                                                  10570029
105800 8220-XCTL-TO-SELECTED-PROGRAM.                                   10580029
105900     SET PC033-INITIALIZE-SCREEN     TO TRUE.                     10590029
106000     MOVE PC-CURRENT-PROGRAM-NAME TO PC033-LAST-PROGRAM.          10600029
106100                                                                  10610029
106200     MOVE LENGTH OF CA-COMMAREA TO PC-COMMAREA-LENGTH             10620029
106300     EXEC CICS                                                    10630029
106400         XCTL  PROGRAM   (PV-TRANSFER-PROGRAM)                    10640029
106500               COMMAREA  (CA-COMMAREA)                            10650029
106600               LENGTH    (PC-COMMAREA-LENGTH)                     10660029
106700               RESP      (PV-CICS-RESPONSE)                       10670029
106800     END-EXEC.                                                    10680029
106900                                                                  10690029
107000     EVALUATE TRUE                                                10700029
107100         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 10710029
107200             CONTINUE                                             10720029
107300         WHEN OTHER                                               10730029
107400             MOVE '8220-XCTL-TO-SELECTED-PROGRAM'                 10740029
107500                 TO DP013-PARAGRAPH                               10750029
107600             MOVE 'UNABLE TO XCTL TO PROGRAM: '                   10760029
107700                 TO DP013-MESSAGE-TEXT (1)                        10770029
107800             MOVE PV-TRANSFER-PROGRAM                             10780029
107900                 TO DP013-MESSAGE-TEXT (2)                        10790029
108000             SET DP013-CICS-ABEND  TO TRUE                        10800029
108100             SET DP013-NO-ROLLBACK TO TRUE                        10810029
108200             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               10820029
108300             MOVE PC-TRANS-UNAVAILABLE-MSG TO AMSGLNO             10830029
108400             SET PC033-PROCESS-SCREEN TO TRUE                     10840029
108500             PERFORM 8000-SEND-MAP                                10850029
108600             PERFORM 8200-RETURN-TRANID                           10860029
108700     END-EVALUATE.                                                10870029
108800*                                                                 10880029
108900*                                                                 10890029
109000 8300-RETURN.                                                     10900029
109100     EXEC CICS                                                    10910029
109200         SEND FROM (PV-MESSAGE-AREA)                              10920029
109300              LENGTH (19)                                         10930029
109400              ERASE                                               10940029
109500     END-EXEC.                                                    10950029
109600                                                                  10960029
109700     EXEC CICS                                                    10970029
109800         RETURN                                                   10980029
109900     END-EXEC.                                                    10990029
110000*                                                                 11000029
110100*                                                                 11010029
110200 8400-XCTL-TO-HELP.                                               11020029
110300     MOVE LENGTH OF PC192-COMMAREA    TO PC-COMMAREA-LENGTH       11030029
110400                                                                  11040029
110500     EXEC CICS                                                    11050029
110600         XCTL                                                     11060029
110700             PROGRAM   (PV-TRANSFER-PROGRAM)                      11070029
110800             COMMAREA  (PC192-COMMAREA)                           11080029
110900             LENGTH    (PC-COMMAREA-LENGTH)                       11090029
111000             RESP      (PV-CICS-RESPONSE)                         11100029
111100     END-EXEC.                                                    11110029
111200                                                                  11120029
111300     EVALUATE TRUE                                                11130029
111400         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 11140029
111500              CONTINUE                                            11150029
111600         WHEN OTHER                                               11160029
111700             MOVE '8400-XCTL-TO-HELP' TO DP013-PARAGRAPH          11170029
111800             MOVE 'PCKRF900 - UNABLE TO XCTL TO PROGRAM: '        11180029
111900                                      TO DP013-MESSAGE-TEXT (1)   11190029
112000             MOVE PV-TRANSFER-PROGRAM TO DP013-MESSAGE-TEXT (2)   11200029
112100             SET DP013-CICS-ABEND                                 11210029
112200                 DP013-ROLLBACK       TO TRUE                     11220029
112300             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               11230029
112400             MOVE PC-TRANS-UNAVAILABLE-MSG                        11240029
112500                                      TO AMSGLNO                  11250029
112600             SET PC033-PROCESS-SCREEN TO TRUE                     11260029
112700             MOVE -1                  TO APOL                     11270029
112800             PERFORM 8000-SEND-MAP                                11280029
112900             PERFORM 8200-RETURN-TRANID                           11290029
113000     END-EVALUATE.                                                11300029
113100/                                                                 11310029
113200 8600-CALL-XLKUT001.                                              11320029
113300       CALL XL001-VSM-PGM      USING DFHEIBLK                     11330029
113400                                XL001-COMMAREA                    11340029
113500                                XL001-ITEM-COMMAREA.              11350029
113600                                                                  11360029
113700       EVALUATE TRUE                                              11370029
113800           WHEN XL001-SUCCESSFUL                                  11380029
113900           WHEN XL001-SKU-NOT-FOUND                               11390029
114000           WHEN XL001-UPC-NOT-FOUND                               11400029
114100           WHEN XL001-UPC-CONTENTION                              11410029
114200           WHEN XL001-SKU-CONTENTION                              11420029
114300               CONTINUE                                           11430029
114400           WHEN XL001-SQL-ERROR                                   11440029
114500           WHEN XL001-INVALID-ACCESS                              11450029
114600               MOVE '8600-LINK-XLKUT001' TO DP013-PARAGRAPH       11460029
114700               MOVE 'PCKRF900 - DB2 ERROR IN PROGRAM: '           11470029
114800                                        TO DP013-MESSAGE-TEXT (1) 11480029
114900               MOVE 'XLKUT001'          TO DP013-MESSAGE-TEXT (2) 11490029
115000               SET DP013-CICS-ABEND                               11500029
115100                   DP013-ROLLBACK           TO TRUE               11510029
115200               PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG             11520029
115300               MOVE PC-TRANS-UNAVAILABLE-MSG                      11530029
115400                                        TO AMSGLNO                11540029
115500               SET PC033-PROCESS-SCREEN TO TRUE                   11550029
115600               PERFORM 8000-SEND-MAP                              11560029
115700               PERFORM 8200-RETURN-TRANID                         11570029
115800           WHEN OTHER                                             11580029
115900               MOVE '8600-LINK-XLKUT001' TO DP013-PARAGRAPH       11590029
116000               MOVE 'PCKRF900 - UNDETERMINED ERROR IN PGM: '      11600029
116100                                        TO DP013-MESSAGE-TEXT (1) 11610029
116200               MOVE 'XLKUT001'          TO DP013-MESSAGE-TEXT (2) 11620029
116300               SET DP013-CICS-ABEND                               11630029
116400                   DP013-ROLLBACK           TO TRUE               11640029
116500               PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG             11650029
116600               MOVE PC-TRANS-UNAVAILABLE-MSG                      11660029
116700                                        TO AMSGLNO                11670029
116800               SET PC033-PROCESS-SCREEN TO TRUE                   11680029
116900               PERFORM 8000-SEND-MAP                              11690029
117000               PERFORM 8200-RETURN-TRANID                         11700029
117100       END-EVALUATE.                                              11710029
117200/                                                                 11720029
117300 9000-SOFT-ABORT.                                                 11730029
117400                                                                  11740029
117500     EXEC CICS                                                    11750029
117600         SYNCPOINT ROLLBACK                                       11760029
117700     END-EXEC                                                     11770029
117800                                                                  11780029
117900     MOVE 4                           TO PC033-PGM-MSG-NBR        11790029
118000     MOVE SQLCODE                     TO PC033-SQLCODE            11800029
118100     PERFORM 8210-XCTL-ERROR-SCREEN.                              11810029
118200                                                                  11820029
118300                                                                  11830029
118400 9903-WRITE-CICS-LOG.                                             11840029
118500                                                                  11850029
118600     MOVE SQLCODE                     TO PV-SQLCODE               11860029
118700     MOVE PC033-CARTON                TO PV-DISPLAY-SML           11870029
118800                                                                  11880029
118900     EXEC CICS                                                    11890029
119000         WRITEQ TD                                                11900029
119100             QUEUE  ('CSSL')                                      11910029
119200             FROM   (PV-LOG-MSG)                                  11920029
119300             RESP   (PV-CICS-RESPONSE)                            11930029
119400     END-EXEC.                                                    11940029
119500                                                                  11950029
119600 9903A-WRITE-CICS.                                                11960029
119700     EXEC CICS                                                    11970029
119800         WRITEQ TD                                                11980029
119900         QUEUE('CSSL')                                            11990029
120000         FROM(PV-CICS-MSG-AREA)                                   12000029
120100         RESP(PV-CICS-RESPONSE)                                   12010029
120200     END-EXEC.                                                    12020029
120300                                                                  12030029
120400     MOVE SPACES TO PV-CICS-MSG-AREA.                             12040029
120500*                                                                 12050029
120600 9990-WRITE-CICS.                                                 12060029
120700     EXEC CICS                                                    12070029
120800         WRITEQ TD                                                12080029
120900         QUEUE('CSSL')                                            12090029
121000         FROM(PV-CICS-MSG-AREA)                                   12100029
121100         RESP(PV-CICS-RESPONSE)                                   12110029
121200     END-EXEC.                                                    12120029
121300                                                                  12130029
121400     MOVE SPACES TO PV-CICS-MSG-AREA.                             12140029
121500                                                                  12150029
121600 9999-WRITE-MESSAGE-TO-CICS-LOG.                                  12160029
121700     MOVE PC-CURRENT-PROGRAM-NAME  TO DP013-PROGRAM.              12170029
121800     MOVE DFHEIBLK                 TO DP013-DFHEIBLK.             12180029
121900     INITIALIZE DP013-SRC-TASK-NUMBER                             12190029
122000                DP013-STACK.                                      12200029
122100     SET DP013-LINK-RETURN TO TRUE.                               12210029
122200                                                                  12220029
122300     EXEC CICS                                                    12230029
122400         LINK                                                     12240029
122500             PROGRAM   (DP013-NAME)                               12250029
122600             COMMAREA  (DP013-PARAMETERS)                         12260029
122700             LENGTH    (DP013-LENGTH)                             12270029
122800     END-EXEC.                                                    12280029
