000100 IDENTIFICATION DIVISION.                                         00010012
000200                                                                  00020012
000300 PROGRAM-ID.    RVKCS111.                                         00030012
000400 AUTHOR.        M. FURLICK.                                       00040012
000500 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00050012
000600 DATE-WRITTEN.  12-02-92.                                         00060012
000700 DATE-COMPILED.                                                   00070012
000800                                                                  00080012
000900*----------------------------------------------------------------*00090012
001000*                                                                *00100012
001100*    T111 - REQUEST FOR RA CRITERIA (RVSREQRA)                   *00110012
001200*                                                                *00120012
001300*    THERE ARE 4 DATA ENTERABLE FIELDS ON THIS SELECTION SCREEN: *00130012
001400*          RA NUMBER, DEPT NUMBER, STATUS, AND VENDOR NAME.      *00140012
001500*                                                                *00150012
001600*    ONLY ONE OF THESE FIELDS MAY BE ENTERED.  VALIDATION CON-   *00160012
001700*    SISTS OF THAT, NUMERIC DATA FOR RA AND DEPT NUMBERS.        *00170012
001800*                                                                *00180012
001900*----------------------------------------------------------------*00190012
002000******************************************************************00200012
002100* 11/17/2003  VANETTE FITZGERALD                       WR 223568 *00210012
002200*      - RTV ENHANCEMENT PROJECT      ADD NEW STATUSES           *00220012
002300*                                                                *00230012
002310* 10/30/2011  STEVE ANDERSON - CODEWORKS               WR 40134  *00231054
002320*      - PROJECT # 3219: GENCO / RTV UPGRADE                     *00232055
002330*      - CHANGE WHERE CLAUSE IN JOIN/SELECT AGAINST TABLES       *00233055
002340*        XLT_LOC AND  XLT_DC_LOC_ASGMT SO THAT RTV LOCATION      *00234055
002350*        INFORMATION IS RETURNED.                                *00235055
002360*      - ALSO CHANGE CODE SO THAT THE OVERRIDE LOCATION NUMBER   *00236055
002370*        THAT CAN BE ENTERED ON THE INITIAL MENU IS NO LONGER    *00237055
002380*        CARRIED OVER TO THE MAP/PROGRAM                         *00238055
002390******************************************************************00239055
002500 ENVIRONMENT DIVISION.                                            00250012
002600                                                                  00260012
002700 DATA DIVISION.                                                   00270012
002800                                                                  00280012
002900 WORKING-STORAGE SECTION.                                         00290012
003000                                                                  00300012
003100 01  DK-DB2-KEYS.                                                 00310012
003200     05  DK-OPER-UNT-ID                 PIC S9(04)  VALUE ZEROS   00320022
003300                                                    COMP SYNC.    00330022
003500                                                                  00350012
003600 01  PC-PROGRAM-CONSTANTS.                                        00360012
003700     05  PC-KOHLS-OPERATING-COMPANY     PIC X(02)    VALUE '03'.  00370012
003800     05  PC-NAVIGATOR-TRAN-ID           PIC X(04)    VALUE 'Z008'.00380012
003900     05  PC-MAXIMUM-COMMAREA-LENGTH     PIC S9(04)   VALUE +4072  00390012
004000                                                     COMP SYNC.   00400012
004100     05  PC-CURRENT-MAP-NAME            PIC X(08)    VALUE        00410012
004200     'RV111A  '.                                                  00420012
004300     05  PC-CURRENT-MAPSET-NAME         PIC X(08)    VALUE        00430012
004400     'RVKM111 '.                                                  00440012
004500     05  PC-CURRENT-PROGRAM-NAME        PIC X(08)    VALUE        00450012
004600     'RVKCS111'.                                                  00460012
004700     05  PC-MAX-RETRIES                 PIC 9(02)    VALUE  3.    00470012
004800     05  PC-ERASE-EOF-COMP              PIC S9(04)   VALUE +128   00480012
004900                                                     COMP SYNC.   00490012
005000     05  FILLER REDEFINES PC-ERASE-EOF-COMP.                      00500012
005100         10  FILLER                     PIC X(01).                00510012
005200         10  PC-ERASE-EOF               PIC X(01).                00520012
005300     05  PC-COMPANY                     PIC X(02)    VALUE '03'.  00530012
005400     05  PC-S                           PIC X(01)    VALUE 'S'.   00540012
005500     05  PC-ASTERISK                    PIC X(01)    VALUE '*'.   00550012
005600     05  PC-TSYMSG-NUMBERS.                                       00560012
005700         10 PC-TSYMSG-00005             PIC 9(05)    VALUE 00005. 00570012
005800         10 PC-TSYMSG-00007             PIC 9(05)    VALUE 00007. 00580012
005900         10 PC-TSYMSG-00036             PIC 9(05)    VALUE 00036. 00590012
006000         10 PC-TSYMSG-00045             PIC 9(05)    VALUE 00045. 00600012
006100         10 PC-TSYMSG-00047             PIC 9(05)    VALUE 00047. 00610012
006200         10 PC-TSYMSG-00807             PIC 9(05)    VALUE 00807. 00620012
006300         10 PC-TSYMSG-01111             PIC 9(05)    VALUE 01111. 00630012
006400                                                                  00640012
006500 01  PM-PROGRAM-MESSAGES.                                         00650012
006600     05  PM-PROGRAM-MESSAGE-1           PIC X(78)    VALUE        00660012
006700     'INVALID NEXT APPLICATION ACTIVITY RECEIVED'.                00670012
006800                                                                  00680012
006900 01  PS-PROGRAM-SWITCHES.                                         00690012
007000     05  PS-MAP-SEND-TYPE               PIC X(01)    VALUE '1'.   00700012
007100         88  PS-SEND-MAP-N-DATA-FRSET                VALUE '1'.   00710012
007200         88  PS-SEND-MAP-N-DATA-FRSET-CPOSN          VALUE '2'.   00720012
007300         88  PS-SEND-DATA-ONLY-FRSET                 VALUE '3'.   00730012
007400         88  PS-SEND-DATA-ONLY                       VALUE '4'.   00740012
007500         88  PS-SEND-DATA-ONLY-ERASEAUP              VALUE '5'.   00750012
007600         88  PS-SEND-MAP-ONLY-FRSET                  VALUE '6'.   00760012
007700     05  PS-ERROR-SW                    PIC X(01)    VALUE 'N'.   00770012
007800         88  PS-ERROR                                VALUE 'Y'.   00780012
007900         88  PS-NO-ERROR                             VALUE 'N'.   00790012
008000     05  PS-MNEMONIC-SW                 PIC X(01)    VALUE 'N'.   00800012
008100         88  PS-MNEMONIC-ERROR                       VALUE 'Y'.   00810012
008200         88  PS-NO-MNEMONIC-ERROR                    VALUE 'N'.   00820012
008300     05  PS-ASTERISK-FOUND-SW           PIC X(01)    VALUE 'N'.   00830012
008400         88  PS-ASTERISK-FOUND                       VALUE 'Y'.   00840012
008500         88  PS-NO-ASTERISK-FOUND                    VALUE 'N'.   00850012
008600     05  PS-EDIT-ERROR-IND              PIC X(01)    VALUE 'N'.   00860012
008700         88  PS-NO-EDIT-ERROR                        VALUE 'N'.   00870012
008800         88  PS-EDIT-ERROR                           VALUE 'Y'.   00880012
008900                                                                  00890012
009000 01  PV-PROGRAM-VARIABLES.                                        00900012
009100     05  PV-CICS-RESPONSE               PIC S9(04)   VALUE +0     00910012
009200                                                     COMP SYNC.   00920012
009300     05  PV-NAV-MNEMONIC                PIC X(08)    VALUE SPACES.00930012
009400     05  PV-MESSAGE                     PIC X(78)    VALUE SPACES.00940012
009500     05  PV-COUNT                       PIC S9(3)    VALUE ZERO   00950012
009600                                                     COMP-3.      00960012
009700     05  PV-DISP-OPER-UNT-ID-X.                                   00970055
009800         10  PV-DISP-OPER-UNT-ID        PIC 9(4)  VALUE ZEROS.    00980055
010000 EJECT                                                            01000012
010100*---------------------------------------------------------------* 01010012
010200*    MESSAGE LAYOUT COPYBOOK.                                   * 01020012
010300*---------------------------------------------------------------* 01030012
010400                                                                  01040012
010500     COPY DPWS006.                                                01050012
010600                                                                  01060012
010700***************************************************************** 01070012
010800*    STANDARD COMMAREA.                                           01080012
010900***************************************************************** 01090012
011000                                                                  01100012
011100     COPY DPWS020.                                                01110012
011200                                                                  01120012
011300     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                01130012
011400                                                                  01140012
011500                                                                  01150012
011600***************************************************************** 01160012
011700*    INTER-APPLICATION COMMAREA.                                  01170012
011800***************************************************************** 01180012
011900                                                                  01190012
012000         10  INTER-APPL-COMM-AREA       PIC X(200).               01200012
012100                                                                  01210012
012200     COPY RVWS100.                                                01220012
012300                                                                  01230012
012400***************************************************************** 01240012
012500*    APPLICATION SPECIFIC COMMAREA                                01250012
012600***************************************************************** 01260012
012700                                                                  01270012
012800         10  RV111-SPECIFIC-COMMAREA.                             01280012
012900             15  FILLER                      PIC X(02).           01290012
013000             15  RV111-REQUEST-DATA.                              01300012
013100                                                                  01310012
013200                 20  RV111-OPER-UNT-ID.                           01320012
013300                     25  RV111-OPER-UNT-ID-N PIC 9(04).           01330012
013400                                                                  01340012
013500                 20  RV111-RA-NUMBER.                             01350012
013600                     25  RV111-RA-NUMBER-N   PIC 9(12).           01360057
013700                                                                  01370012
013800                 20  RV111-TYPE-CDE          PIC X(1).            01380012
013900                     88 RV111-VALID-TYPE-CDE VALUE                01390012
014000                        'M', 'R', 'D', 'C'.                       01400012
014100                     88 RV111-MARKOUT-TYPE   VALUE 'M'.           01410012
014200                     88 RV111-RTV-TYPE       VALUE 'R'.           01420012
014300                     88 RV111-D-AND-D-TYPE   VALUE 'D'.           01430012
014400                     88 RV111-CALL-BACK-TYPE VALUE 'C'.           01440012
014500                 20  RV111-TYPE-DESC         PIC X(15).           01450012
014600                 20  RV111-STATUS-CDE        PIC X(1).            01460012
014700                     88 RV111-VALID-STATUS-CDE                    01470012
014800                        VALUE 'N', 'O', 'C', 'S', 'P', 'A', 'D'.  01480024
014900                     88 RV111-VALID-MKOUT-STATUS                  01490012
015000                        VALUE  'N', 'O', 'P', 'S', 'A'.           01500024
015100                     88 RV111-VALID-D-AND-D-STATUS                01510012
015200                        VALUE  'N', 'O', 'D', 'S', 'A'.           01520024
015300                     88 RV111-VALID-RTV-STATUS                    01530012
015400                        VALUE 'N', 'O', 'C', 'S', 'A'.            01540024
015500                     88 RV111-VALID-CALL-BACK-STATUS              01550012
015600                        VALUE 'N', 'O', 'C', 'S', 'A'.            01560024
015700                     88 RV111-NEW-STAT       VALUE 'N'.           01570012
015800                     88 RV111-OPEN-STAT      VALUE 'O'.           01580012
015900                     88 RV111-CLOSE-STAT     VALUE 'C'.           01590012
016000                     88 RV111-SHIP-STAT      VALUE 'S'.           01600012
016100                     88 RV111-PEND-STAT      VALUE 'P'.           01610012
016200                     88 RV111-APPROVE-STAT   VALUE 'A'.           01620012
016300                     88 RV111-D-AND-D-STAT   VALUE 'D'.           01630012
016400                 20  RV111-STATUS-DESC       PIC X(15).           01640012
016500                 20  RV111-LOCATION          PIC X(15).           01650012
016600                                                                  01660012
016700                 20  RV111-VENDOR-NAME       PIC X(25).           01670012
016800                                                                  01680012
016900             15  RV111-STORE-NAME            PIC X(24).           01690012
017000             15  RV111-SAVE-INTER-APPL-COMM  PIC X(200).          01700012
017100             15  RV111-RESTORE-SW            PIC X(01).           01710012
017200                 88  RV111-RESTORE-COMMAREA             VALUE 'Y'.01720012
017300                 88  RV111-DONT-RESTORE-COMMAREA        VALUE 'N'.01730012
017400             15  FILLER                      PIC X(200).          01740012
017500***************************************************************** 01750012
017600*    ABEND PROCESSING COPYBOOK.                                   01760012
017700***************************************************************** 01770012
017800                                                                  01780012
017900     COPY DPWS013.                                                01790012
018000                                                                  01800012
018100***************************************************************** 01810012
018200*    NUMERIC FIELD EDIT ROUTINE WORKING STORAGE                   01820012
018300***************************************************************** 01830012
018400                                                                  01840012
018500     COPY DPWS010I.                                               01850012
018600                                                                  01860012
018700***************************************************************** 01870012
018800*    ATTRIBUTE SETTINGS COPYBOOK.                                 01880012
018900***************************************************************** 01890012
019000                                                                  01900012
019100     COPY DPWS015.                                                01910012
019200                                                                  01920012
019300***************************************************************** 01930012
019400*    CURRENT DATE AND TIME COPYBOOK.                              01940012
019500***************************************************************** 01950012
019600                                                                  01960012
019700     COPY DPWS017.                                                01970012
019800                                                                  01980012
019900***************************************************************** 01990012
020000*    TOGGLE FUNCTION KEY LINES COPYBOOK.                          02000012
020100***************************************************************** 02010012
020200                                                                  02020012
020300     COPY DPWS009.                                                02030012
020400                                                                  02040012
020500***************************************************************** 02050012
020600*    FUNCTION KEYS COPYBOOK.                                      02060012
020700***************************************************************** 02070012
020800                                                                  02080012
020900     COPY DPWS016.                                                02090012
021000                                                                  02100012
021100***************************************************************** 02110012
021200*    DPKUT045 COPYBOOK.                                           02120012
021300***************************************************************** 02130012
021400                                                                  02140012
021500     COPY DPWS045.                                                02150012
021600                                                                  02160012
021700     COPY DPRD507I.                                               02170012
021800 EJECT                                                            02180012
021900                                                                  02190012
022000******************************************************************02200055
022100*   LOGISTICS DOMAIN LOCATION TABLE                               02210055
022200******************************************************************02220055
022300      EXEC SQL                                                    02230055
022400          INCLUDE XLT00010                                        02240055
022500      END-EXEC.                                                   02250055
022600 EJECT                                                            02260055
022700******************************************************************02270055
022710*   LOGISTICS DOMAIN DC LOCATION ASSIGNMENT TABLE                 02271055
022720******************************************************************02272055
022730      EXEC SQL                                                    02273055
022740          INCLUDE XLT00014                                        02274055
022750      END-EXEC.                                                   02275055
022760 EJECT                                                            02276055
022800***************************************************************** 02280012
022900*  STANDARD LAYOUT FOR THE SQL COMMUNICATIONS AREA                02290012
023000***************************************************************** 02300012
023100                                                                  02310012
023200     EXEC SQL                                                     02320012
023300         INCLUDE SQLCA                                            02330012
023400     END-EXEC.                                                    02340012
023500                                                                  02350012
023600***************************************************************** 02360012
023700*    STANDARD ATTENTION IDENTIFIER LIST                           02370012
023800***************************************************************** 02380012
023900                                                                  02390012
024000     COPY DFHAID.                                                 02400012
024100                                                                  02410012
024200***************************************************************** 02420012
024300*    STANDARD ATTRIBUTE AND PRINTER CONTROL CHARACTER LIST        02430012
024400***************************************************************** 02440012
024500                                                                  02450012
024600     COPY DFHBMSCA.                                               02460012
024700                                                                  02470012
024800***************************************************************** 02480012
024900*    MAP LAYOUT                                                   02490012
025000***************************************************************** 02500012
025100                                                                  02510012
025200     COPY RVKM111.                                                02520012
025300                                                                  02530012
025400 01  MD-MAP-DATA-AREA REDEFINES RV111AO.                          02540012
025500     05  FILLER                         PIC X(700).               02550012
025600 EJECT                                                            02560012
025700 LINKAGE SECTION.                                                 02570012
025800                                                                  02580012
025900 01  DFHCOMMAREA.                                                 02590012
026000     05  FILLER                         OCCURS  1 TO 4072 TIMES   02600012
026100                                        DEPENDING ON EIBCALEN.    02610012
026200         10  FILLER                     PIC X.                    02620012
026300                                                                  02630012
026400     EJECT                                                        02640012
026500 PROCEDURE DIVISION.                                              02650012
026600                                                                  02660012
026700 0000-MAIN-MODULE.                                                02670012
026800                                                                  02680012
026900*----------------------------------------------------------------*02690012
027000*    PROCESS THIS TRANSACTION IF THE COMMAREA IS VALID.          *02700012
027100*----------------------------------------------------------------*02710012
027200                                                                  02720012
027300     PERFORM DP015-0000-CHECK-COMMAREA.                           02730012
027400                                                                  02740012
027500*----------------------------------------------------------------*02750012
027600*    DP020-SRC-RETURN-W-TRAN-ID WILL BE TRUE IF THIS PROGRAM WAS *02760012
027700*    SENT A STANDARD COMMAREA. IF NOT SET TRUE (MEANING OTHER    *02770012
027800*    THAN A STANDARD COMMAREA WAS SENT TO THIS PROGRAM, THIS     *02780012
027900*    PROGRAM WILL RETURN TO CISS.                                *02790012
028000*----------------------------------------------------------------*02800012
028100     IF DP020-SRC-RETURN-W-TRAN-ID                                02810012
028200         PERFORM 1000-CONTROL-PROCESSING                          02820012
028300     END-IF.                                                      02830012
028400                                                                  02840012
028500     PERFORM DP003-0000-RETURN-TO-CICS.                           02850012
028600 EJECT                                                            02860012
028700 1000-CONTROL-PROCESSING.                                         02870012
028800                                                                  02880012
028900*----------------------------------------------------------------*02890012
029000*    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT   *02900012
029100*    COURSE OF ACTION IS FOR THIS TRANSACTION.                   *02910012
029200*                                                                *02920012
029300*    PERFORMED BY 0000-MAIN-MODULE.                              *02930012
029400*----------------------------------------------------------------*02940012
029500                                                                  02950012
029600     EVALUATE TRUE                                                02960012
029700                                                                  02970012
029800         WHEN DP020-NEXT-ACT-INITIAL                              02980012
029900             SET PS-SEND-MAP-N-DATA-FRSET TO TRUE                 02990012
030000             INITIALIZE RV111-SPECIFIC-COMMAREA                   03000012
030100             MOVE INTER-APPL-COMM-AREA                            03010012
030200                                 TO RV111-SAVE-INTER-APPL-COMM    03020012
030300             INITIALIZE RV100-INTER-APPL-COMMAREA                 03030012
030400             PERFORM 2000-BUILD-INITIAL-PANEL                     03040012
030500                                                                  03050012
030600         WHEN DP020-NEXT-ACT-READ-MAP                             03060012
030700             PERFORM 3000-PROCESS-PANEL                           03070012
030800                                                                  03080012
030900         WHEN DP020-NEXT-ACT-RETURN                               03090012
031000             SET PS-SEND-MAP-N-DATA-FRSET TO TRUE                 03100012
031100             IF  RV111-RESTORE-COMMAREA                           03110012
031200                 MOVE RV111-SAVE-INTER-APPL-COMM                  03120012
031300                                 TO  INTER-APPL-COMM-AREA         03130012
031400             END-IF                                               03140012
031500             PERFORM 2200-DISPLAY-PANEL                           03150012
031600                                                                  03160012
031700         WHEN DP020-NEXT-ACT-ERROR                                03170012
031800         WHEN DP020-NEXT-ACT-APPL-ERROR                           03180012
031900             MOVE DP020-MSG-MESSAGE       TO PV-MESSAGE           03190012
032000                                                                  03200012
032100             IF DP020-NAV-MNEMONIC = SPACES                       03210012
032200                 MOVE SPACES              TO ANAVCMDO             03220012
032300                 MOVE DP015-GREEN         TO ANAVCMDC             03230012
032400                 MOVE DP015-UNDERLINE     TO ANAVCMDH             03240012
032500             ELSE                                                 03250012
032600                 MOVE DP015-RED           TO ANAVCMDC             03260012
032700                 MOVE DP015-REVERSE       TO ANAVCMDH             03270012
032800             END-IF                                               03280012
032900                                                                  03290012
033000             SET PS-ERROR                 TO TRUE                 03300012
033100             SET PS-SEND-DATA-ONLY-FRSET  TO TRUE                 03310012
033200                                                                  03320012
033300             MOVE PV-MESSAGE              TO DP020-MSG-MESSAGE    03330012
033400             MOVE -1                      TO ANAVCMDL             03340012
033500             PERFORM 3300-EDIT-DATA-IN-COMMAREA                   03350012
033600             PERFORM 2200-DISPLAY-PANEL                           03360012
033700                                                                  03370012
033800         WHEN OTHER                                               03380012
033900             SET DP013-LOGIC-ABEND        TO TRUE                 03390012
034000             SET DP013-NO-ROLLBACK        TO TRUE                 03400012
034100                                                                  03410012
034200             MOVE 'B100-CONTROL-PROCESSING' TO                    03420012
034300                  DP013-PARAGRAPH                                 03430012
034400                                                                  03440012
034500             MOVE PM-PROGRAM-MESSAGE-1      TO                    03450012
034600                  DP013-MESSAGE-TEXT(1)                           03460012
034700                                                                  03470012
034800             PERFORM DP013-0000-PROCESS-ABEND                     03480012
034900                                                                  03490012
035000     END-EVALUATE.                                                03500012
035100 EJECT                                                            03510012
035200 2000-BUILD-INITIAL-PANEL.                                        03520012
035300                                                                  03530012
035400*----------------------------------------------------------------*03540012
035500*    PERFORMED ON THE FIRST PASS OF THIS PROGRAM.  THERE IS NO   *03550012
035600*    DATA NEEDED TO BUILD THIS PANEL, THEREFORE, JUST DISPLAY IT.*03560012
035700*                                                                *03570012
035800*    PERFORMED BY B100-CONTROL-PROCESSING.                       *03580012
035900*----------------------------------------------------------------*03590012
036000                                                                  03600012
036100     MOVE LOW-VALUES           TO  RV111-REQUEST-DATA.            03610012
036400     PERFORM 2200-DISPLAY-PANEL.                                  03640012
036500                                                                  03650012
036600     EJECT                                                        03660012
036700 2200-DISPLAY-PANEL.                                              03670012
036800                                                                  03680012
036900*----------------------------------------------------------------*03690012
037000*    FILL THE MAP WITH THE NECESSARY DATA AND WRITE IT OUT.      *03700012
037100*                                                                *03710012
037200*    PERFORMED BY 1000-CONTROL-PROCESSING.                       *03720012
037300*    PERFORMED BY 3000-PROCESS-PANEL.                            *03730012
037400*    PERFORMED BY 3100-CHECK-LOCAL-FKEYS.                        *03740012
037500*----------------------------------------------------------------*03750012
037600                                                                  03760012
037700     PERFORM DP017-0000-GET-CURR-DATE-TIME.                       03770012
037800     MOVE DP017-EDITED-TIME-HMS  TO  ATIMEO.                      03780012
037900                                                                  03790012
038000     IF  PS-SEND-MAP-N-DATA-FRSET                                 03800012
038100         PERFORM DP002-0000-FORMAT-TITLE-LINES                    03810012
038200     END-IF.                                                      03820012
038300                                                                  03830012
038400     PERFORM DP005-0000-FORMAT-MSG-LINES.                         03840012
038500                                                                  03850012
038600     IF (DP020-SRC-AID = DP016-PA2                                03860012
038700     OR  PS-SEND-MAP-N-DATA-FRSET)                                03870012
038800         PERFORM DP009-0000-LOAD-FK-LINES                         03880012
038900     END-IF.                                                      03890012
039000                                                                  03900012
039100     IF  PS-NO-ERROR                                              03910012
039200         MOVE -1                 TO  AOPRUIDL                     03920055
039300     END-IF.                                                      03930012
039400                                                                  03940012
039500     PERFORM 3400-MOVE-COMMAREA-TO-SCREEN.                        03950012
039600     PERFORM DP008-0000-WRITE-PANEL.                              03960012
039700                                                                  03970012
039800 EJECT                                                            03980012
039900 3000-PROCESS-PANEL.                                              03990012
040000                                                                  04000012
040100*----------------------------------------------------------------*04010012
040200*    RECEIVE THE MAP, CONDITIONALLY SAVE THE SCREEN DATA, THEN   *04020012
040300*    DETERMINE THE PROCESSING PATH.                              *04030012
040400*                                                                *04040012
040500*    PERFORMED BY B100-CONTROL-PROCESSING.                       *04050012
040600*----------------------------------------------------------------*04060012
040700                                                                  04070012
040800     SET PS-SEND-DATA-ONLY-FRSET TO TRUE.                         04080012
040900                                                                  04090012
041000     PERFORM DP007-0000-GET-PANEL.                                04100012
041100                                                                  04110012
041200     IF (DP020-SRC-AID = DP016-PF5                                04120012
041300     OR  DP020-SRC-AID = DP016-CLEAR)                             04130012
041400         CONTINUE                                                 04140012
041500     ELSE                                                         04150012
041600         PERFORM 3200-MOVE-SCREEN-TO-COMMAREA                     04160012
041700     END-IF.                                                      04170012
041800                                                                  04180012
041900     PERFORM 3100-CHECK-LOCAL-FKEYS.                              04190012
042000 EJECT                                                            04200012
042100                                                                  04210012
042200 3100-CHECK-LOCAL-FKEYS.                                          04220012
042300                                                                  04230012
042400*----------------------------------------------------------------*04240012
042500*    PERFORM THE APPROPRIATE PARAGRAPH BASED ON WHICH FUNCTION   *04250012
042600*    KEY THE USER HIT.                                           *04260012
042700*                                                                *04270012
042800*    PERFORMED BY 3000-PROCESS-PANEL.                            *04280012
042900*----------------------------------------------------------------*04290012
043000                                                                  04300012
043100     EVALUATE TRUE                                                04310012
043200                                                                  04320012
043300         WHEN DP020-FK-GO-TO-TRAN(DP020-SRC-AID) OR               04330012
043400              DP020-FK-RETURN(DP020-SRC-AID)                      04340012
043500              SET RV111-DONT-RESTORE-COMMAREA                     04350012
043600                               TO  TRUE                           04360012
043700              PERFORM 4000-NAVIGATE                               04370012
043800                                                                  04380012
043900         WHEN DP020-FK-LOCAL-GOTO(DP020-SRC-AID)                  04390012
044000              PERFORM 3300-EDIT-DATA-IN-COMMAREA                  04400012
044100              IF  PS-NO-ERROR                                     04410012
044200                  SET RV111-DONT-RESTORE-COMMAREA                 04420012
044300                               TO  TRUE                           04430012
044400                  PERFORM 4000-NAVIGATE                           04440012
044500              ELSE                                                04450012
044600                  PERFORM 2200-DISPLAY-PANEL                      04460012
044700              END-IF                                              04470012
044800                                                                  04480012
044900         WHEN DP020-FK-REFRESH(DP020-SRC-AID)                     04490012
045000              MOVE SPACES      TO  ANAVCMDO                       04500012
045100                                   ANAVKEYO                       04510012
045200              SET PS-SEND-MAP-N-DATA-FRSET                        04520012
045300                                 TO  TRUE                         04530012
045400              INITIALIZE RV111-REQUEST-DATA                       04540012
045500                         RV111-STORE-NAME                         04550012
045600              PERFORM 2000-BUILD-INITIAL-PANEL                    04560012
045700                                                                  04570012
045800         WHEN DP020-SRC-AID = DP016-ENTER                         04580012
045900              IF  DP020-NAV-MNEMONIC GREATER THAN SPACES          04590012
046000                  SET RV111-RESTORE-COMMAREA                      04600012
046100                               TO  TRUE                           04610012
046200                  PERFORM 4000-NAVIGATE                           04620012
046300              ELSE                                                04630012
046400                  PERFORM 3300-EDIT-DATA-IN-COMMAREA              04640012
046500                  PERFORM 2200-DISPLAY-PANEL                      04650012
046600              END-IF                                              04660012
046700                                                                  04670012
046800         WHEN DP020-SRC-AID = DP016-PA2                           04680012
046900              SET PS-SEND-DATA-ONLY TO TRUE                       04690012
047000              MOVE -1               TO ANAVCMDL                   04700012
047100              PERFORM DP017-0000-GET-CURR-DATE-TIME               04710012
047200              PERFORM DP009-0000-LOAD-FK-LINES                    04720012
047300              PERFORM DP008-0000-WRITE-PANEL                      04730012
047400                                                                  04740012
047500         WHEN DP020-SRC-AID = DP016-CLEAR                         04750012
047600              SET PS-SEND-MAP-N-DATA-FRSET                        04760012
047700                                 TO  TRUE                         04770012
047800              PERFORM 3300-EDIT-DATA-IN-COMMAREA                  04780012
047900              PERFORM 2200-DISPLAY-PANEL                          04790012
048000                                                                  04800012
048100         WHEN OTHER                                               04810012
048200             PERFORM 3300-EDIT-DATA-IN-COMMAREA                   04820012
048300             MOVE PC-TSYMSG-00045                                 04830012
048400                                 TO  DP020-MSG-NUMBER             04840012
048500             SET DP020-MSG-FATAL TO  TRUE                         04850012
048600             MOVE -1             TO  ANAVCMDL                     04860012
048700             PERFORM 2200-DISPLAY-PANEL                           04870012
048800                                                                  04880012
048900     END-EVALUATE.                                                04890012
049000 EJECT                                                            04900012
049100                                                                  04910012
049200 3200-MOVE-SCREEN-TO-COMMAREA.                                    04920012
049300                                                                  04930012
049400*----------------------------------------------------------------*04940012
049500*    MOVE THE FIELDS FROM THE MAP TO THE COMMAREA IF ANYTHING    *04950012
049600*    WAS ENTERED IN THAT FIELD.                                  *04960012
049700*                                                                *04970012
049800*    PERFORMED BY 3000-PROCESS-PANEL.                            *04980012
049900*----------------------------------------------------------------*04990012
050000                                                                  05000012
050100     IF AOPRUIDL GREATER THAN ZERO                                05010012
050200        MOVE AOPRUIDI         TO  RV111-OPER-UNT-ID               05020012
050300        EXEC CICS BIF DEEDIT                                      05030012
050400                      FIELD (RV111-OPER-UNT-ID)                   05040012
050500                      LENGTH(4)                                   05050012
050600        END-EXEC                                                  05060012
050700     ELSE                                                         05070012
050800        IF AOPRUIDA EQUAL PC-ERASE-EOF                            05080012
050900           MOVE AOPRUIDI      TO  RV111-OPER-UNT-ID               05090012
051000           MOVE SPACES        TO  RV111-STORE-NAME                05100012
051100        END-IF                                                    05110012
051200     END-IF.                                                      05120012
051300                                                                  05130012
051400     IF ARANBRL GREATER THAN ZERO                                 05140012
051500        MOVE ARANBRI          TO  RV111-RA-NUMBER                 05150012
051600        EXEC CICS BIF DEEDIT                                      05160060
051700                      FIELD (RV111-RA-NUMBER)                     05170060
051800                      LENGTH(12)                                  05180060
051900        END-EXEC                                                  05190060
052000     ELSE                                                         05200012
052100        IF ARANBRA EQUAL PC-ERASE-EOF                             05210012
052200           MOVE ARANBRI       TO  RV111-RA-NUMBER                 05220012
052300        END-IF                                                    05230012
052400     END-IF.                                                      05240012
052500                                                                  05250012
052600     IF ATYPEL > ZERO                                             05260012
052700        MOVE ATYPEI           TO  RV111-TYPE-CDE                  05270012
052800     ELSE                                                         05280012
052900        IF ATYPEA EQUAL PC-ERASE-EOF                              05290012
053000           MOVE SPACES        TO  RV111-TYPE-CDE                  05300012
053100        END-IF                                                    05310012
053200     END-IF.                                                      05320012
053300                                                                  05330012
053400     IF ASTATUSL > ZERO                                           05340012
053500        MOVE ASTATUSI         TO  RV111-STATUS-CDE                05350012
053600     ELSE                                                         05360012
053700        IF ASTATUSA EQUAL PC-ERASE-EOF                            05370012
053800           MOVE SPACES        TO  RV111-STATUS-CDE                05380012
053900        END-IF                                                    05390012
054000     END-IF.                                                      05400012
054100                                                                  05410012
054200     IF (AVENAMEL GREATER THAN ZERO                               05420012
054300     OR  AVENAMEA EQUAL PC-ERASE-EOF)                             05430012
054400        MOVE AVENAMEI          TO  RV111-VENDOR-NAME              05440012
054500     END-IF.                                                      05450012
054600                                                                  05460012
054700     IF (ALOCIDL GREATER THAN ZERO                                05470012
054800     OR  ALOCIDA EQUAL PC-ERASE-EOF)                              05480012
054900        MOVE ALOCIDI           TO  RV111-LOCATION                 05490012
055000     END-IF.                                                      05500012
055100                                                                  05510012
055200 EJECT                                                            05520012
055300                                                                  05530012
055400 3300-EDIT-DATA-IN-COMMAREA.                                      05540012
055500                                                                  05550012
055600*----------------------------------------------------------------*05560012
055700*    VALIDATE THE SCREEN FIELDS.                                 *05570012
055800*                                                                *05580012
055900*    PERFORMED BY 1000-CONTROL-PROCESSING.                       *05590012
056000*    PERFORMED BY 3000-PROCESS-PANEL.                            *05600012
056100*    PERFORMED BY 3100-CHECK-LOCAL-FKEYS.                        *05610012
056200*----------------------------------------------------------------*05620012
056300                                                                  05630012
056400     SET PS-NO-ERROR             TO  TRUE.                        05640012
056500                                                                  05650012
056600     IF (DP020-NAV-MNEMONIC NOT GREATER THAN SPACES               05660012
056700     AND DP020-NAV-KEY-DATA GREATER THAN SPACES)                  05670012
056800         MOVE DP015-RED          TO  ANAVKEYC                     05680012
056900         MOVE DP015-REVERSE      TO  ANAVKEYH                     05690012
057000         MOVE -1                 TO  ANAVKEYL                     05700012
057100         MOVE PC-TSYMSG-00005    TO  DP020-MSG-NUMBER             05710012
057200         SET DP020-MSG-FATAL     TO  TRUE                         05720012
057300         SET PS-ERROR            TO  TRUE                         05730012
057400     ELSE                                                         05740012
057500         MOVE DP015-GREEN        TO  ANAVKEYC                     05750012
057600         MOVE DP015-UNDERLINE    TO  ANAVKEYH                     05760012
057700     END-IF.                                                      05770012
057800                                                                  05780012
057900     MOVE DP015-GREEN            TO  AVENAMEC                     05790012
058000                                     ALOCIDC                      05800012
058100                                     ASTATUSC                     05810012
058200                                     ATYPEC                       05820012
058300                                     ARANBRC                      05830012
058400                                     AOPRUIDC.                    05840012
058500     MOVE DP015-UNDERLINE        TO  AVENAMEH                     05850012
058600                                     ALOCIDH                      05860012
058700                                     ASTATUSH                     05870012
058800                                     ATYPEH                       05880012
058900                                     ARANBRH                      05890012
059000                                     AOPRUIDH.                    05900012
059100     MOVE ZERO                   TO  PV-COUNT.                    05910012
059200                                                                  05920012
059210     IF  RV111-OPER-UNT-ID GREATER THAN ZERO                      05921055
059220         MOVE RV111-OPER-UNT-ID-N  TO DK-OPER-UNT-ID              05922055
059230         PERFORM 3310-VALIDATE-OPER-UNT-ID                        05923055
059240         IF  PS-EDIT-ERROR                                        05924055
059250             SET DP020-MSG-FATAL       TO TRUE                    05925055
059260             MOVE PC-TSYMSG-00005      TO DP020-MSG-NUMBER        05926055
059270             MOVE DP015-UNP-ALP-BRT-OFF  TO AOPRUIDA              05927055
059280             MOVE DP015-RED              TO AOPRUIDC              05928055
059290             MOVE DP015-REVERSE          TO AOPRUIDH              05929055
059291             MOVE -1                     TO AOPRUIDL              05929155
059292             MOVE SPACES                 TO RV111-STORE-NAME      05929255
059293         END-IF                                                   05929355
059294     ELSE                                                         05929455
059295         MOVE -1               TO  AOPRUIDL                       05929555
059296         MOVE DP015-RED        TO  AOPRUIDC                       05929655
059297         MOVE DP015-REVERSE    TO  AOPRUIDH                       05929755
059298         MOVE PC-TSYMSG-00007  TO  DP020-MSG-NUMBER               05929855
059299         SET DP020-MSG-FATAL   TO  TRUE                           05929955
059300         SET PS-ERROR          TO  TRUE                           05930055
059301         SET PS-EDIT-ERROR     TO  TRUE                           05930155
059302     END-IF                                                       05930255
059303                                                                  05930355
059304     IF PS-EDIT-ERROR                                             05930455
059305         CONTINUE                                                 05930555
059306     ELSE                                                         05930655
059320      IF  RV111-RA-NUMBER-N GREATER THAN ZERO                     05932051
059400         CONTINUE                                                 05940012
059500      ELSE                                                        05950051
059600         IF (RV111-TYPE-CDE GREATER THAN SPACES AND               05960020
059700            RV111-STATUS-CDE GREATER THAN SPACES)                 05970020
059800            CONTINUE                                              05980020
059801         ELSE                                                     05980120
059810             IF RV111-LOCATION GREATER THAN SPACES                05981020
059820                CONTINUE                                          05982020
059900             ELSE                                                 05990021
059910                 IF RV111-VENDOR-NAME GREATER THAN SPACES         05991021
059920                    CONTINUE                                      05992021
059930                 ELSE                                             05993021
060000                     MOVE -1                 TO  ARANBRL          06000042
060100                     MOVE DP015-RED          TO  ARANBRC          06010040
060200                     MOVE DP015-REVERSE      TO  ARANBRH          06020040
060340                     MOVE PC-TSYMSG-00005   TO  DP020-MSG-NUMBER  06034039
060400                     SET DP020-MSG-FATAL     TO  TRUE             06040021
060500                     SET PS-ERROR            TO  TRUE             06050021
060600                     SET PS-EDIT-ERROR       TO  TRUE             06060021
060601                 END-IF                                           06060121
060610             END-IF                                               06061020
060700         END-IF                                                   06070015
060800      END-IF                                                      06080051
060810     END-IF.                                                      06081052
060900                                                                  06090012
063600                                                                  06360012
063700     IF PS-EDIT-ERROR                                             06370012
063800         CONTINUE                                                 06380012
063900     ELSE                                                         06390012
064000         IF  RV111-VENDOR-NAME GREATER THAN SPACES                06400012
064100             ADD 1                   TO  PV-COUNT                 06410012
064200         END-IF                                                   06420012
064300                                                                  06430012
064400         IF  RV111-LOCATION    GREATER THAN SPACES                06440012
064500             ADD 1                   TO  PV-COUNT                 06450012
064600         END-IF                                                   06460012
064700                                                                  06470012
064800                                                                  06480012
064900         IF  RV111-RA-NUMBER GREATER THAN ZERO                    06490012
065000             ADD 1                   TO  PV-COUNT                 06500012
065100         END-IF                                                   06510012
065200                                                                  06520012
065300         IF  RV111-TYPE-CDE GREATER THAN SPACES                   06530012
065400             IF  RV111-STATUS-CDE GREATER THAN SPACES             06540012
065500                 PERFORM 3320-VALIDATE-TYPE-STATUS                06550012
065600                 ADD 1                   TO  PV-COUNT             06560012
065700             ELSE                                                 06570012
065800                 MOVE -1                 TO  ATYPEL               06580012
065900                 MOVE DP015-RED          TO  ATYPEC               06590012
066000                                             ASTATUSC             06600012
066100                 MOVE DP015-REVERSE      TO  ATYPEH               06610012
066200                                             ASTATUSH             06620012
066300                 MOVE PC-TSYMSG-01111    TO  DP020-MSG-NUMBER     06630012
066400                 SET DP020-MSG-FATAL     TO  TRUE                 06640012
066500                 SET PS-ERROR            TO  TRUE                 06650012
066600             END-IF                                               06660012
066700         ELSE                                                     06670012
066800             IF  RV111-STATUS-CDE GREATER THAN SPACES             06680012
066900                 MOVE -1                 TO  ATYPEL               06690012
067000                 MOVE DP015-RED          TO  ATYPEC               06700012
067100                                             ASTATUSC             06710012
067200                 MOVE DP015-REVERSE      TO  ATYPEH               06720012
067300                                             ASTATUSH             06730012
067400                 MOVE PC-TSYMSG-01111    TO  DP020-MSG-NUMBER     06740012
067500                 SET DP020-MSG-FATAL     TO  TRUE                 06750012
067600                 SET PS-ERROR            TO  TRUE                 06760012
067700             END-IF                                               06770012
067800         END-IF                                                   06780012
067900                                                                  06790012
068000         IF PS-ERROR                                              06800012
068100             CONTINUE                                             06810012
068200         ELSE                                                     06820012
068300          IF  PV-COUNT EQUAL ZERO                                 06830012
068400             MOVE -1                 TO  ARANBRL                  06840043
068500             MOVE PC-TSYMSG-00036    TO  DP020-MSG-NUMBER         06850012
068600             SET DP020-MSG-FATAL     TO  TRUE                     06860012
068700             SET PS-ERROR            TO  TRUE                     06870012
068800          ELSE                                                    06880012
068900             IF  PV-COUNT GREATER THAN 1                          06890012
069000                                                                  06900012
069100                 IF  RV111-VENDOR-NAME GREATER THAN SPACES        06910012
069200                     MOVE -1         TO  AVENAMEL                 06920012
069300                     MOVE DP015-RED  TO  AVENAMEC                 06930012
069400                     MOVE DP015-REVERSE                           06940012
069500                                     TO  AVENAMEH                 06950012
069600                     MOVE PC-TSYMSG-00047                         06960012
069700                                     TO  DP020-MSG-NUMBER         06970012
069800                     SET DP020-MSG-FATAL                          06980012
069900                                     TO  TRUE                     06990012
070000                     SET PS-ERROR                                 07000012
070100                                     TO  TRUE                     07010012
070200                 END-IF                                           07020012
070300                                                                  07030012
070400                 IF  RV111-LOCATION    GREATER THAN SPACES        07040012
070500                     MOVE -1         TO  ALOCIDL                  07050012
070600                     MOVE DP015-RED  TO  ALOCIDC                  07060012
070700                     MOVE DP015-REVERSE                           07070012
070800                                     TO  ALOCIDH                  07080012
070900                     MOVE PC-TSYMSG-00047                         07090012
071000                                     TO  DP020-MSG-NUMBER         07100012
071100                     SET DP020-MSG-FATAL                          07110012
071200                                     TO  TRUE                     07120012
071300                     SET PS-ERROR                                 07130012
071400                                     TO  TRUE                     07140012
071500                 END-IF                                           07150012
071600                                                                  07160012
071700                 IF  RV111-TYPE-CDE > SPACES                      07170012
071800                     MOVE -1         TO  ATYPEL                   07180012
071900                     MOVE DP015-RED  TO  ATYPEC                   07190012
072000                     MOVE DP015-REVERSE                           07200012
072100                                     TO  ATYPEH                   07210012
072200                     MOVE PC-TSYMSG-00047                         07220012
072300                                     TO  DP020-MSG-NUMBER         07230012
072400                     SET DP020-MSG-FATAL                          07240012
072500                                     TO  TRUE                     07250012
072600                     SET PS-ERROR                                 07260012
072700                                     TO  TRUE                     07270012
072800                 END-IF                                           07280012
072900                                                                  07290012
073000                 IF  RV111-STATUS-CDE GREATER THAN SPACES         07300012
073100                     MOVE -1         TO  ASTATUSL                 07310012
073200                     MOVE DP015-RED  TO  ASTATUSC                 07320012
073300                     MOVE DP015-REVERSE                           07330012
073400                                     TO  ASTATUSH                 07340012
073500                     MOVE PC-TSYMSG-00047                         07350012
073600                                     TO  DP020-MSG-NUMBER         07360012
073700                     SET DP020-MSG-FATAL                          07370012
073800                                     TO  TRUE                     07380012
073900                     SET PS-ERROR                                 07390012
074000                                     TO  TRUE                     07400012
074100                 END-IF                                           07410012
074200                                                                  07420012
074300                 IF  RV111-RA-NUMBER GREATER THAN ZERO            07430012
074400                     MOVE -1         TO  ARANBRL                  07440012
074500                     MOVE DP015-RED  TO  ARANBRC                  07450012
074600                     MOVE DP015-REVERSE                           07460012
074700                                     TO  ARANBRH                  07470012
074800                     MOVE PC-TSYMSG-00047                         07480012
074900                                     TO  DP020-MSG-NUMBER         07490012
075000                     SET DP020-MSG-FATAL                          07500012
075100                                     TO  TRUE                     07510012
075200                     SET PS-ERROR                                 07520012
075300                                     TO  TRUE                     07530012
075400                 END-IF                                           07540012
075500                                                                  07550012
075600             END-IF                                               07560012
075700          END-IF                                                  07570012
075800         END-IF                                                   07580012
075900     END-IF.                                                      07590012
076000                                                                  07600012
076100 EJECT                                                            07610012
076200                                                                  07620012
076300*----------------------------------------------------------------*07630012
076400*  VALIDATE THE OPERATING UNIT ID TO MAKE SURE THAT IT IS A      *07640012
076500*  VALID DISTRIBUTION CENTER.                                    *07650012
076600*----------------------------------------------------------------*07660012
076700 3310-VALIDATE-OPER-UNT-ID.                                       07670012
076800                                                                  07680012
078710     EXEC SQL                                                     07871027
078720         SELECT B.LOC_NM                                          07872027
078730           INTO :XLT00010-LOC-NM                                  07873027
078740           FROM XLT_DC_LOC_ASGMT A                                07874027
078750              , XLT_LOC          B                                07875027
078761          WHERE A.LOC_NBR = :DK-OPER-UNT-ID                       07876129
078770            AND A.LOC_NBR = B.LOC_NBR                             07877027
078780            AND B.LOC_TYP_CDE = 'RV'                              07878027
078790            AND (CHAR(CURRENT_DATE, ISO)                          07879027
078791                   BETWEEN                                        07879127
078792                 CHAR(B.OPN_DTE,ISO)                              07879227
078793                   AND                                            07879327
078794                 CHAR(B.CLO_DTE,ISO))                             07879427
078795     END-EXEC.                                                    07879527
078800                                                                  07880012
078900     EVALUATE TRUE                                                07890012
079000         WHEN SQLCODE = +100                                      07900012
079100             SET PS-EDIT-ERROR TO TRUE                            07910012
079200         WHEN SQLWARN0 NOT = SPACES                               07920012
079300         WHEN SQLCODE < ZERO                                      07930012
079400         WHEN SQLCODE > ZERO                                      07940012
079500             MOVE '3310-VALIDATE-OPER-UNT-ID'                     07950012
079600                              TO DP013-PARAGRAPH                  07960012
079700             MOVE 'SELECT OPERATING UNIT ID'                      07970012
079800                              TO DP013-MESSAGE-TEXT (1)           07980012
079810             MOVE DK-OPER-UNT-ID                                  07981023
079820                              TO PV-DISP-OPER-UNT-ID              07982023
079830             STRING 'CURRENT OPER UNIT ID: '                      07983023
079840                                            DELIMITED BY SIZE     07984023
079850                    PV-DISP-OPER-UNT-ID-X   DELIMITED BY SIZE     07985023
079860                            INTO DP013-MESSAGE-TEXT (2)           07986023
079870             MOVE 'XLT_LOC'                                       07987023
079880                              TO DP013-DB2-TABLE-NAME (1)         07988023
079890             MOVE 'XLT_DC_LOC_ASGMT'                              07989023
079891                              TO DP013-DB2-TABLE-NAME (2)         07989123
079900             MOVE SQLCA       TO DP013-SQLCA                      07990012
080100             SET DP013-DB2-ABEND                                  08010012
080200                 DP013-XCTL-DISPLAY-RESTART                       08020012
080300                              TO TRUE                             08030012
080400             PERFORM DP013-0000-PROCESS-ABEND                     08040012
080500         WHEN SQLCODE = +0                                        08050012
080600             MOVE XLT00010-LOC-NM                                 08060023
080610                              TO  RV111-STORE-NAME                08061023
080700     END-EVALUATE.                                                08070012
080800                                                                  08080012
080900 EJECT                                                            08090012
081000                                                                  08100012
081100*----------------------------------------------------------------*08110012
081200*  THERE THERE ARE VALUES IN BOTH THE TYPE AND THE STATUS,       *08120012
081300*  CHECK THAT THEY ARE VALID VALUES, AND A VALID COMBINATION     *08130012
081400*----------------------------------------------------------------*08140012
081500 3320-VALIDATE-TYPE-STATUS.                                       08150012
081600                                                                  08160012
081700     PERFORM 3321-GET-TYPE-DESC.                                  08170012
081800     PERFORM 3322-GET-STATUS-DESC.                                08180012
081900                                                                  08190012
082000     IF RV111-VALID-TYPE-CDE                                      08200012
082100        IF RV111-VALID-STATUS-CDE                                 08210012
082200           EVALUATE TRUE                                          08220012
082300              WHEN RV111-MARKOUT-TYPE                             08230012
082400                 IF RV111-VALID-MKOUT-STATUS                      08240012
082500                    CONTINUE                                      08250012
082600                 ELSE                                             08260012
082700                    MOVE -1                 TO  ATYPEL            08270012
082800                    MOVE DP015-RED          TO  ATYPEC            08280012
082900                                                ASTATUSC          08290012
083000                    MOVE DP015-REVERSE      TO  ATYPEH            08300012
083100                                                ASTATUSH          08310012
083200                    MOVE PC-TSYMSG-00807    TO  DP020-MSG-NUMBER  08320012
083300                    SET DP020-MSG-FATAL     TO  TRUE              08330012
083400                    SET PS-ERROR            TO  TRUE              08340012
083500                 END-IF                                           08350012
083600                                                                  08360012
083700              WHEN RV111-RTV-TYPE                                 08370012
083800                 IF RV111-VALID-RTV-STATUS                        08380012
083900                    CONTINUE                                      08390012
084000                 ELSE                                             08400012
084100                    MOVE -1                 TO  ATYPEL            08410012
084200                    MOVE DP015-RED          TO  ATYPEC            08420012
084300                                                ASTATUSC          08430012
084400                    MOVE DP015-REVERSE      TO  ATYPEH            08440012
084500                                                ASTATUSH          08450012
084600                    MOVE PC-TSYMSG-00807    TO  DP020-MSG-NUMBER  08460012
084700                    SET DP020-MSG-FATAL     TO  TRUE              08470012
084800                    SET PS-ERROR            TO  TRUE              08480012
084900                 END-IF                                           08490012
085000                                                                  08500012
085100              WHEN RV111-D-AND-D-TYPE                             08510012
085200                 IF RV111-VALID-D-AND-D-STATUS                    08520012
085300                    CONTINUE                                      08530012
085400                 ELSE                                             08540012
085500                    MOVE -1                 TO  ATYPEL            08550012
085600                    MOVE DP015-RED          TO  ATYPEC            08560012
085700                                                ASTATUSC          08570012
085800                    MOVE DP015-REVERSE      TO  ATYPEH            08580012
085900                                                ASTATUSH          08590012
086000                    MOVE PC-TSYMSG-00807    TO  DP020-MSG-NUMBER  08600012
086100                    SET DP020-MSG-FATAL     TO  TRUE              08610012
086200                    SET PS-ERROR            TO  TRUE              08620012
086300                 END-IF                                           08630012
086400                                                                  08640012
086500              WHEN RV111-CALL-BACK-TYPE                           08650012
086600                 IF RV111-VALID-CALL-BACK-STATUS                  08660012
086700                    CONTINUE                                      08670012
086800                 ELSE                                             08680012
086900                    MOVE -1                 TO  ATYPEL            08690012
087000                    MOVE DP015-RED          TO  ATYPEC            08700012
087100                                                ASTATUSC          08710012
087200                    MOVE DP015-REVERSE      TO  ATYPEH            08720012
087300                                                ASTATUSH          08730012
087400                    MOVE PC-TSYMSG-00807    TO  DP020-MSG-NUMBER  08740012
087500                    SET DP020-MSG-FATAL     TO  TRUE              08750012
087600                    SET PS-ERROR            TO  TRUE              08760012
087700                 END-IF                                           08770012
087800                                                                  08780012
087900           END-EVALUATE                                           08790012
088000        ELSE                                                      08800012
088100            MOVE -1                         TO  ASTATUSL          08810012
088200            MOVE DP015-RED                  TO  ASTATUSC          08820012
088300            MOVE DP015-REVERSE              TO  ASTATUSH          08830012
088400            MOVE PC-TSYMSG-00005            TO  DP020-MSG-NUMBER  08840012
088500            SET DP020-MSG-FATAL             TO  TRUE              08850012
088600            SET PS-ERROR                    TO  TRUE              08860012
088700        END-IF                                                    08870012
088800     ELSE                                                         08880012
088900        MOVE -1                             TO  ATYPEL            08890012
089000        MOVE DP015-RED                      TO  ATYPEC            08900012
089100        MOVE DP015-REVERSE                  TO  ATYPEH            08910012
089200        MOVE PC-TSYMSG-00005                TO  DP020-MSG-NUMBER  08920012
089300        SET DP020-MSG-FATAL                 TO  TRUE              08930012
089400        SET PS-ERROR                        TO  TRUE              08940012
089500     END-IF.                                                      08950012
089600                                                                  08960012
089700 3321-GET-TYPE-DESC.                                              08970012
089800*----------------------------------------------------------------*08980012
089900* FILL IN THE TYPE DESCRIPTION FIELD                             *08990012
090000*----------------------------------------------------------------*09000012
090100     EVALUATE TRUE                                                09010012
090200         WHEN RV111-MARKOUT-TYPE                                  09020012
090300             MOVE 'MARKOUT        '  TO RV111-TYPE-DESC           09030012
090400         WHEN RV111-RTV-TYPE                                      09040012
090500             MOVE 'RETURN-TO-VNDR '  TO RV111-TYPE-DESC           09050012
090600         WHEN RV111-D-AND-D-TYPE                                  09060012
090700             MOVE 'DEBIT & DISPOSE'  TO RV111-TYPE-DESC           09070012
090800         WHEN RV111-CALL-BACK-TYPE                                09080012
090900             MOVE 'CALL BACK      '  TO RV111-TYPE-DESC           09090012
091000         WHEN OTHER                                               09100012
091100             MOVE 'INVALID TYPE   '  TO RV111-TYPE-DESC           09110012
091200     END-EVALUATE.                                                09120012
091300                                                                  09130012
091400 3322-GET-STATUS-DESC.                                            09140012
091500*----------------------------------------------------------------*09150012
091600* FILL IN THE STATUS DESCRIPTION FIELD                           *09160012
091700*----------------------------------------------------------------*09170012
091800     EVALUATE TRUE                                                09180012
091900         WHEN RV111-NEW-STAT                                      09190012
092000             MOVE 'NEW STATUS     '  TO RV111-STATUS-DESC         09200012
092100         WHEN RV111-OPEN-STAT                                     09210012
092200             MOVE 'OPEN STATUS    '  TO RV111-STATUS-DESC         09220012
092300         WHEN RV111-CLOSE-STAT                                    09230012
092400             MOVE 'CLOSED STATUS  '  TO RV111-STATUS-DESC         09240012
092500         WHEN RV111-SHIP-STAT                                     09250012
092600             MOVE 'SHIPPED STATUS '  TO RV111-STATUS-DESC         09260012
092700         WHEN RV111-PEND-STAT                                     09270012
092800             MOVE 'PENDING STATUS '  TO RV111-STATUS-DESC         09280012
092900         WHEN RV111-APPROVE-STAT                                  09290012
093000             MOVE 'APPROVED STATUS'  TO RV111-STATUS-DESC         09300012
093100         WHEN RV111-D-AND-D-STAT                                  09310012
093200             MOVE 'DEBIT & DISPOSE'  TO RV111-STATUS-DESC         09320012
093300         WHEN OTHER                                               09330012
093400             MOVE 'INVALID STATUS '  TO RV111-STATUS-DESC         09340012
093500     END-EVALUATE.                                                09350012
093600                                                                  09360012
093700 3400-MOVE-COMMAREA-TO-SCREEN.                                    09370012
093800*----------------------------------------------------------------*09380012
093900*    MOVE THE FIELDS FROM THE COMMAREA TO THE SCREEN.            *09390012
094000*                                                                *09400012
094100*    PERFORMED BY 2200-DISPLAY-PANEL.                            *09410012
094200*----------------------------------------------------------------*09420012
094300                                                                  09430012
094400     MOVE RV111-OPER-UNT-ID-N  TO  AOPRUIDO.                      09440012
094500     MOVE RV111-STORE-NAME     TO  AFDESCO.                       09450012
094510**GB                                                              09451059
094600**GB MOVE RV111-RA-NUMBER      TO  ARANBRO.                       09460060
094610     MOVE RV111-RA-NUMBER-N    TO  ARANBRO.                       09461060
094700     MOVE RV111-TYPE-CDE       TO  ATYPEO.                        09470012
094800     MOVE RV111-TYPE-DESC      TO  ATPDESCO.                      09480012
094900     MOVE RV111-STATUS-CDE     TO  ASTATUSO.                      09490012
095000     MOVE RV111-STATUS-DESC    TO  ASTDESCO.                      09500012
095100     MOVE RV111-LOCATION       TO  ALOCIDO.                       09510012
095200     MOVE RV111-VENDOR-NAME    TO  AVENAMEO.                      09520012
095300                                                                  09530012
095400 EJECT                                                            09540012
095500                                                                  09550012
095600 4000-NAVIGATE.                                                   09560012
095700*----------------------------------------------------------------*09570012
095800*    SETUP THE INTER APPLICATION COMMAREA WITH DATA FROM THE     *09580012
095900*    SPECIFIC COMMAREA.                                          *09590012
096000*                                                                *09600012
096100*    PERFORMED BY 3300-EDIT-DATA-IN-COMMAREA                     *09610012
096200*----------------------------------------------------------------*09620012
096300                                                                  09630012
096400     MOVE RV111-RA-NUMBER-N    TO  RV100-RA-NUMBER.               09640012
096500     MOVE RV111-TYPE-CDE       TO  RV100-TYPE-CDE.                09650012
096600     MOVE RV111-STATUS-CDE     TO  RV100-STATUS-CDE.              09660012
096700     MOVE RV111-LOCATION       TO  RV100-LOCATION.                09670012
096800     MOVE RV111-VENDOR-NAME    TO  RV100-VENDOR-NAME.             09680012
096900     MOVE RV111-OPER-UNT-ID-N  TO  RV100-OPER-UNT-ID.             09690012
097000                                                                  09700012
097100     MOVE RV100-INTER-APPL-COMMAREA                               09710012
097200                                 TO  RV111-SAVE-INTER-APPL-COMM.  09720012
097300     PERFORM DP015-1000-START-NAVIGATOR.                          09730012
097400                                                                  09740012
097500 EJECT                                                            09750012
097600*----------------------------------------------------------------*09760012
097700*    FILL IN SCREEN HEADER MODULE                                *09770012
097800*----------------------------------------------------------------*09780012
097900                                                                  09790012
098000     COPY DPPD022.                                                09800012
098100 EJECT                                                            09810012
098200*----------------------------------------------------------------*09820012
098300*    RETURN TO CICS MODULE                                       *09830012
098400*----------------------------------------------------------------*09840012
098500                                                                  09850012
098600     COPY DPPD003.                                                09860012
098700 EJECT                                                            09870012
098800*----------------------------------------------------------------*09880012
098900*    FORMAT MESSAGE LINES MODULE                                 *09890012
099000*----------------------------------------------------------------*09900012
099100                                                                  09910012
099200     COPY DPPD005.                                                09920012
099300 EJECT                                                            09930012
099400*----------------------------------------------------------------*09940012
099500*    GET PANEL MODULE                                            *09950012
099600*----------------------------------------------------------------*09960012
099700                                                                  09970012
099800     COPY DPPD007.                                                09980012
099900 EJECT                                                            09990012
100000*----------------------------------------------------------------*10000012
100100*    WRITE PANEL MODULE                                          *10010012
100200*----------------------------------------------------------------*10020012
100300                                                                  10030012
100400     COPY DPPD008.                                                10040012
100500 EJECT                                                            10050012
100600*----------------------------------------------------------------*10060012
100700*    TOGGLE THE FUNCTION KEY LINE MODULE                         *10070012
100800*----------------------------------------------------------------*10080012
100900                                                                  10090012
101000     COPY DPPD009.                                                10100012
101100 EJECT                                                            10110012
101200*----------------------------------------------------------------*10120012
101300*    ABEND PROCESSOR MODULE                                      *10130012
101400*----------------------------------------------------------------*10140012
101500                                                                  10150012
101600     COPY DPPD013.                                                10160012
101700 EJECT                                                            10170012
101800*----------------------------------------------------------------*10180012
101900*    CHECK COMMUNICATION AREA MODULE                             *10190012
102000*----------------------------------------------------------------*10200012
102100                                                                  10210012
102200     COPY DPPD015.                                                10220012
102300 EJECT                                                            10230012
102400*----------------------------------------------------------------*10240012
102500*    UPDATE TIME AND DATE MODULE                                 *10250012
102600*----------------------------------------------------------------*10260012
102700                                                                  10270012
102800     COPY DPPD017.                                                10280012
102900 EJECT                                                            10290012
