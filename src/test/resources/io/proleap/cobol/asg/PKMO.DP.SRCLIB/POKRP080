000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.    POKRP080.                                         00020000
000300 AUTHOR.        KELLY LARUM.                                      00030000
000400 INSTALLATION.  KOHLS.                                            00040000
000500 DATE-WRITTEN.  08/99.                                            00050000
000600 DATE-COMPILED.                                                   00060000
000700******************************************************************00070000
000800* THIS PROGRAM WILL READ A PURCHASE ORDER NUMBER PASSED FROM THE  00080000
000900* ONLINE AND GENERATE A PURCHASE ORDER PRINT FOR A PREPAK TYPE PO 00090000
001000******************************************************************00100000
001100* DATE  10/24/2000, K. SCHOLEY                                  * 00110000
001200*   WR21302 ADD LOGIC TO PRINT NEW DEALS DISCOUNT PERCENTS, AMTS* 00120000
001300*   AND EXTENDED DAYS.                                          * 00130000
001400******************************************************************00140000
001500* DATE  11/16/2000, K. SCHOLEY                                  * 00150000
001600*   WR21302 MULTIPLY NEW DISCOUNTS BY 100 BEFORE MOVING TO PRINT* 00160000
001700******************************************************************00170000
001800* DATE  06/26/2002, R. STAUFFACHER                              * 00180000
001900*   P471028 ADDED RETRY LOGIC FOR PARAGRAPHS USING TPURITM      * 00190000
002000******************************************************************00200000
002100* DATE  07/11/2002, CINDY HANSEN                                * 00210000
002200*   P471028 INCREASED RETRY MAX FOR TPURITM TO 30.  THIS GIVES  * 00220000
002300*           ADDITIONAL PROCESSING TIME FOR THE PO BRIDGE TO     * 00230000
002400*           CONVERT LARGE ORDERS TO RMS WITHOUT CAUSING AN ABEND* 00240000
002500*           IN THIS PROGRAM DUE TO CONTENTION.                  * 00250000
002600******************************************************************00260000
002610* TKMA888 04/18/2003 - CHANGED REPORT LAYOUT LINES FOR PURCHASE   00270000
002620* BILL SCHROEDER       ORDER AND THE COST COMPUTATION FOR ALL     00280000
002621* STRATAGEM, INC.      IMPORT PURCHASE ORDERS                     00290000
002622******************************************************************00300000
W24803* 05/14/2003  RAMA KRISHNA, IGSI                      WR 24803   *00310000
W24803*   NON-INTELLIGENT SKU PROJECT : CHANGES BEING INCORPORATED     *00320000
W24803*   INTO THIS PROGRAM                                            *00330000
003300******************************************************************00340000
002610* TKMA609 02/10/2004 - RYAN STAUFFACHER   PM00631727              00350000
002620* ADDED UNIT QUANTITY GREATER THAN ZERO CHECK TO PRE APPROVAL     00360000
002621* PACKS CURSOR, POST APPROVAL PACKS CURSOR, PRE APPROVAL UNTIED   00370000
002621* LINES CURSOR, AND POST APPROVAL UNTIED LINES CURSOR.  ADDED     00380000
002621* STORE DISTRO QUANTITY GREATER THAN ZERO CHECK TO ALLOC CURSOR   00390000
002621* AND ALLOCATIONS COUNT.                                          00400000
PE6591* PE6591  01/31/2011  ADDED NULL INDICATOR FOR PV-TOT-VAL-COST-AMT00410000
PE6591*                     AND DELAY LOGIC TO AVOID ABEND IN           00420000
PE6591*                     2101-GET-TPURCHS PARA DUE TO TIMING ISSUE   00430000
PE6591*                     IN BRIDGING BETWEEN RMS TO LEGACY. SUCH PO  00440000
PE6591*                     NUMBERS WHICH HAVE TO BE RE-PRINTED WILL BE 00450000
PE6591*                     WRITTEN TO OUTPUT FILE AFTER A WAIT TIME OF 00460000
PE6591*                     21 SECONDS AND THIS FILE WILL BE E-MAILED TO00470000
PE6591*                     MIO-RMSPO TEAM.                             00480000
PE9809* PE9809  12/05/2011  ADDED A CHECK IN 5000-FILL-PACK-LINE-TOTAL  00490000
PE9809*                     TO HANDLE DIVIDE BY EXCEPTION ABEND         00500000
PE9809*                     WHEN INPK_UNT_QTY = 0 SUCH PO'S WILL BE     00510000
PE9809*                     ERRORED OUT AND THE PO'S WILL BE WRITTERN   00520000
PE9809*                     TO AN OUTPUT FILE AND THIS OUTPUT FILE      00530000
PE9809*                     WILL BE EMAILED TO TO MIM TEAM.             00540000
003300******************************************************************00550037
002610* TKMA537 01/13/2014 - SUE BARTELT   CHG0081355                   00560038
002620* CHANGES MADE FOR MTK PACKAING CODE CHANGES.                     00570037
002621* ADDED POPRPK-PREPK-TYP-CDE TO THE FOLLOWING CURSORS:            00580037
002621* PRE-PACK-CSR, APP-PACK-CSR.  IN 3000-PROCESS-PACK-LINES CHANGED 00590037
002621* TO USE THE PACK TYPE CODE FROM TPOPRPK INSTEAD OF TPURCHS       00600037
      ***************************************************************** 00610039
C98147* 11/04/2014 - LINDA FRIESS   CHG0098147                          00620040
C98147*   EXPANDED PO NUMBER IN REPORT TO 8 DIGITS.                     00630040
003300******************************************************************00640037
002700 ENVIRONMENT DIVISION.                                            00650000
002800 CONFIGURATION SECTION.                                           00660000
002900 SOURCE-COMPUTER. IBM-3090.                                       00670000
003000 OBJECT-COMPUTER. IBM-3090.                                       00680000
003100 INPUT-OUTPUT SECTION.                                            00690000
003200 FILE-CONTROL.                                                    00700000
003300                                                                  00710000
003400     SELECT INPUT-FILE                                            00720000
003500         ASSIGN TO INP01.                                         00730000
003600     SELECT PORPT-FILE                                            00740000
003700         ASSIGN TO RPT01.                                         00750000
PE6591     SELECT INVALIDPO-FILE                                        00760000
PE6591         ASSIGN TO OUT01.                                         00770000
PE9809     SELECT ERRORPO-FILE                                          00780000
PE9809         ASSIGN TO OUT02.                                         00790000
003800                                                                  00800000
003900******************************************************************00810000
004000 DATA DIVISION.                                                   00820000
004100******************************************************************00830000
004200 FILE SECTION.                                                    00840000
004300                                                                  00850000
004400 FD  INPUT-FILE                                                   00860000
004500     RECORDING MODE IS F                                          00870000
004600     LABEL RECORDS ARE STANDARD                                   00880000
004700     RECORD CONTAINS 80 CHARACTERS                                00890000
004800     BLOCK CONTAINS 0 RECORDS.                                    00900000
004900 01  INPUT-RECORD                     PIC  X(80).                 00910000
005000                                                                  00920000
005100 FD  PORPT-FILE                                                   00930000
005200     RECORDING MODE F                                             00940000
005300     BLOCK CONTAINS 0 RECORDS                                     00950000
005400     RECORD CONTAINS 150 CHARACTERS                               00960000
005500     LABEL RECORDS ARE OMITTED                                    00970000
005600     DATA RECORD IS PORPT-RECORD.                                 00980000
005700 01  PORPT-RECORD                     PIC  X(150).                00990000
005800                                                                  01000000
PE6591 FD  INVALIDPO-FILE                                               01010000
PE6591     RECORDING MODE F                                             01020000
PE6591     BLOCK CONTAINS 0 RECORDS                                     01030000
PE6591     RECORD CONTAINS 80 CHARACTERS                                01040000
PE6591     LABEL RECORDS ARE OMITTED                                    01050000
PE6591     DATA RECORD IS INVALID-PO-RECORD.                            01060000
PE6591 01  INVALID-PO-RECORD                 PIC  X(80).                01070000
PE6591                                                                  01080000
PE9809 FD  ERRORPO-FILE                                                 01090000
PE9809     RECORDING MODE F                                             01100000
PE9809     BLOCK CONTAINS 0 RECORDS                                     01110000
PE9809     RECORD CONTAINS 32 CHARACTERS                                01120000
PE9809     LABEL RECORDS ARE OMITTED                                    01130000
PE9809     DATA RECORD IS ERROR-PO-RECORD.                              01140000
PE9809 01  ERROR-PO-RECORD                 PIC  X(32).                  01150000
006000                                                                  01160000
005900 WORKING-STORAGE SECTION.                                         01170000
006000                                                                  01180000
006100 01  IR-INPUT-RECORD.                                             01190000
006200     05  IR-PO-NBR                    PIC S9(09) COMP.            01200000
006300     05  IR-RPT-TYPE-BY               PIC  X(02).                 01210000
006400     05  IR-RPT-TYPE-VN               PIC  X(02).                 01220000
006500     05  IR-RPT-TYPE-DC               PIC  X(02).                 01230000
006600     05  IR-RPT-TYPE-AN               PIC  X(02).                 01240000
006700     05  FILLER                       PIC  X(65).                 01250000
006800                                                                  01260000
006900 01  SD-SYSTEM-DATE.                                              01270000
007000     05  SD-SYSTEM-YY                 PIC  9(02) VALUE ZEROES.    01280000
007100     05  SD-SYSTEM-MM                 PIC  9(02) VALUE ZEROES.    01290000
007200     05  SD-SYSTEM-DD                 PIC  9(02) VALUE ZEROES.    01300000
007300                                                                  01310000
007400 01  ST-SYSTEM-TIME.                                              01320000
007500     05  ST-SYSTEM-HH                 PIC  9(02) VALUE ZEROES.    01330000
007600     05  ST-SYSTEM-MM                 PIC  9(02) VALUE ZEROES.    01340000
007700     05  ST-SYSTEM-SS                 PIC  9(02) VALUE ZEROES.    01350000
007800     05  FILLER                       PIC  9(02) VALUE ZEROES.    01360000
007900                                                                  01370000
008000 01  PS-PROGRAM-SWITCHES.                                         01380000
008100     05  PS-EOF-INPUT-FILE-SW         PIC  X(01) VALUE 'N'.       01390000
008200         88  PS-EOF-INPUT-FILE                   VALUE 'Y'.       01400000
008300     05  PS-EOF-INST-CSR-SW           PIC  X(01) VALUE 'N'.       01410000
008400         88  PS-EOF-INST-CSR                     VALUE 'Y'.       01420000
008500         88  PS-NOT-EOF-INST-CSR                 VALUE 'N'.       01430000
008600     05  PS-EOF-PO-PACK-CSR-SW        PIC  X(01) VALUE 'N'.       01440000
008700         88  PS-EOF-PO-PACK-CSR                  VALUE 'Y'.       01450000
008800         88  PS-NOT-EOF-PO-PACK-CSR              VALUE 'N'.       01460000
008900     05  PS-EOF-PO-LINE-CSR-SW        PIC  X(01) VALUE 'N'.       01470000
009000         88  PS-EOF-PO-LINE-CSR                  VALUE 'Y'.       01480000
009100         88  PS-NOT-EOF-PO-LINE-CSR              VALUE 'N'.       01490000
009200     05  PS-EOF-ALLOC-CSR-SW          PIC  X(01) VALUE 'N'.       01500000
009300         88  PS-EOF-ALLOC-CSR                    VALUE 'Y'.       01510000
009400         88  PS-NOT-EOF-ALLOC-CSR                VALUE 'N'.       01520000
009500     05  PS-WROTE-UNAVAIL-HDR-SW      PIC  X(01) VALUE 'N'.       01530000
009600         88  PS-WROTE-UNAVAIL-HEADER             VALUE 'Y'.       01540000
009700         88  PS-NOT-WROTE-UNAVAIL-HEADER         VALUE 'N'.       01550000
009800     05  PS-WRITE-UNAVAIL-SW          PIC  X(01) VALUE 'N'.       01560000
009900         88  PS-WRITE-UNAVAIL                    VALUE 'Y'.       01570000
010000         88  PS-NOT-WRITE-UNAVAIL                VALUE 'N'.       01580000
010100     05  PS-PRINT-PACK-LINE-SW        PIC  X(01) VALUE 'N'.       01590000
010200         88  PS-PRINT-PACK-LINE-TOTAL            VALUE 'Y'.       01600000
010300         88  PS-NOT-PRINT-PACK-LINE-TOTAL        VALUE 'N'.       01610000
010400     05  PS-TYPE-RPT-PROCESS-SW       PIC  X(01) VALUE ' '.       01620000
010500         88  PS-BUYER-RPT-TYPE                   VALUE 'B'.       01630000
010600         88  PS-ANALYST-RPT-TYPE                 VALUE 'A'.       01640000
010700         88  PS-VENDOR-RPT-TYPE                  VALUE 'V'.       01650000
010800         88  PS-DC-RPT-TYPE                      VALUE 'D'.       01660000
PE6591     05  PS-INVALID-PO-SW             PIC  X(01) VALUE 'N'.       01670000
PE6591         88  PS-INVALID-PO                       VALUE 'Y'.       01680000
PE6591         88  PS-NOT-INVALID-PO                   VALUE 'N'.       01690000
PE9809     05  PS-ERROR-PO-SW               PIC  X(01) VALUE 'N'.       01700000
PE9809         88  PS-ERROR-PO                         VALUE 'Y'.       01710000
010900                                                                  01720000
011000 01  PC-PROGRAM-CONSTANTS.                                        01730000
011100     05  PC-INIT-DATE                 PIC  X(10) VALUE            01740000
011200                                                     '0001-01-01'.01750000
011300     05  PC-STORE-QTY                 PIC  X(21) VALUE            01760000
011400         ' --STORE-- QUANTITY  '.                                 01770000
011500     05  PC-SHIP-INST-ATT             PIC  X(31) VALUE            01780000
011600         'REFER TO SHIPPING INSTRUCTIONS '.                       01790000
011700     05  PC-SHIP-INST-FOLL            PIC  X(31) VALUE            01800000
011800         'SHIPPING INSTRUCTIONS TO FOLLOW'.                       01810000
011900     05  PC-MONTH-ABBR-TABLE.                                     01820000
012000         10  FILLER                   PIC  X(03) VALUE 'JAN'.     01830000
012100         10  FILLER                   PIC  X(03) VALUE 'FEB'.     01840000
012200         10  FILLER                   PIC  X(03) VALUE 'MAR'.     01850000
012300         10  FILLER                   PIC  X(03) VALUE 'APR'.     01860000
012400         10  FILLER                   PIC  X(03) VALUE 'MAY'.     01870000
012500         10  FILLER                   PIC  X(03) VALUE 'JUN'.     01880000
012600         10  FILLER                   PIC  X(03) VALUE 'JUL'.     01890000
012700         10  FILLER                   PIC  X(03) VALUE 'AUG'.     01900000
012800         10  FILLER                   PIC  X(03) VALUE 'SEP'.     01910000
012900         10  FILLER                   PIC  X(03) VALUE 'OCT'.     01920000
013000         10  FILLER                   PIC  X(03) VALUE 'NOV'.     01930000
013100         10  FILLER                   PIC  X(03) VALUE 'DEC'.     01940000
013200     05  FILLER REDEFINES PC-MONTH-ABBR-TABLE.                    01950000
013300         10  PC-MONTH-ABBR OCCURS 12 TIMES                        01960000
013400                                      PIC  X(03).                 01970000
013500     05  PC-DPKUT410                  PIC  X(08) VALUE 'DPKUT410'.01980000
013600     05  PC-MAX-RETRIES               PIC S9(04) VALUE  +30       01990000
013700                                                 COMP.            02000000
PE6591     05  PC-MAX-WAIT-RETRY            PIC S9(04) VALUE  +2        02010000
PE6591                                                 COMP.            02020000
PE6591     05  PC-DELAY-INTERVAL.                                       02030000
PE6591         10  FILLER                PIC X(2)   VALUE SPACES.       02040000
PE6591         10  PC-DELAY-TIME         PIC 9(8)   VALUE 0700.         02050000
013800                                                                  02060000
013900 01  PV-PROGRAM-VARIABLES.                                        02070000
014000     05  PV-ABEND-PARAGRAPH           PIC  X(30) VALUE SPACES.    02080000
014100     05  PV-ABEND-CODE                PIC S9(04) VALUE +0         02090000
014200                                                 COMP.            02100000
014300     05  PV-NULL-IND                  PIC S9(04) VALUE +0         02110000
014400                                                 COMP.            02120000
014500     05  PV-PAGE-CNT                  PIC S9(07) VALUE  0         02130000
014600                                                 COMP-3.          02140000
014700     05  PV-REMAINDER                 PIC S9(04) VALUE +0         02150000
014800                                                 COMP.            02160000
014900     05  PV-PACK-UNITS                PIC S9(09) VALUE +0         02170000
015000                                                 COMP-3.          02180000
015100     05  PV-LINE-CNT                  PIC 9(06).                  02190000
015200     05  PV-ALLOC-CNT                 PIC S9(09) COMP-3.          02200000
015300     05  PV-TEMP-LINE-CNT             PIC S9(09) COMP-3.          02210000
015400     05  PV-PO-LNE-NBR                PIC S9(09)   COMP.          02220000
015500     05  PV-SUB                       PIC S9(04) COMP VALUE +0.   02230000
015600     05  PV-DB2-COUNT                 PIC S9(09) VALUE +0         02240000
015700                                                 COMP-3.          02250000
015800     05  PV-PACK-ID-NUM               PIC  9(3)  VALUE 0.         02260000
015900     05  PV-DATE-BREAK.                                           02270000
016000         10  PV-DB-CC                 PIC  X(02).                 02280000
016100         10  PV-DB-YY                 PIC  X(02).                 02290000
016200         10  FILLER                   PIC  X(01).                 02300000
016300         10  PV-DB-MM                 PIC  X(02).                 02310000
016400         10  FILLER                   PIC  X(01).                 02320000
016500         10  PV-DB-DD                 PIC  X(02).                 02330000
016600     05  PV-DATE-BREAK-SLASH.                                     02340000
016700         10  PV-DBS-MM                PIC  X(02).                 02350000
016800         10  FILLER                   PIC  X(01) VALUE '/'.       02360000
016900         10  PV-DBS-DD                PIC  X(02).                 02370000
017000         10  FILLER                   PIC  X(01) VALUE '/'.       02380000
017100         10  PV-DBS-YY                PIC  X(02).                 02390000
017200     05  PV-OTB-PER-BREAK             PIC  X(06).                 02400000
017300     05  FILLER REDEFINES PV-OTB-PER-BREAK.                       02410000
017400         10  PV-OTBP-CC               PIC  X(02).                 02420000
017500         10  PV-OTBP-YY               PIC  X(02).                 02430000
017600         10  PV-OTBP-MM               PIC  X(02).                 02440000
017700         10  PV-OTBP-MM-N REDEFINES PV-OTBP-MM                    02450000
017800                                      PIC  9(02).                 02460000
017900     05  PV-EDIT-DISC-PCT             PIC  ZZ.                    02470000
018000     05  PV-NUM-DISC-PCT              PIC  9(02) VALUE ZERO.      02480000
018100     05  PV-EDIT-DISC-DAYS            PIC  ZZZ.                   02490000
018200     05  PV-EDIT-DUE-DAYS             PIC  ZZZ.                   02500000
018300     05  PV-EDIT-PAYT-TERM-ID         PIC  ZZ9.                   02510000
018400     05  PV-EDIT-ZIP-CODE             PIC  X(10).                 02520000
018500     05  PV-EDIT-ZIP-NO-DASH REDEFINES PV-EDIT-ZIP-CODE.          02530000
018600         10  PV-EZND-1-5              PIC  X(05).                 02540000
018700         10  PV-EZND-6-9              PIC  X(04).                 02550000
018800         10  FILLER                   PIC  X(01).                 02560000
018900     05  PV-EDIT-ZIP-DASH REDEFINES PV-EDIT-ZIP-CODE.             02570000
019000         10  PV-EZD-1-5               PIC  X(05).                 02580000
019100         10  PV-EZD-DASH              PIC  X(01).                 02590000
               10  PV-EZD-6-9               PIC  X(04).                 02600000
           05  PV-ZIP-CODE-DISPLAY.                                     02610000
               10  PV-ZCD-1-5               PIC  X(05).                 02620000
               10  FILLER                   PIC  X(01) VALUE '-'.       02630000
               10  PV-ZCD-6-9               PIC  X(04).                 02640000
019200     05  PV-EDIT-MU-PCT               PIC  ZZZ.99.                02650000
019300     05  PV-DOL-FORM-13               PIC  $$,$$$,$$$.99.         02660000
019400     05  PV-DOL-FORM-14               PIC  $$$,$$$,$$$.99.        02670000
019500     05  PV-PCT-HOLD                  PIC  9(04)V9(04).           02680000
019600     05  PV-RECIP-CDE-HOLD            PIC  X(02).                 02690000
019700     05  PV-NBR-TIMES                 PIC S9(09) COMP-3.          02700000
019800     05  ASC-PAYT-TERM-ID-DESC        PIC X(28)     VALUE SPACES. 02710000
019900     05  IR-PO-NBR2                   PIC S9(09)    VALUE +0 COMP.02720000
PE9809     05  OUT-PO-NBR                   PIC S9(09)    VALUE +0 COMP.02730000
020000     05  PV-CITY                      PIC  X(15).                 02740000
020100     05  PV-STATE-PROV                PIC  X(30).                 02750000
020200     05  PV-COUNTRY                   PIC  X(30).                 02760000
020300     05  PV-QUOTIENT                  PIC S9(04)   VALUE +0       02770000
020400                                                     COMP SYNC.   02780000
020500     05  PV-RETRY-COUNTER             PIC S9(04) VALUE +0         02790000
020600                                                 COMP SYNC.       02800000
020601* TKMA888 * ADDED 1 LINE *****************************************02810000
020602*           FOR COMPUTING TOTAL PO COST FOR IMPORT PO'S           02820000
020603* TKMA888 *------------------------------------------------------*02830000
020610     05  PV-TOT-VAL-COST-AMT          PIC S9(11)V9(03) COMP-3.    02840000
020620* TKMA888 *------------------------------------------------------*02850000
020700                                                                  02860000
W24803     05  PV-NULL-INDICATOR-VARIABLES.                             02870000
W24803         10 PV-MAJ-CL-NBR-IND         PIC S9(04) COMP VALUE +0.   02880000
W24803         10 PV-SUB-CL-NBR-IND         PIC S9(04) COMP VALUE +0.   02890000
W24803         10 PV-SKU-NBR-IND            PIC S9(04) COMP VALUE +0.   02900000
W24803         10 PV-VS-NBR-IND             PIC S9(04) COMP VALUE +0.   02910000
W24803         10 PV-SKU-DESC-IND           PIC S9(04) COMP VALUE +0.   02920000
W24803         10 PV-CSTM-CLOR-DESC-IND     PIC S9(04) COMP VALUE +0.   02930000
W24803         10 PV-SIZE-DESC-IND          PIC S9(04) COMP VALUE +0.   02940000
PE6591         10 PV-TOT-VAL-COST-AMT-IND   PIC S9(04) COMP VALUE +0.   02950000
W24803                                                                  02960000
W24803     05 PV-TEMP-SKU.                                              02970000
W24803         10 PV-TEMP-DEPT              PIC  9(03) VALUE ZEROES.    02980000
W24803         10 PV-TEMP-CLASS             PIC  9(02) VALUE ZEROES.    02990000
W24803         10 PV-TEMP-SEQ               PIC  9(03) VALUE ZEROES.    03000000
W24803                                                                  03010000
W24803     05 PV-TEMP-MAJ-CL.                                           03020000
W24803         10 PV-TEMP-MAJ-CL-1          PIC  9(01) VALUE 0.         03030000
W24803         10 FILLER                    PIC  9(01) VALUE 0.         03040000
W24803                                                                  03050000
W24803     05 PV-CLASS                      PIC  9(02) VALUE ZEROES.    03060000
W24803     05 PV-SKU                        PIC  9(08) VALUE ZEROES.    03070000
                                                                        03080000
PE6591     05 INVALID-PO-REC.                                           03090000
PE6591        10 INVALID-PO-DET             PIC  X(30) VALUE            03100000
PE6591           ' PO PRINT HAD FAILED FOR PO # '.                      03110000
PE6591        10 INVALID-PO                 PIC  X(10) VALUE ZEROES.    03120000
PE6591        10 FILLER                     PIC  X(40) VALUE SPACES.    03130000
                                                                        03140000
PE6591     05 INVALID-PO-MSG.                                           03150000
PE6591        10 FILLER                     PIC X(51) VALUE             03160000
PE6591        ' BUYING OFFICE NEEDS TO MANUALLY RE-PRINT THE ORDER'.    03170000
PE6591        10 FILLER                     PIC X(26) VALUE             03180000
PE6591        ' IF A SOFT COPY IS NEEDED.'.                             03190000
PE6591        10 FILLER                     PIC X(3) VALUE SPACES.      03200000
                                                                        03210000
PE9809     05 ERROR-PO-REC.                                             03220000
PE9809        10 ERROR-PO-DET               PIC  X(12) VALUE            03230000
PE9809           ' ERROR PO # '.                                        03240000
PE9809        10 ERROR-PO                   PIC  X(10) VALUE ZEROES.    03250000
PE9809        10 FILLER                     PIC  X(01) VALUE SPACES.    03260000
PE9809        10 ERROR-PO-IN                PIC  X(09) VALUE            03270000
PE9809           'IGNORED '.                                            03280000
020400*---------------------------------------------------------------* 03290000
020800******************************************************************03300000
020900*  COMMUNICATIONS AREA2 FOR DB2                                   03310000
021000******************************************************************03320000
021100     COPY SQLCA2.                                                 03330000
021200                                                                  03340000
021300******************************************************************03350000
021400*  WORKING STORAGE AREA FOR NAME REFORMAT DPPD024                 03360000
021500******************************************************************03370000
021600     COPY DPWS024.                                                03380000
021700                                                                  03390000
021800******************************************************************03400000
021900*  WORKING STORAGE AREA FOR PAYMENT TERMS                         03410000
022000******************************************************************03420000
022100     COPY POWS020.                                                03430000
022200                                                                  03440000
022300******************************************************************03450000
022400*  WORKING STORAGE AREA FOR COUNTRY AND STATE RETRIEVAL           03460000
022500******************************************************************03470000
022600     COPY DPWS410.                                                03480000
022700                                                                  03490000
022800******************************************************************03500000
022900*  PURCHASE ORDER REPORT PRINT LINES                              03510000
023000******************************************************************03520000
023100 01  HEADER-LINE1.                                                03530000
023200     05  FILLER                       PIC  X(11) VALUE            03540000
023300         'PO NUMBER: '.                                           03550000
C98147     05  HL1-PO-NBR                   PIC  ZZZZZZZZ.              03560040
C98147     05  FILLER                       PIC  X(03) VALUE SPACES.    03570040
023600     05  FILLER                       PIC  X(12) VALUE            03580000
023700         'ORDER DATE: '.                                          03590000
023800     05  HL1-ORD-DATE                 PIC  X(08).                 03600000
023900     05  FILLER                       PIC  X(09) VALUE SPACES.    03610000
024000     05  FILLER                       PIC  X(08) VALUE 'K O H L '.03620000
024100     05  FILLER                       PIC  X(01) VALUE QUOTE.     03630000
024200     05  FILLER                       PIC  X(38) VALUE            03640000
024300         ' S   D E P A R T M E N T   S T O R E S'.                03650000
024400     05  FILLER                       PIC  X(18) VALUE SPACES.    03660000
024500     05  FILLER                       PIC  X(06) VALUE 'DATE: '.  03670000
024600     05  HL1-RUN-MONTH                PIC  X(02).                 03680000
024700     05  FILLER                       PIC  X(01) VALUE '/'.       03690000
024800     05  HL1-RUN-DAY                  PIC  X(02).                 03700000
024900     05  FILLER                       PIC  X(01) VALUE '/'.       03710000
025000     05  HL1-RUN-YEAR                 PIC  X(02).                 03720000
025100     05  FILLER                       PIC  X(06) VALUE SPACES.    03730000
025200     05  FILLER                       PIC  X(06) VALUE 'TIME: '.  03740000
025300     05  HL1-RUN-HOUR                 PIC  X(02).                 03750000
025400     05  FILLER                       PIC  X(01) VALUE ':'.       03760000
025500     05  HL1-RUN-MINUTE               PIC  X(02).                 03770000
025600     05  FILLER                       PIC  X(01) VALUE ':'.       03780000
025700     05  HL1-RUN-SECOND               PIC  X(02).                 03790000
025800                                                                  03800000
025900 01  HEADER-LINE2.                                                03810000
026000     05  FILLER                       PIC  X(11) VALUE            03820000
026100         'DEPT.....: '.                                           03830000
026200     05  HL2-DEPT-NBR                 PIC  X(03).                 03840000
026300     05  FILLER                       PIC  X(02) VALUE SPACES.    03850000
026400     05  HL2-DEPT-NAME                PIC  X(25).                 03860000
026500     05  FILLER                       PIC  X(01) VALUE SPACES.    03870000
026600     05  FILLER                       PIC  X(46) VALUE            03880000
026700         'P U R C H A S E   O R D E R - (SUBJECT TO KOHL'.        03890000
026800     05  FILLER                       PIC  X(01) VALUE QUOTE.     03900000
026900     05  FILLER                       PIC  X(23) VALUE            03910000
027000         'S TERMS AND CONDITIONS)'.                               03920000
027100     05  FILLER                       PIC  X(24) VALUE SPACES.    03930000
027200     05  FILLER                       PIC  X(06) VALUE 'PAGE: '.  03940000
027300     05  HL2-PAGE                     PIC  ZZZZ,ZZZ.              03950000
027400                                                                  03960000
027500 01  HEADER-LINE3.                                                03970000
027600     05  FILLER                       PIC  X(69) VALUE SPACES.    03980000
027700     05  HL3-VERSION                  PIC  X(12).                 03990000
027800     05  FILLER                       PIC  X(69) VALUE SPACES.    04000000
027900                                                                  04010000
028000 01  HEADER-LINE4.                                                04020000
028100     05  FILLER                       PIC  X(10) VALUE            04030000
028200         ' VENDOR.: '.                                            04040000
028300     05  HL4-VEND-NAME                PIC  X(30).                 04050000
028400     05  FILLER                       PIC  X(20) VALUE SPACES.    04060000
028500     05  FILLER                       PIC  X(17) VALUE            04070000
028600         'MARKUP.........: '.                                     04080000
028700     05  HL4-MU-PCT                   PIC  X(06).                 04090000
028800     05  FILLER                       PIC  X(02) VALUE ' %'.      04100000
028900     05  FILLER                       PIC  X(28) VALUE SPACES.    04110000
029000     05  FILLER                       PIC  X(26) VALUE            04120000
029100         'DO NOT SHIP BEFORE......: '.                            04130000
029200     05  HL4-DNSB-MONTH               PIC  X(02).                 04140000
029300     05  FILLER                       PIC  X(01) VALUE '/'.       04150000
029400     05  HL4-DNSB-DAY                 PIC  X(02).                 04160000
029500     05  FILLER                       PIC  X(01) VALUE '/'.       04170000
029600     05  HL4-DNSB-YEAR                PIC  X(02).                 04180000
029700     05  FILLER                       PIC  X(03) VALUE SPACES.    04190000
029800                                                                  04200000
029900 01  HEADER-LINE5.                                                04210000
030000     05  FILLER                       PIC  X(10) VALUE SPACES.    04220000
030100     05  HL5-VEND-ADDR-1              PIC  X(40).                 04230000
030200     05  FILLER                       PIC  X(10) VALUE SPACES.    04240000
030300     05  FILLER                       PIC  X(17) VALUE            04250000
030400         'COST...........: '.                                     04260000
030500     05  HL5-COST                     PIC  $$$,$$$,$$$.99.        04270000
030600     05  FILLER                       PIC  X(22) VALUE SPACES.    04280000
030700     05  FILLER                       PIC  X(26) VALUE            04290000
030800         'CANCEL IF NOT SHIPPED BY: '.                            04300000
030900     05  HL5-CNSB-MONTH               PIC  X(02).                 04310000
031000     05  FILLER                       PIC  X(01) VALUE '/'.       04320000
031100     05  HL5-CNSB-DAY                 PIC  X(02).                 04330000
031200     05  FILLER                       PIC  X(01) VALUE '/'.       04340000
031300     05  HL5-CNSB-YEAR                PIC  X(02).                 04350000
031400     05  FILLER                       PIC  X(03) VALUE SPACES.    04360000
031500                                                                  04370000
031600 01  HEADER-LINE6.                                                04380000
031700     05  FILLER                       PIC  X(10) VALUE SPACES.    04390000
031800     05  HL6-VEND-ADDR-2              PIC  X(40).                 04400000
031900     05  FILLER                       PIC  X(10) VALUE SPACES.    04410000
032000     05  FILLER                       PIC  X(17) VALUE            04420000
032100         'RETAIL.........: '.                                     04430000
032200     05  HL6-RETAIL                   PIC  X(14).                 04440000
032300     05  FILLER                       PIC  X(22) VALUE SPACES.    04450000
032400     05  FILLER                       PIC  X(26) VALUE            04460000
032500         'OTB PERIOD..............: '.                            04470000
032600     05  HL6-OTBP-MONTH               PIC  X(03).                 04480000
032700     05  FILLER                       PIC  X(01) VALUE ' '.       04490000
032800     05  HL6-OTBP-YEAR                PIC  X(02).                 04500000
032900     05  FILLER                       PIC  X(05) VALUE SPACES.    04510000
033000                                                                  04520000
033100 01  HEADER-LINE7.                                                04530000
033200     05  FILLER                       PIC  X(10) VALUE SPACES.    04540000
033300     05  HL7-VEND-ADDR-3              PIC  X(40).                 04550000
033400     05  FILLER                       PIC  X(10) VALUE SPACES.    04560000
033500     05  FILLER                       PIC  X(17) VALUE            04570000
033600         'UNITS..........: '.                                     04580000
033700     05  HL7-UNITS                    PIC  Z,ZZZ,ZZZ.             04590000
033800     05  FILLER                       PIC  X(27) VALUE SPACES.    04600000
033900     05  FILLER                       PIC  X(15) VALUE            04610000
034000         'EDI..........: '.                                       04620000
034100     05  HL7-EDI                      PIC  X(03).                 04630000
034200     05  FILLER                       PIC  X(02) VALUE SPACES.    04640000
034300     05  HL7-EDI-DEAL                 PIC  X(16).                 04650000
034400     05  FILLER                       PIC  X(01) VALUE SPACES.    04660000
034500                                                                  04670000
034600 01  HEADER-LINE8.                                                04680000
034700     05  FILLER                       PIC  X(60) VALUE SPACES.    04690000
034800     05  FILLER                       PIC  X(17) VALUE            04700000
034900         'PAYMENT TERM...: '.                                     04710000
035000     05  HL8-PAY-TERM                 PIC  X(28).                 04720000
035100     05  FILLER                       PIC  X(08) VALUE SPACES.    04730000
035200     05  FILLER                       PIC  X(15) VALUE            04740000
035300         'NEW STORE....: '.                                       04750000
035400     05  HL8-NEW-STORE                PIC  X(03).                 04760000
035500     05  FILLER                       PIC  X(19) VALUE SPACES.    04770000
035600                                                                  04780000
035700 01  HEADER-LINE9.                                                04790000
035800     05  FILLER                       PIC  X(60) VALUE SPACES.    04800000
035900     05  FILLER                       PIC  X(17) VALUE            04810000
036000         'EXTENDED DATING: '.                                     04820000
036100     05  HL9-EXTEND-DATE              PIC  ZZZ.                   04830000
036200     05  FILLER                       PIC  X(05) VALUE ' DAYS'.   04840000
036300     05  FILLER                       PIC  X(28) VALUE SPACES.    04850000
036400     05  FILLER                       PIC  X(15) VALUE            04860000
036500         'PRETICKETING.: '.                                       04870000
036600     05  HL9-PRE-TICK                 PIC  X(03).                 04880000
036700     05  FILLER                       PIC  X(14) VALUE            04890000
036800         '    HANGERS.: '.                                        04900000
036900     05  HL9-HANGERS                  PIC  X(03).                 04910000
037000     05  FILLER                       PIC  X(02) VALUE SPACES.    04920000
037100                                                                  04930000
037200 01  HEADER-LINE10.                                               04940000
037300     05  FILLER                       PIC  X(10) VALUE            04950000
037400         ' SHIP TO: '.                                            04960000
037500     05  HL10-SHIP-TO-NAME            PIC  X(31).                 04970000
037600     05  FILLER                       PIC  X(19) VALUE SPACES.    04980000
037700     05  FILLER                       PIC  X(17) VALUE            04990000
037800         'VENDOR DISCOUNT: '.                                     05000000
037900     05  HL10-VEND-DIS-AMT            PIC  $$$$$$.99.             05010000
038000     05  FILLER                       PIC  X(02) VALUE SPACES.    05020000
038100     05  HL10-VEND-DIS-PCT            PIC  ZZ.99.                 05030000
038200     05  FILLER                       PIC  X(02) VALUE ' %'.      05040000
038300     05  FILLER                       PIC  X(55) VALUE SPACES.    05050000
038400                                                                  05060000
038500 01  HEADER-LINE11.                                               05070000
038600     05  FILLER                       PIC  X(10) VALUE SPACES.    05080000
038700     05  HL11-SHIP-TO-ADDR-1          PIC  X(30).                 05090000
038800     05  FILLER                       PIC  X(20) VALUE SPACES.    05100000
038900     05  FILLER                       PIC  X(17) VALUE            05110000
039000         'MARK OUT OF STK: '.                                     05120000
039100     05  HL11-MOS-PCT                 PIC  ZZ.99.                 05130000
039200     05  FILLER                       PIC  X(02) VALUE ' %'.      05140000
039300     05  FILLER                       PIC  X(29) VALUE SPACES.    05150000
039400     05  FILLER                       PIC  X(15) VALUE            05160000
039500         'CREATED BY...: '.                                       05170000
039600     05  HL11-CREATED-BY              PIC  X(20).                 05180000
039700     05  FILLER                       PIC  X(02) VALUE SPACES.    05190000
039800                                                                  05200000
039900 01  HEADER-LINE12.                                               05210000
040000     05  FILLER                       PIC  X(10) VALUE SPACES.    05220000
040100     05  HL12-SHIP-TO-ADDR-2          PIC  X(40).                 05230000
040200     05  FILLER                       PIC  X(10) VALUE SPACES.    05240000
040300     05  FILLER                       PIC  X(17) VALUE            05250000
040400         'TRADE..........: '.                                     05260000
040500     05  HL12-TRD-PCT                 PIC  ZZ.99.                 05270000
040600     05  FILLER                       PIC  X(02) VALUE ' %'.      05280000
040700     05  FILLER                       PIC  X(29) VALUE SPACES.    05290000
040800     05  FILLER                       PIC  X(15) VALUE            05300000
040900         'BUYER........: '.                                       05310000
041000     05  HL12-BUYER                   PIC  X(20).                 05320000
041100     05  FILLER                       PIC  X(02) VALUE SPACES.    05330000
041200                                                                  05340000
041300 01  HEADER-LINE13.                                               05350000
041400     05  FILLER                       PIC  X(10) VALUE SPACES.    05360000
041500     05  HL13-SHIP-TO-ADDR-3          PIC  X(40).                 05370000
041600     05  FILLER                       PIC  X(10) VALUE SPACES.    05380000
041700     05  FILLER                       PIC  X(17) VALUE            05390000
041800         'ADVERTISING PCT: '.                                     05400000
041900     05  HL13-ADV-PCT                 PIC  ZZ.99.                 05410000
042000     05  FILLER                       PIC  X(02) VALUE ' %'.      05420000
042100     05  FILLER                       PIC  X(29) VALUE SPACES.    05430000
042200     05  FILLER                       PIC  X(15) VALUE            05440000
042300         'APPROVED BY..: '.                                       05450000
042400     05  HL13-APPROVE-BY              PIC  X(20).                 05460000
042500     05  FILLER                       PIC  X(02) VALUE SPACES.    05470000
042600                                                                  05480000
042700 01  HEADER-LINE14.                                               05490000
042800     05  FILLER                       PIC  X(60) VALUE SPACES.    05500000
042900     05  FILLER                       PIC  X(20) VALUE            05510000
043000         'ADDITIONAL DISCOUNTS'.                                  05520000
043100     05  FILLER                       PIC  X(70) VALUE SPACES.    05530000
043200                                                                  05540000
043300 01  HEADER-LINE15.                                               05550000
043400     05  FILLER                       PIC  X(60) VALUE SPACES.    05560000
043500     05  FILLER                       PIC  X(17) VALUE            05570000
043600         'MISC. DAY(S)...: '.                                     05580000
043700     05  HL15-ADDL-DAYS               PIC  ZZZ.                   05590000
043800     05  FILLER                       PIC  X(72) VALUE SPACES.    05600000
043900                                                                  05610000
044000 01  HEADER-LINE16.                                               05620000
044100     05  FILLER                       PIC  X(60) VALUE SPACES.    05630000
044200     05  FILLER                       PIC  X(17) VALUE            05640000
044300         'MISC. AMOUNT...: '.                                     05650000
044400     05  HL16-ADDL-AMOUNT             PIC  ZZZZZZ.99.             05660000
044500     05  FILLER                       PIC  X(66) VALUE SPACES.    05670000
044600                                                                  05680000
044700 01  HEADER-LINE17.                                               05690000
044800     05  FILLER                       PIC  X(60) VALUE SPACES.    05700000
044900     05  FILLER                       PIC  X(17) VALUE            05710000
045000         'MISC. PERCENT..: '.                                     05720000
045100     05  HL17-ADDL-PERCENT            PIC  ZZ.99.                 05730000
045200     05  FILLER                       PIC  X(02) VALUE ' %'.      05740000
045300     05  FILLER                       PIC  X(68) VALUE SPACES.    05750000
045400                                                                  05760000
045500 01  HEADER-LINE18.                                               05770000
045600     05  FILLER                       PIC  X(60) VALUE SPACES.    05780000
045700     05  FILLER                       PIC  X(17) VALUE            05790000
045800         'PAYS FREIGHT...: '.                                     05800000
045900     05  HL18-PAY-FRT                 PIC  X(10).                 05810000
046000     05  FILLER                       PIC  X(65) VALUE SPACES.    05820000
046100                                                                  05830000
046200 01  HEADER-LINE19.                                               05840000
046300     05  FILLER                       PIC  X(60) VALUE SPACES.    05850000
046400     05  FILLER                       PIC  X(17) VALUE            05860000
046500         'AD MERCHANDISE.: '.                                     05870000
046600     05  HL19-AD-MERCH                PIC  X(03).                 05880000
046700     05  FILLER                       PIC  X(10) VALUE            05890000
046800         ' AD DATE: '.                                            05900000
046900     05  HL19-AD-DATE                 PIC  X(08).                 05910000
047000     05  FILLER                       PIC  X(52) VALUE SPACES.    05920000
047100                                                                  05930000
047200 01  INSTR-HEADER.                                                05940000
047300     05  FILLER                       PIC  X(13) VALUE            05950000
047400         'INSTRUCTIONS:'.                                         05960000
047500     05  FILLER                       PIC  X(137) VALUE SPACES.   05970000
047600                                                                  05980000
047700 01  INSTR-RECIP-LINE.                                            05990000
047800     05  FILLER                       PIC  X(13) VALUE            06000000
047900         '  RECIPIENT: '.                                         06010000
048000     05  INSTR-RECIP                  PIC  X(15).                 06020000
048100     05  FILLER                       PIC  X(122) VALUE SPACES.   06030000
048200                                                                  06040000
048300 01  INSTR-LINE.                                                  06050000
048400     05  INSTR-DESC                   PIC  X(150).                06060000
048500                                                                  06070000
048600 01  DISTR-HEADER-1.                                              06080000
048700     05  FILLER                       PIC  X(22) VALUE            06090000
048800         '   STORE DISTRIBUTION:'.                                06100000
048900     05  FILLER                       PIC  X(128) VALUE SPACES.   06110000
049000                                                                  06120000
049100 01  DISTR-HEADER-2.                                              06130000
049200     05  FILLER                       PIC  X(03) VALUE SPACES.    06140000
049300     05  DH2-COL-HDR                  OCCURS 7 TIMES              06150000
049400                                      PIC  X(21).                 06160000
049500                                                                  06170000
049600 01  DISTR-LINE.                                                  06180000
049700     05  FILLER                       PIC  X(03) VALUE SPACES.    06190000
049800     05  DL-DISTR                     OCCURS 7 TIMES.             06200000
049900         10  FILLER                   PIC  X(01) VALUE SPACES.    06210000
050000         10  DL-STR-NBR               PIC  ZZZZ.                  06220000
050100         10  FILLER                   PIC  X(01) VALUE SPACES.    06230000
050200         10  DL-STR-NAME              PIC  X(05).                 06240000
050300         10  FILLER                   PIC  X(02) VALUE SPACES.    06250000
050400         10  DL-QTY                   PIC  ZZZ,ZZZ.               06260000
050500         10  FILLER                   PIC  X(01) VALUE SPACES.    06270000
050600                                                                  06280000
050700 01  PACK-LINE-TOTAL-MULTI.                                       06290000
050800     05  FILLER                       PIC  X(13) VALUE            06300000
050810* TKMA888 * REPLACED 1 LINE WITH 1 LINE **************************06310000
050820*           TO CHANGE FIELD LABEL                                 06320000
050830* TKMA888 *------------------------------------------------------*06330000
050900*        'PACK ......: '.                                         06340000
050910         'PACK ID ...: '.                                         06350000
050920* TKMA888 *------------------------------------------------------*06360000
051000     05  PKT-PACK-ID-MULTI            PIC  ZZ9.                   06370000
051010* TKMA888 * ADDED 4 LINES ****************************************06380000
051020*           TO CHANGE FIELD LABEL                                 06390000
051030* TKMA888 *------------------------------------------------------*06400000
051100     05  FILLER                       PIC  X(07) VALUE SPACES.    06410000
051200     05  FILLER                       PIC  X(10) VALUE            06420000
051300         'PACK SKU: '.                                            06430000
051400     05  PKT-SKU-NBR                  PIC  ZZZZZZZ9.              06440000
051401* TKMA888 *------------------------------------------------------*06450000
051402     05  FILLER                       PIC  X(07) VALUE SPACES.    06460000
051403     05  FILLER                       PIC  X(13) VALUE            06470000
051404         'TOTAL UNITS: '.                                         06480000
051405     05  PKT-UNITS                    PIC  ZZZ,ZZZ,ZZ9.           06490000
051410* TKMA888 * REPLACED 1 LINE WITH 2 LINES *************************06500000
051420*           TO CHANGE FIELD LABEL                                 06510000
051430* TKMA888 *------------------------------------------------------*06520000
051500*    05  FILLER                       PIC  X(30) VALUE SPACES.    06530000
051510     05  FILLER                       PIC  X(07) VALUE SPACES.    06540000
051520* TKMA888 *------------------------------------------------------*06550000
051600     05  FILLER                       PIC  X(14) VALUE            06560000
051700         '# OF CARTONS: '.                                        06570000
051800     05  PKT-CTNS                     PIC ZZZ,ZZ9.                06580000
051810* TKMA888 * REPLACED 1 LINE WITH 2 LINES *************************06590000
051820*           TO CHANGE FIELD LABEL                                 06600000
051830* TKMA888 *------------------------------------------------------*06610000
051900*    05  FILLER                       PIC X(22) VALUE SPACES.     06620000
051910     05  FILLER                       PIC X(20) VALUE SPACES.     06630000
051920* TKMA888 *------------------------------------------------------*06640000
052000     05  FILLER                       PIC X(24) VALUE             06650000
052100         'TOTAL UNITS PER CARTON: '.                              06660000
052200     05  PKT-UNT-PER-CTN              PIC ZZ,ZZ9.                 06670000
052300                                                                  06680000
052400 01  PACK-LINE-TOTAL-INNER.                                       06690000
052610* TKMA888 * REPLACED 1 LINE WITH 1 LINE **************************06700000
052620*           TO CHANGE FIELD LABEL                                 06710000
052630* TKMA888 *------------------------------------------------------*06720000
052631*    05  FILLER                       PIC  X(13) VALUE            06730000
052640*        'PACK ......: '.                                         06740000
052641     05  FILLER                       PIC  X(09) VALUE            06750000
052650         'PACK ID: '.                                             06760000
052660* TKMA888 *------------------------------------------------------*06770000
052700     05  PKT-PACK-ID-INNER            PIC  ZZ9.                   06780000
052800     05  FILLER                       PIC  X(02) VALUE SPACES.    06790000
052810* TKMA888 * ADDED 4 LINES ****************************************06800000
052820     05  FILLER                       PIC  X(10) VALUE            06810000
052830         'PACK SKU: '.                                            06820000
052840     05  PKT-SKU-NBR-INNER            PIC  ZZZZZZZ9.              06830000
052850     05  FILLER                       PIC  X(02) VALUE SPACES.    06840000
052860* TKMA888 *------------------------------------------------------*06850000
052900     05  FILLER                       PIC  X(13) VALUE            06860000
053000         'TOTAL UNITS: '.                                         06870000
053100     05  PKT-UNITS-INNER              PIC  ZZZ,ZZZ,ZZ9.           06880000
053200     05  FILLER                       PIC  X(03) VALUE SPACES.    06890000
053210* TKMA888 * REPLACED 2 LINES WITH 2 LINES ************************06900000
053300*    05  FILLER                       PIC  X(18) VALUE            06910000
053400*        'UNITS PER CARTON: '.                                    06920000
053401     05  FILLER                       PIC  X(14) VALUE            06930000
053402         'UNTS PER CTN: '.                                        06940000
053410* TKMA888 *------------------------------------------------------*06950000
053500     05  PKT-UNIT-PER-CARTON          PIC  ZZ,ZZ9.                06960000
053600     05  FILLER                       PIC  X(03) VALUE SPACES.    06970000
053610* TKMA888 * REPLACED 2 LINES WITH 2 LINES ************************06980000
053700*    05  FILLER                       PIC  X(14) VALUE            06990000
053800*        '# OF CARTONS: '.                                        07000000
053801     05  FILLER                       PIC  X(11) VALUE            07010000
053802         '# OF CTNS: '.                                           07020000
053810* TKMA888 *------------------------------------------------------*07030000
053900     05  PKT-CTNS-INNER               PIC ZZZ,ZZ9.                07040000
054000     05  FILLER                       PIC X(03) VALUE SPACES.     07050000
054010* TKMA888 * REPLACED 2 LINES WITH 2 LINES ************************07060000
054100*    05  FILLER                       PIC X(18) VALUE             07070000
054200*        '# OF INNER PACKS: '.                                    07080000
054201     05  FILLER                       PIC X(14) VALUE             07090000
054202         '# OF INR PKS: '.                                        07100000
054210* TKMA888 *------------------------------------------------------*07110000
054300     05  PKT-INNER-PKS                PIC ZZ,ZZ9.                 07120000
054400     05  FILLER                       PIC X(02) VALUE SPACES.     07130000
054410* TKMA888 * REPLACED 2 LINES WITH 2 LINES ************************07140000
054500*    05  FILLER                       PIC X(22) VALUE             07150000
054600*        'UNITS PER INNER PACK: '.                                07160000
054601     05  FILLER                       PIC X(17) VALUE             07170000
054602         'UNTS PER INR PK: '.                                     07180000
054610* TKMA888 *------------------------------------------------------*07190000
054700     05  PKT-UNITS-PER-PACK           PIC ZZ,ZZ9.                 07200000
054800                                                                  07210000
054900 01  PACK-DESC-LINE.                                              07220000
054910* TKMA888 * REPLACED 1 LINE WITH 1 LINE **************************07230000
054920*           TO CHANGE FIELD LABEL                                 07240000
054930* TKMA888 *------------------------------------------------------*07250000
055000*    05  FILLER                       PIC  X(13) VALUE            07260000
055100*            'DESCRIPTION: '.                                     07270000
055110     05  FILLER                       PIC  X(18) VALUE            07280000
055120             'PACK DESCRIPTION: '.                                07290000
055130* TKMA888 *------------------------------------------------------*07300000
055200     05  PKT-DESCRIPTION              PIC  X(40).                 07310000
055210* TKMA888 * REPLACED 1 LINE WITH 4 LINE **************************07320000
055220*           TO ADD PACK UPC TO REPORT                             07330000
055230* TKMA888 *------------------------------------------------------*07340000
055300*    05  FILLER                       PIC  X(97) VALUE SPACES.    07350000
055310     05  FILLER                       PIC  X(09) VALUE            07360000
055311             'PACK UPC:'.                                         07370000
055320     05  PKT-UPC-NBR                  PIC  ZZZZZZZZZZZZZZ9.       07380000
055330     05  FILLER                       PIC  X(68) VALUE SPACES.    07390000
055340* TKMA888 *------------------------------------------------------*07400000
055400                                                                  07410000
055500 01  PACK-LINE-UNAVAIL.                                           07420000
055600     05  FILLER                       PIC  X(21) VALUE            07430000
055700            'PACK DATA UNAVAILABLE'.                              07440000
055800     05  FILLER                       PIC  X(02) VALUE SPACES.    07450000
055900     05  FILLER                       PIC  X(13) VALUE            07460000
056000            'TOTAL UNITS: '.                                      07470000
056100     05  PL2-PACK-UNITS               PIC  Z,ZZZ,ZZ9.             07480000
056200     05  FILLER                       PIC  X(105) VALUE SPACES.   07490000
056300                                                                  07500000
056400 01  SKU-LINE-1.                                                  07510000
056500     05  SL1-LINE-NBR                 PIC  9(03).                 07520000
W24803     05  FILLER                       PIC  X(06) VALUE ' DEPT:'.  07530000
056700     05  SL1-DEPT                     PIC  X(03).                 07540000
056800     05  FILLER                       PIC  X(01) VALUE SPACES.    07550000
W24803     05  FILLER                       PIC  X(04) VALUE 'SKU:'.    07560000
W24803     05  SL1-SKU                      PIC  X(08).                 07570000
057000     05  FILLER                       PIC  X(01) VALUE SPACES.    07580000
W24803     05  FILLER                       PIC  X(07) VALUE            07590000
W24803         ' STYLE:'.                                               07600000
057400     05  SL1-STYLE                    PIC  X(18).                 07610000
W24803     05  FILLER                       PIC  X(07) VALUE            07620000
W24803         '  DESC:'.                                               07630000
057700     05  SL1-DESC                     PIC  X(19).                 07640000
W24803     05  FILLER                       PIC  X(10) VALUE            07650000
W24803         ' PK RATIO:'.                                            07660000
058000     05  SL1-PREPK-RATO-QTY           PIC  ZZ9.                   07670000
W24803     05  FILLER                       PIC  X(06) VALUE            07680000
W24803         ' QTY: '.                                                07690000
058300     05  SL1-ORD-QTY                  PIC  ZZZZZZZZZ.             07700000
W24803     05  FILLER                       PIC  X(08) VALUE            07710000
W24803         '  COST: '.                                              07720000
058600     05  SL1-COST                     PIC  $$,$$$.999.            07730000
058700     05  FILLER                       PIC  X(13) VALUE            07740000
058800         ' TOTAL COST: '.                                         07750000
058900     05  SL1-TOT-COST                 PIC  $$$,$$$,$$$.99.        07760000
059000                                                                  07770000
059100 01  SKU-LINE-2.                                                  07780000
W24803     05  FILLER                       PIC  X(4) VALUE 'MCL:'.     07790000
W24803     05  SL2-MAJ-CL                   PIC  X(2).                  07800000
W24803     05  FILLER                       PIC  X(02) VALUE SPACES.    07810000
W24803     05  FILLER                       PIC  X(4) VALUE 'SCL:'.     07820000
W24803     05  SL2-SUB-CL                   PIC  X(2).                  07830000
W24803     05  FILLER                       PIC  X(07) VALUE            07840000
W24803         ' COLOR:'.                                               07850000
W24803     05  SL2-COLOR                    PIC  X(19).                 07860000
W24803     05  FILLER                       PIC  X(14) VALUE            07870000
W24803         '        SIZE: '.                                        07880000
059700     05  SL2-SIZE                     PIC  X(19).                 07890000
059800     05  FILLER                       PIC  X(11) VALUE            07900000
059900         '  AD DATE: '.                                           07910000
060000     05  SL2-AD-DATE                  PIC  X(08).                 07920000
060100     05  FILLER                       PIC  X(17) VALUE            07930000
060200         '         RETAIL: '.                                     07940000
060300     05  SL2-RTL                      PIC  $$$,$$$.99.            07950000
060400     05  FILLER                       PIC  X(17) VALUE            07960000
060500         '   TOTAL RETAIL: '.                                     07970000
060600     05  SL2-TOT-RTL                  PIC  $$$,$$$,$$$.99.        07980000
060700                                                                  07990000
060800 01  LINE-CANCEL-LINE.                                            08000000
060900     05  FILLER                       PIC  X(39) VALUE            08010000
061000         '   *** THIS LINE HAS BEEN CANCELLED ***'.               08020000
061100     05  FILLER                       PIC  X(111) VALUE SPACES.   08030000
061200                                                                  08040000
061300                                                                  08050000
061400 01  END-REPORT-LINE.                                             08060000
061500     05  FILLER                       PIC  X(64) VALUE SPACES.    08070000
061600     05  FILLER                       PIC  X(21) VALUE            08080000
061700         'END OF PURCHASE ORDER'.                                 08090000
061800     05  FILLER                       PIC  X(65) VALUE SPACES.    08100000
061900                                                                  08110000
062000 01  NOT-APPROVED-LINE.                                           08120000
062100     05  FILLER                       PIC  X(48) VALUE            08130000
062200         '***** PURCHASE ORDER HAS NOT BEEN APPROVED *****'.      08140000
062300     05  FILLER                       PIC  X(102) VALUE SPACES.   08150000
062400                                                                  08160000
062500 01  CANCELLED-LINE.                                              08170000
062600     05  FILLER                       PIC  X(45) VALUE            08180000
062700         '***** PURCHASE ORDER HAS BEEN CANCELLED *****'.         08190000
062800     05  FILLER                       PIC  X(105) VALUE SPACES.   08200000
062900                                                                  08210000
063000 01  REVISED-LINE.                                                08220000
063100     05  FILLER                       PIC  X(43) VALUE            08230000
063200         '***** PURCHASE ORDER HAS BEEN REVISED *****'.           08240000
063300     05  FILLER                       PIC  X(107) VALUE SPACES.   08250000
063400                                                                  08260000
063500 01  BLANK-REPORT-LINE.                                           08270000
063600     05  FILLER                       PIC  X(58) VALUE SPACES.    08280000
063700     05  FILLER                       PIC  X(34) VALUE            08290000
063800         'THIS PAGE INTENTIONALLY LEFT BLANK'.                    08300000
063900     05  FILLER                       PIC  X(58) VALUE SPACES.    08310000
064000                                                                  08320000
064100 01  ASTERISK-LINE.                                               08330000
064200     05  FILLER                       PIC  X(02) VALUE SPACES.    08340000
064300     05  FILLER   OCCURS 73 TIMES.                                08350000
064400         10  FILLER                   PIC  X(01) VALUE '*'.       08360000
064500         10  FILLER                   PIC  X(01) VALUE SPACES.    08370000
064600     05  FILLER                       PIC  X(02) VALUE SPACES.    08380000
064700                                                                  08390000
064800/                                                                 08400000
064900******************************************************************08410000
065000*  COMMUNICATIONS AREA FOR DB2                                    08420000
065100******************************************************************08430000
065200     EXEC SQL                                                     08440000
065300          INCLUDE SQLCA                                           08450000
065400     END-EXEC.                                                    08460000
065500******************************************************************08470000
065600*  COPY BOOK FOR PURCHASE ORDER TABLE                             08480000
065700******************************************************************08490000
065800     EXEC SQL                                                     08500000
065900          INCLUDE TPURCHS                                         08510000
066000     END-EXEC.                                                    08520000
066100******************************************************************08530000
066200*  COPY BOOK FOR PURCHASE ITEM TABLE                              08540000
066300******************************************************************08550000
066400     EXEC SQL                                                     08560000
066500          INCLUDE TPURITM                                         08570000
066600     END-EXEC.                                                    08580000
066700******************************************************************08590000
066800*  COPY BOOK FOR PO PLANNED SHIPMENT TABLE                        08600000
066900******************************************************************08610000
067000     EXEC SQL                                                     08620000
067100          INCLUDE TPLNSHP                                         08630000
067200     END-EXEC.                                                    08640000
067300******************************************************************08650000
067400*  COPY BOOK FOR PO AGREEMENT TABLE                               08660000
067500******************************************************************08670000
067600     EXEC SQL                                                     08680000
067700          INCLUDE TPOAGMT                                         08690000
067800     END-EXEC.                                                    08700000
067900******************************************************************08710000
068000*  COPY BOOK FOR PO INSTRUCTION TABLE                             08720000
068100******************************************************************08730000
068200     EXEC SQL                                                     08740000
068300          INCLUDE TPOINST                                         08750000
068400     END-EXEC.                                                    08760000
068500******************************************************************08770000
068600*  COPY BOOK FOR INSTRUCTION CODE TABLE                           08780000
068700******************************************************************08790000
068800     EXEC SQL                                                     08800000
068900          INCLUDE TINSTCD                                         08810000
069000     END-EXEC.                                                    08820000
069100******************************************************************08830000
069200*  COPY BOOK FOR RECIPENT CODE TABLE                              08840000
069300******************************************************************08850000
069400     EXEC SQL                                                     08860000
069500          INCLUDE TINRCCD                                         08870000
069600     END-EXEC.                                                    08880000
069700******************************************************************08890000
069800*  COPY BOOK FOR ALLOCATION PLAN TABLE                            08900000
069900******************************************************************08910000
070000     EXEC SQL                                                     08920000
070100          INCLUDE TALLPLN                                         08930000
070200     END-EXEC.                                                    08940000
070300******************************************************************08950000
070400*  COPY BOOK FOR MERCHANDISE STORE DISTRIBUTION TABLE             08960000
070500******************************************************************08970000
070600     EXEC SQL                                                     08980000
070700          INCLUDE TMESTDS                                         08990000
070800     END-EXEC.                                                    09000000
070900******************************************************************09010000
071000*  COPY BOOK FOR EXTERNAL ENTERPRISE NAME TABLE                   09020000
071100******************************************************************09030000
071200     EXEC SQL                                                     09040000
071300          INCLUDE TENTNME                                         09050000
071400     END-EXEC.                                                    09060000
071500******************************************************************09070000
071600*  COPY BOOK FOR ENTERPRISE LOCATION TABLE                        09080000
071700******************************************************************09090000
071800     EXEC SQL                                                     09100000
071900          INCLUDE TBUSLOC                                         09110000
072000     END-EXEC.                                                    09120000
072100******************************************************************09130000
072200*  COPY BOOK FOR VENDOR PAYMENT TERM TABLE                        09140000
072300******************************************************************09150000
072400     EXEC SQL                                                     09160000
072500          INCLUDE TPAYTRM                                         09170000
072600     END-EXEC.                                                    09180000
072700******************************************************************09190000
072800*  COPY BOOK FOR LOCATION TABLE                                   09200000
072900******************************************************************09210000
073000     EXEC SQL                                                     09220000
073100          INCLUDE XMT00001                                        09230000
073200     END-EXEC.                                                    09240000
073300******************************************************************09250000
073400*  COPY BOOK FOR WORKER ID TABLE                                  09260000
073500******************************************************************09270000
073600     EXEC SQL                                                     09280000
073700          INCLUDE TWORKER                                         09290000
073800     END-EXEC.                                                    09300000
073900******************************************************************09310000
074000*  COPY BOOK FOR PO PRE PACK TABLE                                09320000
074100******************************************************************09330000
074200     EXEC SQL                                                     09340000
074300          INCLUDE TPOPRPK                                         09350000
074400     END-EXEC.                                                    09360000
074500******************************************************************09370000
074600*  COPY BOOK FOR MERCHANDISE AREA                                 09380000
074700******************************************************************09390000
074800     EXEC SQL                                                     09400000
074900          INCLUDE TMDSEAR                                         09410000
075000     END-EXEC.                                                    09420000
075100******************************************************************09430000
075200*  COPY BOOK FOR MERCHANDISE AREA                                 09440000
075300******************************************************************09450000
075400     EXEC SQL                                                     09460000
075500          INCLUDE TRSPBAR                                         09470000
075600     END-EXEC.                                                    09480000
075700                                                                  09490000
W24803******************************************************************09500000
W24803*  COPY BOOK FOR XLT_SKU TABLE                                    09510000
W24803******************************************************************09520000
W24803     EXEC SQL                                                     09530000
W24803          INCLUDE  XLT00003                                       09540000
W24803     END-EXEC.                                                    09550000
W24803******************************************************************09560000
W24803*  COPY BOOK FOR XLT_VND_STYL TABLE                               09570000
W24803******************************************************************09580000
W24803     EXEC SQL                                                     09590000
W24803          INCLUDE  XLT00004                                       09600000
W24803     END-EXEC.                                                    09610000
076100                                                                  09620000
076200                                                                  09630000
076300                                                                  09640000
076400******************************************************************09650000
076500*  CURSOR FOR PO PRE-APPROVAL PREPACKS                            09660000
076600******************************************************************09670000
076700     EXEC SQL                                                     09680000
076800         DECLARE PRE-PACK-CSR CURSOR FOR                          09690000
076900         SELECT A.PO_PREPK_ID                                     09700000
077000               ,A.OTPK_UNT_QTY                                    09710000
077100               ,A.OTPK_ORD_QTY                                    09720000
077200               ,A.INPK_UNT_QTY                                    09730000
077201* TKMA888 * ADDED 3 LINES ****************************************09740000
077210               ,A.PK_SKU_NBR                                      09750000
077220               ,A.PREPK_UPC_NBR                                   09760000
077230               ,B.PRD_1ST_COST_AMT                                09770000
077240* TKMA888 *------------------------------------------------------*09780000
      * TKMA537 *  ADDED 1  LINE****************************************09790032
                     ,A.PREPK_TYP_CDE                                   09800032
      * TKMA537 *------------------------------------------------------*09810032
077300               ,A.PREPK_DESC                                      09820000
077400               ,B.SKU_SEQ_NBR                                     09830000
077500               ,B.CL_NBR                                          09840000
077600               ,B.VEND_STYL_NAME                                  09850000
077700               ,B.SKU_DESC                                        09860000
W24803               ,D.MAJ_CL_NBR                                      09870000
W24803               ,D.SUB_CL_NBR                                      09880000
W24803               ,C.SKU_NBR                                         09890000
W24803               ,D.VS_NBR                                          09900000
W24803               ,C.SKU_DESC                                        09910000
077800               ,B.UNT_QTY                                         09920000
077900               ,B.UNT_COST_AMT                                    09930000
078000               ,B.TOT_VAL_COST_AMT                                09940000
078100               ,B.COLOR_DESC                                      09950000
078200               ,B.SIZE_DESC                                       09960000
W24803               ,C.CSTM_CLOR_DESC                                  09970000
W24803               ,C.SIZE_DESC                                       09980000
078300               ,B.AD_EVNT_DTE                                     09990000
078400               ,B.UNT_RTL_PR_AMT                                  10000000
078500               ,B.TOT_VAL_RTL_AMT                                 10010000
078600               ,B.PO_LNE_NBR                                      10020000
078700               ,B.STATUS_CDE                                      10030000
078800               ,B.ITM_NBR                                         10040000
078900               ,B.PREPK_RATO_QTY                                  10050000
079000         FROM  TPOPRPK A                                          10060000
W24803              ,TPURITM B LEFT OUTER JOIN                          10070000
W24803               XLT_SKU C ON B.ITM_NBR = C.ITM_NBR                 10080000
W24803               LEFT OUTER JOIN                                    10090000
W24803               XLT_VND_STYL D ON C.STYL_ID = D.STYL_ID            10100000
W24803         WHERE  A.PO_NBR = :POPRPK-PO-NBR                         10110000
079300           AND  A.PO_NBR = B.PO_NBR                               10120000
079400           AND  A.PO_PREPK_ID = B.PO_PREPK_ID                     10130000
079500           AND  B.VER_STATUS_CDE = 'A'                            10140000
                 AND  B.UNT_QTY > 0                                     10150000
079600         ORDER BY A.PO_PREPK_ID                                   10160000
079700                 ,B.PO_LNE_NBR                                    10170000
079800     END-EXEC.                                                    10180000
079900******************************************************************10190000
080000*  CURSOR FOR PO APPROVED PREPACKS                                10200000
080100******************************************************************10210000
080200     EXEC SQL                                                     10220000
080300         DECLARE APP-PACK-CSR CURSOR FOR                          10230000
080400         SELECT A.PO_PREPK_ID                                     10240000
080500               ,A.OTPK_UNT_QTY                                    10250000
080600               ,A.OTPK_ORD_QTY                                    10260000
080700               ,A.INPK_UNT_QTY                                    10270000
080710* TKMA888 * ADDED 3 LINES ****************************************10280000
080720               ,A.PK_SKU_NBR                                      10290000
080730               ,A.PREPK_UPC_NBR                                   10300000
080740               ,B.PRD_1ST_COST_AMT                                10310000
080750* TKMA888 *------------------------------------------------------*10320000
      * TKMA537 *ADDED 1  LINE******************************************10330032
                     ,A.PREPK_TYP_CDE                                   10340032
      * TKMA537 *------------------------------------------------------*10350032
080800               ,A.PREPK_DESC                                      10360000
080900               ,B.SKU_SEQ_NBR                                     10370000
081000               ,B.CL_NBR                                          10380000
081100               ,B.VEND_STYL_NAME                                  10390000
081200               ,B.SKU_DESC                                        10400000
W24803               ,D.MAJ_CL_NBR                                      10410000
W24803               ,D.SUB_CL_NBR                                      10420000
W24803               ,C.SKU_NBR                                         10430000
W24803               ,D.VS_NBR                                          10440000
W24803               ,C.SKU_DESC                                        10450000
081300               ,B.UNT_QTY                                         10460000
081400               ,B.UNT_COST_AMT                                    10470000
081500               ,B.TOT_VAL_COST_AMT                                10480000
081600               ,B.COLOR_DESC                                      10490000
081700               ,B.SIZE_DESC                                       10500000
W24803               ,C.CSTM_CLOR_DESC                                  10510000
W24803               ,C.SIZE_DESC                                       10520000
081800               ,B.AD_EVNT_DTE                                     10530000
081900               ,B.UNT_RTL_PR_AMT                                  10540000
082000               ,B.TOT_VAL_RTL_AMT                                 10550000
082100               ,B.APP_PO_LNE_NBR                                  10560000
082200               ,B.STATUS_CDE                                      10570000
082300               ,B.ITM_NBR                                         10580000
082400               ,B.PREPK_RATO_QTY                                  10590000
082500         FROM  TPOPRPK A                                          10600000
W24803              ,TPURITM B LEFT OUTER JOIN                          10610000
W24803               XLT_SKU C ON B.ITM_NBR = C.ITM_NBR                 10620000
W24803               LEFT OUTER JOIN                                    10630000
W24803               XLT_VND_STYL D ON C.STYL_ID = D.STYL_ID            10640000
W24803         WHERE  A.PO_NBR = :POPRPK-PO-NBR                         10650000
082800           AND  A.PO_NBR = B.PO_NBR                               10660000
082900           AND  A.PO_PREPK_ID = B.PO_PREPK_ID                     10670000
083000           AND  B.VER_STATUS_CDE = 'A'                            10680000
                 AND  B.UNT_QTY > 0                                     10690000
083100         ORDER BY A.PO_PREPK_ID                                   10700000
083200                  ,B.APP_PO_LNE_NBR                               10710000
083300     END-EXEC.                                                    10720000
083400******************************************************************10730000
083500*  CURSOR FOR PO PRE-APPROVAL LINES NOT IN A PACK                 10740000
083600******************************************************************10750000
083700     EXEC SQL                                                     10760000
083800         DECLARE PRE-LINE-CSR CURSOR FOR                          10770000
083900         SELECT PO_PREPK_ID                                       10780000
084000               ,SKU_SEQ_NBR                                       10790000
084100               ,CL_NBR                                            10800000
084200               ,VEND_STYL_NAME                                    10810000
W24803               ,A.SKU_DESC                                        10820000
W24803               ,C.MAJ_CL_NBR                                      10830000
W24803               ,C.SUB_CL_NBR                                      10840000
W24803               ,B.SKU_NBR                                         10850000
W24803               ,C.VS_NBR                                          10860000
W24803               ,B.SKU_DESC                                        10870000
084400               ,UNT_QTY                                           10880000
084500               ,UNT_COST_AMT                                      10890000
084600               ,TOT_VAL_COST_AMT                                  10900000
084700               ,COLOR_DESC                                        10910000
W24803               ,A.SIZE_DESC                                       10920000
W24803               ,B.CSTM_CLOR_DESC                                  10930000
W24803               ,B.SIZE_DESC                                       10940000
084900               ,AD_EVNT_DTE                                       10950000
085000               ,UNT_RTL_PR_AMT                                    10960000
085100               ,TOT_VAL_RTL_AMT                                   10970000
085200               ,PO_LNE_NBR                                        10980000
085300               ,STATUS_CDE                                        10990000
W24803               ,A.ITM_NBR                                         11000000
085500               ,PREPK_RATO_QTY                                    11010000
085510* TKMA888 * ADDED 1 LINES ****************************************11020000
085540               ,PRD_1ST_COST_AMT                                  11030000
085550* TKMA888 *------------------------------------------------------*11040000
W24803         FROM  TPURITM A                                          11050000
W24803               LEFT OUTER JOIN                                    11060000
W24803               XLT_SKU B ON A.ITM_NBR = B.ITM_NBR                 11070000
W24803               LEFT OUTER JOIN                                    11080000
W24803               XLT_VND_STYL C ON B.STYL_ID = C.STYL_ID            11090000
W24803         WHERE  A.PO_NBR = :POPRPK-PO-NBR                         11100000
085800                AND  PO_PREPK_ID = 0                              11110000
085900                AND  VER_STATUS_CDE = 'A'                         11120000
                      AND  A.UNT_QTY > 0                                11130000
086000         ORDER BY PO_LNE_NBR                                      11140000
086100     END-EXEC.                                                    11150000
086200******************************************************************11160000
086300*  CURSOR FOR PO POST-APPROVAL LINES NOT IN A PACK                11170000
086400******************************************************************11180000
086500     EXEC SQL                                                     11190000
086600         DECLARE APP-LINE-CSR CURSOR FOR                          11200000
086700         SELECT PO_PREPK_ID                                       11210000
086800               ,SKU_SEQ_NBR                                       11220000
086900               ,CL_NBR                                            11230000
087000               ,VEND_STYL_NAME                                    11240000
W24803               ,A.SKU_DESC                                        11250000
W24803               ,C.MAJ_CL_NBR                                      11260000
W24803               ,C.SUB_CL_NBR                                      11270000
W24803               ,B.SKU_NBR                                         11280000
W24803               ,C.VS_NBR                                          11290000
W24803               ,B.SKU_DESC                                        11300000
087200               ,UNT_QTY                                           11310000
087300               ,UNT_COST_AMT                                      11320000
087400               ,TOT_VAL_COST_AMT                                  11330000
087500               ,COLOR_DESC                                        11340000
W24803               ,A.SIZE_DESC                                       11350000
W24803               ,B.CSTM_CLOR_DESC                                  11360000
W24803               ,B.SIZE_DESC                                       11370000
087700               ,AD_EVNT_DTE                                       11380000
087800               ,UNT_RTL_PR_AMT                                    11390000
087900               ,TOT_VAL_RTL_AMT                                   11400000
088000               ,APP_PO_LNE_NBR                                    11410000
088100               ,STATUS_CDE                                        11420000
W24803               ,A.ITM_NBR                                         11430000
088300               ,PREPK_RATO_QTY                                    11440000
088310* TKMA888 * ADDED 1 LINES ****************************************11450000
088340               ,PRD_1ST_COST_AMT                                  11460000
088350* TKMA888 *------------------------------------------------------*11470000
W24803         FROM  TPURITM A                                          11480000
W24803               LEFT OUTER JOIN                                    11490000
W24803               XLT_SKU B ON A.ITM_NBR = B.ITM_NBR                 11500000
W24803               LEFT OUTER JOIN                                    11510000
W24803               XLT_VND_STYL C ON B.STYL_ID = C.STYL_ID            11520000
W24803         WHERE  PO_NBR = : POPRPK-PO-NBR                          11530000
088600                AND  PO_PREPK_ID = 0                              11540000
088700                AND  VER_STATUS_CDE = 'A'                         11550000
                      AND  A.UNT_QTY > 0                                11560000
088800         ORDER BY APP_PO_LNE_NBR                                  11570000
088900     END-EXEC.                                                    11580000
089000******************************************************************11590000
089100*  CURSOR FOR INSTRUCTIONS                                        11600000
089200******************************************************************11610000
089300     EXEC SQL                                                     11620000
089400         DECLARE INST-CSR CURSOR FOR                              11630000
089500         SELECT B.INSTR_DESC,                                     11640000
089600                B.INSTR_NBR,                                      11650000
089700                C.RECIP_CDE,                                      11660000
089800                C.RECIP_DESC                                      11670000
089900         FROM   TPOINST A,                                        11680000
090000                TINSTCD B,                                        11690000
090100                TINRCCD C                                         11700000
090200         WHERE A.PO_NBR = :IR-PO-NBR2                             11710000
090300           AND A.RECIP_CDE LIKE :POINST-RECIP-CDE                 11720000
090400           AND B.INSTR_NBR = A.INSTR_NBR                          11730000
090500           AND C.RECIP_CDE = A.RECIP_CDE                          11740000
090600         ORDER BY RECIP_CDE, INSTR_NBR                            11750000
090700     END-EXEC.                                                    11760000
090800******************************************************************11770000
090900*  CURSOR FOR STORE DISTRIBUTIONS (ALLOCATIONS)                   11780000
091000******************************************************************11790000
091100     EXEC SQL                                                     11800000
091200         DECLARE ALLOC-CSR CURSOR FOR                             11810000
091300         SELECT A.STR_NBR,                                        11820000
091400                A.STR_DISTRO_QTY,                                 11830000
091500                B.LOC_5_ABBR_NM                                   11840000
091600         FROM TMESTDS A,                                          11850000
091700              XMT_LOC B                                           11860000
091800         WHERE A.PO_NBR = :IR-PO-NBR2                             11870000
091900           AND A.PO_LNE_NBR = :PV-PO-LNE-NBR                      11880000
092000           AND B.LOC_NBR    = A.STR_NBR                           11890000
                 AND A.STR_DISTRO_QTY > 0                               11900000
092100         ORDER BY A.STR_NBR                                       11910000
092200     END-EXEC.                                                    11920000
092300                                                                  11930000
092400 PROCEDURE DIVISION.                                              11940000
092500                                                                  11950000
092600******************************************************************11960000
092700*  CONTROLS THE MAIN PROCESSING OF THE PROGRAM.                   11970000
092800******************************************************************11980000
092900 0000-MAINLINE.                                                   11990000
093000                                                                  12000000
093100     PERFORM 1000-INITIALIZE.                                     12010000
093200                                                                  12020000
093300     IF IR-RPT-TYPE-BY = 'BY'                                     12030000
093400         SET PS-BUYER-RPT-TYPE     TO TRUE                        12040000
093500         MOVE 'BUYER COPY  '       TO HL3-VERSION                 12050000
093600         PERFORM 2000-PROCESS-REPORT.                             12060000
093700                                                                  12070000
093800     IF IR-RPT-TYPE-AN = 'AN'                                     12080000
093900         SET PS-ANALYST-RPT-TYPE   TO TRUE                        12090000
094000         MOVE 'ANALYST COPY'       TO HL3-VERSION                 12100000
094100         PERFORM 2000-PROCESS-REPORT.                             12110000
094200                                                                  12120000
094300     IF IR-RPT-TYPE-DC = 'DC'                                     12130000
094400         SET PS-DC-RPT-TYPE        TO TRUE                        12140000
094500         MOVE 'DC COPY     '       TO HL3-VERSION                 12150000
094600         PERFORM 2000-PROCESS-REPORT.                             12160000
094700                                                                  12170000
094800     IF IR-RPT-TYPE-VN = 'VS' OR 'VN'                             12180000
094900         SET PS-VENDOR-RPT-TYPE    TO TRUE                        12190000
095000         MOVE 'VENDOR COPY '       TO HL3-VERSION                 12200000
095100         PERFORM 2000-PROCESS-REPORT.                             12210000
095200                                                                  12220000
PE6591     IF PS-INVALID-PO-SW = 'Y'                                    12230000
PE6591        MOVE 4095 TO RETURN-CODE.                                 12240000
                                                                        12250000
PE9809     IF PS-ERROR-PO-SW = 'Y'                                      12260000
PE9809        MOVE 4090 TO RETURN-CODE.                                 12270000
                                                                        12280000
095300     CLOSE INPUT-FILE                                             12290000
095400           PORPT-FILE                                             12300000
PE6591           INVALIDPO-FILE                                         12310000
PE9809           ERRORPO-FILE.                                          12320000
095500                                                                  12330000
095600     STOP RUN.                                                    12340000
095700                                                                  12350000
095800******************************************************************12360000
095900*  OPENS THE FILES  READ INPUT FILE, INITS HEADER FIELDS          12370000
096000******************************************************************12380000
096100 1000-INITIALIZE.                                                 12390000
096200                                                                  12400000
096300     OPEN INPUT  INPUT-FILE.                                      12410000
096400     OPEN OUTPUT PORPT-FILE                                       12420000
PE6591                 INVALIDPO-FILE                                   12430000
PE9809                 ERRORPO-FILE.                                    12440000
096500                                                                  12450000
096600     READ INPUT-FILE                                              12460000
096700         INTO IR-INPUT-RECORD                                     12470000
096800         AT END SET PS-EOF-INPUT-FILE                             12480000
096900                                   TO TRUE.                       12490000
097000     IF  PS-EOF-INPUT-FILE                                        12500000
097100         DISPLAY  '****** ABEND IN PROGRAM POKRP080 *******'      12510000
097200         DISPLAY  'EMPTY INPUT FILE'                              12520000
097300         MOVE +4003                TO PV-ABEND-CODE               12530000
097400         CALL 'ILBOABN0' USING PV-ABEND-CODE                      12540000
097500     END-IF.                                                      12550000
097600                                                                  12560000
097700     ACCEPT SD-SYSTEM-DATE FROM DATE.                             12570000
097800     MOVE SD-SYSTEM-MM             TO HL1-RUN-MONTH.              12580000
097900     MOVE SD-SYSTEM-DD             TO HL1-RUN-DAY.                12590000
098000     MOVE SD-SYSTEM-YY             TO HL1-RUN-YEAR.               12600000
098100                                                                  12610000
098200     ACCEPT ST-SYSTEM-TIME FROM TIME.                             12620000
098300     MOVE ST-SYSTEM-HH             TO HL1-RUN-HOUR.               12630000
098400     MOVE ST-SYSTEM-MM             TO HL1-RUN-MINUTE.             12640000
098500     MOVE ST-SYSTEM-SS             TO HL1-RUN-SECOND.             12650000
098600                                                                  12660000
098700     MOVE IR-PO-NBR                TO IR-PO-NBR2.                 12670034
098800     DISPLAY 'POKRP080 FOR PO# ' IR-PO-NBR.                       12680000
098900                                                                  12690000
099000******************************************************************12700000
099100*  CONTROLS REPORT PROCESSING                                     12710000
099200******************************************************************12720000
099300 2000-PROCESS-REPORT.                                             12730000
099400                                                                  12740000
099500     MOVE +1                          TO PV-PAGE-CNT.             12750000
099600     MOVE PV-PAGE-CNT                 TO HL2-PAGE.                12760000
099700     MOVE +0                          TO PV-LINE-CNT.             12770000
099800     MOVE +0                          TO PV-PACK-ID-NUM.          12780000
099900     SET PS-NOT-WROTE-UNAVAIL-HEADER  TO TRUE.                    12790000
100000                                                                  12800000
100100     PERFORM 2100-PROCESS-HEADER.                                 12810000
PE6591     IF PS-INVALID-PO-SW = 'N'                                    12820000
100200        PERFORM 2200-PROCESS-INSTRUCTION                          12830000
100300        PERFORM 2300-PROCESS-PACKS                                12840000
100400        PERFORM 2500-PROCESS-LINES-NOT-IN-PKS                     12850000
100500                                                                  12860000
100600        IF PV-LINE-CNT >= +57                                     12870000
100700           PERFORM 7000-ADVANCE-TO-NEWPAGE                        12880000
100800        END-IF                                                    12890000
100900        WRITE PORPT-RECORD FROM END-REPORT-LINE                   12900000
101000            AFTER 3 LINES                                         12910000
101100                                                                  12920000
101200        DIVIDE PV-PAGE-CNT BY 2                                   12930000
101300            GIVING PV-QUOTIENT                                    12940000
101400            REMAINDER PV-REMAINDER                                12950000
101500        IF PV-REMAINDER > 0                                       12960000
101600            ADD +1                    TO PV-PAGE-CNT              12970000
101700            MOVE PV-PAGE-CNT          TO HL2-PAGE                 12980000
101800            MOVE +0                   TO PV-LINE-CNT              12990000
101900            WRITE PORPT-RECORD FROM HEADER-LINE1                  13000000
102000                AFTER ADVANCING PAGE                              13010000
102100            WRITE PORPT-RECORD FROM HEADER-LINE2                  13020000
102200                AFTER 1 LINES                                     13030000
102300            WRITE PORPT-RECORD FROM HEADER-LINE3                  13040000
102400                AFTER 1 LINES                                     13050000
102500            WRITE PORPT-RECORD FROM BLANK-REPORT-LINE             13060000
102600                AFTER 1 LINES                                     13070000
102700        END-IF                                                    13080000
PE6591     END-IF.                                                      13090000
102800                                                                  13100000
102900******************************************************************13110000
103000*  CONTROLS HEADER PROCESSING                                     13120000
103100******************************************************************13130000
103200 2100-PROCESS-HEADER.                                             13140000
103300                                                                  13150000
103400     PERFORM 2101-GET-TPURCHS.                                    13160000
103500     MOVE '01'                     TO ENTNME-TYPE-CDE.            13170000
103600     PERFORM 2102-GET-TENTNME.                                    13180000
103700     MOVE ENTNME-ENT-NAME-DESC     TO HL4-VEND-NAME.              13190000
103800     PERFORM 2103-GET-TBUSLOC.                                    13200000
103900     PERFORM 2104-GET-TPLNSHP.                                    13210000
104000     IF PURCHS-DEST-KNOWN-IND = 'Y'                               13220000
104100         PERFORM 2196-COUNT-TALLPLNS                              13230000
104200         IF PV-DB2-COUNT > 1                                      13240000
104300             MOVE PC-SHIP-INST-ATT TO HL10-SHIP-TO-NAME           13250000
104400             MOVE SPACES           TO HL11-SHIP-TO-ADDR-1         13260000
104500                                      HL12-SHIP-TO-ADDR-2         13270000
104600                                      HL13-SHIP-TO-ADDR-3         13280000
104700         ELSE                                                     13290000
104800             IF PV-DB2-COUNT = 0                                  13300000
104900                 MOVE SPACES       TO HL10-SHIP-TO-NAME           13310000
105000                                      HL11-SHIP-TO-ADDR-1         13320000
105100                                      HL12-SHIP-TO-ADDR-2         13330000
105200                                      HL13-SHIP-TO-ADDR-3         13340000
105300             ELSE                                                 13350000
105400                 PERFORM 2197-GET-SHIP-DEST                       13360000
105500                 PERFORM 2105-GET-XMT-LOC                         13370000
105600             END-IF                                               13380000
105700         END-IF                                                   13390000
105800     ELSE                                                         13400000
105900         MOVE PC-SHIP-INST-FOLL    TO HL10-SHIP-TO-NAME           13410000
106000         MOVE SPACES               TO HL11-SHIP-TO-ADDR-1         13420000
106100                                      HL12-SHIP-TO-ADDR-2         13430000
106200                                      HL13-SHIP-TO-ADDR-3         13440000
106300     END-IF.                                                      13450000
106400     PERFORM 2113-GET-TPOAGMT-3.                                  13460000
106500     PERFORM 2106-GET-TPOAGMT-2.                                  13470000
106600** GET PRETICKETING INFO                                          13480000
106700     MOVE '1'                      TO POAGMT-TYP-CDE.             13490000
106800     PERFORM 2107-GET-TPOAGMT-4.                                  13500000
106900     IF SQLCODE = +0                                              13510000
107000         MOVE 'YES'                TO HL9-PRE-TICK                13520000
107100     ELSE                                                         13530000
107200         MOVE 'NO '                TO HL9-PRE-TICK                13540000
107300     END-IF.                                                      13550000
107400* GET HANGER INFO                                                 13560000
107500     MOVE '2'                      TO POAGMT-TYP-CDE.             13570000
107600     PERFORM 2107-GET-TPOAGMT-4.                                  13580000
107700     IF SQLCODE = +0                                              13590000
107800         MOVE 'YES'                TO HL9-HANGERS                 13600000
107900     ELSE                                                         13610000
108000         MOVE 'NO '                TO HL9-HANGERS                 13620000
108100     END-IF.                                                      13630000
108200* OBTAIN OTHER VALUES FOR THE REPORT                              13640000
108300     PERFORM 2110-GET-TMDSEAR.                                    13650000
108400     PERFORM 2111-GET-BUYER.                                      13660000
108500     MOVE PURCHS-CRE-BY-UID        TO WORKER-UID-NBR.             13670000
108600     PERFORM 2108-GET-TWORKER.                                    13680000
108700     IF SQLCODE = +0 OR -811                                      13690000
108800         MOVE 20                   TO DP024-FLNAME-LENGTH         13700000
108900         MOVE WORKER-LAST-NAME     TO DP024-LNAME                 13710000
109000         MOVE WORKER-FIR-NAME      TO DP024-FNAME                 13720000
109100         PERFORM DP024-0000-FORMAT-NAME                           13730000
109200         MOVE DP024-FLNAME         TO HL11-CREATED-BY             13740000
109300     END-IF.                                                      13750000
109400     MOVE PURCHS-APP-BY-UID        TO WORKER-UID-NBR.             13760000
109500     PERFORM 2108-GET-TWORKER.                                    13770000
109600     IF SQLCODE = +0 OR -811                                      13780000
109700         MOVE 20                   TO DP024-FLNAME-LENGTH         13790000
109800         MOVE WORKER-LAST-NAME     TO DP024-LNAME                 13800000
109900         MOVE WORKER-FIR-NAME      TO DP024-FNAME                 13810000
110000         PERFORM DP024-0000-FORMAT-NAME                           13820000
110100         MOVE DP024-FLNAME         TO HL13-APPROVE-BY             13830000
110200     ELSE                                                         13840000
110300         IF PURCHS-STATUS-CDE = 'AC' OR 'AP'                      13850000
110400             PERFORM 2112-GET-DMM                                 13860000
110500         ELSE                                                     13870000
110600             MOVE SPACES           TO HL13-APPROVE-BY             13880000
110700         END-IF                                                   13890000
110800     END-IF.                                                      13900000
110900     PERFORM 2109-GET-TPURITM.                                    13910000
111000*SELECT TPOAGMT 5/1                                               13920000
111100     PERFORM 2114-ADDL-DISCOUNT.                                  13930000
111200*SELECT TPOAGMT 5/7                                               13940000
111300     PERFORM 2115-MOS-DISCOUNT.                                   13950000
111400*SELECT TPOAGMT 5/8                                               13960000
111500     PERFORM 2116-TRD-DISCOUNT.                                   13970000
111600*SELECT TPOAGMT 5/9                                               13980000
111700     PERFORM 2117-ADV-DISCOUNT.                                   13990000
111800                                                                  14000000
PE6591     IF PS-INVALID-PO-SW = 'N'                                    14010000
111900         WRITE PORPT-RECORD FROM HEADER-LINE1                     14020000
112000             AFTER ADVANCING PAGE                                 14030000
112100         WRITE PORPT-RECORD FROM HEADER-LINE2                     14040000
112200             AFTER 1 LINES                                        14050000
112300         WRITE PORPT-RECORD FROM HEADER-LINE3                     14060000
112400             AFTER 1 LINES                                        14070000
112500         WRITE PORPT-RECORD FROM HEADER-LINE4                     14080000
112600             AFTER 2 LINES                                        14090000
112700         WRITE PORPT-RECORD FROM HEADER-LINE5                     14100000
112800             AFTER 1 LINES                                        14110000
112900         WRITE PORPT-RECORD FROM HEADER-LINE6                     14120000
113000             AFTER 1 LINES                                        14130000
113100         WRITE PORPT-RECORD FROM HEADER-LINE7                     14140000
113200             AFTER 1 LINES                                        14150000
113300         WRITE PORPT-RECORD FROM HEADER-LINE8                     14160000
113400             AFTER 1 LINES                                        14170000
113500         WRITE PORPT-RECORD FROM HEADER-LINE9                     14180000
113600             AFTER 1 LINES                                        14190000
113700         WRITE PORPT-RECORD FROM HEADER-LINE10                    14200000
113800             AFTER 1 LINES                                        14210000
113900         WRITE PORPT-RECORD FROM HEADER-LINE11                    14220000
114000             AFTER 1 LINES                                        14230000
114100         WRITE PORPT-RECORD FROM HEADER-LINE12                    14240000
114200             AFTER 1 LINES                                        14250000
114300         WRITE PORPT-RECORD FROM HEADER-LINE13                    14260000
114400             AFTER 1 LINES                                        14270000
114500         WRITE PORPT-RECORD FROM HEADER-LINE14                    14280000
114600             AFTER 1 LINES                                        14290000
114700         WRITE PORPT-RECORD FROM HEADER-LINE15                    14300000
114800             AFTER 1 LINES                                        14310000
114900         WRITE PORPT-RECORD FROM HEADER-LINE16                    14320000
115000             AFTER 1 LINES                                        14330000
115100         WRITE PORPT-RECORD FROM HEADER-LINE17                    14340000
115200             AFTER 1 LINES                                        14350000
115300         WRITE PORPT-RECORD FROM HEADER-LINE18                    14360000
115400             AFTER 1 LINES                                        14370000
115500         WRITE PORPT-RECORD FROM HEADER-LINE19                    14380000
115600             AFTER 1 LINES                                        14390000
115700                                                                  14400000
115800         MOVE +20                      TO PV-LINE-CNT             14410000
PE6591     END-IF.                                                      14420000
115900                                                                  14430000
116000******************************************************************14440000
116100*  RETRIEVES AND FORMATS PO DATA ON TPURCHS                       14450000
116200******************************************************************14460000
116300 2101-GET-TPURCHS.                                                14470000
116400                                                                  14480000
116500       EXEC SQL                                                   14490000
116600         SELECT ORD_DTE,                                          14500000
116700                PO_TYP_CDE,                                       14510000
116800                STATUS_CDE,                                       14520000
116900                ENT_ID,                                           14530000
117000                TOT_MU_PCT,                                       14540000
117100                TOT_VAL_COST_AMT,                                 14550000
117200                TOT_VAL_RTL_AMT,                                  14560000
117300                TOT_UNT_QTY,                                      14570000
117400                OTB_PER_NBR,                                      14580000
117500                EDI_IND,                                          14590000
117600                NEW_STR_PO_IND,                                   14600000
117700                CRE_BY_UID,                                       14610000
117800                APP_BY_UID,                                       14620000
117900                DEPT_NBR,                                         14630000
118000                ADR_SEQ_NBR,                                      14640000
118100                REVISION_CT,                                      14650000
118200                DEST_KNOWN_IND,                                   14660000
118300                PKGNG_CDE                                         14670000
118400         INTO  :PURCHS-ORD-DTE,                                   14680000
118500               :PURCHS-PO-TYP-CDE,                                14690000
118600               :PURCHS-STATUS-CDE,                                14700000
118700               :PURCHS-ENT-ID,                                    14710000
118800               :PURCHS-TOT-MU-PCT,                                14720000
118900               :PURCHS-TOT-VAL-COST-AMT,                          14730000
119000               :PURCHS-TOT-VAL-RTL-AMT,                           14740000
119100               :PURCHS-TOT-UNT-QTY,                               14750000
119200               :PURCHS-OTB-PER-NBR,                               14760000
119300               :PURCHS-EDI-IND,                                   14770000
119400               :PURCHS-NEW-STR-PO-IND,                            14780000
119500               :PURCHS-CRE-BY-UID,                                14790000
119600               :PURCHS-APP-BY-UID,                                14800000
119700               :PURCHS-DEPT-NBR,                                  14810000
119800               :PURCHS-ADR-SEQ-NBR,                               14820000
119900               :PURCHS-REVISION-CT,                               14830000
120000               :PURCHS-DEST-KNOWN-IND,                            14840000
120100               :PURCHS-PKGNG-CDE                                  14850000
120200         FROM TPURCHS                                             14860000
120300         WHERE PO_NBR         = :IR-PO-NBR2                       14870000
120400           AND VER_STATUS_CDE = 'A'                               14880000
120500           AND PO_CATEG_CDE   = 'MR'                              14890000
120600       END-EXEC.                                                  14900000
120700                                                                  14910000
120800       EVALUATE TRUE                                              14920000
120900         WHEN SQLCODE = +0                                        14930000
121000             CONTINUE                                             14940000
121100         WHEN SQLWARN NOT = SPACE                                 14950000
121200         WHEN SQLCODE NOT = +0                                    14960000
139100             DISPLAY 'PO NUMBER = ' IR-PO-NBR2                    14970000
121400             MOVE '2101-GET-TPURCHS'                              14980000
121500                                   TO PV-ABEND-PARAGRAPH          14990000
121600             PERFORM 9000-SQL-ABEND                               15000000
121700       END-EVALUATE.                                              15010000
121800                                                                  15020000
121900     MOVE IR-PO-NBR2               TO HL1-PO-NBR.                 15030000
122000     MOVE PURCHS-DEPT-NBR          TO HL2-DEPT-NBR                15040000
122100     IF PURCHS-ORD-DTE = PC-INIT-DATE                             15050000
122200         MOVE SPACES               TO HL1-ORD-DATE                15060000
122300     ELSE                                                         15070000
122400         MOVE PURCHS-ORD-DTE       TO PV-DATE-BREAK               15080000
122500         MOVE PV-DB-MM             TO PV-DBS-MM                   15090000
122600         MOVE PV-DB-DD             TO PV-DBS-DD                   15100000
122700         MOVE PV-DB-YY             TO PV-DBS-YY                   15110000
122800         MOVE PV-DATE-BREAK-SLASH  TO HL1-ORD-DATE                15120000
122900     END-IF.                                                      15130000
123000     IF PS-VENDOR-RPT-TYPE AND IR-RPT-TYPE-VN = 'VS'              15140000
123100         MOVE SPACES               TO HL4-MU-PCT                  15150000
123200     ELSE                                                         15160000
123300         MOVE PURCHS-TOT-MU-PCT    TO PV-EDIT-MU-PCT              15170000
123400         MOVE PV-EDIT-MU-PCT       TO HL4-MU-PCT                  15180000
123500     END-IF.                                                      15190000
123501* TKMA888 * REPLACED 1 LINE WITH 26 LINES ************************15200000
123502*           TO CHANGE COMPUTATION OF TOTAL COST FOR IMPORT PO'S   15210000
123503* TKMA888 *------------------------------------------------------*15220000
123504*    MOVE PURCHS-TOT-VAL-COST-AMT  TO HL5-COST.                   15230000
123511*                                                                 15240000
                                                                        15250000
PE6591     PERFORM WITH TEST AFTER                                      15260000
PE6591        VARYING PV-RETRY-COUNTER FROM 1 BY 1                      15270000
PE6591        UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES OR              15280000
PE6591                SQLCODE = ZERO OR (PV-TOT-VAL-COST-AMT-IND = 0)   15290000
123511                                                                  15300000
123512     EXEC SQL                                                     15310000
123513       SELECT ROUND(SUM(UNT_QTY * PRD_1ST_COST_AMT),2)            15320000
PE6591         INTO :PV-TOT-VAL-COST-AMT :PV-TOT-VAL-COST-AMT-IND       15330000
123515         FROM TPURITM                                             15340000
123516        WHERE PO_NBR         = :IR-PO-NBR2                        15350000
123518          AND VER_STATUS_CDE = 'A'                                15360000
123520     END-EXEC                                                     15370000
123521*                                                                 15380000
123522     EVALUATE TRUE                                                15390000
123523         WHEN SQLCODE     = +0                                    15400000
PE6591             IF PV-TOT-VAL-COST-AMT-IND >= 0                      15410000
123524                CONTINUE                                          15420000
PE6591             ELSE                                                 15430000
PE6591                PERFORM 2118-WAIT-QUERY-TPURITM                   15440000
PE6591            END-IF                                                15450000
123525         WHEN SQLWARN NOT = SPACE                                 15460000
123526         WHEN SQLCODE NOT = +0                                    15470000
123527             MOVE '2101-GET-TPURCHS TOT-VAL-COST'                 15480000
123528                                   TO PV-ABEND-PARAGRAPH          15490000
123529             PERFORM 9000-SQL-ABEND                               15500000
123530     END-EVALUATE                                                 15510000
PE6591     END-PERFORM.                                                 15520000
123531*                                                                 15530000
PE6591     IF PV-TOT-VAL-COST-AMT-IND >= 0                              15540000
123532        MOVE PV-TOT-VAL-COST-AMT      TO HL5-COST                 15550000
PE6591     END-IF                                                       15560000
123630* TKMA888 *------------------------------------------------------*15570000
123700     IF PS-VENDOR-RPT-TYPE AND IR-RPT-TYPE-VN = 'VS'              15580000
123800         MOVE SPACES               TO HL6-RETAIL                  15590000
123900     ELSE                                                         15600000
124000         MOVE PURCHS-TOT-VAL-RTL-AMT                              15610000
124100                                   TO PV-DOL-FORM-14              15620000
124200         MOVE PV-DOL-FORM-14       TO HL6-RETAIL                  15630000
124300     END-IF.                                                      15640000
124400     MOVE PURCHS-TOT-UNT-QTY       TO HL7-UNITS.                  15650000
124500     MOVE PURCHS-OTB-PER-NBR       TO PV-OTB-PER-BREAK.           15660000
124600     MOVE PC-MONTH-ABBR (PV-OTBP-MM-N)                            15670000
124700                                   TO HL6-OTBP-MONTH.             15680000
124800     MOVE PV-OTBP-YY               TO HL6-OTBP-YEAR.              15690000
124900     IF PURCHS-EDI-IND = 'Y'                                      15700000
125000         MOVE 'YES'                TO HL7-EDI                     15710000
125100     ELSE                                                         15720000
125200         MOVE 'NO '                TO HL7-EDI                     15730000
125300     END-IF.                                                      15740000
125400     IF PURCHS-NEW-STR-PO-IND = 'Y'                               15750000
125500         MOVE 'YES'                TO HL8-NEW-STORE               15760000
125600     ELSE                                                         15770000
125700         MOVE 'NO '                TO HL8-NEW-STORE               15780000
125800     END-IF.                                                      15790000
125900                                                                  15800000
PE6591******************************************************************15810000
PE6591*  WAITS FOR 7 SECONDS AND QUERIES TPURITM TABLE THRICE AND       15820000
PE6591*  WRITES TO OUTPUT FILE AFTER 20 SECONDS/3 RETRIES.              15830000
PE6591******************************************************************15840000
PE6591 2118-WAIT-QUERY-TPURITM.                                         15850000
PE6591                                                                  15860000
PE6591     PERFORM WITH TEST AFTER                                      15870000
PE6591        VARYING PV-RETRY-COUNTER FROM 1 BY 1                      15880000
PE6591        UNTIL   PV-RETRY-COUNTER > PC-MAX-WAIT-RETRY OR           15890000
PE6591                PV-TOT-VAL-COST-AMT-IND = 0                       15900000
PE6591                                                                  15910000
PE6591                CALL 'SYSWAIT' USING PC-DELAY-INTERVAL            15920000
PE6591     EXEC SQL                                                     15930000
PE6591       SELECT ROUND(SUM(UNT_QTY * PRD_1ST_COST_AMT),2)            15940000
PE6591         INTO :PV-TOT-VAL-COST-AMT :PV-TOT-VAL-COST-AMT-IND       15950000
PE6591         FROM TPURITM                                             15960000
PE6591        WHERE PO_NBR         = :IR-PO-NBR2                        15970000
PE6591          AND VER_STATUS_CDE = 'A'                                15980000
PE6591     END-EXEC                                                     15990000
PE6591                                                                  16000000
PE6591     EVALUATE TRUE                                                16010000
PE6591         WHEN SQLCODE     = +0                                    16020000
PE6591             CONTINUE                                             16030000
PE6591         WHEN SQLWARN NOT = SPACE                                 16040000
PE6591         WHEN SQLCODE NOT = +0                                    16050000
PE6591             MOVE '2118-WAIT-QUERY-TPURITM'                       16060000
PE6591                                   TO PV-ABEND-PARAGRAPH          16070000
PE6591             PERFORM 9000-SQL-ABEND                               16080000
PE6591     END-EVALUATE                                                 16090000
PE6591     END-PERFORM                                                  16100000
PE6591     IF PV-TOT-VAL-COST-AMT-IND < 0                               16110000
PE6591        MOVE IR-PO-NBR2 TO INVALID-PO                             16120000
PE6591        DISPLAY 'WRITING TO INVALID PO FILE '                     16130000
PE6591        WRITE INVALID-PO-RECORD FROM INVALID-PO-REC               16140000
PE6591        WRITE INVALID-PO-RECORD FROM INVALID-PO-MSG               16150000
PE6591        SET PS-INVALID-PO TO TRUE                                 16160000
PE6591     END-IF.                                                      16170000
PE6591                                                                  16180000
126000******************************************************************16190000
126100*  RETRIEVES AND FORMATS PO DATA ON TENTNME                       16200000
126200******************************************************************16210000
126300 2102-GET-TENTNME.                                                16220000
126400                                                                  16230000
126500     EXEC SQL                                                     16240000
126600         SELECT ENT_NAME_DESC                                     16250000
126700         INTO  :ENTNME-ENT-NAME-DESC                              16260000
126800         FROM TENTNME                                             16270000
126900         WHERE ENT_ID = :PURCHS-ENT-ID                            16280000
127000           AND TYPE_CDE = :ENTNME-TYPE-CDE                        16290000
127100     END-EXEC.                                                    16300000
127200                                                                  16310000
127300     EVALUATE TRUE                                                16320000
127400         WHEN SQLCODE = +0                                        16330000
127500         WHEN SQLCODE = +100                                      16340000
127600             CONTINUE                                             16350000
127700         WHEN SQLWARN NOT = SPACE                                 16360000
127800         WHEN SQLCODE NOT = +0                                    16370000
127900             MOVE '2102-GET-TENTNME'                              16380000
128000                                   TO PV-ABEND-PARAGRAPH          16390000
128100             PERFORM 9000-SQL-ABEND                               16400000
128200     END-EVALUATE.                                                16410000
128300                                                                  16420000
128400     IF SQLCODE = +100                                            16430000
128500         MOVE SPACES TO ENTNME-ENT-NAME-DESC                      16440000
128600     END-IF.                                                      16450000
128700                                                                  16460000
128800******************************************************************16470000
128900*  RETRIEVES AND FORMATS PO DATA ON TBUSLOC                       16480000
129000******************************************************************16490000
129100 2103-GET-TBUSLOC.                                                16500000
129200                                                                  16510000
129300     EXEC SQL                                                     16520000
129400         SELECT ADDRESS_LINE1_DESC,                               16530000
129500                ADDRESS_LINE2_DESC,                               16540000
129600                ATTENTION_TO_TXT,                                 16550000
129700                CITY_NAME,                                        16560000
129800                ZIP_CDE,                                          16570000
129900                ST_PROV_CDE,                                      16580000
130000                CNTRY_CDE                                         16590000
130100         INTO  :BUSLOC-ADDRESS-LINE1-DESC,                        16600000
130200               :BUSLOC-ADDRESS-LINE2-DESC,                        16610000
130300               :BUSLOC-ATTENTION-TO-TXT,                          16620000
130400               :BUSLOC-CITY-NAME,                                 16630000
130500               :BUSLOC-ZIP-CDE,                                   16640000
130600               :BUSLOC-ST-PROV-CDE,                               16650000
130700               :BUSLOC-CNTRY-CDE                                  16660000
130800         FROM TBUSLOC                                             16670000
130900         WHERE ENT_ID = :PURCHS-ENT-ID                            16680000
131000           AND FUNCTION_ID = 2                                    16690000
131100           AND SEQ_NBR = :PURCHS-ADR-SEQ-NBR                      16700000
131200     END-EXEC.                                                    16710000
131300                                                                  16720000
131400     EVALUATE TRUE                                                16730000
131500         WHEN SQLCODE = +0                                        16740000
131600         WHEN SQLCODE = +100                                      16750000
131700             CONTINUE                                             16760000
131800         WHEN SQLWARN NOT = SPACE                                 16770000
131900         WHEN SQLCODE NOT = +0                                    16780000
132000             MOVE '2103-GET-TBUSLOC'                              16790000
132100                                   TO PV-ABEND-PARAGRAPH          16800000
132200             PERFORM 9000-SQL-ABEND                               16810000
132300     END-EVALUATE.                                                16820000
132400                                                                  16830000
132500     IF SQLCODE = +100                                            16840000
132600         MOVE SPACES               TO HL5-VEND-ADDR-1             16850000
132700         MOVE SPACES               TO HL6-VEND-ADDR-2             16860000
132800         MOVE SPACES               TO HL7-VEND-ADDR-3             16870000
132900     ELSE                                                         16880000
133000         MOVE BUSLOC-CITY-NAME TO PV-CITY                         16890000
133100         IF BUSLOC-CNTRY-CDE = 'US ' OR SPACES                    16900000
133200             MOVE SPACES             TO PV-COUNTRY                16910000
133300                                        PV-STATE-PROV             16920000
133400             MOVE BUSLOC-ST-PROV-CDE TO PV-STATE-PROV             16930000
133500         ELSE                                                     16940000
133600             PERFORM 2150-RETRIEVE-PROV-COUNTRY                   16950000
133700         END-IF                                                   16960000
133800         MOVE BUSLOC-ADDRESS-LINE1-DESC                           16970000
133900                                   TO HL5-VEND-ADDR-1             16980000
134000         IF BUSLOC-ADDRESS-LINE2-DESC > SPACES                    16990000
134100             MOVE BUSLOC-ADDRESS-LINE2-DESC                       17000000
134200                                   TO HL6-VEND-ADDR-2             17010000
134300             INITIALIZE HL7-VEND-ADDR-3                           17020000
134400             STRING PV-CITY             DELIMITED BY '  '         17030000
134500                    ', '                DELIMITED BY SIZE         17040000
134600                    PV-STATE-PROV       DELIMITED BY '  '         17050000
134700                    '  '                DELIMITED BY SIZE         17060000
134800                    BUSLOC-ZIP-CDE      DELIMITED BY '  '         17070000
134900                    '  '                DELIMITED BY SIZE         17080000
135000                    PV-COUNTRY          DELIMITED BY '  '         17090000
135100                                 INTO HL7-VEND-ADDR-3             17100000
135200         ELSE                                                     17110000
135300             INITIALIZE HL6-VEND-ADDR-2                           17120000
135400             STRING PV-CITY             DELIMITED BY '  '         17130000
135500                    ', '                DELIMITED BY SIZE         17140000
135600                    PV-STATE-PROV       DELIMITED BY '  '         17150000
135700                    '  '                DELIMITED BY SIZE         17160000
135800                    BUSLOC-ZIP-CDE      DELIMITED BY '  '         17170000
135900                    '  '                DELIMITED BY SIZE         17180000
136000                    PV-COUNTRY          DELIMITED BY '  '         17190000
136100                                 INTO HL6-VEND-ADDR-2             17200000
136200             MOVE BUSLOC-ATTENTION-TO-TXT                         17210000
136300                                   TO HL7-VEND-ADDR-3             17220000
136400         END-IF                                                   17230000
136500     END-IF.                                                      17240000
136600                                                                  17250000
136700******************************************************************17260000
136800*  RETRIEVES AND FORMATS PO DATA ON TPLNSHP                       17270000
136900******************************************************************17280000
137000 2104-GET-TPLNSHP.                                                17290000
137100                                                                  17300000
137200     EXEC SQL                                                     17310000
137300         SELECT FRGT_PAYT_CDE,                                    17320000
137400                DONT_SHIP_BEF_DTE,                                17330000
137500                CAN_IFNOT_SHIP_DTE,                               17340000
137600                EXT_CAN_DTE                                       17350000
137700         INTO  :PLNSHP-FRGT-PAYT-CDE,                             17360000
137800               :PLNSHP-DONT-SHIP-BEF-DTE,                         17370000
137900               :PLNSHP-CAN-IFNOT-SHIP-DTE,                        17380000
138000               :PLNSHP-EXT-CAN-DTE                                17390000
138100         FROM TPLNSHP                                             17400000
138200         WHERE PO_NBR = :IR-PO-NBR2                               17410000
138300           AND VER_STATUS_CDE = 'A'                               17420000
138400     END-EXEC.                                                    17430000
138500                                                                  17440000
138600     EVALUATE TRUE                                                17450000
138700         WHEN SQLCODE = +0                                        17460000
138800             CONTINUE                                             17470000
138900         WHEN SQLWARN NOT = SPACE                                 17480000
139000         WHEN SQLCODE NOT = +0                                    17490000
139100             DISPLAY 'PO NUMBER = ' IR-PO-NBR2                    17500000
139200             MOVE '2104-GET-TPLNSHP'                              17510000
139300                                   TO PV-ABEND-PARAGRAPH          17520000
139400             PERFORM 9000-SQL-ABEND                               17530000
139500     END-EVALUATE.                                                17540000
139600                                                                  17550000
139700     IF PLNSHP-FRGT-PAYT-CDE = 'V'                                17560000
139800         MOVE '04' TO ENTNME-TYPE-CDE                             17570000
139900         PERFORM 2102-GET-TENTNME                                 17580000
140000         MOVE ENTNME-ENT-NAME-DESC TO HL18-PAY-FRT                17590000
140100     ELSE                                                         17600000
140200         IF PLNSHP-FRGT-PAYT-CDE = 'B'                            17610000
140300             MOVE 'BOTH'           TO HL18-PAY-FRT                17620000
140400         ELSE                                                     17630000
140500             MOVE 'KOHLS'          TO HL18-PAY-FRT                17640000
140600         END-IF                                                   17650000
140700     END-IF.                                                      17660000
140800     MOVE PLNSHP-DONT-SHIP-BEF-DTE TO PV-DATE-BREAK.              17670000
140900     MOVE PV-DB-MM                 TO HL4-DNSB-MONTH.             17680000
141000     MOVE PV-DB-DD                 TO HL4-DNSB-DAY.               17690000
141100     MOVE PV-DB-YY                 TO HL4-DNSB-YEAR.              17700000
141200     IF PLNSHP-CAN-IFNOT-SHIP-DTE > PLNSHP-EXT-CAN-DTE            17710000
141300         MOVE PLNSHP-CAN-IFNOT-SHIP-DTE                           17720000
141400                                   TO PV-DATE-BREAK               17730000
141500         MOVE PV-DB-MM             TO HL5-CNSB-MONTH              17740000
141600         MOVE PV-DB-DD             TO HL5-CNSB-DAY                17750000
141700         MOVE PV-DB-YY             TO HL5-CNSB-YEAR               17760000
141800     ELSE                                                         17770000
141900         MOVE PLNSHP-EXT-CAN-DTE                                  17780000
142000                                   TO PV-DATE-BREAK               17790000
142100         MOVE PV-DB-MM             TO HL5-CNSB-MONTH              17800000
142200         MOVE PV-DB-DD             TO HL5-CNSB-DAY                17810000
142300         MOVE PV-DB-YY             TO HL5-CNSB-YEAR               17820000
142400     END-IF.                                                      17830000
142500                                                                  17840000
142600******************************************************************17850000
142700*  RETRIEVES AND FORMATS SHIP TO DATA ON XMT-LOC                  17860000
142800******************************************************************17870000
142900 2105-GET-XMT-LOC.                                                17880000
143000                                                                  17890000
143100     EXEC SQL                                                     17900000
143200         SELECT LOC_NM,                                           17910000
143300                LNE_1_ADDR,                                       17920000
143400                LNE_2_ADDR,                                       17930000
143500                CTY_NM,                                           17940000
143600                ST_CDE,                                           17950000
143700                ZIP_10_CDE                                        17960000
143800         INTO  :XMT00001-LOC-NM,                                  17970000
143900               :XMT00001-LNE-1-ADDR,                              17980000
144000               :XMT00001-LNE-2-ADDR,                              17990000
144100               :XMT00001-CTY-NM,                                  18000000
144200               :XMT00001-ST-CDE,                                  18010000
144300               :XMT00001-ZIP-10-CDE                               18020000
144400         FROM XMT_LOC                                             18030000
144500         WHERE LOC_NBR = :ALLPLN-DEST-NBR                         18040000
144600     END-EXEC.                                                    18050000
144700                                                                  18060000
144800     EVALUATE TRUE                                                18070000
144900         WHEN SQLCODE = +0                                        18080000
145000         WHEN SQLCODE = +100                                      18090000
145100             CONTINUE                                             18100000
145200         WHEN SQLWARN NOT = SPACE                                 18110000
145300         WHEN SQLCODE NOT = +0                                    18120000
145400             MOVE '2105-GET-XMT-LOC'                              18130000
145500                                   TO PV-ABEND-PARAGRAPH          18140000
145600             PERFORM 9000-SQL-ABEND                               18150000
145700     END-EVALUATE.                                                18160000
145800                                                                  18170000
145900     IF SQLCODE = 0                                               18180000
146000         MOVE XMT00001-LOC-NM  TO HL10-SHIP-TO-NAME               18190000
146100         MOVE XMT00001-LNE-1-ADDR                                 18200000
146200                                   TO HL11-SHIP-TO-ADDR-1         18210000
146300         MOVE XMT00001-ZIP-10-CDE                                 18220000
146400                                   TO PV-EDIT-ZIP-CODE            18230000
               IF PV-EZD-DASH EQUAL '-' OR ' '                          18240000
                  MOVE PV-EZD-1-5          TO PV-ZCD-1-5                18250000
                  MOVE PV-EZD-6-9          TO PV-ZCD-6-9                18260000
               ELSE                                                     18270000
                  MOVE PV-EZND-1-5          TO PV-ZCD-1-5               18280000
                  MOVE PV-EZND-6-9          TO PV-ZCD-6-9               18290000
               END-IF                                                   18300000
146700         IF XMT00001-LNE-2-ADDR > SPACES                          18310000
146800             MOVE XMT00001-LNE-2-ADDR                             18320000
146900                                   TO HL12-SHIP-TO-ADDR-2         18330000
147000             INITIALIZE HL13-SHIP-TO-ADDR-3                       18340000
147100             STRING XMT00001-CTY-NM        DELIMITED BY '  '      18350000
147200                    ', '                   DELIMITED BY SIZE      18360000
147300                    XMT00001-ST-CDE        DELIMITED BY '  '      18370000
147400                    '  '                   DELIMITED BY SIZE      18380000
147500                    PV-ZIP-CODE-DISPLAY    DELIMITED BY SIZE      18390000
147600                                 INTO HL13-SHIP-TO-ADDR-3         18400000
147700         ELSE                                                     18410000
147800             INITIALIZE HL12-SHIP-TO-ADDR-2                       18420000
147900             STRING XMT00001-CTY-NM        DELIMITED BY '  '      18430000
148000                    ', '                   DELIMITED BY SIZE      18440000
148100                    XMT00001-ST-CDE        DELIMITED BY '  '      18450000
148200                    '  '                   DELIMITED BY SIZE      18460000
148300                    PV-ZIP-CODE-DISPLAY    DELIMITED BY SIZE      18470000
148400                                 INTO HL12-SHIP-TO-ADDR-2         18480000
148500             MOVE SPACES           TO HL13-SHIP-TO-ADDR-3         18490000
148600         END-IF                                                   18500000
148700     ELSE                                                         18510000
148800         MOVE SPACES               TO HL10-SHIP-TO-NAME           18520000
148900                                      HL11-SHIP-TO-ADDR-1         18530000
149000                                      HL12-SHIP-TO-ADDR-2         18540000
149100                                      HL13-SHIP-TO-ADDR-3         18550000
149200     END-IF.                                                      18560000
149300                                                                  18570000
149400******************************************************************18580000
149500*  RETRIEVES AND FORMATS PO DATA ON PAYMENT TPOAGMT               18590000
149600******************************************************************18600000
149700 2106-GET-TPOAGMT-2.                                              18610000
149800                                                                  18620000
149900     EXEC SQL                                                     18630000
150000         SELECT PAYT_TERM_ID                                      18640000
150100               ,DISC_PAY_DAY_QTY                                  18650000
150200               ,DISC_DOL_AMT                                      18660000
150300               ,DISC_PCT                                          18670000
150400         INTO  :POAGMT-PAYT-TERM-ID                               18680000
150500              ,:POAGMT-DISC-PAY-DAY-QTY                           18690000
150600              ,:POAGMT-DISC-DOL-AMT                               18700000
150700              ,:POAGMT-DISC-PCT                                   18710000
150800         FROM TPOAGMT                                             18720000
150900         WHERE PO_NBR = :IR-PO-NBR2                               18730000
151000           AND VER_STATUS_CDE = 'A'                               18740000
151100           AND AGRMT_TYP_ID = '2'                                 18750000
151200     END-EXEC.                                                    18760000
151300                                                                  18770000
151400     EVALUATE TRUE                                                18780000
151500         WHEN SQLCODE = +0                                        18790000
151600             CONTINUE                                             18800000
151700         WHEN SQLWARN NOT = SPACE                                 18810000
151800         WHEN SQLCODE NOT = +0                                    18820000
151900             DISPLAY 'PO NUMBER = ' IR-PO-NBR2                    18830000
152000             MOVE '2106-GET-TPOAGMT-2'                            18840000
152100                                   TO PV-ABEND-PARAGRAPH          18850000
152200             PERFORM 9000-SQL-ABEND                               18860000
152300     END-EVALUATE.                                                18870000
152400                                                                  18880000
152500     MOVE POAGMT-DISC-PAY-DAY-QTY  TO HL9-EXTEND-DATE.            18890000
152600     MOVE POAGMT-DISC-DOL-AMT      TO HL10-VEND-DIS-AMT.          18900000
152700                                                                  18910000
152800     COMPUTE PV-PCT-HOLD = POAGMT-DISC-PCT * 100.                 18920000
152900     MOVE PV-PCT-HOLD              TO HL10-VEND-DIS-PCT.          18930000
153000     PERFORM 2198-GET-TPAYTRM.                                    18940000
153100     IF SQLCODE = +0                                              18950000
153200         PERFORM 2199-FORMAT-PAYMENT-TERM                         18960000
153300     ELSE                                                         18970000
153400         MOVE SPACES               TO HL8-PAY-TERM                18980000
153500     END-IF.                                                      18990000
153600                                                                  19000000
153700******************************************************************19010000
153800*  RETRIEVES TPOAGMT TO CHECK FOR EXISTENCE                       19020000
153900******************************************************************19030000
154000 2107-GET-TPOAGMT-4.                                              19040000
154100                                                                  19050000
154200     EXEC SQL                                                     19060000
154300         SELECT TYP_CDE                                           19070000
154400         INTO  :POAGMT-TYP-CDE                                    19080000
154500         FROM TPOAGMT                                             19090000
154600         WHERE PO_NBR = :IR-PO-NBR2                               19100000
154700           AND VER_STATUS_CDE = 'A'                               19110000
154800           AND AGRMT_TYP_ID = '4'                                 19120000
154900           AND TYP_CDE = :POAGMT-TYP-CDE                          19130000
155000     END-EXEC.                                                    19140000
155100                                                                  19150000
155200     EVALUATE TRUE                                                19160000
155300         WHEN SQLCODE = +0                                        19170000
155400         WHEN SQLCODE = +100                                      19180000
155500             CONTINUE                                             19190000
155600         WHEN SQLWARN NOT = SPACE                                 19200000
155700         WHEN SQLCODE NOT = +0                                    19210000
155800             DISPLAY 'PO NUMBER = ' IR-PO-NBR2                    19220000
155900             DISPLAY 'TYP CDE = ' POAGMT-TYP-CDE                  19230000
156000             MOVE '2107-GET-TPOAGMT-4'                            19240000
156100                                   TO PV-ABEND-PARAGRAPH          19250000
156200             PERFORM 9000-SQL-ABEND                               19260000
156300     END-EVALUATE.                                                19270000
156400                                                                  19280000
156500******************************************************************19290000
156600*  RETRIEVES NAMES FROM TWORKER                                   19300000
156700******************************************************************19310000
156800 2108-GET-TWORKER.                                                19320000
156900                                                                  19330000
157000     EXEC SQL                                                     19340000
157100         SELECT LAST_NAME,                                        19350000
157200                FIR_NAME                                          19360000
157300         INTO  :WORKER-LAST-NAME,                                 19370000
157400               :WORKER-FIR-NAME                                   19380000
157500         FROM TWORKER                                             19390000
157600         WHERE UID_NBR = :WORKER-UID-NBR                          19400000
157700     END-EXEC.                                                    19410000
157800                                                                  19420000
157900     EVALUATE TRUE                                                19430000
158000         WHEN SQLCODE = +0                                        19440000
158100         WHEN SQLCODE = +100                                      19450000
158200         WHEN SQLCODE = -811                                      19460000
158300             CONTINUE                                             19470000
158400         WHEN SQLWARN NOT = SPACE                                 19480000
158500         WHEN SQLCODE NOT = +0                                    19490000
158600             MOVE '2108-GET-TWORKER'                              19500000
158700                                   TO PV-ABEND-PARAGRAPH          19510000
158800             PERFORM 9000-SQL-ABEND                               19520000
158900     END-EVALUATE.                                                19530000
159000                                                                  19540000
159100     IF SQLCODE = +100                                            19550000
159200         MOVE SPACES               TO WORKER-LAST-NAME            19560000
159300                                      WORKER-FIR-NAME             19570000
159400     END-IF.                                                      19580000
159500                                                                  19590000
159600******************************************************************19600000
159700*  RETRIEVES ANY AD MERCHANDISE FROM TPURITM                      19610000
159800******************************************************************19620000
159900 2109-GET-TPURITM.                                                19630000
160000                                                                  19640000
160100     PERFORM WITH TEST AFTER                                      19650000
160200        VARYING PV-RETRY-COUNTER FROM 1 BY 1                      19660000
160300        UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES OR              19670000
160400                SQLCODE = ZERO OR SQLCODE = +100                  19680000
160500        EXEC SQL                                                  19690000
160600            SELECT MIN(AD_EVNT_DTE)                               19700000
160700            INTO :PURITM-AD-EVNT-DTE:PV-NULL-IND                  19710000
160800            FROM TPURITM                                          19720000
160900            WHERE PO_NBR = :IR-PO-NBR2                            19730000
161000              AND VER_STATUS_CDE = 'A'                            19740000
161100              AND AD_EVNT_DTE > :PC-INIT-DATE                     19750000
161200              AND STATUS_CDE ^= 'CA'                              19760000
161300        END-EXEC                                                  19770000
161400                                                                  19780000
161500        EVALUATE TRUE                                             19790000
161600            WHEN SQLCODE = +0                                     19800000
161700            WHEN SQLCODE = +100                                   19810000
161800            WHEN SQLCODE = -904                                   19820000
161900            WHEN SQLCODE = -911                                   19830000
162000            WHEN SQLCODE = -913                                   19840000
162100                CONTINUE                                          19850000
162200            WHEN SQLWARN NOT = SPACE                              19860000
162300            WHEN SQLCODE NOT = +0                                 19870000
162400                MOVE '2109-GET-TPURITM'                           19880000
162500                                      TO PV-ABEND-PARAGRAPH       19890000
162600                PERFORM 9000-SQL-ABEND                            19900000
162700        END-EVALUATE                                              19910000
162800     END-PERFORM.                                                 19920000
162900                                                                  19930000
163000     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         19940000
163100         MOVE '2109-GET-TPURITM' TO PV-ABEND-PARAGRAPH            19950000
163200         PERFORM 9000-SQL-ABEND                                   19960000
163300     END-IF.                                                      19970000
163400                                                                  19980000
163500     IF SQLCODE = +100 OR                                         19990000
163600        PV-NULL-IND < +0                                          20000000
163700         MOVE 'NO '                TO HL19-AD-MERCH               20010000
163800         MOVE SPACES               TO HL19-AD-DATE                20020000
163900     ELSE                                                         20030000
164000         MOVE 'YES'                TO HL19-AD-MERCH               20040000
164100         MOVE PURITM-AD-EVNT-DTE   TO PV-DATE-BREAK               20050000
164200         MOVE PV-DB-MM             TO PV-DBS-MM                   20060000
164300         MOVE PV-DB-DD             TO PV-DBS-DD                   20070000
164400         MOVE PV-DB-YY             TO PV-DBS-YY                   20080000
164500         MOVE PV-DATE-BREAK-SLASH  TO HL19-AD-DATE                20090000
164600     END-IF.                                                      20100000
164700                                                                  20110000
164800******************************************************************20120000
164900*  GET DEPARTMENT NAME FROM TMDSEAR                               20130000
165000******************************************************************20140000
165100 2110-GET-TMDSEAR.                                                20150000
165200                                                                  20160000
165300     EXEC SQL                                                     20170000
165400         SELECT MDSEAR_DESC                                       20180000
165500               ,MDSEAR_DKEY                                       20190000
165600               ,GMA_NBR                                           20200000
165700               ,DMA_NBR                                           20210000
165800         INTO  :MDSEAR-DESC                                       20220000
165900              ,:MDSEAR-DKEY                                       20230000
166000              ,:MDSEAR-GMA-NBR                                    20240000
166100              ,:MDSEAR-DMA-NBR                                    20250000
166200         FROM TMDSEAR                                             20260000
166300         WHERE OPERCO_NBR = '03'                                  20270000
166400           AND DEPT_NBR = :PURCHS-DEPT-NBR                        20280000
166500           AND MDSELV_CDE = 'DPT'                                 20290000
166600           AND STRT_DTE <= CURRENT DATE                           20300000
166700           AND END_DTE >= CURRENT DATE                            20310000
166800     END-EXEC.                                                    20320000
166900                                                                  20330000
167000     EVALUATE TRUE                                                20340000
167100         WHEN SQLCODE = +0                                        20350000
167200         WHEN SQLCODE = +100                                      20360000
167300             CONTINUE                                             20370000
167400         WHEN SQLWARN NOT = SPACE                                 20380000
167500         WHEN SQLCODE NOT = +0                                    20390000
167600             MOVE '2110-GET-TMDSEAR'                              20400000
167700                                   TO PV-ABEND-PARAGRAPH          20410000
167800             PERFORM 9000-SQL-ABEND                               20420000
167900     END-EVALUATE.                                                20430000
168000                                                                  20440000
168100     IF SQLCODE = +100                                            20450000
168200         MOVE SPACES               TO HL2-DEPT-NAME               20460000
168300     ELSE                                                         20470000
168400         MOVE MDSEAR-DESC          TO HL2-DEPT-NAME               20480000
168500     END-IF.                                                      20490000
168600                                                                  20500000
168700******************************************************************20510000
168800*  GET BUYER NAME FROM TRSPBAR                                    20520000
168900******************************************************************20530000
169000 2111-GET-BUYER.                                                  20540000
169100                                                                  20550000
169200     EXEC SQL                                                     20560000
169300         SELECT WORKER_LAST_NAME                                  20570000
169400               ,WORKER_FIR_NAME                                   20580000
169500         INTO  :RSPBAR-WORKER-LAST-NAME                           20590000
169600              ,:RSPBAR-WORKER-FIR-NAME                            20600000
169700         FROM TRSPBAR                                             20610000
169800         WHERE MDSEAR_DKEY = :MDSEAR-DKEY                         20620000
169900           AND RSPLVL_CDE = 'BYR'                                 20630000
170000           AND WORKER_STRT_DTE <= CURRENT DATE                    20640000
170100           AND WORKER_END_DTE >= CURRENT DATE                     20650000
170200     END-EXEC.                                                    20660000
170300                                                                  20670000
170400     EVALUATE TRUE                                                20680000
170500         WHEN SQLCODE = +0                                        20690000
170600         WHEN SQLCODE = +100                                      20700000
170700             CONTINUE                                             20710000
170800         WHEN SQLWARN NOT = SPACE                                 20720000
170900         WHEN SQLCODE NOT = +0                                    20730000
171000             MOVE '2111-GET-BUYER'                                20740000
171100                                   TO PV-ABEND-PARAGRAPH          20750000
171200             PERFORM 9000-SQL-ABEND                               20760000
171300     END-EVALUATE.                                                20770000
171400                                                                  20780000
171500     IF SQLCODE = +100                                            20790000
171600         MOVE SPACES               TO HL12-BUYER                  20800000
171700     ELSE                                                         20810000
171800         MOVE 20                   TO DP024-FLNAME-LENGTH         20820000
171900         MOVE RSPBAR-WORKER-LAST-NAME                             20830000
172000                                   TO DP024-LNAME                 20840000
172100         MOVE RSPBAR-WORKER-FIR-NAME                              20850000
172200                                   TO DP024-FNAME                 20860000
172300         PERFORM DP024-0000-FORMAT-NAME                           20870000
172400         MOVE DP024-FLNAME         TO HL12-BUYER                  20880000
172500     END-IF.                                                      20890000
172600                                                                  20900000
172700******************************************************************20910000
172800*  RETRIEVES NAME OF DMM                                          20920000
172900******************************************************************20930000
173000 2112-GET-DMM.                                                    20940000
173100                                                                  20950000
173200     EXEC SQL                                                     20960000
173300         SELECT DISTINCT B.WORKER_LAST_NAME,                      20970000
173400                         B.WORKER_FIR_NAME                        20980000
173500         INTO  :RSPBAR-WORKER-LAST-NAME,                          20990000
173600               :RSPBAR-WORKER-FIR-NAME                            21000000
173700         FROM TMDSEAR A,                                          21010000
173800              TRSPBAR B                                           21020000
173900         WHERE A.OPERCO_NBR  = '03'                               21030000
174000           AND A.GMA_NBR     = :MDSEAR-GMA-NBR                    21040000
174100           AND A.DMA_NBR     = :MDSEAR-DMA-NBR                    21050000
174200           AND MDSELV_CDE    = 'DMA'                              21060000
174300           AND A.MDSEAR_DKEY = B.MDSEAR_DKEY                      21070000
174400           AND B.RSPLVL_CDE  = 'DMM'                              21080000
174500           AND B.WORKER_STRT_DTE < CURRENT DATE                   21090000
174600           AND B.WORKER_END_DTE  > CURRENT DATE                   21100000
174700     END-EXEC.                                                    21110000
174800                                                                  21120000
174900     EVALUATE TRUE                                                21130000
175000         WHEN SQLCODE = +0                                        21140000
175100         WHEN SQLCODE = +100                                      21150000
175200             CONTINUE                                             21160000
175300         WHEN SQLWARN NOT = SPACE                                 21170000
175400         WHEN SQLCODE NOT = +0                                    21180000
175500             MOVE '2112-GET-DMM    '                              21190000
175600                                   TO PV-ABEND-PARAGRAPH          21200000
175700             PERFORM 9000-SQL-ABEND                               21210000
175800     END-EVALUATE.                                                21220000
175900                                                                  21230000
176000     IF SQLCODE = +100                                            21240000
176100         MOVE SPACES               TO HL13-APPROVE-BY             21250000
176200     ELSE                                                         21260000
176300         MOVE 20                   TO DP024-FLNAME-LENGTH         21270000
176400         MOVE RSPBAR-WORKER-LAST-NAME                             21280000
176500                                   TO DP024-LNAME                 21290000
176600         MOVE RSPBAR-WORKER-FIR-NAME                              21300000
176700                                   TO DP024-FNAME                 21310000
176800         PERFORM DP024-0000-FORMAT-NAME                           21320000
176900         MOVE DP024-FLNAME         TO HL13-APPROVE-BY             21330000
177000     END-IF.                                                      21340000
177100                                                                  21350000
177200******************************************************************21360000
177300*  RETRIEVES AND FORMATS EDI PROMO TEXT ON TPOAGMT                21370000
177400******************************************************************21380000
177500 2113-GET-TPOAGMT-3.                                              21390000
177600                                                                  21400000
177700     EXEC SQL                                                     21410000
177800         SELECT EDI_PROMO_TXT                                     21420000
177900                                                                  21430000
178000         INTO  :POAGMT-EDI-PROMO-TXT                              21440000
178100                                                                  21450000
178200         FROM TPOAGMT                                             21460000
178300         WHERE PO_NBR = :IR-PO-NBR2                               21470000
178400           AND VER_STATUS_CDE = 'A'                               21480000
178500           AND AGRMT_TYP_ID = '3'                                 21490000
178600     END-EXEC.                                                    21500000
178700                                                                  21510000
178800     EVALUATE TRUE                                                21520000
178900         WHEN SQLCODE = +0                                        21530000
179000             CONTINUE                                             21540000
179100         WHEN SQLCODE = +100                                      21550000
179200             MOVE SPACES           TO HL7-EDI-DEAL                21560000
179300         WHEN SQLWARN NOT = SPACE                                 21570000
179400         WHEN SQLCODE NOT = +0                                    21580000
179500             MOVE '2113-GET-TPOAGMT-3'                            21590000
179600                                   TO PV-ABEND-PARAGRAPH          21600000
179700             PERFORM 9000-SQL-ABEND                               21610000
179800     END-EVALUATE.                                                21620000
179900                                                                  21630000
180000     IF PURCHS-EDI-IND = 'Y'                                      21640000
180100        MOVE POAGMT-EDI-PROMO-TXT  TO HL7-EDI-DEAL                21650000
180200     ELSE                                                         21660000
180300        MOVE SPACES                TO HL7-EDI-DEAL                21670000
180400     END-IF.                                                      21680000
180500                                                                  21690000
180600 2114-ADDL-DISCOUNT.                                              21700000
180700******************************************************************21710000
180800*  SELECT THE ADDITIONAL DISCOUNT DATA                            21720000
180900******************************************************************21730000
181000*    DISPLAY '2114-ADDL-DISCOUNT'.                                21740000
181100                                                                  21750000
181200     EXEC SQL                                                     21760000
181300         SELECT DISC_DOL_AMT,                                     21770000
181400                DISC_PCT,                                         21780000
181500                DISC_PAY_DAY_QTY                                  21790000
181600         INTO :POAGMT-DISC-DOL-AMT,                               21800000
181700              :POAGMT-DISC-PCT,                                   21810000
181800              :POAGMT-DISC-PAY-DAY-QTY                            21820000
181900         FROM TPOAGMT                                             21830000
182000         WHERE PO_NBR         = :IR-PO-NBR2   AND                 21840000
182100               AGRMT_TYP_ID   = '5'           AND                 21850000
182200               TYP_CDE        = 1             AND                 21860000
182300               VER_STATUS_CDE = 'A'                               21870000
182400     END-EXEC.                                                    21880000
182500                                                                  21890000
182600     EVALUATE TRUE                                                21900000
182700                                                                  21910000
182800         WHEN SQLCODE = +000                                      21920000
182900           IF POAGMT-DISC-PAY-DAY-QTY > 0                         21930000
183000             MOVE POAGMT-DISC-PAY-DAY-QTY TO HL15-ADDL-DAYS       21940000
183100           ELSE                                                   21950000
183200             MOVE ZEROS                     TO HL15-ADDL-DAYS     21960000
183300           END-IF                                                 21970000
183400                                                                  21980000
183500           IF POAGMT-DISC-DOL-AMT > 0                             21990000
183600             MOVE POAGMT-DISC-DOL-AMT TO HL16-ADDL-AMOUNT         22000000
183700           ELSE                                                   22010000
183800             MOVE ZEROS                 TO HL16-ADDL-AMOUNT       22020000
183900           END-IF                                                 22030000
184000                                                                  22040000
184100           IF POAGMT-DISC-PCT > 0                                 22050000
184200             COMPUTE PV-PCT-HOLD = POAGMT-DISC-PCT * 100          22060000
184300             MOVE PV-PCT-HOLD           TO HL17-ADDL-PERCENT      22070000
184400           ELSE                                                   22080000
184500             MOVE ZEROS                 TO HL17-ADDL-PERCENT      22090000
184600           END-IF                                                 22100000
184700                                                                  22110000
184800         WHEN SQLCODE = +100                                      22120000
184900             MOVE ZEROS                 TO HL15-ADDL-DAYS         22130000
185000             MOVE ZEROS                 TO HL16-ADDL-AMOUNT       22140000
185100             MOVE ZEROS                 TO HL17-ADDL-PERCENT      22150000
185200         WHEN SQLWARN NOT = SPACES                                22160000
185300         WHEN SQLCODE NOT = +000                                  22170000
185400             MOVE '2114-ADDL-DISCOUNT'    TO PV-ABEND-PARAGRAPH   22180000
185500                                                                  22190000
185600             PERFORM 9000-SQL-ABEND                               22200000
185700                                                                  22210000
185800     END-EVALUATE.                                                22220000
185900 EJECT                                                            22230000
186000 2115-MOS-DISCOUNT.                                               22240000
186100******************************************************************22250000
186200*  SELECT THE MARK OUT OF STOCK DISCOUNT DATA                     22260000
186300******************************************************************22270000
186400*    DISPLAY '2115-MOS-DISCOUNT'.                                 22280000
186500                                                                  22290000
186600     EXEC SQL                                                     22300000
186700         SELECT DISC_PCT                                          22310000
186800         INTO :POAGMT-DISC-PCT                                    22320000
186900         FROM TPOAGMT                                             22330000
187000         WHERE PO_NBR         = :IR-PO-NBR2        AND            22340000
187100               AGRMT_TYP_ID   = '5'                AND            22350000
187200               TYP_CDE        = 7                  AND            22360000
187300               VER_STATUS_CDE = 'A'                               22370000
187400     END-EXEC.                                                    22380000
187500                                                                  22390000
187600     EVALUATE TRUE                                                22400000
187700                                                                  22410000
187800         WHEN SQLCODE = +000                                      22420000
187900           IF POAGMT-DISC-PCT > 0                                 22430000
188000             COMPUTE PV-PCT-HOLD = POAGMT-DISC-PCT * 100          22440000
188100             MOVE PV-PCT-HOLD           TO HL11-MOS-PCT           22450000
188200           ELSE                                                   22460000
188300             MOVE ZEROS                 TO HL11-MOS-PCT           22470000
188400           END-IF                                                 22480000
188500                                                                  22490000
188600         WHEN SQLCODE = +100                                      22500000
188700             MOVE ZEROS                 TO HL11-MOS-PCT           22510000
188800         WHEN SQLWARN NOT = SPACES                                22520000
188900         WHEN SQLCODE NOT = +000                                  22530000
189000             MOVE '2115-MOS-DISCOUNT'     TO PV-ABEND-PARAGRAPH   22540000
189100                                                                  22550000
189200             PERFORM 9000-SQL-ABEND                               22560000
189300                                                                  22570000
189400     END-EVALUATE.                                                22580000
189500 EJECT                                                            22590000
189600 2116-TRD-DISCOUNT.                                               22600000
189700******************************************************************22610000
189800*  SELECT THE TRADE DISCOUNT DATA                                 22620000
189900******************************************************************22630000
190000*    DISPLAY '2116-TRD-DISCOUNT'.                                 22640000
190100                                                                  22650000
190200     EXEC SQL                                                     22660000
190300         SELECT DISC_PCT                                          22670000
190400         INTO :POAGMT-DISC-PCT                                    22680000
190500         FROM TPOAGMT                                             22690000
190600         WHERE PO_NBR         = :IR-PO-NBR2        AND            22700000
190700               AGRMT_TYP_ID   = '5'                AND            22710000
190800               TYP_CDE        = 8                  AND            22720000
190900               VER_STATUS_CDE = 'A'                               22730000
191000     END-EXEC.                                                    22740000
191100                                                                  22750000
191200     EVALUATE TRUE                                                22760000
191300                                                                  22770000
191400         WHEN SQLCODE = +000                                      22780000
191500           IF POAGMT-DISC-PCT > 0                                 22790000
191600             COMPUTE PV-PCT-HOLD = POAGMT-DISC-PCT * 100          22800000
191700             MOVE PV-PCT-HOLD           TO HL12-TRD-PCT           22810000
191800           ELSE                                                   22820000
191900             MOVE ZEROS                 TO HL12-TRD-PCT           22830000
192000           END-IF                                                 22840000
192100                                                                  22850000
192200         WHEN SQLCODE = +100                                      22860000
192300             MOVE ZEROS                 TO HL12-TRD-PCT           22870000
192400         WHEN SQLWARN NOT = SPACES                                22880000
192500         WHEN SQLCODE NOT = +000                                  22890000
192600             MOVE '2116-TRD-DISCOUNT'     TO PV-ABEND-PARAGRAPH   22900000
192700                                                                  22910000
192800             PERFORM 9000-SQL-ABEND                               22920000
192900                                                                  22930000
193000     END-EVALUATE.                                                22940000
193100 EJECT                                                            22950000
193200 2117-ADV-DISCOUNT.                                               22960000
193300******************************************************************22970000
193400*  SELECT THE ADVERTISING DISCOUNT DATA                           22980000
193500******************************************************************22990000
193600*    DISPLAY '2117-ADV-DISCOUNT'.                                 23000000
193700                                                                  23010000
193800     EXEC SQL                                                     23020000
193900         SELECT DISC_PCT                                          23030000
194000         INTO :POAGMT-DISC-PCT                                    23040000
194100         FROM TPOAGMT                                             23050000
194200         WHERE PO_NBR         = :IR-PO-NBR2        AND            23060000
194300               AGRMT_TYP_ID   = '5'                AND            23070000
194400               TYP_CDE        = 9                  AND            23080000
194500               VER_STATUS_CDE = 'A'                               23090000
194600     END-EXEC.                                                    23100000
194700                                                                  23110000
194800     EVALUATE TRUE                                                23120000
194900                                                                  23130000
195000         WHEN SQLCODE = +000                                      23140000
195100           IF POAGMT-DISC-PCT > 0                                 23150000
195200             COMPUTE PV-PCT-HOLD = POAGMT-DISC-PCT * 100          23160000
195300             MOVE PV-PCT-HOLD           TO HL13-ADV-PCT           23170000
195400           ELSE                                                   23180000
195500             MOVE ZEROS                 TO HL13-ADV-PCT           23190000
195600           END-IF                                                 23200000
195700                                                                  23210000
195800         WHEN SQLCODE = +100                                      23220000
195900             MOVE ZEROS                 TO HL13-ADV-PCT           23230000
196000         WHEN SQLWARN NOT = SPACES                                23240000
196100         WHEN SQLCODE NOT = +000                                  23250000
196200             MOVE '2117-ADV-DISCOUNT'     TO PV-ABEND-PARAGRAPH   23260000
196300                                                                  23270000
196400             PERFORM 9000-SQL-ABEND                               23280000
196500                                                                  23290000
196600     END-EVALUATE.                                                23300000
196700******************************************************************23310000
196800*  RETRIEVE THE COUNTRY AND PROVINCE FROM THE PEOPLESOFT TABLES   23320000
196900******************************************************************23330000
197000 2150-RETRIEVE-PROV-COUNTRY.                                      23340000
197100                                                                  23350000
197200     MOVE BUSLOC-ST-PROV-CDE     TO DP410-STATE-CODE.             23360000
197300     MOVE BUSLOC-CNTRY-CDE       TO DP410-COUNTRY-CODE.           23370000
197400                                                                  23380000
197500     CALL PC-DPKUT410 USING DP410-ST-PROV-CNTRY-ROUTINE.          23390000
197600                                                                  23400000
197700     EVALUATE TRUE                                                23410000
197800                                                                  23420000
197900         WHEN  DP410-DB2-ERROR                                    23430000
198000             DISPLAY 'STATE/PROV = ' DP410-STATE-CODE             23440000
198100             DISPLAY 'COUNTRY = ' DP410-COUNTRY-CODE              23450000
198200             MOVE '2150-RETRIEVE-PROV-COUNTRY'                    23460000
198300                                   TO PV-ABEND-PARAGRAPH          23470000
198400             PERFORM 9000-SQL-ABEND                               23480000
198500                                                                  23490000
198600         WHEN  DP410-DEADLOCK-BYPASS-ROUTINE                      23500000
198700             MOVE DP410-STATE-CODE TO PV-STATE-PROV               23510000
198800             MOVE DP410-COUNTRY-CODE TO PV-COUNTRY                23520000
198900                                                                  23530000
199000         WHEN  OTHER                                              23540000
199100             MOVE DP410-STATE-NAME TO PV-STATE-PROV               23550000
199200             MOVE DP410-COUNTRY-NAME TO PV-COUNTRY                23560000
199300     END-EVALUATE.                                                23570000
199400******************************************************************23580000
199500*  COUNTS TALLPLANS                                               23590000
199600******************************************************************23600000
199700 2196-COUNT-TALLPLNS.                                             23610000
199800                                                                  23620000
199900     INITIALIZE PV-DB2-COUNT.                                     23630000
200000     EXEC SQL                                                     23640000
200100          SELECT COUNT(DISTINCT(DEST_NBR))                        23650000
200200          INTO :PV-DB2-COUNT                                      23660000
200300          FROM TALLPLN                                            23670000
200400          WHERE PO_NBR = :IR-PO-NBR2                              23680000
200500     END-EXEC.                                                    23690000
200600                                                                  23700000
200700     EVALUATE TRUE                                                23710000
200800         WHEN SQLCODE = +0                                        23720000
200900         WHEN SQLCODE = +100                                      23730000
201000              CONTINUE                                            23740000
201100                                                                  23750000
201200         WHEN SQLWARN0 NOT = SPACES                               23760000
201300         WHEN SQLCODE < +0                                        23770000
201400         WHEN SQLCODE > +0                                        23780000
201500             MOVE '2196-COUNT-TALLPLN'                            23790000
201600                                   TO PV-ABEND-PARAGRAPH          23800000
201700             PERFORM 9000-SQL-ABEND                               23810000
201800     END-EVALUATE.                                                23820000
201900                                                                  23830000
202000******************************************************************23840000
202100*  GET DEST NUMBER                                                23850000
202200******************************************************************23860000
202300 2197-GET-SHIP-DEST.                                              23870000
202400                                                                  23880000
202500     INITIALIZE PV-DB2-COUNT.                                     23890000
202600     EXEC SQL                                                     23900000
202700          SELECT DISTINCT(DEST_NBR)                               23910000
202800          INTO :ALLPLN-DEST-NBR                                   23920000
202900          FROM TALLPLN                                            23930000
203000          WHERE PO_NBR = :IR-PO-NBR2                              23940000
203100     END-EXEC.                                                    23950000
203200                                                                  23960000
203300     EVALUATE TRUE                                                23970000
203400         WHEN SQLCODE = +0                                        23980000
203500              CONTINUE                                            23990000
203600                                                                  24000000
203700         WHEN SQLWARN0 NOT = SPACES                               24010000
203800         WHEN SQLCODE < +0                                        24020000
203900         WHEN SQLCODE > +0                                        24030000
204000             MOVE '2197-GET-SHIP-DEST'                            24040000
204100                                   TO PV-ABEND-PARAGRAPH          24050000
204200             PERFORM 9000-SQL-ABEND                               24060000
204300     END-EVALUATE.                                                24070000
204400                                                                  24080000
204500******************************************************************24090000
204600*  GETS TPAYTRM DATA                                              24100000
204700******************************************************************24110000
204800 2198-GET-TPAYTRM.                                                24120000
204900                                                                  24130000
205000     EXEC SQL                                                     24140000
205100         SELECT DISCOUNT_DAYS_QTY,                                24150000
205200                DISCOUNT_PCT,                                     24160000
205300                DUE_DAY_QTY,                                      24170000
205400                DUE_DAY_FR_DTE_TXT,                               24180000
205500                OTHER_TXT                                         24190000
205600         INTO  :PAYTRM-DISCOUNT-DAYS-QTY,                         24200000
205700               :PAYTRM-DISCOUNT-PCT,                              24210000
205800               :PAYTRM-DUE-DAY-QTY,                               24220000
205900               :PAYTRM-DUE-DAY-FR-DTE-TXT,                        24230000
206000               :PAYTRM-OTHER-TXT                                  24240000
206100         FROM TPAYTRM                                             24250000
206200         WHERE PAY_TERM_ID = :POAGMT-PAYT-TERM-ID                 24260000
206300     END-EXEC.                                                    24270000
206400                                                                  24280000
206500     EVALUATE TRUE                                                24290000
206600         WHEN SQLCODE = +0                                        24300000
206700         WHEN SQLCODE = +100                                      24310000
206800             CONTINUE                                             24320000
206900         WHEN SQLWARN NOT = SPACE                                 24330000
207000         WHEN SQLCODE NOT = +0                                    24340000
207100             MOVE '2198-GET-TPAYTRM'                              24350000
207200                                   TO PV-ABEND-PARAGRAPH          24360000
207300             PERFORM 9000-SQL-ABEND                               24370000
207400     END-EVALUATE.                                                24380000
207500                                                                  24390000
207600******************************************************************24400000
207700*  FORMATS PAYMENT TERM                                           24410000
207800******************************************************************24420000
207900 2199-FORMAT-PAYMENT-TERM.                                        24430000
208000                                                                  24440000
208100     MOVE POAGMT-PAYT-TERM-ID      TO PV-EDIT-PAYT-TERM-ID.       24450000
208200     COPY POPD001.                                                24460000
208300     MOVE ASC-PAYT-TERM-ID-DESC TO HL8-PAY-TERM.                  24470000
208400                                                                  24480000
208500******************************************************************24490000
208600*  CONTROLS INSTRUCTION PROCESSING                                24500000
208700******************************************************************24510000
208800 2200-PROCESS-INSTRUCTION.                                        24520000
208900                                                                  24530000
209000     WRITE PORPT-RECORD FROM INSTR-HEADER                         24540000
209100         AFTER 2 LINES.                                           24550000
209200     ADD +2                        TO PV-LINE-CNT.                24560000
209300                                                                  24570000
209400                                                                  24580000
209500     IF HL1-ORD-DATE = SPACES                                     24590000
209600         WRITE PORPT-RECORD FROM NOT-APPROVED-LINE                24600000
209700             AFTER 2 LINE                                         24610000
209800         ADD +2                    TO PV-LINE-CNT                 24620000
209900     END-IF.                                                      24630000
210000                                                                  24640000
210100     IF PURCHS-STATUS-CDE = 'CA'                                  24650000
210200         WRITE PORPT-RECORD FROM CANCELLED-LINE                   24660000
210300             AFTER 2 LINE                                         24670000
210400         ADD +2                    TO PV-LINE-CNT                 24680000
210500     END-IF.                                                      24690000
210600                                                                  24700000
210700     IF PURCHS-REVISION-CT > 0                                    24710000
210800         WRITE PORPT-RECORD FROM REVISED-LINE                     24720000
210900             AFTER 2 LINE                                         24730000
211000         ADD +2                    TO PV-LINE-CNT                 24740000
211100     END-IF.                                                      24750000
211200                                                                  24760000
211300     IF PS-VENDOR-RPT-TYPE                                        24770000
211400         MOVE 'VN'                 TO POINST-RECIP-CDE            24780000
211500                                      PV-RECIP-CDE-HOLD           24790000
211600     ELSE                                                         24800000
211700         IF PS-BUYER-RPT-TYPE OR PS-ANALYST-RPT-TYPE              24810000
211800             MOVE '%%'             TO POINST-RECIP-CDE            24820000
211900             MOVE '  '             TO PV-RECIP-CDE-HOLD           24830000
212000         ELSE                                                     24840000
212100             MOVE 'DC'             TO POINST-RECIP-CDE            24850000
212200                                      PV-RECIP-CDE-HOLD           24860000
212300         END-IF                                                   24870000
212400     END-IF.                                                      24880000
212500                                                                  24890000
212600     SET PS-NOT-EOF-INST-CSR       TO TRUE.                       24900000
212700     PERFORM 2210-OPEN-INST-CSR.                                  24910000
212800     PERFORM 2220-PROCESS-INST-CSR                                24920000
212900         UNTIL PS-EOF-INST-CSR.                                   24930000
213000     PERFORM 2230-CLOSE-INST-CSR.                                 24940000
213100                                                                  24950000
213200******************************************************************24960000
213300*  OPENS INSTRUCTION CODE CSR                                     24970000
213400******************************************************************24980000
213500 2210-OPEN-INST-CSR.                                              24990000
213600                                                                  25000000
213700     EXEC SQL                                                     25010000
213800         OPEN INST-CSR                                            25020000
213900     END-EXEC.                                                    25030000
214000                                                                  25040000
214100     EVALUATE TRUE                                                25050000
214200         WHEN SQLCODE = +0                                        25060000
214300             CONTINUE                                             25070000
214400         WHEN SQLWARN NOT = SPACE                                 25080000
214500         WHEN SQLCODE NOT = +0                                    25090000
214600             MOVE '2210-OPEN-INST-CSR'                            25100000
214700                                   TO PV-ABEND-PARAGRAPH          25110000
214800             PERFORM 9000-SQL-ABEND                               25120000
214900     END-EVALUATE.                                                25130000
215000                                                                  25140000
215100******************************************************************25150000
215200*  FETCHS INSTRUCTION CSR AND PRINTS                              25160000
215300******************************************************************25170000
215400 2220-PROCESS-INST-CSR.                                           25180000
215500                                                                  25190000
215600     EXEC SQL                                                     25200000
215700         FETCH INST-CSR                                           25210000
215800         INTO  :INSTCD-INSTR-DESC,                                25220000
215900               :INSTCD-INSTR-NBR,                                 25230000
216000               :INRCCD-RECIP-CDE,                                 25240000
216100               :INRCCD-RECIP-DESC                                 25250000
216200     END-EXEC.                                                    25260000
216300                                                                  25270000
216400     EVALUATE TRUE                                                25280000
216500         WHEN SQLCODE = +0                                        25290000
216600         WHEN SQLCODE = +100                                      25300000
216700             CONTINUE                                             25310000
216800         WHEN SQLWARN NOT = SPACE                                 25320000
216900         WHEN SQLCODE NOT = +0                                    25330000
217000             MOVE '2220-PROCESS-INST-CSR'                         25340000
217100                                   TO PV-ABEND-PARAGRAPH          25350000
217200             PERFORM 9000-SQL-ABEND                               25360000
217300     END-EVALUATE.                                                25370000
217400                                                                  25380000
217500     IF SQLCODE = +100                                            25390000
217600         SET PS-EOF-INST-CSR       TO TRUE                        25400000
217700     ELSE                                                         25410000
217800         IF PV-LINE-CNT > +58                                     25420000
217900             ADD +1                TO PV-PAGE-CNT                 25430000
218000             MOVE PV-PAGE-CNT      TO HL2-PAGE                    25440000
218100             MOVE +0               TO PV-LINE-CNT                 25450000
218200                                                                  25460000
218300             WRITE PORPT-RECORD FROM HEADER-LINE1                 25470000
218400                 AFTER ADVANCING PAGE                             25480000
218500             WRITE PORPT-RECORD FROM HEADER-LINE2                 25490000
218600                 AFTER 1 LINES                                    25500000
218700             WRITE PORPT-RECORD FROM HEADER-LINE3                 25510000
218800                 AFTER 1 LINES                                    25520000
218900             WRITE PORPT-RECORD FROM INSTR-HEADER                 25530000
219000                 AFTER 2 LINES                                    25540000
219100             MOVE +5               TO PV-LINE-CNT                 25550000
219200         END-IF                                                   25560000
219300                                                                  25570000
219400         IF INRCCD-RECIP-CDE = PV-RECIP-CDE-HOLD                  25580000
219500             CONTINUE                                             25590000
219600         ELSE                                                     25600000
219700             MOVE INRCCD-RECIP-DESC                               25610000
219800                                   TO INSTR-RECIP                 25620000
219900             WRITE PORPT-RECORD FROM INSTR-RECIP-LINE             25630000
220000                 AFTER 1 LINES                                    25640000
220100             MOVE INRCCD-RECIP-CDE TO PV-RECIP-CDE-HOLD           25650000
220200             ADD +1                TO PV-LINE-CNT                 25660000
220300         END-IF                                                   25670000
220400                                                                  25680000
220500         MOVE INSTCD-INSTR-DESC    TO INSTR-DESC                  25690000
220600         WRITE PORPT-RECORD FROM INSTR-LINE                       25700000
220700             AFTER 1 LINES                                        25710000
220800         ADD +1                    TO PV-LINE-CNT                 25720000
220900     END-IF.                                                      25730000
221000                                                                  25740000
221100******************************************************************25750000
221200*  CLOSES INSTRUCTION CODE CSR                                    25760000
221300******************************************************************25770000
221400 2230-CLOSE-INST-CSR.                                             25780000
221500                                                                  25790000
221600     EXEC SQL                                                     25800000
221700         CLOSE INST-CSR                                           25810000
221800     END-EXEC.                                                    25820000
221900                                                                  25830000
222000     EVALUATE TRUE                                                25840000
222100         WHEN SQLCODE = +0                                        25850000
222200             CONTINUE                                             25860000
222300         WHEN SQLWARN NOT = SPACE                                 25870000
222400         WHEN SQLCODE NOT = +0                                    25880000
222500             MOVE '2230-CLOSE-INST-CSR'                           25890000
222600                                   TO PV-ABEND-PARAGRAPH          25900000
222700             PERFORM 9000-SQL-ABEND                               25910000
222800     END-EVALUATE.                                                25920000
222900                                                                  25930000
223000******************************************************************25940000
223100*  2300-PROCESS-PACKS:  CONTROLS PACK PROCESSING                  25950000
223200******************************************************************25960000
223300 2300-PROCESS-PACKS.                                              25970000
223500     SET PS-NOT-EOF-PO-PACK-CSR    TO TRUE.                       25980000
223600     PERFORM 2310-OPEN-PO-PACK-CSR.                               25990000
223700     PERFORM 2350-PROCESS-PO-PACK-CSR                             26000000
223800         UNTIL PS-EOF-PO-PACK-CSR.                                26010000
223900     PERFORM 2390-CLOSE-PO-PACK-CSR.                              26020000
224000                                                                  26030000
224100******************************************************************26040000
224200*  OPENS APPROPRIATE CURSOR BASED ON STATUS CODE                  26050000
224300******************************************************************26060000
224400 2310-OPEN-PO-PACK-CSR.                                           26070000
W24803     MOVE IR-PO-NBR2 TO POPRPK-PO-NBR                             26080000
224600     PERFORM WITH TEST AFTER                                      26090000
224700        VARYING PV-RETRY-COUNTER FROM 1 BY 1                      26100000
224800        UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES OR              26110000
224900                SQLCODE = ZERO                                    26120000
225000        IF PURCHS-STATUS-CDE = 'FE' OR 'PA' OR 'RJ'               26130000
225100                            OR 'RS' OR 'WK'                       26140000
225200            EXEC SQL                                              26150000
225300                OPEN PRE-PACK-CSR                                 26160000
225400            END-EXEC                                              26170000
225500        ELSE                                                      26180000
225600            EXEC SQL                                              26190000
225700                OPEN APP-PACK-CSR                                 26200000
225800            END-EXEC                                              26210000
225900        END-IF                                                    26220000
226000                                                                  26230000
226100        EVALUATE TRUE                                             26240000
226200            WHEN SQLCODE = +0                                     26250000
226300            WHEN SQLCODE = -904                                   26260000
226400            WHEN SQLCODE = -911                                   26270000
226500            WHEN SQLCODE = -913                                   26280000
226600                CONTINUE                                          26290000
226700            WHEN SQLWARN NOT = SPACE                              26300000
226800            WHEN SQLCODE NOT = +0                                 26310000
226900                MOVE '2310-OPEN-PO-PACK-CSR'                      26320000
227000                                      TO PV-ABEND-PARAGRAPH       26330000
227100                PERFORM 9000-SQL-ABEND                            26340000
227200        END-EVALUATE                                              26350000
227300     END-PERFORM.                                                 26360000
227400                                                                  26370000
227500     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         26380000
227600         MOVE '2310-OPEN-PO-PACK-CSR' TO PV-ABEND-PARAGRAPH       26390000
227700         PERFORM 9000-SQL-ABEND                                   26400000
227800     END-IF.                                                      26410000
227900                                                                  26420000
228000******************************************************************26430000
228100*  FETCHS PO PACK CSR                                             26440000
228200******************************************************************26450000
228300 2350-PROCESS-PO-PACK-CSR.                                        26460000
W24803     INITIALIZE  PV-NULL-INDICATOR-VARIABLES.                     26470000
W24803                                                                  26480000
228500     PERFORM WITH TEST AFTER                                      26490000
228600        VARYING PV-RETRY-COUNTER FROM 1 BY 1                      26500000
228700        UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES OR              26510000
228800                SQLCODE = ZERO OR SQLCODE = +100                  26520000
228900        IF PURCHS-STATUS-CDE = 'FE' OR 'PA' OR 'RJ'               26530000
229000                            OR 'RS' OR 'WK'                       26540000
229100            EXEC SQL                                              26550000
229200                FETCH PRE-PACK-CSR                                26560000
229300                INTO :POPRPK-PO-PREPK-ID,                         26570000
229400                      :POPRPK-OTPK-UNT-QTY,                       26580000
229500                      :POPRPK-OTPK-ORD-QTY,                       26590000
229600                      :POPRPK-INPK-UNT-QTY,                       26600000
229601* TKMA888 * ADDED 3 LINES ****************************************26610000
229610                      :POPRPK-PK-SKU-NBR,                         26620000
229620                      :POPRPK-PREPK-UPC-NBR,                      26630000
229621                      :PURITM-PRD-1ST-COST-AMT,                   26640000
229630* TKMA888 *------------------------------------------------------*26650000
      * TKMA537 * ADDED 1 LINE *****************************************26660032
                            :POPRPK-PREPK-TYP-CDE,                      26670032
      * TKMA537 *------------------------------------------------------*26680032
229700                      :POPRPK-PREPK-DESC,                         26690000
229800                      :PURITM-SKU-SEQ-NBR,                        26700000
229900                      :PURITM-CL-NBR,                             26710000
230000                      :PURITM-VEND-STYL-NAME,                     26720000
230100                      :PURITM-SKU-DESC,                           26730000
W24803                      :XLT00004-MAJ-CL-NBR:PV-MAJ-CL-NBR-IND,     26740000
W24803                      :XLT00004-SUB-CL-NBR:PV-SUB-CL-NBR-IND,     26750000
W24803                      :XLT00003-SKU-NBR:PV-SKU-NBR-IND,           26760000
W24803                      :XLT00004-VS-NBR:PV-VS-NBR-IND,             26770000
W24803                      :XLT00003-SKU-DESC:PV-SKU-DESC-IND,         26780000
230200                      :PURITM-UNT-QTY,                            26790000
230300                      :PURITM-UNT-COST-AMT,                       26800000
230400                      :PURITM-TOT-VAL-COST-AMT,                   26810000
230500                      :PURITM-COLOR-DESC,                         26820000
230600                      :PURITM-SIZE-DESC,                          26830000
W24803                :XLT00003-CSTM-CLOR-DESC:PV-CSTM-CLOR-DESC-IND,   26840000
W24803                      :XLT00003-SIZE-DESC:PV-SIZE-DESC-IND,       26850000
230700                      :PURITM-AD-EVNT-DTE,                        26860000
230800                      :PURITM-UNT-RTL-PR-AMT,                     26870000
230900                      :PURITM-TOT-VAL-RTL-AMT,                    26880000
231000                      :PURITM-PO-LNE-NBR,                         26890000
231100                      :PURITM-STATUS-CDE,                         26900000
231200                      :PURITM-ITM-NBR,                            26910000
231300                      :PURITM-PREPK-RATO-QTY                      26920000
231400            END-EXEC                                              26930000
231500        ELSE                                                      26940000
231600            EXEC SQL                                              26950000
231700                FETCH APP-PACK-CSR                                26960000
231800                INTO :POPRPK-PO-PREPK-ID,                         26970000
231900                      :POPRPK-OTPK-UNT-QTY,                       26980000
232000                      :POPRPK-OTPK-ORD-QTY,                       26990000
232100                      :POPRPK-INPK-UNT-QTY,                       27000000
232110* TKMA888 * ADDED 3 LINES ****************************************27010000
232120                      :POPRPK-PK-SKU-NBR,                         27020000
232130                      :POPRPK-PREPK-UPC-NBR,                      27030000
232140                      :PURITM-PRD-1ST-COST-AMT,                   27040000
232150* TKMA888 *------------------------------------------------------*27050000
232110* TKMA537 * ADDED 1 LINE  ****************************************27060032
232120                      :POPRPK-PREPK-TYP-CDE,                      27070032
232150* TKMA537 *------------------------------------------------------*27080032
232200                      :POPRPK-PREPK-DESC,                         27090000
232300                      :PURITM-SKU-SEQ-NBR,                        27100000
232400                      :PURITM-CL-NBR,                             27110000
232500                      :PURITM-VEND-STYL-NAME,                     27120000
232600                      :PURITM-SKU-DESC,                           27130000
W24803                      :XLT00004-MAJ-CL-NBR:PV-MAJ-CL-NBR-IND,     27140000
W24803                      :XLT00004-SUB-CL-NBR:PV-SUB-CL-NBR-IND,     27150000
W24803                      :XLT00003-SKU-NBR:PV-SKU-NBR-IND,           27160000
W24803                      :XLT00004-VS-NBR:PV-VS-NBR-IND,             27170000
W24803                      :XLT00003-SKU-DESC:PV-SKU-DESC-IND,         27180000
232700                      :PURITM-UNT-QTY,                            27190000
232800                      :PURITM-UNT-COST-AMT,                       27200000
232900                      :PURITM-TOT-VAL-COST-AMT,                   27210000
233000                      :PURITM-COLOR-DESC,                         27220000
233100                      :PURITM-SIZE-DESC,                          27230000
W24803                   :XLT00003-CSTM-CLOR-DESC:PV-CSTM-CLOR-DESC-IND,27240000
W24803                      :XLT00003-SIZE-DESC:PV-SIZE-DESC-IND,       27250000
233200                      :PURITM-AD-EVNT-DTE,                        27260000
233300                      :PURITM-UNT-RTL-PR-AMT,                     27270000
233400                      :PURITM-TOT-VAL-RTL-AMT,                    27280000
233500                      :PURITM-APP-PO-LNE-NBR,                     27290000
233600                      :PURITM-STATUS-CDE,                         27300000
233700                      :PURITM-ITM-NBR,                            27310000
233800                      :PURITM-PREPK-RATO-QTY                      27320000
233900            END-EXEC                                              27330000
234000        END-IF                                                    27340000
234100                                                                  27350000
234200        EVALUATE TRUE                                             27360000
234300            WHEN SQLCODE = +0                                     27370000
234400        IF PURCHS-STATUS-CDE = 'FE' OR 'PA' OR 'RJ'               27380000
234500                            OR 'RS' OR 'WK'                       27390000
234600            MOVE PURITM-PO-LNE-NBR TO PV-PO-LNE-NBR               27400000
234700        ELSE                                                      27410000
234800            MOVE PURITM-APP-PO-LNE-NBR TO PV-PO-LNE-NBR           27420000
234900        END-IF                                                    27430000
235000            WHEN SQLCODE = +100                                   27440000
235100                CONTINUE                                          27450000
235200            WHEN SQLCODE = -904                                   27460000
235300            WHEN SQLCODE = -911                                   27470000
235400            WHEN SQLCODE = -913                                   27480000
235500                CONTINUE                                          27490000
235600            WHEN SQLWARN NOT = SPACE                              27500000
235700            WHEN SQLCODE NOT = +0                                 27510000
235800                MOVE '2350-PROCESS-PO-PACK-CSR'                   27520000
235900                                      TO PV-ABEND-PARAGRAPH       27530000
236000                PERFORM 9000-SQL-ABEND                            27540000
236100        END-EVALUATE                                              27550000
236200     END-PERFORM.                                                 27560000
236300                                                                  27570000
236400     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         27580000
236500         MOVE '2350-PROCESS-PO-PACK-CSR' TO PV-ABEND-PARAGRAPH    27590000
236600         PERFORM 9000-SQL-ABEND                                   27600000
236700     END-IF.                                                      27610000
236800                                                                  27620000
236900     IF SQLCODE = +100                                            27630000
237000         SET PS-EOF-PO-PACK-CSR    TO TRUE                        27640000
237100     ELSE                                                         27650000
237200         MOVE +0                   TO PV-ALLOC-CNT                27660000
237300                                                                  27670000
237400         IF PS-ANALYST-RPT-TYPE                                   27680000
237500            PERFORM 2475-COUNT-ALLOCATIONS                        27690000
237600         END-IF                                                   27700000
237700                                                                  27710000
237800         IF (PV-PACK-ID-NUM NOT = POPRPK-PO-PREPK-ID)             27720000
237900            AND (PV-PACK-ID-NUM NOT = 0)                          27730000
238000            MOVE SPACES TO PORPT-RECORD                           27740000
238100            WRITE PORPT-RECORD AFTER 1 LINES                      27750000
238200            WRITE PORPT-RECORD FROM ASTERISK-LINE                 27760000
238300                  AFTER 1 LINES                                   27770000
238400            MOVE SPACES TO PORPT-RECORD                           27780000
238500            WRITE PORPT-RECORD AFTER 1 LINES                      27790000
238600            ADD +3 TO PV-LINE-CNT                                 27800000
238700         END-IF                                                   27810000
238800                                                                  27820000
238900         IF (PV-PACK-ID-NUM = 0)                                  27830000
239000            OR (PV-PACK-ID-NUM NOT = POPRPK-PO-PREPK-ID)          27840000
239100            PERFORM 4000-SUM-PACK-QTY                             27850000
239200            PERFORM 5000-FILL-PACK-LINE-TOTAL                     27860000
239300         END-IF                                                   27870000
239400                                                                  27880000
239500         PERFORM 3000-PROCESS-PACK-LINES                          27890000
239600                                                                  27900000
239700     END-IF.                                                      27910000
239800                                                                  27920000
239900******************************************************************27930000
240000*  CLOSES PO PACK CSR                                             27940000
240100******************************************************************27950000
240200 2390-CLOSE-PO-PACK-CSR.                                          27960000
240300                                                                  27970000
240400     PERFORM WITH TEST AFTER                                      27980000
240500        VARYING PV-RETRY-COUNTER FROM 1 BY 1                      27990000
240600        UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES OR              28000000
240700                SQLCODE = ZERO                                    28010000
240800        IF PURCHS-STATUS-CDE = 'FE' OR 'PA' OR 'RJ'               28020000
240900                            OR 'RS' OR 'WK'                       28030000
241000            EXEC SQL                                              28040000
241100                CLOSE PRE-PACK-CSR                                28050000
241200            END-EXEC                                              28060000
241300        ELSE                                                      28070000
241400            EXEC SQL                                              28080000
241500                CLOSE APP-PACK-CSR                                28090000
241600            END-EXEC                                              28100000
241700        END-IF                                                    28110000
241800                                                                  28120000
241900        EVALUATE TRUE                                             28130000
242000            WHEN SQLCODE = +0                                     28140000
242100                CONTINUE                                          28150000
242200            WHEN SQLCODE = -904                                   28160000
242300            WHEN SQLCODE = -911                                   28170000
242400            WHEN SQLCODE = -913                                   28180000
242500                CONTINUE                                          28190000
242600            WHEN SQLWARN NOT = SPACE                              28200000
242700            WHEN SQLCODE NOT = +0                                 28210000
242800                MOVE '2390-CLOSE-PO-PACK-CSR'                     28220000
242900                                      TO PV-ABEND-PARAGRAPH       28230000
243000                PERFORM 9000-SQL-ABEND                            28240000
243100        END-EVALUATE                                              28250000
243200     END-PERFORM.                                                 28260000
243300                                                                  28270000
243400     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         28280000
243500         MOVE '2390-CLOSE-PO-PACK-CSR' TO PV-ABEND-PARAGRAPH      28290000
243600         PERFORM 9000-SQL-ABEND                                   28300000
243700     END-IF.                                                      28310000
243800******************************************************************28320000
243900*  OPENS ALLOCATION CSR                                           28330000
244000******************************************************************28340000
244100 2400-OPEN-ALLOC-CSR.                                             28350000
244200                                                                  28360000
244300     EXEC SQL                                                     28370000
244400         OPEN ALLOC-CSR                                           28380000
244500     END-EXEC.                                                    28390000
244600                                                                  28400000
244700     EVALUATE TRUE                                                28410000
244800         WHEN SQLCODE = +0                                        28420000
244900             CONTINUE                                             28430000
245000         WHEN SQLWARN NOT = SPACE                                 28440000
245100         WHEN SQLCODE NOT = +0                                    28450000
245200             MOVE '2400-OPEN-ALLOC-CSR'                           28460000
245300                                   TO PV-ABEND-PARAGRAPH          28470000
245400             PERFORM 9000-SQL-ABEND                               28480000
245500     END-EVALUATE.                                                28490000
245600                                                                  28500000
245700******************************************************************28510000
245800*  FETCHS ALLOCATION CSR AND WRITES ALLOCATION LINES              28520000
245900******************************************************************28530000
246000 2410-PROCESS-ALLOC-CSR.                                          28540000
246100                                                                  28550000
246200     EXEC SQL                                                     28560000
246300         FETCH ALLOC-CSR                                          28570000
246400         INTO  :MESTDS-STR-NBR,                                   28580000
246500               :MESTDS-STR-DISTRO-QTY,                            28590000
246600               :XMT00001-LOC-5-ABBR-NM                            28600000
246700     END-EXEC.                                                    28610000
246800                                                                  28620000
246900     EVALUATE TRUE                                                28630000
247000         WHEN SQLCODE = +0                                        28640000
247100         WHEN SQLCODE = +100                                      28650000
247200             CONTINUE                                             28660000
247300         WHEN SQLWARN NOT = SPACE                                 28670000
247400         WHEN SQLCODE NOT = +0                                    28680000
247500             MOVE '2410-PROCESS-ALLOC-CSR'                        28690000
247600                                   TO PV-ABEND-PARAGRAPH          28700000
247700             PERFORM 9000-SQL-ABEND                               28710000
247800     END-EVALUATE.                                                28720000
247900                                                                  28730000
248000     IF SQLCODE = +100                                            28740000
248100         SET PS-EOF-ALLOC-CSR      TO TRUE                        28750000
248200         WRITE PORPT-RECORD FROM DISTR-LINE                       28760000
248300             AFTER 1 LINES                                        28770000
248400         ADD +1                    TO PV-LINE-CNT                 28780000
248500     ELSE                                                         28790000
248600         IF PV-SUB = +7                                           28800000
248700             WRITE PORPT-RECORD FROM DISTR-LINE                   28810000
248800                 AFTER 1 LINES                                    28820000
248900             ADD +1                TO PV-LINE-CNT                 28830000
249000             MOVE +0               TO PV-SUB                      28840000
249100             INITIALIZE DISTR-LINE                                28850000
249200         END-IF                                                   28860000
249300         ADD +1                    TO PV-SUB                      28870000
249400         MOVE MESTDS-STR-NBR       TO DL-STR-NBR (PV-SUB)         28880000
249500         MOVE XMT00001-LOC-5-ABBR-NM                              28890000
249600                                   TO DL-STR-NAME (PV-SUB)        28900000
249700         MOVE MESTDS-STR-DISTRO-QTY                               28910000
249800                                   TO DL-QTY (PV-SUB)             28920000
249900     END-IF.                                                      28930000
250000                                                                  28940000
250100                                                                  28950000
250200******************************************************************28960000
250300*  CLOSES ALLOCATION                                              28970000
250400******************************************************************28980000
250500 2450-CLOSE-ALLOC-CSR.                                            28990000
250600                                                                  29000000
250700     EXEC SQL                                                     29010000
250800         CLOSE ALLOC-CSR                                          29020000
250900     END-EXEC.                                                    29030000
251000                                                                  29040000
251100     EVALUATE TRUE                                                29050000
251200         WHEN SQLCODE = +0                                        29060000
251300             CONTINUE                                             29070000
251400         WHEN SQLWARN NOT = SPACE                                 29080000
251500         WHEN SQLCODE NOT = +0                                    29090000
251600             MOVE '2450-CLOSE-ALLOC-CSR'                          29100000
251700                                   TO PV-ABEND-PARAGRAPH          29110000
251800             PERFORM 9000-SQL-ABEND                               29120000
251900     END-EVALUATE.                                                29130000
252000                                                                  29140000
252100 2475-COUNT-ALLOCATIONS.                                          29150000
252200                                                                  29160000
252300     EXEC SQL                                                     29170000
252400         SELECT COUNT(*)                                          29180000
252500         INTO :PV-ALLOC-CNT                                       29190000
252600         FROM TMESTDS A,                                          29200000
252700              XMT_LOC B                                           29210000
252800         WHERE A.PO_NBR = :IR-PO-NBR2                             29220000
252900           AND A.PO_LNE_NBR = :PV-PO-LNE-NBR                      29230000
253000           AND B.LOC_NBR    = A.STR_NBR                           29240000
253100           AND B.LOC_TYP_CDE IN ( 'CS', 'DS', 'RV')               29250000
253200     END-EXEC.                                                    29260000
253300                                                                  29270000
253400     EVALUATE TRUE                                                29280000
253500         WHEN SQLCODE = +0                                        29290000
253600             CONTINUE                                             29300000
253700         WHEN SQLWARN NOT = SPACE                                 29310000
253800         WHEN SQLCODE NOT = +0                                    29320000
253900             MOVE '2475-COUNT-ALLOCATIONS'                        29330000
254000                                   TO PV-ABEND-PARAGRAPH          29340000
254100             PERFORM 9000-SQL-ABEND                               29350000
254200     END-EVALUATE.                                                29360000
254300                                                                  29370000
254400     IF PV-ALLOC-CNT = +0                                         29380000
254500         CONTINUE                                                 29390000
254600     ELSE                                                         29400000
254700         EXEC SQL                                                 29410000
254800             SELECT COUNT(*)                                      29420000
254900             INTO :PV-ALLOC-CNT                                   29430000
255000             FROM TMESTDS                                         29440000
255100             WHERE PO_NBR = :IR-PO-NBR2                           29450000
255200               AND PO_LNE_NBR = :PV-PO-LNE-NBR                    29460000
                     AND STR_DISTRO_QTY > 0                             29470000
255300         END-EXEC                                                 29480000
255400                                                                  29490000
255500         EVALUATE TRUE                                            29500000
255600             WHEN SQLCODE = +0                                    29510000
255700                 CONTINUE                                         29520000
255800             WHEN SQLWARN NOT = SPACE                             29530000
255900             WHEN SQLCODE NOT = +0                                29540000
256000                 MOVE '2475-COUNT-ALLOCATIONS'                    29550000
256100                                   TO PV-ABEND-PARAGRAPH          29560000
256200                 PERFORM 9000-SQL-ABEND                           29570000
256300         END-EVALUATE                                             29580000
256400     END-IF.                                                      29590000
256500                                                                  29600000
256600                                                                  29610000
256700******************************************************************29620000
256800*  FILL DISTRIBUTION HEADER LINE 2 WITH HEADINGS BASED ON         29630000
256900*  NUMBER OF ALLOCATIONS PRESENT                                  29640000
257000******************************************************************29650000
257100 2490-FILL-DIST-HEAD2.                                            29660000
257200                                                                  29670000
257300     MOVE PC-STORE-QTY             TO DH2-COL-HDR (PV-SUB).       29680000
257400                                                                  29690000
257500 2500-PROCESS-LINES-NOT-IN-PKS.                                   29700000
257600     SET PS-NOT-EOF-PO-LINE-CSR    TO TRUE.                       29710000
257700     PERFORM 2510-OPEN-PO-LINE-CSR.                               29720000
257800     PERFORM 2550-PROCESS-PO-LINE-CSR                             29730000
257900         UNTIL PS-EOF-PO-LINE-CSR.                                29740000
258000     PERFORM 2590-CLOSE-PO-LINE-CSR.                              29750000
258100                                                                  29760000
258200******************************************************************29770000
258300*  OPENS APPROPRIATE CURSOR BASED ON STATUS CODE                  29780000
258400******************************************************************29790000
258500 2510-OPEN-PO-LINE-CSR.                                           29800000
258600                                                                  29810000
W24803     MOVE IR-PO-NBR2 TO POPRPK-PO-NBR                             29820000
258700     PERFORM WITH TEST AFTER                                      29830000
258800        VARYING PV-RETRY-COUNTER FROM 1 BY 1                      29840000
258900        UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES OR              29850000
259000                SQLCODE = ZERO                                    29860000
259100                                                                  29870000
259200        IF PURCHS-STATUS-CDE = 'FE' OR 'PA' OR 'RJ'               29880000
259300                            OR 'RS' OR 'WK'                       29890000
259400            EXEC SQL                                              29900000
259500                OPEN PRE-LINE-CSR                                 29910000
259600            END-EXEC                                              29920000
259700        ELSE                                                      29930000
259800            EXEC SQL                                              29940000
259900                OPEN APP-LINE-CSR                                 29950000
260000            END-EXEC                                              29960000
260100        END-IF                                                    29970000
260200                                                                  29980000
260300        EVALUATE TRUE                                             29990000
260400            WHEN SQLCODE = +0                                     30000000
260500                CONTINUE                                          30010000
260600            WHEN SQLCODE = -904                                   30020000
260700            WHEN SQLCODE = -911                                   30030000
260800            WHEN SQLCODE = -913                                   30040000
260900                CONTINUE                                          30050000
261000            WHEN SQLWARN NOT = SPACE                              30060000
261100            WHEN SQLCODE NOT = +0                                 30070000
261200                MOVE '2510-OPEN-PO-PACK-CSR'                      30080000
261300                                      TO PV-ABEND-PARAGRAPH       30090000
261400                PERFORM 9000-SQL-ABEND                            30100000
261500        END-EVALUATE                                              30110000
261600     END-PERFORM.                                                 30120000
261700                                                                  30130000
261800     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         30140000
261900         MOVE '2510-OPEN-PO-PACK-CSR' TO PV-ABEND-PARAGRAPH       30150000
262000         PERFORM 9000-SQL-ABEND                                   30160000
262100     END-IF.                                                      30170000
262200******************************************************************30180000
262300*  FETCHS PO PACK CSR                                             30190000
262400******************************************************************30200000
262500 2550-PROCESS-PO-LINE-CSR.                                        30210000
262600                                                                  30220000
W24803     INITIALIZE  PV-NULL-INDICATOR-VARIABLES.                     30230000
262700     PERFORM WITH TEST AFTER                                      30240000
262800        VARYING PV-RETRY-COUNTER FROM 1 BY 1                      30250000
262900        UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES OR              30260000
263000                SQLCODE = ZERO  OR SQLCODE = +100                 30270000
263100        IF PURCHS-STATUS-CDE = 'FE' OR 'PA' OR 'RJ'               30280000
263200                            OR 'RS' OR 'WK'                       30290000
263300            EXEC SQL                                              30300000
263400                FETCH PRE-LINE-CSR                                30310000
263500                INTO :PURITM-PO-PREPK-ID,                         30320000
263600                      :PURITM-SKU-SEQ-NBR,                        30330000
263700                      :PURITM-CL-NBR,                             30340000
263800                      :PURITM-VEND-STYL-NAME,                     30350000
263900                      :PURITM-SKU-DESC,                           30360000
W24803                      :XLT00004-MAJ-CL-NBR:PV-MAJ-CL-NBR-IND,     30370000
W24803                      :XLT00004-SUB-CL-NBR:PV-SUB-CL-NBR-IND,     30380000
W24803                      :XLT00003-SKU-NBR:PV-SKU-NBR-IND,           30390000
W24803                      :XLT00004-VS-NBR:PV-VS-NBR-IND,             30400000
W24803                      :XLT00003-SKU-DESC:PV-SKU-DESC-IND,         30410000
264000                      :PURITM-UNT-QTY,                            30420000
264100                      :PURITM-UNT-COST-AMT,                       30430000
264200                      :PURITM-TOT-VAL-COST-AMT,                   30440000
264300                      :PURITM-COLOR-DESC,                         30450000
264400                      :PURITM-SIZE-DESC,                          30460000
W24803                 :XLT00003-CSTM-CLOR-DESC:PV-CSTM-CLOR-DESC-IND,  30470000
W24803                      :XLT00003-SIZE-DESC:PV-SIZE-DESC-IND,       30480000
264500                      :PURITM-AD-EVNT-DTE,                        30490000
264600                      :PURITM-UNT-RTL-PR-AMT,                     30500000
264700                      :PURITM-TOT-VAL-RTL-AMT,                    30510000
264800                      :PURITM-PO-LNE-NBR,                         30520000
264900                      :PURITM-STATUS-CDE,                         30530000
265000                      :PURITM-ITM-NBR,                            30540000
265100                      :PURITM-PREPK-RATO-QTY,                     30550000
265110* TKMA888 * ADDED 1 LINES ****************************************30560000
265140                      :PURITM-PRD-1ST-COST-AMT                    30570000
265150* TKMA888 *------------------------------------------------------*30580000
265200            END-EXEC                                              30590000
265300        ELSE                                                      30600000
265400            EXEC SQL                                              30610000
265500                FETCH APP-LINE-CSR                                30620000
265600                INTO :PURITM-PO-PREPK-ID,                         30630000
265700                      :PURITM-SKU-SEQ-NBR,                        30640000
265800                      :PURITM-CL-NBR,                             30650000
265900                      :PURITM-VEND-STYL-NAME,                     30660000
266000                      :PURITM-SKU-DESC,                           30670000
W24803                      :XLT00004-MAJ-CL-NBR:PV-MAJ-CL-NBR-IND,     30680000
W24803                      :XLT00004-SUB-CL-NBR:PV-SUB-CL-NBR-IND,     30690000
W24803                      :XLT00003-SKU-NBR:PV-SKU-NBR-IND,           30700000
W24803                      :XLT00004-VS-NBR:PV-VS-NBR-IND,             30710000
W24803                      :XLT00003-SKU-DESC:PV-SKU-DESC-IND,         30720000
266100                      :PURITM-UNT-QTY,                            30730000
266200                      :PURITM-UNT-COST-AMT,                       30740000
266300                      :PURITM-TOT-VAL-COST-AMT,                   30750000
266400                      :PURITM-COLOR-DESC,                         30760000
266500                      :PURITM-SIZE-DESC,                          30770000
W24803                :XLT00003-CSTM-CLOR-DESC:PV-CSTM-CLOR-DESC-IND,   30780000
W24803                      :XLT00003-SIZE-DESC:PV-SIZE-DESC-IND,       30790000
266600                      :PURITM-AD-EVNT-DTE,                        30800000
266700                      :PURITM-UNT-RTL-PR-AMT,                     30810000
266800                      :PURITM-TOT-VAL-RTL-AMT,                    30820000
266900                      :PURITM-APP-PO-LNE-NBR,                     30830000
267000                      :PURITM-STATUS-CDE,                         30840000
267100                      :PURITM-ITM-NBR,                            30850000
267200                      :PURITM-PREPK-RATO-QTY,                     30860000
267210* TKMA888 * ADDED 1 LINES ****************************************30870000
267220                      :PURITM-PRD-1ST-COST-AMT                    30880000
267230* TKMA888 *------------------------------------------------------*30890000
267300            END-EXEC                                              30900000
267400        END-IF                                                    30910000
267500                                                                  30920000
267600        EVALUATE TRUE                                             30930000
267700            WHEN SQLCODE = +0                                     30940000
267800        IF PURCHS-STATUS-CDE = 'FE' OR 'PA' OR 'RJ'               30950000
267900                           OR 'RS' OR 'WK'                        30960000
268000            MOVE PURITM-PO-LNE-NBR TO PV-PO-LNE-NBR               30970000
268100        ELSE                                                      30980000
268200            MOVE PURITM-APP-PO-LNE-NBR TO PV-PO-LNE-NBR           30990000
268300        END-IF                                                    31000000
268400            WHEN SQLCODE = +100                                   31010000
268500                CONTINUE                                          31020000
268600            WHEN SQLCODE = -904                                   31030000
268700            WHEN SQLCODE = -911                                   31040000
268800            WHEN SQLCODE = -913                                   31050000
268900                CONTINUE                                          31060000
269000            WHEN SQLWARN NOT = SPACE                              31070000
269100            WHEN SQLCODE NOT = +0                                 31080000
269200                MOVE '2550-PROCESS-PO-LINE-CSR'                   31090000
269300                                      TO PV-ABEND-PARAGRAPH       31100000
269400                PERFORM 9000-SQL-ABEND                            31110000
269500        END-EVALUATE                                              31120000
269600     END-PERFORM.                                                 31130000
269700                                                                  31140000
269800     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         31150000
269900         MOVE '2550-PROCESS-PO-LINE-CSR' TO PV-ABEND-PARAGRAPH    31160000
270000         PERFORM 9000-SQL-ABEND                                   31170000
270100     END-IF.                                                      31180000
270200                                                                  31190000
270300     IF SQLCODE = +100                                            31200000
270400         SET PS-EOF-PO-LINE-CSR    TO TRUE                        31210000
270500     ELSE                                                         31220000
270600         MOVE +0                   TO PV-ALLOC-CNT                31230000
270700         DISPLAY 'REPORT TYPE: ' PS-TYPE-RPT-PROCESS-SW           31240000
270800         IF PS-ANALYST-RPT-TYPE                                   31250000
270900            PERFORM 2475-COUNT-ALLOCATIONS                        31260000
271000         END-IF                                                   31270000
271100                                                                  31280000
271200         IF PS-NOT-WROTE-UNAVAIL-HEADER                           31290000
271300            PERFORM 6000-WRITE-UNAVAIL-HEADER                     31300000
271400         END-IF                                                   31310000
271500         PERFORM 3000-PROCESS-PACK-LINES                          31320000
271600     END-IF.                                                      31330000
271700                                                                  31340000
271800******************************************************************31350000
271900*  CLOSES PO PACK CSR                                             31360000
272000******************************************************************31370000
272100 2590-CLOSE-PO-LINE-CSR.                                          31380000
272200                                                                  31390000
272300     PERFORM WITH TEST AFTER                                      31400000
272400        VARYING PV-RETRY-COUNTER FROM 1 BY 1                      31410000
272500        UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES OR              31420000
272600                SQLCODE = ZERO                                    31430000
272700                                                                  31440000
272800        IF PURCHS-STATUS-CDE = 'FE' OR 'PA' OR 'RJ'               31450000
272900                            OR 'RS' OR 'WK'                       31460000
273000            EXEC SQL                                              31470000
273100                CLOSE PRE-LINE-CSR                                31480000
273200            END-EXEC                                              31490000
273300        ELSE                                                      31500000
273400            EXEC SQL                                              31510000
273500                CLOSE APP-LINE-CSR                                31520000
273600            END-EXEC                                              31530000
273700        END-IF                                                    31540000
273800                                                                  31550000
273900        EVALUATE TRUE                                             31560000
274000            WHEN SQLCODE = +0                                     31570000
274100                CONTINUE                                          31580000
274200            WHEN SQLCODE = -904                                   31590000
274300            WHEN SQLCODE = -911                                   31600000
274400            WHEN SQLCODE = -913                                   31610000
274500                CONTINUE                                          31620000
274600            WHEN SQLWARN NOT = SPACE                              31630000
274700            WHEN SQLCODE NOT = +0                                 31640000
274800                MOVE '2590-CLOSE-PO-LINE-CSR'                     31650000
274900                                      TO PV-ABEND-PARAGRAPH       31660000
275000                PERFORM 9000-SQL-ABEND                            31670000
275100        END-EVALUATE                                              31680000
275200     END-PERFORM.                                                 31690000
275300                                                                  31700000
275400     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         31710000
275500         MOVE '2590-CLOSE-PO-LINE-CSR' TO PV-ABEND-PARAGRAPH      31720000
275600         PERFORM 9000-SQL-ABEND                                   31730000
275700     END-IF.                                                      31740000
275800******************************************************************31750000
275900*  FILLS IN SKU LINE 1 AND 2 FOR EACH LINE WITHIN A PACK AND     *31760000
276000*  WRITES OUT TO PO PRINT.                                       *31770000
276100******************************************************************31780000
276200                                                                  31790000
276300 3000-PROCESS-PACK-LINES.                                         31800000
276400                                                                  31810000
276500******************************************************************31820000
276600* SKU-LINE-1                                                      31830000
276700******************************************************************31840000
276800     IF PURCHS-STATUS-CDE =                                       31850000
276900                         'FE' OR 'PA' OR 'RJ' OR 'RS' OR 'WK'     31860000
277000         MOVE PURITM-PO-LNE-NBR  TO SL1-LINE-NBR                  31870000
277100     ELSE                                                         31880000
277200         MOVE PURITM-APP-PO-LNE-NBR                               31890000
277300                               TO SL1-LINE-NBR                    31900000
277400     END-IF.                                                      31910000
277500                                                                  31920000
277600     MOVE PURCHS-DEPT-NBR       TO SL1-DEPT.                      31930000
W24803     IF PV-SKU-NBR-IND = +0                                       31940000
W24803        MOVE XLT00004-MAJ-CL-NBR     TO  PV-CLASS                 31950000
W24803        MOVE PV-CLASS                TO  SL2-MAJ-CL               31960000
W24803        MOVE XLT00004-SUB-CL-NBR     TO  PV-CLASS                 31970000
W24803        MOVE PV-CLASS                TO  SL2-SUB-CL               31980000
W24803        MOVE XLT00003-SKU-NBR        TO  PV-SKU                   31990000
W24803        MOVE PV-SKU                  TO  SL1-SKU                  32000000
W24803        MOVE XLT00004-VS-NBR         TO  SL1-STYLE                32010000
W24803        MOVE XLT00003-SKU-DESC       TO  SL1-DESC                 32020000
W24803        MOVE XLT00003-CSTM-CLOR-DESC TO  SL2-COLOR                32030000
W24803        MOVE XLT00003-SIZE-DESC      TO  SL2-SIZE                 32040000
W24803     ELSE                                                         32050000
W24803        MOVE PURITM-CL-NBR           TO  SL2-SUB-CL               32060000
W24803        MOVE PURCHS-DEPT-NBR         TO  PV-TEMP-DEPT             32070000
W24803        MOVE PURITM-CL-NBR           TO  PV-TEMP-CLASS            32080000
W24803        MOVE PURITM-SKU-SEQ-NBR      TO  PV-TEMP-SEQ              32090000
W24803        MOVE PV-TEMP-SKU             TO  SL1-SKU                  32100000
W24803        MOVE PURITM-CL-NBR(1:1)      TO  PV-TEMP-MAJ-CL-1         32110000
W24803        MOVE PV-TEMP-MAJ-CL          TO  SL2-MAJ-CL               32120000
W24803        MOVE PURITM-VEND-STYL-NAME   TO  SL1-STYLE                32130000
W24803        MOVE PURITM-SKU-DESC         TO  SL1-DESC                 32140000
W24803        MOVE PURITM-COLOR-DESC       TO  SL2-COLOR                32150000
W24803        MOVE PURITM-SIZE-DESC        TO  SL2-SIZE                 32160000
W24803     END-IF                                                       32170000
277801* TKMA888 * REPLACED 1 LINE WITH 5 LINES *************************32180000
277802*           TO CHANGE UNIT COST AMOUNT FOR IMPORT PO'S            32190000
277910* TKMA888 *------------------------------------------------------*32200000
277920*    MOVE PURITM-UNT-COST-AMT   TO SL1-COST.                      32210000
277921* TKMA888 *------------------------------------------------------*32220000
277923     MOVE PURITM-PRD-1ST-COST-AMT TO SL1-COST                     32230000
277940* TKMA888 *------------------------------------------------------*32240000
278200     MOVE PURITM-PREPK-RATO-QTY TO SL1-PREPK-RATO-QTY.            32250000
278300     MOVE PURITM-UNT-QTY        TO SL1-ORD-QTY.                   32260000
278310* TKMA888 * REPLACED 2 LINE WITH 7 LINES *************************32270000
278320*           TO CHANGE COMPUTE OF ITEM TOTAL COST FOR IMPORT PO'S  32280000
278330* TKMA888 *------------------------------------------------------*32290000
278400*    MOVE PURITM-TOT-VAL-COST-AMT                                 32300000
278500*                               TO SL1-TOT-COST.                  32310000
278501* TKMA888 *------------------------------------------------------*32320000
278520     COMPUTE PV-TOT-VAL-COST-AMT =                                32330000
278521               PURITM-UNT-QTY * PURITM-PRD-1ST-COST-AMT           32340000
278522     MOVE PV-TOT-VAL-COST-AMT     TO SL1-TOT-COST                 32350000
278560* TKMA888 *------------------------------------------------------*32360000
278700                                                                  32370000
278800******************************************************************32380000
278900* SKU-LINE-2                                                      32390000
279000******************************************************************32400000
279200                                                                  32410000
279300     IF PS-VENDOR-RPT-TYPE AND IR-RPT-TYPE-VN = 'VS'              32420000
279400         MOVE ZEROES           TO SL2-RTL                         32430000
279500                                  SL2-TOT-RTL                     32440000
279600     ELSE                                                         32450000
279700         MOVE PURITM-UNT-RTL-PR-AMT                               32460000
279800                               TO SL2-RTL                         32470000
279900         MOVE PURITM-TOT-VAL-RTL-AMT                              32480000
280000                               TO SL2-TOT-RTL                     32490000
280100     END-IF.                                                      32500000
280200                                                                  32510000
280400     IF SL2-SIZE = 'ASSORTED'                                     32520000
280500        MOVE 'SEE BELOW' TO SL2-SIZE                              32530000
280600     END-IF.                                                      32540000
280700     IF PURITM-AD-EVNT-DTE = PC-INIT-DATE                         32550000
280800         MOVE SPACES           TO SL2-AD-DATE                     32560000
280900     ELSE                                                         32570000
281000         MOVE PURITM-AD-EVNT-DTE                                  32580000
281100                               TO PV-DATE-BREAK                   32590000
281200         MOVE PV-DB-MM         TO PV-DBS-MM                       32600000
281300         MOVE PV-DB-DD         TO PV-DBS-DD                       32610000
281400         MOVE PV-DB-YY         TO PV-DBS-YY                       32620000
281500         MOVE PV-DATE-BREAK-SLASH                                 32630000
281600                               TO SL2-AD-DATE                     32640000
281700     END-IF.                                                      32650000
281800                                                                  32660000
281900     MOVE PV-LINE-CNT TO PV-TEMP-LINE-CNT.                        32670000
282000                                                                  32680000
282100     IF PS-PRINT-PACK-LINE-TOTAL                                  32690000
282200        COMPUTE PV-TEMP-LINE-CNT = PV-TEMP-LINE-CNT + 3           32700000
282300     END-IF.                                                      32710000
282400                                                                  32720000
282500     IF PS-WRITE-UNAVAIL                                          32730000
282600        COMPUTE PV-TEMP-LINE-CNT = PV-TEMP-LINE-CNT + 5           32740000
282700     END-IF.                                                      32750000
282800                                                                  32760000
282900     IF PURITM-STATUS-CDE = 'CA'                                  32770000
283000        COMPUTE PV-TEMP-LINE-CNT =  PV-TEMP-LINE-CNT + 2          32780000
283100     END-IF.                                                      32790000
283200                                                                  32800000
283300     IF PV-ALLOC-CNT > 0                                          32810000
283400        COMPUTE PV-TEMP-LINE-CNT ROUNDED =                        32820000
283500                PV-TEMP-LINE-CNT + 3 + (PV-ALLOC-CNT / 7)         32830000
283600     END-IF.                                                      32840000
283700                                                                  32850000
283800     IF PV-TEMP-LINE-CNT >= +57                                   32860000
283900        PERFORM 7000-ADVANCE-TO-NEWPAGE                           32870000
284000     END-IF.                                                      32880000
284100                                                                  32890000
284200     IF PS-PRINT-PACK-LINE-TOTAL                                  32900000
284300        IF POPRPK-PREPK-TYP-CDE = 'M'                             32910032
284400           WRITE PORPT-RECORD FROM PACK-LINE-TOTAL-MULTI          32920000
284500                 AFTER 2 LINES                                    32930000
284600        ELSE                                                      32940000
284700           IF POPRPK-PREPK-TYP-CDE = 'I'                          32950032
284800              WRITE PORPT-RECORD FROM PACK-LINE-TOTAL-INNER       32960000
284900                    AFTER 2 LINES                                 32970000
285000           END-IF                                                 32980000
285100        END-IF                                                    32990000
285200        SET PS-NOT-PRINT-PACK-LINE-TOTAL TO TRUE                  33000000
285300        WRITE PORPT-RECORD FROM PACK-DESC-LINE                    33010000
285400              AFTER 1 LINES                                       33020000
285500        ADD +3 TO PV-LINE-CNT                                     33030000
285600     END-IF.                                                      33040000
285700                                                                  33050000
285800     IF PS-WRITE-UNAVAIL                                          33060000
285900        MOVE SPACES TO PORPT-RECORD                               33070000
286000        WRITE PORPT-RECORD AFTER 1 LINES                          33080000
286100        WRITE PORPT-RECORD FROM ASTERISK-LINE                     33090000
286200                  AFTER 1 LINES                                   33100000
286300        MOVE SPACES TO PORPT-RECORD                               33110000
286400        WRITE PORPT-RECORD AFTER 1 LINES                          33120000
286500        ADD +3 TO PV-LINE-CNT                                     33130000
286600        WRITE PORPT-RECORD FROM PACK-LINE-UNAVAIL                 33140000
286700               AFTER 2 LINES                                      33150000
286800                                                                  33160000
286900        ADD +2 TO PV-LINE-CNT                                     33170000
287000                                                                  33180000
287100        SET PS-WROTE-UNAVAIL-HEADER                               33190000
287200            PS-NOT-WRITE-UNAVAIL    TO TRUE                       33200000
287300     END-IF.                                                      33210000
287400                                                                  33220000
287500                                                                  33230000
287600     WRITE PORPT-RECORD FROM SKU-LINE-1                           33240000
287700             AFTER 2 LINES.                                       33250000
287800     WRITE PORPT-RECORD FROM SKU-LINE-2                           33260000
287900               AFTER 1 LINES.                                     33270000
288000     ADD +3 TO PV-LINE-CNT.                                       33280000
288100                                                                  33290000
288200     IF PURITM-STATUS-CDE = 'CA'                                  33300000
288300        WRITE PORPT-RECORD FROM LINE-CANCEL-LINE                  33310000
288400              AFTER 2 LINES                                       33320000
288500        ADD +2                TO PV-LINE-CNT                      33330000
288600     ELSE                                                         33340000
288700        IF PV-ALLOC-CNT > +0 AND PS-ANALYST-RPT-TYPE              33350000
288800           WRITE PORPT-RECORD FROM DISTR-HEADER-1                 33360000
288900                  AFTER 2 LINES                                   33370000
289000           ADD +2              TO PV-LINE-CNT                     33380000
289100           IF PV-ALLOC-CNT < +7                                   33390000
289200                 CONTINUE                                         33400000
289300           ELSE                                                   33410000
289400                 MOVE +7       TO PV-ALLOC-CNT                    33420000
289500           END-IF                                                 33430000
289600                                                                  33440000
289700           INITIALIZE DISTR-HEADER-2                              33450000
289800                                                                  33460000
289900           PERFORM 2490-FILL-DIST-HEAD2                           33470000
290000           VARYING PV-SUB FROM +1 BY +1                           33480000
290100           UNTIL PV-SUB > PV-ALLOC-CNT                            33490000
290200                                                                  33500000
290300           WRITE PORPT-RECORD FROM DISTR-HEADER-2                 33510000
290400                  AFTER 1 LINES                                   33520000
290500           ADD +1            TO PV-LINE-CNT                       33530000
290600           PERFORM 2400-OPEN-ALLOC-CSR                            33540000
290700           MOVE +0                  TO PV-SUB                     33550000
290800           INITIALIZE DISTR-LINE                                  33560000
290900           SET PS-NOT-EOF-ALLOC-CSR TO TRUE                       33570000
291000           PERFORM 2410-PROCESS-ALLOC-CSR                         33580000
291100                UNTIL PS-EOF-ALLOC-CSR                            33590000
291200           PERFORM 2450-CLOSE-ALLOC-CSR                           33600000
291300        END-IF                                                    33610000
291400     END-IF.                                                      33620000
291500                                                                  33630000
291600                                                                  33640000
291700******************************************************************33650000
291800* DETERMINES TOTAL UNITS IN A PACK.                               33660000
291900******************************************************************33670000
292000 4000-SUM-PACK-QTY.                                               33680000
292100                                                                  33690000
292200     EXEC SQL                                                     33700000
292300         SELECT SUM(UNT_QTY)                                      33710000
292400         INTO  :PV-PACK-UNITS                                     33720000
292500         FROM TPURITM                                             33730000
292600         WHERE PO_NBR = :IR-PO-NBR2                               33740000
292700         AND PO_PREPK_ID = :POPRPK-PO-PREPK-ID                    33750000
292800         AND VER_STATUS_CDE = 'A'                                 33760000
292900     END-EXEC.                                                    33770000
293000                                                                  33780000
293100     EVALUATE TRUE                                                33790000
293200         WHEN SQLCODE = +0                                        33800000
293300             CONTINUE                                             33810000
293400         WHEN SQLWARN NOT = SPACE                                 33820000
293500         WHEN SQLCODE NOT = +0                                    33830000
293600             MOVE '4000-SUM-PACK-QTY'                             33840000
293700                                   TO PV-ABEND-PARAGRAPH          33850000
293800             PERFORM 9000-SQL-ABEND                               33860000
293900     END-EVALUATE.                                                33870000
294000                                                                  33880000
294100******************************************************************33890000
294200* PREPARES PACK HEADING LINE BASED ON IF ITS AN M OR I ORDER      33900000
294300* AND WRITES IT OUT TO THE PO PRINT.                              33910000
294400******************************************************************33920000
294500 5000-FILL-PACK-LINE-TOTAL.                                       33930000
294600                                                                  33940000
294700     MOVE POPRPK-PO-PREPK-ID       TO PKT-PACK-ID-MULTI           33950000
294800                                      PKT-PACK-ID-INNER           33960000
294900                                      PV-PACK-ID-NUM.             33970000
295000     MOVE POPRPK-PREPK-DESC        TO PKT-DESCRIPTION.            33980000
295001* TKMA888 * ADDED 3 LINES ****************************************33990000
295003*                TO INCLUDE SKU AND UPC NUMBERS ON PO PRINT       34000000
295006* TKMA888 *------------------------------------------------------*34010000
295010     MOVE POPRPK-PK-SKU-NBR        TO PKT-SKU-NBR                 34020000
295011                                      PKT-SKU-NBR-INNER.          34030000
295012     MOVE POPRPK-PREPK-UPC-NBR     TO PKT-UPC-NBR.                34040000
295020* TKMA888 *------------------------------------------------------*34050000
295100     MOVE PV-PACK-UNITS            TO PKT-UNITS                   34060000
295200                                      PKT-UNITS-INNER.            34070000
295300     MOVE POPRPK-OTPK-ORD-QTY      TO PKT-CTNS                    34080000
295400                                      PKT-CTNS-INNER.             34090000
295500     MOVE POPRPK-INPK-UNT-QTY      TO PKT-UNT-PER-CTN             34100000
295600                                      PKT-UNITS-PER-PACK.         34110000
295700     MOVE POPRPK-OTPK-UNT-QTY      TO PKT-UNIT-PER-CARTON.        34120000
296400                                                                  34130000
PE9809     IF POPRPK-INPK-UNT-QTY = 0                                   34140000
PE9809        MOVE IR-PO-NBR2    TO OUT-PO-NBR                          34150000
PE9809        PERFORM 5500-WRITE-PO-ERROR-FILE                          34160000
PE9809        SET PS-ERROR-PO TO TRUE                                   34170000
PE9809     ELSE                                                         34180000
PE9809        DIVIDE POPRPK-OTPK-UNT-QTY BY POPRPK-INPK-UNT-QTY         34190000
PE9809        GIVING PKT-INNER-PKS                                      34200000
PE9809        SET PS-PRINT-PACK-LINE-TOTAL TO TRUE                      34210000
PE9809     END-IF.                                                      34220000
PE9809                                                                  34230000
PE9809 5500-WRITE-PO-ERROR-FILE.                                        34240000
PE9809                                                                  34250000
PE9809        MOVE OUT-PO-NBR TO ERROR-PO.                              34260000
PE9809        DISPLAY 'WRITING TO ERROR PO FILE '                       34270000
PE9809        WRITE ERROR-PO-RECORD FROM ERROR-PO-REC.                  34280000
296600                                                                  34290000
296500 6000-WRITE-UNAVAIL-HEADER.                                       34300000
296600                                                                  34310000
296700     INITIALIZE PV-PACK-UNITS.                                    34320000
296800                                                                  34330000
296900     EXEC SQL                                                     34340000
297000         SELECT SUM(UNT_QTY)                                      34350000
297100         INTO  :PV-PACK-UNITS                                     34360000
297200         FROM TPURITM                                             34370000
297300         WHERE PO_NBR = :IR-PO-NBR2                               34380000
297400         AND PO_PREPK_ID = 0                                      34390000
297500         AND VER_STATUS_CDE = 'A'                                 34400000
297600         AND STATUS_CDE NOT IN ('CA', 'CB')                       34410000
297700     END-EXEC.                                                    34420000
297800                                                                  34430000
297900     EVALUATE TRUE                                                34440000
298000         WHEN SQLCODE = +0                                        34450000
298100             MOVE PV-PACK-UNITS TO PL2-PACK-UNITS                 34460000
298200         WHEN SQLCODE = -305                                      34470000
298300             MOVE ZERO          TO PV-PACK-UNITS                  34480000
298400             MOVE ZERO          TO PL2-PACK-UNITS                 34490000
298500         WHEN SQLWARN NOT = SPACE                                 34500000
298600         WHEN SQLCODE NOT = +0                                    34510000
298700             MOVE '6000-WRITE-UNAVAIL-HEADER'                     34520000
298800                                   TO PV-ABEND-PARAGRAPH          34530000
298900             PERFORM 9000-SQL-ABEND                               34540000
299000     END-EVALUATE.                                                34550000
299100                                                                  34560000
299200     SET PS-WRITE-UNAVAIL          TO TRUE.                       34570000
299300                                                                  34580000
299400******************************************************************34590000
299500* ADVANCES PAGE AND REWRITES HEADER                               34600000
299600******************************************************************34610000
299700 7000-ADVANCE-TO-NEWPAGE.                                         34620000
299800                                                                  34630000
299900     ADD +1                    TO PV-PAGE-CNT.                    34640000
300000     MOVE PV-PAGE-CNT          TO HL2-PAGE.                       34650000
300100     MOVE +0                   TO PV-LINE-CNT.                    34660000
300200                                                                  34670000
300300     WRITE PORPT-RECORD FROM HEADER-LINE1                         34680000
300400          AFTER ADVANCING PAGE.                                   34690000
300500     WRITE PORPT-RECORD FROM HEADER-LINE2                         34700000
300600          AFTER 1 LINES.                                          34710000
300700     WRITE PORPT-RECORD FROM HEADER-LINE3                         34720000
300800          AFTER 1 LINES.                                          34730000
300900     MOVE +3                   TO PV-LINE-CNT.                    34740000
301000                                                                  34750000
301100*----------------------------------------------------------------*34760000
301200*    NAME REFORMATOR MODULE                                      *34770000
301300*----------------------------------------------------------------*34780000
301400     COPY DPPD024.                                                34790000
301500/                                                                 34800000
301600******************************************************************34810000
301700*  - ERROR ROUTINE FOR DB2 ABENDS                                 34820000
301800******************************************************************34830000
301900 9000-SQL-ABEND.                                                  34840000
302000                                                                  34850000
302100     MOVE SQLCODE                  TO SQLCODE2.                   34860000
302200     MOVE SQLERRD(3)               TO SQLERRD3.                   34870000
302300     DISPLAY '** ABEND          **'.                              34880000
302400     DISPLAY '** PROGRAM        ** = POKRP080'.                   34890000
302500     DISPLAY '** PARAGRAPH      ** = ' PV-ABEND-PARAGRAPH.        34900000
302600     DISPLAY '** SQLCODE        ** = ' SQLCODE2.                  34910000
302700     DISPLAY '** ROWS PROCESSED ** = ' SQLERRD3.                  34920000
302800     DISPLAY '** SQLERRM        ** = ' SQLERRM.                   34930000
302900     DISPLAY '** SQLERRMC       ** = ' SQLERRMC.                  34940000
303000     MOVE +4013                    TO PV-ABEND-CODE.              34950000
303100     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         34960000
303200******************************************************************34970000
