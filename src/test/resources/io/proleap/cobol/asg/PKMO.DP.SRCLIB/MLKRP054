       IDENTIFICATION DIVISION.                                         11/22/94
00002  PROGRAM-ID.    MLKRP054                                          MLKRP054
00003  AUTHOR.        TESS BESTE.                                          LV004
00004  INSTALLATION.  KOHLS DEPARTMENT STORES.                          MLKRP054
00005  DATE-WRITTEN.  11/01/93.                                         MLKRP054
00006  DATE-COMPILED.                                                   MLKRP054
00007                                                                   MLKRP054
00008 ******************************************************************MLKRP054
00009 * THIS PROGRAM READS THE EDIT SPLIT REPORT DATA FILE AND          MLKRP054
00010 * REPORTS MERCHANDISE LEDGER AND INVENTORY LEDGER COST AND RETAIL MLKRP054
00011 * AMOUNTS. TWO REPORTS ARE CREATED.                               MLKRP054
00012 *                                                                 MLKRP054
00013 * THE FIRST REPORT IS THE EDIT SPLIT STORE REPORT. IT REPORTS     MLKRP054
00014 * TOTALS BY FINANCIAL LIABILITY DATE WITHIN TRANSACTION CODE      MLKRP054
00015 * WITHIN STORE.                                                   MLKRP054
00016 *                                                                 MLKRP054
00017 * THE SECOND REPORT IS THE EDIT SPLIT CORPORATE REPORT. IT        MLKRP054
00018 * REPORTS TOTALS BY FINANCIAL LIABILITY DATE WITHIN TRANSACTION.  MLKRP054
00019 *                                                                 MLKRP054
00020 * BOTH REPORTS SPLIT THE TOTALS INTO CURRENT AND NEXT FISCAL      MLKRP054
00021 * PERIOD AMOUNTS, AND PRINT A FINAL TOTAL PAGE AT THE END.        MLKRP054
00022 *                                                                 MLKRP054
21015 *CHANGE HISTORY:                                                          
21015 *    02/27/2001 - ROD JANSSEN      CHANGE ID: 21015                       
21015 *       EDIT SPLIT REPORT MODS. BREAK PURCHASES OUT AS ADJUSTMENTS        
21015 *       AND RECEIPTS.                                                     
W26603* W26603  03-08-2004 ROD JANSSEN MERCH LEDGER STORE EXPANSION             
21015 *                                                                         
      ******************************************************************MLKRP054
00023                                                                   MLKRP054
00025  ENVIRONMENT DIVISION.                                            MLKRP054
00026  CONFIGURATION SECTION.                                           MLKRP054
00027  SOURCE-COMPUTER.        IBM-3090.                                MLKRP054
00028  OBJECT-COMPUTER.        IBM-3090.                                MLKRP054
00029  INPUT-OUTPUT SECTION.                                            MLKRP054
00030  FILE-CONTROL.                                                    MLKRP054
00031      SELECT EDIT-SPLIT-FILE                                       MLKRP054
00032          ASSIGN TO INP01.                                         MLKRP054
00033      SELECT STORE-SPLIT-REPORT                                    MLKRP054
00034          ASSIGN TO RPT01.                                         MLKRP054
00035      SELECT CORP-SPLIT-REPORT                                     MLKRP054
00036          ASSIGN TO RPT02.                                         MLKRP054
00038                                                                   MLKRP054
00039  DATA DIVISION.                                                   MLKRP054
00040  FILE SECTION.                                                    MLKRP054
00041                                                                   MLKRP054
00042  FD  EDIT-SPLIT-FILE                                              MLKRP054
00043      LABEL RECORDS ARE STANDARD                                   MLKRP054
00044      BLOCK CONTAINS 0 RECORDS                                     MLKRP054
00045      RECORDING  MODE IS F                                         MLKRP054
00046      DATA RECORD IS EDIT-SPLIT-RECORD.                            MLKRP054
00047  01  EDIT-SPLIT-RECORD           PIC X(80).                       MLKRP054
00048                                                                   MLKRP054
00049  FD  STORE-SPLIT-REPORT                                           MLKRP054
00050      LABEL RECORDS ARE OMITTED                                    MLKRP054
00051      RECORD CONTAINS 200 CHARACTERS                               MLKRP054
00052      RECORDING  MODE IS F                                         MLKRP054
00053      DATA RECORD IS STORE-SPLIT-REPORT-LINE.                      MLKRP054
00054  01  STORE-SPLIT-REPORT-LINE      PIC X(200).                     MLKRP054
00055                                                                   MLKRP054
00056  FD  CORP-SPLIT-REPORT                                            MLKRP054
00057      LABEL RECORDS ARE OMITTED                                    MLKRP054
00058      RECORD CONTAINS 200 CHARACTERS                               MLKRP054
00059      RECORDING  MODE IS F                                         MLKRP054
00060      DATA RECORD IS CORP-SPLIT-REPORT-LINE.                       MLKRP054
00061  01  CORP-SPLIT-REPORT-LINE       PIC X(200).                     MLKRP054
00062                                                                   MLKRP054
00063  WORKING-STORAGE SECTION.                                         MLKRP054
00064                                                                   MLKRP054
00065  01  PC-PROGRAM-CONSTANTS.                                        MLKRP054
00066      05  PC-MAX-RETRIES               PIC S9(04)    VALUE +3      MLKRP054
00067                                                         COMP SYNC.MLKRP054
00068      05  PC-LINE-LIMIT-FOR-DTL        PIC S9(04)    VALUE +57     MLKRP054
00069                                                         COMP SYNC.MLKRP054
00070      05  PC-LINE-LIMIT-FOR-HD-TC      PIC S9(04)    VALUE +54     MLKRP054
00071                                                         COMP SYNC.MLKRP054
00072      05  PC-OPER-CO                   PIC  X(02)    VALUE '03'.   MLKRP054
00073      05  PC-EFF-DATE-HD-LIT           PIC  X(08)    VALUE         MLKRP054
00074                                                        'EFF DATE'.MLKRP054
00075      05  PC-INVENTORY-ONLY-MODE       PIC  X(20)  VALUE           MLKRP054
00076                                                '(INVENTORY ONLY)'.MLKRP054
00077                                                                   MLKRP054
00078  01  PV-PROGRAM-VARIABLES.                                        MLKRP054
00079      05  PV-ADVANCE                   PIC S9(03)    VALUE ZERO    MLKRP054
00080                                                     COMP-3.       MLKRP054
00081      05  PV-PAGE-COUNT                PIC S9(05)    VALUE ZERO.   MLKRP054
00082      05  PV-LINE-COUNT                PIC S9(04)    VALUE ZERO    MLKRP054
00083                                                     COMP SYNC.    MLKRP054
00084      05  PV-PARAGRAPH-NAME            PIC  X(30)    VALUE SPACE.  MLKRP054
00085      05  PV-ABEND-MESSAGE             PIC  X(75)    VALUE SPACE.  MLKRP054
00086      05  PV-SQL-SUB                   PIC  9(03)    VALUE ZERO.   MLKRP054
00087      05  PV-DB2-OPER-ATTEMPTED        PIC  X(30)    VALUE SPACE.  MLKRP054
00088                                                                   MLKRP054
00089      05  PV-YYMMDD-DATE.                                          MLKRP054
00090          10  PV-YYMMDD-YY             PIC  X(02)    VALUE SPACE.  MLKRP054
00091          10  PV-YYMMDD-MM             PIC  X(02)    VALUE SPACE.  MLKRP054
00092          10  PV-YYMMDD-DD             PIC  X(02)    VALUE SPACE.  MLKRP054
00093      05  PV-ISO-FMT-DATE.                                         MLKRP054
00094          10  PV-ISO-FMT-CC            PIC  X(02).                 MLKRP054
00095          10  PV-ISO-FMT-YY            PIC  X(02).                 MLKRP054
00096          10  FILLER                   PIC  X.                     MLKRP054
00097          10  PV-ISO-FMT-MM            PIC  X(02).                 MLKRP054
00098          10  FILLER                   PIC  X.                     MLKRP054
00099          10  PV-ISO-FMT-DD            PIC  X(02).                 MLKRP054
00100      05  PV-TIME-HHMMSS.                                          MLKRP054
00101          10  PV-TIME-HHMMSS-HH        PIC  X(02)    VALUE SPACES. MLKRP054
00102          10  PV-TIME-HHMMSS-MM        PIC  X(02)    VALUE SPACES. MLKRP054
00103          10  PV-TIME-HHMMSS-SS        PIC  X(02)    VALUE SPACES. MLKRP054
00104      05  PV-LAST-CNTL-CARD-READ       PIC  X(80).                 MLKRP054
W26603     05  PV-EDIT-STORE                PIC X(05)     VALUE SPACES.         
W26603     05  PV-EDIT-STORE-NUM REDEFINES                                      
W26603         PV-EDIT-STORE                PIC 9(05).                          
00105                                                                   MLKRP054
00106  01  TOT-TOTAL-FIELDS.                                            MLKRP054
00107      05  TOT-FLB-FIN-LIAB-DTE-TOTALS.                             MLKRP054
00108          10  TOT-FLB-CURR-ML-COST      PIC  S9(13)V99 COMP-3.     MLKRP054
00109          10  TOT-FLB-CURR-ML-RETAIL    PIC  S9(13)V99 COMP-3.     MLKRP054
00110          10  TOT-FLB-CURR-INV-COST     PIC  S9(13)V99 COMP-3.     MLKRP054
00111          10  TOT-FLB-CURR-INV-RETAIL   PIC  S9(13)V99 COMP-3.     MLKRP054
00112          10  TOT-FLB-NEXT-ML-COST      PIC  S9(13)V99 COMP-3.     MLKRP054
00113          10  TOT-FLB-NEXT-ML-RETAIL    PIC  S9(13)V99 COMP-3.     MLKRP054
00114          10  TOT-FLB-NEXT-INV-COST     PIC  S9(13)V99 COMP-3.     MLKRP054
00115          10  TOT-FLB-NEXT-INV-RETAIL   PIC  S9(13)V99 COMP-3.     MLKRP054
00116      05  TOT-TCD-TRANS-CDE-TOTALS.                                MLKRP054
00117          10  TOT-TCD-CURR-ML-COST      PIC  S9(13)V99 COMP-3.     MLKRP054
00118          10  TOT-TCD-CURR-ML-RETAIL    PIC  S9(13)V99 COMP-3.     MLKRP054
00119          10  TOT-TCD-CURR-INV-COST     PIC  S9(13)V99 COMP-3.     MLKRP054
00120          10  TOT-TCD-CURR-INV-RETAIL   PIC  S9(13)V99 COMP-3.     MLKRP054
00121          10  TOT-TCD-NEXT-ML-COST      PIC  S9(13)V99 COMP-3.     MLKRP054
00122          10  TOT-TCD-NEXT-ML-RETAIL    PIC  S9(13)V99 COMP-3.     MLKRP054
00123          10  TOT-TCD-NEXT-INV-COST     PIC  S9(13)V99 COMP-3.     MLKRP054
00124          10  TOT-TCD-NEXT-INV-RETAIL   PIC  S9(13)V99 COMP-3.     MLKRP054
00125      05  TOT-STR-STORE-TOTALS.                                    MLKRP054
00126          10  TOT-STR-CURR-ML-COST      PIC  S9(13)V99 COMP-3.     MLKRP054
00127          10  TOT-STR-CURR-ML-RETAIL    PIC  S9(13)V99 COMP-3.     MLKRP054
00128          10  TOT-STR-CURR-INV-COST     PIC  S9(13)V99 COMP-3.     MLKRP054
00129          10  TOT-STR-CURR-INV-RETAIL   PIC  S9(13)V99 COMP-3.     MLKRP054
00130          10  TOT-STR-NEXT-ML-COST      PIC  S9(13)V99 COMP-3.     MLKRP054
00131          10  TOT-STR-NEXT-ML-RETAIL    PIC  S9(13)V99 COMP-3.     MLKRP054
00132          10  TOT-STR-NEXT-INV-COST     PIC  S9(13)V99 COMP-3.     MLKRP054
00133          10  TOT-STR-NEXT-INV-RETAIL   PIC  S9(13)V99 COMP-3.     MLKRP054
00134      05  TOT-FNL-FINAL-TOTALS.                                    MLKRP054
00135          10  TOT-FNL-CURR-ML-COST      PIC  S9(13)V99 COMP-3.     MLKRP054
00136          10  TOT-FNL-CURR-ML-RETAIL    PIC  S9(13)V99 COMP-3.     MLKRP054
00137          10  TOT-FNL-CURR-INV-COST     PIC  S9(13)V99 COMP-3.     MLKRP054
00138          10  TOT-FNL-CURR-INV-RETAIL   PIC  S9(13)V99 COMP-3.     MLKRP054
00139          10  TOT-FNL-NEXT-ML-COST      PIC  S9(13)V99 COMP-3.     MLKRP054
00140          10  TOT-FNL-NEXT-ML-RETAIL    PIC  S9(13)V99 COMP-3.     MLKRP054
00141          10  TOT-FNL-NEXT-INV-COST     PIC  S9(13)V99 COMP-3.     MLKRP054
00142          10  TOT-FNL-NEXT-INV-RETAIL   PIC  S9(13)V99 COMP-3.     MLKRP054
00143                                                                   MLKRP054
00144  01  SA-SAVE-AREAS.                                               MLKRP054
W26603     05  SA-PREV-STORE-NBR       PIC X(05)   VALUE SPACE.         MLKRP054
00146      05  SA-PREV-TRANS-CDE       PIC X(02)   VALUE SPACE.         MLKRP054
00147          88  SA-PREV-TRANS-PURCHASE          VALUE '10'.          MLKRP054
00148          88  SA-PREV-TRANS-SALE              VALUE '20'.          MLKRP054
00149          88  SA-PREV-TRANS-TRANSFER-FROM     VALUE '30'.          MLKRP054
00150          88  SA-PREV-TRANS-TRANSFER-TO       VALUE '31'.          MLKRP054
00151          88  SA-PREV-TRANS-MARKDOWN          VALUE '40'.          MLKRP054
00152          88  SA-PREV-TRANS-MARKUP            VALUE '50'.          MLKRP054
00153          88  SA-PREV-TRANS-ADJUSTMENT        VALUE '80'.          MLKRP054
21015      05  SA-PREV-SYST-ORIG-CDE   PIC X(02)   VALUE SPACES.                
21015          88  SA-PREV-PURCH-RECEIPT           VALUE '08'.                  
00154      05  SA-PREV-FIN-LIAB-DTE    PIC X(10)   VALUE SPACE.         MLKRP054
00155      05  SA-CURR-FSCL-YR-PER     PIC X(06)   VALUE SPACE.         MLKRP054
00156                                                                   MLKRP054
00157  01  SW-SWITCHES.                                                 MLKRP054
00158      05  SW-PROCESSING-WHICH-REPORT-SW                            MLKRP054
00159                                       PIC X         VALUE 'S'.    MLKRP054
00160          88  SW-PROCESSING-STORE-REPORT             VALUE 'S'.    MLKRP054
00161          88  SW-PROCESSING-CORP-REPORT              VALUE 'C'.    MLKRP054
00162      05  SW-END-OF-EDIT-SPLIT-FILE-SW PIC X         VALUE 'N'.    MLKRP054
00163          88  SW-END-OF-EDIT-SPLIT-FILE              VALUE 'Y'.    MLKRP054
00164          88  SW-NOT-END-OF-EDIT-SPLIT-FILE          VALUE 'N'.    MLKRP054
00165      05  SW-EMPTY-EDIT-SPLIT-FILE-SW  PIC X         VALUE 'N'.    MLKRP054
00166          88  SW-EMPTY-EDIT-SPLIT-FILE               VALUE 'Y'.    MLKRP054
00167          88  SW-NOT-EMPTY-EDIT-SPLIT-FILE           VALUE 'N'.    MLKRP054
00168      05  SW-STORE-BREAK-SW            PIC X         VALUE 'N'.    MLKRP054
00169          88  SW-STORE-BREAK                         VALUE 'Y'.    MLKRP054
00170          88  SW-NOT-STORE-BREAK                     VALUE 'N'.    MLKRP054
00171      05  SW-TRANS-CDE-BREAK-SW        PIC X         VALUE 'N'.    MLKRP054
00172          88  SW-TRANS-CDE-BREAK                     VALUE 'Y'.    MLKRP054
00173          88  SW-NOT-TRANS-CDE-BREAK                 VALUE 'N'.    MLKRP054
00174      05  SW-CURR-OR-NEXT-FISC-PER-SW  PIC X         VALUE SPACE.  MLKRP054
00175          88  SW-CURR-FISC-PER                       VALUE 'C'.    MLKRP054
00176          88  SW-NEXT-FISC-PER                       VALUE 'N'.    MLKRP054
00177      05  SW-END-OF-CORP-RPT-TABLE-SW  PIC X         VALUE 'N'.    MLKRP054
00178          88  SW-END-OF-CORP-RPT-TABLE               VALUE 'Y'.    MLKRP054
00179          88  SW-NOT-END-OF-CORP-RPT-TABLE           VALUE 'N'.    MLKRP054
00180                                                                   MLKRP054
00181  01  FPN-FSCL-PER-NAME-TABLE-DATA.                                MLKRP054
00182          15  FPN-ENTRY01-DATA         PIC X(09) VALUE 'FEBRUARY '.MLKRP054
00183          15  FPN-ENTRY02-DATA         PIC X(09) VALUE 'MARCH    '.MLKRP054
00184          15  FPN-ENTRY03-DATA         PIC X(09) VALUE 'APRIL    '.MLKRP054
00185          15  FPN-ENTRY04-DATA         PIC X(09) VALUE 'MAY      '.MLKRP054
00186          15  FPN-ENTRY05-DATA         PIC X(09) VALUE 'JUNE     '.MLKRP054
00187          15  FPN-ENTRY06-DATA         PIC X(09) VALUE 'JULY     '.MLKRP054
00188          15  FPN-ENTRY07-DATA         PIC X(09) VALUE 'AUGUST   '.MLKRP054
00189          15  FPN-ENTRY08-DATA         PIC X(09) VALUE 'SEPTEMBER'.MLKRP054
00190          15  FPN-ENTRY09-DATA         PIC X(09) VALUE 'OCTOBER  '.MLKRP054
00191          15  FPN-ENTRY10-DATA         PIC X(09) VALUE 'NOVEMBER '.MLKRP054
00192          15  FPN-ENTRY11-DATA         PIC X(09) VALUE 'DECEMBER '.MLKRP054
00193          15  FPN-ENTRY12-DATA         PIC X(09) VALUE 'JANUARY  '.MLKRP054
00194                                                                   MLKRP054
00195  01  FPN-FSCL-PER-NAME-TABLE          REDEFINES                   MLKRP054
00196      FPN-FSCL-PER-NAME-TABLE-DATA.                                MLKRP054
00197      05  FPN-ENTRY                    OCCURS 12.                  MLKRP054
00198          10  FPN-FSCL-PER-NAME        PIC X(09).                  MLKRP054
00199                                                                   MLKRP054
00200  01  FPN-SUB-X.                                                   MLKRP054
00201      05  FPN-SUB                      PIC 9(02).                  MLKRP054
00202                                                                   MLKRP054
00203 ******************************************************************MLKRP054
00204 * THE FOLLOWING TABLE IS CREATED DURING STORE REPORT PROCESSING   MLKRP054
00205 * AND USED AS THE DRIVER FOR THE CORPORATE REPORT PROCESSING.     MLKRP054
00206 * IT HOLDS TOTALS BY TRANS-CDE WITHIN FIN-LIAB DATE. IT IS A      MLKRP054
00207 * 2-DIMENSIONAL TABLE. EACH ROW CORRESPONDS TO A DATE. EACH COLUMNMLKRP054
00208 * WITHIN THE ROW CORRESPONDS TO A PRE-DEFINED TRANS-CDE. THE      MLKRP054
00209 * TRANS-CDES ARE DEFINED IN A HARD-CODED TRANS-CDE TABLE          MLKRP054
00210 * (TCT-TRANS-CDE-TABLE). FOR EXAMPLE, IF THE 3RD ENTRY IN THE     MLKRP054
00211 * TRANS-CDE TABLE IS TRANS-CDE '030', THEN THE 3RD COLUMN IN      MLKRP054
00212 * THIS TABLE CONTAINS THE TOTALS FOR TRANS-CDE '030'. FOR THIS    MLKRP054
00213 * REASON, THE NUMBER OF TRANS-CDE ENTRIES IN THESE TWO TABLES     MLKRP054
00214 * MUST BE KEPT IN SYNCH.                                          MLKRP054
00215 ******************************************************************MLKRP054
00216  01  CRT-MAX-ENTRIES                  PIC S9(04)    VALUE +1200   MLKRP054
00217                                                     COMP SYNC.    MLKRP054
00218  01  CRT-SAVE-ENTRY                   PIC  X(465).                MLKRP054
00219  01  CRT-CORP-RPT-TABLE.                                          MLKRP054
00220 *    *------------------------------------------------------------MLKRP054
00221 *    *                    !!! NOTE !!!                            MLKRP054
00222 *    *------------------------------------------------------------MLKRP054
00223 *    * IF THE LENGTH OF AN ENTRY IN THIS TABLE (CRT-ENTRY) IS     MLKRP054
00224 *    * CHANGED, CRT-SAVE-ENTRY MUST BE CHANGED TO  ACCOMMODATE    MLKRP054
00225 *    * THE NEW LENGTH.                                            MLKRP054
00226 *    *                                                            MLKRP054
00227 *    * IF THE  NUMBER OF ENTRIES IS CHANGED, CRT-MAX-ENTRIES      MLKRP054
00228 *    * MUST BE CHANGED TO REFLECT THE CORRECT NUMBER OF ENTRIES.  MLKRP054
00229 *    *------------------------------------------------------------MLKRP054
00230      05  CRT-ENTRY                    OCCURS 1200                 MLKRP054
00231                                       INDEXED BY CRT-DT-IDX       MLKRP054
00232                                                  CRT-SRT-IDX1     MLKRP054
00233                                                  CRT-SRT-IDX2     MLKRP054
00234                                                  CRT-LST-IDX.     MLKRP054
00235          10  CRT-FIN-LIAB-DTE         PIC  X(10).                 MLKRP054
00236 *        *--------------------------------------------------------MLKRP054
00237 *        *                !!! NOTE !!!                            MLKRP054
00238 *        *--------------------------------------------------------MLKRP054
00239 *        * THE OCCURS FOR CRT-TRANS-CDE-DATA MUST MATCH THE OCCURSMLKRP054
00240 *        * FOR TCT-ENTRY IN TCT-TRANS-CDE-TABLE.                  MLKRP054
00241 *        *--------------------------------------------------------MLKRP054
21015 *****    10  CRT-TRANS-CDE-DATA       OCCURS   7                  MLKRP054
21015          10  CRT-TRANS-CDE-DATA       OCCURS   8                  MLKRP054
00243                                       INDEXED BY CRT-TC-IDX.      MLKRP054
00244              15  CRT-DATA-ENTERED-SW  PIC X.                      MLKRP054
00245                  88  CRT-DATA-ENTERED               VALUE 'Y'.    MLKRP054
00246                  88  CRT-NO-DATA-ENTERED            VALUE SPACE.  MLKRP054
00247              15  CRT-CURR-ML-COST     PIC S9(13)V99 COMP-3.       MLKRP054
00248              15  CRT-CURR-ML-RETAIL   PIC S9(13)V99 COMP-3.       MLKRP054
00249              15  CRT-CURR-INV-COST    PIC S9(13)V99 COMP-3.       MLKRP054
00250              15  CRT-CURR-INV-RETAIL  PIC S9(13)V99 COMP-3.       MLKRP054
00251              15  CRT-NEXT-ML-COST     PIC S9(13)V99 COMP-3.       MLKRP054
00252              15  CRT-NEXT-ML-RETAIL   PIC S9(13)V99 COMP-3.       MLKRP054
00253              15  CRT-NEXT-INV-COST    PIC S9(13)V99 COMP-3.       MLKRP054
00254              15  CRT-NEXT-INV-RETAIL  PIC S9(13)V99 COMP-3.       MLKRP054
00255                                                                   MLKRP054
00256  01  TCT-TRANS-CDE-TABLE-DATA.                                    MLKRP054
00257 *    *------------------------------------------------------------MLKRP054
00258 *    *                    !!! NOTE !!!                            MLKRP054
00259 *    *------------------------------------------------------------MLKRP054
00260 *    * IF ANY CHANGES ARE MADE TO THE FORMAT OR SIZE OF THIS      MLKRP054
00261 *    * HARD-CODED TABLE DATA, TCT-TRANS-CDE-TABLE MUST BE CHANGED MLKRP054
00262 *    * ACCORDINGLY.                                               MLKRP054
00263 *    *------------------------------------------------------------MLKRP054
00264      10  TCT-ENTRY1-DATA.                                         MLKRP054
21015 *****    15  FILLER                   PIC  X(02)    VALUE '10'.   MLKRP054
21015          15  FILLER                   PIC  X(04)    VALUE '10  '. MLKRP054
00266          15  FILLER                   PIC  X(15)    VALUE         MLKRP054
00267                                                   'PURCH ADJST'.  MLKRP054
00292                                                                   MLKRP054
21015      10  TCT-ENTRY8-DATA.                                         MLKRP054
21015          15  FILLER                   PIC  X(04)    VALUE '1008'. MLKRP054
21015          15  FILLER                   PIC  X(15)    VALUE         MLKRP054
21015                                                   'RECEIPTS   '.  MLKRP054
21015                                                                   MLKRP054
00268      10  TCT-ENTRY2-DATA.                                         MLKRP054
21015 *****    15  FILLER                   PIC  X(02)    VALUE '20'.   MLKRP054
21015          15  FILLER                   PIC  X(04)    VALUE '20  '. MLKRP054
00270          15  FILLER                   PIC  X(15)    VALUE         MLKRP054
00271                                                   'SALES'.        MLKRP054
00272      10  TCT-ENTRY3-DATA.                                         MLKRP054
21015 *****    15  FILLER                   PIC  X(02)    VALUE '30'.   MLKRP054
21015          15  FILLER                   PIC  X(04)    VALUE '30  '. MLKRP054
00274          15  FILLER                   PIC  X(15)    VALUE         MLKRP054
00275                                                   'TRANSFERS OUT'.MLKRP054
00276      10  TCT-ENTRY4-DATA.                                         MLKRP054
21015 *****    15  FILLER                   PIC  X(02)    VALUE '31'.   MLKRP054
21015          15  FILLER                   PIC  X(04)    VALUE '31  '. MLKRP054
00278          15  FILLER                   PIC  X(15)    VALUE         MLKRP054
00279                                                   'TRANSFERS IN'. MLKRP054
00280      10  TCT-ENTRY5-DATA.                                         MLKRP054
21015 *****    15  FILLER                   PIC  X(02)    VALUE '40'.   MLKRP054
21015          15  FILLER                   PIC  X(04)    VALUE '40  '. MLKRP054
00282          15  FILLER                   PIC  X(15)    VALUE         MLKRP054
00283                                                   'MARKDOWNS'.    MLKRP054
00284      10  TCT-ENTRY6-DATA.                                         MLKRP054
21015 *****    15  FILLER                   PIC  X(02)    VALUE '50'.   MLKRP054
21015          15  FILLER                   PIC  X(04)    VALUE '50  '. MLKRP054
00286          15  FILLER                   PIC  X(15)    VALUE         MLKRP054
00287                                                   'MARKUPS'.      MLKRP054
00288      10  TCT-ENTRY7-DATA.                                         MLKRP054
21015 *****    15  FILLER                   PIC  X(02)    VALUE '80'.   MLKRP054
21015          15  FILLER                   PIC  X(04)    VALUE '80  '. MLKRP054
00290          15  FILLER                   PIC  X(15)    VALUE         MLKRP054
00291                                                   'ADJUSTMENTS'.  MLKRP054
00293  01  TCT-TRANS-CDE-TABLE              REDEFINES                   MLKRP054
00294      TCT-TRANS-CDE-TABLE-DATA.                                    MLKRP054
00295 *    *------------------------------------------------------------MLKRP054
00296 *    *                !!! NOTE !!!                                MLKRP054
00297 *    *------------------------------------------------------------MLKRP054
00298 *    * THE OCCURS FOR TCT-ENTRY MUST MATCH THE OCCURS FOR         MLKRP054
00299 *    * CRT-TRANS-CDE-DATA.                                        MLKRP054
00300 *    *                                                            MLKRP054
00301 *    * IF ANY CHANGES ARE MADE TO THIS TABLE, THE HARD-CODED      MLKRP054
00302 *    * TABLE DATA (TCT-TRANS-CDE-TABLE-DATA) MUST BE CHANGED      MLKRP054
00303 *    * ACCORDINGLY.                                               MLKRP054
00304 *    *                                                            MLKRP054
00305 *    * IF THE  NUMBER OF ENTRIES IS CHANGED, TCT-MAX-ENTRIES      MLKRP054
00306 *    * MUST BE CHANGED TO REFLECT THE CORRECT NUMBER OF ENTRIES.  MLKRP054
00307 *    *------------------------------------------------------------MLKRP054
21015 *****05  TCT-ENTRY                    OCCURS   7                  MLKRP054
21015      05  TCT-ENTRY                    OCCURS   8                  MLKRP054
00309                                       INDEXED BY TCT-IDX.         MLKRP054
00310          10  TCT-TRANS-CDE            PIC  X(02).                 MLKRP054
21015          10  TCT-SYS-ORIG-CDE         PIC  X(02).                 MLKRP054
00311          10  TCT-TRANS-CDE-DESC       PIC  X(15).                 MLKRP054
00312                                                                   MLKRP054
21015 **1  TCT-MAX-ENTRIES                  PIC S9(04)    VALUE +7      MLKRP054
21015  01  TCT-MAX-ENTRIES                  PIC S9(04)    VALUE +8      MLKRP054
00314                                                     COMP SYNC.    MLKRP054
00315                                                                   MLKRP054
00316  01  ABEND-CODE                  PIC S9(04)  VALUE ZERO COMP SYNC.MLKRP054
00317                                                                   MLKRP054
00318 ***************************************************************** MLKRP054
00319 * EDIT-SPLIT-RECORD LAYOUT.                                       MLKRP054
00320 ***************************************************************** MLKRP054
00321                                                                   MLKRP054
00322      COPY MLRD025.                                                   CL**4
00323                                                                   MLKRP054
00324 ******************************************************************MLKRP054
00325 * STANDARD REPORT HEADING                                         MLKRP054
00326 ******************************************************************MLKRP054
00327                                                                   MLKRP054
00328      COPY DPWS200O.                                               MLKRP054
00329                                                                   MLKRP054
00330  01  HD-CP-CORP-HEADING.                                          MLKRP054
00331      05  FILLER                       PIC  X(85)    VALUE SPACE.  MLKRP054
00332      05  FILLER                       PIC  X(11)    VALUE         MLKRP054
00333                                                     'EDIT SPLIT '.MLKRP054
00334      05  FILLER                       PIC  X(11)    VALUE         MLKRP054
00335                                                     'TOTALS FOR '.MLKRP054
00336      05  FILLER                       PIC  X(10)    VALUE         MLKRP054
00337                                                      'ALL STORES'.MLKRP054
00338      05  FILLER                       PIC  X        VALUE SPACE.  MLKRP054
00339      05  HD-CP-PROCESSING-MODE        PIC  X(20)    VALUE SPACE.  MLKRP054
00340                                                                   MLKRP054
00341  01  HD-ST-STORE-HEADING.                                         MLKRP054
00342      05  FILLER                       PIC  X(78)    VALUE SPACE.  MLKRP054
00343      05  FILLER                       PIC  X(11)    VALUE         MLKRP054
00344                                                     'EDIT SPLIT '.MLKRP054
00345      05  FILLER                       PIC  X(11)    VALUE         MLKRP054
00346                                                     'TOTALS FOR '.MLKRP054
00347      05  FILLER                       PIC  X(06)    VALUE         MLKRP054
00348                                                          'STORE '.MLKRP054
W26603     05  HD-ST-STORE-NBR              PIC  X(05).                 MLKRP054
00350      05  FILLER                       PIC  X        VALUE SPACE.  MLKRP054
00351      05  HD-ST-STORE-NAME             PIC  X(25).                 MLKRP054
00352      05  FILLER                       PIC  X        VALUE SPACE.  MLKRP054
00353      05  HD-ST-PROCESSING-MODE        PIC  X(20)    VALUE SPACE.  MLKRP054
00354                                                                   MLKRP054
00355  01  HD-FT-FINAL-TOTAL-HEADING.                                   MLKRP054
00356      05  FILLER                       PIC  X(87)    VALUE SPACE.  MLKRP054
00357      05  FILLER                       PIC  X(11)    VALUE         MLKRP054
00358                                                     'EDIT SPLIT '.MLKRP054
00359      05  FILLER                       PIC  X(12)    VALUE         MLKRP054
00360                                                    'FINAL TOTALS'.MLKRP054
00361      05  FILLER                       PIC  X        VALUE SPACE.  MLKRP054
00362      05  HD-FT-PROCESSING-MODE        PIC  X(20)    VALUE SPACE.  MLKRP054
00363                                                                   MLKRP054
00364  01  HD-ED-EDIT-DATE-HEADING.                                     MLKRP054
00365      05  FILLER                       PIC  X(92)    VALUE SPACE.  MLKRP054
00366      05  FILLER                       PIC  X(03)    VALUE 'FOR'.  MLKRP054
00367      05  FILLER                       PIC  X        VALUE SPACE.  MLKRP054
00368      05  HD-ED-DATE.                                              MLKRP054
00369          15  HD-ED-DATE-MM            PIC  X(02).                 MLKRP054
00370          15  FILLER                   PIC  X        VALUE '/'.    MLKRP054
00371          15  HD-ED-DATE-DD            PIC  X(02).                 MLKRP054
00372          15  FILLER                   PIC  X        VALUE '/'.    MLKRP054
00373          15  HD-ED-DATE-YY            PIC  X(02).                 MLKRP054
00374                                                                   MLKRP054
00375  01  HD-FP-FISCAL-PER-HEADING.                                    MLKRP054
00376      05  FILLER                       PIC  X(11)    VALUE SPACE.  MLKRP054
00377      05  FILLER                       PIC  X(32)    VALUE ALL '-'.MLKRP054
00378      05  FILLER                       PIC  X        VALUE SPACE.  MLKRP054
00379      05  HD-FP-CURR-FISC-PERIOD-NAME  PIC  X(09).                 MLKRP054
00380      05  FILLER                       PIC  X(41)    VALUE ALL '-'.MLKRP054
00381      05  FILLER                       PIC  X(02)    VALUE SPACE.  MLKRP054
00382      05  FILLER                       PIC  X(29)    VALUE ALL '-'.MLKRP054
00383      05  FILLER                       PIC  X        VALUE SPACE.  MLKRP054
00384      05  HD-FP-NEXT-FISC-PERIOD-NAME  PIC  X(09).                 MLKRP054
00385      05  FILLER                       PIC  X(45)    VALUE ALL '-'.MLKRP054
00386                                                                   MLKRP054
00387  01  HD-MI-ML-INV-HEADING.                                        MLKRP054
00388      05  FILLER                       PIC  X(20)    VALUE SPACE.  MLKRP054
00389      05  FILLER                       PIC  X(18)    VALUE         MLKRP054
00390                                              'MERCHANDISE LEDGER'.MLKRP054
00391      05  FILLER                       PIC  X(23)    VALUE SPACE.  MLKRP054
00392      05  FILLER                       PIC  X(16)    VALUE         MLKRP054
00393                                                'INVENTORY LEDGER'.MLKRP054
00394      05  FILLER                       PIC  X(23)    VALUE SPACE.  MLKRP054
00395      05  FILLER                       PIC  X(18)    VALUE         MLKRP054
00396                                              'MERCHANDISE LEDGER'.MLKRP054
00397      05  FILLER                       PIC  X(26)    VALUE SPACE.  MLKRP054
00398      05  FILLER                       PIC  X(16)    VALUE         MLKRP054
00399                                                'INVENTORY LEDGER'.MLKRP054
00400  01  HD-CL-COLUMN-HEADING.                                        MLKRP054
00401      05  FILLER                       PIC  X        VALUE SPACE.  MLKRP054
00402      05  HD-CL-EFF-DATE-HD-LIT        PIC  X(08)    VALUE SPACE.  MLKRP054
00403      05  FILLER                       PIC  X(08)    VALUE SPACE.  MLKRP054
00404      05  FILLER                       PIC  X(04)    VALUE 'COST'. MLKRP054
00405      05  FILLER                       PIC  X(15)    VALUE SPACE.  MLKRP054
00406      05  FILLER                       PIC  X(06)    VALUE         MLKRP054
00407                                                          'RETAIL'.MLKRP054
00408      05  FILLER                       PIC  X(15)    VALUE SPACE.  MLKRP054
00409      05  FILLER                       PIC  X(04)    VALUE 'COST'. MLKRP054
00410      05  FILLER                       PIC  X(16)    VALUE SPACE.  MLKRP054
00411      05  FILLER                       PIC  X(06)    VALUE         MLKRP054
00412                                                          'RETAIL'.MLKRP054
00413      05  FILLER                       PIC  X(13)    VALUE SPACE.  MLKRP054
00414      05  FILLER                       PIC  X(04)    VALUE 'COST'. MLKRP054
00415      05  FILLER                       PIC  X(17)    VALUE SPACE.  MLKRP054
00416      05  FILLER                       PIC  X(06)    VALUE         MLKRP054
00417                                                          'RETAIL'.MLKRP054
00418      05  FILLER                       PIC  X(17)    VALUE SPACE.  MLKRP054
00419      05  FILLER                       PIC  X(04)    VALUE 'COST'. MLKRP054
00420      05  FILLER                       PIC  X(14)    VALUE SPACE.  MLKRP054
00421      05  FILLER                       PIC  X(06)    VALUE         MLKRP054
00422                                                          'RETAIL'.MLKRP054
00423                                                                   MLKRP054
00424  01  HD-TC-TRANS-CDE-HEADING.                                     MLKRP054
00425      05  HD-TC-TRANS-CDE-DESC         PIC  X(15).                 MLKRP054
00426                                                                   MLKRP054
00427  01  DL-DETAIL-LINE.                                              MLKRP054
00428      05  FILLER                       PIC  X        VALUE SPACE.  MLKRP054
00429      05  DL-EFF-DATE.                                             MLKRP054
00430          10  DL-EFF-DATE-MM           PIC  X(02).                 MLKRP054
00431          10  FILLER                   PIC  X        VALUE '/'.    MLKRP054
00432          10  DL-EFF-DATE-DD           PIC  X(02).                 MLKRP054
00433          10  FILLER                   PIC  X        VALUE '/'.    MLKRP054
00434          10  DL-EFF-DATE-YY           PIC  X(02).                 MLKRP054
00435      05  FILLER                       PIC  X(07)    VALUE SPACE.  MLKRP054
00436      05  DL-CURR-ML-COST              PIC  ZZZ,ZZZ,ZZZ.99-.       MLKRP054
00437      05  FILLER                       PIC  X(05)    VALUE SPACE.  MLKRP054
00438      05  DL-CURR-ML-RETAIL            PIC  ZZZ,ZZZ,ZZZ.99-.       MLKRP054
00439      05  FILLER                       PIC  X(06)    VALUE SPACE.  MLKRP054
00440      05  DL-CURR-INV-COST             PIC ZZZ,ZZZ,ZZZ.99-.        MLKRP054
00441      05  FILLER                       PIC  X(06)    VALUE SPACE.  MLKRP054
00442      05  DL-CURR-INV-RETAIL           PIC ZZZ,ZZZ,ZZZ.99-.        MLKRP054
00443      05  FILLER                       PIC  X(06)    VALUE SPACE.  MLKRP054
00444      05  DL-NEXT-ML-COST              PIC ZZZ,ZZZ,ZZZ.99-.        MLKRP054
00445      05  FILLER                       PIC  X(07)    VALUE SPACE.  MLKRP054
00446      05  DL-NEXT-ML-RETAIL            PIC ZZZ,ZZZ,ZZZ.99-.        MLKRP054
00447      05  FILLER                       PIC  X(06)    VALUE SPACE.  MLKRP054
00448      05  DL-NEXT-INV-COST             PIC ZZZ,ZZZ,ZZZ.99-.        MLKRP054
00449      05  FILLER                       PIC  X(07)    VALUE SPACE.  MLKRP054
00450      05  DL-NEXT-INV-RETAIL           PIC ZZZ,ZZZ,ZZZ.99-.        MLKRP054
00451                                                                   MLKRP054
00452  01  TL-TC1-TRANS-CDE-TOTAL-LINE-1.                               MLKRP054
00453      05  FILLER                       PIC  X        VALUE SPACE.  MLKRP054
00454      05  TL-TC1-TRANS-CDE-DESC        PIC  X(15).                 MLKRP054
00455                                                                   MLKRP054
00456  01  TL-TC2-TRANS-CDE-TOTAL-LINE-2.                               MLKRP054
00457      05  FILLER                       PIC  X        VALUE SPACE.  MLKRP054
00458      05  FILLER                       PIC  X(11)    VALUE 'TOTAL'.MLKRP054
00459      05  TL-TC2-CURR-ML-COST          PIC  ZZZ,ZZZ,ZZZ,ZZZ.99-.   MLKRP054
00460      05  FILLER                       PIC  X        VALUE SPACE.  MLKRP054
00461      05  TL-TC2-CURR-ML-RETAIL        PIC  ZZZ,ZZZ,ZZZ,ZZZ.99-.   MLKRP054
00462      05  FILLER                       PIC  X(02)    VALUE SPACE.  MLKRP054
00463      05  TL-TC2-CURR-INV-COST         PIC  ZZZ,ZZZ,ZZZ,ZZZ.99-.   MLKRP054
00464      05  FILLER                       PIC  X(02)    VALUE SPACE.  MLKRP054
00465      05  TL-TC2-CURR-INV-RETAIL       PIC  ZZZ,ZZZ,ZZZ,ZZZ.99-.   MLKRP054
00466      05  FILLER                       PIC  X(02)    VALUE SPACE.  MLKRP054
00467      05  TL-TC2-NEXT-ML-COST          PIC  ZZZ,ZZZ,ZZZ,ZZZ.99-.   MLKRP054
00468      05  FILLER                       PIC  X(03)    VALUE SPACE.  MLKRP054
00469      05  TL-TC2-NEXT-ML-RETAIL        PIC  ZZZ,ZZZ,ZZZ,ZZZ.99-.   MLKRP054
00470      05  FILLER                       PIC  X(02)    VALUE SPACE.  MLKRP054
00471      05  TL-TC2-NEXT-INV-COST         PIC  ZZZ,ZZZ,ZZZ,ZZZ.99-.   MLKRP054
00472      05  FILLER                       PIC  X(03)    VALUE SPACE.  MLKRP054
00473      05  TL-TC2-NEXT-INV-RETAIL       PIC  ZZZ,ZZZ,ZZZ,ZZZ.99-.   MLKRP054
00474                                                                   MLKRP054
00475  01  TL-ST1-STORE-TOTAL-LINE-1.                                   MLKRP054
00476      05  FILLER                       PIC  X        VALUE SPACE.  MLKRP054
00477      05  FILLER                       PIC  X(05)    VALUE 'STORE'.MLKRP054
00478      05  FILLER                       PIC  X        VALUE SPACE.  MLKRP054
W26603     05  TL-ST1-STORE-NBR             PIC  X(05).                 MLKRP054
00480                                                                   MLKRP054
00481  01  TL-ST2-STORE-TOTAL-LINE-2.                                   MLKRP054
00482      05  FILLER                       PIC  X        VALUE SPACE.  MLKRP054
00483      05  FILLER                       PIC  X(11)    VALUE 'TOTAL'.MLKRP054
00484      05  TL-ST2-CURR-ML-COST          PIC  ZZZ,ZZZ,ZZZ,ZZZ.99-.   MLKRP054
00485      05  FILLER                       PIC  X        VALUE SPACE.  MLKRP054
00486      05  TL-ST2-CURR-ML-RETAIL        PIC  ZZZ,ZZZ,ZZZ,ZZZ.99-.   MLKRP054
00487      05  FILLER                       PIC  X(02)    VALUE SPACE.  MLKRP054
00488      05  TL-ST2-CURR-INV-COST         PIC  ZZZ,ZZZ,ZZZ,ZZZ.99-.   MLKRP054
00489      05  FILLER                       PIC  X(02)    VALUE SPACE.  MLKRP054
00490      05  TL-ST2-CURR-INV-RETAIL       PIC  ZZZ,ZZZ,ZZZ,ZZZ.99-.   MLKRP054
00491      05  FILLER                       PIC  X(02)    VALUE SPACE.  MLKRP054
00492      05  TL-ST2-NEXT-ML-COST          PIC  ZZZ,ZZZ,ZZZ,ZZZ.99-.   MLKRP054
00493      05  FILLER                       PIC  X(03)    VALUE SPACE.  MLKRP054
00494      05  TL-ST2-NEXT-ML-RETAIL        PIC  ZZZ,ZZZ,ZZZ,ZZZ.99-.   MLKRP054
00495      05  FILLER                       PIC  X(02)    VALUE SPACE.  MLKRP054
00496      05  TL-ST2-NEXT-INV-COST         PIC  ZZZ,ZZZ,ZZZ,ZZZ.99-.   MLKRP054
00497      05  FILLER                       PIC  X(03)    VALUE SPACE.  MLKRP054
00498      05  TL-ST2-NEXT-INV-RETAIL       PIC  ZZZ,ZZZ,ZZZ,ZZZ.99-.   MLKRP054
00499                                                                   MLKRP054
00500  01  TL-FN1-FINAL-TOTAL-LINE-1.                                   MLKRP054
00501      05  FILLER                       PIC  X        VALUE SPACE.  MLKRP054
00502      05  FILLER                       PIC  X(05)    VALUE 'FINAL'.MLKRP054
00503                                                                   MLKRP054
00504  01  TL-FN2-FINAL-TOTAL-LINE-2.                                   MLKRP054
00505      05  FILLER                       PIC  X        VALUE SPACE.  MLKRP054
00506      05  FILLER                       PIC  X(11)    VALUE 'TOTAL'.MLKRP054
00507      05  TL-FN2-CURR-ML-COST          PIC  ZZZ,ZZZ,ZZZ,ZZZ.99-.   MLKRP054
00508      05  FILLER                       PIC  X        VALUE SPACE.  MLKRP054
00509      05  TL-FN2-CURR-ML-RETAIL        PIC  ZZZ,ZZZ,ZZZ,ZZZ.99-.   MLKRP054
00510      05  FILLER                       PIC  X(02)    VALUE SPACE.  MLKRP054
00511      05  TL-FN2-CURR-INV-COST         PIC  ZZZ,ZZZ,ZZZ,ZZZ.99-.   MLKRP054
00512      05  FILLER                       PIC  X(02)    VALUE SPACE.  MLKRP054
00513      05  TL-FN2-CURR-INV-RETAIL       PIC  ZZZ,ZZZ,ZZZ,ZZZ.99-.   MLKRP054
00514      05  FILLER                       PIC  X(02)    VALUE SPACE.  MLKRP054
00515      05  TL-FN2-NEXT-ML-COST          PIC  ZZZ,ZZZ,ZZZ,ZZZ.99-.   MLKRP054
00516      05  FILLER                       PIC  X(03)    VALUE SPACE.  MLKRP054
00517      05  TL-FN2-NEXT-ML-RETAIL        PIC  ZZZ,ZZZ,ZZZ,ZZZ.99-.   MLKRP054
00518      05  FILLER                       PIC  X(02)    VALUE SPACE.  MLKRP054
00519      05  TL-FN2-NEXT-INV-COST         PIC  ZZZ,ZZZ,ZZZ,ZZZ.99-.   MLKRP054
00520      05  FILLER                       PIC  X(03)    VALUE SPACE.  MLKRP054
00521      05  TL-FN2-NEXT-INV-RETAIL       PIC  ZZZ,ZZZ,ZZZ,ZZZ.99-.   MLKRP054
00522                                                                   MLKRP054
00523  01  ER-END-OF-REPORT-LINE.                                       MLKRP054
00524      05  FILLER                       PIC  X(21)    VALUE         MLKRP054
00525                                           '*** END OF REPORT ***'.MLKRP054
00526                                                                   MLKRP054
00527 ***************************************************************** MLKRP054
00528 *  SQL ABEND ROUTINE WORKING STORAGE                              MLKRP054
00529 ***************************************************************** MLKRP054
00530                                                                   MLKRP054
00531      COPY DPWS004.                                                MLKRP054
00532                                                                   MLKRP054
00533 ***************************************************************** MLKRP054
00534 * DB2 STORE TABLE DCLGEN.                                         MLKRP054
00535 ***************************************************************** MLKRP054
00536                                                                   MLKRP054
00537      EXEC SQL                                                     MLKRP054
W26603         INCLUDE XMT00001                                         MLKRP054
00539      END-EXEC.                                                    MLKRP054
00540                                                                   MLKRP054
00541      EXEC SQL                                                     MLKRP054
00542          INCLUDE SQLCA                                            MLKRP054
00543      END-EXEC.                                                    MLKRP054
00544                                                                   MLKRP054
00545  LINKAGE SECTION.                                                 MLKRP054
00546                                                                   MLKRP054
00547                                                                   MLKRP054
00548  PROCEDURE DIVISION.                                              MLKRP054
00549                                                                   MLKRP054
00550  A100-MAIN-MODULE.                                                MLKRP054
00551                                                                   MLKRP054
00552      OPEN INPUT  EDIT-SPLIT-FILE                                  MLKRP054
00553           OUTPUT STORE-SPLIT-REPORT.                              MLKRP054
00554                                                                   MLKRP054
00555      PERFORM B100-PROCESS-CONTROL-CARD.                           MLKRP054
00556                                                                   MLKRP054
00557      SET SW-PROCESSING-STORE-REPORT TO TRUE.                      MLKRP054
00558      PERFORM B200-S-CREATE-REPORT.                                MLKRP054
00559                                                                   MLKRP054
00560      CLOSE EDIT-SPLIT-FILE                                        MLKRP054
00561            STORE-SPLIT-REPORT.                                    MLKRP054
00562                                                                   MLKRP054
00563      OPEN OUTPUT CORP-SPLIT-REPORT.                               MLKRP054
00564                                                                   MLKRP054
00565      SET SW-PROCESSING-CORP-REPORT TO TRUE.                       MLKRP054
00566      PERFORM B200-C-CREATE-REPORT.                                MLKRP054
00567                                                                   MLKRP054
00568      CLOSE CORP-SPLIT-REPORT.                                     MLKRP054
00569                                                                   MLKRP054
00570      STOP RUN.                                                    MLKRP054
00571                                                                   MLKRP054
00572                                                                   MLKRP054
00573 ******************************************************************MLKRP054
00574 * MAKE SURE THAT THE EDIT-SPLIT FILE CONTAINS A CONTROL CARD AS   MLKRP054
00575 * THE FIRST RECORD. IF THE CONTROL CARD IS PRESENT, USE ITS       MLKRP054
00576 * FIELDS TO BUILD SOME OF THE HEADING FIELDS.                     MLKRP054
00577 ******************************************************************MLKRP054
00578  B100-PROCESS-CONTROL-CARD.                                       MLKRP054
00579                                                                   MLKRP054
00580      MOVE 'B100-PROCESS-CONTROL-CARD' TO PV-PARAGRAPH-NAME.       MLKRP054
00581                                                                   MLKRP054
00582      PERFORM Z100-READ-EDIT-SPLIT-FILE.                           MLKRP054
00583                                                                   MLKRP054
00584      IF SW-END-OF-EDIT-SPLIT-FILE                                 MLKRP054
00585          MOVE 'NO CONTROL CARD ON EDIT-SPLIT-FILE'                MLKRP054
00586                     TO PV-ABEND-MESSAGE                           MLKRP054
00587          MOVE SPACE TO EDIT-SPLIT-RECORD                          MLKRP054
00588          MOVE +4003 TO ABEND-CODE                                 MLKRP054
00589          PERFORM Z999-ABEND                                       MLKRP054
00590      ELSE                                                         MLKRP054
00591          IF NOT ML025-RPT1-CNTL-CARD-HDR-REC                      MLKRP054
00592              MOVE '1ST RECORD ON EDIT-SPLIT-FILE NOT CONTROL CARD'MLKRP054
00593                         TO PV-ABEND-MESSAGE                       MLKRP054
00594              MOVE +4003 TO ABEND-CODE                             MLKRP054
00595              PERFORM Z999-ABEND                                   MLKRP054
00596          ELSE                                                     MLKRP054
00597              PERFORM UNTIL ML025-RPT1-DETAIL-REC                  MLKRP054
00598                         OR SW-END-OF-EDIT-SPLIT-FILE              MLKRP054
00599                  MOVE ML025-RPT1-CNTL-CARD-RECORD                 MLKRP054
00600                                     TO PV-LAST-CNTL-CARD-READ     MLKRP054
00601                  MOVE ML025-RPT1-EDIT-DTE      TO PV-ISO-FMT-DATE MLKRP054
00602                  MOVE PV-ISO-FMT-MM            TO HD-ED-DATE-MM   MLKRP054
00603                  MOVE PV-ISO-FMT-DD            TO HD-ED-DATE-DD   MLKRP054
00604                  MOVE PV-ISO-FMT-YY            TO HD-ED-DATE-YY   MLKRP054
00605                  MOVE ML025-RPT1-CURR-FSCL-YR-PER                 MLKRP054
00606                                    TO SA-CURR-FSCL-YR-PER         MLKRP054
00607                  MOVE ML025-RPT1-CURR-FSCL-PER-CDE                MLKRP054
00608                                    TO FPN-SUB-X                   MLKRP054
00609                  MOVE FPN-FSCL-PER-NAME (FPN-SUB)                 MLKRP054
00610                                    TO HD-FP-CURR-FISC-PERIOD-NAME MLKRP054
00611                  MOVE ML025-RPT1-NEXT-FSCL-PER-CDE                MLKRP054
00612                                    TO FPN-SUB-X                   MLKRP054
00613                  MOVE FPN-FSCL-PER-NAME (FPN-SUB)                 MLKRP054
00614                                    TO HD-FP-NEXT-FISC-PERIOD-NAME MLKRP054
00615                  IF ML025-RPT1-MODE-INV-ONLY                         CL**2
00616                      MOVE PC-INVENTORY-ONLY-MODE                     CL**2
00617                                    TO HD-CP-PROCESSING-MODE          CL**2
00618                                       HD-ST-PROCESSING-MODE          CL**2
00619                                       HD-FT-PROCESSING-MODE          CL**2
00620                  END-IF                                              CL**2
00621                  PERFORM Z100-READ-EDIT-SPLIT-FILE                MLKRP054
00622              END-PERFORM                                          MLKRP054
00623              DISPLAY '** MLKRP054 INPUT CONTROL CARD ='           MLKRP054
00624                       PV-LAST-CNTL-CARD-READ                      MLKRP054
00625          END-IF                                                   MLKRP054
00626      END-IF.                                                      MLKRP054
00627                                                                   MLKRP054
00628                                                                   MLKRP054
00629 ******************************************************************MLKRP054
00630 * CREATE THE STORE EDIT SPLIT REPORT BY FINANCIAL LIABILITY DATE  MLKRP054
00631 * WITHIN TRANSACTION CODE WITHIN STORE. THIS REPORT IS CREATED    MLKRP054
00632 * FROM THE INPUT FILE.                                            MLKRP054
00633 ******************************************************************MLKRP054
00634  B200-S-CREATE-REPORT.                                            MLKRP054
00635                                                                   MLKRP054
00636      PERFORM C200-S-INITIALIZATION.                               MLKRP054
00637      PERFORM Z300-S-PRINT-STD-RPT-HEADING.                        MLKRP054
00638                                                                   MLKRP054
00639      IF SW-NOT-END-OF-EDIT-SPLIT-FILE                             MLKRP054
00640          MOVE ML025-RPT1-FIN-LIAB-DTE  TO SA-PREV-FIN-LIAB-DTE    MLKRP054
00641          MOVE ML025-RPT1-TRANS-CDE     TO SA-PREV-TRANS-CDE       MLKRP054
21015          MOVE ML025-RPT1-SYST-ORIG-CDE TO SA-PREV-SYST-ORIG-CDE   MLKRP054
00642          MOVE ML025-RPT1-STORE-NBR     TO SA-PREV-STORE-NBR       MLKRP054
00643          MOVE ML025-RPT1-STORE-NBR     TO HD-ST-STORE-NBR         MLKRP054
00644                                           TL-ST1-STORE-NBR        MLKRP054
W26603         PERFORM Z600-READ-XMTLOC                                 MLKRP054
W26603         MOVE XMT00001-LOC-NM          TO HD-ST-STORE-NAME        MLKRP054
00647                                                                   MLKRP054
00648          PERFORM Z350-S-PRINT-STORE-HEADING                       MLKRP054
00649          PERFORM Z400-S-PRINT-CONSTANT-HEADINGS                   MLKRP054
00650          PERFORM Z500-PRINT-TRANS-CDE-HEADING                     MLKRP054
00651                                                                   MLKRP054
00652          IF ML025-RPT1-FSCL-YR-PER > SA-CURR-FSCL-YR-PER          MLKRP054
00653              SET SW-NEXT-FISC-PER TO TRUE                         MLKRP054
00654          ELSE                                                     MLKRP054
00655              SET SW-CURR-FISC-PER TO TRUE                         MLKRP054
00656          END-IF                                                   MLKRP054
00657                                                                   MLKRP054
00658          PERFORM C300-S-PROCESS-EDIT-SPLIT-FILE                   MLKRP054
00659              UNTIL SW-END-OF-EDIT-SPLIT-FILE                      MLKRP054
00660                                                                   MLKRP054
00661          PERFORM D200-S-FIN-LIAB-BREAK                            MLKRP054
00662          PERFORM D300-S-TRANS-CDE-BREAK                           MLKRP054
00663          PERFORM D400-S-STORE-NBR-BREAK                           MLKRP054
00664          MOVE SPACE TO HD-ST-STORE-NBR                            MLKRP054
00665                        HD-ST-STORE-NAME                           MLKRP054
00666          PERFORM C400-S-PRINT-FINAL-TOTALS                        MLKRP054
00667      ELSE                                                         MLKRP054
00668          SET SW-EMPTY-EDIT-SPLIT-FILE TO TRUE                     MLKRP054
00669      END-IF.                                                      MLKRP054
00670                                                                   MLKRP054
00671      MOVE ER-END-OF-REPORT-LINE TO STORE-SPLIT-REPORT-LINE.       MLKRP054
00672      MOVE 3 TO PV-ADVANCE.                                        MLKRP054
00673      PERFORM Z200-S-WRITE-REPORT-LINE.                            MLKRP054
00674                                                                   MLKRP054
00675                                                                   MLKRP054
00676                                                                   MLKRP054
00677 ******************************************************************MLKRP054
00678 * CREATE THE CORPORATE EDIT SPLIT REPORT BY FINANCIAL LIABILITY   MLKRP054
00679 * DATE WITHIN TRANSACTION CODE. THIS REPORT IS CREATED FROM A     MLKRP054
00680 * WORKING STORAGE TABLE CREATED DURING STORE REPORT PROCESSING.   MLKRP054
00681 ******************************************************************MLKRP054
00682  B200-C-CREATE-REPORT.                                            MLKRP054
00683                                                                   MLKRP054
00684      PERFORM C200-C-INITIALIZATION.                               MLKRP054
00685      PERFORM Z300-C-PRINT-STD-RPT-HEADING.                        MLKRP054
00686      IF SW-NOT-EMPTY-EDIT-SPLIT-FILE                              MLKRP054
00687          PERFORM Z360-C-PRINT-CORP-HEADING                        MLKRP054
00688          PERFORM Z400-C-PRINT-CONSTANT-HEADINGS                   MLKRP054
00689          PERFORM C335-C-SORT-REPORT-TABLE                         MLKRP054
00690          PERFORM C340-C-PROCESS-REPORT-TABLE                      MLKRP054
00691          PERFORM C400-C-PRINT-FINAL-TOTALS                        MLKRP054
00692      END-IF.                                                      MLKRP054
00693                                                                   MLKRP054
00694      MOVE ER-END-OF-REPORT-LINE TO CORP-SPLIT-REPORT-LINE.        MLKRP054
00695      MOVE 3 TO PV-ADVANCE.                                        MLKRP054
00696      PERFORM Z200-C-WRITE-REPORT-LINE.                            MLKRP054
00697                                                                   MLKRP054
00698                                                                   MLKRP054
00699 ******************************************************************MLKRP054
00700 * INITIALIZE FIELDS AS NECESSARY FOR THE STORE SPLIT REPORT.     *MLKRP054
00701 ******************************************************************MLKRP054
00702  C200-S-INITIALIZATION.                                           MLKRP054
00703                                                                   MLKRP054
00704      INITIALIZE CRT-CORP-RPT-TABLE                                MLKRP054
00705                 PV-PAGE-COUNT                                     MLKRP054
00706                 TOT-TOTAL-FIELDS.                                 MLKRP054
00707                                                                   MLKRP054
00708      SET SW-NOT-EMPTY-EDIT-SPLIT-FILE                             MLKRP054
00709          SW-NOT-STORE-BREAK                                       MLKRP054
00710          SW-NOT-TRANS-CDE-BREAK                                   MLKRP054
00711          SW-NOT-END-OF-CORP-RPT-TABLE  TO TRUE.                   MLKRP054
00712                                                                   MLKRP054
00713      ACCEPT PV-YYMMDD-DATE FROM DATE.                             MLKRP054
00714      MOVE   PV-YYMMDD-YY TO DP200O-RUN-YEAR.                      MLKRP054
00715      MOVE   PV-YYMMDD-MM TO DP200O-RUN-MONTH.                     MLKRP054
00716      MOVE   PV-YYMMDD-DD TO DP200O-RUN-DAY.                       MLKRP054
00717      ACCEPT PV-TIME-HHMMSS FROM TIME.                             MLKRP054
00718      MOVE PV-TIME-HHMMSS-HH   TO DP200O-RUN-HOUR.                 MLKRP054
00719      MOVE PV-TIME-HHMMSS-MM   TO DP200O-RUN-MINUTE.               MLKRP054
00720      MOVE 'MLKRP054'          TO DP200O-PROGRAM-NAME.             MLKRP054
00721      MOVE 1 TO DP200O-REPORT-NUMBER.                              MLKRP054
00722                                                                   MLKRP054
00723      MOVE PC-EFF-DATE-HD-LIT   TO HD-CL-EFF-DATE-HD-LIT.          MLKRP054
00724                                                                   MLKRP054
00725                                                                   MLKRP054
00726 ******************************************************************MLKRP054
00727 * INITIALIZE FIELDS AS NECESSARY FOR THE CORPORATE SPLIT REPORT. *MLKRP054
00728 ******************************************************************MLKRP054
00729  C200-C-INITIALIZATION.                                           MLKRP054
00730                                                                   MLKRP054
00731      INITIALIZE PV-PAGE-COUNT                                     MLKRP054
00732                 TOT-TOTAL-FIELDS.                                 MLKRP054
00733      MOVE PC-EFF-DATE-HD-LIT        TO HD-CL-EFF-DATE-HD-LIT.     MLKRP054
00734      MOVE 2 TO DP200O-REPORT-NUMBER.                              MLKRP054
00735                                                                   MLKRP054
00736                                                                   MLKRP054
00737 ******************************************************************MLKRP054
00738 * READ AND PROCESS THE INPUT FILE. BEFORE EACH RECORD IS         *MLKRP054
00739 * PROCESSED, CHECK FOR CONTROL BREAKS, AND DO ANY NECESSARY      *MLKRP054
00740 * CONTROL BREAK PROCESSING.                                      *MLKRP054
00741 ******************************************************************MLKRP054
00742  C300-S-PROCESS-EDIT-SPLIT-FILE.                                  MLKRP054
00743                                                                   MLKRP054
00744      IF ML025-RPT1-STORE-NBR NOT = SA-PREV-STORE-NBR              MLKRP054
00745          PERFORM D200-S-FIN-LIAB-BREAK                            MLKRP054
00746          PERFORM D300-S-TRANS-CDE-BREAK                           MLKRP054
00747          PERFORM D400-S-STORE-NBR-BREAK                           MLKRP054
00748          SET SW-STORE-BREAK TO TRUE                               MLKRP054
00749      ELSE                                                         MLKRP054
00750          IF ML025-RPT1-TRANS-CDE NOT = SA-PREV-TRANS-CDE          MLKRP054
21015          OR ML025-RPT1-SYST-ORIG-CDE NOT = SA-PREV-SYST-ORIG-CDE  MLKRP054
00751              PERFORM D200-S-FIN-LIAB-BREAK                        MLKRP054
00752              PERFORM D300-S-TRANS-CDE-BREAK                       MLKRP054
00753              SET SW-TRANS-CDE-BREAK TO TRUE                       MLKRP054
00754          ELSE                                                     MLKRP054
00755              IF ML025-RPT1-FIN-LIAB-DTE NOT = SA-PREV-FIN-LIAB-DTEMLKRP054
00756                  PERFORM D200-S-FIN-LIAB-BREAK                    MLKRP054
00757              END-IF                                               MLKRP054
00758          END-IF                                                   MLKRP054
00759      END-IF.                                                      MLKRP054
00760                                                                   MLKRP054
00761      PERFORM D500-S-PROCESS-EDIT-SPLIT-REC.                       MLKRP054
00762      PERFORM Z100-READ-EDIT-SPLIT-FILE.                           MLKRP054
00763                                                                   MLKRP054
00764                                                                   MLKRP054
00765 ******************************************************************MLKRP054
00766 * SORT THE CORPORATE REPORT TABLE INTO FINANCIAL LIABILITY DATE  *MLKRP054
00767 * SEQUENCE.                                                       MLKRP054
00768 ******************************************************************MLKRP054
00769  C335-C-SORT-REPORT-TABLE.                                        MLKRP054
00770                                                                   MLKRP054
00771 *    *------------------------------------------------------------MLKRP054
00772 *    * FIND THE LAST ENTRY IN THE TABLE.                          MLKRP054
00773 *    *------------------------------------------------------------MLKRP054
00774      SET CRT-LST-IDX TO 1.                                        MLKRP054
00775      SEARCH CRT-ENTRY                                             MLKRP054
00776          VARYING CRT-LST-IDX                                      MLKRP054
00777          AT END                                                   MLKRP054
00778              SET CRT-LST-IDX TO CRT-MAX-ENTRIES                   MLKRP054
00779          WHEN CRT-FIN-LIAB-DTE (CRT-LST-IDX) = SPACE              MLKRP054
00780              IF CRT-LST-IDX = 1                                   MLKRP054
00781                  CONTINUE                                         MLKRP054
00782              ELSE                                                 MLKRP054
00783                  SET CRT-LST-IDX DOWN BY 1                        MLKRP054
00784              END-IF                                               MLKRP054
00785      END-SEARCH.                                                  MLKRP054
00786                                                                   MLKRP054
00787 *    *------------------------------------------------------------MLKRP054
00788 *    * SORT THE ENTRIES.                                          MLKRP054
00789 *    *------------------------------------------------------------MLKRP054
00790      PERFORM                                                      MLKRP054
00791          VARYING CRT-LST-IDX FROM CRT-LST-IDX BY -1               MLKRP054
00792          UNTIL   CRT-LST-IDX = 1                                  MLKRP054
00793              SET CRT-SRT-IDX1 TO 1                                MLKRP054
00794              SET CRT-SRT-IDX2 TO 2                                MLKRP054
00795              PERFORM                                              MLKRP054
00796                  UNTIL CRT-SRT-IDX2 > CRT-LST-IDX                 MLKRP054
00797                      IF CRT-FIN-LIAB-DTE (CRT-SRT-IDX1)  >        MLKRP054
00798                         CRT-FIN-LIAB-DTE (CRT-SRT-IDX2)           MLKRP054
00799                          MOVE CRT-ENTRY (CRT-SRT-IDX1)            MLKRP054
00800                            TO CRT-SAVE-ENTRY                      MLKRP054
00801                          MOVE CRT-ENTRY (CRT-SRT-IDX2)            MLKRP054
00802                            TO CRT-ENTRY (CRT-SRT-IDX1)            MLKRP054
00803                          MOVE CRT-SAVE-ENTRY                      MLKRP054
00804                            TO CRT-ENTRY (CRT-SRT-IDX2)            MLKRP054
00805                      END-IF                                       MLKRP054
00806                      SET CRT-SRT-IDX1 UP BY 1                     MLKRP054
00807                      SET CRT-SRT-IDX2 UP BY 1                     MLKRP054
00808              END-PERFORM                                          MLKRP054
00809      END-PERFORM.                                                 MLKRP054
00810                                                                   MLKRP054
00811                                                                   MLKRP054
00812 ******************************************************************MLKRP054
00813 * READ THE CORPORATE REPORT TABLE AND CREATE THE CORPORATE REPORT.MLKRP054
00814 ******************************************************************MLKRP054
00815  C340-C-PROCESS-REPORT-TABLE.                                     MLKRP054
00816                                                                   MLKRP054
00817      PERFORM C345-C-PROCESS-TRANS-CDES                            MLKRP054
00818          VARYING CRT-TC-IDX FROM 1 BY 1                           MLKRP054
00819          UNTIL   CRT-TC-IDX > TCT-MAX-ENTRIES.                    MLKRP054
00820                                                                   MLKRP054
00821                                                                   MLKRP054
00822  C345-C-PROCESS-TRANS-CDES.                                       MLKRP054
00823                                                                   MLKRP054
00824 *    *------------------------------------------------------------MLKRP054
00825 *    * FOR THE TRANS-CDE BEING PROCESSED, SEE IF THERE ARE ANY    MLKRP054
00826 *    * ROWS (DATES) FOR WHICH THERE WAS DATA. IF THERE ARE,       MLKRP054
00827 *    * REPORT THE TRANS-CDE AND ACCUMULATE FINAL TOTALS.          MLKRP054
00828 *    *------------------------------------------------------------MLKRP054
00829      SET CRT-DT-IDX TO 1.                                         MLKRP054
00830      SEARCH CRT-ENTRY                                             MLKRP054
00831          WHEN CRT-DATA-ENTERED (CRT-DT-IDX, CRT-TC-IDX)           MLKRP054
00832              PERFORM C350-C-PROCESS-TRANS-CDE                     MLKRP054
00833      END-SEARCH.                                                  MLKRP054
00834                                                                   MLKRP054
00835                                                                   MLKRP054
00836 ******************************************************************MLKRP054
00837 * PROCESS A PARTICULAR TRANS-CDE (COLUMN): FORMAT AND PRINT THE   MLKRP054
00838 * TOTAL LINE, ADD THE TRANS-CDE TOTALS TO THE NEXT HIGHER         MLKRP054
00839 * LEVEL TOTALS, AND INTIALIZE THE TRANS-CDE TOTALS.               MLKRP054
00840 ******************************************************************MLKRP054
00841  C350-C-PROCESS-TRANS-CDE.                                        MLKRP054
00842                                                                   MLKRP054
00843      PERFORM Z500-PRINT-TRANS-CDE-HEADING.                        MLKRP054
00844                                                                   MLKRP054
00845      SET SW-NOT-END-OF-CORP-RPT-TABLE TO TRUE.                    MLKRP054
00846      PERFORM C375-C-PROCESS-FIN-LIAB-DTE                          MLKRP054
00847          UNTIL SW-END-OF-CORP-RPT-TABLE.                          MLKRP054
00848                                                                   MLKRP054
00849      MOVE TL-TC1-TRANS-CDE-TOTAL-LINE-1 TO CORP-SPLIT-REPORT-LINE.MLKRP054
00850      MOVE 2 TO PV-ADVANCE.                                        MLKRP054
00851      PERFORM Z200-C-WRITE-REPORT-LINE.                            MLKRP054
00852                                                                   MLKRP054
00853      MOVE TOT-TCD-CURR-ML-COST    TO TL-TC2-CURR-ML-COST.         MLKRP054
00854      MOVE TOT-TCD-CURR-ML-RETAIL  TO TL-TC2-CURR-ML-RETAIL.       MLKRP054
00855      MOVE TOT-TCD-CURR-INV-COST   TO TL-TC2-CURR-INV-COST.        MLKRP054
00856      MOVE TOT-TCD-CURR-INV-RETAIL TO TL-TC2-CURR-INV-RETAIL.      MLKRP054
00857      MOVE TOT-TCD-NEXT-ML-COST    TO TL-TC2-NEXT-ML-COST.         MLKRP054
00858      MOVE TOT-TCD-NEXT-ML-RETAIL  TO TL-TC2-NEXT-ML-RETAIL.       MLKRP054
00859      MOVE TOT-TCD-NEXT-INV-COST   TO TL-TC2-NEXT-INV-COST.        MLKRP054
00860      MOVE TOT-TCD-NEXT-INV-RETAIL TO TL-TC2-NEXT-INV-RETAIL.      MLKRP054
00861                                                                   MLKRP054
00862      MOVE TL-TC2-TRANS-CDE-TOTAL-LINE-2 TO CORP-SPLIT-REPORT-LINE.MLKRP054
00863      MOVE 1 TO PV-ADVANCE.                                        MLKRP054
00864      PERFORM Z200-C-WRITE-REPORT-LINE.                            MLKRP054
00865                                                                   MLKRP054
00866 *    *------------------------------------------------------------MLKRP054
00867 *    * THE ONLY REASON FOR THE FOLLOWING MOVE IS TO MAKE USE OF   MLKRP054
00868 *    * THE 88 LEVELS DEFINED FOR SA-PREV-TRANS-CDE.               MLKRP054
00869 *    *------------------------------------------------------------MLKRP054
00870      MOVE TCT-TRANS-CDE (TCT-IDX) TO SA-PREV-TRANS-CDE.           MLKRP054
21015      MOVE TCT-SYS-ORIG-CDE (TCT-IDX) TO SA-PREV-SYST-ORIG-CDE.    MLKRP054
21015                                                                           
00871      IF SA-PREV-TRANS-PURCHASE                                    MLKRP054
00872      OR SA-PREV-TRANS-TRANSFER-TO                                 MLKRP054
00873      OR SA-PREV-TRANS-MARKUP                                      MLKRP054
00874      OR SA-PREV-TRANS-ADJUSTMENT                                  MLKRP054
00875          ADD TOT-TCD-CURR-ML-COST    TO TOT-FNL-CURR-ML-COST      MLKRP054
00876          ADD TOT-TCD-CURR-ML-RETAIL  TO TOT-FNL-CURR-ML-RETAIL    MLKRP054
00877          ADD TOT-TCD-CURR-INV-COST   TO TOT-FNL-CURR-INV-COST     MLKRP054
00878          ADD TOT-TCD-CURR-INV-RETAIL TO TOT-FNL-CURR-INV-RETAIL   MLKRP054
00879          ADD TOT-TCD-NEXT-ML-COST    TO TOT-FNL-NEXT-ML-COST      MLKRP054
00880          ADD TOT-TCD-NEXT-ML-RETAIL  TO TOT-FNL-NEXT-ML-RETAIL    MLKRP054
00881          ADD TOT-TCD-NEXT-INV-COST   TO TOT-FNL-NEXT-INV-COST     MLKRP054
00882          ADD TOT-TCD-NEXT-INV-RETAIL TO TOT-FNL-NEXT-INV-RETAIL   MLKRP054
00883      ELSE                                                         MLKRP054
00884          SUBTRACT TOT-TCD-CURR-ML-COST                            MLKRP054
00885                                       FROM TOT-FNL-CURR-ML-COST   MLKRP054
00886          SUBTRACT TOT-TCD-CURR-ML-RETAIL                          MLKRP054
00887                                       FROM TOT-FNL-CURR-ML-RETAIL MLKRP054
00888          SUBTRACT TOT-TCD-CURR-INV-COST                           MLKRP054
00889                                       FROM TOT-FNL-CURR-INV-COST  MLKRP054
00890          SUBTRACT TOT-TCD-CURR-INV-RETAIL                         MLKRP054
00891                                       FROM TOT-FNL-CURR-INV-RETAILMLKRP054
00892          SUBTRACT TOT-TCD-NEXT-ML-COST                            MLKRP054
00893                                       FROM TOT-FNL-NEXT-ML-COST   MLKRP054
00894          SUBTRACT TOT-TCD-NEXT-ML-RETAIL                          MLKRP054
00895                                       FROM TOT-FNL-NEXT-ML-RETAIL MLKRP054
00896          SUBTRACT TOT-TCD-NEXT-INV-COST                           MLKRP054
00897                                       FROM TOT-FNL-NEXT-INV-COST  MLKRP054
00898          SUBTRACT TOT-TCD-NEXT-INV-RETAIL                         MLKRP054
00899                                       FROM TOT-FNL-NEXT-INV-RETAILMLKRP054
00900      END-IF.                                                      MLKRP054
00901                                                                   MLKRP054
00902      INITIALIZE TOT-TCD-TRANS-CDE-TOTALS.                         MLKRP054
00903                                                                   MLKRP054
00905 ******************************************************************MLKRP054
00906 * PROCESS A PARTICULAR FIN-LIAB-DTE (ROW) FOR THE TRANS-CDE BEING MLKRP054
00907 * PROCESSED: FORMAT AND PRINT A DETAIL LINE, AND ADD THE FIN-LIAB MLKRP054
00908 * TOTALS TO THE NEXT HIGHER LEVEL TOTALS.                         MLKRP054
00909 ******************************************************************MLKRP054
00910  C375-C-PROCESS-FIN-LIAB-DTE.                                     MLKRP054
00911                                                                   MLKRP054
00912      MOVE CRT-FIN-LIAB-DTE (CRT-DT-IDX) TO PV-ISO-FMT-DATE.       MLKRP054
00913      MOVE PV-ISO-FMT-MM                 TO DL-EFF-DATE-MM.        MLKRP054
00914      MOVE PV-ISO-FMT-DD                 TO DL-EFF-DATE-DD.        MLKRP054
00915      MOVE PV-ISO-FMT-YY                 TO DL-EFF-DATE-YY.        MLKRP054
00916                                                                   MLKRP054
00917      MOVE CRT-CURR-ML-COST    (CRT-DT-IDX, CRT-TC-IDX)            MLKRP054
00918        TO  DL-CURR-ML-COST.                                       MLKRP054
00919      MOVE CRT-CURR-ML-RETAIL  (CRT-DT-IDX, CRT-TC-IDX)            MLKRP054
00920        TO  DL-CURR-ML-RETAIL.                                     MLKRP054
00921      MOVE CRT-CURR-INV-COST   (CRT-DT-IDX, CRT-TC-IDX)            MLKRP054
00922        TO  DL-CURR-INV-COST.                                      MLKRP054
00923      MOVE CRT-CURR-INV-RETAIL (CRT-DT-IDX, CRT-TC-IDX)            MLKRP054
00924        TO  DL-CURR-INV-RETAIL.                                    MLKRP054
00925      MOVE CRT-NEXT-ML-COST    (CRT-DT-IDX, CRT-TC-IDX)            MLKRP054
00926        TO  DL-NEXT-ML-COST.                                       MLKRP054
00927      MOVE CRT-NEXT-ML-RETAIL  (CRT-DT-IDX, CRT-TC-IDX)            MLKRP054
00928        TO  DL-NEXT-ML-RETAIL.                                     MLKRP054
00929      MOVE CRT-NEXT-INV-COST   (CRT-DT-IDX, CRT-TC-IDX)            MLKRP054
00930        TO  DL-NEXT-INV-COST.                                      MLKRP054
00931      MOVE CRT-NEXT-INV-RETAIL (CRT-DT-IDX, CRT-TC-IDX)            MLKRP054
00932        TO  DL-NEXT-INV-RETAIL.                                    MLKRP054
00933                                                                   MLKRP054
00934      IF PV-LINE-COUNT > PC-LINE-LIMIT-FOR-DTL                     MLKRP054
00935          PERFORM Z300-C-PRINT-STD-RPT-HEADING                     MLKRP054
00936          PERFORM Z360-C-PRINT-CORP-HEADING                        MLKRP054
00937          PERFORM Z400-C-PRINT-CONSTANT-HEADINGS                   MLKRP054
00938      END-IF.                                                      MLKRP054
00939                                                                   MLKRP054
00940      MOVE DL-DETAIL-LINE TO CORP-SPLIT-REPORT-LINE.               MLKRP054
00941      PERFORM Z200-C-WRITE-REPORT-LINE.                            MLKRP054
00942      MOVE 1 TO PV-ADVANCE.                                        MLKRP054
00943                                                                   MLKRP054
00944      ADD CRT-CURR-ML-COST   (CRT-DT-IDX, CRT-TC-IDX)              MLKRP054
00945          TO TOT-TCD-CURR-ML-COST.                                 MLKRP054
00946      ADD CRT-CURR-ML-RETAIL (CRT-DT-IDX, CRT-TC-IDX)              MLKRP054
00947          TO TOT-TCD-CURR-ML-RETAIL.                               MLKRP054
00948      ADD CRT-CURR-INV-COST  (CRT-DT-IDX, CRT-TC-IDX)              MLKRP054
00949          TO TOT-TCD-CURR-INV-COST.                                MLKRP054
00950      ADD CRT-CURR-INV-RETAIL(CRT-DT-IDX, CRT-TC-IDX)              MLKRP054
00951          TO TOT-TCD-CURR-INV-RETAIL.                              MLKRP054
00952      ADD CRT-NEXT-ML-COST   (CRT-DT-IDX, CRT-TC-IDX)              MLKRP054
00953          TO TOT-TCD-NEXT-ML-COST.                                 MLKRP054
00954      ADD CRT-NEXT-ML-RETAIL (CRT-DT-IDX, CRT-TC-IDX)              MLKRP054
00955          TO TOT-TCD-NEXT-ML-RETAIL.                               MLKRP054
00956      ADD CRT-NEXT-INV-COST  (CRT-DT-IDX, CRT-TC-IDX)              MLKRP054
00957          TO TOT-TCD-NEXT-INV-COST.                                MLKRP054
00958      ADD CRT-NEXT-INV-RETAIL(CRT-DT-IDX, CRT-TC-IDX)              MLKRP054
00959          TO TOT-TCD-NEXT-INV-RETAIL.                              MLKRP054
00960                                                                   MLKRP054
00961 *    *------------------------------------------------------------MLKRP054
00962 *    * FOR THE TRANS-CDE BEING PROCESSED, FIND THE NEXT ROW (DATE)MLKRP054
00963 *    * FOR WHICH THERE WAS DATA.                                  MLKRP054
00964 *    *------------------------------------------------------------MLKRP054
00965      SET CRT-DT-IDX UP BY 1.                                      MLKRP054
00966      SEARCH CRT-ENTRY                                             MLKRP054
00967          AT END                                                   MLKRP054
00968              SET SW-END-OF-CORP-RPT-TABLE TO TRUE                 MLKRP054
00969          WHEN CRT-DATA-ENTERED (CRT-DT-IDX, CRT-TC-IDX)           MLKRP054
00970              NEXT SENTENCE                                        MLKRP054
00971      END-SEARCH.                                                  MLKRP054
00972                                                                   MLKRP054
00973                                                                   MLKRP054
00974 ******************************************************************MLKRP054
00975 * PRINT THE FINAL TOTAL PAGE FOR THE STORE SPLIT REPORT.          MLKRP054
00976 ******************************************************************MLKRP054
00977  C400-S-PRINT-FINAL-TOTALS.                                       MLKRP054
00978                                                                   MLKRP054
00979      PERFORM Z300-S-PRINT-STD-RPT-HEADING.                        MLKRP054
00980      MOVE SPACE TO HD-CL-EFF-DATE-HD-LIT.                         MLKRP054
00981      PERFORM Z375-S-PRINT-FINAL-TOT-HEADING.                      MLKRP054
00982      PERFORM Z400-S-PRINT-CONSTANT-HEADINGS.                      MLKRP054
00983      MOVE TL-FN1-FINAL-TOTAL-LINE-1 TO STORE-SPLIT-REPORT-LINE.   MLKRP054
00984      PERFORM Z200-S-WRITE-REPORT-LINE.                            MLKRP054
00985                                                                   MLKRP054
00986      MOVE TOT-FNL-CURR-ML-COST    TO TL-FN2-CURR-ML-COST.         MLKRP054
00987      MOVE TOT-FNL-CURR-ML-RETAIL  TO TL-FN2-CURR-ML-RETAIL.       MLKRP054
00988      MOVE TOT-FNL-CURR-INV-COST   TO TL-FN2-CURR-INV-COST.        MLKRP054
00989      MOVE TOT-FNL-CURR-INV-RETAIL TO TL-FN2-CURR-INV-RETAIL.      MLKRP054
00990      MOVE TOT-FNL-NEXT-ML-COST    TO TL-FN2-NEXT-ML-COST.         MLKRP054
00991      MOVE TOT-FNL-NEXT-ML-RETAIL  TO TL-FN2-NEXT-ML-RETAIL.       MLKRP054
00992      MOVE TOT-FNL-NEXT-INV-COST   TO TL-FN2-NEXT-INV-COST.        MLKRP054
00993      MOVE TOT-FNL-NEXT-INV-RETAIL TO TL-FN2-NEXT-INV-RETAIL.      MLKRP054
00994                                                                   MLKRP054
00995      MOVE TL-FN2-FINAL-TOTAL-LINE-2 TO STORE-SPLIT-REPORT-LINE.   MLKRP054
00996      MOVE 1 TO PV-ADVANCE.                                        MLKRP054
00997      PERFORM Z200-S-WRITE-REPORT-LINE.                            MLKRP054
00998                                                                   MLKRP054
00999                                                                   MLKRP054
01000 ******************************************************************MLKRP054
01001 * PRINT THE FINAL TOTAL PAGE FOR THE CORPORATE REPORT.            MLKRP054
01002 ******************************************************************MLKRP054
01003  C400-C-PRINT-FINAL-TOTALS.                                       MLKRP054
01004                                                                   MLKRP054
01005      PERFORM Z300-C-PRINT-STD-RPT-HEADING.                        MLKRP054
01006      MOVE SPACE TO HD-CL-EFF-DATE-HD-LIT.                         MLKRP054
01007      PERFORM Z375-C-PRINT-FINAL-TOT-HEADING.                      MLKRP054
01008      PERFORM Z400-C-PRINT-CONSTANT-HEADINGS.                      MLKRP054
01009      MOVE TL-FN1-FINAL-TOTAL-LINE-1 TO CORP-SPLIT-REPORT-LINE.    MLKRP054
01010      PERFORM Z200-C-WRITE-REPORT-LINE.                            MLKRP054
01011                                                                   MLKRP054
01012      MOVE TOT-FNL-CURR-ML-COST    TO TL-FN2-CURR-ML-COST.         MLKRP054
01013      MOVE TOT-FNL-CURR-ML-RETAIL  TO TL-FN2-CURR-ML-RETAIL.       MLKRP054
01014      MOVE TOT-FNL-CURR-INV-COST   TO TL-FN2-CURR-INV-COST.        MLKRP054
01015      MOVE TOT-FNL-CURR-INV-RETAIL TO TL-FN2-CURR-INV-RETAIL.      MLKRP054
01016      MOVE TOT-FNL-NEXT-ML-COST    TO TL-FN2-NEXT-ML-COST.         MLKRP054
01017      MOVE TOT-FNL-NEXT-ML-RETAIL  TO TL-FN2-NEXT-ML-RETAIL.       MLKRP054
01018      MOVE TOT-FNL-NEXT-INV-COST   TO TL-FN2-NEXT-INV-COST.        MLKRP054
01019      MOVE TOT-FNL-NEXT-INV-RETAIL TO TL-FN2-NEXT-INV-RETAIL.      MLKRP054
01020                                                                   MLKRP054
01021      MOVE TL-FN2-FINAL-TOTAL-LINE-2 TO CORP-SPLIT-REPORT-LINE.    MLKRP054
01022      MOVE 1 TO PV-ADVANCE.                                        MLKRP054
01023      PERFORM Z200-C-WRITE-REPORT-LINE.                            MLKRP054
01024                                                                   MLKRP054
01025                                                                   MLKRP054
01026 ******************************************************************MLKRP054
01027 * CHECK THE TOTALS FOR THE FINANCIAL LIABILITY DATE. IF THEY ARE  MLKRP054
01028 * ALL ZERO, SKIP THE BREAK PROCESSING SO THAT THE DATE WILL NOT   MLKRP054
01029 * BE REPORTED. OTHERWISE, CONTINUE THE BREAK PROCESSING.          MLKRP054
01030 ******************************************************************MLKRP054
01031  D200-S-FIN-LIAB-BREAK.                                           MLKRP054
01032                                                                   MLKRP054
01033      IF  TOT-FLB-CURR-ML-COST     = ZERO                          MLKRP054
01034      AND TOT-FLB-CURR-ML-RETAIL   = ZERO                          MLKRP054
01035      AND TOT-FLB-CURR-INV-COST    = ZERO                          MLKRP054
01036      AND TOT-FLB-CURR-INV-RETAIL  = ZERO                          MLKRP054
01037      AND TOT-FLB-NEXT-ML-COST     = ZERO                          MLKRP054
01038      AND TOT-FLB-NEXT-ML-RETAIL   = ZERO                          MLKRP054
01039      AND TOT-FLB-NEXT-INV-COST    = ZERO                          MLKRP054
01040      AND TOT-FLB-NEXT-INV-RETAIL  = ZERO                          MLKRP054
01041          CONTINUE                                                 MLKRP054
01042      ELSE                                                         MLKRP054
01043          PERFORM E100-S-CONTINUE-FIN-LIAB-BREAK                   MLKRP054
01044      END-IF.                                                      MLKRP054
01045                                                                   MLKRP054
01046      MOVE ML025-RPT1-FIN-LIAB-DTE TO SA-PREV-FIN-LIAB-DTE.        MLKRP054
01047      IF ML025-RPT1-FSCL-YR-PER > SA-CURR-FSCL-YR-PER              MLKRP054
01048          SET SW-NEXT-FISC-PER TO TRUE                             MLKRP054
01049      ELSE                                                         MLKRP054
01050          SET SW-CURR-FISC-PER TO TRUE                             MLKRP054
01051      END-IF.                                                      MLKRP054
01052                                                                   MLKRP054
01053                                                                   MLKRP054
01054 ******************************************************************MLKRP054
01055 * PROCESS A BREAK ON TRANS-CDE: FORMAT AND PRINT THE TOTAL        MLKRP054
01056 * LINE, ADD THE TRANS-CDE TOTALS TO THE NEXT HIGHER LEVEL TOTALS, MLKRP054
01057 * AND INITIALIZE THE TRANS-CDE TOTALS.                            MLKRP054
01058 ******************************************************************MLKRP054
01059  D300-S-TRANS-CDE-BREAK.                                          MLKRP054
01060                                                                   MLKRP054
01061      MOVE TL-TC1-TRANS-CDE-TOTAL-LINE-1                           MLKRP054
01062                                   TO STORE-SPLIT-REPORT-LINE.     MLKRP054
01063      MOVE 2 TO PV-ADVANCE.                                        MLKRP054
01064      PERFORM Z200-S-WRITE-REPORT-LINE.                            MLKRP054
01065                                                                   MLKRP054
01066      MOVE TOT-TCD-CURR-ML-COST    TO TL-TC2-CURR-ML-COST.         MLKRP054
01067      MOVE TOT-TCD-CURR-ML-RETAIL  TO TL-TC2-CURR-ML-RETAIL.       MLKRP054
01068      MOVE TOT-TCD-CURR-INV-COST   TO TL-TC2-CURR-INV-COST.        MLKRP054
01069      MOVE TOT-TCD-CURR-INV-RETAIL TO TL-TC2-CURR-INV-RETAIL.      MLKRP054
01070      MOVE TOT-TCD-NEXT-ML-COST    TO TL-TC2-NEXT-ML-COST.         MLKRP054
01071      MOVE TOT-TCD-NEXT-ML-RETAIL  TO TL-TC2-NEXT-ML-RETAIL.       MLKRP054
01072      MOVE TOT-TCD-NEXT-INV-COST   TO TL-TC2-NEXT-INV-COST.        MLKRP054
01073      MOVE TOT-TCD-NEXT-INV-RETAIL TO TL-TC2-NEXT-INV-RETAIL.      MLKRP054
01074                                                                   MLKRP054
01075      MOVE TL-TC2-TRANS-CDE-TOTAL-LINE-2                           MLKRP054
01076                                   TO STORE-SPLIT-REPORT-LINE.     MLKRP054
01077      MOVE 1 TO PV-ADVANCE.                                        MLKRP054
01078      PERFORM Z200-S-WRITE-REPORT-LINE.                            MLKRP054
01079                                                                   MLKRP054
01080      IF SA-PREV-TRANS-PURCHASE                                    MLKRP054
01081      OR SA-PREV-TRANS-TRANSFER-TO                                 MLKRP054
01082      OR SA-PREV-TRANS-MARKUP                                      MLKRP054
01083      OR SA-PREV-TRANS-ADJUSTMENT                                  MLKRP054
01084          ADD TOT-TCD-CURR-ML-COST    TO TOT-STR-CURR-ML-COST      MLKRP054
01085          ADD TOT-TCD-CURR-ML-RETAIL  TO TOT-STR-CURR-ML-RETAIL    MLKRP054
01086          ADD TOT-TCD-CURR-INV-COST   TO TOT-STR-CURR-INV-COST     MLKRP054
01087          ADD TOT-TCD-CURR-INV-RETAIL TO TOT-STR-CURR-INV-RETAIL   MLKRP054
01088          ADD TOT-TCD-NEXT-ML-COST    TO TOT-STR-NEXT-ML-COST      MLKRP054
01089          ADD TOT-TCD-NEXT-ML-RETAIL  TO TOT-STR-NEXT-ML-RETAIL    MLKRP054
01090          ADD TOT-TCD-NEXT-INV-COST   TO TOT-STR-NEXT-INV-COST     MLKRP054
01091          ADD TOT-TCD-NEXT-INV-RETAIL TO TOT-STR-NEXT-INV-RETAIL   MLKRP054
01092      ELSE                                                         MLKRP054
01093          SUBTRACT TOT-TCD-CURR-ML-COST                            MLKRP054
01094                                       FROM TOT-STR-CURR-ML-COST   MLKRP054
01095          SUBTRACT TOT-TCD-CURR-ML-RETAIL                          MLKRP054
01096                                       FROM TOT-STR-CURR-ML-RETAIL MLKRP054
01097          SUBTRACT TOT-TCD-CURR-INV-COST                           MLKRP054
01098                                       FROM TOT-STR-CURR-INV-COST  MLKRP054
01099          SUBTRACT TOT-TCD-CURR-INV-RETAIL                         MLKRP054
01100                                       FROM TOT-STR-CURR-INV-RETAILMLKRP054
01101          SUBTRACT TOT-TCD-NEXT-ML-COST                            MLKRP054
01102                                       FROM TOT-STR-NEXT-ML-COST   MLKRP054
01103          SUBTRACT TOT-TCD-NEXT-ML-RETAIL                          MLKRP054
01104                                       FROM TOT-STR-NEXT-ML-RETAIL MLKRP054
01105          SUBTRACT TOT-TCD-NEXT-INV-COST                           MLKRP054
01106                                       FROM TOT-STR-NEXT-INV-COST  MLKRP054
01107          SUBTRACT TOT-TCD-NEXT-INV-RETAIL                         MLKRP054
01108                                       FROM TOT-STR-NEXT-INV-RETAILMLKRP054
01109      END-IF.                                                      MLKRP054
01110                                                                   MLKRP054
01111      INITIALIZE TOT-TCD-TRANS-CDE-TOTALS.                         MLKRP054
01112      MOVE ML025-RPT1-TRANS-CDE    TO SA-PREV-TRANS-CDE.           MLKRP054
21015      MOVE ML025-RPT1-SYST-ORIG-CDE TO SA-PREV-SYST-ORIG-CDE.      MLKRP054
01114                                                                   MLKRP054
01115 ******************************************************************MLKRP054
01116 * PROCESS A BREAK ON STORE-NBR: FORMAT AND PRINT THE TOTAL        MLKRP054
01117 * LINE, ADD THE STORE TOTALS TO THE NEXT HIGHER LEVEL TOTALS,     MLKRP054
01118 * AND INITIALIZE THE STORE TOTALS.                                MLKRP054
01119 ******************************************************************MLKRP054
01120  D400-S-STORE-NBR-BREAK.                                          MLKRP054
01121                                                                   MLKRP054
01122      MOVE TL-ST1-STORE-TOTAL-LINE-1 TO STORE-SPLIT-REPORT-LINE.   MLKRP054
01123      MOVE 3 TO PV-ADVANCE.                                        MLKRP054
01124      PERFORM Z200-S-WRITE-REPORT-LINE.                            MLKRP054
01125                                                                   MLKRP054
01126      MOVE TOT-STR-CURR-ML-COST    TO TL-ST2-CURR-ML-COST.         MLKRP054
01127      MOVE TOT-STR-CURR-ML-RETAIL  TO TL-ST2-CURR-ML-RETAIL.       MLKRP054
01128      MOVE TOT-STR-CURR-INV-COST   TO TL-ST2-CURR-INV-COST.        MLKRP054
01129      MOVE TOT-STR-CURR-INV-RETAIL TO TL-ST2-CURR-INV-RETAIL.      MLKRP054
01130      MOVE TOT-STR-NEXT-ML-COST    TO TL-ST2-NEXT-ML-COST.         MLKRP054
01131      MOVE TOT-STR-NEXT-ML-RETAIL  TO TL-ST2-NEXT-ML-RETAIL.       MLKRP054
01132      MOVE TOT-STR-NEXT-INV-COST   TO TL-ST2-NEXT-INV-COST.        MLKRP054
01133      MOVE TOT-STR-NEXT-INV-RETAIL TO TL-ST2-NEXT-INV-RETAIL.      MLKRP054
01134                                                                   MLKRP054
01135      MOVE TL-ST2-STORE-TOTAL-LINE-2 TO STORE-SPLIT-REPORT-LINE.   MLKRP054
01136      MOVE 1 TO PV-ADVANCE.                                        MLKRP054
01137      PERFORM Z200-S-WRITE-REPORT-LINE.                            MLKRP054
01138                                                                   MLKRP054
01139      ADD TOT-STR-CURR-ML-COST    TO TOT-FNL-CURR-ML-COST.         MLKRP054
01140      ADD TOT-STR-CURR-ML-RETAIL  TO TOT-FNL-CURR-ML-RETAIL.       MLKRP054
01141      ADD TOT-STR-CURR-INV-COST   TO TOT-FNL-CURR-INV-COST.        MLKRP054
01142      ADD TOT-STR-CURR-INV-RETAIL TO TOT-FNL-CURR-INV-RETAIL.      MLKRP054
01143      ADD TOT-STR-NEXT-ML-COST    TO TOT-FNL-NEXT-ML-COST.         MLKRP054
01144      ADD TOT-STR-NEXT-ML-RETAIL  TO TOT-FNL-NEXT-ML-RETAIL.       MLKRP054
01145      ADD TOT-STR-NEXT-INV-COST   TO TOT-FNL-NEXT-INV-COST.        MLKRP054
01146      ADD TOT-STR-NEXT-INV-RETAIL TO TOT-FNL-NEXT-INV-RETAIL.      MLKRP054
01147                                                                   MLKRP054
01148      INITIALIZE TOT-STR-STORE-TOTALS.                             MLKRP054
01149      MOVE ML025-RPT1-STORE-NBR TO SA-PREV-STORE-NBR.              MLKRP054
01150                                                                   MLKRP054
01151                                                                   MLKRP054
01152 ******************************************************************MLKRP054
01153 * PROCESS EACH INPUT RECORD: PRINT HEADINGS AS NECESSARY DUE TO   MLKRP054
01154 * CONTROL BREAKS; IF THE FINANCIAL LIABILITY DATE HAS CHANGED,    MLKRP054
01155 * RESET THE CURRENT OR NEXT FISCAL PERIOD INDICATOR; ADD THE      MLKRP054
01156 * COST AND RETAIL AMOUNTS TO THE LOWEST LEVEL TOTALS.             MLKRP054
01157 ******************************************************************MLKRP054
01158  D500-S-PROCESS-EDIT-SPLIT-REC.                                   MLKRP054
01159                                                                   MLKRP054
01160      IF SW-STORE-BREAK                                            MLKRP054
01161          PERFORM Z300-S-PRINT-STD-RPT-HEADING                     MLKRP054
01162          MOVE ML025-RPT1-STORE-NBR    TO HD-ST-STORE-NBR          MLKRP054
01163                                          TL-ST1-STORE-NBR         MLKRP054
W26603         PERFORM Z600-READ-XMTLOC                                 MLKRP054
W26603         MOVE XMT00001-LOC-NM         TO HD-ST-STORE-NAME         MLKRP054
01166          PERFORM Z350-S-PRINT-STORE-HEADING                       MLKRP054
01167          PERFORM Z400-S-PRINT-CONSTANT-HEADINGS                   MLKRP054
01168          PERFORM Z500-PRINT-TRANS-CDE-HEADING                     MLKRP054
01169          SET SW-NOT-STORE-BREAK TO TRUE                           MLKRP054
01170      ELSE                                                         MLKRP054
01171          IF SW-TRANS-CDE-BREAK                                    MLKRP054
01172              PERFORM Z500-PRINT-TRANS-CDE-HEADING                 MLKRP054
01173              SET SW-NOT-TRANS-CDE-BREAK TO TRUE                   MLKRP054
01174          END-IF                                                   MLKRP054
01175      END-IF.                                                      MLKRP054
01176                                                                   MLKRP054
01177      IF SW-CURR-FISC-PER                                          MLKRP054
01178          IF ML025-RPT1-INCLUDE-IN-ML                              MLKRP054
01179              ADD ML025-RPT1-EXTD-COST-AMT                         MLKRP054
01180                                         TO TOT-FLB-CURR-ML-COST   MLKRP054
01181              ADD ML025-RPT1-EXTD-RTL-AMT                          MLKRP054
01182                                         TO TOT-FLB-CURR-ML-RETAIL MLKRP054
01183          END-IF                                                   MLKRP054
01184          IF ML025-RPT1-INCLUDE-IN-INV                             MLKRP054
01185              ADD ML025-RPT1-EXTD-COST-AMT                         MLKRP054
01186                                         TO TOT-FLB-CURR-INV-COST  MLKRP054
01187              ADD ML025-RPT1-EXTD-RTL-AMT                          MLKRP054
01188                                         TO TOT-FLB-CURR-INV-RETAILMLKRP054
01189          END-IF                                                   MLKRP054
01190      ELSE                                                         MLKRP054
01191          IF ML025-RPT1-INCLUDE-IN-ML                              MLKRP054
01192              ADD ML025-RPT1-EXTD-COST-AMT                         MLKRP054
01193                                         TO TOT-FLB-NEXT-ML-COST   MLKRP054
01194              ADD ML025-RPT1-EXTD-RTL-AMT                          MLKRP054
01195                                         TO TOT-FLB-NEXT-ML-RETAIL MLKRP054
01196          END-IF                                                   MLKRP054
01197          IF ML025-RPT1-INCLUDE-IN-INV                             MLKRP054
01198              ADD ML025-RPT1-EXTD-COST-AMT                         MLKRP054
01199                                         TO TOT-FLB-NEXT-INV-COST  MLKRP054
01200              ADD ML025-RPT1-EXTD-RTL-AMT                          MLKRP054
01201                                         TO TOT-FLB-NEXT-INV-RETAILMLKRP054
01202          END-IF                                                   MLKRP054
01203      END-IF.                                                      MLKRP054
01204                                                                   MLKRP054
01205                                                                   MLKRP054
01206 ******************************************************************MLKRP054
01207 * PROCESS A BREAK ON FIN-LIAB-DTE: FORMAT AND PRINT A DETAIL LINE,MLKRP054
01208 * SAVE THE FIN-LIAB TOTALS IN A TABLE FOR USE BY THE CORPORATE    MLKRP054
01209 * REPORT PROCESSING, ADD THE FIN-LIAB TOTALS TO THE NEXT HIGHER   MLKRP054
01210 * LEVEL TOTALS, AND INITIALIZE THE FIN-LIAB TOTALS.               MLKRP054
01211 ******************************************************************MLKRP054
01212  E100-S-CONTINUE-FIN-LIAB-BREAK.                                  MLKRP054
01213                                                                   MLKRP054
01214      MOVE 'E100-S-CONTINUE-FIN-LIAB-BREAK' TO PV-PARAGRAPH-NAME.  MLKRP054
01215                                                                   MLKRP054
01216      MOVE SA-PREV-FIN-LIAB-DTE    TO PV-ISO-FMT-DATE.             MLKRP054
01217      MOVE PV-ISO-FMT-MM           TO DL-EFF-DATE-MM.              MLKRP054
01218      MOVE PV-ISO-FMT-DD           TO DL-EFF-DATE-DD.              MLKRP054
01219      MOVE PV-ISO-FMT-YY           TO DL-EFF-DATE-YY.              MLKRP054
01220                                                                   MLKRP054
01221      MOVE TOT-FLB-CURR-ML-COST    TO DL-CURR-ML-COST.             MLKRP054
01222      MOVE TOT-FLB-CURR-ML-RETAIL  TO DL-CURR-ML-RETAIL.           MLKRP054
01223      MOVE TOT-FLB-CURR-INV-COST   TO DL-CURR-INV-COST.            MLKRP054
01224      MOVE TOT-FLB-CURR-INV-RETAIL TO DL-CURR-INV-RETAIL.          MLKRP054
01225      MOVE TOT-FLB-NEXT-ML-COST    TO DL-NEXT-ML-COST.             MLKRP054
01226      MOVE TOT-FLB-NEXT-ML-RETAIL  TO DL-NEXT-ML-RETAIL.           MLKRP054
01227      MOVE TOT-FLB-NEXT-INV-COST   TO DL-NEXT-INV-COST.            MLKRP054
01228      MOVE TOT-FLB-NEXT-INV-RETAIL TO DL-NEXT-INV-RETAIL.          MLKRP054
01229                                                                   MLKRP054
01230      IF PV-LINE-COUNT > PC-LINE-LIMIT-FOR-DTL                     MLKRP054
01231          PERFORM Z300-S-PRINT-STD-RPT-HEADING                     MLKRP054
01232          PERFORM Z350-S-PRINT-STORE-HEADING                       MLKRP054
01233          PERFORM Z400-S-PRINT-CONSTANT-HEADINGS                   MLKRP054
01234      END-IF.                                                      MLKRP054
01235                                                                   MLKRP054
01236      MOVE DL-DETAIL-LINE TO STORE-SPLIT-REPORT-LINE.              MLKRP054
01237      PERFORM Z200-S-WRITE-REPORT-LINE.                            MLKRP054
01238      MOVE 1 TO PV-ADVANCE.                                        MLKRP054
01239                                                                   MLKRP054
01240 *    *------------------------------------------------------------MLKRP054
01241 *    * STORE THE TOTALS BY TRANS-CDE WITHIN FIN-LIAB-DTE FOR USE  MLKRP054
01242 *    * BY CORPORATE REPORT PROCESSING. SEARCH FOR THE FIN-LIAB-   MLKRP054
01243 *    * DTE IN THE TABLE TO FIND THE APPROPRIATE ROW. IF IT DOESN'TMLKRP054
01244 *    * EXIST, CREATE A NEW ROW. THE APPROPRIATE COLUMN WITHIN THE MLKRP054
01245 *    * ROW WAS DETERMINED EARLIER WHEN PRINTING THE TRANS-CDE     MLKRP054
01246 *    * HEADING. AT THAT TIME, THE COLUMN INDEX (CRT-TC-IDX) WAS   MLKRP054
01247 *    * SET TO THE COLUMN THAT CORRESPONDS TO THE TRANS-CDE BEING  MLKRP054
01248 *    * PROCESSED.                                                 MLKRP054
01249 *    *------------------------------------------------------------MLKRP054
01250      SET CRT-DT-IDX TO 1.                                         MLKRP054
01251      SEARCH CRT-ENTRY                                             MLKRP054
01252          AT END                                                   MLKRP054
01253              MOVE 'TABLE OVERFLOW ON CRT-CORP-RPT-TABLE.'         MLKRP054
01254                         TO PV-ABEND-MESSAGE                       MLKRP054
01255              MOVE +4004 TO ABEND-CODE                             MLKRP054
01256              PERFORM Z999-ABEND                                   MLKRP054
01257          WHEN CRT-FIN-LIAB-DTE (CRT-DT-IDX) =                     MLKRP054
01258               SA-PREV-FIN-LIAB-DTE                                MLKRP054
01259            OR CRT-FIN-LIAB-DTE (CRT-DT-IDX) = SPACE               MLKRP054
01260              NEXT SENTENCE                                        MLKRP054
01261      END-SEARCH.                                                  MLKRP054
01262                                                                   MLKRP054
01263      IF CRT-FIN-LIAB-DTE (CRT-DT-IDX) = SPACE                     MLKRP054
01264          MOVE SA-PREV-FIN-LIAB-DTE                                MLKRP054
01265                                  TO CRT-FIN-LIAB-DTE (CRT-DT-IDX) MLKRP054
01266      END-IF.                                                      MLKRP054
01267                                                                   MLKRP054
01268      SET CRT-DATA-ENTERED        (CRT-DT-IDX, CRT-TC-IDX) TO TRUE.MLKRP054
01269      ADD TOT-FLB-CURR-ML-COST                                     MLKRP054
01270              TO CRT-CURR-ML-COST    (CRT-DT-IDX, CRT-TC-IDX).     MLKRP054
01271      ADD TOT-FLB-CURR-ML-RETAIL                                   MLKRP054
01272              TO CRT-CURR-ML-RETAIL  (CRT-DT-IDX, CRT-TC-IDX).     MLKRP054
01273      ADD TOT-FLB-CURR-INV-COST                                    MLKRP054
01274              TO CRT-CURR-INV-COST   (CRT-DT-IDX, CRT-TC-IDX).     MLKRP054
01275      ADD TOT-FLB-CURR-INV-RETAIL                                  MLKRP054
01276              TO CRT-CURR-INV-RETAIL (CRT-DT-IDX, CRT-TC-IDX).     MLKRP054
01277      ADD TOT-FLB-NEXT-ML-COST                                     MLKRP054
01278              TO CRT-NEXT-ML-COST    (CRT-DT-IDX, CRT-TC-IDX).     MLKRP054
01279      ADD TOT-FLB-NEXT-ML-RETAIL                                   MLKRP054
01280              TO CRT-NEXT-ML-RETAIL  (CRT-DT-IDX, CRT-TC-IDX).     MLKRP054
01281      ADD TOT-FLB-NEXT-INV-COST                                    MLKRP054
01282              TO CRT-NEXT-INV-COST   (CRT-DT-IDX, CRT-TC-IDX).     MLKRP054
01283      ADD TOT-FLB-NEXT-INV-RETAIL                                  MLKRP054
01284              TO CRT-NEXT-INV-RETAIL (CRT-DT-IDX, CRT-TC-IDX).     MLKRP054
01285                                                                   MLKRP054
01286      ADD TOT-FLB-CURR-ML-COST    TO TOT-TCD-CURR-ML-COST.         MLKRP054
01287      ADD TOT-FLB-CURR-ML-RETAIL  TO TOT-TCD-CURR-ML-RETAIL.       MLKRP054
01288      ADD TOT-FLB-CURR-INV-COST   TO TOT-TCD-CURR-INV-COST.        MLKRP054
01289      ADD TOT-FLB-CURR-INV-RETAIL TO TOT-TCD-CURR-INV-RETAIL.      MLKRP054
01290      ADD TOT-FLB-NEXT-ML-COST    TO TOT-TCD-NEXT-ML-COST.         MLKRP054
01291      ADD TOT-FLB-NEXT-ML-RETAIL  TO TOT-TCD-NEXT-ML-RETAIL.       MLKRP054
01292      ADD TOT-FLB-NEXT-INV-COST   TO TOT-TCD-NEXT-INV-COST.        MLKRP054
01293      ADD TOT-FLB-NEXT-INV-RETAIL TO TOT-TCD-NEXT-INV-RETAIL.      MLKRP054
01294                                                                   MLKRP054
01295      INITIALIZE TOT-FLB-FIN-LIAB-DTE-TOTALS.                      MLKRP054
01296                                                                   MLKRP054
01297                                                                   MLKRP054
01298  Z100-READ-EDIT-SPLIT-FILE.                                       MLKRP054
01299                                                                   MLKRP054
01300      READ EDIT-SPLIT-FILE                                         MLKRP054
01301          INTO ML025-RPT1-RECORD                                   MLKRP054
01302              AT END SET SW-END-OF-EDIT-SPLIT-FILE TO TRUE.        MLKRP054
01303                                                                   MLKRP054
01304                                                                   MLKRP054
01305  Z200-S-WRITE-REPORT-LINE.                                        MLKRP054
01306                                                                   MLKRP054
01307      WRITE STORE-SPLIT-REPORT-LINE                                MLKRP054
01308          AFTER ADVANCING PV-ADVANCE.                              MLKRP054
01309      ADD PV-ADVANCE TO PV-LINE-COUNT.                             MLKRP054
01310                                                                   MLKRP054
01311                                                                   MLKRP054
01312  Z200-C-WRITE-REPORT-LINE.                                        MLKRP054
01313                                                                   MLKRP054
01314      WRITE CORP-SPLIT-REPORT-LINE                                 MLKRP054
01315          AFTER ADVANCING PV-ADVANCE.                              MLKRP054
01316      ADD PV-ADVANCE TO PV-LINE-COUNT.                             MLKRP054
01317                                                                   MLKRP054
01318                                                                   MLKRP054
01319 ******************************************************************MLKRP054
01320 * PRINT THE STANDARD REPORT HEADING LINE FOR THE STORE REPORT.    MLKRP054
01321 ******************************************************************MLKRP054
01322  Z300-S-PRINT-STD-RPT-HEADING.                                    MLKRP054
01323                                                                   MLKRP054
01324      ADD 1 TO PV-PAGE-COUNT.                                      MLKRP054
01325      MOVE PV-PAGE-COUNT TO DP200O-PAGE-NUMBER.                    MLKRP054
01326      MOVE DP200O-STANDRD-HEADER-200-COLS                          MLKRP054
01327          TO STORE-SPLIT-REPORT-LINE                               MLKRP054
01328      WRITE STORE-SPLIT-REPORT-LINE                                MLKRP054
01329          AFTER ADVANCING PAGE.                                    MLKRP054
01330      MOVE +1 TO PV-LINE-COUNT.                                    MLKRP054
01331                                                                   MLKRP054
01332                                                                   MLKRP054
01333 ******************************************************************MLKRP054
01334 * PRINT THE STANDARD REPORT HEADING LINE FOR THE CORPORATE REPORT.MLKRP054
01335 ******************************************************************MLKRP054
01336  Z300-C-PRINT-STD-RPT-HEADING.                                    MLKRP054
01337                                                                   MLKRP054
01338      ADD 1 TO PV-PAGE-COUNT.                                      MLKRP054
01339      MOVE PV-PAGE-COUNT TO DP200O-PAGE-NUMBER.                    MLKRP054
01340      MOVE DP200O-STANDRD-HEADER-200-COLS                          MLKRP054
01341          TO CORP-SPLIT-REPORT-LINE                                MLKRP054
01342      WRITE CORP-SPLIT-REPORT-LINE                                 MLKRP054
01343          AFTER ADVANCING PAGE.                                    MLKRP054
01344      MOVE +1 TO PV-LINE-COUNT.                                    MLKRP054
01345                                                                   MLKRP054
01346                                                                   MLKRP054
01347 ******************************************************************MLKRP054
01348 * PRINT THE STORE HEADING LINE.                                   MLKRP054
01349 ******************************************************************MLKRP054
01350  Z350-S-PRINT-STORE-HEADING.                                      MLKRP054
01351                                                                   MLKRP054
01352      WRITE STORE-SPLIT-REPORT-LINE FROM HD-ST-STORE-HEADING       MLKRP054
01353          AFTER ADVANCING 2 LINES.                                 MLKRP054
01354      ADD +2 TO PV-LINE-COUNT.                                     MLKRP054
01355                                                                   MLKRP054
01356                                                                   MLKRP054
01357 ******************************************************************MLKRP054
01358 * PRINT THE CORP HEADING LINE.                                    MLKRP054
01359 ******************************************************************MLKRP054
01360  Z360-C-PRINT-CORP-HEADING.                                       MLKRP054
01361                                                                   MLKRP054
01362      WRITE CORP-SPLIT-REPORT-LINE FROM HD-CP-CORP-HEADING         MLKRP054
01363          AFTER ADVANCING 2 LINES.                                 MLKRP054
01364      ADD +2 TO PV-LINE-COUNT.                                     MLKRP054
01365                                                                   MLKRP054
01366                                                                   MLKRP054
01367 ******************************************************************MLKRP054
01368 * PRINT THE FINAL TOTAL HEADING LINE FOR THE STORE REPORT.        MLKRP054
01369 ******************************************************************MLKRP054
01370  Z375-S-PRINT-FINAL-TOT-HEADING.                                  MLKRP054
01371                                                                   MLKRP054
01372      WRITE STORE-SPLIT-REPORT-LINE FROM HD-FT-FINAL-TOTAL-HEADING MLKRP054
01373              AFTER ADVANCING 2 LINES.                             MLKRP054
01374      ADD +2 TO PV-LINE-COUNT.                                     MLKRP054
01375                                                                   MLKRP054
01376                                                                   MLKRP054
01377 ******************************************************************MLKRP054
01378 * PRINT THE FINAL TOTAL HEADING LINE FOR THE CORPORATE REPORT.    MLKRP054
01379 ******************************************************************MLKRP054
01380  Z375-C-PRINT-FINAL-TOT-HEADING.                                  MLKRP054
01381                                                                   MLKRP054
01382      WRITE CORP-SPLIT-REPORT-LINE FROM HD-FT-FINAL-TOTAL-HEADING  MLKRP054
01383              AFTER ADVANCING 2 LINES.                             MLKRP054
01384      ADD +2 TO PV-LINE-COUNT.                                     MLKRP054
01385                                                                   MLKRP054
01386                                                                   MLKRP054
01387 ******************************************************************MLKRP054
01388 * PRINT THE STORE REPORT HEADINGS THAT ARE THE SAME FOR BOTH THE  MLKRP054
01389 * DETAIL PAGES AND THE FINAL TOTAL PAGE. THE TRANS-CDE HEADING IS MLKRP054
01390 * NOT PRINTED HERE. IT IS PRINTED SPEARATELY BECAUSE UNLIKE THE   MLKRP054
01391 * HEADINGS PRINTED HERE, IT IS NOT REPRINTED UPON A PAGE BREAK.   MLKRP054
01392 ******************************************************************MLKRP054
01393  Z400-S-PRINT-CONSTANT-HEADINGS.                                  MLKRP054
01394                                                                   MLKRP054
01395      WRITE STORE-SPLIT-REPORT-LINE FROM HD-ED-EDIT-DATE-HEADING   MLKRP054
01396          AFTER ADVANCING 1 LINES.                                 MLKRP054
01397      WRITE STORE-SPLIT-REPORT-LINE FROM HD-FP-FISCAL-PER-HEADING  MLKRP054
01398          AFTER ADVANCING 2 LINES.                                 MLKRP054
01399      WRITE STORE-SPLIT-REPORT-LINE FROM HD-MI-ML-INV-HEADING      MLKRP054
01400          AFTER ADVANCING 2 LINES.                                 MLKRP054
01401      WRITE STORE-SPLIT-REPORT-LINE FROM HD-CL-COLUMN-HEADING      MLKRP054
01402          AFTER ADVANCING 1 LINE.                                  MLKRP054
01403      ADD +6 TO PV-LINE-COUNT.                                     MLKRP054
01404      MOVE 2  TO PV-ADVANCE.                                       MLKRP054
01405                                                                   MLKRP054
01406                                                                   MLKRP054
01407 ******************************************************************MLKRP054
01408 * PRINT THE CORPORATE REPORT HEADINGS THAT ARE THE SAME FOR BOTH  MLKRP054
01409 * THE DETAIL PAGES AND THE FINAL TOTAL PAGE. THE TRANS-CDE HEADINGMLKRP054
01410 * IS NOT PRINTED HERE. IT IS PRINTED SPEARATELY BECAUSE UNLIKE THEMLKRP054
01411 * HEADINGS PRINTED HERE, IT IS NOT REPRINTED UPON A PAGE BREAK.   MLKRP054
01412 ******************************************************************MLKRP054
01413  Z400-C-PRINT-CONSTANT-HEADINGS.                                  MLKRP054
01414                                                                   MLKRP054
01415      WRITE CORP-SPLIT-REPORT-LINE FROM HD-ED-EDIT-DATE-HEADING    MLKRP054
01416          AFTER ADVANCING 1 LINES.                                 MLKRP054
01417      WRITE CORP-SPLIT-REPORT-LINE FROM HD-FP-FISCAL-PER-HEADING   MLKRP054
01418          AFTER ADVANCING 2 LINES.                                 MLKRP054
01419      WRITE CORP-SPLIT-REPORT-LINE FROM HD-MI-ML-INV-HEADING       MLKRP054
01420          AFTER ADVANCING 2 LINES.                                 MLKRP054
01421      WRITE CORP-SPLIT-REPORT-LINE FROM HD-CL-COLUMN-HEADING       MLKRP054
01422          AFTER ADVANCING 1 LINE.                                  MLKRP054
01423      ADD +6 TO PV-LINE-COUNT.                                     MLKRP054
01424      MOVE 2  TO PV-ADVANCE.                                       MLKRP054
01425                                                                   MLKRP054
01426                                                                   MLKRP054
01427 ******************************************************************MLKRP054
01428 * PRINT THE TRANS-CDE HEADING. FOR THE STORE REPORT,              MLKRP054
01429 * TRANS-CDE TABLE IS SEARCHED TO FIND THE DESCRIPTION THAT WILL   MLKRP054
01430 * BE USED IN THE HEADING. AT THE SAME TIME, THE CORPORATE REPORT  MLKRP054
01431 * TABLE TRANS-CDE INDEX (CRT-TC-IDX) IS SET FOR LATER USE BECAUSE MLKRP054
01432 * BECAUSE ITS VALUE IS THE SAME AS THE ENTRY NUMBER IN THE        MLKRP054
01433 * TRANS-CDE TABLE. FOR EXAMPLE, IF TRANS-CDE '030' IS FOUND IN    MLKRP054
01434 * THE 3RD ENTRY OF THE TRANS-CDE TABLE, THEN THE 3RD COLUMN OF    MLKRP054
01435 * EACH ROW IN THE CORPORATE REPORT TABLE IS USED TO STORE         MLKRP054
01436 * TRANS-CDE '030' INFORMATION. FOR THE CORPORATE REPORT,          MLKRP054
01437 * CRT-TC-IDX IS ALREADY SET FOR THE TRANS-CDE BEING PROCESSED, SO MLKRP054
01438 * IT CAN BE USED AS THE INDEX INTO THE TRANS-CDE TABLE.           MLKRP054
01439 ******************************************************************MLKRP054
01440  Z500-PRINT-TRANS-CDE-HEADING.                                    MLKRP054
01441                                                                   MLKRP054
01442      MOVE 'Z500-PRINT-TRANS-CDE-HEADING' TO PV-PARAGRAPH-NAME.    MLKRP054
01443                                                                   MLKRP054
01444      IF SW-PROCESSING-STORE-REPORT                                MLKRP054
01445          SET TCT-IDX TO 1                                         MLKRP054
01446                                                                   MLKRP054
01447          SEARCH TCT-ENTRY                                         MLKRP054
01448              AT END                                               MLKRP054
01449                  MOVE 'TRANS-CDE ON INPUT RECORD NOT FOUND IN TCT-MLKRP054
01450 -                        'TRANS-CDE-TABLE.' TO PV-ABEND-MESSAGE   MLKRP054
01451                  MOVE +4008 TO ABEND-CODE                         MLKRP054
01452                  PERFORM Z999-ABEND                               MLKRP054
01453              WHEN TCT-TRANS-CDE (TCT-IDX) = ML025-RPT1-TRANS-CDE  MLKRP054
21015               AND TCT-SYS-ORIG-CDE (TCT-IDX)                      MLKRP054
21015                               = ML025-RPT1-SYST-ORIG-CDE                  
01454                  SET CRT-TC-IDX TO TCT-IDX                        MLKRP054
01455                  MOVE TCT-TRANS-CDE-DESC (TCT-IDX)                MLKRP054
01456                                           TO HD-TC-TRANS-CDE-DESC MLKRP054
01457                                              TL-TC1-TRANS-CDE-DESCMLKRP054
01458          END-SEARCH                                               MLKRP054
01459                                                                   MLKRP054
01460      ELSE                                                         MLKRP054
01461          SET TCT-IDX TO CRT-TC-IDX                                MLKRP054
01462          MOVE TCT-TRANS-CDE-DESC (TCT-IDX)                        MLKRP054
01463                                           TO HD-TC-TRANS-CDE-DESC MLKRP054
01464                                              TL-TC1-TRANS-CDE-DESCMLKRP054
01465      END-IF.                                                      MLKRP054
01466                                                                   MLKRP054
01467      IF PV-LINE-COUNT > PC-LINE-LIMIT-FOR-HD-TC                   MLKRP054
01468          IF SW-PROCESSING-STORE-REPORT                            MLKRP054
01469              PERFORM Z300-S-PRINT-STD-RPT-HEADING                 MLKRP054
01470              PERFORM Z350-S-PRINT-STORE-HEADING                   MLKRP054
01471              PERFORM Z400-S-PRINT-CONSTANT-HEADINGS               MLKRP054
01472          ELSE                                                     MLKRP054
01473              PERFORM Z300-C-PRINT-STD-RPT-HEADING                 MLKRP054
01474              PERFORM Z360-C-PRINT-CORP-HEADING                    MLKRP054
01475              PERFORM Z400-C-PRINT-CONSTANT-HEADINGS               MLKRP054
01476          END-IF                                                   MLKRP054
01477      END-IF.                                                      MLKRP054
01478                                                                   MLKRP054
01479      IF SW-PROCESSING-STORE-REPORT                                MLKRP054
01480          WRITE STORE-SPLIT-REPORT-LINE                            MLKRP054
01481              FROM HD-TC-TRANS-CDE-HEADING                         MLKRP054
01482              AFTER ADVANCING 2 LINES                              MLKRP054
01483      ELSE                                                         MLKRP054
01484          WRITE CORP-SPLIT-REPORT-LINE                             MLKRP054
01485              FROM HD-TC-TRANS-CDE-HEADING                         MLKRP054
01486              AFTER ADVANCING 2 LINES                              MLKRP054
01487      END-IF.                                                      MLKRP054
01488                                                                   MLKRP054
01489      ADD +2 TO PV-LINE-COUNT.                                     MLKRP054
01490      MOVE 2 TO PV-ADVANCE.                                        MLKRP054
01491                                                                   MLKRP054
01492                                                                   MLKRP054
01493 ***************************************************************** MLKRP054
01494 * THIS PARAGRAPH RETRIEVES THE STORE NAME.                        MLKRP054
01495 ***************************************************************** MLKRP054
W26603 Z600-READ-XMTLOC.                                                MLKRP054
01497                                                                   MLKRP054
W26603     MOVE 'Z600-READ-XMTLOC' TO PV-PARAGRAPH-NAME.                MLKRP054
01499                                                                   MLKRP054
01500      PERFORM                                                      MLKRP054
01501          WITH TEST AFTER                                          MLKRP054
01502          VARYING PV-SQL-SUB FROM 1 BY 1                           MLKRP054
01503          UNTIL PV-SQL-SUB > PC-MAX-RETRIES                        MLKRP054
01504             OR SQLCODE = 0                                        MLKRP054
01505                                                                   MLKRP054
W26603         MOVE ML025-RPT1-STORE-NBR TO PV-EDIT-STORE                       
W26603         MOVE PV-EDIT-STORE-NUM    TO XMT00001-LOC-NBR                    
W26603                                                                  MLKRP054
01506          EXEC SQL                                                 MLKRP054
W26603              SELECT LOC_NM                                       MLKRP054
W26603              INTO :XMT00001-LOC-NM                               MLKRP054
W26603              FROM XMT_LOC                                        MLKRP054
W26603              WHERE LOC_NBR = :XMT00001-LOC-NBR                   MLKRP054
W26603              WITH UR                                                     
01512          END-EXEC                                                 MLKRP054
01513                                                                   MLKRP054
01514          EVALUATE TRUE                                            MLKRP054
01515              WHEN SQLCODE = +100                                  MLKRP054
01516                  DISPLAY '*** MLKRP054 ABEND ***'                 MLKRP054
01517                  DISPLAY '**** NO MATCH FOR STORE '               MLKRP054
01518                                           ML025-RPT1-STORE-NBR    MLKRP054
01519                  DISPLAY '**** ON DB2 STORE TABLE'                MLKRP054
01520                  PERFORM Z900-SQL-ABEND                           MLKRP054
01521              WHEN SQLCODE = -904                                  MLKRP054
01522              WHEN SQLCODE = -911                                  MLKRP054
01523              WHEN SQLCODE = 0                                     MLKRP054
01524                  CONTINUE                                         MLKRP054
01525              WHEN SQLWARN NOT = SPACES                            MLKRP054
01526              WHEN SQLCODE NOT = ZERO                              MLKRP054
W26603                 MOVE 'Z600-READ-XMTLOC'                          MLKRP054
01528                                TO  PV-PARAGRAPH-NAME              MLKRP054
01529                  MOVE 'READING STORE TABLE'                       MLKRP054
01530                                TO  PV-DB2-OPER-ATTEMPTED          MLKRP054
01531                  PERFORM Z900-SQL-ABEND                           MLKRP054
01532          END-EVALUATE                                             MLKRP054
01533      END-PERFORM.                                                 MLKRP054
01534                                                                   MLKRP054
01535      IF  PV-SQL-SUB > PC-MAX-RETRIES                              MLKRP054
01536          MOVE 'READ RETRIES EXCEEDED'                             MLKRP054
01537                                TO  PV-DB2-OPER-ATTEMPTED          MLKRP054
01538          PERFORM Z900-SQL-ABEND                                   MLKRP054
01539      END-IF.                                                      MLKRP054
01540                                                                   MLKRP054
01541                                                                   MLKRP054
01542 ******************************************************************MLKRP054
01543 *  STANDARD DB2 ERROR ABEND ROUTINE                               MLKRP054
01544 *  THIS ROUTINE FORCES AN ABEND DUE TO A DB2 PROBLEM.             MLKRP054
01545 ******************************************************************MLKRP054
01546  Z900-SQL-ABEND.                                                  MLKRP054
01547                                                                   MLKRP054
01548      MOVE +4013                 TO ABEND-CODE.                    MLKRP054
01549      DISPLAY '**  ABEND     **'.                                  MLKRP054
01550      DISPLAY '**  PROGRAM   **  =  MLKRP054'.                     MLKRP054
01551      DISPLAY '**  PARAGRAPH **  = ' PV-PARAGRAPH-NAME.            MLKRP054
01552      DISPLAY '**  OPERATION **  = ' PV-DB2-OPER-ATTEMPTED.        MLKRP054
01553                                                                   MLKRP054
01554 *    THE FOLLOWING COPYBOOK UTILIZES THE DB2 ABEND MODULE         MLKRP054
01555 *    DSNTIAR TO CONVERT SQLCA INTO UNDERSTANDABLE VERBAGE.        MLKRP054
01556                                                                   MLKRP054
01557      COPY DPPD004.                                                MLKRP054
01558                                                                   MLKRP054
01559      CALL 'ILBOABN0'  USING ABEND-CODE.                           MLKRP054
01560                                                                   MLKRP054
01561  Z999-ABEND.                                                      MLKRP054
01562                                                                   MLKRP054
01563      DISPLAY '**  ABEND     **'.                                  MLKRP054
01564      DISPLAY '**  PROGRAM   **  =  MLKRP054'.                     MLKRP054
01565      DISPLAY '**  PARAGRAPH **  = ' PV-PARAGRAPH-NAME.            MLKRP054
01566      DISPLAY '**  ' PV-ABEND-MESSAGE.                             MLKRP054
01567      DISPLAY '**  INPUT RECORD: ' EDIT-SPLIT-RECORD.              MLKRP054
01568      CALL 'ILBOABN0'  USING ABEND-CODE.                           MLKRP054
