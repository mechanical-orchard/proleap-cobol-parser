000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.    RCKUT193.                                         00020000
000300 AUTHOR.        GERMAN BANDA.                                     00030000
000400 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00040000
000500 DATE-WRITTEN.  APRIL, 2022.                                      00050000
000600 DATE-COMPILED.                                                   00060000
000700******************************************************************00070000
000800* THIS PROGRAM WILL READ IN A FILE OF ERRORS GENERATED FROM       00080000
000900* PROCESSING TRAILER INFORMATION FROM THIRD PARTY VENDOR(GEODIS)  00090000
000910* PROCESS WILL FORMAT AN OUTPUT FILE INDICATING RECORDS PROCESSED 00091000
000920* AND ERROR COUNTS.                                               00092000
001000******************************************************************00100000
001200******************************************************************00120000
001300 ENVIRONMENT DIVISION.                                            00130000
001400 CONFIGURATION SECTION.                                           00140000
001500 SOURCE-COMPUTER.    IBM-3090.                                    00150000
001600 OBJECT-COMPUTER.    IBM-3090.                                    00160000
001700 INPUT-OUTPUT SECTION.                                            00170000
001800 FILE-CONTROL.                                                    00180000
001900                                                                  00190000
002000     SELECT ERROR-COUNT-FILE                                      00200002
002100            ASSIGN TO INP01.                                      00210000
002200                                                                  00220000
002300     SELECT OUTPUT-EMAIL-FILE                                     00230000
002400            ASSIGN TO OUT01.                                      00240000
002500                                                                  00250000
002700                                                                  00270000
002800 DATA DIVISION.                                                   00280000
002900 FILE SECTION.                                                    00290000
003000                                                                  00300000
003100 FD  ERROR-COUNT-FILE                                             00310000
003200     RECORDING MODE IS F                                          00320000
003300     LABEL RECORDS OMITTED                                        00330000
003400     BLOCK CONTAINS 0 RECORDS                                     00340000
003500     DATA RECORD IS ERROR-COUNT-RECORD.                           00350000
003600 01  INPUT-ERROR-REC                     PIC  X(100).             00360003
003700                                                                  00370000
003800 FD  OUTPUT-EMAIL-FILE                                            00380000
003900     RECORDING MODE IS F                                          00390000
004000     LABEL RECORDS OMITTED                                        00400000
004100     BLOCK CONTAINS 0 RECORDS                                     00410000
004200     DATA RECORD IS OUTPUT-EMAIL-RECORD.                          00420003
004300 01  OUTPUT-EMAIL-RECORD                 PIC  X(80).              00430003
004400                                                                  00440000
004500 WORKING-STORAGE SECTION.                                         00450000
004600                                                                  00460000
004700******************************************************************00470000
004800* PROGRAM CONSTANTS                                               00480000
004900******************************************************************00490000
005000 01  PC-CONSTANTS-FIELDS.                                         00500000
005100     05  PC-PGM-NAME                     PIC  X(08) VALUE         00510000
005200                                                    'RCKUT193'.   00520000
005300     05  PC-MAX-RETRIES                  PIC S9(03) VALUE +3      00530000
005400                                                    COMP-3.       00540000
005410     05  PC-COLON                        PIC  X(01) VALUE ':'.    00541045
005500                                                                  00550000
005600******************************************************************00560000
005700* PROGRAM VARIABLES                                               00570000
005800******************************************************************00580000
005900 01  PV-VARIABLE-FIELDS.                                          00590000
006000     05  PV-PARAGRAPH-NAME               PIC  X(30) VALUE SPACE.  00600000
006100     05  PV-DB2-OPERATION                PIC  X(30) VALUE SPACE.  00610000
006200     05  PV-RETRY-COUNTER                PIC S9(04) VALUE ZEROS   00620000
006300                                                    COMP SYNC.    00630000
006310     05  PV-DISP-SQLCODE                    PIC -999.             00631010
006400     05  PV-EDIT-FIELD                   PIC  ZZZ,ZZZ,ZZ9.        00640000
006600     05  PV-TIMESTAMP                    PIC  X(26).              00660038
006700     05  PV-TIMESTAMP-REDEF REDEFINES PV-TIMESTAMP.               00670037
006710         10 PV-TIMESTAMP-DATE            PIC  X(10).              00671038
006711         10 FILLER                       PIC  X(01).              00671145
006720         10 PV-TIMESTAMP-TIME.                                    00672046
006721             15  PV-CURR-TIME-HH         PIC  X(02).              00672145
006722             15  PV-CURR-TIME-P1         PIC  X(01).              00672245
006723             15  PV-CURR-TIME-MM         PIC  X(02).              00672345
006730         10 FILLER                       PIC  X(10).              00673037
007201*                                                                 00720100
007219     05  PV-PGM-MSG                PIC X(80).                     00721933
007220     05  PV-PGM-MSG-REDEF  REDEFINES  PV-PGM-MSG.                 00722033
007221         10  PV-ERROR-MSG          PIC X(40).                     00722133
007222         10  PV-ERROR-COUNT        PIC X(9).                      00722233
007223         10  PV-FILLER             PIC X(31).                     00722333
007224                                                                  00722433
007225 01  PV-MSG-RECORD                       PIC X(80) VALUE SPACES.  00722500
007226 01  PV-DISP-NBR                         PIC  ZZ,ZZZ,ZZ9.         00722600
007227 01  PV-COUNTERS.                                                 00722710
007230     05  PV-SML-COUNT                    PIC S9(9)   VALUE +0     00723032
007240                                                     COMP-3.      00724032
007250     05  PV-UNIT-COUNT                   PIC S9(9)   VALUE +0     00725032
007260                                                     COMP-3.      00726032
007270     05  PV-RCVR-COUNT                   PIC S9(9)   VALUE +0     00727010
007280                                                     COMP-3.      00728010
007300                                                                  00730000
007310 01  DN-NULL-INDICATORS.                                          00731049
007320     05  DN-SML-NULL                 PIC S9(4)  COMP.             00732049
007330     05  DN-SHIPT-QTY-NULL           PIC S9(4)  COMP.             00733049
007340     05  DN-RECEIVER-NULL            PIC S9(4)  COMP.             00734050
007400******************************************************************00740000
007500* PROGRAM ACCUMULATORS                                            00750000
007600******************************************************************00760000
007700 01  PA-PROGRAM-ACCUMULATORS.                                     00770000
007800     05  PA-INPUT-RECORDS-READ           PIC  9(09) VALUE ZEROS.  00780000
007900     05  PA-OUTPUT-RECORDS-WROTE         PIC  9(09) VALUE ZEROS.  00790000
008000                                                                  00800000
008100******************************************************************00810000
008200* PROGRAM SWITCHES                                                00820000
008300******************************************************************00830000
008400 01  PS-SWITCH-AREAS.                                             00840000
008500     05  PS-END-OF-INPUT-FILE-SW         PIC  X(01) VALUE 'N'.    00850000
008600         88  PS-END-OF-INPUT-FILE                   VALUE 'Y'.    00860000
008700         88  PS-NOT-END-OF-FILE                     VALUE 'N'.    00870000
008800     05  PS-FIRST-TIME-SW                PIC  X(01) VALUE 'N'.    00880000
008900         88  PS-FIRST-TIME-Y                        VALUE 'Y'.    00890000
009000         88  PS-FIRST-TIME-N                        VALUE 'N'.    00900000
009100                                                                  00910000
009200******************************************************************00920000
009300* ABEND INFORMATION                                               00930000
009400******************************************************************00940000
009500 01  ABEND-CODE                          PIC S9(04) VALUE ZEROS   00950000
009600                                                    COMP SYNC.    00960000
009700     88  ABEND-4001-WRITE-ERROR                     VALUE +4001.  00970000
009800     88  ABEND-4002-READ-ERROR                      VALUE +4002.  00980000
009900     88  ABEND-4003-CTRL-CARD-ERROR                 VALUE +4003.  00990000
010000     88  ABEND-4004-TABLE-ERROR                     VALUE +4004.  01000000
010100     88  ABEND-4005-OPEN-ERROR                      VALUE +4005.  01010000
010200     88  ABEND-4006-CLOSE-ERROR                     VALUE +4006.  01020000
010300     88  ABEND-4007-SEQUENCE-ERROR                  VALUE +4007.  01030000
010400     88  ABEND-4008-DATA-ERROR                      VALUE +4008.  01040000
010500     88  ABEND-4009-KEY-DATA-ERROR                  VALUE +4009.  01050000
010600     88  ABEND-4013-DB2-ERROR                       VALUE +4013.  01060000
010700     88  ABEND-4019-CAL-SUB-ERROR                   VALUE +4019.  01070000
010800     88  ABEND-4020-MQ-ERROR                        VALUE +4020.  01080000
010900     88  ABEND-4444-FORCED-ABEND                    VALUE +4444.  01090000
011000                                                                  01100000
011100******************************************************************01110000
011600****INPUT COPYBOOK                                                01160000
011700     COPY RCRD122.                                                01170000
011800                                                                  01180000
011900***************************************************************** 01190011
012000*  *** DB2 MESSAGE AREAS ****                                   * 01200011
012100***************************************************************** 01210011
012110     COPY DPWS004.                                                01211011
012120                                                                  01212011
012130*---------------------------------------------------------------* 01213011
012140*    DB2 AREA FOR TRECEIV - RECEIVER TABLE                      * 01214011
012150*---------------------------------------------------------------* 01215011
012160     EXEC SQL                                                     01216011
012170          INCLUDE TRECEIV                                         01217011
012180     END-EXEC.                                                    01218011
012190                                                                  01219011
012191*---------------------------------------------------------------* 01219114
012192*    DB2 AREA FOR TPURITM - PO ITEM  TABLE                      * 01219214
012193*---------------------------------------------------------------* 01219314
012194     EXEC SQL                                                     01219414
012195          INCLUDE TPURITM                                         01219514
012196     END-EXEC.                                                    01219614
012197                                                                  01219714
012198*---------------------------------------------------------------* 01219814
012199*    DB2 AREA FOR SUT_OTBND_CART OUTBOUND CARTON TABLE          * 01219914
012200*---------------------------------------------------------------* 01220014
012201     EXEC SQL                                                     01220114
012202          INCLUDE SUT00024                                        01220214
012203     END-EXEC.                                                    01220314
012204                                                                  01220414
012205*---------------------------------------------------------------* 01220514
012206*    DB2 AREA FOR SUT_OTBND_UPC  OUTBOUND UPC TABLE             * 01220614
012207*---------------------------------------------------------------* 01220714
012208     EXEC SQL                                                     01220814
012209          INCLUDE SUT00028                                        01220914
012210     END-EXEC.                                                    01221014
012211*---------------------------------------------------------------* 01221114
012212*    DB2 AREA FOR COMMUNICATIONS                                * 01221214
012213*---------------------------------------------------------------* 01221314
012214     EXEC SQL                                                     01221414
012215          INCLUDE SQLCA                                           01221514
012216     END-EXEC.                                                    01221614
012217                                                                  01221714
012218                                                                  01221814
012220 PROCEDURE DIVISION.                                              01222011
012300******************************************************************01230000
012400 0000-MAINLINE-PROCESSING.                                        01240000
012500                                                                  01250000
012600     PERFORM 1000-INITIALIZATION.                                 01260000
012700     IF PS-NOT-END-OF-FILE                                        01270000
012800        PERFORM 2000-CREATE-EXTRACT-DATA                          01280000
013000     END-IF                                                       01300000
013010                                                                  01301000
013100     PERFORM 9000-WRAPUP.                                         01310000
013200     GOBACK.                                                      01320000
013300                                                                  01330000
013400******************************************************************01340000
013500* INITIALIZATION ROUTINE                                          01350000
013600******************************************************************01360000
013700 1000-INITIALIZATION.                                             01370000
013800                                                                  01380000
013900     DISPLAY ' '.                                                 01390000
014000     DISPLAY '*******************************************'.       01400000
014100     DISPLAY '***  PROGRAM NAME:  '  PC-PGM-NAME.                 01410000
014200     DISPLAY ' '.                                                 01420000
014300                                                                  01430000
014400     OPEN INPUT  ERROR-COUNT-FILE                                 01440000
014500          OUTPUT OUTPUT-EMAIL-FILE.                               01450000
014600                                                                  01460000
014700     PERFORM 1100-READ-INPUT-FILE.                                01470000
014800                                                                  01480000
014900******************************************************************01490000
015000* READ A RECORD FROM THE INPUT TRAILER EXTRACT FILE               01500000
015100******************************************************************01510000
015200 1100-READ-INPUT-FILE.                                            01520000
015300                                                                  01530000
015400     READ ERROR-COUNT-FILE INTO RC122-ERROR-COUNTS-REC            01540000
015500        AT END                                                    01550000
015600           SET PS-END-OF-INPUT-FILE TO TRUE.                      01560000
015700                                                                  01570000
015800     IF PS-END-OF-INPUT-FILE                                      01580000
016000           DISPLAY ' '                                            01600000
016100           DISPLAY 'INPUT FILE IS EMPTY'                          01610000
016200           DISPLAY ' '                                            01620000
016700     END-IF.                                                      01670000
016800                                                                  01680000
016900******************************************************************01690000
017000* PROCESS THE INPUT RECORD                                        01700000
017100******************************************************************01710000
017200 2000-CREATE-EXTRACT-DATA.                                        01720000
017201     DISPLAY 'PROCESS BEG TIMESTAMP: ' RC122-BEG-TIMESTAMP        01720148
017202     PERFORM 2100-SEL-CRTN-UNIT-CNT.                              01720210
017203     PERFORM 2200-SEL-RECEIVER-CNT.                               01720319
017204     PERFORM 3000-FORMAT-OUTPUT-FILE.                             01720420
017205                                                                  01720519
017206******************************************************************01720619
017207* SELECT SML CARTONS AND UNITS CREATED IN A TIME FRAME FROM       01720719
017208* THIRD PARTY PROCESSING                                          01720819
017209******************************************************************01720919
017210                                                                  01721019
017211 2100-SEL-CRTN-UNIT-CNT.                                          01721119
017212                                                                  01721228
017213     MOVE RC122-BEG-TIMESTAMP TO PV-TIMESTAMP.                    01721343
017214                                                                  01721428
017215     EXEC SQL                                                     01721519
017216       SELECT COUNT(DISTINCT C.SHIPT_UNT_ID)                      01721628
017217            , SUM(B.SHPD_UNT_QTY)                                 01721719
017218       INTO :PV-SML-COUNT  :DN-SML-NULL                           01721849
017219          , :PV-UNIT-COUNT :DN-SHIPT-QTY-NULL                     01721949
017220         FROM TRECEIV A                                           01722019
017221            , SUT_OTBND_UPC B                                     01722119
017230            , SUT_OTBND_CART C                                    01723019
017231       WHERE DATE(A.VERFYD_TMST) >= :PV-TIMESTAMP-DATE            01723128
017232         AND DATE(A.VERFYD_TMST) <= CURRENT DATE                  01723228
017233         AND A.VERFYD_TMST >=  :RC122-BEG-TIMESTAMP               01723328
017234         AND A.VERFYD_TMST <=  CURRENT TIMESTAMP                  01723428
017235         AND A.CRE_UID = 'THRDPRTY'                               01723528
017236         AND B.TRN_NBR = A.ORD_NBR                                01723628
017237         AND B.RCVR_SEQ_NBR = A.REC_SEQ_NBR                       01723728
017238         AND C.SHIPT_UNT_ID = B.SHIPT_UNT_ID                      01723828
017239       WITH UR                                                    01723928
017240     END-EXEC                                                     01724019
017241                                                                  01724119
017242     EVALUATE TRUE                                                01724219
017243         WHEN SQLCODE = +0                                        01724319
017244              IF DN-SML-NULL = -1                                 01724449
017245                 MOVE 0 TO PV-SML-COUNT                           01724549
017246              END-IF                                              01724649
017247              IF DN-SHIPT-QTY-NULL = -1                           01724749
017248                 MOVE 0 TO PV-UNIT-COUNT                          01724849
017249              END-IF                                              01724949
017251         WHEN SQLCODE = +100                                      01725149
017252              MOVE  0  TO  PV-SML-COUNT                           01725249
017253                           PV-UNIT-COUNT                          01725349
017254                                                                  01725449
017255         WHEN SQLWARN0 NOT = SPACES                               01725549
017256         WHEN SQLCODE  NOT = ZERO                                 01725649
017257              MOVE SQLCODE              TO PV-DISP-SQLCODE        01725749
017258              DISPLAY  ' RCKUT193-2100-'                          01725849
017259                       ' SQL:'             PV-DISP-SQLCODE        01725949
017260                       ' BEG TMST'         RC122-BEG-TIMESTAMP    01726049
017261              DISPLAY '*****************************************' 01726149
017262              DISPLAY '*ABEND                                  *' 01726249
017263              DISPLAY '*PROGRAM   = RCKUT193                   *' 01726349
017264              DISPLAY '*DB2 OPER  = SELECT ON TRECEIV          *' 01726449
017265              DISPLAY '*PARAGRAPH = 2100-SEL-CRTN-UNIT-CNT     *' 01726549
017266              DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE               01726649
017267              DISPLAY '*****************************************' 01726749
017268             MOVE '2100-SEL-CRTN-UNIT-CNT'  TO PV-PARAGRAPH-NAME  01726849
017269             PERFORM 9100-SQL-ABEND                               01726949
017270     END-EVALUATE.                                                01727049
017271******************************************************************01727149
017272* SELECT RECEIVER COUNT IN A TIME FRAME FROM                      01727249
017273* THIRD PARTY PROCESSING                                          01727349
017274******************************************************************01727449
017275                                                                  01727549
017276 2200-SEL-RECEIVER-CNT.                                           01727649
017277                                                                  01727749
017278     EXEC SQL                                                     01727849
017279       SELECT COUNT(A.ORD_NBR)                                    01727949
017280        INTO :PV-RCVR-COUNT                                       01728050
017281          FROM TRECEIV A                                          01728149
017282         WHERE DATE(A.VERFYD_TMST) >= :PV-TIMESTAMP-DATE          01728249
017283         AND DATE(A.VERFYD_TMST) <= CURRENT DATE                  01728349
017284         AND A.VERFYD_TMST >=  :RC122-BEG-TIMESTAMP               01728449
017285         AND A.VERFYD_TMST <=  CURRENT TIMESTAMP                  01728549
017286          AND A.CRE_UID = 'THRDPRTY'                              01728649
017287        WITH UR                                                   01728749
017294     END-EXEC                                                     01729410
017295                                                                  01729510
017296     EVALUATE TRUE                                                01729610
017297         WHEN SQLCODE = +0                                        01729710
017298              CONTINUE                                            01729850
017302         WHEN SQLCODE = +100                                      01730210
017303              MOVE  0  TO  PV-RCVR-COUNT                          01730310
017304                                                                  01730410
017305         WHEN SQLWARN0 NOT = SPACES                               01730510
017306         WHEN SQLCODE  NOT = ZERO                                 01730610
017307              MOVE SQLCODE              TO PV-DISP-SQLCODE        01730710
017308              DISPLAY  ' RCKUT193-2200-'                          01730810
017309                       ' SQL:'             PV-DISP-SQLCODE        01730910
017310                       ' BEG TMST'         RC122-BEG-TIMESTAMP    01731010
017311              DISPLAY '*****************************************' 01731110
017312              DISPLAY '*ABEND                                  *' 01731210
017313              DISPLAY '*PROGRAM   = RCKUT193                   *' 01731310
017314              DISPLAY '*DB2 OPER  = SELECT ON TRECEIV          *' 01731410
017315              DISPLAY '*PARAGRAPH = 2200-SEL-RECEIVER-CNT      *' 01731510
017316              DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE               01731610
017317              DISPLAY '*****************************************' 01731710
017318             MOVE '2200-SEL-RECEIVER-CNT '  TO PV-PARAGRAPH-NAME  01731810
017319             PERFORM 9100-SQL-ABEND                               01731910
017320     END-EVALUATE.                                                01732010
017330                                                                  01733010
017400 3000-FORMAT-OUTPUT-FILE.                                         01740010
017631                                                                  01763117
017632     INITIALIZE PV-MSG-RECORD.                                    01763217
017633       WRITE OUTPUT-EMAIL-RECORD FROM PV-MSG-RECORD               01763327
017634*                                                                 01763427
017635     INITIALIZE PV-MSG-RECORD.                                    01763536
017636     MOVE PC-COLON          TO PV-CURR-TIME-P1.                   01763645
017637     STRING  'DATE/TIME 945 DATA PROCESSED ' DELIMITED BY SIZE    01763740
017638             PV-TIMESTAMP-DATE   ' '        DELIMITED BY SIZE     01763843
017639             PV-TIMESTAMP-TIME   ' '        DELIMITED BY SIZE     01763944
017640             'CENTRAL TIME'                 DELIMITED BY SIZE     01764037
017641             INTO PV-MSG-RECORD                                   01764137
017642       WRITE OUTPUT-EMAIL-RECORD FROM PV-MSG-RECORD               01764237
017643                                                                  01764341
017644     INITIALIZE PV-MSG-RECORD.                                    01764440
017645     WRITE OUTPUT-EMAIL-RECORD FROM PV-MSG-RECORD                 01764540
017646                                                                  01764633
017647*                                                                 01764741
017648     MOVE PV-UNIT-COUNT           TO PV-DISP-NBR.                 01764841
017649     STRING  'UNITS PROCESSED           = ' DELIMITED BY SIZE     01764933
017650             PV-DISP-NBR                    DELIMITED BY SIZE     01765033
017651             INTO PV-MSG-RECORD                                   01765133
017652       WRITE OUTPUT-EMAIL-RECORD FROM PV-MSG-RECORD               01765233
017653*                                                                 01765333
017654     INITIALIZE PV-MSG-RECORD.                                    01765417
017660     MOVE PV-SML-COUNT            TO PV-DISP-NBR.                 01766017
017670     STRING  'UNIQUE SML CARTONS LOADED = ' DELIMITED BY SIZE     01767023
017680             PV-DISP-NBR                   DELIMITED BY SIZE      01768017
017690             INTO PV-MSG-RECORD                                   01769017
017691       WRITE OUTPUT-EMAIL-RECORD FROM PV-MSG-RECORD               01769117
017692*                                                                 01769217
017693*                                                                 01769317
017694     INITIALIZE PV-MSG-RECORD.                                    01769417
017695     MOVE PV-RCVR-COUNT           TO PV-DISP-NBR.                 01769517
017696     STRING  'UNIQUE RECEIVERS CREATED  = ' DELIMITED BY SIZE     01769623
017697             PV-DISP-NBR                   DELIMITED BY SIZE      01769717
017698             INTO PV-MSG-RECORD                                   01769817
017699       WRITE OUTPUT-EMAIL-RECORD FROM PV-MSG-RECORD               01769917
017700*                                                                 01770017
017701     INITIALIZE PV-MSG-RECORD.                                    01770117
017702       WRITE OUTPUT-EMAIL-RECORD FROM PV-MSG-RECORD               01770217
017703*                                                                 01770317
017710     INITIALIZE PV-MSG-RECORD.                                    01771017
017720     MOVE RC122-TOT-RECORDS-READ  TO PV-DISP-NBR.                 01772000
017730     STRING  'RECORDS READ              = ' DELIMITED BY SIZE     01773023
017740             PV-DISP-NBR                   DELIMITED BY SIZE      01774000
017741             INTO PV-MSG-RECORD                                   01774100
017742       WRITE OUTPUT-EMAIL-RECORD FROM PV-MSG-RECORD               01774200
017743*                                                                 01774300
017744     INITIALIZE PV-MSG-RECORD.                                    01774405
017745     MOVE RC122-VALID-RECORDS-READ TO PV-DISP-NBR.                01774500
017746     STRING  'VALID FILE WRITE COUNT    = ' DELIMITED BY SIZE     01774623
017747             PV-DISP-NBR                   DELIMITED BY SIZE      01774700
017748             INTO PV-MSG-RECORD                                   01774800
017749       WRITE OUTPUT-EMAIL-RECORD FROM PV-MSG-RECORD               01774900
017750*                                                                 01775000
017751     INITIALIZE PV-MSG-RECORD.                                    01775105
017752     MOVE RC122-INVLD-RECORDS-READ TO PV-DISP-NBR.                01775200
017760     STRING  'INVALID FILE WRITE COUNT  = ' DELIMITED BY SIZE     01776023
017770             PV-DISP-NBR                   DELIMITED BY SIZE      01777000
017780             INTO PV-MSG-RECORD                                   01778000
017790       WRITE OUTPUT-EMAIL-RECORD FROM PV-MSG-RECORD               01779000
017791*                                                                 01779109
017792     INITIALIZE PV-MSG-RECORD.                                    01779209
017793     WRITE OUTPUT-EMAIL-RECORD FROM PV-MSG-RECORD                 01779309
017800*                                                                 01780000
017810     INITIALIZE PV-MSG-RECORD.                                    01781005
017811     STRING  '     **ERROR COUNTS**      ' DELIMITED BY SIZE      01781102
017813             INTO PV-MSG-RECORD                                   01781300
017815       WRITE OUTPUT-EMAIL-RECORD FROM PV-MSG-RECORD               01781500
017816     INITIALIZE PV-MSG-RECORD.                                    01781608
017817     WRITE OUTPUT-EMAIL-RECORD FROM PV-MSG-RECORD                 01781708
017818*                                                                 01781800
017819     INITIALIZE PV-MSG-RECORD.                                    01781905
017820     MOVE RC122-NON-NUMERIC-CNT  TO PV-DISP-NBR.                  01782000
017821     STRING  'ERRORS OF NON NUMERIC DATA      =' DELIMITED BY SIZE01782125
017822             PV-DISP-NBR                   DELIMITED BY SIZE      01782200
017823             INTO PV-MSG-RECORD                                   01782300
017824       WRITE OUTPUT-EMAIL-RECORD FROM PV-MSG-RECORD               01782400
017825*                                                                 01782500
017826     INITIALIZE PV-MSG-RECORD.                                    01782605
017827     MOVE RC122-DATA-MISSING-CNT TO PV-DISP-NBR.                  01782700
017828     STRING  'ERRORS OF MISSING DATA          =' DELIMITED BY SIZE01782825
017829             PV-DISP-NBR                   DELIMITED BY SIZE      01782900
017830             INTO PV-MSG-RECORD                                   01783000
017831       WRITE OUTPUT-EMAIL-RECORD FROM PV-MSG-RECORD               01783100
017832*                                                                 01783200
017833     INITIALIZE PV-MSG-RECORD.                                    01783305
017834     MOVE RC122-PO-NOT-FND-CNT   TO PV-DISP-NBR.                  01783400
017835     STRING  'ERRORS OF PO NOT FOUND          =' DELIMITED BY SIZE01783525
017836             PV-DISP-NBR                   DELIMITED BY SIZE      01783600
017837             INTO PV-MSG-RECORD                                   01783700
017838       WRITE OUTPUT-EMAIL-RECORD FROM PV-MSG-RECORD               01783800
017839*                                                                 01783900
017840     INITIALIZE PV-MSG-RECORD.                                    01784005
017841     MOVE RC122-SKU-NOT-ON-PO-CNT TO PV-DISP-NBR.                 01784151
017842     STRING  'ERRORS OF SKU NOT FOUND ON PO   =' DELIMITED BY SIZE01784225
017843             PV-DISP-NBR                      DELIMITED BY SIZE   01784302
017844             INTO PV-MSG-RECORD                                   01784400
017845       WRITE OUTPUT-EMAIL-RECORD FROM PV-MSG-RECORD               01784500
017846*                                                                 01784600
017847*                                                                 01784751
017848     INITIALIZE PV-MSG-RECORD.                                    01784851
017849     MOVE RC122-SKU-NOT-FND-CNT  TO PV-DISP-NBR.                  01784951
017850     STRING  'ERRORS OF SKU NOT FOUND         =' DELIMITED BY SIZE01785052
017851             PV-DISP-NBR                      DELIMITED BY SIZE   01785151
017852             INTO PV-MSG-RECORD                                   01785251
017853       WRITE OUTPUT-EMAIL-RECORD FROM PV-MSG-RECORD               01785351
017854*                                                                 01785451
017855     INITIALIZE PV-MSG-RECORD.                                    01785551
017856     MOVE RC122-SML-EXISTS-CNT   TO PV-DISP-NBR.                  01785651
017857     STRING  'ERRORS OF SML ALREADY EXISTS    =' DELIMITED BY SIZE01785751
017858             PV-DISP-NBR                      DELIMITED BY SIZE   01785851
017859             INTO PV-MSG-RECORD                                   01785951
017860       WRITE OUTPUT-EMAIL-RECORD FROM PV-MSG-RECORD               01786051
017861*                                                                 01786151
017862     INITIALIZE PV-MSG-RECORD.                                    01786251
017863     MOVE RC122-STR-NOT-FND-CNT  TO PV-DISP-NBR.                  01786351
017864     STRING  'ERRORS OF STORE NBR NOT FOUND   =' DELIMITED BY SIZE01786451
017865             PV-DISP-NBR                      DELIMITED BY SIZE   01786551
017866             INTO PV-MSG-RECORD                                   01786651
017867       WRITE OUTPUT-EMAIL-RECORD FROM PV-MSG-RECORD               01786751
017868*                                                                 01786851
017869     INITIALIZE PV-MSG-RECORD.                                    01786951
017870     MOVE RC122-3RD-DC-NOT-FND-CNT TO PV-DISP-NBR.                01787051
017871     STRING 'ERRORS OF 3RD PARTY DC NOT FOUND =' DELIMITED BY SIZE01787151
017872             PV-DISP-NBR                     DELIMITED BY SIZE    01787251
017873             INTO PV-MSG-RECORD                                   01787351
017874       WRITE OUTPUT-EMAIL-RECORD FROM PV-MSG-RECORD               01787451
017875*                                                                 01787551
017876     INITIALIZE PV-MSG-RECORD.                                    01787651
017877     MOVE RC122-TO-DC-NOT-FND-CNT TO PV-DISP-NBR.                 01787751
017878     STRING  'ERRORS OF SHIP TO DC NOT FOUND  =' DELIMITED BY SIZE01787851
017879             PV-DISP-NBR                      DELIMITED BY SIZE   01787951
017880             INTO PV-MSG-RECORD                                   01788051
017881       WRITE OUTPUT-EMAIL-RECORD FROM PV-MSG-RECORD               01788151
017882*                                                                 01788251
017883     INITIALIZE PV-MSG-RECORD.                                    01788351
017884     MOVE RC122-SML-DC-NOT-FND-CNT TO PV-DISP-NBR.                01788451
017885     STRING  'ERRORS OF SML DC NOT FOUND      =' DELIMITED BY SIZE01788551
017886             PV-DISP-NBR                      DELIMITED BY SIZE   01788651
017887             INTO PV-MSG-RECORD                                   01788751
017888       WRITE OUTPUT-EMAIL-RECORD FROM PV-MSG-RECORD               01788851
017889*                                                                 01788951
017890     INITIALIZE PV-MSG-RECORD.                                    01789051
017891     MOVE RC122-SRV-DC-NOT-FND-CNT TO PV-DISP-NBR.                01789151
017892     STRING  'ERRORS OF SERVICE DC NOT FOUND  =' DELIMITED BY SIZE01789251
017893             PV-DISP-NBR                       DELIMITED BY SIZE  01789351
017894             INTO PV-MSG-RECORD                                   01789451
017895       WRITE OUTPUT-EMAIL-RECORD FROM PV-MSG-RECORD.              01789551
017900*                                                                 01790051
027000******************************************************************02700000
027100* CLOSE INPUT/OUTPUT FILES AND DISPLAY PROGRAM COUNTS             02710000
027200******************************************************************02720000
027300 9000-WRAPUP.                                                     02730000
027400                                                                  02740000
027500     CLOSE ERROR-COUNT-FILE                                       02750000
027600           OUTPUT-EMAIL-FILE.                                     02760000
027900                                                                  02790000
027910*-----------------------------------------------------------------02791010
027920 9100-SQL-ABEND.                                                  02792010
027930     DISPLAY '9100-SQL-ABEND'.                                    02793010
027940     DISPLAY '** ABEND     **'.                                   02794010
027950     DISPLAY '** PROGRAM   ** =  RCKUT193'.                       02795010
027960     DISPLAY '** PARAGRAPH ** = ' PV-PARAGRAPH-NAME.              02796010
027980                                                                  02798010
027990******************************************************************02799010
027991* THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION STATE-    02799110
027992* MENTS THAT ARE REQUIRED TO UTILIZE THE DB2 ABEND MODULE         02799210
027993* 'DSNTIAR' AND CONVERT THE SQLCA INFORMATION INTO A READABLE     02799310
027994* FORMAT.                                                         02799410
027995******************************************************************02799510
027996     COPY DPPD004.                                                02799610
027997                                                                  02799710
027998     MOVE +4013                  TO ABEND-CODE.                   02799810
027999     CALL 'ILBOABN0' USING ABEND-CODE.                            02799910
028000/                                                                 02800010
028010******************************************************************02801000
