000100 IDENTIFICATION DIVISION.                                         00010002
000200                                                                  00020002
000300 PROGRAM-ID.             RCKRP019.                                00030002
000400 AUTHOR.                 DENISE HAHN.                             00040002
000500 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00050002
000600 DATE-WRITTEN            APRIL, 1998.                             00060050
000800                                                                  00080002
000900******************************************************************00090002
001000*                                                                 00100002
001100*  THIS PROGRAM CREATES THE MONTHLY RECEIPT FLOW ANALYSIS REPORT. 00110002
001200*                                                                 00120002
001300*  THE INPUT FILE SHOULD BE SORTED IN THE FOLLOWING SEQUENCE:     00130005
001400*      -DIVISION, BUYER, DEPT, PURCHASE ORDER SEQUENCE            00140002
001500******************************************************************00150002
002500*----------------------------------------------------------------*00151092
002200* 2014-11-10 CHERI PARMLEY      CHG0098147                       *00152093
002300*            EXPANDED PO# FROM 7 TO 8 DIGITS                     *00153092
002500*----------------------------------------------------------------*00154092
001600                                                                  00160002
001700                                                                  00170002
001800 ENVIRONMENT DIVISION.                                            00180002
001900 INPUT-OUTPUT SECTION.                                            00190002
002000                                                                  00200002
002100 FILE-CONTROL.                                                    00210002
002200                                                                  00220002
002300     SELECT INPUT-FILE        ASSIGN TO IN01.                     00230002
002501                                                                  00250152
002502     SELECT DATE-FILE         ASSIGN TO IN02.                     00250285
002503                                                                  00250385
002510     SELECT REPORT-FILE       ASSIGN TO RPT01.                    00251052
002520                                                                  00252052
002530     SELECT SUMMARY-FILE      ASSIGN TO OUT02.                    00253052
002600                                                                  00260002
002700                                                                  00270002
002800 DATA DIVISION.                                                   00280002
002900                                                                  00290002
003000 FILE SECTION.                                                    00300002
003100 FD  INPUT-FILE                                                   00310002
003200     RECORDING MODE IS F                                          00320002
003300     LABEL RECORDS ARE STANDARD                                   00330002
003400     BLOCK CONTAINS 0 RECORDS.                                    00340002
003500 01  INPUT-RECORD                     PIC X(250).                 00350005
003600                                                                  00360002
003610 FD  DATE-FILE                                                    00361085
003620     RECORDING MODE IS F                                          00362085
003630     LABEL RECORDS ARE STANDARD                                   00363085
003640     BLOCK CONTAINS 0 RECORDS.                                    00364085
003650 01  DATE-RECORD                      PIC X(080).                 00365085
003660                                                                  00366085
003700                                                                  00370002
003800 FD  REPORT-FILE                                                  00380002
003900     RECORDING MODE IS F                                          00390002
004000     BLOCK CONTAINS 0 RECORDS                                     00400002
004100     LABEL RECORDS ARE OMITTED.                                   00410002
004200 01  REPORT-RECORD                    PIC  X(132).                00420005
004300                                                                  00430002
004310                                                                  00431052
004320 FD  SUMMARY-FILE                                                 00432052
004330     RECORDING MODE IS F                                          00433052
004340     BLOCK CONTAINS 0 RECORDS                                     00434052
004350     LABEL RECORDS ARE OMITTED.                                   00435052
004360 01  SUMMARY-RECORD                   PIC  X(250).                00436052
004370                                                                  00437052
004400                                                                  00440002
004500                                                                  00450002
004600 WORKING-STORAGE SECTION.                                         00460002
004700 01  PS-SWITCHES.                                                 00470002
004800     05  PS-INPUT-EOF-SW               PIC  X(03)    VALUE 'N'.   00480005
004900         88  PS-INPUT-EOF                            VALUE 'Y'.   00490005
005000         88  PS-INPUT-NOT-EOF                        VALUE 'N'.   00500005
005100     05  PS-NEW-PAGE-SW                PIC  X(03)    VALUE 'N'.   00510005
005200         88  PS-NEW-PAGE                             VALUE 'Y'.   00520005
005300         88  PS-NOT-NEW-PAGE                         VALUE 'N'.   00530005
005310     05  PS-NO-DETAIL-SW               PIC  X(03)    VALUE 'N'.   00531035
005320         88  PS-NO-DETAIL                            VALUE 'Y'.   00532035
005400                                                                  00540004
005500 01  CD-CPU-DATE.                                                 00550004
005600     03  CD-YEAR                       PIC  9(02)    VALUE ZERO.  00560005
005700     03  CD-MONTH                      PIC  9(02)    VALUE ZERO.  00570005
005800     03  CD-DAY                        PIC  9(02)    VALUE ZERO.  00580005
005900                                                                  00590004
006000 01  CT-CPU-TIME.                                                 00600004
006100     03  CT-HOUR                       PIC  9(02)    VALUE ZERO.  00610005
006200     03  CT-MINUTE                     PIC  9(02)    VALUE ZERO.  00620005
006300     03  FILLER                        PIC  9(04)    VALUE ZERO.  00630005
006400                                                                  00640004
006410 01  PV-ABEND-FIELDS.                                             00641005
006420     05  PV-RECORD-COUNT              PIC  9(9)  VALUE ZERO.      00642037
006421     05  PV-SUMMARY-COUNT             PIC  9(9)  VALUE ZERO.      00642153
006422                                                                  00642237
006423     05  PV-SQLCODE                   PIC  9(9)  VALUE ZERO.      00642337
006424     05  PV-ABEND-CODE                PIC S9(4)  VALUE +0         00642437
006425                                                 COMP SYNC.       00642537
006430     05  PV-ABEND-PROGRAM             PIC  X(8)  VALUE 'RCKRP019'.00643015
006440     05  PV-ABEND-PARAGRAPH           PIC  X(50) VALUE SPACES.    00644015
006450     05  PV-ABEND-OPERATION           PIC  X(50) VALUE SPACES.    00645015
006460     05  PV-ABEND-STRUCTURE-1         PIC  X(8)  VALUE SPACES.    00646015
006470     05  PV-ABEND-STRUCTURE-2         PIC  X(8)  VALUE SPACES.    00647015
006480     05  PV-ABEND-STRUCTURE-3         PIC  X(8)  VALUE SPACES.    00648015
006490     05  PV-DB2-OPERATION-MSG-1       PIC  X(79) VALUE SPACES.    00649011
006491     05  PV-DB2-OPERATION-MSG-2       PIC  X(79) VALUE SPACES.    00649111
006492     05  PV-DB2-OPERATION-MSG-3       PIC  X(79) VALUE SPACES.    00649211
006493     05  PV-DB2-OPERATION-MSG-4       PIC  X(79) VALUE SPACES.    00649311
006494     05  PV-DB2-TABLE-NAME            PIC  X(8)  VALUE SPACES.    00649405
006495                                                                  00649505
006500 01  PC-PROGRAM-CONSTANTS.                                        00650005
006602     05  PC-DESCRIPTION-2             PIC  X(20)    VALUE         00660278
006603             'DEPARTMENT TOTAL    '.                              00660378
006604     05  PC-DESCRIPTION-3             PIC  X(20)    VALUE         00660478
006605             'BUYER TOTAL         '.                              00660578
006606     05  PC-DESCRIPTION-4             PIC  X(20)    VALUE         00660678
006607             'DIVISION TOTAL      '.                              00660778
006608     05  PC-DESCRIPTION-5             PIC  X(20)    VALUE         00660878
006609             'COMPANY TOTAL       '.                              00660978
006610     05  PC-DESCRIPTION-6             PIC  X(20)    VALUE         00661078
006611             'VENDOR TOTAL        '.                              00661178
006620     05  PC-CURRENT-PROGRAM-NAME      PIC  X(08)    VALUE         00662014
006700                                          'RCKRP019'.             00670005
006800     05  PC-OPERCO-CDE                PIC X(02)     VALUE '03'.   00680014
006810     05  PC-DPT                       PIC X(03)     VALUE 'DPT'.  00681014
006811     05  PC-1                         PIC 9(01)     VALUE 1.      00681114
006812     05  PC-ONE                       PIC 9(01)     VALUE 1.      00681253
006813     05  PC-TWO                       PIC 9(01)     VALUE 2.      00681353
006814     05  PC-THREE                     PIC 9(01)     VALUE 3.      00681453
006815     05  PC-FOUR                      PIC 9(01)     VALUE 4.      00681553
006816     05  PC-LINE-LIMIT                PIC S9(04)    VALUE +60     00681653
006817                                                    COMP SYNC.    00681753
006818 01  PV-DATE-RECORD.                                              00681885
006819     05  PV-DATE-START-MM             PIC X(02) VALUE SPACE.      00681985
006820     05  FILLER                       PIC X(01) VALUE '/'.        00682085
006821     05  PV-DATE-START-DD             PIC X(02) VALUE SPACE.      00682185
006822     05  FILLER                       PIC X(01) VALUE '/'.        00682285
006823     05  PV-DATE-START-CCYY           PIC X(04) VALUE SPACE.      00682385
006824     05  FILLER                       PIC X(01) VALUE SPACE.      00682485
006825     05  PV-DATE-END-MM               PIC X(02) VALUE SPACE.      00682585
006826     05  FILLER                       PIC X(01) VALUE '/'.        00682685
006827     05  PV-DATE-END-DD               PIC X(02) VALUE SPACE.      00682785
006828     05  FILLER                       PIC X(01) VALUE '/'.        00682885
006829     05  PV-DATE-END-CCYY             PIC X(04) VALUE SPACE.      00682985
006830     05  FILLER                       PIC X(01) VALUE SPACE.      00683085
006831     05  PV-DATE-FISCAL-PERIOD        PIC X(02) VALUE SPACES.     00683187
006832     05  FILLER                       PIC X(01) VALUE SPACE.      00683285
006833     05  PV-DATE-FISCAL-QUARTER       PIC 9(01) VALUE ZERO.       00683385
006834     05  FILLER                       PIC X(01)  VALUE SPACE.     00683485
006835     05  PV-DATE-SEASON               PIC X(06)  VALUE SPACES.    00683585
006836     05  FILLER                       PIC X(47)  VALUE SPACES.    00683685
006840                                                                  00684009
006900 01  PV-PROGRAM-VARIABLES.                                        00690003
007300     05  PV-LINE-COUNT                PIC S9(04)    VALUE +0      00730046
007400                                                    COMP SYNC.    00740006
007700     05  PV-PAGE-COUNT                PIC S9(04)    VALUE ZERO.   00770011
007800     05  PV-CURRENT-DB2-DATE          PIC  X(10)    VALUE SPACES. 00780006
007900                                                                  00790004
008000  01  PC-WORK-FIELDS.                                             00800087
008210      05  PV-MONTH-FEBRUARY     PIC  X(02)   VALUE '01'.          00821087
008300      05  PV-MONTH-MARCH        PIC  X(02)   VALUE '02'.          00830087
008600      05  PV-MONTH-APRIL        PIC  X(02)   VALUE '03'.          00860087
008700      05  PV-MONTH-MAY          PIC  X(02)   VALUE '04'.          00870087
008800      05  PV-MONTH-JUNE         PIC  X(02)   VALUE '05'.          00880087
008900      05  PV-MONTH-JULY         PIC  X(02)   VALUE '06'.          00890087
009000      05  PV-MONTH-AUGUST       PIC  X(02)   VALUE '07'.          00900087
009100      05  PV-MONTH-SEPTEMBER    PIC  X(02)   VALUE '08'.          00910087
009200      05  PV-MONTH-OCTOBER      PIC  X(02)   VALUE '09'.          00920087
009300      05  PV-MONTH-NOVEMBER     PIC  X(02)   VALUE '10'.          00930087
009400      05  PV-MONTH-DECEMBER     PIC  X(02)   VALUE '11'.          00940087
009410      05  PV-MONTH-JANUARY      PIC  X(02)   VALUE '12'.          00941087
009900*                                                                 00990004
010000     05  PV-WORK-MONTH-YEAR           PIC  X(16)    VALUE SPACE.  01000005
010100     05  PV-WORK-MONTH-JAN.                                       01010004
010200         10  FILLER                   PIC  X(09)    VALUE         01020005
010300                                      'JANUARY, '.                01030004
010400         10  PV-WORK-YY-JAN           PIC  X(04)    VALUE SPACES. 01040005
010500         10  FILLER                   PIC  X(03)    VALUE SPACES. 01050005
010600     05  PV-WORK-MONTH-FEB.                                       01060004
010700         10  FILLER                   PIC  X(10)    VALUE         01070005
010800                                      'FEBRUARY, '.               01080004
010900         10  PV-WORK-YY-FEB           PIC  X(04)    VALUE SPACES. 01090005
011000         10  FILLER                   PIC  X(02)    VALUE SPACES. 01100005
011100     05  PV-WORK-MONTH-MAR.                                       01110004
011200         10  FILLER                   PIC  X(07)    VALUE         01120005
011300                                      'MARCH, '.                  01130004
011400         10  PV-WORK-YY-MAR           PIC  X(04)    VALUE SPACES. 01140005
011500         10  FILLER                   PIC  X(05)    VALUE SPACES. 01150005
011600     05  PV-WORK-MONTH-APR.                                       01160004
011700         10  FILLER                   PIC  X(07)    VALUE         01170005
011800                                      'APRIL, '.                  01180004
011900         10  PV-WORK-YY-APR           PIC  X(04)    VALUE SPACES. 01190005
012000         10  FILLER                   PIC  X(05)    VALUE SPACES. 01200005
012100     05  PV-WORK-MONTH-MAY.                                       01210004
012200         10  FILLER                   PIC  X(05)    VALUE         01220005
012300                                      'MAY, '.                    01230004
012400         10  PV-WORK-YY-MAY           PIC  X(04)    VALUE SPACES. 01240005
012500         10  FILLER                   PIC  X(07)    VALUE SPACES. 01250005
012600     05  PV-WORK-MONTH-JUN.                                       01260004
012700         10  FILLER                   PIC  X(06)    VALUE         01270005
012800                                      'JUNE, '.                   01280004
012900         10  PV-WORK-YY-JUN           PIC  X(04)    VALUE SPACES. 01290005
013000         10  FILLER                   PIC  X(06)    VALUE SPACES. 01300005
013100     05  PV-WORK-MONTH-JUL.                                       01310004
013200         10  FILLER                   PIC  X(06)    VALUE         01320005
013300                                      'JULY, '.                   01330004
013400         10  PV-WORK-YY-JUL           PIC  X(04)    VALUE SPACES. 01340005
013500         10  FILLER                   PIC  X(06)    VALUE SPACES. 01350005
013600     05  PV-WORK-MONTH-AUG.                                       01360004
013700         10  FILLER                   PIC  X(08)    VALUE         01370005
013800                                      'AUGUST, '.                 01380004
013900         10  PV-WORK-YY-AUG           PIC  X(04)    VALUE SPACES. 01390005
014000         10  FILLER                   PIC  X(04)    VALUE SPACES. 01400005
014100     05  PV-WORK-MONTH-SEP.                                       01410004
014200         10  FILLER                   PIC  X(11)    VALUE         01420005
014300                                      'SEPTEMBER, '.              01430004
014400         10  PV-WORK-YY-SEP           PIC  X(04)    VALUE SPACES. 01440005
014500         10  FILLER                   PIC  X(01)    VALUE SPACES. 01450005
014600     05  PV-WORK-MONTH-OCT.                                       01460004
014700         10  FILLER                   PIC  X(09)    VALUE         01470005
014800                                      'OCTOBER, '.                01480004
014900         10  PV-WORK-YY-OCT           PIC  X(04)    VALUE SPACES. 01490005
015000         10  FILLER                   PIC  X(03)    VALUE SPACES. 01500005
015100     05  PV-WORK-MONTH-NOV.                                       01510004
015200         10  FILLER                   PIC  X(10)    VALUE         01520005
015300                                      'NOVEMBER, '.               01530004
015400         10  PV-WORK-YY-NOV           PIC  X(04)    VALUE SPACES. 01540005
015500         10  FILLER                   PIC  X(02)    VALUE SPACES. 01550005
015600     05  PV-WORK-MONTH-DEC.                                       01560004
015700         10  FILLER                   PIC  X(10)    VALUE         01570005
015800                                      'DECEMBER, '.               01580004
015900         10  PV-WORK-YY-DEC           PIC  X(04)    VALUE SPACES. 01590005
016000         10  FILLER                   PIC  X(02)    VALUE SPACES. 01600005
016100*                                                                 01610004
016200  01  PV-ACCUMULATOR-FIELDS.                                      01620004
016210*-------------------------------------------------                01621005
016220*  NUMBER OF RECEIVERS                                            01622005
016230*-------------------------------------------------                01623005
016300     05  PV-PO-RECEIVERS-CNT          PIC  9(03)   VALUE ZEROES.  01630022
016400     05  PV-VND-RECEIVERS-CNT         PIC  9(04)   VALUE ZEROES.  01640068
016410     05  PV-DPT-RECEIVERS-CNT         PIC  9(04)   VALUE ZEROES.  01641068
016500     05  PV-BYR-RECEIVERS-CNT         PIC  9(05)   VALUE ZEROES.  01650032
016600     05  PV-DIV-RECEIVERS-CNT         PIC  9(06)   VALUE ZEROES.  01660032
016700     05  PV-COM-RECEIVERS-CNT         PIC  9(07)   VALUE ZEROES.  01670032
016710*-------------------------------------------------                01671005
016720*  NUMBER OF PURCHASE ORDERS                                      01672005
016730*-------------------------------------------------                01673005
016900     05  PV-VND-PURCH-ORD-CNT         PIC  9(04)   VALUE ZEROES.  01690068
016910     05  PV-DPT-PURCH-ORD-CNT         PIC  9(04)   VALUE ZEROES.  01691068
017000     05  PV-BYR-PURCH-ORD-CNT         PIC  9(05)   VALUE ZEROES.  01700032
017100     05  PV-DIV-PURCH-ORD-CNT         PIC  9(06)   VALUE ZEROES.  01710032
017200     05  PV-COM-PURCH-ORD-CNT         PIC  9(07)   VALUE ZEROES.  01720032
017201*-------------------------------------------------                01720105
017202*  AVERAGE NUMBER OF RECEIVERS PER PURCHASE ORDER                 01720205
017203*-------------------------------------------------                01720305
017204     05  PV-VND-PO-RECVRS-AVG         PIC  9(04)V9 VALUE ZEROES.  01720468
017205     05  PV-DPT-PO-RECVRS-AVG         PIC  9(04)V9 VALUE ZEROES.  01720568
017206     05  PV-BYR-PO-RECVRS-AVG         PIC  9(05)V9 VALUE ZEROES.  01720668
017207     05  PV-DIV-PO-RECVRS-AVG         PIC  9(06)V9 VALUE ZEROES.  01720768
017208     05  PV-COM-PO-RECVRS-AVG         PIC  9(07)V9 VALUE ZEROES.  01720868
017210*-------------------------------------------------                01721005
017220*  UNITS RECEIVED/EXPECTED BY WEEK                                01722005
017230*-------------------------------------------------                01723005
017400     05  PV-WK1-ORD-COUNT             PIC  9(09)   VALUE ZEROES.  01740067
017410     05  PV-WK1-VND-COUNT             PIC  9(09)   VALUE ZEROES.  01741068
017500     05  PV-WK1-DPT-COUNT             PIC  9(09)   VALUE ZEROES.  01750067
017600     05  PV-WK1-BYR-COUNT             PIC  9(09)   VALUE ZEROES.  01760067
017700     05  PV-WK1-DIV-COUNT             PIC  9(09)   VALUE ZEROES.  01770067
017800     05  PV-WK1-COM-COUNT             PIC  9(09)   VALUE ZEROES.  01780067
017900*                                                                 01790004
018000     05  PV-WK2-ORD-COUNT             PIC  9(09)   VALUE ZEROES.  01800067
018010     05  PV-WK2-VND-COUNT             PIC  9(09)   VALUE ZEROES.  01801068
018100     05  PV-WK2-DPT-COUNT             PIC  9(09)   VALUE ZEROES.  01810067
018200     05  PV-WK2-BYR-COUNT             PIC  9(09)   VALUE ZEROES.  01820067
018300     05  PV-WK2-DIV-COUNT             PIC  9(09)   VALUE ZEROES.  01830067
018400     05  PV-WK2-COM-COUNT             PIC  9(09)   VALUE ZEROES.  01840067
018500*                                                                 01850004
018600     05  PV-WK3-ORD-COUNT             PIC  9(09)   VALUE ZEROES.  01860067
018610     05  PV-WK3-VND-COUNT             PIC  9(09)   VALUE ZEROES.  01861068
018700     05  PV-WK3-DPT-COUNT             PIC  9(09)   VALUE ZEROES.  01870067
018800     05  PV-WK3-BYR-COUNT             PIC  9(09)   VALUE ZEROES.  01880067
018900     05  PV-WK3-DIV-COUNT             PIC  9(09)   VALUE ZEROES.  01890067
019000     05  PV-WK3-COM-COUNT             PIC  9(09)   VALUE ZEROES.  01900067
019100*                                                                 01910004
019200     05  PV-WK4-ORD-COUNT             PIC  9(09)   VALUE ZEROES.  01920067
019210     05  PV-WK4-VND-COUNT             PIC  9(09)   VALUE ZEROES.  01921068
019300     05  PV-WK4-DPT-COUNT             PIC  9(09)   VALUE ZEROES.  01930067
019400     05  PV-WK4-BYR-COUNT             PIC  9(09)   VALUE ZEROES.  01940067
019500     05  PV-WK4-DIV-COUNT             PIC  9(09)   VALUE ZEROES.  01950067
019600     05  PV-WK4-COM-COUNT             PIC  9(09)   VALUE ZEROES.  01960067
019700*                                                                 01970004
019800     05  PV-WK5-ORD-COUNT             PIC  9(09)   VALUE ZEROES.  01980067
019810     05  PV-WK5-VND-COUNT             PIC  9(09)   VALUE ZEROES.  01981068
019900     05  PV-WK5-DPT-COUNT             PIC  9(09)   VALUE ZEROES.  01990067
020000     05  PV-WK5-BYR-COUNT             PIC  9(09)   VALUE ZEROES.  02000067
020100     05  PV-WK5-DIV-COUNT             PIC  9(09)   VALUE ZEROES.  02010067
020200     05  PV-WK5-COM-COUNT             PIC  9(09)   VALUE ZEROES.  02020067
020210*-------------------------------------------------                02021005
020220*  TOTAL ALL UNITS RECEIVED/EXPECTED                              02022005
020230*-------------------------------------------------                02023005
020400     05  PV-ALL-ORD-COUNT             PIC  9(11)   VALUE ZEROES.  02040067
020410     05  PV-ALL-VND-COUNT             PIC  9(11)   VALUE ZEROES.  02041068
020500     05  PV-ALL-DPT-COUNT             PIC  9(11)   VALUE ZEROES.  02050067
020600     05  PV-ALL-BYR-COUNT             PIC  9(11)   VALUE ZEROES.  02060067
020700     05  PV-ALL-DIV-COUNT             PIC  9(11)   VALUE ZEROES.  02070067
020800     05  PV-ALL-COM-COUNT             PIC  9(11)   VALUE ZEROES.  02080067
020810*-------------------------------------------------                02081005
020820*  UNITS RECEIVED/EXPECTED  DIVIDED BY  ALL UNITS                 02082005
020830*-------------------------------------------------                02083005
021000     05  PV-WK1-AMOUNT               PIC  9(01)V999 VALUE ZEROES. 02100022
021100     05  PV-WK2-AMOUNT               PIC  9(01)V999 VALUE ZEROES. 02110022
021200     05  PV-WK3-AMOUNT               PIC  9(01)V999 VALUE ZEROES. 02120022
021300     05  PV-WK4-AMOUNT               PIC  9(01)V999 VALUE ZEROES. 02130022
021400     05  PV-WK5-AMOUNT               PIC  9(01)V999 VALUE ZEROES. 02140022
021410*-------------------------------------------------                02141005
021420*  UNITS RECEIVED/EXPECTED BY WEEK PERCENTAGE                     02142005
021430*-------------------------------------------------                02143005
021600     05  PV-WK1-PERCENT              PIC  9(03)V9   VALUE ZEROES. 02160022
021700     05  PV-WK2-PERCENT              PIC  9(03)V9   VALUE ZEROES. 02170022
021800     05  PV-WK3-PERCENT              PIC  9(03)V9   VALUE ZEROES. 02180022
021900     05  PV-WK4-PERCENT              PIC  9(03)V9   VALUE ZEROES. 02190022
022000     05  PV-WK5-PERCENT              PIC  9(03)V9   VALUE ZEROES. 02200022
022100*                                                                 02210004
022200  01  PV-HOLD-FIELDS.                                             02220004
022300     05  PV-HOLD-PO-NMBR             PIC S9(09)     COMP.         02230005
022400     05  PV-HOLD-DEPT-NBR            PIC  X(03)     VALUE SPACES. 02240005
022500     05  PV-HOLD-DEPT-NAME           PIC  X(32)     VALUE SPACES. 02250005
022600     05  PV-HOLD-BUYER-NBR           PIC  X(03)     VALUE SPACES. 02260005
022700     05  PV-HOLD-BUYER-NAME          PIC  X(32)     VALUE SPACES. 02270005
022800     05  PV-HOLD-DIVISION-NBR        PIC  X(02)     VALUE SPACES. 02280005
022900     05  PV-HOLD-DIVISION-NAME       PIC  X(32)     VALUE SPACES. 02290005
023000     05  PV-HOLD-VENDOR-NAME         PIC  X(30)     VALUE SPACES. 02300050
023100     05  PV-PREV-VENDOR-NAME         PIC  X(30)     VALUE SPACES. 02310057
024100                                                                  02410005
027600                                                                  02760005
027700                                                                  02770005
027800 01  HL1-HEADING-LINE-1.                                          02780002
027900     05  FILLER                      PIC  X(46)    VALUE SPACES.  02790028
028000     05  FILLER                      PIC  X(26)    VALUE          02800003
028100     'RECEIPT FLOW ANALYSIS FOR '.                                02810003
028200     05  HL1-MONTH-YEAR              PIC  X(16)    VALUE SPACES.  02820003
028300     05  FILLER                      PIC  X(44)    VALUE SPACES.  02830028
028400                                                                  02840002
028500 01  HL2-HEADING-LINE-2.                                          02850002
028600     05  FILLER                      PIC  X(04)    VALUE SPACES.  02860057
028700     05  FILLER                      PIC  X(11)    VALUE          02870003
028800         'DIVISION:  '.                                           02880003
028900     05  HL2-DIVISION-NMBR           PIC  X(02)    VALUE SPACES.  02890083
028901     05  FILLER                      PIC  X(02)    VALUE SPACES.  02890183
028910     05  HL2-DIVISION                PIC  X(32)    VALUE SPACES.  02891083
029000     05  FILLER                      PIC  X(81)    VALUE SPACES.  02900083
029100                                                                  02910002
029200 01  HL3-HEADING-LINE-3.                                          02920049
029300     05  FILLER                      PIC  X(07)    VALUE SPACES.  02930057
029400     05  FILLER                      PIC  X(08)    VALUE          02940003
029500         'BUYER:  '.                                              02950003
029600     05  HL3-BUYER-NMBR              PIC  X(03)    VALUE SPACES.  02960083
029601     05  FILLER                      PIC  X(01)    VALUE SPACES.  02960183
029610     05  HL3-BUYER                   PIC  X(32)    VALUE SPACES.  02961083
029700     05  FILLER                      PIC  X(81)    VALUE SPACES.  02970083
029800                                                                  02980002
029900 01  HL4-HEADING-LINE-4.                                          02990002
030000     05  FILLER                      PIC  X(06)    VALUE SPACES.  03000050
030010     05  FILLER                      PIC  X(11)    VALUE          03001050
030020         'VENDOR NAME'.                                           03002050
030030     05  FILLER                      PIC  X(34)    VALUE SPACES.  03003078
030100     05  FILLER                      PIC  X(08)    VALUE          03010003
030200         'PURCHASE'.                                              03020011
030300     05  FILLER                      PIC  X(03)    VALUE SPACES.  03030052
030400     05  FILLER                      PIC  X(12)    VALUE          03040050
030500         'NO.RECEIVERS'.                                          03050050
030600     05  FILLER                      PIC  X(15)    VALUE SPACES.  03060078
030700     05  FILLER                      PIC  X(30)    VALUE          03070003
030800         'UNITS RECEIVED BY ARRIVAL WEEK'.                        03080011
030900     05  FILLER                      PIC  X(13)    VALUE SPACES.  03090078
031000                                                                  03100003
031100 01  HL5-HEADING-LINE-5.                                          03110003
031200     05  FILLER                      PIC  X(53)    VALUE SPACES.  03120078
031300     05  FILLER                      PIC  X(05)    VALUE          03130003
031400         'ORDER'.                                                 03140003
031500     05  FILLER                      PIC  X(05)    VALUE SPACES.  03150050
031600     05  FILLER                      PIC  X(10)    VALUE          03160050
031700         'FOR PERIOD'.                                            03170050
031800     05  FILLER                      PIC  X(05)    VALUE SPACES.  03180078
031900     05  FILLER                      PIC  X(06)    VALUE          03190003
032000         'WEEK 1'.                                                03200003
032100     05  FILLER                      PIC  X(06)    VALUE SPACES.  03210050
032200     05  FILLER                      PIC  X(06)    VALUE          03220003
032300         'WEEK 2'.                                                03230003
032400     05  FILLER                      PIC  X(06)    VALUE SPACES.  03240050
032500     05  FILLER                      PIC  X(06)    VALUE          03250003
032600         'WEEK 3'.                                                03260003
032700     05  FILLER                      PIC  X(06)    VALUE SPACES.  03270050
032800     05  FILLER                      PIC  X(06)    VALUE          03280003
032900         'WEEK 4'.                                                03290003
033000     05  FILLER                      PIC  X(06)    VALUE SPACES.  03300050
033100     05  FILLER                      PIC  X(06)    VALUE          03310003
033200         'WEEK 5'.                                                03320003
033400                                                                  03340003
033500                                                                  03350002
033600 01  DL1-DETAIL-LINE-1.                                           03360002
033700     05  FILLER                      PIC  X(02)    VALUE SPACES.  03370057
033800     05  FILLER                      PIC  X(13)    VALUE          03380003
033900         'DEPARTMENT:  '.                                         03390003
034000     05  DL1-DEPT-NO                 PIC  999      VALUE ZERO.    03400003
034100     05  FILLER                      PIC  X(01)    VALUE SPACE.   03410003
034200     05  DL1-DEPT-NAME               PIC  X(32)    VALUE SPACES.  03420003
034300     05  FILLER                      PIC  X(81)    VALUE SPACES.  03430057
034400                                                                  03440003
034500 01  DL2-DETAIL-LINE-2.                                           03450003
034510     05  FILLER                     PIC  X(06)     VALUE SPACES.  03451050
034520     05  DL2-VENDOR-NAME            PIC  X(30)     VALUE SPACES.  03452051
034600     05  FILLER                     PIC  X(15)     VALUE SPACES.  03460079
      *CLP 11/10/14                                                     03461092
034700     05  DL2-PO-NBR                 PIC  ZZZZZZZ9  VALUE ZERO.    03470092
034800     05  FILLER                     PIC  X(07)     VALUE SPACES.  03480092
034900     05  DL2-NO-RECEIVERS           PIC  ZZ9       VALUE ZERO.    03490031
035000     05  FILLER                     PIC  X(04)     VALUE SPACES.  03500081
035100     05  DL2-WEEK-1-UNITS           PIC  ZZZ,ZZZ,ZZ9 VALUE ZERO.  03510067
035200     05  FILLER                     PIC  X(01)     VALUE SPACES.  03520067
035300     05  DL2-WEEK-2-UNITS           PIC  ZZZ,ZZZ,ZZ9 VALUE ZERO.  03530067
035400     05  FILLER                     PIC  X(01)     VALUE SPACES.  03540067
035500     05  DL2-WEEK-3-UNITS           PIC  ZZZ,ZZZ,ZZ9 VALUE ZERO.  03550067
035600     05  FILLER                     PIC  X(01)     VALUE SPACES.  03560067
035700     05  DL2-WEEK-4-UNITS           PIC  ZZZ,ZZZ,ZZ9 VALUE ZERO.  03570067
035800     05  FILLER                     PIC  X(01)     VALUE SPACES.  03580081
035900     05  DL2-WEEK-5-UNITS           PIC  ZZZ,ZZZ,ZZ9 VALUE ZERO.  03590067
036100                                                                  03610003
036200 01  DL3-DETAIL-LINE-3.                                           03620003
036300     05  FILLER                     PIC  X(78)     VALUE SPACES.  03630081
036400     05  DL3-WEEK-1-PERCENT         PIC  ZZZ.9     VALUE ZEROES.  03640031
036500     05  FILLER                     PIC  X(01)     VALUE '%'.     03650013
036510     05  FILLER                     PIC  X(06)     VALUE SPACES.  03651050
036600     05  DL3-WEEK-2-PERCENT         PIC  ZZZ.9     VALUE ZEROES.  03660031
036610     05  FILLER                     PIC  X(01)     VALUE '%'.     03661013
036700     05  FILLER                     PIC  X(06)     VALUE SPACES.  03670050
036800     05  DL3-WEEK-3-PERCENT         PIC  ZZZ.9     VALUE ZEROES.  03680031
036810     05  FILLER                     PIC  X(01)     VALUE '%'.     03681013
036900     05  FILLER                     PIC  X(06)     VALUE SPACES.  03690050
037000     05  DL3-WEEK-4-PERCENT         PIC  ZZZ.9     VALUE ZEROES.  03700031
037001     05  FILLER                     PIC  X(01)     VALUE '%'.     03700113
037100     05  FILLER                     PIC  X(06)     VALUE SPACES.  03710081
037200     05  DL3-WEEK-5-PERCENT         PIC  ZZZ.9     VALUE ZEROES.  03720031
037201     05  FILLER                     PIC  X(01)     VALUE '%'.     03720113
037400                                                                  03740003
037500 01  TL1-TOTAL-LINE-1.                                            03750003
037600     05  FILLER                     PIC  X(02)     VALUE SPACES.  03760057
037700     05  TL1-TOT-DESCRIPTION        PIC  X(20)     VALUE SPACES.  03770078
037710     05  FILLER                     PIC  X(12)     VALUE          03771078
037720         'AVG.RCVRS/PO'.                                          03772079
037730     05  TL1-TOT-AVG-RECEIVERS      PIC  ZZZZZZ.9  VALUE ZERO.    03773078
037800     05  FILLER                     PIC  X(31)     VALUE SPACES.  03780081
037900     05  TL1-TOT-WEEK-1-UNITS       PIC  ZZZ,ZZZ,ZZ9 VALUE ZERO.  03790067
038000     05  FILLER                     PIC  X(01)     VALUE SPACES.  03800067
038100     05  TL1-TOT-WEEK-2-UNITS       PIC  ZZZ,ZZZ,ZZ9 VALUE ZERO.  03810067
038200     05  FILLER                     PIC  X(01)     VALUE SPACES.  03820067
038300     05  TL1-TOT-WEEK-3-UNITS       PIC  ZZZ,ZZZ,ZZ9 VALUE ZERO.  03830067
038400     05  FILLER                     PIC  X(01)     VALUE SPACES.  03840067
038500     05  TL1-TOT-WEEK-4-UNITS       PIC  ZZZ,ZZZ,ZZ9 VALUE ZERO.  03850067
038600     05  FILLER                     PIC  X(01)     VALUE SPACES.  03860082
038700     05  TL1-TOT-WEEK-5-UNITS       PIC  ZZZ,ZZZ,ZZ9 VALUE ZERO.  03870067
038900                                                                  03890003
039000 01  TL2-TOTAL-LINE-2.                                            03900003
039100     05  FILLER                     PIC  X(78)     VALUE SPACES.  03910081
039200     05  TL2-TOT-WEEK-1-PERCENT     PIC  ZZZ.9     VALUE ZEROES.  03920031
039210     05  FILLER                     PIC  X(01)     VALUE '%'.     03921013
039300     05  FILLER                     PIC  X(06)     VALUE SPACES.  03930050
039400     05  TL2-TOT-WEEK-2-PERCENT     PIC  ZZZ.9     VALUE ZEROES.  03940031
039410     05  FILLER                     PIC  X(01)     VALUE '%'.     03941013
039500     05  FILLER                     PIC  X(06)     VALUE SPACES.  03950050
039600     05  TL2-TOT-WEEK-3-PERCENT     PIC  ZZZ.9     VALUE ZEROES.  03960031
039610     05  FILLER                     PIC  X(01)     VALUE '%'.     03961013
039700     05  FILLER                     PIC  X(06)     VALUE SPACES.  03970050
039800     05  TL2-TOT-WEEK-4-PERCENT     PIC  ZZZ.9     VALUE ZEROES.  03980031
039810     05  FILLER                     PIC  X(01)     VALUE '%'.     03981013
039900     05  FILLER                     PIC  X(06)     VALUE SPACES.  03990082
040000     05  TL2-TOT-WEEK-5-PERCENT     PIC  ZZZ.9     VALUE ZEROES.  04000031
040010     05  FILLER                     PIC  X(01)     VALUE '%'.     04001013
040200                                                                  04020003
041100 01  TL4-TOTAL-LINE-4.                                            04110073
041200     05  FILLER                     PIC  X(02)     VALUE SPACES.  04120073
041300     05  TL4-TOT-DESCRIPTION        PIC  X(20)     VALUE SPACES.  04130078
041400     05  FILLER                     PIC  X(12)     VALUE          04140078
041401         'AVG.RCVRS/PO'.                                          04140179
041402     05  TL4-TOT-AVG-RECEIVERS      PIC  ZZZZZZ.9  VALUE ZERO.    04140278
041403     05  FILLER                     PIC  X(03)     VALUE SPACES.  04140378
041405     05  FILLER                     PIC  X(09)     VALUE          04140578
041406         'TOTAL PO '.                                             04140678
041410     05  TL4-TOT-PURCH-ORD          PIC  ZZZ9      VALUE ZEROES.  04141073
041420     05  FILLER                     PIC  X(07)     VALUE SPACES.  04142076
041430     05  TL4-TOT-RECEIVERS          PIC  ZZZ9      VALUE ZEROES.  04143073
041440     05  FILLER                     PIC  X(04)     VALUE SPACES.  04144081
041500     05  TL4-TOT-WEEK-1-UNITS       PIC  ZZZ,ZZZ,ZZ9 VALUE ZERO.  04150073
041600     05  FILLER                     PIC  X(01)     VALUE SPACES.  04160073
041610     05  TL4-TOT-WEEK-2-UNITS       PIC  ZZZ,ZZZ,ZZ9 VALUE ZERO.  04161073
041620     05  FILLER                     PIC  X(01)     VALUE SPACES.  04162073
041630     05  TL4-TOT-WEEK-3-UNITS       PIC  ZZZ,ZZZ,ZZ9 VALUE ZERO.  04163073
041640     05  FILLER                     PIC  X(01)     VALUE SPACES.  04164073
041650     05  TL4-TOT-WEEK-4-UNITS       PIC  ZZZ,ZZZ,ZZ9 VALUE ZERO.  04165073
041660     05  FILLER                     PIC  X(01)     VALUE SPACES.  04166082
041670     05  TL4-TOT-WEEK-5-UNITS       PIC  ZZZ,ZZZ,ZZ9 VALUE ZERO.  04167073
041690                                                                  04169073
041691 01  TL5-TOTAL-LINE-5.                                            04169173
041692     05  FILLER                     PIC  X(78)     VALUE SPACES.  04169281
041693     05  TL5-TOT-WEEK-1-PERCENT     PIC  ZZZ.9     VALUE ZEROES.  04169373
041694     05  FILLER                     PIC  X(01)     VALUE '%'.     04169473
041695     05  FILLER                     PIC  X(06)     VALUE SPACES.  04169573
041696     05  TL5-TOT-WEEK-2-PERCENT     PIC  ZZZ.9     VALUE ZEROES.  04169673
041697     05  FILLER                     PIC  X(01)     VALUE '%'.     04169773
041698     05  FILLER                     PIC  X(06)     VALUE SPACES.  04169873
041699     05  TL5-TOT-WEEK-3-PERCENT     PIC  ZZZ.9     VALUE ZEROES.  04169973
041700     05  FILLER                     PIC  X(01)     VALUE '%'.     04170073
041701     05  FILLER                     PIC  X(06)     VALUE SPACES.  04170173
041702     05  TL5-TOT-WEEK-4-PERCENT     PIC  ZZZ.9     VALUE ZEROES.  04170273
041703     05  FILLER                     PIC  X(01)     VALUE '%'.     04170373
041704     05  FILLER                     PIC  X(06)     VALUE SPACES.  04170482
041705     05  TL5-TOT-WEEK-5-PERCENT     PIC  ZZZ.9     VALUE ZEROES.  04170573
041706     05  FILLER                     PIC  X(01)     VALUE '%'.     04170673
041708                                                                  04170873
041720                                                                  04172002
041800 01  PR-PRINT-FINAL.                                              04180002
041900     05  FILLER                      PIC X(53)  VALUE SPACES.     04190002
042000     05  FILLER                      PIC X(21)  VALUE             04200002
042100         '*** END OF REPORT ***'.                                 04210002
042200                                                                  04220002
042300                                                                  04230002
042400 01  PR-PRINT-NO-DETAIL.                                          04240002
042500     05  FILLER                      PIC X(53)  VALUE SPACES.     04250002
042600     05  FILLER                      PIC X(29)  VALUE             04260002
042700         '*** NO DETAILS TO REPORT ***'.                          04270002
042800*                                                                 04280003
042810*---------------------------------------------------------------* 04281015
042820*  COPYBOOK FOR DB2 ERROR MESSAGE BUILDING                      * 04282015
042830*---------------------------------------------------------------* 04283015
042840     COPY DPWS004.                                                04284015
042850                                                                  04285015
042860*---------------------------------------------------------------* 04286015
042870*    DB2 AREA FOR COMMUNICATIONS                                * 04287015
042880*---------------------------------------------------------------* 04288015
042890     EXEC SQL                                                     04289015
042891          INCLUDE SQLCA                                           04289115
042892     END-EXEC.                                                    04289215
042893                                                                  04289315
042894*---------------------------------------------------------------* 04289415
042895*    DB2 AREA FOR MERCHANDISE AREA TABLE                        * 04289517
042896*---------------------------------------------------------------* 04289615
042897     EXEC SQL                                                     04289715
042898          INCLUDE TMDSEAR                                         04289815
042899     END-EXEC.                                                    04289915
042900                                                                  04290015
042910*---------------------------------------------------------------* 04291003
043000*  COPYBOOK USED FOR INPUT FILE                                 * 04300003
043100*---------------------------------------------------------------* 04310003
043200     COPY RCRD035.                                                04320003
043300                                                                  04330005
043310*---------------------------------------------------------------* 04331052
043320*  COPYBOOK USED FOR OUTPUT FILE                                * 04332052
043330*---------------------------------------------------------------* 04333052
043340     COPY RCRD036.                                                04334052
043350                                                                  04335052
043400*---------------------------------------------------------------* 04340011
043500*  COPYBOOK USED FOR OUTPUT REPORT (132 POS)                    * 04350011
043510*---------------------------------------------------------------* 04351011
043520     COPY DPWS132O.                                               04352011
043530                                                                  04353012
046900***************************************************************** 04690002
047000 PROCEDURE DIVISION.                                              04700002
047200*---------------------------------------------------------------* 04720005
047300*  THIS PARAGRAPH DRIVES THE PROGRAM.                           * 04730002
047400*---------------------------------------------------------------* 04740005
047610                                                                  04761005
047700     PERFORM 1000-INITIALIZE.                                     04770002
047800                                                                  04780002
047810     IF  PS-INPUT-EOF                                             04781035
047820         PERFORM 6800-NO-REPORT-DETAIL                            04782035
047821         SET PS-NO-DETAIL  TO  TRUE                               04782135
047830     ELSE                                                         04783035
047900         PERFORM 2000-MAIN-PROCESS                                04790035
048000           UNTIL  PS-INPUT-EOF.                                   04800035
048100                                                                  04810002
048101     IF  PS-NO-DETAIL                                             04810135
048102         NEXT SENTENCE                                            04810235
048103     ELSE                                                         04810335
048104         PERFORM 4000-PURCH-ORD-TOTALS                            04810435
048105         PERFORM 4100-VENDOR-TOTALS                               04810568
048106         PERFORM 4200-DEPARTMENT-TOTALS                           04810668
048107         PERFORM 4400-BUYER-TOTALS                                04810768
048108         PERFORM 4600-DIVISION-TOTALS                             04810868
048110         PERFORM 4800-COMPANY-TOTALS                              04811035
048112         PERFORM 6600-PRINT-END-OF-REPORT.                        04811235
048120                                                                  04812005
048200     PERFORM 9000-END-PROCESS.                                    04820002
048300                                                                  04830002
048400     GOBACK.                                                      04840002
048500                                                                  04850002
048600 1000-INITIALIZE.                                                 04860002
048700***************************************************************** 04870002
048800*  PROGRAM INITIALIZATION                                       * 04880002
048900*    -- OPEN INPUT AND OUTPUT FILES.                            * 04890002
049000*    -- ACCEPT DATE AND TIME FROM THE SYSTEM AND INITIALIZE     * 04900002
049100*       THE REPORT HEADINGS.                                    * 04910002
049200***************************************************************** 04920002
049300     OPEN  INPUT INPUT-FILE                                       04930002
049310                 DATE-FILE                                        04931088
049400           OUTPUT REPORT-FILE                                     04940052
049500                  SUMMARY-FILE.                                   04950052
049530                                                                  04953006
049600     ACCEPT CD-CPU-DATE FROM DATE.                                04960002
049700     ACCEPT CT-CPU-TIME FROM TIME.                                04970002
049800                                                                  04980002
049810     READ DATE-FILE INTO PV-DATE-RECORD.                          04981085
049840                                                                  04984085
049900     PERFORM 7000-READ-INPUT-FILE.                                04990002
050000                                                                  05000002
050100     MOVE RC035-ORD-NBR          TO  PV-HOLD-PO-NMBR.             05010061
050110     MOVE RC035-VEND-DESC        TO  PV-HOLD-VENDOR-NAME.         05011061
050200     MOVE RC035-DEPT-NBR         TO  PV-HOLD-DEPT-NBR.            05020061
050300     MOVE RC035-BYR-NMBR         TO  PV-HOLD-BUYER-NBR.           05030061
050400     MOVE RC035-BYR-NAME         TO  PV-HOLD-BUYER-NAME.          05040061
050500     MOVE RC035-DMM-NMBR         TO  PV-HOLD-DIVISION-NBR.        05050061
050600     MOVE RC035-DMM-NAME         TO  PV-HOLD-DIVISION-NAME.       05060061
050700                                                                  05070002
050800     ADD  1                      TO  PV-VND-PURCH-ORD-CNT.        05080068
050810     ADD  1                      TO  PV-DPT-PURCH-ORD-CNT.        05081068
050900     ADD  1                      TO  PV-BYR-PURCH-ORD-CNT.        05090004
051000     ADD  1                      TO  PV-DIV-PURCH-ORD-CNT.        05100004
051100     ADD  1                      TO  PV-COM-PURCH-ORD-CNT.        05110004
051200                                                                  05120004
051300     PERFORM 1100-GET-DEPARTMENT-NAME.                            05130004
051400     PERFORM 1200-INITIALIZE-HEADINGS.                            05140004
051500     PERFORM 6000-PRINT-RPT-HEADING.                              05150004
051600                                                                  05160002
051610                                                                  05161005
051700 1100-GET-DEPARTMENT-NAME.                                        05170004
051800*---------------------------------------------------------------* 05180005
051900* GET THE DEPARTMENT NAME FROM MERCHANDISE AREA TABLE           * 05190017
052000*---------------------------------------------------------------* 05200005
052100                                                                  05210004
052180       EXEC SQL                                                   05218006
052190                SELECT   MDSEAR_DESC                              05219006
052200                  INTO  :MDSEAR-DESC                              05220006
052201                  FROM   TMDSEAR                                  05220106
052202                 WHERE   DEPT_NBR   =  :PV-HOLD-DEPT-NBR          05220206
052203                   AND   OPERCO_NBR =  :PC-OPERCO-CDE             05220310
052204                   AND   MDSELV_CDE =  :PC-DPT                    05220410
052205                   AND  (STRT_DTE   <  CURRENT DATE OR            05220509
052206                         STRT_DTE   =  CURRENT DATE)              05220609
052208                   AND   END_DTE    >  CURRENT DATE               05220808
052212       END-EXEC.                                                  05221208
052213                                                                  05221308
052214       EVALUATE TRUE                                              05221408
052215            WHEN SQLCODE = ZERO                                   05221508
052216                MOVE  MDSEAR-DESC     TO  PV-HOLD-DEPT-NAME       05221608
052217            WHEN SQLCODE = +100                                   05221708
052218                MOVE SPACES           TO  PV-HOLD-DEPT-NAME       05221808
052219                MOVE 'UNKNOWN DEPT '  TO  PV-HOLD-DEPT-NAME       05221908
052220            WHEN OTHER                                            05222008
052221                MOVE SQLCODE          TO  PV-SQLCODE              05222111
052226                MOVE '1100-GET-DEPARTMENT-NAME'                   05222611
052227                                      TO  PV-ABEND-PARAGRAPH      05222711
052228                MOVE 'SELECT'         TO  PV-ABEND-OPERATION      05222811
052229                MOVE 'GET DEPARTMENT NAME '                       05222911
052230                                      TO  PV-DB2-OPERATION-MSG-1  05223011
052231                MOVE 'FROM TMDSEAR TABLE  '                       05223111
052232                                      TO  PV-DB2-OPERATION-MSG-2  05223211
052234                MOVE 'TMDSEAR'        TO  PV-ABEND-STRUCTURE-1    05223411
052242                PERFORM 9900-DB2-ABEND                            05224205
052243        END-EVALUATE.                                             05224305
052250                                                                  05225005
052600                                                                  05260004
052700 1200-INITIALIZE-HEADINGS.                                        05270002
052800***************************************************************** 05280002
052900*  INITIALIZE REPORT HEADINGS                                   * 05290002
053000***************************************************************** 05300002
053100     MOVE CD-YEAR                TO DP132O-RUN-YEAR.              05310002
053200     MOVE CD-MONTH               TO DP132O-RUN-MONTH.             05320002
053300     MOVE CD-DAY                 TO DP132O-RUN-DAY.               05330002
053400     MOVE CT-HOUR                TO DP132O-RUN-HOUR.              05340002
053500     MOVE CT-MINUTE              TO DP132O-RUN-MINUTE.            05350002
053600     MOVE 'RCKRP019'             TO DP132O-PROGRAM-NAME.          05360002
053700     MOVE PC-1                   TO DP132O-REPORT-NUMBER.         05370002
053800                                                                  05380002
053900     PERFORM 1210-DETERMINE-HEADING-MONTH.                        05390004
054000                                                                  05400004
054100     MOVE PV-WORK-MONTH-YEAR     TO HL1-MONTH-YEAR.               05410004
054200     MOVE PV-HOLD-DIVISION-NBR   TO HL2-DIVISION-NMBR.            05420083
054210     MOVE PV-HOLD-DIVISION-NAME  TO HL2-DIVISION.                 05421083
054300     MOVE PV-HOLD-BUYER-NBR      TO HL3-BUYER-NMBR.               05430084
054310     MOVE PV-HOLD-BUYER-NAME     TO HL3-BUYER.                    05431083
054400                                                                  05440004
054500 1210-DETERMINE-HEADING-MONTH.                                    05450004
054600*---------------------------------------------------------------* 05460004
054700*  DETERMINE THE 'MONTH NAME' & YEAR FOR REPORT HEADING         * 05470004
054800*---------------------------------------------------------------* 05480004
055100                                                                  05510004
055110     EVALUATE PV-DATE-FISCAL-PERIOD                               05511085
055200         WHEN PV-MONTH-JANUARY                                    05520085
055300              MOVE  PV-DATE-END-CCYY        TO  PV-WORK-YY-JAN    05530085
055400              MOVE  PV-WORK-MONTH-JAN       TO  PV-WORK-MONTH-YEAR05540085
055600         WHEN PV-MONTH-FEBRUARY                                   05560085
055700              MOVE  PV-DATE-END-CCYY        TO  PV-WORK-YY-FEB    05570085
055800              MOVE  PV-WORK-MONTH-FEB       TO  PV-WORK-MONTH-YEAR05580085
056000         WHEN PV-MONTH-MARCH                                      05600085
056100              MOVE  PV-DATE-END-CCYY        TO  PV-WORK-YY-MAR    05610085
056200              MOVE  PV-WORK-MONTH-MAR       TO  PV-WORK-MONTH-YEAR05620085
056400         WHEN PV-MONTH-APRIL                                      05640085
056500              MOVE  PV-DATE-END-CCYY        TO  PV-WORK-YY-APR    05650085
056600              MOVE  PV-WORK-MONTH-APR       TO  PV-WORK-MONTH-YEAR05660085
056800         WHEN PV-MONTH-MAY                                        05680085
056900              MOVE  PV-DATE-END-CCYY        TO  PV-WORK-YY-MAY    05690085
057000              MOVE  PV-WORK-MONTH-MAY       TO  PV-WORK-MONTH-YEAR05700085
057200         WHEN PV-MONTH-JUNE                                       05720085
057300              MOVE  PV-DATE-END-CCYY        TO  PV-WORK-YY-JUN    05730085
057400              MOVE  PV-WORK-MONTH-JUN       TO  PV-WORK-MONTH-YEAR05740085
057600         WHEN PV-MONTH-JULY                                       05760085
057700              MOVE  PV-DATE-END-CCYY        TO  PV-WORK-YY-JUL    05770085
057800              MOVE  PV-WORK-MONTH-JUL       TO  PV-WORK-MONTH-YEAR05780085
058000         WHEN PV-MONTH-AUGUST                                     05800085
058100              MOVE  PV-DATE-END-CCYY        TO  PV-WORK-YY-AUG    05810085
058200              MOVE  PV-WORK-MONTH-AUG       TO  PV-WORK-MONTH-YEAR05820085
058400         WHEN PV-MONTH-SEPTEMBER                                  05840085
058500              MOVE  PV-DATE-END-CCYY        TO  PV-WORK-YY-SEP    05850085
058600              MOVE  PV-WORK-MONTH-SEP       TO  PV-WORK-MONTH-YEAR05860085
058800         WHEN PV-MONTH-OCTOBER                                    05880085
058900              MOVE  PV-DATE-END-CCYY        TO  PV-WORK-YY-OCT    05890085
059000              MOVE  PV-WORK-MONTH-OCT       TO  PV-WORK-MONTH-YEAR05900085
059200         WHEN PV-MONTH-NOVEMBER                                   05920085
059300              MOVE  PV-DATE-END-CCYY        TO  PV-WORK-YY-NOV    05930085
059400              MOVE  PV-WORK-MONTH-NOV       TO  PV-WORK-MONTH-YEAR05940085
059600         WHEN PV-MONTH-DECEMBER                                   05960085
059700              MOVE  PV-DATE-END-CCYY        TO  PV-WORK-YY-DEC    05970085
059800              MOVE  PV-WORK-MONTH-DEC       TO  PV-WORK-MONTH-YEAR05980085
059810     END-EVALUATE.                                                05981085
059900                                                                  05990004
060000                                                                  06000002
060100 2000-MAIN-PROCESS.                                               06010002
060200                                                                  06020004
060210      ADD  1  TO  PV-RECORD-COUNT.                                06021037
060220                                                                  06022037
060300*---------------------------------------------------------------* 06030004
060400*  IF NEW DIVISION NUMBER - PRINT PO/DEPT/BUYER/DIVISION TOTALS * 06040004
060500*                           AND NEW PAGE HEADING                * 06050004
060600*---------------------------------------------------------------* 06060004
060700     IF  RC035-DMM-NMBR  =  PV-HOLD-DIVISION-NBR                  06070061
060800         CONTINUE                                                 06080004
060900     ELSE                                                         06090004
061000         PERFORM 4000-PURCH-ORD-TOTALS                            06100004
061010         PERFORM 4100-VENDOR-TOTALS                               06101068
061100         PERFORM 4200-DEPARTMENT-TOTALS                           06110004
061200         PERFORM 4400-BUYER-TOTALS                                06120004
061300         PERFORM 4600-DIVISION-TOTALS                             06130004
061400         ADD  1                      TO PV-VND-PURCH-ORD-CNT      06140068
061410         ADD  1                      TO PV-DPT-PURCH-ORD-CNT      06141068
061500         ADD  1                      TO PV-BYR-PURCH-ORD-CNT      06150004
061600         ADD  1                      TO PV-DIV-PURCH-ORD-CNT      06160004
061700         ADD  1                      TO PV-COM-PURCH-ORD-CNT      06170004
061800         MOVE RC035-ORD-NBR          TO PV-HOLD-PO-NMBR           06180061
061810         MOVE RC035-VEND-DESC        TO PV-HOLD-VENDOR-NAME       06181061
061900         MOVE RC035-DEPT-NBR         TO PV-HOLD-DEPT-NBR          06190061
062000         PERFORM 1100-GET-DEPARTMENT-NAME                         06200004
062100         MOVE RC035-BYR-NMBR         TO PV-HOLD-BUYER-NBR         06210061
062200         MOVE RC035-BYR-NAME         TO PV-HOLD-BUYER-NAME        06220061
062300         MOVE PV-HOLD-BUYER-NBR      TO HL3-BUYER-NMBR            06230083
062310         MOVE PV-HOLD-BUYER-NAME     TO HL3-BUYER                 06231083
062400         MOVE RC035-DMM-NMBR         TO PV-HOLD-DIVISION-NBR      06240061
062500         MOVE RC035-DMM-NAME         TO PV-HOLD-DIVISION-NAME     06250061
062600         MOVE PV-HOLD-DIVISION-NBR   TO HL2-DIVISION-NMBR         06260083
062610         MOVE PV-HOLD-DIVISION-NAME  TO HL2-DIVISION              06261083
062700         PERFORM 6000-PRINT-RPT-HEADING.                          06270045
062800                                                                  06280004
062900*---------------------------------------------------------------* 06290004
063000*  IF NEW BUYER NUMBER - PRINT PO/DEPT/BUYER TOTALS             * 06300004
063100*                        AND NEW PAGE HEADING                   * 06310004
063200*---------------------------------------------------------------* 06320004
063300     IF  RC035-BYR-NMBR  =  PV-HOLD-BUYER-NBR                     06330061
063400         CONTINUE                                                 06340004
063500     ELSE                                                         06350004
063600         PERFORM 4000-PURCH-ORD-TOTALS                            06360004
063610         PERFORM 4100-VENDOR-TOTALS                               06361068
063700         PERFORM 4200-DEPARTMENT-TOTALS                           06370004
063800         PERFORM 4400-BUYER-TOTALS                                06380004
063810         ADD  1                      TO PV-VND-PURCH-ORD-CNT      06381068
063900         ADD  1                      TO PV-DPT-PURCH-ORD-CNT      06390004
064000         ADD  1                      TO PV-BYR-PURCH-ORD-CNT      06400004
064100         ADD  1                      TO PV-DIV-PURCH-ORD-CNT      06410004
064200         ADD  1                      TO PV-COM-PURCH-ORD-CNT      06420004
064300         MOVE RC035-ORD-NBR          TO PV-HOLD-PO-NMBR           06430061
064310         MOVE RC035-VEND-DESC        TO PV-HOLD-VENDOR-NAME       06431061
064400         MOVE RC035-DEPT-NBR         TO PV-HOLD-DEPT-NBR          06440061
064500         PERFORM 1100-GET-DEPARTMENT-NAME                         06450004
064600         MOVE RC035-BYR-NMBR         TO PV-HOLD-BUYER-NBR         06460061
064700         MOVE RC035-BYR-NAME         TO PV-HOLD-BUYER-NAME        06470061
064800         MOVE PV-HOLD-BUYER-NBR      TO HL3-BUYER-NMBR            06480083
064810         MOVE PV-HOLD-BUYER-NAME     TO HL3-BUYER                 06481083
064900         PERFORM 6000-PRINT-RPT-HEADING.                          06490045
065000                                                                  06500004
065100*---------------------------------------------------------------* 06510004
065200*  IF NEW DEPT NUMBER - PRINT PO/DEPT TOTALS & NEW DEPT HEADING * 06520004
065300*---------------------------------------------------------------* 06530004
065400     IF  RC035-DEPT-NBR  =  PV-HOLD-DEPT-NBR                      06540061
065500         CONTINUE                                                 06550004
065600     ELSE                                                         06560004
065700         PERFORM 4000-PURCH-ORD-TOTALS                            06570004
065710         PERFORM 4100-VENDOR-TOTALS                               06571068
065800         PERFORM 4200-DEPARTMENT-TOTALS                           06580004
065810         ADD  1                      TO PV-VND-PURCH-ORD-CNT      06581068
065900         ADD  1                      TO PV-DPT-PURCH-ORD-CNT      06590004
066000         ADD  1                      TO PV-BYR-PURCH-ORD-CNT      06600004
066100         ADD  1                      TO PV-DIV-PURCH-ORD-CNT      06610004
066200         ADD  1                      TO PV-COM-PURCH-ORD-CNT      06620004
066300         MOVE RC035-ORD-NBR          TO PV-HOLD-PO-NMBR           06630061
066310         MOVE RC035-VEND-DESC        TO PV-HOLD-VENDOR-NAME       06631061
066400         MOVE RC035-DEPT-NBR         TO PV-HOLD-DEPT-NBR          06640061
066500         PERFORM 1100-GET-DEPARTMENT-NAME                         06650004
066600         PERFORM 6100-PRINT-DPT-HEADING.                          06660004
066610                                                                  06661068
066620*---------------------------------------------------------------* 06662068
066630*  IF VENDOR - PRINT VENDOR TOTALS                              * 06663068
066640*---------------------------------------------------------------* 06664068
066650     IF  RC035-VEND-DESC  =  PV-HOLD-VENDOR-NAME                  06665068
066660         CONTINUE                                                 06666068
066670     ELSE                                                         06667068
066680         PERFORM 4000-PURCH-ORD-TOTALS                            06668068
066681         PERFORM 4100-VENDOR-TOTALS                               06668170
066682         ADD  1                      TO PV-VND-PURCH-ORD-CNT      06668268
066690         ADD  1                      TO PV-DPT-PURCH-ORD-CNT      06669068
066691         ADD  1                      TO PV-BYR-PURCH-ORD-CNT      06669168
066692         ADD  1                      TO PV-DIV-PURCH-ORD-CNT      06669268
066693         ADD  1                      TO PV-COM-PURCH-ORD-CNT      06669368
066694         MOVE RC035-ORD-NBR          TO PV-HOLD-PO-NMBR           06669468
066695         MOVE RC035-VEND-DESC        TO PV-HOLD-VENDOR-NAME.      06669568
066696                                                                  06669668
066700                                                                  06670004
066800*---------------------------------------------------------------* 06680004
066900*  IF NEW PURCHASE ORDER NUMBER - PRINT PURCHASE ORDER TOTALS   * 06690004
067000*---------------------------------------------------------------* 06700004
067100     IF  RC035-ORD-NBR  =  PV-HOLD-PO-NMBR                        06710061
067200         CONTINUE                                                 06720004
067300     ELSE                                                         06730004
067400         PERFORM 4000-PURCH-ORD-TOTALS                            06740004
067410         ADD  1                      TO PV-VND-PURCH-ORD-CNT      06741068
067500         ADD  1                      TO PV-DPT-PURCH-ORD-CNT      06750004
067600         ADD  1                      TO PV-BYR-PURCH-ORD-CNT      06760004
067700         ADD  1                      TO PV-DIV-PURCH-ORD-CNT      06770004
067800         ADD  1                      TO PV-COM-PURCH-ORD-CNT      06780004
067900         MOVE RC035-ORD-NBR          TO PV-HOLD-PO-NMBR           06790061
067910         MOVE RC035-VEND-DESC        TO PV-HOLD-VENDOR-NAME.      06791061
068000                                                                  06800004
068100*---------------------------------------------------------------* 06810004
068200* ACCUMULATE PURCHASE ORDER INFORMATION.                        * 06820004
068300*       -NUMBER OF RECEIVERS                                    * 06830004
068400*       -UNIT QUANTITY                                          * 06840004
068500*            -IF "VERIFIED STATUS" USE VERIFIED ITEM QUANTITY   * 06850004
068600*            -OTHERWISE USE EXPECTED ITEN QUANTITY              * 06860004
068700*---------------------------------------------------------------* 06870004
068800                                                                  06880004
068900     ADD  1                       TO  PV-PO-RECEIVERS-CNT.        06890004
068910     ADD  1                       TO  PV-VND-RECEIVERS-CNT.       06891068
069000     ADD  1                       TO  PV-DPT-RECEIVERS-CNT.       06900004
069100     ADD  1                       TO  PV-BYR-RECEIVERS-CNT.       06910004
069200     ADD  1                       TO  PV-DIV-RECEIVERS-CNT.       06920004
069300     ADD  1                       TO  PV-COM-RECEIVERS-CNT.       06930004
069400                                                                  06940004
069500     IF  RC035-STATUS-CDE = 'VE'                                  06950061
069600         PERFORM 2100-VERIFIED-ACCUMULATION                       06960004
069700     ELSE                                                         06970004
069800         PERFORM 2200-EXPECTED-ACCUMULATION.                      06980004
069900                                                                  06990004
070000     PERFORM 7000-READ-INPUT-FILE.                                07000004
070100                                                                  07010004
070200                                                                  07020004
070300 2100-VERIFIED-ACCUMULATION.                                      07030004
070400*---------------------------------------------------------------* 07040004
070500* ACCUMULATE VERIFIED ITEM QUANTITY BY WEEK FOR RECEIVERS IN    * 07050004
070600* VERIFIED STATUS - WEEK IS DETERMINED BY ARRIVED DATE          * 07060024
070700*---------------------------------------------------------------* 07070004
070800                                                                  07080004
070900     IF  RC035-ARRIVE-PERIOD-WEEK  =  '01'                        07090061
071000         ADD  RC035-VERIFY-ITM-QTY  TO  PV-WK1-ORD-COUNT          07100061
071010         ADD  RC035-VERIFY-ITM-QTY  TO  PV-WK1-VND-COUNT          07101070
071100         ADD  RC035-VERIFY-ITM-QTY  TO  PV-WK1-DPT-COUNT          07110061
071200         ADD  RC035-VERIFY-ITM-QTY  TO  PV-WK1-BYR-COUNT          07120061
071300         ADD  RC035-VERIFY-ITM-QTY  TO  PV-WK1-DIV-COUNT          07130061
071400         ADD  RC035-VERIFY-ITM-QTY  TO  PV-WK1-COM-COUNT          07140061
071500     ELSE                                                         07150004
071600     IF  RC035-ARRIVE-PERIOD-WEEK  =  '02'                        07160061
071700         ADD  RC035-VERIFY-ITM-QTY  TO  PV-WK2-ORD-COUNT          07170061
071710         ADD  RC035-VERIFY-ITM-QTY  TO  PV-WK2-VND-COUNT          07171070
071800         ADD  RC035-VERIFY-ITM-QTY  TO  PV-WK2-DPT-COUNT          07180061
071900         ADD  RC035-VERIFY-ITM-QTY  TO  PV-WK2-BYR-COUNT          07190061
072000         ADD  RC035-VERIFY-ITM-QTY  TO  PV-WK2-DIV-COUNT          07200061
072100         ADD  RC035-VERIFY-ITM-QTY  TO  PV-WK2-COM-COUNT          07210061
072200     ELSE                                                         07220004
072300     IF  RC035-ARRIVE-PERIOD-WEEK  =  '03'                        07230061
072400         ADD  RC035-VERIFY-ITM-QTY  TO  PV-WK3-ORD-COUNT          07240061
072410         ADD  RC035-VERIFY-ITM-QTY  TO  PV-WK3-VND-COUNT          07241070
072500         ADD  RC035-VERIFY-ITM-QTY  TO  PV-WK3-DPT-COUNT          07250061
072600         ADD  RC035-VERIFY-ITM-QTY  TO  PV-WK3-BYR-COUNT          07260061
072700         ADD  RC035-VERIFY-ITM-QTY  TO  PV-WK3-DIV-COUNT          07270061
072800         ADD  RC035-VERIFY-ITM-QTY  TO  PV-WK3-COM-COUNT          07280061
072900     ELSE                                                         07290004
073000     IF  RC035-ARRIVE-PERIOD-WEEK  =  '04'                        07300061
073100         ADD  RC035-VERIFY-ITM-QTY  TO  PV-WK4-ORD-COUNT          07310070
073110         ADD  RC035-VERIFY-ITM-QTY  TO  PV-WK4-VND-COUNT          07311070
073200         ADD  RC035-VERIFY-ITM-QTY  TO  PV-WK4-DPT-COUNT          07320061
073300         ADD  RC035-VERIFY-ITM-QTY  TO  PV-WK4-BYR-COUNT          07330061
073400         ADD  RC035-VERIFY-ITM-QTY  TO  PV-WK4-DIV-COUNT          07340061
073500         ADD  RC035-VERIFY-ITM-QTY  TO  PV-WK4-COM-COUNT          07350061
073600     ELSE                                                         07360004
073700     IF  RC035-ARRIVE-PERIOD-WEEK  =  '05'                        07370061
073800         ADD  RC035-VERIFY-ITM-QTY  TO  PV-WK5-ORD-COUNT          07380061
073810         ADD  RC035-VERIFY-ITM-QTY  TO  PV-WK5-VND-COUNT          07381070
073900         ADD  RC035-VERIFY-ITM-QTY  TO  PV-WK5-DPT-COUNT          07390061
074000         ADD  RC035-VERIFY-ITM-QTY  TO  PV-WK5-BYR-COUNT          07400061
074100         ADD  RC035-VERIFY-ITM-QTY  TO  PV-WK5-DIV-COUNT          07410061
074200         ADD  RC035-VERIFY-ITM-QTY  TO  PV-WK5-COM-COUNT.         07420061
074300                                                                  07430004
074400                                                                  07440004
074500 2200-EXPECTED-ACCUMULATION.                                      07450004
074600*---------------------------------------------------------------* 07460004
074700* ACCUMULATE EXPECTED ITEM QUANTITY BY WEEK FOR RECEIVERS NOT   * 07470004
074800* IN VERIFIED STATUS - WEEK DETERMINED BY ARRIVED DATE          * 07480024
074900*---------------------------------------------------------------* 07490004
075000                                                                  07500004
075100     IF  RC035-ARRIVE-PERIOD-WEEK  =  '01'                        07510061
075200         ADD  RC035-EXPTED-ITM-QTY  TO  PV-WK1-ORD-COUNT          07520061
075300         ADD  RC035-EXPTED-ITM-QTY  TO  PV-WK1-DPT-COUNT          07530061
075400         ADD  RC035-EXPTED-ITM-QTY  TO  PV-WK1-BYR-COUNT          07540061
075500         ADD  RC035-EXPTED-ITM-QTY  TO  PV-WK1-DIV-COUNT          07550061
075600         ADD  RC035-EXPTED-ITM-QTY  TO  PV-WK1-COM-COUNT          07560061
075700     ELSE                                                         07570004
075800     IF  RC035-ARRIVE-PERIOD-WEEK  =  '02'                        07580061
075900         ADD  RC035-EXPTED-ITM-QTY  TO  PV-WK2-ORD-COUNT          07590061
076000         ADD  RC035-EXPTED-ITM-QTY  TO  PV-WK2-DPT-COUNT          07600061
076100         ADD  RC035-EXPTED-ITM-QTY  TO  PV-WK2-BYR-COUNT          07610061
076200         ADD  RC035-EXPTED-ITM-QTY  TO  PV-WK2-DIV-COUNT          07620061
076300         ADD  RC035-EXPTED-ITM-QTY  TO  PV-WK2-COM-COUNT          07630061
076400     ELSE                                                         07640004
076500     IF  RC035-ARRIVE-PERIOD-WEEK  =  '03'                        07650061
076600         ADD  RC035-EXPTED-ITM-QTY  TO  PV-WK3-ORD-COUNT          07660061
076700         ADD  RC035-EXPTED-ITM-QTY  TO  PV-WK3-DPT-COUNT          07670061
076800         ADD  RC035-EXPTED-ITM-QTY  TO  PV-WK3-BYR-COUNT          07680061
076900         ADD  RC035-EXPTED-ITM-QTY  TO  PV-WK3-DIV-COUNT          07690061
077000         ADD  RC035-EXPTED-ITM-QTY  TO  PV-WK3-COM-COUNT          07700061
077100     ELSE                                                         07710004
077200     IF  RC035-ARRIVE-PERIOD-WEEK  =  '04'                        07720061
077300         ADD  RC035-EXPTED-ITM-QTY  TO  PV-WK4-ORD-COUNT          07730061
077400         ADD  RC035-EXPTED-ITM-QTY  TO  PV-WK4-DPT-COUNT          07740061
077500         ADD  RC035-EXPTED-ITM-QTY  TO  PV-WK4-BYR-COUNT          07750061
077600         ADD  RC035-EXPTED-ITM-QTY  TO  PV-WK4-DIV-COUNT          07760061
077700         ADD  RC035-EXPTED-ITM-QTY  TO  PV-WK4-COM-COUNT          07770061
077800     ELSE                                                         07780004
077900     IF  RC035-ARRIVE-PERIOD-WEEK  =  '05'                        07790061
078000         ADD  RC035-EXPTED-ITM-QTY  TO  PV-WK5-ORD-COUNT          07800061
078100         ADD  RC035-EXPTED-ITM-QTY  TO  PV-WK5-DPT-COUNT          07810061
078200         ADD  RC035-EXPTED-ITM-QTY  TO  PV-WK5-BYR-COUNT          07820061
078300         ADD  RC035-EXPTED-ITM-QTY  TO  PV-WK5-DIV-COUNT          07830061
078400         ADD  RC035-EXPTED-ITM-QTY  TO  PV-WK5-COM-COUNT.         07840061
078500                                                                  07850004
078600                                                                  07860004
078700 4000-PURCH-ORD-TOTALS.                                           07870004
078701*---------------------------------------------------------------* 07870105
078702*  CALCULATE/PRINT PURCHASE ORDER TOTALS                        * 07870205
078703*---------------------------------------------------------------* 07870305
078704                                                                  07870405
078710*---------------------------------------------------------------* 07871005
078720*  ACCUMULATE THE TOTAL NUMBER OF UNITS RECEIVED/EXPECTED       * 07872005
078730*---------------------------------------------------------------* 07873005
078900         ADD  PV-WK1-ORD-COUNT                                    07890004
079000              PV-WK2-ORD-COUNT                                    07900004
079100              PV-WK3-ORD-COUNT                                    07910004
079200              PV-WK4-ORD-COUNT                                    07920004
079300              PV-WK5-ORD-COUNT  GIVING  PV-ALL-ORD-COUNT.         07930004
079400                                                                  07940004
079416*---------------------------------------------------------------* 07941605
079420*  DETERMINE WEELKY PERCENTAGE:                                 * 07942005
079421*            WEEK UNITS RECEIVED/EXPECTED --- DIVIDED BY ---    * 07942105
079430*            TOTAL UNITS RECEIVED/EXPECTED -- MULTIPLIED BY --  * 07943005
079431*            100  =  WEEKLY PERCENTAGE                          * 07943105
079432*  EX:  WK1 (1000) / TOTAL (5000) = .2 X 100 = 20%              * 07943205
079433*       WK2 (1000) / TOTAL (5000) = .2 X 100 = 20%              * 07943305
079434*       WK3 (2000) / TOTAL (5000) = .4 X 100 = 40%              * 07943405
079435*       WK4 (0500) / TOTAL (5000) = .1 X 100 = 10%              * 07943505
079436*       WK5 (0500) / TOTAL (5000) = .1 X 100 = 10%              * 07943605
079440*---------------------------------------------------------------* 07944005
079500         INITIALIZE    PV-WK1-AMOUNT                              07950040
079501                       PV-WK2-AMOUNT                              07950139
079502                       PV-WK3-AMOUNT                              07950239
079503                       PV-WK4-AMOUNT                              07950339
079504                       PV-WK5-AMOUNT                              07950439
079505                       PV-WK1-PERCENT                             07950539
079506                       PV-WK2-PERCENT                             07950639
079507                       PV-WK3-PERCENT                             07950739
079508                       PV-WK4-PERCENT                             07950839
079509                       PV-WK5-PERCENT.                            07950939
079510                                                                  07951039
079520         IF  PV-ALL-ORD-COUNT  >  ZERO  AND                       07952091
079530             PV-WK1-ORD-COUNT  >  ZERO                            07953091
079540             DIVIDE  PV-WK1-ORD-COUNT  BY  PV-ALL-ORD-COUNT       07954091
079600               GIVING  PV-WK1-AMOUNT                              07960039
079700             MULTIPLY  PV-WK1-AMOUNT   BY  100                    07970039
079800               GIVING  PV-WK1-PERCENT.                            07980039
079900                                                                  07990004
079910         IF  PV-ALL-ORD-COUNT  >  ZERO  AND                       07991091
080000             PV-WK2-ORD-COUNT  >  ZERO                            08000091
080010             DIVIDE  PV-WK2-ORD-COUNT  BY  PV-ALL-ORD-COUNT       08001091
080100               GIVING  PV-WK2-AMOUNT                              08010039
080200             MULTIPLY  PV-WK2-AMOUNT   BY  100                    08020039
080300               GIVING  PV-WK2-PERCENT.                            08030039
080400                                                                  08040004
080410         IF  PV-ALL-ORD-COUNT  >  ZERO  AND                       08041091
080500             PV-WK3-ORD-COUNT  >  ZERO                            08050091
080510             DIVIDE  PV-WK3-ORD-COUNT  BY  PV-ALL-ORD-COUNT       08051091
080600               GIVING  PV-WK3-AMOUNT                              08060039
080700             MULTIPLY  PV-WK3-AMOUNT   BY  100                    08070039
080800               GIVING  PV-WK3-PERCENT.                            08080039
080900                                                                  08090004
080910         IF  PV-ALL-ORD-COUNT  >  ZERO  AND                       08091091
081000             PV-WK4-ORD-COUNT  >  ZERO                            08100091
081010             DIVIDE  PV-WK4-ORD-COUNT  BY  PV-ALL-ORD-COUNT       08101091
081100               GIVING  PV-WK4-AMOUNT                              08110039
081200             MULTIPLY  PV-WK4-AMOUNT   BY  100                    08120039
081300               GIVING  PV-WK4-PERCENT.                            08130039
081400                                                                  08140004
081410         IF  PV-ALL-ORD-COUNT  >  ZERO  AND                       08141091
081500             PV-WK5-ORD-COUNT  >  ZERO                            08150091
081510             DIVIDE  PV-WK5-ORD-COUNT  BY  PV-ALL-ORD-COUNT       08151091
081600               GIVING  PV-WK5-AMOUNT                              08160039
081700             MULTIPLY  PV-WK5-AMOUNT   BY  100                    08170039
081800               GIVING  PV-WK5-PERCENT.                            08180039
081900                                                                  08190004
081910         IF  PV-HOLD-VENDOR-NAME  =   PV-PREV-VENDOR-NAME         08191057
081920             MOVE  SPACES             TO DL2-VENDOR-NAME          08192057
081930         ELSE                                                     08193057
082000             MOVE PV-HOLD-VENDOR-NAME TO DL2-VENDOR-NAME          08200057
082001             MOVE PV-HOLD-VENDOR-NAME TO PV-PREV-VENDOR-NAME.     08200157
082002                                                                  08200257
082010         MOVE  PV-HOLD-PO-NMBR       TO DL2-PO-NBR.               08201050
082100         MOVE  PV-PO-RECEIVERS-CNT   TO DL2-NO-RECEIVERS.         08210004
082200         MOVE  PV-WK1-ORD-COUNT      TO DL2-WEEK-1-UNITS.         08220004
082300         MOVE  PV-WK2-ORD-COUNT      TO DL2-WEEK-2-UNITS.         08230004
082400         MOVE  PV-WK3-ORD-COUNT      TO DL2-WEEK-3-UNITS.         08240004
082500         MOVE  PV-WK4-ORD-COUNT      TO DL2-WEEK-4-UNITS.         08250004
082600         MOVE  PV-WK5-ORD-COUNT      TO DL2-WEEK-5-UNITS.         08260004
082700                                                                  08270004
082800         MOVE  PV-WK1-PERCENT        TO DL3-WEEK-1-PERCENT.       08280004
082900         MOVE  PV-WK2-PERCENT        TO DL3-WEEK-2-PERCENT.       08290004
083000         MOVE  PV-WK3-PERCENT        TO DL3-WEEK-3-PERCENT.       08300004
083100         MOVE  PV-WK4-PERCENT        TO DL3-WEEK-4-PERCENT.       08310004
083200         MOVE  PV-WK5-PERCENT        TO DL3-WEEK-5-PERCENT.       08320004
083300                                                                  08330004
083400         PERFORM 6200-PRINT-PURCH-ORD-TOTALS.                     08340004
083550                                                                  08355053
083600         MOVE  ZEROES                TO PV-WK1-ORD-COUNT          08360004
083700                                        PV-WK2-ORD-COUNT          08370004
083800                                        PV-WK3-ORD-COUNT          08380004
083900                                        PV-WK4-ORD-COUNT          08390004
084000                                        PV-WK5-ORD-COUNT          08400004
084100                                        PV-ALL-ORD-COUNT          08410004
084210                                        PV-PO-RECEIVERS-CNT.      08421023
084220                                                                  08422068
084230                                                                  08423068
084240 4100-VENDOR-TOTALS.                                              08424068
084250*---------------------------------------------------------------* 08425068
084260*  CALCULATE/PRINT VENDOR TOTALS                                * 08426068
084270*---------------------------------------------------------------* 08427068
084280                                                                  08428068
084290*---------------------------------------------------------------* 08429068
084291*  ACCUMULATE THE TOTAL NUMBER OF UNITS RECEIVED/EXPECTED       * 08429168
084292*---------------------------------------------------------------* 08429268
084293         ADD  PV-WK1-VND-COUNT                                    08429368
084294              PV-WK2-VND-COUNT                                    08429468
084295              PV-WK3-VND-COUNT                                    08429568
084296              PV-WK4-VND-COUNT                                    08429668
084297              PV-WK5-VND-COUNT  GIVING  PV-ALL-VND-COUNT.         08429768
084298                                                                  08429868
084299*---------------------------------------------------------------* 08429968
084300*  DETERMINE WEELKY PERCENTAGE:                                 * 08430068
084301*            WEEK UNITS RECEIVED/EXPECTED --- DIVIDED BY ---    * 08430168
084302*            TOTAL UNITS RECEIVED/EXPECTED -- MULTIPLIED BY --  * 08430268
084303*            100  =  WEEKLY PERCENTAGE                          * 08430368
084304*  EX:  WK1 (1000) / TOTAL (5000) = .2 X 100 = 20%              * 08430468
084305*       WK2 (1000) / TOTAL (5000) = .2 X 100 = 20%              * 08430568
084306*       WK3 (2000) / TOTAL (5000) = .4 X 100 = 40%              * 08430668
084307*       WK4 (0500) / TOTAL (5000) = .1 X 100 = 10%              * 08430768
084308*       WK5 (0500) / TOTAL (5000) = .1 X 100 = 10%              * 08430868
084309*---------------------------------------------------------------* 08430968
084310         IF  PV-ALL-VND-COUNT  >  ZERO  AND                       08431091
084311             PV-WK1-VND-COUNT  >  ZERO                            08431191
084312             DIVIDE  PV-WK1-VND-COUNT  BY  PV-ALL-VND-COUNT       08431291
084313               GIVING  PV-WK1-AMOUNT                              08431391
084314             MULTIPLY  PV-WK1-AMOUNT   BY  100                    08431491
084315               GIVING  PV-WK1-PERCENT.                            08431591
084316                                                                  08431691
084317         IF  PV-ALL-VND-COUNT  >  ZERO AND                        08431791
084318             PV-WK2-VND-COUNT  >  ZERO                            08431891
084319             DIVIDE  PV-WK2-VND-COUNT  BY  PV-ALL-VND-COUNT       08431991
084320               GIVING  PV-WK2-AMOUNT                              08432091
084321             MULTIPLY  PV-WK2-AMOUNT   BY  100                    08432191
084322               GIVING  PV-WK2-PERCENT.                            08432291
084323                                                                  08432391
084324         IF  PV-ALL-VND-COUNT  >  ZERO  AND                       08432491
084325             PV-WK3-VND-COUNT  >  ZERO                            08432591
084326             DIVIDE  PV-WK3-VND-COUNT  BY  PV-ALL-VND-COUNT       08432691
084327               GIVING  PV-WK3-AMOUNT                              08432791
084328             MULTIPLY  PV-WK3-AMOUNT   BY  100                    08432891
084329               GIVING  PV-WK3-PERCENT.                            08432991
084330                                                                  08433091
084331         IF  PV-ALL-VND-COUNT  >  ZERO  AND                       08433191
084332             PV-WK4-VND-COUNT  >  ZERO                            08433291
084333             DIVIDE  PV-WK4-VND-COUNT  BY  PV-ALL-VND-COUNT       08433391
084334               GIVING  PV-WK4-AMOUNT                              08433491
084335             MULTIPLY  PV-WK4-AMOUNT   BY  100                    08433591
084336               GIVING  PV-WK4-PERCENT.                            08433691
084337                                                                  08433791
084338         IF  PV-ALL-VND-COUNT  >  ZERO  AND                       08433891
084339             PV-WK5-VND-COUNT  >  ZERO                            08433991
084340             DIVIDE  PV-WK5-VND-COUNT  BY  PV-ALL-VND-COUNT       08434091
084341               GIVING  PV-WK5-AMOUNT                              08434191
084342             MULTIPLY  PV-WK5-AMOUNT   BY  100                    08434291
084343               GIVING  PV-WK5-PERCENT.                            08434391
084344                                                                  08434491
084345*---------------------------------------------------------------* 08434591
084346*  DETERMINE AVERAGE NUMBER OF RECEIVERS PER PURCHASE ORDER     * 08434691
084347*            #RECEIVERS DIVIDED BY #PURCHASE ORDERS = AVG       * 08434791
084348*  EX: RECEIVERS (8) / PURCHASE ORDERS (2) = AVG PER ORDER (4)  * 08434891
084349*---------------------------------------------------------------* 08434991
084350                                                                  08435091
084351     IF  PV-VND-RECEIVERS-CNT  >  0  AND                          08435191
084352         PV-VND-PURCH-ORD-CNT  >  0                               08435291
084353         DIVIDE  PV-VND-RECEIVERS-CNT  BY  PV-VND-PURCH-ORD-CNT   08435391
084354           GIVING  PV-VND-PO-RECVRS-AVG ROUNDED                   08435491
084355     ELSE                                                         08435591
084356         MOVE  ZEROES  TO  PV-VND-PO-RECVRS-AVG                   08435691
084357     END-IF.                                                      08435791
084358                                                                  08435891
084359         MOVE  PC-DESCRIPTION-6      TO TL4-TOT-DESCRIPTION.      08435991
084360                                                                  08436091
084361         MOVE  PV-VND-PO-RECVRS-AVG  TO TL4-TOT-AVG-RECEIVERS.    08436191
084362         MOVE  PV-VND-PURCH-ORD-CNT  TO TL4-TOT-PURCH-ORD.        08436291
084363         MOVE  PV-VND-RECEIVERS-CNT  TO TL4-TOT-RECEIVERS.        08436391
084364                                                                  08436491
084365         MOVE  PV-WK1-VND-COUNT      TO TL4-TOT-WEEK-1-UNITS.     08436591
084366         MOVE  PV-WK2-VND-COUNT      TO TL4-TOT-WEEK-2-UNITS.     08436691
084367         MOVE  PV-WK3-VND-COUNT      TO TL4-TOT-WEEK-3-UNITS.     08436791
084368         MOVE  PV-WK4-VND-COUNT      TO TL4-TOT-WEEK-4-UNITS.     08436891
084369         MOVE  PV-WK5-VND-COUNT      TO TL4-TOT-WEEK-5-UNITS.     08436991
084370                                                                  08437091
084371         MOVE  PV-WK1-PERCENT        TO TL5-TOT-WEEK-1-PERCENT.   08437191
084372         MOVE  PV-WK2-PERCENT        TO TL5-TOT-WEEK-2-PERCENT.   08437291
084373         MOVE  PV-WK3-PERCENT        TO TL5-TOT-WEEK-3-PERCENT.   08437391
084374         MOVE  PV-WK4-PERCENT        TO TL5-TOT-WEEK-4-PERCENT.   08437491
084375         MOVE  PV-WK5-PERCENT        TO TL5-TOT-WEEK-5-PERCENT.   08437591
084376                                                                  08437691
084377         PERFORM 6450-PRINT-TOTALS.                               08437791
084380                                                                  08438071
084383         MOVE  ZEROES                TO PV-WK1-VND-COUNT          08438368
084384                                        PV-WK2-VND-COUNT          08438468
084385                                        PV-WK3-VND-COUNT          08438568
084386                                        PV-WK4-VND-COUNT          08438668
084387                                        PV-WK5-VND-COUNT          08438768
084388                                        PV-ALL-VND-COUNT          08438868
084389                                        PV-VND-PURCH-ORD-CNT      08438968
084390                                        PV-VND-RECEIVERS-CNT.     08439068
084393                                                                  08439304
084400                                                                  08440004
084500 4200-DEPARTMENT-TOTALS.                                          08450004
084501*---------------------------------------------------------------* 08450105
084510*  CALCULATE/PRINT DEPARTMENT TOTALS                            * 08451005
084520*---------------------------------------------------------------* 08452005
084601         MOVE SPACES              TO PV-PREV-VENDOR-NAME.         08460157
084610*---------------------------------------------------------------* 08461005
084620*  ACCUMULATE THE TOTAL NUMBER OF UNITS RECEIVED/EXPECTED       * 08462005
084630*---------------------------------------------------------------* 08463005
084700         ADD  PV-WK1-DPT-COUNT                                    08470004
084800              PV-WK2-DPT-COUNT                                    08480004
084900              PV-WK3-DPT-COUNT                                    08490004
085000              PV-WK4-DPT-COUNT                                    08500004
085100              PV-WK5-DPT-COUNT  GIVING  PV-ALL-DPT-COUNT.         08510005
085200                                                                  08520004
085210*---------------------------------------------------------------* 08521005
085220*  DETERMINE WEELKY PERCENTAGE:                                 * 08522005
085230*            WEEK UNITS RECEIVED/EXPECTED --- DIVIDED BY ---    * 08523005
085240*            TOTAL UNITS RECEIVED/EXPECTED -- MULTIPLIED BY --  * 08524005
085250*            100  =  WEEKLY PERCENTAGE                          * 08525005
085260*  EX:  WK1 (1000) / TOTAL (5000) = .2 X 100 = 20%              * 08526005
085270*       WK2 (1000) / TOTAL (5000) = .2 X 100 = 20%              * 08527005
085280*       WK3 (2000) / TOTAL (5000) = .4 X 100 = 40%              * 08528005
085290*       WK4 (0500) / TOTAL (5000) = .1 X 100 = 10%              * 08529005
085291*       WK5 (0500) / TOTAL (5000) = .1 X 100 = 10%              * 08529105
085292*---------------------------------------------------------------* 08529205
085293         IF  PV-ALL-DPT-COUNT  >  ZERO  AND                       08529391
085300             PV-WK1-DPT-COUNT  >  ZERO                            08530091
085310             DIVIDE  PV-WK1-DPT-COUNT  BY  PV-ALL-DPT-COUNT       08531091
085400               GIVING  PV-WK1-AMOUNT                              08540062
085500             MULTIPLY  PV-WK1-AMOUNT   BY  100                    08550062
085600               GIVING  PV-WK1-PERCENT.                            08560062
085700                                                                  08570004
085710         IF  PV-ALL-DPT-COUNT  >  ZERO  AND                       08571091
085800             PV-WK2-DPT-COUNT  >  ZERO                            08580091
085810             DIVIDE  PV-WK2-DPT-COUNT  BY  PV-ALL-DPT-COUNT       08581091
085900               GIVING  PV-WK2-AMOUNT                              08590062
086000             MULTIPLY  PV-WK2-AMOUNT   BY  100                    08600062
086100               GIVING  PV-WK2-PERCENT.                            08610062
086200                                                                  08620004
086210         IF  PV-ALL-DPT-COUNT  >  ZERO  AND                       08621091
086300             PV-WK3-DPT-COUNT  >  ZERO                            08630091
086310             DIVIDE  PV-WK3-DPT-COUNT  BY  PV-ALL-DPT-COUNT       08631091
086400               GIVING  PV-WK3-AMOUNT                              08640062
086500             MULTIPLY  PV-WK3-AMOUNT   BY  100                    08650062
086600               GIVING  PV-WK3-PERCENT.                            08660062
086700                                                                  08670004
086710         IF  PV-ALL-DPT-COUNT  >  ZERO  AND                       08671091
086800             PV-WK4-DPT-COUNT  >  0                               08680091
086810             DIVIDE  PV-WK4-DPT-COUNT  BY  PV-ALL-DPT-COUNT       08681091
086900               GIVING  PV-WK4-AMOUNT                              08690062
087000             MULTIPLY  PV-WK4-AMOUNT   BY  100                    08700062
087100               GIVING  PV-WK4-PERCENT.                            08710062
087200                                                                  08720004
087210         IF  PV-ALL-DPT-COUNT  >  ZERO  AND                       08721091
087300             PV-WK5-DPT-COUNT  >  ZERO                            08730091
087310             DIVIDE  PV-WK5-DPT-COUNT  BY  PV-ALL-DPT-COUNT       08731091
087400               GIVING  PV-WK5-AMOUNT                              08740062
087500             MULTIPLY  PV-WK5-AMOUNT   BY  100                    08750062
087600               GIVING  PV-WK5-PERCENT.                            08760062
087700                                                                  08770004
087710*---------------------------------------------------------------* 08771024
087720*  DETERMINE AVERAGE NUMBER OF RECEIVERS PER PURCHASE ORDER     * 08772024
087730*            #RECEIVERS DIVIDED BY #PURCHASE ORDERS = AVG       * 08773024
087760*  EX: RECEIVERS (8) / PURCHASE ORDERS (2) = AVG PER ORDER (4)  * 08776024
087770*---------------------------------------------------------------* 08777024
087780                                                                  08778089
087800     IF  PV-DPT-RECEIVERS-CNT  >  0  AND                          08780089
087810         PV-DPT-PURCH-ORD-CNT  >  0                               08781089
087820         DIVIDE  PV-DPT-RECEIVERS-CNT  BY  PV-DPT-PURCH-ORD-CNT   08782089
087900           GIVING  PV-DPT-PO-RECVRS-AVG ROUNDED                   08790089
087910     ELSE                                                         08791089
087920         MOVE ZEROES  TO  PV-DPT-PO-RECVRS-AVG                    08792089
087930     END-IF.                                                      08793089
088000                                                                  08800004
088100         MOVE  PC-DESCRIPTION-2      TO TL1-TOT-DESCRIPTION.      08810005
088110         MOVE  PV-DPT-PO-RECVRS-AVG  TO TL1-TOT-AVG-RECEIVERS.    08811078
088200                                                                  08820004
088300         MOVE  PV-WK1-DPT-COUNT      TO TL1-TOT-WEEK-1-UNITS.     08830011
088400         MOVE  PV-WK2-DPT-COUNT      TO TL1-TOT-WEEK-2-UNITS.     08840011
088500         MOVE  PV-WK3-DPT-COUNT      TO TL1-TOT-WEEK-3-UNITS.     08850011
088600         MOVE  PV-WK4-DPT-COUNT      TO TL1-TOT-WEEK-4-UNITS.     08860011
088700         MOVE  PV-WK5-DPT-COUNT      TO TL1-TOT-WEEK-5-UNITS.     08870011
088800                                                                  08880004
088900         MOVE  PV-WK1-PERCENT        TO TL2-TOT-WEEK-1-PERCENT.   08890011
089000         MOVE  PV-WK2-PERCENT        TO TL2-TOT-WEEK-2-PERCENT.   08900011
089100         MOVE  PV-WK3-PERCENT        TO TL2-TOT-WEEK-3-PERCENT.   08910011
089200         MOVE  PV-WK4-PERCENT        TO TL2-TOT-WEEK-4-PERCENT.   08920011
089300         MOVE  PV-WK5-PERCENT        TO TL2-TOT-WEEK-5-PERCENT.   08930011
089400                                                                  08940004
089700                                                                  08970004
089800         PERFORM 6400-PRINT-TOTALS.                               08980026
089900                                                                  08990004
089910         INITIALIZE  RC036-RCVR-EXTRACT-RECORD.                   08991063
089934         MOVE PC-ONE                 TO RC036-TOTALS-TYPE.        08993461
089935         MOVE PV-WK1-DPT-COUNT       TO RC036-WK1-UNITS.          08993561
089936         MOVE PV-WK2-DPT-COUNT       TO RC036-WK2-UNITS.          08993661
089937         MOVE PV-WK3-DPT-COUNT       TO RC036-WK3-UNITS.          08993761
089938         MOVE PV-WK4-DPT-COUNT       TO RC036-WK4-UNITS.          08993861
089939         MOVE PV-WK5-DPT-COUNT       TO RC036-WK5-UNITS.          08993961
089940         MOVE PV-WK1-PERCENT         TO RC036-WK1-PERCENT.        08994061
089941         MOVE PV-WK2-PERCENT         TO RC036-WK2-PERCENT.        08994166
089942         MOVE PV-WK3-PERCENT         TO RC036-WK3-PERCENT.        08994266
089943         MOVE PV-WK4-PERCENT         TO RC036-WK4-PERCENT.        08994366
089944         MOVE PV-WK5-PERCENT         TO RC036-WK5-PERCENT.        08994466
089945         MOVE PV-DPT-PO-RECVRS-AVG   TO RC036-AVG-RECEIVERS.      08994561
089951                                                                  08995159
089960         PERFORM 5000-WRITE-SUMMARY-RECORD.                       08996053
089990                                                                  08999053
090000         MOVE  ZEROES                TO PV-WK1-DPT-COUNT          09000004
090100                                        PV-WK2-DPT-COUNT          09010004
090200                                        PV-WK3-DPT-COUNT          09020004
090300                                        PV-WK4-DPT-COUNT          09030004
090400                                        PV-WK5-DPT-COUNT          09040004
090500                                        PV-ALL-DPT-COUNT          09050004
090510                                        PV-DPT-PURCH-ORD-CNT      09051023
090600                                        PV-DPT-RECEIVERS-CNT.     09060004
090700                                                                  09070004
090800                                                                  09080004
090900 4400-BUYER-TOTALS.                                               09090004
090910*---------------------------------------------------------------* 09091005
090920*  CALCULATE/PRINT BUYER TOTALS                                 * 09092005
090930*---------------------------------------------------------------* 09093005
090940                                                                  09094005
090950*---------------------------------------------------------------* 09095005
090960*  ACCUMULATE THE TOTAL NUMBER OF UNITS RECEIVED/EXPECTED       * 09096005
090970*---------------------------------------------------------------* 09097005
090980         ADD  PV-WK1-BYR-COUNT                                    09098005
090990              PV-WK2-BYR-COUNT                                    09099005
090991              PV-WK3-BYR-COUNT                                    09099105
090992              PV-WK4-BYR-COUNT                                    09099205
090993              PV-WK5-BYR-COUNT  GIVING  PV-ALL-BYR-COUNT.         09099305
090994                                                                  09099405
090995*---------------------------------------------------------------* 09099505
090996*  DETERMINE WEELKY PERCENTAGE:                                 * 09099605
090997*            WEEK UNITS RECEIVED/EXPECTED --- DIVIDED BY ---    * 09099705
090998*            TOTAL UNITS RECEIVED/EXPECTED -- MULTIPLIED BY --  * 09099805
090999*            100  =  WEEKLY PERCENTAGE                          * 09099905
091000*  EX:  WK1 (1000) / TOTAL (5000) = .2 X 100 = 20%              * 09100005
091001*       WK2 (1000) / TOTAL (5000) = .2 X 100 = 20%              * 09100105
091002*       WK3 (2000) / TOTAL (5000) = .4 X 100 = 40%              * 09100205
091003*       WK4 (0500) / TOTAL (5000) = .1 X 100 = 10%              * 09100305
091004*       WK5 (0500) / TOTAL (5000) = .1 X 100 = 10%              * 09100405
091005*---------------------------------------------------------------* 09100505
091006                                                                  09100691
091007     IF  PV-WK1-BYR-COUNT  >  ZERO  AND                           09100791
091008         PV-ALL-BYR-COUNT  >  ZERO                                09100891
091009         DIVIDE  PV-WK1-BYR-COUNT  BY  PV-ALL-BYR-COUNT           09100991
091010           GIVING  PV-WK1-AMOUNT                                  09101091
091011         MULTIPLY  PV-WK1-AMOUNT   BY  100                        09101191
091012           GIVING  PV-WK1-PERCENT                                 09101291
091013     ELSE                                                         09101391
091014         MOVE ZERO  TO   PV-WK1-PERCENT                           09101491
091015     END-IF.                                                      09101591
091016                                                                  09101691
091017     IF  PV-WK2-BYR-COUNT  >  ZERO  AND                           09101791
091018         PV-ALL-BYR-COUNT  >  ZERO                                09101891
091019         DIVIDE  PV-WK2-BYR-COUNT  BY  PV-ALL-BYR-COUNT           09101991
091020           GIVING  PV-WK2-AMOUNT                                  09102091
091021         MULTIPLY  PV-WK2-AMOUNT   BY  100                        09102191
091022           GIVING  PV-WK2-PERCENT                                 09102291
091023     ELSE                                                         09102391
091024         MOVE ZERO TO  PV-WK2-PERCENT                             09102491
091025     END-IF.                                                      09102591
091026                                                                  09102691
091027     IF  PV-WK3-BYR-COUNT  >  ZERO  AND                           09102791
091028         PV-ALL-BYR-COUNT  >  ZERO                                09102891
091029         DIVIDE  PV-WK3-BYR-COUNT  BY  PV-ALL-BYR-COUNT           09102991
091030           GIVING  PV-WK3-AMOUNT                                  09103091
091031         MULTIPLY  PV-WK3-AMOUNT   BY  100                        09103191
091032           GIVING  PV-WK3-PERCENT                                 09103291
091033     ELSE                                                         09103391
091034         MOVE  ZERO  TO  PV-WK3-PERCENT                           09103491
091035     END-IF.                                                      09103591
091036                                                                  09103691
091037     IF  PV-WK4-BYR-COUNT  >  ZERO  AND                           09103791
091038         PV-ALL-BYR-COUNT  >  ZERO                                09103891
091039         DIVIDE  PV-WK4-BYR-COUNT  BY  PV-ALL-BYR-COUNT           09103991
091040           GIVING  PV-WK4-AMOUNT                                  09104091
091041         MULTIPLY  PV-WK4-AMOUNT   BY  100                        09104191
091042           GIVING  PV-WK4-PERCENT                                 09104291
091043     ELSE                                                         09104391
091044         MOVE ZERO  TO  PV-WK4-PERCENT                            09104491
091045     END-IF.                                                      09104591
091046                                                                  09104691
091047     IF  PV-WK5-BYR-COUNT  >  ZERO  AND                           09104791
091048         PV-ALL-BYR-COUNT  >  ZERO                                09104891
091049         DIVIDE  PV-WK5-BYR-COUNT  BY  PV-ALL-BYR-COUNT           09104991
091050           GIVING  PV-WK5-AMOUNT                                  09105091
091051         MULTIPLY  PV-WK5-AMOUNT   BY  100                        09105191
091052           GIVING  PV-WK5-PERCENT                                 09105291
091053     ELSE                                                         09105391
091054         MOVE ZERO  TO  PV-WK5-PERCENT                            09105491
091055     END-IF.                                                      09105591
091056                                                                  09105691
091057*---------------------------------------------------------------* 09105791
091058*  DETERMINE AVERAGE NUMBER OF RECEIVERS PER PURCHASE ORDER     * 09105891
091059*            #RECEIVERS DIVIDED BY #PURCHASE ORDERS = AVG       * 09105991
091060*  EX: RECEIVERS (8) / PURCHASE ORDERS (2) = AVG PER ORDER (4)  * 09106091
091061*---------------------------------------------------------------* 09106191
091062                                                                  09106291
091063     IF  PV-BYR-RECEIVERS-CNT  >  0  AND                          09106391
091064         PV-BYR-PURCH-ORD-CNT  >  0                               09106491
091065         DIVIDE  PV-BYR-RECEIVERS-CNT  BY  PV-BYR-PURCH-ORD-CNT   09106591
091066           GIVING  PV-BYR-PO-RECVRS-AVG ROUNDED                   09106691
091067     ELSE                                                         09106791
091068         MOVE ZEROES  TO  PV-BYR-PO-RECVRS-AVG                    09106891
091069     END-IF.                                                      09106991
091070                                                                  09107091
091071         MOVE  PC-DESCRIPTION-3      TO TL1-TOT-DESCRIPTION.      09107191
091072         MOVE  PV-BYR-PO-RECVRS-AVG  TO TL1-TOT-AVG-RECEIVERS.    09107291
091073                                                                  09107391
091074         MOVE  PV-WK1-BYR-COUNT      TO TL1-TOT-WEEK-1-UNITS.     09107491
091075         MOVE  PV-WK2-BYR-COUNT      TO TL1-TOT-WEEK-2-UNITS.     09107591
091076         MOVE  PV-WK3-BYR-COUNT      TO TL1-TOT-WEEK-3-UNITS.     09107691
091077         MOVE  PV-WK4-BYR-COUNT      TO TL1-TOT-WEEK-4-UNITS.     09107791
091078         MOVE  PV-WK5-BYR-COUNT      TO TL1-TOT-WEEK-5-UNITS.     09107891
091079                                                                  09107991
091080         MOVE  PV-WK1-PERCENT        TO TL2-TOT-WEEK-1-PERCENT.   09108091
091081         MOVE  PV-WK2-PERCENT        TO TL2-TOT-WEEK-2-PERCENT.   09108191
091082         MOVE  PV-WK3-PERCENT        TO TL2-TOT-WEEK-3-PERCENT.   09108291
091083         MOVE  PV-WK4-PERCENT        TO TL2-TOT-WEEK-4-PERCENT.   09108391
091084         MOVE  PV-WK5-PERCENT        TO TL2-TOT-WEEK-5-PERCENT.   09108491
091085                                                                  09108591
091086         PERFORM 6400-PRINT-TOTALS.                               09108691
091087                                                                  09108791
091088         INITIALIZE  RC036-RCVR-EXTRACT-RECORD.                   09108891
091089         MOVE PC-TWO                 TO RC036-TOTALS-TYPE.        09108991
091090         MOVE PV-WK1-BYR-COUNT       TO RC036-WK1-UNITS.          09109091
091091         MOVE PV-WK2-BYR-COUNT       TO RC036-WK2-UNITS.          09109191
091092         MOVE PV-WK3-BYR-COUNT       TO RC036-WK3-UNITS.          09109291
091093         MOVE PV-WK4-BYR-COUNT       TO RC036-WK4-UNITS.          09109391
091094         MOVE PV-WK5-BYR-COUNT       TO RC036-WK5-UNITS.          09109491
091095         MOVE PV-WK1-PERCENT         TO RC036-WK1-PERCENT.        09109591
091096         MOVE PV-WK2-PERCENT         TO RC036-WK2-PERCENT.        09109691
091097         MOVE PV-WK3-PERCENT         TO RC036-WK3-PERCENT.        09109791
091098         MOVE PV-WK4-PERCENT         TO RC036-WK4-PERCENT.        09109891
091099         MOVE PV-WK5-PERCENT         TO RC036-WK5-PERCENT.        09109991
091100         MOVE PV-BYR-PO-RECVRS-AVG   TO RC036-AVG-RECEIVERS.      09110091
091101                                                                  09110191
091102         PERFORM 5000-WRITE-SUMMARY-RECORD.                       09110291
091103                                                                  09110391
091104         MOVE  ZEROES                TO PV-WK1-BYR-COUNT          09110491
091105                                        PV-WK2-BYR-COUNT          09110591
091106                                        PV-WK3-BYR-COUNT          09110691
091107                                        PV-WK4-BYR-COUNT          09110791
091108                                        PV-WK5-BYR-COUNT          09110891
091109                                        PV-ALL-BYR-COUNT          09110991
091110                                        PV-BYR-PURCH-ORD-CNT      09111091
091111                                        PV-BYR-RECEIVERS-CNT.     09111191
091120                                                                  09112091
091200                                                                  09120091
092000 4600-DIVISION-TOTALS.                                            09200004
092020*---------------------------------------------------------------* 09202005
092030*  CALCULATE/PRINT DIVISION TOTALS                              * 09203005
092040*---------------------------------------------------------------* 09204005
092050                                                                  09205005
092060*---------------------------------------------------------------* 09206005
092070*  ACCUMULATE THE TOTAL NUMBER OF UNITS RECEIVED/EXPECTED       * 09207005
092080*---------------------------------------------------------------* 09208005
092090         ADD  PV-WK1-DIV-COUNT                                    09209005
092091              PV-WK2-DIV-COUNT                                    09209105
092092              PV-WK3-DIV-COUNT                                    09209205
092093              PV-WK4-DIV-COUNT                                    09209305
092094              PV-WK5-DIV-COUNT  GIVING  PV-ALL-DIV-COUNT.         09209405
092095                                                                  09209505
092096*---------------------------------------------------------------* 09209605
092097*  DETERMINE WEELKY PERCENTAGE:                                 * 09209705
092098*            WEEK UNITS RECEIVED/EXPECTED --- DIVIDED BY ---    * 09209805
092099*            TOTAL UNITS RECEIVED/EXPECTED -- MULTIPLIED BY --  * 09209905
092100*            100  =  WEEKLY PERCENTAGE                          * 09210005
092101*  EX:  WK1 (1000) / TOTAL (5000) = .2 X 100 = 20%              * 09210105
092102*       WK2 (1000) / TOTAL (5000) = .2 X 100 = 20%              * 09210205
092103*       WK3 (2000) / TOTAL (5000) = .4 X 100 = 40%              * 09210305
092104*       WK4 (0500) / TOTAL (5000) = .1 X 100 = 10%              * 09210405
092105*       WK5 (0500) / TOTAL (5000) = .1 X 100 = 10%              * 09210505
092106*---------------------------------------------------------------* 09210605
092107                                                                  09210791
092108     IF  PV-WK1-DIV-COUNT  >  ZERO  AND                           09210891
092109         PV-ALL-DIV-COUNT  >  ZERO                                09210991
092110         DIVIDE  PV-WK1-DIV-COUNT  BY  PV-ALL-DIV-COUNT           09211091
092111           GIVING  PV-WK1-AMOUNT                                  09211191
092112         MULTIPLY  PV-WK1-AMOUNT   BY  100                        09211291
092113           GIVING  PV-WK1-PERCENT                                 09211391
092114     ELSE                                                         09211491
092115         MOVE ZERO TO PV-WK1-PERCENT                              09211591
092116     END-IF.                                                      09211691
092117                                                                  09211791
092118     IF  PV-WK2-DIV-COUNT  >  ZERO  AND                           09211891
092119         PV-ALL-DIV-COUNT  >  ZERO                                09211991
092120         DIVIDE  PV-WK2-DIV-COUNT  BY  PV-ALL-DIV-COUNT           09212091
092121           GIVING  PV-WK2-AMOUNT                                  09212191
092122         MULTIPLY  PV-WK2-AMOUNT   BY  100                        09212291
092123           GIVING  PV-WK2-PERCENT                                 09212391
092124     ELSE                                                         09212491
092125         MOVE  ZERO  TO  PV-WK2-PERCENT                           09212591
092126     END-IF.                                                      09212691
092127                                                                  09212791
092128     IF  PV-WK3-DIV-COUNT  >  ZERO  AND                           09212891
092129         PV-ALL-DIV-COUNT  >  ZERO                                09212991
092130         DIVIDE  PV-WK3-DIV-COUNT  BY  PV-ALL-DIV-COUNT           09213091
092131           GIVING  PV-WK3-AMOUNT                                  09213191
092132         MULTIPLY  PV-WK3-AMOUNT   BY  100                        09213291
092133           GIVING  PV-WK3-PERCENT                                 09213391
092134     ELSE                                                         09213491
092135         MOVE ZERO TO PV-WK3-PERCENT                              09213591
092136     END-IF.                                                      09213691
092137                                                                  09213791
092138     IF  PV-WK4-DIV-COUNT  >  ZERO  AND                           09213891
092139         PV-ALL-DIV-COUNT  >  ZERO                                09213991
092140         DIVIDE  PV-WK4-DIV-COUNT  BY  PV-ALL-DIV-COUNT           09214091
092141          GIVING  PV-WK4-AMOUNT                                   09214191
092142         MULTIPLY  PV-WK4-AMOUNT   BY  100                        09214291
092143           GIVING  PV-WK4-PERCENT                                 09214391
092144     ELSE                                                         09214491
092145         MOVE ZERO  TO  PV-WK4-PERCENT                            09214591
092146     END-IF.                                                      09214691
092147                                                                  09214791
092148     IF  PV-WK5-DIV-COUNT  >  ZERO  AND                           09214891
092149         PV-ALL-DIV-COUNT  >  ZERO                                09214991
092150         DIVIDE  PV-WK5-DIV-COUNT  BY  PV-ALL-DIV-COUNT           09215091
092151           GIVING  PV-WK5-AMOUNT                                  09215191
092152         MULTIPLY  PV-WK5-AMOUNT   BY  100                        09215291
092153           GIVING  PV-WK5-PERCENT                                 09215391
092154     ELSE                                                         09215491
092155         MOVE ZERO  TO  PV-WK5-PERCENT                            09215591
092156     END-IF.                                                      09215691
092157                                                                  09215791
092158*---------------------------------------------------------------* 09215891
092159*  DETERMINE AVERAGE NUMBER OF RECEIVERS PER PURCHASE ORDER     * 09215991
092160*            #RECEIVERS DIVIDED BY #PURCHASE ORDERS = AVG       * 09216091
092161*  EX: RECEIVERS (8) / PURCHASE ORDERS (2) = AVG PER ORDER (4)  * 09216191
092162*---------------------------------------------------------------* 09216291
092163                                                                  09216391
092164     IF  PV-DIV-RECEIVERS-CNT  >  0  AND                          09216491
092165         PV-DIV-PURCH-ORD-CNT  >  0                               09216591
092166         DIVIDE  PV-DIV-RECEIVERS-CNT  BY  PV-DIV-PURCH-ORD-CNT   09216691
092167           GIVING  PV-DIV-PO-RECVRS-AVG ROUNDED                   09216791
092168     ELSE                                                         09216891
092169         MOVE ZEROES  TO  PV-DIV-PO-RECVRS-AVG                    09216991
092170     END-IF.                                                      09217091
092171                                                                  09217191
092172         MOVE  PC-DESCRIPTION-4      TO TL1-TOT-DESCRIPTION.      09217291
092173         MOVE  PV-DIV-PO-RECVRS-AVG  TO TL1-TOT-AVG-RECEIVERS.    09217391
092174                                                                  09217491
092175         MOVE  PV-WK1-DIV-COUNT      TO TL1-TOT-WEEK-1-UNITS.     09217591
092176         MOVE  PV-WK2-DIV-COUNT      TO TL1-TOT-WEEK-2-UNITS.     09217691
092177         MOVE  PV-WK3-DIV-COUNT      TO TL1-TOT-WEEK-3-UNITS.     09217791
092178         MOVE  PV-WK4-DIV-COUNT      TO TL1-TOT-WEEK-4-UNITS.     09217891
092179         MOVE  PV-WK5-DIV-COUNT      TO TL1-TOT-WEEK-5-UNITS.     09217991
092180                                                                  09218091
092181         MOVE  PV-WK1-PERCENT        TO TL2-TOT-WEEK-1-PERCENT.   09218191
092182         MOVE  PV-WK2-PERCENT        TO TL2-TOT-WEEK-2-PERCENT.   09218291
092183         MOVE  PV-WK3-PERCENT        TO TL2-TOT-WEEK-3-PERCENT.   09218391
092184         MOVE  PV-WK4-PERCENT        TO TL2-TOT-WEEK-4-PERCENT.   09218491
092185         MOVE  PV-WK5-PERCENT        TO TL2-TOT-WEEK-5-PERCENT.   09218591
092186                                                                  09218691
092187         PERFORM 6400-PRINT-TOTALS.                               09218791
092188                                                                  09218891
092189         INITIALIZE  RC036-RCVR-EXTRACT-RECORD.                   09218991
092190         MOVE PC-THREE               TO RC036-TOTALS-TYPE.        09219091
092191         MOVE PV-WK1-DIV-COUNT       TO RC036-WK1-UNITS.          09219191
092192         MOVE PV-WK2-DIV-COUNT       TO RC036-WK2-UNITS.          09219291
092193         MOVE PV-WK3-DIV-COUNT       TO RC036-WK3-UNITS.          09219391
092194         MOVE PV-WK4-DIV-COUNT       TO RC036-WK4-UNITS.          09219491
092195         MOVE PV-WK5-DIV-COUNT       TO RC036-WK5-UNITS.          09219591
092196         MOVE PV-WK1-PERCENT         TO RC036-WK1-PERCENT.        09219691
092197         MOVE PV-WK2-PERCENT         TO RC036-WK2-PERCENT.        09219791
092198         MOVE PV-WK3-PERCENT         TO RC036-WK3-PERCENT.        09219891
092199         MOVE PV-WK4-PERCENT         TO RC036-WK4-PERCENT.        09219991
092200         MOVE PV-WK5-PERCENT         TO RC036-WK5-PERCENT.        09220091
092201         MOVE PV-DIV-PO-RECVRS-AVG   TO RC036-AVG-RECEIVERS.      09220191
092202                                                                  09220291
092203         PERFORM 5000-WRITE-SUMMARY-RECORD.                       09220391
092204                                                                  09220491
092205         MOVE  ZEROES                TO PV-WK1-DIV-COUNT          09220591
092206                                        PV-WK2-DIV-COUNT          09220691
092207                                        PV-WK3-DIV-COUNT          09220791
092208                                        PV-WK4-DIV-COUNT          09220891
092209                                        PV-WK5-DIV-COUNT          09220991
092210                                        PV-ALL-DIV-COUNT          09221091
092220                                        PV-DIV-PURCH-ORD-CNT      09222091
092300                                        PV-DIV-RECEIVERS-CNT.     09230091
093000                                                                  09300004
093100                                                                  09310002
093200 4800-COMPANY-TOTALS.                                             09320004
093210*---------------------------------------------------------------* 09321005
093220*  CALCULATE/PRINT COMPANY TOTALS                               * 09322005
093230*---------------------------------------------------------------* 09323005
093240                                                                  09324005
093250*---------------------------------------------------------------* 09325005
093260*  ACCUMULATE THE TOTAL NUMBER OF UNITS RECEIVED/EXPECTED       * 09326005
093270*---------------------------------------------------------------* 09327005
093280         ADD  PV-WK1-COM-COUNT                                    09328005
093290              PV-WK2-COM-COUNT                                    09329005
093291              PV-WK3-COM-COUNT                                    09329105
093292              PV-WK4-COM-COUNT                                    09329205
093293              PV-WK5-COM-COUNT  GIVING  PV-ALL-COM-COUNT.         09329305
093294                                                                  09329405
093295*---------------------------------------------------------------* 09329505
093296*  DETERMINE WEELKY PERCENTAGE:                                 * 09329605
093297*            WEEK UNITS RECEIVED/EXPECTED --- DIVIDED BY ---    * 09329705
093298*            TOTAL UNITS RECEIVED/EXPECTED -- MULTIPLIED BY --  * 09329805
093299*            100  =  WEEKLY PERCENTAGE                          * 09329905
093300*  EX:  WK1 (1000) / TOTAL (5000) = .2 X 100 = 20%              * 09330005
093301*       WK2 (1000) / TOTAL (5000) = .2 X 100 = 20%              * 09330105
093302*       WK3 (2000) / TOTAL (5000) = .4 X 100 = 40%              * 09330205
093303*       WK4 (0500) / TOTAL (5000) = .1 X 100 = 10%              * 09330305
093304*       WK5 (0500) / TOTAL (5000) = .1 X 100 = 10%              * 09330405
093305*---------------------------------------------------------------* 09330505
093306                                                                  09330691
093307     IF  PV-WK1-COM-COUNT  >  0  AND                              09330791
093308         PV-ALL-COM-COUNT  >  0                                   09330891
093309         DIVIDE  PV-WK1-COM-COUNT  BY  PV-ALL-COM-COUNT           09330991
093310           GIVING  PV-WK1-AMOUNT                                  09331091
093311         MULTIPLY  PV-WK1-AMOUNT   BY  100                        09331191
093312           GIVING  PV-WK1-PERCENT                                 09331291
093313     ELSE                                                         09331391
093314         MOVE  ZEROES  TO PV-WK1-PERCENT                          09331491
093315     END-IF.                                                      09331591
093316                                                                  09331691
093317     IF  PV-WK2-COM-COUNT  >  0  AND                              09331791
093318         PV-ALL-COM-COUNT  >  0                                   09331891
093319         DIVIDE  PV-WK2-COM-COUNT  BY  PV-ALL-COM-COUNT           09331991
093322           GIVING  PV-WK2-AMOUNT                                  09332291
093323         MULTIPLY  PV-WK2-AMOUNT   BY  100                        09332391
093324           GIVING  PV-WK2-PERCENT                                 09332491
093325     ELSE                                                         09332591
093326         MOVE  ZEROES  TO PV-WK2-PERCENT                          09332691
093327     END-IF.                                                      09332791
093328                                                                  09332891
093329     IF  PV-WK3-COM-COUNT  >  0  AND                              09332991
093330         PV-ALL-COM-COUNT  >  0                                   09333091
093331         DIVIDE  PV-WK3-COM-COUNT  BY  PV-ALL-COM-COUNT           09333191
093332           GIVING  PV-WK3-AMOUNT                                  09333291
093333         MULTIPLY  PV-WK3-AMOUNT   BY  100                        09333391
093334           GIVING  PV-WK3-PERCENT                                 09333491
093335     ELSE                                                         09333591
093336         MOVE  ZEROES  TO PV-WK3-PERCENT                          09333691
093337     END-IF.                                                      09333791
093338                                                                  09333891
093339     IF  PV-WK4-COM-COUNT  >  0  AND                              09333991
093340         PV-ALL-COM-COUNT  >  0                                   09334091
093341         DIVIDE  PV-WK4-COM-COUNT  BY  PV-ALL-COM-COUNT           09334191
093342           GIVING  PV-WK4-AMOUNT                                  09334291
093343         MULTIPLY  PV-WK4-AMOUNT   BY  100                        09334391
093344           GIVING  PV-WK4-PERCENT                                 09334491
093345     ELSE                                                         09334591
093346         MOVE  ZEROES  TO PV-WK4-PERCENT                          09334691
093347     END-IF.                                                      09334791
093348                                                                  09334891
093349     IF  PV-WK5-COM-COUNT  >  0  AND                              09334991
093350         PV-ALL-COM-COUNT  >  0                                   09335091
093351         DIVIDE  PV-WK5-COM-COUNT  BY  PV-ALL-COM-COUNT           09335191
093352           GIVING  PV-WK5-AMOUNT                                  09335291
093353         MULTIPLY  PV-WK5-AMOUNT   BY  100                        09335391
093354           GIVING  PV-WK5-PERCENT                                 09335491
093355     ELSE                                                         09335591
093356         MOVE  ZEROES  TO PV-WK5-PERCENT                          09335691
093357     END-IF.                                                      09335791
093358                                                                  09335891
093359*---------------------------------------------------------------* 09335991
093360*  DETERMINE AVERAGE NUMBER OF RECEIVERS PER PURCHASE ORDER     * 09336091
093361*            #RECEIVERS DIVIDED BY #PURCHASE ORDERS = AVG       * 09336191
093362*  EX: RECEIVERS (8) / PURCHASE ORDERS (2) = AVG PER ORDER (4)  * 09336291
093363*---------------------------------------------------------------* 09336391
093364                                                                  09336491
093365     IF  PV-COM-RECEIVERS-CNT  >  0  AND                          09336591
093366         PV-COM-PURCH-ORD-CNT  >  0                               09336691
093367         DIVIDE  PV-COM-RECEIVERS-CNT  BY  PV-COM-PURCH-ORD-CNT   09336791
093368           GIVING  PV-COM-PO-RECVRS-AVG                           09336891
093369     ELSE                                                         09336991
093370         MOVE ZEROES  TO  PV-COM-PO-RECVRS-AVG                    09337091
093371     END-IF.                                                      09337191
093372                                                                  09337291
093373         MOVE  PC-DESCRIPTION-5      TO TL1-TOT-DESCRIPTION.      09337391
093374         MOVE  PV-COM-PO-RECVRS-AVG  TO TL1-TOT-AVG-RECEIVERS.    09337491
093375                                                                  09337591
093376         MOVE  PV-WK1-COM-COUNT      TO TL1-TOT-WEEK-1-UNITS.     09337691
093377         MOVE  PV-WK2-COM-COUNT      TO TL1-TOT-WEEK-2-UNITS.     09337791
093378         MOVE  PV-WK3-COM-COUNT      TO TL1-TOT-WEEK-3-UNITS.     09337891
093379         MOVE  PV-WK4-COM-COUNT      TO TL1-TOT-WEEK-4-UNITS.     09337991
093380         MOVE  PV-WK5-COM-COUNT      TO TL1-TOT-WEEK-5-UNITS.     09338091
093381                                                                  09338191
093382         MOVE  PV-WK1-PERCENT        TO TL2-TOT-WEEK-1-PERCENT.   09338291
093383         MOVE  PV-WK2-PERCENT        TO TL2-TOT-WEEK-2-PERCENT.   09338391
093384         MOVE  PV-WK3-PERCENT        TO TL2-TOT-WEEK-3-PERCENT.   09338491
093385         MOVE  PV-WK4-PERCENT        TO TL2-TOT-WEEK-4-PERCENT.   09338591
093386         MOVE  PV-WK5-PERCENT        TO TL2-TOT-WEEK-5-PERCENT.   09338691
093387                                                                  09338791
093388         PERFORM 6400-PRINT-TOTALS.                               09338891
093389                                                                  09338991
093390         INITIALIZE  RC036-RCVR-EXTRACT-RECORD.                   09339091
093391         MOVE PC-FOUR                TO RC036-TOTALS-TYPE.        09339191
093392         MOVE PV-WK1-COM-COUNT       TO RC036-WK1-UNITS.          09339291
093393         MOVE PV-WK2-COM-COUNT       TO RC036-WK2-UNITS.          09339391
093394         MOVE PV-WK3-COM-COUNT       TO RC036-WK3-UNITS.          09339491
093395         MOVE PV-WK4-COM-COUNT       TO RC036-WK4-UNITS.          09339591
093396         MOVE PV-WK5-COM-COUNT       TO RC036-WK5-UNITS.          09339691
093397         MOVE PV-WK1-PERCENT         TO RC036-WK1-PERCENT.        09339791
093398         MOVE PV-WK2-PERCENT         TO RC036-WK2-PERCENT.        09339891
093399         MOVE PV-WK3-PERCENT         TO RC036-WK3-PERCENT.        09339991
093400         MOVE PV-WK4-PERCENT         TO RC036-WK4-PERCENT.        09340091
093401         MOVE PV-WK5-PERCENT         TO RC036-WK5-PERCENT.        09340191
093402         MOVE PV-COM-PO-RECVRS-AVG   TO RC036-AVG-RECEIVERS.      09340291
093403                                                                  09340391
093404         PERFORM 5000-WRITE-SUMMARY-RECORD.                       09340491
093405                                                                  09340591
093406         MOVE  ZEROES                TO PV-WK1-COM-COUNT          09340691
093407                                        PV-WK2-COM-COUNT          09340791
093408                                        PV-WK3-COM-COUNT          09340891
093409                                        PV-WK4-COM-COUNT          09340991
093410                                        PV-WK5-COM-COUNT          09341091
093411                                        PV-ALL-COM-COUNT          09341191
093412                                        PV-COM-PURCH-ORD-CNT      09341291
093413                                        PV-COM-RECEIVERS-CNT.     09341391
093414                                                                  09341491
093415                                                                  09341591
093416 5000-WRITE-SUMMARY-RECORD.                                       09341691
093417*---------------------------------------------------------------* 09341791
093418*  WRITE TOTAL SUMMARY RECORD                                   * 09341891
093419*---------------------------------------------------------------* 09341991
093420         MOVE PV-HOLD-DIVISION-NBR   TO RC036-DMM-NMBR.           09342091
093421         MOVE PV-HOLD-DIVISION-NAME  TO RC036-DMM-NAME.           09342191
093422         MOVE PV-HOLD-BUYER-NBR      TO RC036-BYR-NMBR.           09342291
093430         MOVE PV-HOLD-BUYER-NAME     TO RC036-BYR-NAME.           09343091
093500         MOVE PV-HOLD-DEPT-NBR       TO RC036-DEPT-NBR.           09350061
093600         MOVE PV-HOLD-DEPT-NAME      TO RC036-DEPT-NAME.          09360061
093610         MOVE PV-WORK-MONTH-YEAR     TO RC036-RPT-MONTH-YEAR.     09361061
093700                                                                  09370053
093710     WRITE SUMMARY-RECORD                                         09371053
093720       FROM RC036-RCVR-EXTRACT-RECORD.                            09372065
093740                                                                  09374053
093800     ADD  1  TO  PV-SUMMARY-COUNT.                                09380053
093900                                                                  09390053
094370                                                                  09437053
094400 6000-PRINT-RPT-HEADING.                                          09440004
094500*---------------------------------------------------------------* 09450005
094600*  HEADING ROUTINE.                                             * 09460004
094610*---------------------------------------------------------------* 09461005
094800     ADD 1                       TO PV-PAGE-COUNT.                09480004
094900     MOVE PV-PAGE-COUNT          TO DP132O-PAGE-NUMBER.           09490004
095000                                                                  09500004
095010     MOVE 9                      TO PV-LINE-COUNT.                09501057
095020                                                                  09502048
095100     WRITE REPORT-RECORD                                          09510004
095200       FROM DP132O-STANDRD-HEADER-132-COLS                        09520004
095300         AFTER ADVANCING PAGE.                                    09530004
095400                                                                  09540004
095500     WRITE REPORT-RECORD                                          09550004
095600       FROM HL1-HEADING-LINE-1                                    09560004
095700         AFTER ADVANCING 2 LINES.                                 09570004
095800                                                                  09580004
095900     WRITE REPORT-RECORD                                          09590004
096000       FROM HL2-HEADING-LINE-2                                    09600004
096100         AFTER ADVANCING 2 LINES.                                 09610004
096200                                                                  09620004
096300     WRITE REPORT-RECORD                                          09630004
096400       FROM HL3-HEADING-LINE-3                                    09640004
096500         AFTER ADVANCING 1 LINES.                                 09650004
096600                                                                  09660004
096610     PERFORM 6100-PRINT-DPT-HEADING.                              09661045
096620                                                                  09662045
096700     WRITE REPORT-RECORD                                          09670004
096800       FROM HL4-HEADING-LINE-4                                    09680004
096900         AFTER ADVANCING 2 LINES.                                 09690004
097000                                                                  09700004
097100     WRITE REPORT-RECORD                                          09710004
097200       FROM HL5-HEADING-LINE-5                                    09720004
097300         AFTER ADVANCING 1 LINES.                                 09730004
097310                                                                  09731052
097311     MOVE  SPACES  TO  REPORT-RECORD.                             09731152
097320     WRITE REPORT-RECORD                                          09732052
097340         AFTER ADVANCING 1 LINES.                                 09734052
097400                                                                  09740004
097900                                                                  09790004
098000 6100-PRINT-DPT-HEADING.                                          09800004
098100*---------------------------------------------------------------* 09810004
098200*  PRINT DEPARTMENT NUMBER AND NAME                             * 09820004
098300*---------------------------------------------------------------* 09830004
098400                                                                  09840004
098500     IF  PV-LINE-COUNT > PC-LINE-LIMIT                            09850014
098600         PERFORM 6000-PRINT-RPT-HEADING                           09860014
098700     END-IF.                                                      09870004
098800                                                                  09880004
098810     MOVE  RC035-DEPT-NBR     TO  DL1-DEPT-NO.                    09881061
098811     MOVE  PV-HOLD-DEPT-NAME  TO  DL1-DEPT-NAME.                  09881119
098820                                                                  09882019
098900     WRITE REPORT-RECORD                                          09890004
099000       FROM DL1-DETAIL-LINE-1                                     09900004
099100         AFTER ADVANCING 2 LINES.                                 09910004
099200                                                                  09920004
099300     ADD 2                       TO PV-LINE-COUNT.                09930004
099400                                                                  09940004
099500                                                                  09950004
099600 6200-PRINT-PURCH-ORD-TOTALS.                                     09960004
099700*---------------------------------------------------------------* 09970004
099800*  PRINT PURCHASE ORDER TOTALS.                                 * 09980004
099900*---------------------------------------------------------------* 09990004
100000                                                                  10000004
100100     IF  PV-LINE-COUNT > PC-LINE-LIMIT                            10010014
100200         PERFORM 6000-PRINT-RPT-HEADING                           10020014
100210         MOVE PV-HOLD-VENDOR-NAME TO DL2-VENDOR-NAME              10021057
100300     END-IF.                                                      10030004
100400                                                                  10040004
100500     WRITE REPORT-RECORD                                          10050004
100600       FROM DL2-DETAIL-LINE-2                                     10060014
100700         AFTER ADVANCING 1 LINES.                                 10070004
100800     ADD 1                       TO PV-LINE-COUNT.                10080004
100900                                                                  10090004
101000     IF  PV-LINE-COUNT > PC-LINE-LIMIT                            10100014
101100         PERFORM 6000-PRINT-RPT-HEADING                           10110014
101110         MOVE SPACES  TO  PV-PREV-VENDOR-NAME                     10111058
101200     END-IF.                                                      10120004
101300                                                                  10130004
101400     WRITE REPORT-RECORD                                          10140004
101500       FROM DL3-DETAIL-LINE-3                                     10150014
101600         AFTER ADVANCING 1 LINES.                                 10160004
101700     ADD 1                       TO PV-LINE-COUNT.                10170004
101800                                                                  10180004
101810     IF  PV-LINE-COUNT > PC-LINE-LIMIT                            10181043
101820         PERFORM 6000-PRINT-RPT-HEADING                           10182043
101830         MOVE SPACES  TO  PV-PREV-VENDOR-NAME                     10183058
101840     ELSE                                                         10184044
101860         MOVE  SPACES  TO  REPORT-RECORD                          10186044
101870         WRITE REPORT-RECORD                                      10187044
101880             AFTER ADVANCING 1 LINES                              10188044
101890         ADD 1                   TO PV-LINE-COUNT.                10189044
101891                                                                  10189143
101892 6400-PRINT-TOTALS.                                               10189273
101893*---------------------------------------------------------------* 10189373
101894*  PRINT DEPARTMENT/BUYER/DIVISION/COMPANY TOTALS               * 10189473
101895*---------------------------------------------------------------* 10189573
101896                                                                  10189673
101897     IF  PV-LINE-COUNT > PC-LINE-LIMIT                            10189773
101898         PERFORM 6000-PRINT-RPT-HEADING                           10189873
101899     END-IF.                                                      10189973
101900                                                                  10190073
101901     WRITE REPORT-RECORD                                          10190173
101902       FROM TL1-TOTAL-LINE-1                                      10190273
101903         AFTER ADVANCING 1 LINES.                                 10190377
101904     ADD 1                       TO PV-LINE-COUNT.                10190477
101905                                                                  10190573
101906     IF  PV-LINE-COUNT > PC-LINE-LIMIT                            10190673
101907         PERFORM 6000-PRINT-RPT-HEADING                           10190773
101908     END-IF.                                                      10190873
101909                                                                  10190973
101910     WRITE REPORT-RECORD                                          10191073
101911       FROM TL2-TOTAL-LINE-2                                      10191173
101912         AFTER ADVANCING 1 LINES.                                 10191273
101913     ADD 1                       TO PV-LINE-COUNT.                10191373
101914                                                                  10191473
101915     IF  PV-LINE-COUNT > PC-LINE-LIMIT                            10191573
101916         PERFORM 6000-PRINT-RPT-HEADING                           10191673
101917     ELSE                                                         10191778
101924         MOVE  SPACES             TO REPORT-RECORD                10192478
101925         WRITE REPORT-RECORD                                      10192578
101926             AFTER ADVANCING 1 LINES                              10192678
101927         ADD 1                    TO PV-LINE-COUNT.               10192778
101928                                                                  10192873
101929     IF  PV-LINE-COUNT > PC-LINE-LIMIT                            10192973
101930         PERFORM 6000-PRINT-RPT-HEADING                           10193073
101931     END-IF.                                                      10193173
101932                                                                  10193273
101933                                                                  10193373
101940                                                                  10194004
102000 6450-PRINT-TOTALS.                                               10200073
102100*---------------------------------------------------------------* 10210004
102200*  PRINT VENDOR TOTALS                                          * 10220073
102300*---------------------------------------------------------------* 10230004
102410                                                                  10241005
102420     IF  PV-LINE-COUNT > PC-LINE-LIMIT                            10242014
102430         PERFORM 6000-PRINT-RPT-HEADING                           10243014
102440     END-IF.                                                      10244005
102450                                                                  10245005
102460     WRITE REPORT-RECORD                                          10246005
102470       FROM TL4-TOTAL-LINE-4                                      10247073
102480         AFTER ADVANCING 1 LINES.                                 10248077
102490     ADD 1                       TO PV-LINE-COUNT.                10249077
102491                                                                  10249105
102492     IF  PV-LINE-COUNT > PC-LINE-LIMIT                            10249214
102493         PERFORM 6000-PRINT-RPT-HEADING                           10249314
102495     END-IF.                                                      10249505
102496                                                                  10249605
102497     WRITE REPORT-RECORD                                          10249705
102498       FROM TL5-TOTAL-LINE-5                                      10249873
102499         AFTER ADVANCING 1 LINES.                                 10249905
102500     ADD 1                       TO PV-LINE-COUNT.                10250005
102501                                                                  10250105
102502     IF  PV-LINE-COUNT > PC-LINE-LIMIT                            10250214
102503         PERFORM 6000-PRINT-RPT-HEADING                           10250314
102505     ELSE                                                         10250578
102512         MOVE  SPACES            TO REPORT-RECORD                 10251278
102513         WRITE REPORT-RECORD                                      10251378
102515             AFTER ADVANCING 1 LINES                              10251578
102516         ADD 1                   TO PV-LINE-COUNT.                10251678
102517                                                                  10251727
102518     IF  PV-LINE-COUNT > PC-LINE-LIMIT                            10251827
102519         PERFORM 6000-PRINT-RPT-HEADING                           10251927
102521     END-IF.                                                      10252127
102522                                                                  10252227
102530                                                                  10253005
103820 6600-PRINT-END-OF-REPORT.                                        10382005
103830*---------------------------------------------------------------* 10383005
103840*  PRINT END OF REPORT BANNER                                   * 10384005
103850*---------------------------------------------------------------* 10385005
103860                                                                  10386005
103870     IF  PV-LINE-COUNT > PC-LINE-LIMIT                            10387014
103880         PERFORM 6000-PRINT-RPT-HEADING                           10388014
103890     END-IF.                                                      10389005
103900                                                                  10390005
104000     WRITE REPORT-RECORD                                          10400005
104100       FROM PR-PRINT-FINAL                                        10410005
104200         AFTER ADVANCING 2 LINES.                                 10420005
104300     ADD 2                       TO PV-LINE-COUNT.                10430005
104400                                                                  10440005
105000                                                                  10500004
105001 6800-NO-REPORT-DETAIL.                                           10500136
105010*---------------------------------------------------------------* 10501035
105020*  PRINT "NO DETAIL REPORT' BANNER                              * 10502035
105030*---------------------------------------------------------------* 10503035
105040                                                                  10504035
105050     IF  PV-LINE-COUNT > PC-LINE-LIMIT                            10505035
105060         PERFORM 6000-PRINT-RPT-HEADING                           10506035
105070     END-IF.                                                      10507035
105080                                                                  10508035
105090     WRITE REPORT-RECORD                                          10509035
105091       FROM PR-PRINT-NO-DETAIL                                    10509136
105092         AFTER ADVANCING 2 LINES.                                 10509235
105093     ADD 2                       TO PV-LINE-COUNT.                10509335
105094                                                                  10509435
105095                                                                  10509535
107800 7000-READ-INPUT-FILE.                                            10780002
107810*---------------------------------------------------------------* 10781005
107820*  READ INPUT FILE                                              * 10782005
107830*---------------------------------------------------------------* 10783005
107840                                                                  10784005
107900      READ INPUT-FILE INTO RC035-RCVR-EXTRACT-RECORD              10790061
108000          AT END                                                  10800002
108100             SET PS-INPUT-EOF TO TRUE.                            10810004
111400                                                                  11140002
111500                                                                  11150005
111600 9000-END-PROCESS.                                                11160002
111610*---------------------------------------------------------------* 11161005
111800*  CLOSE FILES.                                                   11180002
111810*---------------------------------------------------------------* 11181005
112000                                                                  11200002
112100     DISPLAY '*------------------------------*'.                  11210054
112110     DISPLAY '*     PROGRAM - RCKRP019       *'.                  11211054
112120     DISPLAY '*------------------------------*'.                  11212054
112130     DISPLAY '* PV-RECORD-COUNT  - ' PV-RECORD-COUNT.             11213053
112140     DISPLAY '* PV-SUMMARY-COUNT - ' PV-SUMMARY-COUNT.            11214053
112150     DISPLAY '*------------------------------*'.                  11215054
112200                                                                  11220053
117000     CLOSE INPUT-FILE                                             11700002
117100           DATE-FILE                                              11710088
117110           REPORT-FILE                                            11711088
117200           SUMMARY-FILE.                                          11720052
117245                                                                  11724505
117248*                                                                 11724805
117249 9900-DB2-ABEND.                                                  11724905
117250*---------------------------------------------------------------* 11725005
117251*  DB2-ABEND-PROCESSING                                           11725105
117252*---------------------------------------------------------------* 11725205
117253                                                                  11725305
117254     DISPLAY '*** DB2 ERROR '.                                    11725405
117255     DISPLAY '*** SQLCODE   = ' PV-SQLCODE.                       11725505
117256     DISPLAY '*** PROGRAM   = ' PV-ABEND-PROGRAM.                 11725605
117257     DISPLAY '*** PARAGRAPH = ' PV-ABEND-PARAGRAPH.               11725705
117258     DISPLAY '*** OPERATION = ' PV-ABEND-OPERATION.               11725805
117259     DISPLAY '*** MESSAGE   = ' PV-DB2-OPERATION-MSG-1.           11725905
117260     DISPLAY '***           = ' PV-DB2-OPERATION-MSG-2.           11726005
117261     DISPLAY '***           = ' PV-DB2-OPERATION-MSG-3.           11726105
117262     DISPLAY '*** TABLE 1   = ' PV-ABEND-STRUCTURE-1.             11726205
117263                                                                  11726305
117272     COPY DPPD004.                                                11727292
117273                                                                  11727305
117274     MOVE +4013                  TO PV-ABEND-CODE.                11727405
117275     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         11727505
117276                                                                  11727605
118000****************************************************************  11800002
