000100******************************************************************00010000
000200*  DPPD024 COMBINES SEPARATE FIRST AND LAST NAME FIELDS INTO ONE *00020001
000300*  FIRST/LAST NAME FIELD, AND TRUNCATING AS NECESSARY TO FIT THE *00030001
000310*  LENGTH REQUIREMENTS OF THE PERFORMING PROGRAM.                *00031001
000320*                                                                *00032001
000330*  COPYBOOK DPWS024 IS THE PARAMETER LIST FOR USING THIS ROUTINE.*00033001
000400*                                                                *00040000
000500*  THE LENGTH OF THE FIRST/LAST NAME FIELD MUST BE MOVED TO      *00050001
000600*  DP024-FLNAME-LENGTH BEFORE MOVING THE FIRST AND LAST NAMES    *00060001
000610*  INTO THE NAME FIELDS.  IF THE PERFORMING PROGRAM HAS MULTIPLE *00061001
000700*  PERFORMS WITH DIFFERING LENGTH FIRST/LAST NAME FIELDS, THE    *00070001
000800*  LENGTH MUST BE SET PRIOR TO MOVING EACH SET OF NAME FIELDS,   *00080001
000810*  NOT JUST IN THE INITIALIZATION OF THE PROGRAM.  USING THE     *00081001
000820*  "LENGTH OF" RESERVED WORD WILL PREVENT THE NEED TO DEFINE     *00082001
000821*  ADDITIONAL CONSTANTS FOR THE LENGTH, AND WILL ALLOW THE       *00082101
000830*  PERFORMING PROGRAM TO ALWAYS STAY IN SYNC WITH ANY LENGTH     *00083001
000840*  CHANGES TO THE DESTINATION FIRST/LAST NAME FIELDS.            *00084001
000900*                                                                *00090000
001000*  PERFORM EXAMPLE:                                              *00100001
001001*                                                                *00100101
001010*      MOVE LENGTH OF PV-FORMATTED-NAME TO DP024-FLNAME-LENGTH.  *00101001
001100*      MOVE PV-FIRST-NAME TO DP024-FNAME.                        *00110001
001200*      MOVE PV-LAST-NAME TO DP024-LNAME.                         *00120001
001300*      PERFORM DP024-0000-FORMAT-NAME.                           *00130001
001310*      MOVE DP024-FLNAME TO PV-FORMATTED-NAME                    *00131001
001400*                                                                *00140000
001500*   IF PV-FIRST-NAME = "JOHN" AND PV-LAST-NAME = "MC GREGOR III",*00150001
001700*        DP024-FLNAME WILL BE "JOHN MC GREGOR III"               *00170001
002000*                                                                *00200000
002100*  TRUNCATION NOTE:                                              *00210001
002110*       THE LENGTH OF THE LAST NAME TAKES PRECEDENCE IF          *00211001
002200*       TRUNCATION OF THE FIRST/LAST NAME IS REQUIRED.           *00220001
002300*                                                                *00230001
002400*  IF DP024-FLNAME-LENGTH = 15 IN THE ABOVE EXAMPLE,             *00240001
002500*        DP024-FLNAME WILL BE "J MC GREGOR III"                  *00250001
003200******************************************************************00320000
003300                                                                  00330000
003400 DP024-0000-FORMAT-NAME.                                          00340000
003500                                                                  00350000
003600     MOVE SPACE                  TO DP024-FLNAME.                 00360000
003700                                                                  00370000
003800* DETERMINE LENGTH OF LAST NAME                                   00380000
003900     PERFORM VARYING DP024-WORK-INDEX FROM DP024-FLNAME-LENGTH    00390000
004000                                 BY -1                            00400000
004100         UNTIL DP024-LNAME-ENTRY(DP024-WORK-INDEX)                00410000
004200                                 NOT = SPACE                      00420000
004300     END-PERFORM.                                                 00430000
004400                                                                  00440000
004500     MOVE DP024-WORK-INDEX       TO DP024-LNAME-LENGTH.           00450000
004600                                                                  00460000
004601* COMPUTE THE MAXIMUM LENGTH OF THE FIRST NAME. (SUBTRACT 1 FOR A 00460101
004602* SPACE BETWEEN FIRST AND LAST NAME).                             00460201
004680                                                                  00468001
005010     COMPUTE DP024-FNAME-LENGTH  = (DP024-FLNAME-LENGTH -         00501001
005020                                 DP024-LNAME-LENGTH)    - 1.      00502001
005100                                                                  00510000
005200* FORMAT THE FIRST NAME                                           00520000
005300     PERFORM VARYING DP024-WORK-INDEX FROM 1 BY 1                 00530000
005400         UNTIL (DP024-WORK-INDEX > DP024-FNAME-LENGTH) OR         00540000
005500             (DP024-FNAME-ENTRY(DP024-WORK-INDEX) = SPACE  AND    00550000
005600             DP024-FNAME-ENTRY(DP024-WORK-INDEX + 1) = SPACE)     00560000
005700                 MOVE DP024-FNAME-ENTRY(DP024-WORK-INDEX)         00570000
005800                     TO DP024-FLNAME-ENTRY(DP024-WORK-INDEX)      00580000
005900     END-PERFORM.                                                 00590000
005901                                                                  00590101
005902     COMPUTE DP024-FLNAME-INDEX = (DP024-WORK-INDEX + 1).         00590201
005903                                                                  00590301
005904* SAVE THE LENGTH OF THE FIRST NAME AS USED BY THE ROUTINE        00590401
005905     COMPUTE DP024-FNAME-LENGTH = (DP024-WORK-INDEX - 1).         00590501
005906* ELIMINATE THE SPACE BETWEEN THE NAMES IF THE LENGTH OF THE      00590602
005907* LAST NAME WILL PREVENT ANY PART OF THE FIRST NAME TO BE USED    00590702
005908     IF DP024-FNAME-LENGTH = 0                                    00590802
005909         MOVE 1 TO DP024-FLNAME-INDEX                             00590902
005910     END-IF.                                                      00591002
006000                                                                  00600000
006100* FORMAT THE LAST NAME                                            00610000
006400     PERFORM VARYING DP024-WORK-INDEX FROM 1 BY 1                 00640000
006500         UNTIL DP024-WORK-INDEX > DP024-LNAME-LENGTH              00650000
006600             MOVE DP024-LNAME-ENTRY(DP024-WORK-INDEX)             00660000
006700                 TO DP024-FLNAME-ENTRY(DP024-FLNAME-INDEX)        00670000
006800             ADD +1              TO DP024-FLNAME-INDEX            00680000
006900     END-PERFORM.                                                 00690000
006910                                                                  00691001
007000     COMPUTE DP024-RESULT-FLNAME-LENGTH =                         00700001
007100               (DP024-FNAME-LENGTH + DP024-LNAME-LENGTH + 1).     00710001
