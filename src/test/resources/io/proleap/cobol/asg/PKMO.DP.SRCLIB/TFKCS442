      *-----------------------*                                         00010002
       IDENTIFICATION DIVISION.                                         00020002
      *-----------------------*                                         00030002
       PROGRAM-ID.    TFKCS442.                                         00040002
       AUTHOR.        JACK KRAMER.                                      00050002
       INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060002
       DATE-WRITTEN.  JANUARY 1997.                                     00070002
       DATE-COMPILED.                                                   00080002
                                                                        00090002
      *---------------------------------------------------------------* 00100002
      *    P442 - TRANSFER WORKSHEET REPORT.                          * 00110002
      *                                                               * 00120002
      *    THIS PROGRAM PRODUCES A WORKSHEET LIST.                    * 00130002
      *---------------------------------------------------------------* 00150002
      *  1/20/2003 - RAY GRAF                                                   
      *   PROCESS NONINTELLIGENT SKU.                                           
      ******************************************************************        
080204**DATE:08/02/2004 CHANGED BY: RAY GRAF                                    
080204**     CHANGE PRINTER DESTINATION TO NEW 8 CHARACTER FORMAT               
      *****************************************************************         
100404**DATE:10/04/2004 CHANGED BY: RAY GRAF                                    
100404**     EXPAND STORE NUMBER.  MAKE DOMAIN COMPLIANT.                       
      *****************************************************************         
SR3403**DATE:03/02/2012 CHANGED BY: JALAJ KUMAR                                 
SR3403**     PRICE FIELD EXPANSIONS FOR LARGE RETAIL PROJECT                    
      *****************************************************************         
CICS  * CHANGED 11/17/2022    BY JIM HUNTER      WR: CHG0278345                 
CICS  * THIS PROGRAM DOES NOT CALL THE CICS ARCHITECTURE - REMOVE               
CICS  * COPYBOOK DPWS030.                                                       
CICS  *-----------------------------------------------------------------        
       EJECT                                                            00160002
       ENVIRONMENT DIVISION.                                            00170002
                                                                        00180002
       DATA DIVISION.                                                   00190002
                                                                        00200002
       WORKING-STORAGE SECTION.                                         00210002
                                                                        00220002
       01  DK-DB2-KEYS.                                                 00230002
           05  DK-XFER-DKEY-ID          PIC S9(09)  COMP  VALUE +0.     00270002
                                                                        00280002
       01  PC-PROGRAM-CONSTANTS.                                        00290002
           05 PC-099                    PIC  9(03)  VALUE 099.                  
           05 PC-100                    PIC  9(03)  VALUE 100.                  
           05 PC-INIT                   PIC  X(04)  VALUE 'INIT'.       00300002
           05 PC-PUT                    PIC  X(04)  VALUE 'PUT'.        00310002
           05 PC-TERM                   PIC  X(04)  VALUE 'TERM'.       00320002
           05  PC-TOP-OF-PAGE              PIC  X(01)  VALUE '1'.       03900013
           05  PC-SINGLE-SPACE             PIC  X(01)  VALUE ' '.       03910013
           05  PC-DOUBLE-SPACE             PIC  X(01)  VALUE '0'.       03920013
           05  PC-TRIPLE-SPACE             PIC  X(01)  VALUE '-'.       03930013
           05  PC-PAGE-MAX                 PIC S9(02)  VALUE +60        03940072
                                                          COMP-3.       03950072
           05  PC-LINE-MAX                    PIC S9(02)  VALUE +60     00360002
                                                          COMP-3.       00370002
           05  PC-MAX-BLOCKS-IN-ARRAY         PIC S9(04)  VALUE +2      00940099
                                                          COMP SYNC.    00950099
           05  PC-ITEMS-PER-RTL-PANEL         PIC S9(04)  VALUE +20     00900099
                                                          COMP SYNC.    00910099
           05  PC-ITEMS-PER-NRTL-PANEL        PIC S9(04)  VALUE +10     00920099
                                                          COMP SYNC.    00930099
           05  PC-CURRENT-PROGRAM-NAME        PIC  X(08)  VALUE         00380002
                                                          'TFKCS442'.   00390002
           05  PC-CUSTOMER                    PIC  X(02)  VALUE '05'.   00830099
           05  PC-NON-RETAIL                  PIC  X(02)  VALUE '06'.   00840099
           05  PC-TRAILER                     PIC X(02)    VALUE '04'.  00400002
           05  PC-CALLBACK                    PIC  X(02)  VALUE '02'.   00800099
           05  PC-STOCK-BAL-CORP              PIC  X(02)  VALUE '03'.   00810099
           05  PC-LG-TOTE-LITERAL             PIC  X(15)  VALUE         01126199
                   'LG TOTE SEAL.:'.                                    01126299
           05  PC-SM-TOTE-LITERAL             PIC  X(16)  VALUE         01126399
                   'SM TOTE SEAL..:'.                                   01126499
           05  PC-CALLBACK-LITERAL            PIC  X(16)  VALUE         01121099
                   'CALLBACK NO...:'.                                   01122099
           05  PC-APPROVAL-LITERAL            PIC  X(16)  VALUE         01123099
                   'APPROVAL NO...:'.                                   01124099
           05  PC-REQUESTOR-LITERAL           PIC  X(16)  VALUE         01124199
                   'REQUESTED BY..:'.                                   01124299
           05  PC-TRLR-NBR-LITERAL            PIC X(15)  VALUE          00410002
               'TRAILER NBR   :'.                                               
           05  PC-TRLR-SEAL-LITERAL           PIC X(15)  VALUE          00410002
               'TRAILER SEAL  :'.                                               
      *----------  ERROR MESSAGES  ------------------------------------         
           05  PC-CONTENTION-MSG               PIC  X(36)  VALUE        04210013
               'SYSTEM IS BUSY.  PLEASE TRY AGAIN.'.                    04220013
      *----------------------------------------------------------------         
      *                                                                 00430002
       01  PS-PROGRAM-SWITCHES.                                         00440002
           05  PS-ERROR-SW                    PIC  X(01)  VALUE 'Y'.    00480002
               88  PS-NO-ERROR                            VALUE 'Y'.    00490002
               88  PS-ERROR                               VALUE 'N'.    00500002
           05  PS-ITEMS-LEFT-INDICATOR               PIC  X(01).        02610002
               88  PS-ITEMS-LEFT-ON-DB                    VALUE 'Y'.    02620002
               88  PS-NO-ITEMS-LEFT-ON-DB                 VALUE 'N'.    02630002
           05  PS-DRS-INITIALIZED-SW           PIC  X      VALUE 'N'.   06080013
               88  PS-DRS-INITIALIZED                      VALUE 'Y'.   06090013
               88  PS-DRS-NOT-INITIALIZED                  VALUE 'N'.   06100013
           05  PS-CONTENTION-SW                PIC  X(01)  VALUE 'N'.   06170013
               88  PS-CONTENTION                           VALUE 'Y'.   06180013
      *                                                                 00570002
       01  PV-PROGRAM-VARIABLES.                                        00580002
           05  PV-ABSTIME                      PIC S9(16)  VALUE +0.    00590002
           05  PV-LINE-COUNT                  PIC  S9(03)  VALUE +0.    00600002
           05  PV-PAGE-COUNT                  PIC  S9(03)  VALUE +0.    00610002
           05  PV-LINE-NBR                    PIC S9(04)  COMP.         01371599
           05  PV-LG-TOTE-FIELD.                                        01431099
               10  PV-LG-TOTE-SEAL1            PIC X(08).               01431199
               10                              PIC X(01)  VALUE SPACE.  01431299
               10  PV-LG-TOTE-SEAL2            PIC X(08).               01431399
           05  PV-NAME.                                                 01431599
               10  PV-INT                      PIC X(01).               01432099
               10                              PIC X(01)  VALUE SPACE.  01433099
               10  PV-LAST-NAME                PIC X(20).               01434099
           05  PV-ERROR-KEY                    PIC  X(25)  VALUE SPACE. 05280072
           05  PV-SUB                         PIC S9(04)  VALUE +0      00867002
                                                          COMP SYNC.    00868002
           05  PV-REMAINDER                   PIC S9(04)  VALUE +0      00880002
                                                          COMP SYNC.    00890002
           05  PV-CICS-RESPONSE               PIC S9(04)  VALUE +0      00920002
                                                          COMP SYNC.    00930002
           05  PV-BLOCK                       PIC S9(04)  VALUE +0      00940002
                                                          COMP SYNC.    00950002
           05  PV-ITEM                        PIC S9(04)  VALUE +0      00940002
                                                          COMP SYNC.    00950002
           05  PV-BLK-SUB                                PIC S9(04)     06640099
                                                              COMP      06650099
                                                              SYNC.     06660099
           05  PV-ITEM-SUB                               PIC S9(04)     06670099
                                                              COMP      06680099
                                                              SYNC.     06690099
           05  PV-ERROR-MSG                    PIC  X(50) VALUE SPACE.  05270013
           05  PV-DISPLAY-KEYS.                                         05710013
100404*        10  PV-DISPLAY-FROM-STORE-NBR   PIC  X(03)  VALUE SPACE. 05750013
100404         10  PV-DISPLAY-FROM-STORE-NBR   PIC  X(04)  VALUE SPACE. 05750013
               10  FILLER                      PIC  X(02)  VALUE SPACE. 05760013
               10  PV-DISPLAY-XFER-DKEY-ID     PIC  X(06)  VALUE SPACE. 05770013
               10  FILLER                      PIC  X(02)  VALUE SPACE. 05780013
080204         10  PV-DISPLAY-PRINTER-DEST     PIC  X(08)  VALUE SPACE. 05790013
           05  PV-HOLD-UPC-NBR.                                                 
               10  FILLER                      PIC X(03).                       
               10  PV-KOHLS-UPC-DIGIT          PIC X(01).                       
               10  FILLER                      PIC X(02).                       
               10  PV-KOHLS-DEPT               PIC 9(03).                       
               10  PV-KOHLS-CL.                                                 
                   15  PV-KOHLS-CL-1           PIC X(01).                       
                   15  PV-KOHLS-CL-2           PIC X(01).                       
               10  PV-KOHLS-CL-9 REDEFINES PV-KOHLS-CL                          
                                               PIC 9(02).                       
               10  PV-KOHLS-DUMMY-SKU          PIC X(03).                       
               10  PV-KOHLS-CHECKDIGIT         PIC X(01).                       
           05  PV-HOLD-UPC-NBR-9 REDEFINES PV-HOLD-UPC-NBR                      
                                               PIC 9(15).                       
      *                                                                 01020002
       01  PH-PROGRAM-HOLD-AREA.                                        05710099
           05  PH-CONTROL-NBR                              PIC  9(09).  05720099
           05  PH-XFER-DKEY-ID                             PIC  S9(09)  05730099
                                                                COMP.   05740099
           05  PH-XFER-TYPE                                PIC  X(02).  05750099
               88  PH-NON-RETAIL-XFER                      VALUE '06'.  05750199
               88  PH-RETAIL-XFER                          VALUE        05750299
                                                 '01' THRU '05', '07'.  05751099
           05  PH-XFER-DESC                                PIC  X(21).  05760099
           05  PH-CONTNR-TYPE                              PIC  X(02).  05770099
           05  PH-CONTNR-DESC                              PIC  X(18).  05780099
100404*    05  PH-FR-STORE-NBR                             PIC  X(03).  05790099
100404     05  PH-FR-STORE-NBR                             PIC  X(04).  05790099
100404*    05  PH-FR-STORE-NBR-N REDEFINES PH-FR-STORE-NBR PIC  9(03).  05800099
100404     05  PH-FR-STORE-NBR-N REDEFINES PH-FR-STORE-NBR PIC  9(04).  05800099
100404*    05  PH-TO-STORE-NBR                             PIC  X(03).  05790099
100404     05  PH-TO-STORE-NBR                             PIC  X(04).  05790099
100404*    05  PH-TO-STORE-NBR-N REDEFINES PH-TO-STORE-NBR PIC  9(03).  05800099
100404     05  PH-TO-STORE-NBR-N REDEFINES PH-TO-STORE-NBR PIC  9(04).  05800099
           05  PH-TO-STORE-NAM                             PIC  X(10).  05820099
           05  PH-TO-STORE-TYPE                            PIC  X(02).  05820099
           05  PH-COMP-BY-INT                              PIC  X(01).  05830099
           05  PH-COMP-BY-NAM                              PIC  X(20).  05840099
           05  PH-REQ-BY-INT                               PIC  X(01).  05850099
           05  PH-REQ-BY-NAM                               PIC  X(20).  05860099
           05  PH-ATTN-TO-INT                              PIC  X(01).  05870099
           05  PH-ATTN-TO-NAM                              PIC  X(20).  05880099
           05  PH-CALLBACK-NBR                             PIC  X(04).  05890099
           05  PH-CALLBACK-NBR-N REDEFINES PH-CALLBACK-NBR              05900099
                                                           PIC  9(04).  05910099
           05  PH-APPROVAL-NBR                             PIC  X(09).  05920099
           05  PH-APPROVAL-NBR-N REDEFINES PH-APPROVAL-NBR              05930099
                                                           PIC  9(09).  05940099
           05  PH-CUST-NAME                                PIC  X(20).  05950099
           05  PH-PHONE                                    PIC  X(10).  05960099
           05  FILLER REDEFINES PH-PHONE.                               05970099
               10  PH-PHONE-AREA.                                       05980099
                   15  PH-PHONE-AREA-N                     PIC  9(03).  05990099
               10  PH-PHONE-EXCH.                                       06000099
                   15  PH-PHONE-EXCH-N                     PIC  9(03).  06010099
               10  PH-PHONE-NBR.                                        06020099
                   15  PH-PHONE-NBR-N                      PIC  9(04).  06030099
           05  PH-ADDR1                                    PIC  X(20).  06040099
           05  PH-ADDR2                                    PIC  X(20).  06050099
           05  PH-CITY                                     PIC  X(20).  06060099
           05  PH-STATE                                    PIC  X(02).  06070099
           05  PH-ZIP                                      PIC X(05).   06080099
           05  PH-ZIP-N REDEFINES PH-ZIP                   PIC  9(05).  06090099
           05  PH-ZIP-EXT                                  PIC  X(04).  06100099
           05  PH-ZIP-EXT-N REDEFINES PH-ZIP-EXT PIC            9(04).  06110099
           05  PH-LG-TOTE-SEAL1                            PIC  X(07).  06120099
           05  PH-LG-TOTE-SEAL2                            PIC  X(07).  06130099
           05  PH-SM-TOTE-SEAL                             PIC  X(07).  06140099
           05  PH-TRAILER-SEAL                             PIC  X(07).  06150099
           05  PH-TRAILER-NBR                              PIC  X(08).  06160099
           05  PH-BLOCK-ENTRIES OCCURS 2 TIMES.                         06170099
               10  PH-BLOCK-MODIFIED-SW                    PIC  X(01).  06180099
                   88  PH-BLOCK-NOT-MODIFIED               VALUE 'N'.   06190099
                   88  PH-BLOCK-MODIFIED                   VALUE 'Y'.   06200099
               10  PH-RETAIL-ITEM-ARRAY.                                06210099
                   15  PH-RETAIL-ENTRIES OCCURS 20 TIMES.               06220099
                       20  PH-ENT-DPT-CL-SUBCL.                         06230099
                           25  PH-ENT-DEPT               PIC  9(03).    06240099
                           25  PH-ENT-CLASS              PIC  9(03).    06250099
                           25  PH-ENT-SUBCLASS           PIC  9(03).    06260099
                       20  PH-STR-DPT-CL-SUBCL.                         06230099
                           25  PH-STR-DEPT               PIC  9(03).    06240099
                           25  PH-STR-CLASS              PIC  9(03).    06250099
                           25  PH-STR-SUBCLASS           PIC  9(03).    06260099
                       20  PH-UPC                        PIC  X(13).    06280099
                       20  PH-UPC-N REDEFINES PH-UPC                    06290099
                                                         PIC  9(13).    06300099
                       20  PH-KOHLS-UPC                  PIC S9(15)     06301099
                                                         COMP-3.        06302099
                       20  PH-ITEM-NBR                   PIC S9(15)     06301099
                                                         COMP-3.        06302099
                       20  PH-PRICE                      PIC X(07).     06310099
                       20  PH-PRICE-N REDEFINES PH-PRICE                06320099
                                                         PIC  9(05)V99. 06330099
                       20  PH-FILE-PRICE                 PIC S9(05)V99  06340099
                                                         COMP-3.        06302099
                       20  PH-RTL-QTY                    PIC X(03).     06350099
                       20  PH-RTL-QTY-N REDEFINES PH-RTL-QTY            06360099
                                                         PIC  9(03).    06370099
                       20  PH-RENUMBER-SW                PIC X(01).     06380099
                           88  PH-RENUMBERED                VALUE 'Y'.  06390099
                           88  PH-NOT-RENUMBERED VALUE 'N'.             06400099
                       20  PH-CALLBACK-PRICE-SW PIC X(01).              06401099
                           88  PH-VALID-CALLBACK-PRICE                  06402099
                                                            VALUE 'Y'.  06403099
                           88  PH-INVALID-CALLBACK-PRICE                06404099
                                                            VALUE 'N'.  06405099
                       20  PH-RTL-ITEM-UPDATED-SW PIC X(01).            06410099
                           88  PH-RTL-ITEM-UPDATED                      06420099
                                                            VALUE 'Y'.  06430099
                           88  PH-RTL-ITEM-NOT-UPDATED                  06440099
                                                            VALUE ' '.  06450099
               10  PH-NON-RETAIL-ITEM-ARRAY                             06460099
                           REDEFINES PH-RETAIL-ITEM-ARRAY.              06470099
                   15  PH-NON-RETAIL-ENTRIES OCCURS 10 TIMES.           06480099
                       20  PH-ITEM-DESC.                                06490099
                           25  PH-ITEM-DESC1             PIC X(20).     06500099
                           25  PH-ITEM-DESC2             PIC X(20).     06510099
                       20  PH-NRTL-DEPT                  PIC  X(03).    06520099
                       20  PH-FIXTURE                    PIC  X(20).    06530099
                       20  PH-NRTL-QTY                   PIC X(03).     06540099
                       20  PH-NRTL-QTY-N REDEFINES PH-NRTL-QTY          6550099 
                                                         PIC 9(03).     06560099
                       20  PH-NRTL-ITEM-UPDATED-SW PIC X(01).           06561099
                           88  PH-NRTL-ITEM-UPDATED                     06562099
                                                            VALUE 'Y'.  06563099
                           88  PH-NRTL-ITEM-NOT-UPDATED                 06564099
                                                            VALUE ' '.  06565099
                                                                        06570099
           EJECT                                                        06740099
           COPY DPWS132O.                                               01030002
       01  HL2-HEADING-LINE-2.                                          01670499
           05  FILLER                          PIC  X(57)  VALUE SPACE. 01670599
           05  FILLER                          PIC  X(30)  VALUE        01670699
               'TRANSFER WORKSHEET'.                                    01670799
      *                                                                 01670899
       01  HL3-HEADING-LINE-3.                                          01670999
           05  FILLER                          PIC  X(02)  VALUE SPACE. 01671099
           05  FILLER                          PIC  X(15)  VALUE        01671199
                'WORKSHEET NO.:'.                                       01671299
           05  HL3-CONTROL-NBR                 PIC  9(09).              01671399
           05  FILLER                          PIC  X(24)  VALUE SPACE. 01671599
           05  FILLER                          PIC  X(16)  VALUE        01671699
                'TO STORE......:'.                                      01671799
100404*    05  HL3-TO-STORE-NBR                PIC  9(03).              01671999
100404     05  HL3-TO-STORE-NBR                PIC  9(04).              01671999
           05  FILLER                          PIC  X(01)  VALUE SPACE. 01672099
           05  HL3-TO-STORE-NAM                PIC  X(10).              01672199
       01  HL4-HEADING-LINE-4.                                          01672299
           05  FILLER                          PIC  X(02)  VALUE SPACE. 01672399
           05  FILLER                          PIC  X(15)  VALUE        01672499
                'TRANSFER TYPE:'.                                       01672599
           05  HL4-XFER-TYPE                   PIC  X(02).              01672699
           05  FILLER                          PIC  X(01)  VALUE SPACE. 01672899
           05  HL4-XFER-DESC                   PIC  X(20).              01672999
           05  FILLER                          PIC  X(10)  VALUE SPACE. 01673099
           05  FILLER                          PIC  X(16)  VALUE        01673199
                'CONTAINER TYPE:'.                                      01673299
           05  HL4-CONTNR-TYPE                 PIC  X(02).              01673399
           05  FILLER                          PIC  X(01)  VALUE SPACE. 01673499
           05  HL4-CONTNR-DESC                 PIC  X(20).              01673599
       01  HL5-HEADING-LINE-5.                                          01673699
           05  FILLER                          PIC  X(02)  VALUE SPACE. 01673799
           05  FILLER                          PIC  X(15)  VALUE        01673899
                'COMPLETED BY.:'.                                       01673999
           05  HL5-COMP-BY-INT                 PIC  X(01).              01674099
           05  FILLER                          PIC  X(01)  VALUE SPACE. 01674199
           05  HL5-COMP-BY-NAM                 PIC  X(20).              01674299
           05  FILLER                          PIC  X(11)  VALUE SPACE. 01674399
           05  HL5-LITERAL                     PIC  X(16)  VALUE SPACE. 01674499
           05  HL5-FIELD                       PIC  X(22).              01674599
       01  HL6A-HEADING-LINE-6A.                                        01674699
           05  FILLER                          PIC  X(02)  VALUE SPACE. 01674799
           05  FILLER                          PIC  X(15)  VALUE        01674899
                'ATTENTION TO.:'.                                       01674999
           05  HL6A-ATTN-TO-INT                PIC  X(01).              01675099
           05  FILLER                          PIC  X(01)  VALUE SPACE. 01675199
           05  HL6A-ATTN-TO-NAM                PIC  X(20).              01675299
       01  HL6B-HEADING-LINE-6B.                                        01675399
           05  FILLER                          PIC  X(02)  VALUE SPACE. 01675499
           05  FILLER                          PIC  X(15)  VALUE        01675599
                'CUSTOMER NAME:'.                                       01675699
           05  HL6B-CUST-NAME                  PIC  X(20).              01675999
           05  FILLER                          PIC  X(13)  VALUE SPACE. 01676099
           05  FILLER                          PIC  X(16)  VALUE        01676199
                'CUSTOMER PHONE:'.                                      01676299
           05  FILLER                          PIC  X(01)  VALUE '('.   01676399
           05  HL6B-PHONE-AREA                 PIC  X(03).              01676499
           05  FILLER                          PIC  X(02)  VALUE ')-'.  01676599
           05  HL6B-PHONE-EXCH                 PIC  X(03).              01676699
           05  FILLER                          PIC  X(01)  VALUE '-'.   01676799
           05  HL6B-PHONE-NBR                  PIC  X(04).              01676899
       01  HL7-HEADING-LINE-7.                                          01676999
           05  FILLER                          PIC  X(05)  VALUE SPACE. 01677099
           05  FILLER                          PIC  X(12)  VALUE        01677199
                'ADDRESS...:'.                                          01677299
           05  HL7-ADDRESS                     PIC  X(20).              01677399
           05  FILLER                          PIC  X(16)  VALUE SPACE. 01677499
           05  FILLER                          PIC  X(13)  VALUE        01677599
                'CITY.......:'.                                         01677699
           05  HL7-CITY                        PIC  X(20).              01677899
       01  HL8-HEADING-LINE-8.                                          01677999
           05  FILLER                          PIC  X(05)  VALUE SPACE. 01678099
           05  FILLER                          PIC  X(12)  VALUE        01678199
                '          :'.                                          01678299
           05  HL8-ADDRESS                     PIC  X(20).              01678399
           05  FILLER                          PIC  X(16)  VALUE SPACE. 01678499
           05  FILLER                          PIC  X(13)  VALUE        01678599
                'STATE/ZIP..:'.                                         01678699
           05  HL8-STATE                       PIC  X(02).              01678799
           05  FILLER                          PIC  X(01)  VALUE SPACE. 01678899
           05  HL8-ZIP                         PIC  X(05).              01678999
           05  HL8-DASH                        PIC  X(01)  VALUE SPACE. 01679099
           05  HL8-ZIP-EXT                     PIC  X(04).              01679199
       01  HL9-HEADING-LINE-9.                                          01679299
           05  FILLER                          PIC  X(02)  VALUE SPACE. 01679399
           05  HL9-LITERAL-1                   PIC  X(15)  VALUE SPACE. 01679499
           05  HL9-FIELD-1                     PIC  X(20).              01679699
           05  FILLER                          PIC  X(13)  VALUE SPACE. 01679799
           05  HL9-LITERAL-2                   PIC  X(16)  VALUE SPACE. 01679899
           05  HL9-FIELD-2                     PIC  X(08).              01680099
       01  HL10A-HEADING-LINE-10A.                                      01680599
           05  FILLER                          PIC  X(33)  VALUE        01680699
             '  LN D/M/S       UPC'.                                    01680799
           05  FILLER                          PIC  X(18)  VALUE        01680899
             'TICKET   QTY'.                                            01680999
           05  FILLER                          PIC  X(33)  VALUE        01681099
             '  LN D/M/S       UPC'.                                    01681199
           05  FILLER                          PIC  X(18)  VALUE        01681299
             ' TICKET   QTY'.                                           01681399
       01  HL10B-HEADING-LINE-10B.                                      01681499
           05  FILLER                          PIC  X(49)  VALUE        01681599
             '  LN   ITEM DESCRIPTION'.                                 01681699
           05  FILLER                          PIC  X(22)  VALUE        01681799
             'FIXTURE'.                                                 01681899
           05  FILLER                          PIC  X(10)  VALUE        01681999
             'DPT   QTY'.                                               01682099
       01  DL1A-DETAIL-LINE-1A.                                         01682199
           05  FILLER                          PIC  X(01)  VALUE SPACE. 01682299
           05  DL1A-LIN1                       PIC  ZZ9.                01682399
           05  FILLER                          PIC  X(01)  VALUE SPACE. 01682499
           05  DL1A-DPT-CL-SUBCL-1.                                             
               10  DL1A-DEPT-1                PIC ZZZ.                          
               10  FILLER                     PIC X(01)   VALUE SPACE.          
               10  DL1A-GROUP-1.                                                
                   15 DL1A-CLASS-1            PIC ZZ      VALUE ZEROS.          
                   15 FILLER                  PIC X(01)   VALUE SPACE.          
                   15 DL1A-SUBCLASS-1         PIC ZZ      VALUE ZEROS.          
                   15 FILLER                  PIC X(02)   VALUE SPACE.          
               10  DL1A-GROUP-2 REDEFINES DL1A-GROUP-1.                         
                   15 DL1A-CLASS-2            PIC  ZZ.                          
                   15 DL1A-FILLER-2A          PIC  X(01).                       
                   15 DL1A-SUBCLASS-2         PIC  ZZZ.                         
                   15 DL1A-FILLER-2B          PIC  X(01).                       
               10  DL1A-GROUP-3 REDEFINES DL1A-GROUP-1.                         
                   15 DL1A-CLASS-3            PIC  ZZZ.                         
                   15 DL1A-FILLER-3A          PIC  X(01).                       
                   15 DL1A-SUBCLASS-3         PIC  ZZ.                          
                   15 DL1A-FILLER-3B          PIC  X(01).                       
               10  DL1A-GROUP-4 REDEFINES DL1A-GROUP-1.                         
                   15 DL1A-CLASS-4            PIC  ZZZ.                         
                   15 DL1A-FILLER-4A          PIC  X(01).                       
                   15 DL1A-SUBCLASS-4         PIC  ZZZ.                         
           05  FILLER                          PIC  X(01)  VALUE SPACE. 01682699
           05  DL1A-UPC1                       PIC  X(13).              01682799
SR3403     05  FILLER                          PIC  X(01)  VALUE SPACE. 01682899
SR3403     05  DL1A-PRC1                       PIC  ZZZZZ.ZZ.           01682999
           05  FILLER                          PIC  X(03)  VALUE SPACE. 01683099
           05  DL1A-QTY1                       PIC  ZZZ.                01683199
           05  FILLER                          PIC  X(07)  VALUE SPACE. 01683299
           05  DL1A-LIN2                       PIC  ZZ9.                01683399
           05  FILLER                          PIC  X(01)  VALUE SPACE. 01683499
           05  DL1A-DPT-CL-SUBCL-2.                                             
               10  DL1A-DEPT-2                PIC ZZZ.                          
               10  FILLER                     PIC X(01)   VALUE SPACE.          
               10  DL1A-GROUP-5.                                                
                   15 DL1A-CLASS-5            PIC ZZ      VALUE ZEROS.          
                   15 FILLER                  PIC X(01)   VALUE SPACE.          
                   15 DL1A-SUBCLASS-5         PIC ZZ      VALUE ZEROS.          
                   15 FILLER                  PIC X(02)   VALUE SPACE.          
               10  DL1A-GROUP-6 REDEFINES DL1A-GROUP-5.                         
                   15 DL1A-CLASS-6            PIC  ZZ.                          
                   15 DL1A-FILLER-6A          PIC  X(01).                       
                   15 DL1A-SUBCLASS-6         PIC  ZZZ.                         
                   15 DL1A-FILLER-6B          PIC  X(01).                       
               10  DL1A-GROUP-7 REDEFINES DL1A-GROUP-5.                         
                   15 DL1A-CLASS-7            PIC  ZZZ.                         
                   15 DL1A-FILLER-7A          PIC  X(01).                       
                   15 DL1A-SUBCLASS-7         PIC  ZZ.                          
                   15 DL1A-FILLER-7B          PIC  X(01).                       
               10  DL1A-GROUP-8 REDEFINES DL1A-GROUP-5.                         
                   15 DL1A-CLASS-8            PIC  ZZZ.                         
                   15 DL1A-FILLER-8A          PIC  X(01).                       
                   15 DL1A-SUBCLASS-8         PIC  ZZZ.                         
           05  FILLER                          PIC  X(01)  VALUE SPACE. 01683699
           05  DL1A-UPC2                       PIC  X(13).              01683799
SR3403     05  FILLER                          PIC  X(01)  VALUE SPACE. 01683899
SR3403     05  DL1A-PRC2                       PIC  ZZZZZ.ZZ.           01683999
           05  FILLER                          PIC  X(03)  VALUE SPACE. 01684099
           05  DL1A-QTY2                       PIC  ZZZ.                01684199
           05  FILLER                          PIC  X(03)  VALUE SPACE. 01684299
       01  DL1B-DETAIL-LINE-1B.                                         01684399
           05  FILLER                          PIC  X(01)  VALUE SPACE. 01684499
           05  DL1B-LINE                       PIC  ZZ9.                01684599
           05  FILLER                          PIC  X(03)  VALUE SPACE. 01684699
           05  DL1B-DESCRIPTION                PIC  X(40)  VALUE SPACE. 01684799
           05  FILLER                          PIC  X(02)  VALUE SPACE. 01684899
           05  DL1B-FIXTURE                    PIC  X(20)  VALUE SPACE. 01684999
           05  FILLER                          PIC  X(02)  VALUE SPACE. 01685099
           05  DL1B-DEPT                       PIC  X(03)  VALUE SPACE. 01685199
           05  FILLER                          PIC  X(03)  VALUE SPACE. 01685299
           05  DL1B-QTY                        PIC  ZZZ.                01685399
       01  EH1-ERROR-HEADING-1.                                         03350013
           05  EH1-RUN-DATE                PIC  X(08)  VALUE SPACES.    03360013
           05  FILLER                      PIC  X(02)  VALUE SPACES.    03370013
           05  EH1-RUN-TIME                PIC  X(08)  VALUE SPACES.    03380013
           05  FILLER                      PIC  X(10)  VALUE SPACES.    03390013
           05  FILLER                      PIC  X(48)  VALUE            03400013
               'KOHL''S TRANSFER WORKSHEET PRINT REQUEST ERROR'.        03410072
       01  EH2-ERROR-HEADING-2.                                         03420013
           05  FILLER                      PIC  X(28)  VALUE            03430013
               'PRINT REQUEST FOR WORKSHEET:'.                          03440072
           05  EH2-CONTROL-NBR             PIC  9(09).                  03450072
           05  FILLER                      PIC  X(16)  VALUE            03430013
               '    FROM STORE:'.                                       03440072
100404*    05  EH2-FROM-STORE-NBR          PIC  X(03).                  03450072
100404     05  EH2-FROM-STORE-NBR          PIC  X(04).                  03450072
           05  FILLER                      PIC  X(01)  VALUE SPACE.     03460072
           05  FILLER                      PIC  X(40)  VALUE            03530072
               'WAS CANCELLED FOR THE FOLLOWING REASON:'.               03540072
       01  ED1-ERROR-DETAIL-1.                                          03550013
           05  ED1-ERROR                   PIC  X(50)  VALUE SPACE.     03560013
           05  FILLER                      PIC  X(02)  VALUE SPACE.     03570072
           05  FILLER                      PIC  X(02)  VALUE SPACE.     03580072
           05  ED1-ERROR-KEY               PIC  X(25)  VALUE SPACE.     03590072
       01  ED2-ERROR-DETAIL-2.                                          03600013
           05  ED2-MESSAGE                 PIC  X(35)  VALUE SPACE.     03610072
       01  BL-BLANK-LINE.                                               01920002
           05  FILLER                          PIC  X(80)  VALUE SPACE. 01930002
      *                                                                 00620072
      *  FORMATS CICS SYSTEM MESSAGES FOR NON-ARCHITECTURE PROGRAMS     00630072
      *                                                                 00640072
      *    COPY DPWS011.                                                00650072
      *                                                                 00660013
      *---------------------------------------------------------------* 01940002
      *    ATTRIBUTE SETTINGS COPYBOOK.                               * 01950002
      *---------------------------------------------------------------* 01960002
                                                                        01970002
           COPY DPWS015.                                                01980002
                                                                        01990002
      *---------------------------------------------------------------* 02000002
      *    NUMERIC EDIT LAYOUT.                                       * 02010002
      *---------------------------------------------------------------* 02020002
                                                                        02030002
           COPY DPWS010I.                                               02040002
       EJECT                                                            02050002
      *---------------------------------------------------------------* 02120002
      *    STANDARD COMMAREA.                                         * 02130002
      *---------------------------------------------------------------* 02140002
                                                                        02150002
           COPY DPWS020.                                                02160002
           05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                02170002
                                                                        02180002
               10  INTER-APPL-COMM-AREA       PIC X(200).               05660099
           COPY TFWS001.                                                05670099
                                                                        02770402
           EJECT                                                        02670002
      *                                                                 02680002
      *  LAYOUT FOR THE DRS (DYNAMIC REPORT SYSTEM) COMMAREA            02690002
      *                                                                 02700002
           COPY  DRRD001O.                                              02710002
                                                                        02720002
      *                                                                 02730002
      *  LAYOUT FOR THE DRS (DYNAMIC REPORT SYSTEM) DETAIL LINES        02740002
      *                                                                 02750002
           COPY  DRRD002O.                                              02760002
                                                                        02770002
      *                                                                 00820072
      *  LAYOUT FOR THE DRS TERMINATION BLOCK                           00830072
      *                                                                 00840072
           COPY DRRD007.                                                00850072
                                                                        00860013
           EJECT                                                        02770102
      *                                                                 02770202
      *---------------------------------------------------------------* 02770502
      *    ABEND PROCESSING COPYBOOK.                                 * 02770602
      *---------------------------------------------------------------* 02770702
                                                                        02770802
           COPY DPWS013.                                                02770902
                                                                        02771002
       EJECT                                                            02772002
      *---------------------------------------------------------------* 02773002
      *    DB2 AREA FOR THE TRANSFER TABLE                            * 02774002
      *---------------------------------------------------------------* 02775002
           EXEC SQL                                                     02776002
                INCLUDE TTFMSTR                                         02777002
           END-EXEC.                                                    02778002
      *---------------------------------------------------------------* 02779002
      *    DB2 AREA FOR THE TRANSFER ITEM TABLE                       * 02780002
      *---------------------------------------------------------------* 02790002
           EXEC SQL                                                     02800002
                INCLUDE TTFITEM                                         02810002
           END-EXEC.                                                    02820002
      *---------------------------------------------------------------* 03010002
      *    DB2 AREA FOR THE TRANSFER CUSTOMER TABLE.                  * 03020002
      *---------------------------------------------------------------* 03030002
           EXEC SQL                                                     03040002
                INCLUDE TTFCUST                                         03050002
           END-EXEC.                                                    03060002
      *---------------------------------------------------------------* 03010002
      *    DB2 AREA FOR THE TRANSFER CONTAINER TYPE TABLE.            * 03020002
      *---------------------------------------------------------------* 03030002
           EXEC SQL                                                     03040002
                INCLUDE TTFSHCT                                         03050002
           END-EXEC.                                                    03060002
      *---------------------------------------------------------------* 03010002
      *    DB2 AREA FOR THE TRANSFER TYPE TABLE.                      * 03020002
      *---------------------------------------------------------------* 03030002
           EXEC SQL                                                     03040002
                INCLUDE TTFTYCD                                         03050002
           END-EXEC.                                                    03060002
      *---------------------------------------------------------------* 03250002
100404*    DB2 AREA FOR THE XST_LOC TABLE                             * 03260002
      *---------------------------------------------------------------* 03270002
           EXEC SQL                                                     03280002
100404          INCLUDE XST00001                                        03290002
           END-EXEC.                                                    03300002
      *---------------------------------------------------------------* 03250002
      *    DB2 AREA FOR THE SKU CROSS REFERENCE TABLE                 * 03260002
      *---------------------------------------------------------------* 03270002
           EXEC SQL                                                     03280002
                INCLUDE TSKXREF                                         03290002
           END-EXEC.                                                    03300002
      *---------------------------------------------------------------* 03310002
      *    DB2 AREA FOR COMMUNICATIONS                                * 03320002
      *---------------------------------------------------------------* 03330002
           EXEC SQL                                                     03340002
                INCLUDE SQLCA                                           03350002
           END-EXEC.                                                    03360002
      *---------------------------------------------------------------* 07220099
      *    CURSOR TO GET TRANSFER ITEMS FOR A RETAIL TRANSFER.        * 07230099
      *---------------------------------------------------------------* 07240099
                                                                        07250099
           EXEC SQL                                                     07260099
                DECLARE RTL-ITEM-CSR CURSOR                             07270099
                FOR SELECT                                              07280099
                      XFER_LNE_NBR                                      07290099
                     ,CPLD_RTL_PRIC_AMT                                 07330099
                     ,SCN_UPC_NBR                                       07340099
                     ,KOHLS_UPC_NBR                                     07340099
                     ,ITM_NBR                                           07340099
                     ,XFER_PRIC_AMT                                     07340099
                     ,XFER_QTY                                          07350099
                     ,RNBR_SKU_IND                                      07360099
                FROM  TTFITEM                                           07370099
               WHERE  XFER_DKEY_ID   = :DK-XFER-DKEY-ID                 07380099
               ORDER BY  XFER_LNE_NBR                                   07390099
100404         WITH UR                                                          
           END-EXEC.                                                    07410099
                                                                        07420099
      *---------------------------------------------------------------* 07430099
      *    CURSOR TO GET TRANSFER ITEMS FOR A NON-RETAIL TRANSFER.    * 07440099
      *---------------------------------------------------------------* 07450099
                                                                        07460099
           EXEC SQL                                                     07470099
                DECLARE NRTL-ITEM-CSR CURSOR                            07480099
                FOR SELECT                                              07490099
                      XFER_LNE_NBR                                      07500099
                     ,NRTL_1ST_LNE_DESC                                 07510099
                     ,NRTL_2ND_LNE_DESC                                 07520099
                     ,NRTL_FIXT_ID                                      07530099
                     ,NRTL_DEPT_NBR                                     07540099
                     ,XFER_QTY                                          07550099
                FROM  TTFITEM                                           07560099
               WHERE  XFER_DKEY_ID   = :DK-XFER-DKEY-ID                 07570099
               ORDER BY  XFER_LNE_NBR                                   07580099
100404         WITH UR                                                          
           END-EXEC.                                                    07600099
                                                                        07700002
       EJECT                                                            07710002
       LINKAGE SECTION.                                                 07720002
                                                                        07730002
       01  DFHCOMMAREA.                                                 07740002
           05  FILLER                         OCCURS  1 TO 4072 TIMES   07750002
                                              DEPENDING ON EIBCALEN.    07760002
               10  FILLER                     PIC X.                    07770002
                                                                        07780002
       EJECT                                                            07790002
       PROCEDURE DIVISION.                                              07800002
       0000-MAIN-MODULE.                                                07810002
           SET PS-NO-ERROR          TO TRUE.                            08160002
           PERFORM 8100-FORMAT-TIME.                                    08170002
           PERFORM 0100-RETRIEVE-STORED-DATA.                           08180002
           PERFORM 0200-MAIN-PROCESS.                                   08190002
                                                                        08200002
           MOVE PC-TERM TO DRS01-DRRB-FUNC.                             08210002
           PERFORM 8000-LINK-TO-DRS.                                    08220002
                                                                        08230002
           GOBACK.                                                      08240002
                                                                        08250002
       EJECT                                                            08260002
       0100-RETRIEVE-STORED-DATA.                                       08270002
                                                                        08280002
           EXEC CICS                                                    08290002
               RETRIEVE                                                 08300002
                   INTO  (TF001-INTER-APPL-COMMAREA)                    08310002
                   RESP  (PV-CICS-RESPONSE)                             08320002
           END-EXEC.                                                    08330002
                                                                        08340002
           EVALUATE TRUE                                                08350002
               WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 08360002
                   CONTINUE                                             08370002
               WHEN OTHER                                               08380002
                   SET PS-ERROR          TO TRUE                        08390002
                   MOVE 'CICS ERROR IN PASSING DATA. '                  04200013
                                         TO PV-ERROR-MSG                08400002
                   MOVE '0100-RETRIEVE-STORED-DATA'                     08410002
                                         TO DP013-PARAGRAPH             08420002
                   MOVE 'ERROR - RETRIEVE COMMAREA DATA'                06280013
                                         TO DP013-MESSAGE-TEXT (1)      08430002
                   PERFORM 9000-RETURN-MSG                              08440002
                   MOVE PV-DISPLAY-KEYS  TO DP013-MESSAGE-TEXT (2)      08450002
                   SET DP013-LINK-RETURN                                08460002
                       DP013-CICS-ABEND                                 08470002
                       DP013-NO-ROLLBACK TO TRUE                        08480002
                   PERFORM DP014-0000-PROCESS-ABEND                     08490002
           END-EVALUATE.                                                08500002
           MOVE TF001-DKEY-ID       TO DK-XFER-DKEY-ID                  08510013
                                       PH-CONTROL-NBR.                          
       EJECT                                                            08590002
       0200-MAIN-PROCESS.                                               08620002
                                                                        08670002
           IF PS-NO-ERROR                                               08680002
               PERFORM 6000-GET-CONTROL-INFO                            08690002
           END-IF.                                                      08700002
                                                                        08710002
           IF PS-NO-ERROR                                               08720002
               PERFORM 0400-INIT-PRINTER-FOR-REPORT                     08730002
           END-IF.                                                      08740002
                                                                        08750002
           IF PS-NO-ERROR                                               08720002
               IF PH-XFER-TYPE = PC-CUSTOMER                            35295705
                   PERFORM 6100-READ-CUSTOMER                           35295813
               END-IF                                                   35295905
           END-IF.                                                      35295905
                                                                                
           IF PS-NO-ERROR                                               08720002
               IF PH-XFER-TYPE NOT = PC-NON-RETAIL                      35296099
                   INITIALIZE PH-RETAIL-ITEM-ARRAY (1)                  35300099
                                     PH-RETAIL-ITEM-ARRAY (2)           35310099
                   PERFORM 6110-OPEN-RTL-CURSOR                         35320099
                   PERFORM 6120-READ-RTL-ITEMS-FROM-DB                  35330099
                   PERFORM 6130-CLOSE-RTL-CURSOR                        35340099
               ELSE                                                     35350099
                   INITIALIZE PH-NON-RETAIL-ITEM-ARRAY (1)              35360099
                                    PH-NON-RETAIL-ITEM-ARRAY (2)        35370099
                   PERFORM 6210-OPEN-NRTL-CURSOR                        35380099
                   PERFORM 6220-READ-NRTL-ITEMS-FROM-DB                 35390099
                   PERFORM 6230-CLOSE-NRTL-CURSOR                       35400099
               END-IF                                                   35410099
           END-IF.                                                      35410099
                                                                        08754003
           IF PS-NO-ERROR                                               08760002
               PERFORM 6500-PRINT-LIST                                  09260599
           END-IF.                                                      08900002
                                                                        08910002
      *----------------------------------------------------------------*08920002
      * IF THERE WAS AN ERROR ENCOUNTERED, TERMINATE DRS AND DELETE ANY 08930002
      * PORTION OF THE DOCUMENT THAT MAY HAVE ALREADY BEEN PRINTED;     08940002
      * THEN INITIALIZE DRS FOR AN ERROR REPORT.                        08950002
      *----------------------------------------------------------------*08960002
           IF PS-ERROR                                                  08970002
               IF PS-DRS-INITIALIZED                                    08980002
                   MOVE 'D'              TO DRS07-DRTB-DISP (1)         08990002
                   MOVE +1               TO DRS07-DRTB-ATTR-INDX (1)    09000002
                   MOVE PC-TERM          TO DRS01-DRRB-FUNC             09010002
                   MOVE DRS07-DRTB-TERM-BLOCK                           09020002
                                         TO DRS01-COMM-DRIB             09030002
                   PERFORM 8000-LINK-TO-DRS                             09040002
               END-IF                                                   09050002
               PERFORM 0500-INIT-PRINTER-FOR-ERROR                      09060002
               PERFORM 9000-PRINT-ERROR                                 09070002
           END-IF.                                                      09080002
      *----------------------------------------------------------------*09580002
      * INITIALIZE THE PRINTER FOR THE TRANSFER DOCUMENT.               09590002
      *----------------------------------------------------------------*09600002
       0400-INIT-PRINTER-FOR-REPORT.                                    09610002
           IF TF001-PRINTER-DEST = 'XXXX'                               10300002
               MOVE 'R'                TO DRS02-DRIB-CLASS              10310002
               MOVE 'N'                TO DRS02-DRIB-HOLD               10320002
               MOVE 'LOCAL'            TO DRS02-DRIB-DEST               10330002
           ELSE                                                         10340002
               MOVE 'A'                TO DRS02-DRIB-CLASS              10350002
               MOVE 'N'                TO DRS02-DRIB-HOLD               10360002
               MOVE TF001-PRINTER-DEST                                  10370002
                                       TO DRS02-DRIB-DEST               10380002
           END-IF.                                                      10390002
                                                                        10400002
           MOVE PC-INIT                TO DRS01-DRRB-FUNC.              10410002
           MOVE DRS02-DRIB-HEADER      TO DRS01-COMM-DRIB-HDR.          10420002
           MOVE DRS02-DRIB-ATTRIB      TO DRS01-COMM-DRIB-AT1.          10430002
      *                                                                 10440002
           PERFORM 8000-LINK-TO-DRS.                                    10450002
                                                                        10460002
           SET PS-DRS-INITIALIZED TO TRUE.                              10470002
           MOVE PC-PUT                 TO  DRS01-DRRB-FUNC.             10480002
           MOVE PC-CURRENT-PROGRAM-NAME TO DP132O-PROGRAM-NAME.         16350002
           MOVE 1                       TO DP132O-REPORT-NUMBER.        16360002
           MOVE 99                      TO PV-LINE-COUNT.               16460002
           MOVE 0                       TO PV-PAGE-COUNT.               16470002
                                                                        10490002
      *----------------------------------------------------------------*10500002
      * INITIALIZE THE PRINTER FOR THE ERROR REPORT.                    10510002
      *----------------------------------------------------------------*10520002
       0500-INIT-PRINTER-FOR-ERROR.                                     10530002
                                                                        10540002
           IF TF001-PRINTER-DEST = 'XXXX'                               10550002
               MOVE 'R'                TO DRS02-DRIB-CLASS              10560002
               MOVE 'N'                TO DRS02-DRIB-HOLD               10570002
               MOVE 'LOCAL'            TO DRS02-DRIB-DEST               10580002
           ELSE                                                         10590002
               MOVE 'A'                TO DRS02-DRIB-CLASS              10600002
               MOVE 'N'                TO DRS02-DRIB-HOLD               10610002
               MOVE TF001-PRINTER-DEST                                  10620002
                                       TO DRS02-DRIB-DEST               10630002
           END-IF.                                                      10640002
                                                                        10650002
           MOVE PC-INIT                TO DRS01-DRRB-FUNC.              10660002
           MOVE DRS02-DRIB-HEADER      TO DRS01-COMM-DRIB-HDR.          10670002
           MOVE DRS02-DRIB-ATTRIB      TO DRS01-COMM-DRIB-AT1.          10680002
                                                                        10690002
           PERFORM 8000-LINK-TO-DRS.                                    10700002
                                                                        10710002
           SET PS-DRS-INITIALIZED      TO TRUE.                         10720002
           MOVE PC-PUT                 TO  DRS01-DRRB-FUNC.             10730002
                                                                        10740002
      *----------------------------------------------------------------*35287100
      * SELECT DATA FROM THE TRANSFER TABLES WHEN PROCESSING AN         35287202
      * EXISTING WORKSHEET FROM THE CRITERIA SPEC SCREEN.              *35287399
      *----------------------------------------------------------------*35287499
       6000-GET-CONTROL-INFO.                                           35287599
      *                                                                 35288300
               EXEC SQL                                                 35288400
                   SELECT ENTR_MTHD_TYP_CDE                             35288513
                         ,X.XFER_TYP_CDE                                35288613
                         ,X.CONTNR_TYP_CDE                              35288702
                         ,FR_STR_NBR                                    35288802
                         ,TO_STR_NBR                                    35288802
                         ,CPLD_INIT_1ST_NM                              35288920
                         ,CPLD_LAST_NM                                  35289020
                         ,LG_TTE_1ST_SEAL_ID                            35289102
                         ,LG_TTE_2ND_SEAL_ID                            35289202
                         ,SM_TTE_BAG_SEAL_ID                            35289302
                         ,TRLR_NBR                                      35289402
                         ,TRLR_SEAL_ID                                  35289520
                         ,CLBK_NBR                                      35289602
                         ,STK_BAL_APVL_NBR                              35289702
                         ,RQSTR_INIT_1ST_NM                             35289802
                         ,RQSTR_LAST_NM                                 35289920
                         ,ATTN_INIT_1ST_NM                              35290002
                         ,ATTN_LAST_NM                                  35290120
100404                   ,LOC_10_ABBR_NM                                35290220
                         ,CT.CONTNR_TYP_DESC                            06899402
                         ,XT.TYP_1ST_LNE_DESC                           06899602
                         ,XT.TYP_2ND_LNE_DESC                           06899602
                   INTO   :TFMSTR-ENTR-MTHD-TYP-CDE                     35290319
                         ,:TFMSTR-XFER-TYP-CDE                          35290419
                         ,:TFMSTR-CONTNR-TYP-CDE                        35290519
                         ,:TFMSTR-FR-STR-NBR                            35290619
                         ,:TFMSTR-TO-STR-NBR                            35290619
                         ,:TFMSTR-CPLD-INIT-1ST-NM                      35290720
                         ,:TFMSTR-CPLD-LAST-NM                          35290820
                         ,:TFMSTR-LG-TTE-1ST-SEAL-ID                    35290919
                         ,:TFMSTR-LG-TTE-2ND-SEAL-ID                    35291019
                         ,:TFMSTR-SM-TTE-BAG-SEAL-ID                    35291119
                         ,:TFMSTR-TRLR-NBR                              35291219
                         ,:TFMSTR-TRLR-SEAL-ID                          35291320
                         ,:TFMSTR-CLBK-NBR                              35291419
                         ,:TFMSTR-STK-BAL-APVL-NBR                      35291519
                         ,:TFMSTR-RQSTR-INIT-1ST-NM                     35291619
                         ,:TFMSTR-RQSTR-LAST-NM                         35291720
                         ,:TFMSTR-ATTN-INIT-1ST-NM                      35291819
                         ,:TFMSTR-ATTN-LAST-NM                          35291920
100404                   ,:XST00001-LOC-10-ABBR-NM                      35292020
                         ,:TFSHCT-CONTNR-TYP-DESC                       06910019
                         ,:TFTYCD-TYP-1ST-LNE-DESC                      06910120
                         ,:TFTYCD-TYP-2ND-LNE-DESC                      06910120
                   FROM   TTFMSTR X                                     35292118
100404                   ,XST_LOC L                                     35292218
                         ,TTFSHCT CT                                    06931018
                         ,TTFTYCD XT                                    06932018
                   WHERE  X.XFER_DKEY_ID   = :DK-XFER-DKEY-ID     AND   35292313
                          X.CONTNR_TYP_CDE = CT.CONTNR_TYP_CDE    AND   06941002
                          X.XFER_TYP_CDE   = XT.XFER_TYP_CDE      AND   06942003
100404                    X.TO_STR_NBR     = L.LOC_NBR                  35292499
               END-EXEC                                                 35292500
                                                                        35292600
               EVALUATE TRUE                                            35292700
                   WHEN SQLCODE = ZERO                                  35292800
                      MOVE TFMSTR-XFER-TYP-CDE  TO PH-XFER-TYPE         35293219
                      MOVE TFMSTR-CONTNR-TYP-CDE TO PH-CONTNR-TYPE      35293319
                      MOVE TFMSTR-TO-STR-NBR    TO PH-TO-STORE-NBR-N    35293419
                      MOVE TFMSTR-FR-STR-NBR    TO PH-FR-STORE-NBR-N    35293419
                      MOVE TFMSTR-CPLD-INIT-1ST-NM                      35293522
                                                TO PH-COMP-BY-INT       35293603
                      MOVE TFMSTR-CPLD-LAST-NM  TO PH-COMP-BY-NAM       35293722
                      MOVE TFMSTR-LG-TTE-1ST-SEAL-ID                    35293819
                                                TO PH-LG-TOTE-SEAL1     35293903
                      MOVE TFMSTR-LG-TTE-2ND-SEAL-ID                    35294019
                                                TO PH-LG-TOTE-SEAL2     35294103
                      MOVE TFMSTR-SM-TTE-BAG-SEAL-ID                    35294219
                                                TO PH-SM-TOTE-SEAL      35294303
                      MOVE TFMSTR-TRLR-NBR      TO PH-TRAILER-NBR       35294419
                      MOVE TFMSTR-TRLR-SEAL-ID  TO PH-TRAILER-SEAL      35294522
                      MOVE TFMSTR-CLBK-NBR      TO PH-CALLBACK-NBR-N    35294619
                      MOVE TFMSTR-STK-BAL-APVL-NBR                      35294719
                                                TO PH-APPROVAL-NBR-N    35294803
                      MOVE TFMSTR-RQSTR-INIT-1ST-NM                     35294919
                                                TO PH-REQ-BY-INT        35295003
                      MOVE TFMSTR-RQSTR-LAST-NM TO PH-REQ-BY-NAM        35295122
                      MOVE TFMSTR-ATTN-INIT-1ST-NM                      35295219
                                                TO PH-ATTN-TO-INT       35295303
                      MOVE TFMSTR-ATTN-LAST-NM  TO PH-ATTN-TO-NAM       35295422
100404                MOVE XST00001-LOC-10-ABBR-NM                      35295522
                                                TO PH-TO-STORE-NAM      35295603
                      MOVE TFSHCT-CONTNR-TYP-DESC                       06983919
                                                TO PH-CONTNR-DESC       06984003
                      IF TFTYCD-TYP-2ND-LNE-DESC = SPACES                       
                          MOVE TFTYCD-TYP-1ST-LNE-DESC                          
                                         TO PH-XFER-DESC                        
                      ELSE                                                      
                          STRING                                                
                              TFTYCD-TYP-1ST-LNE-DESC DELIMITED BY '  '         
                              TFTYCD-TYP-2ND-LNE-DESC DELIMITED BY '  '         
                                         INTO PH-XFER-DESC                      
                      END-IF                                                    
                   WHEN OTHER                                           35410600
                       IF SQLCODE = -904 OR -911 OR -913                11450000
                           SET PS-CONTENTION TO TRUE                    11730002
                       END-IF                                                   
                       SET PS-ERROR         TO TRUE                     11520002
                       MOVE 'ERROR READING THE TRANSFER MASTER'         11530002
                                            TO PV-ERROR-MSG             11540002
                       MOVE '6000-GET-CONTROL-INFO'                     11550002
                                            TO DP013-PARAGRAPH          11560002
                       MOVE 'READ WORKSHEET DATA FROM MASTER'           11570002
                                            TO DP013-MESSAGE-TEXT (1)   11570002
                       PERFORM 9000-RETURN-MSG                          11580002
                       MOVE PV-DISPLAY-KEYS TO DP013-MESSAGE-TEXT (2)   11590002
                       MOVE 'TTFMSTR'       TO DP013-DB2-TABLE-NAME (1) 11600002
100404                 MOVE 'XST_LOC'       TO DP013-DB2-TABLE-NAME (2) 35411518
                       MOVE SQLCA           TO DP013-SQLCA              11630002
                       SET DP013-LINK-RETURN                            11640002
                           DP013-DB2-ABEND                              11650002
                           DP013-NO-ROLLBACK TO TRUE                    11660002
                       PERFORM DP014-0000-PROCESS-ABEND                 11670002
               END-EVALUATE.                                            35412000
       EJECT                                                            35413702
      *----------------------------------------------------------------*35413800
      * SELECT DATA FROM THE TRANSFER THE CUSTOMER TABLE.              *35413902
      *----------------------------------------------------------------*35414099
       6100-READ-CUSTOMER.                                              35415013
           INITIALIZE DCLTTFCUST.                                       35415199
               EXEC SQL                                                 35415703
                   SELECT CUST_NM                                       35415805
                         ,CUST_1ST_LNE_ADDR                             35415905
                         ,CUST_2ND_LNE_ADDR                             35416005
                         ,CTY_NM                                        35416105
                         ,ST_CDE                                        35416205
                         ,ZIP_CDE                                       35416305
                         ,ZIP_EXT_CDE                                   35416405
                         ,PHN_NBR                                       35416505
                       INTO :TFCUST-CUST-NM                             35416619
                           ,:TFCUST-CUST-1ST-LNE-ADDR                   35416719
                           ,:TFCUST-CUST-2ND-LNE-ADDR                   35416819
                           ,:TFCUST-CTY-NM                              35416919
                           ,:TFCUST-ST-CDE                              35417019
                           ,:TFCUST-ZIP-CDE                             35417119
                           ,:TFCUST-ZIP-EXT-CDE                         35417219
                           ,:TFCUST-PHN-NBR                             35417319
                       FROM TTFCUST                                     35417418
                       WHERE XFER_DKEY_ID  = :DK-XFER-DKEY-ID           35417515
               END-EXEC                                                 35417603
               EVALUATE TRUE                                            35417703
                   WHEN SQLCODE = ZERO                                  35418403
                       MOVE TFCUST-CUST-NM                              35418722
                                          TO PH-CUST-NAME               35418805
                       MOVE TFCUST-CUST-1ST-LNE-ADDR                    35418922
                                          TO PH-ADDR1                   35419005
                       MOVE TFCUST-CUST-2ND-LNE-ADDR                    35419122
                                          TO PH-ADDR2                   35419205
                       MOVE TFCUST-CTY-NM                               35419322
                                          TO PH-CITY                    35419405
                       MOVE TFCUST-ST-CDE                               35419522
                                          TO PH-STATE                   35419605
                       MOVE TFCUST-ZIP-CDE                              35419722
                                          TO PH-ZIP                     35419805
                       MOVE TFCUST-ZIP-EXT-CDE                          35419922
                                          TO PH-ZIP-EXT                 35420005
                       MOVE TFCUST-PHN-NBR                              35420122
                                          TO PH-PHONE                   35420205
                   WHEN SQLCODE = +100                                  35418003
                       MOVE 'NOT FOUND'   TO PH-CUST-NAME               35418305
                   WHEN OTHER                                           35410600
                       IF SQLCODE = -904 OR -911 OR -913                11450000
                           SET PS-CONTENTION TO TRUE                    11730002
                       END-IF                                                   
                       SET PS-ERROR         TO TRUE                     11520002
                       MOVE 'ERROR READING THE CUSTOMER TABLE'          11530002
                                            TO PV-ERROR-MSG             11540002
                       MOVE '6100-READ-CUSTOMER'                        35420613
                                         TO DP013-PARAGRAPH             35420703
                       MOVE 'READ DATA FROM TTFCUST'                    35420818
                                         TO DP013-MESSAGE-TEXT (1)      35420903
                       PERFORM 9000-RETURN-MSG                          11580002
                       MOVE PV-DISPLAY-KEYS TO DP013-MESSAGE-TEXT (2)   11590002
                       MOVE 'TTFCUST'    TO DP013-DB2-TABLE-NAME (1)    35421118
                       MOVE SQLCA           TO DP013-SQLCA              11630002
                       SET DP013-LINK-RETURN                            11640002
                           DP013-DB2-ABEND                              11650002
                           DP013-NO-ROLLBACK TO TRUE                    11660002
                       PERFORM DP014-0000-PROCESS-ABEND                 11670002
               END-EVALUATE.                                            35421603
           EJECT                                                        35423224
      *----------------------------------------------------------------*35423399
      * OPEN THE RETAIL TRANSFER ITEM CURSOR.                          *35423499
      *----------------------------------------------------------------*35424099
       6110-OPEN-RTL-CURSOR.                                            35425099
                                                                        35480099
               EXEC SQL                                                 36990099
                    OPEN RTL-ITEM-CSR                                   37000099
               END-EXEC                                                 37010099
                                                                        35480099
               EVALUATE TRUE                                            35490099
                   WHEN SQLCODE = ZERO                                  35500099
                       CONTINUE                                                 
                   WHEN OTHER                                           35540099
                       IF SQLCODE = -904 OR -911 OR -913                11450000
                           SET PS-CONTENTION TO TRUE                    11730002
                       END-IF                                                   
                       MOVE '6110-OPEN-RTL-CURSOR'                      35570099
                                         TO DP013-PARAGRAPH             35580099
                       MOVE 'OPEN TRANSFER ITEM CURSOR - '              35590099
                                         TO DP013-MESSAGE-TEXT (1)      35600099
                       MOVE SQLCA        TO DP013-SQLCA                 35610099
                       MOVE 'TTFITEM '   TO DP013-DB2-TABLE-NAME (1)    35620099
                       SET PS-ERROR         TO TRUE                     11520002
                       MOVE 'ERROR OPENING THE RETAIL ITEM CURSOR'      11530002
                                            TO PV-ERROR-MSG             11540002
                       PERFORM 9000-RETURN-MSG                          11580002
                       MOVE PV-DISPLAY-KEYS TO DP013-MESSAGE-TEXT (2)   11590002
                       MOVE SQLCA           TO DP013-SQLCA              11630002
                       SET DP013-LINK-RETURN                            11640002
                           DP013-DB2-ABEND                              11650002
                           DP013-NO-ROLLBACK TO TRUE                    11660002
                       PERFORM DP014-0000-PROCESS-ABEND                 11670002
               END-EVALUATE.                                            35660099
       EJECT                                                            35810099
      *----------------------------------------------------------------*35820099
      *    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE    *35830099
      *    BLOCKS IN THE ARRAY.  THE LIMIT IS 2 BLOCKS; WHEN THEY      *35840099
      *    BECOME FULL, STOP PROCESSING. (RETAIL TRANSFERS)            *35850099
      *----------------------------------------------------------------*35860099
                                                                        35870099
       6120-READ-RTL-ITEMS-FROM-DB.                                     35880099
                                                                        35890099
           SET PS-ITEMS-LEFT-ON-DB       TO TRUE.                       35900099
           PERFORM                                                      35910099
               UNTIL  PS-NO-ITEMS-LEFT-ON-DB                            35920099
                                                                        35930099
               PERFORM 6140-FETCH-RTL-ITEMS                             35940099
                                                                        35950099
               IF  PS-ITEMS-LEFT-ON-DB                                  35960099
                   IF  TFITEM-XFER-LNE-NBR > PC-ITEMS-PER-RTL-PANEL     35970099
                       MOVE +2           TO PV-BLK-SUB                  35980099
                       SUBTRACT PC-ITEMS-PER-RTL-PANEL FROM             35990099
                                         TFITEM-XFER-LNE-NBR            36000099
                   ELSE                                                 36010099
                       MOVE +1           TO PV-BLK-SUB                  36020099
                   END-IF                                               36030099
                   MOVE TFITEM-XFER-LNE-NBR TO PV-ITEM-SUB              36040099
                   MOVE SKXREF-DEPT                      TO             36050099
                           PH-ENT-DEPT       (PV-BLK-SUB PV-ITEM-SUB)   36060099
                   MOVE SKXREF-CLASS                     TO             36070099
                           PH-ENT-CLASS      (PV-BLK-SUB PV-ITEM-SUB)   36080099
                   MOVE SKXREF-SUBCLASS                  TO             36090099
                           PH-ENT-SUBCLASS   (PV-BLK-SUB PV-ITEM-SUB)   36100099
                   MOVE TFITEM-XFER-QTY                  TO             36110099
                           PH-RTL-QTY-N      (PV-BLK-SUB PV-ITEM-SUB)   36120099
                   MOVE TFITEM-CPLD-RTL-PRIC-AMT         TO             36130099
                           PH-FILE-PRICE     (PV-BLK-SUB PV-ITEM-SUB)   36140099
                   IF TFITEM-SCN-UPC-NBR > 0                            36140199
                       MOVE TFITEM-SCN-UPC-NBR           TO             36141099
                           PH-UPC-N          (PV-BLK-SUB PV-ITEM-SUB)   36141199
                   END-IF                                               36141299
                   MOVE TFITEM-ITM-NBR                   TO             36142099
                           PH-ITEM-NBR       (PV-BLK-SUB PV-ITEM-SUB)   36143099
                   MOVE TFITEM-KOHLS-UPC-NBR             TO             36142099
                           PH-KOHLS-UPC      (PV-BLK-SUB PV-ITEM-SUB)   36143099
                   MOVE TFITEM-XFER-PRIC-AMT             TO             36150099
                           PH-PRICE-N        (PV-BLK-SUB PV-ITEM-SUB)   36160099
                   MOVE TFITEM-RNBR-SKU-IND              TO             36170099
                           PH-RENUMBER-SW    (PV-BLK-SUB PV-ITEM-SUB)   36180099
               END-IF                                                   36190099
           END-PERFORM.                                                 36200099
       EJECT                                                            36220099
      *----------------------------------------------------------------*36230099
      * CLOSE THE TRANSFER ITEM CURSOR.                                *36240099
      *----------------------------------------------------------------*36250099
                                                                        36260099
       6130-CLOSE-RTL-CURSOR.                                           36270099
           EXEC SQL                                                     36280099
               CLOSE RTL-ITEM-CSR                                       36290099
           END-EXEC                                                     36300099
      *                                                                 36310099
           EVALUATE TRUE                                                36320099
               WHEN SQLCODE = ZERO                                      36330099
                   CONTINUE                                             36340099
               WHEN OTHER                                               36350099
                       MOVE '6130-CLOSE-RTL-CURSOR'                     36380099
                                     TO DP013-PARAGRAPH                 36390099
                       MOVE 'CLOSE TRANSFER ITEM CURSOR '               36400099
                                     TO DP013-MESSAGE-TEXT (1)          36410099
                       MOVE 'TTFITEM '   TO DP013-DB2-TABLE-NAME (1)    36430099
                       IF SQLCODE = -904 OR -911 OR -913                11450000
                           SET PS-CONTENTION TO TRUE                    11730002
                       END-IF                                                   
                       MOVE 'TTFITEM '   TO DP013-DB2-TABLE-NAME (1)    35620099
                       SET PS-ERROR         TO TRUE                     11520002
                       MOVE 'ERROR CLOSING THE RETAIL ITEM CURSOR'      11530002
                                            TO PV-ERROR-MSG             11540002
                       PERFORM 9000-RETURN-MSG                          11580002
                       MOVE PV-DISPLAY-KEYS TO DP013-MESSAGE-TEXT (2)   11590002
                       MOVE SQLCA           TO DP013-SQLCA              11630002
                       SET DP013-LINK-RETURN                            11640002
                           DP013-DB2-ABEND                              11650002
                           DP013-NO-ROLLBACK TO TRUE                    11660002
                       PERFORM DP014-0000-PROCESS-ABEND                 11670002
           END-EVALUATE.                                                36470099
                                                                        36480099
       EJECT                                                            36490099
      *----------------------------------------------------------------*36500099
      *    FETCH THE TRANSFER ITEM CURSOR. (RETAIL TRANSFERS)          *36510099
      *----------------------------------------------------------------*36520099
                                                                        36530099
       6140-FETCH-RTL-ITEMS.                                            36540099
                                                                        36550099
           EXEC SQL                                                     36560099
               FETCH RTL-ITEM-CSR                                       36570099
               INTO                                                     36580099
                      :TFITEM-XFER-LNE-NBR                              36590099
                    , :TFITEM-CPLD-RTL-PRIC-AMT                         36630099
                    , :TFITEM-SCN-UPC-NBR                               07340099
                    , :TFITEM-KOHLS-UPC-NBR                             07340099
                    , :TFITEM-ITM-NBR                                   07340099
                    , :TFITEM-XFER-PRIC-AMT                             36640099
                    , :TFITEM-XFER-QTY                                  36650099
                    , :TFITEM-RNBR-SKU-IND                              36660099
           END-EXEC                                                     36670099
                                                                        36680099
           EVALUATE TRUE                                                36690099
               WHEN SQLCODE = ZERO                                      36700099
                    PERFORM 6150-SELECT-DEPT-CLASS                              
               WHEN SQLCODE = +100                                      36720099
                    SET PS-NO-ITEMS-LEFT-ON-DB                          36730099
                                         TO TRUE                        36740099
               WHEN OTHER                                               36750099
                    MOVE '6140-FETCH-RTL-ITEMS'                         36770099
                                     TO DP013-PARAGRAPH                 36780099
                    MOVE 'FETCH RETAIL TRANSFER ITEM CURSOR'            36790099
                                     TO DP013-MESSAGE-TEXT (1)          36800099
                    MOVE 'TTFITEM '  TO DP013-DB2-TABLE-NAME (1)        36810099
                    IF SQLCODE = -904 OR -911 OR -913                   11450000
                           SET PS-CONTENTION TO TRUE                    11730002
                    END-IF                                                      
                    MOVE 'TTFITEM '   TO DP013-DB2-TABLE-NAME (1)       35620099
                    SET PS-ERROR         TO TRUE                        11520002
                    MOVE 'ERROR READING THE RETAIL ITEM CURSOR'         11530002
                                            TO PV-ERROR-MSG             11540002
                    PERFORM 9000-RETURN-MSG                             11580002
                    MOVE PV-DISPLAY-KEYS TO DP013-MESSAGE-TEXT (2)      11590002
                    MOVE SQLCA           TO DP013-SQLCA                 11630002
                    SET DP013-LINK-RETURN                               11640002
                        DP013-DB2-ABEND                                 11650002
                        DP013-NO-ROLLBACK TO TRUE                       11660002
                    PERFORM DP014-0000-PROCESS-ABEND                    11670002
           END-EVALUATE.                                                36860099
                                                                        36870099
       EJECT                                                            36880099
                                                                                
       6150-SELECT-DEPT-CLASS.                                                  
           INITIALIZE DCLTSKXREF.                                               
                                                                                
           EXEC SQL                                                             
               SELECT  DEPT                                                     
                      ,CLASS                                                    
                      ,SUBCLASS                                                 
                 INTO  :SKXREF-DEPT                                             
                      ,:SKXREF-CLASS                                            
                      ,:SKXREF-SUBCLASS                                         
                 FROM  TSKXREF                                                  
                WHERE  ITM_NBR  =  :TFITEM-ITM-NBR                              
           END-EXEC.                                                            
                                                                                
           EVALUATE TRUE                                                        
               WHEN SQLCODE = ZERO                                              
                    CONTINUE                                                    
               WHEN SQLCODE = +100                                              
                   MOVE TFITEM-KOHLS-UPC-NBR TO PV-HOLD-UPC-NBR-9               
                   MOVE PV-KOHLS-DEPT TO SKXREF-DEPT                            
                   MOVE PV-KOHLS-CL-9 TO SKXREF-SUBCLASS                        
                   MOVE ZERO          TO PV-KOHLS-CL-2                          
                   MOVE PV-KOHLS-CL-9 TO SKXREF-CLASS                           
               WHEN OTHER                                                       
                   IF SQLCODE = -904 OR -911 OR -913                    11450000
                       SET PS-CONTENTION TO TRUE                        11730002
                   END-IF                                                       
                   SET PS-ERROR             TO TRUE                     11520002
                   MOVE 'ERROR READING TSKXREF'                         11530002
                                        TO PV-ERROR-MSG                 11540002
                   MOVE '6150-SELECT-DEPT-CLASS'                        35420613
                                     TO DP013-PARAGRAPH                 35420703
                   MOVE 'READ DATA FROM TSKXREF'                        35420818
                                     TO DP013-MESSAGE-TEXT (1)          35420903
                   PERFORM 9000-RETURN-MSG                              11580002
                   MOVE PV-DISPLAY-KEYS TO DP013-MESSAGE-TEXT (2)       11590002
                   MOVE 'TSKXREF'        TO DP013-DB2-TABLE-NAME (1)    35421118
                   MOVE SQLCA               TO DP013-SQLCA              11630002
                   SET DP013-LINK-RETURN                                11640002
                       DP013-DB2-ABEND                                  11650002
                       DP013-NO-ROLLBACK TO TRUE                        11660002
                   PERFORM DP014-0000-PROCESS-ABEND                     11670002
           END-EVALUATE.                                                        
                                                                                
      *----------------------------------------------------------------*36890099
      * OPEN THE NON-RETAIL TRANSFER ITEM CURSOR.                      *36900099
      *----------------------------------------------------------------*36910099
       6210-OPEN-NRTL-CURSOR.                                           36920099
               EXEC SQL                                                 36990099
                    OPEN NRTL-ITEM-CSR                                  37000099
               END-EXEC                                                 37010099
                                                                        37020099
               EVALUATE TRUE                                            37030099
                   WHEN SQLCODE = ZERO                                  37040099
                       CONTINUE                                         37070099
                   WHEN OTHER                                           37080099
                       MOVE '6210-OPEN-NRTL-CURSOR'                     37110099
                                         TO DP013-PARAGRAPH             37120099
                       MOVE 'OPEN TRANSFER ITEM CURSOR - '              37130099
                                         TO DP013-MESSAGE-TEXT (1)      37140099
                       MOVE 'TTFITEM '   TO DP013-DB2-TABLE-NAME (1)    37160099
                       IF SQLCODE = -904 OR -911 OR -913                11450000
                           SET PS-CONTENTION TO TRUE                    11730002
                       END-IF                                                   
                       MOVE 'TTFITEM '   TO DP013-DB2-TABLE-NAME (1)    35620099
                       SET PS-ERROR         TO TRUE                     11520002
                       MOVE 'ERROR OPENING THE NON-RETAIL ITEM CURSOR'  11530002
                                            TO PV-ERROR-MSG             11540002
                       PERFORM 9000-RETURN-MSG                          11580002
                       MOVE PV-DISPLAY-KEYS TO DP013-MESSAGE-TEXT (2)   11590002
                       MOVE SQLCA           TO DP013-SQLCA              11630002
                       SET DP013-LINK-RETURN                            11640002
                           DP013-DB2-ABEND                              11650002
                           DP013-NO-ROLLBACK TO TRUE                    11660002
                       PERFORM DP014-0000-PROCESS-ABEND                 11670002
               END-EVALUATE.                                            37200099
       EJECT                                                            37350099
      *----------------------------------------------------------------*37360099
      *    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE    *37370099
      *    BLOCKS IN THE ARRAY.  THE LIMIT IS 2 BLOCKS; WHEN THEY      *37380099
      *    BECOME FULL, STOP PROCESSING. (NON-RETAIL TRANSFERS)        *37390099
      *----------------------------------------------------------------*37400099
                                                                        37410099
       6220-READ-NRTL-ITEMS-FROM-DB.                                    37420099
                                                                        37430099
           PERFORM                                                      37440099
               UNTIL  PS-NO-ITEMS-LEFT-ON-DB                            37450099
                                                                        37460099
               PERFORM 6240-FETCH-NRTL-ITEMS                            37470099
                                                                        37480099
               IF  PS-ITEMS-LEFT-ON-DB                                  37490099
                   IF  TFITEM-XFER-LNE-NBR > PC-ITEMS-PER-NRTL-PANEL    37500099
                       MOVE +2           TO PV-BLK-SUB                  37510099
                       SUBTRACT PC-ITEMS-PER-NRTL-PANEL FROM            37520099
                                         TFITEM-XFER-LNE-NBR            37530099
                   ELSE                                                 37540099
                       MOVE +1           TO PV-BLK-SUB                  37550099
                   END-IF                                               37560099
                   MOVE TFITEM-XFER-LNE-NBR TO PV-ITEM-SUB              37570099
                   MOVE TFITEM-NRTL-FIXT-ID              TO             37580099
                           PH-FIXTURE        (PV-BLK-SUB PV-ITEM-SUB)   37590099
                   MOVE TFITEM-NRTL-DEPT-NBR             TO             37600099
                           PH-NRTL-DEPT      (PV-BLK-SUB PV-ITEM-SUB)   37610099
                   MOVE TFITEM-NRTL-1ST-LNE-DESC         TO             37620099
                           PH-ITEM-DESC1     (PV-BLK-SUB PV-ITEM-SUB)   37630099
                   MOVE TFITEM-NRTL-2ND-LNE-DESC         TO             37640099
                           PH-ITEM-DESC2     (PV-BLK-SUB PV-ITEM-SUB)   37650099
                   MOVE TFITEM-XFER-QTY                  TO             37660099
                           PH-NRTL-QTY-N     (PV-BLK-SUB PV-ITEM-SUB)   37670099
               END-IF                                                   37680099
           END-PERFORM.                                                 37690099
                                                                        37700099
       EJECT                                                            37710099
      *----------------------------------------------------------------*37720099
      * CLOSE THE NON-RETAIL TRANSFER ITEM CURSOR.                     *37730099
      *----------------------------------------------------------------*37740099
                                                                        37750099
       6230-CLOSE-NRTL-CURSOR.                                          37760099
           EXEC SQL                                                     37770099
               CLOSE NRTL-ITEM-CSR                                      37780099
           END-EXEC                                                     37790099
      *                                                                 37800099
           EVALUATE TRUE                                                37810099
               WHEN SQLCODE = ZERO                                      37820099
                   CONTINUE                                             37830099
               WHEN OTHER                                               37840099
                   MOVE '6230-CLOSE-NRTL-CURSOR'                        37870099
                                     TO DP013-PARAGRAPH                 37880099
                   MOVE 'CLOSE TRANSFER ITEM CURSOR '                   37890099
                                     TO DP013-MESSAGE-TEXT (1)          37900099
                   MOVE SQLCA        TO DP013-SQLCA                     37910099
                   MOVE 'TTFITEM '   TO DP013-DB2-TABLE-NAME (1)        37920099
                   IF SQLCODE = -904 OR -911 OR -913                    11450000
                           SET PS-CONTENTION TO TRUE                    11730002
                   END-IF                                                       
                   SET PS-ERROR         TO TRUE                         11520002
                   MOVE 'ERROR CLOSING THE NON-RETAIL ITEM CURSOR'      11530002
                                        TO PV-ERROR-MSG                 11540002
                   PERFORM 9000-RETURN-MSG                              11580002
                   MOVE PV-DISPLAY-KEYS TO DP013-MESSAGE-TEXT (2)       11590002
                   MOVE SQLCA           TO DP013-SQLCA                  11630002
                   SET DP013-LINK-RETURN                                11640002
                       DP013-DB2-ABEND                                  11650002
                       DP013-NO-ROLLBACK TO TRUE                        11660002
                   PERFORM DP014-0000-PROCESS-ABEND                     11670002
           END-EVALUATE.                                                37960099
                                                                        37970099
       EJECT                                                            37980099
      *----------------------------------------------------------------*37990099
      *    FETCH THE TRANSFER ITEM CURSOR. (NON-RETAIL)                *38000099
      *----------------------------------------------------------------*38010099
                                                                        38020099
       6240-FETCH-NRTL-ITEMS.                                           38030099
                                                                        38040099
           EXEC SQL                                                     38050099
               FETCH NRTL-ITEM-CSR                                      38060099
               INTO                                                     38070099
                      :TFITEM-XFER-LNE-NBR                              38080099
                    , :TFITEM-NRTL-1ST-LNE-DESC                         38090099
                    , :TFITEM-NRTL-2ND-LNE-DESC                         38100099
                    , :TFITEM-NRTL-FIXT-ID                              38110099
                    , :TFITEM-NRTL-DEPT-NBR                             38120099
                    , :TFITEM-XFER-QTY                                  38130099
           END-EXEC                                                     38140099
                                                                        38150099
           EVALUATE TRUE                                                38160099
               WHEN SQLCODE = ZERO                                      38170099
                    CONTINUE                                            38180099
               WHEN SQLCODE = +100                                      38190099
                    SET PS-NO-ITEMS-LEFT-ON-DB                          38200099
                                         TO TRUE                        38210099
               WHEN OTHER                                               38220099
                   MOVE '6240-FETCH-NRTL-ITEMS'                         38240099
                                     TO DP013-PARAGRAPH                 38250099
                   MOVE 'FETCH NON-RETAIL TRANSFER ITEM CURSOR'         38260099
                                     TO DP013-MESSAGE-TEXT (1)          38270099
                   MOVE 'TTFITEM '  TO DP013-DB2-TABLE-NAME (1)         38280099
                   IF SQLCODE = -904 OR -911 OR -913                    11450000
                           SET PS-CONTENTION TO TRUE                    11730002
                   END-IF                                                       
                   SET PS-ERROR         TO TRUE                         11520002
                   MOVE 'ERROR READING THE NON-RETAIL ITEM CURSOR'      11530002
                                        TO PV-ERROR-MSG                 11540002
                   PERFORM 9000-RETURN-MSG                              11580002
                   MOVE PV-DISPLAY-KEYS TO DP013-MESSAGE-TEXT (2)       11590002
                   MOVE SQLCA           TO DP013-SQLCA                  11630002
                   SET DP013-LINK-RETURN                                11640002
                       DP013-DB2-ABEND                                  11650002
                       DP013-NO-ROLLBACK TO TRUE                        11660002
                   PERFORM DP014-0000-PROCESS-ABEND                     11670002
           END-EVALUATE.                                                38330099
                                                                        38340099
       EJECT                                                            38340199
      *----------------------------------------------------------------*38340299
      * PRODUCE THE LIST REPORT USING THE DRS FACILITY.                *38340399
      *----------------------------------------------------------------*38340499
       6500-PRINT-LIST.                                                 38340599
                                                                        38340699
           PERFORM 6510-INITIALIZE.                                     38340799
           MOVE PC-PUT                 TO DRS01-DRRB-FUNC.              38340899
           IF PH-XFER-TYPE NOT = PC-NON-RETAIL                          38340999
               PERFORM 6520-PRINT-RTL-REPORT                            38341099
                 VARYING PV-BLOCK                                       38341199
                   FROM 1 BY 1 UNTIL                                    38341299
                         PV-BLOCK > PC-MAX-BLOCKS-IN-ARRAY              38341399
                 AFTER PV-ITEM                                          38341499
                   FROM 1 BY 1                                          38341599
                   UNTIL PV-ITEM >  PC-ITEMS-PER-RTL-PANEL              38341699
           ELSE                                                         38341899
               PERFORM 6530-PRINT-NRTL-REPORT                           38341999
                 VARYING PV-BLOCK                                       38342099
                   FROM 1 BY 1 UNTIL                                    38342199
                         PV-BLOCK > PC-MAX-BLOCKS-IN-ARRAY              38342299
                 AFTER PV-ITEM                                          38342399
                   FROM 1 BY 1                                          38342499
                   UNTIL PV-ITEM >  PC-ITEMS-PER-NRTL-PANEL             38342599
           END-IF.                                                      38342799
                                                                        38342899
           MOVE PC-TERM                TO DRS01-DRRB-FUNC.              38342999
           PERFORM 8000-LINK-TO-DRS.                                    38343099
                                                                        38343199
      *----------------------------------------------------------------*38343299
      * INITIALIZE VARIABLES FOR DRS PRINTING.                         *38343399
      *----------------------------------------------------------------*38343499
       6510-INITIALIZE.                                                 38343599
           PERFORM 8100-FORMAT-TIME.                                    38343699
                                                                        38343799
           MOVE PC-CURRENT-PROGRAM-NAME TO DP132O-PROGRAM-NAME.         38345499
           MOVE 1                       TO DP132O-REPORT-NUMBER.        38345599
           MOVE PH-CONTROL-NBR          TO HL3-CONTROL-NBR.             38345699
           MOVE PH-TO-STORE-NBR         TO HL3-TO-STORE-NBR.            38345799
           MOVE PH-TO-STORE-NAM         TO HL3-TO-STORE-NAM.            38345899
           MOVE PH-XFER-TYPE            TO HL4-XFER-TYPE.               38345999
           MOVE PH-XFER-DESC            TO HL4-XFER-DESC.               38346099
           MOVE PH-CONTNR-TYPE          TO HL4-CONTNR-TYPE.             38346199
           MOVE PH-CONTNR-DESC          TO HL4-CONTNR-DESC.             38346299
           MOVE PH-COMP-BY-INT          TO HL5-COMP-BY-INT.             38346399
           MOVE PH-COMP-BY-NAM          TO HL5-COMP-BY-NAM.             38346499
           EVALUATE PH-XFER-TYPE                                        38346599
              WHEN PC-CALLBACK                                          38346699
                 MOVE PC-CALLBACK-LITERAL                               38346799
                                        TO HL5-LITERAL                  38346899
                 MOVE PH-CALLBACK-NBR   TO HL5-FIELD                    38346999
              WHEN PC-STOCK-BAL-CORP                                    38347099
                 MOVE PC-APPROVAL-LITERAL                               38347199
                                        TO HL5-LITERAL                  38347299
                 MOVE PH-APPROVAL-NBR   TO HL5-FIELD                    38347399
              WHEN PC-NON-RETAIL                                        38347499
                 MOVE PC-REQUESTOR-LITERAL                              38347599
                                        TO HL5-LITERAL                  38347699
                 MOVE PH-REQ-BY-INT     TO PV-INT                       38347799
                 MOVE PH-REQ-BY-NAM     TO PV-LAST-NAME                 38347899
                 MOVE PV-NAME           TO HL5-FIELD                    38347999
                 MOVE PH-ATTN-TO-INT    TO HL6A-ATTN-TO-INT             38348099
                 MOVE PH-ATTN-TO-NAM    TO HL6A-ATTN-TO-NAM             38348199
              WHEN PC-CUSTOMER                                          38348299
                 MOVE PC-REQUESTOR-LITERAL                              38348399
                                        TO HL5-LITERAL                  38348499
                 MOVE PH-REQ-BY-INT     TO PV-INT                       38348599
                 MOVE PH-REQ-BY-NAM     TO PV-LAST-NAME                 38348699
                 MOVE PV-NAME           TO HL5-FIELD                    38348799
                 MOVE PH-CUST-NAME      TO HL6B-CUST-NAME               38348899
                 MOVE PH-PHONE-AREA     TO HL6B-PHONE-AREA              38348999
                 MOVE PH-PHONE-EXCH     TO HL6B-PHONE-EXCH              38349099
                 MOVE PH-PHONE-NBR      TO HL6B-PHONE-NBR               38349199
                 MOVE PH-ADDR1          TO HL7-ADDRESS                  38349299
                 MOVE PH-CITY           TO HL7-CITY                     38349399
                 MOVE PH-ADDR2          TO HL8-ADDRESS                  38349499
                 MOVE PH-STATE          TO HL8-STATE                    38349599
                 MOVE PH-ZIP            TO HL8-ZIP                      38349699
                 IF PH-ZIP-EXT > SPACES                                 38349799
                     MOVE PH-ZIP-EXT    TO HL8-ZIP-EXT                  38349899
                     MOVE '-'           TO HL8-DASH                     38349999
                 END-IF                                                 38350099
           END-EVALUATE.                                                38350199
           EVALUATE PH-CONTNR-TYPE                                      38350299
              WHEN PC-TRAILER                                           38350399
                 MOVE PC-TRLR-SEAL-LITERAL                              38350499
                                        TO HL9-LITERAL-1                38350599
                 MOVE PH-TRAILER-SEAL   TO HL9-FIELD-1                  38350699
                 MOVE PC-TRLR-NBR-LITERAL                               38350999
                                        TO HL9-LITERAL-2                38351099
                 MOVE PH-TRAILER-NBR    TO HL9-FIELD-2                  38351199
              WHEN OTHER                                                38351299
                 MOVE PC-LG-TOTE-LITERAL                                38351399
                                        TO HL9-LITERAL-1                38351499
                 MOVE PH-LG-TOTE-SEAL1 TO PV-LG-TOTE-SEAL1              38351599
                 MOVE PH-LG-TOTE-SEAL2 TO PV-LG-TOTE-SEAL2              38351699
                 MOVE PV-LG-TOTE-FIELD  TO HL9-FIELD-1                  38351799
                 MOVE PC-SM-TOTE-LITERAL                                38351899
                                        TO HL9-LITERAL-2                38351999
                 MOVE PH-SM-TOTE-SEAL   TO HL9-FIELD-2                  38352099
           END-EVALUATE.                                                38352199
                                                                        38352299
           MOVE 99                      TO PV-LINE-COUNT.               38352399
           MOVE 0                       TO PV-PAGE-COUNT.               38352499
       EJECT                                                            38352599
      *----------------------------------------------------------------*38352699
      * MOVE THE APPROPRIATE FIELDS TO THE DETAIL LINE AND PRINT.      *38352799
      *  RETAIL TRANSFER TYPES.                                        *38352899
      *----------------------------------------------------------------*38352999
       6520-PRINT-RTL-REPORT.                                           38353099
           IF PV-LINE-COUNT > PC-LINE-MAX                               38353199
               PERFORM 8200-PRINT-HEADINGS                              38353299
           END-IF.                                                      38353399
           IF PV-BLOCK = +2                                             38353499
               COMPUTE PV-LINE-NBR = PV-ITEM + PC-ITEMS-PER-RTL-PANEL   38353599
           ELSE                                                         38353699
               MOVE PV-ITEM              TO PV-LINE-NBR                 38353799
           END-IF.                                                      38353899
           DIVIDE PV-ITEM BY +2                                         38353999
               GIVING PV-SUB                                            38354099
                 REMAINDER PV-REMAINDER.                                38354199
           IF  PV-REMAINDER > ZERO                                      38354299
               MOVE PV-LINE-NBR          TO DL1A-LIN1                   38354399
               MOVE PH-ENT-DEPT (PV-BLOCK PV-ITEM) TO DL1A-DEPT-1               
               IF PH-ENT-CLASS (PV-BLOCK PV-ITEM) < PC-100 AND                  
                  PH-ENT-SUBCLASS (PV-BLOCK PV-ITEM) < PC-100                   
                   MOVE PH-ENT-CLASS (PV-BLOCK PV-ITEM)                         
                                          TO DL1A-CLASS-1                       
                   MOVE PH-ENT-SUBCLASS (PV-BLOCK PV-ITEM)                      
                                          TO DL1A-SUBCLASS-1                    
               ELSE IF                                                          
                  PH-ENT-CLASS (PV-BLOCK PV-ITEM) < PC-100 AND                  
                  PH-ENT-SUBCLASS (PV-BLOCK PV-ITEM) > PC-099                   
                   MOVE PH-ENT-CLASS (PV-BLOCK PV-ITEM)                         
                                          TO DL1A-CLASS-2                       
                   MOVE PH-ENT-SUBCLASS (PV-BLOCK PV-ITEM)                      
                                          TO DL1A-SUBCLASS-2                    
                   MOVE SPACES TO DL1A-FILLER-2A                                
                                  DL1A-FILLER-2B                                
               ELSE IF                                                          
                  PH-ENT-CLASS (PV-BLOCK PV-ITEM) > PC-099 AND                  
                  PH-ENT-SUBCLASS (PV-BLOCK PV-ITEM) < PC-100                   
                   MOVE PH-ENT-CLASS (PV-BLOCK PV-ITEM)                         
                                          TO DL1A-CLASS-3                       
                   MOVE PH-ENT-SUBCLASS (PV-BLOCK PV-ITEM)                      
                                          TO DL1A-SUBCLASS-3                    
                   MOVE SPACES TO DL1A-FILLER-3A                                
                                  DL1A-FILLER-3B                                
               ELSE IF                                                          
                  PH-ENT-CLASS (PV-BLOCK PV-ITEM) > PC-099 AND                  
                  PH-ENT-SUBCLASS (PV-BLOCK PV-ITEM) > PC-099                   
                   MOVE PH-ENT-CLASS (PV-BLOCK PV-ITEM)                         
                                          TO DL1A-CLASS-4                       
                   MOVE PH-ENT-SUBCLASS (PV-BLOCK PV-ITEM)                      
                                          TO DL1A-SUBCLASS-4                    
                   MOVE SPACES TO DL1A-FILLER-4A                                
               END-IF                                                           
               END-IF                                                           
               END-IF                                                           
               END-IF                                                           
               MOVE PH-UPC (PV-BLOCK PV-ITEM)                           38354699
                                         TO DL1A-UPC1                   38354799
               IF PH-PRICE (PV-BLOCK PV-ITEM) > SPACES                  38354899
                   MOVE PH-PRICE-N (PV-BLOCK PV-ITEM)                   38354999
                                         TO DL1A-PRC1                   38355099
               END-IF                                                   38355199
               MOVE PH-RTL-QTY-N (PV-BLOCK PV-ITEM)                     38355299
                                         TO DL1A-QTY1                   38355399
           ELSE                                                         38355499
               MOVE PV-LINE-NBR          TO DL1A-LIN2                   38355599
               MOVE PH-ENT-DEPT (PV-BLOCK PV-ITEM) TO DL1A-DEPT-2               
               IF PH-ENT-CLASS (PV-BLOCK PV-ITEM) < PC-100 AND                  
                  PH-ENT-SUBCLASS (PV-BLOCK PV-ITEM) < PC-100                   
                   MOVE PH-ENT-CLASS (PV-BLOCK PV-ITEM)                         
                                          TO DL1A-CLASS-5                       
                   MOVE PH-ENT-SUBCLASS (PV-BLOCK PV-ITEM)                      
                                          TO DL1A-SUBCLASS-5                    
               ELSE IF                                                          
                  PH-ENT-CLASS (PV-BLOCK PV-ITEM) < PC-100 AND                  
                  PH-ENT-SUBCLASS (PV-BLOCK PV-ITEM) > PC-099                   
                   MOVE PH-ENT-CLASS (PV-BLOCK PV-ITEM)                         
                                          TO DL1A-CLASS-6                       
                   MOVE PH-ENT-SUBCLASS (PV-BLOCK PV-ITEM)                      
                                          TO DL1A-SUBCLASS-6                    
                   MOVE SPACES TO DL1A-FILLER-6A                                
                                  DL1A-FILLER-6B                                
               ELSE IF                                                          
                  PH-ENT-CLASS (PV-BLOCK PV-ITEM) > PC-099 AND                  
                  PH-ENT-SUBCLASS (PV-BLOCK PV-ITEM) < PC-100                   
                   MOVE PH-ENT-CLASS (PV-BLOCK PV-ITEM)                         
                                          TO DL1A-CLASS-7                       
                   MOVE PH-ENT-SUBCLASS (PV-BLOCK PV-ITEM)                      
                                          TO DL1A-SUBCLASS-7                    
                   MOVE SPACES TO DL1A-FILLER-7A                                
                                  DL1A-FILLER-7B                                
               ELSE IF                                                          
                  PH-ENT-CLASS (PV-BLOCK PV-ITEM) > PC-099 AND                  
                  PH-ENT-SUBCLASS (PV-BLOCK PV-ITEM) > PC-099                   
                   MOVE PH-ENT-CLASS (PV-BLOCK PV-ITEM)                         
                                          TO DL1A-CLASS-8                       
                   MOVE PH-ENT-SUBCLASS (PV-BLOCK PV-ITEM)                      
                                          TO DL1A-SUBCLASS-8                    
                   MOVE SPACES TO DL1A-FILLER-8A                                
               END-IF                                                           
               END-IF                                                           
               END-IF                                                           
               END-IF                                                           
               MOVE PH-UPC (PV-BLOCK PV-ITEM)                           38355899
                                         TO DL1A-UPC2                   38355999
               IF PH-PRICE (PV-BLOCK PV-ITEM) > SPACES                  38356099
                   MOVE PH-PRICE-N (PV-BLOCK PV-ITEM)                   38356199
                                         TO DL1A-PRC2                   38356299
               END-IF                                                   38356399
               MOVE PH-RTL-QTY-N (PV-BLOCK PV-ITEM)                     38356499
                                         TO DL1A-QTY2                   38356599
               MOVE DL1A-DETAIL-LINE-1A                                 38356699
                                         TO DRS01-COMM-DATA             38356799
               MOVE PC-SINGLE-SPACE      TO DRS01-COMM-CTL              38356899
               PERFORM 8000-LINK-TO-DRS                                 38356999
               ADD 1                     TO PV-LINE-COUNT               38357099
               MOVE SPACES               TO DL1A-DETAIL-LINE-1A         38357199
           END-IF                                                       38357299
           IF PV-BLOCK = +2 AND                                         38357399
              PV-ITEM  = +1                                             38357499
               MOVE BL-BLANK-LINE        TO DRS01-COMM-DATA             38357599
               MOVE PC-SINGLE-SPACE      TO DRS01-COMM-CTL              38357699
               PERFORM 8000-LINK-TO-DRS                                 38357799
               ADD 1                   TO PV-LINE-COUNT                 38357899
           END-IF.                                                      38357999
       EJECT                                                            38358099
      *----------------------------------------------------------------*38358199
      * MOVE THE APPROPRIATE FIELDS TO THE DETAIL LINE AND PRINT.      *38358299
      *  RETAIL TRANSFER TYPES.                                        *38358399
      *----------------------------------------------------------------*38358499
       6530-PRINT-NRTL-REPORT.                                          38358599
           IF PV-LINE-COUNT > PC-LINE-MAX                               38358699
               PERFORM 8200-PRINT-HEADINGS                              38358799
           END-IF.                                                      38358899
           IF PV-BLOCK = +2 AND                                         38358999
              PV-ITEM  = +1                                             38359099
               MOVE BL-BLANK-LINE        TO DRS01-COMM-DATA             38359199
               MOVE PC-SINGLE-SPACE    TO DRS01-COMM-CTL                38359299
               PERFORM 8000-LINK-TO-DRS                                 38359399
               ADD 1                   TO PV-LINE-COUNT                 38359499
           END-IF.                                                      38359599
           IF PV-BLOCK = +2                                             38359699
               COMPUTE PV-LINE-NBR = PV-ITEM + PC-ITEMS-PER-NRTL-PANEL  38359799
           ELSE                                                         38359899
               MOVE PV-ITEM              TO PV-LINE-NBR                 38359999
           END-IF.                                                      38360099
           MOVE PV-LINE-NBR              TO DL1B-LINE                   38360199
           MOVE PH-ITEM-DESC (PV-BLOCK PV-ITEM)                         38360299
                                         TO DL1B-DESCRIPTION            38360399
           MOVE PH-NRTL-QTY-N (PV-BLOCK PV-ITEM)                        38360499
                                         TO DL1B-QTY                    38360599
           MOVE PH-FIXTURE (PV-BLOCK PV-ITEM)                           38360699
                                         TO DL1B-FIXTURE                38360799
           MOVE PH-NRTL-DEPT (PV-BLOCK PV-ITEM)                         38360899
                                         TO DL1B-DEPT                   38360999
           MOVE DL1B-DETAIL-LINE-1B                                     38361099
                                         TO DRS01-COMM-DATA             38361199
           MOVE PC-SINGLE-SPACE        TO DRS01-COMM-CTL.               38361299
           PERFORM 8000-LINK-TO-DRS.                                    38361399
           ADD 1                       TO PV-LINE-COUNT.                38361499
       EJECT                                                            38362099
      ******************************************************************17152802
      * THIS MODULE EXECUTES A LINK TO DRS (DYNAMIC REPORT SYSTEM).     17152902
      ******************************************************************17153002
       8000-LINK-TO-DRS.                                                17154002
                                                                        17155002
           EXEC CICS                                                    17156002
               LINK                                                     17157002
                   PROGRAM   ('DRS1INTC')                               17158002
                   COMMAREA  (DRS01-COMMAREA)                           17159002
           END-EXEC.                                                    17160002
                                                                        17170002
      ******************************************************************17180002
      * FORMAT THE REPORT HEADING DATE AND TIME FIELDS.                 17190002
      ******************************************************************17200002
       8100-FORMAT-TIME.                                                17210002
                                                                        17220002
           EXEC CICS                                                    17230002
               ASKTIME ABSTIME (PV-ABSTIME)                             17240002
           END-EXEC.                                                    17250002
                                                                        17260002
           EXEC CICS                                                    17270002
               FORMATTIME ABSTIME  (PV-ABSTIME)                         17280002
                          MMDDYY   (DP132O-RUN-DATE)                    17290002
                          DATESEP  ('/')                                17300002
                          TIME     (DP132O-RUN-TIME)                    17310002
                          TIMESEP  (':')                                17320002
           END-EXEC.                                                    17330002
                                                                        17340002
       EJECT                                                            17350002
      *----------------------------------------------------------------*40573499
      *  PRINT THE REPORT HEADING LINES.                                40573599
      *----------------------------------------------------------------*40573699
       8200-PRINT-HEADINGS.                                             40573799
           ADD 1                       TO PV-PAGE-COUNT.                40573899
           MOVE 11                     TO PV-LINE-COUNT.                40573999
           MOVE PV-PAGE-COUNT          TO DP132O-PAGE-NUMBER.           40574099
           MOVE DP132O-STANDRD-HEADER-132-COLS                          40574199
                                       TO DRS01-COMM-DATA.              40574299
           MOVE PC-TOP-OF-PAGE         TO DRS01-COMM-CTL.               40574399
           PERFORM 8000-LINK-TO-DRS.                                    40574499
                                                                        40574599
           MOVE HL2-HEADING-LINE-2     TO DRS01-COMM-DATA.              40574699
           MOVE PC-SINGLE-SPACE        TO DRS01-COMM-CTL.               40574799
           PERFORM 8000-LINK-TO-DRS.                                    40574899
                                                                        40574999
           MOVE HL3-HEADING-LINE-3     TO DRS01-COMM-DATA.              40575099
           MOVE PC-DOUBLE-SPACE        TO DRS01-COMM-CTL.               40575199
           PERFORM 8000-LINK-TO-DRS.                                    40575299
                                                                        40575399
           MOVE HL4-HEADING-LINE-4     TO DRS01-COMM-DATA.              40575499
           MOVE PC-SINGLE-SPACE        TO DRS01-COMM-CTL.               40575599
           PERFORM 8000-LINK-TO-DRS.                                    40575699
                                                                        40575799
           MOVE HL5-HEADING-LINE-5     TO DRS01-COMM-DATA.              40575899
           MOVE PC-SINGLE-SPACE        TO DRS01-COMM-CTL.               40575999
           PERFORM 8000-LINK-TO-DRS.                                    40576099
                                                                        40576199
           EVALUATE PH-XFER-TYPE                                        40576299
               WHEN PC-NON-RETAIL                                       40576399
                   MOVE HL6A-HEADING-LINE-6A                            40576499
                                       TO DRS01-COMM-DATA               40576599
                   MOVE PC-SINGLE-SPACE                                 40576699
                                       TO DRS01-COMM-CTL                40576799
                   PERFORM 8000-LINK-TO-DRS                             40576899
                   ADD 1               TO PV-LINE-COUNT                 40576999
               WHEN PC-CUSTOMER                                         40577099
                   MOVE HL6B-HEADING-LINE-6B                            40577199
                                       TO DRS01-COMM-DATA               40577299
                   MOVE PC-SINGLE-SPACE                                 40577399
                                       TO DRS01-COMM-CTL                40577499
                   PERFORM 8000-LINK-TO-DRS                             40577599
                   MOVE HL7-HEADING-LINE-7                              40577699
                                       TO DRS01-COMM-DATA               40577799
                   MOVE PC-SINGLE-SPACE                                 40577899
                                       TO DRS01-COMM-CTL                40577999
                   PERFORM 8000-LINK-TO-DRS                             40578099
                   MOVE HL8-HEADING-LINE-8                              40578199
                                       TO DRS01-COMM-DATA               40578299
                   MOVE PC-SINGLE-SPACE                                 40578399
                                       TO DRS01-COMM-CTL                40578499
                   PERFORM 8000-LINK-TO-DRS                             40578599
                   ADD 3               TO PV-LINE-COUNT                 40578699
           END-EVALUATE.                                                40578799
                                                                        40578899
           MOVE HL9-HEADING-LINE-9     TO DRS01-COMM-DATA.              40578999
           MOVE PC-DOUBLE-SPACE        TO DRS01-COMM-CTL.               40579099
           PERFORM 8000-LINK-TO-DRS.                                    40579199
                                                                        40579299
           EVALUATE TRUE                                                40579999
               WHEN PH-RETAIL-XFER                                      40580099
                   MOVE HL10A-HEADING-LINE-10A                          40580199
                                       TO DRS01-COMM-DATA               40580299
                   MOVE PC-DOUBLE-SPACE                                 40580399
                                       TO DRS01-COMM-CTL                40580499
                   PERFORM 8000-LINK-TO-DRS                             40580599
               WHEN OTHER                                               40580699
                   MOVE HL10B-HEADING-LINE-10B                          40580799
                                       TO DRS01-COMM-DATA               40580899
                   MOVE PC-DOUBLE-SPACE                                 40580999
                                       TO DRS01-COMM-CTL                40581099
                   PERFORM 8000-LINK-TO-DRS                             40581199
           END-EVALUATE.                                                40581299
                                                                        40581399
           MOVE BL-BLANK-LINE          TO DRS01-COMM-DATA.              40581499
           MOVE PC-SINGLE-SPACE        TO DRS01-COMM-CTL.               40581599
           PERFORM 8000-LINK-TO-DRS.                                    40581699
       EJECT                                                            40581799
      *----------------------------------------------------------------*26350072
      * BUILD A CICS ERROR MESSAGE WITH DATA FROM THE PASSED COMMAREA.  26360011
      *----------------------------------------------------------------*26370072
       9000-RETURN-MSG.                                                 26380013
                                                                        26390013
           MOVE PH-CONTROL-NBR      TO PV-DISPLAY-XFER-DKEY-ID.         26420013
           MOVE PH-FR-STORE-NBR     TO PV-DISPLAY-FROM-STORE-NBR.       26580072
           MOVE TF001-PRINTER-DEST  TO PV-DISPLAY-PRINTER-DEST.         26440013
                                                                        26450013
           EJECT                                                        26460013
                                                                        26470013
      *----------------------------------------------------------------*26480072
      * PRINT AN ERROR REPORT INDICATING THE REASON FOR THE PROGRAM     26490011
      * TERMINATION.                                                    26500011
      *----------------------------------------------------------------*26510072
       9000-PRINT-ERROR.                                                26520072
                                                                        26530013
           MOVE EH1-ERROR-HEADING-1        TO  DRS01-COMM-DATA.         26540013
           MOVE PC-TOP-OF-PAGE             TO  DRS01-COMM-CTL.          26550013
           PERFORM 8000-LINK-TO-DRS.                                    26560013
                                                                        26570013
           MOVE PH-CONTROL-NBR             TO EH2-CONTROL-NBR.          26580072
           MOVE PH-FR-STORE-NBR            TO EH2-FROM-STORE-NBR.       26580072
           MOVE EH2-ERROR-HEADING-2        TO  DRS01-COMM-DATA.         26640013
           MOVE PC-TRIPLE-SPACE            TO  DRS01-COMM-CTL.          26650013
           PERFORM 8000-LINK-TO-DRS.                                    26660013
                                                                        26670013
           MOVE PV-ERROR-MSG               TO ED1-ERROR.                26680072
           MOVE PV-ERROR-KEY               TO ED1-ERROR-KEY.            26690072
           MOVE ED1-ERROR-DETAIL-1         TO  DRS01-COMM-DATA.         26700013
           MOVE PC-TRIPLE-SPACE            TO  DRS01-COMM-CTL.          26710013
           PERFORM 8000-LINK-TO-DRS.                                    26720013
                                                                        26730013
           IF PS-CONTENTION                                             26740072
               MOVE PC-CONTENTION-MSG      TO ED2-MESSAGE               26750072
               MOVE ED2-ERROR-DETAIL-2     TO  DRS01-COMM-DATA          26760013
               MOVE PC-TRIPLE-SPACE        TO  DRS01-COMM-CTL           26770013
               PERFORM 8000-LINK-TO-DRS                                 26780013
           END-IF.                                                      26790072
      *                                                                 26800072
      *    NON-CICS ARCHITECTURE SYSTEM MESSAGE FORMAT MODULE           26810072
      *                                                                 26820072
      *                                                                 26830072
      *    COPY DPPD011.                                                26840072
      *                                                                 26850072
      *    NON-CICS ARCHITECTURE ABEND ROUTINE CALL                     26860072
      *                                                                 26870072
                                                                        26880072
           COPY DPPD014.                                                26890072
