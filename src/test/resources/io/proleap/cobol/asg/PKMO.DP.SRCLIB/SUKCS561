000100*-----------------------*                                         00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300*-----------------------*                                         00030000
000400 PROGRAM-ID.    SUKCS561.                                         00040000
000500 AUTHOR.        DEANNA BRANTNER.                                  00050000
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060000
000700 DATE-WRITTEN.  JULY, 2001.                                       00070000
000800 DATE-COMPILED.                                                   00080000
000900*---------------------------------------------------------------* 00090000
001000*    S561 - SHIPPING DOOR STATUS  - OUTBOUND TRIP CARTON LIST   * 00100000
001100*---------------------------------------------------------------* 00110000
001110* CHANGED 11/15/2021    BY JIM HUNTER      WR: CHG0263968         00111019
001120* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00112020
001130* MAKING THE CALL DYNAMIC VS STATIC.                              00113020
001130*                                                                 00113121
001110* CHANGED 01/09/2023    BY JEAN KURK       WR: CHG0278099         00113221
001120* CHANGE CALL OF DPKCS030 TO BE DYNAMIC                           00113321
001140*---------------------------------------------------------------* 00114020
001200 ENVIRONMENT DIVISION.                                            00120000
001300 DATA DIVISION.                                                   00130000
001400                                                                  00140000
001500 WORKING-STORAGE SECTION.                                         00150000
001600 01  DK-DB2-KEYS.                                                 00160000
001700     05  DK-CASE                        PIC  X(01)  VALUE SPACES. 00170000
001800     05  DK-START-TMST                  PIC  X(26)  VALUE SPACES. 00180000
001900     05  DK-END-TMST                    PIC  X(26)  VALUE SPACES. 00190000
002000     05  DK-PC-DEFAULT-TMST             PIC  X(26) VALUE          00200000
002100                                     '9999-09-09-09.09.09.999999'.00210000
002200     05  PC-EMPTY-TIMESTAMP             PIC  X(26) VALUE          00220000
002300                                     '    -  -  -  .  .  .      '.00230000
002400     05  DK-OPER-UNT-ID                 PIC S9(04)  VALUE ZERO    00240000
002500                                                   COMP.          00250000
002600     05  DK-STORE-NUMBER                PIC S9(04)  VALUE ZERO    00260000
002700                                                   COMP.          00270000
002800     05  DK-TRIP-ID                     PIC S9(09) COMP.          00280000
002900     05  DK-DOOR-ID                     PIC  X(04) VALUE SPACES.  00290000
003000     05  DK-TRLR-SRL-NBR                PIC S9(09) COMP.          00300000
003100     05  DK-SML-NBR                     PIC S9(18)V COMP-3.       00310000
003200     05  DK-SHIPT-UNT-ID                PIC S9(18)V COMP-3.       00320000
003300     05  DK-BARCODE                     PIC  X(22) VALUE SPACES.  00330000
003400     05  DK-BARCODE-R REDEFINES DK-BARCODE.                       00340000
003500         10  DK-BARCODE-1-2             PIC  9(02).               00350000
003600         10  DK-BARCODE-3-20            PIC  9(18).               00360000
003700         10  DK-BARCODE-21-22           PIC  X(02).               00370000
003800     05  DK-BARCODE-N                   PIC  9(18) VALUE ZEROES.  00380000
003900     05  DK-CRTN-STAT-DESC.                                       00390000
004000         10  DK-INVALID-DESC            PIC X(7) VALUE 'INVALID'. 00400000
004100         10  DK-INACT-DESC              PIC X(7) VALUE 'INACTIV'. 00410000
004200         10  DK-SC-OF-DESC              PIC X(7) VALUE 'SCD OFF'. 00420000
004300         10  DK-SC-ON-DESC              PIC X(7) VALUE 'SCND ON'. 00430000
004400         10  DK-DVRT-DESC               PIC X(7) VALUE 'DIVERTD'. 00440000
004500         10  DK-LOADED-DESC             PIC X(7) VALUE 'LOADED '. 00450000
004600         10  DK-CSEPK-DESC              PIC X(7) VALUE 'CASEPCK'. 00460000
004700         10  DK-CK-IN-DESC              PIC X(7) VALUE 'CHKD-IN'. 00470000
004800         10  DK-P2L-DESC                PIC X(7) VALUE ' P-2-L '. 00480000
004900         10  DK-RDM-DESC                PIC X(7) VALUE 'CRD RDM'. 00490000
005000         10  DK-RECV-DESC               PIC X(7) VALUE 'CRD RCV'. 00500000
005100         10  DK-ASN-DESC                PIC X(7) VALUE 'CRD ASN'. 00510000
005200         10  DK-SMTH-DESC               PIC X(7) VALUE 'CRD SMO'. 00520000
005300         10  DK-XFER-DESC               PIC X(7) VALUE 'CRD XFR'. 00530000
005400         10  DK-MSTR-DESC               PIC X(7) VALUE 'CRD MST'. 00540000
005500         10  DK-BLD-DESC                PIC X(7) VALUE 'CRD BLD'. 00550000
005600         10  DK-JWL-DESC                PIC X(7) VALUE 'JEWELRY'. 00560000
005700         10  DK-DMG-DESC                PIC X(7) VALUE 'DAMAGED'. 00570000
005710         10  DK-3WD-DESC                PIC X(7) VALUE 'CRD 3WD'. 00571020
005800         10  DK-ASSUMED                 PIC X(7) VALUE 'ASSUMED'. 00580000
005900                                                                  00590000
006000 01  PC-PROGRAM-CONSTANTS.                                        00600000
006100     05  PC-CURRENT-MAP-NAME       PIC  X(08)  VALUE 'SU561A  '.  00610000
006200     05  PC-CURRENT-MAPSET-NAME    PIC  X(08)  VALUE 'SUKM561'.   00620000
006300     05  PC-CURRENT-PROGRAM-NAME   PIC  X(08)  VALUE 'SUKCS561'.  00630000
006500     05  PC-LIST-QUEUE-SEQ         PIC  9(01)  VALUE 1.           00650000
006600     05  PC-SEL-QUEUE-SEQ          PIC  9(01)  VALUE 2.           00660000
006700     05  PC-CRIT-SPEC-FORMAT       PIC  X(01)  VALUE '1'.         00670000
006800     05  PC-LIST-FORMAT            PIC  X(01)  VALUE '2'.         00680000
006900     05  PC-ITEMS-PER-PANEL        PIC S9(04)  VALUE +11          00690000
007000                                               COMP SYNC.         00700000
007100     05  PC-MAX-BLOCKS-IN-ARRAY    PIC S9(04)  VALUE +2           00710000
007200                                               COMP SYNC.         00720000
007300     05  PC-MAX-ITEMS              PIC S9(09)  VALUE +1000000     00730000
007400                                               COMP-3.            00740000
007500     05  PC-MSG-NUMBER-LENGTH      PIC S9(04)  VALUE +5           00750000
007600                                               COMP SYNC.         00760000
007700     05  PC-MAX-RETRIES            PIC S9(03)  VALUE 3            00770000
007800                                               COMP-3.            00780000
007900     05  PC-INQ                    PIC  X(03)  VALUE 'INQ'.       00790000
008000     05  PC-UPD                    PIC  X(03)  VALUE 'UPD'.       00800000
008100     05  PC-DEL                    PIC  X(03)  VALUE 'DEL'.       00810000
008200     05  PC-ERR                    PIC  X(03)  VALUE 'ERR'.       00820000
008300     05  PC-SLASH                  PIC  X(01)  VALUE '/'.         00830000
008400     05  PC-ZERO                   PIC S9(04)  VALUE ZEROES       00840000
008500                                               COMP.              00850000
008600     05  PC-01                     PIC  X(02)  VALUE '01'.        00860000
008700     05  PC-PO                     PIC  X(02)  VALUE 'PO'.        00870000
008800     05  PC-SH                     PIC  X(02)  VALUE 'SH'.        00880000
008900     05  PC-D                      PIC  X(01)  VALUE 'D'.         00890000
009000     05  PC-S                      PIC  X(01)  VALUE 'S'.         00900000
009100     05  PC-I                      PIC  X(01)  VALUE 'I'.         00910000
009200     05  PC-SHON                   PIC  X(04)  VALUE 'SHON'.      00920000
009300     05  PC-SHOF                   PIC  X(04)  VALUE 'SHOF'.      00930000
009400*                                                                 00940000
009500*----------------------------------------------------------------*00950000
009600*  SYSTEM MESSAGES                                               *00960000
009700*----------------------------------------------------------------*00970000
009800*   00005 = INVALID VALUE                                        *00980000
009900*   00008 = MUST BE NUMERIC                                      *00990000
010000*   00050 - NO LIST ITEMS WERE FOUND FOR THE CRITERIA SPECIFIED  *01000000
010100*   00051 - NO END OF RANGE HAS BEEN SPECIFIED                   *01010000
010200*   00052 - END OF RANGE PRECEDES START OF RANGE                 *01020000
010300*   00053 - NO START OF RANGE HAS BEEN SPECIFIED                 *01030000
010400*   00054 - ONLY ONE START OF RANGE INDICATOR MAY BE SPECIFIED   *01040000
010500*   00055 - ONLY ONE END OF RANGE INDICATOR MAY BE SPECIFIED     *01050000
010600*   00057 - A LIST ITEM MUST BE SELECTED FOR THIS FUNCTION       *01060000
010700*   00069 - TOP OF LIST                                          *01070000
010800*   00070 - BOTTOM OF LIST                                       *01080000
010900*   00101 - VALUE MUST BE > ZERO AND  < 1,000,000                *01090000
011000*   00551 - WAIT 15 SECONDS;RETRY FUNCTION AGAIN; IF UNSUCCESSFUL*01100000
011100*   00279 - MORE ITEMS TO DISPLAY                                *01110000
011200*   00743 - TRIP DOES NOT EXIST                                  *01120000
011300*   00840 - YOU ARE NOT AUTHORIZED TO VIEW THIS DATA             *01130000
011400*   00984 - DATABASE IS BUSY, TRY AGAIN IN A FEW MINUTES         *01140000
011500*   02227 = APPLICATION UNAVAILABLE AT THIS TIME                 *01150000
011600*   02792 = ENDING CUTOFF ALREADY EXISTS FOR TRLR-BEGIN CUTOFF NE*01160000
011700*   02793 = CARTON IS ALREADY LOADED ONTO A TRAILER.             *01170000
011800*   02796 = END CUTOFF ASSIGNMENT SUCCESSFUL.                    *01180000
011900*   02799 = END CARTON DIVERT TIME MUST BE GREATER THAN BEGIN CAR*01190000
011910*   03387 = MUST BE A MASTER CONTAINER TO PERFORM THIS FUNCTION  *01191014
012000*   99901 = INVALID COMMAND WAS ENTERED                          *01200000
012100*----------------------------------------------------------------*01210000
012200     05  PC-TSYMSG-NUMBERS.                                       01220000
012300         10  PC-TSYMSG-00005            PIC  9(05)  VALUE 00005.  01230000
012400         10  PC-TSYMSG-00008            PIC  9(05)  VALUE 00008.  01240000
012500         10  PC-TSYMSG-00050            PIC  9(05)  VALUE 00050.  01250000
012600         10  PC-TSYMSG-00051            PIC  9(05)  VALUE 00051.  01260000
012700         10  PC-TSYMSG-00052            PIC  9(05)  VALUE 00052.  01270000
012800         10  PC-TSYMSG-00053            PIC  9(05)  VALUE 00053.  01280000
012900         10  PC-TSYMSG-00054            PIC  9(05)  VALUE 00054.  01290000
013000         10  PC-TSYMSG-00055            PIC  9(05)  VALUE 00055.  01300000
013100         10  PC-TSYMSG-00057            PIC  9(05)  VALUE 00057.  01310000
013200         10  PC-TSYMSG-00069            PIC  9(05)  VALUE 00069.  01320000
013300         10  PC-TSYMSG-00070            PIC  9(05)  VALUE 00070.  01330000
013400         10  PC-TSYMSG-00101            PIC  9(05)  VALUE 00101.  01340000
013500         10  PC-TSYMSG-00279            PIC  9(05)  VALUE 00279.  01350000
013600         10  PC-TSYMSG-00551            PIC  9(05)  VALUE 00551.  01360000
013700         10  PC-TSYMSG-00743            PIC  9(05)  VALUE 00743.  01370000
013800         10  PC-TSYMSG-00746            PIC  9(05)  VALUE 00746.  01380000
013900         10  PC-TSYMSG-01563            PIC  9(05)  VALUE 01563.  01390000
014000         10  PC-TSYMSG-00840            PIC  9(05)  VALUE 00840.  01400000
014100         10  PC-TSYMSG-00984            PIC  9(05)  VALUE 00984.  01410000
014200         10  PC-TSYMSG-02227            PIC  9(05)  VALUE 02227.  01420000
014300         10  PC-TSYMSG-02792            PIC  9(05)  VALUE 02792.  01430000
014400         10  PC-TSYMSG-02793            PIC  9(05)  VALUE 02793.  01440000
014500         10  PC-TSYMSG-02796            PIC  9(05)  VALUE 02796.  01450000
014600         10  PC-TSYMSG-02799            PIC  9(05)  VALUE 02799.  01460000
014700         10  PC-TSYMSG-02974            PIC  9(05)  VALUE 02974.  01470000
014800         10  PC-TSYMSG-02975            PIC  9(05)  VALUE 02975.  01480000
014900         10  PC-TSYMSG-02976            PIC  9(05)  VALUE 02976.  01490000
014910         10  PC-TSYMSG-03387            PIC  9(05)  VALUE 03387.  01491014
015000         10  PC-TSYMSG-99901            PIC  9(05)  VALUE 99901.  01500000
015100*                                                                 01510000
015200 01  PS-PROGRAM-SWITCHES.                                         01520000
015300     05  PS-REBUILD-AFTER-UPDATE-SW     PIC  X(01)  VALUE 'N'.    01530000
015400         88  PS-REBUILD-AFTER-UPDATE                VALUE 'Y'.    01540000
015500         88  PS-REBUILD-AFTER-UPDATE-NO             VALUE 'N'.    01550000
015600     05  PS-BLOCK-ERROR-SW              PIC  X(01)  VALUE 'Y'.    01560000
015700         88  PS-NO-BLOCK-ERROR                      VALUE 'Y'.    01570000
015800         88  PS-BLOCK-ERROR                         VALUE 'N'.    01580000
015900     05  PS-ERROR-SW                    PIC  X(01)  VALUE 'Y'.    01590000
016000         88  PS-NO-ERROR                            VALUE 'Y'.    01600000
016100         88  PS-ERROR                               VALUE 'N'.    01610000
016200     05  PS-SOFT-ABORT-ERROR-SW         PIC  X(01)  VALUE 'N'.    01620000
016300         88  PS-SOFT-ABORT-ERROR                    VALUE 'Y'.    01630000
016400         88  PS-NO-SOFT-ABORT-ERROR                 VALUE 'N'.    01640000
016500     05  PS-COMMAREA-SW                 PIC  X(01)  VALUE 'N'.    01650000
016600         88  PS-COMMAREA-VALID                      VALUE 'Y'.    01660000
016700         88  PS-COMMAREA-NOT-VALID                  VALUE 'N'.    01670000
016800     05  PS-DONE-SW                     PIC  X(01)  VALUE 'N'.    01680000
016900         88  PS-DONE                                VALUE 'Y'.    01690000
017000         88  PS-NOT-DONE                            VALUE 'N'.    01700000
017100     05  PS-LIST-END-SW                 PIC  X(01)  VALUE 'N'.    01710000
017200         88  PS-LIST-END                            VALUE 'Y'.    01720000
017300         88  PS-NO-LIST-END                         VALUE 'N'.    01730000
017400     05  PS-ACCESS-SW                   PIC  X(01)  VALUE 'N'.    01740000
017500         88  PS-ACCESS-ALLOWED                      VALUE 'Y'.    01750000
017600         88  PS-ACCESS-NOT-ALLOWED                  VALUE 'N'.    01760000
017700     05  PS-CONTENT-SW                  PIC  X(01)  VALUE ' '.    01770000
017800         88  PS-FOUND-CONTENTS                      VALUE 'Y'.    01780000
017900         88  PS-NO-CONTENTS-FOUND                   VALUE 'N'.    01790000
018000     05  PS-TRIP-OPEN-SW                PIC  X(01)  VALUE ' '.    01800000
018100         88  PS-TRIP-OPEN                           VALUE 'Y'.    01810000
018200         88  PS-TRIP-NOT-OPEN                       VALUE 'N'.    01820000
018300         88  PS-AUDIT-OPEN                          VALUE 'O'.    01830000
018400         88  PS-AUDIT-CLOSED                        VALUE 'C'.    01840000
018500         88  PS-TRLR-CLOSED                         VALUE 'T'.    01850000
018600*                                                                 01860000
018700 01  PV-PROGRAM-VARIABLES.                                        01870000
018800     05  PV-DISPLAY-OPER                PIC 9(04)  VALUE ZEROES.  01880000
018900     05  PV-DISPLAY-TRIP                PIC 9(09)  VALUE ZEROES.  01890000
019000     05  PV-DISPLAY-DOOR                PIC 9(09)  VALUE ZEROES.  01900000
019100     05  PV-DISPLAY-STORE-1             PIC 9(04)  VALUE ZEROES.  01910000
019200     05  PV-DISPLAY-STORE-2             PIC 9(04)  VALUE ZEROES.  01920000
019300     05  PV-DISPLAY-STORE-3             PIC 9(04)  VALUE ZEROES.  01930000
019400     05  PV-DISPLAY-STORE-4             PIC 9(04)  VALUE ZEROES.  01940000
019500     05  PV-DISPLAY-SHIPT               PIC 9(18)  VALUE ZEROES.  01950000
019600                                                                  01960000
019700     05  PV-REC-SEQ                      PIC 9(09)  VALUE ZEROES. 01970000
019800     05  PV-REC-SEQ-R REDEFINES PV-REC-SEQ.                       01980000
019900         10  FILLER                      PIC X(06).               01990000
020000         10  PV-REC-SEQ-7-9              PIC X(03).               02000000
020100     05  PV-RACF-ERROR-CODE              PIC  9(04) VALUE ZEROES. 02010000
020200     05  PV-ORIGINAL-BLOCK               PIC S9(04)  VALUE +0     02020000
020300                                                     COMP SYNC.   02030000
020400     05  PV-ITEMS-HOLD                   PIC S9(03)  COMP-3.      02040000
020500     05  PV-ITEMS-DIFF                   PIC S9(03)  COMP-3.      02050000
020600     05  PV-CICS-RESPONSE               PIC S9(08)  VALUE ZEROES  02060000
020700                                        COMP SYNC.                02070000
020800     05  PV-SUB                         PIC S9(04)  VALUE +0      02080000
020900                                                    COMP SYNC.    02090000
021000     05  PV-REMAINDER                   PIC S9(04)  VALUE +0      02100000
021100                                                    COMP SYNC.    02110000
021200     05  PV-READ-COUNT                  PIC S9(09)  VALUE +0      02120000
021300                                                    COMP-3.       02130000
021400     05  PV-ITEMS-PROCESSED             PIC S9(09)  VALUE +0      02140000
021500                                                    COMP-3.       02150000
021600     05  PV-HOLD-SELECTED-ITEMS         PIC S9(09)  VALUE +0      02160000
021700                                                    COMP-3.       02170000
021800     05  PV-ITEM-IN-USE                 PIC S9(09)  VALUE +0      02180000
021900                                                    COMP-3.       02190000
022000     05  PV-TOP-ITEM                    PIC S9(09)  VALUE +0      02200000
022100                                                    COMP-3.       02210000
022200     05  PV-BOTTOM-ITEM                 PIC S9(09)  VALUE +0      02220000
022300                                                    COMP-3.       02230000
022400     05  PV-TEMP-BLOCK-NUMBER           PIC S9(09)  VALUE +0      02240000
022500                                                    COMP-3.       02250000
022600     05  PV-BLOCK-NUMBER                PIC S9(04)  VALUE +0      02260000
022700                                                    COMP SYNC.    02270000
022800     05  PV-CICS-RESP                   PIC S9(04)  VALUE +0      02280000
022900                                                    COMP SYNC.    02290000
023000     05  PV-ITEM                        PIC S9(04)  VALUE +0      02300000
023100                                                    COMP SYNC.    02310000
023200     05  PV-SEL-QUEUE-ITEM              PIC S9(04)  VALUE +0      02320000
023300                                                    COMP SYNC.    02330000
023400     05  PV-SAVE-ITEM                   PIC S9(04)  VALUE +0      02340000
023500                                                    COMP SYNC.    02350000
023600     05  PV-HIGHEST-BLOCK-WRITTEN       PIC S9(04)  VALUE +0      02360000
023700                                                    COMP SYNC.    02370000
023800     05  PV-LIST-ITEM-NUMBER            PIC S9(04)  VALUE +0      02380000
023900                                                    COMP SYNC.    02390000
024000     05  PV-FIRST-BLOCK-IN-ARRAY        PIC S9(04)  VALUE +0      02400000
024100                                                    COMP SYNC.    02410000
024200     05  PV-NEXT-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      02420000
024300                                                    COMP SYNC.    02430000
024400     05  PV-PREV-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      02440000
024500                                                    COMP SYNC.    02450000
024600     05  PV-FIRST-BLOCK-IN-RANGE        PIC S9(04)  VALUE +0      02460000
024700                                                    COMP SYNC.    02470000
024800     05  PV-LAST-BLOCK-IN-RANGE         PIC S9(04)  VALUE +0      02480000
024900                                                    COMP SYNC.    02490000
025000     05  PV-START-OF-SELECTED-RANGE     PIC S9(04)  VALUE +0      02500000
025100                                                    COMP SYNC.    02510000
025200     05  PV-END-OF-SELECTED-RANGE       PIC S9(04)  VALUE +0      02520000
025300                                                    COMP SYNC.    02530000
025400     05  PV-SQL-SUB                     PIC S9(04)  VALUE +0      02540000
025500                                                    COMP SYNC.    02550000
025600     05  PV-RETRY-COUNTER               PIC S9(04)  VALUE +0      02560000
025700                                                    COMP SYNC.    02570000
025800     05  PV-NULL-IND-1                  PIC S9(04)  VALUE +0      02580000
025900                                                    COMP.         02590000
026000     05  PV-NULL-IND-2                  PIC S9(04)  VALUE +0      02600000
026100                                                    COMP.         02610000
026200     05  PV-NULL-IND-3                  PIC S9(04)  VALUE +0      02620000
026300                                                    COMP.         02630000
026310     05  PV-STORE-SCAN-COUNT            PIC S9(09)  VALUE +0      02631016
026320                                                    COMP.         02632016
026400     05  PV-SOFT-ABORT-MSG.                                       02640000
026500         10  FILLER            PIC X(12) VALUE ' SUKCS561 - '.    02650000
026600         10  FILLER            PIC X(09) VALUE 'SQLCODE: '.       02660000
026700         10  PV-SOFT-SQLCODE   PIC ZZZZZZZZ9-.                    02670000
026800         10  FILLER            PIC X(12) VALUE ' PARAGRAPH: '.    02680000
026900         10  PV-SOFT-PARAGRAPH PIC X(30).                         02690000
027000     05  PV-COMMAREA-LENGTH              PIC S9(04)  VALUE +0     02700000
027100                                                     COMP SYNC.   02710000
027200     05  PV-CICS-MSG-AREA.                                        02720000
027300         10  FILLER                      PIC X(05) VALUE 'TASK='. 02730000
027400         10  PV-CICS-TASK                PIC ZZZZ9.               02740000
027500         10  FILLER                      PIC X(01) VALUE SPACES.  02750000
027600         10  PV-CICS-MSG                 PIC X(68) VALUE SPACES.  02760000
027700                                                                  02770000
027800     05  PV-TMST                 PIC X(26)   VALUE SPACES.        02780000
027900     05  PV-TMST-R REDEFINES  PV-TMST.                            02790000
028000         10   PV-TMST-DATE.                                       02800000
028100             15   PV-TMST-CC            PIC X(02).                02810000
028200             15   PV-TMST-YY            PIC X(02).                02820000
028300             15   FILLER                PIC X(01).                02830000
028400             15   PV-TMST-MM            PIC X(02).                02840000
028500             15   FILLER                PIC X(01).                02850000
028600             15   PV-TMST-DD            PIC X(02).                02860000
028700         10   FILLER                    PIC X(01).                02870000
028800         10   PV-TMST-TIME.                                       02880000
028900             15   PV-TMST-HRS           PIC X(02).                02890000
029000             15   FILLER                PIC X(01).                02900000
029100             15   PV-TMST-MIN           PIC X(02).                02910000
029200         10   FILLER                    PIC X(01).                02920000
029300         10   PV-TMST-SEC               PIC X(02).                02930000
029400         10   FILLER                    PIC X(07).                02940000
029500     05  PV-FROM-TMST.                                            02950000
029600         10   PV-FROM-YY    PIC X(04)  VALUE ZEROES.              02960000
029700         10   FILLER        PIC X(01)  VALUE '-'.                 02970000
029800         10   PV-FROM-MM    PIC X(02)  VALUE ZEROES.              02980000
029900         10   FILLER        PIC X(01)  VALUE '-'.                 02990000
030000         10   PV-FROM-DD    PIC X(02)  VALUE ZEROES.              03000000
030100         10   FILLER        PIC X(16)  VALUE '-00.00.00.000000'.  03010000
030200     05  PV-TO-TMST.                                              03020000
030300         10   PV-TO-YY      PIC X(04)  VALUE ZEROES.              03030000
030400         10   FILLER        PIC X(01)  VALUE '-'.                 03040000
030500         10   PV-TO-MM      PIC X(02)  VALUE ZEROES.              03050000
030600         10   FILLER        PIC X(01)  VALUE '-'.                 03060000
030700         10   PV-TO-DD      PIC X(02)  VALUE ZEROES.              03070000
030800         10   FILLER        PIC X(16)  VALUE '-23.59.59.999999'.  03080000
030900     05  PV-DATE-DISPLAY.                                         03090000
031000         10   PV-DISPLAY-MM             PIC X(02)   VALUE SPACES. 03100000
031100         10   PV-SLASH-1                PIC X(01)   VALUE '-'.    03110000
031200         10   PV-DISPLAY-DD             PIC X(02)   VALUE SPACES. 03120000
031300         10   PV-SLASH-2                PIC X(01)   VALUE '-'.    03130000
031400         10   PV-DISPLAY-YY             PIC X(02)   VALUE SPACES. 03140000
031500     05  PV-TIME-DISPLAY.                                         03150000
031600         10   PV-AT                     PIC X(03)   VALUE SPACES. 03160000
031700         10   PV-DISPLAY-HRS            PIC X(02)   VALUE SPACES. 03170000
031800         10   PV-SEMICOLON-1            PIC X(01)   VALUE SPACES. 03180000
031900         10   PV-DISPLAY-MIN            PIC X(02)   VALUE SPACES. 03190000
032000         10   PV-SEMICOLON-2            PIC X(01)   VALUE SPACES. 03200000
032100         10   PV-DISPLAY-SEC            PIC X(02)   VALUE SPACES. 03210000
032200     05  PV-DATE-TIME.                                            03220000
032300         10   PV-DT-CC             PIC X(02)  VALUE '20'.         03230000
032400         10   PV-DT-YY             PIC X(02)  VALUE ZEROES.       03240000
032500         10   FILLER               PIC X(01)  VALUE '-'.          03250000
032600         10   PV-DT-MM             PIC X(02)  VALUE ZEROES.       03260000
032700         10   FILLER               PIC X(01)  VALUE '-'.          03270000
032800         10   PV-DT-DD             PIC X(02)  VALUE ZEROES.       03280000
032900         10   FILLER               PIC X(01)  VALUE '-'.          03290000
033000         10   PV-DT-HRS            PIC X(02)   VALUE SPACES.      03300000
033100         10   FILLER               PIC X(01)   VALUE '.'.         03310000
033200         10   PV-DT-MIN            PIC X(02)   VALUE SPACES.      03320000
033300         10   FILLER               PIC X(01)   VALUE '.'.         03330000
033400         10   PV-DT-SEC            PIC X(09)   VALUE '59.999999'. 03340000
033500     05  PV-CREATE-DATE                  PIC  X(08) VALUE SPACES. 03350000
033600     05  PV-USA-DATE                     PIC  X(10) VALUE SPACES. 03360000
033700     05  PV-JIS-TIME                     PIC  X(08) VALUE SPACES. 03370000
033800     05  PV-JIS-TIME-R REDEFINES PV-JIS-TIME.                     03380000
033900         10  PV-JIS-HH-MM                PIC  X(05).              03390000
033901         10  FILLER                      PIC  X(03).              03390100
033902     05  PV-SELECT-LIST-SEQ              PIC  X(01) VALUE SPACES. 03390200
033903     05  PV-NBR-ITEMS                    PIC  9(05) VALUE ZEROES. 03390300
034000     05  PV-SEL-TERM-ID                  PIC  X(04).              03400000
034100     05  PV-SEL-TASK-NUMBER              PIC  9(05).              03410000
034200     05  PV-SEL-SEQ                      PIC  9(01).              03420000
034300     05  PV-SHIPT-UNT-ID                 PIC  9(18) VALUE ZERO.   03430000
034400     05  PV-DISP-NBR                     PIC  ZZZZ9.              03440000
034500     05  PV-SAVE-SOURCE-PARA             PIC  X(18).              03450000
034600                                                                  03460000
034700     05  PV-DISP-PO-RCVR.                                         03470000
034800         10  PV-DISP-PO                  PIC Z(7)9.               03480000
034900         10  FILLER                      PIC X(01) VALUE '-'.     03490000
035000         10  PV-DISP-RCVR                PIC X(3).                03500000
035100                                                                  03510000
035200     05  PV-DISP-TRN-NBR.                                         03520000
035300         10  PV-DISP-TRN                 PIC Z(09).               03530000
035400         10  FILLER                      PIC X(03).               03540000
035500                                                                  03550000
035600     05  PV-DISP-PULL-NBR.                                        03560000
035700         10  PV-DISP-PULL                PIC Z(09) VALUE ZEROES.  03570000
035701         10  FILLER                      PIC X(03) VALUE '-CS'.   03570100
035702                                                                  03570200
035703     05  PV-CARTON-MSG.                                           03570300
035704         10  FILLER                   PIC X(01) VALUE SPACE.      03570400
035800         10  FILLER                   PIC X(08) VALUE 'PCKRF881'. 03580000
035900         10  FILLER                   PIC X(01) VALUE '-'.        03590000
036000         10  PV-CTN-PARA              PIC X(04) VALUE SPACES.     03600000
036100         10  FILLER                   PIC X(05) VALUE ' REC='.    03610000
036200         10  PV-CTN-RET-CDE           PIC X(02) VALUE SPACES.     03620000
036300         10  FILLER                   PIC X(10)                   03630000
036400                             VALUE ' CTN STAT='.                  03640000
036500         10  PV-CTN-STATUS            PIC X(02) VALUE SPACES.     03650000
036600         10  FILLER                   PIC X(01) VALUE '/'.        03660000
036700         10  PV-CTN-STAT-DESC         PIC X(19) VALUE SPACES.     03670000
036800         10  FILLER                   PIC X(05) VALUE ' SER='.    03680000
036900         10  PV-CTN-TRLR-SERIAL       PIC 9(09) VALUE ZEROES.     03690000
037000         10  FILLER                   PIC X(06) VALUE ' TRIP='.   03700000
037100         10  PV-CTN-TRIP              PIC 9(09) VALUE ZEROES.     03710000
037200         10  FILLER                   PIC X(06) VALUE ' STAT='.   03720000
037300         10  PV-CTN-TRIP-STAT         PIC X(02) VALUE SPACES.     03730000
037400         10  FILLER                   PIC X(06) VALUE ' USER='.   03740000
037500         10  PV-CTN-STAT-USERID       PIC X(08) VALUE SPACES.     03750000
037600                                                                  03760000
037700******************************************************************03770000
037800**  THIS IS THE LAYOUT FOR THE LIST ITEMS TEMP STORAGE QUEUE.   **03780000
037900**  THIS MUST BE THE EXACT SAME FORMAT A BLOCK IN THE           **03790000
038000**  APPLICATION-SPECIFIC COMMAREA.                              **03800000
038100******************************************************************03810000
038200 01  LQW-LIST-QUEUE-WORK-AREA.                                    03820000
038300     05  LQW-BLOCK-MODIFIED             PIC  X(01)  VALUE SPACE.  03830000
038400     05  LQW-ITEM-ENTRIES               OCCURS 11 TIMES           03840000
038500                                        INDEXED BY LQW-IDX.       03850000
038600         10  LQW-LIST-ITEM-NUMBER       PIC S9(09)  COMP-3.       03860000
038700         10  LQW-TEMP-SELECTED-SW       PIC  X(01).               03870000
038800         10  LQW-SELECTED-SW            PIC  X(01).               03880000
038900             88  LQW-SELECT                         VALUE 'S'.    03890000
039000             88  LQW-DESELECT                       VALUE ' '.    03900000
039100         10  LQW-ACTION                 PIC  X(03).               03910000
039200             88  LQW-DEL                            VALUE 'DEL'.  03920000
039300             88  LQW-INQ                            VALUE 'INQ'.  03930000
039400             88  LQW-UPD                            VALUE 'UPD'.  03940000
039500             88  LQW-ERR                            VALUE 'ERR'.  03950000
039600         10  LQW-SML                    PIC  9(18).               03960000
039700         10  LQW-CREATE                 PIC  X(03).               03970000
039800         10  LQW-DEST-NBR               PIC  9(04).               03980000
039820         10  LQW-STR-SCAN               PIC  X(04).               03982012
039900         10  LQW-PO-RCVR                PIC  X(12).               03990000
040000         10  LQW-LOAD-STATUS            PIC  X(07).               04000000
040100         10  LQW-ACTV-CDE               PIC  X(01).               04010000
040200         10  LQW-STAT-DATE              PIC  X(08).               04020000
040300         10  LQW-STAT-TIME              PIC  X(05).               04030000
040400         10  LQW-USER-ID                PIC  X(07).               04040000
040500         10  LQW-ERROR-SW               PIC  X(01).               04050000
040510         10  LQW-MULT-SCAN-SW           PIC  X(01).               04051016
040600                                                                  04060000
040700*---------------------------------------------------------------* 04070000
040800* SELECTON QUEUE LAYOUT                                         * 04080000
040900*---------------------------------------------------------------* 04090000
041000     COPY SUWS010.                                                04100000
041100                                                                  04110000
041200******************************************************************04120000
041300* COMMAREA FOR PCKUT713 - CARTON STATUS MODULE                    04130018
041400******************************************************************04140000
041500     COPY PCWS046.                                                04150000
041600                                                                  04160000
041700*---------------------------------------------------------------* 04170000
041800*    MAP LAYOUT                                                 * 04180000
041900*---------------------------------------------------------------* 04190000
042000     COPY SUKM561.                                                04200000
042100*                                                                 04210000
042200 01  MR-OCCURS-LAYOUT                   REDEFINES  SU561AO.       04220000
042300     05  FILLER                         PIC X(234).               04230007
042400     05  MR-SCROLL-AREA                 OCCURS 11 TIMES.          04240000
042500         10  MR-SELECTL                 PIC S9(04) COMP.          04250000
042600         10  MR-SELECTA                 PIC  X(01).               04260000
042700         10  MR-SELECTC                 PIC  X(01).               04270000
042800         10  MR-SELECTH                 PIC  X(01).               04280000
042900         10  MR-SELECTI                 PIC  X(01).               04290000
043000                                                                  04300000
043100         10  MR-ACTIONL                 PIC S9(04) COMP.          04310000
043200         10  MR-ACTIONA                 PIC  X(01).               04320000
043300         10  MR-ACTIONC                 PIC  X(01).               04330000
043400         10  MR-ACTIONH                 PIC  X(01).               04340000
043500         10  MR-ACTION                  PIC  X(01).               04350003
043600                                                                  04360000
043700         10  MR-SMLL                    PIC S9(04) COMP.          04370000
043800         10  MR-SMLA                    PIC  X(01).               04380000
043900         10  MR-SMLC                    PIC  X(01).               04390000
044000         10  MR-SMLH                    PIC  X(01).               04400000
044100         10  MR-SML                     PIC  X(18).               04410000
044200                                                                  04420000
044300         10  MR-CREATEL                 PIC S9(04) COMP.          04430000
044400         10  MR-CREATEA                 PIC  X(01).               04440000
044500         10  MR-CREATEC                 PIC  X(01).               04450000
044600         10  MR-CREATEH                 PIC  X(01).               04460000
044700         10  MR-CREATE                  PIC  X(03).               04470000
044800                                                                  04480000
044900         10  MR-DEST-NBRL               PIC S9(04) COMP.          04490000
045000         10  MR-DEST-NBRA               PIC  X(01).               04500000
045100         10  MR-DEST-NBRC               PIC  X(01).               04510000
045200         10  MR-DEST-NBRH               PIC  X(01).               04520000
045300         10  MR-DEST-NBR                PIC  X(04).               04530000
045400                                                                  04540000
045410         10  MR-STR-SCANL               PIC S9(04) COMP.          04541003
045420         10  MR-STR-SCANA               PIC  X(01).               04542003
045430         10  MR-STR-SCANC               PIC  X(01).               04543003
045440         10  MR-STR-SCANH               PIC  X(01).               04544003
045450         10  MR-STR-SCAN                PIC  X(04).               04545003
045460                                                                  04546003
045500         10  MR-PO-RCVRL                PIC S9(04) COMP.          04550000
045600         10  MR-PO-RCVRA                PIC  X(01).               04560000
045700         10  MR-PO-RCVRC                PIC  X(01).               04570000
045800         10  MR-PO-RCVRH                PIC  X(01).               04580000
045900         10  MR-PO-RCVR                 PIC  X(12).               04590000
046000                                                                  04600000
046100         10  MR-LOAD-STATUSL            PIC S9(04) COMP.          04610000
046200         10  MR-LOAD-STATUSA            PIC  X(01).               04620000
046300         10  MR-LOAD-STATUSC            PIC  X(01).               04630000
046400         10  MR-LOAD-STATUSH            PIC  X(01).               04640000
046500         10  MR-LOAD-STATUS             PIC  X(07).               04650000
046600                                                                  04660000
046700         10  MR-ACTV-CDEL               PIC S9(04) COMP.          04670000
046800         10  MR-ACTV-CDEA               PIC  X(01).               04680000
046900         10  MR-ACTV-CDEC               PIC  X(01).               04690000
047000         10  MR-ACTV-CDEH               PIC  X(01).               04700000
047100         10  MR-ACTV-CDE                PIC  X(01).               04710000
047200                                                                  04720000
047300         10  MR-STAT-DATEL              PIC S9(04) COMP.          04730000
047400         10  MR-STAT-DATEA              PIC  X(01).               04740000
047500         10  MR-STAT-DATEC              PIC  X(01).               04750000
047600         10  MR-STAT-DATEH              PIC  X(01).               04760000
047700         10  MR-STAT-DATE               PIC  X(05).               04770003
047800                                                                  04780000
047900         10  MR-STAT-TIMEL              PIC S9(04) COMP.          04790000
048000         10  MR-STAT-TIMEA              PIC  X(01).               04800000
048100         10  MR-STAT-TIMEC              PIC  X(01).               04810000
048200         10  MR-STAT-TIMEH              PIC  X(01).               04820000
048300         10  MR-STAT-TIME               PIC  X(05).               04830000
048400                                                                  04840000
048500         10  MR-USER-IDL                PIC S9(04) COMP.          04850000
048600         10  MR-USER-IDA                PIC  X(01).               04860000
048700         10  MR-USER-IDC                PIC  X(01).               04870000
048800         10  MR-USER-IDH                PIC  X(01).               04880000
048900         10  MR-USER-ID                 PIC  X(07).               04890000
048910     05  FILLER                         PIC  X(12).               04891005
049000                                                                  04900000
049100*---------------------------------------------------------------* 04910000
049200*    ATTRIBUTE SETTINGS COPYBOOK.                               * 04920000
049300*---------------------------------------------------------------* 04930000
049400     COPY DPWS015.                                                04940000
049500                                                                  04950000
049600*---------------------------------------------------------------* 04960000
049700*    FUNCTION KEYS COPYBOOK.                                    * 04970000
049800*---------------------------------------------------------------* 04980000
049900     COPY DPWS016.                                                04990000
050000                                                                  05000000
050100*----------------------------------------------------------------*05010000
050200**  SECURITY SUBROUTINE PARAMETERS                                05020000
050300*----------------------------------------------------------------*05030000
050400     COPY DPWS008.                                                05040000
050500                                                                  05050000
050600*---------------------------------------------------------------* 05060000
050700*    NUMERIC EDIT LAYOUT.                                       * 05070000
050800*---------------------------------------------------------------* 05080000
050900     COPY DPWS010I.                                               05090000
051000                                                                  05100000
051100*---------------------------------------------------------------* 05110000
051200*    PARAMETERS FOR CALLING CICS ARCHITECTURE API               * 05120021
051300*---------------------------------------------------------------* 05130000
051400     COPY DPWS030.                                                05140000
051400     COPY DPWS930.                                                05141021
051500                                                                  05150000
051600*---------------------------------------------------------------* 05160000
051700*    STANDARD COMMAREA.                                         * 05170000
051800*---------------------------------------------------------------* 05180000
051900     COPY DPWS020.                                                05190000
052000     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                05200000
052100                                                                  05210000
052200*---------------------------------------------------------------* 05220000
052300* INTER-APPLICATION COMMAREA.                                   * 05230000
052400*   SUWS008 - IS THE INPUT LAYOUT WHEN COMING FROM THE CRIT.    * 05240000
052500*             SPEC SCREEN.                                      * 05250000
052600*   SUWS009 - IS THE OUTPUT LAYOUT THAT WILL BE PASSED FROM     * 05260000
052700*             THIS LIST PROGRAMMING FOR A LOCAL-GO FUNCTION.    * 05270000
052800*---------------------------------------------------------------* 05280000
052900                                                                  05290000
053000         10  INTER-APPL-COMM-AREA       PIC X(200).               05300000
053100     COPY SUWS008.                                                05310000
053200     COPY SUWS009.                                                05320000
053300*---------------------------------------------------------------* 05330000
053400*  THIS IS THE APPLICATION-SPECIFIC COMMAREA.                   * 05340000
053500*---------------------------------------------------------------* 05350000
053600         10  ASC-SPECIFIC-COMMAREA.                               05360000
053700             15  ASC-OPER-UNT-ID             PIC  X(04).          05370000
053800             15  ASC-OPER-UNT-ID-N REDEFINES                      05380000
053900                     ASC-OPER-UNT-ID         PIC  9(04).          05390000
054000             15  ASC-SCAC-CODE               PIC  X(04).          05400000
054100             15  ASC-MANUAL                  PIC  9(06).          05410000
054200             15  ASC-DIVERT                  PIC  9(06).          05420000
054300             15  ASC-TRLR-SRL-NMBR           PIC  9(09).          05430000
054400             15  ASC-TRLR-ID                 PIC  X(12).          05440000
054500             15  ASC-SCAN-OFF                PIC  9(06).          05450000
054600             15  ASC-ASSUMED                 PIC  9(06).          05460000
054700             15  ASC-OUTBOUND-TRIP-ID        PIC S9(09) COMP.     05470000
054800             15  ASC-DOORSLOT                PIC  X(06).          05480000
054900             15  ASC-NUMBER                  PIC  X(06).          05490000
055000             15  ASC-DOOR-DESC               PIC  X(25).          05500000
055100             15  ASC-TOTAL                   PIC  9(06).          05510000
055200             15  ASC-DOOR-ID                 PIC  X(04).          05520000
055300             15  ASC-DOOR-ID-R  REDEFINES ASC-DOOR-ID.            05530000
055400                 20  ASC-DOOR-ID-N           PIC  9(04).          05540000
055500             15  ASC-DOOR-TYPE               PIC  X(02).          05550000
055600             15  ASC-STR-NBR-X               PIC  X(04).          05560000
055700             15  ASC-STR-NBR-N REDEFINES ASC-STR-NBR-X.           05570000
055800                 20  ASC-STR-NBR             PIC  9(04).          05580000
055900             15  ASC-TRIP-DEST-OPER          PIC  X(04).          05590000
056000             15 ASC-TRIP-DEST-OPER-X REDEFINES ASC-TRIP-DEST-OPER.05600000
056100                 20  ASC-TRIP-DEST-OPER-N    PIC  9(04).          05610000
056200             15  ASC-TRIP-STAT-CDE           PIC  X(24).          05620000
056300             15  ASC-ACTIVITY-CODE           PIC  X(01).          05630000
056400             15  ASC-STATUS-DATE             PIC  X(08).          05640000
056500             15  ASC-STATUS-TIME             PIC  X(05).          05650000
056600             15  ASC-USERID                  PIC  X(08).          05660000
056700             15  ASC-SML-NBR                 PIC  9(18).          05670000
056800             15  ASC-CREATE-ID               PIC  X(03).          05680000
056900             15  ASC-PO-RCVR                 PIC  X(12).          05690000
057000                                                                  05700000
057100             15  ASC-TRN-NBR                 PIC  9(09).          05710000
057200                                                                  05720000
057300             15  ASC-LOAD-STAT               PIC  X(07).          05730000
057400             15  ASC-CARTON                  PIC  X(01).          05740000
057410             15  ASC-TRIP-STATUS             PIC  XX.             05741003
057420             15  ASC-TRIP-STATUS-DATE        PIC  X(08).          05742003
057500             15  FILLER                      PIC  X(017).         05750003
057600*-----------------------------------------------------------------05760000
057700             15  ASC-BLK-SUB                  PIC S9(04) COMP     05770000
057800                                                         SYNC.    05780000
057900             15  ASC-ITEM-SUB                 PIC S9(04) COMP     05790000
058000                                                         SYNC.    05800000
058100             15  ASC-NUMBER-OF-ITEMS-READ     PIC S9(09) COMP-3.  05810000
058200             15  ASC-NUMBER-OF-SELECTED-ITEMS PIC S9(09) COMP-3.  05820000
058300             15  ASC-ITEMS-DISPLAYED          PIC S9(03) COMP-3.  05830000
058400             15  ASC-ITEM-AT-TOP-OF-PANEL     PIC S9(09) COMP-3.  05840000
058500             15  ASC-ITEM-AT-BOT-OF-PANEL     PIC S9(09) COMP-3.  05850000
058600             15  ASC-HIGHEST-BLOCK-WRITTEN    PIC S9(04) COMP     05860000
058700                                                         SYNC.    05870000
058800             15  ASC-START-OF-SELECTED-RANGE  PIC S9(09) COMP-3.  05880000
058900             15  ASC-END-OF-SELECTED-RANGE    PIC S9(09) COMP-3.  05890000
059000             15  ASC-ITEMS-LEFT-INDICATOR     PIC  X(01).         05900000
059100                 88  ASC-ITEMS-LEFT-ON-DB          VALUE 'Y'.     05910000
059200                 88  ASC-NO-ITEMS-LEFT-ON-DB       VALUE 'N'.     05920000
059300             15  ASC-TEMP-QUEUE-UPDATE-SW     PIC  X(01).         05930000
059400                 88  ASC-UPDATE-TSQ                VALUE 'Y'.     05940000
059500                 88  ASC-NO-TSQ-UPDATE             VALUE ' '.     05950000
059600             15  ASC-ERROR-CARTON-SW          PIC  X(01).         05960000
059700                 88  ASC-ERROR-CARTON              VALUE 'Y'.     05970000
059800                 88  ASC-NO-ERROR-CARTON           VALUE ' '.     05980000
059900             15  ASC-LIST-QUEUE-NAME.                             05990000
060000                 20  ASC-LIST-TERM-ID         PIC  X(04).         06000000
060100                 20  ASC-LIST-TASK-NUMBER     PIC S9(05) COMP-3.  06010000
060200                 20  ASC-LIST-SEQ             PIC  9(01).         06020000
060300                                                                  06030000
060400             15  ASC-START-ITEM-REQUEST.                          06040000
060500                 20  ASC-START-ITEM-REQUEST-N PIC  9(05).         06050000
060600                                                                  06060000
060700             15  ASC-SEL-SUB                  PIC S9(4) COMP.     06070000
060800             15  ASC-SEL-ITEM                 PIC S9(4) COMP.     06080000
060900             15  ASC-USE-SELECTION-QUEUE-IND  PIC  X(1).          06090000
061000                 88  ASC-USE-SELECTION-QUEUE           VALUE 'Y'. 06100000
061100             15  ASC-SEL-QUEUE-NAME-OUT.                          06110000
061200                 20  ASC-SEL-TERM-ID-OUT      PIC  X(04).         06120000
061300                 20  ASC-SEL-TASK-NUMBER-OUT  PIC S9(05) COMP-3.  06130000
061400                 20  ASC-SEL-SEQ-OUT          PIC  9(01).         06140000
061500             15  ASC-SEL-QUEUE-NAME-IN.                           06150000
061600                 20  ASC-SEL-TERM-ID-IN       PIC  X(04).         06160000
061700                 20  ASC-SEL-TASK-NUMBER-IN   PIC S9(05) COMP-3.  06170000
061800                 20  ASC-SEL-SEQ-IN           PIC  9(01).         06180000
061900             15  ASC-NUMBER-OF-TS-ITEMS       PIC S9(09) COMP-3.  06190000
062000                                                                  06200000
062100*-----------------------------------------------------------------06210000
062200             15  ASC-BLOCK-ENTRIES OCCURS 2 TIMES.                06220000
062300                 20  ASC-BLOCK-MODIFIED-SW           PIC  X(01).  06230000
062400                     88  ASC-BLOCK-NOT-MODIFIED      VALUE 'N'.   06240000
062500                     88  ASC-BLOCK-MODIFIED          VALUE 'Y'.   06250000
062600                                                                  06260000
062700                 20  ASC-ITEM-ARRAY.                              06270000
062800                     25  ASC-ITEM-ENTRIES OCCURS 11 TIMES.        06280000
062900                         30  ASC-LIST-ITEM-NUMBER                 06290000
063000                                                     PIC S9(09)   06300000
063100                                                     COMP-3.      06310000
063200                         30  ASC-TEMP-SELECTED-SW    PIC  X(01).  06320000
063300                             88  ASC-VALID-SELECT    VALUE ' '    06330000
063400                                                           'S'    06340000
063500                                                           'B'    06350000
063600                                                           'E'.   06360000
063700                             88  ASC-TEMP-NO-SELECT  VALUE ' '.   06370000
063800                             88  ASC-TEMP-SELECT     VALUE 'S'.   06380000
063900                             88  ASC-TEMP-BEGIN      VALUE 'B'.   06390000
064000                             88  ASC-TEMP-END        VALUE 'E'.   06400000
064100                         30  ASC-SELECTED-SW         PIC  X(01).  06410000
064200                             88  ASC-NO-SELECT       VALUE ' '.   06420000
064300                             88  ASC-SELECT          VALUE 'S'.   06430000
064400                             88  ASC-BEGIN           VALUE 'B'.   06440000
064500                             88  ASC-END             VALUE 'E'.   06450000
064600                         30  ASC-ACTION               PIC  X(03). 06460000
064700                         30  ASC-SML                  PIC  9(18). 06470000
064800                         30  ASC-CREATE               PIC  X(03). 06480000
064900                         30  ASC-DEST-NBR             PIC  9(04). 06490000
064910                         30  ASC-STR-SCAN             PIC  X(04). 06491003
065000                         30  ASC-PO-RCVR-NBR          PIC  X(12). 06500000
065100                         30  ASC-LOAD-STATUS          PIC  X(07). 06510000
065200                         30  ASC-ACTV-CDE             PIC  X(01). 06520000
065300                         30  ASC-STAT-DATE            PIC  X(08). 06530000
065400                         30  ASC-STAT-TIME            PIC  X(05). 06540000
065500                         30  ASC-USER-ID              PIC  X(07). 06550000
065600                         30  ASC-ERROR-SW             PIC  X(01). 06560000
065700                             88  ASC-MISSING-DATA    VALUE '1'.   06570000
065800                             88  ASC-NO-MISSING-DATA VALUE '2'.   06580000
065900                             88  ASC-INACTIVE-CRTN   VALUE '3'.   06590000
066000                             88  ASC-ACTIVE-CRTN     VALUE '4'.   06600000
066010                         30  ASC-MULT-SCAN-SW         PIC  X(01). 06601016
066020                             88  ASC-MULT-SCAN       VALUE 'M'.   06602016
066100                                                                  06610000
066200*---------------------------------------------------------------* 06620000
066300*    ABEND PROCESSING COPYBOOK.                                 * 06630000
066400*---------------------------------------------------------------* 06640000
066500     COPY DPWS013.                                                06650000
066600                                                                  06660000
066700*---------------------------------------------------------------* 06670000
066800*    TSUOBTR - OUTBOUND TRAILER TRIP                            * 06680000
066900*---------------------------------------------------------------* 06690000
067000     EXEC SQL                                                     06700000
067100          INCLUDE TSUOBTR                                         06710000
067200     END-EXEC.                                                    06720000
067300                                                                  06730000
067400*---------------------------------------------------------------* 06740000
067500*    TSUOBTS - OUTBOUND TRAILER TRIP STATUS                     * 06750000
067600*---------------------------------------------------------------* 06760000
067700     EXEC SQL                                                     06770000
067800          INCLUDE TSUOBTS                                         06780000
067900     END-EXEC.                                                    06790000
068000                                                                  06800000
068100*---------------------------------------------------------------* 06810000
068200*    TSUOBSC - TRIP STATUS CODE DESCRIPTION                       06820000
068300*---------------------------------------------------------------* 06830000
068400     EXEC SQL                                                     06840000
068500          INCLUDE TSUOBSC                                         06850000
068600     END-EXEC.                                                    06860000
068700                                                                  06870000
068800*---------------------------------------------------------------* 06880000
068900*    TSUCDOT - CARTON DIVERT - TRIP ASSOCIATION TABLE             06890000
069000*---------------------------------------------------------------* 06900000
069100     EXEC SQL                                                     06910000
069200          INCLUDE TSUCDOT                                         06920000
069300     END-EXEC.                                                    06930000
069400                                                                  06940000
069500*---------------------------------------------------------------* 06950000
069600*    TSUCRDV - CARTON DIVERT TABLE                                06960000
069700*---------------------------------------------------------------* 06970000
069800     EXEC SQL                                                     06980000
069900          INCLUDE TSUCRDV                                         06990000
070000     END-EXEC.                                                    07000000
070100                                                                  07010000
070200*---------------------------------------------------------------* 07020000
070300*     WORKER AUDIT TABLE                                          07030000
070400*     SUT_TRIP_WRKR_AUD                                           07040000
070500*---------------------------------------------------------------* 07050000
070600     EXEC SQL                                                     07060000
070700          INCLUDE SUT00006                                        07070000
070800     END-EXEC.                                                    07080000
070900                                                                  07090000
071000*---------------------------------------------------------------* 07100000
071100*     OUTBOUND SHIPPING UNIT LOCATION TABLE                       07110000
071200*     SUT_OTBND_LOC                                               07120000
071300*---------------------------------------------------------------* 07130000
071400     EXEC SQL                                                     07140000
071500          INCLUDE SUT00027                                        07150000
071600     END-EXEC.                                                    07160000
071700                                                                  07170000
071800     EXEC SQL                                                     07180000
071900          INCLUDE SUT00024                                        07190000
072000     END-EXEC.                                                    07200000
072100                                                                  07210000
072200     EXEC SQL                                                     07220000
072300          INCLUDE SUT00028                                        07230000
072400     END-EXEC.                                                    07240000
072500                                                                  07250000
072600*---------------------------------------------------------------* 07260000
072700*    TCNDCDR - DC TO DOOR ASSIGNMENT                            * 07270000
072800*---------------------------------------------------------------* 07280000
072900     EXEC SQL                                                     07290000
073000          INCLUDE TCNDCDR                                         07300000
073100     END-EXEC.                                                    07310000
073200                                                                  07320000
073300*---------------------------------------------------------------* 07330000
073400*   TCNDRST - DC DOOR TO STORE ASSOCIATION TABLE                * 07340000
073500*---------------------------------------------------------------* 07350000
073600     EXEC SQL                                                     07360000
073700          INCLUDE TCNDRST                                         07370000
073800     END-EXEC.                                                    07380000
073900                                                                  07390000
074000*---------------------------------------------------------------* 07400000
074100*    TCNTRID - TRAILIER ID TABLE                                  07410000
074200*---------------------------------------------------------------* 07420000
074300     EXEC SQL                                                     07430000
074400          INCLUDE TCNTRID                                         07440000
074500     END-EXEC.                                                    07450000
074600                                                                  07460000
074700*---------------------------------------------------------------* 07470000
074800*    TPKSLIP                                                      07480000
074900*---------------------------------------------------------------* 07490000
075000     EXEC SQL                                                     07500000
075100          INCLUDE TPKSLIP                                         07510000
075200     END-EXEC.                                                    07520000
075300                                                                  07530000
075310*---------------------------------------------------------------* 07531010
075320*    SUT_OTBND_STR_SCN                                            07532010
075330*---------------------------------------------------------------* 07533010
075340     EXEC SQL                                                     07534010
075350          INCLUDE SUT00121                                        07535010
075360     END-EXEC.                                                    07536010
075370                                                                  07537010
075400*---------------------------------------------------------------* 07540000
075500*    DB2 AREA FOR COMMUNICATIONS                                * 07550000
075600*---------------------------------------------------------------* 07560000
075700     EXEC SQL                                                     07570000
075800          INCLUDE SQLCA                                           07580000
075900     END-EXEC.                                                    07590000
076000                                                                  07600000
076100******************************************************************07610000
076200* VARIOUS CURSORS, SELECTS, AND WORKING STORAGE AREAS FOR         07620000
076300* RETRIEVING CARTONS                                              07630000
076400******************************************************************07640000
076500     COPY PCWS049.                                                07650000
076600     COPY PCWS050.                                                07660000
076700                                                                  07670000
076800*-----------------------------------------------------------------07680000
076900 LINKAGE SECTION.                                                 07690000
077000                                                                  07700000
077100 01  DFHCOMMAREA.                                                 07710000
077200     05  FILLER                         OCCURS  1 TO 4072 TIMES   07720000
077300                                        DEPENDING ON EIBCALEN.    07730000
077400         10  FILLER                     PIC X.                    07740000
077500                                                                  07750000
077600                                                                  07760000
077700 PROCEDURE DIVISION.                                              07770000
077800******************************************************************07780000
077900**  THIS MODULE IS THE HIGHEST PROCESSING LEVEL IN THE PROGRAM. **07790000
078000**  FIRST, CALL THE CICS ARCHITECTURE API, PERFORM THE PROGRAM  **07800000
078100**  PROCESSING AND THEN CALL THE CICS ARCHITECTURE API TO EXIT. **07810000
078200******************************************************************07820000
078300 0000-MAIN-MODULE.                                                07830000
078400     INITIALIZE DP030-CICS-API-FIELDS.                            07840000
078500     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       07850000
078600     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          07860000
078700     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         07870000
078800     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       07880000
078900     MOVE LENGTH OF SU561AI        TO DP030-MAP-LENGTH (1).       07890000
079000     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     07900000
079100     PERFORM 0001-CALL-CICS-ARCH-API.                             07910000
079200*                                                                 07920000
079300     PERFORM 1000-CONTROL-PROCESSING                              07930000
079400*                                                                 07940000
079500     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     07950000
079600     PERFORM 0001-CALL-CICS-ARCH-API.                             07960000
079700                                                                  07970000
079800******************************************************************07980000
079900**  THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE   **07990000
080000**  AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.         **08000000
080100******************************************************************08010000
080200 0001-CALL-CICS-ARCH-API.                                         08020000
080300                                                                  08030000
080400*    CALL 'DPKCS030' USING DFHEIBLK                               08040021
080400     CALL DP930-CICS-ARCH-API USING DFHEIBLK                      08041021
080500                           DFHCOMMAREA                            08050000
080600                           DP030-CICS-API-FIELDS                  08060000
080700                           DP020-STANDARD-COMMAREA                08070000
080800                           SU561AI.                               08080000
080900*                                                                 08090000
081000     IF  DP030-RC-CALL-SUCCESSFUL                                 08100000
081100         CONTINUE                                                 08110000
081200     ELSE                                                         08120000
081300         SET DP013-NO-ROLLBACK                                    08130000
081400             DP013-XCTL-DISPLAY-RESTART                           08140000
081500             DP013-CICS-ABEND      TO TRUE                        08150000
081600         MOVE '0001-CALL-CICS-ARCH-API' TO DP013-PARAGRAPH        08160000
081700*        MOVE 'CALL TO DPKCS030 NOT SUCCESSFUL, RETURN-CODE ON NEX08170021
081800*             'T LINE'             TO DP013-MESSAGE-TEXT (2)      08180021
081700         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL. RETURN-CODE O08181021
081800-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      08182021
081900         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      08190000
082000         PERFORM DP013-0000-PROCESS-ABEND                         08200000
082100     END-IF.                                                      08210000
082200                                                                  08220000
082300*----------------------------------------------------------------*08230000
082400* PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT      *08240000
082500* COURSE OF ACTION IS FOR THIS TRANSACTION.                      *08250000
082600*                                                                *08260000
082700* NOTE:  PV-TOP-ITEM IS THE ITEM THAT IS REQUESTED TO BE AT THE  *08270000
082800*  TOP OF THE PANEL.  MOVING ASC-ITEM-AT-TOP-OF-PANEL TO THIS    *08280000
082900*  MEANS THAT POSITION WITHIN THE LIST WILL NOT CHANGE -- THIS   *08290000
083000*  IS THE DEFAULT WHICH WILL BE OVERRIDDEN BY SCROLLING ACTIONS. *08300000
083100*----------------------------------------------------------------*08310000
083200 1000-CONTROL-PROCESSING.                                         08320000
083300                                                                  08330000
083400                                                                  08340000
083500     EVALUATE TRUE                                                08350000
083600         WHEN DP020-NEXT-ACT-INITIAL                              08360000
083700             INITIALIZE ASC-SPECIFIC-COMMAREA                     08370000
083800             MOVE EIBTRMID         TO ASC-LIST-TERM-ID            08380000
083900                                      ASC-SEL-TERM-ID-OUT         08390000
084000             MOVE DP020-SRC-TASK-NUMBER TO ASC-LIST-TASK-NUMBER   08400000
084100                                         ASC-SEL-TASK-NUMBER-OUT  08410000
084200             MOVE PC-LIST-QUEUE-SEQ  TO ASC-LIST-SEQ              08420000
084300             MOVE PC-SEL-QUEUE-SEQ TO ASC-SEL-SEQ-OUT             08430000
084400             SET ASC-NO-ERROR-CARTON TO TRUE                      08440000
084500             PERFORM 1100-PROCESS-INTER-APPL-COMM                 08450000
084600             PERFORM 4000-BUILD-INITIAL-PANEL                     08460000
084700                                                                  08470000
084800         WHEN DP020-NEXT-ACT-READ-MAP                             08480000
084900             MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-TOP-ITEM         08490000
085000             PERFORM 2000-PROCESS-PANEL                           08500000
085100                                                                  08510000
085200         WHEN DP020-NEXT-ACT-RETURN                               08520000
085300             MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-TOP-ITEM         08530000
085400             MOVE ZERO  TO ASC-ITEM-AT-TOP-OF-PANEL               08540000
085700             PERFORM 6000-REFRESH-PANEL-FROM-TEMP                 08570000
085800             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 08580000
085900                                                                  08590000
086000         WHEN OTHER                                               08600000
086100             SET DP013-LOGIC-ABEND TO TRUE                        08610000
086200             SET DP013-NO-ROLLBACK TO TRUE                        08620000
086300             MOVE '1000-CONTROL-PROCESSING' TO DP013-PARAGRAPH    08630000
086400             MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    08640000
086500                                   TO DP013-MESSAGE-TEXT(1)       08650000
086600             PERFORM DP013-0000-PROCESS-ABEND                     08660000
086700     END-EVALUATE.                                                08670000
086800                                                                  08680000
086900*----------------------------------------------------------------*08690000
087000* DETERMINE IF DATA WAS PASSED THROUGH INTER-APPL COMMAREA OR    *08700000
087100* IF THERE IS DATA TO BE USED IN THE NAV-KEY FIELD.              *08710000
087200*----------------------------------------------------------------*08720000
087300 1100-PROCESS-INTER-APPL-COMM.                                    08730000
087400                                                                  08740000
087500                                                                  08750000
087600                                                                  08760000
087700     SET PS-COMMAREA-VALID         TO TRUE.                       08770000
087800     MOVE SPACE                    TO ASC-START-ITEM-REQUEST.     08780000
087900                                                                  08790000
088000     IF  DP020-INT-APPL-FORMAT-IND = PC-CRIT-SPEC-FORMAT          08800000
088100         MOVE SU008-OPER-UNT-ID       TO ASC-OPER-UNT-ID-N        08810000
088200                                         DK-OPER-UNT-ID           08820000
088300         MOVE SU008-DOOR-ID           TO ASC-DOOR-ID              08830000
088400         MOVE SU008-SCAC-CDE          TO ASC-SCAC-CODE            08840000
088500         MOVE SU008-TRLR-SRL-NBR      TO ASC-TRLR-SRL-NMBR        08850000
088600         MOVE SU008-DEST-STR-NBR      TO ASC-STR-NBR              08860000
088700         MOVE SU008-CARTONS           TO ASC-CARTON               08870000
088800         MOVE SU008-TRIP-ID           TO ASC-OUTBOUND-TRIP-ID     08880000
088900                                         DK-TRIP-ID               08890000
089000     ELSE                                                         08900000
089100         SET ASC-USE-SELECTION-QUEUE TO TRUE                      08910000
089200         MOVE SU009-NUMBER-OF-SELECTED-ITEMS TO                   08920000
089300                                      ASC-NUMBER-OF-SELECTED-ITEMS08930000
089400         MOVE SU009-NUMBER-OF-TS-ITEMS TO ASC-NUMBER-OF-TS-ITEMS  08940000
089500         MOVE SU009-SEL-QUEUE-NAME     TO ASC-SEL-QUEUE-NAME-IN   08950000
089600         MOVE SU009-OPER-UNT-ID        TO ASC-OPER-UNT-ID-N       08960000
089700                                          DK-OPER-UNT-ID          08970000
089800         MOVE SU009-TRLR-SRL-NBR       TO ASC-TRLR-SRL-NMBR       08980000
089900                                          DK-TRLR-SRL-NBR         08990000
090000         MOVE SU009-SCAC-CDE          TO ASC-SCAC-CODE            09000000
090100         PERFORM 1120-PREPARE-LIST-ENTRY                          09010000
090200     END-IF.                                                      09020000
090300                                                                  09030000
090400*-----------------------------------------------------------------09040000
090500 1120-PREPARE-LIST-ENTRY.                                         09050000
090600                                                                  09060000
090700     MOVE SU010-MAX-ITEMS          TO ASC-SEL-SUB.                09070000
090800     MOVE ZERO                     TO ASC-SEL-ITEM.               09080000
090900     PERFORM 1130-GET-NEXT-RECORD.                                09090000
091000                                                                  09100000
091100*-----------------------------------------------------------------09110000
091200*    GET THE NEXT RECORD IF A LIST OF RECORDS ARE BEING PROCESSED*09120000
091300*-----------------------------------------------------------------09130000
091400 1130-GET-NEXT-RECORD.                                            09140000
091500                                                                  09150000
091600     ADD +1                       TO ASC-SEL-SUB.                 09160000
091700                                                                  09170000
091800     IF  ASC-SEL-SUB > SU010-MAX-ITEMS                            09180000
091900         ADD +1                   TO ASC-SEL-ITEM                 09190000
092000         MOVE +1                  TO ASC-SEL-SUB                  09200000
092100     END-IF.                                                      09210000
092200                                                                  09220000
092300     IF  ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                09230000
092400         PERFORM 9100-READ-SEL-QUEUE                              09240000
092500         IF  SU010-ITEM (ASC-SEL-SUB) > ZERO                      09250000
092700             MOVE SU010-TRLR-SRL-NBR (ASC-SEL-SUB)  TO            09270020
092800                                              ASC-TRLR-SRL-NMBR   09280020
093000             MOVE SU010-TRIP-ID (ASC-SEL-SUB)                     09300000
093100                                           TO ASC-OUTBOUND-TRIP-ID09310000
093200             MOVE SU010-STAT-DATE (ASC-SEL-SUB)                   09320000
093300                                               TO ASC-STATUS-DATE 09330000
093400             MOVE SU010-DEST-NBR (ASC-SEL-SUB) TO ASC-STR-NBR     09340000
093500             IF ASC-SCAC-CODE = SPACES OR LOW-VALUES              09350000
093600                 MOVE SU010-SCAC (ASC-SEL-SUB)                    09360000
093700                                         TO ASC-SCAC-CODE         09370000
093800             END-IF                                               09380000
093900             SET SU010-INQ (ASC-SEL-SUB) TO TRUE                  09390000
094000             PERFORM 9200-REWRITE-SEL-QUEUE                       09400000
094100         ELSE                                                     09410000
094200             SUBTRACT +1 FROM ASC-SEL-SUB                         09420000
094300             MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER             09430000
094400             SET DP020-MSG-INFORMATIONAL                          09440000
094500                 PS-LIST-END             TO TRUE                  09450000
094600         END-IF                                                   09460000
094700     ELSE                                                         09470000
094800         SUBTRACT +1 FROM ASC-SEL-ITEM                            09480000
094900         MOVE SU010-MAX-ITEMS     TO ASC-SEL-SUB                  09490000
095000         MOVE PC-TSYMSG-00070     TO DP020-MSG-NUMBER             09500000
095100         SET DP020-MSG-INFORMATIONAL                              09510000
095200             PS-LIST-END             TO TRUE                      09520000
095300     END-IF.                                                      09530000
095400                                                                  09540000
095500*-----------------------------------------------------------------09550000
095600*    GET THE PREVIOUS RECORD IF A LIST OF RECORDS ARE BEING      *09560000
095700*    PROCESSED.                                                  *09570000
095800*-----------------------------------------------------------------09580000
095900 1140-GET-PREV-RECORD.                                            09590000
096000                                                                  09600000
096100     SUBTRACT +1 FROM ASC-SEL-SUB.                                09610000
096200                                                                  09620000
096300     IF  ASC-SEL-SUB < +1                                         09630000
096400         SUBTRACT +1 FROM ASC-SEL-ITEM                            09640000
096500         MOVE SU010-MAX-ITEMS     TO ASC-SEL-SUB                  09650000
096600     END-IF.                                                      09660000
096700                                                                  09670000
096800     IF  ASC-SEL-ITEM > ZERO                                      09680000
096900         PERFORM 9100-READ-SEL-QUEUE                              09690000
097100         MOVE SU010-TRLR-SRL-NBR (ASC-SEL-SUB)  TO                09710020
097200                                              ASC-TRLR-SRL-NMBR   09720020
097400         MOVE SU010-TRIP-ID (ASC-SEL-SUB)  TO ASC-OUTBOUND-TRIP-ID09740000
097500         MOVE SU010-STAT-DATE (ASC-SEL-SUB) TO ASC-STATUS-DATE    09750000
097600         MOVE SU010-DEST-NBR (ASC-SEL-SUB) TO ASC-STR-NBR         09760000
097700         SET SU010-INQ (ASC-SEL-SUB) TO TRUE                      09770000
097800         PERFORM 9200-REWRITE-SEL-QUEUE                           09780000
097900     ELSE                                                         09790000
098000         MOVE +1                  TO ASC-SEL-ITEM                 09800000
098100                                     ASC-SEL-SUB                  09810000
098200         MOVE PC-TSYMSG-00069     TO DP020-MSG-NUMBER             09820000
098300         SET DP020-MSG-INFORMATIONAL                              09830000
098400             PS-LIST-END             TO TRUE                      09840000
098500     END-IF.                                                      09850000
098600                                                                  09860000
098700*----------------------------------------------------------------*09870000
098800* DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *09880000
098900* ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *09890000
099000* USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *09900000
099100* OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *09910000
099200* FUNCTION KEYS CAN GET THIS FAR.                                *09920000
099300*----------------------------------------------------------------*09930000
099400 2000-PROCESS-PANEL.                                              09940000
099500                                                                  09950000
099600     EVALUATE TRUE                                                09960000
099700         WHEN DP020-SRC-AID = DP016-CLEAR                         09970000
099800             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    09980000
099900             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   09990000
100000             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 10000000
100100                                                                  10010000
100200         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    10020000
100300             PERFORM 2050-DELETE-LIST-QUEUE                       10030000
100400             PERFORM 4000-BUILD-INITIAL-PANEL                     10040000
100500                                                                  10050000
100600         WHEN DP020-FK-DESELECT(DP020-SRC-AID)                    10060000
100700             PERFORM 2140-DESELECT-ALL-ITEMS                      10070000
100800             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 10080000
100900                                                                  10090000
101000         WHEN DP020-FK-SELECT-ALL(DP020-SRC-AID)                  10100000
101100             PERFORM 2150-SELECT-ALL-ITEMS                        10110000
101200             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 10120000
101300                                                                  10130000
101400         WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             10140000
101500             IF  ASC-USE-SELECTION-QUEUE                          10150000
101600                 PERFORM 1130-GET-NEXT-RECORD                     10160000
101700                 IF PS-LIST-END                                   10170000
101800                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         10180000
101900                     SET PS-NO-LIST-END TO TRUE                   10190000
102000                 ELSE                                             10200000
102100                     PERFORM 2050-DELETE-LIST-QUEUE               10210000
102200                     PERFORM 3200-RESET-ATTRIBUTES                10220000
102300                     PERFORM 4000-BUILD-INITIAL-PANEL             10230000
102400                 END-IF                                           10240000
102500              ELSE                                                10250000
102600                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             10260000
102700*                --- BOTTOM OF LIST ---                           10270000
102800                 MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER         10280000
102900                 SET DP020-MSG-INFORMATIONAL TO TRUE              10290000
103000             END-IF                                               10300000
103100                                                                  10310000
103200         WHEN DP020-FK-PREV-SELECTION (DP020-SRC-AID)             10320000
103300             IF  ASC-USE-SELECTION-QUEUE                          10330000
103400                 PERFORM 1140-GET-PREV-RECORD                     10340000
103500                 IF PS-LIST-END                                   10350000
103600                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         10360000
103700                     SET PS-NO-LIST-END TO TRUE                   10370000
103800                 ELSE                                             10380000
103900                     PERFORM 2050-DELETE-LIST-QUEUE               10390000
104000                     PERFORM 3200-RESET-ATTRIBUTES                10400000
104100                     PERFORM 4000-BUILD-INITIAL-PANEL             10410000
104200                 END-IF                                           10420000
104300             ELSE                                                 10430000
104400                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             10440000
104500                 MOVE PC-TSYMSG-00069 TO DP020-MSG-NUMBER         10450000
104600                 SET DP020-MSG-INFORMATIONAL TO TRUE              10460000
104700             END-IF                                               10470000
104800                                                                  10480000
104900         WHEN OTHER                                               10490000
105000             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 10500000
105100             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   10510000
105200                                                                  10520000
105300             IF  PS-NO-ERROR                                      10530000
105400                 SET DP030-CONTINUE-GO TO TRUE                    10540000
105500                 PERFORM 2100-CHECK-FUNCTION-KEY                  10550000
105600             ELSE                                                 10560000
105700                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             10570000
105800                 SET DP030-OVERRIDE-GO TO TRUE                    10580000
105900             END-IF                                               10590000
106000     END-EVALUATE.                                                10600000
106100                                                                  10610000
106200*----------------------------------------------------------------*10620000
106300*  DELETE THE LIST ITEMS TEMP STORAGE QUEUE.                     *10630000
106400*----------------------------------------------------------------*10640000
106500 2050-DELETE-LIST-QUEUE.                                          10650000
106600                                                                  10660000
106700     EXEC CICS                                                    10670000
106800         DELETEQ TS                                               10680000
106900             QUEUE (ASC-LIST-QUEUE-NAME)                          10690000
107000             RESP  (PV-CICS-RESP)                                 10700000
107100     END-EXEC.                                                    10710000
107200                                                                  10720000
107300     IF (PV-CICS-RESP = DFHRESP(NORMAL)) OR                       10730000
107400        (PV-CICS-RESP = DFHRESP(QIDERR))                          10740000
107500         CONTINUE                                                 10750000
107600     ELSE                                                         10760000
107700         SET DP013-CICS-ABEND      TO TRUE                        10770000
107800         SET DP013-NO-ROLLBACK     TO TRUE                        10780000
107900                                                                  10790000
108000         MOVE '2050-DELETE-LIST-QUEUE' TO DP013-PARAGRAPH         10800000
108100         MOVE 'ERROR TRYING TO DELETE LIST TEMP STORAGE QUEUE'    10810000
108200                                   TO DP013-MESSAGE-TEXT (1)      10820000
108300         PERFORM DP013-0000-PROCESS-ABEND                         10830000
108400     END-IF.                                                      10840000
108500                                                                  10850000
108600     MOVE +0                       TO ASC-HIGHEST-BLOCK-WRITTEN.  10860000
108700                                                                  10870000
108800*----------------------------------------------------------------*10880000
108900* ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED FIRST.*10890000
109000* NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED FROM THE  *10900000
109100* CICS ARCHITECTURE API.                                         *10910000
109200*----------------------------------------------------------------*10920000
109300 2100-CHECK-FUNCTION-KEY.                                         10930000
109400                                                                  10940000
109500     EVALUATE TRUE                                                10950000
109600                                                                  10960020
109700* F22 - CARTON DETAIL                                             10970000
109800         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              10980000
109900* F18 - CARTON PACKED DETAIL                                      10990000
110000         WHEN DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)              11000000
110001                                                                  11000120
110010* F14 - SML FLOW                                                  11001002
110020         WHEN DP020-FK-LOCAL-FUNC-05 (DP020-SRC-AID)              11002002
110040                                                                  11004020
110060* F16 - CHILD LIST                                                11006015
110070         WHEN DP020-FK-LOCAL-FUNC-06 (DP020-SRC-AID)              11007015
110090                                                                  11009020
110100             IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              11010000
110200                 SET ASC-USE-SELECTION-QUEUE TO TRUE              11020000
110300                 INITIALIZE SU009-INTER-APPL-COMMAREA             11030000
110400                 MOVE ASC-NUMBER-OF-SELECTED-ITEMS                11040000
110500                                TO SU009-NUMBER-OF-SELECTED-ITEMS 11050000
110600                 MOVE ASC-NUMBER-OF-TS-ITEMS                      11060000
110700                                      TO SU009-NUMBER-OF-TS-ITEMS 11070000
110800                 MOVE ASC-SEL-QUEUE-NAME-OUT                      11080000
110900                                      TO SU009-SEL-QUEUE-NAME     11090000
111000                 MOVE ASC-OPER-UNT-ID      TO SU009-OPER-UNT-ID   11100000
111100                 MOVE ASC-SCAC-CODE        TO SU009-SCAC-CDE      11110000
111200                 MOVE ASC-TRLR-ID          TO SU009-TRLR-ID       11120000
111300                 MOVE ASC-TRLR-SRL-NMBR    TO SU009-TRLR-SRL-NBR  11130000
111400                 MOVE ASC-STR-NBR          TO SU009-DEST-STR-NBR  11140000
111500                 MOVE ASC-NUMBER           TO SU009-DOOR-ID       11150000
111600                 MOVE ASC-OUTBOUND-TRIP-ID TO SU009-TRIP-ID       11160000
111700                 PERFORM 5000-PREPARE-SEL-QUEUE                   11170000
111800             ELSE                                                 11180000
111900                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             11190000
112000                 SET DP030-OVERRIDE-GO TO TRUE                    11200000
112100                 MOVE PC-TSYMSG-00057 TO DP020-MSG-NUMBER         11210000
112200                 SET DP020-MSG-WARNING TO TRUE                    11220000
112300             END-IF                                               11230000
112400                                                                  11240020
112500* F24 - END CARTON CUT OFF                                        11250000
112600         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              11260000
112700             IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              11270000
112800               MOVE 'SUCUTOFF' TO DP008-FUNCTION-NAME             11280000
112900               PERFORM 2105-RACF-ACCESS                           11290000
113000               IF  PS-ACCESS-NOT-ALLOWED                          11300000
113100                   SET  PS-ERROR                                  11310000
113200                        DP020-MSG-FATAL TO TRUE                   11320000
113300                   MOVE PC-TSYMSG-00840 TO DP020-MSG-NUMBER       11330000
113400                   PERFORM 4400-MOVE-COMMAREA-TO-SCREEN           11340000
113500               END-IF                                             11350000
113600                                                                  11360000
113700               IF  PS-NO-ERROR                                    11370000
113800                   PERFORM 3650-CHECK-4-OPEN-TRIP                 11380000
113900                   IF  PS-TRIP-OPEN                               11390000
114000                       PERFORM 5000-PREPARE-SEL-QUEUE             11400000
114100                       SET SU010-IDX TO  1                        11410000
114200                       IF SU010-LOAD-STATUS (SU010-IDX)           11420000
114300                                 NOT = 'LOADED ' AND 'ASSUMED'    11430000
114400                           SET  PS-ERROR                          11440000
114500                                DP020-MSG-FATAL TO TRUE           11450000
114600                           MOVE PC-TSYMSG-02793                   11460000
114700                                              TO DP020-MSG-NUMBER 11470000
114800                           PERFORM 4400-MOVE-COMMAREA-TO-SCREEN   11480000
114900                       ELSE                                       11490000
115000                           PERFORM 3600-RETRIEVE-START-TMST       11500000
115100                           PERFORM 3700-CHECK-4-END-CUTOFF        11510000
115200                           IF PS-NO-ERROR                         11520000
115300                             PERFORM 3710-UPDATE-TSUCDOT          11530000
115400                           ELSE                                   11540000
115500                             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN 11550000
115600                             SET DP030-OVERRIDE-GO TO TRUE        11560000
115700                           END-IF                                 11570000
115800                       END-IF                                     11580000
115900                   ELSE                                           11590000
116000                       EVALUATE TRUE                              11600000
116100                       WHEN PS-AUDIT-OPEN                         11610000
116200                         SET  PS-ERROR                            11620000
116300                              DP020-MSG-FATAL TO TRUE             11630000
116400                         MOVE PC-TSYMSG-02974 TO DP020-MSG-NUMBER 11640000
116500                         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN     11650000
116600                       WHEN PS-AUDIT-CLOSED                       11660000
116700                         SET  PS-ERROR                            11670000
116800                              DP020-MSG-FATAL TO TRUE             11680000
116900                         MOVE PC-TSYMSG-02975 TO DP020-MSG-NUMBER 11690000
117000                         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN     11700000
117100                       WHEN PS-TRLR-CLOSED                        11710000
117200                         SET  PS-ERROR                            11720000
117300                              DP020-MSG-FATAL TO TRUE             11730000
117400                         MOVE PC-TSYMSG-02976 TO DP020-MSG-NUMBER 11740000
117500                         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN     11750000
117600                       WHEN OTHER                                 11760000
117700                         SET  PS-ERROR                            11770000
117800                              DP020-MSG-FATAL TO TRUE             11780000
117900                         MOVE PC-TSYMSG-00743 TO DP020-MSG-NUMBER 11790000
118000                         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN     11800000
118100                       END-EVALUATE                               11810000
118200                   END-IF                                         11820000
118300               END-IF                                             11830000
118400             ELSE                                                 11840000
118500                 MOVE PC-TSYMSG-00057 TO DP020-MSG-NUMBER         11850000
118600                 SET DP020-MSG-WARNING TO TRUE                    11860000
118700             END-IF                                               11870000
118800                                                                  11880020
118900* F17- ERROR CARTONS                                              11890000
119000         WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)              11900000
119100             SET ASC-ERROR-CARTON  TO TRUE                        11910000
119200             PERFORM 2050-DELETE-LIST-QUEUE                       11920000
119300             PERFORM 4000-BUILD-INITIAL-PANEL                     11930000
119400                                                                  11940020
119500* F6 - FIRST PAGE                                                 11950000
119600         WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                  11960000
119700             MOVE +1               TO PV-TOP-ITEM                 11970000
119800             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 11980000
119900                                                                  11990020
120000* F7 - PREVIOUS PAGE                                              12000000
120100         WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                   12010000
120200             PERFORM 2110-BROWSE-BACKWARD                         12020000
120300             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 12030000
120400                                                                  12040020
120500* F8 - NEXT PAGE                                                  12050000
120600         WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                   12060000
120700             PERFORM 2120-BROWSE-FORWARD                          12070000
120800             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 12080000
120900                                                                  12090020
121000* ENTER KEY                                                       12100000
121100         WHEN DP020-SRC-AID = DP016-ENTER                         12110000
121200             PERFORM 2130-CHECK-FOR-JUMP-BROWSE                   12120000
121300             IF  PS-ERROR                                         12130000
121400                 CONTINUE                                         12140000
121500             ELSE                                                 12150000
121600                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             12160000
121700             END-IF                                               12170000
121800                                                                  12180000
121900         WHEN OTHER                                               12190000
122000             SET DP013-NO-ROLLBACK                                12200000
122100                 DP013-XCTL-DISPLAY-RESTART                       12210000
122200                 DP013-CICS-ABEND  TO TRUE                        12220000
122300             MOVE '2100-CHECK-FUNCTION-KEY' TO DP013-PARAGRAPH    12230000
122400             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      12240000
122500                                   TO DP013-MESSAGE-TEXT (1)      12250000
122600             PERFORM DP013-0000-PROCESS-ABEND                     12260000
122700     END-EVALUATE.                                                12270000
122800                                                                  12280020
122900*----------------------------------------------------------------*12290000
123000* CHECK TO SEE IF USER HAS RACF AUTHORIZATION                     12300000
123100*----------------------------------------------------------------*12310000
123200 2105-RACF-ACCESS.                                                12320000
123300                                                                  12330000
123400      SET DP008-RSRC-TYPE-FUNC           TO TRUE                  12340000
123500      SET DP008-ACCESS-TYPE-USE          TO TRUE                  12350000
123600                                                                  12360000
123700      EXEC CICS                                                   12370000
123800         LINK PROGRAM (DP008-SECURITY-SUBROUTINE)                 12380000
123900              COMMAREA (DP008-SECURITY-COMMAREA)                  12390000
124000              LENGTH (DP008-SECURITY-COMMAREA-LENGTH)             12400000
124100      END-EXEC                                                    12410000
124200                                                                  12420000
124300      IF DP008-CALL-SUCCESSFUL                                    12430000
124400         IF DP008-ACCESS-ALLOWED                                  12440000
124500             SET PS-ACCESS-ALLOWED TO TRUE                        12450000
124600         ELSE                                                     12460000
124700             SET PS-ACCESS-NOT-ALLOWED TO TRUE                    12470000
124800             MOVE DP008-ERROR-CODE TO PV-RACF-ERROR-CODE          12480000
124900             STRING ' SUKCS561- RACF -'  DELIMITED BY SIZE        12490000
125000                    ' DP008-ACCESS-SW- ' DELIMITED BY SIZE        12500000
125100                      DP008-ACCESS-SW    DELIMITED BY SIZE        12510000
125200                    ' RACF ERROR CODE-'  DELIMITED BY SIZE        12520000
125300                      PV-RACF-ERROR-CODE DELIMITED BY SIZE        12530000
125400                                    INTO PV-CICS-MSG              12540000
125500               PERFORM 8000-WRITE-CSSL                            12550000
125600         END-IF                                                   12560000
125700     ELSE                                                         12570000
125800         MOVE ' 2105-RACF-ACCESS'                                 12580000
125900                               TO DP013-PARAGRAPH                 12590000
126000          MOVE 'UNABLE TO ACCESS CICS'                            12600000
126100                               TO DP013-MESSAGE-TEXT (1)          12610000
126200          MOVE SQLCA                 TO DP013-SQLCA               12620000
126300          SET DP013-DB2-ABEND                                     12630000
126400              DP013-XCTL-DISPLAY-RESTART                          12640000
126500                               TO TRUE                            12650000
126600          PERFORM DP013-0000-PROCESS-ABEND                        12660000
126700      END-IF.                                                     12670000
126800                                                                  12680000
126900*----------------------------------------------------------------*12690000
127000*    IF THE USER HITS THE PAGE BACKWARD KEY, COMPUTE THE TOP     *12700000
127100*    ITEM NUMBER FOR THE NEW PAGE.  IF IT IS ABOVE THE TOP,      *12710000
127200*    SET THE TOP ITEM NUMBER TO +1 AND DISPLAY THE TOP OF LIST   *12720000
127300*    MESSAGE.                                                    *12730000
127400*----------------------------------------------------------------*12740000
127500 2110-BROWSE-BACKWARD.                                            12750000
127600                                                                  12760000
127700     SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    12770000
127800         GIVING PV-TOP-ITEM.                                      12780000
127900*                                                                 12790000
128000     IF  ((PV-TOP-ITEM < +1)                                      12800000
128100       OR (PV-TOP-ITEM = +1))                                     12810000
128200         MOVE +1                   TO PV-TOP-ITEM                 12820000
128300*        -- TOP OF LIST --                                        12830000
128400         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            12840000
128500         SET DP020-MSG-INFORMATIONAL TO TRUE                      12850000
128600     END-IF.                                                      12860000
128700                                                                  12870000
128800*----------------------------------------------------------------*12880000
128900*    IF THE USER HITS THE PAGE FORWARD KEY, COMPUTE THE TOP      *12890000
129000*    ITEM NUMBER FOR THE NEW PAGE.  IF THE USER ATTEMPTS TO GO   *12900000
129100*    PAST THE END, ISSUE THE BOTTOM OF LIST MESSAGE.             *12910000
129200*----------------------------------------------------------------*12920000
129300 2120-BROWSE-FORWARD.                                             12930000
129400                                                                  12940000
129500     ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              12950000
129600         GIVING PV-TOP-ITEM.                                      12960000
129700     IF  PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                   12970000
129800         MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-TOP-ITEM             12980000
129900*        -- BOTTOM OF LIST --                                     12990000
130000         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            13000000
130100         SET DP020-MSG-INFORMATIONAL  TO TRUE                     13010000
130200     ELSE                                                         13020000
130300         COMPUTE PV-BOTTOM-ITEM =                                 13030000
130400             PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 13040000
130500         IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ            13050000
130600*            -- BOTTOM OF LIST --                                 13060000
130700             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            13070000
130800             SET DP020-MSG-INFORMATIONAL TO TRUE                  13080000
130900         END-IF                                                   13090000
131000     END-IF.                                                      13100000
131100                                                                  13110000
131200*----------------------------------------------------------------*13120000
131300*    THE USER CAN CHANGE THE CURRENT BEGINNING LIST NUMBER SO    *13130000
131400*    THAT THE TRANSACTION WILL JUMP TO THAT POINT IN THE LIST.   *13140000
131500*    THIS IS A FASTER WAY TO GET TO A CERTAIN POINT IN THE LIST  *13150000
131600*    RATHER THAN HITTING NEXT-PAGE TO GET TO THAT POINT.         *13160000
131700*    THE NEW LIST NUMBER ENTERED IS EDITED TO MAKE SURE THAT     *13170000
131800*    IT IS NUMERIC AND FALLS BETWEEN A SPECIFIED RANGE.          *13180000
131900*----------------------------------------------------------------*13190000
131901                                                                  13190100
131902 2130-CHECK-FOR-JUMP-BROWSE.                                      13190200
131903                                                                  13190300
131904     SET PS-NO-ERROR             TO TRUE.                         13190400
131905     IF ASC-START-ITEM-REQUEST = SPACE                            13190500
131906         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            13190600
131907                                 TO PV-TOP-ITEM                   13190700
131908     ELSE                                                         13190800
131909         MOVE ASC-START-ITEM-REQUEST                              13190900
131910                                 TO DP010I-UNEDITED-FIELD         13191000
131911         MOVE +5                 TO DP010I-MAXIMUM-DIGITS         13191100
131912         MOVE ZERO               TO DP010I-MAXIMUM-DECIMALS       13191200
131913         SET DP010I-NEGATIVE-NOT-ALLOWED                          13191300
131914                                 TO TRUE                          13191400
131915                                                                  13191500
131916         CALL DP010I-NUMERIC-EDIT-ROUTINE                         13191620
131917              USING DP010I-NUMERIC-EDIT-AREA                      13191720
131919                                                                  13191900
131920         IF NOT DP010I-ERROR-DETECTED                             13192000
131921             MOVE DP010I-NUMERIC-FIELD                            13192100
131922                                 TO ASC-START-ITEM-REQUEST-N      13192200
131923             IF ASC-START-ITEM-REQUEST-N > ZERO                   13192300
131924                IF ASC-START-ITEM-REQUEST-N >                     13192400
131925                                          ASC-NUMBER-OF-ITEMS-READ13192500
131926                    MOVE SPACE   TO ASC-START-ITEM-REQUEST        13192600
131927                    COMPUTE PV-TOP-ITEM = ASC-NUMBER-OF-ITEMS-READ13192700
131928                                          - PC-ITEMS-PER-PANEL + 113192800
131929                    IF PV-TOP-ITEM < +1                           13192900
131930                        MOVE +1  TO PV-TOP-ITEM                   13193000
131931                        MOVE PC-TSYMSG-00070                      13193100
131932                                 TO DP020-MSG-NUMBER              13193200
131933                        SET DP020-MSG-INFORMATIONAL               13193300
131934                                 TO TRUE                          13193400
131935                    END-IF                                        13193500
131936                ELSE                                              13193600
131937                    MOVE ASC-START-ITEM-REQUEST-N                 13193700
131938                                 TO PV-TOP-ITEM                   13193800
131939                    MOVE SPACE   TO ASC-START-ITEM-REQUEST        13193900
131940                    COMPUTE PV-BOTTOM-ITEM = PV-TOP-ITEM +        13194000
131941                                            PC-ITEMS-PER-PANEL - 113194100
131942                    IF PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ  13194200
131943                         MOVE PC-TSYMSG-00070                     13194300
131944                                 TO DP020-MSG-NUMBER              13194400
131945                         SET DP020-MSG-INFORMATIONAL              13194500
131946                                 TO TRUE                          13194600
131947                    END-IF                                        13194700
131948                END-IF                                            13194800
131949             ELSE                                                 13194900
131950                 MOVE PC-TSYMSG-00101                             13195000
131951                                 TO DP020-MSG-NUMBER              13195100
131952                 SET DP030-SET-CURSOR-APPL-1                      13195200
131953                                 TO TRUE                          13195300
131954                 MOVE -1         TO ASTRTITL                      13195400
131955                 MOVE DP015-UNP-NUM-BRT-MDT                       13195500
131956                                 TO ASTRTITA                      13195600
131957                 MOVE DP015-RED  TO ASTRTITC                      13195700
131958                 MOVE DP015-REVERSE                               13195800
131959                                 TO ASTRTITH                      13195900
131960                 SET PS-ERROR                                     13196000
131961                     DP020-MSG-FATAL                              13196100
131962                                 TO TRUE                          13196200
131963             END-IF                                               13196300
131964         ELSE                                                     13196400
131965             MOVE PC-TSYMSG-00008 TO DP020-MSG-NUMBER             13196500
131966             SET DP030-SET-CURSOR-APPL-1                          13196600
131967                                 TO TRUE                          13196700
131968             MOVE -1             TO ASTRTITL                      13196800
131969             MOVE DP015-UNP-NUM-BRT-MDT                           13196900
131970                                 TO ASTRTITA                      13197000
131971             MOVE DP015-RED      TO ASTRTITC                      13197100
131972             MOVE DP015-REVERSE  TO ASTRTITH                      13197200
131973             SET PS-ERROR                                         13197300
131974                 DP020-MSG-FATAL TO TRUE                          13197400
131975         END-IF                                                   13197500
131976     END-IF.                                                      13197600
131977                                                                  13197700
138900*----------------------------------------------------------------*13890000
139000*    IF THE USER HITS THE DESELECT KEY, CLEAR THE SELECTION      *13900000
139100*    SWITCH FOR ALL ITEMS THAT WERE PREVIOUSLY SELECTED.         *13910000
139200*----------------------------------------------------------------*13920000
139300 2140-DESELECT-ALL-ITEMS.                                         13930000
139400                                                                  13940000
139500     MOVE +1                       TO ASC-BLK-SUB.                13950000
139600                                                                  13960000
139700     PERFORM 2141-CLEAR-SELECTED-INDS                             13970000
139800         VARYING ASC-ITEM-SUB                                     13980000
139900         FROM 1 BY 1                                              13990000
140000         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 14000000
140100                                                                  14010000
140200     ADD +1                        TO ASC-BLK-SUB.                14020000
140300                                                                  14030000
140400     PERFORM 2141-CLEAR-SELECTED-INDS                             14040000
140500         VARYING ASC-ITEM-SUB                                     14050000
140600         FROM 1 BY 1                                              14060000
140700         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 14070000
140800                                                                  14080000
140900     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               14090000
141000                                   TO PV-LIST-ITEM-NUMBER.        14100000
141100                                                                  14110000
141200     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            14120000
141300         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    14130000
141400                                                                  14140000
141500     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     14150000
141600        (ASC-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)      14160000
141700         MOVE +1                   TO ASC-BLK-SUB                 14170000
141800                                                                  14180000
141900         PERFORM 5100-WRITE-TEMP-STORAGE                          14190000
142000         MOVE +2                   TO ASC-BLK-SUB                 14200000
142100         PERFORM 5100-WRITE-TEMP-STORAGE                          14210000
142200         MOVE +1                   TO ASC-BLK-SUB                 14220000
142300                                                                  14230000
142400         MOVE +1                   TO PV-BLOCK-NUMBER             14240000
142500                                                                  14250000
142600         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         14260000
142700             PV-FIRST-BLOCK-IN-ARRAY - 1                          14270000
142800                                                                  14280000
142900         PERFORM                                                  14290000
143000             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       14300000
143100                                                                  14310000
143200             PERFORM 4410-READ-TEMP-STORAGE                       14320000
143300                                                                  14330000
143400             PERFORM 2141-CLEAR-SELECTED-INDS                     14340000
143500                 VARYING ASC-ITEM-SUB FROM 1 BY 1                 14350000
143600                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          14360000
143700                                                                  14370000
143800             PERFORM 5100-WRITE-TEMP-STORAGE                      14380000
143900                                                                  14390000
144000             ADD +1                TO PV-BLOCK-NUMBER             14400000
144100                                                                  14410000
144200         END-PERFORM                                              14420000
144300                                                                  14430000
144400         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         14440000
144500             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     14450000
144600                                                                  14460000
144700         PERFORM                                                  14470000
144800             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       14480000
144900                   ASC-HIGHEST-BLOCK-WRITTEN                      14490000
145000                                                                  14500000
145100             MOVE PV-NEXT-BLOCK-IN-ARRAY                          14510000
145200                                   TO PV-BLOCK-NUMBER             14520000
145300                                                                  14530000
145400             PERFORM 4410-READ-TEMP-STORAGE                       14540000
145500                                                                  14550000
145600             PERFORM 2141-CLEAR-SELECTED-INDS                     14560000
145700                 VARYING ASC-ITEM-SUB                             14570000
145800                 FROM 1 BY 1                                      14580000
145900                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          14590000
146000                                                                  14600000
146100             PERFORM 5100-WRITE-TEMP-STORAGE                      14610000
146200                                                                  14620000
146300             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      14630000
146400         END-PERFORM                                              14640000
146500                                                                  14650000
146600         MOVE PV-FIRST-BLOCK-IN-ARRAY TO PV-BLOCK-NUMBER          14660000
146700         PERFORM 4410-READ-TEMP-STORAGE                           14670000
146800     END-IF.                                                      14680000
146900                                                                  14690000
147000                                                                  14700000
147100     MOVE +0                     TO ASC-NUMBER-OF-SELECTED-ITEMS. 14710000
147200     MOVE +0                     TO ASC-START-OF-SELECTED-RANGE.  14720000
147300     MOVE +0                     TO ASC-END-OF-SELECTED-RANGE.    14730000
147400                                                                  14740000
147500     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        14750000
147600                                                                  14760000
147700*----------------------------------------------------------------*14770000
147800*    MARK EACH ITEM AS BEING NOT SELECTED.                       *14780000
147900*----------------------------------------------------------------*14790000
148000 2141-CLEAR-SELECTED-INDS.                                        14800000
148100                                                                  14810000
148200     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           14820000
148300             NOT EQUAL ZERO                                       14830000
148400         IF  NOT ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          14840000
148500             SET ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          14850000
148600                 ASC-TEMP-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)    14860000
148700                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  14870000
148800                                   TO TRUE                        14880000
148900         END-IF                                                   14890000
149000     END-IF.                                                      14900000
149100                                                                  14910000
149200*----------------------------------------------------------------*14920000
149300*  IF THE USER HITS THE SELECT-ALL KEY, SET THE SELECTIO SWITCH  *14930000
149400*  FOR ALL ITEMS.                                                *14940000
149500*----------------------------------------------------------------*14950000
149600 2150-SELECT-ALL-ITEMS.                                           14960000
149700                                                                  14970000
149800     MOVE +1                       TO ASC-BLK-SUB.                14980000
149900                                                                  14990000
150000     PERFORM 2151-SET-SELECTED-INDS                               15000000
150100         VARYING ASC-ITEM-SUB                                     15010000
150200         FROM 1 BY 1                                              15020000
150300         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 15030000
150400                                                                  15040000
150500     ADD +1                        TO ASC-BLK-SUB.                15050000
150600                                                                  15060000
150700     PERFORM 2151-SET-SELECTED-INDS                               15070000
150800         VARYING ASC-ITEM-SUB                                     15080000
150900         FROM 1 BY 1                                              15090000
151000         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 15100000
151100                                                                  15110000
151200     MOVE ASC-LIST-ITEM-NUMBER(1 1) TO PV-LIST-ITEM-NUMBER.       15120000
151300                                                                  15130000
151400     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            15140000
151500         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    15150000
151600                                                                  15160000
151700     IF  PV-FIRST-BLOCK-IN-ARRAY  = +1                            15170000
151800         MOVE +1                   TO ASC-BLK-SUB                 15180000
151900                                                                  15190000
152000         PERFORM 5100-WRITE-TEMP-STORAGE                          15200000
152100         MOVE +2                   TO ASC-BLK-SUB                 15210000
152200         PERFORM 5100-WRITE-TEMP-STORAGE                          15220000
152300         MOVE +1                   TO ASC-BLK-SUB                 15230000
152400         MOVE +1                   TO PV-BLOCK-NUMBER             15240000
152500     END-IF.                                                      15250000
152600                                                                  15260000
152700     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     15270000
152800        (ASC-HIGHEST-BLOCK-WRITTEN >   PC-MAX-BLOCKS-IN-ARRAY)    15280000
152900         MOVE +1                   TO ASC-BLK-SUB                 15290000
153000                                                                  15300000
153100         PERFORM 5100-WRITE-TEMP-STORAGE                          15310000
153200         MOVE +2                   TO ASC-BLK-SUB                 15320000
153300         PERFORM 5100-WRITE-TEMP-STORAGE                          15330000
153400         MOVE +1                   TO ASC-BLK-SUB                 15340000
153500         MOVE +1                   TO PV-BLOCK-NUMBER             15350000
153600                                                                  15360000
153700         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         15370000
153800             PV-FIRST-BLOCK-IN-ARRAY - 1                          15380000
153900                                                                  15390000
154000         PERFORM                                                  15400000
154100             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       15410000
154200                                                                  15420000
154300             PERFORM 4410-READ-TEMP-STORAGE                       15430000
154400                                                                  15440000
154500             PERFORM 2151-SET-SELECTED-INDS                       15450000
154600                 VARYING ASC-ITEM-SUB                             15460000
154700                 FROM 1 BY 1                                      15470000
154800                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          15480000
154900                                                                  15490000
155000             PERFORM 5100-WRITE-TEMP-STORAGE                      15500000
155100                                                                  15510000
155200             ADD +1                TO PV-BLOCK-NUMBER             15520000
155300                                                                  15530000
155400         END-PERFORM                                              15540000
155500                                                                  15550000
155600         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         15560000
155700             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     15570000
155800                                                                  15580000
155900         PERFORM                                                  15590000
156000             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       15600000
156100                   ASC-HIGHEST-BLOCK-WRITTEN                      15610000
156200                                                                  15620000
156300             MOVE PV-NEXT-BLOCK-IN-ARRAY                          15630000
156400                                   TO PV-BLOCK-NUMBER             15640000
156500                                                                  15650000
156600             PERFORM 4410-READ-TEMP-STORAGE                       15660000
156700                                                                  15670000
156800             PERFORM 2151-SET-SELECTED-INDS                       15680000
156900                 VARYING ASC-ITEM-SUB                             15690000
157000                 FROM 1 BY 1                                      15700000
157100                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          15710000
157200                                                                  15720000
157300             PERFORM 5100-WRITE-TEMP-STORAGE                      15730000
157400                                                                  15740000
157500             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      15750000
157600                                                                  15760000
157700         END-PERFORM                                              15770000
157800                                                                  15780000
157900         MOVE PV-FIRST-BLOCK-IN-ARRAY                             15790000
158000                                   TO PV-BLOCK-NUMBER             15800000
158100                                                                  15810000
158200         PERFORM 4410-READ-TEMP-STORAGE                           15820000
158300     END-IF.                                                      15830000
158400                                                                  15840000
158500                                                                  15850000
158600     MOVE ASC-NUMBER-OF-ITEMS-READ TO                             15860000
158700                       ASC-NUMBER-OF-SELECTED-ITEMS.              15870000
158800                                                                  15880000
158900     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        15890000
159000                                                                  15900000
159100*----------------------------------------------------------------*15910000
159200*    MARK EACH ITEM AS BEING SELECTED.                           *15920000
159300*----------------------------------------------------------------*15930000
159400 2151-SET-SELECTED-INDS.                                          15940000
159500                                                                  15950000
159600     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           15960000
159700             NOT EQUAL ZERO                                       15970000
159800         IF  NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             15980000
159900             SET ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             15990000
160000                 ASC-TEMP-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)        16000000
160100                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  16010000
160200                               TO  TRUE                           16020000
160300         END-IF                                                   16030000
160400     END-IF.                                                      16040000
160500                                                                  16050000
160600******************************************************************16060000
160700** MOVE ALL OF THE FIELDS THAT WERE ENTERED / CHANGED ON THE    **16070000
160800** SCREEN INTO THE COMMAREA.  ALL EDITTING IS DONE IN THE COMM. **16080000
160900******************************************************************16090000
161000 2200-MOVE-SCREEN-TO-COMMAREA.                                    16100000
161100                                                                  16110000
161200     MOVE PV-TOP-ITEM              TO PV-ITEM-IN-USE.             16120000
161300     MOVE +1                       TO PV-SUB.                     16130000
161400*                                                                 16140000
161500     PERFORM 3100-SET-SUBSCRIPTS.                                 16150000
161600     IF  ASTRTITL > ZERO                                          16160000
161700         MOVE ASTRTITI         TO ASC-START-ITEM-REQUEST          16170000
161800     ELSE                                                         16180000
161900         IF  ASTRTITF = DP015-ERASE-EOF                           16190000
162000             INITIALIZE ASC-START-ITEM-REQUEST                    16200000
162100         END-IF                                                   16210000
162200     END-IF.                                                      16220000
162300                                                                  16230000
162400     PERFORM 2210-MOVE-LINES-TO-COMMAREA                          16240000
162500         VARYING PV-SUB                                           16250000
162600         FROM 1 BY 1                                              16260000
162700         UNTIL PV-SUB > ASC-ITEMS-DISPLAYED.                      16270000
162800******************************************************************16280000
162900** MOVE THE ENTERABLE FIELDS ON EACH LIST LINE INTO THE COMMAREA**16290000
163000******************************************************************16300000
163100 2210-MOVE-LINES-TO-COMMAREA.                                     16310000
163200                                                                  16320000
163300     IF MR-SELECTL (PV-SUB) > ZERO                                16330000
163400         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE             16340000
163500         MOVE MR-SELECTI (PV-SUB)   TO ASC-TEMP-SELECTED-SW       16350000
163600                                      (ASC-BLK-SUB, ASC-ITEM-SUB) 16360000
163700     ELSE                                                         16370000
163800         IF  MR-SELECTA (PV-SUB) = DP015-ERASE-EOF                16380000
163900                 SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE     16390000
164000                 MOVE SPACE        TO ASC-TEMP-SELECTED-SW        16400000
164100                                      (ASC-BLK-SUB, ASC-ITEM-SUB) 16410000
164200         END-IF                                                   16420000
164300     END-IF.                                                      16430000
164400                                                                  16440000
164500     ADD +1                        TO ASC-ITEM-SUB.               16450000
164600                                                                  16460020
166500     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        16650000
166600         ADD +1                    TO ASC-BLK-SUB                 16660000
166700         MOVE +1                   TO ASC-ITEM-SUB                16670000
166800     END-IF.                                                      16680000
166900******************************************************************16690000
167000** EDIT ALL OF THE DATA ON THE SCREEN AS IT RESIDES IN THE      **16700000
167100** COMMAREA (EDITTING IS NOT DONE AGAINST THE SCREEN DIRECTLY). **16710000
167200******************************************************************16720000
167300 3000-EDIT-DATA-IN-COMMAREA.                                      16730000
167400                                                                  16740000
167500     SET PS-NO-ERROR               TO TRUE.                       16750000
167600     PERFORM 3200-RESET-ATTRIBUTES.                               16760000
167700     MOVE ASC-ITEMS-DISPLAYED      TO PV-SUB.                     16770000
167800                                                                  16780000
167900**                                                                16790000
168000* CALCULATE THE POSITION OF THE LAST ITEM DISPLAYED.              16800000
168100* EDITTING IS DONE FROM THE BOTTOM UP.                            16810000
168200**                                                                16820000
168300     COMPUTE PV-ITEM-IN-USE = PV-TOP-ITEM +                       16830000
168400         ASC-ITEMS-DISPLAYED - 1.                                 16840000
168500     PERFORM 3100-SET-SUBSCRIPTS.                                 16850000
169000                                                                  16900000
191600     PERFORM 3300-EDIT-SELECTIONS                                 19160000
191700             VARYING PV-SUB  FROM PV-SUB BY -1                    19170000
191800             UNTIL   PV-SUB < +1.                                 19180000
191900                                                                  19190000
191901                                                                  19190100
191902     IF  PS-NO-ERROR                                              19190200
191903         PERFORM 3400-CHECK-RANGE-SEQUENCE                        19190300
191904     END-IF.                                                      19190400
191905*                                                                 19190500
191906     IF  ((PS-NO-ERROR)                                           19190600
191907       AND (ASC-START-OF-SELECTED-RANGE > ZERO)                   19190700
191908       AND (ASC-END-OF-SELECTED-RANGE > ZERO))                    19190800
191909             PERFORM 3500-MARK-RANGE-AS-SELECTED                  19190900
191910     END-IF.                                                      19191000
191911                                                                  19191100
192052*----------------------------------------------------------------*19205200
192053*    DETERMINE THE VALUE OF THE ITEM SUBSCRIPT BASED ON THE ITEM *19205300
192054*    CURRENTLY IN USE AND THE FIRST ITEM IN THE ARRAY.  THIS WILL*19205400
192055*    POSITION US IN THE 1ST BLOCK OF THE ARRAY.                  *19205500
192056*                                                                *19205600
192057*    IF THE ITEM SUBSCRIPT EXCEEDS THE MAXIMUM NUMBER OF ITEMS   *19205700
192058*    IN A BLOCK, RECALCULATE THE SUBSCRIPT BY SUBTRACTING OUT    *19205800
192059*    THE MAXIMUM NUMBER OF ITEMS.  THIS WILL CORRECTLY POSITION  *19205900
192060*    US IN THE 2ND BLOCK OF THE ARRAY.                           *19206000
192061*----------------------------------------------------------------*19206100
192062 3100-SET-SUBSCRIPTS.                                             19206200
192063                                                                  19206300
192064     COMPUTE ASC-ITEM-SUB =                                       19206400
192065         (PV-ITEM-IN-USE - ASC-LIST-ITEM-NUMBER(1 1)) + 1.        19206500
192066                                                                  19206600
192067     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         19206700
192068         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            19206800
192069         MOVE PC-MAX-BLOCKS-IN-ARRAY TO ASC-BLK-SUB               19206900
192070     ELSE                                                         19207000
192071         MOVE +1                     TO ASC-BLK-SUB               19207100
192072     END-IF.                                                      19207200
192073******************************************************************19207300
192074** RESET THE ATTRIBUTES OF ALL ENTERABLE FIELDS ON THE MAP.     **19207400
192075******************************************************************19207500
192076 3200-RESET-ATTRIBUTES.                                           19207600
192077                                                                  19207700
192078     MOVE DP015-UNP-ALP-NOR-OFF    TO ASTRTITA.                   19207800
192079     MOVE DP015-GREEN              TO ASTRTITC.                   19207900
192080     MOVE DP015-UNDERLINE          TO ASTRTITH.                   19208000
192081                                                                  19208100
192082     PERFORM                                                      19208200
192083         VARYING PV-SUB                                           19208300
192084         FROM 1 BY 1                                              19208400
192085         UNTIL PV-SUB > PC-ITEMS-PER-PANEL                        19208500
192086             MOVE DP015-UNP-ALP-NOR-OFF TO MR-SELECTA (PV-SUB)    19208600
192087             MOVE DP015-GREEN         TO MR-SELECTC (PV-SUB)      19208700
192088             MOVE DP015-UNDERLINE     TO MR-SELECTH (PV-SUB)      19208800
192089     END-PERFORM.                                                 19208900
192090                                                                  19209000
192091******************************************************************19209100
192092** CHANGE THE ATTRIBUTES OF ROWS WITH MISSING DATA.               19209200
192093******************************************************************19209300
192094 3250-CHANGE-ATTRIBUTES.                                          19209400
192095                                                                  19209500
192096     MOVE DP015-YELLOW        TO    MR-SMLC (PV-SUB)              19209600
192097                                    MR-CREATEC (PV-SUB)           19209700
192098                                    MR-DEST-NBRC (PV-SUB)         19209800
192099                                    MR-STR-SCANC (PV-SUB)         19209910
192100                                    MR-PO-RCVRC (PV-SUB)          19210010
192101                                    MR-LOAD-STATUSC (PV-SUB)      19210110
192102                                    MR-ACTV-CDEC (PV-SUB)         19210210
192103                                    MR-STAT-DATEC (PV-SUB)        19210310
192104                                    MR-STAT-TIMEC (PV-SUB)        19210410
192105                                    MR-USER-IDC (PV-SUB).         19210510
192106                                                                  19210610
192107******************************************************************19210710
192108** CHANGE THE ATTRIBUTES BACK OF ROWS WITH DATA.                  19210810
192109******************************************************************19210910
192110 3255-CHANGE-ATTRIBUTES-BACK.                                     19211010
192111                                                                  19211110
192112     MOVE DP015-BLUE          TO    MR-SMLC (PV-SUB)              19211210
192113                                    MR-CREATEC (PV-SUB)           19211310
192114                                    MR-DEST-NBRC (PV-SUB)         19211410
192115                                    MR-STR-SCANC (PV-SUB)         19211510
192116                                    MR-PO-RCVRC (PV-SUB)          19211610
192117                                    MR-LOAD-STATUSC (PV-SUB)      19211710
192118                                    MR-ACTV-CDEC (PV-SUB)         19211810
192119                                    MR-STAT-DATEC (PV-SUB)        19211910
192120                                    MR-STAT-TIMEC (PV-SUB)        19212010
192121                                    MR-USER-IDC (PV-SUB).         19212110
192122                                                                  19212210
192123******************************************************************19212310
192124** EDIT THE SELECTIONS MADE.  NOTE THAT THE 'SELECTED-SW' IS    **19212410
192125** WHAT WAS PREVIOUSLY CHECKED AND CORRECT 'TEMP-SELECTED-SW'   **19212510
192126** IS WHAT HAS JUST BEEN ENTERED AND HAS NOT BEEN EDITTED OR    **19212610
192127** WAS ENTERED EARLIER, BUT DID NOT PASS THE EDITS.             **19212710
192128******************************************************************19212810
192129 3300-EDIT-SELECTIONS.                                            19212910
192130                                                                  19213010
192131     EVALUATE TRUE                                                19213110
192132         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     19213210
192133             = ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)         19213310
192134                 CONTINUE                                         19213410
192200         WHEN ASC-TEMP-SELECT  (ASC-BLK-SUB ASC-ITEM-SUB)         19220000
192300             IF  NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)        19230000
192400                 ADD +1         TO ASC-NUMBER-OF-SELECTED-ITEMS   19240000
192500                 MOVE ASC-TEMP-SELECTED-SW                        19250000
192600                                      (ASC-BLK-SUB ASC-ITEM-SUB)  19260000
192700                                TO ASC-SELECTED-SW                19270000
192800                                      (ASC-BLK-SUB ASC-ITEM-SUB)  19280000
192900             END-IF                                               19290000
193000         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     19300000
193100                 = SPACE                                          19310000
193200             EVALUATE TRUE                                        19320000
193300                 WHEN ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)       19330000
193400                     SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS19340000
193500                     MOVE SPACE TO ASC-SELECTED-SW                19350000
193600                                      (ASC-BLK-SUB ASC-ITEM-SUB)  19360000
193601                                    ASC-ACTION                    19360100
193602                                   (ASC-BLK-SUB ASC-ITEM-SUB)     19360200
193700                 WHEN ASC-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)        19370000
193800                     MOVE ZERO  TO ASC-START-OF-SELECTED-RANGE    19380000
193900                     MOVE SPACE TO ASC-SELECTED-SW                19390000
194000                                      (ASC-BLK-SUB ASC-ITEM-SUB)  19400000
194100                 WHEN ASC-END (ASC-BLK-SUB ASC-ITEM-SUB)          19410000
194200                     MOVE ZERO  TO ASC-END-OF-SELECTED-RANGE      19420000
194300                     MOVE SPACE TO ASC-SELECTED-SW                19430000
194400                                      (ASC-BLK-SUB ASC-ITEM-SUB)  19440000
194500             END-EVALUATE                                         19450000
194600         WHEN ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)           19460000
194700             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            19470000
194800                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    19480000
194900             END-IF                                               19490000
195000             PERFORM 3310-EDIT-RANGE                              19500000
195100         WHEN ASC-TEMP-END (ASC-BLK-SUB ASC-ITEM-SUB)             19510000
195200             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            19520000
195300                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    19530000
195400             END-IF                                               19540000
195500             PERFORM 3310-EDIT-RANGE                              19550000
195600         WHEN OTHER                                               19560000
195700             MOVE PC-TSYMSG-00005   TO DP020-MSG-NUMBER           19570000
195800             SET DP020-MSG-FATAL    TO TRUE                       19580000
195900             MOVE -1                TO ASTRTITL                   19590000
196000             SET DP030-SET-CURSOR-APPL-1                          19600000
196100                                    TO TRUE                       19610000
196200             MOVE DP015-RED         TO MR-SELECTC (PV-SUB)        19620000
196300             MOVE DP015-REVERSE     TO MR-SELECTH (PV-SUB)        19630000
196400             SET PS-ERROR TO TRUE                                 19640000
196500             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            19650000
196600                 SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS     19660000
196700                 MOVE SPACE         TO ASC-SELECTED-SW            19670000
196800                                        (ASC-BLK-SUB ASC-ITEM-SUB)19680000
196900             END-IF                                               19690000
197000     END-EVALUATE.                                                19700000
197001                                                                  19700114
197030* F16 - CHILD LIST                                                19703014
197041     IF  DP020-FK-LOCAL-FUNC-06 (DP020-SRC-AID)                   19704114
197042         IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)                19704214
197043             IF  ASC-CREATE (ASC-BLK-SUB ASC-ITEM-SUB) = 'MST'    19704314
197044                 CONTINUE                                         19704414
197045             ELSE                                                 19704514
197046                 MOVE PC-TSYMSG-03387   TO DP020-MSG-NUMBER       19704614
197047                 SET DP020-MSG-FATAL    TO TRUE                   19704714
197048                 MOVE -1                TO ASTRTITL               19704814
197049                 SET DP030-SET-CURSOR-APPL-1                      19704914
197050                                        TO TRUE                   19705014
197051                 MOVE DP015-RED         TO MR-SELECTC (PV-SUB)    19705114
197052                 MOVE DP015-REVERSE     TO MR-SELECTH (PV-SUB)    19705214
197053                 SET PS-ERROR TO TRUE                             19705314
197054                 IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)        19705414
197055                     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS 19705514
197056                     MOVE SPACE         TO ASC-SELECTED-SW        19705614
197057                                       (ASC-BLK-SUB ASC-ITEM-SUB) 19705714
197058                 END-IF                                           19705814
197059             END-IF                                               19705914
197060         END-IF                                                   19706014
197061     END-IF.                                                      19706114
197100                                                                  19710000
197200     SUBTRACT +1             FROM PV-ITEM-IN-USE.                 19720000
197300     SUBTRACT +1 FROM ASC-ITEM-SUB.                               19730000
197400     IF  ASC-ITEM-SUB < 1                                         19740000
197500         SUBTRACT +1 FROM ASC-BLK-SUB                             19750000
197600         MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB                19760000
197700     END-IF.                                                      19770000
197800                                                                  19780000
197900******************************************************************19790000
198000** IF A BEGINNING AND END OF RANGE WAS ENTERED TO SELECT A      **19800000
198100** RANGE OF LINES, MAKE SURE THERE IS ONLY 1 BEGINNING AND 1    **19810000
198200** ENDING AND MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN)**19820000
198300** THE ENDING.                                                  **19830000
198400******************************************************************19840000
198500 3310-EDIT-RANGE.                                                 19850000
198600                                                                  19860000
198700     IF  ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)                19870000
198800         IF  ASC-START-OF-SELECTED-RANGE = ZERO                   19880000
198900             MOVE ASC-TEMP-SELECTED-SW  (ASC-BLK-SUB ASC-ITEM-SUB)19890000
199000                                   TO ASC-SELECTED-SW             19900000
199100                                        (ASC-BLK-SUB ASC-ITEM-SUB)19910000
199200             MOVE PV-ITEM-IN-USE   TO ASC-START-OF-SELECTED-RANGE 19920000
199300         ELSE                                                     19930000
199400             IF  ASC-START-OF-SELECTED-RANGE = PV-ITEM-IN-USE     19940000
199500                 CONTINUE                                         19950000
199600             ELSE                                                 19960000
199700*                -- ONLY ONE BEGINNING-OF-RANGE-ALLOWED --        19970000
199800                 MOVE PC-TSYMSG-00054                             19980000
199900                                       TO DP020-MSG-NUMBER        19990000
200000                 MOVE -1               TO ASTRTITL                20000000
200100                 SET DP020-MSG-FATAL                              20010000
200200                     DP030-SET-CURSOR-APPL-1                      20020000
200300                     PS-ERROR          TO TRUE                    20030000
200400             END-IF                                               20040000
200500         END-IF                                                   20050000
200600     ELSE                                                         20060000
200700         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     20070000
200800             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 20080000
200900                                   TO ASC-SELECTED-SW             20090000
201000                                     (ASC-BLK-SUB ASC-ITEM-SUB)   20100000
201100             MOVE PV-ITEM-IN-USE   TO ASC-END-OF-SELECTED-RANGE   20110000
201200         ELSE                                                     20120000
201300             IF  ASC-END-OF-SELECTED-RANGE = PV-ITEM-IN-USE       20130000
201400                 CONTINUE                                         20140000
201500             ELSE                                                 20150000
201600*                -- ONLY ONE END-OF-RANGE ALLOWED --              20160000
201700                 MOVE PC-TSYMSG-00055                             20170000
201800                                        TO DP020-MSG-NUMBER       20180000
201900                 MOVE -1                TO ASTRTITL               20190000
202000                 SET DP020-MSG-FATAL                              20200000
202100                     DP030-SET-CURSOR-APPL-1                      20210000
202200                     PS-ERROR           TO TRUE                   20220000
202300             END-IF                                               20230000
202400         END-IF                                                   20240000
202500     END-IF.                                                      20250000
202600*                                                                 20260000
202700******************************************************************20270000
202800** IF BOTH A BEGINNING AND END OF RANGE HAVE BEEN SPECIFIED,    **20280000
202900** MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN) THE END.  **20290000
203000******************************************************************20300000
203100 3400-CHECK-RANGE-SEQUENCE.                                       20310000
203200                                                                  20320000
203300     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       20330000
203400       AND  ASC-END-OF-SELECTED-RANGE > ZERO                      20340000
203500       AND  ASC-START-OF-SELECTED-RANGE >                         20350000
203600                                         ASC-END-OF-SELECTED-RANGE20360000
203700*        -- END-OF-RANGE BEFORE BEGINNING-OF-RANGE                20370000
203800         MOVE PC-TSYMSG-00052 TO DP020-MSG-NUMBER                 20380000
203900         SET DP020-MSG-FATAL TO TRUE                              20390000
204000         SET PS-ERROR TO TRUE                                     20400000
204100         PERFORM 3410-POSITION-AT-ERROR                           20410000
204200     END-IF.                                                      20420000
204300******************************************************************20430000
204400** BECAUSE RANGES CAN SPAN ACROSS MULTIPLE PAGES, A SEPARATE    **20440000
204500** PARAGRAPH (THIS ONE) IS NEEDED TO DETERMINE WHERE THE CURSOR **20450000
204600** SHOULD BE POSITIONED ON A RANGE ERROR.                       **20460000
204700******************************************************************20470000
204800 3410-POSITION-AT-ERROR.                                          20480000
204900                                                                  20490000
205000     SET DP030-SET-CURSOR-APPL-1                                  20500000
205100                                   TO TRUE.                       20510000
205200     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 20520000
205300                    - PV-TOP-ITEM + 1.                            20530000
205400     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      20540000
205500         CONTINUE                                                 20550000
205600     ELSE                                                         20560000
205700         MOVE -1                   TO MR-SELECTL (PV-SUB)         20570000
205800         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         20580000
205900         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         20590000
206000     END-IF.                                                      20600000
206100*                                                                 20610000
206200     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   20620000
206300                    - PV-TOP-ITEM + 1.                            20630000
206400     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      20640000
206500         CONTINUE                                                 20650000
206600     ELSE                                                         20660000
206700         MOVE -1                   TO MR-SELECTL (PV-SUB)         20670000
206800         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         20680000
206900         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         20690000
207000     END-IF.                                                      20700000
207100                                                                  20710000
207200*----------------------------------------------------------------*20720000
207300*    WHENEVER THE USER SELECTS AN ITEM AS THE BEGINNING RANGE    *20730000
207400*    AND ONE AS THE ENDING RANGE, MARK THESE ITEMS AS WELL AS    *20740000
207500*    THOSE THAT FALL IN THE RANGE AS BEING SELECTED.             *20750000
207600*----------------------------------------------------------------*20760000
207700 3500-MARK-RANGE-AS-SELECTED.                                     20770000
207800                                                                  20780000
207900     MOVE +1                       TO  ASC-BLK-SUB.               20790000
208000     PERFORM 3510-MARK-SELECTED-INDS                              20800000
208100         VARYING ASC-ITEM-SUB                                     20810000
208200         FROM 1 BY 1                                              20820000
208300         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 20830000
208400                                                                  20840000
208500     ADD +1                        TO ASC-BLK-SUB.                20850000
208600     PERFORM 3510-MARK-SELECTED-INDS                              20860000
208700         VARYING ASC-ITEM-SUB                                     20870000
208800         FROM 1 BY 1                                              20880000
208900         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 20890000
209000                                                                  20900000
209100     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               20910000
209200                                   TO  PV-LIST-ITEM-NUMBER.       20920000
209300     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            20930000
209400         1 + ((PV-LIST-ITEM-NUMBER - 1) /                         20940000
209500               PC-ITEMS-PER-PANEL).                               20950000
209600                                                                  20960000
209700     MOVE ASC-START-OF-SELECTED-RANGE                             20970000
209800                                   TO PV-START-OF-SELECTED-RANGE. 20980000
209900     COMPUTE PV-FIRST-BLOCK-IN-RANGE =                            20990000
210000         1 + ((PV-START-OF-SELECTED-RANGE - 1) /                  21000000
210100               PC-ITEMS-PER-PANEL).                               21010000
210200                                                                  21020000
210300     MOVE ASC-END-OF-SELECTED-RANGE                               21030000
210400                                   TO  PV-END-OF-SELECTED-RANGE.  21040000
210500     COMPUTE PV-LAST-BLOCK-IN-RANGE =                             21050000
210600         1 + ((PV-END-OF-SELECTED-RANGE - 1) /                    21060000
210700               PC-ITEMS-PER-PANEL).                               21070000
210800     COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                             21080000
210900         PV-FIRST-BLOCK-IN-ARRAY + 1.                             21090000
211000                                                                  21100000
211100     IF (PV-FIRST-BLOCK-IN-RANGE < PV-FIRST-BLOCK-IN-ARRAY) OR    21110000
211200        (PV-LAST-BLOCK-IN-RANGE  > PV-NEXT-BLOCK-IN-ARRAY)        21120000
211300         MOVE +1                   TO ASC-BLK-SUB                 21130000
211400         PERFORM 5100-WRITE-TEMP-STORAGE                          21140000
211500         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         21150000
211600             PV-FIRST-BLOCK-IN-ARRAY - 1                          21160000
211700                                                                  21170000
211800         PERFORM                                                  21180000
211900             UNTIL PV-FIRST-BLOCK-IN-RANGE >                      21190000
212000                   PV-PREV-BLOCK-IN-ARRAY                         21200000
212100             MOVE PV-FIRST-BLOCK-IN-RANGE                         21210000
212200                                   TO PV-BLOCK-NUMBER             21220000
212300             PERFORM 4410-READ-TEMP-STORAGE                       21230000
212400             PERFORM 3510-MARK-SELECTED-INDS                      21240000
212500                 VARYING ASC-ITEM-SUB                             21250000
212600                 FROM 1 BY 1                                      21260000
212700                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          21270000
212800             PERFORM 5100-WRITE-TEMP-STORAGE                      21280000
212900             ADD +1                TO PV-FIRST-BLOCK-IN-RANGE     21290000
213000         END-PERFORM                                              21300000
213100                                                                  21310000
213200         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         21320000
213300             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     21330000
213400         PERFORM                                                  21340000
213500             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       21350000
213600                   PV-LAST-BLOCK-IN-RANGE                         21360000
213700             MOVE PV-NEXT-BLOCK-IN-ARRAY                          21370000
213800                                   TO PV-BLOCK-NUMBER             21380000
213900             PERFORM 4410-READ-TEMP-STORAGE                       21390000
214000             PERFORM 3510-MARK-SELECTED-INDS                      21400000
214100                 VARYING ASC-ITEM-SUB                             21410000
214200                 FROM 1 BY 1                                      21420000
214300                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          21430000
214400             PERFORM 5100-WRITE-TEMP-STORAGE                      21440000
214500             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      21450000
214600         END-PERFORM                                              21460000
214700                                                                  21470000
214800         MOVE PV-FIRST-BLOCK-IN-ARRAY                             21480000
214900                                   TO PV-BLOCK-NUMBER             21490000
215000         PERFORM 4410-READ-TEMP-STORAGE                           21500000
215100     END-IF.                                                      21510000
215200                                                                  21520000
215300     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE 21530000
215400                                      ASC-END-OF-SELECTED-RANGE.  21540000
215500                                                                  21550000
215600*----------------------------------------------------------------*21560000
215700* SET THE SELECTION INDICATOR TO 'S' WITHIN THE RANGE.           *21570000
215800*----------------------------------------------------------------*21580000
215900 3510-MARK-SELECTED-INDS.                                         21590000
216000                                                                  21600000
216100     IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         21610000
216200                                ASC-ITEM-SUB) >                   21620000
216300         ASC-START-OF-SELECTED-RANGE)                             21630000
216400     OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         21640000
216500                                ASC-ITEM-SUB) =                   21650000
216600         ASC-START-OF-SELECTED-RANGE)                             21660000
216700                                                                  21670000
216800         IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     21680000
216900                                    ASC-ITEM-SUB) <               21690000
217000             ASC-END-OF-SELECTED-RANGE)                           21700000
217100         OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     21710000
217200                                    ASC-ITEM-SUB) =               21720000
217300             ASC-END-OF-SELECTED-RANGE)                           21730000
217400                                                                  21740000
217500             IF NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          21750000
217600                 SET ASC-SELECT     (ASC-BLK-SUB  ASC-ITEM-SUB)   21760000
217700                     ASC-TEMP-SELECT(ASC-BLK-SUB  ASC-ITEM-SUB)   21770000
217800                               TO TRUE                            21780000
217900                 SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB)              21790000
218000                               TO TRUE                            21800000
218100                 ADD +1        TO ASC-NUMBER-OF-SELECTED-ITEMS    21810000
218200             END-IF                                               21820000
218300         END-IF                                                   21830000
218400     END-IF.                                                      21840000
218500                                                                  21850000
218600*----------------------------------------------------------------*21860000
218700* RETRIEVE START TMST FOR SML SELECTED.                           21870000
218800*----------------------------------------------------------------*21880000
218900 3600-RETRIEVE-START-TMST.                                        21890000
219000                                                                  21900000
219100     MOVE SU010-SML (SU010-IDX) TO DK-SML-NBR.                    21910000
219200     EXEC SQL                                                     21920000
219300          SELECT A.DIVERT_TMST                                    21930000
219400            INTO :DK-START-TMST                                   21940000
219500            FROM TSUCRDV A                                        21950000
219600           WHERE A.OPER_UNT_ID     = :DK-OPER-UNT-ID              21960000
219700             AND A.SHIPT_UNT_ID    = :DK-SML-NBR                  21970000
219800             AND A.DIVERT_TMST IN                                 21980000
219900               (SELECT MAX(B.DIVERT_TMST)                         21990000
220000                  FROM TSUCRDV B                                  22000000
220100                 WHERE B.OPER_UNT_ID =  :DK-OPER-UNT-ID           22010000
220200                   AND B.SHIPT_UNT_ID = :DK-SML-NBR)              22020000
220300      END-EXEC                                                    22030000
220400                                                                  22040000
220500      EVALUATE TRUE                                               22050000
220600          WHEN SQLCODE = +0                                       22060000
220700              SET  PS-NO-ERROR  TO TRUE                           22070000
220800          WHEN OTHER                                              22080000
220900              MOVE SU010-STAT-DATE(SU010-IDX) TO                  22090000
221000                                      PV-DATE-DISPLAY             22100000
221100              MOVE SU010-STAT-TIME(SU010-IDX) TO                  22110000
221200                                      PV-TIME-DISPLAY             22120000
221300              MOVE PV-DISPLAY-MM    TO  PV-DT-MM                  22130000
221400              MOVE PV-DISPLAY-YY    TO  PV-DT-YY                  22140000
221500              MOVE PV-DISPLAY-DD    TO  PV-DT-DD                  22150000
221600              MOVE PV-DISPLAY-HRS   TO  PV-DT-HRS                 22160000
221700              MOVE PV-DISPLAY-MIN   TO  PV-DT-MIN                 22170000
221800              MOVE PV-DATE-TIME     TO  DK-START-TMST             22180000
221900     END-EVALUATE.                                                22190000
222000                                                                  22200000
222100*-----------------------------------------------------------------22210000
222200*  CHECK TRIP TO SEE IF IT IS OPEN                                22220000
222300*-----------------------------------------------------------------22230000
222400 3650-CHECK-4-OPEN-TRIP.                                          22240000
222500                                                                  22250000
222600     MOVE ASC-OPER-UNT-ID       TO DK-OPER-UNT-ID.                22260000
222700     MOVE ASC-OUTBOUND-TRIP-ID  TO DK-TRIP-ID.                    22270000
222800     EXEC SQL                                                     22280000
222900          SELECT  A.OTBND_TRIP_ID                                 22290000
223000                , A.TRIP_STAT_CDE                                 22300000
223100                , B.DEST_OPER_UNT_ID                              22310000
223200                , B.TRLR_SRL_NBR                                  22320000
223300            INTO  :SUOBTS-OTBND-TRIP-ID                           22330000
223400                , :SUOBTS-TRIP-STAT-CDE                           22340000
223500                , :SUOBTR-DEST-OPER-UNT-ID                        22350000
223600                , :SUOBTR-TRLR-SRL-NBR                            22360000
223700            FROM  TSUOBTS A                                       22370000
223800                , TSUOBTR B                                       22380000
223900           WHERE  A.STAT_OPER_UNT_ID  =  :DK-OPER-UNT-ID          22390000
224000             AND  A.OTBND_TRIP_ID     =  :DK-TRIP-ID              22400000
224100             AND  A.OTBND_TRIP_ID     =  B.OTBND_TRIP_ID          22410000
224200             AND  A.STAT_OPER_UNT_ID  =  B.ORGN_OPER_UNT_ID       22420000
224300             AND OTBND_STAT_TMST =                                22430000
224400                     (SELECT MAX(C.OTBND_STAT_TMST)               22440000
224500                FROM TSUOBTS C                                    22450000
224600               WHERE A.OTBND_TRIP_ID  =  C.OTBND_TRIP_ID)         22460000
224700     END-EXEC.                                                    22470000
224800      EVALUATE TRUE                                               22480000
224900          WHEN SQLCODE = +0                                       22490000
225000          WHEN SQLCODE = -811                                     22500000
225100              EVALUATE TRUE                                       22510000
225200                  WHEN SUOBTS-TRIP-STAT-CDE = 'DO'                22520000
225300                      SET PS-TRIP-OPEN  TO  TRUE                  22530000
225400                  WHEN SUOBTS-TRIP-STAT-CDE = 'AO'                22540000
225500                      SET PS-AUDIT-OPEN TO  TRUE                  22550000
225600                  WHEN SUOBTS-TRIP-STAT-CDE = 'AK'                22560000
225700                      SET PS-AUDIT-CLOSED TO TRUE                 22570000
225800                  WHEN SUOBTS-TRIP-STAT-CDE = 'DC'                22580000
225900                      SET PS-TRLR-CLOSED TO TRUE                  22590000
226000                  WHEN OTHER                                      22600000
226100                      SET PS-TRIP-NOT-OPEN TO TRUE                22610000
226200              END-EVALUATE                                        22620000
226300          WHEN OTHER                                              22630000
226400               SET PS-TRIP-NOT-OPEN  TO  TRUE                     22640000
226500     END-EVALUATE.                                                22650000
226600                                                                  22660000
226700*----------------------------------------------------------------*22670000
226800* MAKE SURE THAT THERE IS A BEGIN CUTOFF WITHOUT AN END CUTOFF   *22680000
226900*----------------------------------------------------------------*22690000
227000 3700-CHECK-4-END-CUTOFF.                                         22700000
227100                                                                  22710000
227200     MOVE ASC-DOOR-ID           TO DK-DOOR-ID.                    22720000
227300     MOVE ASC-TRIP-DEST-OPER    TO DK-STORE-NUMBER.               22730000
227400     EXEC SQL                                                     22740000
227500          SELECT STRT_DIVERT_TMST                                 22750000
227600            INTO :SUCDOT-STRT-DIVERT-TMST                         22760000
227700            FROM TSUCDOT                                          22770000
227800           WHERE OTBND_TRIP_ID   = :DK-TRIP-ID                    22780000
227900             AND END_DIVERT_TMST = :DK-PC-DEFAULT-TMST            22790000
228000      END-EXEC                                                    22800000
228100                                                                  22810000
228200      EVALUATE TRUE                                               22820000
228300          WHEN SQLCODE = +0                                       22830000
228400               IF DK-START-TMST > SUCDOT-STRT-DIVERT-TMST         22840000
228500                   SET PS-NO-ERROR TO TRUE                        22850000
228600               ELSE                                               22860000
228700                   SET PS-ERROR                                   22870000
228800                       DP020-MSG-FATAL TO TRUE                    22880000
228900                   MOVE PC-TSYMSG-02799 TO DP020-MSG-NUMBER       22890000
229000               END-IF                                             22900000
229100          WHEN SQLCODE = +100                                     22910000
229200               SET  PS-ERROR                                      22920000
229300                    DP020-MSG-FATAL TO TRUE                       22930000
229400               MOVE PC-TSYMSG-02792 TO DP020-MSG-NUMBER           22940000
229500          WHEN OTHER                                              22950000
229600               SET PS-ERROR TO TRUE                               22960000
229700     END-EVALUATE.                                                22970000
229800                                                                  22980000
229900*----------------------------------------------------------------*22990000
230000* IF THERE ARE NO ERRORS, UPDATE ROW ON TSUCDOT.                  23000000
230100*----------------------------------------------------------------*23010000
230200 3710-UPDATE-TSUCDOT.                                             23020000
230300                                                                  23030000
230400     EXEC SQL                                                     23040000
230500          UPDATE TSUCDOT                                          23050000
230600             SET END_DIVERT_TMST     =  :DK-START-TMST            23060000
230700                ,END_SCN_TMST        =  CURRENT TIMESTAMP         23070000
230800                ,END_SCN_USR_ID      =  :DP020-USERID             23080000
230900          WHERE OTBND_TRIP_ID        =  :DK-TRIP-ID               23090000
231000            AND END_DIVERT_TMST      =  :DK-PC-DEFAULT-TMST       23100000
231100      END-EXEC                                                    23110000
231200                                                                  23120000
231300      EVALUATE TRUE                                               23130000
231400          WHEN SQLCODE = +0                                       23140000
231500               MOVE 'SUKCS561' TO SUT00006-CRE-BY-PGM-NM          23150000
231600               PERFORM 7400-INSERT-WRKR-AUD                       23160000
231700                                                                  23170000
231800               SET PS-REBUILD-AFTER-UPDATE  TO  TRUE              23180000
231900               PERFORM 3720-SYNCPOINT                             23190000
232000               PERFORM 2050-DELETE-LIST-QUEUE                     23200000
232100               PERFORM 3200-RESET-ATTRIBUTES                      23210000
232200               PERFORM 4000-BUILD-INITIAL-PANEL                   23220000
232300              MOVE PC-TSYMSG-02796  TO  DP020-MSG-NUMBER          23230000
232400          WHEN SQLCODE = -904                                     23240000
232500          WHEN SQLCODE = -911                                     23250000
232600          WHEN SQLCODE = -913                                     23260000
232700               SET  PS-ERROR                                      23270000
232800                    DP020-MSG-FATAL TO TRUE                       23280000
232900              MOVE PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          23290000
233000          WHEN OTHER                                              23300000
233100               SET  PS-ERROR                                      23310000
233200                    DP020-MSG-FATAL TO TRUE                       23320000
233300              MOVE PC-TSYMSG-00551  TO  DP020-MSG-NUMBER          23330000
233400     END-EVALUATE.                                                23340000
233500                                                                  23350000
233600                                                                  23360000
233700 3720-SYNCPOINT.                                                  23370000
233800                                                                  23380000
233900         EXEC CICS                                                23390000
234000              SYNCPOINT                                           23400000
234100         END-EXEC.                                                23410000
234200                                                                  23420000
234300                                                                  23430000
234400*----------------------------------------------------------------*23440000
234500*    INITIALIZE BOTH BLOCKS IN THE ARRAY.                        *23450000
234600*    INITIALIZE ALL COUNTERS AND FLAGS.                          *23460000
234700*    READ THE DATA BASE FOR THE 1ST TIME AND FILL UP THE ARRAY.  *23470000
234800*    DISPLAY THE PANEL TO USER.                                  *23480000
234900*----------------------------------------------------------------*23490000
235000 4000-BUILD-INITIAL-PANEL.                                        23500000
235100                                                                  23510000
235200     INITIALIZE                  ASC-BLOCK-ENTRIES (1)            23520000
235300                                 ASC-BLOCK-ENTRIES (2).           23530000
235400     MOVE +1                 TO ASC-BLK-SUB.                      23540000
235500     SET ASC-ITEMS-LEFT-ON-DB                                     23550000
235600                             TO TRUE.                             23560000
235700                                                                  23570000
235800     MOVE +0                 TO ASC-ITEM-SUB                      23580000
235900                                ASC-NUMBER-OF-ITEMS-READ          23590000
236000                                ASC-NUMBER-OF-SELECTED-ITEMS      23600000
236100                                ASC-HIGHEST-BLOCK-WRITTEN         23610000
236200                                ASC-START-OF-SELECTED-RANGE       23620000
236300                                ASC-END-OF-SELECTED-RANGE         23630000
236400                                ASC-ITEM-AT-TOP-OF-PANEL          23640000
236500                                ASC-TOTAL                         23650000
236600                                ASC-MANUAL                        23660000
236700                                ASC-DIVERT                        23670000
236800                                ASC-ASSUMED.                      23680000
236900                                                                  23690000
237000     PERFORM 4050-SELECT-INFORMATION.                             23700000
237100     PERFORM 4051-RETRIEVE-TMST.                                  23710000
237200     IF PC049-DIVERT-CUTOFFS-NO                                   23720000
237300        MOVE  DK-PC-DEFAULT-TMST                                  23730000
237400          TO  PC049-DK-START-TMST                                 23740000
237500        MOVE  DK-PC-DEFAULT-TMST                                  23750000
237600          TO  PC049-DK-END-TMST                                   23760000
237700     END-IF.                                                      23770000
237800     PERFORM 4100-OPEN-CURSOR.                                    23780000
237900     IF PC049-SHTL-DVRT-CRTN-CSR OR PC049-SHIP-DVRT-CRTN-CSR      23790000
238000         PERFORM 4300-READ-ITEMS-FROM-DB                          23800000
238100     ELSE                                                         23810000
238200         IF PC049-SCAN-ON-CRTN-CSR                                23820000
238300             PERFORM 4305-READ-ITEMS-FROM-DB                      23830000
238400         ELSE                                                     23840000
238500             IF PC049-SHP-TR-ALL-CTN-CSR OR                       23850000
238600                PC049-SHTL-TR-AL-CTN-CSR                          23860000
238700                    PERFORM 4306-READ-ITEMS-FROM-DB               23870000
238800             END-IF                                               23880000
238900         END-IF                                                   23890000
239000     END-IF.                                                      23900000
239100     PERFORM 4200-CLOSE-CURSOR                                    23910000
239200                                                                  23920000
239300     MOVE +1                   TO  PV-TOP-ITEM.                   23930000
239400                                                                  23940000
239500*    IF MORE THAN ONE ITEM WAS SELECTED, SHOW A BLANK LIST        23950000
239600*    FOR THOSE ITEMS THAT WERE NOT FOUND.  THIS ALLOWS THE USER   23960000
239700*    TO BROWSE THRU THEIR SELECTIONS WITHOUT JUMPING BACK TO      23970000
239800*    THE ORIGINAL SCREEN.                                         23980000
239900     EVALUATE TRUE                                                23990000
240000         WHEN SU010-SELECTED-ITEMS > 1                            24000000
240100             IF  ASC-NUMBER-OF-ITEMS-READ = ZERO                  24010000
240200                 SET DP020-MSG-WARNING TO  TRUE                   24020000
240300                 MOVE PC-TSYMSG-00050  TO  DP020-MSG-NUMBER       24030000
240400                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              24040000
240500                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             24050000
240600             ELSE                                                 24060000
240700                 MOVE -1               TO MR-SELECTL (1)          24070000
240800                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              24080000
240900                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             24090000
241000             END-IF                                               24100000
241100         WHEN ASC-ERROR-CARTON                                    24110000
241200             IF  ASC-NUMBER-OF-ITEMS-READ = ZERO                  24120000
241300                 SET DP020-MSG-WARNING TO  TRUE                   24130000
241400                 MOVE PC-TSYMSG-00050  TO  DP020-MSG-NUMBER       24140000
241500                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              24150000
241600                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             24160000
241700             ELSE                                                 24170000
241800                 MOVE -1               TO MR-SELECTL (1)          24180000
241900                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              24190000
242000                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             24200000
242100             END-IF                                               24210000
242200         WHEN OTHER                                               24220000
242300             IF  ASC-NUMBER-OF-ITEMS-READ = ZERO                  24230000
242400                 SET DP020-NEXT-ACT-APPL-ERROR TO TRUE            24240000
242500                 SET DP020-MSG-FATAL   TO  TRUE                   24250000
242600                 MOVE PC-TSYMSG-00050  TO  DP020-MSG-NUMBER       24260000
242700             ELSE                                                 24270000
242800                 MOVE -1               TO MR-SELECTL (1)          24280000
242900                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              24290000
243000                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             24300000
243100             END-IF                                               24310000
243200     END-EVALUATE.                                                24320000
243300                                                                  24330000
243400*----------------------------------------------------------------*24340000
243500*    FILL TOP OF SCREEN WITH DATA                                 24350000
243600*----------------------------------------------------------------*24360000
243700 4050-SELECT-INFORMATION.                                         24370000
243800                                                                  24380000
243900     MOVE ASC-OPER-UNT-ID       TO  DK-OPER-UNT-ID.               24390000
244000     MOVE ASC-OUTBOUND-TRIP-ID  TO  DK-TRIP-ID.                   24400000
244100     MOVE ASC-TRLR-SRL-NMBR     TO  DK-TRLR-SRL-NBR.              24410000
244200                                                                  24420000
244300     IF ASC-TRLR-SRL-NMBR > ZERO AND                              24430000
244400        ASC-OUTBOUND-TRIP-ID > ZERO                               24440000
244500         EXEC SQL                                                 24450000
244600             SELECT  A.TRLR_SRL_NBR                               24460000
244700                    ,A.OTBND_TRIP_ID                              24470000
244800                    ,A.DEST_OPER_UNT_ID                           24480000
244900                    ,B.SHIP_SCAC_CDE                              24490000
245000                    ,B.DOOR_ID                                    24500000
245100                    ,B.TRLR_PRKG_LOC_DESC                         24510000
245200                    ,B.TRLR_PRKG_SLOT_NBR                         24520000
245210                    ,B.TRIP_STAT_CDE                              24521008
245220                    ,B.OTBND_STAT_TMST                            24522008
245300                    ,C.TRLR_ID                                    24530000
245400                    ,D.DOOR_TYP_CDE                               24540000
245500              INTO  :SUOBTR-TRLR-SRL-NBR                          24550000
245600                   ,:SUOBTR-OTBND-TRIP-ID                         24560000
245700                   ,:SUOBTR-DEST-OPER-UNT-ID                      24570000
245800                   ,:SUOBTS-SHIP-SCAC-CDE                         24580000
245900                   ,:SUOBTS-DOOR-ID                               24590000
246000                   ,:SUOBTS-TRLR-PRKG-LOC-DESC                    24600000
246100                   ,:SUOBTS-TRLR-PRKG-SLOT-NBR                    24610000
246110                   ,:SUOBTS-TRIP-STAT-CDE                         24611008
246120                   ,:SUOBTS-OTBND-STAT-TMST                       24612008
246200                   ,:CNTRID-TRLR-ID                               24620000
246300                   ,:CNDCDR-DOOR-TYP-CDE                          24630000
246400               FROM  TSUOBTR A                                    24640000
246500                    ,TSUOBTS B                                    24650000
246600                    ,TCNTRID C                                    24660000
246700                    ,TCNDCDR D                                    24670000
246800              WHERE  A.TRLR_SRL_NBR     = :DK-TRLR-SRL-NBR        24680000
247000                AND  A.TRIP_ACTV_CDE    = 'A'                     24700000
247100                AND  A.OTBND_TRIP_ID    = :DK-TRIP-ID             24710000
247200                AND  A.OTBND_TRIP_ID    = B.OTBND_TRIP_ID         24720000
247300                AND  A.TRLR_SRL_NBR     = C.TRLR_SRL_NBR          24730000
247400                AND  A.ORGN_OPER_UNT_ID = D.OPER_UNT_ID           24740000
247500                AND  B.DOOR_ID          = D.DOOR_ID               24750000
247600                AND OTBND_STAT_TMST =                             24760000
247700                      (SELECT MAX(D.OTBND_STAT_TMST)              24770000
247800                 FROM TSUOBTS D                                   24780000
247900                WHERE B.OTBND_TRIP_ID  =  D.OTBND_TRIP_ID)        24790000
248000         END-EXEC                                                 24800000
248100     ELSE                                                         24810000
248200         IF ASC-TRLR-SRL-NMBR > ZERO AND                          24820000
248300            ASC-OUTBOUND-TRIP-ID = ZERO                           24830000
248400         EXEC SQL                                                 24840000
248500             SELECT  A.TRLR_SRL_NBR                               24850000
248600                    ,A.OTBND_TRIP_ID                              24860000
248700                    ,A.DEST_OPER_UNT_ID                           24870000
248800                    ,B.SHIP_SCAC_CDE                              24880000
248900                    ,B.DOOR_ID                                    24890000
249000                    ,B.TRLR_PRKG_LOC_DESC                         24900000
249100                    ,B.TRLR_PRKG_SLOT_NBR                         24910000
249110                    ,B.TRIP_STAT_CDE                              24911008
249120                    ,B.OTBND_STAT_TMST                            24912008
249200                    ,C.TRLR_ID                                    24920000
249300                    ,D.DOOR_TYP_CDE                               24930000
249400              INTO  :SUOBTR-TRLR-SRL-NBR                          24940000
249500                   ,:SUOBTR-OTBND-TRIP-ID                         24950000
249600                   ,:SUOBTR-DEST-OPER-UNT-ID                      24960000
249700                   ,:SUOBTS-SHIP-SCAC-CDE                         24970000
249800                   ,:SUOBTS-DOOR-ID                               24980000
249900                   ,:SUOBTS-TRLR-PRKG-LOC-DESC                    24990000
250000                   ,:SUOBTS-TRLR-PRKG-SLOT-NBR                    25000000
250010                   ,:SUOBTS-TRIP-STAT-CDE                         25001008
250020                   ,:SUOBTS-OTBND-STAT-TMST                       25002008
250100                   ,:CNTRID-TRLR-ID                               25010000
250200                   ,:CNDCDR-DOOR-TYP-CDE                          25020000
250300               FROM  TSUOBTR A                                    25030000
250400                    ,TSUOBTS B                                    25040000
250500                    ,TCNTRID C                                    25050000
250600                    ,TCNDCDR D                                    25060000
250700              WHERE  A.TRLR_SRL_NBR     = :DK-TRLR-SRL-NBR        25070000
250900                AND  A.TRIP_ACTV_CDE    = 'A'                     25090000
251000                AND  A.OTBND_TRIP_ID    = B.OTBND_TRIP_ID         25100000
251100                AND  A.TRLR_SRL_NBR     = C.TRLR_SRL_NBR          25110000
251200                AND  A.ORGN_OPER_UNT_ID = D.OPER_UNT_ID           25120000
251300                AND  B.DOOR_ID          = D.DOOR_ID               25130000
251400                AND OTBND_STAT_TMST =                             25140000
251500                      (SELECT MAX(D.OTBND_STAT_TMST)              25150000
251600                 FROM TSUOBTS D                                   25160000
251700                WHERE B.OTBND_TRIP_ID  =  D.OTBND_TRIP_ID)        25170000
251800         END-EXEC                                                 25180000
251900     ELSE                                                         25190000
252000         IF ASC-OUTBOUND-TRIP-ID > ZERO                           25200000
252100             EXEC SQL                                             25210000
252200                 SELECT  A.TRLR_SRL_NBR                           25220000
252300                        ,A.OTBND_TRIP_ID                          25230000
252400                        ,A.DEST_OPER_UNT_ID                       25240000
252500                        ,B.SHIP_SCAC_CDE                          25250000
252600                        ,B.DOOR_ID                                25260000
252700                        ,B.TRLR_PRKG_LOC_DESC                     25270000
252800                        ,B.TRLR_PRKG_SLOT_NBR                     25280000
252810                        ,B.TRIP_STAT_CDE                          25281008
252820                        ,B.OTBND_STAT_TMST                        25282008
252900                        ,C.TRLR_ID                                25290000
253000                        ,D.DOOR_TYP_CDE                           25300000
253100                  INTO  :SUOBTR-TRLR-SRL-NBR                      25310000
253200                       ,:SUOBTR-OTBND-TRIP-ID                     25320000
253300                       ,:SUOBTR-DEST-OPER-UNT-ID                  25330000
253400                       ,:SUOBTS-SHIP-SCAC-CDE                     25340000
253500                       ,:SUOBTS-DOOR-ID                           25350000
253600                       ,:SUOBTS-TRLR-PRKG-LOC-DESC                25360000
253700                       ,:SUOBTS-TRLR-PRKG-SLOT-NBR                25370000
253710                       ,:SUOBTS-TRIP-STAT-CDE                     25371008
253720                       ,:SUOBTS-OTBND-STAT-TMST                   25372008
253800                       ,:CNTRID-TRLR-ID                           25380000
253900                       ,:CNDCDR-DOOR-TYP-CDE                      25390000
254000                   FROM  TSUOBTR A                                25400000
254100                        ,TSUOBTS B                                25410000
254200                        ,TCNTRID C                                25420000
254300                        ,TCNDCDR D                                25430000
254400                  WHERE  A.OTBND_TRIP_ID    = :DK-TRIP-ID         25440000
254600                    AND  A.TRIP_ACTV_CDE    = 'A'                 25460000
254700                    AND  A.OTBND_TRIP_ID    = B.OTBND_TRIP_ID     25470000
254800                    AND  A.TRLR_SRL_NBR     = C.TRLR_SRL_NBR      25480000
254900                    AND  A.ORGN_OPER_UNT_ID = D.OPER_UNT_ID       25490000
255000                    AND  B.DOOR_ID          = D.DOOR_ID           25500000
255100                    AND OTBND_STAT_TMST =                         25510000
255200                          (SELECT MAX(D.OTBND_STAT_TMST)          25520000
255300                     FROM TSUOBTS D                               25530000
255400                    WHERE B.OTBND_TRIP_ID  =  D.OTBND_TRIP_ID)    25540000
255500             END-EXEC                                             25550000
255600         END-IF                                                   25560000
255700       END-IF                                                     25570000
255800     END-IF.                                                      25580000
255900                                                                  25590000
256000     EVALUATE TRUE                                                25600000
256100         WHEN SQLCODE = ZERO                                      25610000
256200         WHEN SQLCODE = -811                                      25620000
256300             MOVE SUOBTR-OTBND-TRIP-ID    TO ASC-OUTBOUND-TRIP-ID 25630000
256400             MOVE SUOBTR-TRLR-SRL-NBR     TO ASC-TRLR-SRL-NMBR    25640000
256500             MOVE SUOBTR-DEST-OPER-UNT-ID TO ASC-TRIP-DEST-OPER-N 25650000
256600             MOVE SUOBTS-SHIP-SCAC-CDE    TO ASC-SCAC-CODE        25660000
256610             MOVE SUOBTS-TRIP-STAT-CDE   TO ASC-TRIP-STATUS       25661008
256620             MOVE SUOBTS-OTBND-STAT-TMST TO PV-TMST               25662009
256621             MOVE PV-TMST-YY             TO PV-DISPLAY-YY         25662109
256622             MOVE PV-TMST-MM             TO PV-DISPLAY-MM         25662209
256623             MOVE PV-TMST-DD             TO PV-DISPLAY-DD         25662309
256624             MOVE PV-DATE-DISPLAY        TO ASC-TRIP-STATUS-DATE  25662409
256700             MOVE CNTRID-TRLR-ID          TO ASC-TRLR-ID          25670000
256800             MOVE CNDCDR-DOOR-TYP-CDE     TO ASC-DOOR-TYPE        25680000
256900             IF SUOBTS-TRLR-PRKG-SLOT-NBR > SPACES                25690000
257000                 MOVE SUOBTS-TRLR-PRKG-SLOT-NBR TO ASC-NUMBER     25700000
257100                 MOVE SUOBTS-TRLR-PRKG-LOC-DESC TO ASC-DOOR-DESC  25710000
257200                 MOVE 'SLOT:'            TO ASC-DOORSLOT          25720000
257300             ELSE                                                 25730000
257400                 MOVE 'DOOR:'            TO ASC-DOORSLOT          25740000
257500                 PERFORM 4320-GET-DOOR-ID-DESC                    25750000
257600             END-IF                                               25760000
257700         WHEN SQLCODE = +100                                      25770000
257800              CONTINUE                                            25780000
257900         WHEN SQLWARN0 NOT = SPACE                                25790000
258000         WHEN SQLCODE NOT = ZERO                                  25800000
258100              MOVE '4050-SELECT-INFORMATION' TO DP013-PARAGRAPH   25810000
258200              MOVE 'SELECT INFO PROBLEM '                         25820000
258300                               TO DP013-MESSAGE-TEXT (1)          25830000
258400              MOVE SQLCA       TO DP013-SQLCA                     25840000
258500              MOVE 'TSUOBTR '   TO DP013-DB2-TABLE-NAME (1)       25850000
258600              SET DP013-DB2-ABEND TO TRUE                         25860000
258700              PERFORM DP013-0000-PROCESS-ABEND                    25870000
258800     END-EVALUATE.                                                25880000
258900                                                                  25890000
259000******************************************************************25900000
259100*  GET MAXIMUM AND MINIMUM DIVERT ON TIMESTAMP FOR A TRAILER     *25910000
259200*  INCLUDING CARTONS ASSUMED ONTO TRAILER                        *25920000
259300******************************************************************25930000
259400 4051-RETRIEVE-TMST.                                              25940000
259500                                                                  25950000
259600     MOVE ASC-OUTBOUND-TRIP-ID  TO  PC049-DK-OTBND-TRIP-ID.       25960000
259700     PERFORM P4000-STRT-END-DVRT.                                 25970000
259800     PERFORM P3000-DOOR-STR-CSR.                                  25980000
259900                                                                  25990000
260000*----------------------------------------------------------------*26000000
260100* OPEN THE CURSOR                                                 26010000
260200*----------------------------------------------------------------*26020000
260300 4100-OPEN-CURSOR.                                                26030000
260400     PERFORM 4110-SELECT-LOC                                      26040000
260600     MOVE ASC-OUTBOUND-TRIP-ID  TO PC049-DK-OTBND-TRIP-ID.        26060000
260700                                                                  26070000
260800     IF ASC-CARTON    = PC-S                                      26080000
260900         SET PC049-SCAN-ON-CRTN-CSR TO TRUE                       26090000
261000         PERFORM P7000-OPEN-SCAN-CRTN-CSR                         26100000
261100     ELSE                                                         26110000
261200         IF ASC-DOOR-TYPE = PC-SH                                 26120000
261300             SET PC049-SHIPPING-TRLR TO TRUE                      26130000
261400             IF ASC-CARTON    = PC-D                              26140000
261500                 SET PC049-SHIP-DVRT-CRTN-CSR TO TRUE             26150000
261600                 PERFORM P7030-OPEN-DVRT-CRTN-CSR                 26160000
261700             ELSE                                                 26170000
261800                 SET PC049-SHP-TR-ALL-CTN-CSR TO TRUE             26180000
261900                 PERFORM P7160-OPEN-SHP-TR-ALL-CTN-CSR            26190000
262000             END-IF                                               26200000
262100         ELSE                                                     26210000
262200             SET PC049-SHUTL-STRG-TRLR TO TRUE                    26220000
262300             IF ASC-CARTON    = PC-D                              26230000
262400                 SET PC049-SHTL-DVRT-CRTN-CSR TO TRUE             26240000
262500                 PERFORM P7030-OPEN-DVRT-CRTN-CSR                 26250000
262600             ELSE                                                 26260000
262700                 SET PC049-SHTL-TR-AL-CTN-CSR TO TRUE             26270000
262800                 PERFORM P7220-OPEN-SHTL-TR-AL-CTN-CSR            26280000
262900             END-IF                                               26290000
263000         END-IF                                                   26300000
263100     END-IF.                                                      26310000
263200                                                                  26320000
263300     EVALUATE TRUE                                                26330000
263400         WHEN SQLCODE = ZEROS                                     26340000
263500              CONTINUE                                            26350000
263600                                                                  26360000
263700         WHEN SQLCODE = -904                                      26370000
263800         WHEN SQLCODE = -911                                      26380000
263900         WHEN SQLCODE = -913                                      26390000
264000              MOVE PC049-DK-OPER-UNT-ID    TO PV-DISPLAY-OPER     26400000
264100              MOVE PC049-DK-OTBND-TRIP-ID  TO PV-DISPLAY-TRIP     26410000
264200              MOVE PC049-PV-STORE-01       TO PV-DISPLAY-STORE-1  26420000
264300              MOVE PC049-PV-STORE-02       TO PV-DISPLAY-STORE-2  26430000
264400              MOVE PC049-PV-STORE-03       TO PV-DISPLAY-STORE-3  26440000
264500              MOVE PC049-PV-STORE-04       TO PV-DISPLAY-STORE-4  26450000
264600              MOVE PC049-DK-DOOR-ID        TO PV-DISPLAY-DOOR     26460000
264700                                                                  26470000
264800              INITIALIZE DP013-MESSAGE-TEXT (1)                   26480000
264900              MOVE '4100-OPEN-CURSOR'      TO DP013-PARAGRAPH     26490000
265000              STRING 'OPEN CURSOR-'           DELIMITED BY SIZE   26500000
265100                     PC049-CURSOR-SWITCHES    DELIMITED BY SIZE   26510000
265200                     ' TRIP-' PV-DISPLAY-TRIP DELIMITED BY SIZE   26520000
265300                     ' OPER-' PV-DISPLAY-OPER DELIMITED BY SIZE   26530000
265400                     ' DOOR-' PV-DISPLAY-DOOR DELIMITED BY SIZE   26540000
265500                                      INTO DP013-MESSAGE-TEXT (1) 26550000
265600                                                                  26560000
265700              STRING 'STORES-'                DELIMITED BY SIZE   26570000
265800                     PV-DISPLAY-STORE-1 '-'   DELIMITED BY SIZE   26580000
265900                     PV-DISPLAY-STORE-2 '-'   DELIMITED BY SIZE   26590000
266000                     PV-DISPLAY-STORE-3 '-'   DELIMITED BY SIZE   26600000
266100                     PV-DISPLAY-STORE-4       DELIMITED BY SIZE   26610000
266200                     ' DFLT TMST-'            DELIMITED BY SIZE   26620000
266300                     PC049-PC-DEFAULT-TMST    DELIMITED BY SIZE   26630000
266400                                      INTO DP013-MESSAGE-TEXT (2) 26640000
266500                                                                  26650000
266600             STRING ' START-'                 DELIMITED BY SIZE   26660000
266700                    PC049-DK-START-TMST       DELIMITED BY SIZE   26670000
266800                    ' END-'                   DELIMITED BY SIZE   26680000
266900                    PC049-DK-END-TMST         DELIMITED BY SIZE   26690000
267000                                      INTO DP013-MESSAGE-TEXT (3) 26700000
267100                                                                  26710000
267200              MOVE SQLCA       TO DP013-SQLCA                     26720000
267300              MOVE 'SUT00027'   TO DP013-DB2-TABLE-NAME (1)       26730000
267400              MOVE 'TSUCRDV '   TO DP013-DB2-TABLE-NAME (2)       26740000
267500              MOVE 'TSUCDOT '   TO DP013-DB2-TABLE-NAME (3)       26750000
267600              SET DP013-DB2-ABEND TO TRUE                         26760000
267700              PERFORM DP013-0000-PROCESS-ABEND                    26770000
267800               SET  PS-ERROR                                      26780000
267900                    DP020-MSG-FATAL TO TRUE                       26790000
268000              MOVE PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          26800000
268100                                                                  26810000
268200         WHEN OTHER                                               26820000
268300              MOVE PC049-DK-OPER-UNT-ID    TO PV-DISPLAY-OPER     26830000
268400              MOVE PC049-DK-OTBND-TRIP-ID  TO PV-DISPLAY-TRIP     26840000
268500              MOVE PC049-PV-STORE-01       TO PV-DISPLAY-STORE-1  26850000
268600              MOVE PC049-PV-STORE-02       TO PV-DISPLAY-STORE-2  26860000
268700              MOVE PC049-PV-STORE-03       TO PV-DISPLAY-STORE-3  26870000
268800              MOVE PC049-PV-STORE-04       TO PV-DISPLAY-STORE-4  26880000
268900              MOVE PC049-DK-DOOR-ID        TO PV-DISPLAY-DOOR     26890000
269000                                                                  26900000
269100              INITIALIZE DP013-MESSAGE-TEXT (1)                   26910000
269200              MOVE '4100-OPEN-CURSOR'      TO DP013-PARAGRAPH     26920000
269300              STRING 'OPEN CURSOR-'           DELIMITED BY SIZE   26930000
269400                     PC049-CURSOR-SWITCHES    DELIMITED BY SIZE   26940000
269500                     ' TRIP-' PV-DISPLAY-TRIP DELIMITED BY SIZE   26950000
269600                     ' OPER-' PV-DISPLAY-OPER DELIMITED BY SIZE   26960000
269700                     ' DOOR-' PV-DISPLAY-DOOR DELIMITED BY SIZE   26970000
269800                                      INTO DP013-MESSAGE-TEXT (1) 26980000
269900                                                                  26990000
270000              STRING 'STORES-'                DELIMITED BY SIZE   27000000
270100                     PV-DISPLAY-STORE-1 '-'   DELIMITED BY SIZE   27010000
270200                     PV-DISPLAY-STORE-2 '-'   DELIMITED BY SIZE   27020000
270300                     PV-DISPLAY-STORE-3 '-'   DELIMITED BY SIZE   27030000
270400                     PV-DISPLAY-STORE-4       DELIMITED BY SIZE   27040000
270500                     ' DFLT TMST-'            DELIMITED BY SIZE   27050000
270600                     PC049-PC-DEFAULT-TMST    DELIMITED BY SIZE   27060000
270700                                      INTO DP013-MESSAGE-TEXT (2) 27070000
270800                                                                  27080000
270900             STRING ' START-'                 DELIMITED BY SIZE   27090000
271000                    PC049-DK-START-TMST       DELIMITED BY SIZE   27100000
271100                    ' END-'                   DELIMITED BY SIZE   27110000
271200                    PC049-DK-END-TMST         DELIMITED BY SIZE   27120000
271300                                      INTO DP013-MESSAGE-TEXT (3) 27130000
271400                                                                  27140000
271500              MOVE SQLCA       TO DP013-SQLCA                     27150000
271600              MOVE 'SUT00027'   TO DP013-DB2-TABLE-NAME (1)       27160000
271700              MOVE 'TSUCRDV '   TO DP013-DB2-TABLE-NAME (2)       27170000
271800              MOVE 'TSUCDOT '   TO DP013-DB2-TABLE-NAME (3)       27180000
271900              SET DP013-DB2-ABEND TO TRUE                         27190000
272000              PERFORM DP013-0000-PROCESS-ABEND                    27200000
272100              SET  PS-ERROR                                       27210000
272200                   DP020-MSG-FATAL TO TRUE                        27220000
272300              MOVE PC-TSYMSG-00551  TO  DP020-MSG-NUMBER          27230000
272400     END-EVALUATE.                                                27240000
272500                                                                  27250000
272501 4110-SELECT-LOC.                                                 27250100
272502     EXEC SQL                                                     27250200
272503          SELECT ORGN_OPER_UNT_ID                                 27250300
272504            INTO :PC049-DK-OPER-UNT-ID                            27250400
272505            FROM TSUOBTR                                          27250500
272506           WHERE OTBND_TRIP_ID   = :DK-TRIP-ID                    27250600
272507      END-EXEC                                                    27250700
272508                                                                  27250800
272509      EVALUATE TRUE                                               27250900
272510          WHEN SQLCODE = +0                                       27251000
272511               CONTINUE                                           27251100
272512          WHEN OTHER                                              27251200
272513               SET PS-ERROR TO TRUE                               27251300
272514     END-EVALUATE.                                                27251400
272515                                                                  27251500
272600                                                                  27260000
272700*----------------------------------------------------------------*27270000
272800* CLOSE THE CURSOR.                                               27280000
272900*   IN THIS PARTICULAR APPLICATION ONE OF 2 DIFFERENT CURSORS    *27290000
273000*   WILL BE CLOSED DEPENDING ON THE CRITERIA SPECIFIED BY THE    *27300000
273100*   USER.                                                        *27310000
273200*----------------------------------------------------------------*27320000
273300 4200-CLOSE-CURSOR.                                               27330000
273400                                                                  27340000
273500     IF PC049-SHTL-DVRT-CRTN-CSR OR PC049-SHIP-DVRT-CRTN-CSR      27350000
273600         PERFORM P7050-CLOSE-DVRT-CRTN-CSR                        27360000
273700     ELSE                                                         27370000
273800         IF PC049-SCAN-ON-CRTN-CSR                                27380000
273900             PERFORM P7020-CLOSE-SCAN-CRTN-CSR                    27390000
274000         ELSE                                                     27400000
274100             IF PC049-SHP-TR-ALL-CTN-CSR                          27410000
274200                 PERFORM P7170-CLOSE-SHP-TR-ALL-CTN-CSR           27420000
274300             ELSE                                                 27430000
274400                 PERFORM P7230-CLOSE-SHTL-TR-AL-CTN-CSR           27440000
274500             END-IF                                               27450000
274600         END-IF                                                   27460000
274700     END-IF.                                                      27470000
274800                                                                  27480000
274900     EVALUATE TRUE                                                27490000
275000         WHEN SQLCODE = ZEROS                                     27500000
275100              CONTINUE                                            27510000
275200                                                                  27520000
275300         WHEN SQLCODE = -904                                      27530000
275400         WHEN SQLCODE = -911                                      27540000
275500         WHEN SQLCODE = -913                                      27550000
275600              MOVE PC049-DK-OPER-UNT-ID    TO PV-DISPLAY-OPER     27560000
275700              MOVE PC049-DK-OTBND-TRIP-ID  TO PV-DISPLAY-TRIP     27570000
275800              MOVE PC049-PV-STORE-01       TO PV-DISPLAY-STORE-1  27580000
275900              MOVE PC049-PV-STORE-02       TO PV-DISPLAY-STORE-2  27590000
276000              MOVE PC049-PV-STORE-03       TO PV-DISPLAY-STORE-3  27600000
276100              MOVE PC049-PV-STORE-04       TO PV-DISPLAY-STORE-4  27610000
276200              MOVE PC049-DK-DOOR-ID        TO PV-DISPLAY-DOOR     27620000
276300                                                                  27630000
276400              INITIALIZE DP013-MESSAGE-TEXT (1)                   27640000
276500              MOVE '4200-CLOSE-CURSOR'     TO DP013-PARAGRAPH     27650000
276600              STRING 'CLOSE CURSOR-'          DELIMITED BY SIZE   27660000
276700                     PC049-CURSOR-SWITCHES    DELIMITED BY SIZE   27670000
276800                     ' TRIP-' PV-DISPLAY-TRIP DELIMITED BY SIZE   27680000
276900                     ' OPER-' PV-DISPLAY-OPER DELIMITED BY SIZE   27690000
277000                     ' DOOR-' PV-DISPLAY-DOOR DELIMITED BY SIZE   27700000
277100                                      INTO DP013-MESSAGE-TEXT (1) 27710000
277200                                                                  27720000
277300              STRING 'STORES-'                DELIMITED BY SIZE   27730000
277400                     PV-DISPLAY-STORE-1 '-'   DELIMITED BY SIZE   27740000
277500                     PV-DISPLAY-STORE-2 '-'   DELIMITED BY SIZE   27750000
277600                     PV-DISPLAY-STORE-3 '-'   DELIMITED BY SIZE   27760000
277700                     PV-DISPLAY-STORE-4       DELIMITED BY SIZE   27770000
277800                     ' DFLT TMST-'            DELIMITED BY SIZE   27780000
277900                     PC049-PC-DEFAULT-TMST    DELIMITED BY SIZE   27790000
278000                                      INTO DP013-MESSAGE-TEXT (2) 27800000
278100                                                                  27810000
278200             STRING ' START-'                 DELIMITED BY SIZE   27820000
278300                    PC049-DK-START-TMST       DELIMITED BY SIZE   27830000
278400                    ' END-'                   DELIMITED BY SIZE   27840000
278500                    PC049-DK-END-TMST         DELIMITED BY SIZE   27850000
278600                                      INTO DP013-MESSAGE-TEXT (3) 27860000
278700                                                                  27870000
278800              MOVE SQLCA       TO DP013-SQLCA                     27880000
278900              MOVE 'SUT00027'   TO DP013-DB2-TABLE-NAME (1)       27890000
279000              MOVE 'TSUCRDV '   TO DP013-DB2-TABLE-NAME (2)       27900000
279100              MOVE 'TSUCDOT '   TO DP013-DB2-TABLE-NAME (3)       27910000
279200              SET DP013-DB2-ABEND TO TRUE                         27920000
279300              PERFORM DP013-0000-PROCESS-ABEND                    27930000
279400               SET  PS-ERROR                                      27940000
279500                    DP020-MSG-FATAL TO TRUE                       27950000
279600              MOVE PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          27960000
279700                                                                  27970000
279800         WHEN OTHER                                               27980000
279900              MOVE PC049-DK-OPER-UNT-ID    TO PV-DISPLAY-OPER     27990000
280000              MOVE PC049-DK-OTBND-TRIP-ID  TO PV-DISPLAY-TRIP     28000000
280100              MOVE PC049-PV-STORE-01       TO PV-DISPLAY-STORE-1  28010000
280200              MOVE PC049-PV-STORE-02       TO PV-DISPLAY-STORE-2  28020000
280300              MOVE PC049-PV-STORE-03       TO PV-DISPLAY-STORE-3  28030000
280400              MOVE PC049-PV-STORE-04       TO PV-DISPLAY-STORE-4  28040000
280500              MOVE PC049-DK-DOOR-ID        TO PV-DISPLAY-DOOR     28050000
280600                                                                  28060000
280700              INITIALIZE DP013-MESSAGE-TEXT (1)                   28070000
280800              MOVE '4200-CLOSE-CURSOR'     TO DP013-PARAGRAPH     28080000
280900              STRING 'CLOSE CURSOR'           DELIMITED BY SIZE   28090000
281000                     PC049-CURSOR-SWITCHES    DELIMITED BY SIZE   28100000
281100                     ' TRIP-' PV-DISPLAY-TRIP DELIMITED BY SIZE   28110000
281200                     ' OPER-' PV-DISPLAY-OPER DELIMITED BY SIZE   28120000
281300                     ' DOOR-' PV-DISPLAY-DOOR DELIMITED BY SIZE   28130000
281400                                      INTO DP013-MESSAGE-TEXT (1) 28140000
281500                                                                  28150000
281600              STRING 'STORES-'                DELIMITED BY SIZE   28160000
281700                     PV-DISPLAY-STORE-1 '-'   DELIMITED BY SIZE   28170000
281800                     PV-DISPLAY-STORE-2 '-'   DELIMITED BY SIZE   28180000
281900                     PV-DISPLAY-STORE-3 '-'   DELIMITED BY SIZE   28190000
282000                     PV-DISPLAY-STORE-4 '-'   DELIMITED BY SIZE   28200000
282100                     ' DFLT TMST-'            DELIMITED BY SIZE   28210000
282200                     PC049-PC-DEFAULT-TMST    DELIMITED BY SIZE   28220000
282300                                      INTO DP013-MESSAGE-TEXT (2) 28230000
282400                                                                  28240000
282500             STRING ' START-'                 DELIMITED BY SIZE   28250000
282600                    PC049-DK-START-TMST       DELIMITED BY SIZE   28260000
282700                    ' END-'                   DELIMITED BY SIZE   28270000
282800                    PC049-DK-END-TMST         DELIMITED BY SIZE   28280000
282900                                      INTO DP013-MESSAGE-TEXT (3) 28290000
283000                                                                  28300000
283100              MOVE SQLCA       TO DP013-SQLCA                     28310000
283200              MOVE 'SUT00027'   TO DP013-DB2-TABLE-NAME (1)       28320000
283300              MOVE 'TSUCRDV '   TO DP013-DB2-TABLE-NAME (2)       28330000
283400              MOVE 'TSUCDOT '   TO DP013-DB2-TABLE-NAME (3)       28340000
283500              SET DP013-DB2-ABEND TO TRUE                         28350000
283600              PERFORM DP013-0000-PROCESS-ABEND                    28360000
283700              SET  PS-ERROR                                       28370000
283800                   DP020-MSG-FATAL TO TRUE                        28380000
283900              MOVE PC-TSYMSG-00551  TO  DP020-MSG-NUMBER          28390000
284000     END-EVALUATE.                                                28400000
284100                                                                  28410000
284200*----------------------------------------------------------------*28420000
284300*    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE    *28430000
284400*    BLOCKS IN THE ARRAY.  WHENEVER BOTH BLOCKS BECOME FULL,     *28440000
284500*    WRITE OUT THE 1ST BLOCK TO TEMPORARY STORAGE, MOVE THE 2ND  *28450000
284600*    BLOCK IN THE ARRAY TO THE 1ST BLOCK, AND INITIALIZE THE     *28460000
284700*    2ND BLOCK MAKING IT AVAILABLE TO BE USED.                   *28470000
284800*                                                                *28480000
284900*    DUE TO THE SIZE OF THE TABLE, AND THE ORDER IN WHICH THE    *28490000
285000*    ROWS ARE SORTED, THE ENTIRE TABLE IS READ INTO THE PROGRAM  *28500000
285100*    UPON INITIALIZATION.                                        *28510000
285200*----------------------------------------------------------------*28520000
285300 4300-READ-ITEMS-FROM-DB.                                         28530000
285400                                                                  28540000
285500     PERFORM                                                      28550000
285600         VARYING PV-READ-COUNT                                    28560000
285700         FROM 1 BY 1                                              28570000
285800         UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                    28580000
285900            OR (ASC-NO-ITEMS-LEFT-ON-DB))                         28590000
286000                                                                  28600000
286100         PERFORM 4310-FETCH                                       28610000
286200                                                                  28620000
286300         IF  ASC-ITEMS-LEFT-ON-DB                                 28630000
286400           PERFORM 4308-CHECK-CARTON-CONTENTS                     28640000
286500           IF (ASC-ERROR-CARTON AND PS-NO-CONTENTS-FOUND) OR      28650000
286600               ASC-NO-ERROR-CARTON                                28660000
286700             IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                28670000
286800                 ADD +1            TO ASC-ITEM-SUB                28680000
286900             ELSE                                                 28690000
287000                 ADD +1            TO ASC-BLK-SUB                 28700000
287100                 MOVE +1           TO ASC-ITEM-SUB                28710000
287200                                                                  28720000
287300                 IF  ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY         28730000
287400                     MOVE +1       TO ASC-BLK-SUB                 28740000
287500                     SET ASC-BLOCK-MODIFIED (1) TO TRUE           28750000
287600                     PERFORM 5100-WRITE-TEMP-STORAGE              28760000
287700                     MOVE ASC-BLOCK-ENTRIES                       28770000
287800                                   (PC-MAX-BLOCKS-IN-ARRAY)       28780000
287900                                TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB) 28790000
288000                     ADD +1        TO ASC-BLK-SUB                 28800000
288100                     INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)   28810000
288200                     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)      28820000
288300                                                          TO TRUE 28830000
288400                 END-IF                                           28840000
288500             END-IF                                               28850000
288600             IF PS-NO-CONTENTS-FOUND                              28860000
288700                 SET ASC-MISSING-DATA (ASC-BLK-SUB ASC-ITEM-SUB)  28870000
288800                              TO TRUE                             28880000
288900             ELSE                                                 28890000
289000                 MOVE SPACE TO PS-CONTENT-SW                      28900000
289100                 SET ASC-NO-MISSING-DATA(ASC-BLK-SUB ASC-ITEM-SUB)28910000
289200                              TO TRUE                             28920000
289300             END-IF                                               28930000
289400             ADD +1                TO ASC-NUMBER-OF-ITEMS-READ    28940000
289500             SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB) TO TRUE          28950000
289600             MOVE ASC-NUMBER-OF-ITEMS-READ                        28960000
289700                                   TO ASC-LIST-ITEM-NUMBER        28970000
289800                                      (ASC-BLK-SUB ASC-ITEM-SUB)  28980000
289900             MOVE SPACES           TO  ASC-ACTION                 28990000
290000                                      (ASC-BLK-SUB ASC-ITEM-SUB)  29000000
290100             MOVE SUCRDV-SHIPT-UNT-ID                             29010000
290200                            TO ASC-SML (ASC-BLK-SUB ASC-ITEM-SUB) 29020000
290300             MOVE ASC-CREATE-ID                                   29030000
290400                         TO ASC-CREATE (ASC-BLK-SUB ASC-ITEM-SUB) 29040000
290500                                                                  29050000
290600             IF ASC-CREATE-ID = 'FXR'                             29060000
290700                IF  ASC-TRN-NBR  >  0                             29070000
290800                    MOVE ASC-TRN-NBR                              29080000
290900                    TO ASC-PO-RCVR-NBR (ASC-BLK-SUB ASC-ITEM-SUB) 29090000
291000                ELSE                                              29100000
291100                    MOVE 'UNKNOWN    '                            29110000
291200                    TO ASC-PO-RCVR-NBR (ASC-BLK-SUB ASC-ITEM-SUB) 29120000
291300                END-IF                                            29130000
291400             ELSE                                                 29140000
291500                 IF PS-NO-CONTENTS-FOUND                          29150000
291600                     IF ASC-CREATE-ID = 'MST'                     29160000
291700                         MOVE 'CHILDREN   '                       29170000
291800                              TO ASC-PO-RCVR-NBR                  29180000
291900                                (ASC-BLK-SUB ASC-ITEM-SUB)        29190000
292000                     ELSE                                         29200000
292100                         MOVE 'UNKNOWN    '                       29210000
292200                              TO ASC-PO-RCVR-NBR                  29220000
292300                                (ASC-BLK-SUB ASC-ITEM-SUB)        29230000
292400                     END-IF                                       29240000
292500                 ELSE                                             29250000
292600                    MOVE ASC-PO-RCVR                              29260000
292700                    TO ASC-PO-RCVR-NBR (ASC-BLK-SUB ASC-ITEM-SUB) 29270000
292800                 END-IF                                           29280000
292900             END-IF                                               29290000
293000                                                                  29300000
293100             MOVE SUCRDV-DEST-OPER-UNT-ID TO                      29310000
293200                          ASC-DEST-NBR (ASC-BLK-SUB ASC-ITEM-SUB) 29320000
293300             EVALUATE PC046-CRTN-STATUS                           29330000
293400                 WHEN '01'                                        29340000
293500                     MOVE DK-INVALID-DESC TO ASC-LOAD-STATUS      29350000
293600                                       (ASC-BLK-SUB ASC-ITEM-SUB) 29360000
293700                 WHEN '02'                                        29370000
293800                     MOVE DK-INACT-DESC  TO ASC-LOAD-STATUS       29380000
293900                                       (ASC-BLK-SUB ASC-ITEM-SUB) 29390000
294000                 WHEN '03'                                        29400000
294100                     MOVE DK-SC-OF-DESC  TO ASC-LOAD-STATUS       29410000
294200                                       (ASC-BLK-SUB ASC-ITEM-SUB) 29420000
294300                 WHEN '04'                                        29430000
294400                     MOVE DK-SC-ON-DESC  TO ASC-LOAD-STATUS       29440000
294500                                       (ASC-BLK-SUB ASC-ITEM-SUB) 29450000
294600                 WHEN '05'                                        29460000
294700                     MOVE DK-DVRT-DESC   TO ASC-LOAD-STATUS       29470000
294800                                       (ASC-BLK-SUB ASC-ITEM-SUB) 29480000
294900                 WHEN '06'                                        29490000
295000                     MOVE DK-LOADED-DESC TO ASC-LOAD-STATUS       29500000
295100                                       (ASC-BLK-SUB ASC-ITEM-SUB) 29510000
295200                 WHEN '07'                                        29520000
295300                     MOVE DK-CSEPK-DESC  TO ASC-LOAD-STATUS       29530000
295400                                       (ASC-BLK-SUB ASC-ITEM-SUB) 29540000
295500                 WHEN '08'                                        29550000
295600                     MOVE DK-CK-IN-DESC  TO ASC-LOAD-STATUS       29560000
295700                                       (ASC-BLK-SUB ASC-ITEM-SUB) 29570000
295800                 WHEN '09'                                        29580000
295900                     MOVE DK-P2L-DESC    TO ASC-LOAD-STATUS       29590000
296000                                       (ASC-BLK-SUB ASC-ITEM-SUB) 29600000
296100                 WHEN '10'                                        29610000
296200                     MOVE DK-RDM-DESC    TO ASC-LOAD-STATUS       29620000
296300                                       (ASC-BLK-SUB ASC-ITEM-SUB) 29630000
296400                 WHEN '11'                                        29640000
296500                     MOVE DK-RECV-DESC   TO ASC-LOAD-STATUS       29650000
296600                                       (ASC-BLK-SUB ASC-ITEM-SUB) 29660000
296700                 WHEN '12'                                        29670000
296800                     MOVE DK-ASN-DESC    TO ASC-LOAD-STATUS       29680000
296900                                       (ASC-BLK-SUB ASC-ITEM-SUB) 29690000
297000                 WHEN '13'                                        29700000
297100                     MOVE DK-SMTH-DESC   TO ASC-LOAD-STATUS       29710000
297200                                       (ASC-BLK-SUB ASC-ITEM-SUB) 29720000
297300                 WHEN '14'                                        29730000
297400                     MOVE DK-XFER-DESC   TO ASC-LOAD-STATUS       29740000
297500                                       (ASC-BLK-SUB ASC-ITEM-SUB) 29750000
297600                 WHEN '15'                                        29760000
297700                     MOVE DK-MSTR-DESC   TO ASC-LOAD-STATUS       29770000
297800                                       (ASC-BLK-SUB ASC-ITEM-SUB) 29780000
297900                 WHEN '16'                                        29790000
298000                     MOVE DK-BLD-DESC    TO ASC-LOAD-STATUS       29800000
298100                                       (ASC-BLK-SUB ASC-ITEM-SUB) 29810000
298200                 WHEN '17'                                        29820000
298300                     MOVE DK-JWL-DESC    TO ASC-LOAD-STATUS       29830000
298400                                       (ASC-BLK-SUB ASC-ITEM-SUB) 29840000
298500                 WHEN '18'                                        29850000
298600                     MOVE DK-DMG-DESC    TO ASC-LOAD-STATUS       29860000
298700                                       (ASC-BLK-SUB ASC-ITEM-SUB) 29870000
298710                 WHEN '19'                                        29871020
298720                     MOVE DK-3WD-DESC    TO ASC-LOAD-STATUS       29872020
298730                                       (ASC-BLK-SUB ASC-ITEM-SUB) 29873020
298800             END-EVALUATE                                         29880000
298900             IF SUCRDV-ACTV-CDE = PC-I                            29890000
299000                 MOVE SUCRDV-NACTV-USR-ID TO                      29900000
299100                            ASC-USER-ID(ASC-BLK-SUB ASC-ITEM-SUB) 29910000
299200                 MOVE SUCRDV-ACTV-CDE TO                          29920000
299300                           ASC-ACTV-CDE(ASC-BLK-SUB ASC-ITEM-SUB) 29930000
299400                 MOVE DK-DVRT-DESC   TO ASC-LOAD-STATUS           29940000
299500                                       (ASC-BLK-SUB ASC-ITEM-SUB) 29950000
299600             ELSE                                                 29960000
299700                 MOVE SUCDOT-STRT-SCN-USR-ID TO                   29970000
299800                            ASC-USER-ID(ASC-BLK-SUB ASC-ITEM-SUB) 29980000
299900                 MOVE SPACES TO                                   29990000
300000                           ASC-ACTV-CDE(ASC-BLK-SUB ASC-ITEM-SUB) 30000000
300100                 ADD +1 TO ASC-DIVERT                             30010000
300200             END-IF                                               30020000
300300             IF PC049-PV-BEG-DVRT                                 30030000
300400                 MOVE 'DVT BEG' TO ASC-LOAD-STATUS                30040000
300500                                      (ASC-BLK-SUB ASC-ITEM-SUB)  30050000
300600             ELSE                                                 30060000
300700                 IF PC049-PV-END-DVRT                             30070000
300800                     MOVE 'DVT END' TO ASC-LOAD-STATUS            30080000
300900                                      (ASC-BLK-SUB ASC-ITEM-SUB)  30090000
301000                 END-IF                                           30100000
301100             END-IF                                               30110000
301200             IF ASC-LOAD-STATUS (ASC-BLK-SUB ASC-ITEM-SUB) =      30120000
301300                                                    'DVT BEG'     30130000
301400                 MOVE SUCDOT-STRT-SCN-TMST   TO PV-TMST           30140000
301500             ELSE                                                 30150000
301600                 IF ASC-LOAD-STATUS (ASC-BLK-SUB ASC-ITEM-SUB) =  30160000
301700                                                        'DVT END' 30170000
301800                     MOVE SUCDOT-END-SCN-TMST    TO PV-TMST       30180000
301900                 ELSE                                             30190000
302000                     IF PC046-CRTN-STAT-TMST = PC-EMPTY-TIMESTAMP 30200000
302100                         MOVE SPACES                 TO PV-TMST   30210000
302200                     ELSE                                         30220000
302300                         MOVE PC046-CRTN-STAT-TMST   TO PV-TMST   30230000
302400                     END-IF                                       30240000
302500                 END-IF                                           30250000
302600             END-IF                                               30260000
302700                                                                  30270000
302800             MOVE PV-TMST-YY             TO PV-DISPLAY-YY         30280000
302900             MOVE PV-TMST-MM             TO PV-DISPLAY-MM         30290000
303000             MOVE PV-TMST-DD             TO PV-DISPLAY-DD         30300000
303100                                                                  30310000
303200             IF PV-TMST > SPACES                                  30320000
303300                 MOVE '4300-READ-ITEMS-FROM-DB'                   30330000
303400                            TO PV-SAVE-SOURCE-PARA                30340000
303500                 PERFORM 4300A-FORMAT-DATE-TIME                   30350000
303600                 STRING PV-USA-DATE(1:6) PV-USA-DATE(9:2)         30360000
303700                     DELIMITED BY SIZE                            30370000
303800                    INTO ASC-STAT-DATE (ASC-BLK-SUB ASC-ITEM-SUB) 30380000
303900                 MOVE PV-JIS-HH-MM                                30390000
304000                      TO ASC-STAT-TIME (ASC-BLK-SUB ASC-ITEM-SUB) 30400000
304100             ELSE                                                 30410000
304200                 MOVE SPACES                                      30420000
304300                      TO ASC-STAT-DATE (ASC-BLK-SUB ASC-ITEM-SUB) 30430000
304400                         ASC-STAT-TIME (ASC-BLK-SUB ASC-ITEM-SUB) 30440000
304500             END-IF                                               30450000
304510                                                                  30451010
308200           END-IF                                                 30820000
308300         END-IF                                                   30830000
308400     END-PERFORM.                                                 30840000
308500                                                                  30850000
308600     IF  ASC-NUMBER-OF-ITEMS-READ > ZERO                          30860000
308700         MOVE +1               TO ASC-BLK-SUB                     30870000
308800         PERFORM 5100-WRITE-TEMP-STORAGE                          30880000
308900         ADD +1                TO ASC-BLK-SUB                     30890000
309000         PERFORM 5100-WRITE-TEMP-STORAGE                          30900000
309100                                                                  30910000
309200         MOVE 1                TO ASC-BLK-SUB                     30920000
309300                                  PV-BLOCK-NUMBER                 30930000
309400         PERFORM 4410-READ-TEMP-STORAGE                           30940000
309500         IF  ASC-HIGHEST-BLOCK-WRITTEN GREATER THAN 1             30950000
309600             MOVE 2            TO ASC-BLK-SUB                     30960000
309700                                  PV-BLOCK-NUMBER                 30970000
309800             PERFORM 4410-READ-TEMP-STORAGE                       30980000
309900         END-IF                                                   30990000
310000     END-IF.                                                      31000000
310100                                                                  31010000
310200 4300A-FORMAT-DATE-TIME.                                          31020000
310300                                                                  31030000
310400     EXEC SQL                                                     31040000
310500     SELECT                                                       31050000
310600         CHAR(DATE(:PV-TMST),USA)                                 31060000
310700     ,   CHAR(TIME(:PV-TMST),JIS)                                 31070000
310800     INTO                                                         31080000
310900         :PV-USA-DATE                                             31090000
311000     ,   :PV-JIS-TIME                                             31100000
311100     FROM SYSIBM.SYSDUMMY1                                        31110000
311200     END-EXEC.                                                    31120000
311300                                                                  31130000
311400     EVALUATE TRUE                                                31140000
311500         WHEN SQLCODE = ZERO                                      31150000
311600             CONTINUE                                             31160000
311700         WHEN SQLWARN0 NOT = SPACE                                31170000
311800         WHEN SQLCODE NOT = ZERO                                  31180000
311900              MOVE '4300A-FORMAT-DATE-TIME'  TO DP013-PARAGRAPH   31190000
312000              STRING ' PV-TMST='                                  31200000
312100                      PV-TMST            DELIMITED BY SIZE        31210000
312200                             INTO DP013-MESSAGE-TEXT (1)          31220000
312300              STRING ' CARTON='                                   31230000
312400                     PC046-CARTON-ID     DELIMITED BY SIZE        31240000
312500                             INTO DP013-MESSAGE-TEXT (2)          31250000
312600              STRING ' PC049-PV-REC-TYPE-2 = '                    31260000
312700                     PC049-PV-REC-TYPE-2 DELIMITED BY SIZE        31270000
312800                             INTO DP013-MESSAGE-TEXT (3)          31280000
312900              STRING ' PC046-CRTN-STAT-TMST = '                   31290000
313000                    PC046-CRTN-STAT-TMST DELIMITED BY SIZE        31300000
313100                             INTO DP013-MESSAGE-TEXT (4)          31310000
313200              MOVE SQLCA       TO DP013-SQLCA                     31320000
313300              MOVE 'SYSDUMMY1'   TO DP013-DB2-TABLE-NAME (1)      31330000
313400              MOVE PV-SAVE-SOURCE-PARA                            31340000
313500                                 TO DP013-DB2-TABLE-NAME (2)      31350000
313600              STRING '46-CRTN-STATUS='                            31360000
313700                     PC046-CRTN-STATUS   DELIMITED BY SIZE        31370000
313800                             INTO DP013-DB2-TABLE-NAME (3)        31380000
313900              SET DP013-DB2-ABEND TO TRUE                         31390000
314000              PERFORM DP013-0000-PROCESS-ABEND                    31400000
314100     END-EVALUATE.                                                31410000
314200                                                                  31420020
314300*-----------------------------------------------------------------31430000
314400* FETCH DATA FROM THE SCAN ON CURSOR                              31440000
314500*-----------------------------------------------------------------31450000
314600 4305-READ-ITEMS-FROM-DB.                                         31460000
314700                                                                  31470000
314800     PERFORM                                                      31480000
314900         VARYING PV-READ-COUNT                                    31490000
315000         FROM 1 BY 1                                              31500000
315100         UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                    31510000
315200            OR (ASC-NO-ITEMS-LEFT-ON-DB))                         31520000
315300                                                                  31530000
315400         PERFORM 4310-FETCH                                       31540000
315500                                                                  31550000
315600         IF  ASC-ITEMS-LEFT-ON-DB                                 31560000
315700           PERFORM 4308-CHECK-CARTON-CONTENTS                     31570000
315800           IF (ASC-ERROR-CARTON AND PS-NO-CONTENTS-FOUND) OR      31580000
315900               ASC-NO-ERROR-CARTON                                31590000
316000             IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                31600000
316100                 ADD +1            TO ASC-ITEM-SUB                31610000
316200             ELSE                                                 31620000
316300                 ADD +1            TO ASC-BLK-SUB                 31630000
316400                 MOVE +1           TO ASC-ITEM-SUB                31640000
316500                                                                  31650000
316600                 IF  ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY         31660000
316700                     MOVE +1       TO ASC-BLK-SUB                 31670000
316800                     SET ASC-BLOCK-MODIFIED (1) TO TRUE           31680000
316900                     PERFORM 5100-WRITE-TEMP-STORAGE              31690000
317000                     MOVE ASC-BLOCK-ENTRIES                       31700000
317100                                   (PC-MAX-BLOCKS-IN-ARRAY)       31710000
317200                                TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB) 31720000
317300                     ADD +1        TO ASC-BLK-SUB                 31730000
317400                     INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)   31740000
317500                     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)      31750000
317600                                                          TO TRUE 31760000
317700                 END-IF                                           31770000
317800             END-IF                                               31780000
317900             IF PS-NO-CONTENTS-FOUND                              31790000
318000                 SET ASC-MISSING-DATA (ASC-BLK-SUB ASC-ITEM-SUB)  31800000
318100                            TO TRUE                               31810000
318200             ELSE                                                 31820000
318300                 MOVE SPACE TO PS-CONTENT-SW                      31830000
318400                 SET ASC-NO-MISSING-DATA(ASC-BLK-SUB ASC-ITEM-SUB)31840000
318500                            TO TRUE                               31850000
318600             END-IF                                               31860000
318700             ADD +1                TO ASC-NUMBER-OF-ITEMS-READ    31870000
318800             SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB) TO TRUE          31880000
318900             MOVE ASC-NUMBER-OF-ITEMS-READ                        31890000
319000                                   TO ASC-LIST-ITEM-NUMBER        31900000
319100                                      (ASC-BLK-SUB ASC-ITEM-SUB)  31910000
319200             MOVE SPACES           TO  ASC-ACTION                 31920000
319300                                      (ASC-BLK-SUB ASC-ITEM-SUB)  31930000
319400             MOVE SUT00027-SHIPT-UNT-ID                           31940000
319500                            TO ASC-SML (ASC-BLK-SUB ASC-ITEM-SUB) 31950000
319600             MOVE SUT00027-CRE-USR-ID TO                          31960000
319700                        ASC-USER-ID(ASC-BLK-SUB ASC-ITEM-SUB)     31970000
319800             MOVE ASC-CREATE-ID                                   31980000
319900                         TO ASC-CREATE (ASC-BLK-SUB ASC-ITEM-SUB) 31990000
320000             IF PS-NO-CONTENTS-FOUND                              32000000
320100                 IF ASC-CREATE-ID = 'MST'                         32010000
320200                     MOVE 'CHILDREN   '                           32020000
320300                          TO ASC-PO-RCVR-NBR                      32030000
320400                            (ASC-BLK-SUB ASC-ITEM-SUB)            32040000
320500                 ELSE                                             32050000
320600                     MOVE 'UNKNOWN    '                           32060000
320700                          TO ASC-PO-RCVR-NBR                      32070000
320800                            (ASC-BLK-SUB ASC-ITEM-SUB)            32080000
320900                 END-IF                                           32090000
321000             ELSE                                                 32100000
321100                 MOVE ASC-PO-RCVR                                 32110000
321200                    TO ASC-PO-RCVR-NBR (ASC-BLK-SUB ASC-ITEM-SUB) 32120000
321300             END-IF                                               32130000
321400             MOVE ASC-STR-NBR TO                                  32140000
321500                          ASC-DEST-NBR (ASC-BLK-SUB ASC-ITEM-SUB) 32150000
321600             IF SUT00027-SCN-CDE = PC-SHON                        32160000
321700                 MOVE DK-SC-ON-DESC TO ASC-LOAD-STATUS            32170000
321800                                       (ASC-BLK-SUB ASC-ITEM-SUB) 32180000
321900                 MOVE SPACES TO                                   32190000
322000                           ASC-ACTV-CDE(ASC-BLK-SUB ASC-ITEM-SUB) 32200000
322100                 ADD +1         TO ASC-MANUAL                     32210000
322200                                   ASC-TOTAL                      32220000
322300             ELSE                                                 32230000
322400                 MOVE DK-SC-OF-DESC TO ASC-LOAD-STATUS            32240000
322500                                       (ASC-BLK-SUB ASC-ITEM-SUB) 32250000
322600                 MOVE SUT00027-ACTV-CDE TO                        32260000
322700                           ASC-ACTV-CDE(ASC-BLK-SUB ASC-ITEM-SUB) 32270000
322800                 ADD +1         TO ASC-SCAN-OFF                   32280000
322900             END-IF                                               32290000
323000             MOVE SUT00027-CRE-TMST      TO PV-TMST               32300000
323100             MOVE '4305-READ-ITEMS-FROM-DB'                       32310000
323200                        TO PV-SAVE-SOURCE-PARA                    32320000
323300             PERFORM 4300A-FORMAT-DATE-TIME                       32330000
323400                                                                  32340000
323500             MOVE PV-TMST-YY             TO PV-DISPLAY-YY         32350000
323600             MOVE PV-TMST-MM             TO PV-DISPLAY-MM         32360000
323700             MOVE PV-TMST-DD             TO PV-DISPLAY-DD         32370000
323900             STRING PV-USA-DATE(1:6) PV-USA-DATE(9:2)             32390000
324000                     DELIMITED BY SIZE                            32400000
324100                    INTO ASC-STAT-DATE (ASC-BLK-SUB ASC-ITEM-SUB) 32410000
324200             MOVE PV-TMST-TIME                                    32420000
324300                      TO ASC-STAT-TIME (ASC-BLK-SUB ASC-ITEM-SUB) 32430000
324400                                                                  32440000
328000           END-IF                                                 32800000
328010                                                                  32801010
328021           PERFORM 4325-GET-STORE-SCAN-CDE                        32802110
328040                                                                  32804010
328100         END-IF                                                   32810000
328200     END-PERFORM.                                                 32820000
328300                                                                  32830000
328400     IF  ASC-NUMBER-OF-ITEMS-READ > ZERO                          32840000
328500         MOVE +1               TO ASC-BLK-SUB                     32850000
328600         PERFORM 5100-WRITE-TEMP-STORAGE                          32860000
328700         ADD +1                TO ASC-BLK-SUB                     32870000
328800         PERFORM 5100-WRITE-TEMP-STORAGE                          32880000
328900                                                                  32890000
329000         MOVE 1                TO ASC-BLK-SUB                     32900000
329100                                  PV-BLOCK-NUMBER                 32910000
329200         PERFORM 4410-READ-TEMP-STORAGE                           32920000
329300         IF  ASC-HIGHEST-BLOCK-WRITTEN GREATER THAN 1             32930000
329400             MOVE 2            TO ASC-BLK-SUB                     32940000
329500                                  PV-BLOCK-NUMBER                 32950000
329600             PERFORM 4410-READ-TEMP-STORAGE                       32960000
329700         END-IF                                                   32970000
329800     END-IF.                                                      32980000
329900                                                                  32990000
330000*-----------------------------------------------------------------33000000
330100* FETCH DATA FROM THE ALL CARTON CURSORS                          33010000
330200*-----------------------------------------------------------------33020000
330300 4306-READ-ITEMS-FROM-DB.                                         33030000
330400                                                                  33040000
330500     PERFORM                                                      33050000
330600         VARYING PV-READ-COUNT                                    33060000
330700         FROM 1 BY 1                                              33070000
330800         UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                    33080000
330900            OR (ASC-NO-ITEMS-LEFT-ON-DB))                         33090000
331000                                                                  33100000
331100         PERFORM 4310-FETCH                                       33110000
331200                                                                  33120000
331300         IF  ASC-ITEMS-LEFT-ON-DB                                 33130000
331400           PERFORM 4308-CHECK-CARTON-CONTENTS                     33140000
331500           IF (ASC-ERROR-CARTON AND PS-NO-CONTENTS-FOUND) OR      33150000
331600               ASC-NO-ERROR-CARTON                                33160000
331700             IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                33170000
331800                 ADD +1            TO ASC-ITEM-SUB                33180000
331900             ELSE                                                 33190000
332000                 ADD +1            TO ASC-BLK-SUB                 33200000
332100                 MOVE +1           TO ASC-ITEM-SUB                33210000
332200                                                                  33220000
332300                 IF  ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY         33230000
332400                     MOVE +1       TO ASC-BLK-SUB                 33240000
332500                     SET ASC-BLOCK-MODIFIED (1) TO TRUE           33250000
332600                     PERFORM 5100-WRITE-TEMP-STORAGE              33260000
332700                     MOVE ASC-BLOCK-ENTRIES                       33270000
332800                                   (PC-MAX-BLOCKS-IN-ARRAY)       33280000
332900                                TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB) 33290000
333000                     ADD +1        TO ASC-BLK-SUB                 33300000
333100                     INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)   33310000
333200                     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)      33320000
333300                                                          TO TRUE 33330000
333400                 END-IF                                           33340000
333500             END-IF                                               33350000
333600             IF PS-NO-CONTENTS-FOUND                              33360000
333700                 SET ASC-MISSING-DATA (ASC-BLK-SUB ASC-ITEM-SUB)  33370000
333800                            TO TRUE                               33380000
333900             ELSE                                                 33390000
334000                 MOVE SPACE TO PS-CONTENT-SW                      33400000
334100                 SET ASC-NO-MISSING-DATA(ASC-BLK-SUB ASC-ITEM-SUB)33410000
334200                            TO TRUE                               33420000
334300             END-IF                                               33430000
334400             ADD +1                TO ASC-NUMBER-OF-ITEMS-READ    33440000
334500             SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB) TO TRUE          33450000
334600             MOVE ASC-NUMBER-OF-ITEMS-READ                        33460000
334700                                   TO ASC-LIST-ITEM-NUMBER        33470000
334800                                      (ASC-BLK-SUB ASC-ITEM-SUB)  33480000
334900             MOVE SPACES           TO  ASC-ACTION                 33490000
335000                                      (ASC-BLK-SUB ASC-ITEM-SUB)  33500000
335100             MOVE SUCRDV-SHIPT-UNT-ID                             33510000
335200                            TO ASC-SML (ASC-BLK-SUB ASC-ITEM-SUB) 33520000
335300             MOVE SUCRDV-DEST-OPER-UNT-ID TO                      33530000
335400                          ASC-DEST-NBR (ASC-BLK-SUB ASC-ITEM-SUB) 33540000
335500             MOVE ASC-CREATE-ID                                   33550000
335600                         TO ASC-CREATE (ASC-BLK-SUB ASC-ITEM-SUB) 33560000
335700             IF ASC-CREATE-ID = 'FXR'                             33570000
335800                IF  ASC-TRN-NBR  >  0                             33580000
335900                    MOVE ASC-TRN-NBR                              33590000
336000                    TO ASC-PO-RCVR-NBR (ASC-BLK-SUB ASC-ITEM-SUB) 33600000
336100                ELSE                                              33610000
336200                    MOVE 'UNKNOWN    '                            33620000
336300                    TO ASC-PO-RCVR-NBR (ASC-BLK-SUB ASC-ITEM-SUB) 33630000
336400                END-IF                                            33640000
336500             ELSE                                                 33650000
336600                 IF PS-NO-CONTENTS-FOUND                          33660000
336700                     IF ASC-CREATE-ID = 'MST'                     33670000
336800                         MOVE 'CHILDREN   '                       33680000
336900                              TO ASC-PO-RCVR-NBR                  33690000
337000                                (ASC-BLK-SUB ASC-ITEM-SUB)        33700000
337100                     ELSE                                         33710000
337200                         MOVE 'UNKNOWN    '                       33720000
337300                              TO ASC-PO-RCVR-NBR                  33730000
337400                                (ASC-BLK-SUB ASC-ITEM-SUB)        33740000
337500                     END-IF                                       33750000
337600                 ELSE                                             33760000
337700                    MOVE ASC-PO-RCVR                              33770000
337800                    TO ASC-PO-RCVR-NBR (ASC-BLK-SUB ASC-ITEM-SUB) 33780000
337900                 END-IF                                           33790000
338000             END-IF                                               33800000
338100                                                                  33810000
338200             EVALUATE PC046-CRTN-STATUS                           33820000
338300                 WHEN '01'                                        33830000
338400                     MOVE DK-INVALID-DESC TO ASC-LOAD-STATUS      33840000
338500                                       (ASC-BLK-SUB ASC-ITEM-SUB) 33850000
338600                 WHEN '02'                                        33860000
338700                     MOVE DK-INACT-DESC  TO ASC-LOAD-STATUS       33870000
338800                                       (ASC-BLK-SUB ASC-ITEM-SUB) 33880000
338900                 WHEN '03'                                        33890000
339000                     MOVE DK-SC-OF-DESC  TO ASC-LOAD-STATUS       33900000
339100                                       (ASC-BLK-SUB ASC-ITEM-SUB) 33910000
339200                 WHEN '04'                                        33920000
339300                     MOVE DK-SC-ON-DESC  TO ASC-LOAD-STATUS       33930000
339400                                       (ASC-BLK-SUB ASC-ITEM-SUB) 33940000
339500                 WHEN '05'                                        33950000
339600                     MOVE DK-DVRT-DESC   TO ASC-LOAD-STATUS       33960000
339700                                       (ASC-BLK-SUB ASC-ITEM-SUB) 33970000
339800                 WHEN '06'                                        33980000
339900                     MOVE DK-LOADED-DESC TO ASC-LOAD-STATUS       33990000
340000                                       (ASC-BLK-SUB ASC-ITEM-SUB) 34000000
340100                 WHEN '07'                                        34010000
340200                     MOVE DK-CSEPK-DESC  TO ASC-LOAD-STATUS       34020000
340300                                       (ASC-BLK-SUB ASC-ITEM-SUB) 34030000
340400                 WHEN '08'                                        34040000
340500                     MOVE DK-CK-IN-DESC  TO ASC-LOAD-STATUS       34050000
340600                                       (ASC-BLK-SUB ASC-ITEM-SUB) 34060000
340700                 WHEN '09'                                        34070000
340800                     MOVE DK-P2L-DESC    TO ASC-LOAD-STATUS       34080000
340900                                       (ASC-BLK-SUB ASC-ITEM-SUB) 34090000
341000                 WHEN '10'                                        34100000
341100                     MOVE DK-RDM-DESC    TO ASC-LOAD-STATUS       34110000
341200                                       (ASC-BLK-SUB ASC-ITEM-SUB) 34120000
341300                 WHEN '11'                                        34130000
341400                     MOVE DK-RECV-DESC   TO ASC-LOAD-STATUS       34140000
341500                                       (ASC-BLK-SUB ASC-ITEM-SUB) 34150000
341600                 WHEN '12'                                        34160000
341700                     MOVE DK-ASN-DESC    TO ASC-LOAD-STATUS       34170000
341800                                       (ASC-BLK-SUB ASC-ITEM-SUB) 34180000
341900                 WHEN '13'                                        34190000
342000                     MOVE DK-SMTH-DESC   TO ASC-LOAD-STATUS       34200000
342100                                       (ASC-BLK-SUB ASC-ITEM-SUB) 34210000
342200                 WHEN '14'                                        34220000
342300                     MOVE DK-XFER-DESC   TO ASC-LOAD-STATUS       34230000
342400                                       (ASC-BLK-SUB ASC-ITEM-SUB) 34240000
342500                 WHEN '15'                                        34250000
342600                     MOVE DK-MSTR-DESC   TO ASC-LOAD-STATUS       34260000
342700                                       (ASC-BLK-SUB ASC-ITEM-SUB) 34270000
342800                 WHEN '16'                                        34280000
342900                     MOVE DK-BLD-DESC    TO ASC-LOAD-STATUS       34290000
343000                                       (ASC-BLK-SUB ASC-ITEM-SUB) 34300000
343100                 WHEN '17'                                        34310000
343200                     MOVE DK-JWL-DESC    TO ASC-LOAD-STATUS       34320000
343300                                       (ASC-BLK-SUB ASC-ITEM-SUB) 34330000
343400                 WHEN '18'                                        34340000
343500                     MOVE DK-DMG-DESC    TO ASC-LOAD-STATUS       34350000
343600                                       (ASC-BLK-SUB ASC-ITEM-SUB) 34360000
343610                 WHEN '19'                                        34361020
343620                     MOVE DK-3WD-DESC    TO ASC-LOAD-STATUS       34362020
343630                                       (ASC-BLK-SUB ASC-ITEM-SUB) 34363020
343700             END-EVALUATE                                         34370000
343800             EVALUATE PC049-PV-REC-TYPE                           34380000
343900* A = DIVERTED CARTON                                             34390000
344000                 WHEN 'A'                                         34400000
344100                     IF SUCRDV-ACTV-CDE = PC-I                    34410000
344200                         MOVE SUCRDV-NACTV-USR-ID TO              34420000
344300                            ASC-USER-ID(ASC-BLK-SUB ASC-ITEM-SUB) 34430000
344400                         MOVE SUCRDV-ACTV-CDE TO                  34440000
344500                           ASC-ACTV-CDE(ASC-BLK-SUB ASC-ITEM-SUB) 34450000
344600                         MOVE DK-DVRT-DESC   TO ASC-LOAD-STATUS   34460000
344700                                       (ASC-BLK-SUB ASC-ITEM-SUB) 34470000
344800                     ELSE                                         34480000
344900                         MOVE SUCDOT-STRT-SCN-USR-ID TO           34490000
345000                            ASC-USER-ID(ASC-BLK-SUB ASC-ITEM-SUB) 34500000
345100                         MOVE SPACES TO                           34510000
345200                           ASC-ACTV-CDE(ASC-BLK-SUB ASC-ITEM-SUB) 34520000
345300                         ADD +1         TO ASC-DIVERT             34530000
345400                                           ASC-TOTAL              34540000
345500                     END-IF                                       34550000
345600* B = SCANNED CARTON                                              34560000
345700                 WHEN 'B'                                         34570000
345800                     IF SUCRDV-ACTV-CDE = PC-I                    34580000
345900                         MOVE SUCRDV-ACTV-CDE TO                  34590000
346000                           ASC-ACTV-CDE(ASC-BLK-SUB ASC-ITEM-SUB) 34600000
346100                         IF  SUCRDV-DOOR-ID   =  'SHON'           34610000
346200                             MOVE DK-SC-ON-DESC                   34620000
346300                               TO ASC-LOAD-STATUS                 34630000
346400                                       (ASC-BLK-SUB ASC-ITEM-SUB) 34640000
346500                             ADD +1         TO ASC-MANUAL         34650000
346600                         ELSE                                     34660000
346700                             MOVE DK-SC-OF-DESC                   34670000
346800                               TO ASC-LOAD-STATUS                 34680000
346900                                       (ASC-BLK-SUB ASC-ITEM-SUB) 34690000
347000                             ADD +1         TO ASC-SCAN-OFF       34700000
347100                         END-IF                                   34710000
347200                         MOVE SUCDOT-STRT-SCN-USR-ID              34720000
347300                                             TO ASC-USER-ID       34730000
347400                                       (ASC-BLK-SUB ASC-ITEM-SUB) 34740000
347500                     ELSE                                         34750000
347600                         MOVE SUCDOT-STRT-SCN-USR-ID TO           34760000
347700                            ASC-USER-ID(ASC-BLK-SUB ASC-ITEM-SUB) 34770000
347800                         MOVE SPACES TO                           34780000
347900                           ASC-ACTV-CDE(ASC-BLK-SUB ASC-ITEM-SUB) 34790000
348000                         MOVE DK-SC-ON-DESC TO ASC-LOAD-STATUS    34800000
348100                                       (ASC-BLK-SUB ASC-ITEM-SUB) 34810000
348200                         ADD +1         TO ASC-MANUAL             34820000
348300                                           ASC-TOTAL              34830000
348400                     END-IF                                       34840000
348500                     MOVE ASC-STR-NBR  TO                         34850000
348600                          ASC-DEST-NBR (ASC-BLK-SUB ASC-ITEM-SUB) 34860000
348700* C = ASSUMED ON THE TRAILER                                      34870000
348800                 WHEN 'C'                                         34880000
348900                     IF SUCRDV-ACTV-CDE = PC-I                    34890000
349000                         MOVE SUCRDV-NACTV-USR-ID TO              34900000
349100                           ASC-USER-ID(ASC-BLK-SUB ASC-ITEM-SUB)  34910000
349200                         MOVE SUCRDV-ACTV-CDE TO                  34920000
349300                           ASC-ACTV-CDE(ASC-BLK-SUB ASC-ITEM-SUB) 34930000
349400                     ELSE                                         34940000
349500                         MOVE SUCDOT-STRT-SCN-USR-ID TO           34950000
349600                            ASC-USER-ID(ASC-BLK-SUB ASC-ITEM-SUB) 34960000
349700                         MOVE SPACES  TO                          34970000
349800                           ASC-ACTV-CDE(ASC-BLK-SUB ASC-ITEM-SUB) 34980000
349900                         ADD +1         TO ASC-ASSUMED            34990000
350000                                           ASC-TOTAL              35000000
350100                     END-IF                                       35010000
350300                     IF  ASC-LOAD-STATUS(ASC-BLK-SUB ASC-ITEM-SUB)35030000
350400                         =  DK-INACT-DESC                         35040000
350500                         CONTINUE                                 35050000
350600                     ELSE                                         35060000
350700                         MOVE DK-ASSUMED  TO ASC-LOAD-STATUS      35070000
350800                                       (ASC-BLK-SUB ASC-ITEM-SUB) 35080000
350900                     END-IF                                       35090000
351100             END-EVALUATE                                         35110000
351200             EVALUATE PC049-PV-REC-TYPE-2                         35120000
351300* S = START OF THE DIVERT                                         35130000
351400                 WHEN 'S'                                         35140000
351500                     IF SUCRDV-ACTV-CDE = PC-I                    35150000
351600                         MOVE SUCRDV-NACTV-USR-ID TO              35160000
351700                            ASC-USER-ID(ASC-BLK-SUB ASC-ITEM-SUB) 35170000
351800                         MOVE SUCRDV-ACTV-CDE TO                  35180000
351900                           ASC-ACTV-CDE(ASC-BLK-SUB ASC-ITEM-SUB) 35190000
352000                     ELSE                                         35200000
352100                         MOVE SUCDOT-STRT-SCN-USR-ID TO           35210000
352200                            ASC-USER-ID(ASC-BLK-SUB ASC-ITEM-SUB) 35220000
352300                         MOVE SPACES  TO                          35230000
352400                           ASC-ACTV-CDE(ASC-BLK-SUB ASC-ITEM-SUB) 35240000
352500                     END-IF                                       35250000
352600                     MOVE 'DVT BEG' TO ASC-LOAD-STATUS            35260000
352700                                      (ASC-BLK-SUB ASC-ITEM-SUB)  35270000
352800* E = END OF THE DIVERT                                           35280000
352900                 WHEN 'E'                                         35290000
353000                     IF SUCRDV-ACTV-CDE = PC-I                    35300000
353100                         MOVE SUCRDV-NACTV-USR-ID TO              35310000
353200                            ASC-USER-ID(ASC-BLK-SUB ASC-ITEM-SUB) 35320000
353300                         MOVE SUCRDV-ACTV-CDE TO                  35330000
353400                           ASC-ACTV-CDE(ASC-BLK-SUB ASC-ITEM-SUB) 35340000
353500                     ELSE                                         35350000
353600                         MOVE SUCDOT-STRT-SCN-USR-ID TO           35360000
353700                            ASC-USER-ID(ASC-BLK-SUB ASC-ITEM-SUB) 35370000
353800                         MOVE SPACES  TO                          35380000
353900                           ASC-ACTV-CDE(ASC-BLK-SUB ASC-ITEM-SUB) 35390000
354000                     END-IF                                       35400000
354100                     MOVE 'DVT END' TO ASC-LOAD-STATUS            35410000
354200                                      (ASC-BLK-SUB ASC-ITEM-SUB)  35420000
354300             END-EVALUATE                                         35430000
354400             IF ASC-LOAD-STATUS (ASC-BLK-SUB ASC-ITEM-SUB) =      35440000
354500                                        'DVT BEG'                 35450000
354600                 MOVE SUCDOT-STRT-SCN-TMST   TO PV-TMST           35460000
354700             ELSE                                                 35470000
354800             IF ASC-LOAD-STATUS (ASC-BLK-SUB ASC-ITEM-SUB) =      35480000
354900                                        'DVT END'                 35490000
355000                 MOVE SUCDOT-END-SCN-TMST    TO PV-TMST           35500000
355100             ELSE                                                 35510000
355200             IF ASC-LOAD-STATUS (ASC-BLK-SUB ASC-ITEM-SUB) =      35520000
355300                          'SCND ON' OR 'SCD OFF'                  35530000
355400                           OR 'ASSUMED' OR 'DIVERTD'              35540000
355500                           OR 'LOADED '                           35550000
355600                 MOVE SUCRDV-DIVERT-TMST     TO PV-TMST           35560000
355700             ELSE                                                 35570000
355800             IF PC046-CRTN-STAT-TMST = PC-EMPTY-TIMESTAMP         35580000
355900                 MOVE SPACES                 TO PV-TMST           35590000
356000             ELSE                                                 35600000
356100                 MOVE PC046-CRTN-STAT-TMST   TO PV-TMST           35610000
356200             END-IF                                               35620000
356300             END-IF                                               35630000
356400             END-IF                                               35640000
356500             END-IF                                               35650000
356600             MOVE PV-TMST-YY             TO PV-DISPLAY-YY         35660000
356700             MOVE PV-TMST-MM             TO PV-DISPLAY-MM         35670000
356800             MOVE PV-TMST-DD             TO PV-DISPLAY-DD         35680000
356900                                                                  35690000
357000             MOVE '4306-READ-ITEMS-FROM-DB'                       35700000
357100                        TO PV-SAVE-SOURCE-PARA                    35710000
357200             IF PV-TMST > SPACES                                  35720000
357300                 PERFORM 4300A-FORMAT-DATE-TIME                   35730000
357400                 STRING PV-USA-DATE(1:6) PV-USA-DATE(9:2)         35740000
357500                     DELIMITED BY SIZE                            35750000
357600                    INTO ASC-STAT-DATE (ASC-BLK-SUB ASC-ITEM-SUB) 35760000
357700                 MOVE PV-JIS-HH-MM                                35770000
357800                      TO ASC-STAT-TIME (ASC-BLK-SUB ASC-ITEM-SUB) 35780000
357900             ELSE                                                 35790000
358000                 MOVE SPACES                                      35800000
358100                      TO ASC-STAT-DATE (ASC-BLK-SUB ASC-ITEM-SUB) 35810000
358200                         ASC-STAT-TIME (ASC-BLK-SUB ASC-ITEM-SUB) 35820000
358300             END-IF                                               35830000
358400                                                                  35840000
358421             PERFORM 4325-GET-STORE-SCAN-CDE                      35842110
358440                                                                  35844010
362000           END-IF                                                 36200000
362100         END-IF                                                   36210000
362200     END-PERFORM.                                                 36220000
362300                                                                  36230000
362400     IF  ASC-NUMBER-OF-ITEMS-READ > ZERO                          36240000
362500         MOVE +1               TO ASC-BLK-SUB                     36250000
362600         PERFORM 5100-WRITE-TEMP-STORAGE                          36260000
362700         ADD +1                TO ASC-BLK-SUB                     36270000
362800         PERFORM 5100-WRITE-TEMP-STORAGE                          36280000
362900                                                                  36290000
363000         MOVE 1                TO ASC-BLK-SUB                     36300000
363100                                  PV-BLOCK-NUMBER                 36310000
363200         PERFORM 4410-READ-TEMP-STORAGE                           36320000
363300         IF  ASC-HIGHEST-BLOCK-WRITTEN GREATER THAN 1             36330000
363400             MOVE 2            TO ASC-BLK-SUB                     36340000
363500                                  PV-BLOCK-NUMBER                 36350000
363600             PERFORM 4410-READ-TEMP-STORAGE                       36360000
363700         END-IF                                                   36370000
363800     END-IF.                                                      36380000
363900                                                                  36390000
364000*----------------------------------------------------------------*36400000
364100* CHECK FOR CARTON CONTENTS ON SUT_OTBND_UPC TABLE                36410000
364200*----------------------------------------------------------------*36420000
364300 4308-CHECK-CARTON-CONTENTS.                                      36430000
364400                                                                  36440000
364500     EXEC SQL                                                     36450000
364600          SELECT TRN_NBR                                          36460000
364700            INTO :SUT00028-TRN-NBR                                36470000
364800           FROM  SUT_OTBND_UPC                                    36480000
364900          WHERE  SHIPT_UNT_ID  =  :DK-SHIPT-UNT-ID                36490000
365000     END-EXEC                                                     36500000
365100     EVALUATE TRUE                                                36510000
365200         WHEN SQLCODE = ZERO                                      36520000
365300         WHEN SQLCODE = -811                                      36530000
365400             SET PS-FOUND-CONTENTS     TO TRUE                    36540000
365500         WHEN SQLCODE = +100                                      36550000
365600             SET PS-NO-CONTENTS-FOUND  TO TRUE                    36560000
365700         WHEN SQLWARN0 NOT = SPACE                                36570000
365800         WHEN SQLCODE NOT = ZERO                                  36580000
365900             SET PS-NO-CONTENTS-FOUND  TO TRUE                    36590000
366000     END-EVALUATE.                                                36600000
366100                                                                  36610000
366200*----------------------------------------------------------------*36620000
366300*    FETCH THE CURSOR                                             36630000
366400*----------------------------------------------------------------*36640000
366500 4310-FETCH.                                                      36650000
366600                                                                  36660000
367000     EVALUATE TRUE                                                36700000
367100     WHEN PC049-SHTL-DVRT-CRTN-CSR OR PC049-SHIP-DVRT-CRTN-CSR    36710000
367200         PERFORM P7040-FETCH-DVRT-CRTN-CSR                        36720000
367300         IF SQLCODE = ZERO                                        36730000
367400             MOVE SUCRDV-SHIPT-UNT-ID TO PV-SHIPT-UNT-ID          36740000
367500                                     DK-SHIPT-UNT-ID              36750000
367600         END-IF                                                   36760000
367700                                                                  36770000
367800     WHEN PC049-SCAN-ON-CRTN-CSR                                  36780000
367900         PERFORM P7010-FETCH-SCAN-CRTN-CSR                        36790000
368000         IF SQLCODE = ZERO                                        36800000
368100             MOVE SUT00027-SHIPT-UNT-ID TO PV-SHIPT-UNT-ID        36810000
368200                                         DK-SHIPT-UNT-ID          36820000
368300         END-IF                                                   36830000
368400                                                                  36840000
368500     WHEN PC049-SHP-TR-ALL-CTN-CSR                                36850000
368600         PERFORM P7165-FETCH-SHP-TR-ALL-CTN-CSR                   36860000
368700         IF SQLCODE = ZERO                                        36870000
368800             MOVE SUCRDV-SHIPT-UNT-ID TO PV-SHIPT-UNT-ID          36880000
368900                                         DK-SHIPT-UNT-ID          36890000
369000         END-IF                                                   36900000
370100                                                                  37010000
370200     WHEN OTHER                                                   37020000
370300         PERFORM P7225-FETCH-SHTL-TR-AL-CTN-CSR                   37030000
370400         IF SQLCODE = ZERO                                        37040000
370500             MOVE SUCRDV-SHIPT-UNT-ID TO PV-SHIPT-UNT-ID          37050000
370600                                             DK-SHIPT-UNT-ID      37060000
370700         END-IF                                                   37070000
370800     END-EVALUATE.                                                37080000
370900                                                                  37090000
371000     EVALUATE TRUE                                                37100000
371100         WHEN SQLCODE = ZEROS                                     37110000
371200         WHEN SQLCODE = +100                                      37120000
371300              CONTINUE                                            37130000
371400                                                                  37140000
371500         WHEN SQLCODE = -904                                      37150000
371600         WHEN SQLCODE = -911                                      37160000
371700         WHEN SQLCODE = -913                                      37170000
371800              MOVE PC049-DK-OPER-UNT-ID    TO PV-DISPLAY-OPER     37180000
371900              MOVE PC049-DK-OTBND-TRIP-ID  TO PV-DISPLAY-TRIP     37190000
372000              MOVE PC049-PV-STORE-01       TO PV-DISPLAY-STORE-1  37200000
372100              MOVE PC049-PV-STORE-02       TO PV-DISPLAY-STORE-2  37210000
372200              MOVE PC049-PV-STORE-03       TO PV-DISPLAY-STORE-3  37220000
372300              MOVE PC049-PV-STORE-04       TO PV-DISPLAY-STORE-4  37230000
372400              MOVE PC049-DK-DOOR-ID        TO PV-DISPLAY-DOOR     37240000
372500                                                                  37250000
372600              INITIALIZE DP013-MESSAGE-TEXT (1)                   37260000
372700              MOVE '4310-FETCH'            TO DP013-PARAGRAPH     37270000
372800              STRING 'FETCH CURSOR-'          DELIMITED BY SIZE   37280000
372900                     PC049-CURSOR-SWITCHES    DELIMITED BY SIZE   37290000
373000                     ' TRIP-' PV-DISPLAY-TRIP DELIMITED BY SIZE   37300000
373100                     ' OPER-' PV-DISPLAY-OPER DELIMITED BY SIZE   37310000
373200                     ' DOOR-' PV-DISPLAY-DOOR DELIMITED BY SIZE   37320000
373300                                      INTO DP013-MESSAGE-TEXT (1) 37330000
373400                                                                  37340000
373500              STRING 'STORES-'                DELIMITED BY SIZE   37350000
373600                     PV-DISPLAY-STORE-1 '-'   DELIMITED BY SIZE   37360000
373700                     PV-DISPLAY-STORE-2 '-'   DELIMITED BY SIZE   37370000
373800                     PV-DISPLAY-STORE-3 '-'   DELIMITED BY SIZE   37380000
373900                     PV-DISPLAY-STORE-4       DELIMITED BY SIZE   37390000
374000                     ' DFLT TMST-'            DELIMITED BY SIZE   37400000
374100                     PC049-PC-DEFAULT-TMST    DELIMITED BY SIZE   37410000
374200                                      INTO DP013-MESSAGE-TEXT (2) 37420000
374300                                                                  37430000
374400             STRING ' START-'                 DELIMITED BY SIZE   37440000
374500                    PC049-DK-START-TMST       DELIMITED BY SIZE   37450000
374600                    ' END-'                   DELIMITED BY SIZE   37460000
374700                    PC049-DK-END-TMST         DELIMITED BY SIZE   37470000
374800                                      INTO DP013-MESSAGE-TEXT (3) 37480000
374900                                                                  37490000
375000              MOVE SQLCA       TO DP013-SQLCA                     37500000
375100              MOVE 'SUT00027'   TO DP013-DB2-TABLE-NAME (1)       37510000
375200              MOVE 'TSUCRDV '   TO DP013-DB2-TABLE-NAME (2)       37520000
375300              MOVE 'TSUCDOT '   TO DP013-DB2-TABLE-NAME (3)       37530000
375400              SET DP013-DB2-ABEND TO TRUE                         37540000
375500              PERFORM DP013-0000-PROCESS-ABEND                    37550000
375600               SET  PS-ERROR                                      37560000
375700                    DP020-MSG-FATAL TO TRUE                       37570000
375800              MOVE PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          37580000
375900                                                                  37590000
376000         WHEN OTHER                                               37600000
376100              MOVE PC049-DK-OPER-UNT-ID    TO PV-DISPLAY-OPER     37610000
376200              MOVE PC049-DK-OTBND-TRIP-ID  TO PV-DISPLAY-TRIP     37620000
376300              MOVE PC049-PV-STORE-01       TO PV-DISPLAY-STORE-1  37630000
376400              MOVE PC049-PV-STORE-02       TO PV-DISPLAY-STORE-2  37640000
376500              MOVE PC049-PV-STORE-03       TO PV-DISPLAY-STORE-3  37650000
376600              MOVE PC049-PV-STORE-04       TO PV-DISPLAY-STORE-4  37660000
376700              MOVE PC049-DK-DOOR-ID        TO PV-DISPLAY-DOOR     37670000
376800                                                                  37680000
376900              INITIALIZE DP013-MESSAGE-TEXT (1)                   37690000
377000              MOVE '4310-FETCH'            TO DP013-PARAGRAPH     37700000
377100              STRING 'FETCH CURSOR-'          DELIMITED BY SIZE   37710000
377200                     PC049-CURSOR-SWITCHES    DELIMITED BY SIZE   37720000
377300                     ' TRIP-' PV-DISPLAY-TRIP DELIMITED BY SIZE   37730000
377400                     ' OPER-' PV-DISPLAY-OPER DELIMITED BY SIZE   37740000
377500                     ' DOOR-' PV-DISPLAY-DOOR DELIMITED BY SIZE   37750000
377600                                      INTO DP013-MESSAGE-TEXT (1) 37760000
377700                                                                  37770000
377800              STRING 'STORES-'                DELIMITED BY SIZE   37780000
377900                     PV-DISPLAY-STORE-1 '-'   DELIMITED BY SIZE   37790000
378000                     PV-DISPLAY-STORE-2 '-'   DELIMITED BY SIZE   37800000
378100                     PV-DISPLAY-STORE-3 '-'   DELIMITED BY SIZE   37810000
378200                     PV-DISPLAY-STORE-4       DELIMITED BY SIZE   37820000
378300                     ' DFLT TMST-'            DELIMITED BY SIZE   37830000
378400                                      INTO DP013-MESSAGE-TEXT (2) 37840000
378500                                                                  37850000
378600             STRING ' START-'                 DELIMITED BY SIZE   37860000
378700                    PC049-DK-START-TMST       DELIMITED BY SIZE   37870000
378800                    ' END-'                   DELIMITED BY SIZE   37880000
378900                    PC049-DK-END-TMST         DELIMITED BY SIZE   37890000
379000                                      INTO DP013-MESSAGE-TEXT (3) 37900000
379100                                                                  37910000
379200              MOVE SQLCA       TO DP013-SQLCA                     37920000
379300              MOVE 'SUT00027'   TO DP013-DB2-TABLE-NAME (1)       37930000
379400              MOVE 'TSUCRDV '   TO DP013-DB2-TABLE-NAME (2)       37940000
379500              MOVE 'TSUCDOT '   TO DP013-DB2-TABLE-NAME (3)       37950000
379600              SET DP013-DB2-ABEND TO TRUE                         37960000
379700              PERFORM DP013-0000-PROCESS-ABEND                    37970000
379800              SET  PS-ERROR                                       37980000
379900                   DP020-MSG-FATAL TO TRUE                        37990000
380000              MOVE PC-TSYMSG-00551  TO  DP020-MSG-NUMBER          38000000
380100     END-EVALUATE.                                                38010000
380200                                                                  38020000
380300     IF  PC049-EOF-DVRT-CRTN                                      38030000
380400     OR  PC049-EOF-SCAN-CRTN                                      38040000
380500     OR  PC049-EOF-SHP-TR-ALL-CTN                                 38050000
380600     OR  PC049-EOF-SHTL-TR-AL-CTN                                 38060000
380700         SET ASC-NO-ITEMS-LEFT-ON-DB TO TRUE                      38070000
380800     ELSE                                                         38080000
380900     PERFORM 4350-RETRIEVE-PO-INFO                                38090000
381000         IF PV-SHIPT-UNT-ID (1:2) = '41'                          38100000
381002            OR PV-SHIPT-UNT-ID (1:2) = '42'                       38100200
381100             CONTINUE                                             38110000
381200         ELSE                                                     38120000
381300             PERFORM 7000-GET-KOHLS-SML                           38130000
381400             IF SUT00024-SHIPT-UNT-ID   = PV-SHIPT-UNT-ID         38140000
381500                 CONTINUE                                         38150000
381600             ELSE                                                 38160000
381700                 MOVE SUT00024-SHIPT-UNT-ID                       38170000
381800                                      TO SUT00027-SHIPT-UNT-ID    38180000
381900                                         SUCRDV-SHIPT-UNT-ID      38190000
382000                 MOVE 'CKN'           TO ASC-CREATE-ID            38200000
382100             END-IF                                               38210000
382200         END-IF                                                   38220000
382300     END-IF.                                                      38230000
382600                                                                  38260000
382700                                                                  38270000
382800*----------------------------------------------------------------*38280000
382900* RETRIEVE DOOR ID DESCRIPTION FROM TCNDCDR TABLE                 38290000
383000*----------------------------------------------------------------*38300000
383100 4320-GET-DOOR-ID-DESC.                                           38310000
383200                                                                  38320000
383300     EXEC SQL                                                     38330000
383400          SELECT DOOR_LOC_DESC                                    38340000
383500          INTO  :CNDCDR-DOOR-LOC-DESC                             38350000
383600           FROM  TCNDCDR                                          38360000
383700          WHERE  OPER_UNT_ID  =  :DK-OPER-UNT-ID                  38370000
383800            AND  DOOR_ID      =  :SUOBTS-DOOR-ID                  38380000
383900     END-EXEC                                                     38390000
384000     EVALUATE TRUE                                                38400000
384100         WHEN SQLCODE = ZERO                                      38410000
384200             MOVE SUOBTS-DOOR-ID       TO ASC-NUMBER              38420000
384300             MOVE CNDCDR-DOOR-LOC-DESC TO ASC-DOOR-DESC           38430000
384400         WHEN SQLCODE = +100                                      38440000
384500             MOVE SPACES TO ASC-DOOR-DESC                         38450000
384600                            ASC-NUMBER                            38460000
384700         WHEN SQLWARN0 NOT = SPACE                                38470000
384800         WHEN SQLCODE NOT = ZERO                                  38480000
384900              MOVE '4320-GET-DOOR-ID-DESC' TO DP013-PARAGRAPH     38490000
385000              MOVE 'GET DOOR ID DESCRIPTION'                      38500000
385100                               TO DP013-MESSAGE-TEXT (1)          38510000
385200              MOVE SQLCA       TO DP013-SQLCA                     38520000
385300              MOVE 'TCNDCDR '   TO DP013-DB2-TABLE-NAME (1)       38530000
385400              SET DP013-DB2-ABEND TO TRUE                         38540000
385500              PERFORM DP013-0000-PROCESS-ABEND                    38550000
385600     END-EVALUATE.                                                38560000
385700                                                                  38570000
385710*----------------------------------------------------------------*38571010
385720* CHECK TO SEE IF CARTON HAS BEEN SCAN BASED RECEIVE AT A STORE   38572010
385730*----------------------------------------------------------------*38573010
385740 4325-GET-STORE-SCAN-CDE.                                         38574010
385750                                                                  38575010
385751     MOVE ASC-SML (ASC-BLK-SUB ASC-ITEM-SUB)                      38575110
385752                                       TO SUT00121-SHIPT-UNT-ID   38575210
385753                                                                  38575310
385760     EXEC SQL                                                     38576010
385770          SELECT SCN_TYP_CDE                                      38577010
385780          INTO  :SUT00121-SCN-TYP-CDE                             38578010
385790           FROM  SUT_OTBND_STR_SCN A                              38579010
385791          WHERE A.SHIPT_UNT_ID = :SUT00121-SHIPT-UNT-ID           38579110
385792            AND A.CRE_TMST IN                                     38579211
385793                (SELECT MAX(B.CRE_TMST)                           38579310
385794                   FROM SUT_OTBND_STR_SCN B                       38579410
385795                  WHERE A.SHIPT_UNT_ID  =  B.SHIPT_UNT_ID         38579511
385796                    AND NOT B.SCN_TYP_CDE  =  'SSMS'              38579613
385797                )                                                 38579713
385798     END-EXEC                                                     38579813
385799     EVALUATE TRUE                                                38579913
385800         WHEN SQLCODE = ZERO                                      38580013
385801             MOVE SUT00121-SCN-TYP-CDE                            38580113
385802               TO ASC-STR-SCAN (ASC-BLK-SUB ASC-ITEM-SUB)         38580213
385803             PERFORM 4330-CHECK-MULT-STORE-SCAN                   38580316
385804         WHEN SQLCODE = +100                                      38580413
385805             MOVE SPACES                                          38580513
385806               TO ASC-STR-SCAN (ASC-BLK-SUB ASC-ITEM-SUB)         38580613
385807                  ASC-MULT-SCAN-SW (ASC-BLK-SUB ASC-ITEM-SUB)     38580716
385808                                                                  38580816
385809         WHEN SQLWARN0 NOT = SPACE                                38580910
385810         WHEN SQLCODE NOT = ZERO                                  38581010
385811              MOVE '4325-GET-STORE-SCAN-CDE'TO DP013-PARAGRAPH    38581110
385812              MOVE 'GET STORE SCAN CODE    '                      38581210
385813                               TO DP013-MESSAGE-TEXT (1)          38581310
385814              MOVE SQLCA       TO DP013-SQLCA                     38581410
385815              MOVE 'SUT00121'   TO DP013-DB2-TABLE-NAME (1)       38581510
385816              SET DP013-DB2-ABEND TO TRUE                         38581610
385817              PERFORM DP013-0000-PROCESS-ABEND                    38581710
385818     END-EVALUATE.                                                38581810
385819                                                                  38581910
385820                                                                  38582016
385821*----------------------------------------------------------------*38582116
385822* CHECK TO THE CARTON WAS SCANNED MULTIPLE TIMES                  38582216
385824*----------------------------------------------------------------*38582416
385825 4330-CHECK-MULT-STORE-SCAN.                                      38582516
385826                                                                  38582616
385830     EXEC SQL                                                     38583016
385831          SELECT COUNT(*)                                         38583116
385832          INTO  :PV-STORE-SCAN-COUNT                              38583216
385833           FROM  SUT_OTBND_STR_SCN A                              38583316
385834          WHERE A.SHIPT_UNT_ID = :SUT00121-SHIPT-UNT-ID           38583416
385841     END-EXEC                                                     38584116
385842     EVALUATE TRUE                                                38584216
385843         WHEN SQLCODE = ZERO                                      38584316
385844             IF  PV-STORE-SCAN-COUNT  > 1                         38584416
385845                 MOVE  'M'  TO  ASC-MULT-SCAN-SW                  38584516
385846                                  (ASC-BLK-SUB ASC-ITEM-SUB)      38584616
385848             ELSE                                                 38584816
385849                 MOVE  ' '  TO  ASC-MULT-SCAN-SW                  38584916
385850                                  (ASC-BLK-SUB ASC-ITEM-SUB)      38585016
385851             END-IF                                               38585116
385852                                                                  38585216
385856         WHEN SQLCODE = +100                                      38585616
385857                 MOVE  ' '  TO  ASC-MULT-SCAN-SW                  38585716
385858                                  (ASC-BLK-SUB ASC-ITEM-SUB)      38585816
385861         WHEN SQLWARN0 NOT = SPACE                                38586116
385862         WHEN SQLCODE NOT = ZERO                                  38586216
385863              MOVE '4330-CHECK-MULT-STORE-SCAN'                   38586316
385864                                            TO DP013-PARAGRAPH    38586416
385865              MOVE 'GET STORE SCAN CODE    '                      38586516
385866                               TO DP013-MESSAGE-TEXT (1)          38586616
385867              MOVE SQLCA       TO DP013-SQLCA                     38586716
385868              MOVE 'SUT00121'   TO DP013-DB2-TABLE-NAME (1)       38586816
385869              SET DP013-DB2-ABEND TO TRUE                         38586916
385870              PERFORM DP013-0000-PROCESS-ABEND                    38587016
385871     END-EVALUATE.                                                38587116
385872                                                                  38587216
385873                                                                  38587316
385880*----------------------------------------------------------------*38588000
385900* CALL PCKUT713 TO RETRIEVE PO, RCVR, DEST-OPER-UNT-ID, ETC.      38590018
386000*----------------------------------------------------------------*38600000
386100 4350-RETRIEVE-PO-INFO.                                           38610000
386200                                                                  38620000
386300     INITIALIZE  PC046-COMMAREA-REC.                              38630000
386400     MOVE  ZEROES  TO  ASC-TRN-NBR.                               38640000
386500     SET   PC046-FROM-SHIPPING-DOOR TO TRUE.                      38650000
386600     IF PC049-SCAN-ON-CRTN-CSR                                    38660000
386700         MOVE SUT00027-SHIPT-UNT-ID TO PC046-CARTON-ID            38670000
386800     ELSE                                                         38680000
386900         MOVE SUCRDV-SHIPT-UNT-ID  TO  PC046-CARTON-ID            38690000
387000     END-IF.                                                      38700000
387100                                                                  38710000
387200     CALL PC046-CARTON-STATUS-MODULE                              38720000
387300             USING DFHEIBLK                                       38730000
387400             PC046-COMMAREA                                       38740000
387500             PC046-COMMAREA-REC                                   38750000
387600     END-CALL                                                     38760000
387700                                                                  38770000
387800     PERFORM 4375-VALIDATE-STATUS-CALL.                           38780000
387900                                                                  38790000
388000*----------------------------------------------------------------*38800000
388100* CHECK RETURN CODE FROM CRTN STATUS PROGRAM TO SEE IF SUCCESSFUL*38810000
388200*----------------------------------------------------------------*38820000
388300 4375-VALIDATE-STATUS-CALL.                                       38830000
388400                                                                  38840000
388500     IF  PC046-SUCCESSFUL                                         38850000
388600         MOVE  PC046-DEST-OPER-UNT-ID  TO  ASC-STR-NBR            38860000
388700         MOVE  PC046-SHPUNT-SRC-ID     TO  ASC-CREATE-ID          38870000
388800         IF PC046-MULT-PO = 'MULTIPLE '                           38880000
388900             MOVE PC046-MULT-PO   TO  ASC-PO-RCVR                 38890000
389000         ELSE                                                     38900000
389100             IF  PC046-PO-NBR > ZERO                              38910000
389200                 IF ASC-CREATE-ID = 'RDM'                         38920000
389401                     MOVE PC046-TRN-NBR    TO PV-DISP-PULL        38940100
389402                     MOVE PV-DISP-PULL-NBR TO ASC-PO-RCVR         38940200
389500                 ELSE                                             38950000
389600                 IF ASC-CREATE-ID = 'FXR'                         38960000
389700                     MOVE PC046-TRN-NBR TO PV-DISP-TRN            38970000
389800                     MOVE PV-DISP-TRN-NBR TO ASC-TRN-NBR          38980000
389900                 ELSE                                             38990000
390000                     MOVE PC046-PO-NBR    TO PV-DISP-PO           39000000
390100                     MOVE PC046-RCVR-NBR  TO PV-DISP-RCVR         39010000
390200                     MOVE PV-DISP-PO-RCVR TO  ASC-PO-RCVR         39020000
390300                 END-IF                                           39030000
390400                 END-IF                                           39040000
390500             ELSE                                                 39050000
390600                 MOVE  SPACES        TO  ASC-PO-RCVR              39060000
390700             END-IF                                               39070000
390800         END-IF                                                   39080000
390900     ELSE                                                         39090000
391000         SET  PS-ERROR       TO  TRUE                             39100000
391100         PERFORM 9904-WRITE-CRTN-MODULE-MSG                       39110000
391200     END-IF.                                                      39120000
391300                                                                  39130000
391400*----------------------------------------------------------------*39140000
391500* MOVE THE DISPLAYED FIELDS FROM THE COMMAREA TO THE SCREEN.     *39150000
391600*----------------------------------------------------------------*39160000
391700 4400-MOVE-COMMAREA-TO-SCREEN.                                    39170000
391800                                                                  39180000
391900     IF  (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1))             39190000
392000         AND (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1)))          39200000
392100         OR  (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)))          39210000
392200             MOVE +1    TO ASC-BLK-SUB                            39220000
392300             PERFORM 5100-WRITE-TEMP-STORAGE                      39230000
392400             ADD +1     TO ASC-BLK-SUB                            39240000
392500             PERFORM 5100-WRITE-TEMP-STORAGE                      39250000
392600             DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             39260000
392700                 GIVING PV-BLOCK-NUMBER                           39270000
392800                 REMAINDER PV-REMAINDER                           39280000
392900             IF  PV-REMAINDER > ZERO                              39290000
393000                 ADD +1 TO PV-BLOCK-NUMBER                        39300000
393100             END-IF                                               39310000
393200             MOVE +1    TO ASC-BLK-SUB                            39320000
393300             PERFORM 4410-READ-TEMP-STORAGE                       39330000
393400             ADD +1     TO ASC-BLK-SUB                            39340000
393500                           PV-BLOCK-NUMBER                        39350000
393600             PERFORM 4410-READ-TEMP-STORAGE                       39360000
393700     END-IF.                                                      39370000
393800     MOVE +1            TO ASC-BLK-SUB.                           39380000
393900     COMPUTE ASC-ITEM-SUB =                                       39390000
394000         ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              39400000
394100         + PC-ITEMS-PER-PANEL).                                   39410000
394200*                                                                 39420000
394300     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        39430000
394400         ADD +1         TO ASC-BLK-SUB                            39440000
394500         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            39450000
394600     END-IF.                                                      39460000
394700*                                                                 39470000
394800     COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           39480000
394900         ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                39490000
395000     PERFORM 4430-CHECK-FOR-BEGIN-AND-END.                        39500000
395100     PERFORM 4420-FORMAT-LIST-LINES                               39510000
395200         VARYING PV-SUB                                           39520000
395300         FROM PC-ITEMS-PER-PANEL BY -1                            39530000
395400         UNTIL PV-SUB < +1.                                       39540000
395500*                                                                 39550000
395600     COMPUTE ASC-ITEMS-DISPLAYED =                                39560000
395700         ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).          39570000
395800     MOVE PV-TOP-ITEM              TO ASC-ITEM-AT-TOP-OF-PANEL    39580000
395900                                      ASTRTITO.                   39590000
396000     MOVE ASC-ITEM-AT-BOT-OF-PANEL TO AENDITO.                    39600000
396100     MOVE ASC-NUMBER-OF-ITEMS-READ TO ATOTITO.                    39610000
396200     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            39620000
396300                                   TO ASELITO.                    39630000
396400                                                                  39640000
396500     MOVE ASC-OPER-UNT-ID            TO AOPERO.                   39650000
396600     MOVE ASC-SCAC-CODE              TO ASCACO.                   39660000
396700     MOVE ASC-MANUAL                 TO AMANUALO.                 39670000
396800     MOVE ASC-DIVERT                 TO ADIVERTO.                 39680000
396900     MOVE ASC-TRLR-SRL-NMBR          TO ATRLRO.                   39690000
397000     MOVE ASC-TRLR-ID                TO ATRLRIDO.                 39700000
397100     MOVE ASC-SCAN-OFF               TO ASCANNDO.                 39710000
397200     MOVE ASC-ASSUMED                TO AASSUMDO.                 39720000
397300     MOVE ASC-OUTBOUND-TRIP-ID       TO ATRIPO.                   39730000
397400     MOVE ASC-DOORSLOT               TO ADRSLTO.                  39740000
397500     MOVE ASC-NUMBER                 TO ANMBRO.                   39750000
397600     MOVE ASC-DOOR-DESC              TO ADESCO.                   39760000
397700     MOVE ASC-TOTAL                  TO ATOTALO.                  39770000
397800     MOVE ASC-TRIP-DEST-OPER-N       TO ATRPDSTO.                 39780000
397810     MOVE ASC-TRIP-STATUS            TO ATRPSTAO.                 39781008
397820     MOVE ASC-TRIP-STATUS-DATE       TO ASTADTEO.                 39782008
397900                                                                  39790000
398000     IF  DP020-MSG-NUMBER-X = SPACE                               39800000
398100         IF  ASC-ITEM-AT-BOT-OF-PANEL < ASC-NUMBER-OF-ITEMS-READ  39810000
398200*            --- MORE ITEMS TO DISPLAY ----                       39820000
398300             MOVE PC-TSYMSG-00279  TO DP020-MSG-NUMBER            39830000
398400             SET DP020-MSG-INFORMATIONAL TO TRUE                  39840000
398500         END-IF                                                   39850000
398600     END-IF.                                                      39860000
398700                                                                  39870000
398800*----------------------------------------------------------------*39880000
398900*    READ A BLOCK FROM TEMPORARY STORAGE INTO THE ARRAY.         *39890000
399000*----------------------------------------------------------------*39900000
399100 4410-READ-TEMP-STORAGE.                                          39910000
399200                                                                  39920000
399300     EXEC CICS                                                    39930000
399400         READQ TS                                                 39940000
399500             QUEUE (ASC-LIST-QUEUE-NAME)                          39950000
399600             INTO  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               39960000
399700             ITEM  (PV-BLOCK-NUMBER)                              39970000
399800             RESP  (PV-CICS-RESP)                                 39980000
399900     END-EXEC.                                                    39990000
400000                                                                  40000000
400100     IF  ((PV-CICS-RESP = DFHRESP (NORMAL))                       40010000
400200       OR (PV-CICS-RESP = DFHRESP (ITEMERR)))                     40020000
400300         CONTINUE                                                 40030000
400400     ELSE                                                         40040000
400500         SET DP013-CICS-ABEND     TO TRUE                         40050000
400600         SET DP013-NO-ROLLBACK    TO TRUE                         40060000
400700         MOVE '4410-READ-TEMP-STORAGE'                            40070000
400800                                  TO DP013-PARAGRAPH              40080000
400900         MOVE 'ERROR TRYING TO READ FROM TEMP STORAGE QUEUE'      40090000
401000                                  TO DP013-MESSAGE-TEXT(1)        40100000
401100         PERFORM DP013-0000-PROCESS-ABEND                         40110000
401200     END-IF.                                                      40120000
401300                                                                  40130000
401400     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             40140000
401500*                                                                 40150000
401600     IF  PV-CICS-RESP = DFHRESP (ITEMERR)                         40160000
401700         INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               40170000
401800     END-IF.                                                      40180000
401900                                                                  40190000
402000*----------------------------------------------------------------*40200000
402100*    PROCESS THE ITEMS IN THE ARRAY AND MOVE THEM TO THE MAP.    *40210000
402200*----------------------------------------------------------------*40220000
402300 4420-FORMAT-LIST-LINES.                                          40230000
402400                                                                  40240000
402500     IF  ASC-ITEM-AT-BOT-OF-PANEL > ASC-NUMBER-OF-ITEMS-READ      40250000
402600         SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                40260000
402700         MOVE DP015-ASK-DRK-OFF  TO MR-SELECTA (PV-SUB)           40270000
402800         MOVE DP015-HL-OFF       TO MR-SELECTH (PV-SUB)           40280000
402900         MOVE SPACE              TO MR-SELECTI (PV-SUB)           40290000
403000                                    MR-ACTION (PV-SUB)            40300000
403100                                    MR-SML (PV-SUB)               40310000
403200                                    MR-CREATE (PV-SUB)            40320000
403300                                    MR-DEST-NBR (PV-SUB)          40330000
403310                                    MR-STR-SCAN (PV-SUB)          40331010
403400                                    MR-PO-RCVR (PV-SUB)           40340000
403500                                    MR-LOAD-STATUS (PV-SUB)       40350000
403600                                    MR-ACTV-CDE (PV-SUB)          40360000
403700                                    MR-STAT-DATE (PV-SUB)         40370000
403800                                    MR-STAT-TIME (PV-SUB)         40380000
403900                                    MR-USER-ID (PV-SUB)           40390000
404000     ELSE                                                         40400000
404100         IF  ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      40410000
404200                                                   > SPACE        40420000
404300             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 40430000
404400                                 TO MR-SELECTI (PV-SUB)           40440000
404500         ELSE                                                     40450000
404600             MOVE ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      40460000
404700                                 TO MR-SELECTI (PV-SUB)           40470000
404800         END-IF                                                   40480000
404900         IF  DP030-SET-CURSOR-TRAILER                             40490000
405000             IF  ((ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)40500000
405100                 > SPACE)                                         40510000
405200               OR (PV-SUB = 1))                                   40520000
405300                SET DP030-SET-CURSOR-APPL-1 TO TRUE               40530000
405400                MOVE -1               TO MR-SELECTL (PV-SUB)      40540000
405500             END-IF                                               40550000
405600         END-IF                                                   40560000
405700*                                                                 40570000
405800                                                                  40580000
405900         MOVE ASC-ACTION (ASC-BLK-SUB ASC-ITEM-SUB)               40590000
406000                                            TO MR-ACTION (PV-SUB) 40600000
406100         MOVE ASC-SML (ASC-BLK-SUB ASC-ITEM-SUB)                  40610000
406200                                               TO MR-SML (PV-SUB) 40620000
406300         MOVE ASC-CREATE (ASC-BLK-SUB ASC-ITEM-SUB)               40630000
406400                                            TO MR-CREATE (PV-SUB) 40640000
406500         MOVE ASC-DEST-NBR (ASC-BLK-SUB ASC-ITEM-SUB)             40650000
406600                                          TO MR-DEST-NBR (PV-SUB) 40660000
406610         MOVE ASC-STR-SCAN (ASC-BLK-SUB ASC-ITEM-SUB)             40661010
406620                                          TO MR-STR-SCAN (PV-SUB) 40662010
406700         MOVE ASC-PO-RCVR-NBR (ASC-BLK-SUB ASC-ITEM-SUB)          40670000
406800                                          TO MR-PO-RCVR (PV-SUB)  40680000
406900         MOVE ASC-LOAD-STATUS (ASC-BLK-SUB ASC-ITEM-SUB)          40690000
407000                                       TO MR-LOAD-STATUS (PV-SUB) 40700000
407100         MOVE ASC-ACTV-CDE (ASC-BLK-SUB ASC-ITEM-SUB)             40710000
407200                                          TO MR-ACTV-CDE (PV-SUB) 40720000
407300         MOVE ASC-STAT-DATE (ASC-BLK-SUB ASC-ITEM-SUB)            40730000
407400                                         TO MR-STAT-DATE (PV-SUB) 40740000
407500         MOVE ASC-STAT-TIME (ASC-BLK-SUB ASC-ITEM-SUB)            40750000
407600                                         TO MR-STAT-TIME (PV-SUB) 40760000
407700         MOVE ASC-USER-ID (ASC-BLK-SUB ASC-ITEM-SUB)              40770000
407800                                           TO MR-USER-ID (PV-SUB) 40780000
407900         EVALUATE TRUE                                            40790000
408000             WHEN ASC-MISSING-DATA (ASC-BLK-SUB ASC-ITEM-SUB)     40800000
408100                   PERFORM 3250-CHANGE-ATTRIBUTES                 40810000
408200             WHEN ASC-NO-MISSING-DATA (ASC-BLK-SUB ASC-ITEM-SUB)  40820000
408300                   PERFORM 3255-CHANGE-ATTRIBUTES-BACK            40830000
408400             WHEN ASC-INACTIVE-CRTN (ASC-BLK-SUB ASC-ITEM-SUB)    40840000
408500                   PERFORM 3255-CHANGE-ATTRIBUTES-BACK            40850000
408600                   MOVE DP015-YELLOW TO MR-ACTV-CDEC (PV-SUB)     40860000
408700             WHEN ASC-ACTIVE-CRTN (ASC-BLK-SUB ASC-ITEM-SUB)      40870000
408800                   PERFORM 3255-CHANGE-ATTRIBUTES-BACK            40880000
408900         END-EVALUATE                                             40890000
408910         IF   ASC-MULT-SCAN (ASC-BLK-SUB ASC-ITEM-SUB)            40891017
408920              MOVE  DP015-RED             TO MR-STR-SCANC(PV-SUB) 40892017
408930         END-IF                                                   40893017
409000     END-IF.                                                      40900000
409100     SUBTRACT +1 FROM ASC-ITEM-SUB                                40910000
409200     IF  ASC-ITEM-SUB < + 1                                       40920000
409300         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  40930000
409400         MOVE +1                 TO ASC-BLK-SUB                   40940000
409500     END-IF.                                                      40950000
409600                                                                  40960000
409700******************************************************************40970000
409800** IF A BEGINNING OF RANGE WAS SPECIFIED, MAKE SURE AN END OF   **40980000
409900** RANGE WAS SPECIFIED AND VICE-VERSA.  IF ONE IS MISSING,      **40990000
410000** ISSUE A WARNING.                                             **41000000
410100******************************************************************41010000
410200 4430-CHECK-FOR-BEGIN-AND-END.                                    41020000
410300                                                                  41030000
410400     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       41040000
410500         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     41050000
410600*            -- NO END-OF-RANGE SPECFIED ---                      41060000
410700             MOVE PC-TSYMSG-00051  TO DP020-MSG-NUMBER            41070000
410800             SET DP020-MSG-WARNING TO TRUE                        41080000
410900             PERFORM 4431-POSITION-AT-WARNING                     41090000
411000         END-IF                                                   41100000
411100     ELSE                                                         41110000
411200         IF  ASC-END-OF-SELECTED-RANGE > ZERO                     41120000
411300*            -- NO BEGINNING-OF-RANGE SPECFIED ---                41130000
411400             MOVE PC-TSYMSG-00053  TO DP020-MSG-NUMBER            41140000
411500             SET DP020-MSG-WARNING TO TRUE                        41150000
411600             PERFORM 4431-POSITION-AT-WARNING                     41160000
411700         END-IF                                                   41170000
411800     END-IF.                                                      41180000
411900******************************************************************41190000
412000** ONCE IT HAS BEEN DETERMINED THAT A WARNING IS TO BE ISSUED,  **41200000
412100** DETERMINE IF EITHER THE BEGINNING OF RANGE OR END OF RANGE   **41210000
412200** IS ON THE CURRENT SCREEN.  IF IT IS, HIGHLIGHT IT AND        **41220000
412300** POSITION THE CURSOR THERE.                                   **41230000
412400******************************************************************41240000
412500 4431-POSITION-AT-WARNING.                                        41250000
412600                                                                  41260000
412700     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 41270000
412800                    - PV-TOP-ITEM + 1.                            41280000
412900     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      41290000
413000         CONTINUE                                                 41300000
413100     ELSE                                                         41310000
413200         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      41320000
413300         MOVE -1                   TO MR-SELECTL (PV-SUB)         41330000
413400         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         41340000
413500         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         41350000
413600     END-IF.                                                      41360000
413700*                                                                 41370000
413800     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   41380000
413900                    - PV-TOP-ITEM + 1.                            41390000
414000     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      41400000
414100         CONTINUE                                                 41410000
414200     ELSE                                                         41420000
414300         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      41430000
414400         MOVE -1                   TO MR-SELECTL (PV-SUB)         41440000
414500         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         41450000
414600         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         41460000
414700     END-IF.                                                      41470000
414800                                                                  41480000
414900*----------------------------------------------------------------*41490000
415000* PREPARE THE SELECTED ITEMS TEMP STORAGE QUEUE.  MOVE ALL SEL-  *41500000
415100* ECTED ITEMS FROM THE LIST TEMP STORAGE QUEUE TO THE LAYOUT     *41510000
415200* FOR THE SELECTED ITEMS QUEUE.                                  *41520000
415300*                                                                *41530000
415400* FIRST, DELETE THE SELECTION QUEUE, NEXT LOAD THE SELECTION     *41540000
415500* QUEUE RECORD.  FINALLY, WRITE THE SELECTION QUEUE ITEM WHEN    *41550000
415600* THE ARRAY IS FULL.                                             *41560000
415700*----------------------------------------------------------------*41570000
415800 5000-PREPARE-SEL-QUEUE.                                          41580000
415900                                                                  41590000
416000     MOVE +1                   TO  ASC-BLK-SUB.                   41600000
416100     PERFORM 5100-WRITE-TEMP-STORAGE.                             41610000
416200     ADD +1                    TO  ASC-BLK-SUB.                   41620000
416300     PERFORM 5100-WRITE-TEMP-STORAGE.                             41630000
416400                                                                  41640000
416500     MOVE ASC-SEL-QUEUE-NAME-OUT   TO  SU009-SEL-QUEUE-NAME.      41650000
416600     PERFORM 6010-DELETE-SEL-QUEUE.                               41660000
416700                                                                  41670000
416800     SET ASC-UPDATE-TSQ        TO  TRUE.                          41680000
416900                                                                  41690000
417000     SET SU010-IDX             TO  1.                             41700000
417100     MOVE ZERO                 TO SU009-NUMBER-OF-TS-ITEMS.       41710000
417200     INITIALIZE SU010-SELECTED-ITEM-ARRAY.                        41720000
417300                                                                  41730000
417400     PERFORM 5200-FILL-SEL-QUEUE-RECORD                           41740000
417500             VARYING PV-ITEM                                      41750000
417600             FROM 1 BY 1                                          41760000
417700             UNTIL PV-ITEM GREATER ASC-HIGHEST-BLOCK-WRITTEN.     41770000
417800                                                                  41780000
417900     IF  SU010-IDX > 1                                            41790000
418000         PERFORM 5205-WRITE-SEL-QUEUE                             41800000
418100         ADD +1                TO SU009-NUMBER-OF-TS-ITEMS        41810000
418200     END-IF.                                                      41820000
418300*----------------------------------------------------------------*41830000
418400*    WRITE A NEW BLOCK FROM THE ARRAY TO TEMPORARY STORAGE.      *41840000
418500*    REWRITE AN EXISITING BLOCK ONLY IF IT HAS BEEN MODIFIED.    *41850000
418600*----------------------------------------------------------------*41860000
418700 5100-WRITE-TEMP-STORAGE.                                         41870000
418800                                                                  41880000
418900     MOVE ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1)                     41890000
419000                                   TO PV-LIST-ITEM-NUMBER.        41900000
419100     COMPUTE PV-BLOCK-NUMBER =                                    41910000
419200         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    41920000
419300                                                                  41930000
419400     IF (PV-BLOCK-NUMBER < ASC-HIGHEST-BLOCK-WRITTEN)             41940000
419500     OR (PV-BLOCK-NUMBER = ASC-HIGHEST-BLOCK-WRITTEN)             41950000
419600         IF  ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                      41960000
419700             PERFORM 5105-REWRITE-ASC-LISTQ                       41970000
419800         END-IF                                                   41980000
419900     ELSE                                                         41990000
420000         COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                       42000000
420100         ASC-HIGHEST-BLOCK-WRITTEN + 1                            42010000
420200         PERFORM 5110-WRITE-ASC-LISTQ                             42020000
420300         ADD +1                    TO ASC-HIGHEST-BLOCK-WRITTEN   42030000
420400     END-IF.                                                      42040000
420500                                                                  42050000
420600     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             42060000
420700                                                                  42070000
420800******************************************************************42080000
420900** REWRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-    **42090000
421000** SPECIFIC COMMAREA.                                           **42100000
421100******************************************************************42110000
421200 5105-REWRITE-ASC-LISTQ.                                          42120000
421300                                                                  42130000
421400     EXEC CICS                                                    42140000
421500         WRITEQ TS                                                42150000
421600             QUEUE (ASC-LIST-QUEUE-NAME)                          42160000
421700             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               42170000
421800             ITEM  (PV-BLOCK-NUMBER)                              42180000
421900             REWRITE                                              42190000
422000             RESP  (PV-CICS-RESP)                                 42200000
422100     END-EXEC.                                                    42210000
422200                                                                  42220000
422300     IF  PV-CICS-RESP = DFHRESP(NORMAL)                           42230000
422400         CONTINUE                                                 42240000
422500     ELSE                                                         42250000
422600         SET DP013-CICS-ABEND            TO TRUE                  42260000
422700         SET DP013-NO-ROLLBACK           TO TRUE                  42270000
422800         MOVE '5105-REWRITE-ASC-LISTQ'   TO DP013-PARAGRAPH       42280000
422900         MOVE 'ATTEMPTING TO REWRITE LIST TEMP STORAGE QUEUE'     42290000
423000                                         TO DP013-MESSAGE-TEXT(1) 42300000
423100         PERFORM DP013-0000-PROCESS-ABEND                         42310000
423200     END-IF.                                                      42320000
423300                                                                  42330000
423400******************************************************************42340000
423500** WRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-      **42350000
423600** SPECIFIC COMMAREA.                                           **42360000
423700******************************************************************42370000
423800 5110-WRITE-ASC-LISTQ.                                            42380000
423900                                                                  42390000
424000     EXEC CICS                                                    42400000
424100         WRITEQ TS                                                42410000
424200             QUEUE (ASC-LIST-QUEUE-NAME)                          42420000
424300             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               42430000
424400             ITEM  (PV-BLOCK-NUMBER)                              42440000
424500             RESP  (PV-CICS-RESP)                                 42450000
424600     END-EXEC.                                                    42460000
424700     IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      42470000
424800         SET DP013-CICS-ABEND      TO TRUE                        42480000
424900         SET DP013-NO-ROLLBACK     TO TRUE                        42490000
425000         MOVE '5110-WRITE-ASC-LISTQ'                              42500000
425100                                   TO DP013-PARAGRAPH             42510000
425200         MOVE 'ATTEMPTING TO WRITE ASC LIST QUEUE'                42520000
425300                                   TO DP013-MESSAGE-TEXT(1)       42530000
425400         PERFORM DP013-0000-PROCESS-ABEND                         42540000
425500     END-IF.                                                      42550000
425600                                                                  42560000
425700*----------------------------------------------------------------*42570000
425800* READ A LIST QUEUE RECORD AND MOVE THE KEYS OF SELECTED OBJECTS *42580000
425900* TO THE SELECTED ITEMS TEMP STORAGE QUEUE RECORD.               *42590000
426000*----------------------------------------------------------------*42600000
426100 5200-FILL-SEL-QUEUE-RECORD.                                      42610000
426200                                                                  42620000
426300     PERFORM 6112-READ-LIST-QUEUE.                                42630000
426400                                                                  42640000
426500     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       42650000
426600         PERFORM                                                  42660000
426700         VARYING LQW-IDX                                          42670000
426800         FROM 1 BY 1                                              42680000
426900         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            42690000
427000           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          42700000
427100                                                                  42710000
427200             IF  LQW-SELECT (LQW-IDX)                             42720000
427300                 MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)              42730000
427400                                   TO SU010-ITEM (SU010-IDX)      42740000
427500                 MOVE SPACE        TO SU010-ACTION-SW (SU010-IDX) 42750000
427600                                                                  42760000
427700                 MOVE LQW-SML (LQW-IDX)  TO SU010-SML (SU010-IDX) 42770000
427800                 MOVE LQW-CREATE (LQW-IDX) TO                     42780000
427900                                         SU010-CREATE (SU010-IDX) 42790000
428000                 MOVE LQW-DEST-NBR (LQW-IDX)  TO                  42800000
428100                                       SU010-DEST-NBR (SU010-IDX) 42810000
428200                 MOVE LQW-PO-RCVR (LQW-IDX)  TO                   42820000
428300                                        SU010-PO-RCVR (SU010-IDX) 42830000
428400                 MOVE LQW-LOAD-STATUS (LQW-IDX)                   42840000
428500                                 TO SU010-LOAD-STATUS (SU010-IDX) 42850000
428600                 MOVE LQW-STAT-DATE (LQW-IDX) TO                  42860000
428700                                       SU010-STAT-DATE(SU010-IDX) 42870000
428800                 MOVE LQW-STAT-TIME (LQW-IDX) TO                  42880000
428900                                       SU010-STAT-TIME(SU010-IDX) 42890000
429000                 MOVE LQW-USER-ID (LQW-IDX) TO                    42900000
429100                                      SU010-USER-ID (SU010-IDX)   42910000
429200                 SET SU010-IDX UP BY 1                            42920000
429300                 IF  SU010-IDX > SU010-MAX-ITEMS                  42930000
429400                     PERFORM 5205-WRITE-SEL-QUEUE                 42940000
429500                     ADD +1        TO SU009-NUMBER-OF-TS-ITEMS    42950000
429600                     INITIALIZE SU010-SELECTED-ITEM-ARRAY         42960000
429700                     SET SU010-IDX TO  1                          42970000
429800                 END-IF                                           42980000
429900             END-IF                                               42990000
430000         END-PERFORM                                              43000000
430100     END-IF.                                                      43010000
430200                                                                  43020000
430300*----------------------------------------------------------------*43030000
430400*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE.                *43040000
430500*----------------------------------------------------------------*43050000
430600 5205-WRITE-SEL-QUEUE.                                            43060000
430700                                                                  43070000
430800     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            43080000
430900                                   TO SU010-SELECTED-ITEMS.       43090000
431000                                                                  43100000
431100     EXEC CICS                                                    43110000
431200          WRITEQ TS                                               43120000
431300              QUEUE (ASC-SEL-QUEUE-NAME-OUT)                      43130000
431400              FROM  (SU010-SELECT-RECORD)                         43140000
431500              ITEM  (PV-SEL-QUEUE-ITEM)                           43150000
431600              RESP  (PV-CICS-RESP)                                43160000
431700     END-EXEC.                                                    43170000
431800                                                                  43180000
431900     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          43190000
432000         CONTINUE                                                 43200000
432100     ELSE                                                         43210000
432200         SET DP013-CICS-ABEND      TO TRUE                        43220000
432300         SET DP013-NO-ROLLBACK     TO TRUE                        43230000
432400         MOVE '5205-WRITE-SEL-QUEUE'  TO DP013-PARAGRAPH          43240000
432500         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          43250000
432600                                   TO DP013-MESSAGE-TEXT(1)       43260000
432700         PERFORM DP013-0000-PROCESS-ABEND                         43270000
432800     END-IF.                                                      43280000
432900******************************************************************43290000
433000** WHEN RETURNING TO THIS TRANSACTION FROM ANOTHER TRANSACTION, **43300000
433100** SETUP THE ARRAY AS IT WAS WHEN WE HAD LEFT PREVIOUSLY.  EDIT **43310000
433200** THE SELECTIONS MADE AT THAT TIME AND DISPLAY THE PANEL TO    **43320000
433300** THE USER.                                                    **43330000
433400******************************************************************43340000
433500 6000-REFRESH-PANEL-FROM-TEMP.                                    43350000
433600                                                                  43360000
433700     IF  ASC-UPDATE-TSQ                                           43370000
433800         SET ASC-NO-TSQ-UPDATE TO TRUE                            43380000
433900         MOVE ZERO                 TO PV-SAVE-ITEM                43390000
434000                                      PV-SEL-QUEUE-ITEM           43400000
434100         MOVE ASC-NUMBER-OF-SELECTED-ITEMS                        43410000
434200                                   TO PV-HOLD-SELECTED-ITEMS      43420000
434300         MOVE +1                   TO PV-ITEMS-PROCESSED          43430000
434400         PERFORM 6100-UPDATE-TSQ                                  43440000
434500             UNTIL PV-ITEMS-PROCESSED >                           43450000
434600                                     PV-HOLD-SELECTED-ITEMS       43460000
434700         INITIALIZE ASC-BLOCK-ENTRIES (1)                         43470000
434800                    ASC-BLOCK-ENTRIES (2)                         43480000
434900     END-IF.                                                      43490000
435000                                                                  43500000
435100*----------------------------------------------------------------*43510000
435200*    1ELETE THE SELECTED ITEMS TEMP STORAGE QUEUE.               *43520000
435300*----------------------------------------------------------------*43530000
435400 6010-DELETE-SEL-QUEUE.                                           43540000
435500                                                                  43550000
435600     EXEC CICS                                                    43560000
435700         DELETEQ TS                                               43570000
435800             QUEUE (ASC-SEL-QUEUE-NAME-OUT)                       43580000
435900             RESP  (PV-CICS-RESP)                                 43590000
436000     END-EXEC.                                                    43600000
436100*                                                                 43610000
436200     IF ((PV-CICS-RESP = DFHRESP(NORMAL)) OR                      43620000
436300        (PV-CICS-RESP = DFHRESP(QIDERR)))                         43630000
436400         CONTINUE                                                 43640000
436500     ELSE                                                         43650000
436600         SET DP013-CICS-ABEND TO TRUE                             43660000
436700         SET DP013-NO-ROLLBACK TO TRUE                            43670000
436800         MOVE '6010-DELETE-SEL-QUEUE'                             43680000
436900                        TO DP013-PARAGRAPH                        43690000
437000         MOVE 'ERROR TRYING TO DELETE SELECTION TS QUEUE'         43700000
437100                        TO DP013-MESSAGE-TEXT (1)                 43710000
437200         PERFORM DP013-0000-PROCESS-ABEND                         43720000
437300     END-IF.                                                      43730000
437400                                                                  43740000
437500*----------------------------------------------------------------*43750000
437600*    INCREMENT THE TSQ ITEM NUMBER AND READ THE LIST QUEUE.      *43760000
437700*    LOOP THROUGH THE LIST QUEUE TO OBTAIN THE LINE ITEM NUMBER  *43770000
437800*    TO BE USED TO UPDATE (DESELECT) THE CORRECT LINE ITEM IN    *43780000
437900*    THE TEMP QUEUE.                                             *43790000
438000*    USE THE SELECT QUE THAT WAS SENT OFF TO THE NEXT PROGRAM.   *43800000
438100*----------------------------------------------------------------*43810000
438200 6100-UPDATE-TSQ.                                                 43820000
438300                                                                  43830000
438400     ADD 1                     TO  PV-SEL-QUEUE-ITEM.             43840000
438500     PERFORM 6150-READ-SEL-QUEUE.                                 43850000
438600     PERFORM                                                      43860000
438700         VARYING SU010-IDX                                        43870000
438800         FROM 1 BY 1                                              43880000
438900         UNTIL ((PV-ITEMS-PROCESSED > PV-HOLD-SELECTED-ITEMS)     43890000
439000         OR (SU010-IDX GREATER THAN SU010-MAX-ITEMS))             43900000
439100         IF  SU010-ACTION-SW (SU010-IDX) > SPACE                  43910000
439200             PERFORM 6110-PROCESS-ITEMS                           43920000
439300         END-IF                                                   43930000
439400         ADD +1                TO PV-ITEMS-PROCESSED              43940000
439500     END-PERFORM.                                                 43950000
439600     PERFORM 6111-WRITE-LIST-QUEUE.                               43960000
439700                                                                  43970000
439800*----------------------------------------------------------------*43980000
439900*    READ THE LIST QUEUE RECORD.                                 *43990000
440000*----------------------------------------------------------------*44000000
440100 6150-READ-SEL-QUEUE.                                             44010000
440200*    USE THE OUTPUT QUE THAT WAS PROCESSED BY THE TARGET PROGRAM  44020000
440300                                                                  44030000
440400                                                                  44040000
440500     EXEC CICS                                                    44050000
440600          READQ TS                                                44060000
440700              QUEUE (ASC-SEL-QUEUE-NAME-OUT)                      44070000
440800              INTO  (SU010-SELECT-RECORD)                         44080000
440900              ITEM  (PV-SEL-QUEUE-ITEM)                           44090000
441000              RESP  (PV-CICS-RESP)                                44100000
441100     END-EXEC.                                                    44110000
441200*                                                                 44120000
441300     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          44130000
441400         CONTINUE                                                 44140000
441500     ELSE                                                         44150000
441600         SET DP013-CICS-ABEND      TO  TRUE                       44160000
441700         SET DP013-NO-ROLLBACK     TO  TRUE                       44170000
441800         MOVE '6150-READ-SEL-QUEUE' TO  DP013-PARAGRAPH           44180000
441900         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           44190000
442000                                   TO  DP013-MESSAGE-TEXT(1)      44200000
442100         PERFORM DP013-0000-PROCESS-ABEND                         44210000
442200     END-IF.                                                      44220000
442300                                                                  44230000
442400*----------------------------------------------------------------*44240000
442500*    CALCULATE THE TEMP QUEUE ITEM THAT MUST BE READ AND READ IT.*44250000
442600*    REWRITE THE CURRENT TEMP QUEUE ITEM IF NECESSARY.  CALCULATE*44260000
442700*    THE LINE ITEM OCCURENCE AND UPDATE (DESELECT) IT.           *44270000
442800*----------------------------------------------------------------*44280000
442900 6110-PROCESS-ITEMS.                                              44290000
443000                                                                  44300000
443100     COMPUTE PV-ITEM = 1 + ((SU010-ITEM (SU010-IDX) - 1)          44310000
443200                     / PC-ITEMS-PER-PANEL).                       44320000
443300                                                                  44330000
443400     IF  PV-ITEM NOT EQUAL PV-SAVE-ITEM                           44340000
443500         IF  PV-SAVE-ITEM NOT EQUAL ZERO                          44350000
443600             PERFORM 6111-WRITE-LIST-QUEUE                        44360000
443700         END-IF                                                   44370000
443800         MOVE PV-ITEM          TO PV-SAVE-ITEM                    44380000
443900                                                                  44390000
444000         PERFORM 6112-READ-LIST-QUEUE                             44400000
444100         IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)               44410000
444200             CONTINUE                                             44420000
444300         END-IF                                                   44430000
444400     END-IF.                                                      44440000
444500                                                                  44450000
444600     COMPUTE PV-SUB = (SU010-ITEM (SU010-IDX)                     44460000
444700                    - LQW-LIST-ITEM-NUMBER (1)) + 1.              44470000
444800     SET LQW-DESELECT (PV-SUB) TO    TRUE                         44480000
444900     MOVE LQW-SELECTED-SW (PV-SUB)                                44490000
445000                               TO LQW-TEMP-SELECTED-SW (PV-SUB).  44500000
445100                                                                  44510000
445200     EVALUATE TRUE                                                44520000
445300         WHEN SU010-INQ (SU010-IDX)                               44530000
445400              MOVE PC-INQ      TO LQW-ACTION (PV-SUB)             44540000
445500                                                                  44550000
445600         WHEN SU010-UPD (SU010-IDX)                               44560000
445700              MOVE PC-UPD      TO LQW-ACTION (PV-SUB)             44570000
445800                                                                  44580000
445900         WHEN SU010-DEL (SU010-IDX)                               44590000
446000              MOVE PC-DEL      TO LQW-ACTION (PV-SUB)             44600000
446100                                                                  44610000
446200         WHEN SU010-ERR (SU010-IDX)                               44620000
446300              MOVE PC-ERR      TO LQW-ACTION (PV-SUB)             44630000
446400     END-EVALUATE.                                                44640000
446500                                                                  44650000
446600     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                44660000
446700                                                                  44670000
446800*----------------------------------------------------------------*44680000
446900*    WRITE THE TS QUEUE RECORD JUST UPDATED IN C600.             *44690000
447000*----------------------------------------------------------------*44700000
447100 6111-WRITE-LIST-QUEUE.                                           44710000
447200                                                                  44720000
447300     EXEC CICS                                                    44730000
447400         WRITEQ TS                                                44740000
447500             QUEUE (ASC-LIST-QUEUE-NAME)                          44750000
447600             FROM  (LQW-LIST-QUEUE-WORK-AREA)                     44760000
447700             ITEM  (PV-SAVE-ITEM)                                 44770000
447800             REWRITE                                              44780000
447900             RESP  (PV-CICS-RESP)                                 44790000
448000     END-EXEC.                                                    44800000
448100*                                                                 44810000
448200     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          44820000
448300         CONTINUE                                                 44830000
448400     ELSE                                                         44840000
448500         SET DP013-CICS-ABEND  TO  TRUE                           44850000
448600         SET DP013-NO-ROLLBACK TO  TRUE                           44860000
448700         MOVE '6111-WRITE-LIST-QUEUE'                             44870000
448800                               TO  DP013-PARAGRAPH                44880000
448900         MOVE 'ATTEMPTING TO REWRITE LIST QUEUE'                  44890000
449000                               TO  DP013-MESSAGE-TEXT(1)          44900000
449100         PERFORM DP013-0000-PROCESS-ABEND                         44910000
449200     END-IF.                                                      44920000
449300                                                                  44930000
449400*----------------------------------------------------------------*44940000
449500*    READ THE TEMPORARY STORAGE QUEUE INTO A TEMPORARY WORK AREA.*44950000
449600*----------------------------------------------------------------*44960000
449700 6112-READ-LIST-QUEUE.                                            44970000
449800                                                                  44980000
449900     EXEC CICS                                                    44990000
450000         READQ TS                                                 45000000
450100             QUEUE (ASC-LIST-QUEUE-NAME)                          45010000
450200             INTO  (LQW-LIST-QUEUE-WORK-AREA)                     45020000
450300             ITEM  (PV-ITEM)                                      45030000
450400             RESP  (PV-CICS-RESP)                                 45040000
450500     END-EXEC.                                                    45050000
450600*                                                                 45060000
450700     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          45070000
450800         CONTINUE                                                 45080000
450900     ELSE                                                         45090000
451000         SET DP013-CICS-ABEND        TO TRUE                      45100000
451100         SET DP013-NO-ROLLBACK       TO TRUE                      45110000
451200         MOVE '6112-READ-LIST-QUEUE' TO DP013-PARAGRAPH           45120000
451300         MOVE 'ATTEMPTING TO READQ LIST QUEUE'                    45130000
451400                                     TO DP013-MESSAGE-TEXT(1)     45140000
451500         PERFORM DP013-0000-PROCESS-ABEND                         45150000
451600     END-IF.                                                      45160000
451700                                                                  45170000
451800 7000-GET-KOHLS-SML.                                              45180000
451900                                                                  45190000
452000     MOVE '7000-GET-KOHLS-SML'  TO PV-CICS-MSG                    45200000
452200                                                                  45220000
452300     MOVE PV-SHIPT-UNT-ID             TO SUT00024-ORIG-CART-ID    45230000
452400                                                                  45240000
452500     EXEC SQL                                                     45250000
452600     SELECT                                                       45260000
452700         A.SHIPT_UNT_ID                                           45270000
452800     INTO                                                         45280000
452900         :SUT00024-SHIPT-UNT-ID                                   45290000
453000     FROM                                                         45300000
453100         SUT_OTBND_CART A                                         45310000
453200     WHERE                                                        45320000
453300             A.ORIG_CART_ID = :SUT00024-ORIG-CART-ID              45330000
453400         AND A.ACTV_IND     = 'Y'                                 45340000
454000     END-EXEC.                                                    45400000
454100                                                                  45410000
454200     EVALUATE TRUE                                                45420000
454300         WHEN SQLCODE = ZERO                                      45430000
454310              CONTINUE                                            45431001
454400         WHEN SQLCODE = +100                                      45440000
454500              MOVE +0 TO SUT00024-SHIPT-UNT-ID                    45450001
454600         WHEN SQLWARN0 NOT = SPACE                                45460000
454700         WHEN SQLCODE NOT = ZERO                                  45470000
454800              MOVE '7000-GET-KOHLS-SML' TO DP013-PARAGRAPH        45480000
454900              MOVE 'SELECT SUT_OTBND_CART'                        45490000
455000                                   TO DP013-MESSAGE-TEXT (1)      45500000
455100              MOVE DK-SHIPT-UNT-ID TO DP013-MESSAGE-TEXT (2)      45510000
455200              MOVE SQLCA       TO DP013-SQLCA                     45520000
455300              MOVE 'SUT_OTBND_CART'                               45530000
455400                                   TO DP013-DB2-TABLE-NAME (1)    45540000
455500              SET DP013-DB2-ABEND TO TRUE                         45550000
455600              PERFORM DP013-0000-PROCESS-ABEND                    45560000
455700     END-EVALUATE.                                                45570000
455800                                                                  45580020
455900 7400-INSERT-WRKR-AUD.                                            45590000
456000     EXEC SQL                                                     45600000
456100         INSERT INTO SUT_TRIP_WRKR_AUD                            45610000
456200             (                                                    45620000
456300               OTBND_TRIP_ID                                      45630000
456400             , USR_ID                                             45640000
456500             , CRE_TMST                                           45650000
456600             , CRE_BY_PGM_NM                                      45660000
456700                 )                                                45670000
456800                                                                  45680000
456900             VALUES                                               45690000
457000                                                                  45700000
457100                 (                                                45710000
457200                 :DK-TRIP-ID                                      45720000
457300             ,   :DP020-USERID                                    45730000
457400             ,   CURRENT TIMESTAMP                                45740000
457500             ,   :SUT00006-CRE-BY-PGM-NM                          45750000
457600                 )                                                45760000
457700     END-EXEC.                                                    45770000
457800                                                                  45780000
457900     EVALUATE TRUE                                                45790000
458000         WHEN SQLCODE = ZERO                                      45800000
458100         WHEN SQLCODE = +100                                      45810000
458200              CONTINUE                                            45820000
458300         WHEN SQLWARN0 NOT = SPACE                                45830000
458400         WHEN SQLCODE NOT = ZERO                                  45840000
458500              MOVE '7400-INSERT-WRKR-AUD' TO DP013-PARAGRAPH      45850000
458600              MOVE 'INSERT SUT_TRIP_WRKR_AUD'                     45860000
458700                                   TO DP013-MESSAGE-TEXT (1)      45870000
458800              MOVE DK-SHIPT-UNT-ID TO DP013-MESSAGE-TEXT (2)      45880000
458900              MOVE SQLCA       TO DP013-SQLCA                     45890000
459000              MOVE 'SUT_TRIP_WRKR_AUD'                            45900000
459100                                   TO DP013-DB2-TABLE-NAME (1)    45910000
459200              SET DP013-DB2-ABEND TO TRUE                         45920000
459300              PERFORM DP013-0000-PROCESS-ABEND                    45930000
459400     END-EVALUATE.                                                45940000
459500                                                                  45950020
459600 8000-WRITE-CSSL.                                                 45960000
459700                                                                  45970000
459800     MOVE EIBTASKN TO PV-CICS-TASK                                45980000
459900     MOVE LENGTH OF PV-CICS-MSG-AREA                              45990000
460000               TO PV-COMMAREA-LENGTH                              46000000
460100                                                                  46010000
460200     EXEC CICS                                                    46020000
460300         WRITEQ TD                                                46030000
460400             QUEUE  ('CSSL')                                      46040000
460500             FROM  (PV-CICS-MSG-AREA)                             46050000
460600             LENGTH  (PV-COMMAREA-LENGTH)                         46060000
460700             RESP  (PV-CICS-RESP)                                 46070000
460800     END-EXEC.                                                    46080000
460900                                                                  46090020
461000*-----------------------------------------------------------------46100000
461100*  READ THE LIST QUEUE RECORD                                     46110000
461200*-----------------------------------------------------------------46120000
461300 9100-READ-SEL-QUEUE.                                             46130000
461400                                                                  46140000
461500     EXEC CICS                                                    46150000
461600         READQ TS                                                 46160000
461700             QUEUE (ASC-SEL-QUEUE-NAME-IN)                        46170000
461800             INTO  (SU010-SELECT-RECORD)                          46180000
461900             ITEM  (ASC-SEL-ITEM)                                 46190000
462000             RESP  (PV-CICS-RESP)                                 46200000
462100     END-EXEC.                                                    46210000
462200     IF PV-CICS-RESP EQUAL DFHRESP(NORMAL)                        46220000
462300         CONTINUE                                                 46230000
462400     ELSE                                                         46240000
462500         SET DP013-LOGIC-ABEND                                    46250000
462600             DP013-NO-ROLLBACK   TO   TRUE                        46260000
462700         MOVE '9100-READ-SEL-QUEUE' TO   DP013-PARAGRAPH          46270000
462800         MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   46280000
462900                                 TO   DP013-MESSAGE-TEXT (1)      46290000
463000         PERFORM DP013-0000-PROCESS-ABEND                         46300000
463100     END-IF.                                                      46310000
463200                                                                  46320000
463300*-----------------------------------------------------------------46330000
463400* UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE.       *46340000
463500*-----------------------------------------------------------------46350000
463600 9200-REWRITE-SEL-QUEUE.                                          46360000
463700                                                                  46370000
463800     EXEC CICS                                                    46380000
463900          WRITEQ TS                                               46390000
464000              QUEUE  (ASC-SEL-QUEUE-NAME-IN)                      46400000
464100              FROM   (SU010-SELECT-RECORD)                        46410000
464200              ITEM   (ASC-SEL-ITEM)                               46420000
464300              RESP   (PV-CICS-RESP)                               46430000
464400              REWRITE                                             46440000
464500     END-EXEC.                                                    46450000
464600                                                                  46460000
464700     IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                   46470000
464800         SET DP013-CICS-ABEND                                     46480000
464900             DP013-NO-ROLLBACK     TO TRUE                        46490000
465000         MOVE '9200-REWRITE-SEL-QUEUE'                            46500000
465100                                   TO DP013-PARAGRAPH             46510000
465200         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   46520000
465300                                   TO DP013-MESSAGE-TEXT (1)      46530000
465400         PERFORM DP013-0000-PROCESS-ABEND                         46540000
465500     END-IF.                                                      46550000
465600                                                                  46560000
465700*----------------------------------------------------------------*46570000
465800*    THE DB2 RESOURCE IS NOT AVAILABLE, DISPLAY A MESSAGE ON     *46580000
465900*    THE TERMINAL INDICATING THAT THE RESOURCE IS UNAVAILABLE.   *46590000
466000*----------------------------------------------------------------*46600000
466100 9900-SOFT-ABORT.                                                 46610000
466200                                                                  46620000
466300     EXEC CICS SYNCPOINT                                          46630000
466400          ROLLBACK                                                46640000
466500     END-EXEC.                                                    46650000
466600                                                                  46660000
466700     SET  PS-ERROR                                                46670000
466800          PS-SOFT-ABORT-ERROR                                     46680000
466900          DP020-MSG-FATAL       TO  TRUE.                         46690000
467000                                                                  46700000
467100                                                                  46710000
467200 9904-WRITE-CRTN-MODULE-MSG.                                      46720000
467300                                                                  46730000
467400     MOVE '4350'                      TO  PV-CTN-PARA             46740000
467500     MOVE PC046-CRA-RET-CDE           TO  PV-CTN-RET-CDE          46750000
467600     MOVE PC046-CRTN-STATUS           TO  PV-CTN-STATUS           46760000
467700     MOVE PC046-CRTN-STAT-DESC        TO  PV-CTN-STAT-DESC        46770000
467800     MOVE PC046-TRLR-SRL              TO  PV-CTN-TRLR-SERIAL      46780000
467900     MOVE PC046-OTBD-TRIP-ID          TO  PV-CTN-TRIP             46790000
468000     MOVE PC046-TRIP-STATUS           TO  PV-CTN-TRIP-STAT        46800000
468100     MOVE PC046-STATUS-USERID         TO  PV-CTN-STAT-USERID      46810000
468200                                                                  46820000
468300     EXEC CICS                                                    46830000
468400         WRITEQ TD                                                46840000
468500             QUEUE  ('CSSL')                                      46850000
468600             FROM   (PV-CARTON-MSG)                               46860000
468700             RESP   (PV-CICS-RESPONSE)                            46870000
468800     END-EXEC.                                                    46880000
468900                                                                  46890000
469000     EXEC CICS                                                    46900000
469100         WRITEQ TD                                                46910000
469200             QUEUE  ('CSSL')                                      46920000
469300             FROM   (PC046-CRA-RET-MSG)                           46930000
469400             RESP   (PV-CICS-RESPONSE)                            46940000
469500     END-EXEC.                                                    46950000
469600                                                                  46960000
469700*----------------------------------------------------------------*46970000
469800*    ABEND PROCESSOR MODULE                                      *46980000
469900*----------------------------------------------------------------*46990000
470000     COPY DPPD013.                                                47000000
470100                                                                  47010000
470200***************************************************************** 47020000
470300* PCPD049 - PROCEDURE DIVISION USED TO DETERMINE TRAILER CONTENTS 47030000
470400     COPY PCPD049.                                                47040000
