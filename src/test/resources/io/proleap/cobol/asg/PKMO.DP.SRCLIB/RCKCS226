000100******************************************************************00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300******************************************************************00030000
000400 PROGRAM-ID.      RCKCS226.                                       00040000
000500 AUTHOR.          ANNE YEKO.                                      00050000
000600 INSTALLATION.    KOHLS DEPARTMENT STORES.                        00060000
000700 DATE-WRITTEN.    04/06/93.                                       00070000
000800 DATE-COMPILED.                                                   00080000
000900                                                                  00090000
001000******************************************************************00100000
001100*  RCKCS226 - TRANID = E226                                      *00110000
001200*                                                                *00120000
001300*  THIS PROGRAM WILL PRINT THE RECEIVING TRAILER MANIFEST REPORT.*00130000
001400*  THE PRINT LINES WILL BE ROUTED TO THE PRINTER THRU DRS.       *00140000
001500******************************************************************00150000
001600*  PROGRAM CHANGE MADE TO ELIMINATE BLANK LINES THAT PRINT AT THE*00160000
001700*  END OF TRAILER MANIFEST AND REPLACE THEM WITH A NEW PAGE THAT *00170000
001800*  CONTAINS ONLY BLANK LINES.  WR-4610 DENISE HAHN 6/2/98        *00180000
      *                                                                 00190000
      *  03/02/2010  TOM PRIMEAU WR38216                               *00200000
      *        CHANGE THE PROCESSING WITHIN THE PROGRAM TO RECOGNIZE   *00210000
      *        WHETHER THE 'DC' IS AN 'EFC' OR NOT.                    *00220000
      *        XL071-E-BUS-IND WILL BE USED IN PLACE OF 870 HC.        *00230000
      *        REMOVED DK-OPER-UNT-ID-870.CHECK XL071-E-BUS-IND INSTEAD*00240000
      *        REMOVE PS-EC-870-FOUND-SW AND 88 LVL PS-EC-870-FOUND    *00250000
      *        ADDED 'PS-EC-EFC-FOUND-SW' AND 'PS-EC-EFC-FOUND'        *00260000
001900******************************************************************00270000
002000                                                                  00280000
002100 ENVIRONMENT DIVISION.                                            00290000
002200                                                                  00300000
002300 DATA DIVISION.                                                   00310000
002400     EJECT                                                        00320000
002500                                                                  00330000
002600 WORKING-STORAGE SECTION.                                         00340000
002700 01  FILLER                           PIC X(36)  VALUE            00350000
002800     'RCKCS226 WORKING STORAGE STARTS HERE'.                      00360000
002900                                                                  00370000
003000 01 TL-TRIP-LINE.                                                 00380000
003100     05  FILLER                          PIC X(15)  VALUE         00390000
003200         '^M0101000^T0870'.                                       00400000
003300     05  TL-TRANSLATED-TEXT.                                      00410000
003400         10  TL-TRIP-LINE-FILLER         PIC X(07)   VALUE        00420000
003500             'TRIP ID'.                                           00430000
003600                                                                  00440000
003700 01 TL-TRIP-LINE-NO-BARCODE.                                      00450000
003800     05  FILLER                          PIC X(85)  VALUE SPACES. 00460000
003900     05  TL-TRANSLATED-TEXT-NB          PIC X(13)  VALUE SPACES.  00470000
004000                                                                  00480000
004100                                                                  00490000
004200 01 TL-BARCODE-LINE.                                              00500000
004300     05  FILLER                          PIC X(19)   VALUE        00510000
004400         '^M0505020^T0840^BNZ'.                                   00520000
004500     05  TL-BARCODE-96-1                 PIC 9(02)   VALUE 96.    00530000
004600     05  TL-BARCODE-TRIP-ID-1            PIC 9(9)    VALUE ZERO.  00540000
004700     05  FILLER                          PIC X(4)    VALUE '^G^-'.00550000
004800                                                                  00560000
004900 01 TL2-TOTAL-LINE-2.                                             00570000
005000     05  FILLER                          PIC X(15)  VALUE         00580000
005100         '^M0101000^T0870'.                                       00590000
005200     05  TL2-TRANSLATED-TEXT.                                     00600000
005300         10  FILLER                      PIC X(01)   VALUE '('.   00610000
005400         10  TL-BARCODE-96               PIC X(02)   VALUE '96'.  00620000
005500         10  FILLER                      PIC X(01)   VALUE ')'.   00630000
005600         10  TL-BARCODE-TRIP-ID          PIC X(9)    VALUE SPACES.00640000
005700     05  FILLER                          PIC X(4)    VALUE '^G^-'.00650000
005800*                                                                 00660000
005900*  STANDARD ATTENTION IDENTIFIER LIST                             00670000
006000*                                                                 00680000
006100     COPY DFHAID.                                                 00690000
006200     EJECT                                                        00700000
006300                                                                  00710000
006400*                                                                 00720000
006500* COPIES FOR THE PROGRAM DRS1INTC WORK FIELDS.                    00730000
006600*                                                                 00740000
006700     COPY DRRD001O.                                               00750000
006800     COPY DRRD002O.                                               00760000
006900                                                                  00770000
007000*                                                                 00780000
007100*  RECORD LAYOUT FOR THE REPORT HEADER                            00790000
007200*                                                                 00800000
007300     COPY DPWS108O.                                               00810000
007400*                                                                 00820000
007500*  RECORD LAYOUT FOR PRINTER CONTROL CODES                        00830000
007600*                                                                 00840000
007700     COPY DSWS004.                                                00850000
007800*                                                                 00860000
007900*  RECORD LAYOUT FOR THE PRINT CONTROL ROUTINE COMMAREA           00870000
008000*                                                                 00880000
008100     COPY DPWS072.                                                00890000
008200*                                                                 00900000
008300 01  IE-DRS-ERROR-MSG.                                            00910000
008400     05  FILLER                       PIC X(41)  VALUE            00920000
008500     'A DRS ERROR HAS OCCURRED  - CONTACT DP - '.                 00930000
008600     05  FILLER                       PIC X(16)  VALUE            00940000
008700     'PROGRAM RCKCS226'.                                          00950000
008800     05  FILLER                       PIC X(12)  VALUE            00960000
008900     ' FUNCTION = '.                                              00970000
009000     05  IE-DRS-FUNC                  PIC X(04)  VALUE SPACE.     00980000
009100     05  FILLER                       PIC X(15)  VALUE            00990000
009200     ' RETURN CODE = '.                                           01000000
009300     05  IE-DRS-RC                    PIC 9(09)  BLANK ZERO.      01010000
009400     05  FILLER                       PIC X(10)  VALUE            01020000
009500     ' USERID = '.                                                01030000
009600     05  IE-DRS-USERID                PIC X(08)  VALUE SPACE.     01040000
009700                                                                  01050000
009750                                                                  01060000
009800*                                                                 01070000
009900*  LAYOUT FOR THE ABEND MODULE COMMUNICATIONS AREA.               01080000
010000*                                                                 01090000
010020*---------------------------------------------------------------**01100000
010030*  COPYBOOK FOR LOGISTICS DOMAIN ITEM ACCESS MODULE               01110000
010040*---------------------------------------------------------------**01120000
010050     COPY XLWS001.                                                01130000
010091*                                                                 01140000
010092*----------------------------------------------------------------*01150000
010093*    COPYBOOK FOR LOCATION CALL MODULE                            01160000
010094*-----------------------------------------------------------------01170000
010095     COPY XLWS071.                                                01180000
010096*                                                                 01190000
010100     COPY DPWS013.                                                01200000
010200                                                                  01210000
010300*01  H1-HEADING-LINE1.                                            01220000
010400*    05  FILLER                       PIC X(38)  VALUE SPACES.    01230000
010500*    05  FILLER                       PIC X(26)  VALUE            01240000
010600*        'RECEIVING TRAILER MANIFEST'.                            01250000
010700*    05  FILLER                       PIC X(46)  VALUE SPACES.    01260000
010710*01  H1-EC-HEADING-LINE1.                                         01270000
010720*    05  FILLER                       PIC X(28)  VALUE SPACES.    01280000
010730*    05  FILLER                       PIC X(46)  VALUE            01290000
010740*        'E-COMMERCE RECEIVING CHECK-IN TRAILER MANIFEST'.        01300000
010750*    05  FILLER                       PIC X(36)  VALUE SPACES.    01310000
010751 01  H1-HEADING-LINE1.                                            01320000
010760     05  FILLER                       PIC X(24)  VALUE SPACES.    01330000
010770     05  FILLER                       PIC X(34)  VALUE            01340000
010780         'RECEIVING TRAILER MANIFEST FOR DC '.                    01350000
010790     05  H1-DC-NBR                    PIC 9(04).                  01360000
010791     05  H1-DC-NBR-A REDEFINES H1-DC-NBR                          01370000
010792                                      PIC X(04).                  01380000
010793     05  FILLER                       PIC X(02)  VALUE ', '.      01390000
010794     05  H1-DC-NAME                   PIC X(25).                  01400000
010795     05  FILLER                       PIC X(12)  VALUE SPACES.    01410000
010796 01  H1-EC-HEADING-LINE1.                                         01420000
010797     05  FILLER                       PIC X(14)  VALUE SPACES.    01430000
010798     05  FILLER                       PIC X(54)  VALUE            01440000
010799         'E-COMMERCE RECEIVING CHECK-IN TRAILER MANIFEST FOR DC '.01450000
010800     05  H1-EC-DC-NBR                 PIC 9(04).                  01460000
010801     05  H1-EC-DC-NBR-A REDEFINES H1-EC-DC-NBR                    01470000
010802                                      PIC X(04).                  01480000
010803     05  FILLER                       PIC X(02)  VALUE ', '.      01490000
010804     05  H1-EC-DC-NAME                PIC X(25).                  01500000
010805     05  FILLER                       PIC X(12)  VALUE SPACES.    01510000
010810                                                                  01520000
010900 01  H2-HEADING-LINE2.                                            01530000
011000     05  FILLER                       PIC X(02)  VALUE SPACES.    01540000
011100     05  FILLER                       PIC X(09)  VALUE            01550000
011200         'CARRIER: '.                                             01560000
011300     05  H2-CARRIER                   PIC X(04)  VALUE SPACES.    01570000
011400     05  FILLER                       PIC X(12)  VALUE            01580000
011500         '   TRAILER: '.                                          01590000
011600     05  H2-TRAILER                   PIC X(10)  VALUE SPACES.    01600000
011700     05  FILLER                       PIC X(73)  VALUE SPACES.    01610000
011800                                                                  01620000
011900 01  H3-HEADING-LINE3.                                            01630000
012000     05  FILLER                       PIC X(02)  VALUE SPACES.    01640000
012100     05  FILLER                       PIC X(18)  VALUE            01650000
012200         'PO/RECEIVER   DEPT'.                                    01660000
012300     05  FILLER                       PIC X(31)  VALUE SPACES.    01670000
012400     05  FILLER                       PIC X(16)  VALUE            01680000
012500         'TROUBLE     SCAN'.                                      01690000
012600     05  FILLER                       PIC X(02)  VALUE SPACES.    01700000
012700     05  FILLER                       PIC X(04)  VALUE 'MULT'.    01710000
012800     05  FILLER                       PIC X(02)  VALUE SPACES.    01720000
012900     05  FILLER                       PIC X(04)  VALUE 'CART'.    01730000
013000     05  FILLER                       PIC X(04)  VALUE SPACES.    01740000
013100     05  FILLER                       PIC X(03)  VALUE 'ADJ'.     01750000
013200     05  FILLER                       PIC X(06)  VALUE SPACES.    01760000
013300     05  FILLER                       PIC X(03)  VALUE 'DMG'.     01770000
013400     05  FILLER                       PIC X(05)  VALUE SPACES.    01780000
013500     05  FILLER                       PIC X(05)  VALUE 'RECVR'.   01790000
013600                                                                  01800000
013700 01  H4-HEADING-LINE4.                                            01810000
013800     05  FILLER                       PIC X(02)  VALUE SPACES.    01820000
013900     05  FILLER                       PIC X(18)  VALUE            01830000
014000         '  NUMBER          '.                                    01840000
014100     05  FILLER                       PIC X(03)  VALUE SPACES.    01850000
014200     05  FILLER                       PIC X(03)  VALUE 'PKG'.     01860000
014300     05  FILLER                       PIC X(02)  VALUE SPACES.    01870000
014400     05  FILLER                       PIC X(03)  VALUE 'SET'.     01880000
014500     05  FILLER                       PIC X(03)  VALUE SPACES.    01890000
014600     05  FILLER                       PIC X(11)  VALUE            01900000
014700         'VENDOR NAME'.                                           01910000
014800     05  FILLER                       PIC X(06)  VALUE SPACES.    01920000
014900     05  FILLER                       PIC X(16)  VALUE            01930000
015000         'STATUS     COUNT'.                                      01940000
015100     05  FILLER                       PIC X(02)  VALUE SPACES.    01950000
015200     05  FILLER                       PIC X(04)  VALUE 'SHIP'.    01960000
015300     05  FILLER                       PIC X(02)  VALUE SPACES.    01970000
015400     05  FILLER                       PIC X(05)  VALUE 'COUNT'.   01980000
015500     05  FILLER                       PIC X(02)  VALUE SPACES.    01990000
015600     05  FILLER                       PIC X(05)  VALUE 'COUNT'.   02000000
015700     05  FILLER                       PIC X(04)  VALUE SPACES.    02010000
015800     05  FILLER                       PIC X(05)  VALUE 'COUNT'.   02020000
015900     05  FILLER                       PIC X(04)  VALUE SPACES.    02030000
016000     05  FILLER                       PIC X(05)  VALUE 'INITS'.   02040000
016100                                                                  02050000
016200                                                                  02060000
016300                                                                  02070000
016400 01  H5-HEADING-LINE5.                                            02080000
016500     05  FILLER                       PIC X(02)  VALUE SPACES.    02090000
016600     05  FILLER                       PIC X(07)  VALUE            02100000
016700         'RCV SEQ'.                                               02110000
016800     05  FILLER                       PIC X(03)  VALUE SPACES.    02120000
016900     05  FILLER                       PIC X(02)  VALUE 'PO'.      02130000
017000     05  FILLER                       PIC X(23)  VALUE SPACES.    02140000
017100     05  FILLER                       PIC X(04)  VALUE 'PROC'.    02150000
017200     05  FILLER                       PIC X(46)  VALUE SPACES.    02160000
017300     05  FILLER                       PIC X(04)  VALUE 'CART'.    02170000
017400     05  FILLER                       PIC X(05)  VALUE SPACES.    02180000
017500     05  FILLER                       PIC X(03)  VALUE 'ADJ'.     02190000
017600     05  FILLER                       PIC X(06)  VALUE SPACES.    02200000
017700     05  FILLER                       PIC X(03)  VALUE 'DMG'.     02210000
017800     05  FILLER                       PIC X(02)  VALUE SPACES.    02220000
017900                                                                  02230000
018000 01  H6-HEADING-LINE6.                                            02240000
018100     05  FILLER                       PIC X(03)  VALUE SPACES.    02250000
018200     05  FILLER                       PIC X(06)  VALUE 'NUMBER'.  02260000
018300     05  FILLER                       PIC X(01)  VALUE SPACES.    02270000
018400     05  FILLER                       PIC X(06)  VALUE 'NUMBER'.  02280000
018500     05  FILLER                       PIC X(02)  VALUE SPACES.    02290000
018600     05  FILLER                       PIC X(04)  VALUE 'SCAC'.    02300000
018700     05  FILLER                       PIC X(01)  VALUE SPACES.    02310000
018800     05  FILLER                       PIC X(07)  VALUE            02320000
018900         'TRAILER'.                                               02330000
019000     05  FILLER                       PIC X(04)  VALUE SPACES.    02340000
019100     05  FILLER                       PIC X(02)  VALUE 'ST'.      02350000
019200     05  FILLER                       PIC X(01)  VALUE SPACES.    02360000
019300     05  FILLER                       PIC X(04)  VALUE 'AREA'.    02370000
019400     05  FILLER                       PIC X(01)  VALUE SPACES.    02380000
019500     05  FILLER                       PIC X(12)  VALUE            02390000
019600         'FREIGHT BILL'.                                          02400000
019700     05  FILLER                       PIC X(11)  VALUE SPACES.    02410000
019800     05  FILLER                       PIC X(14)  VALUE            02420000
019900         'BILL OF LADING'.                                        02430000
020000     05  FILLER                       PIC X(08)  VALUE SPACES.    02440000
020100     05  FILLER                       PIC X(05)  VALUE 'COUNT'.   02450000
020200     05  FILLER                       PIC X(03)  VALUE SPACES.    02460000
020300     05  FILLER                       PIC X(05)  VALUE 'COUNT'.   02470000
020400     05  FILLER                       PIC X(04)  VALUE SPACES.    02480000
020500     05  FILLER                       PIC X(05)  VALUE 'COUNT'.   02490000
020600                                                                  02500000
020700 01  H7-HEADING-LINE7.                                            02510000
020800     05  FILLER                       PIC X(02)  VALUE SPACES.    02520000
020900     05  FILLER                       PIC X(13)  VALUE            02530000
021000         'FREIGHT BILL/'.                                         02540000
021100     05  FILLER                       PIC X(54)  VALUE SPACES.    02550000
021200     05  FILLER                       PIC X(07)  VALUE 'PO/RCVR'. 02560000
021300     05  FILLER                       PIC X(04)  VALUE SPACES.    02570000
021400     05  FILLER                       PIC X(04)  VALUE 'CART'.    02580000
021500     05  FILLER                       PIC X(07)  VALUE SPACES.    02590000
021600     05  FILLER                       PIC X(03)  VALUE 'PPD'.     02600000
021700     05  FILLER                       PIC X(02)  VALUE SPACES.    02610000
021800     05  FILLER                       PIC X(03)  VALUE 'FRT'.     02620000
021900     05  FILLER                       PIC X(32)  VALUE SPACES.    02630000
022000                                                                  02640000
022100 01  H8-HEADING-LINE8.                                            02650000
022200     05  FILLER                       PIC X(02)  VALUE SPACES.    02660000
022300     05  FILLER                       PIC X(07)  VALUE 'PRO NBR'. 02670000
022400     05  FILLER                       PIC X(12)  VALUE SPACES.    02680000
022500     05  FILLER                       PIC X(08)  VALUE 'P/U DATE'.02690000
022600     05  FILLER                       PIC X(02)  VALUE SPACES.    02700000
022700     05  FILLER                       PIC X(11)  VALUE            02710000
022800         'VENDOR NAME'.                                           02720000
022900     05  FILLER                       PIC X(08)  VALUE SPACES.    02730000
023000     05  FILLER                       PIC X(14)  VALUE            02740000
023100         'BILL OF LADING'.                                        02750000
023200     05  FILLER                       PIC X(05)  VALUE SPACES.    02760000
023300     05  FILLER                       PIC X(06)  VALUE 'NUMBER'.  02770000
023400     05  FILLER                       PIC X(05)  VALUE SPACES.    02780000
023500     05  FILLER                       PIC X(05)  VALUE 'COUNT'.   02790000
023600     05  FILLER                       PIC X(01)  VALUE SPACES.    02800000
023700     05  FILLER                       PIC X(03)  VALUE 'WGT'.     02810000
023800     05  FILLER                       PIC X(02)  VALUE SPACES.    02820000
023900     05  FILLER                       PIC X(03)  VALUE 'COL'.     02830000
024000     05  FILLER                       PIC X(02)  VALUE SPACES.    02840000
024100     05  FILLER                       PIC X(03)  VALUE 'CHG'.     02850000
024200     05  FILLER                       PIC X(03)  VALUE SPACES.    02860000
024300     05  FILLER                       PIC X(04)  VALUE 'OS&D'.    02870000
024400     05  FILLER                       PIC X(26)  VALUE SPACES.    02880000
024410                                                                  02890000
024420 01  H9-HEADING-LINE9.                                            02900000
024430     05  FILLER                       PIC X(02)  VALUE SPACES.    02910000
024440     05  FILLER                       PIC X(35)  VALUE            02920000
024450         'PO/RECEIVER    PACK          VENDOR'.                   02930000
024460     05  FILLER                       PIC X(19)  VALUE SPACES.    02940000
024470     05  FILLER                       PIC X(44)  VALUE            02950000
024480         'PBS        EC STORAGE     PRETICKET   HANGER'.          02960000
024490     05  FILLER                       PIC X(10)  VALUE SPACES.    02970000
024491                                                                  02980000
024492 01  H10-HEADING-LINE10.                                          02990000
024493     05  FILLER                       PIC X(02)  VALUE SPACES.    03000000
024494     05  FILLER                       PIC X(35)  VALUE            03010000
024495         '  NUMBER       TYPE           NAME '.                   03020000
024496     05  FILLER                       PIC X(16)  VALUE SPACES.    03030000
024497     05  FILLER                       PIC X(49)  VALUE            03040000
024498         'INDICATOR        TYPE        INDICATOR  INDICATOR'.     03050000
024499     05  FILLER                       PIC X(08)  VALUE SPACES.    03060000
024500                                                                  03070000
024600 01  D1-DETAIL-LINE1.                                             03080000
024700     05  FILLER                       PIC X(01)  VALUE SPACES.    03090001
024800** CHG0094517  CHANGED PO-NBR LENGTH TO 8 FROM 7                  03100001
024800     05  D1-PO-NBR                    PIC 9(08)  VALUE ZEROES.    03110001
024900     05  FILLER                       PIC X(01)  VALUE '-'.       03120000
025000     05  D1-REC-SEQ-NBR               PIC 9(04)  VALUE ZEROES.    03130000
025100     05  FILLER                       PIC X(02)  VALUE SPACES.    03140000
025200     05  D1-DEPT                      PIC X(03)  VALUE SPACES.    03150000
025300     05  FILLER                       PIC X(03)  VALUE SPACES.    03160000
025500     05  FILLER                       PIC X(02)  VALUE SPACES.    03170000
025600     05  D1-PKGNG-CDE                 PIC X(01)  VALUE SPACES.    03180000
025700     05  FILLER                       PIC X(02)  VALUE SPACES.    03190000
025800     05  D1-SEASON-SET                PIC X(05)  VALUE SPACES.    03200000
025900     05  FILLER                       PIC X(02)  VALUE SPACES.    03210000
026000     05  D1-VEND-NAME                 PIC X(14)  VALUE SPACES.    03220000
026100     05  FILLER                       PIC X(02)  VALUE SPACES.    03230000
026200     05  D1-TRBL-STAT                 PIC X(09)  VALUE SPACES.    03240000
026300     05  D1-TRBL-STAT-ADDL            PIC X(01)  VALUE SPACES.    03250000
026400     05  FILLER                       PIC X(02)  VALUE SPACES.    03260000
026500     05  D1-RECV-COUNT                PIC ZZZZ   VALUE ZERO.      03270000
026600     05  FILLER                       PIC X(04)  VALUE SPACES.    03280000
026700     05  D1-MULTIPLE-IND              PIC X(01)  VALUE SPACES.    03290000
026800     05  FILLER                       PIC X(04)  VALUE SPACES.    03300000
026900     05  D1-CART-CNT                  PIC ZZZ9   VALUE ZEROES.    03310000
027000     05  FILLER                       PIC X(02)  VALUE SPACES.    03320000
027100     05  FILLER                       PIC X(06)  VALUE '______'.  03330000
027200     05  FILLER                       PIC X(03)  VALUE SPACES.    03340000
027300     05  FILLER                       PIC X(06)  VALUE '______'.  03350000
027400     05  FILLER                       PIC X(03)  VALUE SPACES.    03360000
027500     05  FILLER                       PIC X(06)  VALUE '______'.  03370000
027600     05  FILLER                       PIC X(06)  VALUE SPACES.    03380000
027700                                                                  03390000
027800 01  D2-DETAIL-LINE2.                                             03400000
027900     05  FILLER                       PIC X(02)  VALUE SPACES.    03410000
028000     05  FILLER                       PIC X(18)  VALUE            03420000
028100         '__________________'.                                    03430000
028200     05  FILLER                       PIC X(01)  VALUE SPACES.    03440000
028300     05  FILLER                       PIC X(09)  VALUE            03450000
028400         '_________'.                                             03460000
028500     05  FILLER                       PIC X(01)  VALUE SPACES.    03470000
028600     05  FILLER                       PIC X(18)  VALUE            03480000
028700         '__________________'.                                    03490000
028800     05  FILLER                       PIC X(01)  VALUE SPACES.    03500000
028900     05  FILLER                       PIC X(18)  VALUE            03510000
029000         '__________________'.                                    03520000
029100     05  FILLER                       PIC X(01)  VALUE SPACES.    03530000
029200     05  FILLER                       PIC X(10)  VALUE            03540000
029300         '__________'.                                            03550000
029400     05  FILLER                       PIC X(01)  VALUE SPACES.    03560000
029500     05  FILLER                       PIC X(05)  VALUE '_____'.   03570000
029600     05  FILLER                       PIC X(01)  VALUE SPACES.    03580000
029700     05  FILLER                       PIC X(04)  VALUE '____'.    03590000
029800     05  FILLER                       PIC X(01)  VALUE SPACES.    03600000
029900     05  FILLER                       PIC X(04)  VALUE '____'.    03610000
030000     05  FILLER                       PIC X(01)  VALUE SPACES.    03620000
030100     05  FILLER                       PIC X(04)  VALUE '____'.    03630000
030200     05  FILLER                       PIC X(01)  VALUE SPACES.    03640000
030300     05  FILLER                       PIC X(05)  VALUE '_____'.   03650000
030400     05  FILLER                       PIC X(26)  VALUE SPACES.    03660000
030500                                                                  03670000
030600 01  D3-DETAIL-LINE3.                                             03680000
030700     05  FILLER                       PIC X(03)  VALUE SPACES.    03690001
024800** CHG0094517  CHANGED PO-NBR LENGTH TO 8 FROM 7                  03700001
030800     05  D3-PO-NBR                    PIC 9(08).                  03710001
030900     05  D3-PO-NBR-X REDEFINES                                    03720000
031000         D3-PO-NBR                    PIC X(08).                  03730001
031100     05  FILLER                       PIC X(01)  VALUE '-'.       03740000
031200     05  D3-REC-SEQ-NBR               PIC 9(04).                  03750000
031300     05  D3-REC-SEQ-NBR-X REDEFINES                               03760000
031400         D3-REC-SEQ-NBR               PIC X(04).                  03770000
031500     05  FILLER                       PIC X(02)  VALUE SPACES.    03780000
031600     05  D3-SCAC                      PIC X(04)  VALUE SPACES.    03790000
031700     05  FILLER                       PIC X(01)  VALUE SPACES.    03800000
031800     05  D3-VEH                       PIC X(10)  VALUE SPACES.    03810000
031900     05  FILLER                       PIC X(01)  VALUE SPACES.    03820000
032000     05  D3-STATUS                    PIC X(02)  VALUE SPACES.    03830000
032100     05  FILLER                       PIC X(01)  VALUE SPACES.    03840000
032200     05  D3-PROC-AREA                 PIC X(04)  VALUE SPACES.    03850000
032300     05  FILLER                       PIC X(01)  VALUE SPACES.    03860000
032400     05  D3-PRO-NBR                   PIC X(22)  VALUE SPACES.    03870000
032500     05  FILLER                       PIC X(01)  VALUE SPACES.    03880000
032600     05  D3-BOL-NBR                   PIC X(22)  VALUE SPACES.    03890000
032700     05  FILLER                       PIC X(01)  VALUE SPACES.    03900000
032800     05  D3-CART-CNT                  PIC ZZZ9   VALUE ZEROES.    03910000
032900     05  FILLER                       PIC X(02)  VALUE SPACES.    03920000
033000     05  FILLER                       PIC X(06)  VALUE '______'.  03930000
033100     05  FILLER                       PIC X(03)  VALUE SPACES.    03940000
033200     05  FILLER                       PIC X(06)  VALUE '______'.  03950000
033300                                                                  03960000
033400 01  D4-DETAIL-LINE4.                                             03970000
033500     05  FILLER                       PIC X(05)  VALUE SPACES.    03980000
033600     05  FILLER                       PIC X(04)  VALUE '____'.    03990000
033700     05  FILLER                       PIC X(01)  VALUE SPACES.    04000000
033800     05  FILLER                       PIC X(07)  VALUE '_______'. 04010000
033900     05  FILLER                       PIC X(01)  VALUE SPACES.    04020000
034000     05  FILLER                       PIC X(04)  VALUE '____'.    04030000
034100     05  FILLER                       PIC X(01)  VALUE SPACES.    04040000
034200     05  FILLER                       PIC X(10)  VALUE            04050000
034300         '__________'.                                            04060000
034400     05  FILLER                       PIC X(01)  VALUE SPACES.    04070000
034500     05  FILLER                       PIC X(02)  VALUE '__'.      04080000
034600     05  FILLER                       PIC X(01)  VALUE SPACES.    04090000
034700     05  FILLER                       PIC X(04)  VALUE '____'.    04100000
034800     05  FILLER                       PIC X(01)  VALUE SPACES.    04110000
034900     05  FILLER                       PIC X(22)  VALUE            04120000
035000         '______________________'.                                04130000
035100     05  FILLER                       PIC X(01)  VALUE SPACES.    04140000
035200     05  FILLER                       PIC X(22)  VALUE            04150000
035300         '______________________'.                                04160000
035400     05  FILLER                       PIC X(01)  VALUE SPACES.    04170000
035500     05  FILLER                       PIC X(04)  VALUE '____'.    04180000
035600     05  FILLER                       PIC X(02)  VALUE SPACES.    04190000
035700     05  FILLER                       PIC X(06)  VALUE '______'.  04200000
035800     05  FILLER                       PIC X(03)  VALUE SPACES.    04210000
035900     05  FILLER                       PIC X(06)  VALUE '______'.  04220000
035901                                                                  04230000
035910 01  D5-DETAIL-LINE5.                                             04240000
035920     05  FILLER                       PIC X(01)  VALUE SPACES.    04250001
024800** CHG0094517  CHANGED PO-NBR LENGTH TO 8 FROM 7                  04260001
035930     05  D5-PO-NBR                    PIC 9(08)  VALUE ZEROES.    04270001
035940     05  FILLER                       PIC X(01)  VALUE '-'.       04280000
035950     05  D5-REC-SEQ-NBR               PIC 9(03)  VALUE ZEROES.    04290000
035960     05  FILLER                       PIC X(03)  VALUE SPACES.    04300000
035970     05  D5-PACK-TYPE                 PIC X(06)  VALUE ZEROES.    04310000
035980     05  FILLER                       PIC X(02)  VALUE SPACES.    04320000
035990     05  D5-VEND-NAME                 PIC X(30)  VALUE SPACES.    04330000
035991     05  FILLER                       PIC X(03)  VALUE SPACES.    04340000
035992     05  D5-PBS-IND                   PIC X(01)  VALUE SPACES.    04350000
035993     05  FILLER                       PIC X(08)  VALUE SPACES.    04360000
035994     05  D5-STORAGE-TYPE              PIC X(14)  VALUE SPACES.    04370000
035995     05  FILLER                       PIC X(06)  VALUE SPACES.    04380000
035996     05  D5-PRETICKET-IND             PIC X(01)  VALUE SPACES.    04390000
035997     05  FILLER                       PIC X(09)  VALUE SPACES.    04400000
035998     05  D5-HANGER-IND                PIC X(01)  VALUE SPACES.    04410000
035999     05  FILLER                       PIC X(13)  VALUE SPACES.    04420000
036000                                                                  04430000
036100 01  T1-TOTAL-LINE1.                                              04440000
036200     05  FILLER                       PIC X(65)  VALUE SPACES.    04450000
036300     05  FILLER                       PIC X(09)  VALUE 'TOTAL:  '.04460000
036400     05  T1-TOT-CART-CNT              PIC ZZZZ9  VALUE ZEROES.    04470000
036500     05  FILLER                       PIC X(30)  VALUE SPACES.    04480000
036501                                                                  04490000
036510 01  T2-TOTAL-LINE2.                                              04500000
036520     05  FILLER                       PIC X(31)   VALUE           04510000
036530         '  TOTAL NUMBER OF PO/RECEIVERS:'.                       04520000
036540     05  FILLER                       PIC X(13)   VALUE SPACES.   04530000
036550     05  T2-TOT-PO-RCVRS              PIC ZZZ,ZZ9 VALUE ZEROES.   04540000
036600                                                                  04550000
036700 01  L1-LAST-LINE.                                                04560000
036800     05  FILLER                       PIC X(02)  VALUE SPACES.    04570000
036900     05  FILLER                       PIC X(44)  VALUE            04580000
037000         'UNLOADED BY: ______________________________'.           04590000
037100     05  FILLER                       PIC X(18)  VALUE            04600000
037200         '  DATE: __________'.                                    04610000
037300     05  FILLER                       PIC X(44)  VALUE SPACES.    04620000
037400                                                                  04630000
037500 01  E1-END-OF-MANIFEST.                                          04640000
037600     05  FILLER                       PIC X(32)  VALUE SPACES.    04650000
037700     05  FILLER                       PIC X(44)  VALUE            04660000
037800         '------ E N D   O F   M A N I F E S T ------'.           04670000
037900     05  FILLER                       PIC X(32)  VALUE SPACES.    04680000
038000                                                                  04690000
038100 01  DK-DB2-KEYS.                                                 04700000
038200     05  DK-PO-NBR                       PIC S9(09) COMP VALUE +0.04710000
038300     05  DK-ORD-NBR                      PIC S9(09) COMP VALUE +0.04720000
038400     05  DK-REC-SEQ-NBR                  PIC S9(09) COMP VALUE +0.04730000
038500     05  DK-DEPT-NBR                     PIC  X(03) VALUE SPACES. 04740000
038600     05  DK-OPER-UNT-ID                  PIC S9(04) COMP VALUE +0.04750000
038700     05  DK-FCLTY-ID                     PIC S9(04) COMP VALUE +0.04760000
038800     05  DK-OPER-SET-ID                  PIC S9(04) COMP VALUE +0.04770000
038900     05  DK-SHIPT-ID                     PIC S9(09) COMP VALUE +0.04780000
038910     05  DK-ITEM-NBR                     PIC S9(15) COMP-3.       04790000
038920     05  DK-INTR-UPC-ID                  PIC S9(09) COMP.         04800000
039000                                                                  04810000
039100 01  DN-NULL-INDICATORS.                                          04820000
039200     05  DN-AD-EVNT-DTE                  PIC S9(04) COMP VALUE +0.04830000
039300     05  DN-VEH-TRIP-NULL                PIC S9(04) VALUE +0      04840000
039400                                                    COMP SYNC.    04850000
039500                                                                  04860000
039600                                                                  04870000
039700 01  PS-PROGRAM-SWITCHES.                                         04880000
039800     05  PS-NO-DISTRO-SW              PIC X(01)  VALUE SPACES.    04890000
039900         88  PS-NO-DISTRO                        VALUE 'Y'.       04900000
040000     05  PS-RTV-SW                    PIC X(01)  VALUE SPACES.    04910000
040100         88  PS-RTV                              VALUE 'Y'.       04920000
040200     05  PS-RCVR-PO-CSR-SW            PIC X(01)  VALUE 'N'.       04930000
040300         88  PS-END-OF-RCVR-PO-CSR               VALUE 'Y'.       04940000
040400         88  PS-NOT-END-OF-RCVR-PO-CSR           VALUE 'N'.       04950000
040500     05  PS-PO-CSR-SW                PIC X(01)  VALUE 'N'.        04960000
040600         88  PS-END-OF-PO-CSR                    VALUE 'Y'.       04970000
040700         88  PS-NOT-END-OF-PO-CSR                VALUE 'N'.       04980000
040800     05  PS-ALL-STORES-READ-SW        PIC X(01)  VALUE SPACES.    04990000
040900         88  PS-ALL-STORES-READ                  VALUE 'Y'.       05000000
041000     05  PS-ALL-LI-READ-SW            PIC X(01)  VALUE SPACES.    05010000
041100         88  PS-ALL-LI-READ                      VALUE 'Y'.       05020000
041200     05  PS-NO-DISTRO-CHECK-SW        PIC X(01)  VALUE SPACES.    05030000
041300         88  PS-DO-NO-DISTRO-CHECK               VALUE 'Y'.       05040000
041400         88  PS-STOP-NO-DISTRO-CHECK             VALUE 'N'.       05050000
041500     05  PS-PO-FOUND-SW               PIC X(01)  VALUE 'N'.       05060000
041600         88  PS-PO-FOUND                         VALUE 'Y'.       05070000
041700         88  PS-PO-NOT-FOUND                     VALUE 'N'.       05080000
W38216     05  PS-EC-EFC-FOUND-SW           PIC X(01)  VALUE 'N'.       05090000
W38216         88  PS-EC-EFC-FOUND                     VALUE 'Y'.       05100000
041800     05  PS-NOT-MULTIPLE-SW           PIC X(01)  VALUE 'N'.       05110000
041900         88  PS-NOT-MULTIPLE                     VALUE 'N'.       05120000
042000         88  PS-MULTIPLE                         VALUE 'Y'.       05130000
042100     05  PS-FIRST-LINE-SW             PIC X(01)  VALUE 'Y'.       05140000
042200         88  PS-FIRST-LINE                       VALUE 'Y'.       05150000
042300         88  PS-NOT-FIRST-LINE                   VALUE 'N'.       05160000
042400     05  PS-FIRST-PAGE-SW             PIC X(01)  VALUE 'Y'.       05170000
042500         88  PS-FIRST-PAGE                       VALUE 'Y'.       05180000
042600         88  PS-NOT-FIRST-PAGE                   VALUE 'N'.       05190000
042700     05  PS-FIRST-HEADER-SW           PIC X(01)  VALUE 'Y'.       05200000
042800         88  PS-FIRST-HEADER                     VALUE 'Y'.       05210000
042900         88  PS-NOT-FIRST-HEADER                 VALUE 'N'.       05220000
043000     05  PS-TROUBLE-IND               PIC X(05)  VALUE SPACES.    05230000
043100     05  FILLER REDEFINES PS-TROUBLE-IND.                         05240000
043200         10  PS-TB-ST-CANCELED        PIC X(01).                  05250000
043300         10  PS-TB-ST-EARLY           PIC X(01).                  05260000
043400         10  PS-TB-ST-LATE            PIC X(01).                  05270000
043500         10  PS-TB-ST-NO-DISTRO       PIC X(01).                  05280000
043600         10  PS-TB-ST-RTV             PIC X(01).                  05290000
043710                                                                  05300000
043770     05  PS-CALL-API-SW               PIC  X    VALUE 'N'.        05310000
043780         88  PS-CALL-API-NO                     VALUE 'N'.        05320000
043790         88  PS-CALL-API-YES                    VALUE 'Y'.        05330000
043795                                                                  05340000
043800 01  PM-PROGRAM-MESSAGES.                                         05350000
043900     05  PM-PROGRAM-MESSAGE-7.                                    05360000
044000         10  FILLER                   PIC X(54)  VALUE            05370000
044100         'ERROR DURING TERM LINK TO DRS  - RCKCS226 CICS RESP = '.05380000
044200         10  PM-CICS-RESP-7           PIC 9(04)  VALUE ZEROS.     05390000
044300         10  FILLER                   PIC X(18)  VALUE SPACES.    05400000
044400     05  PM-PROGRAM-MESSAGE-8.                                    05410000
044500         10  FILLER                   PIC X(54)  VALUE            05420000
044600         'ERROR DURING CICS RETRIEVE INTO- RCKCS226 CICS RESP = '.05430000
044700         10  PM-CICS-RESP-8           PIC 9(04)  VALUE ZEROS.     05440000
044800         10  FILLER                   PIC X(18)  VALUE SPACES.    05450000
044900     05  PM-PROGRAM-MESSAGE-9.                                    05460000
045000         10  FILLER                   PIC X(54)  VALUE            05470000
045100         'ERROR DURING INIT LINK TO DRS  - RCKCS226 CICS RESP = '.05480000
045200         10  PM-CICS-RESP-9           PIC 9(04)  VALUE ZEROS.     05490000
045300         10  FILLER                   PIC X(18)  VALUE SPACES.    05500000
045400     05  PM-PROGRAM-MESSAGE-10.                                   05510000
045500         10  FILLER                   PIC X(54)  VALUE            05520000
045600         'ERROR DURING PUT LINK TO DRS  -  RCKCS226 CICS RESP = '.05530000
045700         10  PM-CICS-RESP-10          PIC 9(04)  VALUE ZEROS.     05540000
045800         10  FILLER                   PIC X(18)  VALUE SPACES.    05550000
045900     05  PM-PROGRAM-MESSAGE-11.                                   05560000
046000         10  FILLER                   PIC X(54)  VALUE            05570000
046100         'ERROR DURING CICS WRITEQ CSML -  RCKCS226 CICS RESP = '.05580000
046200         10  PM-CICS-RESP-11          PIC 9(09)  VALUE ZEROS.     05590000
046300         10  FILLER                   PIC X(13)  VALUE SPACES.    05600000
046400                                                                  05610000
046500 01  PV-PROGRAM-VARIABLES.                                        05620000
046600     05  PV-CICS-RESPONSE             PIC S9(9)  VALUE +0         05630000
046700                                                 COMP SYNC.       05640000
046800     05  PV-SAVE-RC                   PIC S9(9)  VALUE +0         05650000
046900                                                 COMP SYNC.       05660000
047000     05  PV-RETRY-COUNTER             PIC S9(04)  VALUE +0        05670000
047100                                                 COMP SYNC.       05680000
047200     05  PV-COUNT-SU-RECORDS          PIC S9(4) VALUE ZERO        05690000
047300                                                COMP.             05700000
047400     05  PV-COUNT-IND                 PIC S9(4) VALUE ZERO        05710000
047500                                                COMP.             05720000
047600     05  PV-TOT-CART-CNT              PIC  9(05).                 05730000
047700     05  PV-DB2-DATE                  PIC  X(10).                 05740000
047800     05  FILLER  REDEFINES PV-DB2-DATE.                           05750000
047900         10  PV-DB2-DATE-CC           PIC  X(02).                 05760000
048000         10  PV-DB2-DATE-YY           PIC  X(02).                 05770000
048100         10  FILLER                   PIC  X(01).                 05780000
048200         10  PV-DB2-DATE-MM           PIC  X(02).                 05790000
048300         10  FILLER                   PIC  X(01).                 05800000
048400         10  PV-DB2-DATE-DD           PIC  X(02).                 05810000
048500                                                                  05820000
048501     05  PV-CURR-TMST-SQL             PIC X(26)  VALUE SPACE.     05830000
048510     05  PV-EC-STORAGE-MSG.                                       05840000
048520         10  FILLER                   PIC  X(11) VALUE            05850000
048530             'NOT FOUND: '.                                       05860000
048540         10  PV-EC-ERROR-CD           PIC  X(02).                 05870000
048550                                                                  05880000
048600     05  PV-IDX                       PIC S9(04) COMP.            05890000
048700                                                                  05900000
048800     05  PV-MULTIPLE-TABLE.                                       05910000
048900         10  PV-MULT-ITEMS OCCURS 100 TIMES.                      05920000
049000             15  PV-PO-NBR            PIC S9(09) COMP.            05930000
049100             15  PV-REC-SEQ-NBR       PIC S9(09) COMP.            05940000
049200                                                                  05950000
049300                                                                  05960000
049400 01  PA-PROGRAM-ACCUMS.                                           05970000
049500     05  PA-PAGE-NBR                  PIC S9(05) VALUE ZERO.      05980000
049600     05  PA-CART-CNT                  PIC S9(05) COMP-3           05990000
049700                                                 VALUE ZERO.      06000000
049800     05  PA-LINE-CNT                  PIC S9(02) VALUE +99.       06010000
049810     05  PA-RCVR-CNT                  PIC S9(02) VALUE ZERO.      06020000
049900                                                                  06030000
050000 01  SA-SAVE-AREAS.                                               06040000
050100     05  SA-REPORT-ID                 PIC X(08).                  06050000
050200                                                                  06060000
050300 01  IW-INTERMEDIATE-WORK-AREAS.                                  06070000
050400     05  IW-DATE.                                                 06080000
050500         10  IW-MONTH                 PIC 9(2)   VALUE ZERO.      06090000
050600         10  FILLER REDEFINES IW-MONTH.                           06100000
050700             15  IW-FIRST-DIGIT-OF-MONTH                          06110000
050800                                      PIC X.                      06120000
050900             15  IW-SECOND-DIGIT-OF-MONTH                         06130000
051000                                      PIC X.                      06140000
051100         10  FILLER                   PIC X      VALUE '/'.       06150000
051200         10  IW-DAY                   PIC X(2).                   06160000
051300         10  FILLER                   PIC X      VALUE '/'.       06170000
051400         10  IW-YEAR                  PIC X(2).                   06180000
051500     05  IW-TIME.                                                 06190000
051600         10  IW-ABSTIME               PIC S9(18) COMP SYNC.       06200000
051700         10  IW-TIME-EDIT.                                        06210000
051800             15  IW-TIME-HHMM         PIC X(5).                   06220000
051900             15  FILLER               PIC X(3).                   06230000
052000                                                                  06240000
052100 01  PC-PROGRAM-CONSTANTS.                                        06250000
052200     05  PC-MAX-RETRIES               PIC S9(04) VALUE +3         06260000
052300                                                 COMP SYNC.       06270000
052400     05  PC-ZERO                      PIC S9(09) VALUE +0         06280000
052500                                                 COMP SYNC.       06290000
052600     05  PC-111                       PIC S9(04) VALUE +111       06300000
052700                                                 COMP.            06310000
052800     05  PC-INIT                      PIC X(04)  VALUE 'INIT'.    06320000
052900     05  PC-TERM                      PIC X(04)  VALUE 'TERM'.    06330000
053000     05  PC-PUT                       PIC X(03)  VALUE 'PUT'.     06340000
053100     05  PC-ACTIVE                    PIC X(01)  VALUE 'A'.       06350000
053200     05  PC-SINGLE-SPACE              PIC X(01)  VALUE ' '.       06360000
053300     05  PC-DASH                      PIC X      VALUE '-'.       06370000
053400     05  PC-SLASH                     PIC X      VALUE '/'.       06380000
053500     05  PC-LINE-MAX                  PIC S9(2)  VALUE +50.       06390000
053600     05  PC-LAST-LINE                 PIC S9(2)  VALUE +44.       06400000
053700     05  PC-PAGE                      PIC X      VALUE '1'.       06410000
053800     05  PC-SPACE1                    PIC X      VALUE ' '.       06420000
053900     05  PC-SPACE2                    PIC X      VALUE '0'.       06430000
054000     05  PC-SPACE3                    PIC X      VALUE '-'.       06440000
054100     05  PC-LOCAL                     PIC X(05)  VALUE 'LOCAL'.   06450000
054200     05  PC-PROG-NAME                 PIC X(08)  VALUE 'RCKCS226'.06460000
054300     05  PC-1                         PIC 9      VALUE 1.         06470000
054310     05  PC-2                         PIC 9      VALUE 2.         06480000
054400     05  PC-AST                       PIC X      VALUE '*'.       06490000
054500     05  PC-A                         PIC X      VALUE 'A'.       06500000
054600     05  PC-I                         PIC X      VALUE 'I'.       06510000
054700     05  PC-L                         PIC X      VALUE 'L'.       06520000
054800     05  PC-N                         PIC X      VALUE 'N'.       06530000
054900     05  PC-Y                         PIC X      VALUE 'Y'.       06540000
055000     05  PC-IP                        PIC X(02)  VALUE 'IP'.      06550000
055100     05  PC-CM                        PIC X(02)  VALUE 'CM'.      06560000
055200     05  PC-CANCEL                    PIC X(06)  VALUE 'CANCEL'.  06570000
055300     05  PC-COMPLETE                  PIC X(08)  VALUE            06580000
055400         'COMPLETE'.                                              06590000
055500     05  PC-EARLY                     PIC X(05)  VALUE 'EARLY'.   06600000
055600     05  PC-LATE                      PIC X(05)  VALUE 'LATE '.   06610000
055700     05  PC-NDIST                     PIC X(09)  VALUE            06620000
055800         'NO DISTRO'.                                             06630000
055900     05  PC-NOF                       PIC X(05)  VALUE 'NOF  '.   06640000
056000     05  PC-RTV                       PIC X(05)  VALUE 'RTV  '.   06650000
056100     05  PC-OPERATING-COMPANY         PIC X(02)  VALUE '03'.      06660000
056110     05  PC-DC-NOT-FOUND              PIC X(21)  VALUE            06670000
056120         'MANIFEST DC NOT FOUND'.                                 06680000
056130     05  PC-DC-NAME-NOT-FOUND         PIC X(17)  VALUE            06690000
056140         'DC NAME NOT FOUND'.                                     06700000
056200                                                                  06710000
056300 01  PC-PORTRAIT-PRINT.                                           06720000
056400     05  PC-PORTRAIT-LINE1            PIC X(50)  VALUE            06730000
056500         ' $$DJDE$$ JDL=KDSP1S,JDE=000001,COPIES=001,END;  '.     06740000
056600                                                                  06750000
056700 01  CA-COMM-AREA.                                                06760000
056800     05  CA-OWNER-SCAC-ID             PIC X(04).                  06770000
056900     05  CA-VEH-NBR                   PIC X(10).                  06780000
057000     05  CA-ARRIVAL-DTE               PIC X(10).                  06790000
057100     05  CA-PRINTER.                                              06800000
057200         10  CA-PRINTER-1             PIC X(01).                  06810000
057300         10  FILLER                   PIC X(07).                  06820000
057400     05  CA-TRIP-ID                   PIC S9(09) COMP.            06830000
057500     05  CA-USERID                    PIC X(08).                  06840000
057600     05  CA-PRTR-AUTO-CUTTER-IND      PIC  X(01).                 06850000
057700     05  CA-PRTR-BARCODE-IND          PIC  X(01).                 06860000
057800     05  CA-PRTR-PRTR-CNTL-IND        PIC  X(01).                 06870000
057900     05  CA-PRTR-TRACK-NBR            PIC S9(04) COMP.            06880000
058000     05  CA-PRINT-PACKAGE-IND         PIC  X(01).                 06890000
058100         88 CA-NOT-FROM-PRINT-PACKAGE VALUE 'N'.                  06900000
058200         88 CA-FROM-PRINT-PACKAGE     VALUE 'Y'.                  06910000
058300     05  CA-DRIB-AREA                 PIC X(264).                 06920000
058400                                                                  06930000
058500/                                                                 06940000
058600*---------------------------------------------------------------* 06950000
058700*    DB2 AREA FOR PURCHASE ORDER TABLE                          * 06960000
058800*---------------------------------------------------------------* 06970000
058900     EXEC SQL                                                     06980000
059000          INCLUDE TPURCHS                                         06990000
059100     END-EXEC.                                                    07000000
059200                                                                  07010000
059300/                                                                 07020000
059400*---------------------------------------------------------------* 07030000
059500*    DB2 AREA FOR THE PURCHASE ORDER LINE ITEM TABLE            * 07040000
059600*---------------------------------------------------------------* 07050000
059700     EXEC SQL                                                     07060000
059800          INCLUDE TPURITM                                         07070000
059900     END-EXEC.                                                    07080000
060000                                                                  07090000
060100/                                                                 07100000
060200*---------------------------------------------------------------* 07110000
060300*    DB2 AREA FOR RECEIVER TABLE                                * 07120000
060400*---------------------------------------------------------------* 07130000
060500     EXEC SQL                                                     07140000
060600          INCLUDE TRECEIV                                         07150000
060700     END-EXEC.                                                    07160000
060800                                                                  07170000
060900/                                                                 07180000
061000*---------------------------------------------------------------* 07190000
061100*    DB2 AREA FOR SHIPMENT TABLE                                * 07200000
061200*---------------------------------------------------------------* 07210000
061300     EXEC SQL                                                     07220000
061400          INCLUDE TSHIPMT                                         07230000
061500     END-EXEC.                                                    07240000
061600                                                                  07250000
061700/                                                                 07260000
061800*---------------------------------------------------------------* 07270000
061900*    DB2 AREA FOR SHIPMENT PO TABLE                             * 07280000
062000*---------------------------------------------------------------* 07290000
062100     EXEC SQL                                                     07300000
062200          INCLUDE TSHPTPO                                         07310000
062300     END-EXEC.                                                    07320000
062400                                                                  07330000
062500/                                                                 07340000
062600*---------------------------------------------------------------* 07350000
062700*    DB2 AREA FOR VEHICLE TRIP TABLE                            * 07360000
062800*---------------------------------------------------------------* 07370000
062900     EXEC SQL                                                     07380000
063000          INCLUDE TVHTRIP                                         07390000
063100     END-EXEC.                                                    07400000
063200                                                                  07410000
063300/                                                                 07420000
063400*---------------------------------------------------------------* 07430000
063500*    DB2 AREA FOR VEHICLE TRIP STATUS TABLE                     * 07440000
063600*---------------------------------------------------------------* 07450000
063700     EXEC SQL                                                     07460000
063800          INCLUDE TTRIPST                                         07470000
063900     END-EXEC.                                                    07480000
064000                                                                  07490000
064100/                                                                 07500000
064200*---------------------------------------------------------------* 07510000
064300*    DB2 AREA FOR VEHICLE TRIP STATUS CODE TABLE                * 07520000
064400*---------------------------------------------------------------* 07530000
064500     EXEC SQL                                                     07540000
064600          INCLUDE TTRSTYP                                         07550000
064700     END-EXEC.                                                    07560000
064800                                                                  07570000
064900/                                                                 07580000
065000*---------------------------------------------------------------* 07590000
065100*    DB2 AREA FOR THE ENTERPRISE NAME TABLE                     * 07600000
065200*---------------------------------------------------------------* 07610000
065300     EXEC SQL                                                     07620000
065400          INCLUDE TENTNME                                         07630000
065500     END-EXEC.                                                    07640000
065600                                                                  07650000
065700/                                                                 07660000
065800*----------------------------------------------------------------*07670000
065900*    DB2 DCLGEN FOR THE TROUBLE NOTIFICATION TABLE                07680000
066000*----------------------------------------------------------------*07690000
066100     EXEC SQL                                                     07700000
066200          INCLUDE TTRBNTF                                         07710000
066300     END-EXEC.                                                    07720000
066400                                                                  07730000
066500/                                                                 07740000
066600*----------------------------------------------------------------*07750000
066700*    DB2 DCLGEN FOR THE TROUBLE REASON TABLE                      07760000
066800*----------------------------------------------------------------*07770000
066900     EXEC SQL                                                     07780000
067000          INCLUDE TTRBRSN                                         07790000
067100     END-EXEC.                                                    07800000
067200                                                                  07810000
067300*---------------------------------------------------------------* 07820000
067400*    DB2 AREA FOR SHIPMENT STATUS TABLE                         * 07830000
067500*---------------------------------------------------------------* 07840000
067600     EXEC SQL                                                     07850000
067700          INCLUDE TSHIPST                                         07860000
067800     END-EXEC.                                                    07870000
067900*---------------------------------------------------------------* 07880000
068000*    DB2 AREA FOR STATUS TYPE TABLE                             * 07890000
068100*---------------------------------------------------------------* 07900000
068200     EXEC SQL                                                     07910000
068300          INCLUDE TSHSTYP                                         07920000
068400     END-EXEC.                                                    07930000
068500*----------------------------------------------------------------*07940000
068600*    DB2 AREA FOR WORK ORDER TABLE                               *07950000
068700*----------------------------------------------------------------*07960000
068800     EXEC SQL                                                     07970000
068900          INCLUDE TWRKORD                                         07980000
069000     END-EXEC.                                                    07990000
069100*----------------------------------------------------------------*08000000
069200*    DB2 AREA FOR TDCFAAS  DEPT/CLASS FACILITY LOC. ASSIGNMENTS  *08010000
069300*----------------------------------------------------------------*08020000
069400                                                                  08030000
069500     EXEC SQL                                                     08040000
069600          INCLUDE TDCFAAS                                         08050000
069700     END-EXEC.                                                    08060000
069800                                                                  08070000
069900/                                                                 08080000
070000*----------------------------------------------------------------*08090000
070100*    DB2 AREA FOR OPERATION SET TABLE                            *08100000
070200*----------------------------------------------------------------*08110000
070300                                                                  08120000
070400     EXEC SQL                                                     08130000
070500          INCLUDE TOPRSET                                         08140000
070600     END-EXEC.                                                    08150000
070700                                                                  08160000
070800/                                                                 08170000
070900*----------------------------------------------------------------*08180000
071000*    DB2 DCLGEN FOR PACK SLIP HEADER TABLE                        08190000
071100*----------------------------------------------------------------*08200000
071200     EXEC SQL                                                     08210000
071300          INCLUDE TPKSLIP                                         08220000
071400     END-EXEC.                                                    08230000
071500                                                                  08240000
071600/                                                                 08250000
071700*----------------------------------------------------------------*08260000
071800*    DB2 DCLGEN FOR INBOUND EDI PACKSLIP/VENDOR SHIPMENT UNIT TBL 08270000
071900*----------------------------------------------------------------*08280000
072000     EXEC SQL                                                     08290000
072100          INCLUDE TINPKSU                                         08300000
072200     END-EXEC.                                                    08310000
072300                                                                  08320000
072400/                                                                 08330000
072530*---------------------------------------------------------------* 08340000
072600*  CURSOR TO SELECT ALL PURCHASE ORDERS FOR A RECEIVER            08350000
072700*---------------------------------------------------------------* 08360000
072800*  THIS CURSOR SHOULD GIVE THE SAME RESULTS AS THE CURSOR IN      08370000
072900*  RCKCS225.                                                      08380000
073000                                                                  08390000
073100     EXEC SQL                                                     08400000
073200         DECLARE RCVR_PO_CSR CURSOR FOR                           08410000
073300             SELECT DISTINCT                                      08420000
073400                    A.PO_NBR                                      08430000
073500                   ,A.REC_SEQ_NBR                                 08440000
073600*                  ,A.EXPTED_CART_CNT                             08450000
073700*                  ,A.ACTL_CART_CNT                               08460000
073800*                  ,A.DMG_CART_CNT                                08470000
073900*                  ,A.VEND_NAME                                   08480000
074000                   ,C.OWNER_SCAC_ID                               08490000
074100                   ,C.VEH_NBR                                     08500000
074200*                  ,D.STATUS_DTE                                  08510000
074300*                  ,B.SHIPT_ID                                    08520000
074400                   ,F.EXPTED_CART_CNT                             08530000
074500                   ,F.CRE_TMST                                    08540000
074600                   ,F.OPER_UNT_ID                                 08550000
074700                   ,F.FCLTY_ID                                    08560000
074800                   ,F.PACK_BY_ST_IND                              08570000
074801                   ,F.PRE_TKT_IND                                 08580000
074802                   ,F.GOH_IND                                     08590000
074810                   ,F.PKGNG_CDE                                   08600000
074900               FROM TSHPTPO A                                     08610000
075000                   ,TSHIPMT B                                     08620000
075100                   ,TVHTRIP C                                     08630000
075200*                  ,TTRIPST D                                     08640000
075300*                  ,TTRSTYP E                                     08650000
075400                   ,TRECEIV F                                     08660000
075500              WHERE C.OWNER_SCAC_ID = :CA-OWNER-SCAC-ID           08670000
075600*               AND D.STATUS_DTE    = :CA-ARRIVAL-DTE             08680000
075700                AND C.VEH_NBR       = :CA-VEH-NBR                 08690000
075800                AND C.TRIP_ID       = :CA-TRIP-ID                 08700000
075900*               AND D.TRIP_STATUS_CDE = E.TRIP_STATUS_CDE         08710000
076000                AND A.SHIPT_ID        = B.SHIPT_ID                08720000
076100                AND B.TRIP_ID         = C.TRIP_ID                 08730000
076200*               AND C.TRIP_ID         = D.TRIP_ID                 08740000
076300                AND A.PO_NBR          = F.ORD_NBR                 08750000
076400                AND A.REC_SEQ_NBR     = F.REC_SEQ_NBR             08760000
076500                AND F.VER_STATUS_CDE  = 'A'                       08770000
076600             ORDER BY F.CRE_TMST                                  08780000
076700     END-EXEC.                                                    08790000
076900                                                                  08800000
076910     EXEC SQL                                                     08810000
077000          DECLARE PO-CSR CURSOR FOR                               08820000
077100              SELECT DISTINCT                                     08830000
077200                A.SHIPT_ID                                        08840000
077300              , A.PRO_NBR                                         08850000
077400              , A.BOL_NBR                                         08860000
077600              , D.EXPTED_CART_CNT                                 08870000
077700              , B.OWNER_SCAC_ID                                   08880000
077800              , B.VEH_NBR                                         08890000
077900          FROM  TSHIPMT A                                         08900000
078000              , TVHTRIP B                                         08910000
078100              , TTRIPST C                                         08920000
078200              , TSHPTPO D                                         08930000
078300              , TRECEIV E                                         08940000
078400          WHERE E.ORD_NBR           = :DK-PO-NBR                  08950000
078500            AND E.REC_SEQ_NBR       = :DK-REC-SEQ-NBR             08960000
078600            AND E.VER_STATUS_CDE    = :PC-A                       08970000
078700            AND E.STATUS_CDE        = :PC-IP                      08980000
078800            AND E.ORD_NBR           = D.PO_NBR                    08990000
078900            AND E.REC_SEQ_NBR       = D.REC_SEQ_NBR               09000000
079000            AND C.OPER_UNT_ID       = :DK-OPER-UNT-ID             09010000
079100            AND C.FCLTY_ID          = :DK-FCLTY-ID                09020000
079200            AND B.TRIP_ID           = C.TRIP_ID                   09030000
079300            AND B.TRIP_ID           = A.TRIP_ID                   09040000
079400            AND A.SHIPT_ID          = D.SHIPT_ID                  09050000
079500            AND B.VEH_NBR           IS NOT NULL                   09060000
079600          ORDER BY A.PRO_NBR, A.BOL_NBR                           09070000
079700     END-EXEC.                                                    09080000
079850*                                                                 09090000
079900*                                                                 09100000
080000*  COMMUNICATION AREAS FOR DB2                                    09110000
080100*                                                                 09120000
080200     EXEC SQL                                                     09130000
080300         INCLUDE SQLCA                                            09140000
080400     END-EXEC.                                                    09150000
080500                                                                  09160000
080600/                                                                 09170000
080700******************************************************************09180000
080800 LINKAGE SECTION.                                                 09190000
080900******************************************************************09200000
081000                                                                  09210000
081100 01  DFHCOMMAREA                      PIC X(350).                 09220000
081200/                                                                 09230000
081300                                                                  09240000
081400******************************************************************09250000
081500 PROCEDURE DIVISION.                                              09260000
081600******************************************************************09270000
081700                                                                  09280000
081800 0000-MAINLINE.                                                   09290000
081900                                                                  09300000
082000     PERFORM 0100-INITIALIZATION.                                 09310000
082100                                                                  09320000
082110     PERFORM 0300-DESTINATION-DC                                  09330000
082111     IF SQLCODE = +0                                              09340000
082112         PERFORM 0310-SELECT-DC                                   09350000
082113     END-IF                                                       09360000
082114     IF SQLCODE = +0                                              09370000
082115         PERFORM 0320-DC-NAME                                     09380000
082116     END-IF                                                       09390000
082120                                                                  09400000
082200     PERFORM 4000-OPEN-RCVR-PO-CSR.                               09410000
082300     PERFORM 4100-FETCH-RCVR-PO-CSR.                              09420000
082400                                                                  09430000
082500     PERFORM 1000-CREATE-REPORT                                   09440000
082600         UNTIL PS-END-OF-RCVR-PO-CSR.                             09450000
082610     PERFORM 4200-CLOSE-CURSOR                                    09460000
082700                                                                  09470000
082800     PERFORM 5000-SETUP-TOTAL-LINE.                               09480000
082900                                                                  09490000
083000     IF PV-PO-NBR (1) > ZERO                                      09500000
083100         SET PS-MULTIPLE TO TRUE                                  09510000
083200         MOVE 99 TO PA-LINE-CNT                                   09520000
083300         PERFORM 6000-PRINT-MULTIPLE-LINES                        09530000
083400             VARYING PV-IDX FROM 1 BY 1                           09540000
083500             UNTIL PV-PO-NBR (PV-IDX) = 0                         09550000
083600         PERFORM 5100-SETUP-TOTAL-LINE                            09560000
083700     END-IF.                                                      09570000
083800                                                                  09580000
083900     MOVE E1-END-OF-MANIFEST     TO DRS01-COMM-DATA.              09590000
084000     MOVE PC-SPACE2              TO DRS01-COMM-CTL.               09600000
084100     MOVE SA-REPORT-ID           TO DRS01-DRRB-RID.               09610000
084200                                                                  09620000
084300     PERFORM 9000-PUT-LINE-TO-DRS.                                09630000
084310                                                                  09640000
W38216     IF PS-EC-EFC-FOUND                                           09650000
084312         MOVE 99                TO PA-LINE-CNT                    09660000
084320         PERFORM 4000-OPEN-RCVR-PO-CSR                            09670000
084330         PERFORM 4100-FETCH-RCVR-PO-CSR                           09680000
084340                                                                  09690000
084341         INITIALIZE PS-RCVR-PO-CSR-SW                             09700000
084342                    PA-PAGE-NBR                                   09710000
084350         PERFORM 1010-CREATE-EC-REPORT                            09720000
084360             UNTIL PS-END-OF-RCVR-PO-CSR                          09730000
084370         PERFORM 4200-CLOSE-CURSOR                                09740000
084371                                                                  09750000
084372         MOVE PA-RCVR-CNT        TO T2-TOT-PO-RCVRS               09760000
084380         MOVE T2-TOTAL-LINE2     TO DRS01-COMM-DATA               09770000
084381         MOVE PC-SPACE2          TO DRS01-COMM-CTL                09780000
084382         MOVE SA-REPORT-ID       TO DRS01-DRRB-RID                09790000
084383         PERFORM 9000-PUT-LINE-TO-DRS                             09800000
084384         MOVE E1-END-OF-MANIFEST TO DRS01-COMM-DATA               09810000
084390         MOVE PC-SPACE2          TO DRS01-COMM-CTL                09820000
084391         MOVE SA-REPORT-ID       TO DRS01-DRRB-RID                09830000
084393         PERFORM 9000-PUT-LINE-TO-DRS                             09840000
084394     END-IF                                                       09850000
084400                                                                  09860000
084500*    IF THIS PROGRAM WAS CALLED FROM THE PRINT PACKAGE, DON'T     09870000
084600*    TERMINATE DRS OR CUT PAPER (IF PRINTER IS CAPABLE)           09880000
084700     IF CA-NOT-FROM-PRINT-PACKAGE                                 09890000
084800         IF CA-PRTR-AUTO-CUTTER-IND = 'Y'                         09900000
084900             MOVE DS004-PLC-CUT-FORM     TO DRS01-COMM-DATA       09910000
085000             MOVE ' '                    TO DRS01-COMM-CTL        09920000
085100             PERFORM 9000-PUT-LINE-TO-DRS                         09930000
085200         END-IF                                                   09940000
085300                                                                  09950000
085400         MOVE PC-TERM                TO DRS01-DRRB-FUNC           09960000
085500                                                                  09970000
085600         EXEC CICS LINK                                           09980000
085700             PROGRAM  ('DRS1INTC')                                09990000
085800             COMMAREA (DRS01-COMMAREA)                            10000000
085900             RESP     (PV-CICS-RESPONSE)                          10010000
086000         END-EXEC                                                 10020000
086100                                                                  10030000
086200         IF PV-CICS-RESPONSE NOT = DFHRESP(NORMAL)                10040000
086300             SET DP013-LOGIC-ABEND   TO TRUE                      10050000
086400             SET DP013-NO-ROLLBACK   TO TRUE                      10060000
086500             MOVE '0000-MAINLINE'    TO DP013-PARAGRAPH           10070000
086600             MOVE PV-CICS-RESPONSE   TO PM-CICS-RESP-7            10080000
086700             MOVE PM-PROGRAM-MESSAGE-7                            10090000
086800                                     TO DP013-MESSAGE-TEXT(1)     10100000
086900             PERFORM 9999-ABEND                                   10110000
087000         END-IF                                                   10120000
087100     END-IF.                                                      10130000
087200                                                                  10140000
087300     GOBACK.                                                      10150000
087400                                                                  10160000
087500 0100-INITIALIZATION.                                             10170000
087600                                                                  10180000
087700     EXEC CICS                                                    10190000
087800          RETRIEVE                                                10200000
087900          INTO   (CA-COMM-AREA)                                   10210000
088000          LENGTH (LENGTH OF CA-COMM-AREA)                         10220000
088100          RESP   (PV-CICS-RESPONSE)                               10230000
088200     END-EXEC.                                                    10240000
088300                                                                  10250000
088400     EVALUATE TRUE                                                10260000
088500         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 10270000
088600             CONTINUE                                             10280000
088700         WHEN PV-CICS-RESPONSE = DFHRESP (ENDDATA)                10290000
088800             PERFORM 0200-MOVE-COMMAREA                           10300000
088900         WHEN OTHER                                               10310000
089000             SET DP013-LOGIC-ABEND   TO TRUE                      10320000
089100             SET DP013-NO-ROLLBACK   TO TRUE                      10330000
089200             MOVE '0100-INITIALIZATION'                           10340000
089300                                     TO DP013-PARAGRAPH           10350000
089400             MOVE PV-CICS-RESPONSE   TO PM-CICS-RESP-8            10360000
089500             MOVE PM-PROGRAM-MESSAGE-8                            10370000
089600                                     TO DP013-MESSAGE-TEXT(1)     10380000
089700             PERFORM 9999-ABEND                                   10390000
089800     END-EVALUATE.                                                10400000
089900                                                                  10410000
090000*    IF THE PROGRAM IS NOT CALLED FROM THE PRINT PACKAGE, INIT    10420000
090100*    DRS                                                          10430000
090200     IF CA-NOT-FROM-PRINT-PACKAGE                                 10440000
090300         MOVE PC-INIT                TO DRS01-DRRB-FUNC           10450000
090400         MOVE PC-111                 TO DRS02-DRIB-LRECL-1        10460000
090500         MOVE PC-111                 TO DRS02-DRIB-BLKSIZE-1      10470000
090600         MOVE PC-A                   TO DRS02-DRIB-CLASS          10480000
090700         MOVE 1                      TO PV-IDX                    10490000
090800                                                                  10500000
090900         IF CA-PRINTER = 'XXXXXXXX'                               10510000
091000             MOVE 'R'                TO DRS02-DRIB-CLASS          10520000
091100             MOVE 'N'                TO DRS02-DRIB-HOLD           10530000
091200             MOVE PC-LOCAL           TO DRS02-DRIB-DEST           10540000
091300         ELSE                                                     10550000
091400             MOVE CA-PRINTER         TO DRS02-DRIB-DEST           10560000
091500         END-IF                                                   10570000
091600                                                                  10580000
091700         MOVE DRS02-DRIB-HEADER      TO DRS01-COMM-DRIB-HDR       10590000
091800         MOVE DRS02-DRIB-ATTRIB      TO DRS01-COMM-DRIB-AT1       10600000
091900                                                                  10610000
092000         EXEC CICS LINK                                           10620000
092100             PROGRAM  ('DRS1INTC')                                10630000
092200             COMMAREA (DRS01-COMMAREA)                            10640000
092300             RESP     (PV-CICS-RESPONSE)                          10650000
092400         END-EXEC                                                 10660000
092500                                                                  10670000
092600         IF PV-CICS-RESPONSE NOT = DFHRESP(NORMAL)                10680000
092700             SET DP013-LOGIC-ABEND   TO TRUE                      10690000
092800             SET DP013-NO-ROLLBACK   TO TRUE                      10700000
092900             MOVE '0100-INITIALIZATION'                           10710000
093000                                     TO DP013-PARAGRAPH           10720000
093100             MOVE PV-CICS-RESPONSE   TO PM-CICS-RESP-9            10730000
093200             MOVE PM-PROGRAM-MESSAGE-9                            10740000
093300                                     TO DP013-MESSAGE-TEXT(1)     10750000
093400             PERFORM 9999-ABEND                                   10760000
093500         END-IF                                                   10770000
093600                                                                  10780000
093700         IF DRS01-DRRB-RC = ZERO                                  10790000
093800             CONTINUE                                             10800000
093900         ELSE                                                     10810000
094000             MOVE DRS01-DRRB-RC      TO PV-SAVE-RC                10820000
094100             PERFORM 9950-DRS-FATAL-ERROR                         10830000
094200         END-IF                                                   10840000
094300                                                                  10850000
094400*        IF SENDING THE REPORT TO A "FORMSPRO" PRINTER, SET-UP    10860000
094500*        AND SEND THE FORM TO LOAD.                               10870000
094600         IF CA-PRTR-PRTR-CNTL-IND = 'P'                           10880000
094700             MOVE CA-PRTR-TRACK-NBR   TO DS004-PLC-LF-FORM-NBR    10890000
094800             MOVE DS004-PES-8LPI      TO DS004-PLC-LF-LPI         10900000
094900                                         DS004-PLC-DI-LPI         10910000
095000                                                                  10920000
095100             MOVE DS004-PLC-LOAD-FORM TO  DRS01-COMM-DATA         10930000
095200             MOVE PC-SINGLE-SPACE     TO  DRS01-COMM-CTL          10940000
095300             PERFORM 9000-PUT-LINE-TO-DRS                         10950000
095400         END-IF                                                   10960000
095500     ELSE                                                         10970000
095600*    CALLED FROM THE PRINTER PACKAGE - MUST MOVE THE "DRIB" AND   10980000
095700*    SET-UP THE "DEACTIVATE IMAGE" FIELD WITH THE LINE-PER-INCH   10990000
095800         MOVE DS004-PES-8LPI          TO DS004-PLC-DI-LPI         11000000
095900     END-IF.                                                      11010000
096000                                                                  11020000
096100     MOVE DRS01-DRRB-RID             TO SA-REPORT-ID.             11030000
096200                                                                  11040000
096300     INITIALIZE PA-CART-CNT.                                      11050000
096400     INITIALIZE PV-MULTIPLE-TABLE.                                11060000
096500     SET PS-NOT-MULTIPLE TO TRUE.                                 11070000
096600                                                                  11080000
096700     EXEC CICS                                                    11090000
096800         ASKTIME                                                  11100000
096900         ABSTIME(IW-ABSTIME)                                      11110000
097000     END-EXEC.                                                    11120000
097100                                                                  11130000
097200     EXEC CICS                                                    11140000
097300         FORMATTIME                                               11150000
097400         ABSTIME (IW-ABSTIME)                                     11160000
097500         MMDDYY  (DP108O-RUN-DATE)                                11170000
097600         DATESEP                                                  11180000
097700         TIME    (IW-TIME-EDIT)                                   11190000
097800         TIMESEP                                                  11200000
097900     END-EXEC.                                                    11210000
098000                                                                  11220000
098100     MOVE IW-TIME-HHMM           TO DP108O-RUN-TIME.              11230000
098101                                                                  11240000
098110     EXEC SQL                                                     11250000
098120         SET :PV-CURR-TMST-SQL = CURRENT TIMESTAMP                11260000
098130     END-EXEC                                                     11270000
098140     EVALUATE TRUE                                                11280000
098150         WHEN SQLCODE = ZERO                                      11290000
098160             CONTINUE                                             11300000
098190         WHEN SQLWARN0 NOT = SPACES                               11310000
098191         WHEN SQLCODE < ZERO                                      11320000
098192         WHEN SQLCODE > ZERO                                      11330000
098193             MOVE '0100-INITIALIZATION'                           11340000
098194                               TO DP013-PARAGRAPH                 11350000
098195             MOVE SQLCA        TO DP013-SQLCA                     11360000
098196             SET DP013-DB2-ABEND                                  11370000
098197                 DP013-XCTL-DISPLAY-RESTART TO TRUE               11380000
098198             PERFORM 9999-ABEND                                   11390000
098199     END-EVALUATE.                                                11400000
098220                                                                  11410000
098300 0200-MOVE-COMMAREA.                                              11420000
098400     INITIALIZE CA-COMM-AREA.                                     11430000
098500     MOVE DFHCOMMAREA           TO CA-COMM-AREA.                  11440000
098600*  THIS RESTORES THE DRIB WORK AREAS THAT WERE INITIALIZED        11450000
098700*  IN DSKCS606                                                    11460000
098800     MOVE CA-DRIB-AREA          TO DRS01-COMMAREA.                11470000
098900/                                                                 11480000
098901 0300-DESTINATION-DC.                                             11490000
098910     PERFORM                                                      11500000
098920         WITH TEST AFTER                                          11510000
098930         VARYING PV-RETRY-COUNTER                                 11520000
098940         FROM 1 BY 1                                              11530000
098950         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               11540000
098960             OR (SQLCODE = +0)                                    11550000
098961             OR (SQLCODE = +100)                                  11560000
098970             OR (SQLCODE = -305))                                 11570000
098980                                                                  11580000
098990         EXEC SQL                                                 11590000
098991             SELECT MAX(STATUS_DTE)                               11600000
098992               INTO :TRIPST-STATUS-DTE                            11610000
098994               FROM TTRIPST                                       11620000
098999              WHERE TRIP_ID         = :CA-TRIP-ID                 11630000
099000         END-EXEC                                                 11640000
099001                                                                  11650000
099002         EVALUATE TRUE                                            11660000
099009             WHEN SQLCODE = +0                                    11670000
099010                 CONTINUE                                         11680000
099011                                                                  11690000
099012             WHEN SQLCODE = -305                                  11700000
099013             WHEN SQLCODE = +100                                  11710000
099014                 MOVE SPACES          TO H1-DC-NBR-A              11720000
099015                                         H1-EC-DC-NBR-A           11730000
099016                 MOVE PC-DC-NOT-FOUND TO H1-DC-NAME               11740000
099017                                         H1-EC-DC-NAME            11750000
099018                                                                  11760000
099019             WHEN SQLCODE = -904                                  11770000
099020             WHEN SQLCODE = -913                                  11780000
099021                 CONTINUE                                         11790000
099022                                                                  11800000
099023             WHEN SQLWARN0 NOT = SPACES                           11810000
099024             WHEN SQLCODE < +0                                    11820000
099025             WHEN SQLCODE > +0                                    11830000
099026                  MOVE '0300-DESTINATION-DC'                      11840000
099027                                      TO DP013-PARAGRAPH          11850000
099028                  MOVE 'UNSUCCESSFUL SELECT ON TTRIPST'           11860000
099029                                      TO DP013-MESSAGE-TEXT (1)   11870000
099030                  MOVE SQLCA          TO DP013-SQLCA              11880000
099031                  MOVE 'TTRIPST '     TO DP013-DB2-TABLE-NAME (1) 11890000
099032                  SET DP013-DB2-ABEND                             11900000
099033                      DP013-XCTL-DISPLAY-RESTART                  11910000
099034                                      TO TRUE                     11920000
099035                  PERFORM 9999-ABEND                              11930000
099036         END-EVALUATE                                             11940000
099037     END-PERFORM                                                  11950000
099038                                                                  11960000
099039     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    11970000
099040         SQLCODE NOT = +0                                         11980000
099041         MOVE '0300-DESTINATION-DC'                               11990000
099042                                      TO DP013-PARAGRAPH          12000000
099043         MOVE 'MAX RETRIES EXCEEDED ON SELECT TTRIPST'            12010000
099044                                      TO DP013-MESSAGE-TEXT (1)   12020000
099045         MOVE SQLCA                   TO DP013-SQLCA              12030000
099046         MOVE 'TTRIPST '              TO DP013-DB2-TABLE-NAME (1) 12040000
099047         SET DP013-DB2-ABEND                                      12050000
099048             DP013-XCTL-DISPLAY-RESTART                           12060000
099049                                      TO TRUE                     12070000
099050         PERFORM 9999-ABEND                                       12080000
099051     END-IF.                                                      12090000
099052 0310-SELECT-DC.                                                  12100000
099053     PERFORM                                                      12110000
099054         WITH TEST AFTER                                          12120000
099055         VARYING PV-RETRY-COUNTER                                 12130000
099056         FROM 1 BY 1                                              12140000
099057         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               12150000
099058                   OR (SQLCODE = +0)                              12160000
099059                   OR (SQLCODE = +100)                            12170000
099060                   OR (SQLCODE = -305))                           12180000
099061                                                                  12190000
099062         EXEC SQL                                                 12200000
099063          SELECT MAX(STATUS_TME),                                 12210000
099064                 OPER_UNT_ID                                      12220000
099065            INTO :TRIPST-STATUS-TME,                              12230000
099066                 :TRIPST-OPER-UNT-ID                              12240000
099067            FROM TTRIPST                                          12250000
099068           WHERE TRIP_ID       = :CA-TRIP-ID                      12260000
099069             AND STATUS_DTE    = :TRIPST-STATUS-DTE               12270000
099070           GROUP BY OPER_UNT_ID                                   12280000
099071         END-EXEC                                                 12290000
099072                                                                  12300000
099073         EVALUATE TRUE                                            12310000
099081             WHEN SQLCODE = +0                                    12320000
099082                 MOVE TRIPST-OPER-UNT-ID TO H1-DC-NBR             12330000
099083                                            H1-EC-DC-NBR          12340000
099087                                                                  12350000
099088             WHEN SQLCODE = -305                                  12360000
099089             WHEN SQLCODE = +100                                  12370000
099090                 MOVE SPACES             TO H1-DC-NBR-A           12380000
099091                                            H1-EC-DC-NBR-A        12390000
099092                 MOVE PC-DC-NOT-FOUND    TO H1-DC-NAME            12400000
099093                                            H1-EC-DC-NAME         12410000
099094             WHEN SQLCODE = -904                                  12420000
099095             WHEN SQLCODE = -913                                  12430000
099096                  CONTINUE                                        12440000
099097                                                                  12450000
099098             WHEN SQLWARN0 NOT = SPACES                           12460000
099099             WHEN SQLCODE < +0                                    12470000
099100             WHEN SQLCODE > +0                                    12480000
099101                  MOVE '3015-SELECT-TIME'                         12490000
099102                                  TO DP013-PARAGRAPH              12500000
099103                  MOVE 'UNSUCCESSFUL SELECT ON TVHTRIP'           12510000
099104                                  TO DP013-MESSAGE-TEXT (1)       12520000
099105                  MOVE SQLCA      TO DP013-SQLCA                  12530000
099106                  MOVE 'TTRIPST ' TO DP013-DB2-TABLE-NAME (1)     12540000
099107                  SET DP013-DB2-ABEND                             12550000
099108                      DP013-XCTL-DISPLAY-RESTART                  12560000
099109                                  TO TRUE                         12570000
099110                  PERFORM 9999-ABEND                              12580000
099111         END-EVALUATE                                             12590000
099112     END-PERFORM.                                                 12600000
099113                                                                  12610000
099114     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    12620000
099115         SQLCODE NOT = +0                                         12630000
099116         MOVE '3015-SELECT-TIME'                                  12640000
099117                                  TO DP013-PARAGRAPH              12650000
099118         MOVE 'MAX RETRIES EXCEEDED ON SELECT TVHTRIP'            12660000
099119                                  TO DP013-MESSAGE-TEXT (1)       12670000
099120         MOVE SQLCA               TO DP013-SQLCA                  12680000
099121         MOVE 'TTRIPST '          TO DP013-DB2-TABLE-NAME (1)     12690000
099122         SET DP013-DB2-ABEND                                      12700000
099123             DP013-XCTL-DISPLAY-RESTART                           12710000
099124                                  TO TRUE                         12720000
099125         PERFORM 9999-ABEND                                       12730000
099126     END-IF.                                                      12740000
099127                                                                  12750000
099128 0320-DC-NAME.                                                    12760000
099129                                                                  12770000
099130     INITIALIZE XL071-COMMAREA-REC.                               12780000
099131     MOVE TRIPST-OPER-UNT-ID  TO XL071-LOCATION-NUMBER.           12790000
099132                                                                  12800000
099133     CALL XL071-LOCATION-MODULE USING DFHEIBLK                    12810000
099134                                      XL071-COMMAREA              12820000
099135                                      XL071-COMMAREA-REC.         12830000
099136                                                                  12840000
099137     EVALUATE TRUE                                                12850000
099138         WHEN XL071-NO-ERRORS                                     12860000
099139             IF XL071-LOC-TYP-CDE = 'DC'                          12870000
099140                 MOVE XL071-LOC-NM  TO H1-DC-NAME                 12880000
099141                                       H1-EC-DC-NAME              12890000
099142             ELSE                                                 12900000
099143                 MOVE PC-DC-NAME-NOT-FOUND                        12910000
099144                                    TO H1-DC-NAME                 12920000
099145                                       H1-EC-DC-NAME              12930000
099146             END-IF                                               12940000
099147                                                                  12950000
099148         WHEN XL071-LOC-NOT-FOUND                                 12960000
099149             MOVE PC-DC-NAME-NOT-FOUND                            12970000
099150                                    TO H1-DC-NAME                 12980000
099151                                       H1-EC-DC-NAME              12990000
099156                                                                  13000000
099157         WHEN XL071-SQLCODE-N = -904                              13010000
099158         WHEN XL071-SQLCODE-N = -913                              13020000
099159             CONTINUE                                             13030000
099160                                                                  13040000
099161         WHEN OTHER                                               13050000
099165             MOVE '0320-DC-NAME'    TO DP013-PARAGRAPH            13060000
099166             MOVE 'CALL TO XLUT071'                               13070000
099167                                    TO DP013-MESSAGE-TEXT (1)     13080000
099168             MOVE XL071-SQLCODE-N   TO SQLCODE                    13090000
099169             MOVE XL071-SQLCA       TO DP013-SQLCA                13100000
099170             MOVE 'XLT_LOC'         TO DP013-DB2-TABLE-NAME (1)   13110000
099171             SET DP013-DB2-ABEND    TO TRUE                       13120000
099172             SET DP013-XCTL-DISPLAY-RESTART                       13130000
099173                                    TO TRUE                       13140000
099174             PERFORM 9999-ABEND                                   13150000
099175         END-EVALUATE.                                            13160000
099177                                                                  13170000
099191*----------------------------------------------------------------*13180000
099192*    CONTROL THE COLLECTION OF ALL INFORMATION TO BE PRINTED     *13190000
099200*    ON THE REPORT.                                              *13200000
099300*----------------------------------------------------------------*13210000
099400                                                                  13220000
099500 1000-CREATE-REPORT.                                              13230000
099600                                                                  13240000
099700     MOVE RECEIV-OPER-UNT-ID     TO DK-OPER-UNT-ID.               13250000
W38216     IF XL071-E-BUS-IND = 'Y'                                     13260000
W38216        AND XL071-LOC-TYP-CDE = 'DC'                              13270000
W38216         SET PS-EC-EFC-FOUND     TO TRUE                          13280000
W38216     END-IF                                                       13290000
099800     MOVE RECEIV-FCLTY-ID        TO DK-FCLTY-ID.                  13300000
099900     MOVE SHPTPO-PO-NBR          TO DK-ORD-NBR                    13310000
100000                                    DK-PO-NBR.                    13320000
100100     MOVE SHPTPO-REC-SEQ-NBR     TO DK-REC-SEQ-NBR.               13330000
100200                                                                  13340000
100300     PERFORM 3010-GET-PO-INFO.                                    13350000
100400     IF  SQLCODE = +100                                           13360000
100500         MOVE SPACES             TO ENTNME-ENT-NAME-DESC          13370000
100600*        MOVE SHPTPO-VEND-NAME   TO ENTNME-ENT-NAME-DESC          13380000
100700     END-IF.                                                      13390000
100800     PERFORM 3000-GET-SU-INFO.                                    13400000
100900     MOVE PV-COUNT-SU-RECORDS TO D1-RECV-COUNT.                   13410000
101000                                                                  13420000
101100     PERFORM 3200-GET-PURITM-DATA.                                13430000
101200                                                                  13440000
101300     PERFORM 3300-LOOK-FOR-TROUBLE.                               13450000
101400                                                                  13460000
101500     PERFORM 3400-GET-SHIPMENT-INFO.                              13470000
101600                                                                  13480000
101700     PERFORM 1100-FORMAT-REPORT.                                  13490000
101800                                                                  13500000
101900     PERFORM 9000-PUT-LINE-TO-DRS.                                13510000
102000                                                                  13520000
102100     PERFORM 4100-FETCH-RCVR-PO-CSR.                              13530000
102200                                                                  13540000
102210 1010-CREATE-EC-REPORT.                                           13550000
102220                                                                  13560000
102230     MOVE RECEIV-OPER-UNT-ID     TO DK-OPER-UNT-ID.               13570000
W38216     IF PS-EC-EFC-FOUND                                           13580000
102250         PERFORM 1011-FORMAT-EC-REPORT                            13590000
102251         ADD PC-1               TO PA-RCVR-CNT                    13600000
102260     END-IF.                                                      13610000
102261     PERFORM 4100-FETCH-RCVR-PO-CSR.                              13620000
102262                                                                  13630000
102263 1011-FORMAT-EC-REPORT.                                           13640000
102270     MOVE RECEIV-FCLTY-ID        TO DK-FCLTY-ID.                  13650000
102280     MOVE SHPTPO-PO-NBR          TO DK-ORD-NBR                    13660000
102290                                    DK-PO-NBR                     13670000
102291                                    D5-PO-NBR.                    13680000
102292     MOVE SHPTPO-REC-SEQ-NBR     TO DK-REC-SEQ-NBR                13690000
102293                                    D5-REC-SEQ-NBR.               13700000
102294     MOVE RECEIV-PACK-BY-ST-IND  TO D5-PBS-IND                    13710000
102295     MOVE RECEIV-PRE-TKT-IND     TO D5-PRETICKET-IND              13720000
102296     MOVE RECEIV-GOH-IND         TO D5-HANGER-IND                 13730000
102297     EVALUATE TRUE                                                13740000
102298     WHEN RECEIV-PKGNG-CDE      = 'B'                             13750000
102299         MOVE 'BULK'             TO D5-PACK-TYPE                  13760000
102300     WHEN RECEIV-PKGNG-CDE = 'C'                                  13770000
102301         MOVE 'CASE'             TO D5-PACK-TYPE                  13780000
102302     WHEN RECEIV-PKGNG-CDE = 'I'                                  13790000
102303         MOVE 'INNER'            TO D5-PACK-TYPE                  13800000
102304     WHEN RECEIV-PKGNG-CDE = 'M'                                  13810000
102305         MOVE 'MULTI'            TO D5-PACK-TYPE                  13820000
102306     WHEN RECEIV-PKGNG-CDE = 'S'                                  13830000
102307         MOVE 'SINGLE'           TO D5-PACK-TYPE                  13840000
102308     WHEN OTHER                                                   13850000
102309         MOVE SPACES             TO D5-PACK-TYPE                  13860000
102310     END-EVALUATE.                                                13870000
102311                                                                  13880000
102312     PERFORM 3010-GET-PO-INFO.                                    13890000
102313     IF  SQLCODE = ZERO                                           13900000
102314         MOVE ENTNME-ENT-NAME-DESC                                13910000
102315                                 TO D5-VEND-NAME                  13920000
102316     ELSE                                                         13930000
102317         MOVE SPACES             TO D5-VEND-NAME                  13940000
102318     END-IF.                                                      13950000
102319                                                                  13960000
102320     PERFORM 3200-GET-PURITM-DATA.                                13970000
102321                                                                  13980000
102330     IF SQLCODE = ZERO                                            13990000
102332         IF PS-CALL-API-YES                                       14000000
102333            PERFORM 3500-CALL-CICS-API-ARCH                       14010000
102334         END-IF                                                   14020000
102343     ELSE                                                         14030000
102344         MOVE '01'                TO PV-EC-ERROR-CD               14040000
102345         MOVE PV-EC-STORAGE-MSG   TO D5-STORAGE-TYPE              14050000
102346     END-IF                                                       14060000
102347                                                                  14070000
102348     IF PA-LINE-CNT > PC-LINE-MAX                                 14080000
102349         PERFORM 1400-FORMAT-EC-HEADER-LINES                      14090000
102350     END-IF.                                                      14100000
102351                                                                  14110000
102352     MOVE D5-DETAIL-LINE5        TO DRS01-COMM-DATA.              14120000
102353     MOVE PC-SPACE2              TO DRS01-COMM-CTL.               14130000
102354     MOVE SA-REPORT-ID           TO DRS01-DRRB-RID.               14140000
102355     ADD  2                      TO PA-LINE-CNT.                  14150000
102356     PERFORM 9000-PUT-LINE-TO-DRS.                                14160000
102357                                                                  14170000
102360/                                                                 14180000
102400*----------------------------------------------------------------*14190000
102500*    SETS UP DRS CALL AND PRINTS THE LINE                        *14200000
102600*----------------------------------------------------------------*14210000
102700                                                                  14220000
102800 1100-FORMAT-REPORT.                                              14230000
102900                                                                  14240000
103000     IF PA-LINE-CNT > PC-LINE-MAX                                 14250000
103100         PERFORM 1200-FORMAT-HEADER-LINES                         14260000
103200     END-IF.                                                      14270000
103300                                                                  14280000
103400     MOVE SHPTPO-REC-SEQ-NBR     TO D1-REC-SEQ-NBR.               14290000
103500     MOVE SHPTPO-PO-NBR          TO D1-PO-NBR.                    14300000
103600     MOVE PURCHS-DEPT-NBR        TO D1-DEPT.                      14310000
103800     MOVE RECEIV-PKGNG-CDE       TO D1-PKGNG-CDE.                 14320000
103900     MOVE PURCHS-SEASET-SHRT-NM  TO D1-SEASON-SET.                14330000
104000     MOVE ENTNME-ENT-NAME-DESC   TO D1-VEND-NAME.                 14340000
104100*    MOVE SHPTPO-EXPTED-CART-CNT TO D1-CART-CNT.                  14350000
104200*    ADD  SHPTPO-EXPTED-CART-CNT TO PA-CART-CNT.                  14360000
104300     MOVE RECEIV-EXPTED-CART-CNT TO D1-CART-CNT.                  14370000
104400     ADD  RECEIV-EXPTED-CART-CNT TO PA-CART-CNT.                  14380000
104500                                                                  14390000
104600     MOVE D1-DETAIL-LINE1        TO DRS01-COMM-DATA.              14400000
104700     MOVE PC-SPACE2              TO DRS01-COMM-CTL.               14410000
104800     MOVE SA-REPORT-ID           TO DRS01-DRRB-RID.               14420000
104900     ADD  2                      TO PA-LINE-CNT.                  14430000
105000                                                                  14440000
105100 1150-FORMAT-BARCODE.                                             14450000
105200***  BARCODE CODING                                               14460000
105300     IF CA-PRTR-BARCODE-IND = 'Y'                                 14470000
105400         MOVE '^PY^-'                 TO DRS01-COMM-DATA          14480000
105500         MOVE PC-SINGLE-SPACE         TO DRS01-COMM-CTL           14490000
105600         PERFORM 9000-PUT-LINE-TO-DRS                             14500000
105700                                                                  14510000
105800*        IF THE PRINTER IS A FORMS-PRO PRINTER, SET FREE-FORM     14520000
105900         IF CA-PRTR-PRTR-CNTL-IND = 'P'                           14530000
106000             MOVE DS004-PLC-ACTIVATE-FF-PROC                      14540000
106100                                      TO  DRS01-COMM-DATA         14550000
106200             MOVE PC-SINGLE-SPACE     TO  DRS01-COMM-CTL          14560000
106300             PERFORM 9000-PUT-LINE-TO-DRS                         14570000
106400         END-IF                                                   14580000
106500                                                                  14590000
106600         MOVE TL-TRIP-LINE            TO  DRS01-COMM-DATA         14600000
106700         MOVE PC-SINGLE-SPACE         TO  DRS01-COMM-CTL          14610000
106800         PERFORM 9000-PUT-LINE-TO-DRS                             14620000
106900                                                                  14630000
107000         MOVE CA-TRIP-ID              TO TL-BARCODE-TRIP-ID       14640000
107100                                         TL-BARCODE-TRIP-ID-1     14650000
107200         MOVE TL-BARCODE-LINE         TO DRS01-COMM-DATA          14660000
107300         MOVE PC-SINGLE-SPACE         TO DRS01-COMM-CTL           14670000
107400         PERFORM 9000-PUT-LINE-TO-DRS                             14680000
107500                                                                  14690000
107600         MOVE TL2-TOTAL-LINE-2        TO  DRS01-COMM-DATA         14700000
107700         MOVE PC-SINGLE-SPACE         TO  DRS01-COMM-CTL          14710000
107800         PERFORM 9000-PUT-LINE-TO-DRS                             14720000
107900                                                                  14730000
108000         IF CA-PRTR-PRTR-CNTL-IND = 'P'                           14740000
108100             MOVE DS004-PLC-DEACTIVATE-FF-PROC                    14750000
108200                                      TO  DRS01-COMM-DATA         14760000
108300             MOVE PC-SINGLE-SPACE     TO  DRS01-COMM-CTL          14770000
108400             PERFORM 9000-PUT-LINE-TO-DRS                         14780000
108500                                                                  14790000
108600             MOVE DS004-PLC-DEACTIVATE-IMAGE                      14800000
108700                                      TO DRS01-COMM-DATA          14810000
108800         ELSE                                                     14820000
108900             MOVE '^PN^-'             TO DRS01-COMM-DATA          14830000
109000         END-IF                                                   14840000
109100         MOVE PC-SINGLE-SPACE         TO DRS01-COMM-CTL           14850000
109200         PERFORM 9000-PUT-LINE-TO-DRS                             14860000
109300     ELSE                                                         14870000
109400         MOVE SPACES                  TO TL-TRIP-LINE-NO-BARCODE  14880000
109500         MOVE TL-TRANSLATED-TEXT      TO TL-TRANSLATED-TEXT-NB    14890000
109600         MOVE TL-TRIP-LINE-NO-BARCODE TO DRS01-COMM-DATA          14900000
109700         MOVE PC-SINGLE-SPACE         TO DRS01-COMM-CTL           14910000
109800         PERFORM 9000-PUT-LINE-TO-DRS                             14920000
109900                                                                  14930000
110000         MOVE CA-TRIP-ID              TO TL-BARCODE-TRIP-ID       14940000
110100                                         TL-BARCODE-TRIP-ID-1     14950000
110200         MOVE SPACES                  TO TL-TRIP-LINE-NO-BARCODE  14960000
110300                                                                  14970000
110400         MOVE TL2-TRANSLATED-TEXT     TO TL-TRANSLATED-TEXT-NB    14980000
110500         MOVE TL-TRIP-LINE-NO-BARCODE TO DRS01-COMM-DATA          14990000
110600         MOVE PC-SINGLE-SPACE         TO DRS01-COMM-CTL           15000000
110700         PERFORM 9000-PUT-LINE-TO-DRS                             15010000
110800     END-IF.                                                      15020000
110900                                                                  15030000
111000***  BARCODE CODING                                               15040000
111100                                                                  15050000
111200                                                                  15060000
111300*----------------------------------------------------------------*15070000
111400*    FORMAT AND PRINT HEADING LINES                              *15080000
111500*----------------------------------------------------------------*15090000
111600                                                                  15100000
111700 1200-FORMAT-HEADER-LINES.                                        15110000
111800                                                                  15120000
111900     IF PS-FIRST-HEADER                                           15130000
112000         SET PS-NOT-FIRST-HEADER TO TRUE                          15140000
112100     ELSE                                                         15150000
112200         IF PS-FIRST-PAGE                                         15160000
112300             SET PS-NOT-FIRST-PAGE TO TRUE                        15170000
112400             PERFORM 1150-FORMAT-BARCODE                          15180000
112500         END-IF                                                   15190000
112600     END-IF.                                                      15200000
112700                                                                  15210000
112800     ADD 1                       TO PA-PAGE-NBR.                  15220000
112900     MOVE PA-PAGE-NBR            TO DP108O-PAGE-NUMBER.           15230000
113000     MOVE PC-PROG-NAME           TO DP108O-PROGRAM-NAME.          15240000
113100     MOVE PC-1                   TO DP108O-REPORT-NUMBER.         15250000
113200     MOVE DP108O-STANDRD-HEADER-108-COLS                          15260000
113300                                 TO DRS01-COMM-DATA.              15270000
113400     MOVE PC-PAGE                TO DRS01-COMM-CTL.               15280000
113500     MOVE SA-REPORT-ID           TO DRS01-DRRB-RID.               15290000
113600                                                                  15300000
113700     PERFORM 9000-PUT-LINE-TO-DRS.                                15310000
113800                                                                  15320000
113900     MOVE H1-HEADING-LINE1       TO DRS01-COMM-DATA.              15330000
114000     MOVE PC-SPACE1              TO DRS01-COMM-CTL.               15340000
114100     MOVE SA-REPORT-ID           TO DRS01-DRRB-RID.               15350000
114200                                                                  15360000
114300     PERFORM 9000-PUT-LINE-TO-DRS.                                15370000
114400                                                                  15380000
114500     MOVE CA-OWNER-SCAC-ID       TO H2-CARRIER.                   15390000
114600     MOVE CA-VEH-NBR             TO H2-TRAILER.                   15400000
114700                                                                  15410000
114800     MOVE H2-HEADING-LINE2       TO DRS01-COMM-DATA.              15420000
114900     MOVE PC-SPACE2              TO DRS01-COMM-CTL.               15430000
115000     MOVE SA-REPORT-ID           TO DRS01-DRRB-RID.               15440000
115100                                                                  15450000
115200     PERFORM 9000-PUT-LINE-TO-DRS.                                15460000
115300                                                                  15470002
115400     IF PS-NOT-MULTIPLE                                           15480000
115500         MOVE H3-HEADING-LINE3       TO DRS01-COMM-DATA           15490000
115600         MOVE PC-SPACE2              TO DRS01-COMM-CTL            15500000
115700         MOVE SA-REPORT-ID           TO DRS01-DRRB-RID            15510000
115800                                                                  15520000
115900         PERFORM 9000-PUT-LINE-TO-DRS                             15530000
116000                                                                  15540000
116100         MOVE H4-HEADING-LINE4       TO DRS01-COMM-DATA           15550000
116200         MOVE PC-SPACE1              TO DRS01-COMM-CTL            15560000
116300         MOVE SA-REPORT-ID           TO DRS01-DRRB-RID            15570000
116400                                                                  15580000
116500         PERFORM 9000-PUT-LINE-TO-DRS                             15590000
116600     ELSE                                                         15600000
116700         MOVE H5-HEADING-LINE5       TO DRS01-COMM-DATA           15610000
116800         MOVE PC-SPACE2              TO DRS01-COMM-CTL            15620000
116900         MOVE SA-REPORT-ID           TO DRS01-DRRB-RID            15630000
117000                                                                  15640000
117100         PERFORM 9000-PUT-LINE-TO-DRS                             15650000
117200                                                                  15660000
117300         MOVE H6-HEADING-LINE6       TO DRS01-COMM-DATA           15670000
117400         MOVE PC-SPACE1              TO DRS01-COMM-CTL            15680000
117500         MOVE SA-REPORT-ID           TO DRS01-DRRB-RID            15690000
117600                                                                  15700000
117700         PERFORM 9000-PUT-LINE-TO-DRS                             15710000
117800     END-IF.                                                      15720000
117900                                                                  15730000
118000     MOVE 7                      TO PA-LINE-CNT.                  15740000
118100                                                                  15750000
118200                                                                  15760000
118300*----------------------------------------------------------------*15770000
118400*    FORMAT AND PRINT HEADING LINES - FOR BLANK PAGE             *15780000
118500*----------------------------------------------------------------*15790000
118600                                                                  15800000
118700 1300-FORMAT-HEADER-LINES.                                        15810000
118800                                                                  15820000
118900     ADD 1                       TO PA-PAGE-NBR.                  15830000
119000     MOVE PA-PAGE-NBR            TO DP108O-PAGE-NUMBER.           15840000
119100     MOVE PC-PROG-NAME           TO DP108O-PROGRAM-NAME.          15850000
119200     MOVE PC-1                   TO DP108O-REPORT-NUMBER.         15860000
119300     MOVE DP108O-STANDRD-HEADER-108-COLS                          15870000
119400                                 TO DRS01-COMM-DATA.              15880000
119500     MOVE PC-PAGE                TO DRS01-COMM-CTL.               15890000
119600     MOVE SA-REPORT-ID           TO DRS01-DRRB-RID.               15900000
119700                                                                  15910000
119800     PERFORM 9000-PUT-LINE-TO-DRS.                                15920000
119900                                                                  15930000
120000     MOVE H1-HEADING-LINE1       TO DRS01-COMM-DATA.              15940000
120100     MOVE PC-SPACE1              TO DRS01-COMM-CTL.               15950000
120200     MOVE SA-REPORT-ID           TO DRS01-DRRB-RID.               15960000
120300                                                                  15970000
120400     PERFORM 9000-PUT-LINE-TO-DRS.                                15980000
120500                                                                  15990000
120600     MOVE CA-OWNER-SCAC-ID       TO H2-CARRIER.                   16000000
120700     MOVE CA-VEH-NBR             TO H2-TRAILER.                   16010000
120800                                                                  16020000
120900     MOVE H2-HEADING-LINE2       TO DRS01-COMM-DATA.              16030000
121000     MOVE PC-SPACE2              TO DRS01-COMM-CTL.               16040000
121100     MOVE SA-REPORT-ID           TO DRS01-DRRB-RID.               16050000
121200                                                                  16060000
121300     PERFORM 9000-PUT-LINE-TO-DRS.                                16070000
121400                                                                  16080000
121500     MOVE H7-HEADING-LINE7       TO DRS01-COMM-DATA               16090000
121600     MOVE PC-SPACE2              TO DRS01-COMM-CTL                16100000
121700     MOVE SA-REPORT-ID           TO DRS01-DRRB-RID                16110000
121800                                                                  16120000
121900     PERFORM 9000-PUT-LINE-TO-DRS                                 16130000
122000                                                                  16140000
122100     MOVE H8-HEADING-LINE8       TO DRS01-COMM-DATA               16150000
122200     MOVE PC-SPACE1              TO DRS01-COMM-CTL                16160000
122300     MOVE SA-REPORT-ID           TO DRS01-DRRB-RID                16170000
122400                                                                  16180000
122500     PERFORM 9000-PUT-LINE-TO-DRS                                 16190000
122600                                                                  16200000
122700     MOVE 7                      TO PA-LINE-CNT.                  16210000
122800                                                                  16220000
122900*----------------------------------------------------------------*16230000
123000*    FORMAT AND PRINT EC HEADING LINES                           *16240000
123100*----------------------------------------------------------------*16250000
123200                                                                  16260000
123300 1400-FORMAT-EC-HEADER-LINES.                                     16270000
123400                                                                  16280000
124400     ADD 1                       TO PA-PAGE-NBR.                  16290000
124500     MOVE PA-PAGE-NBR            TO DP108O-PAGE-NUMBER.           16300000
124600     MOVE PC-PROG-NAME           TO DP108O-PROGRAM-NAME.          16310000
124700     MOVE PC-2                   TO DP108O-REPORT-NUMBER.         16320000
124800     MOVE DP108O-STANDRD-HEADER-108-COLS                          16330000
124900                                 TO DRS01-COMM-DATA.              16340000
125000     MOVE PC-PAGE                TO DRS01-COMM-CTL.               16350000
125100     MOVE SA-REPORT-ID           TO DRS01-DRRB-RID.               16360000
125200                                                                  16370000
125300     PERFORM 9000-PUT-LINE-TO-DRS.                                16380000
125400                                                                  16390000
125500     MOVE H1-EC-HEADING-LINE1    TO DRS01-COMM-DATA.              16400000
125600     MOVE PC-SPACE1              TO DRS01-COMM-CTL.               16410000
125700     MOVE SA-REPORT-ID           TO DRS01-DRRB-RID.               16420000
125800                                                                  16430000
125900     PERFORM 9000-PUT-LINE-TO-DRS.                                16440000
126000                                                                  16450000
126100     MOVE CA-OWNER-SCAC-ID       TO H2-CARRIER.                   16460000
126200     MOVE CA-VEH-NBR             TO H2-TRAILER.                   16470000
126300                                                                  16480000
126400     MOVE H2-HEADING-LINE2       TO DRS01-COMM-DATA.              16490000
126500     MOVE PC-SPACE2              TO DRS01-COMM-CTL.               16500000
126600     MOVE SA-REPORT-ID           TO DRS01-DRRB-RID.               16510000
126700                                                                  16520000
126800     PERFORM 9000-PUT-LINE-TO-DRS.                                16530000
126900                                                                  16540000
127100     MOVE H9-HEADING-LINE9       TO DRS01-COMM-DATA               16550000
127200     MOVE PC-SPACE2              TO DRS01-COMM-CTL                16560000
127300     MOVE SA-REPORT-ID           TO DRS01-DRRB-RID                16570000
127400                                                                  16580000
127500     PERFORM 9000-PUT-LINE-TO-DRS                                 16590000
127600                                                                  16600000
127700     MOVE H10-HEADING-LINE10     TO DRS01-COMM-DATA               16610000
127800     MOVE PC-SPACE1              TO DRS01-COMM-CTL                16620000
127900     MOVE SA-REPORT-ID           TO DRS01-DRRB-RID                16630000
128000                                                                  16640000
128100     PERFORM 9000-PUT-LINE-TO-DRS                                 16650000
129500                                                                  16660000
129600     MOVE 7                      TO PA-LINE-CNT.                  16670000
129700                                                                  16680000
130900/                                                                 16690000
131000*----------------------------------------------------------------*16700000
131100*    GET SHIPMENT UNIT INFO                                      *16710000
131200*----------------------------------------------------------------*16720000
131300 3000-GET-SU-INFO.                                                16730000
131400                                                                  16740000
131500     INITIALIZE PV-COUNT-SU-RECORDS.                              16750000
131600     EXEC SQL                                                     16760000
131700         SELECT COUNT(*)                                          16770000
131800          INTO  :PV-COUNT-SU-RECORDS :PV-COUNT-IND                16780000
131900           FROM TPKSLIP A,                                        16790000
132000                TINPKSU B                                         16800000
132100          WHERE A.PO_NBR          = :DK-PO-NBR                    16810000
132200            AND A.PO_NBR          = B.PO_NBR                      16820000
132300            AND A.REC_SEQ_NBR     = :DK-REC-SEQ-NBR               16830000
132400            AND A.VER_STAT_CDE    = :PC-ACTIVE                    16840000
132500            AND A.SEQ_NBR         = B.SEQ_NBR                     16850000
132600     END-EXEC                                                     16860000
132700                                                                  16870000
132800     EVALUATE TRUE                                                16880000
132900         WHEN SQLCODE = ZERO                                      16890000
133000              CONTINUE                                            16900000
133100         WHEN SQLWARN0 NOT = SPACES                               16910000
133200         WHEN SQLCODE  NOT = ZERO                                 16920000
133300              MOVE '3000-GET-SU-INFO'                             16930000
133400                             TO DP013-PARAGRAPH                   16940000
133500              MOVE 'UNSUCCESSFUL COUNT OF TPKSLIP'                16950000
133600                             TO DP013-MESSAGE-TEXT (1)            16960000
133700              MOVE SQLCA     TO DP013-SQLCA                       16970000
133800              MOVE 'TPKSLIP' TO DP013-DB2-TABLE-NAME (1)          16980000
133900              MOVE 'TINPKSU' TO DP013-DB2-TABLE-NAME (2)          16990000
134000              SET DP013-DB2-ABEND                                 17000000
134100                  DP013-XCTL-DISPLAY-RESTART                      17010000
134200                             TO TRUE                              17020000
134300              PERFORM 9999-ABEND                                  17030000
134400     END-EVALUATE.                                                17040000
134500                                                                  17050000
134600/                                                                 17060000
134700*----------------------------------------------------------------*17070000
134800*    GET PURCHASE ORDER INFO                                     *17080000
134900*----------------------------------------------------------------*17090000
135000 3010-GET-PO-INFO.                                                17100000
135100                                                                  17110000
135200     PERFORM                                                      17120000
135300         WITH TEST AFTER                                          17130000
135400         VARYING PV-RETRY-COUNTER                                 17140000
135500         FROM 1 BY 1                                              17150000
135600         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               17160000
135700            OR (SQLCODE = +0)                                     17170000
135800            OR (SQLCODE = +100))                                  17180000
135900                                                                  17190000
136000         EXEC SQL                                                 17200000
136100            SELECT  A.DEPT_NBR                                    17210000
136300                   ,A.SEASET_SHRT_NM                              17220000
136400                   ,B.ENT_NAME_DESC                               17230000
136500              INTO :PURCHS-DEPT-NBR                               17240000
136700                  ,:PURCHS-SEASET-SHRT-NM                         17250000
136800                  ,:ENTNME-ENT-NAME-DESC                          17260000
136900              FROM  TPURCHS A                                     17270000
137000                   ,TENTNME B                                     17280000
137100          WHERE A.PO_NBR         = :DK-PO-NBR                     17290000
137200            AND A.VER_STATUS_CDE = 'A'                            17300000
137300            AND B.TYPE_CDE       = '01'                           17310000
137400            AND A.ENT_ID = B.ENT_ID                               17320000
137500         END-EXEC                                                 17330000
137600                                                                  17340000
137700         EVALUATE TRUE                                            17350000
137701             WHEN SQLCODE = +0                                    17360000
137702             WHEN SQLCODE = -904                                  17370000
137703             WHEN SQLCODE = -913                                  17380000
137704                 CONTINUE                                         17390000
137705                                                                  17400000
137710             WHEN SQLCODE = +100                                  17410000
137720                 MOVE SPACES TO PURCHS-DEPT-NBR                   17420000
137730                                                                  17430000
138400             WHEN SQLWARN0 NOT = SPACE                            17440000
138500             WHEN SQLCODE < +0                                    17450000
138600             WHEN SQLCODE > +0                                    17460000
138700                 MOVE '3010-GET-PO-INFO'                          17470000
138800                                 TO DP013-PARAGRAPH               17480000
138900                 MOVE 'SELECT ON TPURCHS'                         17490000
139000                                 TO DP013-MESSAGE-TEXT (1)        17500000
139100                 MOVE SQLCA      TO DP013-SQLCA                   17510000
139200                 MOVE 'TPURCHS'  TO DP013-DB2-TABLE-NAME (1)      17520000
139300                 MOVE 'TENTNME'  TO DP013-DB2-TABLE-NAME (2)      17530000
139400                 SET DP013-DB2-ABEND                              17540000
139500                                 TO TRUE                          17550000
139600                 SET DP013-XCTL-DISPLAY-RESTART                   17560000
139700                                 TO TRUE                          17570000
139800                 PERFORM 9999-ABEND                               17580000
139900         END-EVALUATE                                             17590000
140000     END-PERFORM.                                                 17600000
140100                                                                  17610000
140200     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    17620000
140300         SQLCODE NOT = +0                                         17630000
140400         MOVE '3010-GET-PO-INFO'                                  17640000
140500                                 TO DP013-PARAGRAPH               17650000
140600         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     17660000
140700                                 TO DP013-MESSAGE-TEXT (1)        17670000
140800         MOVE 'PURCHASE ORDER INFO'                               17680000
140900                                 TO DP013-MESSAGE-TEXT (2)        17690000
141000         MOVE SQLCA              TO DP013-SQLCA                   17700000
141100         MOVE 'TPURCHS'          TO DP013-DB2-TABLE-NAME (1)      17710000
141200         MOVE 'TENTNME'          TO DP013-DB2-TABLE-NAME (2)      17720000
141300         SET DP013-DB2-ABEND     TO TRUE                          17730000
141400         SET DP013-XCTL-DISPLAY-RESTART                           17740000
141500                                 TO TRUE                          17750000
141600         PERFORM 9999-ABEND                                       17760000
141700     END-IF.                                                      17770000
141800                                                                  17780000
141900/                                                                 17790000
142000*----------------------------------------------------------------*17800000
142100*    GET THE ITEM NUMBER                                        * 17810000
142200*----------------------------------------------------------------*17820000
142300 3200-GET-PURITM-DATA.                                            17830000
142400                                                                  17840000
142500     PERFORM                                                      17850000
142600         WITH TEST AFTER                                          17860000
142700         VARYING PV-RETRY-COUNTER                                 17870000
142800         FROM 1 BY 1                                              17880000
142900         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               17890000
143000             OR (SQLCODE = +0)                                    17900000
143100             OR (SQLCODE = +100))                                 17910000
143200                                                                  17920000
143300         EXEC SQL                                                 17930000
143420              SELECT A.ITM_NBR                                    17940000
143520                INTO :DK-ITEM-NBR                                 17950000
143600                FROM TPURITM A                                    17960000
143700               WHERE A.PO_NBR         = :DK-PO-NBR                17970000
143800                 AND A.VER_STATUS_CDE = 'A'                       17980000
143900                 AND A.PO_LNE_NBR =                               17990000
144000                  (SELECT MIN(B.PO_LNE_NBR)                       18000000
144100                    FROM TPURITM B                                18010000
144200                   WHERE B.PO_NBR = A.PO_NBR                      18020000
144300                     AND B.VER_STATUS_CDE = 'A')                  18030000
144400         END-EXEC                                                 18040000
144500                                                                  18050000
144600         EVALUATE TRUE                                            18060000
144700             WHEN SQLCODE = +0                                    18070000
144900                 SET PS-CALL-API-YES TO TRUE                      18080000
145000             WHEN SQLCODE = +100                                  18090000
145100             WHEN SQLCODE = -904                                  18100000
145200             WHEN SQLCODE = -913                                  18110000
145300                  CONTINUE                                        18120000
145400                                                                  18130000
145500             WHEN SQLWARN0 NOT = SPACES                           18140000
145600             WHEN SQLCODE < +0                                    18150000
145700             WHEN SQLCODE > +0                                    18160000
145800                  MOVE '3200-GET-PURITM-DATA'                     18170000
145900                                  TO DP013-PARAGRAPH              18180000
146000                  MOVE 'UNSUCCESSFUL SELECT ON TPURITM'           18190000
146100                                  TO DP013-MESSAGE-TEXT (1)       18200000
146200                  MOVE SQLCA      TO DP013-SQLCA                  18210000
146300                  MOVE 'TPURITM ' TO DP013-DB2-TABLE-NAME (1)     18220000
146400                  SET DP013-DB2-ABEND                             18230000
146500                      DP013-XCTL-DISPLAY-RESTART                  18240000
146600                                  TO TRUE                         18250000
146700                  PERFORM 9999-ABEND                              18260000
146800         END-EVALUATE                                             18270000
146900     END-PERFORM.                                                 18280000
147050*                                                                 18290000
147100     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    18300000
147200         SQLCODE NOT = +0                                         18310000
147300         MOVE '3200-GET-PURITM-DATA '                             18320000
147400                                  TO DP013-PARAGRAPH              18330000
147500         MOVE 'MAX RETRIES EXCEEDED ON SELECT TPURITM'            18340000
147600                                  TO DP013-MESSAGE-TEXT (1)       18350000
147700         MOVE SQLCA               TO DP013-SQLCA                  18360000
147800         MOVE 'TPURITM '          TO DP013-DB2-TABLE-NAME (1)     18370000
147900         SET DP013-DB2-ABEND                                      18380000
148000             DP013-XCTL-DISPLAY-RESTART                           18390000
148100                                  TO TRUE                         18400000
148200         PERFORM 9999-ABEND                                       18410000
148300     END-IF.                                                      18420000
148400                                                                  18430000
148500/                                                                 18440000
148600 3300-LOOK-FOR-TROUBLE.                                           18450000
148700                                                                  18460000
148800     PERFORM                                                      18470000
148900         WITH TEST AFTER                                          18480000
149000         VARYING PV-RETRY-COUNTER                                 18490000
149100         FROM 1 BY 1                                              18500000
149200         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               18510000
149300            OR (SQLCODE = +0 OR +100 OR -811))                    18520000
149400                                                                  18530000
149500         EXEC SQL                                                 18540000
149600             SELECT B.TRBL_SHT_DESC                               18550000
149700             INTO :TRBRSN-TRBL-SHT-DESC                           18560000
149800             FROM  TTRBNTF A                                      18570000
149900                  ,TTRBRSN B                                      18580000
150000             WHERE A.PO_NBR           = :SHPTPO-PO-NBR            18590000
150100                   AND A.REC_SEQ_NBR  = :SHPTPO-REC-SEQ-NBR       18600000
150200                   AND A.RESOLVED_IND IN (:PC-N, :PC-I)           18610000
150300                   AND A.TRBL_RSN_CDE = B.TRBL_RSN_CDE            18620000
150400         END-EXEC                                                 18630000
150500                                                                  18640000
150600         EVALUATE TRUE                                            18650000
150700             WHEN SQLCODE = +0                                    18660000
150800                 MOVE TRBRSN-TRBL-SHT-DESC TO D1-TRBL-STAT        18670000
150900                 MOVE SPACE                TO D1-TRBL-STAT-ADDL   18680000
151000             WHEN SQLCODE = -811                                  18690000
151100                 MOVE TRBRSN-TRBL-SHT-DESC TO D1-TRBL-STAT        18700000
151200                 MOVE '*'                  TO D1-TRBL-STAT-ADDL   18710000
151300             WHEN SQLCODE = +100                                  18720000
151400                 MOVE SPACES               TO D1-TRBL-STAT        18730000
151500                                              D1-TRBL-STAT-ADDL   18740000
151600             WHEN SQLCODE = -904                                  18750000
151700             WHEN SQLCODE = -913                                  18760000
151800                 CONTINUE                                         18770000
151900                                                                  18780000
152000             WHEN SQLWARN0 NOT = SPACE                            18790000
152100             WHEN SQLCODE < ZERO                                  18800000
152200             WHEN SQLCODE > ZERO                                  18810000
152300                 MOVE '3300-LOOK-FOR-TROUBLE'                     18820000
152400                                 TO DP013-PARAGRAPH               18830000
152500                 MOVE 'SELECT ON TTRBNTF/TTRBRSN'                 18840000
152600                                 TO DP013-MESSAGE-TEXT (1)        18850000
152700                 MOVE SQLCA      TO DP013-SQLCA                   18860000
152800                 MOVE 'TTRBNTF'  TO DP013-DB2-TABLE-NAME (1)      18870000
152900                 MOVE 'TTRBRSN'  TO DP013-DB2-TABLE-NAME (2)      18880000
153000                 SET DP013-DB2-ABEND                              18890000
153100                     DP013-XCTL-DISPLAY-RESTART                   18900000
153200                                 TO TRUE                          18910000
153300                  PERFORM 9999-ABEND                              18920000
153400         END-EVALUATE                                             18930000
153500     END-PERFORM.                                                 18940000
153600                                                                  18950000
153700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        18960000
153800             AND (SQLCODE = -904 OR -913)                         18970000
153900         MOVE '3300-LOOK-FOR-TROUBLE'                             18980000
154000                                 TO DP013-PARAGRAPH               18990000
154100         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     19000000
154200                                 TO DP013-MESSAGE-TEXT (1)        19010000
154300         MOVE 'ON TTRBNTF'       TO DP013-MESSAGE-TEXT (2)        19020000
154400         MOVE SQLCA              TO DP013-SQLCA                   19030000
154500         MOVE 'TTRBNTF'          TO DP013-DB2-TABLE-NAME (1)      19040000
154600         MOVE 'TTRBRSN'          TO DP013-DB2-TABLE-NAME (2)      19050000
154700         SET DP013-DB2-ABEND                                      19060000
154800             DP013-XCTL-DISPLAY-RESTART                           19070000
154900                                 TO TRUE                          19080000
155000         PERFORM 9999-ABEND                                       19090000
155100     END-IF.                                                      19100000
155200*----------------------------------------------------------------*19110000
155300*    GET SHIPMENT INFO                                           *19120000
155400*----------------------------------------------------------------*19130000
155500 3400-GET-SHIPMENT-INFO.                                          19140000
155600                                                                  19150000
155700     PERFORM                                                      19160000
155800         WITH TEST AFTER                                          19170000
155900         VARYING PV-RETRY-COUNTER                                 19180000
156000         FROM 1 BY 1                                              19190000
156100         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               19200000
156200            OR (SQLCODE = +0)                                     19210000
156300            OR (SQLCODE = +100)                                   19220000
156400            OR (SQLCODE = -811))                                  19230000
156500                                                                  19240000
156600         EXEC SQL                                                 19250000
156700            SELECT  B.PRO_NBR                                     19260000
156800                   ,B.BOL_NBR                                     19270000
156900                   ,B.VEND_SHIP_DTE                               19280000
157000              INTO :SHIPMT-PRO-NBR                                19290000
157100                  ,:SHIPMT-BOL-NBR                                19300000
157200                  ,:SHIPMT-VEND-SHIP-DTE                          19310000
157300              FROM  TSHPTPO A                                     19320000
157400                   ,TSHIPMT B                                     19330000
157500          WHERE A.PO_NBR      = :DK-PO-NBR                        19340000
157600            AND A.REC_SEQ_NBR = :DK-REC-SEQ-NBR                   19350000
157700            AND A.SHIPT_ID = B.SHIPT_ID                           19360000
157800         END-EXEC                                                 19370000
157900                                                                  19380000
158000         EVALUATE TRUE                                            19390000
158100             WHEN SQLCODE = +0                                    19400000
158200             WHEN SQLCODE = +100                                  19410000
158300             WHEN SQLCODE = -811                                  19420000
158400             WHEN SQLCODE = -904                                  19430000
158500             WHEN SQLCODE = -913                                  19440000
158600                 CONTINUE                                         19450000
158700                                                                  19460000
158800             WHEN SQLWARN0 NOT = SPACE                            19470000
158900             WHEN SQLCODE < +0                                    19480000
159000             WHEN SQLCODE > +0                                    19490000
159100                 MOVE '3400-GET-SHIPMENT-INFO'                    19500000
159200                                 TO DP013-PARAGRAPH               19510000
159300                 MOVE 'SELECT ON TSHPTPO/TSHIPMT'                 19520000
159400                                 TO DP013-MESSAGE-TEXT (1)        19530000
159500                 MOVE SQLCA      TO DP013-SQLCA                   19540000
159600                 MOVE 'TSHIPMT'  TO DP013-DB2-TABLE-NAME (1)      19550000
159700                 MOVE 'TSHPTPO'  TO DP013-DB2-TABLE-NAME (2)      19560000
159800                 SET DP013-DB2-ABEND                              19570000
159900                     DP013-XCTL-DISPLAY-RESTART                   19580000
160000                                 TO TRUE                          19590000
160100                  PERFORM 9999-ABEND                              19600000
160200         END-EVALUATE                                             19610000
160300     END-PERFORM.                                                 19620000
160400                                                                  19630000
160500     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        19640000
160600             AND (SQLCODE = -904 OR -913)                         19650000
160700         MOVE '3400-GET-SHIPMENT-INFO'                            19660000
160800                                 TO DP013-PARAGRAPH               19670000
160900         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     19680000
161000                                 TO DP013-MESSAGE-TEXT (1)        19690000
161100         MOVE 'ON TSHIPMT'       TO DP013-MESSAGE-TEXT (2)        19700000
161200         MOVE SQLCA              TO DP013-SQLCA                   19710000
161300         MOVE 'TSHIPMT'          TO DP013-DB2-TABLE-NAME (1)      19720000
161400         MOVE 'TSHPTPO'          TO DP013-DB2-TABLE-NAME (2)      19730000
161500         SET DP013-DB2-ABEND                                      19740000
161600             DP013-XCTL-DISPLAY-RESTART                           19750000
161700                                 TO TRUE                          19760000
161800         PERFORM 9999-ABEND                                       19770000
161900     END-IF.                                                      19780000
162000                                                                  19790000
162100     IF SQLCODE = -811                                            19800000
162200         MOVE 'M'    TO D1-MULTIPLE-IND                           19810000
162300         MOVE DK-PO-NBR   TO PV-PO-NBR (PV-IDX)                   19820000
162400         MOVE DK-REC-SEQ-NBR TO PV-REC-SEQ-NBR (PV-IDX)           19830000
162500         ADD 1                      TO PV-IDX                     19840000
162600         IF PV-IDX > 100                                          19850000
162700             MOVE '3400-GET-SHIPMENT-INFO'                        19860000
162800                                 TO DP013-PARAGRAPH               19870000
162900             MOVE 'PO TABLE LENGTH EXCEEDED'                      19880000
163000                                 TO DP013-MESSAGE-TEXT (1)        19890000
163100             MOVE ' ON PV-MULTIPLE-TABLE'                         19900000
163200                                 TO DP013-MESSAGE-TEXT (2)        19910000
163300             MOVE SQLCA          TO DP013-SQLCA                   19920000
163400             SET DP013-DB2-ABEND                                  19930000
163500                 DP013-XCTL-DISPLAY-RESTART                       19940000
163600                                 TO TRUE                          19950000
163700             PERFORM 9999-ABEND                                   19960000
163800         END-IF                                                   19970000
163900     ELSE                                                         19980000
164000         MOVE SPACES TO D1-MULTIPLE-IND                           19990000
164100     END-IF.                                                      20000000
164267                                                                  20010000
164268 3500-CALL-CICS-API-ARCH.                                         20020000
164271                                                                  20030000
164272     MOVE DK-ITEM-NBR          TO XL001-KEY-ITM-NBR.              20040000
164273                                                                  20050000
164274     SET  XL001-BY-ITEM                                           20060000
164275          XL001-SELECT-SKU                                        20070000
164276          XL001-SELECT-WEB-SKU TO TRUE.                           20080000
164277                                                                  20090000
164278     CALL XL001-VSM-PGM USING  DFHEIBLK                           20100000
164279                               XL001-COMMAREA                     20110000
164280                               XL001-ITEM-COMMAREA.               20120000
164281                                                                  20130000
164282         EVALUATE TRUE                                            20140000
164283                                                                  20150000
164284             WHEN XL001-SKU-SQLCODE = +0                          20160000
164285                  PERFORM 3550-XLV-WEB-SKU                        20170000
164287                                                                  20180000
164288             WHEN XL001-SKU-SQLCODE = +100                        20190000
164289                  MOVE SPACES  TO D5-STORAGE-TYPE                 20200000
164290                                                                  20210000
164291             WHEN XL001-SKU-SQLCODE = -904                        20220000
164292             WHEN XL001-SKU-SQLCODE = -913                        20230000
164293                  MOVE SPACES  TO D5-STORAGE-TYPE                 20240000
164295                                                                  20250000
164296             WHEN XL001-INVALID-ACCESS                            20260000
164297                                                                  20270000
164298                  MOVE '3500-CALL-CICS-API-ARCH'                  20280000
164299                                  TO DP013-PARAGRAPH              20290000
164300                  MOVE 'ACCESS INFO FOR XLKUT001 INCORRECT'       20300000
164301                                  TO DP013-MESSAGE-TEXT (1)       20310000
164304                  MOVE SQLCA      TO DP013-SQLCA                  20320000
164305                  MOVE 'XLV_SKU'  TO DP013-DB2-TABLE-NAME (1)     20330000
164306                  SET DP013-DB2-ABEND                             20340000
164307                      DP013-XCTL-DISPLAY-RESTART                  20350000
164308                                  TO TRUE                         20360000
164309                  PERFORM 9999-ABEND                              20370000
164310                                                                  20380000
164311             WHEN OTHER                                           20390000
164312                                                                  20400000
164313                  MOVE '3500-CALL-CICS-API-ARCH'                  20410000
164314                                  TO DP013-PARAGRAPH              20420000
164315                  MOVE 'SELECT ON XLV_SKU'                        20430000
164316                                  TO DP013-MESSAGE-TEXT (1)       20440000
164317                  MOVE XL001-SKU-SQLCODE                          20450000
164318                                  TO SQLCODE                      20460000
164319                  MOVE SQLCA      TO DP013-SQLCA                  20470000
164320                  MOVE 'XLV_SKU'  TO DP013-DB2-TABLE-NAME (1)     20480000
164321                  SET DP013-DB2-ABEND                             20490000
164322                      DP013-XCTL-DISPLAY-RESTART                  20500000
164323                                  TO TRUE                         20510000
164324                  PERFORM 9999-ABEND                              20520000
164325         END-EVALUATE.                                            20530000
164326*                                                                 20540000
164327 3550-XLV-WEB-SKU.                                                20550000
164328******************************************************************20560000
164329******************************************************************20570000
164330                                                                  20580000
164331         EVALUATE TRUE                                            20590000
164332                                                                  20600000
164333             WHEN XL001-WEB-SKU-SQLCODE = +0                      20610000
164334                  MOVE XL001-STRG-AREA-DESC                       20620000
164335                               TO D5-STORAGE-TYPE                 20630000
164336                                                                  20640000
164337             WHEN XL001-WEB-SKU-SQLCODE = +100                    20650000
164338                  MOVE SPACES  TO D5-STORAGE-TYPE                 20660000
164339                                                                  20670000
164340             WHEN XL001-WEB-SKU-SQLCODE = -904                    20680000
164341             WHEN XL001-WEB-SKU-SQLCODE = -913                    20690000
164342                  MOVE SPACES  TO D5-STORAGE-TYPE                 20700000
164343                                                                  20710000
164344             WHEN XL001-INVALID-ACCESS                            20720000
164345                                                                  20730000
164346                  MOVE '3550-XLV-WEB-SKU'                         20740000
164347                                  TO DP013-PARAGRAPH              20750000
164348                  MOVE 'ACCESS INFO FOR XLKUT001 INCORRECT'       20760000
164349                                  TO DP013-MESSAGE-TEXT (1)       20770000
164350                  MOVE SQLCA      TO DP013-SQLCA                  20780000
164351                  MOVE 'XLV_WEB_SKU'                              20790000
164352                                  TO DP013-DB2-TABLE-NAME (1)     20800000
164353                  SET DP013-DB2-ABEND                             20810000
164354                      DP013-XCTL-DISPLAY-RESTART                  20820000
164355                                  TO TRUE                         20830000
164356                  PERFORM 9999-ABEND                              20840000
164357                                                                  20850000
164358             WHEN OTHER                                           20860000
164359                                                                  20870000
164360                  MOVE '3550-XLV-WEB-SKU'                         20880000
164361                                  TO DP013-PARAGRAPH              20890000
164362                  MOVE 'SELECT ON XLV_WEB_SKU'                    20900000
164363                                  TO DP013-MESSAGE-TEXT (1)       20910000
164364                  MOVE XL001-WEB-SKU-SQLCODE                      20920000
164365                                  TO SQLCODE                      20930000
164366                  MOVE SQLCA      TO DP013-SQLCA                  20940000
164367                  MOVE 'XLV_WEB_SKU'                              20950000
164368                                  TO DP013-DB2-TABLE-NAME (1)     20960000
164369                  SET DP013-DB2-ABEND                             20970000
164370                      DP013-XCTL-DISPLAY-RESTART                  20980000
164371                                  TO TRUE                         20990000
164372                  PERFORM 9999-ABEND                              21000000
164373         END-EVALUATE.                                            21010000
164378*----------------------------------------------------------------*21020000
164379*    OPEN RCVR_PO_CSR                                            *21030000
164380*----------------------------------------------------------------*21040000
164381                                                                  21050000
164382 4000-OPEN-RCVR-PO-CSR.                                           21060000
164383                                                                  21070000
164384     EXEC SQL                                                     21080000
164385         OPEN RCVR_PO_CSR                                         21090000
164386     END-EXEC.                                                    21100000
164387                                                                  21110000
164388     EVALUATE TRUE                                                21120000
164389         WHEN SQLCODE = ZERO                                      21130000
164390             CONTINUE                                             21140000
164391                                                                  21150000
164392         WHEN SQLWARN0 NOT = SPACES                               21160000
164393         WHEN SQLCODE < ZERO                                      21170000
164394         WHEN SQLCODE > ZERO                                      21180000
164395             MOVE '4000-OPEN-RCVR-PO-CSR'                         21190000
164396                                 TO DP013-PARAGRAPH               21200000
164397             MOVE 'OPEN RCVR_PO_CSR'                              21210000
164398                                 TO DP013-MESSAGE-TEXT (1)        21220000
164399             MOVE SQLCA          TO DP013-SQLCA                   21230000
164400             MOVE 'TSHPTPO'      TO DP013-DB2-TABLE-NAME (1)      21240000
164401             MOVE 'TSHIPMT'      TO DP013-DB2-TABLE-NAME (2)      21250000
164402             MOVE 'TVHTRIP'      TO DP013-DB2-TABLE-NAME (3)      21260000
164403             MOVE 'TTRIPST'      TO DP013-DB2-TABLE-NAME (4)      21270000
164404             SET DP013-DB2-ABEND TO TRUE                          21280000
164405             SET DP013-XCTL-DISPLAY-RESTART                       21290000
164406                                 TO TRUE                          21300000
164407             PERFORM 9999-ABEND                                   21310000
164408     END-EVALUATE.                                                21320000
164409                                                                  21330000
164410                                                                  21340000
164411*----------------------------------------------------------------*21350000
164412*    FETCH RCVR_PO_CSR                                           *21360000
164413*----------------------------------------------------------------*21370000
164414                                                                  21380000
164415 4100-FETCH-RCVR-PO-CSR.                                          21390000
164416                                                                  21400000
164417     EXEC SQL                                                     21410000
164418          FETCH  RCVR_PO_CSR                                      21420000
164419           INTO :SHPTPO-PO-NBR                                    21430000
164420              , :SHPTPO-REC-SEQ-NBR                               21440000
164421*             , :SHPTPO-EXPTED-CART-CNT                           21450000
164422*             , :SHPTPO-ACTL-CART-CNT                             21460000
164423*             , :SHPTPO-DMG-CART-CNT                              21470000
164424*             , :SHPTPO-VEND-NAME                                 21480000
164425              , :VHTRIP-OWNER-SCAC-ID                             21490000
164426              , :VHTRIP-VEH-NBR                                   21500000
164427*             , :TRIPST-STATUS-DTE                                21510000
164428              , :RECEIV-EXPTED-CART-CNT                           21520000
164429              , :RECEIV-CRE-TMST                                  21530000
164430              , :RECEIV-OPER-UNT-ID                               21540000
164431              , :RECEIV-FCLTY-ID                                  21550000
164432              , :RECEIV-PACK-BY-ST-IND                            21560000
164433              , :RECEIV-PRE-TKT-IND                               21570000
164434              , :RECEIV-GOH-IND                                   21580000
164435              , :RECEIV-PKGNG-CDE                                 21590000
164436     END-EXEC.                                                    21600000
164437                                                                  21610000
164438     EVALUATE TRUE                                                21620000
164439         WHEN SQLCODE = ZERO                                      21630000
164440             CONTINUE                                             21640000
164441                                                                  21650000
164442         WHEN SQLCODE = +100                                      21660000
164443             SET PS-END-OF-RCVR-PO-CSR                            21670000
164444                                 TO TRUE                          21680000
164445                                                                  21690000
164446         WHEN SQLWARN0 NOT = SPACES                               21700000
164447         WHEN SQLCODE < ZERO                                      21710000
164448         WHEN SQLCODE > ZERO                                      21720000
164449             MOVE '4100-FETCH-RCVR-PO-CSR'                        21730000
164450                                 TO DP013-PARAGRAPH               21740000
164451             MOVE 'FETCH RCVR_PO_CSR'                             21750000
164452                                 TO DP013-MESSAGE-TEXT (1)        21760000
164453             MOVE SQLCA          TO DP013-SQLCA                   21770000
164454             SET DP013-DB2-ABEND TO TRUE                          21780000
164455             SET DP013-XCTL-DISPLAY-RESTART                       21790000
164456                                 TO TRUE                          21800000
164457             PERFORM 9999-ABEND                                   21810000
164458     END-EVALUATE.                                                21820000
164459                                                                  21830000
164460 4200-CLOSE-CURSOR.                                               21840000
164461     EXEC SQL                                                     21850000
164462         CLOSE RCVR_PO_CSR                                        21860000
164463     END-EXEC.                                                    21870000
164464                                                                  21880000
164465     EVALUATE TRUE                                                21890000
164466         WHEN SQLCODE = ZERO                                      21900000
164467             CONTINUE                                             21910000
164468                                                                  21920000
164469         WHEN SQLWARN0 NOT = SPACES                               21930000
164470         WHEN SQLCODE < ZERO                                      21940000
164471         WHEN SQLCODE > ZERO                                      21950000
164472             MOVE '4200-CLOSE-CURSOR'                             21960000
164473                                 TO DP013-PARAGRAPH               21970000
164474             MOVE 'CLOSE RCVR_PO_CSR'                             21980000
164475                                 TO DP013-MESSAGE-TEXT (1)        21990000
164476             MOVE SQLCA          TO DP013-SQLCA                   22000000
164477             MOVE 'TSHIPMT'      TO DP013-DB2-TABLE-NAME (1)      22010000
164478             MOVE 'TVHTRIP'      TO DP013-DB2-TABLE-NAME (2)      22020000
164479             MOVE 'TSHPTPO'      TO DP013-DB2-TABLE-NAME (3)      22030000
164480             MOVE 'TRECEIV'      TO DP013-DB2-TABLE-NAME (4)      22040000
164481             SET DP013-DB2-ABEND TO TRUE                          22050000
164482             SET DP013-XCTL-DISPLAY-RESTART                       22060000
164483                                 TO TRUE                          22070000
164484             PERFORM 9999-ABEND                                   22080000
164485     END-EVALUATE.                                                22090000
164486                                                                  22100000
164487/                                                                 22110000
164488*----------------------------------------------------------------*22120000
164490*    LINK TO DRS TO PRINT THE LINE                               *22130000
164500*----------------------------------------------------------------*22140000
164600                                                                  22150000
164700 5000-SETUP-TOTAL-LINE.                                           22160000
164800                                                                  22170000
164900     ADD 6                       TO PA-LINE-CNT.                  22180000
165000                                                                  22190000
165100     IF PA-LINE-CNT > PC-LINE-MAX                                 22200000
165200         PERFORM 1200-FORMAT-HEADER-LINES                         22210000
165300     END-IF.                                                      22220000
165400                                                                  22230000
165500     MOVE PA-CART-CNT            TO T1-TOT-CART-CNT.              22240000
165600     MOVE T1-TOTAL-LINE1         TO DRS01-COMM-DATA.              22250000
165700     MOVE PC-SPACE2              TO DRS01-COMM-CTL.               22260000
165800     MOVE SA-REPORT-ID           TO DRS01-DRRB-RID.               22270000
165900     PERFORM 9000-PUT-LINE-TO-DRS.                                22280000
166000                                                                  22290000
166100     COMPUTE PA-LINE-CNT = PA-LINE-CNT - 6.                       22300000
166200                                                                  22310000
166300     MOVE SPACES                 TO DRS01-COMM-DATA.              22320000
166400     MOVE PC-SPACE2              TO DRS01-COMM-CTL.               22330000
166500     MOVE SA-REPORT-ID           TO DRS01-DRRB-RID.               22340000
166600                                                                  22350000
166700     PERFORM                                                      22360000
166800         UNTIL PA-LINE-CNT > PC-LAST-LINE                         22370000
166900             PERFORM 9000-PUT-LINE-TO-DRS                         22380000
167000             ADD 2               TO PA-LINE-CNT                   22390000
167100     END-PERFORM.                                                 22400000
167200                                                                  22410000
167300     IF PS-FIRST-PAGE                                             22420000
167400         SET PS-NOT-FIRST-PAGE TO TRUE                            22430000
167500         PERFORM 1150-FORMAT-BARCODE                              22440000
167600     END-IF.                                                      22450000
167700                                                                  22460000
167800*                                                                 22470000
167900*** CREATE PAGE WITH BLANK LINES                                  22480000
168000*                                                                 22490000
168100     PERFORM 1300-FORMAT-HEADER-LINES.                            22500000
168200                                                                  22510000
168300     COMPUTE PA-LINE-CNT = PA-LINE-CNT - 6.                       22520000
168400                                                                  22530000
168500     MOVE D2-DETAIL-LINE2        TO DRS01-COMM-DATA.              22540000
168600     MOVE PC-SPACE2              TO DRS01-COMM-CTL.               22550000
168700     MOVE SA-REPORT-ID           TO DRS01-DRRB-RID.               22560000
168800                                                                  22570000
168900     PERFORM                                                      22580000
169000         UNTIL PA-LINE-CNT > PC-LAST-LINE                         22590000
169100             PERFORM 9000-PUT-LINE-TO-DRS                         22600000
169200             ADD 2               TO PA-LINE-CNT                   22610000
169300     END-PERFORM.                                                 22620000
169400*                                                                 22630000
169500*** PRINT "UNLOADED BY: _______" LINE                             22640000
169600*                                                                 22650000
169700     MOVE L1-LAST-LINE           TO DRS01-COMM-DATA.              22660000
169800     MOVE PC-SPACE2              TO DRS01-COMM-CTL.               22670000
169900     MOVE SA-REPORT-ID           TO DRS01-DRRB-RID.               22680000
170000                                                                  22690000
170100     PERFORM 9000-PUT-LINE-TO-DRS.                                22700000
170200                                                                  22710000
170300 5100-SETUP-TOTAL-LINE.                                           22720000
170400                                                                  22730000
170500     ADD 6                       TO PA-LINE-CNT.                  22740000
170600                                                                  22750000
170700     IF PA-LINE-CNT > PC-LINE-MAX                                 22760000
170800         PERFORM 1200-FORMAT-HEADER-LINES                         22770000
170900     END-IF.                                                      22780000
171000                                                                  22790000
171100     COMPUTE PA-LINE-CNT = PA-LINE-CNT - 6.                       22800000
171200                                                                  22810000
171300     MOVE SPACES                 TO DRS01-COMM-DATA.              22820000
171400*    MOVE D4-DETAIL-LINE4        TO DRS01-COMM-DATA.              22830000
171500     MOVE PC-SPACE2              TO DRS01-COMM-CTL.               22840000
171600     MOVE SA-REPORT-ID           TO DRS01-DRRB-RID.               22850000
171700                                                                  22860000
171800     PERFORM                                                      22870000
171900         UNTIL PA-LINE-CNT > PC-LAST-LINE                         22880000
172000             PERFORM 9000-PUT-LINE-TO-DRS                         22890000
172100             ADD 2               TO PA-LINE-CNT                   22900000
172200     END-PERFORM.                                                 22910000
172300                                                                  22920000
172400                                                                  22930000
172500 6000-PRINT-MULTIPLE-LINES.                                       22940000
172600     MOVE PV-PO-NBR (PV-IDX)       TO DK-PO-NBR.                  22950000
172700     MOVE PV-REC-SEQ-NBR (PV-IDX)  TO DK-REC-SEQ-NBR.             22960000
172800     MOVE ZERO                     TO PV-TOT-CART-CNT.            22970000
172900     SET PS-NOT-END-OF-PO-CSR                                     22980000
173000         PS-FIRST-LINE TO TRUE.                                   22990000
173100     PERFORM 6100-OPEN-CURSOR.                                    23000000
173200     PERFORM 6200-PROCESS-MULTIPLES                               23010000
173300         UNTIL PS-END-OF-PO-CSR.                                  23020000
173400     PERFORM 6400-CLOSE-CURSOR.                                   23030000
173500     PERFORM 6800-PRINT-TOTALS.                                   23040000
173600                                                                  23050000
173700                                                                  23060000
173800 6100-OPEN-CURSOR.                                                23070000
173900     EXEC SQL                                                     23080000
174000         OPEN PO-CSR                                              23090000
174100     END-EXEC.                                                    23100000
174200                                                                  23110000
174300     EVALUATE TRUE                                                23120000
174400         WHEN SQLCODE = ZERO                                      23130000
174500             CONTINUE                                             23140000
174600                                                                  23150000
174700         WHEN SQLWARN0 NOT = SPACES                               23160000
174800         WHEN SQLCODE < ZERO                                      23170000
174900         WHEN SQLCODE > ZERO                                      23180000
175000             MOVE '6100-OPEN-CURSOR'                              23190000
175100                                 TO DP013-PARAGRAPH               23200000
175200             MOVE 'OPEN PO-CSR'                                   23210000
175300                                 TO DP013-MESSAGE-TEXT (1)        23220000
175400             MOVE SQLCA          TO DP013-SQLCA                   23230000
175500             MOVE 'TSHIPMT'      TO DP013-DB2-TABLE-NAME (1)      23240000
175600             MOVE 'TVHTRIP'      TO DP013-DB2-TABLE-NAME (2)      23250000
175700             MOVE 'TTRIPST'      TO DP013-DB2-TABLE-NAME (3)      23260000
175800             MOVE 'TSHPTPO'      TO DP013-DB2-TABLE-NAME (4)      23270000
175900             MOVE 'TRECEIV'      TO DP013-DB2-TABLE-NAME (5)      23280000
176000             SET DP013-DB2-ABEND TO TRUE                          23290000
176100             SET DP013-XCTL-DISPLAY-RESTART                       23300000
176200                                 TO TRUE                          23310000
176300             PERFORM 9999-ABEND                                   23320000
176400     END-EVALUATE.                                                23330000
176500                                                                  23340000
176600 6200-PROCESS-MULTIPLES.                                          23350000
176700                                                                  23360000
176800     PERFORM 6300-FETCH-PO-CSR.                                   23370000
176900     IF PS-NOT-END-OF-PO-CSR                                      23380000
177000         IF PA-LINE-CNT > PC-LINE-MAX                             23390000
177100             PERFORM 1200-FORMAT-HEADER-LINES                     23400000
177200         END-IF                                                   23410000
177310         MOVE PURCHS-DEPT-NBR      TO DK-DEPT-NBR                 23420000
177400         PERFORM 6500-GET-OPER-SET-INFO                           23430000
177500         MOVE DCFAAS-OPER-SET-ID   TO DK-OPER-SET-ID              23440000
177600         PERFORM 6600-GET-PROCESS-AREA                            23450000
177700         MOVE SHIPMT-SHIPT-ID     TO DK-SHIPT-ID                  23460000
177800         PERFORM 6700-GET-STATUS                                  23470000
177900         IF PS-FIRST-LINE                                         23480000
178000             MOVE DK-REC-SEQ-NBR  TO D3-REC-SEQ-NBR               23490000
178100             MOVE DK-PO-NBR       TO D3-PO-NBR                    23500000
178200             MOVE WRKORD-INST-PRC-AREA-ID                         23510000
178300                                  TO D3-PROC-AREA                 23520000
178400         ELSE                                                     23530000
178500             MOVE SPACES          TO D3-REC-SEQ-NBR-X             23540000
178600                                     D3-PO-NBR-X                  23550000
178700                                     D3-PROC-AREA                 23560000
178800         END-IF                                                   23570000
178900         MOVE VHTRIP-OWNER-SCAC-ID                                23580000
179000                                  TO D3-SCAC                      23590000
179100         MOVE VHTRIP-VEH-NBR      TO D3-VEH                       23600000
179200         MOVE SHIPST-SHIPT-STATUS-CDE                             23610000
179300                                  TO D3-STATUS                    23620000
179400         MOVE SHIPMT-PRO-NBR      TO D3-PRO-NBR                   23630000
179500         MOVE SHIPMT-BOL-NBR      TO D3-BOL-NBR                   23640000
179600         MOVE SHPTPO-EXPTED-CART-CNT                              23650000
179700                                  TO D3-CART-CNT                  23660000
179800         ADD SHPTPO-EXPTED-CART-CNT                               23670000
179900                                  TO PV-TOT-CART-CNT              23680000
180000         MOVE D3-DETAIL-LINE3     TO DRS01-COMM-DATA              23690000
180100         MOVE PC-SPACE2           TO DRS01-COMM-CTL               23700000
180200         MOVE SA-REPORT-ID        TO DRS01-DRRB-RID               23710000
180300                                                                  23720000
180400         PERFORM 9000-PUT-LINE-TO-DRS                             23730000
180500                                                                  23740000
180600         ADD  2                   TO PA-LINE-CNT                  23750000
180700                                                                  23760000
180800         SET PS-NOT-FIRST-LINE TO TRUE                            23770000
180900     END-IF.                                                      23780000
181000                                                                  23790000
181100*----------------------------------------------------------------*23800000
181200*    FETCH PO-CSR                                                *23810000
181300*----------------------------------------------------------------*23820000
181400                                                                  23830000
181500 6300-FETCH-PO-CSR.                                               23840000
181600                                                                  23850000
181700     EXEC SQL                                                     23860000
181800          FETCH  PO-CSR                                           23870000
181900           INTO  :SHIPMT-SHIPT-ID                                 23880000
182000               , :SHIPMT-PRO-NBR                                  23890000
182100               , :SHIPMT-BOL-NBR                                  23900000
182300               , :SHPTPO-EXPTED-CART-CNT                          23910000
182400               , :VHTRIP-OWNER-SCAC-ID                            23920000
182500               , :VHTRIP-VEH-NBR :DN-VEH-TRIP-NULL                23930000
182600     END-EXEC.                                                    23940000
182750*                                                                 23950000
182800     EVALUATE TRUE                                                23960000
182900         WHEN SQLCODE = ZERO                                      23970000
183000             CONTINUE                                             23980000
183100                                                                  23990000
183200         WHEN SQLCODE = +100                                      24000000
183300             SET PS-END-OF-PO-CSR                                 24010000
183400                                 TO TRUE                          24020000
183500                                                                  24030000
183600         WHEN SQLWARN0 NOT = SPACES                               24040000
183700         WHEN SQLCODE < ZERO                                      24050000
183800         WHEN SQLCODE > ZERO                                      24060000
183900             MOVE '6300-FETCH-PO-CSR'                             24070000
184000                                 TO DP013-PARAGRAPH               24080000
184100             MOVE 'FETCH PO-CSR'                                  24090000
184200                                 TO DP013-MESSAGE-TEXT (1)        24100000
184300             MOVE SQLCA          TO DP013-SQLCA                   24110000
184400             SET DP013-DB2-ABEND TO TRUE                          24120000
184500             SET DP013-XCTL-DISPLAY-RESTART                       24130000
184600                                 TO TRUE                          24140000
184700             PERFORM 9999-ABEND                                   24150000
184800     END-EVALUATE.                                                24160000
184900                                                                  24170000
185000 6400-CLOSE-CURSOR.                                               24180000
185100     EXEC SQL                                                     24190000
185200         CLOSE PO-CSR                                             24200000
185300     END-EXEC.                                                    24210000
185400                                                                  24220000
185500     EVALUATE TRUE                                                24230000
185600         WHEN SQLCODE = ZERO                                      24240000
185700             CONTINUE                                             24250000
185800                                                                  24260000
185900         WHEN SQLWARN0 NOT = SPACES                               24270000
186000         WHEN SQLCODE < ZERO                                      24280000
186100         WHEN SQLCODE > ZERO                                      24290000
186200             MOVE '6400-CLOSE-CURSOR'                             24300000
186300                                 TO DP013-PARAGRAPH               24310000
186400             MOVE 'CLOSE PO-CSR'                                  24320000
186500                                 TO DP013-MESSAGE-TEXT (1)        24330000
186600             MOVE SQLCA          TO DP013-SQLCA                   24340000
186700             MOVE 'TSHIPMT'      TO DP013-DB2-TABLE-NAME (1)      24350000
186800             MOVE 'TVHTRIP'      TO DP013-DB2-TABLE-NAME (2)      24360000
186900             MOVE 'TTRIPST'      TO DP013-DB2-TABLE-NAME (3)      24370000
187000             MOVE 'TSHPTPO'      TO DP013-DB2-TABLE-NAME (4)      24380000
187100             MOVE 'TRECEIV'      TO DP013-DB2-TABLE-NAME (5)      24390000
187200             SET DP013-DB2-ABEND TO TRUE                          24400000
187300             SET DP013-XCTL-DISPLAY-RESTART                       24410000
187400                                 TO TRUE                          24420000
187500             PERFORM 9999-ABEND                                   24430000
187600     END-EVALUATE.                                                24440000
187700                                                                  24450000
187800                                                                  24460000
187900 6500-GET-OPER-SET-INFO.                                          24470000
188000                                                                  24480000
188100                                                                  24490000
188200*  THIS IS THE OPER SET DEFAULT THAT IS ASSIGNED IN CNUDCLOC      24500000
188300*  BY OPER-UNIT, FACILTY, DEPT, AND CLASS.                        24510000
188400                                                                  24520000
188500     PERFORM                                                      24530000
188600         WITH TEST AFTER                                          24540000
188700         VARYING PV-RETRY-COUNTER                                 24550000
188800         FROM 1 BY 1                                              24560000
188900         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               24570000
189000             OR (SQLCODE = +0)                                    24580000
189100             OR (SQLCODE = +100))                                 24590000
189200                                                                  24600000
189300         EXEC SQL                                                 24610000
189400              SELECT A.OPER_SET_ID                                24620000
189500                INTO :DCFAAS-OPER-SET-ID                          24630000
189600                FROM TDCFAAS A                                    24640000
189700                    ,TOPRSET B                                    24650000
189800               WHERE A.OPER_UNT_ID       = :DK-OPER-UNT-ID        24660000
189900                 AND A.FCLTY_ID          = :DK-FCLTY-ID           24670000
190000                 AND A.DEPT_NBR          = :DK-DEPT-NBR           24680000
190100                 AND A.FCLTY_LOC_TYP_CDE = 'PA'                   24690000
190200                 AND A.RANK_NBR          = 1                      24700000
190300                 AND B.VER_STATUS_CDE    = 'A'                    24710000
190310                 AND A.OPER_UNT_ID       = B.OPER_UNT_ID          24720000
190400                 AND A.CL_NBR            =                        24730000
190500                    (SELECT MIN(C.CL_NBR)                         24740000
190600                      FROM TPURITM C                              24750000
190700                     WHERE C.PO_NBR      = :DK-PO-NBR             24760000
190800                       AND C.VER_STATUS_CDE = 'A')                24770000
190900                 AND A.OPER_SET_ID = B.OPER_SET_ID                24780000
191000         END-EXEC                                                 24790000
191100                                                                  24800000
191200         EVALUATE TRUE                                            24810000
191300             WHEN SQLCODE = +0                                    24820000
191400             WHEN SQLCODE = +100                                  24830000
191500             WHEN SQLCODE = -904                                  24840000
191600             WHEN SQLCODE = -913                                  24850000
191700                  CONTINUE                                        24860000
191800                                                                  24870000
191900             WHEN SQLWARN0 NOT = SPACES                           24880000
192000             WHEN SQLCODE < +0                                    24890000
192100             WHEN SQLCODE > +0                                    24900000
192200                 MOVE '6500-GET-OPER-SET-INFO'                    24910000
192300                                     TO DP013-PARAGRAPH           24920000
192400                 MOVE 'SELECT OPER-SET'                           24930000
192500                                     TO DP013-MESSAGE-TEXT (1)    24940000
192600                 MOVE SQLCA          TO DP013-SQLCA               24950000
192700                 SET DP013-DB2-ABEND TO TRUE                      24960000
192800                 SET DP013-XCTL-DISPLAY-RESTART                   24970000
192900                                     TO TRUE                      24980000
193000                 PERFORM 9999-ABEND                               24990000
193100         END-EVALUATE                                             25000000
193200     END-PERFORM.                                                 25010000
193300                                                                  25020000
193400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    25030000
193500         SQLCODE NOT = +0                                         25040000
193600         MOVE '6500-GET-OPER-SET-INFO'  TO DP013-PARAGRAPH        25050000
193700         MOVE 'MAX RETRIES EXCEEDED ON FACILITY LOC ASSIGNMENTS'  25060000
193800                                  TO DP013-MESSAGE-TEXT (1)       25070000
193900         MOVE SQLCA               TO DP013-SQLCA                  25080000
194000         MOVE 'TDCFAAS'           TO DP013-DB2-TABLE-NAME (1)     25090000
194100         MOVE 'TOPRSET'           TO DP013-DB2-TABLE-NAME (2)     25100000
194200         SET DP013-DB2-ABEND                                      25110000
194300             DP013-XCTL-DISPLAY-RESTART                           25120000
194400                                  TO TRUE                         25130000
194500         PERFORM 9999-ABEND                                       25140000
194600     END-IF.                                                      25150000
194700                                                                  25160000
194800 6600-GET-PROCESS-AREA.                                           25170000
194900                                                                  25180000
195000     PERFORM                                                      25190000
195100         WITH TEST AFTER                                          25200000
195200         VARYING PV-RETRY-COUNTER                                 25210000
195300         FROM 1 BY 1                                              25220000
195400         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               25230000
195500             OR (SQLCODE = +0)                                    25240000
195600             OR (SQLCODE = +100))                                 25250000
195700                                                                  25260000
195800         EXEC SQL                                                 25270000
195900             SELECT INST_PRC_AREA_ID                              25280000
196000              INTO  :WRKORD-INST-PRC-AREA-ID                      25290000
196100             FROM TWRKORD                                         25300000
196200            WHERE ORD_NBR          =  :DK-PO-NBR                  25310000
196300              AND RCVR_SEQ_NBR     =  :DK-REC-SEQ-NBR             25320000
196400              AND OPER_SET_ID      =  :DK-OPER-SET-ID             25330000
196500              AND VER_STATUS_CDE   =  :PC-A                       25340000
196600              AND ORD_LNE_NBR      =  :PC-ZERO                    25350000
196700              AND STAT_CDE         =  :PC-CM                      25360000
196800         END-EXEC                                                 25370000
196900                                                                  25380000
197000         EVALUATE TRUE                                            25390000
197100             WHEN SQLCODE = +0                                    25400000
197200             WHEN SQLCODE = -904                                  25410000
197300             WHEN SQLCODE = -913                                  25420000
197400                 CONTINUE                                         25430000
197500                                                                  25440000
197600             WHEN SQLCODE = +100                                  25450000
197700                 MOVE SPACES TO WRKORD-INST-PRC-AREA-ID           25460000
197800                                                                  25470000
197900             WHEN SQLWARN0 NOT = SPACES                           25480000
198000             WHEN SQLCODE < +0                                    25490000
198100             WHEN SQLCODE > +0                                    25500000
198200                 MOVE '6600-GET-PROCESS-AREA'                     25510000
198300                                   TO DP013-PARAGRAPH             25520000
198400                 MOVE 'SELECT TWRKORD'                            25530000
198500                                   TO DP013-MESSAGE-TEXT(1)       25540000
198600                 MOVE SQLCA        TO DP013-SQLCA                 25550000
198700                 MOVE 'TWRKORD'    TO DP013-DB2-TABLE-NAME (1)    25560000
198800                 SET DP013-DB2-ABEND                              25570000
198900                     DP013-XCTL-DISPLAY-RESTART TO TRUE           25580000
199000                 PERFORM 9999-ABEND                               25590000
199100         END-EVALUATE                                             25600000
199200     END-PERFORM.                                                 25610000
199300                                                                  25620000
199400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    25630000
199500         SQLCODE NOT = +0                                         25640000
199600         MOVE '6600-GET-PROCESS-AREA'                             25650000
199700                                   TO DP013-PARAGRAPH             25660000
199800         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              25670000
199900                                   TO DP013-MESSAGE-TEXT (1)      25680000
200000         MOVE 'TO SELECT TWRKORD'                                 25690000
200100                                   TO DP013-MESSAGE-TEXT (2)      25700000
200200         MOVE SQLCA                TO DP013-SQLCA                 25710000
200300         MOVE 'TWRKORD'            TO DP013-DB2-TABLE-NAME (1)    25720000
200400         SET DP013-DB2-ABEND                                      25730000
200500             DP013-XCTL-DISPLAY-RESTART                           25740000
200600                                   TO TRUE                        25750000
200700         PERFORM 9999-ABEND                                       25760000
200800     END-IF.                                                      25770000
200900                                                                  25780000
201000 6700-GET-STATUS.                                                 25790000
201100                                                                  25800000
201200     PERFORM                                                      25810000
201300         WITH TEST AFTER                                          25820000
201400         VARYING PV-RETRY-COUNTER                                 25830000
201500         FROM 1 BY 1                                              25840000
201600         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               25850000
201700             OR (SQLCODE = +0)                                    25860000
201800             OR (SQLCODE = +100))                                 25870000
201900                                                                  25880000
202000         EXEC SQL                                                 25890000
202100             SELECT  A.SHIPT_STATUS_CDE                           25900000
202200             INTO    :SHIPST-SHIPT-STATUS-CDE                     25910000
202300           FROM   TSHIPST A                                       25920000
202400                 ,TSHSTYP B                                       25930000
202500           WHERE  A.SHIPT_ID = :DK-SHIPT-ID                       25940000
202600             AND  B.PRTY_CDE =                                    25950000
202700                  (SELECT MAX(D.PRTY_CDE)                         25960000
202800                     FROM TSHIPST C                               25970000
202900                         ,TSHSTYP D                               25980000
203000                    WHERE C.SHIPT_ID         = A.SHIPT_ID         25990000
203100                      AND C.SHIPT_STATUS_CDE = D.SHIPT_STATUS_CDE)26000000
203200             AND  A.SHIPT_STATUS_CDE = B.SHIPT_STATUS_CDE         26010000
203300         END-EXEC                                                 26020000
203400                                                                  26030000
203500                                                                  26040000
203600         EVALUATE TRUE                                            26050000
203700             WHEN SQLCODE = +0                                    26060000
203800             WHEN SQLCODE = +100                                  26070000
203900             WHEN SQLCODE = -904                                  26080000
204000             WHEN SQLCODE = -913                                  26090000
204100                 CONTINUE                                         26100000
204200                                                                  26110000
204300             WHEN SQLWARN0 NOT = SPACES                           26120000
204400             WHEN SQLCODE < +0                                    26130000
204500             WHEN SQLCODE > +0                                    26140000
204600                 MOVE '6700-GET-STATUS'                           26150000
204700                                   TO DP013-PARAGRAPH             26160000
204800                 MOVE 'SELECT TSHIPST'                            26170000
204900                                   TO DP013-MESSAGE-TEXT(1)       26180000
205000                 MOVE SQLCA        TO DP013-SQLCA                 26190000
205100                 MOVE 'TSHIPST'    TO DP013-DB2-TABLE-NAME (1)    26200000
205200                 MOVE 'TSHSTYP'    TO DP013-DB2-TABLE-NAME (1)    26210000
205300                 SET DP013-DB2-ABEND                              26220000
205400                     DP013-XCTL-DISPLAY-RESTART TO TRUE           26230000
205500                 PERFORM 9999-ABEND                               26240000
205600         END-EVALUATE                                             26250000
205700     END-PERFORM.                                                 26260000
205800                                                                  26270000
205900     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    26280000
206000         SQLCODE NOT = +0                                         26290000
206100         MOVE '6700-GET-STATUS'    TO DP013-PARAGRAPH             26300000
206200         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              26310000
206300                                   TO DP013-MESSAGE-TEXT (1)      26320000
206400         MOVE 'TO SELECT TSHIPST'                                 26330000
206500                                   TO DP013-MESSAGE-TEXT (2)      26340000
206600         MOVE SQLCA                TO DP013-SQLCA                 26350000
206700         MOVE 'TSHIPST'            TO DP013-DB2-TABLE-NAME (1)    26360000
206800         MOVE 'TSHSTYP'            TO DP013-DB2-TABLE-NAME (2)    26370000
206900         SET DP013-DB2-ABEND                                      26380000
207000             DP013-XCTL-DISPLAY-RESTART                           26390000
207100                                   TO TRUE                        26400000
207200         PERFORM 9999-ABEND                                       26410000
207300     END-IF.                                                      26420000
207400                                                                  26430000
207500 6800-PRINT-TOTALS.                                               26440000
207600     MOVE PV-TOT-CART-CNT        TO T1-TOT-CART-CNT.              26450000
207700     MOVE T1-TOTAL-LINE1         TO DRS01-COMM-DATA.              26460000
207800     MOVE PC-SPACE2              TO DRS01-COMM-CTL.               26470000
207900     MOVE SA-REPORT-ID           TO DRS01-DRRB-RID.               26480000
208000                                                                  26490000
208100     PERFORM 9000-PUT-LINE-TO-DRS.                                26500000
208200                                                                  26510000
208300*----------------------------------------------------------------*26520000
208400*    LINK TO DRS TO PRINT THE LINE                               *26530000
208500*----------------------------------------------------------------*26540000
208600                                                                  26550000
208700 9000-PUT-LINE-TO-DRS.                                            26560000
208800                                                                  26570000
208900     MOVE PC-PUT                 TO DRS01-DRRB-FUNC.              26580000
209000                                                                  26590000
209100     EXEC CICS LINK                                               26600000
209200         PROGRAM  ('DRS1INTC')                                    26610000
209300         COMMAREA (DRS01-COMMAREA)                                26620000
209400         RESP     (PV-CICS-RESPONSE)                              26630000
209500     END-EXEC.                                                    26640000
209600                                                                  26650000
209700     IF PV-CICS-RESPONSE NOT = DFHRESP(NORMAL)                    26660000
209800         SET DP013-LOGIC-ABEND   TO TRUE                          26670000
209900         SET DP013-NO-ROLLBACK   TO TRUE                          26680000
210000         MOVE '9000-PUT-LINE-TO-DRS'                              26690000
210100                                 TO DP013-PARAGRAPH               26700000
210200         MOVE PV-CICS-RESPONSE   TO PM-CICS-RESP-10               26710000
210300         MOVE PM-PROGRAM-MESSAGE-10                               26720000
210400                                 TO DP013-MESSAGE-TEXT(1)         26730000
210500         PERFORM 9999-ABEND                                       26740000
210600     END-IF.                                                      26750000
210700                                                                  26760000
210800     IF DRS01-DRRB-RC = ZERO                                      26770000
210900         CONTINUE                                                 26780000
211000     ELSE                                                         26790000
211100         MOVE DRS01-DRRB-RC      TO PV-SAVE-RC                    26800000
211200         PERFORM 9950-DRS-FATAL-ERROR                             26810000
211300     END-IF.                                                      26820000
211400                                                                  26830000
211500/                                                                 26840000
211600*----------------------------------------------------------------*26850000
211700*    TERMINATE DRS AND WRITE AN ERROR MESSAGE TO THE LOG         *26860000
211800*----------------------------------------------------------------*26870000
211900                                                                  26880000
212000 9950-DRS-FATAL-ERROR.                                            26890000
212100                                                                  26900000
212200* SAVE INFO FROM THE FAILED DRS CALL                              26910000
212300     MOVE DRS01-DRRB-FUNC        TO IE-DRS-FUNC.                  26920000
212400     MOVE DRS01-DRRB-RC          TO IE-DRS-RC.                    26930000
212500     MOVE CA-USERID              TO IE-DRS-USERID                 26940000
212600                                                                  26950000
212700* CALL DRS TO CLOSE THE REPORT                                    26960000
212800     MOVE PC-TERM                TO DRS01-DRRB-FUNC.              26970000
212900     EXEC CICS LINK                                               26980000
213000         PROGRAM  ('DRS1INTC')                                    26990000
213100         COMMAREA (DRS01-COMMAREA)                                27000000
213200     END-EXEC.                                                    27010000
213300                                                                  27020000
213400* WRITE AN ERROR MESSAGE TO THE CICS MASTER LOG                   27030000
213500     EXEC CICS                                                    27040000
213600         WRITEQ TD                                                27050000
213700         QUEUE  ('CSML')                                          27060000
213800         FROM   (IE-DRS-ERROR-MSG)                                27070000
213900         RESP   (PV-CICS-RESPONSE)                                27080000
214000     END-EXEC.                                                    27090000
214100                                                                  27100000
214200* SETUP AND PERFORM THE ABEND ROUTINE                             27110000
214300     IF PV-CICS-RESPONSE = DFHRESP(NORMAL)                        27120000
214400         MOVE '9500-DRS-FATAL-ERROR'                              27130000
214500                                 TO DP013-PARAGRAPH               27140000
214600         MOVE PV-SAVE-RC         TO PM-CICS-RESP-11               27150000
214700         MOVE PM-PROGRAM-MESSAGE-11                               27160000
214800                                 TO DP013-MESSAGE-TEXT(1)         27170000
214900         MOVE CA-COMM-AREA       TO DP013-MESSAGE-TEXT(2)         27180000
215000         PERFORM 9999-ABEND                                       27190000
215100     ELSE                                                         27200000
215200         SET DP013-LOGIC-ABEND   TO TRUE                          27210000
215300         SET DP013-NO-ROLLBACK   TO TRUE                          27220000
215400         MOVE '9500-DRS-FATAL-ERROR'                              27230000
215500                                 TO DP013-PARAGRAPH               27240000
215600         MOVE PV-CICS-RESPONSE   TO PM-CICS-RESP-11               27250000
215700         MOVE PM-PROGRAM-MESSAGE-11                               27260000
215800                                 TO DP013-MESSAGE-TEXT(1)         27270000
215900         PERFORM 9999-ABEND                                       27280000
216000     END-IF.                                                      27290000
216100                                                                  27300000
216200                                                                  27310000
216300/                                                                 27320000
216400 9999-ABEND.                                                      27330000
216500                                                                  27340000
216600     MOVE 'RCKCS226'             TO DP013-PROGRAM.                27350000
216700                                                                  27360000
216800     SET DP013-LINK-RETURN       TO TRUE.                         27370000
216900     SET DP013-NO-ROLLBACK       TO TRUE.                         27380000
217000                                                                  27390000
217100     INITIALIZE                     DP013-SRC-TASK-NUMBER         27400000
217200                                    DP013-STACK.                  27410000
217300                                                                  27420000
217400     MOVE DFHEIBLK               TO DP013-DFHEIBLK.               27430000
217500                                                                  27440000
217600     EXEC CICS                                                    27450000
217700         LINK PROGRAM  (DP013-NAME)                               27460000
217800              COMMAREA (DP013-PARAMETERS)                         27470000
217900              LENGTH   (DP013-LENGTH)                             27480000
218000     END-EXEC.                                                    27490000
218100                                                                  27500000
218200     EXEC CICS                                                    27510000
218300         RETURN                                                   27520000
218400     END-EXEC.                                                    27530000
