000100 ID  DIVISION.                                                    00010001
000200 PROGRAM-ID.         POKUT219.                                    00020003
000300 AUTHOR.             TROY BIRK.                                   00030001
000400 INSTALLATION.       KOHLS DEPARTMENT STORES.                     00040001
000500 DATE-WRITTEN.       08/94.                                       00050001
000600 DATE-COMPILED.                                                   00060001
000700                                                                  00070001
000800******************************************************************00080001
000900* CALCULATE EXTENDED COST & RETAIL AMOUNTS                       *00090001
001000*                                                                *00100001
001100* COBOL390                                                       *00110001
001200*                                                                *00120001
001300* THIS PROGRAM WILL READ A FILE OF ACTIVE PURCHASE ORDERS. FOR   *00130001
001400* EVERY PO/LINE RECORD READ, THE OPEN COST AND RETAIL AMOUNTS    *00140001
001500* WILL BE CALCULATED BY MULTIPLYING THE OPEN UNITS BY UNIT COST  *00150001
001600* AND UNIT RETAIL.                                               *00160001
001700******************************************************************00170001
001800*     CHANGE LOG                                                 *00180001
001900******************************************************************00190001
002000*    DATE  03/21/12                                              *00200004
002100*  CHANGE MADE: NEW PROGRAM                                      *00210004
002200*  MADE BY: COGNIZANT                              WR #: 2344    *00220004
002300******************************************************************00230004
002400* 04/12/12 MADE BY: COGNIZANT               WR/IR #: CRQ 23538    00240006
002500* CHANGES: CHANGED RECORD LAYOUT FOR PO RECORDS.                  00250006
002600******************************************************************00260006
002700* 07/18/12 MADE BY: COGNIZANT               WR/IR #: CRQ 29188    00270009
002800* CHANGES: CHANGED RECORD LAYOUT FOR PO RECORDS TO ADD DIST DATE  00280008
002900*          WEEK NUMBER                                            00290008
003000******************************************************************00300008
003100                                                                  00310001
003200 ENVIRONMENT DIVISION.                                            00320001
003300*                                                                 00330001
003400 CONFIGURATION SECTION.                                           00340001
003500*                                                                 00350001
003600 SOURCE-COMPUTER.        IBM-3090.                                00360001
003700 OBJECT-COMPUTER.        IBM-3090.                                00370001
003800*                                                                 00380001
003900 INPUT-OUTPUT SECTION.                                            00390001
004000 FILE-CONTROL.                                                    00400001
004100     SELECT  PO-LINE-FILE                                         00410001
004200         ASSIGN TO INP01.                                         00420001
004300     SELECT  OPEN-TO-RECEIVE-FILE                                 00430001
004400         ASSIGN TO OUT01.                                         00440001
004500                                                                  00450001
004600 DATA DIVISION.                                                   00460001
004700 FILE SECTION.                                                    00470001
004800*                                                                 00480001
004900 FD  PO-LINE-FILE                                                 00490001
005000     RECORDING MODE IS F                                          00500001
005100     LABEL RECORDS ARE STANDARD                                   00510001
005200     BLOCK CONTAINS 0 RECORDS.                                    00520001
005300 01  PO-LINE-RECORD              PIC X(210).                      00530007
005400*                                                                 00540001
005500 FD  OPEN-TO-RECEIVE-FILE                                         00550001
005600     RECORDING MODE IS F                                          00560001
005700     LABEL RECORDS ARE STANDARD                                   00570001
005800     BLOCK CONTAINS 0 RECORDS.                                    00580001
005900 01  OPEN-TO-RECEIVE-RECORD        PIC X(210).                    00590007
006000*                                                                 00600001
006100                                                                  00610001
006200 WORKING-STORAGE SECTION.                                         00620001
006300*                                                                 00630001
006400 01  DK-DATABASE-KEYS.                                            00640001
006500     05  DK-ORD-NBR                 PIC  S9(9) COMP.              00650001
006600     05  DK-ORD-LNE-NBR             PIC  S9(9) COMP.              00660001
006700*                                                                 00670001
006800 01  PV-PROGRAM-VARIABLES.                                        00680001
006900     05  PV-PARAGRAPH-NAME          PIC X(30)    VALUE SPACE.     00690001
007000     05  PV-DB2-OPER-ATTEMPTED      PIC X(30)    VALUE SPACE.     00700001
007100     05  PV-PO-UNITS-RECEIVED       PIC 9(09)    VALUE ZERO.      00710001
007200     05  PV-PO-RETAIL-RECEIVED      PIC 9(11)V99 VALUE ZERO.      00720001
007300     05  PV-UNIT-RTL                PIC S9(9)V99 VALUE ZERO       00730001
007400                                                 COMP-3.          00740001
007500*                                                                 00750001
007600 01  PS-PROGRAM-SWITCHES.                                         00760001
007700     05  PS-MORE-INPUT-RECS-SW           PIC X(01)   VALUE 'Y'.   00770001
007800         88  PS-MORE-INPUT-RECS                      VALUE 'Y'.   00780001
007900         88  PS-NO-MORE-INPUT-RECS                   VALUE 'N'.   00790001
008000     05  PS-MORE-PO-RCPT-ROWS-SW         PIC X(01)   VALUE 'Y'.   00800001
008100         88  PS-MORE-PO-RCPT-ROWS                    VALUE 'Y'.   00810001
008200         88  PS-NO-MORE-PO-RCPT-ROWS                 VALUE 'N'.   00820001
008300*                                                                 00830001
008400******************************************************************00840001
008500*  INPUT/OUTPUT RECORD LAYOUT.                                    00850001
008600******************************************************************00860001
008700     COPY POWS010.                                                00870005
008800*                                                                 00880001
008900                                                                  00890001
009000 01  ABEND-CODE               PIC S9(04)  VALUE ZERO              00900001
009100                                          COMP SYNC.              00910001
009200     EJECT                                                        00920001
009300 LINKAGE SECTION.                                                 00930001
009400*                                                                 00940001
009500 PROCEDURE DIVISION.                                              00950001
009600*                                                                 00960001
009700******************************************************************00970001
009800*                                                                 00980001
009900******************************************************************00990001
010000 A100-MAIN-MODULE.                                                01000001
010100                                                                  01010001
010200     PERFORM B100-OPEN-FILES.                                     01020001
010300     PERFORM Z100-READ-INPUT-FILE.                                01030001
010400     PERFORM B200-COMPUTE-OPEN-TO-RECEIVE                         01040001
010500         UNTIL PS-NO-MORE-INPUT-RECS.                             01050001
010600     PERFORM B300-CLOSE-FILES.                                    01060001
010700                                                                  01070001
010800     STOP RUN.                                                    01080001
010900                                                                  01090001
011000******************************************************************01100001
011100*                                                                 01110001
011200******************************************************************01120001
011300 B100-OPEN-FILES.                                                 01130001
011400*                                                                 01140001
011500     OPEN  INPUT  PO-LINE-FILE                                    01150001
011600           OUTPUT OPEN-TO-RECEIVE-FILE.                           01160001
011700*                                                                 01170001
011800******************************************************************01180001
011900*  CALCUATE THE COST & RETAIL AMOUNTS ON EACH PO/LINE RECORD      01190001
012000******************************************************************01200001
012100 B200-COMPUTE-OPEN-TO-RECEIVE.                                    01210001
012200                                                                  01220001
012300     COMPUTE PO010-OPEN-RTL ROUNDED =                             01230005
012400             PO010-OPEN-UNITS * PO010-UNIT-RETAIL                 01240005
012500     ON SIZE ERROR INITIALIZE PO010-OPEN-RTL.                     01250005
012600                                                                  01260001
012700     COMPUTE PO010-OPEN-COST ROUNDED =                            01270005
012800             PO010-OPEN-UNITS * PO010-UNIT-COST                   01280005
012900     ON SIZE ERROR INITIALIZE PO010-OPEN-COST.                    01290005
013000                                                                  01300001
013100     PERFORM Z200-WRITE-OUTPUT-RECORD.                            01310001
013200     PERFORM Z100-READ-INPUT-FILE.                                01320001
013300*                                                                 01330001
013400******************************************************************01340001
013500*  CLOSE ALL FILES USED BY THIS PROGRAM.                          01350001
013600******************************************************************01360001
013700 B300-CLOSE-FILES.                                                01370001
013800*                                                                 01380001
013900     CLOSE PO-LINE-FILE                                           01390001
014000           OPEN-TO-RECEIVE-FILE.                                  01400001
014100*                                                                 01410001
014200******************************************************************01420001
014300* READ THE INPUT FILE                                             01430001
014400******************************************************************01440001
014500 Z100-READ-INPUT-FILE.                                            01450001
014600*                                                                 01460001
014700     READ  PO-LINE-FILE                                           01470001
014800           INTO PO010-RECORD                                      01480005
014900           AT END SET PS-NO-MORE-INPUT-RECS TO TRUE.              01490001
015000*                                                                 01500001
015100******************************************************************01510001
015200* WRITE THE RECORD TO THE OUTPUT FILE.                            01520001
015300******************************************************************01530001
015400 Z200-WRITE-OUTPUT-RECORD.                                        01540001
015500*                                                                 01550001
015600     WRITE OPEN-TO-RECEIVE-RECORD  FROM PO010-RECORD.             01560005
015700*                                                                 01570001
