000100******************************************************************00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300******************************************************************00030000
000400*                                                                 00040000
000500 PROGRAM-ID.    FSKRP121.                                         00050000
000600 AUTHOR.        LINDA FRIESS.                                     00060000
000700 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00070000
000800 DATE-WRITTEN.  03-17-2003.                                       00080000
000900 DATE-COMPILED.                                                   00090000
001000*                                                                 00100000
001100******************************************************************00110000
001200*       FSKRP121 - DAILY ADJUSTMENT & RECEIPT ERROR REPORT       *00120000
001300******************************************************************00130000
001400*                                                                 00140000
001500*   THIS PROGRAM WILL PRINT A COMBINED ERROR REPORT FOR ALL       00150000
001600*   ADJUSTMENTS AND RECEIPTS ON A GIVEN DAY.  THE REPORT WILL     00160000
001700*   BREAK ON DEPARTMENT AND MAJOR CLASS.                          00170000
001800*                                                                 00180000
001900******************************************************************00190000
002000*  CHANGE MADE: ADDED PRINTING OF HEADERS & MESSAGE IF NO ERRORS *00200000
002100*               WERE FOUND                                       *00210000
002200*      MADE BY:  LINDA FRIESS                                    *00220000
002300*         DATE:  03/31/03                 WR# 23946              *00230000
002400******************************************************************00240029
002000*  CHANGE MADE: STORE NUMBER EXPANSION PROJECT.                  *00250029
002100*  REMOVE TRANSACTION TYPES 141 AND 142 (INVENTORY TYPES).       *00260029
002200*      MADE BY:  MARIA KLAMIK                                    *00270029
002300*         DATE:  04/19/2004               WR# 26355              *00280029
002400******************************************************************00290034
RONNA *  CHANGE MADE: ADD BATCH RANGE 801 THROUGH 831 FOR              *00300034
RONNA *               OMS CENTRAL STOCK                                *00310034
RONNA *      MADE BY:  RONNA MCDONALD                                  *00320034
RONNA *         DATE:  03/20/2013               WR# 41224              *00330035
OCFSFS* 08/23/13 - RACHEL GRAMANN               CHG# CHG0060713         00340041
OCFSFS*    - OCF SHIP FROM STORE PROJECT TO FEED MERCHANDISE CHANGES TO 00350037
OCFSFS*      FASHION SALES                                              00360037
111890***************************************************************** 00370043
111890* 05/21/2015 CHANGED BY:  JIM HUNTER        CHG0111890            00380053
111890* DESCRIPTION: CHANGED FOR RFID PROJECT.  RFID COUNTS WILL NOW    00390043
111890*              PASS 'RFID' IN THE BATCH NUMBER.  USA COUNTS       00400043
111890*              WILL CONTINUE TO PASS '9988' IN THE BATCH NUMBER.  00410043
111890*              THE FASHION REPORT PROGRAMS CAN NOW DISTINGUISH    00420043
111890*              RFID COUNTS FROM USA COUNTS.                       00430043
002400******************************************************************00440000
164325* 05/12/2017 CHANGED BY:  BARB SCHULTZ      CHG0164325            00450044
164325* DESCRIPTION: ADDED 'MISLOAD TSFR' BATCH TO THE PROGRAM FOR THE  00460045
164325*              STORE RECEIVING PROJECT.                           00470045
002400******************************************************************00480044
GIV2FS* 10/02/2017 CHANGED BY:  JIM HUNTER  CHG0180589 (FIND GIV2FS)    00490053
GIV2FS*            CHANGED TO ALLOW FASHION TO ACCEPT UPDATES FROM GIV. 00500050
GIV2FS*            GIV ADJUSTMENTS WILL BE DISTINGUISHED FROM OTHER     00510050
GIV2FS*            ADJUSTMENTS BY THE BATCH NUMBER WHICH WILL CONTAIN   00520050
GIV2FS*            'GIV'.                                               00530050
002400******************************************************************00540050
0518  *  05/13/18 - JIM ARENDT   CHG0199002 (FIND 0518)                 00550056
0518  *  CHANGE MADE: ADDED CODE FOR THE BOSS PROJECT TO READ THE       00560056
0518  *               TKRPRPM TABLE 'BSSRCV' TO RETRIEVE THE BOSS       00570056
0518  *               RECEIVER.  IF THE RECEIVER NUMBER EQUALS THE BOSS 00580056
0518  *               PARM, DISPLAY 'BSS' IN THE RECEIVER FIELD.        00590056
0518  *               CHANGES DENOTED BY '0518' IN COL 1-4.             00600056
002600******************************************************************00610056
002500 ENVIRONMENT DIVISION.                                            00620000
002600******************************************************************00630000
002700 CONFIGURATION SECTION.                                           00640000
002800******************************************************************00650000
002900 SOURCE-COMPUTER.    IBM-3090.                                    00660000
003000 OBJECT-COMPUTER.    IBM-3090.                                    00670000
003100******************************************************************00680000
003200 INPUT-OUTPUT SECTION.                                            00690000
003300******************************************************************00700000
003400 FILE-CONTROL.                                                    00710000
003500******************************************************************00720000
003600*                                                                 00730000
003700     SELECT CONTROL-FILE   ASSIGN TO INP01.                       00740000
003800*                                                                 00750000
008300     SELECT PRINT-REPORT   ASSIGN TO OUT01.                       00760000
008400*                                                                 00770000
008500******************************************************************00780000
008600 DATA DIVISION.                                                   00790000
009200***************************************************************** 00800000
009300*                                                                 00810000
009400 FILE SECTION.                                                    00820000
009500*                                                                 00830000
009600 FD  CONTROL-FILE                                                 00840000
009700     RECORDING MODE IS F                                          00850000
009800     DATA RECORD IS CONTROL-RECORD.                               00860000
009900                                                                  00870000
010000 01  CONTROL-RECORD                    PIC X(80).                 00880000
010100*                                                                 00890000
010200*                                                                 00900000
011000 FD  PRINT-REPORT                                                 00910000
011100     LABEL RECORDS ARE STANDARD                                   00920000
011200     RECORDING MODE IS F                                          00930000
011300     RECORD CONTAINS 132 CHARACTERS                               00940000
011400     BLOCK CONTAINS 0 RECORDS.                                    00950000
011500                                                                  00960000
011600 01  PRINT-LINE                       PIC X(132).                 00970000
011700*                                                                 00980000
011800******************************************************************00990000
011900 WORKING-STORAGE SECTION.                                         01000000
012000*                                                                 01010000
012700 01  CONTROL-DATA-IN.                                             01020000
012800     05  CTL-PROCESSING-DATE           PIC X(10).                 01030000
013500     05  FILLER                        PIC X(70).                 01040000
013600*                                                                 01050000
014200******************************************************            01060000
014300** STANDARD HEADER LINE - KOHLS 132 COL                           01070000
014400******************************************************            01080000
014500     COPY DPWS132.                                                01090000
014600*                                                                 01100000
014700 01  HEADING-LINE-2.                                              01110000
015300     05  FILLER                       PIC X(57)  VALUE SPACES.    01120000
015400     05  FILLER                       PIC X(17)  VALUE            01130000
015500         'SKU ON HAND ERROR'.                                     01140000
015600     05  FILLER                       PIC X(58)  VALUE SPACES.    01150000
015700*                                                                 01160000
015800 01  HEADING-LINE-3.                                              01170000
015900     05  FILLER                       PIC X(02)  VALUE SPACES.    01180000
016000     05  FILLER                       PIC X(06)  VALUE 'DEPT: '.  01190000
016100     05  HL3-DEPT                     PIC ZZZ9.                   01200000
016200     05  FILLER                       PIC X(02)  VALUE SPACES.    01210000
016300     05  FILLER                       PIC X(13)  VALUE            01220000
016400                                                 'MAJOR CLASS: '. 01230000
016500     05  HL3-MAJOR-CLASS              PIC ZZZ9.                   01240000
016600     05  FILLER                       PIC X(02)  VALUE SPACES.    01250000
016601     05  FILLER                       PIC X(10)  VALUE            01260000
016602                                                 'SUBCLASS: '.    01270000
016700     05  HL3-SUBCLASS                 PIC ZZZ9.                   01280000
016800     05  FILLER                       PIC X(85)  VALUE SPACES.    01290000
017210*                                                                 01300000
017400 01  HEADING-LINE-4.                                              01310000
017500     05  FILLER                       PIC X(05)  VALUE SPACES.    01320000
017700     05  FILLER                       PIC X(03)  VALUE 'SKU'.     01330000
017800     05  FILLER                       PIC X(63)  VALUE SPACES.    01340000
OCFSFS     05  FILLER                       PIC X(19)  VALUE            01350038
OCFSFS         ' BATCH     BATCH   '.                                   01360038
OCFSFS     05  FILLER                       PIC X(42)  VALUE SPACES.    01370038
018100*                                                                 01380000
018200 01  HEADING-LINE-5.                                              01390000
018300     05  FILLER                       PIC X(04)  VALUE SPACES.    01400000
018400     05  FILLER                       PIC X(46)  VALUE            01410000
018700         'NUMBER    STORE    ORDER NUMBER   UPDATE TYPE '.        01420000
018701     05  FILLER                       PIC X(43)  VALUE            01430000
OCFSFS         'FIELD      QTY   ACT    NO   DESCRIPTION  '.            01440038
018703     05  FILLER                       PIC X(09)  VALUE SPACES.    01450000
018704     05  FILLER                       PIC X(16)  VALUE            01460000
018705         ' *** MESSAGE ***'.                                      01470000
018706     05  FILLER                       PIC X(14)  VALUE SPACES.    01480000
019700*                                                                 01490000
019800 01  DETAIL-LINE-1.                                               01500000
019900     05  FILLER                       PIC X(03)  VALUE SPACES.    01510000
020000     05  DL1-SKU-NBR                  PIC X(08).                  01520000
020100     05  FILLER                       PIC X(03)  VALUE SPACES.    01530028
020200     05  DL1-STORE-NBR                PIC ZZZZ9.                  01540028
020300     05  FILLER                       PIC X(03)  VALUE SPACES.    01550058
020301     05  DL1-ORDER                    PIC X(13).                  01560058
020302     05  FILLER REDEFINES DL1-ORDER.                              01570000
020400         10  DL1-ORDER-NBR            PIC 9(09).                  01580058
020500         10  DL1-DASH                 PIC X(01).                  01590000
020501         10  DL1-RCVR-NBR             PIC 9(03).                  01600000
0518           10  DL1-RCVR-NBR-X REDEFINES DL1-RCVR-NBR                01610053
0518                                        PIC X(03).                  01620053
020502     05  FILLER                       PIC X(03)  VALUE SPACES.    01630000
020600     05  DL1-TYPE-CODE                PIC X(03).                  01640000
020700     05  FILLER                       PIC X(01)  VALUE SPACES.    01650000
OCFSFS     05  DL1-TYPE-DESC                PIC X(14).                  01660038
020800     05  DL1-QTY                      PIC -------9.               01670000
020900     05  FILLER                       PIC X(04)  VALUE SPACES.    01680000
021000     05  DL1-ACTION                   PIC X(01)  VALUE SPACES.    01690000
021100     05  FILLER                       PIC X(04)  VALUE SPACES.    01700000
021200     05  DL1-BATCH                    PIC X(04).                  01710000
021300     05  FILLER                       PIC X(02)  VALUE SPACES.    01720000
021400     05  DL1-BATCH-DESC               PIC X(22).                  01730000
OCFSFS     05  FILLER                       PIC X(01)  VALUE SPACES.    01740038
021710     05  DL1-ERROR-MSG                PIC X(30).                  01750000
022700*                                                                 01760000
027600*                                                                 01770000
027700 01  BLANK-LINE.                                                  01780000
027800     05  FILLER                       PIC X(132) VALUE SPACES.    01790000
027900*                                                                 01800000
028000 01  NO-ERRORS-LINE.                                              01810000
028100     05  FILLER                       PIC X(25)      VALUE        01820000
028200         ' ** NO ERRORS FOUND **   '.                             01830000
027900*                                                                 01840000
028000 01  END-OF-REPORT-LINE.                                          01850000
028100     05  FILLER                       PIC X(25)      VALUE        01860000
028200         ' **  END OF REPORT  **   '.                             01870000
028300*                                                                 01880000
028400*                                                                 01890000
028500 01  PROGRAM-SWITCHES.                                            01900000
028600     05  PS-EOF-CONTROL-FILE         PIC  X(01)    VALUE 'N'.     01910000
028700         88  EOF-CONTROL-FILE                      VALUE 'Y'.     01920000
028800     05  PS-EOF-ADJ-RCPT-CURSOR      PIC  X(01)    VALUE 'N'.     01930000
028900         88  EOF-ADJ-RCPT-CURSOR                   VALUE 'Y'.     01940000
028901     05  PS-EOF-INV-ITEM-CURSOR      PIC  X(01)    VALUE 'N'.     01950000
028902         88  EOF-INV-ITEM-CURSOR                   VALUE 'Y'.     01960000
028903     05  PS-FIRST-TIME-THRU          PIC  X(01)    VALUE 'Y'.     01970000
028904         88  FIRST-TIME-THRU                       VALUE 'Y'.     01980000
031200*                                                                 01990000
031300 01  ABEND-CODE                       PIC S9(04)     VALUE +0     02000000
031400                                                     COMP SYNC.   02010000
031500     88  ABEND-4013                                  VALUE +4013. 02020000
031600*                                                                 02030000
031700 01  PC-CONSTANTS.                                                02040000
031800     05  PC-PROGRAM-NAME             PIC X(08)  VALUE 'FSKRP121'. 02050000
033100     05  PC-1                        PIC S9(03) VALUE +1          02060000
033200                                                COMP-3.           02070000
033300     05  PC-2                        PIC S9(03) VALUE +2          02080000
033400                                                COMP-3.           02090000
033401     05  PC-MAX-LINES                PIC S9(3)  VALUE +56         02100000
033402                                                COMP-3.           02110000
033403*                                                                 02120000
033404 01  PV-PROGRAM-VARIABLES.                                        02130000
046200     05  PV-PREV-DEPT                PIC 9(04).                   02140000
046201     05  PV-PREV-MAJ-CL              PIC 9(04).                   02150000
046202     05  PV-PREV-SUB-CL              PIC 9(04).                   02160000
046203     05  PV-EDIT-SKU                 PIC ZZZZZZZ9.                02170000
046204     05  PV-HOLD-SKU                 PIC X(08).                   02180000
046205     05  PV-RECS-PROCESSED           PIC S9(09) COMP-3 VALUE +0.  02190000
0618       05  PV-BOSS-PROCESSED           PIC S9(09) COMP-3 VALUE +0.  02200062
0518       05  PV-BOSS-PARM-RECV           PIC S9(09) COMP.             02210053
0518       05  PV-BOSS-PARM-DISP           PIC --------9.               02220059
046206     05  PV-DISP-RECS-PROC           PIC ZZZ,ZZZ,ZZ9.             02230000
046202     05  PV-BATCH-NBR-ALPHA          PIC X(04) VALUE ZEROS        02240000
                                                     JUST RIGHT.        02250000
046202     05  PV-BATCH-NBR-NUMERIC REDEFINES PV-BATCH-NBR-ALPHA        02260000
046202                                     PIC 9(04).                   02270000
046207*                                                                 02280000
046208     05  PV-EVALUATE-TYPE            PIC X(04).                   02290000
084400         88 PV-ONHAND-ADJ            VALUE '121'.                 02300000
084401         88 PV-STORE-RCPTS           VALUE '123'.                 02310000
OCFSFS         88 PV-SFS-ADJ               VALUE '125'.                 02320037
OCFSFS         88 PV-SFS-SALES-ADJ         VALUE '126'.                 02330038
084404         88 PV-ONHAND-DBL-BK         VALUE '143'.                 02340000
084405         88 PV-RECEIPT-TYPE          VALUE '000'.                 02350000
084406*                                                                 02360000
084407     05  PV-EVALUATE-BATCH           PIC 9(04).                   02370000
084408         88 PV-FAST-TRANSFER         VALUES 001 THRU 366.         02380000
164325         88 PV-MISLOAD-TSFR          VALUES 500 THRU 599.         02390044
0518           88 PV-BOSS-REQS             VALUES 601 THRU 699.         02400057
084601         88 PV-CENTRAL-STOCK         VALUES 701 THRU 731.         02410000
084602         88 PV-IN-STR-PRICE-CHG      VALUE  888.                  02420000
084601         88 PV-DATA-ENTRY-TRANSFER   VALUES 901 THRU 997.         02430000
084603         88 PV-USA-COUNTS            VALUE  9988.                 02440000
084604         88 PV-DATA-ENTRY            VALUE  9999.                 02450000
084605         88 PV-RECEIPT               VALUES 9001 THRU 9366.       02460000
RONNA          88 PV-OMS-CENTRAL-STOCK     VALUES 801 THRU 831.         02470034
                                                                        02480000
084407     05  PV-EVALUATE-BATCH-X         PIC X(04) JUST RIGHT.        02490000
084408         88 PV-FAST-TRANSFER-X       VALUES ' 001' THRU ' 366'.   02500000
084408         88 PV-FAST-TRANSFER-X2      VALUES '001 ' THRU '366 '.   02510000
164325         88 PV-MISLOAD-TSFR-X        VALUES ' 500' THRU ' 599'.   02520044
164325         88 PV-MISLOAD-TSFR-X2       VALUES '500 ' THRU '599 '.   02530044
0518           88 PV-BOSS-REQS-X           VALUES ' 601' THRU ' 699'.   02540057
0518           88 PV-BOSS-REQS-X2          VALUES '601 ' THRU '699 '.   02550057
084601         88 PV-CENTRAL-STOCK-X       VALUES ' 701' THRU ' 731'.   02560000
084601         88 PV-CENTRAL-STOCK-X2      VALUES '701 ' THRU '731 '.   02570000
084602         88 PV-IN-STR-PRICE-CHG-X    VALUE  ' 888'.               02580000
084602         88 PV-IN-STR-PRICE-CHG-X2   VALUE  '888 '.               02590000
084601         88 PV-DATA-ENTRY-TRANSFER-X VALUES ' 901' THRU ' 997'.   02600000
084601         88 PV-DATA-ENTRY-TRANSFER-X2 VALUES '901 ' THRU '997 '.  02610000
MK             88 PV-INVENTORY             VALUES 'INV3', 'INOL',       02620028
084608                                            'INAD'.               02630000
MK             88 PV-ECOM                  VALUES 'ECOM'.               02640028
RONNA          88 PV-OMS-CENTRAL-STOCK-X   VALUES ' 801' THRU ' 831'.   02650034
RONNA          88 PV-OMS-CENTRAL-STOCK-X2  VALUES '801 ' THRU '831 '.   02660034
OCFSFS         88 PV-OCF-ADJ               VALUE 'SFS'.                 02670037
111890         88 PV-RFID-ADJ              VALUE 'RFID'.                02680043
GIV2FS         88 PV-GIV-ADJ               VALUE 'GIV'.                 02690050
084609*                                                                 02700000
084610     05  PV-PAGE-CNT                 PIC S9(5)     VALUE +0       02710000
084611                                                   COMP-3.        02720000
084612     05  PV-LINE-CNT                 PIC S9(3)     VALUE +0       02730000
084613                                                   COMP-3.        02740000
084614     05  PV-PARAGRAPH-NAME           PIC X(30)     VALUE SPACES.  02750000
084615     05  PV-DB2-OPER-ATTEMPTED       PIC X(30)     VALUE SPACES.  02760000
084616*                                                                 02770000
084617 01  CD-CPU-DATE                      PIC 9(08).                  02780000
084618 01  FILLER REDEFINES CD-CPU-DATE.                                02790000
084619     05  CD-CPU-YEAR                  PIC 9(04).                  02800000
084620     05  CD-CPU-MON                   PIC 9(02).                  02810000
084621     05  CD-CPU-DAY                   PIC 9(02).                  02820000
084622*                                                                 02830000
084623 01  CT-CPU-TIME.                                                 02840000
084624     05  CT-CPU-HR                    PIC 9(02)     VALUE ZEROS.  02850000
084625     05  CT-CPU-MIN                   PIC 9(02)     VALUE ZEROS.  02860000
084626     05  CT-CPU-SEC                   PIC 9(02)     VALUE ZEROS.  02870000
084627     05  CT-CPU-HSEC                  PIC 9(02)     VALUE ZEROS.  02880000
084628*                                                                 02890000
084629***********************                                           02900000
084630*  DB2 TABLE LAYOUTS  *                                           02910000
084631***********************                                           02920000
084632*                                                                 02930000
084633     EXEC SQL                                                     02940000
084634         INCLUDE TSKXREF                                          02950000
084635     END-EXEC.                                                    02960000
084636*                                                                 02970000
0518       EXEC SQL                                                     02980053
0518           INCLUDE TKRPRPM                                          02990053
0518       END-EXEC.                                                    03000053
0518  *                                                                 03010053
084637*************************************                             03020000
084638*   ONHAND EDIT ERROR TYPE TABLE                                  03030000
084639*************************************                             03040000
084640     EXEC SQL                                                     03050000
084641         INCLUDE FST00002                                         03060000
084642     END-EXEC.                                                    03070000
084643*                                                                 03080000
084644**********************************************                    03090000
084645*   ONHAND ADJUSTMENT AUDIT TEMPORARY TABLE                       03100000
084646**********************************************                    03110000
084647     EXEC SQL                                                     03120000
084648         INCLUDE FST00003                                         03130000
084649     END-EXEC.                                                    03140000
084650*                                                                 03150000
084651**********************************************                    03160000
084652*   ONHAND RECEIPTS AUDIT TEMPORARY TABLE                         03170000
084653**********************************************                    03180000
084654     EXEC SQL                                                     03190000
084655         INCLUDE FST00004                                         03200000
084656     END-EXEC.                                                    03210000
084657*                                                                 03220000
084658*                                                                 03230000
084659* DB2 COMMUNICATION AREA                                          03240000
084660*                                                                 03250000
084661     EXEC SQL                                                     03260000
084662         INCLUDE SQLCA                                            03270000
084663     END-EXEC.                                                    03280000
084664*                                                                 03290000
084665* DB2 COMMUNICATION AREA2                                         03300000
084666*                                                                 03310000
084667     COPY SQLCA2.                                                 03320000
084668 EJECT                                                            03330000
084669*                                                                 03340000
084670* CURSOR FOR ADJUSTMENT & RECEIPT ERRORS                          03350000
084671*                                                                 03360000
084672     EXEC SQL                                                     03370000
084673       DECLARE ADJ_RCPT_ERR_CSR CURSOR FOR                        03380000
084674         SELECT A.DEPT_NBR                                        03390000
084675               ,A.MAJ_CL_NBR                                      03400000
084676               ,A.SUB_CL_NBR                                      03410000
084677               ,B.SKU                                             03420000
084680               ,A.LOC_NBR                                         03430000
084690               ,A.ADJ_TYP_CDE                                     03440000
084700               ,A.ACTN_CDE                                        03450000
084800               ,A.ADJ_QTY                                         03460000
084900               ,A.BTCH_NBR                                        03470000
085000               ,0                                                 03480000
085100               ,0                                                 03490000
085120               ,E.ERR_TYP_DESC                                    03500000
085200           FROM FSTT_OH_ADJ_AUD A                                 03510000
085300               ,TSKXREF B                                         03520000
085310               ,FST_OH_ERR_TYP E                                  03530000
085400          WHERE A.ITM_NBR = B.ITM_NBR                             03540000
085410            AND A.ERR_TYP_CDE = E.ERR_TYP_CDE                     03550000
085500            AND A.PRCG_DTE = :CTL-PROCESSING-DATE                 03560000
085600            AND A.TRN_STAT_CDE = 'E'                              03570000
085700            AND B.SKU_STAT_CDE > '00'                             03580000
085800       UNION ALL                                                  03590000
085900         SELECT C.DEPT_NBR                                        03600000
086000               ,C.MAJ_CL_NBR                                      03610000
086100               ,C.SUB_CL_NBR                                      03620000
086200               ,D.SKU                                             03630000
086300               ,C.LOC_NBR                                         03640000
086400               ,'000'                                             03650000
086500               ,' '                                               03660000
086600               ,C.LOC_RCPT_QTY                                    03670000
086700               ,C.BTCH_NBR                                        03680000
086800               ,C.PO_NBR                                          03690000
086900               ,C.RCVR_NBR                                        03700000
086920               ,F.ERR_TYP_DESC                                    03710000
087000           FROM FSTT_OH_RCPT_AUD C                                03720000
087100               ,TSKXREF D                                         03730000
087110               ,FST_OH_ERR_TYP F                                  03740000
087200          WHERE C.ITM_NBR = D.ITM_NBR                             03750000
087210            AND C.ERR_TYP_CDE = F.ERR_TYP_CDE                     03760000
087300            AND C.PRCG_DTE = :CTL-PROCESSING-DATE                 03770000
087400            AND C.TRN_STAT_CDE = 'E'                              03780000
087500            AND D.SKU_STAT_CDE > '00'                             03790000
087600          ORDER BY 1,2,3,4,5                                      03800000
087700       WITH UR                                                    03810000
087800       FOR FETCH ONLY                                             03820000
087801     END-EXEC.                                                    03830000
087802*                                                                 03840000
087803*                                                                 03850000
087804* CURSOR FOR INVALID ITEM NUMBERS                                 03860000
MK    *   - 004 IS THE ERROR TYPE CODE FOR AN INVALID ITEM NUMBER       03870033
087805*                                                                 03880000
087806     EXEC SQL                                                     03890000
087807       DECLARE INVALID_ITEM_CSR CURSOR FOR                        03900000
087808         SELECT A.DEPT_NBR                                        03910000
087809               ,A.MAJ_CL_NBR                                      03920000
087810               ,A.SUB_CL_NBR                                      03930000
087812               ,A.LOC_NBR                                         03940000
087813               ,A.ADJ_TYP_CDE                                     03950000
087814               ,A.ACTN_CDE                                        03960000
087815               ,A.ADJ_QTY                                         03970000
087816               ,A.BTCH_NBR                                        03980000
087817               ,0                                                 03990000
087818               ,0                                                 04000000
087819               ,E.ERR_TYP_DESC                                    04010000
087820           FROM FSTT_OH_ADJ_AUD A                                 04020000
087822               ,FST_OH_ERR_TYP E                                  04030000
087824          WHERE A.ERR_TYP_CDE = E.ERR_TYP_CDE                     04040031
087825            AND A.PRCG_DTE = :CTL-PROCESSING-DATE                 04050000
MK                AND A.ERR_TYP_CDE = '004'                             04060033
087826            AND A.TRN_STAT_CDE = 'E'                              04070000
087828       UNION ALL                                                  04080000
087829         SELECT C.DEPT_NBR                                        04090000
087830               ,C.MAJ_CL_NBR                                      04100000
087831               ,C.SUB_CL_NBR                                      04110000
087833               ,C.LOC_NBR                                         04120000
087834               ,'000'                                             04130000
087835               ,' '                                               04140000
087836               ,C.LOC_RCPT_QTY                                    04150000
087837               ,C.BTCH_NBR                                        04160000
087838               ,C.PO_NBR                                          04170000
087839               ,C.RCVR_NBR                                        04180000
087840               ,F.ERR_TYP_DESC                                    04190000
087841           FROM FSTT_OH_RCPT_AUD C                                04200000
087843               ,FST_OH_ERR_TYP F                                  04210000
087845          WHERE C.ERR_TYP_CDE = F.ERR_TYP_CDE                     04220031
087846            AND C.PRCG_DTE = :CTL-PROCESSING-DATE                 04230000
MK                AND C.ERR_TYP_CDE = '004'                             04240033
087847            AND C.TRN_STAT_CDE = 'E'                              04250000
087849          ORDER BY 1,2,3,4,5                                      04260000
087850       WITH UR                                                    04270000
087851       FOR FETCH ONLY                                             04280000
087852     END-EXEC.                                                    04290000
087853*                                                                 04300000
087854*---------------------------------------------------------------* 04310000
087855*   ERROR MESSAGE AREA FOR DB2                                    04320000
087856*---------------------------------------------------------------* 04330000
087857     COPY DPWS004.                                                04340000
087858*                                                                 04350000
087859 EJECT                                                            04360000
087860*                                                                 04370000
087861 LINKAGE SECTION.                                                 04380000
087862***************************************************************** 04390000
087863*PROCEDURE DIVISION.                                              04400000
087864***************************************************************** 04410000
087865 PROCEDURE DIVISION.                                              04420000
087866*                                                                 04430000
087867 A100-MAINLINE-PROCESSING.                                        04440000
087868*                                                                 04450000
087869     PERFORM B100-INITIALIZATION.                                 04460000
087870*                                                                 04470000
087871     PERFORM B200-PROCESS-ADJ-RCPT-CURSOR                         04480000
087872             UNTIL EOF-ADJ-RCPT-CURSOR.                           04490000
087873*                                                                 04500000
087874     PERFORM Z300-CLOSE-ADJ-RCPT-CURSOR.                          04510000
087875     PERFORM Z500-OPEN-INV-ITEM-CURSOR.                           04520000
087876*                                                                 04530000
087877     PERFORM B300-PROCESS-INV-ITEM-CURSOR                         04540000
087878             UNTIL EOF-INV-ITEM-CURSOR.                           04550000
087879*                                                                 04560000
087880     PERFORM B400-END-ROUTINE.                                    04570000
087881*                                                                 04580000
087882     STOP RUN.                                                    04590000
087883*                                                                 04600000
087884 EJECT                                                            04610000
087885***************************************************************** 04620000
087886*                                                                 04630000
087887*  - GET SYSTEM DATE & TIME AND MOVE TO REPORT HEADER             04640000
087888*  - READ CONTROL CARD WITH PROCESSING DATE                       04650000
087889*  - OPEN CURSOR                                                  04660000
087890*                                                                 04670000
087891***************************************************************** 04680000
087892 B100-INITIALIZATION.                                             04690000
087893*                                                                 04700000
087894     ACCEPT CT-CPU-TIME FROM TIME.                                04710000
087895     ACCEPT CD-CPU-DATE FROM DATE YYYYMMDD.                       04720000
087896*                                                                 04730000
087897     MOVE CT-CPU-HR     TO DP132-RUN-HOUR.                        04740000
087898     MOVE CT-CPU-MIN    TO DP132-RUN-MINUTE.                      04750000
087899*                                                                 04760000
087900     MOVE CD-CPU-MON    TO DP132-RUN-MONTH.                       04770000
087901     MOVE CD-CPU-DAY    TO DP132-RUN-DAY.                         04780000
087902     MOVE CD-CPU-YEAR   TO DP132-RUN-YEAR.                        04790000
087903*                                                                 04800000
087904     MOVE 1  TO DP132-REPORT-NUMBER                               04810000
087905                DP132-PAGE-NUMBER.                                04820000
087906     MOVE PC-PROGRAM-NAME TO DP132-PROGRAM-NAME.                  04830000
087907*                                                                 04840000
087908     OPEN INPUT  CONTROL-FILE                                     04850000
087909          OUTPUT PRINT-REPORT.                                    04860000
087910*                                                                 04870000
087911     PERFORM Z100-READ-CONTROL-FILE.                              04880000
087920*                                                                 04890000
0518       PERFORM C600-GET-BOSS-PARM-RCVR.                             04900060
0518                                                                    04910060
088000     PERFORM Z200-OPEN-ADJ-RCPT-CURSOR.                           04920000
088001                                                                  04930000
088002 EJECT                                                            04940000
088003***************************************************************** 04950000
088004*                                                                 04960000
088005*  - FETCH ROW FROM CURSOR                                        04970000
088006*  - CHECK FOR BREAKS                                             04980000
088007*  - PRINT DETAIL LINE                                            04990000
088008*                                                                 05000000
088009***************************************************************** 05010000
088010 B200-PROCESS-ADJ-RCPT-CURSOR.                                    05020000
088011*                                                                 05030000
088012     PERFORM C100-FETCH-ADJ-RCPT-CSR.                             05040000
088013*                                                                 05050000
088014     IF EOF-ADJ-RCPT-CURSOR                                       05060000
088015        CONTINUE                                                  05070000
088016     ELSE                                                         05080000
088017        IF FIRST-TIME-THRU                                        05090000
088018           PERFORM C200-DEPT-MCL-BREAK                            05100000
088019           MOVE 'N' TO PS-FIRST-TIME-THRU                         05110000
088020        ELSE                                                      05120000
088030           IF (FST00003-DEPT-NBR NOT = PV-PREV-DEPT) OR           05130000
088040              (FST00003-MAJ-CL-NBR NOT = PV-PREV-MAJ-CL)          05140000
088050               PERFORM C200-DEPT-MCL-BREAK                        05150000
088060           ELSE                                                   05160000
088070              IF (FST00003-SUB-CL-NBR NOT = PV-PREV-SUB-CL)       05170000
088080                 PERFORM C300-SUBCLASS-BREAK                      05180000
088090              END-IF                                              05190000
088100           END-IF                                                 05200000
088200        END-IF                                                    05210000
088300                                                                  05220000
088310        MOVE SKXREF-SKU  TO PV-EDIT-SKU                           05230000
088320        MOVE PV-EDIT-SKU TO PV-HOLD-SKU                           05240000
088330                                                                  05250000
088400        PERFORM C400-FORMAT-DETAIL-LINE                           05260000
088500     END-IF.                                                      05270000
088501                                                                  05280000
088502 EJECT                                                            05290000
088503***************************************************************** 05300000
088504*                                                                 05310000
088505*  - FETCH ROW FROM INVALID ITEM CURSOR                           05320000
088506*  - CHECK FOR BREAKS                                             05330000
088507*  - PRINT DETAIL LINE                                            05340000
088508*                                                                 05350000
088509***************************************************************** 05360000
088510 B300-PROCESS-INV-ITEM-CURSOR.                                    05370000
088511*                                                                 05380000
088512     PERFORM C500-FETCH-INV-ITEM-CSR.                             05390000
088513*                                                                 05400000
088514     IF EOF-INV-ITEM-CURSOR                                       05410000
088515        CONTINUE                                                  05420000
088516     ELSE                                                         05430000
088517        IF FIRST-TIME-THRU                                        05440000
088518           PERFORM C200-DEPT-MCL-BREAK                            05450000
088519           MOVE 'N' TO PS-FIRST-TIME-THRU                         05460000
088520        ELSE                                                      05470000
088521           IF (FST00003-DEPT-NBR NOT = PV-PREV-DEPT) OR           05480000
088522              (FST00003-MAJ-CL-NBR NOT = PV-PREV-MAJ-CL)          05490000
088523               PERFORM C200-DEPT-MCL-BREAK                        05500000
088524           ELSE                                                   05510000
088525              IF (FST00003-SUB-CL-NBR NOT = PV-PREV-SUB-CL)       05520000
088526                 PERFORM C300-SUBCLASS-BREAK                      05530000
088527              END-IF                                              05540000
088528           END-IF                                                 05550000
088529        END-IF                                                    05560000
088530                                                                  05570000
088531        MOVE 'INVALID' TO PV-HOLD-SKU                             05580000
088532                                                                  05590000
088533        PERFORM C400-FORMAT-DETAIL-LINE                           05600000
088534     END-IF.                                                      05610000
088535                                                                  05620000
088536 EJECT                                                            05630000
088537***************************************************************** 05640000
088538*                                                                 05650000
088540*  - IF NO ERRORS FOUND, PRINT HEADERS & MESSAGE                  05660000
088540*  - PRINT "END" MESSAGE                                          05670000
088539*  - PRINT CONTROL TOTALS, CLOSE FILES                            05680000
088540*                                                                 05690000
088541***************************************************************** 05700000
088542 B400-END-ROUTINE.                                                05710000
088543*                                                                 05720000
           IF PV-RECS-PROCESSED = ZERO                                  05730000
222261        ADD PC-1 TO PV-PAGE-CNT                                   05740000
222262        MOVE PV-PAGE-CNT TO DP132-PAGE-NUMBER                     05750000
222263*                                                                 05760000
222264        WRITE PRINT-LINE FROM DP132-STANDRD-HEADER-132-COLS       05770000
222265            AFTER ADVANCING PAGE                                  05780000
222266*                                                                 05790000
222267        WRITE PRINT-LINE FROM HEADING-LINE-2                      05800000
222268           AFTER ADVANCING PC-1                                   05810000
222266*                                                                 05820000
222267        WRITE PRINT-LINE FROM NO-ERRORS-LINE                      05830000
222268           AFTER ADVANCING PC-2                                   05840000
           END-IF.                                                      05850000
222269*                                                                 05860000
088544     WRITE PRINT-LINE FROM END-OF-REPORT-LINE                     05870000
088545         AFTER ADVANCING PC-2.                                    05880000
088546*                                                                 05890000
088547     MOVE PV-RECS-PROCESSED TO PV-DISP-RECS-PROC.                 05900000
088548     DISPLAY '*************************************************'. 05910000
088549     DISPLAY 'FSKRP121 - RECORDS PROCESSED: ' PV-DISP-RECS-PROC.  05920000
0618       MOVE PV-BOSS-PROCESSED TO PV-DISP-RECS-PROC.                 05930062
0618       DISPLAY '      BOSS RECORDS PROCESSED: ' PV-DISP-RECS-PROC.  05940062
088550     DISPLAY '*************************************************'. 05950000
088551*                                                                 05960000
088560     CLOSE CONTROL-FILE                                           05970000
210700           PRINT-REPORT.                                          05980000
210701*                                                                 05990000
210702     PERFORM Z600-CLOSE-INV-ITEM-CURSOR.                          06000000
210703                                                                  06010000
210704 EJECT                                                            06020000
211000***************************************************************** 06030000
211100*                                                                 06040000
211200*  - FETCH ROW FROM ADJUSTMENT RECEIPT ERROR CURSOR               06050000
211600*                                                                 06060000
211700***************************************************************** 06070000
211800 C100-FETCH-ADJ-RCPT-CSR.                                         06080000
211801*                                                                 06090000
222242     MOVE 'C100-FETCH-ADJ-RCPT-CSR'  TO PV-PARAGRAPH-NAME.        06100000
222243     MOVE 'FETCH ADJ RECEIPT CURSOR' TO PV-DB2-OPER-ATTEMPTED.    06110000
221109*                                                                 06120000
211802     EXEC SQL                                                     06130000
211803         FETCH ADJ_RCPT_ERR_CSR                                   06140000
211804          INTO :FST00003-DEPT-NBR,                                06150000
211805               :FST00003-MAJ-CL-NBR,                              06160000
211806               :FST00003-SUB-CL-NBR,                              06170000
211807               :SKXREF-SKU,                                       06180000
211808               :FST00003-LOC-NBR,                                 06190000
211809               :FST00003-ADJ-TYP-CDE,                             06200000
211810               :FST00003-ACTN-CDE,                                06210000
211811               :FST00003-ADJ-QTY,                                 06220000
211812               :FST00003-BTCH-NBR,                                06230000
211813               :FST00004-PO-NBR,                                  06240000
211814               :FST00004-RCVR-NBR,                                06250000
211815               :FST00002-ERR-TYP-DESC                             06260000
211816     END-EXEC.                                                    06270000
211817*                                                                 06280000
211818     EVALUATE TRUE                                                06290000
211819         WHEN SQLCODE = ZERO                                      06300000
211820             CONTINUE                                             06310000
211821         WHEN SQLCODE = +100                                      06320000
211822             SET EOF-ADJ-RCPT-CURSOR TO TRUE                      06330000
211823         WHEN SQLWARN0 NOT = SPACES                               06340000
211824         WHEN SQLCODE  NOT = ZERO                                 06350000
211825             PERFORM Z999-SQL-ABEND                               06360000
211826     END-EVALUATE.                                                06370000
211827                                                                  06380000
211828 EJECT                                                            06390000
211829***************************************************************** 06400000
211830*                                                                 06410000
211831*  - PAGE BREAK FOR NEW DEPT OR MAJOR CLASS                       06420000
211832*                                                                 06430000
211833***************************************************************** 06440000
211834 C200-DEPT-MCL-BREAK.                                             06450000
211835*                                                                 06460000
211836     MOVE FST00003-DEPT-NBR   TO HL3-DEPT.                        06470000
211837     MOVE FST00003-MAJ-CL-NBR TO HL3-MAJOR-CLASS.                 06480000
211838     MOVE FST00003-SUB-CL-NBR TO HL3-SUBCLASS.                    06490000
211839*                                                                 06500000
211840     PERFORM Z400-PRINT-REPORT-HEADERS.                           06510000
211841*                                                                 06520000
211850     MOVE FST00003-DEPT-NBR   TO PV-PREV-DEPT.                    06530000
211860     MOVE FST00003-MAJ-CL-NBR TO PV-PREV-MAJ-CL.                  06540000
211870     MOVE FST00003-SUB-CL-NBR TO PV-PREV-SUB-CL.                  06550000
211871*                                                                 06560000
211872***************************************************************** 06570000
211873*                                                                 06580000
211874*  - PRINT DEPT/MAJOR CLASS/SUBCLASS LINE WHEN SUBCLASS CHANGES   06590000
211875*                                                                 06600000
211876***************************************************************** 06610000
211877 C300-SUBCLASS-BREAK.                                             06620000
211878*                                                                 06630000
211879     MOVE FST00003-SUB-CL-NBR TO HL3-SUBCLASS.                    06640000
215900*                                                                 06650000
216000     WRITE PRINT-LINE FROM HEADING-LINE-3                         06660000
216100         AFTER ADVANCING PC-2.                                    06670000
216200*                                                                 06680000
216300     MOVE FST00003-SUB-CL-NBR TO PV-PREV-SUB-CL.                  06690000
216301                                                                  06700000
216302 EJECT                                                            06710000
216303***************************************************************** 06720000
216304*                                                                 06730000
216305*  - MOVE DATA TO DETAIL LINE & PRINT                             06740000
216306*                                                                 06750000
216307***************************************************************** 06760000
216308 C400-FORMAT-DETAIL-LINE.                                         06770000
216309*                                                                 06780000
           INITIALIZE PV-BATCH-NBR-ALPHA                                06790000
                      PV-BATCH-NBR-NUMERIC                              06800000
                      PV-EVALUATE-BATCH                                 06810000
                      PV-EVALUATE-BATCH-X.                              06820000
                                                                        06830000
216310     MOVE PV-HOLD-SKU           TO DL1-SKU-NBR.                   06840000
216320     MOVE FST00003-LOC-NBR      TO DL1-STORE-NBR.                 06850000
216330     MOVE SPACES                TO DL1-ORDER.                     06860000
216370     MOVE FST00003-ADJ-TYP-CDE  TO DL1-TYPE-CODE.                 06870000
216380     MOVE FST00003-ADJ-QTY      TO DL1-QTY.                       06880000
216390     MOVE FST00003-ACTN-CDE     TO DL1-ACTION.                    06890000
216400     MOVE FST00003-BTCH-NBR     TO DL1-BATCH.                     06900000
216410     MOVE FST00002-ERR-TYP-DESC TO DL1-ERROR-MSG.                 06910000
216500*                                                                 06920000
           MOVE FST00003-BTCH-NBR TO PV-BATCH-NBR-ALPHA.                06930000
                                                                        06940049
           IF PV-BATCH-NBR-NUMERIC NUMERIC                              06950000
              MOVE FST00003-BTCH-NBR TO PV-EVALUATE-BATCH               06960000
           ELSE                                                         06970000
              MOVE FST00003-BTCH-NBR TO PV-EVALUATE-BATCH-X             06980000
           END-IF.                                                      06990000
                                                                        07000049
216700     EVALUATE TRUE                                                07010000
216800        WHEN PV-FAST-TRANSFER OR PV-FAST-TRANSFER-X               07020000
216800                              OR PV-FAST-TRANSFER-X2              07030000
216900            MOVE 'FAST TRANSFER'         TO DL1-BATCH-DESC        07040000
0518          WHEN PV-BOSS-REQS OR PV-BOSS-REQS-X                       07050057
0518                           OR PV-BOSS-REQS-X2                       07060057
0518              MOVE 'BOSS TRANSFERS '       TO DL1-BATCH-DESC        07070054
217200        WHEN PV-CENTRAL-STOCK OR PV-CENTRAL-STOCK-X               07080000
217200                              OR PV-CENTRAL-STOCK-X2              07090000
217300            MOVE 'CENTRAL STOCK'         TO DL1-BATCH-DESC        07100000
217400        WHEN PV-IN-STR-PRICE-CHG OR PV-IN-STR-PRICE-CHG-X         07110000
217400                                 OR PV-IN-STR-PRICE-CHG-X2        07120000
217500            MOVE 'IN-STORE PRICE CHANGE' TO DL1-BATCH-DESC        07130000
217400        WHEN PV-DATA-ENTRY-TRANSFER OR PV-DATA-ENTRY-TRANSFER-X   07140000
217400                                  OR PV-DATA-ENTRY-TRANSFER-X2    07150000
217500            MOVE 'DATA ENTRY TRANSFER'   TO DL1-BATCH-DESC        07160000
217600        WHEN PV-USA-COUNTS                                        07170000
217700            MOVE 'USA COUNT'             TO DL1-BATCH-DESC        07180000
217800        WHEN PV-DATA-ENTRY                                        07190000
217900            MOVE 'DATA ENTRY'            TO DL1-BATCH-DESC        07200000
218000        WHEN PV-RECEIPT                                           07210000
218100            MOVE 'RECEIPT'               TO DL1-BATCH-DESC        07220000
218200        WHEN PV-INVENTORY                                         07230000
218300            MOVE 'INVENTORY'             TO DL1-BATCH-DESC        07240000
MK            WHEN PV-ECOM                                              07250028
MK                MOVE 'RDM ADJUSTMENT'        TO DL1-BATCH-DESC        07260028
RONNA         WHEN PV-OMS-CENTRAL-STOCK OR PV-OMS-CENTRAL-STOCK-X       07270034
RONNA                                   OR PV-OMS-CENTRAL-STOCK-X2      07280034
RONNA             MOVE 'OMS CENTRAL STOCK'     TO DL1-BATCH-DESC        07290034
OCFSFS        WHEN PV-OCF-ADJ                                           07300037
OCFSFS            MOVE 'OMS SFS'               TO DL1-BATCH-DESC        07310037
111890        WHEN PV-RFID-ADJ                                          07320043
111890            MOVE 'RFID COUNT'            TO DL1-BATCH-DESC        07330043
GIV2FS        WHEN PV-GIV-ADJ                                           07340050
GIV2FS            MOVE 'GIV ADJUSTMENT'        TO DL1-BATCH-DESC        07350050
164325        WHEN PV-MISLOAD-TSFR                                      07360044
164325            MOVE 'MISLOAD TSFR'          TO DL1-BATCH-DESC        07370044
218400        WHEN OTHER                                                07380000
218500            MOVE SPACES                  TO DL1-BATCH-DESC        07390000
218600     END-EVALUATE.                                                07400000
218700*                                                                 07410000
218800     MOVE FST00003-ADJ-TYP-CDE TO PV-EVALUATE-TYPE.               07420000
218900     EVALUATE TRUE                                                07430000
219000        WHEN PV-ONHAND-ADJ                                        07440048
219100            MOVE 'ON HAND ADJ'    TO DL1-TYPE-DESC                07450038
219200        WHEN PV-STORE-RCPTS                                       07460000
219300            MOVE 'STORE RCPTS'    TO DL1-TYPE-DESC                07470038
219800        WHEN PV-ONHAND-DBL-BK                                     07480000
219900            MOVE 'ONHAND DBL BK'  TO DL1-TYPE-DESC                07490038
OCFSFS        WHEN PV-SFS-ADJ                                           07500037
OCFSFS            MOVE 'SFS OH ADJ'     TO DL1-TYPE-DESC                07510038
OCFSFS        WHEN PV-SFS-SALES-ADJ                                     07520038
OCFSFS            MOVE 'SFS SETTLE ADJ' TO DL1-TYPE-DESC                07530038
220000        WHEN PV-RECEIPT-TYPE                                      07540000
220100            MOVE 'RECEIPT'         TO DL1-TYPE-DESC               07550000
220200            MOVE SPACES            TO DL1-TYPE-CODE               07560000
220300            MOVE FST00004-PO-NBR   TO DL1-ORDER-NBR               07570000
220400            MOVE '-'               TO DL1-DASH                    07580000
0518              IF FST00004-RCVR-NBR = PV-BOSS-PARM-RECV              07590053
0518                 MOVE 'BSS'          TO DL1-RCVR-NBR-X              07600053
0618                 ADD 1               TO PV-BOSS-PROCESSED           07610062
0518              ELSE                                                  07620053
220500               MOVE FST00004-RCVR-NBR                             07630052
220500                                   TO DL1-RCVR-NBR                07640052
0518              END-IF                                                07650053
0518                                                                    07660053
220600        WHEN OTHER                                                07670000
220700            MOVE SPACES          TO DL1-TYPE-DESC                 07680000
220800     END-EVALUATE.                                                07690000
220900*                                                                 07700000
221000     PERFORM D100-PRINT-DETAIL-LINE.                              07710000
221100     ADD +1 TO PV-RECS-PROCESSED.                                 07720000
221101                                                                  07730000
221102 EJECT                                                            07740000
221103***************************************************************** 07750000
221104*                                                                 07760000
221105*  - FETCH ROW FROM INVALID ITEM CURSOR                           07770000
221106*                                                                 07780000
221107***************************************************************** 07790000
221108 C500-FETCH-INV-ITEM-CSR.                                         07800000
221109*                                                                 07810000
222242     MOVE 'C500-FETCH-INV-ITEM-CSR'   TO PV-PARAGRAPH-NAME.       07820000
222243     MOVE 'FETCH INVALID ITEM CURSOR' TO PV-DB2-OPER-ATTEMPTED.   07830000
221109*                                                                 07840000
221110     EXEC SQL                                                     07850000
221111         FETCH INVALID_ITEM_CSR                                   07860000
221112          INTO :FST00003-DEPT-NBR,                                07870000
221113               :FST00003-MAJ-CL-NBR,                              07880000
221114               :FST00003-SUB-CL-NBR,                              07890000
221116               :FST00003-LOC-NBR,                                 07900000
221117               :FST00003-ADJ-TYP-CDE,                             07910000
221118               :FST00003-ACTN-CDE,                                07920000
221119               :FST00003-ADJ-QTY,                                 07930000
221120               :FST00003-BTCH-NBR,                                07940000
221121               :FST00004-PO-NBR,                                  07950000
221122               :FST00004-RCVR-NBR,                                07960000
221123               :FST00002-ERR-TYP-DESC                             07970000
221124     END-EXEC.                                                    07980000
221125*                                                                 07990000
221126     EVALUATE TRUE                                                08000000
221127         WHEN SQLCODE = ZERO                                      08010000
221128             CONTINUE                                             08020000
221129         WHEN SQLCODE = +100                                      08030000
221130             SET EOF-INV-ITEM-CURSOR TO TRUE                      08040000
221131         WHEN SQLWARN0 NOT = SPACES                               08050000
221132         WHEN SQLCODE  NOT = ZERO                                 08060000
221133             PERFORM Z999-SQL-ABEND                               08070000
221134     END-EVALUATE.                                                08080000
221135                                                                  08090000
221136 EJECT                                                            08100000
0518  ******************************************************************08110055
0518  *- READ TKRPRPM TO RETRIEVE THE BOSS RECEIVER PARM                08120055
0518  ******************************************************************08130055
0518   C600-GET-BOSS-PARM-RCVR.                                         08140053
0518                                                                    08150053
0518       EXEC SQL                                                     08160053
0518           SELECT FUNC_QTY                                          08170053
0518             INTO :PV-BOSS-PARM-RECV                                08180053
0518             FROM TKRPRPM                                           08190053
0518            WHERE LOC_ID            = 90                            08200053
0518              AND INTFC_SYS_CDE     = 'GIV'                         08210053
0518              AND SYS_PRC_FUNC_CDE  = 'BSSRCV'                      08220053
0518              AND FUNC_PRC_STAT_CDE = 'AC'                          08230053
0518            WITH UR                                                 08240053
0518       END-EXEC.                                                    08250053
0518                                                                    08260053
0518       EVALUATE TRUE                                                08270053
0518           WHEN SQLCODE = ZERO                                      08280053
0518               MOVE PV-BOSS-PARM-RECV      TO PV-BOSS-PARM-DISP     08290059
0518               DISPLAY ' BOSS PARM RECEIVER  = '                    08300053
0618                                              PV-BOSS-PARM-DISP     08310061
0518                                                                    08320053
0518           WHEN SQLWARN0 NOT = SPACES                               08330053
0518           WHEN SQLCODE  NOT = ZERO                                 08340053
0518               PERFORM Z999-SQL-ABEND                               08350053
0518                                                                    08360053
0518       END-EVALUATE.                                                08370053
0518                                                                    08380053
221137***************************************************************** 08390052
221138 D100-PRINT-DETAIL-LINE.                                          08400000
221139*                                                                 08410000
221140     ADD PC-2 TO PV-LINE-CNT.                                     08420000
221141*                                                                 08430000
221142     IF PV-LINE-CNT > PC-MAX-LINES                                08440000
221143        PERFORM Z400-PRINT-REPORT-HEADERS                         08450000
221144        ADD PC-2 TO PV-LINE-CNT                                   08460000
221145     END-IF.                                                      08470000
221146*                                                                 08480000
221147     WRITE PRINT-LINE FROM DETAIL-LINE-1                          08490000
221148         AFTER ADVANCING PC-2.                                    08500000
221149*                                                                 08510000
221150     MOVE SPACES TO PRINT-LINE.                                   08520000
221151*                                                                 08530000
221152                                                                  08540000
221153 EJECT                                                            08550000
221154***************************************************************** 08560000
221155*                                                                 08570000
221156*  - READ CONTROL CARD CONTAINING PROCESSING DATE                 08580000
221157*                                                                 08590000
221158***************************************************************** 08600000
221159 Z100-READ-CONTROL-FILE.                                          08610000
221160*                                                                 08620000
221161     READ CONTROL-FILE INTO CONTROL-DATA-IN                       08630000
221162          AT END SET EOF-CONTROL-FILE TO TRUE.                    08640000
221163*                                                                 08650000
221170     IF EOF-CONTROL-FILE                                          08660000
221500        DISPLAY '** ABEND **'                                     08670000
221600        DISPLAY '** PROGRAM    = ' PC-PROGRAM-NAME                08680000
221700        DISPLAY '** PARAGRAPH  = Z100-READ-CONTROL-FILE'          08690000
221800        DISPLAY '** MESSAGE    = CONTROL FILE DATE NOT FOUND'     08700000
222000        MOVE +4003      TO ABEND-CODE                             08710000
222100        CALL 'ILBOABN0' USING ABEND-CODE                          08720000
222200     END-IF.                                                      08730000
222201                                                                  08740000
222202 EJECT                                                            08750000
222203******************************************************************08760000
222204 Z200-OPEN-ADJ-RCPT-CURSOR.                                       08770000
222205*                                                                 08780000
222206     MOVE 'Z200-OPEN-ADJ-RCPT-CURSOR' TO PV-PARAGRAPH-NAME.       08790000
222207     MOVE 'OPEN CURSOR '              TO PV-DB2-OPER-ATTEMPTED.   08800000
222208*                                                                 08810000
222209     EXEC SQL                                                     08820000
222210         OPEN ADJ_RCPT_ERR_CSR                                    08830000
222211     END-EXEC.                                                    08840000
222212                                                                  08850000
222213     EVALUATE TRUE                                                08860000
222214         WHEN SQLCODE = ZERO                                      08870000
222215             CONTINUE                                             08880000
222216         WHEN OTHER                                               08890000
222217             PERFORM Z999-SQL-ABEND                               08900000
222218     END-EVALUATE.                                                08910000
222219                                                                  08920000
222220*                                                                 08930000
222230******************************************************************08940000
222240 Z300-CLOSE-ADJ-RCPT-CURSOR.                                      08950000
222241*                                                                 08960000
222242     MOVE 'Z300-CLOSE-ADJ-RCPT-CURSOR' TO PV-PARAGRAPH-NAME.      08970000
222243     MOVE 'CLOSE CURSOR '              TO PV-DB2-OPER-ATTEMPTED.  08980000
222244*                                                                 08990000
222245     EXEC SQL                                                     09000000
222246         CLOSE ADJ_RCPT_ERR_CSR                                   09010000
222247     END-EXEC.                                                    09020000
222248                                                                  09030000
222249     EVALUATE TRUE                                                09040000
222250         WHEN SQLCODE = ZERO                                      09050000
222251             CONTINUE                                             09060000
222252         WHEN OTHER                                               09070000
222253             PERFORM Z999-SQL-ABEND                               09080000
222254     END-EVALUATE.                                                09090000
222255                                                                  09100000
222256 EJECT                                                            09110000
222257*                                                                 09120000
222258***************************************************************** 09130000
222259 Z400-PRINT-REPORT-HEADERS.                                       09140000
222260*                                                                 09150000
222261     ADD PC-1 TO PV-PAGE-CNT.                                     09160000
222262     MOVE PV-PAGE-CNT TO DP132-PAGE-NUMBER.                       09170000
222263*                                                                 09180000
222264     WRITE PRINT-LINE FROM DP132-STANDRD-HEADER-132-COLS          09190000
222265         AFTER ADVANCING PAGE.                                    09200000
222266*                                                                 09210000
222267     WRITE PRINT-LINE FROM HEADING-LINE-2                         09220000
222268         AFTER ADVANCING PC-1.                                    09230000
222269*                                                                 09240000
222270     WRITE PRINT-LINE FROM HEADING-LINE-3                         09250000
222271         AFTER ADVANCING PC-1.                                    09260000
222272*                                                                 09270000
222273     WRITE PRINT-LINE FROM HEADING-LINE-4                         09280000
222274         AFTER ADVANCING PC-2.                                    09290000
222275*                                                                 09300000
222276     WRITE PRINT-LINE FROM HEADING-LINE-5                         09310000
222277         AFTER ADVANCING PC-1.                                    09320000
222278*                                                                 09330000
222279     MOVE ZERO TO PV-LINE-CNT.                                    09340000
222280                                                                  09350000
222290 EJECT                                                            09360000
222291******************************************************************09370000
222292 Z500-OPEN-INV-ITEM-CURSOR.                                       09380000
222293*                                                                 09390000
222294     MOVE 'Z500-OPEN-INV-ITEM-CURSOR' TO PV-PARAGRAPH-NAME.       09400000
222295     MOVE 'OPEN CURSOR '              TO PV-DB2-OPER-ATTEMPTED.   09410000
222296*                                                                 09420000
222297     EXEC SQL                                                     09430000
222298         OPEN INVALID_ITEM_CSR                                    09440000
222299     END-EXEC.                                                    09450000
222300                                                                  09460000
222301     EVALUATE TRUE                                                09470000
222302         WHEN SQLCODE = ZERO                                      09480000
222303             CONTINUE                                             09490000
222304         WHEN OTHER                                               09500000
222305             PERFORM Z999-SQL-ABEND                               09510000
222306     END-EVALUATE.                                                09520000
222307                                                                  09530000
222308*                                                                 09540000
222309******************************************************************09550000
222310 Z600-CLOSE-INV-ITEM-CURSOR.                                      09560000
222311*                                                                 09570000
222312     MOVE 'Z600-CLOSE-INV-ITEM-CURSOR' TO PV-PARAGRAPH-NAME.      09580000
222313     MOVE 'CLOSE CURSOR '              TO PV-DB2-OPER-ATTEMPTED.  09590000
222314*                                                                 09600000
222315     EXEC SQL                                                     09610000
222316         CLOSE INVALID_ITEM_CSR                                   09620000
222317     END-EXEC.                                                    09630000
222318                                                                  09640000
222319     EVALUATE TRUE                                                09650000
222320         WHEN SQLCODE = ZERO                                      09660000
222321             CONTINUE                                             09670000
222322         WHEN OTHER                                               09680000
222323             PERFORM Z999-SQL-ABEND                               09690000
222324     END-EVALUATE.                                                09700000
222325                                                                  09710000
222330*                                                                 09720000
222400***************************************************************** 09730000
222500 Z999-SQL-ABEND.                                                  09740000
222600*                                                                 09750000
222700     SET ABEND-4013            TO TRUE.                           09760000
222800     DISPLAY '**  ABEND     **'.                                  09770000
222900     DISPLAY '**  PROGRAM   **  = ' PC-PROGRAM-NAME.              09780000
223000     DISPLAY '**  PARAGRAPH **  = ' PV-PARAGRAPH-NAME.            09790000
223100     DISPLAY '**  OPERATION **  = ' PV-DB2-OPER-ATTEMPTED.        09800000
223200                                                                  09810000
223300*    THE FOLLOWING COPYBOOK UTILIZES THE DB2 ABEND MODULE         09820000
223400*    DSNTIAR TO CONVERT SQLCA INTO UNDERSTANDABLE VERBAGE.        09830000
223500                                                                  09840000
223600     COPY DPPD004.                                                09850000
223700                                                                  09860000
223800     CALL 'ILBOABN0'  USING ABEND-CODE.                           09870000
223900*                                                                 09880000
224000***************************************************************** 09890000
