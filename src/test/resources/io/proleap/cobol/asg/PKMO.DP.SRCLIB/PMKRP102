000100*----------------------------------------------------------       00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300*----------------------------------------------------------       00030000
000400 PROGRAM-ID.             PMKRP102.                                00040000
000500 AUTHOR.                 ALEXIS KEIKER.                           00050000
000600 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00060000
000700 DATE-WRITTEN.           APRIL 2003.                              00070000
000800 DATE-COMPILED.                                                   00080000
000900*----------------------------------------------------------       00090000
001000*          PMKRP102 - PROMO ITEM SALES RESULTS SUMMARY            00100000
001010*                             BY BUYER, BY AD PAGE                00110007
001020*----------------------------------------------------------       00120000
001023* THIS PROGRAM WILL PRODUCE EITHER A FORECAST ONLY REPORT         00130018
001024* OR AN ACTUAL/FORECAST REPORT. THIS PROGRAM WILL READ            00140018
001025* IN A SORTED INPUT FILE CREATED FROM PROGRAM PMKUT100.           00150018
001026* IT WILL THEN REPORT EACH PROMO ITEMS SALE RESULTS.  IF          00160018
001027* IT IS A FORECAST ONLY REPORT THEN THE INPUT FILE WOULD          00170018
001028* HAVE AN 'F' IN THE SLS TYP CDE OF THE FILE.  THIS MEANS         00180018
001029* ONLY FORECASTED INFORMATION WILL BE REPORTED.  IF IT HAS        00190018
001030* AN 'A' IN THE SLS TYP CDE OF THE FILE, IT WILL REPORT ON        00200018
001031* ACTUALS AND FORECASTS. THIS REPORT IS A LITTLE DIFFERENT        00210018
001032* THAN PMKRP100 AND PMKRP101 BECAUSE IT IS TOTALING BY BUYER      00220018
001033* AND NOT JUST PROMOTION.                                         00230018
001034*----------------------------------------------------------       00240000
001035* HISTORY LOG:                                                    00250000
001036*----------------------------------------------------------       00260000
001037* DATE:                                                           00270000
001038* WR/IR#:                                                         00280000
001039* PROGRAMMER:                                                     00290000
001040* DESCRIPTION:                                                    00300000
001041*                                                                 00310000
PM3403* 04/20/2012 - PMO 3403 (LARGE RETAIL PROJECT).  S. JACKSON       00320037
PM3403*   EXPAND UNIT RETAIL FIELDS TO ALLOW FOR AMT > 9999.99          00330035
PGNBR *                                                                 00330138
PGNBR * DATE: 07/25/2014                                                00331038
PGNBR * WR/IR#: PRB 47935                                               00332038
PGNBR * PROGRAMMER: COGNIZANT                                           00333038
PGNBR * DESCRIPTION: MODIFIED THE PROGRAM TO PROCESS THE PROMO ITEMS AS 00334038
PGNBR *              3 CATEGORIES ADVERTISED,ADVERTISED WITH NO PAGE    00335038
PGNBR *              AND UNADVERTISED VS 2 CATEGORIES ADV & UNADV       00336038
PGNBR *                                                                 00337038
001042*----------------------------------------------------------       00340000
001050 ENVIRONMENT DIVISION.                                            00350000
001060*----------------------------------------------------------       00360000
001070 CONFIGURATION SECTION.                                           00370000
001080 SOURCE-COMPUTER. IBM-3090.                                       00380000
001090 OBJECT-COMPUTER. IBM-3090.                                       00390000
001100                                                                  00400000
001200 INPUT-OUTPUT SECTION.                                            00410000
001300                                                                  00420000
001400 FILE-CONTROL.                                                    00430000
001500                                                                  00440000
001600     SELECT PROMO-ITM-SUMM-FILE                                   00450000
001700            ASSIGN TO INP01.                                      00460000
001800                                                                  00470000
001900     SELECT PROMO-ITM-SUMM-REPORT                                 00480000
002000            ASSIGN TO RPT01.                                      00490000
002100                                                                  00500000
002200*----------------------------------------------------------       00510000
002300 DATA DIVISION.                                                   00520000
002400*----------------------------------------------------------       00530000
002500 FILE SECTION.                                                    00540000
002600                                                                  00550000
002700 FD  PROMO-ITM-SUMM-FILE                                          00560000
002800     RECORDING MODE F                                             00570000
002900     BLOCK CONTAINS 0 RECORDS                                     00580000
003000     LABEL RECORDS ARE OMITTED.                                   00590000
003100 01  PROMO-ITM-SUMM-RECORD            PIC X(750).                 00600000
003200                                                                  00610000
003300 FD  PROMO-ITM-SUMM-REPORT                                        00620000
003400     RECORDING MODE F                                             00630000
003500     BLOCK CONTAINS 0 RECORDS                                     00640000
003600     LABEL RECORDS ARE OMITTED.                                   00650000
003700 01  PROMO-ITM-SUMM-RPT-LINE          PIC X(250).                 00660000
003800                                                                  00670000
003900 WORKING-STORAGE SECTION.                                         00680000
004000*----------------------------------------------------------       00690000
004100* CD- CONTROL DATES (DATES ACCEPTED INTO THE PROGRAM)             00700000
004200*----------------------------------------------------------       00710000
004300 01  CD-CONTROL-DATES.                                            00720000
004400     05  CD-CPU-DATE.                                             00730000
004500         10  CD-CPU-YR                PIC 9(02)  VALUE ZEROES.    00740000
004510         10  CD-CPU-MO                PIC 9(02)  VALUE ZEROES.    00750000
004520         10  CD-CPU-DY                PIC 9(02)  VALUE ZEROES.    00760000
004530                                                                  00770000
004540     05  CD-CPU-DATE-GREG.                                        00780000
004550         10  CD-CPU-MM                PIC 9(02)  VALUE ZEROES.    00790000
004560         10  CD-CPU-DD                PIC 9(02)  VALUE ZEROES.    00800000
004570         10  CD-CPU-YY                PIC 9(02)  VALUE ZEROES.    00810000
004580                                                                  00820000
004590     05  CD-CPU-DATE-ISO              PIC X(10)  VALUE SPACES.    00830000
004591                                                                  00840000
004592*----------------------------------------------------------       00850000
004593* CT- CONTROL TIMES (TIMES ACCEPTED INTO THE PROGRAM)             00860000
004594*----------------------------------------------------------       00870000
004595 01  CT-CONTROL-TIMES.                                            00880000
004596     05  CT-CPU-TIME.                                             00890000
004597         10  CT-CPU-HR                PIC 9(02)  VALUE ZEROES.    00900000
004598         10  CT-CPU-MIN               PIC 9(02)  VALUE ZEROES.    00910000
004599         10  CT-CPU-SEC               PIC 9(02)  VALUE ZEROES.    00920000
004600         10  CT-CPU-HSEC              PIC 9(02)  VALUE ZEROES.    00930000
004601                                                                  00940000
004602*----------------------------------------------------------       00950000
004603* PC- PROGRAM CONSTANTS                                           00960000
004604*----------------------------------------------------------       00970000
004605 01  PC-PROGRAM-CONSTANTS.                                        00980000
004606     05  PC-MAX-LINE-CNT              PIC S9(04) VALUE +78 COMP.  00990000
004607     05  PC-SUB-1                     PIC 9(01)  VALUE 1.         01000000
004608     05  PC-SUB-2                     PIC 9(01)  VALUE 2.         01010000
004609     05  PC-DEFAULT-BEG-HR            PIC 9(02)  VALUE 0.         01020000
004610     05  PC-DEFAULT-BEG-MIN           PIC 9(02)  VALUE 0.         01030000
004620     05  PC-DEFAULT-END-HR            PIC 9(02)  VALUE 23.        01040000
004630     05  PC-DEFAULT-END-MIN           PIC 9(02)  VALUE 59.        01050000
004640     05  PC-CHAR-BUY                  PIC X(03)  VALUE 'BUY'.     01060000
004650     05  PC-CHAR-GET                  PIC X(03)  VALUE 'GET'.     01070000
004660     05  PC-CHAR-OFF                  PIC X(03)  VALUE 'OFF'.     01080000
004670     05  PC-CHAR-EFFECTIVE            PIC X(09)  VALUE            01090000
004680                                          'EFFECTIVE'.            01100000
004690     05  PC-FORECAST-RSLT             PIC X(36)  VALUE            01110014
004700         'FORECAST ONLY RESULTS (IN THOUSANDS)'.                  01120014
004800     05  PC-ACTUAL-RSLT               PIC X(36)  VALUE            01130014
004900         'ACTUAL RESULTS (IN THOUSANDS)       '.                  01140014
005000     05  PC-PERCENT-SIGN              PIC X(01)  VALUE '%'.       01150000
005100     05  PC-DOLLAR-SIGN               PIC X(01)  VALUE '$'.       01160000
005200     05  PC-FRONT-PAR                 PIC X(01)  VALUE '('.       01170000
005300     05  PC-BACK-PAR                  PIC X(01)  VALUE ')'.       01180000
005400     05  PC-ONE-LINE                  PIC S9(04) VALUE +1 COMP.   01190000
005500     05  PC-CURRENT-PROGRAM-NAME      PIC X(08)  VALUE            01200000
005600                                                 'PMKRP102'.      01210003
005700     05  PC-COLON                     PIC X(01)  VALUE ':'.       01220000
005800     05  PC-DASH                      PIC X(01)  VALUE '-'.       01230000
005900     05  PC-ALL-DAY                   PIC X(07)  VALUE            01240000
006000                                                 'ALL DAY'.       01250000
006100     05  PC-PROMO-ITEMS-ON-PAGE       PIC X(37)  VALUE            01260000
006200          'PROMO ITEMS ON PAGE:                 '.                01270000
PGNBR      05  PC-PROMO-ITEMS-NO-PAGE       PIC X(37)  VALUE            01271038
PGNBR           'ADVERTISED PROMO ITEMS WITH NO PAGE: '.                01272038
006300     05  PC-TIER-ACT-TITLE            PIC X(24)  VALUE            01280000
006400          ' TIERED ACTUAL RESULTS: '.                             01290000
006500     05  PC-PROMO-ITEMS-UNADV         PIC X(37)  VALUE            01300000
006600          'UNADVERTISED                         '.                01310000
006900     05  PC-TOTAL                     PIC X(21)  VALUE            01320000
007000          'TOTAL:               '.                                01330000
007100     05  PC-TOTAL-FOR-PAGE            PIC X(18)  VALUE            01340000
007200          'TOTAL FOR PAGE:   '.                                   01350000
007300     05  PC-ADV-TOTAL                 PIC X(18)  VALUE            01360000
007400          'ADVERTISED TOTAL: '.                                   01370000
PGNBR      05  PC-ADVNO-TOTAL               PIC X(32)  VALUE            01371038
PGNBR           'ADVERTISED WITH NO PAGE TOTAL: '.                      01372038
007500     05  PC-UNADV-TOTAL               PIC X(20)  VALUE            01380000
007600          'UNADVERTISED TOTAL: '.                                 01390000
007900     05  PC-PROMOTION-TOTAL           PIC X(18)  VALUE            01400000
008000          'PROMOTION TOTAL:  '.                                   01410000
008100                                                                  01420000
008200*----------------------------------------------------------       01430000
008300* PS- PROGRAM SWITCHES                                            01440000
008400*----------------------------------------------------------       01450000
008500 01  PS-PROGRAM-SWITCHES.                                         01460000
008600     05  PS-SALES-RESULTS-SW          PIC X(01)  VALUE 'Y'.       01470000
008700         88  PS-EOF-SALES-RESULTS                VALUE 'N'.       01480000
008800         88  PS-NOT-EOF-SALES-RESULTS            VALUE 'Y'.       01490000
008900     05  PS-FIRST-TIME-SW             PIC X(01)  VALUE 'Y'.       01500000
009000         88  PS-NOT-FIRST-TIME                   VALUE 'N'.       01510000
009100         88  PS-FIRST-TIME                       VALUE 'Y'.       01520000
009500     05  PS-PAGE-SECTION-TTL-SW       PIC X(01)  VALUE 'Y'.       01530000
009600         88  PS-PAGE-SECTION-TTL                 VALUE 'N'.       01540000
009700         88  PS-NO-PAGE-TTL                      VALUE 'Y'.       01550000
009800     05  PS-ADV-PROMO-TTL-SW          PIC X(01)  VALUE 'Y'.       01560000
009900         88  PS-ADV-PROMO-TTL                    VALUE 'N'.       01570000
010000         88  PS-NO-ADV-PROMO-TTL                 VALUE 'Y'.       01580000
PGNBR      05  PS-ADV-NOPGE-TTL-SW          PIC X(01)  VALUE 'Y'.       01581038
PGNBR          88  PS-ADV-NOPGE-TTL                    VALUE 'N'.       01582038
PGNBR          88  PS-NO-ADV-NOPGE-TTL                 VALUE 'Y'.       01583038
010100     05  PS-UNADV-PROMO-TTL-SW        PIC X(01)  VALUE 'Y'.       01590000
010200         88  PS-UNADV-PROMO-TTL                  VALUE 'N'.       01600000
010300         88  PS-NO-UNADV-PROMO-TTL               VALUE 'Y'.       01610000
010700     05  PS-TOT-PROMO-TTL-SW          PIC X(01)  VALUE 'Y'.       01620000
010800         88  PS-TOT-PROMO-TTL                    VALUE 'N'.       01630000
010900         88  PS-NO-TOT-PROMO-TTL                 VALUE 'Y'.       01640000
011000     05  PS-BLANK-LINE-SW             PIC X(01)  VALUE 'Y'.       01650000
011100         88  PS-BLANK-LINE                       VALUE 'N'.       01660000
011200         88  PS-NO-BLANK-LINE                    VALUE 'Y'.       01670000
PGNBR      05  PS-REC-TYPE-FLAG             PIC X(01)  VALUE '0'.       01671038
PGNBR          88  PS-ADVNOPG-FLAG                     VALUE '1'.       01672038
PGNBR          88  PS-ADVPG-FLAG                       VALUE '2'.       01673038
PGNBR          88  PS-NOADV-FLAG                       VALUE '3'.       01674038
PGNBR      05  PS-HOLD-REC-TYPE-FLAG        PIC X(01)  VALUE '0'.       01675038
PGNBR          88  PS-HOLD-ADVNOPG-FLAG                VALUE '1'.       01676038
PGNBR          88  PS-HOLD-ADVPG-FLAG                  VALUE '2'.       01677038
PGNBR          88  PS-HOLD-NOADV-FLAG                  VALUE '3'.       01678038
PGNBR      05  PS-EOF-REC-TYPE-FLAG         PIC X(01)  VALUE '0'.       01679038
PGNBR          88  PS-NO-EOF-REC-TYPE                  VALUE '0'.       01679138
PGNBR          88  PS-EOF-ADVNOPG                      VALUE '1'.       01679238
PGNBR          88  PS-EOF-ADVPG                        VALUE '2'.       01679338
PGNBR          88  PS-EOF-NOADV                        VALUE '3'.       01679438
011300                                                                  01680000
011400*----------------------------------------------------------       01690000
011500* PV- PROGRAM VARIABLES                                           01700000
011600*----------------------------------------------------------       01710000
011700 01  PV-PROGRAM-VARIABLES.                                        01720000
011800     05  PV-ADVANCE-LINES             PIC S9(04) VALUE +1 COMP.   01730000
011900     05  PV-SAVE-LINE-AMT             PIC S9(04) VALUE +1 COMP.   01740000
012000     05  PV-LINE-CNT                  PIC S9(04) VALUE +0 COMP.   01750000
012100     05  PV-PAGE-CNT                  PIC 9(05)  VALUE 0.         01760000
012110     05  PV-VAR-IDX                   PIC S9(04) VALUE +0.        01770017
012200     05  PV-PARAGRAPH-NAME            PIC X(30)  VALUE SPACE.     01780000
012300     05  PV-OPERATION-MSG-1           PIC X(40)  VALUE SPACES.    01790000
012400     05  PV-OPERATION-MSG-2           PIC X(40)  VALUE SPACES.    01800000
012500     05  PV-SAVE-VAR                  PIC X(60)  VALUE SPACES.    01810017
012600     05  PV-SAVE-NUM                  PIC 9(02)  VALUE 0.         01820000
012700     05  PV-SAVE-LENGTH               PIC 9(02)  VALUE 0.         01830000
012710     05  PV-CHAR-LENGTH               PIC 9(02)  VALUE 0.         01840017
012800     05  PV-SUBSCRIPT                 PIC 9(02)  VALUE 0.         01850000
012900     05  PV-PROMO-NM-LENGTH           PIC 9(02)  VALUE 0.         01860000
013000     05  PV-AD-EVNT-NM-LENGTH         PIC 9(02)  VALUE 0.         01870000
013100     05  PV-AD-EVNT-NBR-LENGTH        PIC 9(02)  VALUE 0.         01880000
013110     05  PV-BUYER-FRST-LENGTH         PIC 9(02)  VALUE 0.         01890000
013120     05  PV-BUYER-LAST-LENGTH         PIC 9(02)  VALUE 0.         01900000
013200                                                                  01910000
013300     05  PV-TIER-ITM-DESC.                                        01920000
013400         10  FILLER                   PIC X(01)  VALUE SPACES.    01930000
013500         10  PV-TIER-ITM-DESC-1       PIC X(39)  VALUE SPACES.    01940000
013600     05  PV-THRS-AMT-NUM              PIC 9(08)V9(02) VALUE 0.    01950000
013700     05  PV-THRS-AMT-NUM-X REDEFINES                              01960000
013800         PV-THRS-AMT-NUM              PIC 9(10).                  01970000
013900     05  PV-DISC-PCT-NUM              PIC 9(03)V9(03) VALUE 0.    01980000
014000     05  PV-DISC-PCT-NUM-X REDEFINES                              01990000
014100         PV-DISC-PCT-NUM              PIC 9(06).                  02000000
014200     05  PV-DISC-AMT-NUM              PIC 9(08)V9(02) VALUE 0.    02010000
014300     05  PV-DISC-AMT-NUM-X REDEFINES                              02020000
014400         PV-DISC-AMT-NUM              PIC 9(10).                  02030000
014500     05  PV-SAVE-THRS-AMT.                                        02040000
014600         10  PV-SAVE-THRS-AMT-1       PIC 9(08)  VALUE 0.         02050000
014700         10  PV-SAVE-THRS-AMT-2       PIC 9(02)  VALUE 0.         02060000
014800     05  PV-SAVE-DISC-PCT.                                        02070000
014900         10  PV-SAVE-DISC-PCT-1       PIC 9(03)  VALUE 0.         02080000
015000         10  PV-SAVE-DISC-PCT-2       PIC 9(03)  VALUE 0.         02090000
015100     05  PV-SAVE-DISC-AMT.                                        02100000
015200         10  PV-SAVE-DISC-AMT-1       PIC 9(08)  VALUE 0.         02110000
015300         10  PV-SAVE-DISC-AMT-2       PIC 9(02)  VALUE 0.         02120000
015400     05  PV-THRS-AMT-CHAR             PIC X(08)  VALUE SPACES.    02130000
015500     05  PV-DISC-PCT-CHAR             PIC X(03)  VALUE SPACES.    02140000
015600     05  PV-DISC-AMT-CHAR             PIC X(08)  VALUE SPACES.    02150000
015700     05  PV-THRS-QTY-CHAR             PIC X(05)  VALUE SPACES.    02160000
015800     05  PV-POINTER-FIELD             PIC S9(03) VALUE +0.        02170000
015900     05  PV-LAST-ADEVNT-ID            PIC 9(10)  VALUE 0.         02180000
016000     05  PV-LAST-PROMO-ID             PIC 9(10)  VALUE 0.         02190000
016010     05  PV-LAST-BUYER-NBR            PIC 9(04)  VALUE 0.         02200000
016100     05  PV-TIER-PRICG-ID             PIC 9(10)  VALUE 0.         02210000
016200     05  PV-AD-PG-NBR                 PIC 9(03)  VALUE 0.         02220000
016400     05  PV-ROUND-TO-WHOLE-DOLLARS    PIC S9(09) VALUE +0.        02230000
016500     05  PV-ROUND-TO-TENTHS           PIC S9(09)V9 VALUE +0.      02240000
016510     05  PV-ROUND-TO-HDRTHS           PIC S9(09)V99 VALUE +0.     02250016
016600     05  PV-ROUND-VOL-PCT             PIC 9(09)V9 VALUE 0.        02260000
016700     05  PV-TRUNCAT-VOL-PCT           PIC 9(04)V9 VALUE 0.        02270011
016800     05  PV-TRUNCAT-VOL-PCT-X REDEFINES                           02280000
016900         PV-TRUNCAT-VOL-PCT           PIC 9(05).                  02290011
017000     05  PV-NUM-VOL-PCT.                                          02300000
017100         10  PV-NUM-VOL-PCT-1         PIC 9(04)  VALUE 0.         02310011
017200         10  PV-NUM-VOL-PCT-2         PIC 9(01)  VALUE 0.         02320000
017300     05  PV-CHAR-VOL-PCT REDEFINES                                02330000
017400         PV-NUM-VOL-PCT.                                          02340000
017500         10  PV-CHAR-VOL-PCT-1        PIC X(04).                  02350011
017600         10  PV-CHAR-VOL-PCT-2        PIC X(01).                  02360000
017700     05  PV-FINAL-VOL-PCT.                                        02370000
017710         10  PV-FINAL-VOL-PCT-1       PIC X(01)  VALUE SPACES.    02380011
017800         10  PV-FINAL-VOL-PCT-2       PIC X(01)  VALUE SPACES.    02390011
017900         10  PV-FINAL-VOL-PCT-3       PIC X(01)  VALUE SPACES.    02400011
018000         10  PV-FINAL-VOL-PCT-4       PIC X(01)  VALUE SPACES.    02410011
018100         10  PV-FINAL-VOL-PCT-5       PIC X(01)  VALUE SPACES.    02420011
018110         10  FILLER                   PIC X(01)  VALUE '.'.       02430000
018120         10  PV-FINAL-VOL-PCT-6       PIC X(01)  VALUE SPACES.    02440011
018130         10  PV-FINAL-VOL-PCT-7       PIC X(01)  VALUE SPACES.    02450011
018140     05  PV-SEP-VOL-PCT.                                          02460000
018141         10  PV-SEP-VOL-PCT-1         PIC 9(01)  VALUE 0.         02470011
018150         10  PV-SEP-VOL-PCT-2         PIC 9(01)  VALUE 0.         02480011
018160         10  PV-SEP-VOL-PCT-3         PIC 9(01)  VALUE 0.         02490011
018170         10  PV-SEP-VOL-PCT-4         PIC 9(01)  VALUE 0.         02500011
018180         10  PV-SEP-VOL-PCT-5         PIC 9(01)  VALUE 0.         02510011
018190     05  PV-VOL-PCT-CHG               PIC S9(09)V9999 VALUE +0    02520000
018191                                                     COMP-3.      02530000
018192     05  PV-MU-PCT                    PIC S9(09)V9999 VALUE +0    02540000
018193                                                     COMP-3.      02550000
018194     05  PV-SELL-THRU-PCT             PIC S9(09)V9999 VALUE +0    02560000
018195                                                     COMP-3.      02570000
018196     05  PV-RPT-LINE                  PIC X(250) VALUE SPACES.    02580000
018197     05  PV-PROMO-STRT-TMST.                                      02590000
018198         10  PV-PROMO-STRT-DTE.                                   02600000
018199             15  PV-PM-STRT-DTE-CC    PIC X(02)  VALUE SPACES.    02610000
018200             15  PV-PM-STRT-DTE-YY    PIC X(02)  VALUE SPACES.    02620000
018210             15  FILLER               PIC X(01)  VALUE SPACES.    02630000
018220             15  PV-PM-STRT-DTE-MM    PIC X(02)  VALUE SPACES.    02640000
018230             15  FILLER               PIC X(01)  VALUE SPACES.    02650000
018240             15  PV-PM-STRT-DTE-DD    PIC X(02)  VALUE SPACES.    02660000
018250         10  FILLER                   PIC X(01)  VALUE SPACES.    02670000
018260         10  PV-PROMO-STRT-TM.                                    02680000
018270             15  PV-PM-STRT-TM-HH     PIC X(02)  VALUE SPACES.    02690000
018280             15  FILLER               PIC X(01)  VALUE SPACES.    02700000
018290             15  PV-PM-STRT-TM-MM     PIC X(02)  VALUE SPACES.    02710000
018300             15  FILLER               PIC X(01)  VALUE SPACES.    02720000
018400             15  PV-PM-STRT-TM-SS     PIC X(02)  VALUE SPACES.    02730000
018500                                                                  02740000
018600     05  PV-PROMO-END-TMST.                                       02750000
018700         10  PV-PROMO-END-DTE.                                    02760000
018800             15  PV-PM-END-DTE-CC     PIC X(02)  VALUE SPACES.    02770000
018900             15  PV-PM-END-DTE-YY     PIC X(02)  VALUE SPACES.    02780000
019000             15  FILLER               PIC X(01)  VALUE SPACES.    02790000
019100             15  PV-PM-END-DTE-MM     PIC X(02)  VALUE SPACES.    02800000
019200             15  FILLER               PIC X(01)  VALUE SPACES.    02810000
019300             15  PV-PM-END-DTE-DD     PIC X(02)  VALUE SPACES.    02820000
019400         10  FILLER                   PIC X(01)  VALUE SPACES.    02830000
019500         10  PV-PROMO-END-TM.                                     02840000
019600             15  PV-PM-END-TM-HH      PIC X(02)  VALUE SPACES.    02850000
019700             15  FILLER               PIC X(01)  VALUE SPACES.    02860000
019800             15  PV-PM-END-TM-MM      PIC X(02)  VALUE SPACES.    02870000
019900             15  FILLER               PIC X(01)  VALUE SPACES.    02880000
020000             15  PV-PM-END-TM-SS      PIC X(02)  VALUE SPACES.    02890000
020100                                                                  02900000
020200     05  PV-PROMO-ITM-STRT-TMST.                                  02910000
020300         10  PV-PROMO-ITM-STRT-DTE.                               02920000
020400             15  PV-PI-STRT-DTE-CC    PIC X(02)  VALUE SPACES.    02930000
020500             15  PV-PI-STRT-DTE-YY    PIC X(02)  VALUE SPACES.    02940000
020600             15  FILLER               PIC X(01)  VALUE SPACES.    02950000
020700             15  PV-PI-STRT-DTE-MM    PIC X(02)  VALUE SPACES.    02960000
020800             15  FILLER               PIC X(01)  VALUE SPACES.    02970000
020900             15  PV-PI-STRT-DTE-DD    PIC X(02)  VALUE SPACES.    02980000
021000         10  FILLER                   PIC X(01)  VALUE SPACES.    02990000
021100         10  PV-PROMO-ITM-STRT-TM.                                03000000
021200             15  PV-PI-STRT-TM-HH     PIC X(02)  VALUE SPACES.    03010000
021300             15  FILLER               PIC X(01)  VALUE SPACES.    03020000
021400             15  PV-PI-STRT-TM-MM     PIC X(02)  VALUE SPACES.    03030000
021500             15  FILLER               PIC X(01)  VALUE SPACES.    03040000
021600             15  PV-PI-STRT-TM-SS     PIC X(02)  VALUE SPACES.    03050000
021700                                                                  03060000
021800     05  PV-PROMO-ITM-END-TMST.                                   03070000
021900         10  PV-PROMO-ITM-END-DTE.                                03080000
022000             15  PV-PI-END-DTE-CC     PIC X(02)  VALUE SPACES.    03090000
022010             15  PV-PI-END-DTE-YY     PIC X(02)  VALUE SPACES.    03100000
022020             15  FILLER               PIC X(01)  VALUE SPACES.    03110000
022030             15  PV-PI-END-DTE-MM     PIC X(02)  VALUE SPACES.    03120000
022040             15  FILLER               PIC X(01)  VALUE SPACES.    03130000
022050             15  PV-PI-END-DTE-DD     PIC X(02)  VALUE SPACES.    03140000
022060         10  FILLER                   PIC X(01)  VALUE SPACES.    03150000
022070         10  PV-PROMO-ITM-END-TM.                                 03160000
022080             15  PV-PI-END-TM-HH      PIC X(02)  VALUE SPACES.    03170000
022090             15  FILLER               PIC X(01)  VALUE SPACES.    03180000
022091             15  PV-PI-END-TM-MM      PIC X(02)  VALUE SPACES.    03190000
022092             15  FILLER               PIC X(01)  VALUE SPACES.    03200000
022093             15  PV-PI-END-TM-SS      PIC X(02)  VALUE SPACES.    03210000
022094                                                                  03220000
022095     05  PV-PM-ITM-EFF-STRT-DTE.                                  03230000
022096         10  PV-EFF-STRT-DTE-MM       PIC X(02)  VALUE SPACES.    03240000
022097         10  FILLER                   PIC X(01)  VALUE '/'.       03250000
022098         10  PV-EFF-STRT-DTE-DD       PIC X(02)  VALUE SPACES.    03260000
022099         10  FILLER                   PIC X(01)  VALUE '/'.       03270000
022100         10  PV-EFF-STRT-DTE-YY       PIC X(02)  VALUE SPACES.    03280000
022101                                                                  03290000
022102     05  PV-PM-ITM-EFF-END-DTE.                                   03300000
022103         10  PV-EFF-END-DTE-MM        PIC X(02)  VALUE SPACES.    03310000
022104         10  FILLER                   PIC X(01)  VALUE '/'.       03320000
022105         10  PV-EFF-END-DTE-DD        PIC X(02)  VALUE SPACES.    03330000
022106         10  FILLER                   PIC X(01)  VALUE '/'.       03340000
022107         10  PV-EFF-END-DTE-YY        PIC X(02)  VALUE SPACES.    03350000
022108                                                                  03360000
022109     05  PV-EFF-DTE-LAYOUT.                                       03370000
022110         10  FILLER                   PIC X(02)  VALUE SPACES.    03380000
022111         10  PV-OPEN-PARENTH          PIC X(01)  VALUE SPACES.    03390000
022112         10  PV-EFF-STRT-DTE          PIC X(08)  VALUE SPACES.    03400000
022113         10  PV-DTE-DASH              PIC X(01)  VALUE SPACES.    03410000
022114         10  PV-EFF-END-DTE           PIC X(08)  VALUE SPACES.    03420000
022115         10  PV-CLOSE-PARENTH         PIC X(01)  VALUE SPACES.    03430000
022116                                                                  03440000
022127     05  PV-VARIABLE-OUTPUT-FIELD.                                03450000
022128         10  PV-BIT-VARIABLE          PIC X(01)  VALUE SPACES     03460000
022129                                       OCCURS 61 TIMES            03470017
022130                                       INDEXED BY                 03480000
022131                                       PV-BIT-IDX.                03490000
022132                                                                  03500000
022133     05  PV-VER-AD-VARIABLE.                                      03510017
022134         10  PV-PARENTHESES           PIC X(01)  VALUE SPACES.    03520017
022135         10  PV-VERSION-AD            PIC X(59)  VALUE SPACES.    03530017
022136                                                                  03540017
022137     05  PV-HEADER-DTE-TM.                                        03550000
022138         10  PV-BEG-DAY-ALPHA         PIC X(10).                  03560000
022139         10  PV-BEG-DATE              PIC X(08).                  03570000
022140         10  FILLER                   PIC X(02)  VALUE SPACES.    03580000
022141         10  PV-BEG-TIME.                                         03590000
022142             15  PV-BEG-HR-TIME       PIC 9(02).                  03600000
022143             15  PV-BEG-TIME-COLON    PIC X(01).                  03610000
022144             15  PV-BEG-MIN-TIME      PIC 9(02).                  03620000
022145             15  FILLER               PIC X(02)  VALUE SPACES.    03630000
022146         10  FILLER                   PIC X(11)  VALUE            03640000
022147                                      '   THROUGH '.              03650000
022148         10  PV-END-DAY-ALPHA         PIC X(10).                  03660000
022149         10  PV-END-DATE              PIC X(08).                  03670000
022150         10  FILLER                   PIC X(02)  VALUE SPACES.    03680000
022151         10  PV-END-TIME.                                         03690000
022152             15  PV-END-HR-TIME       PIC 9(02).                  03700000
022153             15  PV-END-TIME-COLON    PIC X(01).                  03710000
022154             15  PV-END-MIN-TIME      PIC 9(02).                  03720000
022155             15  FILLER               PIC X(02).                  03730000
022156         10  FILLER                   PIC X(22)  VALUE SPACES.    03740000
022157                                                                  03750000
022158*----------------------------------------------------------       03760000
022159* PA- PROGRAM ACCUMULATORS                                        03770000
022160*----------------------------------------------------------       03780000
022161 01  PA-PROGRAM-ACCUMULATORS.                                     03790000
022162     05  PA-CNT-ADV-TOT               PIC 9(09)  VALUE ZEROES.    03800000
PGNBR      05  PA-CNT-ADVNO-TOT             PIC 9(09)  VALUE ZEROES.    03801038
022163     05  PA-CNT-UNADV-TOT             PIC 9(09)  VALUE ZEROES.    03810000
022170     05  PA-CNT-SPACES-1              PIC 9(09)  VALUE ZEROES.    03820000
022180     05  PA-CNT-POS-1                 PIC 9(09)  VALUE ZEROES.    03830000
022190     05  PA-CNT-SPACES-2              PIC 9(09)  VALUE ZEROES.    03840000
022200     05  PA-CNT-SPACES                PIC 9(09)  VALUE ZEROES.    03850000
022300     05  PA-CNT-POS-2                 PIC 9(09)  VALUE ZEROES.    03860000
022400                                                                  03870000
022500*----------------------------------------------------------       03880000
022600* TBL- TABLE VARIABLES                                            03890000
022700*----------------------------------------------------------       03900000
022800* NOTE: THE FIRST OCCURRENCE CONTAINS ACTUAL FIGURES, THE SECOND  03910000
022900*    OCCURRENCE CONTAINS FORECAST FIGURES                         03920000
023000 01  TBL-SECT-TOTAL-TABLE.                                        03930000
023100     05  TBL-STOT-LINE-01 OCCURS 02 TIMES                         03940000
023200                           INDEXED BY TBL-STOT-INDX.              03950000
023300         10  TBL-STOT-TOT-SALE-AMT    PIC S9(09)V9(02) COMP-3.    03960000
023400         10  TBL-STOT-TOT-MD-AMT      PIC S9(09)V9(02) COMP-3.    03970000
023500         10  TBL-STOT-TOT-SLS-UNT-QTY                             03980000
023600                                      PIC S9(09)V9(02) COMP-3.    03990000
023700         10  TBL-STOT-TOT-EOH-INV-QTY                             04000000
023800                                      PIC S9(09)V9(02) COMP-3.    04010000
023900         10  TBL-STOT-PREP-UNT-QTY    PIC S9(09)V9(02) COMP-3.    04020000
024000         10  TBL-STOT-TOT-SLS-COST-AMT                            04030000
024100                                      PIC S9(09)V9(02) COMP-3.    04040000
024200                                                                  04050000
024300* NOTE: THE FIRST OCCURRENCE CONTAINS ACTUAL FIGURES, THE SECOND  04060000
024400*    OCCURRENCE CONTAINS FORECAST FIGURES                         04070000
024500 01  TBL-PROMO-TOTAL-TABLE.                                       04080000
024600     05  TBL-PMTOT-LINE-01 OCCURS 02 TIMES                        04090000
024700                          INDEXED BY TBL-PMTOT-INDX.              04100000
024800         10  TBL-PMTOT-TOT-SALE-AMT   PIC S9(09)V9(02) COMP-3.    04110000
024900         10  TBL-PMTOT-TOT-MD-AMT     PIC S9(09)V9(02) COMP-3.    04120000
025000         10  TBL-PMTOT-TOT-SLS-UNT-QTY                            04130000
025100                                      PIC S9(09)V9(02) COMP-3.    04140000
025200         10  TBL-PMTOT-TOT-EOH-INV-QTY                            04150000
025300                                      PIC S9(09)V9(02) COMP-3.    04160000
025400         10  TBL-PMTOT-PREP-UNT-QTY   PIC S9(09)V9(02) COMP-3.    04170000
025500         10  TBL-PMTOT-TOT-SLS-COST-AMT                           04180000
025600                                      PIC S9(09)V9(02) COMP-3.    04190000
025700                                                                  04200000
025800*----------------------------------------------------------       04210000
025900* ABEND- ABEND VARIABLES                                          04220000
026000*----------------------------------------------------------       04230000
026100 01  ABEND-CODE                       PIC S9(04) VALUE +0 COMP.   04240000
026200     88  ABEND-4001-WRITE-ERROR                  VALUE +4001.     04250000
026300     88  ABEND-4002-READ-ERROR                   VALUE +4002.     04260000
026400     88  ABEND-4003-CTRL-CARD-ERROR              VALUE +4003.     04270000
026500     88  ABEND-4004-TABLE-ERROR                  VALUE +4004.     04280000
026600     88  ABEND-4005-OPEN-ERROR                   VALUE +4005.     04290000
026700     88  ABEND-4006-CLOSE-ERROR                  VALUE +4006.     04300000
026800     88  ABEND-4007-SEQUENCE-ERROR               VALUE +4007.     04310000
026900     88  ABEND-4008-DATA-ERROR                   VALUE +4008.     04320000
027000     88  ABEND-4009-KEY-DATA-ERROR               VALUE +4009.     04330000
027300     88  ABEND-4013-DB2-ERROR                    VALUE +4013.     04340000
027400     88  ABEND-4019-DATE-ROUTINE-ERROR           VALUE +4019.     04350000
027500     88  ABEND-4444-FORCED-ABEND                 VALUE +4444.     04360000
027600                                                                  04370000
027700 01  END-OF-REPORT-LINE.                                          04380000
027800     05  FILLER                       PIC X(25)  VALUE            04390000
027900         ' ** END OF REPORT **     '.                             04400000
028000                                                                  04410000
028100*----------------------------------------------------------       04420000
028200* HD- HEADER INFO                                                 04430000
028300*----------------------------------------------------------       04440000
028400 01  HEADER-01.                                                   04450000
028500     05  FILLER                       PIC X(87) VALUE SPACES.     04460015
028600     05  FILLER                       PIC X(44)  VALUE            04470014
028700         'PROMO ITEM SUMMARY - BY BUYER, BY AD PAGE - '.          04480014
028800     05  HDR-01-TITLE                 PIC X(36)  VALUE SPACES.    04490014
028900     05  FILLER                       PIC X(83)  VALUE SPACES.    04500015
029000                                                                  04510000
029100 01  HEADER-02.                                                   04520000
029200     05  FILLER                       PIC X(12)  VALUE            04530027
029300                                      ' AD EVENT : '.             04540027
029400     05  HDR-02-ADEVNT-STRING         PIC X(238) VALUE SPACES.    04550027
029500                                                                  04560000
029600 01  HEADER-03.                                                   04570000
029700     05  FILLER                       PIC X(12)  VALUE            04580027
029800                                      ' PROMOTION: '.             04590027
029900     05  HDR-03-PROMO-STRING          PIC X(238) VALUE SPACES.    04600027
030000                                                                  04610000
030010 01  HEADER-04.                                                   04620000
030020     05  FILLER                       PIC X(12)  VALUE            04630030
030030                                      ' BUYER    : '.             04640027
030031     05  HDR-04-BUYER-NBR             PIC 9(04)  VALUE ZEROES.    04650000
030032     05  FILLER                       PIC X(01)  VALUE SPACES.    04660000
030040     05  HDR-04-BUYER-STRING          PIC X(233) VALUE SPACES.    04670027
030050                                                                  04680000
030100 01  HEADER-05.                                                   04690000
030200     05  FILLER                       PIC X(45)  VALUE            04700000
030300         '                                             '.         04710000
030400     05  FILLER                       PIC X(45)  VALUE            04720000
030500         '       AD            SALES VOLUME       VOL %'.         04730000
030600     05  FILLER                       PIC X(45)  VALUE            04740000
030700         '            MARKDOWN $              UNITS SOL'.         04750000
030800     05  FILLER                       PIC X(45)  VALUE            04760000
030900         'D              PREP UNITS       SELL         '.         04770027
031000     05  FILLER                       PIC X(45)  VALUE            04780000
031100         '   TOTAL COST         MARKUP %        RETAIL '.         04790000
031200     05  FILLER                       PIC X(25)  VALUE            04800000
031210         'PRICE       PROMO PRICE  '.                             04810000
031220                                                                  04820000
031230 01  HEADER-06.                                                   04830000
031240     05  FILLER                       PIC X(45)  VALUE            04840000
031250         ' PROMO ITEM DESCRIPTION                      '.         04850000
031260     05  FILLER                       PIC X(45)  VALUE            04860000
031270         '      SPACE         ACT        FCST      CHG '.         04870000
031280     05  FILLER                       PIC X(45)  VALUE            04880000
031290         '          ACT        FCST         ACT        '.         04890000
031300     05  FILLER                       PIC X(45)  VALUE            04900000
031400         'FCST         ACT        FCST   THRU %        '.         04910027
031500     05  FILLER                       PIC X(45)  VALUE            04920000
031600         ' ACT        FCST     ACT    FCST       MIN   '.         04930000
031700     05  FILLER                       PIC X(25)  VALUE            04940000
031800         '   MAX      MIN      MAX '.                             04950000
031900                                                                  04960000
032000                                                                  04970000
032100*----------------------------------------------------------       04980000
032200* DTL- DETAIL INFO                                                04990000
032300*----------------------------------------------------------       05000000
032400 01  DETAIL-HEADER-01.                                            05010000
032500     05  DTL-HDR-01-PAGE.                                         05020000
032600         10  DTL-HDR-01-PM-ITM-PAGE.                              05030000
032700             15  FILLER               PIC X(01).                  05040000
032800             15  DTL-HDR-01-PM-ITM-PAGE-TITLE                     05050000
032900                                      PIC X(21).                  05060000
033000             15  DTL-HDR-01-PM-ITM-PAGE-NBR                       05070000
033100                                      PIC ZZ9.                    05080000
033200             15  FILLER               PIC X(13).                  05090000
033300         10  DTL-HDR-01-NO-PAGE REDEFINES                         05100000
033400             DTL-HDR-01-PM-ITM-PAGE .                             05110000
033500             15  FILLER               PIC X(01).                  05120000
033600             15  DTL-HDR-01-HEADING-TITLE                         05130000
033700                                      PIC X(37).                  05140000
033800     05  FILLER                       PIC X(212) VALUE SPACES.    05150000
033900                                                                  05160000
034600 01  DETAIL-VARIABLE.                                             05170000
034700     05  FILLER                       PIC X(01)  VALUE SPACES.    05180000
034800     05  DTL-VAR-VOL-PCT-CHG          PIC ZZZ9.9.                 05190023
034810     05  DTL-VAR-VOL-PCT-CHG-1 REDEFINES                          05200023
034820         DTL-VAR-VOL-PCT-CHG          PIC ZZZZ.Z.                 05210023
034900     05  FILLER                       PIC X(01)  VALUE SPACES.    05220000
035000                                                                  05230000
035100 01  DETAIL-01.                                                   05240000
035200     05  FILLER                       PIC X(01)  VALUE SPACES.    05250000
035300     05  DTL-01-PMITEM-DESC           PIC X(50).                  05260000
035400     05  FILLER                       PIC X(01)  VALUE SPACES.    05270000
035500     05  DTL-01-AD-SPC-CDE            PIC X(04).                  05280000
035600     05  FILLER                       PIC X(02)  VALUE SPACES.    05290016
035700     05  DTL-01-ACTL-SLS-RTL-AMT      PIC ZZZ,ZZ9.99.             05300023
035710     05  DTL-01-ACTL-SLS-RTL-AMT1 REDEFINES                       05310024
035720         DTL-01-ACTL-SLS-RTL-AMT      PIC ZZZ,ZZZ.ZZ.             05320024
035800     05  FILLER                       PIC X(02)  VALUE SPACES.    05330016
035900     05  DTL-01-FCST-SLS-RTL-AMT      PIC ZZZ,ZZZ.ZZ.             05340016
036000     05  FILLER                       PIC X(02)  VALUE SPACES.    05350012
036100     05  DTL-01-VOL-PCT-CHG           PIC X(08)  VALUE SPACES.    05360012
036200     05  DTL-01-VOL-PCT-SIGN          PIC X(01)  VALUE SPACES.    05370000
036300     05  FILLER                       PIC X(02)  VALUE SPACES.    05380016
036400     05  DTL-01-ACTL-MD-AMT           PIC ZZZ,ZZ9.99.             05390023
036410     05  DTL-01-ACTL-MD-AMT1 REDEFINES                            05400024
036420         DTL-01-ACTL-MD-AMT           PIC ZZZ,ZZZ.ZZ.             05410024
036500     05  FILLER                       PIC X(02)  VALUE SPACES.    05420016
036600     05  DTL-01-FCST-MD-AMT           PIC ZZZ,ZZZ.ZZ.             05430016
036700     05  FILLER                       PIC X(02)  VALUE SPACES.    05440016
036800     05  DTL-01-ACTL-UNT-SLD-QTY      PIC ZZZ,ZZ9.99.             05450023
036801     05  DTL-01-ACTL-UNT-SLD-QTY1 REDEFINES                       05460025
036802         DTL-01-ACTL-UNT-SLD-QTY      PIC ZZZ,ZZZ.ZZ.             05470025
036803     05  FILLER                       PIC X(02)  VALUE SPACES.    05480016
036804     05  DTL-01-FCST-UNT-SLD-QTY      PIC ZZZ,ZZZ.ZZ.             05490016
036805     05  FILLER                       PIC X(02)  VALUE SPACES.    05500016
036806     05  DTL-01-ACTL-PREP-UNT-QTY     PIC ZZZ,ZZ9.99.             05510023
036807     05  DTL-01-ACTL-PREP-UNT-QTY1 REDEFINES                      05520025
036808         DTL-01-ACTL-PREP-UNT-QTY     PIC ZZZ,ZZZ.ZZ.             05530025
036809     05  FILLER                       PIC X(02)  VALUE SPACES.    05540016
036810     05  DTL-01-FCST-PREP-UNT-QTY     PIC ZZZ,ZZZ.ZZ.             05550016
036811     05  FILLER                       PIC X(03)  VALUE SPACES.    05560000
036812     05  DTL-01-SELL-THRU-PCT         PIC ZZ9.9.                  05570023
036813     05  DTL-01-SELL-THRU-PCT1 REDEFINES                          05580025
036814         DTL-01-SELL-THRU-PCT         PIC ZZZ.Z.                  05590025
036815     05  DTL-O1-SELL-PCT-SIGN         PIC X(01)  VALUE SPACES.    05600000
036816     05  FILLER                       PIC X(02)  VALUE SPACES.    05610016
036820     05  DTL-01-ACTL-COST-AMT         PIC ZZZ,ZZ9.99.             05620023
036821     05  DTL-01-ACTL-COST-AMT1 REDEFINES                          05630025
036822         DTL-01-ACTL-COST-AMT         PIC ZZZ,ZZZ.ZZ.             05640025
036830     05  FILLER                       PIC X(02)  VALUE SPACES.    05650016
036840     05  DTL-01-FCST-COST-AMT         PIC ZZZ,ZZZ.ZZ.             05660016
036850     05  FILLER                       PIC X(03)  VALUE SPACES.    05670000
036860     05  DTL-01-ACTL-MU-PCT           PIC ZZ9.9.                  05680023
036861     05  DTL-01-ACTL-MU-PCT1 REDEFINES                            05690025
036862         DTL-01-ACTL-MU-PCT           PIC ZZZ.Z.                  05700025
036870     05  DTL-01-ACTL-PCT-SIGN         PIC X(01)  VALUE SPACES.    05710000
PM3403*    05  FILLER                       PIC X(02)  VALUE SPACES.    05720036
PM3403     05  FILLER                       PIC X(01)  VALUE SPACES.    05730036
036890     05  DTL-01-FCST-MU-PCT           PIC ZZ9.9.                  05740027
036891     05  DTL-01-FCST-MU-PCT1 REDEFINES                            05750027
036892         DTL-01-FCST-MU-PCT           PIC ZZZ.Z.                  05760027
036900     05  DTL-01-FCST-PCT-SIGN         PIC X(01)  VALUE SPACES.    05770000
PM3403*    05  FILLER                       PIC X(02)  VALUE SPACES.    05780036
PM3403     05  FILLER                       PIC X(01)  VALUE SPACES.    05790036
PM3403*    05  DTL-01-MIN-RTL-PRC           PIC ZZZZ.ZZ.                05800036
PM3403     05  DTL-01-MIN-RTL-PRC           PIC ZZZZZ.ZZ.               05810036
037200     05  FILLER                       PIC X(01)  VALUE SPACES.    05820000
037300     05  DTL-01-RTL-DASH              PIC X(01)  VALUE SPACES.    05830000
PM3403*    05  DTL-01-MAX-RTL-PRC           PIC ZZZZ.ZZ.                05840036
PM3403     05  DTL-01-MAX-RTL-PRC           PIC ZZZZZ.ZZ.               05850036
PM3403*    05  FILLER                       PIC X(02)  VALUE SPACES.    05860036
PM3403     05  FILLER                       PIC X(01)  VALUE SPACES.    05870036
PM3403*    05  DTL-01-MIN-PROMO-PRC         PIC ZZZZ.ZZ.                05880036
PM3403     05  DTL-01-MIN-PROMO-PRC         PIC ZZZZZ.ZZ.               05890036
037610     05  FILLER                       PIC X(01)  VALUE SPACES.    05900000
037620     05  DTL-01-PRM-DASH              PIC X(01)  VALUE SPACES.    05910000
PM3403*    05  DTL-01-MAX-PROMO-PRC         PIC ZZZZ.ZZ.                05920036
037630     05  DTL-01-MAX-PROMO-PRC         PIC ZZZZZ.ZZ.               05930036
PM3403*    05  FILLER                       PIC X(01)  VALUE SPACES.    05940036
037650                                                                  05950000
037701 01  DETAIL-02.                                                   05960017
037702     05  FILLER                       PIC X(01)  VALUE SPACES.    05970017
037703     05  DTL-02-DTES.                                             05980017
037704         10  DTL-02-EFF-DTES          PIC X(36)  VALUE SPACES.    05990017
037705         10  FILLER                   PIC X(26)  VALUE SPACES.    06000017
037706     05  DTL-02-VERSIONS                                          06010017
037707         REDEFINES DTL-02-DTES.                                   06020017
037708         10  FILLER                   PIC X(02).                  06030017
037709         10  DTL-01-VERSION-AD        PIC X(60).                  06040017
037710     05  FILLER                       PIC X(205) VALUE SPACES.    06050017
037711                                                                  06060017
037712 01  DETAIL-PMPG-TOTALS.                                          06070000
037720     05  DTL-PROMO-PAGE.                                          06080000
037730         10  DTL-PAGE-TITLE.                                      06090000
037740             15  FILLER               PIC X(01).                  06100000
037750             15  DTL-PG-PAGE-TITLE    PIC X(16).                  06110000
037760             15  DTL-PG-PAGE-NBR      PIC ZZ9.                    06120000
037770          10 DTL-PROMO-TITLE REDEFINES                            06130000
037780             DTL-PAGE-TITLE.                                      06140000
037790             15  FILLER               PIC X(01).                  06150000
037800             15  DTL-PM-PROMO-TITLE   PIC X(19).                  06160000
037801     05  FILLER                       PIC X(38)  VALUE SPACES.    06170016
037802     05  DTL-PMPG-ACTL-TOT-SLS-AMT    PIC ZZZ,ZZ9.99.             06180023
037803     05  DTL-PMPG-ACTL-TOT-SLS-AMT1 REDEFINES                     06190026
037804         DTL-PMPG-ACTL-TOT-SLS-AMT    PIC ZZZ,ZZZ.ZZ.             06200026
037805     05  FILLER                       PIC X(02)  VALUE SPACES.    06210016
037806     05  DTL-PMPG-FCST-TOT-SLS-AMT    PIC ZZZ,ZZZ.ZZ.             06220016
037807     05  FILLER                       PIC X(02)  VALUE SPACES.    06230012
037808     05  DTL-PMPG-TOT-VOL-PCT-CHG     PIC X(08)  VALUE SPACES.    06240012
037809     05  DTL-PMPG-VOL-PCT-SIGN        PIC X(01)  VALUE SPACES.    06250000
037810     05  FILLER                       PIC X(02)  VALUE SPACES.    06260016
037811     05  DTL-PMPG-TOT-ACTL-MD-AMT     PIC ZZZ,ZZ9.99.             06270023
037812     05  DTL-PMPG-TOT-ACTL-MD-AMT1 REDEFINES                      06280026
037813         DTL-PMPG-TOT-ACTL-MD-AMT     PIC ZZZ,ZZZ.ZZ.             06290026
037814     05  FILLER                       PIC X(02)  VALUE SPACES.    06300016
037815     05  DTL-PMPG-TOT-FCST-MD-AMT     PIC ZZZ,ZZZ.ZZ.             06310016
037816     05  FILLER                       PIC X(02)  VALUE SPACES.    06320016
037817     05  DTL-PMPG-TOT-ACTL-UNT-QTY    PIC ZZZ,ZZ9.99.             06330023
037818     05  DTL-PMPG-TOT-ACTL-UNT-QTY1 REDEFINES                     06340026
037819         DTL-PMPG-TOT-ACTL-UNT-QTY    PIC ZZZ,ZZZ.ZZ.             06350026
037820     05  FILLER                       PIC X(02)  VALUE SPACES.    06360016
037821     05  DTL-PMPG-TOT-FCST-UNT-QTY    PIC ZZZ,ZZZ.ZZ.             06370016
037822     05  FILLER                       PIC X(02)  VALUE SPACES.    06380016
037823     05  DTL-PMPG-TOT-ACTL-PREP-QTY   PIC ZZZ,ZZ9.99.             06390023
037824     05  DTL-PMPG-TOT-ACTL-PREP-QTY1 REDEFINES                    06400026
037825         DTL-PMPG-TOT-ACTL-PREP-QTY   PIC ZZZ,ZZZ.ZZ.             06410026
037826     05  FILLER                       PIC X(02)  VALUE SPACES.    06420016
037827     05  DTL-PMPG-TOT-FCST-PREP-QTY   PIC ZZZ,ZZZ.ZZ.             06430016
037828     05  FILLER                       PIC X(03)  VALUE SPACES.    06440000
037829     05  DTL-PMPG-TOT-SELL-THRU-PCT   PIC ZZ9.9.                  06450023
037830     05  DTL-PMPG-TOT-SELL-THRU-PCT1 REDEFINES                    06460026
037831         DTL-PMPG-TOT-SELL-THRU-PCT   PIC ZZZ.Z.                  06470026
037832     05  DTL-PMPG-SELL-PCT-SIGN       PIC X(01)  VALUE SPACES.    06480000
037833     05  FILLER                       PIC X(02)  VALUE SPACES.    06490016
037834     05  DTL-PMPG-TOT-ACTL-COST-AMT   PIC ZZZ,ZZ9.99.             06500023
037835     05  DTL-PMPG-TOT-ACTL-COST-AMT1 REDEFINES                    06510026
037836         DTL-PMPG-TOT-ACTL-COST-AMT   PIC ZZZ,ZZZ.ZZ.             06520026
037837     05  FILLER                       PIC X(02)  VALUE SPACES.    06530016
037838     05  DTL-PMPG-TOT-FCST-COST-AMT   PIC ZZZ,ZZZ.ZZ.             06540016
037839     05  FILLER                       PIC X(03)  VALUE SPACES.    06550000
037840     05  DTL-PMPG-TOT-ACTL-MU-PCT     PIC ZZ9.9.                  06560023
037841     05  DTL-PMPG-TOT-ACTL-MU-PCT1 REDEFINES                      06570026
037842         DTL-PMPG-TOT-ACTL-MU-PCT     PIC ZZZ.Z.                  06580026
037843     05  DTL-PMPG-ACTL-PCT-SIGN       PIC X(01)  VALUE SPACES.    06590000
037844     05  FILLER                       PIC X(02)  VALUE SPACES.    06600000
037845     05  DTL-PMPG-TOT-FCST-MU-PCT     PIC ZZ9.9.                  06610027
037846     05  DTL-PMPG-TOT-FCST-MU-PCT1 REDEFINES                      06620027
037847         DTL-PMPG-TOT-FCST-MU-PCT     PIC ZZZ.Z.                  06630027
037848     05  DTL-PMPG-FCST-PCT-SIGN       PIC X(01)  VALUE SPACES.    06640000
037849     05  FILLER                       PIC X(37)  VALUE SPACES.    06650000
037850                                                                  06660000
037851 01  DETAIL-ADV-TOTALS.                                           06670000
037852     05  DTL-ADV.                                                 06680000
037853         10  DTL-ADV-TITLE.                                       06690000
037854             15  FILLER               PIC X(01).                  06700000
037855             15  DTL-ADV-PM-TITLE     PIC X(18).                  06710000
037856     05  FILLER                       PIC X(39)  VALUE SPACES.    06720016
037857     05  DTL-ADV-TOT-ACTL-SLS-AMT     PIC ZZZ,ZZ9.99.             06730023
037858     05  DTL-ADV-TOT-ACTL-SLS-AMT1 REDEFINES                      06740026
037859         DTL-ADV-TOT-ACTL-SLS-AMT     PIC ZZZ,ZZZ.ZZ.             06750026
037860     05  FILLER                       PIC X(02)  VALUE SPACES.    06760016
037870     05  DTL-ADV-TOT-FCST-SLS-AMT     PIC ZZZ,ZZZ.ZZ.             06770016
037871     05  FILLER                       PIC X(02)  VALUE SPACES.    06780012
037872     05  DTL-ADV-TOT-VOL-PCT-CHG      PIC X(08)  VALUE SPACES.    06790012
037873     05  DTL-ADV-VOL-PCT-SIGN         PIC X(01)  VALUE SPACES.    06800000
037874     05  FILLER                       PIC X(02)  VALUE SPACES.    06810016
037875     05  DTL-ADV-TOT-ACTL-MD-AMT      PIC ZZZ,ZZ9.99.             06820023
037876     05  DTL-ADV-TOT-ACTL-MD-AMT1 REDEFINES                       06830026
037877         DTL-ADV-TOT-ACTL-MD-AMT      PIC ZZZ,ZZZ.ZZ.             06840026
037878     05  FILLER                       PIC X(02)  VALUE SPACES.    06850016
037879     05  DTL-ADV-TOT-FCST-MD-AMT      PIC ZZZ,ZZZ.ZZ.             06860016
037880     05  FILLER                       PIC X(02)  VALUE SPACES.    06870016
037881     05  DTL-ADV-TOT-ACTL-UNT-QTY     PIC ZZZ,ZZ9.99.             06880023
037882     05  DTL-ADV-TOT-ACTL-UNT-QTY1 REDEFINES                      06890026
037883         DTL-ADV-TOT-ACTL-UNT-QTY     PIC ZZZ,ZZZ.ZZ.             06900026
037884     05  FILLER                       PIC X(02)  VALUE SPACES.    06910016
037885     05  DTL-ADV-TOT-FCST-UNT-QTY     PIC ZZZ,ZZZ.ZZ.             06920016
037886     05  FILLER                       PIC X(02)  VALUE SPACES.    06930016
037887     05  DTL-ADV-TOT-ACTL-PREP-QTY    PIC ZZZ,ZZ9.99.             06940023
037888     05  DTL-ADV-TOT-ACTL-PREP-QTY1 REDEFINES                     06950026
037889         DTL-ADV-TOT-ACTL-PREP-QTY    PIC ZZZ,ZZZ.ZZ.             06960026
037890     05  FILLER                       PIC X(02)  VALUE SPACES.    06970016
037891     05  DTL-ADV-TOT-FCST-PREP-QTY    PIC ZZZ,ZZZ.ZZ.             06980016
037892     05  FILLER                       PIC X(03)  VALUE SPACES.    06990000
037893     05  DTL-ADV-TOT-SELL-THRU-PCT    PIC ZZ9.9.                  07000023
037894     05  DTL-ADV-TOT-SELL-THRU-PCT1 REDEFINES                     07010026
037895         DTL-ADV-TOT-SELL-THRU-PCT    PIC ZZZ.Z.                  07020026
037896     05  DTL-ADV-SELL-PCT-SIGN        PIC X(01)  VALUE SPACES.    07030000
037897     05  FILLER                       PIC X(02)  VALUE SPACES.    07040016
037898     05  DTL-ADV-TOT-ACTL-COST-AMT    PIC ZZZ,ZZ9.99.             07050023
037899     05  DTL-ADV-TOT-ACTL-COST-AMT1 REDEFINES                     07060027
037900         DTL-ADV-TOT-ACTL-COST-AMT    PIC ZZZ,ZZZ.ZZ.             07070027
037901     05  FILLER                       PIC X(02)  VALUE SPACES.    07080016
037902     05  DTL-ADV-TOT-FCST-COST-AMT    PIC ZZZ,ZZZ.ZZ.             07090016
037903     05  FILLER                       PIC X(03)  VALUE SPACES.    07100000
037904     05  DTL-ADV-TOT-ACTL-MU-PCT      PIC ZZ9.9.                  07110023
037905     05  DTL-ADV-TOT-ACTL-MU-PCT1 REDEFINES                       07120027
037906         DTL-ADV-TOT-ACTL-MU-PCT      PIC ZZZ.Z.                  07130027
037907     05  DTL-ADV-ACTL-PCT-SIGN        PIC X(01)  VALUE SPACES.    07140000
PM3403*    05  FILLER                       PIC X(02)  VALUE SPACES.    07150036
PM3403     05  FILLER                       PIC X(01)  VALUE SPACES.    07160036
037909     05  DTL-ADV-TOT-FCST-MU-PCT      PIC ZZ9.9.                  07170027
037910     05  DTL-ADV-TOT-FCST-MU-PCT1 REDEFINES                       07180027
037911         DTL-ADV-TOT-FCST-MU-PCT      PIC ZZZ.Z.                  07190027
037912     05  DTL-ADV-FCST-PCT-SIGN        PIC X(01)  VALUE SPACES.    07200000
PM3403*    05  FILLER                       PIC X(37)  VALUE SPACES.    07210036
PM3403     05  FILLER                       PIC X(38)  VALUE SPACES.    07220036
037914                                                                  07230000
PGNBR  01  DETAIL-ADVNO-TOTALS.                                         07231038
PGNBR      05  DTL-ADVNO.                                               07232038
PGNBR          10  DTL-ADVNO-TITLE.                                     07233038
PGNBR              15  FILLER               PIC X(01).                  07234038
PGNBR              15  DTL-ADVNO-PM-TITLE   PIC X(32).                  07235039
PGNBR      05  FILLER                       PIC X(25)  VALUE SPACES.    07236039
PGNBR      05  DTL-ADVNO-TOT-ACTL-SLS-AMT   PIC ZZZ,ZZ9.99.             07237038
PGNBR      05  DTL-ADVNO-TOT-ACTL-SLS-AMT1 REDEFINES                    07238038
PGNBR          DTL-ADVNO-TOT-ACTL-SLS-AMT   PIC ZZZ,ZZZ.ZZ.             07239038
PGNBR      05  FILLER                       PIC X(02)  VALUE SPACES.    07239138
PGNBR      05  DTL-ADVNO-TOT-FCST-SLS-AMT   PIC ZZZ,ZZZ.ZZ.             07239238
PGNBR      05  FILLER                       PIC X(02)  VALUE SPACES.    07239338
PGNBR      05  DTL-ADVNO-TOT-VOL-PCT-CHG    PIC X(08)  VALUE SPACES.    07239438
PGNBR      05  DTL-ADVNO-VOL-PCT-SIGN       PIC X(01)  VALUE SPACES.    07239538
PGNBR      05  FILLER                       PIC X(02)  VALUE SPACES.    07239638
PGNBR      05  DTL-ADVNO-TOT-ACTL-MD-AMT    PIC ZZZ,ZZ9.99.             07239738
PGNBR      05  DTL-ADVNO-TOT-ACTL-MD-AMT1 REDEFINES                     07239838
PGNBR          DTL-ADVNO-TOT-ACTL-MD-AMT    PIC ZZZ,ZZZ.ZZ.             07239938
PGNBR      05  FILLER                       PIC X(02)  VALUE SPACES.    07240038
PGNBR      05  DTL-ADVNO-TOT-FCST-MD-AMT    PIC ZZZ,ZZZ.ZZ.             07240138
PGNBR      05  FILLER                       PIC X(02)  VALUE SPACES.    07240238
PGNBR      05  DTL-ADVNO-TOT-ACTL-UNT-QTY   PIC ZZZ,ZZ9.99.             07240338
PGNBR      05  DTL-ADVNO-TOT-ACTL-UNT-QTY1 REDEFINES                    07240438
PGNBR          DTL-ADVNO-TOT-ACTL-UNT-QTY   PIC ZZZ,ZZZ.ZZ.             07240538
PGNBR      05  FILLER                       PIC X(02)  VALUE SPACES.    07240638
PGNBR      05  DTL-ADVNO-TOT-FCST-UNT-QTY   PIC ZZZ,ZZZ.ZZ.             07240738
PGNBR      05  FILLER                       PIC X(02)  VALUE SPACES.    07240838
PGNBR      05  DTL-ADVNO-TOT-ACTL-PREP-QTY  PIC ZZZ,ZZ9.99.             07240938
PGNBR      05  DTL-ADVNO-TOT-ACTL-PREP-QTY1 REDEFINES                   07241038
PGNBR          DTL-ADVNO-TOT-ACTL-PREP-QTY  PIC ZZZ,ZZZ.ZZ.             07241138
PGNBR      05  FILLER                       PIC X(02)  VALUE SPACES.    07241238
PGNBR      05  DTL-ADVNO-TOT-FCST-PREP-QTY  PIC ZZZ,ZZZ.ZZ.             07241338
PGNBR      05  FILLER                       PIC X(03)  VALUE SPACES.    07241438
PGNBR      05  DTL-ADVNO-TOT-SELL-THRU-PCT  PIC ZZ9.9.                  07241538
PGNBR      05  DTL-ADVNO-TOT-SELL-THRU-PCT1 REDEFINES                   07241638
PGNBR          DTL-ADVNO-TOT-SELL-THRU-PCT  PIC ZZZ.Z.                  07241738
PGNBR      05  DTL-ADVNO-SELL-PCT-SIGN      PIC X(01)  VALUE SPACES.    07241838
PGNBR      05  FILLER                       PIC X(02)  VALUE SPACES.    07241938
PGNBR      05  DTL-ADVNO-TOT-ACTL-COST-AMT  PIC ZZZ,ZZ9.99.             07242038
PGNBR      05  DTL-ADVNO-TOT-ACTL-COST-AMT1 REDEFINES                   07242138
PGNBR          DTL-ADVNO-TOT-ACTL-COST-AMT  PIC ZZZ,ZZZ.ZZ.             07242238
PGNBR      05  FILLER                       PIC X(02)  VALUE SPACES.    07242338
PGNBR      05  DTL-ADVNO-TOT-FCST-COST-AMT  PIC ZZZ,ZZZ.ZZ.             07242438
PGNBR      05  FILLER                       PIC X(03)  VALUE SPACES.    07242538
PGNBR      05  DTL-ADVNO-TOT-ACTL-MU-PCT    PIC ZZ9.9.                  07242638
PGNBR      05  DTL-ADVNO-TOT-ACTL-MU-PCT1 REDEFINES                     07242738
PGNBR          DTL-ADVNO-TOT-ACTL-MU-PCT    PIC ZZZ.Z.                  07242838
PGNBR      05  DTL-ADVNO-ACTL-PCT-SIGN      PIC X(01)  VALUE SPACES.    07242938
PGNBR *    05  FILLER                       PIC X(02)  VALUE SPACES.    07243038
PGNBR      05  FILLER                       PIC X(01)  VALUE SPACES.    07243138
PGNBR      05  DTL-ADVNO-TOT-FCST-MU-PCT    PIC ZZ9.9.                  07243238
PGNBR      05  DTL-ADVNO-TOT-FCST-MU-PCT1 REDEFINES                     07243338
PGNBR          DTL-ADVNO-TOT-FCST-MU-PCT    PIC ZZZ.Z.                  07243438
PGNBR      05  DTL-ADVNO-FCST-PCT-SIGN      PIC X(01)  VALUE SPACES.    07243538
PGNBR *    05  FILLER                       PIC X(37)  VALUE SPACES.    07243638
PGNBR      05  FILLER                       PIC X(38)  VALUE SPACES.    07243738
PGNBR                                                                   07243838
037915 01  DETAIL-UNADV-TOTALS.                                         07244000
037920     05  DTL-UNADV.                                               07250000
037921         10  DTL-UNADV-TITLE.                                     07260000
037922             15  FILLER               PIC X(01).                  07270000
037923             15  DTL-UNADV-PM-TITLE   PIC X(20).                  07280000
037924     05  FILLER                       PIC X(37)  VALUE SPACES.    07290016
037925     05  DTL-UNADV-TOT-ACTL-SLS-AMT   PIC ZZZ,ZZ9.99.             07300023
037926     05  DTL-UNADV-TOT-ACTL-SLS-AMT1 REDEFINES                    07310024
037927         DTL-UNADV-TOT-ACTL-SLS-AMT   PIC ZZZ,ZZZ.ZZ.             07320024
037928     05  FILLER                       PIC X(02)  VALUE SPACES.    07330016
037929     05  DTL-UNADV-TOT-FCST-SLS-AMT   PIC ZZZ,ZZZ.ZZ.             07340016
037930     05  FILLER                       PIC X(02)  VALUE SPACES.    07350012
037931     05  DTL-UNADV-TOT-VOL-PCT-CHG    PIC X(08)  VALUE SPACES.    07360012
037932     05  DTL-UNADV-VOL-PCT-SIGN       PIC X(01)  VALUE SPACES.    07370000
037940     05  FILLER                       PIC X(02)  VALUE SPACES.    07380016
037941     05  DTL-UNADV-TOT-ACTL-MD-AMT    PIC ZZZ,ZZ9.99.             07390023
037942     05  DTL-UNADV-TOT-ACTL-MD-AMT1 REDEFINES                     07400024
037943         DTL-UNADV-TOT-ACTL-MD-AMT    PIC ZZZ,ZZZ.ZZ.             07410024
037944     05  FILLER                       PIC X(02)  VALUE SPACES.    07420016
037945     05  DTL-UNADV-TOT-FCST-MD-AMT    PIC ZZZ,ZZZ.ZZ.             07430016
037946     05  FILLER                       PIC X(02)  VALUE SPACES.    07440016
037947     05  DTL-UNADV-TOT-ACTL-UNT-QTY   PIC ZZZ,ZZ9.99.             07450023
037948     05  DTL-UNADV-TOT-ACTL-UNT-QTY1 REDEFINES                    07460024
037949         DTL-UNADV-TOT-ACTL-UNT-QTY   PIC ZZZ,ZZZ.ZZ.             07470024
037950     05  FILLER                       PIC X(02)  VALUE SPACES.    07480016
037951     05  DTL-UNADV-TOT-FCST-UNT-QTY   PIC ZZZ,ZZZ.ZZ.             07490016
037952     05  FILLER                       PIC X(02)  VALUE SPACES.    07500016
037953     05  DTL-UNADV-TOT-ACTL-PREP-QTY  PIC ZZZ,ZZ9.99.             07510023
037954     05  DTL-UNADV-TOT-ACTL-PREP-QTY1 REDEFINES                   07520024
037955         DTL-UNADV-TOT-ACTL-PREP-QTY  PIC ZZZ,ZZZ.ZZ.             07530024
037956     05  FILLER                       PIC X(02)  VALUE SPACES.    07540016
037957     05  DTL-UNADV-TOT-FCST-PREP-QTY  PIC ZZZ,ZZZ.ZZ.             07550016
037958     05  FILLER                       PIC X(03)  VALUE SPACES.    07560000
037959     05  DTL-UNADV-TOT-SELL-THRU-PCT  PIC ZZ9.9.                  07570023
037960     05  DTL-UNADV-TOT-SELL-THRU-PCT1 REDEFINES                   07580024
037961         DTL-UNADV-TOT-SELL-THRU-PCT  PIC ZZZ.Z.                  07590024
037962     05  DTL-UNADV-SELL-PCT-SIGN      PIC X(01)  VALUE SPACES.    07600000
037963     05  FILLER                       PIC X(02)  VALUE SPACES.    07610016
037964     05  DTL-UNADV-TOT-ACTL-COST-AMT  PIC ZZZ,ZZ9.99.             07620023
037965     05  DTL-UNADV-TOT-ACTL-COST-AMT1 REDEFINES                   07630024
037966         DTL-UNADV-TOT-ACTL-COST-AMT  PIC ZZZ,ZZZ.ZZ.             07640024
037967     05  FILLER                       PIC X(02)  VALUE SPACES.    07650016
037968     05  DTL-UNADV-TOT-FCST-COST-AMT  PIC ZZZ,ZZZ.ZZ.             07660016
037969     05  FILLER                       PIC X(03)  VALUE SPACES.    07670000
037970     05  DTL-UNADV-TOT-ACTL-MU-PCT    PIC ZZ9.9.                  07680023
037971     05  DTL-UNADV-TOT-ACTL-MU-PCT1 REDEFINES                     07690024
037972         DTL-UNADV-TOT-ACTL-MU-PCT    PIC ZZZ.Z.                  07700024
037973     05  DTL-UNADV-ACTL-PCT-SIGN      PIC X(01)  VALUE SPACES.    07710000
PM3403*    05  FILLER                       PIC X(02)  VALUE SPACES.    07720036
PM3403     05  FILLER                       PIC X(01)  VALUE SPACES.    07730036
037975     05  DTL-UNADV-TOT-FCST-MU-PCT    PIC ZZ9.9.                  07740027
037976     05  DTL-UNADV-TOT-FCST-MU-PCT1 REDEFINES                     07750027
037977         DTL-UNADV-TOT-FCST-MU-PCT    PIC ZZZ.Z.                  07760027
037978     05  DTL-UNADV-FCST-PCT-SIGN      PIC X(01)  VALUE SPACES.    07770000
PM3403*    05  FILLER                       PIC X(37)  VALUE SPACES.    07780036
PM3403     05  FILLER                       PIC X(38)  VALUE SPACES.    07790036
037980                                                                  07800000
038061*----------------------------------------------------------       07810000
038062* COPYBOOK FOR THE PROMO ITEM SUMMARY EXTRACT - INPUT             07820000
038063*----------------------------------------------------------       07830000
038064     COPY PMRD100.                                                07840000
038065                                                                  07850000
038066*----------------------------------------------------------       07860000
038067*  DATE VALIDATION CALLING PARAMETER LIST                         07870000
038068*----------------------------------------------------------       07880000
038069     COPY DPWS500.                                                07890000
038070                                                                  07900000
038071*----------------------------------------------------------       07910000
038072*  STANDARD HEADER LINE - KOHLS 250 COL                           07920000
038073*----------------------------------------------------------       07930000
038074     COPY DPWS250O.                                               07940000
038075     EJECT                                                        07950000
038076                                                                  07960000
038077*----------------------------------------------------------       07970000
038078 PROCEDURE DIVISION.                                              07980000
038079*----------------------------------------------------------       07990000
038080 0000-MAINLINE.                                                   08000000
038090                                                                  08010000
038100     PERFORM 1000-INITIALIZATION.                                 08020000
038200                                                                  08030000
038300     PERFORM 2000-PROCESS-SALES-RESULTS                           08040000
038400             UNTIL PS-EOF-SALES-RESULTS.                          08050000
038500                                                                  08060000
038600     PERFORM 3000-END-OF-JOB-ROUTINE.                             08070000
038700                                                                  08080000
038800     GOBACK.                                                      08090000
038900                                                                  08100000
039000*0000-EXIT.                                                       08110000
039100 EJECT.                                                           08120000
039200                                                                  08130000
039300*----------------------------------------------------------       08140000
039400* 1000-INITIALIZATION.                                            08150000
039500*     INITIALIZATION AREA - INITIALIZES ALL VARIABLES, OPENS      08160000
039600*     FILES, READS INPUT FILES, AND PROCESSES ANY INPUT FILE      08170000
039700*     PARAMETERS IT MAY NEED TO USE TO READ AND PROCESS           08180000
039800*     ANY OF THE RECORDS FROM THE INPUT FILE.                     08190000
039900*----------------------------------------------------------       08200000
040000 1000-INITIALIZATION.                                             08210000
040100                                                                  08220000
040200     INITIALIZE PM100-PROMO-ITM-SUMM                              08230000
040300                TBL-SECT-TOTAL-TABLE                              08240000
040400                TBL-PROMO-TOTAL-TABLE.                            08250000
040500                                                                  08260000
040510     SET PS-FIRST-TIME TO TRUE.                                   08270009
040520                                                                  08280009
040600     OPEN INPUT PROMO-ITM-SUMM-FILE                               08290000
040700         OUTPUT PROMO-ITM-SUMM-REPORT.                            08300000
040710                                                                  08310000
040720     ACCEPT CD-CPU-DATE FROM DATE.                                08320000
040721     MOVE CD-CPU-YR                  TO CD-CPU-YY.                08330000
040722     MOVE CD-CPU-MO                  TO CD-CPU-MM.                08340000
040723     MOVE CD-CPU-DY                  TO CD-CPU-DD.                08350000
040724                                                                  08360000
040725     INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              08370000
040726     SET DPG51-ACTUAL-CALENDAR-ONLY  TO TRUE.                     08380000
040727     SET DPG51-DO-NOT-INCR-DECR-DATE TO TRUE.                     08390000
040728     SET DPG52-LK-DTE-GREG           TO TRUE.                     08400000
040729     MOVE CD-CPU-DATE-GREG           TO DPG52-LK-DATE-INPUT.      08410000
040730     MOVE 'INVALID CONVERT OF CURRENT DATE FROM CPU'              08420000
040740                                     TO PV-OPERATION-MSG-1.       08430000
040750                                                                  08440000
040760     PERFORM 9100-CALENDAR-ROUTINE.                               08450000
040770                                                                  08460000
040780     MOVE DPG55-DB2-ISO-DATE-FMT     TO CD-CPU-DATE-ISO.          08470000
040790                                                                  08480000
040800     ACCEPT CT-CPU-TIME FROM TIME.                                08490000
040900     MOVE CT-CPU-HR                  TO DP250O-RUN-HOUR.          08500000
041000     MOVE CT-CPU-MIN                 TO DP250O-RUN-MINUTE.        08510000
041100     MOVE CD-CPU-MO                  TO DP250O-RUN-MONTH.         08520000
041200     MOVE CD-CPU-DY                  TO DP250O-RUN-DAY.           08530000
041300     MOVE CD-CPU-YR                  TO DP250O-RUN-YEAR.          08540000
041400     MOVE PC-CURRENT-PROGRAM-NAME    TO DP250O-PROGRAM-NAME.      08550000
041500                                                                  08560000
041600     PERFORM 8000-READ-SALES-RESULTS.                             08570000
041700                                                                  08580000
041800     IF PS-EOF-SALES-RESULTS                                      08590000
041900        DISPLAY 'NO PROMO ITEMS TO REPORT ON'                     08600000
042000     ELSE                                                         08610000
042300        EVALUATE TRUE                                             08620000
042400          WHEN PM100-ACTUAL                                       08630000
042500               MOVE PC-ACTUAL-RSLT   TO HDR-01-TITLE              08640000
042600          WHEN PM100-FORECAST                                     08650000
042700               MOVE PC-FORECAST-RSLT TO HDR-01-TITLE              08660000
042800          WHEN OTHER                                              08670000
042900               DISPLAY 'PM100-FCST-ACTUAL-IND: '                  08680000
043000                              PM100-FCST-ACTUAL-IND               08690000
043100               SET ABEND-4444-FORCED-ABEND TO TRUE                08700000
043200               MOVE '1000-INITIALIZATION' TO PV-PARAGRAPH-NAME    08710000
043300               MOVE 'NOT A VALID FORECAST/ACTUAL IND'             08720000
043400                                       TO PV-OPERATION-MSG-1      08730000
043500               PERFORM 9800-ABEND                                 08740000
043600        END-EVALUATE                                              08750000
043700     END-IF.                                                      08760000
043800                                                                  08770000
043900*1000-EXIT.                                                       08780000
044000 EJECT.                                                           08790000
044100                                                                  08800000
044200*----------------------------------------------------------       08810000
044300* 2000-PROCESS-SALES-RESULTS.                                     08820000
044400*     PROCESSES THE SALES RESULTS FILE AND CREATES A              08830000
044500*     A REPORT. THIS REPORT BREAKS BY AD EVENT/PROMOTION/BUYER.   08840018
044600*     WITHIN EACH PROMOTION/BUYER THE REPORT MAY HAVE A           08850018
044700*     ADVERTISED PROMOTION SECTION WHERE IT ALSO BREAKS           08860000
044800*     EACH AD PAGE NUMBER.  IT MAY HAVE AN UNADVERTISED           08870000
044900*     SECTION ALSO.                                               08880006
045100*----------------------------------------------------------       08890000
045200 2000-PROCESS-SALES-RESULTS.                                      08900000
045300                                                                  08910000
045400     EVALUATE TRUE                                                08920000
045500       WHEN (PM100-AD-EVNT-ID IS NOT = PV-LAST-ADEVNT-ID)         08930000
045600         OR (PM100-PROMO-ID IS NOT = PV-LAST-PROMO-ID)            08940000
045610         OR (PM100-BYR-NBR IS NOT = PV-LAST-BUYER-NBR)            08950000
045700            IF PS-NOT-FIRST-TIME                                  08960000
046300               IF PS-UNADV-PROMO-TTL                              08970004
046400                  PERFORM 3130-PROCESS-UNADV-PROMO-TTL            08980004
046500                  ADD 1          TO PA-CNT-UNADV-TOT              08990004
046600               ELSE                                               09000004
046700                  IF PS-ADV-PROMO-TTL                             09010004
046710                     PERFORM 3110-PROCESS-PAGE-TTL                09020004
046720                     PERFORM 3120-PROCESS-ADV-PROMO-TTL           09030004
046730                     ADD 1       TO PA-CNT-ADV-TOT                09040004
PGNBR                   ELSE                                            09041038
PGNBR                      IF PS-ADV-NOPGE-TTL                          09042038
PGNBR                         PERFORM 3030-PROCESS-ADV-NOPGE-TTL        09043038
PGNBR                         ADD 1          TO PA-CNT-ADVNO-TOT        09044038
PGNBR                      END-IF                                       09045038
046740                  END-IF                                          09050004
046750               END-IF                                             09060004
046770               SET PS-TOT-PROMO-TTL TO TRUE                       09070000
046780               PERFORM 3100-SELECT-TOTAL-LINES                    09080000
046790               PERFORM 2010-SET-TTL-PRINT-SW-OFF                  09090000
046791               INITIALIZE TBL-SECT-TOTAL-TABLE                    09100000
046792                          TBL-PROMO-TOTAL-TABLE                   09110000
046794            END-IF                                                09120000
046795            PERFORM 2300-FORMAT-HEADING-FIELDS                    09130000
046796            PERFORM 2100-ADEVNT-PROMO-HDR-BREAK                   09140000
046797            PERFORM 2400-CREATE-HEADING-FIELDS                    09150000
046798            PERFORM 3500-PROCESS-PAGE-HEADER                      09160000
046799            PERFORM 3400-PROCESS-DETAIL-HEADER                    09170000
046800            MOVE PM100-AD-EVNT-ID TO PV-LAST-ADEVNT-ID            09180000
046900            MOVE PM100-PROMO-ID   TO PV-LAST-PROMO-ID             09190000
046910            MOVE PM100-BYR-NBR    TO PV-LAST-BUYER-NBR            09200000
047000            MOVE PM100-AD-PG-NBR  TO PV-AD-PG-NBR                 09210000
047100            SET PS-NOT-FIRST-TIME TO TRUE                         09220000
PGNBR        WHEN PS-EOF-REC-TYPE-FLAG = 2                              09230038
047500            PERFORM 3110-PROCESS-PAGE-TTL                         09250000
PGNBR             PERFORM 3120-PROCESS-ADV-PROMO-TTL                    09251038
PGNBR             ADD 1               TO PA-CNT-ADV-TOT                 09252038
047600            INITIALIZE TBL-SECT-TOTAL-TABLE                       09260000
047700            MOVE PM100-AD-PG-NBR TO PV-AD-PG-NBR                  09270000
047800            PERFORM 3400-PROCESS-DETAIL-HEADER                    09280000
PGNBR        WHEN PS-EOF-REC-TYPE-FLAG = 1                              09281038
PGNBR             PERFORM 3030-PROCESS-ADV-NOPGE-TTL                    09282038
PGNBR             ADD 1               TO PA-CNT-ADVNO-TOT               09283038
PGNBR             INITIALIZE TBL-SECT-TOTAL-TABLE                       09284038
PGNBR             MOVE PM100-AD-PG-NBR TO PV-AD-PG-NBR                  09285038
PGNBR             PERFORM 3400-PROCESS-DETAIL-HEADER                    09286038
047900       WHEN (PM100-AD-PG-NBR IS NOT = PV-AD-PG-NBR)               09290000
PGNBR         AND (PM100-PROMO-ITM-ADV-IND = 'Y')                       09300038
048100            PERFORM 3110-PROCESS-PAGE-TTL                         09310000
048400            INITIALIZE TBL-SECT-TOTAL-TABLE                       09340000
048500            MOVE PM100-AD-PG-NBR   TO PV-AD-PG-NBR                09350000
048600            PERFORM 3400-PROCESS-DETAIL-HEADER                    09360000
049100     END-EVALUATE.                                                09370000
PGNBR                                                                   09371038
PGNBR      SET PS-NO-EOF-REC-TYPE TO TRUE.                              09372038
PGNBR                                                                   09373038
049200     PERFORM 2200-PROCESS-DETAIL.                                 09380000
049300                                                                  09390000
049400     PERFORM 8000-READ-SALES-RESULTS.                             09400000
049500                                                                  09410000
049600*2000-EXIT.                                                       09420000
049700 EJECT.                                                           09430000
049800                                                                  09440000
049900*----------------------------------------------------------       09450000
050000* 2010-SET-TTL-PRINT-VARIABLES.                                   09460000
050100*     SET ALL THE PRINT SWITCHES TO OFF.                          09470000
050200*----------------------------------------------------------       09480000
050300 2010-SET-TTL-PRINT-SW-OFF.                                       09490000
050400                                                                  09500000
050500     SET PS-NO-PAGE-TTL         TO TRUE.                          09510000
050600     SET PS-NO-ADV-PROMO-TTL    TO TRUE.                          09520000
PGNBR      SET PS-NO-ADV-NOPGE-TTL    TO TRUE.                          09521038
050700     SET PS-NO-UNADV-PROMO-TTL  TO TRUE.                          09530000
050900     SET PS-NO-TOT-PROMO-TTL    TO TRUE.                          09540000
051000                                                                  09550000
051100     MOVE ZEROES                TO PA-CNT-ADV-TOT                 09560000
PGNBR                                    PA-CNT-ADVNO-TOT               09561038
051200                                   PA-CNT-UNADV-TOT.              09570004
051400                                                                  09580000
051500*2010-EXIT.                                                       09590000
051600 EJECT.                                                           09600000
051700                                                                  09610000
051800*----------------------------------------------------------       09620000
051900* 2100-ADEVNT-PROMO-HDR-BREAK.                                    09630000
052000*     WHEN AN ADEVENT ID/PROMO ID CHANGE, GIVE THE NEW            09640000
052100*     START/END DATES.                                            09650000
052200*----------------------------------------------------------       09660000
052300 2100-ADEVNT-PROMO-HDR-BREAK.                                     09670000
052400                                                                  09680000
052500     INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              09690000
052600     SET DPG51-ACTUAL-CALENDAR-ONLY      TO TRUE.                 09700000
052700     SET DPG51-DO-NOT-INCR-DECR-DATE     TO TRUE.                 09710000
052800     SET DPG52-LK-DTE-ISO-FMT            TO TRUE.                 09720000
052900     MOVE PM100-PROMO-STRT-TMST          TO PV-PROMO-STRT-TMST.   09730000
053000     MOVE PM100-PROMO-END-TMST           TO PV-PROMO-END-TMST.    09740000
053100     MOVE PV-PROMO-STRT-DTE              TO DPG52-LK-DATE-INPUT.  09750000
053110     MOVE 'INVALID PROMO BEGINNING DATE' TO PV-OPERATION-MSG-1.   09760000
053111                                                                  09770000
053112     PERFORM 9100-CALENDAR-ROUTINE.                               09780000
053113                                                                  09790000
053114     MOVE DPG55-ALPHA-WEEK-DAY  TO PV-BEG-DAY-ALPHA.              09800000
053115     MOVE DPG55-GREG-DATE-FMT   TO PV-BEG-DATE.                   09810000
053116                                                                  09820000
053117     IF (PV-PM-STRT-TM-HH =                                       09830000
053118         PC-DEFAULT-BEG-HR AND                                    09840000
053119         PV-PM-STRT-TM-MM =                                       09850000
053120         PC-DEFAULT-BEG-MIN)                                      09860000
053130         IF PV-PROMO-STRT-DTE = PV-PROMO-END-DTE                  09870000
053140* NEED TO CLEAR OUT ANY LETTERS FROM A PREVIOUS 'ALL DAY' DISPLAY 09880000
053150            MOVE SPACES         TO PV-BEG-TIME                    09890000
053160            MOVE PV-PM-STRT-TM-HH                                 09900000
053170                                TO PV-BEG-HR-TIME                 09910000
053180            MOVE PC-COLON       TO PV-BEG-TIME-COLON              09920000
053190            MOVE PV-PM-STRT-TM-MM                                 09930000
053200                                TO PV-BEG-MIN-TIME                09940000
053300         ELSE                                                     09950000
053400            MOVE PC-ALL-DAY     TO PV-BEG-TIME                    09960000
053500         END-IF                                                   09970000
053600     ELSE                                                         09980000
053700* NEED TO CLEAR OUT ANY LETTERS FROM A PREVIOUS 'ALL DAY' DISPLAY 09990000
053800        MOVE SPACES             TO PV-BEG-TIME                    10000000
053900        MOVE PV-PM-STRT-TM-HH                                     10010000
054000                                TO PV-BEG-HR-TIME                 10020000
054100        MOVE PC-COLON           TO PV-BEG-TIME-COLON              10030000
054200        MOVE PV-PM-STRT-TM-MM                                     10040000
054300                                TO PV-BEG-MIN-TIME                10050000
054400     END-IF.                                                      10060000
054500                                                                  10070000
054600     INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              10080000
054700     SET DPG51-ACTUAL-CALENDAR-ONLY   TO TRUE.                    10090000
054800     SET DPG51-DO-NOT-INCR-DECR-DATE  TO TRUE.                    10100000
054900     SET DPG52-LK-DTE-ISO-FMT         TO TRUE.                    10110000
055000     MOVE PV-PROMO-END-DTE            TO DPG52-LK-DATE-INPUT.     10120000
055100     MOVE 'INVALID PROMO ENDING DATE' TO PV-OPERATION-MSG-1.      10130000
055200                                                                  10140000
055300     PERFORM 9100-CALENDAR-ROUTINE.                               10150000
055400                                                                  10160000
055500     MOVE DPG55-ALPHA-WEEK-DAY  TO PV-END-DAY-ALPHA.              10170000
055600     MOVE DPG55-GREG-DATE-FMT   TO PV-END-DATE.                   10180000
055700                                                                  10190000
055800     IF (PV-PM-END-TM-HH =                                        10200000
055900         PC-DEFAULT-END-HR AND                                    10210000
056000         PV-PM-END-TM-MM =                                        10220000
056100         PC-DEFAULT-END-MIN)                                      10230000
056200         IF PV-PROMO-STRT-DTE = PV-PROMO-END-DTE                  10240000
056300* NEED TO CLEAR OUT ANY LETTERS FROM A PREVIOUS 'ALL DAY' DISPLAY 10250000
056400            MOVE SPACES         TO PV-END-TIME                    10260000
056500            MOVE PV-PM-END-TM-HH                                  10270000
056600                                TO PV-END-HR-TIME                 10280000
056700            MOVE PC-COLON       TO PV-END-TIME-COLON              10290000
056800            MOVE PV-PM-END-TM-MM                                  10300000
056900                                TO PV-END-MIN-TIME                10310000
057000         ELSE                                                     10320000
057100            MOVE PC-ALL-DAY     TO PV-END-TIME                    10330000
057200         END-IF                                                   10340000
057300      ELSE                                                        10350000
057400* NEED TO CLEAR OUT ANY LETTERS FROM A PREVIOUS 'ALL DAY' DISPLAY 10360000
057500         MOVE SPACES            TO PV-END-TIME                    10370000
057600         MOVE PV-PM-END-TM-HH                                     10380000
057700                                TO PV-END-HR-TIME                 10390000
057800         MOVE PC-COLON          TO PV-END-TIME-COLON              10400000
057900         MOVE PV-PM-END-TM-MM                                     10410000
058000                                TO PV-END-MIN-TIME                10420000
058100     END-IF.                                                      10430000
058200                                                                  10440000
058300*2100-EXIT.                                                       10450000
058400 EJECT.                                                           10460000
058500                                                                  10470000
058600*----------------------------------------------------------       10480000
058700* 2200-PROCESS-DETAIL.                                            10490000
058800*     PROCESS REPORT DETAIL LINES.                                10500000
058900*----------------------------------------------------------       10510000
059000 2200-PROCESS-DETAIL.                                             10520000
059100                                                                  10530000
059200     MOVE SPACES                TO DETAIL-01                      10540000
059300                                   DETAIL-02                      10550000
059400                                   DETAIL-VARIABLE.               10560000
059500                                                                  10570000
059600*** WHEN THE RECORD IS TIERED PRICING SET UP THE DETAIL           10580004
059700*** LINES DIFFERENTLY.                                            10590004
059800     IF PM100-TIER-PRICG                                          10600004
059900        PERFORM 2210-CREATE-TIER-DESC                             10610000
060000        MOVE PV-TIER-ITM-DESC   TO DTL-01-PMITEM-DESC             10620000
060980     ELSE                                                         10630000
060990        MOVE PM100-PROMO-ITM-DESC   TO DTL-01-PMITEM-DESC         10640000
061000        MOVE PM100-AD-SP-CDE        TO DTL-01-AD-SPC-CDE          10650000
061100     END-IF.                                                      10660000
061110                                                                  10670000
061120*** THIS IS PROCESSED FOR ACTUAL REPORTS ONLY.                    10680000
061130     IF PM100-ACTUAL                                              10690000
061160        MOVE PM100-ACTL-SLS-RTL-AMT  TO DTL-01-ACTL-SLS-RTL-AMT   10700029
061177        MOVE PM100-ACTL-MKDN-RTL-AMT TO DTL-01-ACTL-MD-AMT        10710029
061300        MOVE PM100-ACTL-SLS-UNT-QTY  TO DTL-01-ACTL-UNT-SLD-QTY   10720029
061800        MOVE PM100-ACTL-SLS-COST-AMT TO DTL-01-ACTL-COST-AMT      10730031
061900                                                                  10740031
062300*** THIS IS PROCESSED FOR ACTUAL SIMPLE PRICING RECORDS           10750000
062400*** ONLY.                                                         10760000
062500        IF PM100-SMPL-PRICG                                       10770000
062600           IF PM100-PROMO-REG-TYP-CDE = 'U '                      10780000
062700              PERFORM 2220-FORMAT-PROMO-ITM-DTES                  10790000
062800              MOVE PV-PM-ITM-EFF-STRT-DTE TO PV-EFF-STRT-DTE      10800000
062900              MOVE PV-PM-ITM-EFF-END-DTE  TO PV-EFF-END-DTE       10810000
063000              MOVE PC-DASH                TO PV-DTE-DASH          10820000
063100              MOVE PC-FRONT-PAR           TO PV-OPEN-PARENTH      10830000
063200              MOVE PC-BACK-PAR            TO PV-CLOSE-PARENTH     10840000
063300              MOVE PV-EFF-DTE-LAYOUT      TO DTL-02-EFF-DTES      10850000
063400           END-IF                                                 10860000
063401           MOVE PM100-ACTL-PREP-UNT-QTY TO                        10870031
063402                                    DTL-01-ACTL-PREP-UNT-QTY      10880031
063410           ADD PM100-ACTL-SLS-RTL-AMT  TO                         10890004
063420                              TBL-STOT-TOT-SALE-AMT(PC-SUB-1)     10900004
063430                              TBL-PMTOT-TOT-SALE-AMT(PC-SUB-1)    10910004
063440           ADD PM100-ACTL-MKDN-RTL-AMT TO                         10920004
063450                                TBL-STOT-TOT-MD-AMT(PC-SUB-1)     10930004
063460                                TBL-PMTOT-TOT-MD-AMT(PC-SUB-1)    10940004
063470           ADD PM100-ACTL-SLS-UNT-QTY  TO                         10950004
063480                            TBL-STOT-TOT-SLS-UNT-QTY(PC-SUB-1)    10960004
063490                            TBL-PMTOT-TOT-SLS-UNT-QTY(PC-SUB-1)   10970004
063491           ADD PM100-ACTL-SLS-COST-AMT TO                         10980004
063492                              TBL-STOT-TOT-SLS-COST-AMT(PC-SUB-1) 10990004
063493                              TBL-PMTOT-TOT-SLS-COST-AMT(PC-SUB-1)11000004
063500           ADD PM100-ACTL-EOH-INV-QTY TO                          11010000
063600                              TBL-STOT-TOT-EOH-INV-QTY(PC-SUB-1)  11020000
063700                              TBL-PMTOT-TOT-EOH-INV-QTY(PC-SUB-1) 11030000
064200           ADD PM100-ACTL-PREP-UNT-QTY TO                         11040000
064300                                TBL-STOT-PREP-UNT-QTY(PC-SUB-1)   11050000
064400                                TBL-PMTOT-PREP-UNT-QTY(PC-SUB-1)  11060000
064410                                                                  11070016
064500           MOVE ZEROES              TO PV-ROUND-TO-TENTHS         11080000
064600           ADD PM100-ACTL-TOT-MKUP-PCT                            11090000
064700                                    TO PV-ROUND-TO-TENTHS ROUNDED 11100000
064800           MOVE PV-ROUND-TO-TENTHS  TO DTL-01-ACTL-MU-PCT         11110000
064810           MOVE PC-PERCENT-SIGN     TO DTL-01-ACTL-PCT-SIGN       11120024
064900                                                                  11130000
065500           MOVE ZEROES             TO PV-ROUND-TO-TENTHS          11140000
065600           ADD PM100-SELL-THRU-PCT TO PV-ROUND-TO-TENTHS ROUNDED  11150000
065700           MOVE PV-ROUND-TO-TENTHS TO DTL-01-SELL-THRU-PCT        11160000
065710           MOVE PC-PERCENT-SIGN    TO DTL-O1-SELL-PCT-SIGN        11170024
066300                                                                  11180000
066310           IF PM100-FCST-SLS-RTL-AMT = ZEROES                     11190028
066320              MOVE SPACES          TO DETAIL-VARIABLE             11200024
066330              MOVE DETAIL-VARIABLE TO DTL-01-VOL-PCT-CHG          11210023
066331              MOVE SPACES          TO DTL-01-VOL-PCT-SIGN         11220023
066340           ELSE                                                   11230023
066400              MOVE ZEROES           TO PV-ROUND-TO-TENTHS         11240023
066500              ADD PM100-VOL-PCT-CHG TO PV-ROUND-TO-TENTHS ROUNDED 11250023
066600              IF PM100-VOL-PCT-CHG < 0                            11260023
066700                 PERFORM 9000-ADD-PARENTH-TO-NEG-PCT              11270023
066800                 MOVE PV-FINAL-VOL-PCT   TO DTL-01-VOL-PCT-CHG    11280023
066900              ELSE                                                11290023
067000                 MOVE PV-ROUND-TO-TENTHS TO DTL-VAR-VOL-PCT-CHG   11300023
067100                 MOVE DETAIL-VARIABLE    TO DTL-01-VOL-PCT-CHG    11310023
067110              END-IF                                              11320023
067120              MOVE PC-PERCENT-SIGN    TO DTL-01-VOL-PCT-SIGN      11330024
067143           END-IF                                                 11340023
067144        END-IF                                                    11350000
067145     END-IF.                                                      11360000
067146                                                                  11370000
067147*** THIS IS PROCESSED FOR ALL SIMPLE PRICING RECORD IN            11380000
067148*** ACTUAL AND FORECAST REPORTS.                                  11390000
067149     IF PM100-SMPL-PRICG                                          11400000
067150        MOVE PM100-MIN-UNT-REG-RTL-AMT TO DTL-01-MIN-RTL-PRC      11410000
067151        MOVE PM100-MAX-UNT-REG-RTL-AMT TO DTL-01-MAX-RTL-PRC      11420000
067160        MOVE PM100-MIN-UNT-PRM-RTL-AMT TO DTL-01-MIN-PROMO-PRC    11430000
067170        MOVE PM100-MAX-UNT-PRM-RTL-AMT TO DTL-01-MAX-PROMO-PRC    11440000
067180        IF PM100-MIN-UNT-REG-RTL-AMT NOT = 0 AND                  11450000
067190           PM100-MAX-UNT-REG-RTL-AMT NOT = 0                      11460000
067200           MOVE PC-DASH                TO DTL-01-RTL-DASH         11470000
067210        END-IF                                                    11480000
067220        IF PM100-MIN-UNT-PRM-RTL-AMT NOT = 0 AND                  11490000
067230           PM100-MAX-UNT-PRM-RTL-AMT NOT = 0                      11500000
067240           MOVE PC-DASH                TO DTL-01-PRM-DASH         11510000
067250        END-IF                                                    11520000
067251                                                                  11530016
067280        MOVE PM100-FCST-SLS-RTL-AMT TO DTL-01-FCST-SLS-RTL-AMT    11540031
067290        ADD PM100-FCST-SLS-RTL-AMT  TO                            11550000
067300                               TBL-STOT-TOT-SALE-AMT(PC-SUB-2)    11560000
067400                               TBL-PMTOT-TOT-SALE-AMT(PC-SUB-2)   11570000
067410                                                                  11580016
067700        MOVE PM100-FCST-MKDN-RTL-AMT TO DTL-01-FCST-MD-AMT        11590031
067800        ADD PM100-FCST-MKDN-RTL-AMT TO                            11600000
067900                                   TBL-STOT-TOT-MD-AMT(PC-SUB-2)  11610000
068000                                   TBL-PMTOT-TOT-MD-AMT(PC-SUB-2) 11620000
068010                                                                  11630016
068300        MOVE PM100-FCST-SLS-UNT-QTY TO DTL-01-FCST-UNT-SLD-QTY    11640031
068400        ADD PM100-FCST-SLS-UNT-QTY  TO                            11650000
068500                            TBL-STOT-TOT-SLS-UNT-QTY(PC-SUB-2)    11660000
068600                            TBL-PMTOT-TOT-SLS-UNT-QTY(PC-SUB-2)   11670000
068610                                                                  11680016
069000        MOVE PM100-FCST-PROJD-UNT-QTY TO                          11690031
069010                                  DTL-01-FCST-PREP-UNT-QTY        11700031
069100        ADD PM100-FCST-PROJD-UNT-QTY  TO                          11710031
069200                                  TBL-STOT-PREP-UNT-QTY(PC-SUB-2) 11720000
069300                                  TBL-PMTOT-PREP-UNT-QTY(PC-SUB-2)11730000
069310                                                                  11740016
069600        MOVE PM100-FCST-SLS-COST-AMT  TO DTL-01-FCST-COST-AMT     11750031
069700        ADD PM100-FCST-SLS-COST-AMT TO                            11760000
069800                              TBL-STOT-TOT-SLS-COST-AMT(PC-SUB-2) 11770000
069900                              TBL-PMTOT-TOT-SLS-COST-AMT(PC-SUB-2)11780000
070000                                                                  11790000
070010        IF PM100-FCST-SLS-RTL-AMT = ZEROES                        11800027
070020           CONTINUE                                               11810027
070030        ELSE                                                      11820027
070100           MOVE ZEROES                 TO PV-ROUND-TO-TENTHS      11830027
070200           ADD PM100-FCST-TOT-MKUP-PCT TO                         11840027
070210                                 PV-ROUND-TO-TENTHS ROUNDED       11850027
070300           MOVE PV-ROUND-TO-TENTHS     TO DTL-01-FCST-MU-PCT      11860027
070310           MOVE PC-PERCENT-SIGN        TO DTL-01-FCST-PCT-SIGN    11870027
070900        END-IF                                                    11880000
071000     END-IF.                                                      11890000
071100                                                                  11900000
071200     MOVE 1                     TO PV-ADVANCE-LINES               11910000
071300                                   PV-SAVE-LINE-AMT.              11920000
071400     ADD PV-ADVANCE-LINES       TO PV-LINE-CNT.                   11930000
071500     PERFORM 3200-CHECK-MAX-LINE-CNT.                             11940000
071600     MOVE DETAIL-01             TO PV-RPT-LINE.                   11950000
071700     PERFORM 8200-WRITE-RPT-LINE.                                 11960000
071710                                                                  11970000
071720     IF PM100-PROMO-REG-TYP-CDE = 'U '                            11980000
071730        MOVE 1                     TO PV-ADVANCE-LINES            11990000
071740        ADD PV-ADVANCE-LINES       TO PV-LINE-CNT                 12000000
071750        MOVE DETAIL-02             TO PV-RPT-LINE                 12010000
071760        PERFORM 8200-WRITE-RPT-LINE                               12020000
071770     END-IF.                                                      12030000
071780                                                                  12040000
071781     IF PM100-AD-VERSION(PC-SUB-1) NOT = SPACES                   12050017
071782        MOVE SPACES TO PV-VERSION-AD                              12060019
071783        PERFORM 2230-CREATE-VERSION-DATA                          12070017
071784        MOVE 1                     TO PV-ADVANCE-LINES            12080017
071785        ADD PV-ADVANCE-LINES       TO PV-LINE-CNT                 12090017
071786        MOVE DETAIL-02             TO PV-RPT-LINE                 12100017
071787        PERFORM 8200-WRITE-RPT-LINE                               12110017
071788     END-IF.                                                      12120017
071789                                                                  12130017
071790*2200-EXIT.                                                       12140000
071800 EJECT.                                                           12150000
071900                                                                  12160000
072000*----------------------------------------------------------       12170000
072100* 2210-CREATE-TIER-DESC.                                          12180000
072200*     CREATE THE PROMO ITEM DESCRIPTION FIELD FOR TIERED          12190000
072300*     PRICING RECORDS.                                            12200004
072400*----------------------------------------------------------       12210000
072500 2210-CREATE-TIER-DESC.                                           12220000
072600                                                                  12230000
072700     INITIALIZE PA-CNT-POS-1                                      12240000
072800                PA-CNT-POS-2                                      12250000
072900                PA-CNT-SPACES-1                                   12260000
073000                PA-CNT-SPACES-2                                   12270000
073100                PV-TIER-ITM-DESC.                                 12280000
073200                                                                  12290000
073300     EVALUATE TRUE                                                12300000
073400         WHEN PM100-TIER-PRICG-TYP-CDE = 'TAP'                    12310000
073500              MOVE PM100-TIER-THRS-AMT TO PV-THRS-AMT-NUM         12320000
073600              MOVE PV-THRS-AMT-NUM-X   TO PV-SAVE-THRS-AMT        12330000
073700              MOVE PV-SAVE-THRS-AMT-1  TO PV-THRS-AMT-CHAR        12340000
073800              INSPECT PV-THRS-AMT-CHAR REPLACING                  12350000
073900                      LEADING ZERO BY " "                         12360000
074000              INSPECT PV-THRS-AMT-CHAR                            12370000
074100                     TALLYING PA-CNT-SPACES-1 FOR ALL " "         12380000
074200              COMPUTE PA-CNT-POS-1 = 8 - PA-CNT-SPACES-1          12390000
074300              ADD +1 TO PA-CNT-SPACES-1                           12400000
074400              MOVE PM100-TIER-DISC-PCT TO PV-DISC-PCT-NUM         12410000
074500              MOVE PV-DISC-PCT-NUM-X   TO PV-SAVE-DISC-PCT        12420000
074600              MOVE PV-SAVE-DISC-PCT-1  TO PV-DISC-PCT-CHAR        12430000
074700              INSPECT PV-DISC-PCT-CHAR REPLACING                  12440000
074800                      LEADING ZERO BY " "                         12450000
074900              INSPECT PV-DISC-PCT-CHAR                            12460000
075000                     TALLYING PA-CNT-SPACES-2 FOR ALL " "         12470000
075100              COMPUTE PA-CNT-POS-2 = 3 - PA-CNT-SPACES-2          12480000
075200              ADD +1 TO PA-CNT-SPACES-2                           12490000
075300              MOVE +1 TO PV-POINTER-FIELD                         12500000
075400              STRING PC-CHAR-BUY DELIMITED BY " "                 12510000
075500                     " " DELIMITED BY SIZE                        12520000
075600                     PC-DOLLAR-SIGN DELIMITED BY " "              12530000
075700                     PV-THRS-AMT-CHAR                             12540000
075800                         (PA-CNT-SPACES-1:PA-CNT-POS-1)           12550000
075900                     "," DELIMITED BY SIZE                        12560000
076000                     " " DELIMITED BY SIZE                        12570000
076100                     PC-CHAR-GET DELIMITED BY " "                 12580000
076200                     " " DELIMITED BY SIZE                        12590000
076300                     PV-DISC-PCT-CHAR                             12600000
076400                         (PA-CNT-SPACES-2:PA-CNT-POS-2)           12610000
076500                     PC-PERCENT-SIGN DELIMITED BY " "             12620000
076600                     " " DELIMITED BY SIZE                        12630000
076700                     PC-CHAR-OFF DELIMITED BY " "                 12640000
076800              INTO PV-TIER-ITM-DESC-1                             12650000
076900              WITH POINTER PV-POINTER-FIELD                       12660000
077000         WHEN PM100-TIER-PRICG-TYP-CDE = 'TQP'                    12670000
077100              MOVE PM100-TIER-THRS-QTY TO PV-THRS-QTY-CHAR        12680000
077200              INSPECT PV-THRS-QTY-CHAR REPLACING                  12690000
077300                      LEADING ZERO BY " "                         12700000
077400              INSPECT PV-THRS-QTY-CHAR                            12710000
077500                     TALLYING PA-CNT-SPACES-1 FOR ALL " "         12720000
077600              COMPUTE PA-CNT-POS-1 = 5 - PA-CNT-SPACES-1          12730000
077700              ADD +1 TO PA-CNT-SPACES-1                           12740000
077800              MOVE PM100-TIER-DISC-PCT TO PV-DISC-PCT-NUM         12750000
077900              MOVE PV-DISC-PCT-NUM-X   TO PV-SAVE-DISC-PCT        12760000
078000              MOVE PV-SAVE-DISC-PCT-1  TO PV-DISC-PCT-CHAR        12770000
078100              INSPECT PV-DISC-PCT-CHAR REPLACING                  12780000
078200                      LEADING ZERO BY " "                         12790000
078300              INSPECT PV-DISC-PCT-CHAR                            12800000
078400                     TALLYING PA-CNT-SPACES-2 FOR ALL " "         12810000
078500              COMPUTE PA-CNT-POS-2 = 3 - PA-CNT-SPACES-2          12820000
078600              ADD +1 TO PA-CNT-SPACES-2                           12830000
078700              MOVE +1 TO PV-POINTER-FIELD                         12840000
078800              STRING PC-CHAR-BUY DELIMITED BY " "                 12850000
078900                     " " DELIMITED BY SIZE                        12860000
079000                     PV-THRS-QTY-CHAR                             12870000
079100                         (PA-CNT-SPACES-1:PA-CNT-POS-1)           12880000
079200                     "," DELIMITED BY SIZE                        12890000
079300                     " " DELIMITED BY SIZE                        12900000
079400                     PC-CHAR-GET DELIMITED BY " "                 12910000
079500                     " " DELIMITED BY SIZE                        12920000
079600                     PV-DISC-PCT-CHAR                             12930000
079700                         (PA-CNT-SPACES-2:PA-CNT-POS-2)           12940000
079800                     PC-PERCENT-SIGN DELIMITED BY " "             12950000
079900                     " " DELIMITED BY SIZE                        12960000
079910                     PC-CHAR-OFF DELIMITED BY " "                 12970000
079920              INTO PV-TIER-ITM-DESC-1                             12980000
079930              WITH POINTER PV-POINTER-FIELD                       12990000
079940         WHEN PM100-TIER-PRICG-TYP-CDE = 'TQA'                    13000000
079950              MOVE PM100-TIER-THRS-QTY TO PV-THRS-QTY-CHAR        13010000
079960              INSPECT PV-THRS-QTY-CHAR REPLACING                  13020000
079970                      LEADING ZERO BY " "                         13030000
079980              INSPECT PV-THRS-QTY-CHAR                            13040000
079981                     TALLYING PA-CNT-SPACES-1 FOR ALL " "         13050000
079982              COMPUTE PA-CNT-POS-1 = 5 - PA-CNT-SPACES-1          13060000
079983              ADD +1 TO PA-CNT-SPACES-1                           13070000
079984              MOVE PM100-TIER-DISC-AMT TO PV-DISC-AMT-NUM         13080000
079985              MOVE PV-DISC-AMT-NUM-X   TO PV-SAVE-DISC-AMT        13090000
079986              MOVE PV-SAVE-DISC-AMT-1  TO PV-DISC-AMT-CHAR        13100000
079987              INSPECT PV-DISC-AMT-CHAR REPLACING                  13110000
079988                      LEADING ZERO BY " "                         13120000
079989              INSPECT PV-DISC-AMT-CHAR                            13130000
079990                     TALLYING PA-CNT-SPACES-2 FOR ALL " "         13140000
080000              COMPUTE PA-CNT-POS-2 = 8 - PA-CNT-SPACES-2          13150000
080001              ADD +1 TO PA-CNT-SPACES-2                           13160000
080002              MOVE +1 TO PV-POINTER-FIELD                         13170000
080003              STRING PC-CHAR-BUY DELIMITED BY " "                 13180000
080004                     " " DELIMITED BY SIZE                        13190000
080005                     PV-THRS-QTY-CHAR                             13200000
080006                         (PA-CNT-SPACES-1:PA-CNT-POS-1)           13210000
080007                     "," DELIMITED BY SIZE                        13220000
080008                     " " DELIMITED BY SIZE                        13230000
080009                     PC-CHAR-GET DELIMITED BY " "                 13240000
080010                     " " DELIMITED BY SIZE                        13250000
080011                     PC-DOLLAR-SIGN DELIMITED BY " "              13260000
080012                     PV-DISC-AMT-CHAR                             13270000
080013                         (PA-CNT-SPACES-2:PA-CNT-POS-2)           13280000
080014                     " " DELIMITED BY SIZE                        13290000
080015                     PC-CHAR-OFF DELIMITED BY " "                 13300000
080016              INTO PV-TIER-ITM-DESC-1                             13310000
080017              WITH POINTER PV-POINTER-FIELD                       13320000
080018         WHEN PM100-TIER-PRICG-TYP-CDE = 'TAA'                    13330000
080019              MOVE PM100-TIER-THRS-AMT TO PV-THRS-AMT-NUM         13340000
080020              MOVE PV-THRS-AMT-NUM-X   TO PV-SAVE-THRS-AMT        13350000
080021              MOVE PV-SAVE-THRS-AMT-1  TO PV-THRS-AMT-CHAR        13360000
080022              INSPECT PV-THRS-AMT-CHAR REPLACING                  13370000
080023                      LEADING ZERO BY " "                         13380000
080024              INSPECT PV-THRS-AMT-CHAR                            13390000
080025                     TALLYING PA-CNT-SPACES-1 FOR ALL " "         13400000
080026              COMPUTE PA-CNT-POS-1 = 8 - PA-CNT-SPACES-1          13410000
080027              ADD +1 TO PA-CNT-SPACES-1                           13420000
080028              MOVE PM100-TIER-DISC-AMT TO PV-DISC-AMT-NUM         13430000
080029              MOVE PV-DISC-AMT-NUM-X   TO PV-SAVE-DISC-AMT        13440000
080030              MOVE PV-SAVE-DISC-AMT-1  TO PV-DISC-AMT-CHAR        13450000
080031              INSPECT PV-DISC-AMT-CHAR REPLACING                  13460000
080032                      LEADING ZERO BY " "                         13470000
080033              INSPECT PV-DISC-AMT-CHAR                            13480000
080034                     TALLYING PA-CNT-SPACES-2 FOR ALL " "         13490000
080035              COMPUTE PA-CNT-POS-2 = 8 - PA-CNT-SPACES-2          13500000
080036              ADD +1 TO PA-CNT-SPACES-2                           13510000
080037              MOVE +1 TO PV-POINTER-FIELD                         13520000
080038              STRING PC-CHAR-BUY DELIMITED BY " "                 13530000
080039                     " " DELIMITED BY SIZE                        13540000
080040                     PC-DOLLAR-SIGN DELIMITED BY " "              13550000
080041                     PV-THRS-AMT-CHAR                             13560000
080042                         (PA-CNT-SPACES-1:PA-CNT-POS-1)           13570000
080043                     "," DELIMITED BY SIZE                        13580000
080044                     " " DELIMITED BY SIZE                        13590000
080045                     PC-CHAR-GET DELIMITED BY " "                 13600000
080046                     " " DELIMITED BY SIZE                        13610000
080047                     PC-DOLLAR-SIGN DELIMITED BY " "              13620000
080048                     PV-DISC-AMT-CHAR                             13630000
080049                         (PA-CNT-SPACES-2:PA-CNT-POS-2)           13640000
080050                     " " DELIMITED BY SIZE                        13650000
080051                     PC-CHAR-OFF DELIMITED BY " "                 13660000
080052              INTO PV-TIER-ITM-DESC-1                             13670000
080053              WITH POINTER PV-POINTER-FIELD                       13680000
080054     END-EVALUATE.                                                13690000
080055                                                                  13700000
080056*2210-EXIT.                                                       13710000
080057 EJECT.                                                           13720000
080058                                                                  13730000
080059*----------------------------------------------------------       13740000
080060* 2220-FORMAT-PROMO-ITM-DTES.                                     13750000
080061*     IF THE PROMO ITEM IS ATTACHED TO AN UNADVERTISED            13760000
080062*     PROMOTION, THE PROMO ITEM EFFECTIVE DATES NEED              13770000
080063*     TO BE INCLUDED IN THE REPORTS.                              13780000
080064*----------------------------------------------------------       13790000
080065 2220-FORMAT-PROMO-ITM-DTES.                                      13800000
080066                                                                  13810000
080067     MOVE PM100-PROMO-ITM-STRT-TMST TO PV-PROMO-ITM-STRT-TMST.    13820000
080068     MOVE PM100-PROMO-ITM-END-TMST  TO PV-PROMO-ITM-END-TMST.     13830000
080069     MOVE PV-PI-STRT-DTE-YY         TO PV-EFF-STRT-DTE-YY.        13840000
080070     MOVE PV-PI-STRT-DTE-MM         TO PV-EFF-STRT-DTE-MM.        13850000
080071     MOVE PV-PI-STRT-DTE-DD         TO PV-EFF-STRT-DTE-DD.        13860000
080072     MOVE PV-PI-END-DTE-YY          TO PV-EFF-END-DTE-YY.         13870000
080073     MOVE PV-PI-END-DTE-MM          TO PV-EFF-END-DTE-MM.         13880000
080074     MOVE PV-PI-END-DTE-DD          TO PV-EFF-END-DTE-DD.         13890000
080075                                                                  13900000
080076*2220-EXIT.                                                       13910000
080077 EJECT.                                                           13920000
080078                                                                  13930017
080079*----------------------------------------------------------       13940017
080080* 2230-CREATE-VERSION-DATA.                                       13950017
080081*     CREATE THE VERSION DATA IF THE PROMO ITEM HAS SPECIFIC      13960017
080082*     VERSIONS THAT IT IS IN.                                     13970017
080083*----------------------------------------------------------       13980017
080084 2230-CREATE-VERSION-DATA.                                        13990017
080085                                                                  14000017
080086     INITIALIZE PV-CHAR-LENGTH.                                   14010017
080087     MOVE +1 TO PV-POINTER-FIELD.                                 14020017
080088     PERFORM                                                      14030017
080089       VARYING PV-VAR-IDX FROM 1 BY 1                             14040017
080090         UNTIL PM100-AD-VERSION(PV-VAR-IDX) = SPACES              14050017
080091            OR PV-VAR-IDX > 15                                    14060017
080092              STRING PM100-AD-VERSION(PV-VAR-IDX) DELIMITED BY " "14070017
080093              "," DELIMITED BY SIZE                               14080017
080094              " " DELIMITED BY SIZE                               14090017
080095          INTO PV-VERSION-AD                                      14100017
080096          WITH POINTER PV-POINTER-FIELD                           14110017
080097     END-PERFORM.                                                 14120017
080098                                                                  14130017
080099     MOVE PC-FRONT-PAR          TO PV-PARENTHESES.                14140017
080100     MOVE PV-VERSION-AD         TO PV-SAVE-VAR.                   14150017
080101     MOVE 61                    TO PV-SAVE-NUM.                   14160017
080102     PERFORM 2310-COUNT-FIELD-LENGTH.                             14170017
080103     MOVE PV-SAVE-LENGTH        TO PV-CHAR-LENGTH.                14180017
080104                                                                  14190017
080105     MOVE PC-BACK-PAR          TO PV-VERSION-AD(PV-CHAR-LENGTH:1).14200017
080106     MOVE PV-VER-AD-VARIABLE   TO DTL-01-VERSION-AD.              14210017
080107                                                                  14220017
080108*2230-EXIT.                                                       14230017
080109 EJECT.                                                           14240017
080110                                                                  14250017
080111*----------------------------------------------------------       14260000
080112* 2300-FORMAT-HEADING-FIELDS.                                     14270000
080113*     FORMAT THE AD EVENT TITLES AND THE PROMOTION TITLES.        14280000
080120*----------------------------------------------------------       14290000
080200 2300-FORMAT-HEADING-FIELDS.                                      14300000
080210                                                                  14310000
080220     MOVE PM100-AD-EVNT-NBR-TXT TO PV-SAVE-VAR.                   14320000
080230     MOVE 16                    TO PV-SAVE-NUM.                   14330000
080231     PERFORM 2310-COUNT-FIELD-LENGTH.                             14340000
080232     MOVE PV-SAVE-LENGTH        TO PV-AD-EVNT-NBR-LENGTH.         14350000
080233                                                                  14360000
080234     MOVE PM100-AD-EVNT-NM      TO PV-SAVE-VAR.                   14370000
080235     MOVE 41                    TO PV-SAVE-NUM.                   14380000
080236     PERFORM 2310-COUNT-FIELD-LENGTH.                             14390000
080237     MOVE PV-SAVE-LENGTH        TO PV-AD-EVNT-NM-LENGTH.          14400000
080238                                                                  14410000
080239     MOVE PM100-PROMO-NM        TO PV-SAVE-VAR.                   14420000
080240     MOVE 41                    TO PV-SAVE-NUM.                   14430000
080250     PERFORM 2310-COUNT-FIELD-LENGTH.                             14440000
080251     MOVE PV-SAVE-LENGTH        TO PV-PROMO-NM-LENGTH.            14450000
080252                                                                  14460000
080253     MOVE PM100-BYR-FRST-NM     TO PV-SAVE-VAR.                   14470000
080254     MOVE 41                    TO PV-SAVE-NUM.                   14480000
080255     PERFORM 2310-COUNT-FIELD-LENGTH.                             14490000
080256     MOVE PV-SAVE-LENGTH        TO PV-BUYER-FRST-LENGTH.          14500000
080257                                                                  14510000
080258     MOVE PM100-BYR-LAST-NM     TO PV-SAVE-VAR.                   14520000
080259     MOVE 41                    TO PV-SAVE-NUM.                   14530000
080260     PERFORM 2310-COUNT-FIELD-LENGTH.                             14540000
080261     MOVE PV-SAVE-LENGTH        TO PV-BUYER-LAST-LENGTH.          14550000
080262                                                                  14560000
080263*2300-EXIT.                                                       14570000
080264 EJECT.                                                           14580000
080265                                                                  14590000
080266*----------------------------------------------------------       14600000
080267* 2310-COUNT-FIELD-LENGTH.                                        14610000
080268*     COUNTS THE ACTUAL FIELD'S LENGTH.                           14620000
080269*----------------------------------------------------------       14630000
080270 2310-COUNT-FIELD-LENGTH.                                         14640000
080271                                                                  14650000
080272     INITIALIZE PV-VARIABLE-OUTPUT-FIELD.                         14660000
080273     MOVE PV-SAVE-VAR    TO PV-VARIABLE-OUTPUT-FIELD.             14670000
080274                                                                  14680000
080275     MOVE PV-SAVE-NUM TO PV-SUBSCRIPT.                            14690000
080276                                                                  14700000
080277     PERFORM                                                      14710000
080278        VARYING PV-BIT-IDX FROM PV-SAVE-NUM BY -1                 14720000
080279        UNTIL PV-BIT-VARIABLE(PV-BIT-IDX) NOT = SPACES            14730000
080280               OR PV-BIT-IDX = 1                                  14740000
080281        SUBTRACT 1 FROM PV-SUBSCRIPT                              14750000
080282     END-PERFORM.                                                 14760000
080283                                                                  14770000
080284     MOVE PV-SUBSCRIPT TO PV-SAVE-LENGTH.                         14780000
080285                                                                  14790000
080286*2310-EXIT.                                                       14800000
080287 EJECT.                                                           14810000
080288                                                                  14820000
080289*----------------------------------------------------------       14830000
080290* 2400-CREATE-HEADING-FIELDS.                                     14840000
080291*     CREATE THE AD EVENT AND THE PROMO HEADINGS.                 14850000
080292*----------------------------------------------------------       14860000
080293 2400-CREATE-HEADING-FIELDS.                                      14870000
080294                                                                  14880000
080295     MOVE SPACES          TO HDR-02-ADEVNT-STRING                 14890002
080296                             HDR-03-PROMO-STRING                  14900002
080297                             HDR-04-BUYER-STRING.                 14910002
080298                                                                  14920001
080299     MOVE +1 TO PV-POINTER-FIELD.                                 14930000
080300     STRING PM100-AD-EVNT-NBR-TXT(1:PV-AD-EVNT-NBR-LENGTH)        14940000
080301            " " DELIMITED BY SIZE                                 14950000
080302            PM100-AD-EVNT-NM(1:PV-AD-EVNT-NM-LENGTH)              14960000
080303            " " DELIMITED BY SIZE                                 14970000
080304       INTO HDR-02-ADEVNT-STRING                                  14980000
080305       WITH POINTER PV-POINTER-FIELD.                             14990000
080306                                                                  15000000
080307     MOVE +1 TO PV-POINTER-FIELD.                                 15010000
080308     STRING PM100-PROMO-NM(1:PV-PROMO-NM-LENGTH)                  15020000
080309            " " DELIMITED BY SIZE                                 15030000
080310            " " DELIMITED BY SIZE                                 15040000
080311            " " DELIMITED BY SIZE                                 15050000
080312            PC-CHAR-EFFECTIVE DELIMITED BY " "                    15060000
080313            ":" DELIMITED BY SIZE                                 15070000
080314            " " DELIMITED BY SIZE                                 15080000
080315            PV-HEADER-DTE-TM(1:87)                                15090000
080316            " " DELIMITED BY SIZE                                 15100000
080317       INTO HDR-03-PROMO-STRING                                   15110000
080318       WITH POINTER PV-POINTER-FIELD.                             15120000
080319                                                                  15130000
080320     MOVE PM100-BYR-NBR     TO HDR-04-BUYER-NBR.                  15140000
080321     MOVE +1 TO PV-POINTER-FIELD.                                 15150000
080322     STRING PM100-BYR-FRST-NM(1:PV-BUYER-FRST-LENGTH)             15160000
080323            " " DELIMITED BY SIZE                                 15170000
080324            PM100-BYR-LAST-NM(1:PV-BUYER-LAST-LENGTH)             15180000
080325            " " DELIMITED BY SIZE                                 15190000
080327       INTO HDR-04-BUYER-STRING                                   15200000
080328       WITH POINTER PV-POINTER-FIELD.                             15210000
080329                                                                  15220000
080330*2400-EXIT.                                                       15230000
080331 EJECT.                                                           15240000
080332                                                                  15250000
080333*----------------------------------------------------------       15260000
080334* 3000-END-OF-JOB-ROUTINE.                                        15270000
080335*     PERFORMS THE FINAL PROCESSING OF THE PROGRAM.               15280000
080336*     WRITES OUT THE CLOSING LINES OF THE REPORT, CLOSES          15290000
080337*     ANY FILES, AND DISPLAYS ANY NECESSARY STATISTICS.           15300000
080338*----------------------------------------------------------       15310000
080339 3000-END-OF-JOB-ROUTINE.                                         15320000
080340                                                                  15330000
080341*** WRITE OUT THE LAST SECTION'S TOTAL                            15340000
080342     IF PS-NOT-FIRST-TIME                                         15350008
080350        IF PS-UNADV-PROMO-TTL                                     15360008
080360           PERFORM 3130-PROCESS-UNADV-PROMO-TTL                   15370008
080361           ADD 1        TO PA-CNT-UNADV-TOT                       15380008
080362        ELSE                                                      15390008
080363           IF PS-ADV-PROMO-TTL                                    15400008
080364              PERFORM 3110-PROCESS-PAGE-TTL                       15410008
080365              PERFORM 3120-PROCESS-ADV-PROMO-TTL                  15420008
080366              ADD 1     TO PA-CNT-ADV-TOT                         15430008
PGNBR            ELSE                                                   15431038
PGNBR               IF PS-ADV-NOPGE-TTL                                 15432038
PGNBR                  PERFORM 3030-PROCESS-ADV-NOPGE-TTL               15433038
PGNBR                  ADD 1          TO PA-CNT-ADVNO-TOT               15434038
PGNBR               END-IF                                              15435038
080367           END-IF                                                 15440008
080369        END-IF                                                    15450008
080380        SET PS-TOT-PROMO-TTL TO TRUE                              15460008
080390        PERFORM 3100-SELECT-TOTAL-LINES                           15470008
080400                                                                  15480000
080500        MOVE 2                     TO PV-ADVANCE-LINES            15490008
080600                                      PV-SAVE-LINE-AMT            15500008
080610        ADD PV-ADVANCE-LINES       TO PV-LINE-CNT                 15510008
080620        PERFORM 3200-CHECK-MAX-LINE-CNT                           15520008
080630        MOVE END-OF-REPORT-LINE    TO PV-RPT-LINE                 15530008
080640        PERFORM 8200-WRITE-RPT-LINE                               15540008
080641     END-IF.                                                      15550008
080650                                                                  15560000
080660     CLOSE PROMO-ITM-SUMM-FILE                                    15570000
080670           PROMO-ITM-SUMM-REPORT.                                 15580000
080680                                                                  15590000
080690*3000-EXIT.                                                       15600000
080700 EJECT.                                                           15610000
080800                                                                  15620000
080900*----------------------------------------------------------       15630000
081000* 3100-SELECT-TOTAL-LINES.                                        15640000
081100*     SELECTS WHICH TOTAL LINES TO PROCESS IN THE REPORT.         15650000
081200*----------------------------------------------------------       15660000
081300 3100-SELECT-TOTAL-LINES.                                         15670000
081400                                                                  15680000
081500     SET PS-BLANK-LINE       TO TRUE.                             15690000
081600     MOVE 1                  TO PV-ADVANCE-LINES.                 15700000
081700     ADD  PV-ADVANCE-LINES   TO PV-LINE-CNT.                      15710000
081800     PERFORM 3300-CHECK-LNE-CNT-FOR-TTLS.                         15720000
081900     MOVE SPACES             TO PV-RPT-LINE.                      15730000
082000     PERFORM 8200-WRITE-RPT-LINE.                                 15740000
082100     SET PS-NO-BLANK-LINE    TO TRUE.                             15750000
082200                                                                  15760000
082300     IF PS-ADV-PROMO-TTL                                          15770000
082400        PERFORM 3120-PROCESS-ADV-PROMO-TTL                        15780000
082500     END-IF.                                                      15790000
082600                                                                  15800000
PGNBR      IF PS-ADV-NOPGE-TTL                                          15801038
PGNBR         PERFORM 3030-PROCESS-ADV-NOPGE-TTL                        15802038
PGNBR      END-IF.                                                      15803038
PGNBR                                                                   15804038
082700     IF PS-UNADV-PROMO-TTL                                        15810000
082800        PERFORM 3130-PROCESS-UNADV-PROMO-TTL                      15820000
082900     END-IF.                                                      15830000
083000                                                                  15840000
083500     IF PS-TOT-PROMO-TTL                                          15850000
083600        PERFORM 3140-PROCESS-PROMOTION-TTL                        15860004
083700     END-IF.                                                      15870000
083800                                                                  15880000
083900*3100-EXIT.                                                       15890000
084000 EJECT.                                                           15900000
084100                                                                  15910000
084200*----------------------------------------------------------       15920000
084300* 3110-PROCESS-PAGE-TTL.                                          15930000
084400*     PROCESS THE PAGE/SECTION TOTAL OF THE REPORT.               15940000
084500*----------------------------------------------------------       15950000
084600 3110-PROCESS-PAGE-TTL.                                           15960000
084700                                                                  15970000
084800     MOVE SPACES                TO DETAIL-PMPG-TOTALS             15980000
084900                                   DETAIL-VARIABLE.               15990000
085000                                                                  16000000
085100     MOVE PC-TOTAL-FOR-PAGE     TO DTL-PG-PAGE-TITLE.             16010000
085200     MOVE PV-AD-PG-NBR          TO DTL-PG-PAGE-NBR.               16020000
085300                                                                  16030000
085400*** THIS IS PROCESSED ONLY FOR THE ACTUAL REPORTS.                16040000
085500     IF PM100-ACTUAL                                              16050000
085700        MOVE TBL-STOT-TOT-SALE-AMT(PC-SUB-1)                      16060031
085800                                TO DTL-PMPG-ACTL-TOT-SLS-AMT      16070031
086000                                                                  16080000
086100        IF TBL-STOT-TOT-SALE-AMT(PC-SUB-2) = ZEROES               16090000
086200           CONTINUE                                               16100000
086300        ELSE                                                      16110000
086400           COMPUTE PV-VOL-PCT-CHG ROUNDED =                       16120022
086410                 ((TBL-STOT-TOT-SALE-AMT(PC-SUB-2) -              16130022
086500                   TBL-STOT-TOT-SALE-AMT(PC-SUB-1)) /             16140022
086600                   TBL-STOT-TOT-SALE-AMT(PC-SUB-2)) * -100        16150022
086700                   ON SIZE ERROR                                  16160000
086800                   MOVE 0 TO PV-VOL-PCT-CHG                       16170000
086900           END-COMPUTE                                            16180000
087000           MOVE ZEROES             TO PV-ROUND-TO-TENTHS          16190000
087100           ADD PV-VOL-PCT-CHG      TO PV-ROUND-TO-TENTHS ROUNDED  16200000
087200           IF PV-VOL-PCT-CHG < 0                                  16210000
087300              PERFORM 9000-ADD-PARENTH-TO-NEG-PCT                 16220000
087400              MOVE PV-FINAL-VOL-PCT TO DTL-PMPG-TOT-VOL-PCT-CHG   16230000
087500           ELSE                                                   16240000
087600              MOVE PV-ROUND-TO-TENTHS                             16250000
087700                                    TO DTL-VAR-VOL-PCT-CHG        16260000
087800              MOVE DETAIL-VARIABLE  TO DTL-PMPG-TOT-VOL-PCT-CHG   16270000
087900           END-IF                                                 16280000
087910           MOVE PC-PERCENT-SIGN     TO DTL-PMPG-VOL-PCT-SIGN      16290024
088500        END-IF                                                    16300000
088600                                                                  16310000
088640        COMPUTE PV-SELL-THRU-PCT ROUNDED =                        16320020
088650                (TBL-STOT-TOT-SLS-UNT-QTY(PC-SUB-1) /             16330020
088660                (TBL-STOT-TOT-EOH-INV-QTY(PC-SUB-1) +             16340020
088670                 TBL-STOT-TOT-SLS-UNT-QTY(PC-SUB-1))) * 100       16350020
088680                 ON SIZE ERROR                                    16360020
088690                 MOVE 0 TO PV-SELL-THRU-PCT                       16370020
088691        END-COMPUTE                                               16380020
089400        MOVE ZEROES                TO PV-ROUND-TO-TENTHS          16390000
089500        ADD PV-SELL-THRU-PCT       TO PV-ROUND-TO-TENTHS ROUNDED  16400000
089600        MOVE PV-ROUND-TO-TENTHS    TO DTL-PMPG-TOT-SELL-THRU-PCT  16410000
089610        MOVE PC-PERCENT-SIGN       TO DTL-PMPG-SELL-PCT-SIGN      16420024
090200                                                                  16430000
090400        MOVE TBL-STOT-TOT-MD-AMT(PC-SUB-1)                        16440031
090500                                   TO DTL-PMPG-TOT-ACTL-MD-AMT    16450031
090511                                                                  16460016
090530        MOVE TBL-STOT-TOT-SLS-UNT-QTY(PC-SUB-1)                   16470031
090540                                   TO DTL-PMPG-TOT-ACTL-UNT-QTY   16480031
090551                                                                  16490016
090570        MOVE TBL-STOT-PREP-UNT-QTY(PC-SUB-1)                      16500031
090580                                   TO DTL-PMPG-TOT-ACTL-PREP-QTY  16510031
090591                                                                  16520016
090700        MOVE TBL-STOT-TOT-SLS-COST-AMT(PC-SUB-1)                  16530031
090800                                   TO DTL-PMPG-TOT-ACTL-COST-AMT  16540031
091000                                                                  16550000
091100        IF TBL-STOT-TOT-SALE-AMT(PC-SUB-1) = ZEROES               16560000
091200           MOVE ZEROES             TO PV-MU-PCT                   16570024
091210           MOVE PV-MU-PCT          TO DTL-PMPG-TOT-ACTL-MU-PCT    16580024
091220           MOVE PC-PERCENT-SIGN    TO DTL-PMPG-ACTL-PCT-SIGN      16590024
091300        ELSE                                                      16600000
091400           COMPUTE PV-MU-PCT ROUNDED =                            16610000
091500                   ((TBL-STOT-TOT-SALE-AMT(PC-SUB-1) -            16620000
091600                    TBL-STOT-TOT-SLS-COST-AMT(PC-SUB-1))/         16630000
091700                    TBL-STOT-TOT-SALE-AMT(PC-SUB-1)) * 100        16640000
091800                    ON SIZE ERROR                                 16650000
091900                    MOVE 0 TO PV-MU-PCT                           16660000
092000           END-COMPUTE                                            16670000
092100           MOVE ZEROES             TO PV-ROUND-TO-TENTHS          16680000
092200           ADD PV-MU-PCT           TO PV-ROUND-TO-TENTHS ROUNDED  16690000
092300           MOVE PV-ROUND-TO-TENTHS TO DTL-PMPG-TOT-ACTL-MU-PCT    16700000
092310           MOVE PC-PERCENT-SIGN    TO DTL-PMPG-ACTL-PCT-SIGN      16710024
092900        END-IF                                                    16720000
093000     END-IF.                                                      16730000
093100                                                                  16740000
093200*** THIS IS PROCESSED FOR FORECAST AND ACTUAL REPORTS.            16750000
093400     MOVE TBL-STOT-TOT-SALE-AMT(PC-SUB-2)                         16760031
093500                                TO DTL-PMPG-FCST-TOT-SLS-AMT.     16770031
093610                                                                  16780016
093800     MOVE TBL-STOT-TOT-MD-AMT(PC-SUB-2)                           16790031
093900                                TO DTL-PMPG-TOT-FCST-MD-AMT.      16800031
094010                                                                  16810016
094200     MOVE TBL-STOT-TOT-SLS-UNT-QTY(PC-SUB-2)                      16820031
094300                                TO DTL-PMPG-TOT-FCST-UNT-QTY.     16830031
094410                                                                  16840016
094600     MOVE TBL-STOT-PREP-UNT-QTY(PC-SUB-2)                         16850031
094700                                TO DTL-PMPG-TOT-FCST-PREP-QTY.    16860031
094900                                                                  16870016
095100     MOVE TBL-STOT-TOT-SLS-COST-AMT(PC-SUB-2)                     16880031
095200                                TO DTL-PMPG-TOT-FCST-COST-AMT.    16890031
095400                                                                  16900000
095500     IF TBL-STOT-TOT-SALE-AMT(PC-SUB-2) = ZEROES                  16910000
095600         CONTINUE                                                 16920000
095700     ELSE                                                         16930000
095800         COMPUTE PV-MU-PCT ROUNDED =                              16940000
095900                 ((TBL-STOT-TOT-SALE-AMT(PC-SUB-2) -              16950000
096000                 TBL-STOT-TOT-SLS-COST-AMT(PC-SUB-2))/            16960000
096100                 TBL-STOT-TOT-SALE-AMT(PC-SUB-2)) * 100           16970000
096200                 ON SIZE ERROR                                    16980000
096300                 MOVE 0 TO PV-MU-PCT                              16990000
096400         END-COMPUTE                                              17000000
096500         MOVE ZEROES            TO PV-ROUND-TO-TENTHS             17010000
096600         ADD PV-MU-PCT          TO PV-ROUND-TO-TENTHS ROUNDED     17020000
096700         MOVE PV-ROUND-TO-TENTHS                                  17030000
096800                                TO DTL-PMPG-TOT-FCST-MU-PCT       17040000
096810         MOVE PC-PERCENT-SIGN   TO DTL-PMPG-FCST-PCT-SIGN         17050027
097400     END-IF.                                                      17060000
097500                                                                  17070000
097600     MOVE 1                         TO PV-ADVANCE-LINES.          17080000
097700     ADD PV-ADVANCE-LINES           TO PV-LINE-CNT.               17090000
097800     PERFORM 3300-CHECK-LNE-CNT-FOR-TTLS.                         17100000
097900     MOVE DETAIL-PMPG-TOTALS        TO PV-RPT-LINE.               17110000
098000     PERFORM 8200-WRITE-RPT-LINE.                                 17120000
098100                                                                  17130000
098200*3110-EXIT.                                                       17140000
098300 EJECT.                                                           17150000
098400                                                                  17160000
098500*----------------------------------------------------------       17170000
098600* 3120-PROCESS-ADV-PROMO-TTL.                                     17180000
098700*     PROCESS THE ADVERTISED PROMOTION TOTAL OF THE REPORT.       17190000
098800*----------------------------------------------------------       17200000
098900 3120-PROCESS-ADV-PROMO-TTL.                                      17210000
099000                                                                  17220000
099100*** CHECKS TO SEE IF THE ADVERTISED TOTALS HAS BEEN               17230000
099200*** PROCESSED YET, IF IT HASN'T IT WILL PROCESS IT.               17240000
099300*** IF IT HAS THEN IT WILL JUST WRITE OUT THE LINE                17250000
099400*** THAT WAS SAVED FROM THE LAST PROCESSING.                      17260000
099500     IF PA-CNT-ADV-TOT = 0                                        17270000
099600        MOVE SPACES                TO DETAIL-ADV-TOTALS           17280000
099700                                      DETAIL-VARIABLE             17290000
099800        MOVE PC-ADV-TOTAL          TO DTL-ADV-PM-TITLE            17300000
099900        IF PM100-ACTUAL                                           17310000
100100           MOVE TBL-PMTOT-TOT-SALE-AMT(PC-SUB-1)                  17320032
100200                                   TO DTL-ADV-TOT-ACTL-SLS-AMT    17330032
100220                                                                  17340000
100230           IF TBL-PMTOT-TOT-SALE-AMT(PC-SUB-2) = ZEROES           17350000
100240              CONTINUE                                            17360000
100250           ELSE                                                   17370000
100260              COMPUTE PV-VOL-PCT-CHG ROUNDED =                    17380022
100261                    ((TBL-PMTOT-TOT-SALE-AMT(PC-SUB-2) -          17390022
100270                      TBL-PMTOT-TOT-SALE-AMT(PC-SUB-1)) /         17400022
100280                      TBL-PMTOT-TOT-SALE-AMT(PC-SUB-2)) * -100    17410022
100290                      ON SIZE ERROR                               17420000
100300                      MOVE 0 TO PV-VOL-PCT-CHG                    17430000
100400              END-COMPUTE                                         17440000
100500              MOVE ZEROES          TO PV-ROUND-TO-TENTHS          17450000
100600              ADD PV-VOL-PCT-CHG   TO PV-ROUND-TO-TENTHS ROUNDED  17460000
100700              IF PV-VOL-PCT-CHG < 0                               17470000
100800                 PERFORM 9000-ADD-PARENTH-TO-NEG-PCT              17480000
100900                 MOVE PV-FINAL-VOL-PCT                            17490000
101000                                   TO DTL-ADV-TOT-VOL-PCT-CHG     17500000
101100              ELSE                                                17510000
101200                 MOVE PV-ROUND-TO-TENTHS                          17520000
101300                                   TO DTL-VAR-VOL-PCT-CHG         17530000
101400                 MOVE DETAIL-VARIABLE                             17540000
101500                                   TO DTL-ADV-TOT-VOL-PCT-CHG     17550000
101600              END-IF                                              17560000
101610              MOVE PC-PERCENT-SIGN TO DTL-ADV-VOL-PCT-SIGN        17570024
102300           END-IF                                                 17580000
102400                                                                  17590000
102440           COMPUTE PV-SELL-THRU-PCT ROUNDED =                     17600020
102450                   (TBL-PMTOT-TOT-SLS-UNT-QTY(PC-SUB-1) /         17610020
102460                   (TBL-PMTOT-TOT-EOH-INV-QTY(PC-SUB-1) +         17620020
102470                    TBL-PMTOT-TOT-SLS-UNT-QTY(PC-SUB-1))) * 100   17630020
102480                    ON SIZE ERROR                                 17640020
102490                    MOVE 0 TO PV-SELL-THRU-PCT                    17650020
102491           END-COMPUTE                                            17660020
102633           MOVE ZEROES             TO PV-ROUND-TO-TENTHS          17670000
102634           ADD PV-SELL-THRU-PCT    TO PV-ROUND-TO-TENTHS ROUNDED  17680000
102635           MOVE PV-ROUND-TO-TENTHS TO DTL-ADV-TOT-SELL-THRU-PCT   17690000
102636           MOVE PC-PERCENT-SIGN    TO DTL-ADV-SELL-PCT-SIGN       17700024
102637                                                                  17710000
102670           MOVE TBL-PMTOT-TOT-MD-AMT(PC-SUB-1)                    17720032
102680                                   TO DTL-ADV-TOT-ACTL-MD-AMT     17730032
102691                                                                  17740016
102800           MOVE TBL-PMTOT-TOT-SLS-UNT-QTY(PC-SUB-1)               17750032
102900                                   TO DTL-ADV-TOT-ACTL-UNT-QTY    17760032
103010                                                                  17770016
103200           MOVE TBL-PMTOT-PREP-UNT-QTY(PC-SUB-1)                  17780032
103300                                   TO DTL-ADV-TOT-ACTL-PREP-QTY   17790032
103410                                                                  17800016
103600           MOVE TBL-PMTOT-TOT-SLS-COST-AMT(PC-SUB-1)              17810032
103700                                   TO DTL-ADV-TOT-ACTL-COST-AMT   17820032
103900                                                                  17830000
104000           IF TBL-PMTOT-TOT-SALE-AMT(PC-SUB-1) = ZEROES           17840000
104110              MOVE ZEROES             TO PV-MU-PCT                17850024
104120              MOVE PV-MU-PCT          TO DTL-ADV-TOT-ACTL-MU-PCT  17860024
104130              MOVE PC-PERCENT-SIGN    TO DTL-ADV-ACTL-PCT-SIGN    17870024
104200           ELSE                                                   17880000
104300              COMPUTE PV-MU-PCT ROUNDED =                         17890000
104400                      ((TBL-PMTOT-TOT-SALE-AMT(PC-SUB-1) -        17900000
104500                       TBL-PMTOT-TOT-SLS-COST-AMT(PC-SUB-1))/     17910000
104600                       TBL-PMTOT-TOT-SALE-AMT(PC-SUB-1)) * 100    17920000
104700                       ON SIZE ERROR                              17930000
104800                       MOVE 0 TO PV-MU-PCT                        17940000
104900              END-COMPUTE                                         17950000
105000              MOVE ZEROES          TO PV-ROUND-TO-TENTHS          17960000
105100              ADD PV-MU-PCT        TO PV-ROUND-TO-TENTHS ROUNDED  17970016
105200              MOVE PV-ROUND-TO-TENTHS                             17980000
105300                                   TO DTL-ADV-TOT-ACTL-MU-PCT     17990000
105310              MOVE PC-PERCENT-SIGN TO DTL-ADV-ACTL-PCT-SIGN       18000024
105900           END-IF                                                 18010000
106000        END-IF                                                    18020000
106100                                                                  18030000
106300        MOVE TBL-PMTOT-TOT-SALE-AMT(PC-SUB-2)                     18040032
106400                                TO DTL-ADV-TOT-FCST-SLS-AMT       18050032
106510                                                                  18060016
106700        MOVE TBL-PMTOT-TOT-MD-AMT(PC-SUB-2)                       18070032
106800                                TO DTL-ADV-TOT-FCST-MD-AMT        18080032
106910                                                                  18090016
107100        MOVE TBL-PMTOT-TOT-SLS-UNT-QTY(PC-SUB-2)                  18100032
107200                                TO DTL-ADV-TOT-FCST-UNT-QTY       18110032
107310                                                                  18120016
107500        MOVE TBL-PMTOT-PREP-UNT-QTY(PC-SUB-2)                     18130032
107600                                TO DTL-ADV-TOT-FCST-PREP-QTY      18140032
107800                                                                  18150016
108000        MOVE TBL-PMTOT-TOT-SLS-COST-AMT(PC-SUB-2)                 18160032
108100                                TO DTL-ADV-TOT-FCST-COST-AMT      18170032
108300                                                                  18180000
108400        IF TBL-PMTOT-TOT-SALE-AMT(PC-SUB-2) = ZEROES              18190000
108500           CONTINUE                                               18200000
108600        ELSE                                                      18210000
108700           COMPUTE PV-MU-PCT ROUNDED =                            18220000
108800                   ((TBL-PMTOT-TOT-SALE-AMT(PC-SUB-2) -           18230000
108900                     TBL-PMTOT-TOT-SLS-COST-AMT(PC-SUB-2))/       18240000
109000                     TBL-PMTOT-TOT-SALE-AMT(PC-SUB-2)) * 100      18250000
109100                     ON SIZE ERROR                                18260000
109200                     MOVE 0 TO PV-MU-PCT                          18270000
109300           END-COMPUTE                                            18280000
109400           MOVE ZEROES             TO PV-ROUND-TO-TENTHS          18290000
109500           ADD PV-MU-PCT           TO PV-ROUND-TO-TENTHS ROUNDED  18300000
109600           MOVE PV-ROUND-TO-TENTHS                                18310000
109700                                   TO DTL-ADV-TOT-FCST-MU-PCT     18320000
109710           MOVE PC-PERCENT-SIGN    TO DTL-ADV-FCST-PCT-SIGN       18330027
110300        END-IF                                                    18340000
110400     END-IF.                                                      18350000
110500                                                                  18360000
110600     MOVE 1                     TO PV-ADVANCE-LINES.              18370000
110700     ADD PV-ADVANCE-LINES       TO PV-LINE-CNT.                   18380000
110800     PERFORM 3300-CHECK-LNE-CNT-FOR-TTLS.                         18390000
110900     MOVE DETAIL-ADV-TOTALS     TO PV-RPT-LINE.                   18400000
111000     PERFORM 8200-WRITE-RPT-LINE.                                 18410000
111100                                                                  18420000
111200*3120-EXIT.                                                       18430000
111300 EJECT.                                                           18440000
111400                                                                  18450000
111500*----------------------------------------------------------       18460000
111600* 3130-PROCESS-UNADV-PROMO-TTL.                                   18470000
111700*     PROCESS THE UNADVERTISED PROMOTION TOTAL OF THE REPORT.     18480000
111800*----------------------------------------------------------       18490000
111900 3130-PROCESS-UNADV-PROMO-TTL.                                    18500000
112000                                                                  18510000
112100*** CHECKS TO SEE IF THE UNADVERTISED TOTALS HAS BEEN             18520000
112200*** PROCESSED YET, IF IT HASN'T IT WILL PROCESS IT.               18530000
112300*** IF IT HAS THEN IT WILL JUST WRITE OUT THE LINE                18540000
112400*** THAT WAS SAVED FROM THE LAST PROCESSING.                      18550000
112500     IF PA-CNT-UNADV-TOT = 0                                      18560000
112600        MOVE SPACES               TO DETAIL-UNADV-TOTALS          18570000
112700                                     DETAIL-VARIABLE              18580000
112800        MOVE PC-UNADV-TOTAL       TO DTL-UNADV-PM-TITLE           18590000
112900        IF PM100-ACTUAL                                           18600000
113100           MOVE TBL-STOT-TOT-SALE-AMT(PC-SUB-1)                   18610032
113200                                   TO DTL-UNADV-TOT-ACTL-SLS-AMT  18620032
113400                                                                  18630000
113500           IF TBL-STOT-TOT-SALE-AMT(PC-SUB-2) = ZEROES            18640000
113600              CONTINUE                                            18650000
113700           ELSE                                                   18660000
113800              COMPUTE PV-VOL-PCT-CHG ROUNDED =                    18670022
113810                    ((TBL-STOT-TOT-SALE-AMT(PC-SUB-2) -           18680022
113900                      TBL-STOT-TOT-SALE-AMT(PC-SUB-1)) /          18690022
114000                      TBL-STOT-TOT-SALE-AMT(PC-SUB-2)) * -100     18700022
114100                      ON SIZE ERROR                               18710000
114200                      MOVE 0 TO PV-VOL-PCT-CHG                    18720000
114300              END-COMPUTE                                         18730000
114400              MOVE ZEROES          TO PV-ROUND-TO-TENTHS          18740000
114500              ADD PV-VOL-PCT-CHG   TO PV-ROUND-TO-TENTHS ROUNDED  18750000
114600              IF PV-VOL-PCT-CHG < 0                               18760000
114700                 PERFORM 9000-ADD-PARENTH-TO-NEG-PCT              18770000
114800                 MOVE PV-FINAL-VOL-PCT                            18780000
114900                                   TO DTL-UNADV-TOT-VOL-PCT-CHG   18790000
115000              ELSE                                                18800000
115100                 MOVE PV-ROUND-TO-TENTHS                          18810000
115200                                   TO DTL-VAR-VOL-PCT-CHG         18820000
115300                 MOVE DETAIL-VARIABLE                             18830000
115400                                   TO DTL-UNADV-TOT-VOL-PCT-CHG   18840000
115500              END-IF                                              18850000
115900              MOVE PC-PERCENT-SIGN TO DTL-UNADV-VOL-PCT-SIGN      18860024
116200           END-IF                                                 18870000
116300                                                                  18880000
116340           COMPUTE PV-SELL-THRU-PCT ROUNDED =                     18890020
116350                   (TBL-STOT-TOT-SLS-UNT-QTY(PC-SUB-1) /          18900020
116360                   (TBL-STOT-TOT-EOH-INV-QTY(PC-SUB-1) +          18910020
116370                    TBL-STOT-TOT-SLS-UNT-QTY(PC-SUB-1))) * 100    18920020
116380                    ON SIZE ERROR                                 18930020
116390                    MOVE 0 TO PV-SELL-THRU-PCT                    18940020
116391           END-COMPUTE                                            18950020
116470           MOVE ZEROES             TO PV-ROUND-TO-TENTHS          18960000
116480           ADD PV-SELL-THRU-PCT    TO PV-ROUND-TO-TENTHS ROUNDED  18970000
116490           MOVE PV-ROUND-TO-TENTHS TO DTL-UNADV-TOT-SELL-THRU-PCT 18980000
116491           MOVE PC-PERCENT-SIGN    TO DTL-UNADV-SELL-PCT-SIGN     18990024
116500                                                                  19000000
117200           MOVE TBL-STOT-TOT-MD-AMT(PC-SUB-1)                     19010032
117300                                   TO DTL-UNADV-TOT-ACTL-MD-AMT   19020032
117410                                                                  19030016
117600           MOVE TBL-STOT-TOT-SLS-UNT-QTY(PC-SUB-1)                19040032
117610                                   TO DTL-UNADV-TOT-ACTL-UNT-QTY  19050032
117621                                                                  19060016
117640           MOVE TBL-STOT-PREP-UNT-QTY(PC-SUB-1)                   19070032
117650                                   TO DTL-UNADV-TOT-ACTL-PREP-QTY 19080032
117661                                                                  19090016
117680           MOVE TBL-STOT-TOT-SLS-COST-AMT(PC-SUB-1)               19100032
117690                                   TO DTL-UNADV-TOT-ACTL-COST-AMT 19110032
117692                                                                  19120000
117693           IF TBL-STOT-TOT-SALE-AMT(PC-SUB-1) = ZEROES            19130000
117695              MOVE ZEROES             TO PV-MU-PCT                19140024
117696              MOVE PV-MU-PCT          TO DTL-UNADV-TOT-ACTL-MU-PCT19150024
117697              MOVE PC-PERCENT-SIGN    TO DTL-UNADV-ACTL-PCT-SIGN  19160024
117698           ELSE                                                   19170000
117699              COMPUTE PV-MU-PCT ROUNDED =                         19180000
117700                      ((TBL-STOT-TOT-SALE-AMT(PC-SUB-1) -         19190000
117701                       TBL-STOT-TOT-SLS-COST-AMT(PC-SUB-1))/      19200000
117702                       TBL-STOT-TOT-SALE-AMT(PC-SUB-1)) * 100     19210000
117703                       ON SIZE ERROR                              19220000
117704                       MOVE 0 TO PV-MU-PCT                        19230000
117705              END-COMPUTE                                         19240000
117706              MOVE ZEROES          TO PV-ROUND-TO-TENTHS          19250000
117707              ADD PV-MU-PCT        TO PV-ROUND-TO-TENTHS ROUNDED  19260000
117708              MOVE PV-ROUND-TO-TENTHS                             19270000
117709                                   TO DTL-UNADV-TOT-ACTL-MU-PCT   19280000
117710              MOVE PC-PERCENT-SIGN TO DTL-UNADV-ACTL-PCT-SIGN     19290024
117718           END-IF                                                 19300000
117719        END-IF                                                    19310000
117720                                                                  19320000
117722        MOVE TBL-STOT-TOT-SALE-AMT(PC-SUB-2)                      19330032
117723                                TO DTL-UNADV-TOT-FCST-SLS-AMT     19340032
117725                                                                  19350016
117730        MOVE TBL-STOT-TOT-MD-AMT(PC-SUB-2)                        19360032
117731                                TO DTL-UNADV-TOT-FCST-MD-AMT      19370032
117733                                                                  19380016
117735        MOVE TBL-STOT-TOT-SLS-UNT-QTY(PC-SUB-2)                   19390032
117736                                TO DTL-UNADV-TOT-FCST-UNT-QTY     19400032
117738                                                                  19410016
117740        MOVE TBL-STOT-PREP-UNT-QTY(PC-SUB-2)                      19420032
117741                                TO DTL-UNADV-TOT-FCST-PREP-QTY    19430032
117743                                                                  19440016
117745        MOVE TBL-STOT-TOT-SLS-COST-AMT(PC-SUB-2)                  19450032
117746                                TO DTL-UNADV-TOT-FCST-COST-AMT    19460032
117748                                                                  19470000
117749        IF TBL-STOT-TOT-SALE-AMT(PC-SUB-2) = ZEROES               19480000
117750           CONTINUE                                               19490024
117751        ELSE                                                      19500000
117752           COMPUTE PV-MU-PCT ROUNDED =                            19510000
117753                   ((TBL-STOT-TOT-SALE-AMT(PC-SUB-2) -            19520000
117754                     TBL-STOT-TOT-SLS-COST-AMT(PC-SUB-2))/        19530000
117755                     TBL-STOT-TOT-SALE-AMT(PC-SUB-2)) * 100       19540000
117756                     ON SIZE ERROR                                19550000
117757                     MOVE 0 TO PV-MU-PCT                          19560000
117758           END-COMPUTE                                            19570000
117759           MOVE ZEROES             TO PV-ROUND-TO-TENTHS          19580000
117760           ADD PV-MU-PCT           TO PV-ROUND-TO-TENTHS ROUNDED  19590000
117761           MOVE PV-ROUND-TO-TENTHS TO DTL-UNADV-TOT-FCST-MU-PCT   19600016
117762           MOVE PC-PERCENT-SIGN    TO DTL-UNADV-FCST-PCT-SIGN     19610027
117768        END-IF                                                    19620000
117769     END-IF.                                                      19630000
117770                                                                  19640000
117771     MOVE 1                      TO PV-ADVANCE-LINES.             19650000
117772     ADD PV-ADVANCE-LINES        TO PV-LINE-CNT.                  19660000
117773     PERFORM 3300-CHECK-LNE-CNT-FOR-TTLS.                         19670000
117774     MOVE DETAIL-UNADV-TOTALS    TO PV-RPT-LINE.                  19680000
117775     PERFORM 8200-WRITE-RPT-LINE.                                 19690000
117776                                                                  19700000
117777*3130-EXIT.                                                       19710000
117778 EJECT.                                                           19720000
117779                                                                  19730000
PGNBR *----------------------------------------------------------       19731038
PGNBR * 3030-PROCESS-ADV-NOPGE-TTL.                                     19732038
PGNBR *     PROCESS THE ADVERTISED PROMO WITH NO PAGE TOTAL.            19733038
PGNBR *----------------------------------------------------------       19734038
PGNBR  3030-PROCESS-ADV-NOPGE-TTL.                                      19735038
PGNBR                                                                   19736038
PGNBR *** CHECKS TO SEE IF THE ADVERTISED WITH NO PAGE TOTALS HAS BEEN  19737038
PGNBR *** PROCESSED YET, IF IT HASN'T IT WILL PROCESS IT.               19738038
PGNBR *** IF IT HAS THEN IT WILL JUST WRITE OUT THE LINE                19739038
PGNBR *** THAT WAS SAVED FROM THE LAST PROCESSING.                      19739138
PGNBR      IF PA-CNT-ADVNO-TOT = 0                                      19739238
PGNBR         MOVE SPACES               TO DETAIL-ADVNO-TOTALS          19739338
PGNBR                                      DETAIL-VARIABLE              19739438
PGNBR         MOVE PC-ADVNO-TOTAL       TO DTL-ADVNO-PM-TITLE           19739538
PGNBR         IF PM100-ACTUAL                                           19739638
PGNBR            MOVE TBL-STOT-TOT-SALE-AMT(PC-SUB-1)                   19739738
PGNBR                                    TO DTL-ADVNO-TOT-ACTL-SLS-AMT  19739838
PGNBR                                                                   19739938
PGNBR            IF TBL-STOT-TOT-SALE-AMT(PC-SUB-2) = ZEROES            19740038
PGNBR               CONTINUE                                            19740138
PGNBR            ELSE                                                   19740238
PGNBR               COMPUTE PV-VOL-PCT-CHG ROUNDED =                    19740338
PGNBR                     ((TBL-STOT-TOT-SALE-AMT(PC-SUB-2) -           19740438
PGNBR                       TBL-STOT-TOT-SALE-AMT(PC-SUB-1)) /          19740538
PGNBR                       TBL-STOT-TOT-SALE-AMT(PC-SUB-2)) * -100     19740638
PGNBR                       ON SIZE ERROR                               19740738
PGNBR                       MOVE 0 TO PV-VOL-PCT-CHG                    19740838
PGNBR               END-COMPUTE                                         19740938
PGNBR               MOVE ZEROES          TO PV-ROUND-TO-TENTHS          19741038
PGNBR               ADD PV-VOL-PCT-CHG   TO PV-ROUND-TO-TENTHS ROUNDED  19741138
PGNBR               IF PV-VOL-PCT-CHG < 0                               19741238
PGNBR                  PERFORM 9000-ADD-PARENTH-TO-NEG-PCT              19741338
PGNBR                  MOVE PV-FINAL-VOL-PCT                            19741438
PGNBR                                    TO DTL-ADVNO-TOT-VOL-PCT-CHG   19741538
PGNBR               ELSE                                                19741638
PGNBR                  MOVE PV-ROUND-TO-TENTHS                          19741738
PGNBR                                    TO DTL-VAR-VOL-PCT-CHG         19741838
PGNBR                  MOVE DETAIL-VARIABLE                             19741938
PGNBR                                    TO DTL-ADVNO-TOT-VOL-PCT-CHG   19742038
PGNBR               END-IF                                              19742138
PGNBR               MOVE PC-PERCENT-SIGN TO DTL-ADVNO-VOL-PCT-SIGN      19742238
PGNBR            END-IF                                                 19742338
PGNBR                                                                   19742438
PGNBR            COMPUTE PV-SELL-THRU-PCT ROUNDED =                     19742538
PGNBR                    (TBL-STOT-TOT-SLS-UNT-QTY(PC-SUB-1) /          19742638
PGNBR                    (TBL-STOT-TOT-EOH-INV-QTY(PC-SUB-1) +          19742738
PGNBR                     TBL-STOT-TOT-SLS-UNT-QTY(PC-SUB-1))) * 100    19742838
PGNBR                     ON SIZE ERROR                                 19742938
PGNBR                     MOVE 0 TO PV-SELL-THRU-PCT                    19743038
PGNBR            END-COMPUTE                                            19743138
PGNBR            MOVE ZEROES             TO PV-ROUND-TO-TENTHS          19743238
PGNBR            ADD PV-SELL-THRU-PCT    TO PV-ROUND-TO-TENTHS ROUNDED  19743338
PGNBR            MOVE PV-ROUND-TO-TENTHS TO DTL-ADVNO-TOT-SELL-THRU-PCT 19743438
PGNBR            MOVE PC-PERCENT-SIGN    TO DTL-ADVNO-SELL-PCT-SIGN     19743538
PGNBR                                                                   19743638
PGNBR            MOVE TBL-STOT-TOT-MD-AMT(PC-SUB-1)                     19743738
PGNBR                                    TO DTL-ADVNO-TOT-ACTL-MD-AMT   19743838
PGNBR                                                                   19743938
PGNBR            MOVE TBL-STOT-TOT-SLS-UNT-QTY(PC-SUB-1)                19744038
PGNBR                                    TO DTL-ADVNO-TOT-ACTL-UNT-QTY  19744138
PGNBR                                                                   19744238
PGNBR            MOVE TBL-STOT-PREP-UNT-QTY(PC-SUB-1)                   19744338
PGNBR                                    TO DTL-ADVNO-TOT-ACTL-PREP-QTY 19744438
PGNBR                                                                   19744538
PGNBR            MOVE TBL-STOT-TOT-SLS-COST-AMT(PC-SUB-1)               19744638
PGNBR                                    TO DTL-ADVNO-TOT-ACTL-COST-AMT 19744738
PGNBR                                                                   19744838
PGNBR            IF TBL-STOT-TOT-SALE-AMT(PC-SUB-1) = ZEROES            19744938
PGNBR               MOVE ZEROES             TO PV-MU-PCT                19745038
PGNBR               MOVE PV-MU-PCT          TO DTL-ADVNO-TOT-ACTL-MU-PCT19745138
PGNBR               MOVE PC-PERCENT-SIGN    TO DTL-ADVNO-ACTL-PCT-SIGN  19745238
PGNBR            ELSE                                                   19745338
PGNBR               COMPUTE PV-MU-PCT ROUNDED =                         19745438
PGNBR                       ((TBL-STOT-TOT-SALE-AMT(PC-SUB-1) -         19745538
PGNBR                        TBL-STOT-TOT-SLS-COST-AMT(PC-SUB-1))/      19745638
PGNBR                        TBL-STOT-TOT-SALE-AMT(PC-SUB-1)) * 100     19745738
PGNBR                        ON SIZE ERROR                              19745838
PGNBR                        MOVE 0 TO PV-MU-PCT                        19745938
PGNBR               END-COMPUTE                                         19746038
PGNBR               MOVE ZEROES          TO PV-ROUND-TO-TENTHS          19746138
PGNBR               ADD PV-MU-PCT        TO PV-ROUND-TO-TENTHS ROUNDED  19746238
PGNBR               MOVE PV-ROUND-TO-TENTHS                             19746338
PGNBR                                    TO DTL-ADVNO-TOT-ACTL-MU-PCT   19746438
PGNBR               MOVE PC-PERCENT-SIGN TO DTL-ADVNO-ACTL-PCT-SIGN     19746538
PGNBR            END-IF                                                 19746638
PGNBR         END-IF                                                    19746738
PGNBR                                                                   19746838
PGNBR         MOVE TBL-STOT-TOT-SALE-AMT(PC-SUB-2)                      19746938
PGNBR                                 TO DTL-ADVNO-TOT-FCST-SLS-AMT     19747038
PGNBR                                                                   19747138
PGNBR         MOVE TBL-STOT-TOT-MD-AMT(PC-SUB-2)                        19747238
PGNBR                                 TO DTL-ADVNO-TOT-FCST-MD-AMT      19747338
PGNBR                                                                   19747438
PGNBR         MOVE TBL-STOT-TOT-SLS-UNT-QTY(PC-SUB-2)                   19747538
PGNBR                                 TO DTL-ADVNO-TOT-FCST-UNT-QTY     19747638
PGNBR                                                                   19747738
PGNBR         MOVE TBL-STOT-PREP-UNT-QTY(PC-SUB-2)                      19747838
PGNBR                                 TO DTL-ADVNO-TOT-FCST-PREP-QTY    19747938
PGNBR                                                                   19748038
PGNBR         MOVE TBL-STOT-TOT-SLS-COST-AMT(PC-SUB-2)                  19748138
PGNBR                                 TO DTL-ADVNO-TOT-FCST-COST-AMT    19748238
PGNBR                                                                   19748338
PGNBR         IF TBL-STOT-TOT-SALE-AMT(PC-SUB-2) = ZEROES               19748438
PGNBR            CONTINUE                                               19748538
PGNBR         ELSE                                                      19748638
PGNBR            COMPUTE PV-MU-PCT ROUNDED =                            19748738
PGNBR                    ((TBL-STOT-TOT-SALE-AMT(PC-SUB-2) -            19748838
PGNBR                      TBL-STOT-TOT-SLS-COST-AMT(PC-SUB-2))/        19748938
PGNBR                      TBL-STOT-TOT-SALE-AMT(PC-SUB-2)) * 100       19749038
PGNBR                      ON SIZE ERROR                                19749138
PGNBR                      MOVE 0 TO PV-MU-PCT                          19749238
PGNBR            END-COMPUTE                                            19749338
PGNBR            MOVE ZEROES             TO PV-ROUND-TO-TENTHS          19749438
PGNBR            ADD PV-MU-PCT           TO PV-ROUND-TO-TENTHS ROUNDED  19749538
PGNBR            MOVE PV-ROUND-TO-TENTHS TO DTL-ADVNO-TOT-FCST-MU-PCT   19749638
PGNBR            MOVE PC-PERCENT-SIGN    TO DTL-ADVNO-FCST-PCT-SIGN     19749738
PGNBR         END-IF                                                    19749838
PGNBR      END-IF.                                                      19749938
PGNBR                                                                   19750038
PGNBR      MOVE 1                      TO PV-ADVANCE-LINES.             19750138
PGNBR      ADD PV-ADVANCE-LINES        TO PV-LINE-CNT.                  19750238
PGNBR      PERFORM 3300-CHECK-LNE-CNT-FOR-TTLS.                         19750338
PGNBR      MOVE DETAIL-ADVNO-TOTALS    TO PV-RPT-LINE.                  19750438
PGNBR      PERFORM 8200-WRITE-RPT-LINE.                                 19750538
PGNBR                                                                   19750638
PGNBR *3030-EXIT.                                                       19750738
PGNBR  EJECT.                                                           19750838
PGNBR                                                                   19750938
117966*----------------------------------------------------------       19751000
117967* 3140-PROCESS-PROMOTION-TTL.                                     19752004
117968*     PROCESS THE COMPLETE PROMOTION TOTAL.                       19760000
117969*----------------------------------------------------------       19770000
117970 3140-PROCESS-PROMOTION-TTL.                                      19780004
117980                                                                  19790000
117990     MOVE SPACES                TO DETAIL-PMPG-TOTALS             19800000
118000                                   DETAIL-VARIABLE.               19810000
118010                                                                  19820000
118020     MOVE PC-PROMOTION-TOTAL    TO DTL-PM-PROMO-TITLE.            19830000
118021                                                                  19840000
118022*** THIS IS PROCESSED ONLY FOR THE ACTUAL REPORTS.                19850000
118023     IF PM100-ACTUAL                                              19860000
118025        MOVE TBL-PMTOT-TOT-SALE-AMT(PC-SUB-1)                     19870032
118026                                TO DTL-PMPG-ACTL-TOT-SLS-AMT      19880032
118028                                                                  19890000
118029        IF TBL-PMTOT-TOT-SALE-AMT(PC-SUB-2) = ZEROES              19900000
118030           CONTINUE                                               19910000
118031        ELSE                                                      19920000
118032           COMPUTE PV-VOL-PCT-CHG ROUNDED =                       19930022
118033                 ((TBL-PMTOT-TOT-SALE-AMT(PC-SUB-2) -             19940022
118034                   TBL-PMTOT-TOT-SALE-AMT(PC-SUB-1)) /            19950022
118035                   TBL-PMTOT-TOT-SALE-AMT(PC-SUB-2)) * -100       19960022
118036                   ON SIZE ERROR                                  19970000
118037                   MOVE 0 TO PV-VOL-PCT-CHG                       19980000
118038           END-COMPUTE                                            19990000
118039           MOVE ZEROES             TO PV-ROUND-TO-TENTHS          20000000
118040           ADD PV-VOL-PCT-CHG      TO PV-ROUND-TO-TENTHS ROUNDED  20010000
118041           IF PV-VOL-PCT-CHG < 0                                  20020000
118042              PERFORM 9000-ADD-PARENTH-TO-NEG-PCT                 20030000
118043              MOVE PV-FINAL-VOL-PCT TO DTL-PMPG-TOT-VOL-PCT-CHG   20040000
118044           ELSE                                                   20050000
118045              MOVE PV-ROUND-TO-TENTHS                             20060000
118046                                    TO DTL-VAR-VOL-PCT-CHG        20070000
118047              MOVE DETAIL-VARIABLE  TO DTL-PMPG-TOT-VOL-PCT-CHG   20080000
118048           END-IF                                                 20090000
118060           MOVE PC-PERCENT-SIGN     TO DTL-PMPG-VOL-PCT-SIGN      20100024
118062        END-IF                                                    20110000
118063                                                                  20120000
118067        COMPUTE PV-SELL-THRU-PCT ROUNDED =                        20130020
118068                (TBL-PMTOT-TOT-SLS-UNT-QTY(PC-SUB-1) /            20140020
118069                (TBL-PMTOT-TOT-EOH-INV-QTY(PC-SUB-1) +            20150020
118070                 TBL-PMTOT-TOT-SLS-UNT-QTY(PC-SUB-1))) * 100      20160020
118071                 ON SIZE ERROR                                    20170020
118072                 MOVE 0 TO PV-SELL-THRU-PCT                       20180020
118073        END-COMPUTE                                               20190020
118082        MOVE ZEROES                TO PV-ROUND-TO-TENTHS          20200000
118083        ADD PV-SELL-THRU-PCT       TO PV-ROUND-TO-TENTHS ROUNDED  20210000
118084        MOVE PV-ROUND-TO-TENTHS    TO DTL-PMPG-TOT-SELL-THRU-PCT  20220000
118085        MOVE PC-PERCENT-SIGN       TO DTL-PMPG-SELL-PCT-SIGN      20230024
118086                                                                  20240000
118093        MOVE TBL-PMTOT-TOT-MD-AMT(PC-SUB-1)                       20250032
118094                                   TO DTL-PMPG-TOT-ACTL-MD-AMT    20260032
118096                                                                  20270016
118098        MOVE TBL-PMTOT-TOT-SLS-UNT-QTY(PC-SUB-1)                  20280032
118099                                   TO DTL-PMPG-TOT-ACTL-UNT-QTY   20290032
118101                                                                  20300016
118103        MOVE TBL-PMTOT-PREP-UNT-QTY(PC-SUB-1)                     20310032
118104                                   TO DTL-PMPG-TOT-ACTL-PREP-QTY  20320032
118106                                                                  20330016
118108        MOVE TBL-PMTOT-TOT-SLS-COST-AMT(PC-SUB-1)                 20340032
118109                                   TO DTL-PMPG-TOT-ACTL-COST-AMT  20350032
118111                                                                  20360000
118112        IF TBL-PMTOT-TOT-SALE-AMT(PC-SUB-1) = ZEROES              20370000
118114           MOVE ZEROES             TO PV-MU-PCT                   20380024
118115           MOVE PV-MU-PCT          TO DTL-PMPG-TOT-ACTL-MU-PCT    20390024
118116           MOVE PC-PERCENT-SIGN    TO DTL-PMPG-ACTL-PCT-SIGN      20400024
118117        ELSE                                                      20410000
118118           COMPUTE PV-MU-PCT ROUNDED =                            20420000
118119                   ((TBL-PMTOT-TOT-SALE-AMT(PC-SUB-1) -           20430000
118120                    TBL-PMTOT-TOT-SLS-COST-AMT(PC-SUB-1))/        20440000
118121                    TBL-PMTOT-TOT-SALE-AMT(PC-SUB-1)) * 100       20450000
118122                    ON SIZE ERROR                                 20460000
118123                    MOVE 0 TO PV-MU-PCT                           20470000
118124           END-COMPUTE                                            20480000
118125           MOVE ZEROES             TO PV-ROUND-TO-TENTHS          20490000
118126           ADD PV-MU-PCT           TO PV-ROUND-TO-TENTHS ROUNDED  20500000
118127           MOVE PV-ROUND-TO-TENTHS TO DTL-PMPG-TOT-ACTL-MU-PCT    20510000
118128           MOVE PC-PERCENT-SIGN    TO DTL-PMPG-ACTL-PCT-SIGN      20520024
118134        END-IF                                                    20530000
118135     END-IF.                                                      20540000
118136                                                                  20550000
118137*** THIS IS PROCESSED FOR FORECAST AND ACTUAL REPORTS.            20560000
118139     MOVE TBL-PMTOT-TOT-SALE-AMT(PC-SUB-2)                        20570032
118140                                TO DTL-PMPG-FCST-TOT-SLS-AMT.     20580032
118142                                                                  20590016
118144     MOVE TBL-PMTOT-TOT-MD-AMT(PC-SUB-2)                          20600032
118145                                TO DTL-PMPG-TOT-FCST-MD-AMT.      20610032
118147                                                                  20620016
118149     MOVE TBL-PMTOT-TOT-SLS-UNT-QTY(PC-SUB-2)                     20630032
118150                                TO DTL-PMPG-TOT-FCST-UNT-QTY.     20640032
118152                                                                  20650016
118154     MOVE TBL-PMTOT-PREP-UNT-QTY(PC-SUB-2)                        20660032
118155                                TO DTL-PMPG-TOT-FCST-PREP-QTY.    20670033
118157                                                                  20680016
118159     MOVE TBL-PMTOT-TOT-SLS-COST-AMT(PC-SUB-2)                    20690032
118160                                TO DTL-PMPG-TOT-FCST-COST-AMT.    20700032
118162                                                                  20710000
118163     IF TBL-PMTOT-TOT-SALE-AMT(PC-SUB-2) = ZEROES                 20720000
118164         CONTINUE                                                 20730000
118165     ELSE                                                         20740000
118166         COMPUTE PV-MU-PCT ROUNDED =                              20750000
118167                 ((TBL-PMTOT-TOT-SALE-AMT(PC-SUB-2) -             20760000
118168                 TBL-PMTOT-TOT-SLS-COST-AMT(PC-SUB-2))/           20770000
118169                 TBL-PMTOT-TOT-SALE-AMT(PC-SUB-2)) * 100          20780000
118170                 ON SIZE ERROR                                    20790000
118171                 MOVE 0 TO PV-MU-PCT                              20800000
118172         END-COMPUTE                                              20810000
118173         MOVE ZEROES            TO PV-ROUND-TO-TENTHS             20820000
118174         ADD PV-MU-PCT          TO PV-ROUND-TO-TENTHS ROUNDED     20830016
118175         MOVE PV-ROUND-TO-TENTHS                                  20840000
118176                                TO DTL-PMPG-TOT-FCST-MU-PCT       20850000
118177         MOVE PC-PERCENT-SIGN   TO DTL-PMPG-FCST-PCT-SIGN         20860027
118183     END-IF.                                                      20870000
118184                                                                  20880000
118185     MOVE 1                        TO PV-ADVANCE-LINES.           20890000
118186     ADD PV-ADVANCE-LINES          TO PV-LINE-CNT.                20900000
118187     PERFORM 3300-CHECK-LNE-CNT-FOR-TTLS.                         20910000
118188     MOVE DETAIL-PMPG-TOTALS       TO PV-RPT-LINE.                20920000
118189     PERFORM 8200-WRITE-RPT-LINE.                                 20930000
118190                                                                  20940000
118191*3140-EXIT.                                                       20950004
118192 EJECT.                                                           20960000
118193                                                                  20970000
118194*----------------------------------------------------------       20980000
118195* 3200-CHECK-MAX-LINE-CNT.                                        20990000
118196*     CHECKS TO SEE IF IT HAS REACHED THE MAXIMUM AMOUNT          21000000
118197*     OF LINES FOR THE PAGE. WRITES OUT ALL HEADERS.              21010000
118198*----------------------------------------------------------       21020000
118199 3200-CHECK-MAX-LINE-CNT.                                         21030000
118200                                                                  21040000
118201     IF PV-LINE-CNT > PC-MAX-LINE-CNT                             21050000
118202         PERFORM 3500-PROCESS-PAGE-HEADER                         21060000
118203         PERFORM 3400-PROCESS-DETAIL-HEADER                       21070000
118204         MOVE 1                  TO PV-ADVANCE-LINES              21080000
118205         ADD PV-ADVANCE-LINES    TO PV-LINE-CNT                   21090000
118206     END-IF.                                                      21100000
118207                                                                  21110000
118208*3200-EXIT.                                                       21120000
118209 EJECT.                                                           21130000
118210                                                                  21140000
118211*----------------------------------------------------------       21150000
118212* 3300-CHECK-LNE-CNT-FOR-TTLS.                                    21160000
118220*     CHECKS TO SEE IF IT HAS REACHED THE MAXIMUM AMOUNT          21170000
118300*     OF LINES FOR THE PAGE. WRITES OUT ALL HEADERS.              21180000
118301*----------------------------------------------------------       21190000
118302 3300-CHECK-LNE-CNT-FOR-TTLS.                                     21200000
118303                                                                  21210000
118304     IF PV-LINE-CNT > PC-MAX-LINE-CNT                             21220000
118305         PERFORM 3500-PROCESS-PAGE-HEADER                         21230000
118306         IF PS-BLANK-LINE                                         21240000
118307            MOVE 1                  TO PV-ADVANCE-LINES           21250000
118308            ADD PV-ADVANCE-LINES    TO PV-LINE-CNT                21260000
118309         ELSE                                                     21270000
118310            MOVE 2                  TO PV-ADVANCE-LINES           21280000
118311            ADD PV-ADVANCE-LINES    TO PV-LINE-CNT                21290000
118312     END-IF.                                                      21300000
118313                                                                  21310000
118314*3300-EXIT.                                                       21320000
118315 EJECT.                                                           21330000
118316                                                                  21340000
118317*----------------------------------------------------------       21350000
118318* 3400-PROCESS-DETAIL-HEADER.                                     21360000
118319*     PROCESS REPORT DETAIL HEADER LINES.                         21370000
118320*----------------------------------------------------------       21380000
118321 3400-PROCESS-DETAIL-HEADER.                                      21390000
118322                                                                  21400000
118323     MOVE SPACES                 TO DTL-HDR-01-PAGE.              21410000
118324     EVALUATE TRUE                                                21420000
118325         WHEN PM100-AD-PG-NBR NOT = 0 AND                         21430000
118326              PM100-PROMO-ITM-ADV-IND = 'Y'                       21440000
118327              MOVE PC-PROMO-ITEMS-ON-PAGE                         21450000
118328                                 TO DTL-HDR-01-PM-ITM-PAGE-TITLE  21460000
118329              MOVE PM100-AD-PG-NBR                                21470000
118330                                 TO DTL-HDR-01-PM-ITM-PAGE-NBR    21480000
118331              SET PS-PAGE-SECTION-TTL TO TRUE                     21490000
118332              SET PS-ADV-PROMO-TTL    TO TRUE                     21500000
PGNBR          WHEN PM100-AD-PG-NBR = 0 AND                             21501038
PGNBR               PM100-PROMO-ITM-ADV-IND = 'Y'                       21502038
PGNBR               MOVE PC-PROMO-ITEMS-NO-PAGE                         21503038
PGNBR                                  TO DTL-HDR-01-HEADING-TITLE      21504038
PGNBR               SET PS-ADV-NOPGE-TTL    TO TRUE                     21505038
118333         WHEN PM100-AD-PG-NBR = 0 AND                             21510000
118334              PM100-PROMO-ITM-ADV-IND = 'N'                       21520000
118335              MOVE PC-PROMO-ITEMS-UNADV                           21530000
118336                                 TO DTL-HDR-01-HEADING-TITLE      21540000
118337              SET PS-UNADV-PROMO-TTL  TO TRUE                     21550000
118342     END-EVALUATE.                                                21560000
118343                                                                  21570000
118344     MOVE 2                      TO PV-ADVANCE-LINES              21580000
118345                                    PV-SAVE-LINE-AMT.             21590000
118346     ADD PV-ADVANCE-LINES        TO PV-LINE-CNT.                  21600000
118347     IF PV-LINE-CNT > PC-MAX-LINE-CNT                             21610000
118348         PERFORM 3500-PROCESS-PAGE-HEADER                         21620000
118349         MOVE PV-SAVE-LINE-AMT   TO PV-ADVANCE-LINES              21630000
118350         ADD PV-ADVANCE-LINES    TO PV-LINE-CNT                   21640000
118351     END-IF.                                                      21650000
118352     MOVE DETAIL-HEADER-01       TO PV-RPT-LINE.                  21660000
118353     PERFORM 8200-WRITE-RPT-LINE.                                 21670000
118354                                                                  21680000
118355*3400-EXIT.                                                       21690000
118356 EJECT.                                                           21700000
118357                                                                  21710000
118358*----------------------------------------------------------       21720000
118359* 3500-PROCESS-PAGE-HEADER.                                       21730000
118360*     PROCESS REPORT PAGE HEADERS.                                21740000
118361*----------------------------------------------------------       21750000
118362 3500-PROCESS-PAGE-HEADER.                                        21760000
118363                                                                  21770000
118364     MOVE ZEROES                 TO PV-LINE-CNT.                  21780000
118365     ADD 1                       TO PV-PAGE-CNT.                  21790000
118366     MOVE PV-PAGE-CNT            TO DP250O-PAGE-NUMBER.           21800000
118367     MOVE 1                      TO DP250O-REPORT-NUMBER.         21810000
118368                                                                  21820000
118369     MOVE DP250O-STANDRD-HEADER-250-COLS                          21830000
118370                                 TO PV-RPT-LINE.                  21840000
118371     PERFORM 8100-WRITE-SLS-RPT-NEW-PAGE.                         21850000
118372                                                                  21860000
118373     MOVE HEADER-01              TO PV-RPT-LINE.                  21870000
118374     MOVE 2                      TO PV-ADVANCE-LINES.             21880000
118375     ADD PV-ADVANCE-LINES        TO PV-LINE-CNT.                  21890000
118376     PERFORM 8200-WRITE-RPT-LINE.                                 21900000
118377                                                                  21910000
118378     MOVE HEADER-02              TO PV-RPT-LINE.                  21920000
118379     MOVE 1                      TO PV-ADVANCE-LINES.             21930000
118380     ADD PV-ADVANCE-LINES        TO PV-LINE-CNT.                  21940000
118381     PERFORM 8200-WRITE-RPT-LINE.                                 21950000
118382                                                                  21960000
118383     MOVE HEADER-03              TO PV-RPT-LINE.                  21970000
118384     MOVE 1                      TO PV-ADVANCE-LINES.             21980000
118385     ADD PV-ADVANCE-LINES        TO PV-LINE-CNT.                  21990000
118386     PERFORM 8200-WRITE-RPT-LINE.                                 22000000
118387                                                                  22010000
118393     MOVE HEADER-04              TO PV-RPT-LINE.                  22020000
118394     MOVE 1                      TO PV-ADVANCE-LINES.             22030000
118395     ADD PV-ADVANCE-LINES        TO PV-LINE-CNT.                  22040000
118396     PERFORM 8200-WRITE-RPT-LINE                                  22050000
118397                                                                  22060000
118403     MOVE HEADER-05              TO PV-RPT-LINE.                  22070000
118404     MOVE 2                      TO PV-ADVANCE-LINES.             22080000
118405     ADD PV-ADVANCE-LINES        TO PV-LINE-CNT.                  22090000
118406     PERFORM 8200-WRITE-RPT-LINE                                  22100000
118407                                                                  22110000
118408     MOVE HEADER-06              TO PV-RPT-LINE.                  22120000
118409     MOVE 1                      TO PV-ADVANCE-LINES.             22130000
118410     ADD PV-ADVANCE-LINES        TO PV-LINE-CNT.                  22140000
118411     PERFORM 8200-WRITE-RPT-LINE.                                 22150000
118412                                                                  22160000
118413*3500-EXIT.                                                       22170000
118414 EJECT.                                                           22180000
118415                                                                  22190000
118416*----------------------------------------------------------       22200000
118417* 8000-READ-SALES-RESULTS.                                        22210000
118418*     READ SALES RESULTS INPUT RECORDS.                           22220000
118419*----------------------------------------------------------       22230000
118420 8000-READ-SALES-RESULTS.                                         22240000
118421                                                                  22250000
118422     READ PROMO-ITM-SUMM-FILE INTO PM100-PROMO-ITM-SUMM           22260000
118423          AT END                                                  22270000
PGNBR              SET PS-EOF-SALES-RESULTS TO TRUE.                    22280038
PGNBR      EVALUATE TRUE                                                22281038
PGNBR         WHEN PM100-PROMO-ITM-ADV-IND  = 'Y' AND                   22282038
PGNBR              PM100-AD-PG-NBR = 0                                  22283038
PGNBR              SET PS-ADVNOPG-FLAG TO TRUE                          22284038
PGNBR         WHEN PM100-PROMO-ITM-ADV-IND  = 'Y' AND                   22285038
PGNBR              PM100-AD-PG-NBR > 0                                  22286038
PGNBR              SET PS-ADVPG-FLAG TO TRUE                            22287038
PGNBR         WHEN PM100-PROMO-ITM-ADV-IND  = 'N'                       22288038
PGNBR              SET PS-NOADV-FLAG TO TRUE                            22289038
PGNBR         WHEN OTHER                                                22289138
PGNBR              CONTINUE                                             22289238
PGNBR      END-EVALUATE                                                 22289338
PGNBR                                                                   22289438
PGNBR      IF PS-HOLD-REC-TYPE-FLAG NOT = 0                             22289538
PGNBR         IF PS-REC-TYPE-FLAG NOT = PS-HOLD-REC-TYPE-FLAG           22289638
PGNBR            EVALUATE PS-HOLD-REC-TYPE-FLAG                         22289738
PGNBR               WHEN  '1'                                           22289838
PGNBR                     SET PS-EOF-ADVNOPG TO TRUE                    22289938
PGNBR               WHEN  '2'                                           22290038
PGNBR                     SET PS-EOF-ADVPG TO TRUE                      22290138
PGNBR               WHEN  '3'                                           22290238
PGNBR                     SET PS-EOF-NOADV TO TRUE                      22290338
PGNBR               WHEN  OTHER                                         22290438
PGNBR                     CONTINUE                                      22290538
PGNBR            END-EVALUATE                                           22290638
PGNBR         END-IF                                                    22290738
PGNBR      END-IF                                                       22290838
PGNBR                                                                   22290938
PGNBR      MOVE PS-REC-TYPE-FLAG TO  PS-HOLD-REC-TYPE-FLAG.             22291038
PGNBR *    END-READ.                                                    22292038
118426                                                                  22300000
118430*8000-EXIT.                                                       22310000
118431 EJECT.                                                           22320000
118432                                                                  22330000
118433*----------------------------------------------------------       22340000
118434* 8100-WRITE-SLS-RPT-NEW-PAGE.                                    22350000
118435*     WRITES NEW PAGE.                                            22360000
118436*----------------------------------------------------------       22370000
118437 8100-WRITE-SLS-RPT-NEW-PAGE.                                     22380000
118438                                                                  22390000
118439     WRITE PROMO-ITM-SUMM-RPT-LINE                                22400000
118440           FROM PV-RPT-LINE                                       22410000
118441           AFTER ADVANCING PAGE.                                  22420000
118442                                                                  22430000
118443     ADD 2            TO PV-LINE-CNT.                             22440000
118444                                                                  22450000
118445*8100-EXIT.                                                       22460000
118446 EJECT.                                                           22470000
118447                                                                  22480000
118448*----------------------------------------------------------       22490000
118449* 8200-WRITE-RPT-LINE.                                            22500000
118450*     WRITES OUT A LINE ON THE REPORT.                            22510000
118451*----------------------------------------------------------       22520000
118452 8200-WRITE-RPT-LINE.                                             22530000
118453                                                                  22540000
118454     WRITE PROMO-ITM-SUMM-RPT-LINE                                22550000
118455           FROM PV-RPT-LINE                                       22560000
118456           AFTER ADVANCING PV-ADVANCE-LINES.                      22570000
118457                                                                  22580000
118458*8200-EXIT.                                                       22590000
118459 EJECT.                                                           22600000
118460                                                                  22610000
118473*----------------------------------------------------------       22620000
118474* 9000-ADD-PARENTH-TO-NEG-PCT.                                    22630000
118475*     PUTS PARENTHESES AROUND A NEGATIVE PERCENT FOR THE          22640000
118476*     VOLUME PERCENT CHANGE FIELD.                                22650018
118477*----------------------------------------------------------       22660000
118478 9000-ADD-PARENTH-TO-NEG-PCT.                                     22670000
118479                                                                  22680000
118480     INITIALIZE PV-ROUND-VOL-PCT                                  22690000
118481                PV-TRUNCAT-VOL-PCT                                22700000
118482                PV-NUM-VOL-PCT                                    22710000
118483                PV-FINAL-VOL-PCT                                  22720000
118484                PV-SEP-VOL-PCT                                    22730000
118485                PA-CNT-SPACES.                                    22740000
118486                                                                  22750000
118487     MOVE PV-ROUND-TO-TENTHS      TO PV-ROUND-VOL-PCT.            22760000
118488     MOVE PV-ROUND-VOL-PCT        TO PV-TRUNCAT-VOL-PCT.          22770000
118489     MOVE PV-TRUNCAT-VOL-PCT-X    TO PV-NUM-VOL-PCT.              22780000
118490     MOVE PV-TRUNCAT-VOL-PCT-X    TO PV-SEP-VOL-PCT.              22790000
118491     INSPECT PV-CHAR-VOL-PCT-1 REPLACING                          22800000
118492             LEADING ZERO BY " ".                                 22810000
118493     INSPECT PV-CHAR-VOL-PCT-1                                    22820000
118494            TALLYING PA-CNT-SPACES FOR ALL " ".                   22830000
118495     EVALUATE TRUE                                                22840000
118496         WHEN PA-CNT-SPACES = 0                                   22850000
118497              MOVE PC-FRONT-PAR     TO PV-FINAL-VOL-PCT-1         22860000
118498              MOVE PV-SEP-VOL-PCT-1 TO PV-FINAL-VOL-PCT-2         22870000
118499              MOVE PV-SEP-VOL-PCT-2 TO PV-FINAL-VOL-PCT-3         22880000
118500              MOVE PV-SEP-VOL-PCT-3 TO PV-FINAL-VOL-PCT-4         22890000
118501              MOVE PV-SEP-VOL-PCT-4 TO PV-FINAL-VOL-PCT-5         22900000
118502              MOVE PV-SEP-VOL-PCT-5 TO PV-FINAL-VOL-PCT-6         22910011
118503         WHEN PA-CNT-SPACES = 1                                   22920000
118504              MOVE PC-FRONT-PAR     TO PV-FINAL-VOL-PCT-2         22930000
118505              MOVE PV-SEP-VOL-PCT-2 TO PV-FINAL-VOL-PCT-3         22940000
118506              MOVE PV-SEP-VOL-PCT-3 TO PV-FINAL-VOL-PCT-4         22950000
118507              MOVE PV-SEP-VOL-PCT-4 TO PV-FINAL-VOL-PCT-5         22960000
118508              MOVE PV-SEP-VOL-PCT-5 TO PV-FINAL-VOL-PCT-6         22970011
118509         WHEN PA-CNT-SPACES = 2                                   22980000
118510              MOVE PC-FRONT-PAR     TO PV-FINAL-VOL-PCT-3         22990000
118511              MOVE PV-SEP-VOL-PCT-3 TO PV-FINAL-VOL-PCT-4         23000000
118512              MOVE PV-SEP-VOL-PCT-4 TO PV-FINAL-VOL-PCT-5         23010000
118513              MOVE PV-SEP-VOL-PCT-5 TO PV-FINAL-VOL-PCT-6         23020011
118514         WHEN PA-CNT-SPACES = 3                                   23030000
118515              MOVE PC-FRONT-PAR     TO PV-FINAL-VOL-PCT-4         23040000
118516              MOVE PV-SEP-VOL-PCT-4 TO PV-FINAL-VOL-PCT-5         23050000
118517              MOVE PV-SEP-VOL-PCT-5 TO PV-FINAL-VOL-PCT-6         23060011
118518         WHEN PA-CNT-SPACES = 4                                   23070011
118519              MOVE PC-FRONT-PAR     TO PV-FINAL-VOL-PCT-5         23080011
118520              MOVE PV-SEP-VOL-PCT-5 TO PV-FINAL-VOL-PCT-6         23090011
118521     END-EVALUATE.                                                23100000
118522     MOVE PC-BACK-PAR               TO PV-FINAL-VOL-PCT-7.        23110011
118523                                                                  23120000
118524                                                                  23130000
118525*9000-EXIT.                                                       23140000
118526 EJECT.                                                           23150000
118527                                                                  23160000
118528*----------------------------------------------------------       23170000
118529* 9100-CALENDAR-ROUTINE.                                          23180000
118530*     CALLS THE DATE ROUTINE WITH SPECIFIED PARAMETERS.           23190000
118531*----------------------------------------------------------       23200000
118532 9100-CALENDAR-ROUTINE.                                           23210000
118533                                                                  23220000
118534     CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51 DPG52          23230000
118535                                             DPG53 DPG54          23240000
118536                                             DPG55 DPG56.         23250000
118537     EVALUATE TRUE                                                23260000
118538         WHEN DPG54-NO-ERROR                                      23270000
118539             CONTINUE                                             23280000
118540         WHEN DPG54-WARNING-ERROR                                 23290000
118541             DISPLAY '** WARNING - PROGRAM '                      23300000
118542                      PC-CURRENT-PROGRAM-NAME ' **'               23310000
118543             DISPLAY '** 9100-CALENDAR-ROUTINE'                   23320000
118544             DISPLAY '** CALL TO DPKUT500 RETURNED WARNING ERROR' 23330000
118545             DISPLAY '** DPG54-ERROR-MESSAGE: '                   23340000
118546             DISPLAY '** ' DPG54-ERROR-MESSAGE                    23350000
118547             DISPLAY '** DPG51: ' DPG51                           23360000
118548             DISPLAY '** DPG52: ' DPG52                           23370000
118549             DISPLAY '** PLEASE INVESTIGATE FURTHER **'           23380000
118550         WHEN DPG54-SEVERE-ERROR                                  23390000
118551             DISPLAY '** ABEND - PROGRAM '                        23400000
118560                      PC-CURRENT-PROGRAM-NAME ' **'               23410000
118570             DISPLAY '** 9100-CALENDAR-ROUTINE'                   23420000
118580             DISPLAY '** CALL TO DPKUT500 RETURNED SEVERE ERROR'  23430000
118590             IF DPG54-CALENDAR-TYPE-INVALID                       23440000
118600                DISPLAY '** DPG54-CALENDAR-TYPE-INVALID'          23450000
118700                DISPLAY '** DPG51-CALENDAR-TYPE: '                23460000
118800                         DPG51-CALENDAR-TYPE                      23470000
118900             END-IF                                               23480000
119000             IF DPG54-DATE-INVALID                                23490000
119100                DISPLAY '** DPG54-DATE-INVALID'                   23500000
119200                DISPLAY '** DPG52-LK-DATE-INPUT: '                23510000
119300                         DPG52-LK-DATE-INPUT                      23520000
119400             END-IF                                               23530000
119500             IF DPG54-INCR-DECR-INVALID                           23540000
119600                DISPLAY '** DPG54-INCR-DECR-INVALID'              23550000
119700                DISPLAY '** DPG51-INCREMENT-DECREMENT-FLAG: '     23560000
119800                         DPG51-INCREMENT-DECREMENT-FLAG           23570000
119900             END-IF                                               23580000
120000             MOVE DPG54-ERROR-MESSAGE                             23590000
120100                                 TO PV-OPERATION-MSG-2            23600000
120200             SET ABEND-4019-DATE-ROUTINE-ERROR TO TRUE            23610000
120300             PERFORM 9800-ABEND                                   23620000
120400     END-EVALUATE.                                                23630000
120500                                                                  23640000
120600*9100-EXIT.                                                       23650000
120700 EJECT.                                                           23660000
120800                                                                  23670000
120900*----------------------------------------------------------       23680000
121000* 9800-ABEND.                                                     23690000
121100*     PERFORMS A NON-SQL-ABEND.                                   23700000
121200*----------------------------------------------------------       23710000
121300 9800-ABEND.                                                      23720000
121400                                                                  23730000
121500     DISPLAY '** ABEND           **'.                             23740000
121600     DISPLAY '** PROGRAM         ** = ' PC-CURRENT-PROGRAM-NAME.  23750000
121700     DISPLAY '** PARAGRAPH       ** = ' PV-PARAGRAPH-NAME.        23760000
121800     DISPLAY '** OPERATION       ** = ' PV-OPERATION-MSG-1.       23770000
121900     DISPLAY '**                 ** = ' PV-OPERATION-MSG-2.       23780000
122000                                                                  23790000
122100     CALL 'ILBOABN0' USING ABEND-CODE.                            23800000
