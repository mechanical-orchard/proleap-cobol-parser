000100 IDENTIFICATION DIVISION.                                         00010005
000200 PROGRAM-ID.    APKRP228.                                         00020005
000300 AUTHOR.        ALEXIS KEIKER.                                    00030005
000400 DATE-WRITTEN.  OCTOBER 2001.                                     00040005
000500 DATE-COMPILED.                                                   00050005
000600*---------------------------------------------------------------* 00060007
000700*         REPORT OF TEST EDI IMPORT INVOICES REPORT             * 00070005
000800*---------------------------------------------------------------* 00080007
000900*    COBOL 390                                                  * 00090005
001000*---------------------------------------------------------------* 00100007
001100*  PURPOSE:  TO CREATE A REPORT OF TEST EDI IMPORT INVOICES     * 00110005
001200*  THAT HAVE NO ERRORS AND WERE NOT REJECTED.                   * 00120005
001300*---------------------------------------------------------------* 00130007
001400*                                                               * 00140005
001500*  INPUT:  TEST EDI INVOICE RECORDS (APRD019)                   * 00150005
001600*  OUTPUT: PENDING STATUS INVOICES REPORT                       * 00160005
001700*---------------------------------------------------------------* 00170007
001800* CHANGE LOG:                                                   * 00180005
001900*                                                               * 00190005
002000* 03/19/02                                                      * 00200036
002100*    CHANGE MADE: INCREASED REPORT SIZE FROM 150 TO 200 SO      * 00210036
002200*    THAT THE AMOUNT FIELDS ARE NO LONGER TRUNCATED.            * 00220036
002300*    MADE BY: MIKE BESKE                        PITS#: 456693   * 00230036
002400*                                                               * 00240005
002500* DATE  05/22/2003                                              * 00250042
002600*     CHANGE MADE: CHANGED ALL REFERENCES OF PO-SKU-QTY TO      * 00260042
002700*     PO-QTY.  CHANGE TITLE ON 'SKU COUNT' COLUMN TO 'PO QTY'   * 00270042
002800*     AND DTL-SKU-COUNT TO DTL-PO-QTY.                          * 00280042
002900*     MADE BY: KEVIN CATLIN            WR/IR #: WR24632         * 00290042
003000*                                                               * 00290148
003100* DATE  11/04/2014                                              * 00291048
003200*     CHANGE MADE: MODIFIED PO NUMBER LENGTH FROM 7 DIGIT TO 9  * 00292048
003300*     DIGIT IN THE REPORT LAYOUT.                               * 00293048
003301*     MADE BY: COGNIZANT               WR/IR #: CHG0094517      * 00295050
003302*                                                               * 00300042
003303*---------------------------------------------------------------* 00310007
003304 ENVIRONMENT DIVISION.                                            00320005
003305 CONFIGURATION SECTION.                                           00330005
003400 SOURCE-COMPUTER.        IBM-370.                                 00340005
003500 OBJECT-COMPUTER.        IBM-370.                                 00350005
003600                                                                  00360005
003700 INPUT-OUTPUT SECTION.                                            00370005
003800 FILE-CONTROL.                                                    00380005
003900     SELECT TEST-EDI-FILE        ASSIGN TO INP01.                 00390005
004000     SELECT GOOD-TEST-INVC-RPT   ASSIGN TO RPT01.                 00400028
004100                                                                  00410005
004200 DATA DIVISION.                                                   00420005
004300 FILE SECTION.                                                    00430005
004400                                                                  00440005
004500 FD  TEST-EDI-FILE                                                00450005
004600     RECORDING MODE IS F                                          00460005
004700     LABEL RECORDS ARE STANDARD                                   00470005
004800     BLOCK CONTAINS 0 RECORDS                                     00480005
004900     RECORD CONTAINS 360 CHARACTERS                               00490005
005000     DATA RECORD IS TEST-EDI-REC.                                 00500005
005100                                                                  00510005
005200 01  TEST-EDI-REC                       PIC X(360).               00520005
005300                                                                  00530005
005400 FD  GOOD-TEST-INVC-RPT                                           00540028
005500     RECORDING MODE IS F                                          00550005
005600     LABEL RECORDS ARE STANDARD                                   00560005
005700     DATA RECORD IS GOOD-TEST-INVC-REC.                           00570028
005800                                                                  00580005
005900 01  GOOD-TEST-INVC-REC                 PIC X(200).               00590033
006000                                                                  00600005
006100                                                                  00610005
006200 WORKING-STORAGE SECTION.                                         00620005
006300                                                                  00630005
006400 01  PROGRAM-SWITCHES.                                            00640005
006500     05  PS-TEST-EDI-EOF-SW         PIC X       VALUE 'N'.        00650005
006600         88 PS-TEST-EDI-NOT-EOF                 VALUE 'N'.        00660005
006700         88 PS-TEST-EDI-EOF                     VALUE 'Y'.        00670005
006800                                                                  00680005
006900 01  PROGRAM-VARIABLES.                                           00690005
007000     05  PV-COUNT-TEST                  PIC 9(12)       VALUE 0.  00700011
007100     05  PV-TEST-RPT-OUT                PIC 9(12)       VALUE 0.  00710011
007200     05  MAX-LINES                      PIC  S9(3)  COMP-3        00720005
007300                                             VALUE +67.           00730027
007400     05  PAGE-COUNT                    PIC S9(9) COMP-3 VALUE +0. 00740005
007500     05  LINE-COUNT                    PIC S9(3) COMP-3 VALUE +0. 00750005
007600     05  PV-SYSTEM-DATE                 PIC X(08)  VALUE ZERO.    00760005
007700     05  FILLER REDEFINES PV-SYSTEM-DATE.                         00770005
007800         10  PV-SYSTEM-CCYY.                                      00780005
007900             15  PV-SYSTEM-CENTURY      PIC X(02).                00790005
008000             15  PV-SYSTEM-YEAR         PIC X(02).                00800005
008100         10  PV-SYSTEM-MONTH            PIC X(02).                00810005
008200         10  PV-SYSTEM-DAY              PIC X(02).                00820005
008300     05  PV-SYSTEM-TIME.                                          00830005
008400         10  PV-SYSTEM-HOUR         PIC  9(02)  VALUE ZERO.       00840005
008500         10  PV-SYSTEM-MINUTE       PIC  9(02)  VALUE ZERO.       00850005
008600         10  PV-SYSTEM-SECOND       PIC  9(02)  VALUE ZERO.       00860005
008700         10  FILLER                 PIC  9(02)  VALUE ZERO.       00870005
008800     05  PV-PROGRAM-NAME            PIC  X(8)   VALUE 'APKRP228'. 00880019
008900     05  SAVE-CHRG-CODE                 PIC X(03) VALUE SPACES.   00890029
009000     05  SAVE-CHRG-AMT                  PIC -------.99            00900029
009100                                                  VALUE ZEROES.   00910029
009200                                                                  00920005
009300*----------------------------------------------------------------*00930007
009400*           KOHLS STANDARD 200 CHARACTER REPORT HEADER           *00940033
009500*----------------------------------------------------------------*00950007
009600     COPY DPWS200O.                                               00960033
009700                                                                  00970005
009800 01  BLANK-LINE                PIC X(200) VALUE SPACES.           00980033
009900                                                                  00990005
010000 01  SAVE-DETAIL-LINE          PIC X(200) VALUE SPACES.           01000033
010100                                                                  01010028
010200 01  HDR-TITLE-1.                                                 01020005
010300     05  FILLER                  PIC  X(84)     VALUE SPACE.      01030034
010400     05  FILLER                  PIC  X(32)     VALUE             01040005
010500                      'TEST EDI INVOICES WITH NO ERRORS'.         01050005
010600     05  FILLER                  PIC  X(84)     VALUE SPACE.      01060034
010700                                                                  01070033
010800 01  HEADER-1.                                                    01080033
010900     05  FILLER                PIC X(32) VALUE SPACES.            01090047
011000     05  FILLER                PIC X(02) VALUE 'PO'.              01100033
011100     05  FILLER                PIC X(24) VALUE SPACES.            01110047
011200     05  FILLER                PIC X(07) VALUE 'INVOICE'.         01120033
011300     05  FILLER                PIC X(04) VALUE SPACES.            01130033
011400     05  FILLER                PIC X(15) VALUE '  NET INVOICE'.   01140034
011500     05  FILLER                PIC X(02) VALUE SPACES.            01150033
011600     05  FILLER                PIC X(12) VALUE 'CONTAINER / '.    01160033
011700     05  FILLER                PIC X(03) VALUE SPACES.            01170033
011800     05  FILLER                PIC X(04) VALUE 'CHRG'.            01180033
011900     05  FILLER                PIC X(03) VALUE SPACES.            01190033
012000     05  FILLER                PIC X(08) VALUE '  CHARGE'.        01200034
012100     05  FILLER                PIC X(05) VALUE SPACES.            01210033
012200     05  FILLER                PIC X(09) VALUE '    TOTAL'.       01220034
012300     05  FILLER                PIC X(05) VALUE SPACES.            01230033
012400     05  FILLER                PIC X(09) VALUE '    TOTAL'.       01240034
012500     05  FILLER                PIC X(12) VALUE SPACES.            01250041
012600     05  FILLER                PIC X(02) VALUE 'PO'.              01260033
012700     05  FILLER                PIC X(05) VALUE SPACES.            01270038
012800     05  FILLER                PIC X(06) VALUE 'PO UOM'.          01280040
012900     05  FILLER                PIC X(33) VALUE SPACE.             01290041
013000                                                                  01300033
013100 01  HEADER-2.                                                    01310033
013200     05  FILLER                PIC X(09) VALUE 'VENDOR ID'.       01320033
013300     05  FILLER                PIC X(01) VALUE SPACES.            01330033
013400     05  FILLER                PIC X(11) VALUE 'VENDOR NAME'.     01340033
013500     05  FILLER                PIC X(10) VALUE SPACES.            01350047
013600     05  FILLER                PIC X(06) VALUE 'NUMBER'.          01360033
013700     05  FILLER                PIC X(04) VALUE SPACES.            01370047
013800     05  FILLER                PIC X(10) VALUE 'INVOICE ID'.      01380033
013900     05  FILLER                PIC X(09) VALUE SPACES.            01390047
014000     05  FILLER                PIC X(04) VALUE 'DATE'.            01400033
014100     05  FILLER                PIC X(07) VALUE SPACES.            01410033
014200     05  FILLER                PIC X(08) VALUE '  AMOUNT'.        01420034
014300     05  FILLER                PIC X(05) VALUE SPACES.            01430033
014400     05  FILLER                PIC X(14) VALUE 'BOL ID / ENTRY'.  01440033
014500     05  FILLER                PIC X(03) VALUE SPACES.            01450033
014600     05  FILLER                PIC X(04) VALUE 'CODE'.            01460033
014700     05  FILLER                PIC X(03) VALUE SPACES.            01470033
014800     05  FILLER                PIC X(08) VALUE '  AMOUNT'.        01480034
014900     05  FILLER                PIC X(03) VALUE SPACES.            01490033
015000     05  FILLER                PIC X(11) VALUE '    DRAYAGE'.     01500034
015100     05  FILLER                PIC X(02) VALUE SPACES.            01510033
015200     05  FILLER                PIC X(12) VALUE '    DECONSOL'.    01520034
015300     05  FILLER                PIC X(02) VALUE SPACES.            01530041
015400     05  FILLER                PIC X(06) VALUE 'PO QTY'.          01540041
015500     05  FILLER                PIC X(02) VALUE SPACES.            01550041
015600     05  FILLER                PIC X(06) VALUE 'WEIGHT'.          01560033
015700     05  FILLER                PIC X(04) VALUE SPACES.            01570040
015800     05  FILLER                PIC X(03) VALUE 'CDE'.             01580040
015900     05  FILLER                PIC X(35) VALUE SPACE.             01590041
016000                                                                  01600033
016100 01  DETAIL-1.                                                    01610033
016200     05  DTL-VENDOR-ID         PIC X(09) VALUE SPACES.            01620033
016300     05  FILLER                PIC X(01) VALUE SPACES.            01630033
016400     05  DTL-VENDOR-NAME       PIC X(20) VALUE SPACES.            01640033
016500     05  FILLER                PIC X(01) VALUE SPACES.            01650033
016600     05  DTL-PO-NUMBER         PIC ZZZZZZZZ9 VALUE ZEROES.        01660052
016700     05  FILLER                PIC X(01) VALUE SPACES.            01670033
016800     05  DTL-INVOICE-ID        PIC X(16) VALUE SPACES.            01680033
016900     05  FILLER                PIC X(01) VALUE SPACES.            01690047
017000     05  DTL-INVOICE-DTE.                                         01700033
017100         10 DTL-INVC-DTE-MM    PIC 9(02) VALUE ZEROES.            01710033
017200         10 DTL-SLASH-1        PIC X(01) VALUE '/'.               01720033
017300         10 DTL-INVC-DTE-DD    PIC 9(02) VALUE ZEROES.            01730033
017400         10 DTL-SLASH-2        PIC X(01) VALUE '/'.               01740033
017500         10 DTL-INVC-DTE-CC    PIC 9(02) VALUE ZEROES.            01750033
017600         10 DTL-INVC-DTE-YY    PIC 9(02) VALUE ZEROES.            01760033
017700     05  FILLER                PIC X(1)  VALUE SPACE.             01770033
017800     05  DTL-NET-INVC-AMT      PIC ----------.99                  01780034
017900                                         VALUE ZEROES.            01790033
018000     05  FILLER                PIC X(02) VALUE SPACES.            01800047
018100     05  DTL-REFERENCE-ID      PIC X(15) VALUE SPACES.            01810033
018200     05  FILLER                PIC X(02) VALUE SPACES.            01820047
018300     05  DTL-CHRG-CODE         PIC X(03) VALUE SPACES.            01830033
018400     05  FILLER                PIC X(01) VALUE SPACES.            01840033
018500     05  DTL-CHRG-AMT          PIC --------.99                    01850034
018600                                         VALUE ZEROES.            01860033
018700     05  FILLER                PIC X(01) VALUE SPACES.            01870033
018800     05  DTL-TOT-DRAYAGE       PIC ----------.99                  01880034
018900                                      BLANK WHEN ZERO.            01890033
019000     05  FILLER                PIC X(01) VALUE SPACES.            01900033
019100     05  DTL-TOT-DEC           PIC ----------.99                  01910034
019200                                      BLANK WHEN ZERO.            01920033
019300     05  FILLER                PIC X(01) VALUE SPACES.            01930033
019400     05  DTL-PO-QTY            PIC ZZZZZZZ VALUE ZEROES.          01940037
019500     05  FILLER                PIC X(01) VALUE SPACES.            01950033
019600     05  DTL-PO-WEIGHT         PIC ZZZZZZZ VALUE ZEROES.          01960033
019700     05  FILLER                PIC X(05) VALUE SPACE.             01970040
019800     05  DTL-PO-UOM-CDE        PIC X(02) VALUE SPACE.             01980038
019900     05  FILLER                PIC X(35) VALUE SPACE.             01990040
020000                                                                  02000033
020100 01  END-OF-REPORT.                                               02010033
020200     05  FILLER                PIC X(85) VALUE SPACES.            02020033
020300     05  FILLER                PIC X(29) VALUE                    02030033
020400               '- - - - END OF REPORT - - - -'.                   02040033
020500     05  FILLER                PIC X(86) VALUE SPACE.             02050034
020600                                                                  02060033
020700 01  NO-DATA-TO-REPORT.                                           02070033
020800     05  FILLER                PIC X(88) VALUE SPACES.            02080034
020900     05  FILLER                PIC X(23) VALUE                    02090033
021000                     '-  NO DATA TO REPORT  -'.                   02100033
021100     05  FILLER                PIC X(89) VALUE SPACE.             02110034
021200                                                                  02120033
021300*--------------------------------------------------------------*  02130033
021400*  APRD019 RECORD LAYOUT FOR PENDING REVIEW TRANSACTIONS       *  02140033
021500*--------------------------------------------------------------*  02150033
021600     COPY APRD019.                                                02160033
021700                                                                  02170033
021800                                                                  02180033
021900 LINKAGE SECTION.                                                 02190033
022000                                                                  02200033
022100 PROCEDURE DIVISION.                                              02210033
022200                                                                  02220033
022300 A100-MAINLINE-ROUTINE.                                           02230033
022400                                                                  02240033
022500     PERFORM B100-INITIALIZATION.                                 02250033
022600                                                                  02260033
022700     PERFORM B200-CREATE-PENDING-RPT                              02270033
022800       UNTIL PS-TEST-EDI-EOF.                                     02280033
022900                                                                  02290033
023000     PERFORM B300-TERMINATION.                                    02300033
023100     GOBACK.                                                      02310033
023200                                                                  02320033
023300*--------------------------------------------------------------*  02330033
023400* B100-INITIALIZATION                                          *  02340033
023500*  INITIALIZATION PROCESSING.                                  *  02350033
023600*--------------------------------------------------------------*  02360033
023700 B100-INITIALIZATION.                                             02370033
023800                                                                  02380033
023900      DISPLAY ' '.                                                02390033
024000      DISPLAY '**--------------- APKRP228 --------------------**'.02400033
024100      OPEN INPUT  TEST-EDI-FILE                                   02410033
024200           OUTPUT GOOD-TEST-INVC-RPT.                             02420033
024300                                                                  02430033
024400      MOVE FUNCTION CURRENT-DATE TO PV-SYSTEM-DATE                02440033
024500      MOVE PV-SYSTEM-MONTH        TO DP200O-RUN-MONTH.            02450034
024600      MOVE PV-SYSTEM-DAY          TO DP200O-RUN-DAY.              02460034
024700      MOVE PV-SYSTEM-YEAR         TO DP200O-RUN-YEAR.             02470034
024800      ACCEPT PV-SYSTEM-TIME FROM TIME.                            02480033
024900      MOVE PV-SYSTEM-HOUR         TO DP200O-RUN-HOUR.             02490034
025000      MOVE PV-SYSTEM-MINUTE       TO DP200O-RUN-MINUTE.           02500034
025100      MOVE PV-PROGRAM-NAME        TO DP200O-PROGRAM-NAME.         02510034
025200      MOVE '1'                    TO DP200O-REPORT-NUMBER.        02520034
025300      PERFORM W100-WRITE-HEADINGS.                                02530033
025400                                                                  02540033
025500*  THIS READS THE FIRST RECORD OF THE INPUT FILE AND CHECKS TO SEE02550033
025600*  IF THERE ARE RECORDS TO PROCESS.                               02560033
025700      PERFORM R100-READ-INPUT.                                    02570033
025800                                                                  02580033
025900      IF PS-TEST-EDI-EOF                                          02590033
026000         DISPLAY 'NO REPORT RECORDS TO PROCESS '                  02600033
026100         WRITE GOOD-TEST-INVC-REC FROM NO-DATA-TO-REPORT          02610033
026200               AFTER ADVANCING 1 LINE                             02620033
026300      END-IF.                                                     02630033
026400                                                                  02640033
026500                                                                  02650033
026600*--------------------------------------------------------------*  02660033
026700* B200-CREATE-PENDING-RPT                                      *  02670033
026800*  THIS ROUTINE HOLDS THE MAIN LOGIC FOR PENDING REVIEW        *  02680033
026900*  REPORTING.                                                  *  02690033
027000*--------------------------------------------------------------*  02700033
027100 B200-CREATE-PENDING-RPT.                                         02710033
027200                                                                  02720033
027300     MOVE SPACES TO DETAIL-1.                                     02730033
027400                                                                  02740033
027500     MOVE AP019-VENDOR-NBR           TO DTL-VENDOR-ID.            02750033
027600     MOVE AP019-VENDOR-NAME          TO DTL-VENDOR-NAME.          02760033
027700     MOVE AP019-PO-NBR               TO DTL-PO-NUMBER.            02770033
027800     MOVE AP019-INVOICE-NBR          TO DTL-INVOICE-ID.           02780033
027900     MOVE AP019-INVC-DTE-DD          TO DTL-INVC-DTE-DD.          02790033
028000     MOVE AP019-INVC-DTE-MM          TO DTL-INVC-DTE-MM.          02800033
028100     MOVE AP019-INVC-DTE-CC          TO DTL-INVC-DTE-CC.          02810033
028200     MOVE AP019-INVC-DTE-YY          TO DTL-INVC-DTE-YY.          02820033
028300     MOVE '/'                        TO DTL-SLASH-1               02830033
028400                                        DTL-SLASH-2.              02840033
028500                                                                  02850033
028600     IF AP019-ENTRY-NBR NOT = SPACE                               02860033
028700        MOVE AP019-ENTRY-NBR TO DTL-REFERENCE-ID                  02870033
028800     END-IF.                                                      02880033
028900     IF AP019-BOL-ID NOT = SPACE                                  02890033
029000        MOVE AP019-BOL-ID TO DTL-REFERENCE-ID                     02900033
029100     END-IF.                                                      02910033
029200     IF AP019-CONTAINER-ID NOT = SPACE                            02920033
029300        MOVE AP019-CONTAINER-ID TO DTL-REFERENCE-ID               02930033
029400     END-IF.                                                      02940033
029500     MOVE AP019-NET-INVC-AMT         TO DTL-NET-INVC-AMT.         02950033
029600     MOVE AP019-TOTAL-DRAYAGE-AMT    TO DTL-TOT-DRAYAGE.          02960033
029700     MOVE AP019-TOTAL-DECONSOL-AMT   TO DTL-TOT-DEC.              02970033
029800     MOVE AP019-PO-QTY               TO DTL-PO-QTY.               02980037
029900     MOVE AP019-PO-WEIGHT            TO DTL-PO-WEIGHT.            02990033
030000     MOVE AP019-PO-UOM-CDE           TO DTL-PO-UOM-CDE.           03000038
030100                                                                  03010033
030200     MOVE DETAIL-1 TO SAVE-DETAIL-LINE.                           03020033
030300                                                                  03030033
030400     PERFORM VARYING AP019-IDX FROM 1 BY 1                        03040033
030500       UNTIL AP019-CHARGE-CDE(AP019-IDX) = SPACE                  03050033
030600          OR AP019-IDX > 20                                       03060033
030700             MOVE AP019-CHARGE-CDE(AP019-IDX) TO DTL-CHRG-CODE    03070033
030800             MOVE AP019-CHARGE-AMT(AP019-IDX) TO DTL-CHRG-AMT     03080033
030900             PERFORM W200-WRITE-DETAIL                            03090033
031000             MOVE SPACES TO DETAIL-1                              03100033
031100     END-PERFORM.                                                 03110033
031200                                                                  03120033
031300     PERFORM W300-WRITE-BLANK-LINE.                               03130033
031400                                                                  03140033
031500     PERFORM R100-READ-INPUT.                                     03150033
031600                                                                  03160033
031700*------------------------------------------------------------*    03170033
031800* B300-TERMINATION                                           *    03180033
031900*  END OF PROGRAM PROCESSING.                                *    03190033
032000*------------------------------------------------------------*    03200033
032100 B300-TERMINATION.                                                03210033
032200                                                                  03220033
032300     DISPLAY '*************************************'.             03230033
032400     DISPLAY '*************************************'.             03240033
032500     DISPLAY 'EDI IMPORT INVOICE COUNT  ' PV-COUNT-TEST.          03250033
032600     DISPLAY 'PENDING RECORDS WRITTEN  ' PV-TEST-RPT-OUT.         03260033
032700     DISPLAY '*************************************'.             03270033
032800     DISPLAY '*************************************'.             03280033
032900                                                                  03290033
033000     CLOSE TEST-EDI-FILE                                          03300033
033100           GOOD-TEST-INVC-RPT.                                    03310033
033200                                                                  03320033
033300                                                                  03330033
033400*--------------------------------------------------------------*  03340033
033500* R100-READ-INPUT                                              *  03350033
033600*  READS THE INPUT RECORD.                                     *  03360033
033700*--------------------------------------------------------------*  03370033
033800 R100-READ-INPUT.                                                 03380033
033900                                                                  03390033
034000     READ TEST-EDI-FILE INTO AP019-IMPORT-EXP-AUDIT-RECORD        03400033
034100          AT END                                                  03410033
034200             SET PS-TEST-EDI-EOF TO TRUE                          03420033
034300     END-READ.                                                    03430033
034400                                                                  03440033
034500     IF PS-TEST-EDI-NOT-EOF                                       03450033
034600        ADD 1 TO PV-COUNT-TEST                                    03460033
034700     END-IF.                                                      03470033
034800                                                                  03480033
034900                                                                  03490033
035000*----------------------------------------------------------------*03500033
035100* W100-WRITE-HEADINGS                                            *03510033
035200*  PRODUCE THE PAGE HEADINGS FOR THE REPORT.                     *03520033
035300*----------------------------------------------------------------*03530033
035400 W100-WRITE-HEADINGS.                                             03540033
035500                                                                  03550033
035600      ADD 1 TO PAGE-COUNT.                                        03560033
035700      MOVE PAGE-COUNT TO DP200O-PAGE-NUMBER.                      03570034
035800      WRITE GOOD-TEST-INVC-REC FROM DP200O-STANDRD-HEADER-200-COLS03580035
035900          AFTER ADVANCING PAGE.                                   03590033
036000      WRITE GOOD-TEST-INVC-REC FROM HDR-TITLE-1                   03600033
036100          AFTER ADVANCING 1 LINE.                                 03610033
036200      PERFORM W300-WRITE-BLANK-LINE.                              03620033
036300      WRITE GOOD-TEST-INVC-REC FROM HEADER-1                      03630033
036400          AFTER ADVANCING 2 LINES.                                03640033
036500      WRITE GOOD-TEST-INVC-REC FROM HEADER-2                      03650033
036600          AFTER ADVANCING 1 LINE.                                 03660033
036700      WRITE GOOD-TEST-INVC-REC FROM BLANK-LINE                    03670033
036800          AFTER ADVANCING 1 LINE.                                 03680033
036900      MOVE +7            TO LINE-COUNT.                           03690033
037000                                                                  03700033
037100*---------------------------------------------------------------* 03710033
037200* W200-WRITE-DETAIL                                               03720033
037300*  THIS ROUTINE WRITES THE REMITTANCE LINES.                    * 03730033
037400*---------------------------------------------------------------* 03740033
037500 W200-WRITE-DETAIL.                                               03750033
037600                                                                  03760033
037700     IF LINE-COUNT >= MAX-LINES                                   03770033
037800        PERFORM W100-WRITE-HEADINGS                               03780033
037900        MOVE DTL-CHRG-CODE    TO SAVE-CHRG-CODE                   03790033
038000        MOVE DTL-CHRG-AMT     TO SAVE-CHRG-AMT                    03800033
038100        MOVE SAVE-DETAIL-LINE TO DETAIL-1                         03810033
038200        MOVE SAVE-CHRG-CODE   TO DTL-CHRG-CODE                    03820033
038300        MOVE SAVE-CHRG-AMT    TO DTL-CHRG-AMT                     03830033
038400     END-IF.                                                      03840033
038500                                                                  03850033
038600                                                                  03860033
038700     WRITE GOOD-TEST-INVC-REC FROM DETAIL-1                       03870033
038800           AFTER ADVANCING 1 LINE.                                03880033
038900     ADD 1 TO LINE-COUNT                                          03890033
039000              PV-TEST-RPT-OUT.                                    03900033
039100                                                                  03910033
039200*---------------------------------------------------------------* 03920033
039300* W300-WRITE-BLANK-LINE                                         * 03930033
039400*  WRITE A BLANK LINE BETWEEN REMITTANCE LINES                  * 03940033
039500*---------------------------------------------------------------* 03950033
039600 W300-WRITE-BLANK-LINE.                                           03960033
039700                                                                  03970033
039800      IF LINE-COUNT >= MAX-LINES                                  03980033
039900         CONTINUE                                                 03990033
040000      ELSE                                                        04000033
040100         WRITE GOOD-TEST-INVC-REC FROM BLANK-LINE                 04010033
040200         ADD 1 TO LINE-COUNT                                      04020033
040300      END-IF.                                                     04030033
040400                                                                  04040033
