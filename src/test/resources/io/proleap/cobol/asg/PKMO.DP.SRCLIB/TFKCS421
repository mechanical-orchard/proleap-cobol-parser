      *-----------------------*                                         00010099
       IDENTIFICATION DIVISION.                                         00020099
      *-----------------------*                                         00030099
       PROGRAM-ID.    TFKCS421.                                         00040099
       AUTHOR.        PAUL KEBER - STRATAGEM.                           00050099
       INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060099
       DATE-WRITTEN.  09-19-96.                                         00070099
       DATE-COMPILED.                                                   00080099
                                                                        00090099
      ******************************************************************00100099
      * PROGRAM NUMBER: TFKCS421       SYSTEM: TF     LANGUAGE: COBOL II00110099
      *                                                                 00120099
      * TRANID:  P421       MNEMONIC:  TFLINQ        MAP: TFKM421       00130099
      *                                                                 00140099
      * PROGRAM NAME : TRANSFER INQUIRY LIST                            00150099
      *                                                                 00160099
      * ORIGINAL WORK REQUEST #: 3780                                   00170099
      *                                                                 00180099
      * PROGRAM OBJECTIVE:                                              00190099
      *                                                                 00200099
      *   TO DISPLAY A LIST OF TRANSFERS AS PER CRITERIA PASSED FROM    00210099
      *   THE TRANSFER INQUIRY CRITERIA SPECIFICATION PROGRAM (TFKCS420)00220099
      *   AND PASS INFORMATION TO THE NEXT PROGRAM, ACCORDING TO THE    00230099
      *   FUNCTION KEY SELECTED.                                        00240099
      *                                                                 00250099
      * DATASETS USED:                                                  00260099
      *  DATASET                             COPY USED  I/O  VSAM?  DB? 00270099
      * --------------------------------    ----------- ---- -----  --- 00280099
      *  TRANSFER TABLE                      TTFMSTR     I     N    DB2 00290099
      *  TRANSFER ITEM TABLE                 TTFITEM     I     N    DB2 00300099
      *  TRANSFER DISCREPANCY TABLE          TTFDSCP     I     N    DB2 00310099
      *  TRANSFER ITEM RECEIPTS TABLE        TTFITRC     I     N    DB2 00320099
      *  TRANSFER RECEIPT TABLE              TTFRCPT     I     N    DB2 00330099
      *  TRANSFER TYPE TABLE                 TTFTYCD     I     N    DB2 00340099
      *  TRANSFER CUSTOMER TABLE             TTFCUST     I     N    DB2 00350099
      *  TRANSFER STATUS TABLE               TTFSTAT    I/O    N    DB2 00360099
      *  SKU CROSS REFERENCE TABLE           TSKXREF     I     N    DB2 00360099
101803*  XS DOMAIN UPC TABLE                 XST_SKU     I     N    DB2         
      *                                                                 00370099
      * PROGRAM NARRATIVE:                                              00380099
      *                                                                 00390099
      *   THIS PROGRAM GENERATES A LIST OF TRANSFERS BASED ON THE INPUT 00400099
      *   SELECTION CRITERIA.  THIS PROGRAM WILL ALLOW THE USER TO      00410099
      *   SELECT A SPECIFIC TRANSFER NUMBER FOR A TRANSFER HEADER       00420099
      *   INQUIRY, FOR A TRANSFER ITEM INQUIRY, TO VOID A TRANSFER, TO  00430099
      *   PRINT THE LIST OF TRANSFERS, OR TO START A PROGRAM TO RE-PRINT00440099
      *   THE TRANSFER DOCUMENT.  THIS PROGRAM USES DYNAMIC SQL TO      00450099
      *   BUILD THE TRANSFER LIST BASED ON DIFFERENT SELECTION CRITERIA.00460099
      *                                                                 00470099
      ***************************************************************** 00480099
      * CHANGES:                                                        00490099
      *   DATE 03/27/97                                                 00500099
      *   ADDED THE ABILITY TO DISPLAY VOIDED TRANSFERS. ALSO ADDED     00510099
      *   OFFSITE STORAGE TRANSFERS. HILIGHT SELECTIONS_______________  00520099
      *   MADE BY: JACK KRAMER _________   WR/IR #: __________________  00530099
      ***************************************************************** 00540099
      *  1/20/2003 - RAY GRAF                                                   
      *   PROCESS NONINTELLIGENT SKU.                                           
101803******************************************************************        
101803*  10/18/2003 - CHRIS ALBRIGHT                                            
101803*   FIX TO ALLOW USER TO ENTER A VENDOR UPC NUMBER TO RETRIEVE A          
101803*   TRANSFER.  ADDED CALL TO DPKUTO41 TO DETERMINE DUMMY UPC.             
101803*   REMOVED OLD COMMENTED CODE AND ADDED COMMENTED CODE FOR THE           
101803*   LATEST CHANGES.                                                       
101803******************************************************************        
111703* 11/17/2003 - RAY GRAF                                                   
111703*   SORT1/SORT2 TRANSFER TYPES.                                           
111703*     REJECT SORT1 ITEMS FOR DEF/DAM SORT 2 TRANSFER TYPE                 
111703*     REJECT SORT2 ITEMS FOR DEF/DAM SORT 1 TRANSFER TYPE                 
111703*     REJECT DEPT 127 AND 427 FOR EITHER DEF/DAM TRANSFER TYPE            
111703*         WHEN THE 'TO' STORE IS 811 (FINDLAY)                            
111703******************************************************************        
080204**DATE:08/02/2004 CHANGED BY: RAY GRAF                                    
080204**     CHANGE PRINTER DESTINATION TO NEW 8 CHARACTER FORMAT               
      *****************************************************************         
100404** 10/04/2004 CHANGED BY: RAY GRAF                                        
100404**     EXPAND STORE NUMBER. MAKE DOMAIN COMPLIANT.                        
      *****************************************************************         
010306** 01/03/2006 CHANGED BY: RAY GRAF                                        
010306**     IGNORE CMPT_XFER_BEG_TMST WHEN QUERYING ON TRANSFER.               
010306**     INTERROGATE CMPT_XFER_END_TMST INSTEAD.                            
      *****************************************************************         
022212** 02/22/2012 CHANGED BY: CHERI PARMLEY      PRJ#3403                     
022212**     COMPILE DUE TO CHANGES TO TTFITEM AND TTFITRC TABLES               
      *****************************************************************         
      * DATE:        09/24/2021                                                 
      * WR/IR#:      CHG0261678                                                 
      * PROGRAMMER:  GERMAN BANDA                                               
      * DESCRIPTION: CHANGE CALL OF DPKUT100 TO                                 
      *              CALL DP010I-NUMERIC-EDIT-ROUTINE                           
      *              MAKING THE CALL DYNAMIC VS STATIC                          
      *----------------------------------------------------------------*        
CICS  * CHANGED 11/16/2022    BY JIM HUNTER      WR: CHG0278345                 
CICS  * ADD COPYBOOK DPWS930 AND MAKE THE CICS ARCHITECTURE CALL                
CICS  * DYNAMIC INSTEAD OF STATIC BY CALLING DP930-CICS-ARCH-API.               
CICS  *-----------------------------------------------------------------        
      * CHANGED 02/14/2023    BY JEAN KURK       WR: CHG0281369                 
      *   CHANGE CALL OF UPC CHECK DIGIT ROUTINE TO DYNAMIC                     
      *-----------------------------------------------------------------        
       EJECT                                                            00550099
       ENVIRONMENT DIVISION.                                            00560099
                                                                        00570099
       DATA DIVISION.                                                   00580099
                                                                        00590099
       WORKING-STORAGE SECTION.                                         00590199
                                                                        00590200
       01  DK-DB2-KEYS.                                                 00590300
           05  DK-XFER-DKEY-ID          PIC S9(09)  COMP  VALUE +0.     00590407
                                                                        00590599
       01  PC-PROGRAM-CONSTANTS.                                        00590699
           05  PC-ITEM-NUMBER-LENGTH          PIC S9(04)  VALUE +5      00590799
                                                          COMP SYNC.    00590899
           05  PC-ITEMS-PER-PANEL             PIC S9(04)  VALUE +14     00590999
                                                          COMP SYNC.    00591099
           05  PC-MAX-BLOCKS-IN-ARRAY         PIC S9(04)  VALUE +2      00592099
                                                          COMP SYNC.    00592199
           05  PC-LEAVE-SYSTEM-LENGTH         PIC S9(04)  VALUE +160    00592212
                                                          COMP SYNC.    00592312
           05  PC-1                           PIC S9(03)  VALUE +1      00592499
                                                          COMP-3.       00592599
           05  PC-APOSTROPHE                  PIC  X(01)  VALUE X'7D'.  00592699
           05  PC-CRIT-SPEC-FORMAT            PIC  X(01)  VALUE '1'.    00592799
           05  PC-CURRENT-MAP-NAME            PIC  X(08)  VALUE         00592899
                                                          'TF421A  '.   00592999
           05  PC-CURRENT-MAPSET-NAME         PIC  X(08)  VALUE         00593099
                                                          'TFKM421 '.   00594099
           05  PC-CURRENT-PROGRAM-NAME        PIC  X(08)  VALUE         00595099
                                                          'TFKCS421'.   00596099
           05  PC-DOUBLE-SPACE                PIC  X(01)  VALUE '0'.    00597099
           05  PC-ERR                         PIC  X(03)  VALUE 'ERR'.  00598099
           05  PC-EQUAL                       PIC  X(02)  VALUE ' ='.   00599099
           05  PC-INIT                        PIC  X(04)  VALUE 'INIT'. 00600099
           05  PC-INQ                         PIC  X(03)  VALUE 'INQ'.  00610099
           05  PC-LINE-MAX                    PIC S9(03)  VALUE +60.    00620099
           05  PC-LIST-QUEUE-SEQ              PIC  9(01)  VALUE 1.      00630099
           05  PC-MAX-ITEMS                   PIC S9(09)  VALUE         00640099
                                                          +10000        00650099
                                                          COMP-3.       00660099
           05  PC-MAX-RETRIES                 PIC S9(03)  VALUE +3      00670099
                                                          COMP-3.       00680099
           05  PC-MAX-TYPES                   PIC S9(03)  VALUE +9      00690099
                                                          COMP-3.       00700099
           05  PC-NOT-EQUAL                   PIC  X(02)  VALUE '^='.   00710099
           05  PC-POS-RECEIVED-STATUS         PIC  X(02)  VALUE 'PR'.   00720099
           05  PC-INTERMEDIATE-STATUS         PIC  X(02)  VALUE 'IR'.   00720099
           05  PC-NO-DTL-CHK-STATUS           PIC  X(02)  VALUE 'RN'.   00730099
           05  PC-DTL-CHK-STATUS              PIC  X(02)  VALUE 'RC'.   00740099
           05  PC-RECEIVED                    PIC  X(03)  VALUE 'REC'.  00750099
           05  PC-PUT                         PIC  X(04)  VALUE 'PUT'.  00760099
           05  PC-SEL-QUEUE-SEQ               PIC  9(01)  VALUE 2.      00770099
           05  PC-SINGLE-SPACE                PIC  X(01)  VALUE ' '.    00780099
           05  PC-TERM                        PIC  X(04)  VALUE 'TERM'. 00790099
           05  PC-TOP-OF-PAGE                 PIC  X(01)  VALUE '1'.    00800099
           05  PC-VOID-STATUS                 PIC  X(02)  VALUE  'VD'.  00810099
           05  PC-ASSUMPTIVE-STATUS           PIC  X(02)  VALUE  'AR'.  00820099
           05  PC-COMPLETE-STATUS             PIC  X(02)  VALUE  'CM'.  00820099
      *                                                                 00830099
           05  PC-TSYMSG-NUMBERS.                                       00840099
               10  PC-TSYMSG-00005            PIC  9(05)  VALUE 00005.  00850099
               10  PC-TSYMSG-00008            PIC  9(05)  VALUE 00008.  00860099
               10  PC-TSYMSG-00017            PIC  9(05)  VALUE 00017.  00870099
               10  PC-TSYMSG-00047            PIC  9(05)  VALUE 00047.  00880099
               10  PC-TSYMSG-00050            PIC  9(05)  VALUE 00050.  00890099
               10  PC-TSYMSG-00051            PIC  9(05)  VALUE 00051.  00900099
               10  PC-TSYMSG-00052            PIC  9(05)  VALUE 00052.  00910099
               10  PC-TSYMSG-00053            PIC  9(05)  VALUE 00053.  00920099
               10  PC-TSYMSG-00054            PIC  9(05)  VALUE 00054.  00930099
               10  PC-TSYMSG-00055            PIC  9(05)  VALUE 00055.  00940099
               10  PC-TSYMSG-00057            PIC  9(05)  VALUE 00057.  00950099
               10  PC-TSYMSG-00069            PIC  9(05)  VALUE 00069.  00960099
               10  PC-TSYMSG-00070            PIC  9(05)  VALUE 00070.  00970099
               10  PC-TSYMSG-00098            PIC  9(05)  VALUE 00098.  00980099
               10  PC-TSYMSG-00101            PIC  9(05)  VALUE 00101.  00990099
               10  PC-TSYMSG-00148            PIC  9(05)  VALUE 00148.  01000099
               10  PC-TSYMSG-00279            PIC  9(05)  VALUE 00279.  01010099
               10  PC-TSYMSG-00336            PIC  9(05)  VALUE 00336.  01010099
               10  PC-TSYMSG-00984            PIC  9(05)  VALUE 00984.  01020099
               10  PC-TSYMSG-01399            PIC  9(05)  VALUE 01399.  01030099
               10  PC-TSYMSG-01400            PIC  9(05)  VALUE 01400.  01040099
               10  PC-TSYMSG-01402            PIC  9(05)  VALUE 01402.  01050099
               10  PC-TSYMSG-01403            PIC  9(05)  VALUE 01403.  01060099
               10  PC-TSYMSG-01404            PIC  9(05)  VALUE 01404.  01070099
               10  PC-TSYMSG-01581            PIC  9(05)  VALUE 01581.  01070099
               10  PC-TSYMSG-01583            PIC  9(05)  VALUE 01583.  01070099
               10  PC-TSYMSG-01584            PIC  9(05)  VALUE 01584.  01070099
      *                                                                 01080099
       01  PS-PROGRAM-SWITCHES.                                         01080199
           05  PS-ABEND-IND                   PIC X(01)   VALUE 'N'.    01080212
               88  PS-NO-ABEND-IN-PROGRESS                VALUE 'N'.    01080312
               88  PS-ABEND-IN-PROGRESS                   VALUE 'Y'.    01080412
           05  PS-CURSOR-SW                   PIC  X(01)  VALUE ' '.    01080599
               88  PS-XFER-ALL-CSR                        VALUE 'A'.    01080699
               88  PS-XFER-ITEM-CSR                       VALUE 'I'.    01080799
               88  PS-XFER-LIST-CSR                       VALUE 'L'.    01080899
               88  PS-XFER-RCVR-CSR                       VALUE 'R'.    01080999
           05  PS-ERROR-SW                    PIC  X(01)  VALUE 'Y'.    01081099
               88  PS-NO-ERROR                            VALUE 'Y'.    01082099
               88  PS-ERROR                               VALUE 'N'.    01083099
           05  PS-ERROR-DB2-SW                PIC  X(01)  VALUE 'Y'.    01084099
               88  PS-NO-ERROR-DB2                        VALUE 'Y'.    01085099
               88  PS-ERROR-DB2                           VALUE 'N'.    01086099
           05  PS-COMMAREA-SW                 PIC  X(01)  VALUE 'N'.    01087099
               88  PS-COMMAREA-VALID                      VALUE 'Y'.    01088099
               88  PS-COMMAREA-NOT-VALID                  VALUE 'N'.    01089099
           05  PS-FIRST-FETCH-SW              PIC  X(01)  VALUE 'N'.    01090099
               88  PS-FIRST-FETCH                         VALUE 'Y'.    01100099
               88  PS-NOT-FIRST-FETCH                     VALUE 'N'.    01100199
           05  PS-ITEM-VOIDED-IND             PIC  X(01)  VALUE 'N'.    01100212
               88  PS-ITEM-NOT-VOIDED                     VALUE 'N'.    01100312
               88  PS-ITEM-VOIDED                         VALUE 'Y'.    01100412
           05  PS-RECEIPT-SELECTED-SW         PIC  X(01)  VALUE 'N'.    01100599
               88  PS-RECEIPT-SELECTED                    VALUE 'Y'.    01100699
               88  PS-RECEIPT-NOT-SELECTED                VALUE 'N'.    01100799
           05  PS-XFER-NBR-CHG-IND            PIC  X(01)  VALUE 'N'.    01100812
               88  PS-XFER-NBR-NO-CHG                     VALUE 'N'.    01100912
               88  PS-XFER-NBR-CHG                        VALUE 'Y'.    01101012
           05  PS-UPDATE-SEL-QUEUE-SW         PIC  X(01)  VALUE 'N'.    01101112
               88  PS-NO-UPDATE-SEL-QUEUE                 VALUE 'N'.    01101212
               88  PS-UPDATE-SEL-QUEUE                    VALUE 'Y'.    01101312
      *                                                                 01101499
       01  PV-PROGRAM-VARIABLES.                                        01101599
111703*    05  PV-HOLD-UPC-NBR.                                                 
111703*        10  PV-KOHLS-UPC-DIGITS         PIC X(04).                       
111703*        10  PV-KOHLS-DEPT               PIC X(03).                       
111703*        10  PV-KOHLS-CL.                                                 
111703*            15  PV-KOHLS-CL-1           PIC X(01).                       
111703*            15  PV-KOHLS-CL-2           PIC X(01).                       
111703*        10  PV-KOHLS-CL-9 REDEFINES PV-KOHLS-CL                          
111703*                                        PIC 9(02).                       
111703*        10  PV-KOHLS-DUMMY-SKU          PIC X(03).                       
111703*        10  PV-KOHLS-CHECKDIGIT         PIC X(01).                       
111703*    05  PV-HOLD-UPC-NBR-9 REDEFINES PV-HOLD-UPC-NBR                      
111703*                                        PIC 9(13).                       
           05  PV-ABSTIME                     PIC S9(16)  VALUE +0      01101699
                                                          COMP SYNC.    01101799
           05  PV-ORD-BY-SUB                  PIC S9(04)  VALUE +0      01101899
                                                          COMP SYNC.    01101999
           05  PV-REMAINDER                   PIC S9(04)  VALUE +0      01102099
                                                          COMP SYNC.    01103099
           05  PV-NULL-IND                    PIC S9(04)  VALUE +0              
                                                          COMP SYNC.            
           05  PV-RETRY-COUNTER               PIC S9(04)  VALUE +0      01104099
                                                          COMP SYNC.    01105099
           05  PV-SUB                         PIC S9(04)  VALUE +0      01106099
                                                          COMP SYNC.    01107099
           05  PV-STATUS-TBL-SUB              PIC S9(04)  VALUE +0      01108099
                                                          COMP SYNC.    01109099
           05  PV-WHERE-SUB                   PIC S9(04)  VALUE +0      01110099
                                                          COMP SYNC.    01120099
           05  PV-READ-COUNT                  PIC S9(09)  VALUE +0      01130099
                                                          COMP-3.       01140099
           05  PV-ITEMS-PROCESSED             PIC S9(09)  VALUE +0      01150099
                                                          COMP-3.       01160099
           05  PV-HOLD-SELECTED-ITEMS         PIC S9(09)  VALUE +0      01170099
                                                          COMP-3.       01180099
           05  PV-ITEM-IN-USE                 PIC S9(09)  VALUE +0      01190099
                                                          COMP-3.       01200099
           05  PV-TOP-ITEM                    PIC S9(09)  VALUE +0      01210099
                                                          COMP-3.       01220099
           05  PV-BOTTOM-ITEM                 PIC S9(09)  VALUE +0      01230099
                                                          COMP-3.       01240099
           05  PV-TEMP-BLOCK-NUMBER           PIC S9(09)  VALUE +0      01250099
                                                          COMP-3.       01260099
           05  PV-BLOCK-NUMBER                PIC S9(04)  VALUE +0      01270099
                                                          COMP SYNC.    01280099
           05  PV-CICS-RESP                   PIC S9(04)  VALUE +0      01290099
                                                          COMP SYNC.    01300099
           05  PV-FIRST-BLOCK-IN-ARRAY        PIC S9(04)  VALUE +0      01310099
                                                          COMP SYNC.    01320099
           05  PV-ITEM                        PIC S9(04)  VALUE +0      01330099
                                                          COMP SYNC.    01340099
           05  PV-SEL-QUEUE-ITEM              PIC S9(04)  VALUE +0      01350099
                                                          COMP SYNC.    01360099
           05  PV-SAVE-ITEM                   PIC S9(04)  VALUE +0      01370099
                                                          COMP SYNC.    01380099
           05  PV-HIGHEST-BLOCK-WRITTEN       PIC S9(04)  VALUE +0      01390099
                                                          COMP SYNC.    01400099
           05  PV-LIST-ITEM-NUMBER            PIC S9(04)  VALUE +0      01410099
                                                          COMP SYNC.    01420099
           05  PV-NEXT-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      01430099
                                                          COMP SYNC.    01440099
           05  PV-PREV-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      01450099
                                                          COMP SYNC.    01460099
           05  PV-FIRST-BLOCK-IN-RANGE        PIC S9(04)  VALUE +0      01470099
                                                          COMP SYNC.    01480099
           05  PV-LAST-BLOCK-IN-RANGE         PIC S9(04)  VALUE +0      01490099
                                                          COMP SYNC.    01500099
           05  PV-START-OF-SELECTED-RANGE     PIC S9(04)  VALUE +0      01510099
                                                          COMP SYNC.    01520099
           05  PV-END-OF-SELECTED-RANGE       PIC S9(04)  VALUE +0      01530099
                                                          COMP SYNC.    01540099
           05  PV-SQL-SUB                     PIC S9(04)  VALUE +0      01550099
                                                          COMP SYNC.    01560099
           05  PV-ITEM-TRN-QTY-NULL           PIC S9(04)  VALUE +0      01570099
                                                          COMP SYNC.    01580099
           05  PV-ITEM-REC-QTY-NULL           PIC S9(04)  VALUE +0      01590099
                                                          COMP SYNC.    01600099
           05  PV-ITEM-TRN-RET-NULL           PIC S9(04)  VALUE +0      01610099
                                                          COMP SYNC.    01620099
           05  PV-ITEM-REC-RET-NULL           PIC S9(04)  VALUE +0      01630099
                                                          COMP SYNC.    01640099
           05  PV-RCV-BEG-TMST-NULL           PIC S9(04)  VALUE +0      01650099
                                                          COMP SYNC.    01660099
           05  PV-XFER-SEQ-NBR-NULL           PIC S9(04)  VALUE +0      01670099
                                                          COMP SYNC.    01680099
           05  PV-AREA-7                      PIC X(07)   VALUE SPACES. 01690099
           05  PV-AREA-20                     PIC X(20)   VALUE SPACES. 01700099
           05  PV-DATE-MMDDYR                 PIC  X(10)  VALUE         01710099
                                                          'MM/DD/CCYY'. 01720099
           05  PV-DISPLAY-NUM-6               PIC Z(05)9  VALUE ZERO.   01730099
                                                                                
           05  PV-DISPLAY-DOL-11              PIC Z(7)9.99 VALUE ZEROS. 01740099
           05  PV-ITEM-TRANSFER-QTY           PIC S9(07)  VALUE +0      01750099
                                                          COMP-3.       01760099
           05  PV-ITEM-RECEIVE-QTY            PIC S9(07)  VALUE +0      01770099
                                                          COMP-3.       01780099
           05  PV-ITEM-TRANSFER-RETAIL        PIC S9(9)V99 VALUE +0     01790099
                                                          COMP-3.       01800099
           05  PV-ITEM-RECEIVE-RETAIL         PIC S9(9)V99 VALUE +0     01810099
                                                          COMP-3.       01820099
           05  PV-LINE-COUNT                  PIC S9(03)  VALUE +0.     01830099
           05  PV-PAGE-COUNT                  PIC S9(03)  VALUE +0.     01840099
           05  PV-ORDER-BY-COUNT              PIC  9(02)  VALUE ZERO.   01840199
           05  PV-USER-ID-8.                                            01840212
               10  PV-USER-ID                 PIC  X(07)  VALUE SPACES. 01840312
               10  FILLER                     PIC  X(01)  VALUE 'Q'.    01840412
           05  PV-SYSTEM-ID.                                            01840512
               10  FILLER                     PIC  X(04)  VALUE SPACE.  01840612
               10  PV-REGION-IND              PIC  X(01).               01840712
                   88  PV-TEST-CICS                       VALUE 'T'.    01840812
                   88  PV-QA-CICS                         VALUE 'Q'.    01840912
                   88  PV-PROD-CICS                       VALUE 'P'.    01841012
                   88  PV-LEARN-CICS                      VALUE 'L'.    01841112
               10  FILLER                     PIC  X(01)  VALUE SPACES. 01841212
           05  PV-DISPLAY-XFER-DKEY-ID         PIC  9(09)  VALUE ZEROS.         
                                                                        01841399
      * DATES ARE IN FORMAT YYYY-MM-DD-HH24.MI.SS                       01841499
           05  PV-SHIPT-BEG-DTE               PIC  X(19) VALUE SPACES.  01841599
           05  PV-SHIPT-END-DTE               PIC  X(19) VALUE SPACES.  01841699
                                                                        01841799
           05  PV-DISPL-XFER-NBR.                                       01844099
100404*        10  PV-DISPL-XFER-1-3          PIC 9(3)    VALUE ZERO.   01845099
100404         10  PV-DISPL-XFER-1-4          PIC 9(4)    VALUE ZERO.   01845099
               10  FILLER                     PIC X(1)    VALUE '-'.    01846099
100404*        10  PV-DISPL-XFER-4-9          PIC 9(6)    VALUE ZERO.   01847099
100404         10  PV-DISPL-XFER-5-10         PIC 9(6)    VALUE ZERO.   01847099
                                                                        01848099
           05  PV-XFER-NBR.                                             01849099
100404*        10  PV-XFER-1-3                PIC 9(3)    VALUE ZERO.   01850099
100404         10  PV-XFER-1-4                PIC 9(4)    VALUE ZERO.   01850099
100404*        10  PV-XFER-4-9                PIC 9(6)    VALUE ZERO.   01860099
100404         10  PV-XFER-5-10               PIC 9(6)    VALUE ZERO.   01860099
                                                                        01870099
           05  PV-TRANSFER-TYPE-DESC.                                   01880099
               10  PV-TRANSFER-TYPE-DESC-1    PIC X(18)   VALUE SPACES. 01890099
               10  FILLER                     PIC X(01)   VALUE SPACE.  01900099
               10  PV-TRANSFER-TYPE-DESC-2    PIC X(18)   VALUE SPACES. 01910099
                                                                        01920099
           05  PV-XFER-TYPE-TBL.                                        01930099
               10  PV-XFER-TYPE-DESC OCCURS 9 TIMES.                    01940099
                   15  PV-XFER-TYPE-DESC-1    PIC X(18).                01950099
                   15  PV-XFER-TYPE-DESC-2    PIC X(18).                01960099
                   15  PV-XFER-TYPE-LINE-DESC PIC X(18).                01970099
                                                                        01980099
       01  TYPE-STATUS-FIELD.                                           01990099
           05  TYPE-ST-FIELD-CODE      PIC X(1)     VALUE SPACE.        02000099
           05  FILLER                  PIC X(1)     VALUE '-'.          02010099
           05  TYPE-ST-FIELD-DESC      PIC X(20)    VALUE SPACES.       02020099
                                                                        02030099
      *---------------------------------------------------------------* 02040099
      *  WORKING STORAGE AREA USED TO BUILD SQL STATEMENTS            * 02050099
      *---------------------------------------------------------------* 02060099
                                                                        02070099
       01  PV-SQL-STMT.                                                 02080099
           49  PV-SQL-STMT-LEN                PIC S9(04)  COMP  VALUE 0.02090099
      *  SELECT LENGTH PLUS WHERE LENGTH PLUS ORDER BY LENGTH           02100099
           49  PV-SQL-STMT-TEXT               PIC X(2096) VALUE SPACES. 02110099
                                                                        02120099
       01  PV-BUILD-XFER-LIST-SELECT.                                   02130099
           05  PV-BUILD-XFER-LIST-LEN         PIC S9(04) COMP VALUE +0. 02140099
           05  PV-XFER-LIST-SELECT-BYTES      PIC S9(04) COMP VALUE 413.02150099
      *    05  PV-XFER-LIST-SELECT-BYTES      PIC S9(04) COMP VALUE 441.02160099
      *         INCLUDES SELECT LENGTH, FROM LENGTH, AND PARTIAL WHERE  02170099
      *         LENGTH.                                                 02180099
           05  PV-BUILD-XFER-LIST-SEL-STMT.                             02190099
               10  FILLER                     PIC  X(07)                02200099
                               VALUE 'SELECT '.                         02210099
               10  FILLER                     PIC  X(16)                02220099
                               VALUE ' A.XFER_DKEY_ID '.                02230099
               10  FILLER                     PIC  X(16)                02240099
                               VALUE ',A.XFER_TYP_CDE '.                02250099
               10  FILLER                     PIC  X(14)                02260099
                               VALUE ',A.FR_STR_NBR '.                  02270099
               10  FILLER                     PIC  X(16)                02280099
                               VALUE ',A.XFER_SEQ_NBR '.                02290099
               10  FILLER                     PIC  X(14)                02300099
                               VALUE ',A.TO_STR_NBR '.                  02310099
               10  FILLER                     PIC  X(12)                02320099
                               VALUE ',A.CLBK_NBR '.                    02330099
               10  FILLER                     PIC  X(20)                02340099
                               VALUE ',A.STK_BAL_APVL_NBR '.            02350099
               10  FILLER                     PIC  X(20)                02360099
                               VALUE ',A.ATTN_INIT_1ST_NM '.            02370099
               10  FILLER                     PIC  X(16)                02380099
                               VALUE ',A.ATTN_LAST_NM '.                02390099
               10  FILLER                     PIC  X(22)                02400099
                               VALUE ',A.CMPT_XFER_BEG_TMST '.          02410099
               10  FILLER                     PIC  X(22)                02420099
                               VALUE ',A.CMPT_XFER_END_TMST '.          02430099
               10  FILLER                     PIC  X(17)                02440099
                               VALUE ',B.XFER_STAT_CDE '.               02450099
               10  FILLER                     PIC  X(06)                02460099
                                         VALUE 'FROM  '.                02470099
               10  FILLER                     PIC  X(03)                02480099
                                         VALUE 'DB2'.                   02490099
               10  PV-BUILD-QUAL-XL1          PIC  X(01).               02500099
               10  FILLER                     PIC  X(03)                02510099
                                         VALUE 'DBA'.                   02520099
               10  FILLER                     PIC  X(11)                02530099
                                         VALUE '.TTFMSTR A '.           02540099
               10  FILLER                     PIC  X(04)                02550099
                                         VALUE ',DB2'.                  02560099
               10  PV-BUILD-QUAL-XL2          PIC  X(01).               02570099
               10  FILLER                     PIC  X(03)                02580099
                                         VALUE 'DBA'.                   02590099
               10  FILLER                     PIC  X(11)                02600099
                                         VALUE '.TTFSTAT B '.           02610099
               10  FILLER                     PIC  X(06)                02620099
                                         VALUE 'WHERE '.                02630099
               10  FILLER                     PIC  X(32)                02640099
                     VALUE 'B.XFER_DKEY_ID = A.XFER_DKEY_ID '.          02650099
               10  FILLER                     PIC  X(04)                02660099
                                         VALUE 'AND '.                  02670099
      *        10  FILLER                     PIC  X(19)                02680099
      *              VALUE 'B.XFER_STAT_CDE ^= '.                       02690099
      *        10  FILLER                     PIC  X(01)  VALUE X'7D'.  02700099
      *        10  FILLER                     PIC  X(02)  VALUE 'VD'.   02710099
      *        10  FILLER                     PIC  X(01)  VALUE X'7D'.  02720099
      *        10  FILLER                     PIC  X(05)                02730099
      *                                  VALUE ' AND '.                 02740099
               10  FILLER                     PIC  X(19)                02750099
                     VALUE 'B.XFER_STAT_TMST = '.                       02760099
               10  FILLER                     PIC  X(32)                02770099
                     VALUE '(SELECT MAX (ST.XFER_STAT_TMST) '.          02780099
               10  FILLER                     PIC  X(09)                02790099
                                         VALUE 'FROM  DB2'.             02800099
               10  PV-BUILD-QUAL-XL3          PIC  X(01).               02810099
               10  FILLER                     PIC  X(15)                02820099
                                         VALUE 'DBA.TTFSTAT ST '.       02830099
               10  FILLER                     PIC  X(40)                02840099
                     VALUE 'WHERE ST.XFER_DKEY_ID = B.XFER_DKEY_ID) '.  02850099
               10  PVBLDSQL-XFER-LIST-WH-ORD  PIC  X(894) VALUE SPACES. 02860099
                                                                        02870099
       01  PV-BUILD-XFER-ITEM-SELECT.                                   02880099
           05  PV-BUILD-XFER-ITEM-LEN         PIC S9(04) COMP VALUE +0. 02890099
           05  PV-XFER-ITEM-SELECT-BYTES      PIC S9(04) COMP VALUE 569.02900099
      *    05  PV-XFER-ITEM-SELECT-BYTES      PIC S9(04) COMP VALUE 505.02910099
      *         INCLUDES SELECT LENGTH, FROM LENGTH, AND PARTIAL WHERE  02920099
      *         LENGTH.                                                 02930099
           05  PV-BUILD-XFER-ITEM-SEL-STMT.                             02940099
               10  FILLER                     PIC  X(16)                02950099
                               VALUE 'SELECT DISTINCT '.                02960099
               10  FILLER                     PIC  X(16)                02970099
                               VALUE ' A.XFER_DKEY_ID '.                02980099
               10  FILLER                     PIC  X(16)                02990099
                               VALUE ',A.XFER_TYP_CDE '.                03000099
               10  FILLER                     PIC  X(14)                03010099
                               VALUE ',A.FR_STR_NBR '.                  03020099
               10  FILLER                     PIC  X(16)                03030099
                               VALUE ',A.XFER_SEQ_NBR '.                03040099
               10  FILLER                     PIC  X(14)                03050099
                               VALUE ',A.TO_STR_NBR '.                  03060099
               10  FILLER                     PIC  X(12)                03070099
                               VALUE ',A.CLBK_NBR '.                    03080099
               10  FILLER                     PIC  X(20)                03090099
                               VALUE ',A.STK_BAL_APVL_NBR '.            03100099
               10  FILLER                     PIC  X(20)                03110099
                               VALUE ',A.ATTN_INIT_1ST_NM '.            03120099
               10  FILLER                     PIC  X(16)                03130099
                               VALUE ',A.ATTN_LAST_NM '.                03140099
               10  FILLER                     PIC  X(22)                03150099
                               VALUE ',A.CMPT_XFER_BEG_TMST '.          03160099
               10  FILLER                     PIC  X(22)                03170099
                               VALUE ',A.CMPT_XFER_END_TMST '.          03180099
               10  FILLER                     PIC  X(17)                03190099
                               VALUE ',B.XFER_STAT_CDE '.               03200099
               10  FILLER                     PIC  X(06)                03210099
                                         VALUE 'FROM  '.                03220099
               10  FILLER                     PIC  X(03)                03230099
                                         VALUE 'DB2'.                   03240099
               10  PV-BUILD-QUAL-XI1          PIC  X(01).               03250099
               10  FILLER                     PIC  X(03)                03260099
                                         VALUE 'DBA'.                   03270099
               10  FILLER                     PIC  X(11)                03280099
                                         VALUE '.TTFMSTR A '.           03290099
               10  FILLER                     PIC  X(04)                03300099
                                         VALUE ',DB2'.                  03310099
               10  PV-BUILD-QUAL-XI2          PIC  X(01).               03320099
               10  FILLER                     PIC  X(03)                03330099
                                         VALUE 'DBA'.                   03340099
               10  FILLER                     PIC  X(11)                03350099
                                         VALUE '.TTFSTAT B '.           03360099
               10  FILLER                     PIC  X(04)                03370099
                                         VALUE ',DB2'.                  03380099
               10  PV-BUILD-QUAL-XI3          PIC  X(01).               03390099
               10  FILLER                     PIC  X(03)                03400099
                                         VALUE 'DBA'.                   03410099
               10  FILLER                     PIC  X(11)                03420099
                                         VALUE '.TTFITEM C '.           03430099
               10  PV-BUILD-TSKXREF-DB2       PIC  X(04)                03370099
                                         VALUE ',DB2'.                  03380099
               10  PV-BUILD-QUAL-XI3A         PIC  X(01).               03390099
               10  PV-BUILD-TSKXREF-DBA       PIC  X(03)                03400099
                                         VALUE 'DBA'.                   03410099
               10  PV-BUILD-TSKXREF-TABLE     PIC  X(11)                03420099
                                         VALUE '.TSKXREF E '.           03430099
101803         10  PV-BUILD-XSTUPC-DB2        PIC  X(04)                        
101803                                   VALUE ',DB2'.                          
101803         10  PV-BUILD-QUAL-XI3B         PIC  X(01).                       
101803         10  PV-BUILD-XSTUPC-DBA        PIC  X(03)                        
101803                                   VALUE 'DBA'.                           
101803         10  PV-BUILD-XSTUPC-TABLE      PIC  X(11)                        
101803                                   VALUE '.XST_UPC U '.                   
               10  FILLER                     PIC  X(06)                03440099
                                         VALUE 'WHERE '.                03450099
               10  FILLER                     PIC  X(32)                03460099
                     VALUE 'B.XFER_DKEY_ID = A.XFER_DKEY_ID '.          03470099
               10  FILLER                     PIC  X(04)                03480099
                                         VALUE 'AND '.                  03490099
               10  FILLER                     PIC  X(32)                03500099
                     VALUE 'C.XFER_DKEY_ID = A.XFER_DKEY_ID '.          03510099
               10  PV-BUILD-TSKXREF-AND       PIC  X(04)                03480099
                                         VALUE 'AND '.                  03490099
               10  PV-BUILD-TSKXREF-TTFITEM-LINK PIC  X(32)             03500099
                     VALUE 'C.ITM_NBR = E.ITM_NBR           '.          03510099
101803         10  FILLER                     PIC  X(04)                03520099
101803                                   VALUE 'AND '.                  03530099
101803         10  FILLER                     PIC  X(32)                        
101803               VALUE 'E.INTR_UPC_ID  = U.INTR_UPC_ID  '.                  
               10  FILLER                     PIC  X(04)                        
                                         VALUE 'AND '.                          
               10  FILLER                     PIC  X(19)                03610099
                     VALUE 'B.XFER_STAT_TMST = '.                       03620099
               10  FILLER                     PIC  X(32)                03630099
                     VALUE '(SELECT MAX (ST.XFER_STAT_TMST) '.          03640099
               10  FILLER                     PIC  X(09)                03650099
                                         VALUE 'FROM  DB2'.             03660099
               10  PV-BUILD-QUAL-XI4          PIC  X(01).               03670099
               10  FILLER                     PIC  X(15)                03680099
                                         VALUE 'DBA.TTFSTAT ST '.       03690099
               10  FILLER                     PIC  X(40)                03700099
                     VALUE 'WHERE ST.XFER_DKEY_ID = B.XFER_DKEY_ID) '.  03710099
               10  PVBLDSQL-XFER-ITEM-WH-ORD  PIC  X(1014) VALUE SPACES.03720099
                                                                        03730099
       01  PV-BUILD-XFER-RCVR-SELECT.                                   03740099
           05  PV-BUILD-XFER-RCVR-LEN         PIC S9(04) COMP VALUE +0. 03750099
           05  PV-XFER-RCVR-SELECT-BYTES      PIC S9(04) COMP VALUE 636.03760099
      *    05  PV-XFER-RCVR-SELECT-BYTES      PIC S9(04) COMP VALUE 664.03770099
      *         INCLUDES SELECT LENGTH, FROM LENGTH, AND PARTIAL WHERE  03780099
      *         LENGTH.                                                 03790099
           05  PV-BUILD-XFER-RCVR-SEL-STMT.                             03800099
               10  FILLER                     PIC  X(07)                03810099
                               VALUE 'SELECT '.                         03820099
               10  FILLER                     PIC  X(16)                03830099
                               VALUE ' A.XFER_DKEY_ID '.                03840099
               10  FILLER                     PIC  X(16)                03850099
                               VALUE ',A.XFER_TYP_CDE '.                03860099
               10  FILLER                     PIC  X(14)                03870099
                               VALUE ',A.FR_STR_NBR '.                  03880099
               10  FILLER                     PIC  X(16)                03890099
                               VALUE ',A.XFER_SEQ_NBR '.                03900099
               10  FILLER                     PIC  X(14)                03910099
                               VALUE ',A.TO_STR_NBR '.                  03920099
               10  FILLER                     PIC  X(12)                03930099
                               VALUE ',A.CLBK_NBR '.                    03940099
               10  FILLER                     PIC  X(20)                03950099
                               VALUE ',A.STK_BAL_APVL_NBR '.            03960099
               10  FILLER                     PIC  X(20)                03970099
                               VALUE ',A.ATTN_INIT_1ST_NM '.            03980099
               10  FILLER                     PIC  X(16)                03990099
                               VALUE ',A.ATTN_LAST_NM '.                04000099
               10  FILLER                     PIC  X(22)                04010099
                               VALUE ',A.CMPT_XFER_BEG_TMST '.          04020099
               10  FILLER                     PIC  X(22)                04030099
                               VALUE ',A.CMPT_XFER_END_TMST '.          04040099
               10  FILLER                     PIC  X(17)                04050099
                               VALUE ',B.XFER_STAT_CDE '.               04060099
               10  FILLER                     PIC  X(21)                04070099
                               VALUE ',D.RCV_XFER_BEG_TMST '.           04080099
               10  FILLER                     PIC  X(21)                04090099
                               VALUE ',D.RCV_XFER_END_TMST '.           04100099
               10  FILLER                     PIC  X(06)                04110099
                                         VALUE 'FROM  '.                04120099
               10  FILLER                     PIC  X(03)                04130099
                                         VALUE 'DB2'.                   04140099
               10  PV-BUILD-QUAL-XR1          PIC  X(01).               04150099
               10  FILLER                     PIC  X(03)                04160099
                                         VALUE 'DBA'.                   04170099
               10  FILLER                     PIC  X(11)                04180099
                                         VALUE '.TTFMSTR A '.           04190099
               10  FILLER                     PIC  X(04)                04200099
                                         VALUE ',DB2'.                  04210099
               10  PV-BUILD-QUAL-XR2          PIC  X(01).               04220099
               10  FILLER                     PIC  X(03)                04230099
                                         VALUE 'DBA'.                   04240099
               10  FILLER                     PIC  X(11)                04250099
                                         VALUE '.TTFSTAT B '.           04260099
               10  FILLER                     PIC  X(04)                04270099
                                         VALUE ',DB2'.                  04280099
               10  PV-BUILD-QUAL-XR3          PIC  X(01).               04290099
               10  FILLER                     PIC  X(03)                04300099
                                         VALUE 'DBA'.                   04310099
               10  FILLER                     PIC  X(11)                04320099
                                         VALUE '.TTFRCPT D '.           04330099
               10  FILLER                     PIC  X(06)                04340099
                                         VALUE 'WHERE '.                04350099
               10  FILLER                     PIC  X(32)                04360099
                     VALUE 'B.XFER_DKEY_ID = A.XFER_DKEY_ID '.          04370099
               10  FILLER                     PIC  X(04)                04380099
                                         VALUE 'AND '.                  04390099
               10  FILLER                     PIC  X(32)                04400099
                     VALUE 'D.XFER_DKEY_ID = A.XFER_DKEY_ID '.          04410099
               10  FILLER                     PIC  X(04)                04420099
                                         VALUE 'AND '.                  04430099
      *        10  FILLER                     PIC  X(19)                04440099
      *              VALUE 'B.XFER_STAT_CDE ^= '.                       04450099
      *        10  FILLER                     PIC  X(01)  VALUE X'7D'.  04460099
      *        10  FILLER                     PIC  X(02)  VALUE 'VD'.   04470099
      *        10  FILLER                     PIC  X(01)  VALUE X'7D'.  04480099
      *        10  FILLER                     PIC  X(05)                04490099
      *                                  VALUE ' AND '.                 04500099
               10  FILLER                     PIC  X(19)                04510099
                     VALUE 'B.XFER_STAT_TMST = '.                       04520099
               10  FILLER                     PIC  X(32)                04530099
                     VALUE '(SELECT MAX (ST.XFER_STAT_TMST) '.          04540099
               10  FILLER                     PIC  X(09)                04550099
                                         VALUE 'FROM  DB2'.             04560099
               10  PV-BUILD-QUAL-XR4          PIC  X(01).               04570099
               10  FILLER                     PIC  X(15)                04580099
                                         VALUE 'DBA.TTFSTAT ST '.       04590099
               10  FILLER                     PIC  X(40)                04600099
                     VALUE 'WHERE ST.XFER_DKEY_ID = B.XFER_DKEY_ID) '.  04610099
               10  FILLER                     PIC  X(04)                04620099
                                         VALUE 'AND '.                  04630099
               10  FILLER                     PIC  X(22)                04640099
                     VALUE 'D.RCV_XFER_BEG_TMST = '.                    04650099
               10  FILLER                     PIC  X(35)                04660099
                     VALUE '(SELECT MAX (RC.RCV_XFER_BEG_TMST) '.       04670099
               10  FILLER                     PIC  X(09)                04680099
                                         VALUE 'FROM  DB2'.             04690099
               10  PV-BUILD-QUAL-XR5          PIC  X(01).               04700099
               10  FILLER                     PIC  X(15)                04710099
                                         VALUE 'DBA.TTFRCPT RC '.       04720099
               10  FILLER                     PIC  X(40)                04730099
                     VALUE 'WHERE RC.XFER_DKEY_ID = D.XFER_DKEY_ID) '.  04740099
               10  PVBLDSQL-XFER-RCVR-WH-ORD  PIC  X(1134) VALUE SPACES.04750099
                                                                        04760099
       01  PV-BUILD-XFER-ALL-SELECT.                                    04770099
           05  PV-BUILD-XFER-ALL-LEN          PIC S9(04) COMP VALUE +0. 04780099
           05  PV-XFER-ALL-SELECT-BYTES       PIC S9(04) COMP VALUE 755.04790099
      *    05  PV-XFER-ALL-SELECT-BYTES       PIC S9(04) COMP VALUE 728.04800099
      *         INCLUDES SELECT LENGTH, FROM LENGTH, AND PARTIAL WHERE  04810099
      *         LENGTH.                                                 04820099
           05  PV-BUILD-XFER-ALL-SEL-STMT.                              04830099
               10  FILLER                     PIC  X(16)                04840099
                               VALUE 'SELECT DISTINCT '.                04850099
               10  FILLER                     PIC  X(16)                04860099
                               VALUE ' A.XFER_DKEY_ID '.                04870099
               10  FILLER                     PIC  X(16)                04880099
                               VALUE ',A.XFER_TYP_CDE '.                04890099
               10  FILLER                     PIC  X(14)                04900099
                               VALUE ',A.FR_STR_NBR '.                  04910099
               10  FILLER                     PIC  X(16)                04920099
                               VALUE ',A.XFER_SEQ_NBR '.                04930099
               10  FILLER                     PIC  X(14)                04940099
                               VALUE ',A.TO_STR_NBR '.                  04950099
               10  FILLER                     PIC  X(12)                04960099
                               VALUE ',A.CLBK_NBR '.                    04970099
               10  FILLER                     PIC  X(20)                04980099
                               VALUE ',A.STK_BAL_APVL_NBR '.            04990099
               10  FILLER                     PIC  X(20)                05000099
                               VALUE ',A.ATTN_INIT_1ST_NM '.            05010099
               10  FILLER                     PIC  X(16)                05020099
                               VALUE ',A.ATTN_LAST_NM '.                05030099
               10  FILLER                     PIC  X(22)                05040099
                               VALUE ',A.CMPT_XFER_BEG_TMST '.          05050099
               10  FILLER                     PIC  X(22)                05060099
                               VALUE ',A.CMPT_XFER_END_TMST '.          05070099
               10  FILLER                     PIC  X(17)                05080099
                               VALUE ',B.XFER_STAT_CDE '.               05090099
               10  FILLER                     PIC  X(21)                05100099
                               VALUE ',D.RCV_XFER_BEG_TMST '.           05110099
               10  FILLER                     PIC  X(21)                05120099
                               VALUE ',D.RCV_XFER_END_TMST '.           05130099
               10  FILLER                     PIC  X(06)                05140099
                                         VALUE 'FROM  '.                05150099
               10  FILLER                     PIC  X(03)                05160099
                                         VALUE 'DB2'.                   05170099
               10  PV-BUILD-QUAL-XA1          PIC  X(01).               05180099
               10  FILLER                     PIC  X(03)                05190099
                                         VALUE 'DBA'.                   05200099
               10  FILLER                     PIC  X(11)                05210099
                                         VALUE '.TTFMSTR A '.           05220099
               10  FILLER                     PIC  X(04)                05230099
                                         VALUE ',DB2'.                  05240099
               10  PV-BUILD-QUAL-XA2          PIC  X(01).               05250099
               10  FILLER                     PIC  X(03)                05260099
                                         VALUE 'DBA'.                   05270099
               10  FILLER                     PIC  X(11)                05280099
                                         VALUE '.TTFSTAT B '.           05290099
               10  FILLER                     PIC  X(04)                05300099
                                         VALUE ',DB2'.                  05310099
               10  PV-BUILD-QUAL-XA3          PIC  X(01).               05320099
               10  FILLER                     PIC  X(03)                05330099
                                         VALUE 'DBA'.                   05340099
               10  FILLER                     PIC  X(11)                05350099
                                         VALUE '.TTFITEM C '.           05360099
               10  FILLER                     PIC  X(04)                05370099
                                         VALUE ',DB2'.                  05380099
               10  PV-BUILD-QUAL-XA4          PIC  X(01).               05390099
               10  FILLER                     PIC  X(03)                05400099
                                         VALUE 'DBA'.                   05410099
               10  FILLER                     PIC  X(11)                05420099
                                         VALUE '.TTFRCPT D '.           05430099
               10  FILLER                     PIC  X(04)                05370099
                                         VALUE ',DB2'.                  05380099
               10  PV-BUILD-QUAL-XA4A         PIC  X(01).               05390099
               10  FILLER                     PIC  X(03)                05400099
                                         VALUE 'DBA'.                   05410099
               10  FILLER                     PIC  X(11)                05420099
                                         VALUE '.TSKXREF E '.           05430099
101803         10  FILLER                     PIC  X(04)                        
101803                                   VALUE ',DB2'.                          
101803         10  PV-BUILD-QUAL-XA4B         PIC  X(01).                       
101803         10  FILLER                     PIC  X(03)                        
101803                                   VALUE 'DBA'.                           
101803         10  FILLER                     PIC  X(11)                        
101803                                   VALUE '.XST_UPC U '.                   
               10  FILLER                     PIC  X(06)                05440099
                                         VALUE 'WHERE '.                05450099
               10  FILLER                     PIC  X(32)                05460099
                     VALUE 'B.XFER_DKEY_ID = A.XFER_DKEY_ID '.          05470099
               10  FILLER                     PIC  X(04)                05480099
                                         VALUE 'AND '.                  05490099
               10  FILLER                     PIC  X(32)                05500099
                     VALUE 'C.XFER_DKEY_ID = A.XFER_DKEY_ID '.          05510099
               10  FILLER                     PIC  X(04)                05520099
                                         VALUE 'AND '.                  05530099
               10  FILLER                     PIC  X(32)                05540099
                     VALUE 'D.XFER_DKEY_ID = A.XFER_DKEY_ID '.          05550099
               10  FILLER                     PIC  X(04)                05560099
                                         VALUE 'AND '.                  05570099
               10  FILLER                     PIC  X(32)                05460099
                     VALUE 'C.ITM_NBR = E.ITM_NBR           '.          05470099
               10  FILLER                     PIC  X(04)                05480099
                                         VALUE 'AND '.                  05490099
101803         10  FILLER                     PIC  X(32)                        
101803               VALUE 'E.INTR_UPC_ID = U.INTR_UPC_ID   '.                  
101803         10  FILLER                     PIC  X(04)                        
101803                                   VALUE 'AND '.                          
               10  FILLER                     PIC  X(19)                05650099
                     VALUE 'B.XFER_STAT_TMST = '.                       05660099
               10  FILLER                     PIC  X(32)                05670099
                     VALUE '(SELECT MAX (ST.XFER_STAT_TMST) '.          05680099
               10  FILLER                     PIC  X(09)                05690099
                                         VALUE 'FROM  DB2'.             05700099
               10  PV-BUILD-QUAL-XA5          PIC  X(01).               05710099
               10  FILLER                     PIC  X(15)                05720099
                                         VALUE 'DBA.TTFSTAT ST '.       05730099
               10  FILLER                     PIC  X(40)                05740099
                     VALUE 'WHERE ST.XFER_DKEY_ID = B.XFER_DKEY_ID) '.  05750099
               10  FILLER                     PIC  X(04)                05760099
                                         VALUE 'AND '.                  05770099
               10  FILLER                     PIC  X(22)                05780099
                     VALUE 'D.RCV_XFER_BEG_TMST = '.                    05790099
               10  FILLER                     PIC  X(35)                05800099
                     VALUE '(SELECT MAX (RC.RCV_XFER_BEG_TMST) '.       05810099
               10  FILLER                     PIC  X(09)                05820099
                                         VALUE 'FROM  DB2'.             05830099
               10  PV-BUILD-QUAL-XA6          PIC  X(01).               05840099
               10  FILLER                     PIC  X(15)                05850099
                                         VALUE 'DBA.TTFRCPT RC '.       05860099
               10  FILLER                     PIC  X(40)                05870099
                     VALUE 'WHERE RC.XFER_DKEY_ID = D.XFER_DKEY_ID) '.  05880099
               10  PVBLDSQL-XFER-ALL-WH-ORD   PIC  X(1254) VALUE SPACES.05890099
                                                                        05900099
       01  PV-WHERE-BYTES                     PIC S9(04)  COMP VALUE 0. 05910099
       01  PV-WHERE-SIZE                      PIC S9(04)  COMP VALUE 75.05920099
       01  PV-ORDER-BY-BYTES                  PIC S9(04)  COMP VALUE 10.05930099
       01  PV-ORDER-BY-SIZE                   PIC S9(04)  COMP VALUE 22.05940099
                                                                        05950099
       01  PV-WHERE-LITERALS.                                           05960099
           05  PV-WHERE-XFER-TYPE.                                      05970099
               10  FILLER                     PIC  X(05)  VALUE ' AND '.05980099
               10  FILLER                     PIC  X(17)                05990099
                                     VALUE 'A.XFER_TYP_CDE = '.         06000099
               10  FILLER                     PIC  X(01)  VALUE X'7D'.  06010099
               10  PV-WH-XFER-TYPE            PIC  X(02)  VALUE SPACES. 06020099
               10  FILLER                     PIC  X(01)  VALUE X'7D'.  06030099
               10  FILLER                     PIC  X(01)  VALUE SPACE.  06040099
           05  PV-WHERE-XFER-STAT-CDE.                                  06050099
               10  FILLER                     PIC  X(04)  VALUE 'AND '. 06060099
               10  FILLER                     PIC  X(16)                06070099
                                     VALUE 'B.XFER_STAT_CDE '.          06080099
               10  PV-WH-XFER-STAT-OP         PIC  X(02)  VALUE SPACES. 06090099
               10  FILLER                     PIC  X(01)  VALUE SPACE.  06100099
               10  FILLER                     PIC  X(01)  VALUE X'7D'.  06110099
               10  PV-WH-XFER-STATUS          PIC  X(02)  VALUE 'PR'.   06120099
               10  FILLER                     PIC  X(01)  VALUE X'7D'.  06130099
               10  FILLER                     PIC  X(01)  VALUE SPACE.  06140099
           05  PV-WHERE-XFER-STAT-NOT-VD.                               06150099
               10  FILLER                     PIC  X(04)  VALUE 'AND '. 06160099
               10  FILLER                     PIC  X(16)                06170099
                                     VALUE 'B.XFER_STAT_CDE '.          06180099
               10  FILLER                     PIC  X(02)  VALUE '^='.   06190099
               10  FILLER                     PIC  X(01)  VALUE SPACE.  06200099
               10  FILLER                     PIC  X(01)  VALUE X'7D'.  06210099
               10  FILLER                     PIC  X(02)  VALUE 'VD'.   06220099
               10  FILLER                     PIC  X(01)  VALUE X'7D'.  06230099
               10  FILLER                     PIC  X(01)  VALUE SPACE.  06240099
           05  PV-WHERE-DTL-CHECK-CDE.                                  06250099
               10  FILLER                     PIC  X(04)  VALUE 'AND '. 06260099
               10  FILLER                     PIC  X(17)                06270099
                                     VALUE 'D.BYP_DTL_CK_IND '.         06280099
               10  PV-WH-DTL-CHECK-OP         PIC  X(02)  VALUE SPACES. 06290099
               10  FILLER                     PIC  X(01)  VALUE SPACE.  06300099
               10  FILLER                     PIC  X(01)  VALUE X'7D'.  06310099
               10  PV-WH-DTL-CHECK            PIC  X(01)  VALUE 'Y'.    06320099
               10  FILLER                     PIC  X(01)  VALUE X'7D'.  06330099
               10  FILLER                     PIC  X(01)  VALUE SPACE.  06340099
           05  PV-WHERE-FROM-STORE.                                     06350099
               10  FILLER                     PIC  X(05)  VALUE ' AND '.06360099
               10  FILLER                     PIC  X(15)                06370099
                                     VALUE 'A.FR_STR_NBR = '.           06380099
100404*        10  PV-WH-FROM-STORE           PIC  9(03)  VALUE ZERO.   06390099
100404         10  PV-WH-FROM-STORE           PIC  9(04)  VALUE ZERO.   06390099
               10  FILLER                     PIC  X(01)  VALUE SPACE.  06400099
           05  PV-WHERE-TO-STORE.                                       06410099
               10  FILLER                     PIC  X(05)  VALUE ' AND '.06420099
               10  FILLER                     PIC  X(15)                06430099
                                     VALUE 'A.TO_STR_NBR = '.           06440099
100404*        10  PV-WH-TO-STORE             PIC  9(03)  VALUE ZERO.   06450099
100404         10  PV-WH-TO-STORE             PIC  9(04)  VALUE ZERO.   06450099
               10  FILLER                     PIC  X(01)  VALUE SPACE.  06460099
                                                                                
           05  PV-WHERE-COMP-BEG-DATE.                                  06470099
               10  FILLER                     PIC  X(05)  VALUE ' AND '.06480099
               10  FILLER                     PIC  X(24)                06490099
010306*              VALUE 'A.CMPT_XFER_BEG_TMST >= '.                  06500099
010306               VALUE 'A.CMPT_XFER_END_TMST >= '.                  06500099
               10  FILLER                     PIC  X(01)  VALUE X'7D'.  06510099
               10  PV-WH-COMP-BEG-YR          PIC  9(04)  VALUE ZERO.   06520099
               10  FILLER                     PIC  X(01)  VALUE '-'.    06530099
               10  PV-WH-COMP-BEG-MM          PIC  9(02)  VALUE ZERO.   06540099
               10  FILLER                     PIC  X(01)  VALUE '-'.    06550099
               10  PV-WH-COMP-BEG-DD          PIC  9(02)  VALUE ZERO.   06560099
               10  PV-WH-COMP-BEG-TIME        PIC  X(16)                06570099
                                              VALUE '-00.00.00.000000'. 06580099
               10  FILLER                     PIC  X(01)  VALUE X'7D'.  06590099
               10  FILLER                     PIC  X(01)  VALUE SPACE.  06600099
           05  PV-WHERE-COMP-END-DATE.                                  06610099
               10  FILLER                     PIC  X(05)  VALUE ' AND '.06620099
               10  FILLER                     PIC  X(24)                06630099
                     VALUE 'A.CMPT_XFER_END_TMST <= '.                  06640099
               10  FILLER                     PIC  X(01)  VALUE X'7D'.  06650099
               10  PV-WH-COMP-END-YR          PIC  9(04)  VALUE ZERO.   06660099
               10  FILLER                     PIC  X(01)  VALUE '-'.    06670099
               10  PV-WH-COMP-END-MM          PIC  9(02)  VALUE ZERO.   06680099
               10  FILLER                     PIC  X(01)  VALUE '-'.    06690099
               10  PV-WH-COMP-END-DD          PIC  9(02)  VALUE ZERO.   06700099
               10  PV-WH-COMP-END-TIME        PIC  X(16)                06710099
                                              VALUE '-23.59.59.999999'. 06720099
               10  FILLER                     PIC  X(01)  VALUE X'7D'.  06730099
               10  FILLER                     PIC  X(01)  VALUE SPACE.  06740099
                                                                                
           05  PV-WHERE-COMP-BEG-VOID-DATE.                             06470099
               10  FILLER                     PIC  X(05)  VALUE ' AND '.06480099
               10  FILLER                     PIC  X(20)                06490099
                     VALUE 'B.XFER_STAT_TMST >= '.                      06500099
               10  FILLER                     PIC  X(01)  VALUE X'7D'.  06510099
               10  PV-WH-COMP-BEG-VOID-YR     PIC  9(04)  VALUE ZERO.   06520099
               10  FILLER                     PIC  X(01)  VALUE '-'.    06530099
               10  PV-WH-COMP-BEG-VOID-MM     PIC  9(02)  VALUE ZERO.   06540099
               10  FILLER                     PIC  X(01)  VALUE '-'.    06550099
               10  PV-WH-COMP-BEG-VOID-DD     PIC  9(02)  VALUE ZERO.   06560099
               10  PV-WH-COMP-BEG-VOID-TIME   PIC  X(16)                06570099
                                              VALUE '-00.00.00.000000'. 06580099
               10  FILLER                     PIC  X(01)  VALUE X'7D'.  06590099
               10  FILLER                     PIC  X(01)  VALUE SPACE.  06600099
           05  PV-WHERE-COMP-END-VOID-DATE.                             06610099
               10  FILLER                     PIC  X(05)  VALUE ' AND '.06620099
               10  FILLER                     PIC  X(20)                06630099
                     VALUE 'B.XFER_STAT_TMST <= '.                      06640099
               10  FILLER                     PIC  X(01)  VALUE X'7D'.  06650099
               10  PV-WH-COMP-END-VOID-YR     PIC  9(04)  VALUE ZERO.   06660099
               10  FILLER                     PIC  X(01)  VALUE '-'.    06670099
               10  PV-WH-COMP-END-VOID-MM     PIC  9(02)  VALUE ZERO.   06680099
               10  FILLER                     PIC  X(01)  VALUE '-'.    06690099
               10  PV-WH-COMP-END-VOID-DD     PIC  9(02)  VALUE ZERO.   06700099
               10  PV-WH-COMP-END-VOID-TIME   PIC  X(16)                06710099
                                              VALUE '-23.59.59.999999'. 06720099
               10  FILLER                     PIC  X(01)  VALUE X'7D'.  06730099
               10  FILLER                     PIC  X(01)  VALUE SPACE.  06740099
                                                                                
           05  PV-WHERE-RECV-BEG-DATE.                                  06750099
               10  FILLER                     PIC  X(05)  VALUE ' AND '.06760099
               10  FILLER                     PIC  X(23)                06770099
                     VALUE 'D.RCV_XFER_BEG_TMST >= '.                   06780099
               10  FILLER                     PIC  X(01)  VALUE X'7D'.  06790099
               10  PV-WH-RECV-BEG-YR          PIC  9(04)  VALUE ZERO.   06800099
               10  FILLER                     PIC  X(01)  VALUE '-'.    06810099
               10  PV-WH-RECV-BEG-MM          PIC  9(02)  VALUE ZERO.   06820099
               10  FILLER                     PIC  X(01)  VALUE '-'.    06830099
               10  PV-WH-RECV-BEG-DD          PIC  9(02)  VALUE ZERO.   06840099
               10  PV-WH-RECV-BEG-TIME        PIC  X(16)                06850099
                                              VALUE '-00.00.00.000000'. 06860099
               10  FILLER                     PIC  X(01)  VALUE X'7D'.  06870099
               10  FILLER                     PIC  X(01)  VALUE SPACE.  06880099
           05  PV-WHERE-RECV-END-DATE.                                  06890099
               10  FILLER                     PIC  X(04)  VALUE 'AND '. 06900099
               10  FILLER                     PIC  X(23)                06910099
                     VALUE 'D.RCV_XFER_END_TMST <= '.                   06920099
               10  FILLER                     PIC  X(01)  VALUE X'7D'.  06930099
               10  PV-WH-RECV-END-YR          PIC  9(04)  VALUE ZERO.   06940099
               10  FILLER                     PIC  X(01)  VALUE '-'.    06950099
               10  PV-WH-RECV-END-MM          PIC  9(02)  VALUE ZERO.   06960099
               10  FILLER                     PIC  X(01)  VALUE '-'.    06970099
               10  PV-WH-RECV-END-DD          PIC  9(02)  VALUE ZERO.   06980099
               10  PV-WH-RECV-END-TIME        PIC  X(16)                06990099
                                              VALUE '-23.59.59.999999'. 07000099
               10  FILLER                     PIC  X(01)  VALUE X'7D'.  07010099
               10  FILLER                     PIC  X(01)  VALUE SPACE.  07020099
           05  PV-WHERE-ITEM-DEPT.                                      07030099
               10  FILLER                     PIC  X(05)  VALUE ' AND '.07040099
               10  FILLER                     PIC  X(09)                07050099
                                     VALUE 'E.DEPT = '.                 07060099
               10  PV-WH-ITEM-DEPT            PIC  9(03)  VALUE ZERO.   07080099
               10  FILLER                     PIC  X(01)  VALUE SPACE.  07100099
           05  PV-WHERE-ITEM-CLASS.                                     07110099
               10  FILLER                     PIC  X(05)  VALUE ' AND '.07120099
               10  FILLER                     PIC  X(10)                07130099
                                     VALUE 'E.CLASS = '.                07140099
               10  PV-WH-ITEM-CLASS           PIC  9(03)  VALUE ZERO.   07160099
               10  FILLER                     PIC  X(01)  VALUE SPACE.  07180099
           05  PV-WHERE-ITEM-SUBCL.                                     07110099
               10  FILLER                     PIC  X(05)  VALUE ' AND '.07120099
               10  FILLER                     PIC  X(13)                07130099
                                     VALUE 'E.SUBCLASS = '.             07140099
               10  PV-WH-ITEM-SUBCL           PIC  9(03)  VALUE ZERO.   07160099
               10  FILLER                     PIC  X(01)  VALUE SPACE.  07180099
101803*    05  PV-WHERE-ITEM-UPC.                                       07030099
101803*        10  FILLER                     PIC  X(05)  VALUE ' AND '.07040099
101803*        10  FILLER                     PIC  X(17)                07050099
101803*                              VALUE '(C.SCN_UPC_NBR = '.         07060099
101803*        10  PV-WH-ITEM-SCN-UPC         PIC  9(13)  VALUE ZERO.   07080099
101803*                                                                         
101803*        10  FILLER                     PIC  X(04)  VALUE ' OR '. 07040099
101803*        10  FILLER                     PIC  X(18)                07050099
101803*                              VALUE 'C.KOHLS_UPC_NBR = '.        07060099
101803*        10  PV-WH-ITEM-KOHLS-UPC       PIC  9(13)  VALUE ZERO.   07080099
101803*        10  FILLER                     PIC  X(01)  VALUE ')'.    07100099
101803*        10  FILLER                     PIC  X(01)  VALUE SPACE.  07100099
                                                                                
101803     05  PV-WHERE-XST-UPC.                                                
101803         10  FILLER                     PIC  X(05)  VALUE ' AND '.        
101803         10  FILLER                     PIC  X(12)                        
101803                               VALUE 'U.UPC_NBR = '.                      
101803         10  PV-WH-ITEM-XST-UPC         PIC  9(13)  VALUE ZERO.           
101803         10  FILLER                     PIC  X(01)  VALUE SPACE.          
                                                                                
           05  PV-WHERE-CALLBACK-NBR.                                   07190099
               10  FILLER                     PIC  X(05)  VALUE ' AND '.07200099
               10  FILLER                     PIC  X(13)                07210099
                                     VALUE 'A.CLBK_NBR = '.             07220099
               10  PV-WH-CALLBACK-NBR         PIC  9(04)  VALUE ZERO.   07230099
               10  FILLER                     PIC  X(01)  VALUE SPACE.  07240099
           05  PV-WHERE-APPROVAL-NBR.                                   07250099
               10  FILLER                     PIC  X(05)  VALUE ' AND '.07260099
               10  FILLER                     PIC  X(21)                07270099
                                     VALUE 'A.STK_BAL_APVL_NBR = '.     07280099
               10  PV-WH-APPROVAL-NBR         PIC  9(09)  VALUE ZERO.   07290099
               10  FILLER                     PIC  X(01)  VALUE SPACE.  07300099
           05  PV-WHERE-COMP-INIT-NM.                                   07310099
               10  FILLER                     PIC  X(05)  VALUE ' AND '.07320099
               10  FILLER                     PIC  X(21)                07330099
                                     VALUE 'A.CPLD_INIT_1ST_NM = '.     07340099
               10  FILLER                     PIC  X(01)  VALUE X'7D'.  07350099
               10  PV-WH-COMP-INIT-NM         PIC  X(01)  VALUE SPACE.  07360099
               10  FILLER                     PIC  X(01)  VALUE X'7D'.  07370099
               10  FILLER                     PIC  X(01)  VALUE SPACE.  07380099
           05  PV-WHERE-COMP-LAST-NM.                                   07390099
               10  FILLER                     PIC  X(05)  VALUE ' AND '.07400099
               10  FILLER                     PIC  X(17)                07410099
                                     VALUE 'A.CPLD_LAST_NM = '.         07420099
               10  FILLER                     PIC  X(01)  VALUE X'7D'.  07430099
               10  PV-WH-COMP-LAST-NM-DELIM   PIC  X(21)  VALUE SPACE.  07440099
               10  FILLER                     PIC  X(01)  VALUE SPACE.  07450099
           05  PV-WHERE-RECV-INIT-NM.                                   07460099
               10  FILLER                     PIC  X(05)  VALUE ' AND '.07470099
               10  FILLER                     PIC  X(21)                07480099
                                     VALUE 'D.RCVR_INIT_1ST_NM = '.     07490099
               10  FILLER                     PIC  X(01)  VALUE X'7D'.  07500099
               10  PV-WH-RECV-INIT-NM         PIC  X(01)  VALUE SPACE.  07510099
               10  FILLER                     PIC  X(01)  VALUE X'7D'.  07520099
               10  FILLER                     PIC  X(01)  VALUE SPACE.  07530099
           05  PV-WHERE-RECV-LAST-NM.                                   07540099
               10  FILLER                     PIC  X(05)  VALUE ' AND '.07550099
               10  FILLER                     PIC  X(17)                07560099
                                     VALUE 'D.RCVR_LAST_NM = '.         07570099
               10  FILLER                     PIC  X(01)  VALUE X'7D'.  07580099
               10  PV-WH-RECV-LAST-NM-DELIM   PIC  X(21)  VALUE SPACE.  07590099
               10  FILLER                     PIC  X(01)  VALUE SPACE.  07600099
                                                                        07610099
       01  PV-WHERE-TABLE.                                              07620099
           05  PV-WHERE-LINE                  PIC  X(75)                07630099
                                              OCCURS 19 TIMES.          07640099
                                                                        07650099
       01  PV-ORDER-BY-FIELDS.                                          07660099
           05  PV-ORDER-BY-XFER-TYPE          PIC  X(14)                07670099
                                     VALUE 'A.XFER_TYP_CDE'.            07680099
           05  PV-ORDER-BY-XFER-STATUS        PIC  X(15)                07690099
                                     VALUE 'B.XFER_STAT_CDE'.           07700099
           05  PV-ORDER-BY-FROM-STORE         PIC  X(12)                07710099
                                     VALUE 'A.FR_STR_NBR'.              07720099
           05  PV-ORDER-BY-XFER-SEQ-NBR       PIC  X(14)                07730099
                                     VALUE 'A.XFER_SEQ_NBR'.            07740099
           05  PV-ORDER-BY-TO-STORE           PIC  X(12)                07750099
                                     VALUE 'A.TO_STR_NBR'.              07760099
           05  PV-ORDER-BY-COMP-BEG-DATE      PIC  X(20)                07770099
                                     VALUE 'A.CMPT_XFER_BEG_TMST'.      07780099
           05  PV-ORDER-BY-COMP-END-DATE      PIC  X(20)                07790099
                                     VALUE 'A.CMPT_XFER_END_TMST'.      07800099
           05  PV-ORDER-BY-RECV-BEG-DATE      PIC  X(19)                07810099
                                     VALUE 'D.RCV_XFER_BEG_TMST'.       07820099
           05  PV-ORDER-BY-RECV-END-DATE      PIC  X(19)                07830099
                                     VALUE 'D.RCV_XFER_END_TMST'.       07840099
           05  PV-ORDER-BY-CALLBACK-NBR       PIC  X(10)                07850099
                                     VALUE 'A.CLBK_NBR'.                07860099
           05  PV-ORDER-BY-APPROVAL-NBR       PIC  X(18)                07870099
                                     VALUE 'A.STK_BAL_APVL_NBR'.        07880099
                                                                        07890099
       01  PV-BUILD-ORDER-BY-COMMAND          PIC  X(10)                07900099
                                              VALUE ' ORDER BY '.       07910099
       01  PV-BUILD-ORDER-BY-COMMA            PIC  X(02)  VALUE ' ,'.   07920099
                                                                        07930099
       01  PV-BUILD-ORDER-BY.                                           07940099
           05  PV-BUILD-ORDER-BY-PREFIX       PIC  X(02)  VALUE SPACES. 07950099
           05  PV-BUILD-ORDER-BY-LITERAL      PIC  X(20)  VALUE SPACES. 07960099
                                                                        07970099
       01  PV-ORDER-BY-TABLE.                                           07980099
           05  PV-ORDER-BY-LINE               PIC  X(22)                07990099
                                              OCCURS 10 TIMES.          08000099
                                                                        08010099
           EJECT                                                        08020099
                                                                                
      ******************************************************************        
      *  RF COPYBOOK TO FORMAT PRINTER DESTINATION                              
      ******************************************************************        
080204     COPY RFWS009.                                                        
                                                                                
      *                                                                 08030099
      *  LAYOUT FOR THE DRS (DYNAMIC REPORT SYSTEM) COMMAREA            08040099
      *                                                                 08050099
           COPY DRRD001O.                                               08060099
                                                                        08070099
      *                                                                 08080099
      *  LAYOUT FOR THE DRS (DYNAMIC REPORT SYSTEM) DETAIL LINES        08090099
      *                                                                 08100099
           COPY DRRD002O.                                               08110099
                                                                                
      *  RECORD STATEMENTS FOR THE PRINT LIST FUNCTION                  08130099
      *                                                                 08140099
           COPY DPWS132O.                                               08150099
                                                                        08160099
       01  HL2-HEADING-LINE-2.                                          08170099
           05  FILLER                          PIC  X(55)  VALUE SPACE. 08180099
           05  FILLER                          PIC  X(30)  VALUE        08190099
               'TRANSFER INQUIRY LIST'.                                 08200099
      *                                                                 08210099
       01  HL3-HEADING-LINE-3.                                          08220099
           05  FILLER                          PIC  X(02)  VALUE SPACE. 08230099
           05  FILLER                          PIC  X(15)  VALUE        08240099
                'TRANSFER TYPE:'.                                       08250099
           05  HL3-XFER-TYPE-DESC              PIC  X(37)  VALUE SPACES.08260099
      *                                                                 08270099
       01  HL4-HEADING-LINE-4.                                          08280099
           05  FILLER                          PIC  X(04)  VALUE SPACE. 08290099
           05  FILLER                          PIC  X(30)  VALUE        08300099
                'TRANSFER'.                                             08310099
           05  FILLER                          PIC  X(10)  VALUE        08320099
                'TRN   REC'.                                            08330099
           05  HL4-MISC-INFO-HDR-1             PIC  X(36)  VALUE SPACES.08340099
      *                                                                 08350099
       01  HL5-HEADING-LINE-5.                                          08360099
           05  FILLER                          PIC  X(04)  VALUE SPACE. 08370099
           05  FILLER                          PIC  X(28)  VALUE        08380099
                'NUMBER       ST  DATE'.                                08390099
           05  FILLER                          PIC  X(11)  VALUE        08400099
                '  QTY   QTY'.                                                  
100404     05  HL5-MISC-INFO-HDR-2             PIC  X(37)  VALUE SPACES.08420099
      *                                                                 08430099
       01  DL-DETAIL-LINE-1.                                            08440099
           05  FILLER                          PIC  X(04)  VALUE SPACE. 08450099
100404*    05  DL1-XFER-NBR                    PIC  X(10)  VALUE SPACE. 08460099
100404     05  DL1-XFER-NBR                    PIC  X(11)  VALUE SPACE. 08460099
           05  FILLER                          PIC  X(01)  VALUE SPACE. 08470099
           05  DL1-STATUS                      PIC  X(03)  VALUE SPACE. 08480099
           05  FILLER                          PIC  X(01)  VALUE SPACE. 08490099
           05  DL1-DATE                        PIC  X(10)  VALUE SPACE. 08500099
           05  FILLER                          PIC  X(01)  VALUE SPACE. 08510099
           05  DL1-TRN-QTY                     PIC  Z(4)9  VALUE ZERO.  08520099
           05  FILLER                          PIC  X(01)  VALUE SPACE. 08530099
           05  DL1-REC-QTY                     PIC  Z(4)9  VALUE ZERO.  08540099
           05  FILLER                          PIC  X(01)  VALUE SPACE. 08550099
100404     05  DL1-MISC                        PIC  X(37)  VALUE SPACE. 08560099
      *                                                                 08570099
       01  RP-TOTALS-LINE.                                              08580099
           05  FILLER                          PIC  X(19)  VALUE SPACE. 08590099
           05  FILLER                          PIC  X(10)  VALUE        08600099
                'TOTALS...'.                                                    
           05  RPTL-TRN-QTY                    PIC  Z(5)9  VALUE ZERO.  08620099
           05  FILLER                          PIC  X(01)  VALUE SPACE. 08630099
           05  RPTL-REC-QTY                    PIC  Z(5)9  VALUE ZERO.  08640099
           05  FILLER                          PIC  X(01)  VALUE SPACE. 08650099
           05  RPTL-XFER-RETAIL                PIC  Z(7)9.99 VALUE ZERO.08660099
           05  FILLER                          PIC  X(01)  VALUE SPACE. 08670099
           05  RPTL-RECV-RETAIL                PIC  Z(7)9.99 VALUE ZERO.08680099
      *                                                                 08690099
       01  BL-BLANK-LINE.                                               08700099
           05  FILLER                          PIC  X(80)  VALUE SPACE. 08710099
      *                                                                 08720099
100404 01  DEFAULT-MISC-HEADER-LINE1           PIC  X(37)  VALUE        08730099
                '  TRNSFER   RECEIVE'.                                  08740099
      *                                                                 08750099
100404 01  CALLBACK-MISC-HEADER-LINE1          PIC  X(37)  VALUE        08760099
                '  TRNSFER   RECEIVE TO  CALLBACK'.                     08770099
      *                                                                 08780099
100404 01  APPROVAL-MISC-HEADER-LINE1          PIC  X(37)  VALUE        08790099
                '  TRNSFER   RECEIVE TO  APPROVAL'.                     08800099
      *                                                                 08810099
100404 01  STORE-MISC-HEADER-LINE1             PIC  X(37)  VALUE        08820099
                '  TRNSFER   RECEIVE TO'.                               08830099
      *                                                                 08840099
100404 01  DEFAULT-MISC-HEADER-LINE2           PIC  X(37)  VALUE        08850099
                '   RETAIL    RETAIL TRANSFER TYPE'.                    08860099
      *                                                                 08870099
100404 01  DEFECTS-MISC-HEADER-LINE2           PIC  X(37)  VALUE        08880099
                '   RETAIL    RETAIL'.                                  08890099
      *                                                                 08900099
100404 01  CALLBACK-MISC-HEADER-LINE2          PIC  X(37)  VALUE        08910099
                '   RETAIL    RETAIL STR  NUMBER'.                      08920099
      *                                                                 08930099
100404 01  APPROVAL-MISC-HEADER-LINE2          PIC  X(37)  VALUE        08940099
                '   RETAIL    RETAIL STR  NUMBER'.                      08950099
      *                                                                 08960099
100404 01  STORE-MISC-HEADER-LINE2             PIC  X(37)  VALUE        08970099
                '   RETAIL    RETAIL STR'.                              08980099
      *                                                                 08990099
100404 01  CUST-MISC-HEADER-LINE2              PIC  X(37)  VALUE        09000099
                'CUSTOMER NAME        PHONE'.                           09010099
      *                                                                 09020099
100404 01  WHSE-MISC-HEADER-LINE2              PIC  X(37)  VALUE        09030099
                'WAREHOUSE NAME       PHONE'.                           09040099
      *                                                                 09050099
100404 01  NON-RETL-MISC-HEADER-LINE2          PIC  X(37)  VALUE        09060099
                'ATTENTION TO'.                                         09070099
      *                                                                 09080099
       01  ML1-MISC-LINE.                                               09090099
           05  ML1-TRANSFER-RETAIL             PIC  Z(5)9.99 VALUE ZERO.09100099
           05  FILLER                          PIC  X(01)  VALUE SPACE. 09110099
           05  ML1-RECEIVE-RETAIL              PIC  Z(5)9.99 VALUE ZERO.09120099
           05  FILLER                          PIC  X(01)  VALUE SPACE. 09130099
           05  ML1-REMAINDER                   PIC  X(18)  VALUE SPACES.09140099
           05  ML1-TO-STORE-REM    REDEFINES ML1-REMAINDER.             09150099
100404*        10  ML1-TO-STORE                PIC  9(03).              09160099
100404         10  ML1-TO-STORE                PIC  9(04).              09160099
100404*        10  ML1-TO-STR-EXTRA            PIC  X(15).              09170099
100404         10  ML1-TO-STR-EXTRA            PIC  X(14).              09170099
      *                                                                 09180099
       01  MISC-REM-CALLBACK-INFO.                                      09190099
           10  FILLER                          PIC  X(03)  VALUE SPACES.09200099
           10  MRCI-CALLBACK-NBR               PIC  Z(03)9 VALUE ZERO.  09210099
           10  FILLER                          PIC  X(08)  VALUE SPACES.09220099
      *                                                                 09230099
       01  MISC-REM-APPROVAL-INFO.                                      09240099
           10  FILLER                          PIC  X(01)  VALUE SPACES.09250099
           10  MRCI-APPROVAL-NBR               PIC  Z(08)9 VALUE ZERO.  09260099
           10  FILLER                          PIC  X(05)  VALUE SPACES.09270099
      *                                                                 09280099
       01  CUST-MISC-LINE.                                              09290099
           05  CUST-ML-NAME                    PIC  X(20)  VALUE SPACES.09300099
           05  FILLER                          PIC  X(01)  VALUE SPACE. 09310099
           05  FILLER                          PIC  X(01)  VALUE '('.   09320099
           05  CUST-ML-PHONE-1-3               PIC  X(03)  VALUE SPACES.09330099
           05  FILLER                          PIC  X(02)  VALUE ')-'.  09340099
           05  CUST-ML-PHONE-4-6               PIC  X(03)  VALUE SPACES.09350099
           05  FILLER                          PIC  X(01)  VALUE '-'.   09360099
           05  CUST-ML-PHONE-7-10              PIC  X(04)  VALUE SPACES.09370099
           05  FILLER                          PIC  X(03)  VALUE SPACES.09380099
      *                                                                 09390099
       01  NON-RETL-MISC-LINE.                                          09400099
           05  NONR-ML-ATTN-INIT-NM            PIC  X(01)  VALUE SPACES.09410099
           05  FILLER                          PIC  X(01)  VALUE SPACE. 09420099
           05  NONR-ML-ATTN-LAST-NM            PIC  X(20)  VALUE SPACES.09430099
           05  FILLER                          PIC  X(16)  VALUE SPACES.09440099
      *                                                                 09450099
      ******************************************************************09460099
      **  THIS IS THE LAYOUT FOR THE LIST ITEMS TEMP STORAGE QUEUE.   **09470099
      **  THIS MUST BE THE EXACT SAME FORMAT AS A BLOCK IN THE        **09480099
      **  APPLICATION-SPECIFIC COMMAREA.                              **09490099
      ******************************************************************09500099
       01  LQW-LIST-QUEUE-WORK-AREA.                                    09510099
           05  LQW-BLOCK-MODIFIED             PIC  X(01)  VALUE SPACE.  09520099
           05  LQW-ITEM-ENTRIES               OCCURS 14 TIMES           09530099
                                              INDEXED BY LQW-IDX.       09540099
               10  LQW-LIST-ITEM-NUMBER       PIC S9(09)  COMP-3.       09550099
               10  LQW-TEMP-SELECTED-SW       PIC  X(01).               09560099
               10  LQW-SELECTED-SW            PIC  X(01).               09570099
                   88  LQW-SELECT                         VALUE 'S'.    09580099
                   88  LQW-DESELECT                       VALUE ' '.    09590099
100404*        10  LQW-TRANSFER-NBR           PIC  X(10).               09600099
100404         10  LQW-TRANSFER-NBR           PIC  X(11).               09600099
               10  LQW-STATUS                 PIC  X(03).               09610099
               10  LQW-DATE                   PIC  X(10).               09620099
               10  LQW-TRN-QTY                PIC S9(05) COMP-3.        09630099
               10  LQW-REC-QTY                PIC S9(05) COMP-3.        09640099
100404*        10  LQW-MISC-INFO              PIC  X(38).               09650099
100404         10  LQW-MISC-INFO              PIC  X(37).               09650099
               10  LQW-XFER-DKEY-ID           PIC S9(09) COMP.          09660099
               10  LQW-DISCREPANCY-SW         PIC  X(01).               09670099
                                                                        09680099
           EJECT                                                        09690099
      *---------------------------------------------------------------* 09700099
      *  RECORD LAYOUT FOR THE TRANSFER SELECTION TEMP STORAGE QUEUE. * 09710099
      *---------------------------------------------------------------* 09720099
                                                                        09730099
           COPY TFWS002.                                                09740099
           EJECT                                                        09750099
      *---------------------------------------------------------------* 09760099
      *    MAP LAYOUT                                                 * 09770099
      *---------------------------------------------------------------* 09780099
                                                                        09790099
           COPY TFKM421.                                                09800099
      *                                                                 09810099
       01  MR-OCCURS-LAYOUT                   REDEFINES  TF421AO.       09820099
100404*    05  FILLER                         PIC X(169).               09830099
100404*>   05  FILLER                         PIC X(165).               09830099
100404     05  FILLER                         PIC X(167).               09830099
           05  MR-SCROLL-AREA                 OCCURS 14 TIMES.          09840099
               10  MR-SELECTL                 PIC S9(04) COMP.          09850099
               10  MR-SELECTA                 PIC  X(01).               09860099
               10  MR-SELECTC                 PIC  X(01).               09870099
               10  MR-SELECTH                 PIC  X(01).               09880099
               10  MR-SELECTI                 PIC  X(01).               09890099
                                                                        09900099
               10  MR-TRANSFER-NBRL           PIC S9(04) COMP.          09910099
               10  MR-TRANSFER-NBRA           PIC  X(01).               09920099
               10  MR-TRANSFER-NBRC           PIC  X(01).               09930099
               10  MR-TRANSFER-NBRH           PIC  X(01).               09940099
100404*        10  MR-TRANSFER-NBR            PIC  X(10).               09950099
100404         10  MR-TRANSFER-NBR            PIC  X(11).               09950099
                                                                        09960099
               10  MR-STATUSL                 PIC S9(04) COMP.          09970099
               10  MR-STATUSA                 PIC  X(01).               09980099
               10  MR-STATUSC                 PIC  X(01).               09990099
               10  MR-STATUSH                 PIC  X(01).               10000099
               10  MR-STATUS                  PIC  X(03).               10010099
                                                                        10020099
               10  MR-DATEL                   PIC S9(04) COMP.          10030099
               10  MR-DATEA                   PIC  X(01).               10040099
               10  MR-DATEC                   PIC  X(01).               10050099
               10  MR-DATEH                   PIC  X(01).               10060099
               10  MR-DATE                    PIC  X(10).               10070099
                                                                        10080099
               10  MR-TRANSFER-QTYL           PIC S9(04) COMP.          10090099
               10  MR-TRANSFER-QTYA           PIC  X(01).               10100099
               10  MR-TRANSFER-QTYC           PIC  X(01).               10110099
               10  MR-TRANSFER-QTYH           PIC  X(01).               10120099
               10  MR-TRANSFER-QTY-X.                                   10130099
                   15  MR-TRANSFER-QTY        PIC ZZZZ9.                10140099
                                                                        10150099
               10  MR-RECEIVED-QTYL           PIC S9(04) COMP.          10160099
               10  MR-RECEIVED-QTYA           PIC  X(01).               10170099
               10  MR-RECEIVED-QTYC           PIC  X(01).               10180099
               10  MR-RECEIVED-QTYH           PIC  X(01).               10190099
               10  MR-RECEIVED-QTY-X.                                   10200099
                   15  MR-RECEIVED-QTY        PIC ZZZZ9.                10210099
                                                                        10220099
               10  MR-MISC-INFOL              PIC S9(04) COMP.          10230099
               10  MR-MISC-INFOA              PIC  X(01).               10240099
               10  MR-MISC-INFOC              PIC  X(01).               10250099
               10  MR-MISC-INFOH              PIC  X(01).               10260099
100404*        10  MR-MISC-INFO               PIC  X(38).               10270099
100404         10  MR-MISC-INFO               PIC  X(37).               10270099
                                                                        10280099
           EJECT                                                        10290099
      *---------------------------------------------------------------* 10300099
      *    ATTRIBUTE SETTINGS COPYBOOK.                               * 10310099
      *---------------------------------------------------------------* 10320099
                                                                        10330099
           COPY DPWS015.                                                10340099
                                                                        10350099
      *---------------------------------------------------------------* 10360099
      *    FUNCTION KEYS COPYBOOK.                                    * 10370099
      *---------------------------------------------------------------* 10380099
                                                                        10390099
           COPY DPWS016.                                                10400099
                                                                        10410099
      *---------------------------------------------------------------* 10420099
      *    NUMERIC EDIT LAYOUT.                                       * 10430099
      *---------------------------------------------------------------* 10440099
                                                                        10450099
           COPY DPWS010I.                                               10460099
       EJECT                                                            10470099
                                                                                
111703*---------------------------------------------------------------*         
111703*  UPC PARAMETER LIST FOR CALLING THE DUMMY UPC CHECK ROUTINE             
111703*---------------------------------------------------------------*         
111703     COPY DPWS040I.                                                       
                                                                                
      *---------------------------------------------------------------* 10480099
      *    PARAMETERS FOR CALLING THE CICS ARCHITECTURE API.          * 10490099
      *---------------------------------------------------------------* 10500099
                                                                        10510099
           COPY DPWS030.                                                10520099
CICS       COPY DPWS930.                                                10520099
       EJECT                                                            10530099
      *---------------------------------------------------------------* 10540099
      *    STANDARD COMMAREA.                                         * 10550099
      *---------------------------------------------------------------* 10560099
                                                                        10570099
           COPY DPWS020.                                                10580099
           05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                10590099
                                                                        10600099
      *---------------------------------------------------------------* 10610099
      * INTER-APPLICATION COMMAREA.                                   * 10620099
      *   TFWS001 - IS THE INPUT LAYOUT WHEN COMING FROM THE CRIT.    * 10630099
      *             SPEC SCREEN.                                      * 10640099
      *   TFWS001 - IS THE OUTPUT LAYOUT THAT WILL BE PASSED FROM     * 10650099
      *             THIS LIST PROGRAMMING FOR A LOCAL-GO FUNCTION.    * 10660099
      *---------------------------------------------------------------* 10670099
                                                                        10680099
               10  INTER-APPL-COMM-AREA       PIC X(200).               10690099
           COPY TFWS001.                                                10700099
      *---------------------------------------------------------------* 10710099
      *  THIS IS THE APPLICATION-SPECIFIC COMMAREA.                   * 10720099
      *---------------------------------------------------------------* 10730099
               10  ASC-SPECIFIC-COMMAREA.                               10740099
                   15  ASC-CRITERIA-INFO.                               10750099
                       20  ASC-XFER-TYPE                   PIC  X(02).  10760099
                           88  ASC-ALL-TYPES               VALUE '  '.  10770099
111703*                    88  ASC-DEFECTS-DAMAGES-TYPE    VALUE '01'.  10780099
111703                     88  ASC-DEFECTIVE-DAMAGE-SORT1  VALUE '00'.          
110703                     88  ASC-DEFECTIVE-DAMAGE-SORT2  VALUE '01'.          
                           88  ASC-CALLBACK-TYPE           VALUE '02'.  10790099
                           88  ASC-STOCK-BAL-CORP-TYPE     VALUE '03'.  10800099
                           88  ASC-STOCK-BAL-STORE-TYPE    VALUE '04'.  10810099
                           88  ASC-CUSTOMER-TYPE           VALUE '05'.  10820099
                           88  ASC-NON-RETAIL-TYPE         VALUE '06'.  10830099
                           88  ASC-OFFSITE-STORAGE-TYPE    VALUE '07'.  10840099
                       20  ASC-XFER-STATUS                 PIC  X(02).  10850099
                           88  ASC-COMPLETE-STATUS         VALUE 'CM'.  10860099
                           88  ASC-RECEIVED-STATUS         VALUE 'PR'.  10870099
100404*                20  ASC-XFER-FROM-STR               PIC  9(03).  10880099
100404                 20  ASC-XFER-FROM-STR               PIC  S9(04)  10880099
100404                                                          COMP-3.         
100404*                20  ASC-XFER-TO-STR                 PIC  9(03).  10890099
100404                 20  ASC-XFER-TO-STR                 PIC  S9(04)  10890099
100404                                                          COMP-3.         
      ****                 DATES ARE IN FORMAT MMDDYYYY                 10900099
                       20  ASC-XFER-COMP-BEG-DTE           PIC  9(08).  10910099
                       20  ASC-XFER-COMP-END-DTE           PIC  9(08).  10920099
                       20  ASC-XFER-RECV-BEG-DTE           PIC  9(08).  10930099
                       20  ASC-XFER-RECV-END-DTE           PIC  9(08).  10940099
                       20  ASC-XFER-DPT                    PIC  9(03).  10950099
                       20  ASC-XFER-CLASS                  PIC  9(03).  10960099
                       20  ASC-XFER-SUBCL                  PIC  X(03).  10960099
                       20  ASC-XFER-UPC                    PIC  9(13).  10970099
                       20  ASC-XFER-CALLBACK-NBR           PIC  9(04).  10970099
                       20  ASC-XFER-APPROVAL-NBR           PIC  9(09).  10980099
                       20  ASC-XFER-COMP-BY-FIRST-INIT     PIC  X(01).  10990099
                       20  ASC-XFER-COMP-BY-LAST-NAME      PIC  X(20).  11000099
                       20  ASC-XFER-RECV-BY-FIRST-INIT     PIC  X(01).  11010099
                       20  ASC-XFER-RECV-BY-LAST-NAME      PIC  X(20).  11020099
                       20  ASC-XFER-DISPLAY-TOT            PIC  X(01).  11030099
                           88  ASC-DISPLAY-TOTALS          VALUE 'Y'.   11040099
                   15  ASC-CRITERIA-SORT-ORDER.                         11050099
                       20  ASC-XFER-TYPE-SORT-NR           PIC  9(01).  11060099
                       20  ASC-XFER-STATUS-SORT-NR         PIC  9(01).  11070099
                       20  ASC-XFER-FROM-STR-SORT-NR       PIC  9(01).  11080099
                       20  ASC-XFER-TO-STR-SORT-NR         PIC  9(01).  11090099
                       20  ASC-XFER-COMP-DTE-SORT-NR       PIC  9(01).  11100099
                       20  ASC-XFER-RECV-DTE-SORT-NR       PIC  9(01).  11110099
                       20  ASC-XFER-CALLBCK-NR-SORT-NR     PIC  9(01).  11120099
                       20  ASC-XFER-APPRV-NR-SORT-NR       PIC  9(01).  11130099
                   15  ASC-TRANSFER-TYPE-DESC              PIC  X(37).  11140099
100404*            15  ASC-MISC-INFO-HEADER-1              PIC  X(38).  11150099
100404             15  ASC-MISC-INFO-HEADER-1              PIC  X(37).  11150099
100404*            15  ASC-MISC-INFO-HEADER-2              PIC  X(38).  11160099
100404             15  ASC-MISC-INFO-HEADER-2              PIC  X(37).  11160099
                   15  ASC-XFER-QTY-TOTAL                  PIC S9(06)   11170099
                                                           COMP-3.      11180099
                   15  ASC-RECV-QTY-TOTAL                  PIC S9(06)   11190099
                                                           COMP-3.      11200099
                   15  ASC-XFER-RETAIL-TOTAL               PIC S9(08)V9911210099
                                                           COMP-3.      11220099
                   15  ASC-RECV-RETAIL-TOTAL               PIC S9(08)V9911230099
                                                           COMP-3.      11240099
100404*            15  ASC-SEL-XFER-NBR                    PIC  X(10).  11250099
100404             15  ASC-SEL-XFER-NBR                    PIC  X(11).  11250099
                   15  ASC-SEL-XFER-DKEY-ID        PIC S9(09)  COMP.    11260099
                   15  ASC-ACTION-SW               PIC  X(01).          11270099
                       88  ASC-PRT-DOC-REQUESTED   VALUE 'P'.           11280099
                       88  ASC-PRINT-LIST-REQUEST  VALUE 'L'.           11290099
                       88  ASC-VOID-REQUESTED      VALUE 'V'.           11300099
                   15  ASC-BLOCK-ENTRIES OCCURS 2 TIMES.                11310099
                       20  ASC-BLOCK-MODIFIED-SW           PIC  X(01).  11320099
                           88  ASC-BLOCK-NOT-MODIFIED      VALUE 'N'.   11330099
                           88  ASC-BLOCK-MODIFIED          VALUE 'Y'.   11340099
                                                                        11350099
                       20  ASC-ITEM-ARRAY.                              11360099
                           25  ASC-ITEM-ENTRIES OCCURS 14 TIMES.        11370099
                               30  ASC-LIST-ITEM-NUMBER                 11380099
                                                       PIC S9(09)       11390099
                                                           COMP-3.      11400099
                               30  ASC-TEMP-SELECTED-SW PIC X(01).      11410099
                                   88  ASC-VALID-SELECT  VALUE ' '      11420099
                                                               'S'.     11430099
                                   88  ASC-TEMP-NO-SELECT               11440099
                                                         VALUE ' '.     11450099
                                   88  ASC-TEMP-SELECT   VALUE 'S'.     11460099
                                   88  ASC-TEMP-BEGIN    VALUE 'B'.     11460099
                                   88  ASC-TEMP-END      VALUE 'E'.     11460099
                               30  ASC-SELECTED-SW     PIC X(01).       11470099
                                   88  ASC-NO-SELECT     VALUE ' '.     11480099
                                   88  ASC-SELECT        VALUE 'S'.     11490099
                                   88  ASC-BEGIN         VALUE 'B'.     11490099
                                   88  ASC-END           VALUE 'E'.     11490099
100404*                        30  ASC-TRANSFER-NBR    PIC X(10).       11500099
100404                         30  ASC-TRANSFER-NBR    PIC X(11).       11500099
                               30  ASC-STATUS          PIC X(03).       11510099
                               30  ASC-DATE            PIC X(10).       11520099
                               30  ASC-TRN-QTY         PIC S9(05)       11530099
                                                           COMP-3.      11540099
                               30  ASC-REC-QTY         PIC S9(05)       11550099
                                                           COMP-3.      11560099
100404*                        30  ASC-MISC-INFO       PIC X(38).       11570099
100404                         30  ASC-MISC-INFO       PIC X(37).       11570099
                               30  ASC-XFER-DKEY-ID    PIC S9(09)       11580099
                                                           COMP.        11590099
                               30  ASC-DISCREPANCY-SW  PIC X(01).       11600099
                                   88  ASC-NO-DISCREPANCY    VALUE ' '. 11610099
                                   88  ASC-DISCREPANCY-EXISTS VALUE 'Y'.11620099
                                                                        11630099
                   15  ASC-BLK-SUB                     PIC S9(04) COMP  11640099
                                                                SYNC.   11650099
                   15  ASC-ITEM-SUB                    PIC S9(04) COMP  11660099
                                                                SYNC.   11670099
                   15  ASC-NUMBER-OF-ITEMS-READ        PIC S9(09)       11680099
                                                                COMP-3. 11690099
                   15  ASC-NUMBER-OF-SELECTED-ITEMS    PIC S9(09)       11700099
                                                                COMP-3. 11710099
                   15  ASC-START-OF-SELECTED-RANGE         PIC S9(09)   DPKCS036
                                                                COMP-3. DPKCS036
                   15  ASC-END-OF-SELECTED-RANGE           PIC S9(09)   DPKCS036
                                                                COMP-3. DPKCS036
                   15  ASC-ITEMS-DISPLAYED             PIC S9(03)       11720099
                                                                COMP-3. 11730099
                   15  ASC-ITEM-AT-TOP-OF-PANEL        PIC S9(09)       11740099
                                                                COMP-3. 11750099
                   15  ASC-ITEM-AT-BOT-OF-PANEL        PIC S9(09)       11760099
                                                                COMP-3. 11770099
                   15  ASC-HIGHEST-BLOCK-WRITTEN       PIC S9(04) COMP  11780099
                                                                SYNC.   11790099
                   15  ASC-ITEMS-LEFT-INDICATOR        PIC  X(01).      11800099
                       88  ASC-ITEMS-LEFT-ON-DB            VALUE 'Y'.   11810099
                       88  ASC-NO-ITEMS-LEFT-ON-DB         VALUE 'N'.   11820099
                   15  ASC-TEMP-QUEUE-UPDATE-SW        PIC  X(01).      11830099
                       88  ASC-UPDATE-TSQ                  VALUE 'Y'.   11840099
                       88  ASC-NO-TSQ-UPDATE               VALUE ' '.   11850099
                   15  ASC-LIST-QUEUE-NAME.                             11860099
                       20  ASC-LIST-TERM-ID            PIC  X(04).      11870099
                       20  ASC-LIST-TASK-NUMBER        PIC S9(05)       11880099
                                                                COMP-3. 11890099
                       20  ASC-LIST-SEQ                PIC  9(01).      11900099
                   15  ASC-SEL-QUEUE-NAME.                              11910099
                       20  ASC-SEL-TERM-ID             PIC  X(04).      11920099
                       20  ASC-SEL-TASK-NUMBER         PIC S9(05)       11930099
                                                                COMP-3. 11940099
                       20  ASC-SEL-SEQ                 PIC  9(01).      11950099
                                                                        11960099
                   15  ASC-START-ITEM-REQUEST.                          11970099
                       20  ASC-START-ITEM-REQUEST-N    PIC  9(05).      11980099
                                                                        11990099
           EJECT                                                        12000099
      *---------------------------------------------------------------* 12010099
      *    ABEND PROCESSING COPYBOOK.                                 * 12020099
      *---------------------------------------------------------------* 12030099
                                                                        12040099
           COPY DPWS013.                                                12050099
                                                                        12050199
           EJECT                                                        12050212
      *---------------------------------------------------------------* 12050312
      *    DB2 AREA FOR TRANSFER TABLE                                * 12050412
      *---------------------------------------------------------------* 12050512
           EXEC SQL                                                     12050612
                INCLUDE TTFMSTR                                         12050712
           END-EXEC.                                                    12050812
                                                                        12050912
      *---------------------------------------------------------------* 12051012
      *    DB2 AREA FOR TRANSFER ITEM TABLE                           * 12051112
      *---------------------------------------------------------------* 12051212
           EXEC SQL                                                     12051312
                INCLUDE TTFITEM                                         12051412
           END-EXEC.                                                    12051512
                                                                        12051612
      *---------------------------------------------------------------* 12051712
      *    DB2 AREA FOR TRANSFER ITEM RECEIPTS TABLE                  * 12051812
      *---------------------------------------------------------------* 12051912
           EXEC SQL                                                     12052012
                INCLUDE TTFITRC                                         12052112
           END-EXEC.                                                    12052212
                                                                        12052312
      *---------------------------------------------------------------* 12052412
      *    DB2 AREA FOR TRANSFER DISCREPANCY TABLE                    * 12052512
      *---------------------------------------------------------------* 12052612
           EXEC SQL                                                     12052712
                INCLUDE TTFDSCP                                         12052812
           END-EXEC.                                                    12052912
                                                                        12053012
      *---------------------------------------------------------------* 12053112
      *    DB2 AREA FOR TRANSFER RECEIPT TABLE                        * 12053212
      *---------------------------------------------------------------* 12053312
           EXEC SQL                                                     12053412
                INCLUDE TTFRCPT                                         12053512
           END-EXEC.                                                    12053612
      *---------------------------------------------------------------* 12053712
      *    DB2 AREA FOR TRANSFER STATUS CODE TABLE                    * 12053812
      *---------------------------------------------------------------* 12053912
           EXEC SQL                                                     12054012
                INCLUDE TTFSTCD                                         12054112
           END-EXEC.                                                    12054212
                                                                        12054312
      *---------------------------------------------------------------* 12054412
      *    DB2 AREA FOR TRANSFER TYPE TABLE                           * 12054512
      *---------------------------------------------------------------* 12054612
           EXEC SQL                                                     12054712
                INCLUDE TTFTYCD                                         12054812
           END-EXEC.                                                    12054912
                                                                        12055012
      *---------------------------------------------------------------* 12055112
      *    DB2 AREA FOR TRANSFER CUSTOMER TABLE                       * 12055212
      *---------------------------------------------------------------* 12055312
           EXEC SQL                                                     12055412
                INCLUDE TTFCUST                                         12055512
           END-EXEC.                                                    12055612
                                                                        12055712
      *---------------------------------------------------------------* 12055812
      *    DB2 AREA FOR TRANSFER STATUS TABLE                         * 12055912
      *---------------------------------------------------------------* 12056012
           EXEC SQL                                                     12056112
                INCLUDE TTFSTAT                                         12056212
           END-EXEC.                                                    12056312
                                                                        12056412
      *---------------------------------------------------------------* 12055812
      *    DB2 AREA FOR SKU CROSS REFERENCE TABLE                     * 12055912
      *---------------------------------------------------------------* 12056012
           EXEC SQL                                                     12056112
                INCLUDE TSKXREF                                         12056212
           END-EXEC.                                                    12056312
                                                                                
101803*--------------------------------------------------------------*          
101803*    DB2 AREA FOR XST UPC TABLE                                 *         
101803*--------------------------------------------------------------*          
101803     EXEC SQL                                                             
101803          INCLUDE XST00012                                                
101803     END-EXEC.                                                            
101803                                                                          
      *---------------------------------------------------------------* 12056512
      *    DB2 AREA FOR COMMUNICATIONS                                * 12056612
      *---------------------------------------------------------------* 12056712
           EXEC SQL                                                     12056812
                INCLUDE SQLCA                                           12056912
           END-EXEC.                                                    12057012
                                                                        12057112
      *---------------------------------------------------------------* 12057212
      *    CURSOR TO OBTAIN THE TRANSFER TYPE CODES AND DESCRIPTIONS  * 12057312
      *---------------------------------------------------------------* 12057412
                                                                        12057512
           EXEC SQL                                                     12057612
                DECLARE XFER-TYPE-CSR CURSOR                            12057712
                FOR                                                     12057812
                  SELECT                                                12057912
                      XFER_TYP_CDE                                      12058012
                     ,TYP_1ST_LNE_DESC                                  12058199
                     ,TYP_2ND_LNE_DESC                                  12058212
                  FROM                                                  12058312
                      TTFTYCD                                           12058412
                  ORDER BY XFER_TYP_CDE                                 12058512
100404            WITH UR                                                       
           END-EXEC.                                                    12058612
                                                                        12058799
      *---------------------------------------------------------------* 12058812
      *    CURSOR TO OBTAIN TRANSFERS FOR THE LIST SCREEN             * 12058912
      *---------------------------------------------------------------* 12059012
      *    EXEC SQL                                                     12059112
      *         DECLARE XFER-LIST-CSR CURSOR                            12059212
      *         FOR                                                     12059312
      *           SELECT                                                12059412
      *                A.XFER_DKEY_ID                                   12059512
      *              , A.XFER_TYP_CDE                                   12059612
      *              , A.FR_STR_NBR                                     12059712
      *              , A.XFER_SEQ_NBR                                   12059812
      *              , A.TO_STR_NBR                                     12059912
      *              , A.CLBK_NBR                                       12060012
      *              , A.STK_BAL_APVL_NBR                               12060112
      *              , A.ATTN_INIT_1ST_NM                               12060212
      *              , A.ATTN_LAST_NM                                   12060312
      *              , A.CMPT_XFER_BEG_TMST                             12060412
      *              , A.CMPT_XFER_END_TMST                             12060512
      *              , A.CPLD_INIT_1ST_NM                               12060612
      *              , A.CPLD_LAST_NM                                   12060712
      *              , B.XFER_STAT_CDE                                  12060812
      *           FROM                                                  12060912
      *                DB2TDBA.TTFMSTR A                                12061012
      *              , DB2TDBA.TTFSTAT B                                12061112
      *           WHERE                                                 12061212
      *                 B.XFER_DKEY_ID = A.XFER_DKEY_ID                 12061312
      *             AND B.XFER_STAT_CDE ^= 'VD'                         12061412
      *             AND B.XFER_STAT_TMST =                              12061512
      *                 (SELECT MAX (ST.XFER_STAT_TMST)                 12061612
      *                   FROM DB2TDBA.TTFSTAT ST                       12061712
      *                  WHERE ST.XFER_DKEY_ID = B.XFER_DKEY_ID)        12061812
      *             AND ...                                             12061912
      *           ORDER BY ...                                          12062012
      *    END-EXEC.                                                    12063012
                                                                        12063199
      *---------------------------------------------------------------* 12063212
      *    CURSOR TO OBTAIN TRANSFERS BY DEPARTMENT/CLASS ITEMS       * 12063312
      *---------------------------------------------------------------* 12063412
      *    EXEC SQL                                                     12063512
      *         DECLARE XFER-ITEM-LIST-CSR CURSOR                       12063612
      *         FOR                                                     12063712
      *           SELECT                                                12063812
      *                DISTINCT A.XFER_DKEY_ID                          12063912
      *              , A.XFER_TYP_CDE                                   12064012
      *              , A.FR_STR_NBR                                     12064112
      *              , A.XFER_SEQ_NBR                                   12064212
      *              , A.TO_STR_NBR                                     12064312
      *              , A.CLBK_NBR                                       12064412
      *              , A.STK_BAL_APVL_NBR                               12064512
      *              , A.ATTN_INIT_1ST_NM                               12064612
      *              , A.ATTN_LAST_NM                                   12064712
      *              , A.CMPT_XFER_BEG_TMST                             12064812
      *              , A.CMPT_XFER_END_TMST                             12064912
      *              , A.CPLD_INIT_1ST_NM                               12065012
      *              , A.CPLD_LAST_NM                                   12065112
      *              , B.XFER_STAT_CDE                                  12065212
      *           FROM                                                  12065512
      *                DB2TDBA.TTFMSTR A                                12065612
      *              , DB2TDBA.TTFSTAT B                                12065712
      *              , DB2TDBA.TTFITEM C                                12065812
      *           WHERE                                                 12065912
      *                 B.XFER_DKEY_ID = A.XFER_DKEY_ID                 12066012
      *             AND C.XFER_DKEY_ID = A.XFER_DKEY_ID                 12066199
      *             AND B.XFER_STAT_CDE ^= 'VD'                         12066212
      *             AND B.XFER_STAT_TMST =                              12066312
      *                 (SELECT MAX (ST.XFER_STAT_TMST)                 12066412
      *                   FROM DB2TDBA.TTFSTAT ST                       12066512
      *                  WHERE ST.XFER_DKEY_ID = B.XFER_DKEY_ID)        12066612
      *             AND ...                                             12066912
      *           ORDER BY ...                                          12067012
      *    END-EXEC.                                                    12068012
                                                                        12068199
      *---------------------------------------------------------------* 12068212
      *    CURSOR TO OBTAIN TRANSFERS BY LATEST RECEIVER              * 12068312
      *---------------------------------------------------------------* 12068412
      *    EXEC SQL                                                     12068512
      *         DECLARE XFER-RCVR-LIST-CSR CURSOR                       12068612
      *         FOR                                                     12068712
      *           SELECT                                                12068812
      *                A.XFER_DKEY_ID                                   12068912
      *              , A.XFER_TYP_CDE                                   12069012
      *              , A.FR_STR_NBR                                     12069112
      *              , A.XFER_SEQ_NBR                                   12069212
      *              , A.TO_STR_NBR                                     12069312
      *              , A.CLBK_NBR                                       12069412
      *              , A.STK_BAL_APVL_NBR                               12069512
      *              , A.ATTN_INIT_1ST_NM                               12069612
      *              , A.ATTN_LAST_NM                                   12069712
      *              , A.CMPT_XFER_BEG_TMST                             12069812
      *              , A.CMPT_XFER_END_TMST                             12069912
      *              , A.CPLD_INIT_1ST_NM                               12070012
      *              , A.CPLD_LAST_NM                                   12070112
      *              , B.XFER_STAT_CDE                                  12070212
      *              , D.RCVR_INIT_1ST_NM                               12070312
      *              , D.RCVR_LAST_NM                                   12070412
      *              , D.RCV_XFER_BEG_TMST                              12070512
      *              , D.RCV_XFER_END_TMST                              12070612
      *           FROM                                                  12070712
      *                DB2TDBA.TTFMSTR A                                12070812
      *              , DB2TDBA.TTFSTAT B                                12070912
      *              , DB2TDBA.TTFRCPT D                                12071012
      *           WHERE                                                 12071112
      *                 B.XFER_DKEY_ID = A.XFER_DKEY_ID                 12071212
      *             AND D.XFER_DKEY_ID = A.XFER_DKEY_ID                 12071399
      *             AND B.XFER_STAT_CDE ^= 'VD'                         12071412
      *             AND B.XFER_STAT_TMST =                              12071512
      *                 (SELECT MAX (ST.XFER_STAT_TMST)                 12071612
      *                   FROM DB2TDBA.TTFSTAT ST                       12071712
      *                  WHERE ST.XFER_DKEY_ID = B.XFER_DKEY_ID)        12071812
      *             AND D.RCV_XFER_BEG_TMST =                           12071912
      *                 (SELECT MAX (RC.RCV_XFER_BEG_TMST)              12072012
      *                   FROM DB2TDBA.TTFRCPT RC                       12072112
      *                  WHERE RC.XFER_DKEY_ID = D.XFER_DKEY_ID)        12072212
      *        ***  AND D.RCVR_INIT_1ST_NM  = :TFRCPT-RCVR-INIT-1ST-NM  12072399
      *        ***  AND D.RCVR_LAST_NM      = :TFRCPT-RCVR-LAST-NM      12072499
      *        ***  AND D.RCV_XFER_BEG_TMST = :TFRCPT-RCV-XFER-BEG-TMST 12072599
      *        ***  AND D.RCV_XFER_END_TMST = :TFRCPT-RCV-XFER-END-TMST 12072699
      *             AND ...                                             12072712
      *           ORDER BY ...                                          12072812
      *    END-EXEC.                                                    12072912
                                                                        12073099
      *---------------------------------------------------------------* 12073112
      *    CURSOR TO OBTAIN TRANSFERS BY ITEM & RECEIPT INFO          * 12073212
      *---------------------------------------------------------------* 12073312
      *    EXEC SQL                                                     12073412
      *         DECLARE XFER-ALL-LIST-CSR CURSOR                        12073512
      *         FOR                                                     12073612
      *           SELECT                                                12073712
      *                DISTINCT A.XFER_DKEY_ID                          12073812
      *              , A.XFER_TYP_CDE                                   12073912
      *              , A.FR_STR_NBR                                     12074012
      *              , A.XFER_SEQ_NBR                                   12074112
      *              , A.TO_STR_NBR                                     12074212
      *              , A.CLBK_NBR                                       12074312
      *              , A.STK_BAL_APVL_NBR                               12074412
      *              , A.ATTN_INIT_1ST_NM                               12074512
      *              , A.ATTN_LAST_NM                                   12074612
      *              , A.CMPT_XFER_BEG_TMST                             12074712
      *              , A.CMPT_XFER_END_TMST                             12074812
      *              , A.CPLD_INIT_1ST_NM                               12074912
      *              , A.CPLD_LAST_NM                                   12075012
      *              , B.XFER_STAT_CDE                                  12075112
      *              , D.RCVR_INIT_1ST_NM                               12075412
      *              , D.RCVR_LAST_NM                                   12075512
      *              , D.RCV_XFER_BEG_TMST                              12075612
      *              , D.RCV_XFER_END_TMST                              12075712
      *           FROM                                                  12075812
      *                DB2TDBA.TTFMSTR A                                12075912
      *              , DB2TDBA.TTFSTAT B                                12076012
      *              , DB2TDBA.TTFITEM C                                12076112
      *              , DB2TDBA.TTFRCPT D                                12076212
      *           WHERE                                                 12076312
      *                 B.XFER_DKEY_ID = A.XFER_DKEY_ID                 12076412
      *             AND C.XFER_DKEY_ID = A.XFER_DKEY_ID                 12076599
      *             AND D.XFER_DKEY_ID = A.XFER_DKEY_ID                 12076699
      *             AND B.XFER_STAT_CDE ^= 'VD'                         12076712
      *             AND B.XFER_STAT_TMST =                              12076812
      *                 (SELECT MAX (ST.XFER_STAT_TMST)                 12076912
      *                   FROM DB2TDBA.TTFSTAT ST                       12077012
      *                  WHERE ST.XFER_DKEY_ID = B.XFER_DKEY_ID)        12077112
      *             AND D.RCV_XFER_BEG_TMST =                           12077212
      *                 (SELECT MAX (RC.RCV_XFER_BEG_TMST)              12077312
      *                   FROM DB2TDBA.TTFRCPT RC                       12077412
      *                  WHERE RC.XFER_DKEY_ID = D.XFER_DKEY_ID)        12077512
      *        ***  AND D.RCVR_INIT_1ST_NM  = :TFRCPT-RCVR-INIT-1ST-NM  12077899
      *        ***  AND D.RCVR_LAST_NM      = :TFRCPT-RCVR-LAST-NM      12077999
      *        ***  AND D.RCV_XFER_BEG_TMST = :TFRCPT-RCV-XFER-BEG-TMST 12078099
      *        ***  AND D.RCV_XFER_END_TMST = :TFRCPT-RCV-XFER-END-TMST 12078199
      *             AND ...                                             12078212
      *           ORDER BY ...                                          12078312
      *    END-EXEC.                                                    12078412
                                                                        12078599
                                                                        12078699
       EJECT                                                            12078799
       LINKAGE SECTION.                                                 12078899
                                                                        12078999
       01  DFHCOMMAREA.                                                 12079099
           05  FILLER                         OCCURS  1 TO 4072 TIMES   12080099
                                              DEPENDING ON EIBCALEN.    12090099
               10  FILLER                     PIC X.                    12100099
                                                                        12110099
       EJECT                                                            12120099
       PROCEDURE DIVISION.                                              12130099
      ******************************************************************12140099
      **  THIS MODULE IS THE HIGHEST PROCESSING LEVEL IN THE PROGRAM. **12150099
      **  FIRST, CALL THE CICS ARCHITECTURE API, PERFORM THE PROGRAM  **12160099
      **  PROCESSING AND THEN CALL THE CICS ARCHITECTURE API TO EXIT. **12170099
      ******************************************************************12180099
       0000-MAIN-MODULE.                                                12190099
           INITIALIZE DP030-CICS-API-FIELDS.                            12200099
           MOVE +1                       TO DP030-NUMBER-OF-MAPS.       12210099
           MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          12220099
           MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         12230099
           SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       12240099
           MOVE LENGTH OF TF421AI        TO DP030-MAP-LENGTH (1).       12250099
           MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     12260099
           PERFORM 0001-CALL-CICS-ARCH-API.                             12270099
                                                                        12280099
           PERFORM 1000-CONTROL-PROCESSING                              12290099
                                                                        12300099
           MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     12310099
           PERFORM 0001-CALL-CICS-ARCH-API.                             12320099
                                                                        12330099
      ******************************************************************12340099
      **  THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE   **12350099
      **  AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.         **12360099
      ******************************************************************12370099
       0001-CALL-CICS-ARCH-API.                                         12380099
CICS       CALL DP930-CICS-ARCH-API USING DFHEIBLK                              
                                          DFHCOMMAREA                           
                                          DP030-CICS-API-FIELDS                 
                                          DP020-STANDARD-COMMAREA               
                                          TF421AI.                              
      *                                                                 12440099
           IF  DP030-RC-CALL-SUCCESSFUL                                 12450099
               CONTINUE                                                 12460099
           ELSE                                                         12470099
               SET DP013-NO-ROLLBACK                                    12480099
                   DP013-XCTL-DISPLAY-RESTART                           12490099
                   DP013-CICS-ABEND      TO TRUE                        12500099
               MOVE '0001-CALL-CICS-ARCH-API'                           12510099
                                         TO DP013-PARAGRAPH             12520099
CICS           MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O        
CICS  -             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)              
               MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      12550099
               PERFORM DP013-0000-PROCESS-ABEND                         12560099
           END-IF.                                                      12570099
      *----------------------------------------------------------------*12580099
      * PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT      *12590099
      * COURSE OF ACTION IS FOR THIS TRANSACTION.                      *12600099
      *                                                                *12610099
      * NOTE:  PV-TOP-ITEM IS THE ITEM THAT IS REQUESTED TO BE AT THE  *12620099
      *  TOP OF THE PANEL.  MOVING ASC-ITEM-AT-TOP-OF-PANEL TO THIS    *12630099
      *  MEANS THAT POSITION WITHIN THE LIST WILL NOT CHANGE -- THIS   *12640099
      *  IS THE DEFAULT WHICH WILL BE OVERRIDDEN BY SCROLLING ACTIONS. *12650099
      *----------------------------------------------------------------*12660099
                                                                        12670099
       1000-CONTROL-PROCESSING.                                         12680099
                                                                        12690099
           EVALUATE TRUE                                                12700099
               WHEN DP020-NEXT-ACT-INITIAL                              12710099
                   INITIALIZE ASC-SPECIFIC-COMMAREA                     12720099
                   MOVE EIBTRMID         TO ASC-LIST-TERM-ID            12730099
                                            ASC-SEL-TERM-ID             12740099
                   MOVE DP020-SRC-TASK-NUMBER                           12750099
                                         TO ASC-LIST-TASK-NUMBER        12760099
                                            ASC-SEL-TASK-NUMBER         12770099
                   MOVE PC-LIST-QUEUE-SEQ                               12780099
                                         TO ASC-LIST-SEQ                12790099
                   MOVE PC-SEL-QUEUE-SEQ TO ASC-SEL-SEQ                 12800099
                   PERFORM 1100-PROCESS-INTER-APPL-COMM                 12810099
                   IF  PS-COMMAREA-NOT-VALID                            12820099
                       SET DP020-NEXT-ACT-APPL-ERROR                    12830099
                                         TO TRUE                        12840099
                   ELSE                                                 12850099
                       PERFORM 4000-BUILD-INITIAL-PANEL                 12860099
                   END-IF                                               12870099
                                                                        12880099
               WHEN DP020-NEXT-ACT-READ-MAP                             12890099
                   MOVE ASC-ITEM-AT-TOP-OF-PANEL                        12900099
                                         TO PV-TOP-ITEM                 12910099
                   PERFORM 2000-PROCESS-PANEL                           12920099
                                                                        12930099
               WHEN DP020-NEXT-ACT-RETURN                               12940099
                   IF ASC-PRINT-LIST-REQUEST        AND                 12950099
                         TF001-PRINT-YES            AND                 12960099
                         TF001-PRINTER-DEST NOT = SPACES                12970099
                       PERFORM 7000-PRINT-LIST                          12980099
      *                -- PRINT REQUEST HAS BEEN SUBMITTED --           12990099
                       MOVE PC-TSYMSG-00098                             13000099
                                         TO DP020-MSG-NUMBER            13010099
                       SET DP020-MSG-INFORMATIONAL  TO TRUE             13020099
                   ELSE                                                 13030099
                       IF ASC-PRT-DOC-REQUESTED   AND                   13040099
                             TF001-PRINT-DOC                            13050099
                           MOVE PC-TSYMSG-01400    TO DP020-MSG-NUMBER  13060099
                           SET DP020-MSG-INFORMATIONAL TO TRUE          13070099
                       END-IF                                           13080099
                   END-IF                                               13090099
                   MOVE ASC-ITEM-AT-TOP-OF-PANEL                        13100099
                                         TO PV-TOP-ITEM                 13110099
                   MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    13120099
                   PERFORM 6000-REFRESH-PANEL-FROM-TEMP                 13130099
                   PERFORM 3000-EDIT-DATA-IN-COMMAREA                   13140099
                   PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 13150099
                                                                        13160099
               WHEN OTHER                                               13170099
                   SET DP013-LOGIC-ABEND TO TRUE                        13180099
                   SET DP013-NO-ROLLBACK TO TRUE                        13190099
                   MOVE '1000-CONTROL-PROCESSING'                       13200099
                                         TO DP013-PARAGRAPH             13210099
                   MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    13220099
                                         TO DP013-MESSAGE-TEXT(1)       13230099
                   PERFORM DP013-0000-PROCESS-ABEND                     13240099
           END-EVALUATE.                                                13250099
                                                                        13260099
       EJECT                                                            13270099
      *----------------------------------------------------------------*13280099
      * DETERMINE IF DATA WAS PASSED THROUGH INTER-APPL COMMAREA       *13290099
      *----------------------------------------------------------------*13300099
                                                                        13310099
       1100-PROCESS-INTER-APPL-COMM.                                    13320099
                                                                        13330099
           SET PS-COMMAREA-VALID         TO TRUE.                       13340099
           MOVE SPACE                    TO ASC-START-ITEM-REQUEST.     13350099
                                                                        13360099
           MOVE TF001-XFER-TYPE          TO ASC-XFER-TYPE.              13370099
           MOVE TF001-XFER-STATUS        TO ASC-XFER-STATUS.            13380099
           MOVE TF001-XFER-FROM-STR      TO ASC-XFER-FROM-STR.          13390099
           MOVE TF001-XFER-TO-STR        TO ASC-XFER-TO-STR.            13400099
           MOVE TF001-XFER-COMP-BEG-DTE  TO ASC-XFER-COMP-BEG-DTE.      13410099
           MOVE TF001-XFER-COMP-END-DTE  TO ASC-XFER-COMP-END-DTE.      13420099
           MOVE TF001-XFER-RECV-BEG-DTE  TO ASC-XFER-RECV-BEG-DTE.      13430099
           MOVE TF001-XFER-RECV-END-DTE  TO ASC-XFER-RECV-END-DTE.      13440099
           MOVE TF001-XFER-DPT           TO ASC-XFER-DPT.               13450099
           MOVE TF001-XFER-CLASS         TO ASC-XFER-CLASS.             13460099
           MOVE TF001-XFER-SUBCLASS      TO ASC-XFER-SUBCL.             13460099
           MOVE TF001-XFER-UPC           TO ASC-XFER-UPC.               13450099
           MOVE TF001-XFER-CALLBACK-NBR  TO ASC-XFER-CALLBACK-NBR.      13470099
           MOVE TF001-XFER-APPROVAL-NBR  TO ASC-XFER-APPROVAL-NBR.      13480099
           MOVE TF001-XFER-COMP-BY-FIRST-INIT                           13490099
                                         TO ASC-XFER-COMP-BY-FIRST-INIT.13500099
           MOVE TF001-XFER-COMP-BY-LAST-NAME                            13510099
                                         TO ASC-XFER-COMP-BY-LAST-NAME. 13520099
           MOVE TF001-XFER-RECV-BY-FIRST-INIT                           13530099
                                         TO ASC-XFER-RECV-BY-FIRST-INIT.13540099
           MOVE TF001-XFER-RECV-BY-LAST-NAME                            13550099
                                         TO ASC-XFER-RECV-BY-LAST-NAME. 13560099
           MOVE TF001-XFER-DISPLAY-TOT   TO ASC-XFER-DISPLAY-TOT.       13570099
           MOVE TF001-XFER-TYPE-SORT-NR  TO ASC-XFER-TYPE-SORT-NR.      13580099
           MOVE TF001-XFER-STATUS-SORT-NR                               13590099
                                         TO ASC-XFER-STATUS-SORT-NR.    13600099
           MOVE TF001-XFER-FROM-STR-SORT-NR                             13610099
                                         TO ASC-XFER-FROM-STR-SORT-NR.  13620099
           MOVE TF001-XFER-TO-STR-SORT-NR                               13630099
                                         TO ASC-XFER-TO-STR-SORT-NR.    13640099
           MOVE TF001-XFER-COMP-DTE-SORT-NR                             13650099
                                         TO ASC-XFER-COMP-DTE-SORT-NR.  13660099
           MOVE TF001-XFER-RECV-DTE-SORT-NR                             13670099
                                         TO ASC-XFER-RECV-DTE-SORT-NR.  13680099
           MOVE TF001-XFER-CALLBCK-NR-SORT-NR                           13690099
                                         TO ASC-XFER-CALLBCK-NR-SORT-NR.13700099
           MOVE TF001-XFER-APPRV-NR-SORT-NR                             13710099
                                         TO ASC-XFER-APPRV-NR-SORT-NR.  13720099
                                                                        13730099
       EJECT                                                            13740099
      *----------------------------------------------------------------*13750099
      * DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *13760099
      * ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *13770099
      * USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *13780099
      * OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *13790099
      * FUNCTION KEYS CAN GET THIS FAR.                                *13800099
      *----------------------------------------------------------------*13810099
                                                                        13820099
       2000-PROCESS-PANEL.                                              13830099
           EVALUATE TRUE                                                13840099
               WHEN DP020-SRC-AID = DP016-CLEAR                         13850099
                   MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    13860099
                   PERFORM 3000-EDIT-DATA-IN-COMMAREA                   13870099
                   PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 13880099
                                                                        13890099
               WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    13900099
                   PERFORM 2050-DELETE-LIST-QUEUE                       13910099
                   PERFORM 4000-BUILD-INITIAL-PANEL                     13920099
                                                                        13930099
               WHEN DP020-FK-DESELECT(DP020-SRC-AID)                    13940099
                   PERFORM 2140-DESELECT-ALL-ITEMS                      13950099
                   PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 13960099
                                                                        DPKCS036
               WHEN DP020-FK-SELECT-ALL(DP020-SRC-AID)                  DPKCS036
                   PERFORM 2150-SELECT-ALL-ITEMS                        DPKCS036
                   PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 DPKCS036
                                                                        13970099
               WHEN OTHER                                               13980099
                   PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 13990099
                   PERFORM 3000-EDIT-DATA-IN-COMMAREA                   14000099
                   IF  PS-NO-ERROR                                      14010099
                       SET DP030-CONTINUE-GO                            14020099
                                       TO TRUE                          14030099
                       PERFORM 2100-CHECK-FUNCTION-KEY                  14040099
                   ELSE                                                 14050099
                       SET DP030-OVERRIDE-GO                            14060099
                                       TO TRUE                          14070099
                   END-IF                                               14080099
           END-EVALUATE.                                                14090099
       EJECT                                                            14100099
      *----------------------------------------------------------------*14110099
      *  DELETE THE LIST ITEMS TEMP STORAGE QUEUE.                     *14120099
      *----------------------------------------------------------------*14130099
       2050-DELETE-LIST-QUEUE.                                          14140099
                                                                        14150099
           EXEC CICS                                                    14160099
               DELETEQ TS                                               14170099
                   QUEUE (ASC-LIST-QUEUE-NAME)                          14180099
                   RESP  (PV-CICS-RESP)                                 14190099
           END-EXEC.                                                    14200099
                                                                        14210099
           IF (PV-CICS-RESP = DFHRESP(NORMAL)) OR                       14220099
              (PV-CICS-RESP = DFHRESP(QIDERR))                          14230099
               CONTINUE                                                 14240099
           ELSE                                                         14250099
               SET DP013-CICS-ABEND      TO TRUE                        14260099
               SET DP013-NO-ROLLBACK     TO TRUE                        14270099
                                                                        14280099
               MOVE '2050-DELETE-LIST-QUEUE'                            14290099
                                         TO DP013-PARAGRAPH             14300099
               MOVE 'ERROR TRYING TO DELETE LIST TEMP STORAGE QUEUE'    14310099
                                         TO DP013-MESSAGE-TEXT (1)      14320099
               PERFORM DP013-0000-PROCESS-ABEND                         14330099
           END-IF.                                                      14340099
                                                                        14350099
           MOVE +0                       TO ASC-HIGHEST-BLOCK-WRITTEN.  14360099
       EJECT                                                            14370099
      *----------------------------------------------------------------*14380099
      * ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED FIRST.*14390099
      * NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED FROM THE  *14400099
      * CICS ARCHITECTURE API.                                         *14410099
      *----------------------------------------------------------------*14420099
       2100-CHECK-FUNCTION-KEY.                                         14430099
           EVALUATE TRUE                                                14440099
               WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              14450099
      *-------- HDR INQ -----------------------------------------------*14460099
               WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              14470099
      *-------- ITM INQ -----------------------------------------------*14460099
                   MOVE SPACE            TO ASC-ACTION-SW               14490099
                   IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              14500099
      **   ** MOVE DATA NECESSARY FOR A TRANSFER HEADER                 14510099
      **   ** INQUIRY OR TRANSFER ITEM INQUIRY                          14520099
                       SET PS-NO-UPDATE-SEL-QUEUE  TO TRUE              14530099
                       INITIALIZE TF001-INTER-APPL-COMMAREA             14540099
                       PERFORM 5000-PREPARE-SEL-QUEUE                   14550099
                       PERFORM 2170-PREP-XFER-INQ-COMMAREA              14560099
                   ELSE                                                 14570099
      *    -- A LIST ITEM MUST BE SELECTED FOR THIS FUNCTION            14580099
                       SET DP030-OVERRIDE-GO                            14590099
                           DP020-MSG-FATAL                              14600099
                           PS-ERROR         TO TRUE                     14610099
                       MOVE PC-TSYMSG-00057 TO DP020-MSG-NUMBER         14620099
                   END-IF                                               14630099
                                                                        14640099
               WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)              14650099
      *-------- VOID --------------------------------------------------*14460099
                 IF ASC-NUMBER-OF-SELECTED-ITEMS > +1                   14670099
      **       -- ONLY ONE LIST ITEM MAY BE SELECTED FOR THIS FUNCTION -14680099
                     SET DP030-OVERRIDE-GO                              14690099
                         DP020-MSG-FATAL                                14700099
                         PS-ERROR             TO TRUE                   14710099
                     MOVE PC-TSYMSG-00047     TO DP020-MSG-NUMBER       14720099
                 ELSE                                                   14730099
                   SET PS-UPDATE-SEL-QUEUE  TO TRUE                     14740099
                   PERFORM 5000-PREPARE-SEL-QUEUE                       14750099
                   MOVE SPACE               TO ASC-ACTION-SW            14760099
                   IF ASC-SEL-XFER-NBR NOT = SPACES                     14770099
                       PERFORM 3600-SELECT-CURR-XFER-STATUS             14780099
                       IF TFSTAT-XFER-STAT-CDE NOT =                            
                                             PC-COMPLETE-STATUS    AND          
                          TFSTAT-XFER-STAT-CDE NOT =                            
                                             PC-ASSUMPTIVE-STATUS               
                           SET PS-ERROR                                 14820099
                               DP030-OVERRIDE-GO                        20010002
                               DP020-MSG-FATAL TO TRUE                  20020099
      *       -- CANNOT VOID TRANSFER WITH THIS STATUS --               20030099
                           MOVE TFSTCD-XFER-STAT-DESC                   20040099
                                                    TO  DP020-MSG-TEXT  20050099
                           MOVE PC-TSYMSG-01402                         20060099
                                                TO DP020-MSG-NUMBER     20070099
                       ELSE                                             20080099
                           INITIALIZE TF001-INTER-APPL-COMMAREA         20090099
100404*                    MOVE ASC-SEL-XFER-NBR(1:3)                   20100099
100404*                                         TO TF001-XFER-NBR(1:3)  20110099
100404*                    MOVE ASC-SEL-XFER-NBR(5:6)                   20120099
100404*                                         TO TF001-XFER-NBR(4:6)  20130099
100404                     MOVE ASC-SEL-XFER-NBR(1:4)                   20100099
100404                                          TO TF001-XFER-NBR(1:4)  20110099
100404                     MOVE ASC-SEL-XFER-NBR(6:6)                   20120099
100404                                          TO TF001-XFER-NBR(5:6)  20130099
                           MOVE PC-TSYMSG-01403 TO DP020-MSG-NUMBER     20140099
                           MOVE 'F16-FKEY'      TO DP020-MSG-TEXT       29420002
                           SET DP020-MSG-INFORMATIONAL  TO TRUE         29430099
                       END-IF                                           29440099
                   ELSE                                                 29450099
                       SET PS-ERROR                                     29450199
                           DP030-OVERRIDE-GO                            29450202
                           DP020-MSG-FATAL TO TRUE                      29450399
      *                    -- A LIST ITEM MUST BE SELECTED FOR THIS     29450499
      *                       FUNCTION --                               29450599
                       MOVE PC-TSYMSG-00057 TO DP020-MSG-NUMBER         29450699
                   END-IF                                               29450799
                 END-IF                                                 29450899
                                                                        29450999
               WHEN DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)              29451099
      *-------- PRT DOC -----------------------------------------------*14460099
                 IF ASC-NUMBER-OF-SELECTED-ITEMS > +1                   29453099
      **       -- ONLY ONE LIST ITEM MAY BE SELECTED FOR THIS FUNCTION -29454099
                     SET DP030-OVERRIDE-GO                              29455099
                         DP020-MSG-FATAL                                29456099
                         PS-ERROR             TO TRUE                   29457099
                     MOVE PC-TSYMSG-00047     TO DP020-MSG-NUMBER       29458099
                 ELSE                                                   29459099
                   SET PS-UPDATE-SEL-QUEUE  TO TRUE                     29460099
                   PERFORM 5000-PREPARE-SEL-QUEUE                       29470099
                   IF PS-XFER-NBR-CHG                                   29480099
                       MOVE SPACE               TO ASC-ACTION-SW        29490099
                   END-IF                                               29500099
                   IF ASC-SEL-XFER-NBR NOT = SPACES                     29510099
                       PERFORM 3600-SELECT-CURR-XFER-STATUS             29520099
                       IF TFSTAT-XFER-STAT-CDE = PC-VOID-STATUS         29530099
                           SET PS-ERROR                                 29530199
                               DP030-OVERRIDE-GO                        29530202
                               DP020-MSG-FATAL TO TRUE                  29530399
      *       -- CANNOT PRINT THE DOCUMENT; TRANSFER WAS VOIDED --      29530499
                           MOVE PC-TSYMSG-01399                         29530699
                                                TO DP020-MSG-NUMBER     29530799
                       ELSE                                             29530899
                           SET ASC-PRT-DOC-REQUESTED TO TRUE            29530999
                           INITIALIZE TF001-INTER-APPL-COMMAREA         29531099
080204                     MOVE DP020-LOCATION-NBR                              
080204                                   TO RFWS009-STORE-NBR                   
080204                     MOVE RFWS009-STORE-PRINTER-DEST                      
080204                                   TO TF001-PRINTER-DEST                  
                           MOVE ASC-SEL-XFER-NBR                        29535099
                                         TO PV-DISPL-XFER-NBR           29536099
100404                     MOVE PV-DISPL-XFER-1-4                       29537099
100404                                   TO PV-XFER-1-4                 29538099
100404                     MOVE PV-DISPL-XFER-5-10                      29539099
100404                                   TO PV-XFER-5-10                29540099
                           MOVE PV-XFER-NBR  TO TF001-XFER-NBR          29550099
                       END-IF                                           29560099
                   ELSE                                                 29570099
                       SET PS-ERROR                                     29570199
                           DP030-OVERRIDE-GO                            29570202
                           DP020-MSG-FATAL TO TRUE                      29570399
      *           -- A LIST ITEM MUST BE SELECTED FOR THIS              29570499
      *              FUNCTION --                                        29570599
                       MOVE PC-TSYMSG-00057 TO DP020-MSG-NUMBER         29570699
                   END-IF                                               29570799
                 END-IF                                                 29570899
                                                                        29570999
               WHEN DP020-FK-LOCAL-FUNC-05 (DP020-SRC-AID)              29571099
      *-------- PRT LIST ----------------------------------------------*14460099
                   SET ASC-PRINT-LIST-REQUEST TO TRUE                   29573099
                   INITIALIZE TF001-DRS-DATA                            29574099
080204             MOVE DP020-LOCATION-NBR TO RFWS009-STORE-NBR                 
080204             MOVE RFWS009-STORE-PRINTER-DEST                              
080204                                     TO TF001-PRINTER-DEST                
                                                                        29450999
               WHEN DP020-FK-LOCAL-FUNC-06 (DP020-SRC-AID)              29451099
      *-------- RESET -------------------------------------------------*14460099
                 IF ASC-NUMBER-OF-SELECTED-ITEMS > +1                   29453099
      **       -- ONLY ONE LIST ITEM MAY BE SELECTED FOR THIS FUNCTION -29454099
                     SET DP030-OVERRIDE-GO                              29455099
                         DP020-MSG-FATAL                                29456099
                         PS-ERROR             TO TRUE                   29457099
                     MOVE PC-TSYMSG-00047     TO DP020-MSG-NUMBER       29458099
                 ELSE                                                   29459099
                   SET PS-UPDATE-SEL-QUEUE  TO TRUE                     29460099
                   PERFORM 5000-PREPARE-SEL-QUEUE                       29470099
                   IF PS-XFER-NBR-CHG                                   29480099
                       MOVE SPACE               TO ASC-ACTION-SW        29490099
                   END-IF                                               29500099
                   IF ASC-SEL-XFER-NBR NOT = SPACES                     29510099
                       PERFORM 3600-SELECT-CURR-XFER-STATUS             29520099
                       EVALUATE TFSTAT-XFER-STAT-CDE                            
                           WHEN PC-COMPLETE-STATUS                              
                           WHEN PC-INTERMEDIATE-STATUS                          
                           WHEN PC-ASSUMPTIVE-STATUS                            
                               CONTINUE                                         
                           WHEN OTHER                                           
                               SET PS-ERROR                             29530199
                                   DP030-OVERRIDE-GO                    29530202
                                   DP020-MSG-FATAL TO TRUE              29530399
      *       -- CANNOT RESET TRANSFER WITH THIS STATUS --              29530499
                               MOVE TFSTCD-XFER-STAT-DESC                       
                                                   TO  DP020-MSG-TEXT           
                               MOVE PC-TSYMSG-01581                     29530699
                                                TO DP020-MSG-NUMBER     29530799
                       END-EVALUATE                                             
                       IF PS-NO-ERROR                                           
                           PERFORM 3050-CHK-IN-PROCESS                          
                       END-IF                                                   
                       IF PS-NO-ERROR                                           
                           INITIALIZE TF001-INTER-APPL-COMMAREA                 
100404*                    MOVE ASC-SEL-XFER-NBR(1:3)                   20100099
100404*                                         TO TF001-XFER-NBR(1:3)  20110099
100404*                    MOVE ASC-SEL-XFER-NBR(5:6)                   20120099
100404*                                         TO TF001-XFER-NBR(4:6)  20130099
100404                     MOVE ASC-SEL-XFER-NBR(1:4)                   20100099
100404                                          TO TF001-XFER-NBR(1:4)  20110099
100404                     MOVE ASC-SEL-XFER-NBR(6:6)                   20120099
100404                                          TO TF001-XFER-NBR(5:6)  20130099
                           MOVE ASC-SEL-XFER-DKEY-ID                            
                                                 TO TF001-DKEY-ID               
                           MOVE PC-TSYMSG-01403                                 
                                                TO DP020-MSG-NUMBER             
                           MOVE 'F23-FKEY'    TO DP020-MSG-TEXT         29420002
                           SET DP020-MSG-INFORMATIONAL  TO TRUE                 
                       END-IF                                           29530899
                   ELSE                                                 29570099
                       SET PS-ERROR                                     29570199
                           DP030-OVERRIDE-GO                            29570202
                           DP020-MSG-FATAL TO TRUE                      29570399
      *           -- A LIST ITEM MUST BE SELECTED FOR THIS              29570499
      *              FUNCTION --                                        29570599
                       MOVE PC-TSYMSG-00057 TO DP020-MSG-NUMBER         29570699
                   END-IF                                               29570799
                 END-IF                                                 29570899
                                                                        29577099
               WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                  29578099
                   MOVE SPACE               TO ASC-ACTION-SW            29579099
                   MOVE +1                  TO PV-TOP-ITEM              29580099
                   PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 29590099
                                                                        29600099
               WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                   29610099
                   MOVE SPACE               TO ASC-ACTION-SW            29620099
                   PERFORM 2110-BROWSE-BACKWARD                         29630099
                   PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 29640099
                                                                        29650099
               WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                   29660099
                   MOVE SPACE               TO ASC-ACTION-SW            29670099
                   PERFORM 2120-BROWSE-FORWARD                          29680099
                   PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 29690099
                                                                        29700099
               WHEN DP020-SRC-AID = DP016-ENTER                         29710099
                   MOVE SPACE               TO ASC-ACTION-SW            29720099
                   PERFORM 2130-CHECK-FOR-JUMP-BROWSE                   29730099
                   IF  PS-ERROR                                         29740099
                       CONTINUE                                         29750099
                   ELSE                                                 29760099
                       PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             29770099
                   END-IF                                               29780099
                                                                        29790099
               WHEN OTHER                                               29800099
                   SET DP013-NO-ROLLBACK                                29810099
                       DP013-XCTL-DISPLAY-RESTART                       29820099
                       DP013-CICS-ABEND  TO TRUE                        29830099
                   MOVE '2100-CHECK-FUNCTION-KEY'                       29840099
                                         TO DP013-PARAGRAPH             29850099
                   MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      29860099
                                         TO DP013-MESSAGE-TEXT (1)      29870099
                   PERFORM DP013-0000-PROCESS-ABEND                     29880099
           END-EVALUATE.                                                29890099
      *                                                                 29900099
      *----------------------------------------------------------------*29910099
      *    IF THE USER HITS THE PAGE BACKWARD KEY, COMPUTE THE TOP     *29920099
      *    ITEM NUMBER FOR THE NEW PAGE.  IF IT IS ABOVE THE TOP,      *29930099
      *    SET THE TOP ITEM NUMBER TO +1 AND DISPLAY THE TOP OF LIST   *29940099
      *    MESSAGE.                                                    *29950099
      *----------------------------------------------------------------*29960099
                                                                        29970099
       2110-BROWSE-BACKWARD.                                            29980099
           SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    29990099
               GIVING PV-TOP-ITEM.                                      30000099
      *                                                                 30010099
           IF  ((PV-TOP-ITEM < +1)                                      30020099
             OR (PV-TOP-ITEM = +1))                                     30030099
               MOVE +1                   TO PV-TOP-ITEM                 30040099
      *        -- TOP OF LIST --                                        30050099
               MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            30060099
               SET DP020-MSG-INFORMATIONAL TO TRUE                      30070099
           END-IF.                                                      30080099
                                                                        30090099
       EJECT                                                            30100099
      *----------------------------------------------------------------*30110099
      *    IF THE USER HITS THE PAGE FORWARD KEY, COMPUTE THE TOP      *30120099
      *    ITEM NUMBER FOR THE NEW PAGE.  IF THE USER ATTEMPTS TO GO   *30130099
      *    PAST THE END, ISSUE THE BOTTOM OF LIST MESSAGE.             *30140099
      *----------------------------------------------------------------*30150099
                                                                        30160099
       2120-BROWSE-FORWARD.                                             30170099
                                                                        30180099
           ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              30190099
               GIVING PV-TOP-ITEM.                                      30200099
           IF  PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                   30210099
               MOVE ASC-ITEM-AT-TOP-OF-PANEL                            30220099
                                         TO PV-TOP-ITEM                 30230099
      *        -- BOTTOM OF LIST --                                     30240099
               MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            30250099
               SET DP020-MSG-INFORMATIONAL                              30260099
                                         TO TRUE                        30270099
           ELSE                                                         30280099
               COMPUTE PV-BOTTOM-ITEM =                                 30290099
                   PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 30300099
               IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ            30310099
      *            -- BOTTOM OF LIST --                                 30320099
                   MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            30330099
                   SET DP020-MSG-INFORMATIONAL                          30340099
                                         TO TRUE                        30350099
               END-IF                                                   30360099
           END-IF.                                                      30370099
       EJECT                                                            30380099
      *----------------------------------------------------------------*30390099
      *    THE USER CAN CHANGE THE CURRENT BEGINNING LIST NUMBER SO    *30400099
      *    THAT THE TRANSACTION WILL JUMP TO THAT POINT IN THE LIST.   *30410099
      *    THIS IS A FASTER WAY TO GET TO A CERTAIN POINT IN THE LIST  *30420099
      *    RATHER THAN HITTING NEXT-PAGE TO GET TO THAT POINT.         *30430099
      *    THE NEW LIST NUMBER ENTERED IS EDITED TO MAKE SURE THAT     *30440099
      *    IT IS NUMERIC AND FALLS BETWEEN A SPECIFIED RANGE.          *30450099
      *----------------------------------------------------------------*30460099
                                                                        30470099
       2130-CHECK-FOR-JUMP-BROWSE.                                      30480099
           SET PS-NO-ERROR               TO TRUE.                       30490099
           IF (ASC-START-ITEM-REQUEST = SPACE)                          30500099
               MOVE ASC-ITEM-AT-TOP-OF-PANEL                            30510099
                                         TO PV-TOP-ITEM                 30520099
           ELSE                                                         30530099
               MOVE ASC-START-ITEM-REQUEST                              30540099
                                         TO DP010I-UNEDITED-FIELD       30550099
               MOVE PC-ITEM-NUMBER-LENGTH TO DP010I-MAXIMUM-DIGITS      30560099
               MOVE +0                   TO DP010I-MAXIMUM-DECIMALS     30570099
               SET DP010I-NEGATIVE-NOT-ALLOWED                          30580099
                                         TO TRUE                        30590099
               CALL DP010I-NUMERIC-EDIT-ROUTINE                                 
                         USING DP010I-NUMERIC-EDIT-AREA                         
                                                                        30610099
               IF  NOT DP010I-ERROR-DETECTED                            30620099
                   MOVE DP010I-NUMERIC-FIELD                            30630099
                                         TO  ASC-START-ITEM-REQUEST-N   30640099
                   IF  ASC-START-ITEM-REQUEST-N > ZERO                  30650099
                       IF  ASC-START-ITEM-REQUEST-N >                   30660099
                                                ASC-NUMBER-OF-ITEMS-READ30670099
                           MOVE SPACE TO ASC-START-ITEM-REQUEST         30680099
                           COMPUTE PV-TOP-ITEM =                        30690099
                                   ASC-NUMBER-OF-ITEMS-READ             30700099
                                   - PC-ITEMS-PER-PANEL + 1             30710099
                           IF  PV-TOP-ITEM < +1                         30720099
                               MOVE +1   TO PV-TOP-ITEM                 30730099
                               MOVE PC-TSYMSG-00070                     30740099
                                         TO DP020-MSG-NUMBER            30750099
                               SET DP020-MSG-INFORMATIONAL              30760099
                                         TO TRUE                        30770099
                           END-IF                                       30780099
                       ELSE                                             30790099
                           MOVE ASC-START-ITEM-REQUEST-N                30800099
                                         TO PV-TOP-ITEM                 30810099
                           MOVE SPACE    TO ASC-START-ITEM-REQUEST      30820099
                           COMPUTE PV-BOTTOM-ITEM =                     30830099
                               PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1     30840099
                           IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ30850099
      *                        -- BOTTOM OF LIST --                     30860099
                               MOVE PC-TSYMSG-00070                     30870099
                                         TO DP020-MSG-NUMBER            30880099
                               SET DP020-MSG-INFORMATIONAL              30890099
                                         TO TRUE                        30900099
                           END-IF                                       30910099
                       END-IF                                           30920099
                   ELSE                                                 30930099
      *                --- VALUE OUT OF RANGE ----                      30940099
                       MOVE PC-TSYMSG-00101                             30950099
                                         TO DP020-MSG-NUMBER            30960099
                       MOVE -1           TO ASTRTITL                    30970099
                       SET DP030-SET-CURSOR-APPL-1                      30980099
                                         TO TRUE                        30990099
                       MOVE DP015-REVERSE                               31000099
                                         TO ASTRTITH                    31010099
                       MOVE DP015-RED    TO ASTRTITC                    31020099
                       MOVE DP015-UNP-NUM-BRT-MDT                       31030099
                                         TO ASTRTITA                    31040099
                       SET DP020-MSG-FATAL                              31050099
                                         TO TRUE                        31060099
                       SET PS-ERROR      TO TRUE                        31070099
                   END-IF                                               31080099
                                                                        31090099
               ELSE                                                     31100099
                   MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            31110099
                   MOVE -1               TO ASTRTITL                    31120099
                   SET DP030-SET-CURSOR-APPL-1 TO TRUE                  31130099
                   MOVE DP015-REVERSE    TO ASTRTITH                    31140099
                   MOVE DP015-RED        TO ASTRTITC                    31150099
                   MOVE DP015-UNP-NUM-BRT-MDT                           31160099
                                         TO ASTRTITA                    31170099
                   SET DP020-MSG-FATAL   TO TRUE                        31180099
                   SET PS-ERROR          TO TRUE                        31190099
               END-IF                                                   31200099
           END-IF.                                                      31210099
       EJECT                                                            31220099
      *----------------------------------------------------------------*31230099
      *    IF THE USER HITS THE DESELECT KEY, CLEAR THE SELECTION      *31240099
      *    SWITCH FOR ALL ITEMS THAT WERE PREVIOUSLY SELECTED.         *31250099
      *----------------------------------------------------------------*31260099
       2140-DESELECT-ALL-ITEMS.                                         31270099
           MOVE +1                       TO ASC-BLK-SUB.                31280099
                                                                        31290099
           PERFORM 2141-CLEAR-SELECTED-INDS                             31300099
               VARYING ASC-ITEM-SUB                                     31310099
               FROM 1 BY 1                                              31320099
               UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 31330099
                                                                        31340099
           ADD +1                        TO ASC-BLK-SUB.                31350099
                                                                        31360099
           PERFORM 2141-CLEAR-SELECTED-INDS                             31370099
               VARYING ASC-ITEM-SUB                                     31380099
               FROM 1 BY 1                                              31390099
               UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 31400099
                                                                        31410099
           MOVE ASC-LIST-ITEM-NUMBER(1 1)                               31420099
                                         TO PV-LIST-ITEM-NUMBER.        31430099
                                                                        31440099
           COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            31450099
               1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    31460099
                                                                        31470099
           IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     31480099
              (ASC-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)      31490099
               MOVE +1                   TO ASC-BLK-SUB                 31500099
                                                                        31510099
               PERFORM 5100-WRITE-TEMP-STORAGE                          31520099
                                                                        31530099
               MOVE +1                   TO PV-BLOCK-NUMBER             31540099
                                                                        31550099
               COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         31560099
                   PV-FIRST-BLOCK-IN-ARRAY - 1                          31570099
                                                                        31580099
               PERFORM                                                  31590099
                   UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       31600099
                                                                        31610099
                   PERFORM 4410-READ-TEMP-STORAGE                       31620099
                                                                        31630099
                   PERFORM 2141-CLEAR-SELECTED-INDS                     31640099
                       VARYING ASC-ITEM-SUB FROM 1 BY 1                 31650099
                       UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          31660099
                                                                        31670099
                   PERFORM 5100-WRITE-TEMP-STORAGE                      31680099
                                                                        31690099
                   ADD +1                TO PV-BLOCK-NUMBER             31700099
                                                                        31710099
               END-PERFORM                                              31720099
                                                                        31730099
               COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         31740099
                   PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     31750099
                                                                        31760099
               PERFORM                                                  31770099
                   UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       31780099
                         ASC-HIGHEST-BLOCK-WRITTEN                      31790099
                                                                        31800099
                   MOVE PV-NEXT-BLOCK-IN-ARRAY                          31810099
                                         TO PV-BLOCK-NUMBER             31820099
                                                                        31830099
                   PERFORM 4410-READ-TEMP-STORAGE                       31840099
                                                                        31850099
                   PERFORM 2141-CLEAR-SELECTED-INDS                     31860099
                       VARYING ASC-ITEM-SUB                             31870099
                       FROM 1 BY 1                                      31880099
                       UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          31890099
                                                                        31900099
                   PERFORM 5100-WRITE-TEMP-STORAGE                      31910099
                                                                        31920099
                   ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      31930099
                                                                        31940099
               END-PERFORM                                              31950099
                                                                        31960099
               MOVE PV-FIRST-BLOCK-IN-ARRAY                             31970099
                                         TO PV-BLOCK-NUMBER             31980099
                                                                        31990099
               PERFORM 4410-READ-TEMP-STORAGE                           32000099
           END-IF.                                                      32010099
                                                                        32020099
                                                                        32030099
           MOVE +0                     TO ASC-NUMBER-OF-SELECTED-ITEMS. 32040099
           MOVE +0                       TO ASC-START-OF-SELECTED-RANGE.DPKCS036
           MOVE +0                       TO ASC-END-OF-SELECTED-RANGE.  DPKCS036
                                                                        32050099
       EJECT                                                            32060099
      *----------------------------------------------------------------*32070099
      *    MARK EACH ITEM AS BEING NOT SELECTED.                       *32080099
      *----------------------------------------------------------------*32090099
                                                                        32100099
       2141-CLEAR-SELECTED-INDS.                                        32110099
                                                                        32120099
           IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           32130099
                   NOT EQUAL ZERO                                       32140099
               IF  NOT ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          32150099
                   SET ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          32160099
                       ASC-TEMP-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)    32170099
                       ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  32180099
                                         TO TRUE                        32190099
               END-IF                                                   32200099
           END-IF.                                                      32210099
                                                                        32220099
       EJECT                                                            32230099
      *----------------------------------------------------------------*DPKCS036
      *  IF THE USER HITS THE SELECT-ALL KEY, SET THE SELECTIO SWITCH  *DPKCS036
      *  FOR ALL ITEMS.                                                *DPKCS036
      *----------------------------------------------------------------*DPKCS036
       2150-SELECT-ALL-ITEMS.                                           DPKCS036
                                                                        DPKCS036
           MOVE +1                       TO ASC-BLK-SUB.                DPKCS036
                                                                        DPKCS036
           PERFORM 2151-SET-SELECTED-INDS                               DPKCS036
               VARYING ASC-ITEM-SUB                                     DPKCS036
               FROM 1 BY 1                                              DPKCS036
               UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 DPKCS036
                                                                        DPKCS036
           ADD +1                        TO ASC-BLK-SUB.                DPKCS036
                                                                        DPKCS036
           PERFORM 2151-SET-SELECTED-INDS                               DPKCS036
               VARYING ASC-ITEM-SUB                                     DPKCS036
               FROM 1 BY 1                                              DPKCS036
               UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 DPKCS036
                                                                        DPKCS036
           MOVE ASC-LIST-ITEM-NUMBER(1 1)                               DPKCS036
                                         TO PV-LIST-ITEM-NUMBER.        DPKCS036
                                                                        DPKCS036
           COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            DPKCS036
               1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    DPKCS036
                                                                        DPKCS036
           IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     DPKCS036
              (ASC-HIGHEST-BLOCK-WRITTEN >   PC-MAX-BLOCKS-IN-ARRAY)    DPKCS036
               MOVE +1                   TO ASC-BLK-SUB                 DPKCS036
                                                                        DPKCS036
               PERFORM 5100-WRITE-TEMP-STORAGE                          DPKCS036
                                                                        DPKCS036
               MOVE +1                   TO PV-BLOCK-NUMBER             DPKCS036
                                                                        DPKCS036
               COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         DPKCS036
                   PV-FIRST-BLOCK-IN-ARRAY - 1                          DPKCS036
                                                                        DPKCS036
               PERFORM                                                  DPKCS036
                   UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       DPKCS036
                                                                        DPKCS036
                   PERFORM 4410-READ-TEMP-STORAGE                       DPKCS036
                                                                        DPKCS036
                   PERFORM 2151-SET-SELECTED-INDS                       DPKCS036
                       VARYING ASC-ITEM-SUB                             DPKCS036
                       FROM 1 BY 1                                      DPKCS036
                       UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          DPKCS036
                                                                        DPKCS036
                   PERFORM 5100-WRITE-TEMP-STORAGE                      DPKCS036
                                                                        DPKCS036
                   ADD +1                TO PV-BLOCK-NUMBER             DPKCS036
                                                                        DPKCS036
               END-PERFORM                                              DPKCS036
                                                                        DPKCS036
               COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         DPKCS036
                   PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     DPKCS036
                                                                        DPKCS036
               PERFORM                                                  DPKCS036
                   UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       DPKCS036
                         ASC-HIGHEST-BLOCK-WRITTEN                      DPKCS036
                                                                        DPKCS036
                   MOVE PV-NEXT-BLOCK-IN-ARRAY                          DPKCS036
                                         TO PV-BLOCK-NUMBER             DPKCS036
                                                                        DPKCS036
                   PERFORM 4410-READ-TEMP-STORAGE                       DPKCS036
                                                                        DPKCS036
                   PERFORM 2151-SET-SELECTED-INDS                       DPKCS036
                       VARYING ASC-ITEM-SUB                             DPKCS036
                       FROM 1 BY 1                                      DPKCS036
                       UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          DPKCS036
                                                                        DPKCS036
                   PERFORM 5100-WRITE-TEMP-STORAGE                      DPKCS036
                                                                        DPKCS036
                   ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      DPKCS036
                                                                        DPKCS036
               END-PERFORM                                              DPKCS036
                                                                        DPKCS036
               MOVE PV-FIRST-BLOCK-IN-ARRAY                             DPKCS036
                                         TO PV-BLOCK-NUMBER             DPKCS036
                                                                        DPKCS036
               PERFORM 4410-READ-TEMP-STORAGE                           DPKCS036
           END-IF.                                                      DPKCS036
                                                                        DPKCS036
                                                                        DPKCS036
           MOVE ASC-NUMBER-OF-ITEMS-READ TO                             DPKCS036
                             ASC-NUMBER-OF-SELECTED-ITEMS.              DPKCS036
                                                                        DPKCS036
           PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        DPKCS036
                                                                        DPKCS036
       EJECT                                                            DPKCS036
      *----------------------------------------------------------------*DPKCS036
      *    MARK EACH ITEM AS BEING SELECTED.                           *DPKCS036
      *----------------------------------------------------------------*DPKCS036
                                                                        DPKCS036
       2151-SET-SELECTED-INDS.                                          DPKCS036
                                                                        DPKCS036
           IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           DPKCS036
                   NOT EQUAL ZERO                                       DPKCS036
               IF  NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             DPKCS036
                   SET ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             DPKCS036
                       ASC-TEMP-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)        DPKCS036
                       ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  DPKCS036
                                     TO  TRUE                           DPKCS036
               END-IF                                                   DPKCS036
           END-IF.                                                      DPKCS036
      *----------------------------------------------------------------*32240099
      * FILL IN THE INTER APPLICATION COMMAREA FIELDS FOR A TRANSFER   *32250099
      * INQUIRY.                                                       *32260099
      *----------------------------------------------------------------*32270099
                                                                        32280099
       2170-PREP-XFER-INQ-COMMAREA.                                     32290099
                                                                        32300099
           SET TF001-INITIALLY-FROM-CRIT-LIST TO TRUE.                  32310099
100404*    MOVE ASC-SEL-XFER-NBR(1:3)    TO TF001-XFER-NBR(1:3).        32320099
100404*    MOVE ASC-SEL-XFER-NBR(5:6)    TO TF001-XFER-NBR(4:6).        32330099
100404     MOVE ASC-SEL-XFER-NBR(1:4)    TO TF001-XFER-NBR(1:4).        32320099
100404     MOVE ASC-SEL-XFER-NBR(6:6)    TO TF001-XFER-NBR(5:6).        32330099
           MOVE ASC-XFER-TYPE            TO TF001-XFER-TYPE.            32340099
           MOVE ASC-XFER-STATUS          TO TF001-XFER-STATUS.          32350099
           MOVE ASC-XFER-FROM-STR        TO TF001-XFER-FROM-STR.        32360099
           MOVE ASC-XFER-TO-STR          TO TF001-XFER-TO-STR.          32370099
           MOVE ASC-XFER-COMP-BEG-DTE    TO TF001-XFER-COMP-BEG-DTE.    32380099
           MOVE ASC-XFER-COMP-END-DTE    TO TF001-XFER-COMP-END-DTE.    32390099
           MOVE ASC-XFER-RECV-BEG-DTE    TO TF001-XFER-RECV-BEG-DTE.    32400099
           MOVE ASC-XFER-RECV-END-DTE    TO TF001-XFER-RECV-END-DTE.    32410099
           MOVE ASC-XFER-DPT             TO TF001-XFER-DPT.             32420099
           MOVE ASC-XFER-CLASS           TO TF001-XFER-CLASS.           32430099
           MOVE ASC-XFER-SUBCL           TO TF001-XFER-SUBCLASS.        32430099
           MOVE ASC-XFER-UPC             TO TF001-XFER-UPC.             32420099
           MOVE ASC-XFER-CALLBACK-NBR    TO TF001-XFER-CALLBACK-NBR.    32440099
           MOVE ASC-XFER-APPROVAL-NBR    TO TF001-XFER-APPROVAL-NBR.    32450099
           MOVE ASC-XFER-COMP-BY-FIRST-INIT                             32460099
                                       TO TF001-XFER-COMP-BY-FIRST-INIT.32470099
           MOVE ASC-XFER-COMP-BY-LAST-NAME                              32480099
                                       TO TF001-XFER-COMP-BY-LAST-NAME. 32490099
           MOVE ASC-XFER-RECV-BY-FIRST-INIT                             32500099
                                       TO TF001-XFER-RECV-BY-FIRST-INIT.32510099
           MOVE ASC-XFER-RECV-BY-LAST-NAME                              32520099
                                       TO TF001-XFER-RECV-BY-LAST-NAME. 32530099
           MOVE ASC-XFER-DISPLAY-TOT     TO TF001-XFER-DISPLAY-TOT.     32540099
           MOVE ASC-XFER-TYPE-SORT-NR    TO TF001-XFER-TYPE-SORT-NR.    32550099
           MOVE ASC-XFER-STATUS-SORT-NR                                 32560099
                                         TO TF001-XFER-STATUS-SORT-NR.  32570099
           MOVE ASC-XFER-FROM-STR-SORT-NR                               32580099
                                         TO TF001-XFER-FROM-STR-SORT-NR.32590099
           MOVE ASC-XFER-TO-STR-SORT-NR                                 32600099
                                         TO TF001-XFER-TO-STR-SORT-NR.  32610099
           MOVE ASC-XFER-COMP-DTE-SORT-NR                               32620099
                                         TO TF001-XFER-COMP-DTE-SORT-NR.32630099
           MOVE ASC-XFER-RECV-DTE-SORT-NR                               32640099
                                         TO TF001-XFER-RECV-DTE-SORT-NR.32650099
           MOVE ASC-XFER-CALLBCK-NR-SORT-NR                             32660099
                                       TO TF001-XFER-CALLBCK-NR-SORT-NR.32670099
           MOVE ASC-XFER-APPRV-NR-SORT-NR                               32680099
                                         TO TF001-XFER-APPRV-NR-SORT-NR.32690099
                                                                        32700099
       EJECT                                                            32710099
      ******************************************************************32720099
      ** MOVE ALL OF THE FIELDS THAT WERE ENTERED / CHANGED ON THE    **32730099
      ** SCREEN INTO THE COMMAREA.  ALL EDITTING IS DONE IN THE COMM. **32740099
      ******************************************************************32750099
       2200-MOVE-SCREEN-TO-COMMAREA.                                    32760099
                                                                        32770099
           MOVE PV-TOP-ITEM              TO PV-ITEM-IN-USE.             32780099
           MOVE +1                       TO PV-SUB.                     32790099
      *                                                                 32800099
           PERFORM 3100-SET-SUBSCRIPTS.                                 32810099
           IF  ASTRTITL > ZERO                                          32820099
               MOVE ASTRTITI         TO ASC-START-ITEM-REQUEST          32830099
           ELSE                                                         32840099
               IF  ASTRTITF = DP015-ERASE-EOF                           32850099
                   INITIALIZE ASC-START-ITEM-REQUEST                    32860099
               END-IF                                                   32870099
           END-IF.                                                      32880099
           PERFORM 2210-MOVE-LINES-TO-COMMAREA                          32890099
               VARYING PV-SUB                                           32900099
               FROM 1 BY 1                                              32910099
               UNTIL PV-SUB > ASC-ITEMS-DISPLAYED.                      32920099
      ******************************************************************32930099
      ** MOVE THE ENTERABLE FIELDS ON EACH LIST LINE INTO THE COMMAREA**32940099
      ******************************************************************32950099
       2210-MOVE-LINES-TO-COMMAREA.                                     32960099
                                                                        32970099
           IF  MR-SELECTL (PV-SUB) > ZERO                               32980099
               SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE             32990099
               MOVE MR-SELECTI (PV-SUB)                                 33000099
                                         TO ASC-TEMP-SELECTED-SW        33010099
                                       (ASC-BLK-SUB, ASC-ITEM-SUB)      33020099
           ELSE                                                         33030099
               IF  MR-SELECTA (PV-SUB) = DP015-ERASE-EOF                33040099
                       SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE     33050099
                       MOVE SPACE        TO ASC-TEMP-SELECTED-SW        33060099
                                       (ASC-BLK-SUB, ASC-ITEM-SUB)      33070099
               END-IF                                                   33080099
           END-IF.                                                      33090099
                                                                        33100099
           ADD +1                        TO ASC-ITEM-SUB.               33110099
                                                                        33120099
           IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        33130099
               ADD +1                    TO ASC-BLK-SUB                 33140099
               MOVE +1                   TO ASC-ITEM-SUB                33150099
           END-IF.                                                      33160099
                                                                        33170099
      ******************************************************************33180099
      ** EDIT ALL OF THE DATA ON THE SCREEN AS IT RESIDES IN THE      **33190099
      ** COMMAREA (EDITTING IS NOT DONE AGAINST THE SCREEN DIRECTLY). **33200099
      ******************************************************************33210099
       3000-EDIT-DATA-IN-COMMAREA.                                      33220099
                                                                        33230099
           SET PS-NO-ERROR               TO TRUE.                       33240099
           PERFORM 3200-RESET-ATTRIBUTES.                               33250099
           MOVE ASC-ITEMS-DISPLAYED      TO PV-SUB.                     33260099
                                                                        33270099
           COMPUTE PV-ITEM-IN-USE =  PV-TOP-ITEM +                      33280099
               ASC-ITEMS-DISPLAYED - 1.                                 33290099
           PERFORM 3100-SET-SUBSCRIPTS.                                 33300099
           PERFORM 3300-EDIT-SELECTIONS                                 33310099
              VARYING PV-SUB                                            33320099
              FROM PV-SUB BY -1                                         33330099
              UNTIL PV-SUB < +1.                                        33340099
                                                                        33350099
           IF  PS-NO-ERROR                                              DPKCS036
               PERFORM 3400-CHECK-RANGE-SEQUENCE                        DPKCS036
           END-IF.                                                      DPKCS036
      *                                                                 DPKCS036
           IF  ((PS-NO-ERROR)                                           DPKCS036
             AND (ASC-START-OF-SELECTED-RANGE > ZERO)                   DPKCS036
             AND (ASC-END-OF-SELECTED-RANGE > ZERO))                    DPKCS036
                   PERFORM 3500-MARK-RANGE-AS-SELECTED                  DPKCS036
           END-IF.                                                      DPKCS036
      *----------------------------------------------------------------*        
      *  CHECK TO SEE IF THE TRANSFER IS IN PROCESS.                            
      *----------------------------------------------------------------*        
       3050-CHK-IN-PROCESS.                                                     
           PERFORM 7150-SELECT-MAX-RCPT-TMST.                                   
                                                                                
           IF PV-NULL-IND IS NOT NEGATIVE                                       
               PERFORM 7200-SELECT-CURRENT-RCPT                                 
               IF TFRCPT-RCV-XFER-BEG-TMST IS NOT =                             
                                               TFRCPT-RCV-XFER-END-TMST         
                   SET DP030-OVERRIDE-GO                                20010002
                       DP020-MSG-FATAL                                          
                       PS-ERROR               TO  TRUE                          
                   MOVE PC-TSYMSG-01583       TO  DP020-MSG-NUMBER              
               END-IF                                                           
           ELSE                                                                 
               SET DP030-OVERRIDE-GO                                    20010002
                   DP020-MSG-FATAL                                              
                   PS-ERROR               TO  TRUE                              
               MOVE PC-TSYMSG-01583  TO  DP020-MSG-NUMBER                       
           END-IF.                                                              
                                                                        33440099
       EJECT                                                            33450099
      *----------------------------------------------------------------*33460099
      *    DETERMINE THE VALUE OF THE ITEM SUBSCRIPT BASED ON THE ITEM *33470099
      *    CURRENTLY IN USE AND THE FIRST ITEM IN THE ARRAY.  THIS WILL*33480099
      *    POSITION US IN THE 1ST BLOCK OF THE ARRAY.                  *33490099
      *                                                                *33500099
      *    IF THE ITEM SUBSCRIPT EXCEEDS THE MAXIMUM NUMBER OF ITEMS   *33510099
      *    IN A BLOCK, RECALCULATE THE SUBSCRIPT BY SUBTRACTING OUT    *33520099
      *    THE MAXIMUM NUMBER OF ITEMS.  THIS WILL CORRECTLY POSITION  *33530099
      *    US IN THE 2ND BLOCK OF THE ARRAY.                           *33540099
      *----------------------------------------------------------------*33550099
                                                                        33560099
       3100-SET-SUBSCRIPTS.                                             33570099
                                                                        33580099
           COMPUTE ASC-ITEM-SUB =                                       33590099
               (PV-ITEM-IN-USE - ASC-LIST-ITEM-NUMBER(1 1)) + 1.        33600099
                                                                        33610099
           IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         33620099
               PERFORM                                                  33630099
                 UNTIL ASC-ITEM-SUB NOT > PC-ITEMS-PER-PANEL            33640099
                   SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB        33650099
               END-PERFORM                                              33660099
               MOVE PC-MAX-BLOCKS-IN-ARRAY TO ASC-BLK-SUB               33670099
           ELSE                                                         33680099
               MOVE +1                     TO ASC-BLK-SUB               33690099
           END-IF.                                                      33700099
                                                                        33710099
      ******************************************************************33720099
      ** RESET THE ATTRIBUTES OF ALL ENTERABLE FIELDS ON THE MAP.     **33730099
      ******************************************************************33740099
                                                                        33750099
       3200-RESET-ATTRIBUTES.                                           33760099
           MOVE DP015-UNP-ALP-NOR-OFF    TO ASTRTITA.                   33770099
           MOVE DP015-GREEN              TO ASTRTITC.                   33780099
           MOVE DP015-UNDERLINE          TO ASTRTITH.                   33790099
      *                                                                 33800099
           PERFORM                                                      33810099
               VARYING PV-SUB                                           33820099
               FROM 1 BY 1                                              33830099
               UNTIL PV-SUB > PC-ITEMS-PER-PANEL                        33840099
               IF PV-SUB > ASC-ITEMS-DISPLAYED                          33850099
                   MOVE DP015-ASK-DRK-OFF                               33860099
                                       TO MR-SELECTA (PV-SUB)           33870099
                   MOVE DP015-HL-OFF   TO MR-SELECTH (PV-SUB)           33880099
               ELSE                                                     33890099
                   MOVE DP015-UNP-ALP-NOR-OFF                           33900099
                                         TO MR-SELECTA (PV-SUB)         33910099
                   MOVE DP015-GREEN      TO MR-SELECTC (PV-SUB)         33920099
                   MOVE DP015-UNDERLINE  TO MR-SELECTH (PV-SUB)         33930099
               END-IF                                                   33940099
           END-PERFORM.                                                 33950099
      ******************************************************************33960099
      ** EDIT THE SELECTION MADE. NOTE THAT THE SELECTED SW IS        **33970099
      ** WHAT WAS PREVIOUSLY CHECKED AND CORREC 'TEMP-SELECTED-SW'    **33980099
      ** IS WHAT HAS JUST BE ENTERED AND HAS NOT BEEN EDITED OR       **33990099
      ** WAS ENTERED EARLIER, BUT DID NOT PASS THE EDITS.             **34000099
      ******************************************************************34010099
                                                                        34020099
       3300-EDIT-SELECTIONS.                                            34030099
                                                                        34040099
           EVALUATE TRUE                                                34050099
               WHEN ASC-TEMP-SELECTED-SW(ASC-BLK-SUB ASC-ITEM-SUB)      34060099
                   = ASC-SELECTED-SW    (ASC-BLK-SUB ASC-ITEM-SUB)      34070099
                       CONTINUE                                         34080099
               WHEN ASC-TEMP-SELECT     (ASC-BLK-SUB ASC-ITEM-SUB)      34090099
                   IF NOT ASC-SELECT    (ASC-BLK-SUB ASC-ITEM-SUB)      34100099
                      ADD +1         TO ASC-NUMBER-OF-SELECTED-ITEMS    34110099
                      MOVE ASC-TEMP-SELECTED-SW                         34120099
                                         (ASC-BLK-SUB ASC-ITEM-SUB)     34130099
                                     TO ASC-SELECTED-SW                 34140099
                                         (ASC-BLK-SUB ASC-ITEM-SUB)     34150099
                   END-IF                                               34160099
               WHEN ASC-TEMP-SELECTED-SW(ASC-BLK-SUB ASC-ITEM-SUB)      34170099
                   = SPACE                                              34180099
                   EVALUATE TRUE                                        DPKCS036
                       WHEN ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)       DPKCS036
                           SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMSDPKCS036
                           MOVE SPACE TO ASC-SELECTED-SW                DPKCS036
                                            (ASC-BLK-SUB ASC-ITEM-SUB)  DPKCS036
                       WHEN ASC-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)        DPKCS036
                           MOVE ZERO  TO ASC-START-OF-SELECTED-RANGE    DPKCS036
                           MOVE SPACE TO ASC-SELECTED-SW                DPKCS036
                                            (ASC-BLK-SUB ASC-ITEM-SUB)  DPKCS036
                       WHEN ASC-END (ASC-BLK-SUB ASC-ITEM-SUB)          DPKCS036
                           MOVE ZERO  TO ASC-END-OF-SELECTED-RANGE      DPKCS036
                           MOVE SPACE TO ASC-SELECTED-SW                DPKCS036
                                            (ASC-BLK-SUB ASC-ITEM-SUB)  DPKCS036
                   END-EVALUATE                                         DPKCS036
               WHEN ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)           DPKCS036
                   IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            DPKCS036
                       SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    DPKCS036
                   END-IF                                               DPKCS036
                   PERFORM 3310-EDIT-RANGE                              DPKCS036
               WHEN ASC-TEMP-END (ASC-BLK-SUB ASC-ITEM-SUB)             DPKCS036
                   IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            DPKCS036
                       SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    DPKCS036
                   END-IF                                               DPKCS036
                   PERFORM 3310-EDIT-RANGE                              DPKCS036
              WHEN OTHER                                                34240099
      *           -- INVALID VALUE --                                   34250099
                  MOVE PC-TSYMSG-00005       TO DP020-MSG-NUMBER        34260099
                  SET DP020-MSG-FATAL        TO TRUE                    34270099
                  MOVE -1                    TO MR-SELECTL (PV-SUB)     34280099
                  SET DP030-SET-CURSOR-APPL-1 TO TRUE                   34290099
                  MOVE DP015-RED              TO MR-SELECTC (PV-SUB)    34300099
                  MOVE DP015-REVERSE          TO MR-SELECTH (PV-SUB)    34310099
                  SET PS-ERROR                TO TRUE                   34320099
                  IF ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)              34330099
                     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS       34340099
                     MOVE SPACE               TO ASC-SELECTED-SW        34350099
                                           (ASC-BLK-SUB ASC-ITEM-SUB)   34360099
                  END-IF                                                34370099
           END-EVALUATE.                                                34380099
                                                                        34390099
           SUBTRACT +1 FROM  PV-ITEM-IN-USE.                            34400099
           SUBTRACT +1 FROM ASC-ITEM-SUB.                               34410099
           IF ASC-ITEM-SUB < 1                                          34420099
              SUBTRACT +1 FROM ASC-BLK-SUB                              34430099
              MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                   34440099
           END-IF.                                                      34450099
                                                                        34460099
       EJECT                                                            34470099
      ******************************************************************DPKCS036
      ** IF A BEGINNING AND END OF RANGE WAS ENTERED TO SELECT A      **DPKCS036
      ** RANGE OF LINES, MAKE SURE THERE IS ONLY 1 BEGINNING AND 1    **DPKCS036
      ** ENDING AND MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN)**DPKCS036
      ** THE ENDING.                                                  **DPKCS036
      ******************************************************************DPKCS036
       3310-EDIT-RANGE.                                                 DPKCS036
           IF  ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)                DPKCS036
               IF  ASC-START-OF-SELECTED-RANGE = ZERO                   DPKCS036
                   MOVE ASC-TEMP-SELECTED-SW  (ASC-BLK-SUB ASC-ITEM-SUB)DPKCS036
                                         TO ASC-SELECTED-SW             DPKCS036
                                              (ASC-BLK-SUB ASC-ITEM-SUB)DPKCS036
                   MOVE PV-ITEM-IN-USE   TO ASC-START-OF-SELECTED-RANGE DPKCS036
               ELSE                                                     DPKCS036
                   IF  ASC-START-OF-SELECTED-RANGE = PV-ITEM-IN-USE     DPKCS036
                       CONTINUE                                         DPKCS036
                   ELSE                                                 DPKCS036
      *                -- ONLY ONE BEGINNING-OF-RANGE-ALLOWED --        DPKCS036
                       MOVE PC-TSYMSG-00054                             DPKCS036
                                         TO DP020-MSG-NUMBER            DPKCS036
                       SET DP020-MSG-FATAL                              DPKCS036
                                         TO TRUE                        DPKCS036
                       MOVE -1           TO MR-SELECTL (PV-SUB)         DPKCS036
                       SET DP030-SET-CURSOR-APPL-1                      DPKCS036
                                         TO TRUE                        DPKCS036
                       MOVE DP015-RED    TO MR-SELECTC (PV-SUB)         DPKCS036
                       MOVE DP015-UNDERLINE                             DPKCS036
                                         TO MR-SELECTH (PV-SUB)         DPKCS036
                       SET PS-ERROR      TO TRUE                        DPKCS036
                   END-IF                                               DPKCS036
               END-IF                                                   DPKCS036
           ELSE                                                         DPKCS036
               IF  ASC-END-OF-SELECTED-RANGE = ZERO                     DPKCS036
                   MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) DPKCS036
                                         TO ASC-SELECTED-SW             DPKCS036
                                           (ASC-BLK-SUB ASC-ITEM-SUB)   DPKCS036
                   MOVE PV-ITEM-IN-USE   TO ASC-END-OF-SELECTED-RANGE   DPKCS036
               ELSE                                                     DPKCS036
                   IF  ASC-END-OF-SELECTED-RANGE = PV-ITEM-IN-USE       DPKCS036
                       CONTINUE                                         DPKCS036
                   ELSE                                                 DPKCS036
      *                -- ONLY ONE END-OF-RANGE ALLOWED --              DPKCS036
                       MOVE PC-TSYMSG-00055                             DPKCS036
                                         TO DP020-MSG-NUMBER            DPKCS036
                       SET DP020-MSG-FATAL                              DPKCS036
                                         TO TRUE                        DPKCS036
                       MOVE -1           TO MR-SELECTL (PV-SUB)         DPKCS036
                       SET DP030-SET-CURSOR-APPL-1                      DPKCS036
                                         TO TRUE                        DPKCS036
                       SET PS-ERROR      TO TRUE                        DPKCS036
                   END-IF                                               DPKCS036
               END-IF                                                   DPKCS036
           END-IF.                                                      DPKCS036
      *                                                                 DPKCS036
      ******************************************************************DPKCS036
      ** IF BOTH A BEGINNING AND END OF RANGE HAVE BEEN SPECIFIED,    **DPKCS036
      ** MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN) THE END.  **DPKCS036
      ******************************************************************DPKCS036
       3400-CHECK-RANGE-SEQUENCE.                                       DPKCS036
           IF  ASC-START-OF-SELECTED-RANGE > ZERO                       DPKCS036
             AND  ASC-END-OF-SELECTED-RANGE > ZERO                      DPKCS036
             AND  ASC-START-OF-SELECTED-RANGE >                         DPKCS036
                                               ASC-END-OF-SELECTED-RANGEDPKCS036
      *        -- END-OF-RANGE BEFORE BEGINNING-OF-RANGE                DPKCS036
               MOVE PC-TSYMSG-00052 TO DP020-MSG-NUMBER                 DPKCS036
               SET DP020-MSG-FATAL TO TRUE                              DPKCS036
               SET PS-ERROR TO TRUE                                     DPKCS036
               PERFORM 3410-POSITION-AT-ERROR                           DPKCS036
           END-IF.                                                      DPKCS036
      ******************************************************************DPKCS036
      ** BECAUSE RANGES CAN SPAN ACROSS MULTIPLE PAGES, A SEPARATE    **DPKCS036
      ** PARAGRAPH (THIS ONE) IS NEEDED TO DETERMINE WHERE THE CURSOR **DPKCS036
      ** SHOULD BE POSITIONED ON A RANGE ERROR.                       **DPKCS036
      ******************************************************************DPKCS036
       3410-POSITION-AT-ERROR.                                          DPKCS036
           SET DP030-SET-CURSOR-APPL-1                                  DPKCS036
                                         TO TRUE.                       DPKCS036
           COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 DPKCS036
                          - PV-TOP-ITEM + 1.                            DPKCS036
           IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      DPKCS036
               CONTINUE                                                 DPKCS036
           ELSE                                                         DPKCS036
               MOVE -1                   TO MR-SELECTL (PV-SUB)         DPKCS036
               MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         DPKCS036
               MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         DPKCS036
           END-IF.                                                      DPKCS036
      *                                                                 DPKCS036
           COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   DPKCS036
                          - PV-TOP-ITEM + 1.                            DPKCS036
           IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      DPKCS036
               CONTINUE                                                 DPKCS036
           ELSE                                                         DPKCS036
               MOVE -1                   TO MR-SELECTL (PV-SUB)         DPKCS036
               MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         DPKCS036
               MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         DPKCS036
           END-IF.                                                      DPKCS036
       EJECT                                                            DPKCS036
      *----------------------------------------------------------------*DPKCS036
      *    WHENEVER THE USER SELECTS AN ITEM AS THE BEGINNING RANGE    *DPKCS036
      *    AND ONE AS THE ENDING RANGE, MARK THESE ITEMS AS WELL AS    *DPKCS036
      *    THOSE THAT FALL IN THE RANGE AS BEING SELECTED.             *DPKCS036
      *----------------------------------------------------------------*DPKCS036
                                                                        DPKCS036
       3500-MARK-RANGE-AS-SELECTED.                                     DPKCS036
           MOVE +1                       TO  ASC-BLK-SUB.               DPKCS036
           PERFORM 3510-MARK-SELECTED-INDS                              DPKCS036
               VARYING ASC-ITEM-SUB                                     DPKCS036
               FROM 1 BY 1                                              DPKCS036
               UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 DPKCS036
                                                                        DPKCS036
           ADD +1                        TO ASC-BLK-SUB.                DPKCS036
           PERFORM 3510-MARK-SELECTED-INDS                              DPKCS036
               VARYING ASC-ITEM-SUB                                     DPKCS036
               FROM 1 BY 1                                              DPKCS036
               UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 DPKCS036
                                                                        DPKCS036
           MOVE ASC-LIST-ITEM-NUMBER(1 1)                               DPKCS036
                                         TO  PV-LIST-ITEM-NUMBER.       DPKCS036
           COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            DPKCS036
               1 + ((PV-LIST-ITEM-NUMBER - 1) /                         DPKCS036
                     PC-ITEMS-PER-PANEL).                               DPKCS036
                                                                        DPKCS036
           MOVE ASC-START-OF-SELECTED-RANGE                             DPKCS036
                                         TO PV-START-OF-SELECTED-RANGE. DPKCS036
           COMPUTE PV-FIRST-BLOCK-IN-RANGE =                            DPKCS036
               1 + ((PV-START-OF-SELECTED-RANGE - 1) /                  DPKCS036
                     PC-ITEMS-PER-PANEL).                               DPKCS036
                                                                        DPKCS036
           MOVE ASC-END-OF-SELECTED-RANGE                               DPKCS036
                                         TO  PV-END-OF-SELECTED-RANGE.  DPKCS036
           COMPUTE PV-LAST-BLOCK-IN-RANGE =                             DPKCS036
               1 + ((PV-END-OF-SELECTED-RANGE - 1) /                    DPKCS036
                     PC-ITEMS-PER-PANEL).                               DPKCS036
           COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                             DPKCS036
               PV-FIRST-BLOCK-IN-ARRAY + 1.                             DPKCS036
                                                                        DPKCS036
           IF (PV-FIRST-BLOCK-IN-RANGE < PV-FIRST-BLOCK-IN-ARRAY) OR    DPKCS036
              (PV-LAST-BLOCK-IN-RANGE  > PV-NEXT-BLOCK-IN-ARRAY)        DPKCS036
               MOVE +1                   TO ASC-BLK-SUB                 DPKCS036
               PERFORM 5100-WRITE-TEMP-STORAGE                          DPKCS036
               COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         DPKCS036
                   PV-FIRST-BLOCK-IN-ARRAY - 1                          DPKCS036
                                                                        DPKCS036
               PERFORM                                                  DPKCS036
                   UNTIL PV-FIRST-BLOCK-IN-RANGE >                      DPKCS036
                         PV-PREV-BLOCK-IN-ARRAY                         DPKCS036
                   MOVE PV-FIRST-BLOCK-IN-RANGE                         DPKCS036
                                         TO PV-BLOCK-NUMBER             DPKCS036
                   PERFORM 4410-READ-TEMP-STORAGE                       DPKCS036
                   PERFORM 3510-MARK-SELECTED-INDS                      DPKCS036
                       VARYING ASC-ITEM-SUB                             DPKCS036
                       FROM 1 BY 1                                      DPKCS036
                       UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          DPKCS036
                   PERFORM 5100-WRITE-TEMP-STORAGE                      DPKCS036
                   ADD +1                TO PV-FIRST-BLOCK-IN-RANGE     DPKCS036
               END-PERFORM                                              DPKCS036
                                                                        DPKCS036
               COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         DPKCS036
                   PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     DPKCS036
               PERFORM                                                  DPKCS036
                   UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       DPKCS036
                         PV-LAST-BLOCK-IN-RANGE                         DPKCS036
                   MOVE PV-NEXT-BLOCK-IN-ARRAY                          DPKCS036
                                         TO PV-BLOCK-NUMBER             DPKCS036
                   PERFORM 4410-READ-TEMP-STORAGE                       DPKCS036
                   PERFORM 3510-MARK-SELECTED-INDS                      DPKCS036
                       VARYING ASC-ITEM-SUB                             DPKCS036
                       FROM 1 BY 1                                      DPKCS036
                       UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          DPKCS036
                   PERFORM 5100-WRITE-TEMP-STORAGE                      DPKCS036
                   ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      DPKCS036
               END-PERFORM                                              DPKCS036
                                                                        DPKCS036
               MOVE PV-FIRST-BLOCK-IN-ARRAY                             DPKCS036
                                         TO PV-BLOCK-NUMBER             DPKCS036
               PERFORM 4410-READ-TEMP-STORAGE                           DPKCS036
           END-IF.                                                      DPKCS036
                                                                        DPKCS036
           MOVE +0                       TO ASC-START-OF-SELECTED-RANGE DPKCS036
                                            ASC-END-OF-SELECTED-RANGE.  DPKCS036
                                                                        DPKCS036
       EJECT                                                            DPKCS036
      *----------------------------------------------------------------*DPKCS036
      * SET THE SELECTION INDICATOR TO 'S' WITHIN THE RANGE.           *DPKCS036
      *----------------------------------------------------------------*DPKCS036
                                                                        DPKCS036
       3510-MARK-SELECTED-INDS.                                         DPKCS036
                                                                        DPKCS036
           IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         DPKCS036
                                      ASC-ITEM-SUB) >                   DPKCS036
               ASC-START-OF-SELECTED-RANGE)                             DPKCS036
           OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         DPKCS036
                                      ASC-ITEM-SUB) =                   DPKCS036
               ASC-START-OF-SELECTED-RANGE)                             DPKCS036
                                                                        DPKCS036
               IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     DPKCS036
                                          ASC-ITEM-SUB) <               DPKCS036
                   ASC-END-OF-SELECTED-RANGE)                           DPKCS036
               OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     DPKCS036
                                          ASC-ITEM-SUB) =               DPKCS036
                   ASC-END-OF-SELECTED-RANGE)                           DPKCS036
                                                                        DPKCS036
                   IF NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          DPKCS036
                       SET ASC-SELECT     (ASC-BLK-SUB  ASC-ITEM-SUB)   DPKCS036
                           ASC-TEMP-SELECT(ASC-BLK-SUB  ASC-ITEM-SUB)   DPKCS036
                                     TO TRUE                            DPKCS036
                       SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB)              DPKCS036
                                     TO TRUE                            DPKCS036
                       ADD +1        TO ASC-NUMBER-OF-SELECTED-ITEMS    DPKCS036
                   END-IF                                               DPKCS036
               END-IF                                                   DPKCS036
           END-IF.                                                      DPKCS036
                                                                        DPKCS036
       EJECT                                                            DPKCS036
      ******************************************************************34480099
      *    SELECT THE CURRENT TTFSTAT TABLE ROW FOR A TRANSFER NUMBER.  34490099
      ******************************************************************34490199
       3600-SELECT-CURR-XFER-STATUS.                                    34490209
                                                                        34490309
           MOVE ASC-SEL-XFER-DKEY-ID     TO  TFSTAT-XFER-DKEY-ID.       34490499
                                                                        34490599
           PERFORM                                                      34490699
               WITH TEST AFTER                                          34490799
               VARYING PV-RETRY-COUNTER                                 34490899
               FROM 1 BY 1                                              34490999
               UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               34491099
                   OR (SQLCODE = +0)                                    34492099
                   OR (SQLCODE = +100))                                 34493099
                                                                        34494099
               EXEC SQL                                                 34495099
                   SELECT  A.XFER_STAT_CDE,                             34496099
                           B.XFER_STAT_DESC                             34497099
                     INTO  :TFSTAT-XFER-STAT-CDE,                       34498099
                           :TFSTCD-XFER-STAT-DESC                       34499099
                     FROM  TTFSTAT  A,                                  34500099
                           TTFSTCD  B                                   34510099
                     WHERE XFER_DKEY_ID = :TFSTAT-XFER-DKEY-ID          34520099
                       AND   A.XFER_STAT_CDE  =  B.XFER_STAT_CDE        34530099
                       AND XFER_STAT_TMST =                             34540099
                           (SELECT MAX (XFER_STAT_TMST)                 34550099
                             FROM TTFSTAT                               34560099
                            WHERE XFER_DKEY_ID = :TFSTAT-XFER-DKEY-ID)  34570099
               END-EXEC                                                 34580099
                                                                        34590099
               EVALUATE TRUE                                            34600099
                   WHEN SQLCODE = +0                                    34610099
                        CONTINUE                                        34620099
                   WHEN SQLCODE = +100                                  34630099
                        MOVE SPACES     TO TFSTAT-XFER-STAT-CDE         34640099
                   WHEN SQLCODE = -904                                  34650099
                   WHEN SQLCODE = -913                                  34660099
                        CONTINUE                                        34670099
                                                                        34680099
                   WHEN OTHER                                           34690099
                        MOVE '3600-SELECT-CURR-XFER-STATUS'             34720099
                                        TO DP013-PARAGRAPH              34730099
                        MOVE 'UNSUCCESSFUL SELECT'                      34740099
                                        TO DP013-MESSAGE-TEXT (1)       34750099
                        MOVE SQLCA      TO DP013-SQLCA                  34760099
                        MOVE 'TTFSTAT'  TO DP013-DB2-TABLE-NAME (1)     34770099
                        SET DP013-DB2-ABEND                             34780099
                            DP013-XCTL-DISPLAY-RESTART                  34790099
                                        TO TRUE                         34800099
                        PERFORM DP013-0000-PROCESS-ABEND                34810099
               END-EVALUATE                                             34820099
           END-PERFORM.                                                 34830099
                                                                        34840099
           IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        34850099
               MOVE '3600-SELECT-CURR-XFER-STATUS'                      34860099
                                        TO DP013-PARAGRAPH              34870099
               MOVE 'MAX RETRIES EXCEEDED FOR SELECT'                   34880099
                                        TO DP013-MESSAGE-TEXT (1)       34890099
               MOVE SQLCA               TO DP013-SQLCA                  34900099
               MOVE 'TTFSTAT '          TO DP013-DB2-TABLE-NAME (1)     34910099
               SET DP013-DB2-ABEND                                      34920099
                   DP013-XCTL-DISPLAY-RESTART                           34930099
                                        TO TRUE                         34940099
               PERFORM DP013-0000-PROCESS-ABEND                         34950099
           END-IF.                                                      34960099
                                                                        34960199
           EJECT                                                        34960210
      ******************************************************************34960399
      *    SELECT THE TTFTYCD TABLE ROW FOR A TRANSFER TYPE CODE.       34960499
      ******************************************************************34960599
       3700-SELECT-XFER-TYPE-CD-INFO.                                   34960609
                                                                        34960709
           MOVE ASC-XFER-TYPE            TO  TFTYCD-XFER-TYP-CDE.       34960899
                                                                        34960909
           PERFORM                                                      34961099
               WITH TEST AFTER                                          34962099
               VARYING PV-RETRY-COUNTER                                 34963099
               FROM 1 BY 1                                              34964099
               UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               34965099
                   OR (SQLCODE = +0)                                    34966099
                   OR (SQLCODE = +100))                                 34967099
                                                                        34968099
               EXEC SQL                                                 34969099
                   SELECT                                               34970099
                          TYP_1ST_LNE_DESC                              34980099
                        , TYP_2ND_LNE_DESC                              34990099
                   INTO  :TFTYCD-TYP-1ST-LNE-DESC                       35000099
                        ,:TFTYCD-TYP-2ND-LNE-DESC                       35010099
                   FROM TTFTYCD                                         35020099
                   WHERE XFER_TYP_CDE = :TFTYCD-XFER-TYP-CDE            35030099
               END-EXEC                                                 35040099
                                                                        35050099
               EVALUATE TRUE                                            35060099
                   WHEN SQLCODE = +0                                    35070099
                   WHEN SQLCODE = +100                                  35080099
                   WHEN SQLCODE = -904                                  35090099
                   WHEN SQLCODE = -913                                  35100099
                        CONTINUE                                        35110099
                                                                        35120099
                   WHEN OTHER                                           35130099
                        MOVE '3700-SELECT-XFER-TYPE-CD-INFO'            35160099
                                        TO DP013-PARAGRAPH              35170099
                        MOVE 'UNSUCCESSFUL SELECT'                      35180099
                                        TO DP013-MESSAGE-TEXT (1)       35190099
                        MOVE SQLCA      TO DP013-SQLCA                  35200099
                        MOVE 'TTFTYCD'  TO DP013-DB2-TABLE-NAME (1)     35210099
                        SET DP013-DB2-ABEND                             35220099
                            DP013-XCTL-DISPLAY-RESTART                  35230099
                                        TO TRUE                         35240099
                        PERFORM DP013-0000-PROCESS-ABEND                35250099
               END-EVALUATE                                             35260099
           END-PERFORM.                                                 35270099
                                                                        35280099
           IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        35290099
               MOVE '3700-SELECT-XFER-TYPE-CD-INFO'                     35300099
                                        TO DP013-PARAGRAPH              35310099
               MOVE 'MAX RETRIES EXCEEDED FOR SELECT'                   35320099
                                        TO DP013-MESSAGE-TEXT (1)       35330099
               MOVE SQLCA               TO DP013-SQLCA                  35340099
               MOVE 'TTFTYCD '          TO DP013-DB2-TABLE-NAME (1)     35350099
               SET DP013-DB2-ABEND                                      35360099
                   DP013-XCTL-DISPLAY-RESTART                           35370099
                                        TO TRUE                         35380099
               PERFORM DP013-0000-PROCESS-ABEND                         35390099
           END-IF.                                                      35400099
                                                                        35410099
      *----------------------------------------------------------------*35420099
      *    INITIALIZE BOTH BLOCKS IN THE ARRAY.                        *35430099
      *    INITIALIZE ALL COUNTERS AND FLAGS.                          *35440099
      *    READ THE DATA BASE FOR THE 1ST TIME AND FILL UP THE ARRAY.  *35450099
      *    DISPLAY THE PANEL TO USER.                                  *35460099
      *----------------------------------------------------------------*35470099
                                                                        35480099
       4000-BUILD-INITIAL-PANEL.                                        35490099
                                                                        35500099
           INITIALIZE                    ASC-BLOCK-ENTRIES (1)          35510099
                                         ASC-BLOCK-ENTRIES (2)          35520099
                                         PV-XFER-TYPE-TBL.              35530099
           SET ASC-ITEMS-LEFT-ON-DB                                     DPKCS036
                                   TO TRUE.                             DPKCS036
           MOVE +1                   TO  ASC-BLK-SUB.                   35540099
                                                                        35550099
           MOVE +0                   TO  ASC-ITEM-SUB                   35560099
                                         ASC-NUMBER-OF-ITEMS-READ       35570099
                                         ASC-NUMBER-OF-SELECTED-ITEMS   35580099
                                         ASC-HIGHEST-BLOCK-WRITTEN      35590099
                                         ASC-ITEM-AT-TOP-OF-PANEL       35600099
                                         ASC-START-OF-SELECTED-RANGE    35600199
                                         ASC-END-OF-SELECTED-RANGE      35601099
                                         ASC-XFER-QTY-TOTAL             35610099
                                         ASC-RECV-QTY-TOTAL             35620099
                                         ASC-XFER-RETAIL-TOTAL          35630099
                                         ASC-RECV-RETAIL-TOTAL.         35640099
                                                                        35650099
           PERFORM 4010-OPEN-XFER-TYPE-CURSOR.                          35660099
                                                                        35670099
           PERFORM 4020-READ-TRANSFER-TYPES.                            35680099
                                                                        35690099
           PERFORM 4030-CLOSE-XFER-TYPE-CURSOR.                         35700099
                                                                        35710099
           PERFORM 4040-FILL-HEADER-INFO.                               35720099
                                                                        35730099
           PERFORM 4100-BUILD-CURSOR                                    35740099
                                                                        35750099
           PERFORM 4210-COMBINE-SQL.                                    35760099
           PERFORM 4220-DECLARE-CURSOR.                                 35770099
           PERFORM 4230-PREPARE-CURSOR.                                 35780099
                                                                        35790099
           PERFORM 4240-OPEN-CURSOR.                                    35800099
                                                                        35810099
           PERFORM 4300-READ-ITEMS-FROM-DB.                             35820099
                                                                        35830099
           PERFORM 4250-CLOSE-CURSOR.                                   35840099
                                                                        35850099
           MOVE +1               TO  PV-TOP-ITEM                        35860099
           IF PS-ERROR-DB2                                              35870099
               SET DP020-NEXT-ACT-APPL-ERROR                            35880099
                   DP020-MSG-FATAL TO TRUE                              35890099
               MOVE PC-TSYMSG-00050 TO DP020-MSG-NUMBER                 35900099
           ELSE                                                         35910099
               IF ASC-NUMBER-OF-ITEMS-READ = ZERO                       35920099
                   SET DP020-NEXT-ACT-APPL-ERROR                        35930099
                       DP020-MSG-FATAL TO TRUE                          35940099
                   MOVE PC-TSYMSG-00050 TO DP020-MSG-NUMBER             35950099
               ELSE                                                     35960099
                   IF PV-READ-COUNT > PC-MAX-ITEMS                      35920099
                       SET DP020-NEXT-ACT-APPL-ERROR                    35930099
                           DP020-MSG-FATAL TO TRUE                      35940099
                       MOVE PC-TSYMSG-00336 TO DP020-MSG-NUMBER         35950099
                   ELSE                                                 35960099
                       IF ASC-NUMBER-OF-ITEMS-READ > ZERO               35970099
                           MOVE -1       TO MR-SELECTL (1)              35980099
                           SET DP030-SET-CURSOR-APPL-1                  35990099
                                         TO TRUE                        36000099
                       END-IF                                           36010099
                       PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             36020099
                   END-IF                                               36030099
               END-IF                                                   36030099
           END-IF.                                                      36040099
                                                                        36050099
       EJECT                                                            36060099
      *----------------------------------------------------------------*36070099
      * OPENS THE TRANSFER TYPE CURSOR                                 *36080099
      *----------------------------------------------------------------*36090099
                                                                        36100099
       4010-OPEN-XFER-TYPE-CURSOR.                                      36110099
                                                                        36120099
           EXEC SQL                                                     36130099
               OPEN XFER-TYPE-CSR                                       36140099
           END-EXEC.                                                    36150099
                                                                        36160099
           EVALUATE TRUE                                                36170099
               WHEN SQLCODE = +0                                        36180099
                   CONTINUE                                             36190099
               WHEN OTHER                                               36200099
                    MOVE '4010-OPEN-XFER-TYPE-CURSOR'                   36210099
                                     TO DP013-PARAGRAPH                 36220099
                    MOVE 'OPEN XFER-TYPE-CSR CURSOR'                    36230099
                                     TO DP013-MESSAGE-TEXT (1)          36240099
                    MOVE SQLCA           TO DP013-SQLCA                 36250099
                    SET DP013-DB2-ABEND                                 36260099
                                     TO TRUE                            36270099
                    PERFORM DP013-0000-PROCESS-ABEND                    36280099
           END-EVALUATE.                                                36290099
                                                                        36300099
       EJECT                                                            36310099
      *----------------------------------------------------------------*36320099
      *    READ THE TRANSFER TYPES AND DESCRIPTIONS AND PROCESS THEM   *36330099
      *----------------------------------------------------------------*36340099
                                                                        36350099
       4020-READ-TRANSFER-TYPES.                                        36360099
                                                                        36370099
           SET ASC-ITEMS-LEFT-ON-DB      TO TRUE.                       36380099
           PERFORM                                                      36390099
               VARYING PV-READ-COUNT                                    36400099
               FROM 1 BY 1                                              36410099
               UNTIL ((PV-READ-COUNT > PC-MAX-TYPES)                    36420099
                  OR (ASC-NO-ITEMS-LEFT-ON-DB))                         36430099
                                                                        36440099
               PERFORM 4025-FETCH-TRANSFER-TYPE                         36450099
                                                                        36460099
               IF  ASC-ITEMS-LEFT-ON-DB                                 36470099
                   MOVE TFTYCD-XFER-TYP-CDE(2:1)                        36480099
                                         TO PV-STATUS-TBL-SUB           36490099
111703************************************************************              
111703** DEFECTIVE DAMAGED SORT1 XFER TYPE OF 0 CANNOT BE USED AS               
111703** A SUBSCRIPT.  DEFAULT IT TO MAX TYPE CODE OF 8                         
111703************************************************************              
111703             IF PV-STATUS-TBL-SUB = 0                                     
111703                 MOVE 8 TO PV-STATUS-TBL-SUB                              
111703             END-IF                                                       
                                                                                
                   MOVE TFTYCD-TYP-1ST-LNE-DESC                         36500099
                                         TO PV-XFER-TYPE-DESC-1         36510099
                                            (PV-STATUS-TBL-SUB)         36520099
                   MOVE TFTYCD-TYP-2ND-LNE-DESC                         36530099
                                         TO PV-XFER-TYPE-DESC-2         36540099
                                            (PV-STATUS-TBL-SUB)         36550099
                   IF TFTYCD-TYP-2ND-LNE-DESC = SPACES                  36560099
                       MOVE TFTYCD-TYP-1ST-LNE-DESC                     36570099
                                         TO PV-XFER-TYPE-LINE-DESC      36580099
                                            (PV-STATUS-TBL-SUB)         36590099
                   ELSE                                                 36600099
                       STRING TFTYCD-TYP-1ST-LNE-DESC DELIMITED BY '  ' 36610099
                              TFTYCD-TYP-2ND-LNE-DESC DELIMITED BY '  ' 36620099
                           INTO PV-XFER-TYPE-LINE-DESC                  36630099
                                            (PV-STATUS-TBL-SUB)         36640099
                   END-IF                                               36650099
               END-IF                                                   36660099
           END-PERFORM.                                                 36670099
                                                                        36680099
       EJECT                                                            36690099
      *----------------------------------------------------------------*36700099
      *    FETCH THE TRANSFER TYPES AND DESCRIPTIONS                   *36710099
      *----------------------------------------------------------------*36720099
                                                                        36730099
       4025-FETCH-TRANSFER-TYPE.                                        36740099
                                                                        36750099
           EXEC SQL                                                     36760099
               FETCH XFER-TYPE-CSR                                      36770099
                   INTO                                                 36780099
                       :TFTYCD-XFER-TYP-CDE                             36790099
                     , :TFTYCD-TYP-1ST-LNE-DESC                         36800099
                     , :TFTYCD-TYP-2ND-LNE-DESC                         36810099
           END-EXEC.                                                    36820099
                                                                        36830099
           EVALUATE TRUE                                                36840099
               WHEN SQLCODE = ZERO                                      36850099
                    CONTINUE                                            36860099
               WHEN SQLCODE = +100                                      36870099
                    SET ASC-NO-ITEMS-LEFT-ON-DB                         36880099
                                       TO TRUE                          36890099
               WHEN OTHER                                               36900099
                    MOVE '4025-FETCH-TRANSFER-TYPE'                     36920099
                                     TO DP013-PARAGRAPH                 36930099
                    MOVE 'FETCH XFER-TYPE-CSR CURSOR'                   36940099
                                     TO DP013-MESSAGE-TEXT (1)          36950099
                    MOVE SQLCA           TO DP013-SQLCA                 36960099
                    SET DP013-DB2-ABEND                                 36970099
                                     TO TRUE                            36980099
                    PERFORM DP013-0000-PROCESS-ABEND                    36990099
           END-EVALUATE.                                                37000099
                                                                        37010099
       EJECT                                                            37020099
      *----------------------------------------------------------------*37030099
      * CLOSE THE TRANSFER TYPE CURSOR                                 *37040099
      *----------------------------------------------------------------*37050099
                                                                        37060099
       4030-CLOSE-XFER-TYPE-CURSOR.                                     37070099
                                                                        37080099
           EXEC SQL                                                     37090099
               CLOSE XFER-TYPE-CSR                                      37100099
           END-EXEC.                                                    37110099
                                                                        37110199
           EVALUATE TRUE                                                37110209
               WHEN SQLCODE = ZERO                                      37110309
                    CONTINUE                                            37110409
               WHEN OTHER                                               37110599
                    MOVE '4030-CLOSE-XFER-TYPE-CURSOR'                  37110609
                                 TO  DP013-PARAGRAPH                    37110709
                    MOVE 'CLOSE XFER-TYPE-CSR CURSOR'                   37110809
                                 TO  DP013-MESSAGE-TEXT (1)             37110909
                    MOVE SQLCA   TO  DP013-SQLCA                        37111009
                    SET DP013-DB2-ABEND                                 37111109
                                 TO  TRUE                               37111209
                    PERFORM DP013-0000-PROCESS-ABEND                    37111309
           END-EVALUATE.                                                37111409
                                                                        37111599
       EJECT                                                            37111699
      *----------------------------------------------------------------*37111799
      *    FILL THE ASC TRANSFER TYPE DESCRIPTION AND THE INFO HEADERS.*37111899
      *----------------------------------------------------------------*37111999
                                                                        37112099
       4040-FILL-HEADER-INFO.                                           37113099
                                                                        37114099
           IF ASC-XFER-TYPE NUMERIC                                     37115099
               MOVE ASC-XFER-TYPE(2:1)   TO PV-STATUS-TBL-SUB           37116099
111703************************************************************              
111703** DEFECTIVE DAMAGED SORT1 XFER TYPE OF 0 CANNOT BE USED AS               
111703** A SUBSCRIPT.  DEFAULT IT TO MAX TYPE CODE OF 8                         
111703************************************************************              
111703         IF PV-STATUS-TBL-SUB = 0                                         
111703             MOVE 8 TO PV-STATUS-TBL-SUB                                  
111703         END-IF                                                           
               MOVE PV-XFER-TYPE-DESC-1 (PV-STATUS-TBL-SUB)             37117099
                                         TO PV-TRANSFER-TYPE-DESC-1     37118099
               MOVE PV-XFER-TYPE-DESC-2 (PV-STATUS-TBL-SUB)             37119099
                                         TO PV-TRANSFER-TYPE-DESC-2     37120099
               MOVE PV-TRANSFER-TYPE-DESC                               37130099
                                         TO ASC-TRANSFER-TYPE-DESC      37140099
           ELSE                                                         37150099
               MOVE 'ALL TYPES'          TO ASC-TRANSFER-TYPE-DESC      37160099
           END-IF.                                                      37170099
                                                                        37180099
           IF ASC-ALL-TYPES                                             37190099
               MOVE DEFAULT-MISC-HEADER-LINE1                           37200099
                                         TO ASC-MISC-INFO-HEADER-1      37210099
               MOVE DEFAULT-MISC-HEADER-LINE2                           37220099
                                         TO ASC-MISC-INFO-HEADER-2      37230099
           END-IF.                                                      37240099
                                                                        37250099
111703*    IF ASC-DEFECTS-DAMAGES-TYPE                                  37260099
111703     IF ASC-DEFECTIVE-DAMAGE-SORT1                                        
               MOVE DEFAULT-MISC-HEADER-LINE1                           37270099
                                         TO ASC-MISC-INFO-HEADER-1      37280099
               MOVE DEFECTS-MISC-HEADER-LINE2                           37290099
                                         TO ASC-MISC-INFO-HEADER-2      37300099
           END-IF.                                                      37310099
                                                                                
111703     IF ASC-DEFECTIVE-DAMAGE-SORT2                                        
111703         MOVE DEFAULT-MISC-HEADER-LINE1                           37270099
111703                                   TO ASC-MISC-INFO-HEADER-1      37280099
111703         MOVE DEFECTS-MISC-HEADER-LINE2                           37290099
111703                                   TO ASC-MISC-INFO-HEADER-2      37300099
111703     END-IF.                                                      37310099
                                                                        37320099
           IF ASC-CALLBACK-TYPE                                         37330099
               MOVE CALLBACK-MISC-HEADER-LINE1                          37340099
                                         TO ASC-MISC-INFO-HEADER-1      37350099
               MOVE CALLBACK-MISC-HEADER-LINE2                          37360099
                                         TO ASC-MISC-INFO-HEADER-2      37370099
           END-IF.                                                      37380099
                                                                        37390099
           IF ASC-STOCK-BAL-CORP-TYPE                                   37400099
               MOVE APPROVAL-MISC-HEADER-LINE1                          37410099
                                         TO ASC-MISC-INFO-HEADER-1      37420099
               MOVE APPROVAL-MISC-HEADER-LINE2                          37430099
                                         TO ASC-MISC-INFO-HEADER-2      37440099
           END-IF.                                                      37450099
                                                                        37460099
           IF ASC-STOCK-BAL-STORE-TYPE                                  37470099
               MOVE STORE-MISC-HEADER-LINE1                             37480099
                                         TO ASC-MISC-INFO-HEADER-1      37490099
               MOVE STORE-MISC-HEADER-LINE2                             37500099
                                         TO ASC-MISC-INFO-HEADER-2      37510099
           END-IF.                                                      37520099
                                                                        37530099
           IF ASC-CUSTOMER-TYPE                                         37540099
               MOVE SPACES               TO ASC-MISC-INFO-HEADER-1      37550099
               MOVE CUST-MISC-HEADER-LINE2                              37560099
                                         TO ASC-MISC-INFO-HEADER-2      37570099
           END-IF.                                                      37580099
                                                                        37590099
           IF ASC-OFFSITE-STORAGE-TYPE                                  37600099
               MOVE SPACES               TO ASC-MISC-INFO-HEADER-1      37610099
               MOVE WHSE-MISC-HEADER-LINE2                              37620099
                                         TO ASC-MISC-INFO-HEADER-2      37630099
           END-IF.                                                      37640099
                                                                        37650099
           IF ASC-NON-RETAIL-TYPE                                       37660099
               MOVE SPACES               TO ASC-MISC-INFO-HEADER-1      37670099
               MOVE NON-RETL-MISC-HEADER-LINE2                          37680099
                                         TO ASC-MISC-INFO-HEADER-2      37690099
           END-IF.                                                      37700099
      *----------------------------------------------------------------*37710099
      *    SET UP THE HOST VARIABLES.                                  *37720099
      *----------------------------------------------------------------*37730099
                                                                        37740099
       4100-BUILD-CURSOR.                                               37750099
                                                                        37760099
           MOVE ZERO                     TO PV-ORD-BY-SUB               37770099
                                            PV-WHERE-SUB.               37780099
           MOVE SPACE                    TO PS-CURSOR-SW.               37790099
                                                                        37800099
           INITIALIZE PV-WHERE-TABLE                                    37810099
                      PV-ORDER-BY-TABLE                                 37820099
                      PV-SQL-STMT.                                      37830099
           EXEC CICS ASSIGN                                             37840099
                     APPLID(PV-SYSTEM-ID)                               37850099
           END-EXEC.                                                    37860099
                                                                        37870099
           MOVE PV-REGION-IND             TO PV-BUILD-QUAL-XL1          37880099
                                             PV-BUILD-QUAL-XL2          37890099
                                             PV-BUILD-QUAL-XL3          37900099
                                             PV-BUILD-QUAL-XI1          37910099
                                             PV-BUILD-QUAL-XI2          37920099
                                             PV-BUILD-QUAL-XI3          37930099
                                             PV-BUILD-QUAL-XI3A         37930099
101803                                       PV-BUILD-QUAL-XI3B                 
                                             PV-BUILD-QUAL-XI4          37940099
                                             PV-BUILD-QUAL-XR1          37950099
                                             PV-BUILD-QUAL-XR2          37960099
                                             PV-BUILD-QUAL-XR3          37970099
                                             PV-BUILD-QUAL-XR4          37980099
                                             PV-BUILD-QUAL-XR5          37990099
                                             PV-BUILD-QUAL-XA1          38000099
                                             PV-BUILD-QUAL-XA2          38010099
                                             PV-BUILD-QUAL-XA3          38020099
                                             PV-BUILD-QUAL-XA4          38030099
                                             PV-BUILD-QUAL-XA4A         38030099
101803                                       PV-BUILD-QUAL-XA4B                 
                                             PV-BUILD-QUAL-XA5          38040099
                                             PV-BUILD-QUAL-XA6.         38050099
                                                                        38060099
           IF ASC-XFER-DPT > ZERO                                       38070099
             OR ASC-XFER-CLASS > ZERO                                   38080099
             OR ASC-XFER-SUBCL > SPACES                                 38080099
               SET PS-XFER-ITEM-CSR      TO TRUE                        38090099
           END-IF.                                                      38100099
                                                                        38110099
           IF ASC-XFER-UPC > ZERO                                       38070099
               SET PS-XFER-ITEM-CSR      TO TRUE                        38090099
           END-IF.                                                      38100099
                                                                                
           IF ASC-XFER-RECV-BEG-DTE > ZERO                              38120099
             OR ASC-XFER-RECV-END-DTE > ZERO                            38130099
             OR ASC-XFER-RECV-BY-FIRST-INIT NOT = SPACE                 38140099
             OR ASC-XFER-RECV-BY-LAST-NAME  NOT = SPACES                38150099
             OR ASC-XFER-RECV-DTE-SORT-NR > ZERO                        38160099
             OR ASC-XFER-STATUS = PC-DTL-CHK-STATUS                     38170099
             OR ASC-XFER-STATUS = PC-NO-DTL-CHK-STATUS                  38180099
               SET PS-RECEIPT-SELECTED TO TRUE                          38190099
               IF PS-XFER-ITEM-CSR                                      38200099
                   SET PS-XFER-ALL-CSR   TO TRUE                        38210099
               ELSE                                                     38220099
                   SET PS-XFER-RCVR-CSR  TO TRUE                        38230099
               END-IF                                                   38240099
           ELSE                                                         38250099
               IF PS-CURSOR-SW = SPACE                                  38260099
                   SET PS-XFER-LIST-CSR  TO TRUE                        38270099
               END-IF                                                   38280099
           END-IF.                                                      38290099
                                                                        38300099
      *    INSERT A 'WHERE' CLAUSE WITH 'AND' IN FRONT OF THE STATEMENT 38310099
      *    INTO THE GENERIC CURSOR WHERE CLAUSE FOR EACH SELECT CRITERIA38320099
      *    FIELD.                                                       38330099
                                                                        38340099
           IF  ASC-XFER-TYPE > SPACES                                   38350099
               MOVE ASC-XFER-TYPE        TO PV-WH-XFER-TYPE             38360099
               ADD PV-WHERE-SIZE         TO PV-WHERE-BYTES              38370099
               ADD PC-1                  TO PV-WHERE-SUB                38380099
               MOVE PV-WHERE-XFER-TYPE   TO PV-WHERE-LINE (PV-WHERE-SUB)38390099
           END-IF.                                                      38400099
                                                                        38410099
           IF  ASC-XFER-STATUS > SPACES                                 38420099
               IF ASC-XFER-STATUS = PC-VOID-STATUS                      38430099
                   MOVE PC-EQUAL         TO PV-WH-XFER-STAT-OP          38440099
                   MOVE PC-VOID-STATUS   TO PV-WH-XFER-STATUS           38450099
               ELSE                                                     38460099
                   ADD PV-WHERE-SIZE     TO PV-WHERE-BYTES              38470099
                   ADD PC-1              TO PV-WHERE-SUB                38480099
                   MOVE PV-WHERE-XFER-STAT-NOT-VD                       38490099
                                         TO PV-WHERE-LINE (PV-WHERE-SUB)38500099
                   IF ASC-XFER-STATUS = PC-POS-RECEIVED-STATUS   OR     38510099
                      ASC-XFER-STATUS = PC-DTL-CHK-STATUS        OR     38520099
                      ASC-XFER-STATUS = PC-NO-DTL-CHK-STATUS            38530099
                       MOVE PC-EQUAL     TO PV-WH-XFER-STAT-OP          38540099
                   ELSE                                                 38550099
                       MOVE PC-NOT-EQUAL TO PV-WH-XFER-STAT-OP          38560099
                   END-IF                                               38570099
               END-IF                                                   38580099
               ADD PV-WHERE-SIZE         TO PV-WHERE-BYTES              38590099
               ADD PC-1                  TO PV-WHERE-SUB                38600099
               MOVE PV-WHERE-XFER-STAT-CDE                              38610099
                                         TO PV-WHERE-LINE (PV-WHERE-SUB)38620099
           END-IF.                                                      38630099
                                                                        38640099
           IF ASC-XFER-STATUS = PC-DTL-CHK-STATUS         OR            38650099
              ASC-XFER-STATUS = PC-NO-DTL-CHK-STATUS                    38660099
               IF ASC-XFER-STATUS = PC-DTL-CHK-STATUS                   38670099
                   MOVE PC-NOT-EQUAL TO PV-WH-DTL-CHECK-OP              38680099
               ELSE                                                     38690099
                   MOVE PC-EQUAL     TO PV-WH-DTL-CHECK-OP              38700099
               END-IF                                                   38710099
               ADD PV-WHERE-SIZE         TO PV-WHERE-BYTES              38720099
               ADD PC-1                  TO PV-WHERE-SUB                38730099
               MOVE PV-WHERE-DTL-CHECK-CDE                              38740099
                                         TO PV-WHERE-LINE (PV-WHERE-SUB)38750099
           END-IF.                                                      38760099
                                                                        38770099
           IF  ASC-XFER-FROM-STR > ZERO                                 38780099
               MOVE ASC-XFER-FROM-STR    TO PV-WH-FROM-STORE            38790099
               ADD PV-WHERE-SIZE         TO PV-WHERE-BYTES              38800099
               ADD PC-1                  TO PV-WHERE-SUB                38810099
               MOVE PV-WHERE-FROM-STORE  TO PV-WHERE-LINE (PV-WHERE-SUB)38820099
           END-IF.                                                      38830099
                                                                        38840099
           IF  ASC-XFER-TO-STR > ZERO                                   38850099
               MOVE ASC-XFER-TO-STR      TO PV-WH-TO-STORE              38860099
               ADD PV-WHERE-SIZE         TO PV-WHERE-BYTES              38870099
               ADD PC-1                  TO PV-WHERE-SUB                38880099
               MOVE PV-WHERE-TO-STORE    TO PV-WHERE-LINE (PV-WHERE-SUB)38890099
           END-IF.                                                      38900099
                                                                                
           IF  (ASC-XFER-COMP-BEG-DTE > ZERO)                           38920099
           AND (ASC-XFER-COMP-END-DTE > ZERO)                           39050099
           AND (ASC-XFER-STATUS       = PC-VOID-STATUS)                         
               MOVE ASC-XFER-COMP-BEG-DTE(5:4)                          38930099
                                         TO PV-WH-COMP-BEG-YR           38940099
                                            PV-WH-COMP-BEG-VOID-YR      38940099
               MOVE ASC-XFER-COMP-BEG-DTE(1:2)                          38950099
                                         TO PV-WH-COMP-BEG-MM           38960099
                                            PV-WH-COMP-BEG-VOID-MM      38960099
               MOVE ASC-XFER-COMP-BEG-DTE(3:2)                          38970099
                                         TO PV-WH-COMP-BEG-DD           38980099
                                            PV-WH-COMP-BEG-VOID-DD      38980099
                                                                                
               MOVE ASC-XFER-COMP-END-DTE(5:4)                          39060099
                                         TO PV-WH-COMP-END-YR           39070099
                                            PV-WH-COMP-END-VOID-YR      39070099
               MOVE ASC-XFER-COMP-END-DTE(1:2)                          39080099
                                         TO PV-WH-COMP-END-MM           39090099
                                            PV-WH-COMP-END-VOID-MM      39090099
               MOVE ASC-XFER-COMP-END-DTE(3:2)                          39100099
                                         TO PV-WH-COMP-END-DD           39110099
                                            PV-WH-COMP-END-VOID-DD      39110099
                                                                                
               ADD PV-WHERE-SIZE         TO PV-WHERE-BYTES              38990099
               ADD PC-1                  TO PV-WHERE-SUB                39000099
               MOVE PV-WHERE-COMP-BEG-DATE                              39010099
                                         TO PV-WHERE-LINE (PV-WHERE-SUB)39150099
                                                                                
               ADD PV-WHERE-SIZE         TO PV-WHERE-BYTES              38990099
               ADD PC-1                  TO PV-WHERE-SUB                39000099
               MOVE PV-WHERE-COMP-END-DATE                              39010099
                                         TO PV-WHERE-LINE (PV-WHERE-SUB)39020099
                                                                                
               ADD PV-WHERE-SIZE         TO PV-WHERE-BYTES              39120099
               ADD PC-1                  TO PV-WHERE-SUB                39130099
               MOVE PV-WHERE-COMP-BEG-VOID-DATE                         39140099
                                         TO PV-WHERE-LINE (PV-WHERE-SUB)39150099
                                                                                
               ADD PV-WHERE-SIZE         TO PV-WHERE-BYTES              39120099
               ADD PC-1                  TO PV-WHERE-SUB                39130099
               MOVE PV-WHERE-COMP-END-VOID-DATE                         39140099
                                         TO PV-WHERE-LINE (PV-WHERE-SUB)39150099
           END-IF.                                                      39160099
                                                                                
           IF  (ASC-XFER-COMP-BEG-DTE > ZERO)                           38920099
           AND (ASC-XFER-STATUS   NOT = PC-VOID-STATUS)                         
               MOVE ASC-XFER-COMP-BEG-DTE(5:4)                          38930099
                                         TO PV-WH-COMP-BEG-YR           38940099
               MOVE ASC-XFER-COMP-BEG-DTE(1:2)                          38950099
                                         TO PV-WH-COMP-BEG-MM           38960099
               MOVE ASC-XFER-COMP-BEG-DTE(3:2)                          38970099
                                         TO PV-WH-COMP-BEG-DD           38980099
               ADD PV-WHERE-SIZE         TO PV-WHERE-BYTES              38990099
               ADD PC-1                  TO PV-WHERE-SUB                39000099
               MOVE PV-WHERE-COMP-BEG-DATE                              39010099
                                         TO PV-WHERE-LINE (PV-WHERE-SUB)39020099
           END-IF.                                                      39030099
                                                                        39040099
           IF  (ASC-XFER-COMP-END-DTE > ZERO)                           39050099
           AND (ASC-XFER-STATUS   NOT = PC-VOID-STATUS)                         
               MOVE ASC-XFER-COMP-END-DTE(5:4)                          39060099
                                         TO PV-WH-COMP-END-YR           39070099
               MOVE ASC-XFER-COMP-END-DTE(1:2)                          39080099
                                         TO PV-WH-COMP-END-MM           39090099
               MOVE ASC-XFER-COMP-END-DTE(3:2)                          39100099
                                         TO PV-WH-COMP-END-DD           39110099
               ADD PV-WHERE-SIZE         TO PV-WHERE-BYTES              39120099
               ADD PC-1                  TO PV-WHERE-SUB                39130099
               MOVE PV-WHERE-COMP-END-DATE                              39140099
                                         TO PV-WHERE-LINE (PV-WHERE-SUB)39150099
           END-IF.                                                      39160099
                                                                        39170099
           IF  ASC-XFER-RECV-BEG-DTE > ZERO                             39180099
               MOVE ASC-XFER-RECV-BEG-DTE(5:4)                          39190099
                                         TO PV-WH-RECV-BEG-YR           39200099
               MOVE ASC-XFER-RECV-BEG-DTE(1:2)                          39210099
                                         TO PV-WH-RECV-BEG-MM           39220099
               MOVE ASC-XFER-RECV-BEG-DTE(3:2)                          39230099
                                         TO PV-WH-RECV-BEG-DD           39240099
               ADD PV-WHERE-SIZE         TO PV-WHERE-BYTES              39250099
               ADD PC-1                  TO PV-WHERE-SUB                39260099
               MOVE PV-WHERE-RECV-BEG-DATE                              39270099
                                         TO PV-WHERE-LINE (PV-WHERE-SUB)39280099
           END-IF.                                                      39290099
                                                                        39300099
           IF  ASC-XFER-RECV-END-DTE > ZERO                             39310099
               MOVE ASC-XFER-RECV-END-DTE(5:4)                          39320099
                                         TO PV-WH-RECV-END-YR           39330099
               MOVE ASC-XFER-RECV-END-DTE(1:2)                          39340099
                                         TO PV-WH-RECV-END-MM           39350099
               MOVE ASC-XFER-RECV-END-DTE(3:2)                          39360099
                                         TO PV-WH-RECV-END-DD           39370099
               ADD PV-WHERE-SIZE         TO PV-WHERE-BYTES              39380099
               ADD PC-1                  TO PV-WHERE-SUB                39390099
               MOVE PV-WHERE-RECV-END-DATE                              39400099
                                         TO PV-WHERE-LINE (PV-WHERE-SUB)39410099
           END-IF.                                                      39420099
                                                                        39430099
           IF  ASC-XFER-DPT > ZERO                                      39440099
               MOVE ASC-XFER-DPT         TO PV-WH-ITEM-DEPT             39450099
               ADD PV-WHERE-SIZE         TO PV-WHERE-BYTES              39460099
               ADD PC-1                  TO PV-WHERE-SUB                39470099
               MOVE PV-WHERE-ITEM-DEPT   TO PV-WHERE-LINE (PV-WHERE-SUB)39480099
           END-IF.                                                      39490099
                                                                        39500099
           IF  ASC-XFER-CLASS > ZERO                                    39510099
               MOVE ASC-XFER-CLASS       TO PV-WH-ITEM-CLASS            39520099
               ADD PV-WHERE-SIZE         TO PV-WHERE-BYTES              39530099
               ADD PC-1                  TO PV-WHERE-SUB                39540099
               MOVE PV-WHERE-ITEM-CLASS  TO PV-WHERE-LINE (PV-WHERE-SUB)39550099
           END-IF.                                                      39560099
                                                                        39500099
           IF  ASC-XFER-SUBCL > SPACES                                  39510099
               MOVE ASC-XFER-SUBCL       TO PV-WH-ITEM-SUBCL            39520099
               ADD PV-WHERE-SIZE         TO PV-WHERE-BYTES              39530099
               ADD PC-1                  TO PV-WHERE-SUB                39540099
               MOVE PV-WHERE-ITEM-SUBCL  TO PV-WHERE-LINE (PV-WHERE-SUB)39550099
           END-IF.                                                      39560099
                                                                        39570099
101803*----------------------------------------------------------------*        
101803*    UPC IS PASSED THROUGH UPC CHECK FOR A DUMMY CHECK           *        
101803*    IF A DUMMY UPC NUMBER WAS ENTERED IN THE PANEL, BOTH        *        
101803*    TSKXREF AND XST_UPC TABLE JOINS ARE REMOVED FROM SQL.       *        
101803*----------------------------------------------------------------*        
101803*    IF  ASC-XFER-UPC > ZERO                                              
101803*        MOVE ASC-XFER-UPC TO PV-HOLD-UPC-NBR                             
101803*        IF (PV-KOHLS-UPC-DIGITS = '0400')  AND                           
101803*           (PV-KOHLS-DUMMY-SKU = '000')                                  
                                                                                
101803     IF  ASC-XFER-UPC > ZERO                                              
101803         MOVE ASC-XFER-UPC TO DP040I-UPC-CODE                             
101803         SET DP040I-EXTRACT-SKU-FROM-UPC TO TRUE                          
101803         CALL DP040I-UPC-CHECK-DIGIT-WO-IUPC                              
101803                         USING DP040I-UPC-CHECK-DIGIT-PARMS               
101803         IF NOT DP040I-UPC-NOT-DUMMY-UPC                                  
                   MOVE SPACES TO PV-BUILD-TSKXREF-DB2                          
                                  PV-BUILD-QUAL-XI3A                            
                                  PV-BUILD-TSKXREF-DBA                          
                                  PV-BUILD-TSKXREF-TABLE                        
101803                            PV-BUILD-XSTUPC-DB2                           
101803                            PV-BUILD-QUAL-XI3B                            
101803                            PV-BUILD-XSTUPC-DBA                           
101803                            PV-BUILD-XSTUPC-TABLE                         
                                  PV-BUILD-TSKXREF-AND                          
                                  PV-BUILD-TSKXREF-TTFITEM-LINK                 
101803*            MOVE ASC-XFER-UPC         TO PV-WH-ITEM-SCN-UPC      39450099
101803*                                         PV-WH-ITEM-KOHLS-UPC            
101803             MOVE ASC-XFER-UPC         TO PV-WH-ITEM-XST-UPC              
                   ADD PV-WHERE-SIZE         TO PV-WHERE-BYTES          39460099
                   ADD PC-1                  TO PV-WHERE-SUB            39470099
101803*            MOVE PV-WHERE-ITEM-UPC    TO                         39480099
101803*                                  PV-WHERE-LINE (PV-WHERE-SUB)   39480099
101803             MOVE PV-WHERE-XST-UPC    TO                                  
101803                                   PV-WHERE-LINE (PV-WHERE-SUB)           
               ELSE                                                             
101803*            MOVE ASC-XFER-UPC         TO PV-WH-ITEM-SCN-UPC      39450099
101803*                                         PV-WH-ITEM-KOHLS-UPC            
101803             MOVE ASC-XFER-UPC         TO PV-WH-ITEM-XST-UPC              
                   ADD PV-WHERE-SIZE         TO PV-WHERE-BYTES          39460099
                   ADD PC-1                  TO PV-WHERE-SUB            39470099
101803*            MOVE PV-WHERE-ITEM-UPC    TO                         39480099
101803*                                  PV-WHERE-LINE (PV-WHERE-SUB)   39480099
101803             MOVE PV-WHERE-XST-UPC    TO                                  
101803                                   PV-WHERE-LINE (PV-WHERE-SUB)           
               END-IF                                                           
           END-IF.                                                      39490099
                                                                        39500099
           IF  ASC-XFER-CALLBACK-NBR > ZERO                             39580099
               MOVE ASC-XFER-CALLBACK-NBR                               39590099
                                         TO PV-WH-CALLBACK-NBR          39600099
               ADD PV-WHERE-SIZE         TO PV-WHERE-BYTES              39610099
               ADD PC-1                  TO PV-WHERE-SUB                39620099
               MOVE PV-WHERE-CALLBACK-NBR                               39630099
                                         TO PV-WHERE-LINE (PV-WHERE-SUB)39640099
           END-IF.                                                      39650099
                                                                        39660099
           IF  ASC-XFER-APPROVAL-NBR > ZERO                             39670099
               MOVE ASC-XFER-APPROVAL-NBR                               39680099
                                         TO PV-WH-APPROVAL-NBR          39690099
               ADD PV-WHERE-SIZE         TO PV-WHERE-BYTES              39700099
               ADD PC-1                  TO PV-WHERE-SUB                39710099
               MOVE PV-WHERE-APPROVAL-NBR                               39720099
                                         TO PV-WHERE-LINE (PV-WHERE-SUB)39730099
           END-IF.                                                      39740099
                                                                        39750099
           IF  ASC-XFER-COMP-BY-FIRST-INIT > SPACE                      39760099
               MOVE ASC-XFER-COMP-BY-FIRST-INIT                         39770099
                                         TO PV-WH-COMP-INIT-NM          39780099
               ADD PV-WHERE-SIZE         TO PV-WHERE-BYTES              39790099
               ADD PC-1                  TO PV-WHERE-SUB                39800099
               MOVE PV-WHERE-COMP-INIT-NM                               39810099
                                         TO PV-WHERE-LINE (PV-WHERE-SUB)39820099
           END-IF.                                                      39830099
                                                                        39840099
           IF  ASC-XFER-COMP-BY-LAST-NAME > SPACE                       39850099
               STRING ASC-XFER-COMP-BY-LAST-NAME  DELIMITED BY '   '    39860099
                      PC-APOSTROPHE               DELIMITED BY SIZE     39870099
                   INTO PV-WH-COMP-LAST-NM-DELIM                        39880099
               ADD PV-WHERE-SIZE         TO PV-WHERE-BYTES              39890099
               ADD PC-1                  TO PV-WHERE-SUB                39900099
               MOVE PV-WHERE-COMP-LAST-NM                               39910099
                                         TO PV-WHERE-LINE (PV-WHERE-SUB)39920099
           END-IF.                                                      39930099
                                                                        39940099
           IF  ASC-XFER-RECV-BY-FIRST-INIT > SPACE                      39950099
               MOVE ASC-XFER-RECV-BY-FIRST-INIT                         39960099
                                         TO PV-WH-RECV-INIT-NM          39970099
               ADD PV-WHERE-SIZE         TO PV-WHERE-BYTES              39980099
               ADD PC-1                  TO PV-WHERE-SUB                39990099
               MOVE PV-WHERE-RECV-INIT-NM                               40000099
                                         TO PV-WHERE-LINE (PV-WHERE-SUB)40010099
           END-IF.                                                      40020099
                                                                        40030099
           IF  ASC-XFER-RECV-BY-LAST-NAME > SPACE                       40040099
               STRING ASC-XFER-RECV-BY-LAST-NAME  DELIMITED BY '   '    40050099
                      PC-APOSTROPHE               DELIMITED BY SIZE     40060099
                   INTO PV-WH-RECV-LAST-NM-DELIM                        40070099
               ADD PV-WHERE-SIZE         TO PV-WHERE-BYTES              40080099
               ADD PC-1                  TO PV-WHERE-SUB                40090099
               MOVE PV-WHERE-RECV-LAST-NM                               40100099
                                         TO PV-WHERE-LINE (PV-WHERE-SUB)40110099
           END-IF.                                                      40120099
                                                                        40130099
           IF  ASC-CRITERIA-SORT-ORDER = ZEROES                         40140099
      *        SELECT THE CORRECT DEFAULT ORDER BY FIELDS               40150099
               IF ASC-CALLBACK-TYPE                                     40160099
                   MOVE PV-ORDER-BY-CALLBACK-NBR                        40170099
                                         TO PV-BUILD-ORDER-BY-LITERAL   40180099
                   ADD PV-ORDER-BY-SIZE  TO PV-ORDER-BY-BYTES           40190099
                   ADD PC-1              TO PV-ORD-BY-SUB               40200099
                   MOVE PV-BUILD-ORDER-BY                               40210099
                                    TO PV-ORDER-BY-LINE (PV-ORD-BY-SUB) 40220099
               ELSE                                                     40230099
                   IF ASC-STOCK-BAL-CORP-TYPE                           40240099
                       MOVE PV-ORDER-BY-APPROVAL-NBR                    40250099
                                         TO PV-BUILD-ORDER-BY-LITERAL   40260099
                       ADD PV-ORDER-BY-SIZE                             40270099
                                         TO PV-ORDER-BY-BYTES           40280099
                       ADD PC-1          TO PV-ORD-BY-SUB               40290099
                       MOVE PV-BUILD-ORDER-BY                           40300099
                                    TO PV-ORDER-BY-LINE (PV-ORD-BY-SUB) 40310099
                   ELSE                                                 40320099
                       MOVE PV-ORDER-BY-FROM-STORE                      40330099
                                         TO PV-BUILD-ORDER-BY-LITERAL   40340099
                       ADD PV-ORDER-BY-SIZE                             40350099
                                         TO PV-ORDER-BY-BYTES           40360099
                       ADD PC-1          TO PV-ORD-BY-SUB               40370099
                       MOVE PV-BUILD-ORDER-BY                           40380099
                                    TO PV-ORDER-BY-LINE (PV-ORD-BY-SUB) 40390099
                       MOVE PV-BUILD-ORDER-BY-COMMA                     40400099
                                         TO PV-BUILD-ORDER-BY-PREFIX    40410099
                       MOVE PV-ORDER-BY-XFER-SEQ-NBR                    40420099
                                         TO PV-BUILD-ORDER-BY-LITERAL   40430099
                       ADD PV-ORDER-BY-SIZE                             40440099
                                         TO PV-ORDER-BY-BYTES           40450099
                       ADD PC-1          TO PV-ORD-BY-SUB               40460099
                       MOVE PV-BUILD-ORDER-BY                           40470099
                                    TO PV-ORDER-BY-LINE (PV-ORD-BY-SUB) 40480099
                   END-IF                                               40490099
               END-IF                                                   40500099
           ELSE                                                         40510099
               PERFORM 4110-BUILD-ORDER-BY-TABLE                        40520099
                   VARYING PV-ORDER-BY-COUNT                            40530099
                   FROM 1 BY 1                                          40540099
                   UNTIL PV-ORDER-BY-COUNT > 8                          40550099
           END-IF.                                                      40560099
                                                                        40570099
      /                                                                 40580099
      *----------------------------------------------------------------*40590099
      *    INSERT AN ORDER BY CLAUSE WITH THE PROPER ORDER BY PREFIX    40600099
      *    INTO THE GENERIC CURSOR ORDER BY CLAUSE FOR EACH SORT ORDER  40610099
      *    FIELD.                                                       40620099
      *----------------------------------------------------------------*40630099
                                                                        40640099
       4110-BUILD-ORDER-BY-TABLE.                                       40650099
                                                                        40660099
           IF  ASC-XFER-TYPE-SORT-NR = PV-ORDER-BY-COUNT                40670099
               MOVE PV-ORDER-BY-XFER-TYPE                               40680099
                                         TO PV-BUILD-ORDER-BY-LITERAL   40690099
               ADD PV-ORDER-BY-SIZE      TO PV-ORDER-BY-BYTES           40700099
               ADD PC-1                  TO PV-ORD-BY-SUB               40710099
               MOVE PV-BUILD-ORDER-BY                                   40720099
                                    TO PV-ORDER-BY-LINE (PV-ORD-BY-SUB) 40730099
               MOVE PV-BUILD-ORDER-BY-COMMA                             40740099
                                         TO PV-BUILD-ORDER-BY-PREFIX    40750099
           END-IF.                                                      40760099
                                                                        40770099
           IF  ASC-XFER-STATUS-SORT-NR = PV-ORDER-BY-COUNT              40780099
               MOVE PV-ORDER-BY-XFER-STATUS                             40790099
                                         TO PV-BUILD-ORDER-BY-LITERAL   40800099
               ADD PV-ORDER-BY-SIZE      TO PV-ORDER-BY-BYTES           40810099
               ADD PC-1                  TO PV-ORD-BY-SUB               40820099
               MOVE PV-BUILD-ORDER-BY                                   40830099
                                    TO PV-ORDER-BY-LINE (PV-ORD-BY-SUB) 40840099
               MOVE PV-BUILD-ORDER-BY-COMMA                             40850099
                                         TO PV-BUILD-ORDER-BY-PREFIX    40860099
           END-IF.                                                      40870099
                                                                        40880099
           IF  ASC-XFER-FROM-STR-SORT-NR = PV-ORDER-BY-COUNT            40890099
               MOVE PV-ORDER-BY-FROM-STORE                              40900099
                                         TO PV-BUILD-ORDER-BY-LITERAL   40910099
               ADD PV-ORDER-BY-SIZE      TO PV-ORDER-BY-BYTES           40920099
               ADD PC-1                  TO PV-ORD-BY-SUB               40930099
               MOVE PV-BUILD-ORDER-BY                                   40940099
                                    TO PV-ORDER-BY-LINE (PV-ORD-BY-SUB) 40950099
               MOVE PV-BUILD-ORDER-BY-COMMA                             40960099
                                         TO PV-BUILD-ORDER-BY-PREFIX    40970099
           END-IF.                                                      40980099
                                                                        40990099
           IF  ASC-XFER-TO-STR-SORT-NR = PV-ORDER-BY-COUNT              41000099
               MOVE PV-ORDER-BY-TO-STORE TO PV-BUILD-ORDER-BY-LITERAL   41010099
               ADD PV-ORDER-BY-SIZE      TO PV-ORDER-BY-BYTES           41020099
               ADD PC-1                  TO PV-ORD-BY-SUB               41030099
               MOVE PV-BUILD-ORDER-BY                                   41040099
                                    TO PV-ORDER-BY-LINE (PV-ORD-BY-SUB) 41050099
               MOVE PV-BUILD-ORDER-BY-COMMA                             41060099
                                         TO PV-BUILD-ORDER-BY-PREFIX    41070099
           END-IF.                                                      41080099
                                                                        41090099
           IF  ASC-XFER-COMP-DTE-SORT-NR = PV-ORDER-BY-COUNT            41100099
               MOVE PV-ORDER-BY-COMP-BEG-DATE                           41110099
                                         TO PV-BUILD-ORDER-BY-LITERAL   41120099
               ADD PV-ORDER-BY-SIZE      TO PV-ORDER-BY-BYTES           41130099
               ADD PC-1                  TO PV-ORD-BY-SUB               41140099
               MOVE PV-BUILD-ORDER-BY                                   41150099
                                    TO PV-ORDER-BY-LINE (PV-ORD-BY-SUB) 41160099
               MOVE PV-BUILD-ORDER-BY-COMMA                             41170099
                                         TO PV-BUILD-ORDER-BY-PREFIX    41180099
               MOVE PV-ORDER-BY-COMP-END-DATE                           41190099
                                         TO PV-BUILD-ORDER-BY-LITERAL   41200099
               ADD PV-ORDER-BY-SIZE      TO PV-ORDER-BY-BYTES           41210099
               ADD PC-1                  TO PV-ORD-BY-SUB               41220099
               MOVE PV-BUILD-ORDER-BY                                   41230099
                                    TO PV-ORDER-BY-LINE (PV-ORD-BY-SUB) 41240099
           END-IF.                                                      41250099
                                                                        41260099
           IF  ASC-XFER-RECV-DTE-SORT-NR = PV-ORDER-BY-COUNT            41270099
               MOVE PV-ORDER-BY-RECV-BEG-DATE                           41280099
                                         TO PV-BUILD-ORDER-BY-LITERAL   41290099
               ADD PV-ORDER-BY-SIZE      TO PV-ORDER-BY-BYTES           41300099
               ADD PC-1                  TO PV-ORD-BY-SUB               41310099
               MOVE PV-BUILD-ORDER-BY                                   41320099
                                    TO PV-ORDER-BY-LINE (PV-ORD-BY-SUB) 41330099
               MOVE PV-BUILD-ORDER-BY-COMMA                             41340099
                                         TO PV-BUILD-ORDER-BY-PREFIX    41350099
               MOVE PV-ORDER-BY-RECV-END-DATE                           41360099
                                         TO PV-BUILD-ORDER-BY-LITERAL   41370099
               ADD PV-ORDER-BY-SIZE      TO PV-ORDER-BY-BYTES           41380099
               ADD PC-1                  TO PV-ORD-BY-SUB               41390099
               MOVE PV-BUILD-ORDER-BY                                   41400099
                                    TO PV-ORDER-BY-LINE (PV-ORD-BY-SUB) 41410099
           END-IF.                                                      41420099
                                                                        41430099
           IF  ASC-XFER-CALLBCK-NR-SORT-NR = PV-ORDER-BY-COUNT          41440099
               MOVE PV-ORDER-BY-CALLBACK-NBR                            41450099
                                         TO PV-BUILD-ORDER-BY-LITERAL   41460099
               ADD PV-ORDER-BY-SIZE      TO PV-ORDER-BY-BYTES           41470099
               ADD PC-1                  TO PV-ORD-BY-SUB               41480099
               MOVE PV-BUILD-ORDER-BY                                   41490099
                                    TO PV-ORDER-BY-LINE (PV-ORD-BY-SUB) 41500099
               MOVE PV-BUILD-ORDER-BY-COMMA                             41510099
                                         TO PV-BUILD-ORDER-BY-PREFIX    41520099
           END-IF.                                                      41530099
                                                                        41540099
           IF  ASC-XFER-APPRV-NR-SORT-NR = PV-ORDER-BY-COUNT            41550099
               MOVE PV-ORDER-BY-APPROVAL-NBR                            41560099
                                         TO PV-BUILD-ORDER-BY-LITERAL   41570099
               ADD PV-ORDER-BY-SIZE      TO PV-ORDER-BY-BYTES           41580099
               ADD PC-1                  TO PV-ORD-BY-SUB               41590099
               MOVE PV-BUILD-ORDER-BY                                   41600099
                                    TO PV-ORDER-BY-LINE (PV-ORD-BY-SUB) 41610099
               MOVE PV-BUILD-ORDER-BY-COMMA                             41620099
                                         TO PV-BUILD-ORDER-BY-PREFIX    41630099
           END-IF.                                                      41640099
                                                                        41650099
      /                                                                 41660099
      *----------------------------------------------------------------*41670099
      *    PLACE ALL 'WHERE' AND 'ORDER BY' LINES INTO THE APPROPRIATE *41680099
      *    SQL LIST.                                                   *41690099
      *----------------------------------------------------------------*41700099
                                                                        41710099
       4210-COMBINE-SQL.                                                41720099
                                                                        41730099
           IF PS-XFER-LIST-CSR                                          41740099
               STRING PV-WHERE-LINE (1)  DELIMITED BY '   '             41750099
                      PV-WHERE-LINE (2)  DELIMITED BY '   '             41760099
                      PV-WHERE-LINE (3)  DELIMITED BY '   '             41770099
                      PV-WHERE-LINE (4)  DELIMITED BY '   '             41780099
                      PV-WHERE-LINE (5)  DELIMITED BY '   '             41790099
                      PV-WHERE-LINE (6)  DELIMITED BY '   '             41800099
                      PV-WHERE-LINE (7)  DELIMITED BY '   '             41810099
                      PV-WHERE-LINE (8)  DELIMITED BY '   '             41820099
                      PV-WHERE-LINE (9)  DELIMITED BY '   '             41830099
                      PV-WHERE-LINE (10) DELIMITED BY '   '             41840099
                      PV-WHERE-LINE (11) DELIMITED BY '   '             41850099
                      PV-BUILD-ORDER-BY-COMMAND                         41860099
                                            DELIMITED BY SIZE           41870099
                      PV-ORDER-BY-LINE (1)  DELIMITED BY '   '          41880099
                      PV-ORDER-BY-LINE (2)  DELIMITED BY '   '          41890099
                      PV-ORDER-BY-LINE (3)  DELIMITED BY '   '          41900099
                      PV-ORDER-BY-LINE (4)  DELIMITED BY '   '          41910099
                      PV-ORDER-BY-LINE (5)  DELIMITED BY '   '          41920099
                      PV-ORDER-BY-LINE (6)  DELIMITED BY '   '          41930099
                      PV-ORDER-BY-LINE (7)  DELIMITED BY '   '          41940099
                      PV-ORDER-BY-LINE (8)  DELIMITED BY '   '          41950099
                      PV-ORDER-BY-LINE (9)  DELIMITED BY '   '          41960099
                      PV-ORDER-BY-LINE (10) DELIMITED BY '   '          41970099
                   INTO PVBLDSQL-XFER-LIST-WH-ORD                       41980099
               ADD PV-XFER-LIST-SELECT-BYTES                            41990099
                   PV-WHERE-BYTES                                       42000099
                   PV-ORDER-BY-BYTES                                    42010099
                   GIVING PV-BUILD-XFER-LIST-LEN                        42020099
               MOVE PV-BUILD-XFER-LIST-LEN TO PV-SQL-STMT-LEN           42030099
               MOVE PV-BUILD-XFER-LIST-SEL-STMT TO PV-SQL-STMT-TEXT     42040099
           END-IF.                                                      42050099
                                                                        42060099
           IF PS-XFER-ITEM-CSR                                          42070099
               STRING PV-WHERE-LINE (1)  DELIMITED BY '   '             42080099
                      PV-WHERE-LINE (2)  DELIMITED BY '   '             42090099
                      PV-WHERE-LINE (3)  DELIMITED BY '   '             42100099
                      PV-WHERE-LINE (4)  DELIMITED BY '   '             42110099
                      PV-WHERE-LINE (5)  DELIMITED BY '   '             42120099
                      PV-WHERE-LINE (6)  DELIMITED BY '   '             42130099
                      PV-WHERE-LINE (7)  DELIMITED BY '   '             42140099
                      PV-WHERE-LINE (8)  DELIMITED BY '   '             42150099
                      PV-WHERE-LINE (9)  DELIMITED BY '   '             42160099
                      PV-WHERE-LINE (10) DELIMITED BY '   '             42170099
                      PV-WHERE-LINE (11) DELIMITED BY '   '             42180099
                      PV-WHERE-LINE (12) DELIMITED BY '   '             42190099
                      PV-WHERE-LINE (13) DELIMITED BY '   '             42200099
                      PV-BUILD-ORDER-BY-COMMAND                         42210099
                                            DELIMITED BY SIZE           42220099
                      PV-ORDER-BY-LINE (1)  DELIMITED BY '   '          42230099
                      PV-ORDER-BY-LINE (2)  DELIMITED BY '   '          42240099
                      PV-ORDER-BY-LINE (3)  DELIMITED BY '   '          42250099
                      PV-ORDER-BY-LINE (4)  DELIMITED BY '   '          42260099
                      PV-ORDER-BY-LINE (5)  DELIMITED BY '   '          42270099
                      PV-ORDER-BY-LINE (6)  DELIMITED BY '   '          42280099
                      PV-ORDER-BY-LINE (7)  DELIMITED BY '   '          42290099
                      PV-ORDER-BY-LINE (8)  DELIMITED BY '   '          42300099
                      PV-ORDER-BY-LINE (9)  DELIMITED BY '   '          42310099
                      PV-ORDER-BY-LINE (10) DELIMITED BY '   '          42320099
                   INTO PVBLDSQL-XFER-ITEM-WH-ORD                       42330099
               ADD PV-XFER-ITEM-SELECT-BYTES                            42340099
                   PV-WHERE-BYTES                                       42350099
                   PV-ORDER-BY-BYTES                                    42360099
                   GIVING PV-BUILD-XFER-ITEM-LEN                        42370099
               MOVE PV-BUILD-XFER-ITEM-LEN TO PV-SQL-STMT-LEN           42380099
               MOVE PV-BUILD-XFER-ITEM-SEL-STMT TO PV-SQL-STMT-TEXT     42390099
           END-IF.                                                      42400099
                                                                        42410099
                                                                        42420099
           IF PS-XFER-RCVR-CSR                                          42430099
               STRING PV-WHERE-LINE (1)  DELIMITED BY '   '             42440099
                      PV-WHERE-LINE (2)  DELIMITED BY '   '             42450099
                      PV-WHERE-LINE (3)  DELIMITED BY '   '             42460099
                      PV-WHERE-LINE (4)  DELIMITED BY '   '             42470099
                      PV-WHERE-LINE (5)  DELIMITED BY '   '             42480099
                      PV-WHERE-LINE (6)  DELIMITED BY '   '             42490099
                      PV-WHERE-LINE (7)  DELIMITED BY '   '             42500099
                      PV-WHERE-LINE (8)  DELIMITED BY '   '             42510099
                      PV-WHERE-LINE (9)  DELIMITED BY '   '             42520099
                      PV-WHERE-LINE (10) DELIMITED BY '   '             42530099
                      PV-WHERE-LINE (11) DELIMITED BY '   '             42540099
                      PV-WHERE-LINE (12) DELIMITED BY '   '             42550099
                      PV-WHERE-LINE (13) DELIMITED BY '   '             42560099
                      PV-WHERE-LINE (14) DELIMITED BY '   '             42570099
                      PV-WHERE-LINE (15) DELIMITED BY '   '             42580099
                      PV-BUILD-ORDER-BY-COMMAND                         42590099
                                            DELIMITED BY SIZE           42600099
                      PV-ORDER-BY-LINE (1)  DELIMITED BY '   '          42610099
                      PV-ORDER-BY-LINE (2)  DELIMITED BY '   '          42620099
                      PV-ORDER-BY-LINE (3)  DELIMITED BY '   '          42630099
                      PV-ORDER-BY-LINE (4)  DELIMITED BY '   '          42640099
                      PV-ORDER-BY-LINE (5)  DELIMITED BY '   '          42650099
                      PV-ORDER-BY-LINE (6)  DELIMITED BY '   '          42660099
                      PV-ORDER-BY-LINE (7)  DELIMITED BY '   '          42670099
                      PV-ORDER-BY-LINE (8)  DELIMITED BY '   '          42680099
                      PV-ORDER-BY-LINE (9)  DELIMITED BY '   '          42690099
                      PV-ORDER-BY-LINE (10) DELIMITED BY '   '          42700099
                   INTO PVBLDSQL-XFER-RCVR-WH-ORD                       42710099
               ADD PV-XFER-RCVR-SELECT-BYTES                            42720099
                   PV-WHERE-BYTES                                       42730099
                   PV-ORDER-BY-BYTES                                    42740099
                   GIVING PV-BUILD-XFER-RCVR-LEN                        42750099
               MOVE PV-BUILD-XFER-RCVR-LEN TO PV-SQL-STMT-LEN           42760099
               MOVE PV-BUILD-XFER-RCVR-SEL-STMT TO PV-SQL-STMT-TEXT     42770099
           END-IF.                                                      42780099
                                                                        42790099
           IF PS-XFER-ALL-CSR                                           42800099
               STRING PV-WHERE-LINE (1)  DELIMITED BY '   '             42810099
                      PV-WHERE-LINE (2)  DELIMITED BY '   '             42820099
                      PV-WHERE-LINE (3)  DELIMITED BY '   '             42830099
                      PV-WHERE-LINE (4)  DELIMITED BY '   '             42840099
                      PV-WHERE-LINE (5)  DELIMITED BY '   '             42850099
                      PV-WHERE-LINE (6)  DELIMITED BY '   '             42860099
                      PV-WHERE-LINE (7)  DELIMITED BY '   '             42870099
                      PV-WHERE-LINE (8)  DELIMITED BY '   '             42880099
                      PV-WHERE-LINE (9)  DELIMITED BY '   '             42890099
                      PV-WHERE-LINE (10) DELIMITED BY '   '             42900099
                      PV-WHERE-LINE (11) DELIMITED BY '   '             42910099
                      PV-WHERE-LINE (12) DELIMITED BY '   '             42920099
                      PV-WHERE-LINE (13) DELIMITED BY '   '             42930099
                      PV-WHERE-LINE (14) DELIMITED BY '   '             42940099
                      PV-WHERE-LINE (15) DELIMITED BY '   '             42950099
                      PV-WHERE-LINE (16) DELIMITED BY '   '             42960099
                      PV-WHERE-LINE (17) DELIMITED BY '   '             42970099
                      PV-BUILD-ORDER-BY-COMMAND                         42980099
                                            DELIMITED BY SIZE           42990099
                      PV-ORDER-BY-LINE (1)  DELIMITED BY '   '          43000099
                      PV-ORDER-BY-LINE (2)  DELIMITED BY '   '          43010099
                      PV-ORDER-BY-LINE (3)  DELIMITED BY '   '          43020099
                      PV-ORDER-BY-LINE (4)  DELIMITED BY '   '          43030099
                      PV-ORDER-BY-LINE (5)  DELIMITED BY '   '          43040099
                      PV-ORDER-BY-LINE (6)  DELIMITED BY '   '          43050099
                      PV-ORDER-BY-LINE (7)  DELIMITED BY '   '          43060099
                      PV-ORDER-BY-LINE (8)  DELIMITED BY '   '          43070099
                      PV-ORDER-BY-LINE (9)  DELIMITED BY '   '          43080099
                      PV-ORDER-BY-LINE (10) DELIMITED BY '   '          43090099
                   INTO PVBLDSQL-XFER-ALL-WH-ORD                        43100099
               ADD PV-XFER-ALL-SELECT-BYTES                             43110099
                   PV-WHERE-BYTES                                       43120099
                   PV-ORDER-BY-BYTES                                    43130099
                   GIVING PV-BUILD-XFER-ALL-LEN                         43140099
               MOVE PV-BUILD-XFER-ALL-LEN TO PV-SQL-STMT-LEN            43150099
               MOVE PV-BUILD-XFER-ALL-SEL-STMT TO PV-SQL-STMT-TEXT      43160099
           END-IF.                                                      43170099
                                                                        43180099
       EJECT                                                            43190099
      *----------------------------------------------------------------*43200099
      *    DECLARE THE CURSOR FOR DYNAMIC SQL CALL                     *43210099
      *----------------------------------------------------------------*43220099
                                                                        43230099
       4220-DECLARE-CURSOR.                                             43240099
                                                                        43250099
           IF PS-XFER-LIST-CSR                                          43260099
               PERFORM 4221-DECLARE-LIST-CURSOR                         43270099
           ELSE                                                         43280099
               IF PS-XFER-ITEM-CSR                                      43290099
                   PERFORM 4222-DECLARE-ITEM-CURSOR                     43300099
               ELSE                                                     43310099
                   IF PS-XFER-RCVR-CSR                                  43320099
                       PERFORM 4223-DECLARE-RCVR-CURSOR                 43330099
                   ELSE                                                 43340099
                       PERFORM 4224-DECLARE-ALL-CURSOR                  43350099
                   END-IF                                               43360099
               END-IF                                                   43370099
           END-IF.                                                      43380099
                                                                        43390099
       EJECT                                                            43400099
      *----------------------------------------------------------------*43410099
      *    DECLARE THE TRANSFER LIST CURSOR FOR DYNAMIC SQL CALL       *43420099
      *----------------------------------------------------------------*43430099
                                                                        43440099
       4221-DECLARE-LIST-CURSOR.                                        43450099
                                                                        43460099
           EXEC SQL                                                     43470099
               DECLARE XFER-LIST-CSR CURSOR FOR                         43480099
                       XFER-SELECT-LIST                                 43490099
           END-EXEC.                                                    43500099
                                                                        43510099
                                                                        43520099
           EVALUATE TRUE                                                43530099
               WHEN SQLCODE = +0                                        43540099
                    CONTINUE                                            43550099
               WHEN OTHER                                               43560099
                    MOVE '4221-DECLARE-LIST-CURSOR'                     43580099
                                     TO DP013-PARAGRAPH                 43590099
                    MOVE 'DECLARE TRANSFER LIST CURSOR'                 43600099
                                     TO DP013-MESSAGE-TEXT (1)          43610099
                    MOVE SQLCA       TO DP013-SQLCA                     43620099
                    MOVE 'TTFMSTR'   TO DP013-DB2-TABLE-NAME (1)        43630099
                    MOVE 'TTFSTAT'   TO DP013-DB2-TABLE-NAME (2)        43640099
                    SET DP013-DB2-ABEND                                 43650099
                                     TO TRUE                            43660099
                    PERFORM DP013-0000-PROCESS-ABEND                    43670099
           END-EVALUATE.                                                43680099
                                                                        43690099
       EJECT                                                            43700099
      *----------------------------------------------------------------*43710099
      *    DECLARE THE TRANSFER ITEM CURSOR FOR DYNAMIC SQL CALL        43720099
      *----------------------------------------------------------------*43730099
                                                                        43740099
       4222-DECLARE-ITEM-CURSOR.                                        43750099
                                                                        43760099
           EXEC SQL                                                     43770099
               DECLARE XFER-ITEM-CSR CURSOR FOR                         43780099
                       XFER-SELECT-ITEM                                 43790099
           END-EXEC.                                                    43800099
                                                                        43810099
                                                                        43820099
           EVALUATE TRUE                                                43830099
               WHEN SQLCODE = +0                                        43840099
                    CONTINUE                                            43850099
               WHEN OTHER                                               43860099
                    MOVE '4222-DECLARE-ITEM-CURSOR'                     43880099
                                     TO DP013-PARAGRAPH                 43890099
                    MOVE 'DECLARE TRANSFER ITEM CURSOR'                 43900099
                                     TO DP013-MESSAGE-TEXT (1)          43910099
                    MOVE SQLCA       TO DP013-SQLCA                     43920099
                    MOVE 'TTFMSTR'   TO DP013-DB2-TABLE-NAME (1)        43930099
                    MOVE 'TTFSTAT'   TO DP013-DB2-TABLE-NAME (2)        43940099
                    MOVE 'TTFITEM'   TO DP013-DB2-TABLE-NAME (3)        43950099
                    SET DP013-DB2-ABEND                                 43960099
                                     TO TRUE                            43970099
                    PERFORM DP013-0000-PROCESS-ABEND                    43980099
           END-EVALUATE.                                                43990099
                                                                        44000099
       EJECT                                                            44010099
      *----------------------------------------------------------------*44020099
      *    DECLARE THE TRANSFER RECEIVER CURSOR FOR DYNAMIC SQL CALL   *44030099
      *----------------------------------------------------------------*44040099
                                                                        44050099
       4223-DECLARE-RCVR-CURSOR.                                        44060099
                                                                        44070099
           EXEC SQL                                                     44080099
               DECLARE XFER-RCVR-CSR CURSOR FOR                         44090099
                       XFER-SELECT-RCVR                                 44100099
           END-EXEC.                                                    44110099
                                                                        44120099
                                                                        44130099
           EVALUATE TRUE                                                44140099
               WHEN SQLCODE = +0                                        44150099
                    CONTINUE                                            44160099
               WHEN OTHER                                               44170099
                    MOVE '4223-DECLARE-RCVR-CURSOR'                     44190099
                                     TO DP013-PARAGRAPH                 44200099
                    MOVE 'DECLARE TRANSFER RECEIVER CURSOR'             44210099
                                     TO DP013-MESSAGE-TEXT (1)          44220099
                    MOVE SQLCA       TO DP013-SQLCA                     44230099
                    MOVE 'TTFMSTR'   TO DP013-DB2-TABLE-NAME (1)        44240099
                    MOVE 'TTFSTAT'   TO DP013-DB2-TABLE-NAME (2)        44250099
                    MOVE 'TTFRCVR'   TO DP013-DB2-TABLE-NAME (3)        44260099
                    SET DP013-DB2-ABEND                                 44270099
                                     TO TRUE                            44280099
                    PERFORM DP013-0000-PROCESS-ABEND                    44290099
           END-EVALUATE.                                                44300099
                                                                        44310099
       EJECT                                                            44320099
      *----------------------------------------------------------------*44330099
      *    DECLARE THE TRANSFER ALL CURSOR FOR DYNAMIC SQL CALL        *44340099
      *----------------------------------------------------------------*44350099
                                                                        44360099
       4224-DECLARE-ALL-CURSOR.                                         44370099
                                                                        44380099
           EXEC SQL                                                     44390099
               DECLARE XFER-ALL-CSR CURSOR FOR                          44400099
                       XFER-SELECT-ALL                                  44410099
           END-EXEC.                                                    44420099
                                                                        44430099
                                                                        44440099
           EVALUATE TRUE                                                44450099
               WHEN SQLCODE = +0                                        44460099
                    CONTINUE                                            44470099
               WHEN OTHER                                               44480099
                    MOVE '4224-DECLARE-ALL-CURSOR'                      44500099
                                     TO DP013-PARAGRAPH                 44510099
                    MOVE 'DECLARE TRANSFER ALL CURSOR'                  44520099
                                     TO DP013-MESSAGE-TEXT (1)          44530099
                    MOVE SQLCA       TO DP013-SQLCA                     44540099
                    MOVE 'TTFMSTR'   TO DP013-DB2-TABLE-NAME (1)        44550099
                    MOVE 'TTFSTAT'   TO DP013-DB2-TABLE-NAME (2)        44560099
                    MOVE 'TTFITEM'   TO DP013-DB2-TABLE-NAME (3)        44570099
                    MOVE 'TTFRCVR'   TO DP013-DB2-TABLE-NAME (4)        44580099
                    SET DP013-DB2-ABEND                                 44590099
                                     TO TRUE                            44600099
                    PERFORM DP013-0000-PROCESS-ABEND                    44610099
           END-EVALUATE.                                                44620099
                                                                        44630099
       EJECT                                                            44640099
      *----------------------------------------------------------------*44650099
      *  PREPARE THE APPROPRIATE TRANSFER CURSOR FOR DYNAMIC SQL CALL. *44660099
      *----------------------------------------------------------------*44670099
                                                                        44680099
       4230-PREPARE-CURSOR.                                             44690099
                                                                        44700099
           IF PS-XFER-LIST-CSR                                          44710099
               PERFORM 4231-PREPARE-LIST-CURSOR                         44720099
           ELSE                                                         44730099
               IF PS-XFER-ITEM-CSR                                      44740099
                   PERFORM 4232-PREPARE-ITEM-CURSOR                     44750099
               ELSE                                                     44760099
                   IF PS-XFER-RCVR-CSR                                  44770099
                       PERFORM 4233-PREPARE-RCVR-CURSOR                 44780099
                   ELSE                                                 44790099
                       PERFORM 4234-PREPARE-ALL-CURSOR                  44800099
                   END-IF                                               44810099
               END-IF                                                   44820099
           END-IF.                                                      44830099
                                                                        44840099
      /                                                                 44850099
      *----------------------------------------------------------------*44860099
      *    PREPARE THE TRANSFER LIST CURSOR FOR DYNAMIC SQL CALL       *44870099
      *----------------------------------------------------------------*44880099
                                                                        44890099
       4231-PREPARE-LIST-CURSOR.                                        44900099
                                                                        44910099
           EXEC SQL                                                     44920099
               PREPARE XFER-SELECT-LIST FROM :PV-SQL-STMT               44930099
           END-EXEC.                                                    44940099
                                                                        44950099
                                                                        44960099
           EVALUATE TRUE                                                44970099
               WHEN SQLCODE = +0                                        44980099
                    CONTINUE                                            44990099
               WHEN OTHER                                               45000099
                    MOVE '4231-PREPARE-LIST-CURSOR'                     45020099
                                     TO DP013-PARAGRAPH                 45030099
                    MOVE 'PREPARE TRANSFER LIST CURSOR'                 45040099
                                     TO DP013-MESSAGE-TEXT (1)          45050099
                    MOVE SQLCA       TO DP013-SQLCA                     45060099
                    MOVE 'TTFMSTR'   TO DP013-DB2-TABLE-NAME (1)        45070099
                    MOVE 'TTFSTAT'   TO DP013-DB2-TABLE-NAME (2)        45080099
                    SET DP013-DB2-ABEND                                 45090099
                                     TO TRUE                            45100099
                    PERFORM DP013-0000-PROCESS-ABEND                    45110099
           END-EVALUATE.                                                45120099
                                                                        45130099
      /                                                                 45140099
      *----------------------------------------------------------------*45150099
      *    PREPARE THE TRANSFER ITEM CURSOR FOR DYNAMIC SQL CALL       *45160099
      *----------------------------------------------------------------*45170099
                                                                        45180099
       4232-PREPARE-ITEM-CURSOR.                                        45190099
                                                                        45200099
           EXEC SQL                                                     45210099
               PREPARE XFER-SELECT-ITEM FROM :PV-SQL-STMT               45220099
           END-EXEC.                                                    45230099
                                                                        45240099
                                                                        45250099
           EVALUATE TRUE                                                45260099
               WHEN SQLCODE = +0                                        45270099
                    CONTINUE                                            45280099
               WHEN OTHER                                               45290099
                    MOVE '4232-PREPARE-ITEM-CURSOR'                     45310099
                                     TO DP013-PARAGRAPH                 45320099
                    MOVE 'PREPARE TRANSFER ITEM CURSOR'                 45330099
                                     TO DP013-MESSAGE-TEXT (1)          45340099
                    MOVE SQLCA       TO DP013-SQLCA                     45350099
                    MOVE 'TTFMSTR'   TO DP013-DB2-TABLE-NAME (1)        45360099
                    MOVE 'TTFSTAT'   TO DP013-DB2-TABLE-NAME (2)        45370099
                    MOVE 'TTFITEM'   TO DP013-DB2-TABLE-NAME (3)        45380099
                    SET DP013-DB2-ABEND                                 45390099
                                     TO TRUE                            45400099
                    PERFORM DP013-0000-PROCESS-ABEND                    45410099
           END-EVALUATE.                                                45420099
                                                                        45430099
      /                                                                 45440099
      *----------------------------------------------------------------*45450099
      *    PREPARE THE TRANSFER RECEIVER CURSOR FOR DYNAMIC SQL CALL   *45460099
      *----------------------------------------------------------------*45470099
                                                                        45480099
       4233-PREPARE-RCVR-CURSOR.                                        45490099
                                                                        45500099
           EXEC SQL                                                     45510099
               PREPARE XFER-SELECT-RCVR FROM :PV-SQL-STMT               45520099
           END-EXEC.                                                    45530099
                                                                        45540099
                                                                        45550099
           EVALUATE TRUE                                                45560099
               WHEN SQLCODE = +0                                        45570099
                    CONTINUE                                            45580099
               WHEN OTHER                                               45590099
                    MOVE '4233-PREPARE-RCVR-CURSOR'                     45610099
                                     TO DP013-PARAGRAPH                 45620099
                    MOVE 'PREPARE TRANSFER RECEIVER CURSOR'             45630099
                                     TO DP013-MESSAGE-TEXT (1)          45640099
                    MOVE SQLCA       TO DP013-SQLCA                     45650099
                    MOVE 'TTFMSTR'   TO DP013-DB2-TABLE-NAME (1)        45660099
                    MOVE 'TTFSTAT'   TO DP013-DB2-TABLE-NAME (2)        45670099
                    MOVE 'TTFRCPT'   TO DP013-DB2-TABLE-NAME (3)        45680099
                    SET DP013-DB2-ABEND                                 45690099
                                     TO TRUE                            45700099
                    PERFORM DP013-0000-PROCESS-ABEND                    45710099
           END-EVALUATE.                                                45720099
                                                                        45730099
      /                                                                 45740099
      *----------------------------------------------------------------*45750099
      *    PREPARE THE TRANSFER ALL CURSOR FOR DYNAMIC SQL CALL        *45760099
      *----------------------------------------------------------------*45770099
                                                                        45780099
       4234-PREPARE-ALL-CURSOR.                                         45790099
                                                                        45800099
           EXEC SQL                                                     45810099
               PREPARE XFER-SELECT-ALL FROM :PV-SQL-STMT                45820099
           END-EXEC.                                                    45830099
                                                                        45840099
                                                                        45850099
           EVALUATE TRUE                                                45860099
               WHEN SQLCODE = +0                                        45870099
                    CONTINUE                                            45880099
               WHEN OTHER                                               45890099
                    MOVE '4234-PREPARE-ALL-CURSOR'                      45910099
                                     TO DP013-PARAGRAPH                 45920099
                    MOVE 'PREPARE TRANSFER ALL CURSOR'                  45930099
                                     TO DP013-MESSAGE-TEXT (1)          45940099
                    MOVE SQLCA       TO DP013-SQLCA                     45950099
                    MOVE 'TTFMSTR'   TO DP013-DB2-TABLE-NAME (1)        45960099
                    MOVE 'TTFSTAT'   TO DP013-DB2-TABLE-NAME (2)        45970099
                    MOVE 'TTFITEM'   TO DP013-DB2-TABLE-NAME (3)        45980099
                    MOVE 'TTFRCPT'   TO DP013-DB2-TABLE-NAME (4)        45990099
                    SET DP013-DB2-ABEND                                 46000099
                                     TO TRUE                            46010099
                    PERFORM DP013-0000-PROCESS-ABEND                    46020099
           END-EVALUATE.                                                46030099
                                                                        46040099
       EJECT                                                            46050099
      *----------------------------------------------------------------*46060099
      * OPEN THE APPROPRIATE TRANSFER CURSOR.                          *46070099
      *----------------------------------------------------------------*46080099
                                                                        46090099
       4240-OPEN-CURSOR.                                                46100099
                                                                        46110099
           IF PS-XFER-LIST-CSR                                          46120099
               PERFORM 4241-OPEN-LIST-CURSOR                            46130099
           ELSE                                                         46140099
               IF PS-XFER-ITEM-CSR                                      46150099
                   PERFORM 4242-OPEN-ITEM-CURSOR                        46160099
               ELSE                                                     46170099
                   IF PS-XFER-RCVR-CSR                                  46180099
                       PERFORM 4243-OPEN-RCVR-CURSOR                    46190099
                   ELSE                                                 46200099
                       PERFORM 4244-OPEN-ALL-CURSOR                     46210099
                   END-IF                                               46220099
               END-IF                                                   46230099
           END-IF.                                                      46240099
                                                                        46250099
       EJECT                                                            46260099
      *----------------------------------------------------------------*46270099
      * OPEN THE TRANSFER LIST CURSOR.                                 *46280099
      *----------------------------------------------------------------*46290099
                                                                        46300099
       4241-OPEN-LIST-CURSOR.                                           46310099
                                                                        46320099
           PERFORM                                                      46330099
               WITH TEST AFTER                                          46340099
               VARYING PV-RETRY-COUNTER                                 46350099
               FROM 1 BY 1                                              46360099
               UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               46370099
                         OR (SQLCODE = ZERO))                           46380099
               EXEC SQL                                                 46390099
                    OPEN XFER-LIST-CSR                                  46400099
               END-EXEC                                                 46410099
                                                                        46420099
                                                                        46430099
               EVALUATE TRUE                                            46440099
                   WHEN SQLCODE = ZERO                                  46450099
                   WHEN SQLCODE = -904                                  46460099
                   WHEN SQLCODE = -913                                  46470099
                       CONTINUE                                         46480099
                   WHEN OTHER                                           46490099
                       MOVE '4241-OPEN-LIST-CURSOR'                     46520099
                                         TO DP013-PARAGRAPH             46530099
                       MOVE 'ERROR OPENING THE TRANSFER LIST CURSOR '   46540099
                                         TO DP013-MESSAGE-TEXT (1)      46550099
                       MOVE SQLCA        TO DP013-SQLCA                 46560099
                       MOVE 'TTFMSTR'    TO DP013-DB2-TABLE-NAME (1)    46570099
                       MOVE 'TTFSTAT'    TO DP013-DB2-TABLE-NAME (2)    46580099
                       SET DP013-DB2-ABEND                              46590099
                           DP013-XCTL-DISPLAY-RESTART TO TRUE           46600099
                       PERFORM DP013-0000-PROCESS-ABEND                 46610099
               END-EVALUATE                                             46620099
           END-PERFORM.                                                 46630099
                                                                        46640099
           IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        46650099
               MOVE '4241-OPEN-LIST-CURSOR'                             46660099
                                         TO DP013-PARAGRAPH             46670099
               MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO '           46680099
                                         TO DP013-MESSAGE-TEXT (1)      46690099
               MOVE 'OPEN THE TRANSFER LIST CURSOR '                    46700099
                                         TO DP013-MESSAGE-TEXT (2)      46710099
               MOVE SQLCA                TO DP013-SQLCA                 46720099
               MOVE 'TTFMSTR'            TO DP013-DB2-TABLE-NAME (1)    46730099
               MOVE 'TTFSTAT'            TO DP013-DB2-TABLE-NAME (2)    46740099
               SET DP013-DB2-ABEND                                      46750099
                   DP013-XCTL-DISPLAY-RESTART                           46760099
                                         TO TRUE                        46770099
               PERFORM DP013-0000-PROCESS-ABEND                         46780099
           END-IF.                                                      46790099
                                                                        46800099
       EJECT                                                            46810099
      *----------------------------------------------------------------*46820099
      * OPEN THE TRANSFER ITEM CURSOR.                                 *46830099
      *----------------------------------------------------------------*46840099
                                                                        46850099
       4242-OPEN-ITEM-CURSOR.                                           46860099
                                                                        46870099
           PERFORM                                                      46880099
               WITH TEST AFTER                                          46890099
               VARYING PV-RETRY-COUNTER                                 46900099
               FROM 1 BY 1                                              46910099
               UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               46920099
                         OR (SQLCODE = ZERO))                           46930099
               EXEC SQL                                                 46940099
                    OPEN XFER-ITEM-CSR                                  46950099
               END-EXEC                                                 46960099
                                                                        46970099
                                                                        46980099
               EVALUATE TRUE                                            46990099
                   WHEN SQLCODE = ZERO                                  47000099
                   WHEN SQLCODE = -904                                  47010099
                   WHEN SQLCODE = -913                                  47020099
                       CONTINUE                                         47030099
                   WHEN OTHER                                           47040099
                       MOVE '4242-OPEN-ITEM-CURSOR'                     47070099
                                         TO DP013-PARAGRAPH             47080099
                       MOVE 'ERROR OPENING THE TRANSFER ITEM CURSOR '   47090099
                                         TO DP013-MESSAGE-TEXT (1)      47100099
                       MOVE SQLCA        TO DP013-SQLCA                 47110099
                       MOVE 'TTFMSTR'    TO DP013-DB2-TABLE-NAME (1)    47120099
                       MOVE 'TTFSTAT'    TO DP013-DB2-TABLE-NAME (2)    47130099
                       MOVE 'TTFITEM'    TO DP013-DB2-TABLE-NAME (3)    47140099
                       SET DP013-DB2-ABEND                              47150099
                           DP013-XCTL-DISPLAY-RESTART TO TRUE           47160099
                       PERFORM DP013-0000-PROCESS-ABEND                 47170099
               END-EVALUATE                                             47180099
           END-PERFORM.                                                 47190099
                                                                        47200099
           IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        47210099
               MOVE '4242-OPEN-ITEM-CURSOR'                             47220099
                                         TO DP013-PARAGRAPH             47230099
               MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO '           47240099
                                         TO DP013-MESSAGE-TEXT (1)      47250099
               MOVE 'OPEN THE TRANSFER ITEM CURSOR '                    47260099
                                         TO DP013-MESSAGE-TEXT (2)      47270099
               MOVE SQLCA                TO DP013-SQLCA                 47280099
               MOVE 'TTFMSTR'            TO DP013-DB2-TABLE-NAME (1)    47290099
               MOVE 'TTFSTAT'            TO DP013-DB2-TABLE-NAME (2)    47300099
               MOVE 'TTFITEM'            TO DP013-DB2-TABLE-NAME (3)    47310099
               SET DP013-DB2-ABEND                                      47320099
                   DP013-XCTL-DISPLAY-RESTART                           47330099
                                         TO TRUE                        47340099
               PERFORM DP013-0000-PROCESS-ABEND                         47350099
           END-IF.                                                      47360099
                                                                        47370099
       EJECT                                                            47380099
      *----------------------------------------------------------------*47390099
      * OPEN THE TRANSFER RECEIVER CURSOR.                             *47400099
      *----------------------------------------------------------------*47410099
                                                                        47420099
       4243-OPEN-RCVR-CURSOR.                                           47430099
                                                                        47440099
           PERFORM                                                      47450099
               WITH TEST AFTER                                          47460099
               VARYING PV-RETRY-COUNTER                                 47470099
               FROM 1 BY 1                                              47480099
               UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               47490099
                         OR (SQLCODE = ZERO))                           47500099
               EXEC SQL                                                 47510099
                    OPEN XFER-RCVR-CSR                                  47520099
               END-EXEC                                                 47530099
                                                                        47540099
                                                                        47550099
               EVALUATE TRUE                                            47560099
                   WHEN SQLCODE = ZERO                                  47570099
                   WHEN SQLCODE = -904                                  47580099
                   WHEN SQLCODE = -913                                  47590099
                       CONTINUE                                         47600099
                   WHEN OTHER                                           47610099
                       MOVE '4243-OPEN-RCVR-CURSOR'                     47640099
                                         TO DP013-PARAGRAPH             47650099
                       MOVE 'ERROR OPENING THE TRANSFER RECEIVER CURSOR'47660099
                                         TO DP013-MESSAGE-TEXT (1)      47670099
                       MOVE SQLCA        TO DP013-SQLCA                 47680099
                       MOVE 'TTFMSTR'    TO DP013-DB2-TABLE-NAME (1)    47690099
                       MOVE 'TTFSTAT'    TO DP013-DB2-TABLE-NAME (2)    47700099
                       MOVE 'TTFRCVR'    TO DP013-DB2-TABLE-NAME (3)    47710099
                       SET DP013-DB2-ABEND                              47720099
                           DP013-XCTL-DISPLAY-RESTART TO TRUE           47730099
                       PERFORM DP013-0000-PROCESS-ABEND                 47740099
               END-EVALUATE                                             47750099
           END-PERFORM.                                                 47760099
                                                                        47770099
           IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        47780099
               MOVE '4243-OPEN-RCVR-CURSOR'                             47790099
                                         TO DP013-PARAGRAPH             47800099
               MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO '           47810099
                                         TO DP013-MESSAGE-TEXT (1)      47820099
               MOVE 'OPEN THE TRANSFER RECEIVER CURSOR '                47830099
                                         TO DP013-MESSAGE-TEXT (2)      47840099
               MOVE SQLCA                TO DP013-SQLCA                 47850099
               MOVE 'TTFMSTR'            TO DP013-DB2-TABLE-NAME (1)    47860099
               MOVE 'TTFSTAT'            TO DP013-DB2-TABLE-NAME (2)    47870099
               MOVE 'TTFRCPT'            TO DP013-DB2-TABLE-NAME (3)    47880099
               SET DP013-DB2-ABEND                                      47890099
                   DP013-XCTL-DISPLAY-RESTART                           47900099
                                         TO TRUE                        47910099
               PERFORM DP013-0000-PROCESS-ABEND                         47920099
           END-IF.                                                      47930099
                                                                        47940099
       EJECT                                                            47950099
      *----------------------------------------------------------------*47960099
      * OPEN THE TRANSFER ALL CURSOR.                                  *47970099
      *----------------------------------------------------------------*47980099
                                                                        47990099
       4244-OPEN-ALL-CURSOR.                                            48000099
                                                                        48010099
           PERFORM                                                      48020099
               WITH TEST AFTER                                          48030099
               VARYING PV-RETRY-COUNTER                                 48040099
               FROM 1 BY 1                                              48050099
               UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               48060099
                         OR (SQLCODE = ZERO))                           48070099
               EXEC SQL                                                 48080099
                    OPEN XFER-ALL-CSR                                   48090099
               END-EXEC                                                 48100099
                                                                        48110099
                                                                        48120099
               EVALUATE TRUE                                            48130099
                   WHEN SQLCODE = ZERO                                  48140099
                   WHEN SQLCODE = -904                                  48150099
                   WHEN SQLCODE = -913                                  48160099
                       CONTINUE                                         48170099
                   WHEN OTHER                                           48180099
                       MOVE '4244-OPEN-ALL-CURSOR'                      48210099
                                         TO DP013-PARAGRAPH             48220099
                       MOVE 'ERROR OPENING THE TRANSFER ALL CURSOR '    48230099
                                         TO DP013-MESSAGE-TEXT (1)      48240099
                       MOVE SQLCA        TO DP013-SQLCA                 48250099
                       MOVE 'TTFMSTR'    TO DP013-DB2-TABLE-NAME (1)    48260099
                       MOVE 'TTFSTAT'    TO DP013-DB2-TABLE-NAME (2)    48270099
                       MOVE 'TTFITEM'    TO DP013-DB2-TABLE-NAME (3)    48280099
                       MOVE 'TTFRCPT'    TO DP013-DB2-TABLE-NAME (4)    48290099
                       SET DP013-DB2-ABEND                              48300099
                           DP013-XCTL-DISPLAY-RESTART TO TRUE           48310099
                       PERFORM DP013-0000-PROCESS-ABEND                 48320099
               END-EVALUATE                                             48330099
           END-PERFORM.                                                 48340099
                                                                        48350099
           IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        48360099
               MOVE '4244-OPEN-ALL-CURSOR'                              48370099
                                         TO DP013-PARAGRAPH             48380099
               MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO '           48390099
                                         TO DP013-MESSAGE-TEXT (1)      48400099
               MOVE 'OPEN THE TRANSFER ALL CURSOR '                     48410099
                                         TO DP013-MESSAGE-TEXT (2)      48420099
               MOVE SQLCA                TO DP013-SQLCA                 48430099
               MOVE 'TTFMSTR'            TO DP013-DB2-TABLE-NAME (1)    48440099
               MOVE 'TTFSTAT'            TO DP013-DB2-TABLE-NAME (2)    48450099
               MOVE 'TTFITEM'            TO DP013-DB2-TABLE-NAME (3)    48460099
               MOVE 'TTFRCPT'            TO DP013-DB2-TABLE-NAME (4)    48470099
               SET DP013-DB2-ABEND                                      48480099
                   DP013-XCTL-DISPLAY-RESTART                           48490099
                                         TO TRUE                        48500099
               PERFORM DP013-0000-PROCESS-ABEND                         48510099
           END-IF.                                                      48520099
                                                                        48530099
       EJECT                                                            48540099
      *----------------------------------------------------------------*48550099
      * CLOSE THE APPROPRIATE TRANSFER CURSOR.                         *48560099
      *----------------------------------------------------------------*48570099
                                                                        48580099
       4250-CLOSE-CURSOR.                                               48590099
                                                                        48600099
           IF PS-XFER-LIST-CSR                                          48610099
               PERFORM 4251-CLOSE-LIST-CURSOR                           48620099
           ELSE                                                         48630099
               IF PS-XFER-ITEM-CSR                                      48640099
                   PERFORM 4252-CLOSE-ITEM-CURSOR                       48650099
               ELSE                                                     48660099
                   IF PS-XFER-RCVR-CSR                                  48670099
                       PERFORM 4253-CLOSE-RCVR-CURSOR                   48680099
                   ELSE                                                 48690099
                       PERFORM 4254-CLOSE-ALL-CURSOR                    48700099
                   END-IF                                               48710099
               END-IF                                                   48720099
           END-IF.                                                      48730099
                                                                        48740099
       EJECT                                                            48750099
      *----------------------------------------------------------------*48760099
      * CLOSE THE TRANSFER LIST CURSOR.                                *48770099
      *----------------------------------------------------------------*48780099
                                                                        48790099
       4251-CLOSE-LIST-CURSOR.                                          48800099
                                                                        48810099
           EXEC SQL                                                     48820099
               CLOSE XFER-LIST-CSR                                      48830099
           END-EXEC.                                                    48840099
                                                                        48850099
           EVALUATE TRUE                                                48860099
               WHEN SQLCODE = ZERO                                      48870099
                   CONTINUE                                             48880099
               WHEN OTHER                                               48890099
                   MOVE '4251-CLOSE-LIST-CURSOR'                        48920099
                                     TO DP013-PARAGRAPH                 48930099
                   MOVE 'ERROR CLOSING THE TRANSFER LIST CURSOR '       48940099
                                     TO DP013-MESSAGE-TEXT (1)          48950099
                   MOVE SQLCA        TO DP013-SQLCA                     48960099
                   MOVE 'TTFMSTR'    TO DP013-DB2-TABLE-NAME (1)        48970099
                   MOVE 'TTFSTAT'    TO DP013-DB2-TABLE-NAME (2)        48980099
                   SET DP013-DB2-ABEND                                  48990099
                       DP013-XCTL-DISPLAY-RESTART TO TRUE               49000099
                   PERFORM DP013-0000-PROCESS-ABEND                     49010099
           END-EVALUATE.                                                49020099
                                                                        49030099
       EJECT                                                            49040099
      *----------------------------------------------------------------*49050099
      * CLOSE THE TRANSFER ITEM CURSOR.                                *49060099
      *----------------------------------------------------------------*49070099
                                                                        49080099
       4252-CLOSE-ITEM-CURSOR.                                          49090099
                                                                        49100099
           EXEC SQL                                                     49110099
               CLOSE XFER-ITEM-CSR                                      49120099
           END-EXEC.                                                    49130099
                                                                        49140099
           EVALUATE TRUE                                                49150099
               WHEN SQLCODE = ZERO                                      49160099
                   CONTINUE                                             49170099
               WHEN OTHER                                               49180099
                   MOVE '4252-CLOSE-ITEM-CURSOR'                        49210099
                                     TO DP013-PARAGRAPH                 49220099
                   MOVE 'ERROR CLOSING THE TRANSFER ITEM CURSOR '       49230099
                                     TO DP013-MESSAGE-TEXT (1)          49240099
                   MOVE SQLCA        TO DP013-SQLCA                     49250099
                   MOVE 'TTFMSTR'    TO DP013-DB2-TABLE-NAME (1)        49260099
                   MOVE 'TTFSTAT'    TO DP013-DB2-TABLE-NAME (2)        49270099
                   MOVE 'TTFITEM'    TO DP013-DB2-TABLE-NAME (3)        49280099
                   SET DP013-DB2-ABEND                                  49290099
                       DP013-XCTL-DISPLAY-RESTART TO TRUE               49300099
                   PERFORM DP013-0000-PROCESS-ABEND                     49310099
           END-EVALUATE.                                                49320099
                                                                        49330099
       EJECT                                                            49340099
      *----------------------------------------------------------------*49350099
      * CLOSE THE TRANSFER RECEIVER CURSOR.                            *49360099
      *----------------------------------------------------------------*49370099
                                                                        49380099
       4253-CLOSE-RCVR-CURSOR.                                          49390099
                                                                        49400099
           EXEC SQL                                                     49410099
               CLOSE XFER-RCVR-CSR                                      49420099
           END-EXEC.                                                    49430099
                                                                        49440099
           EVALUATE TRUE                                                49450099
               WHEN SQLCODE = ZERO                                      49460099
                   CONTINUE                                             49470099
               WHEN OTHER                                               49480099
                   MOVE '4253-CLOSE-RCVR-CURSOR'                        49510099
                                     TO DP013-PARAGRAPH                 49520099
                   MOVE 'ERROR CLOSING THE TRANSFER RECEIVER CURSOR '   49530099
                                     TO DP013-MESSAGE-TEXT (1)          49540099
                   MOVE SQLCA        TO DP013-SQLCA                     49550099
                   MOVE 'TTFMSTR'    TO DP013-DB2-TABLE-NAME (1)        49560099
                   MOVE 'TTFSTAT'    TO DP013-DB2-TABLE-NAME (2)        49570099
                   MOVE 'TTFRCVR'    TO DP013-DB2-TABLE-NAME (3)        49580099
                   SET DP013-DB2-ABEND                                  49590099
                       DP013-XCTL-DISPLAY-RESTART TO TRUE               49600099
                   PERFORM DP013-0000-PROCESS-ABEND                     49610099
           END-EVALUATE.                                                49620099
                                                                        49630099
       EJECT                                                            49640099
      *----------------------------------------------------------------*49650099
      * CLOSE THE TRANSFER ALL CURSOR.                                 *49660099
      *----------------------------------------------------------------*49670099
                                                                        49680099
       4254-CLOSE-ALL-CURSOR.                                           49690099
                                                                        49700099
           EXEC SQL                                                     49710099
               CLOSE XFER-ALL-CSR                                       49720099
           END-EXEC.                                                    49730099
                                                                        49740099
           EVALUATE TRUE                                                49750099
               WHEN SQLCODE = ZERO                                      49760099
                   CONTINUE                                             49770099
               WHEN OTHER                                               49780099
                   MOVE '4254-CLOSE-ALL-CURSOR'                         49810099
                                     TO DP013-PARAGRAPH                 49820099
                   MOVE 'ERROR CLOSING THE TRANSFER ALL CURSOR '        49830099
                                     TO DP013-MESSAGE-TEXT (1)          49840099
                   MOVE SQLCA        TO DP013-SQLCA                     49850099
                   MOVE 'TTFMSTR'    TO DP013-DB2-TABLE-NAME (1)        49860099
                   MOVE 'TTFSTAT'    TO DP013-DB2-TABLE-NAME (2)        49870099
                   MOVE 'TTFITEM'    TO DP013-DB2-TABLE-NAME (3)        49880099
                   MOVE 'TTFRCVR'    TO DP013-DB2-TABLE-NAME (4)        49890099
                   SET DP013-DB2-ABEND                                  49900099
                       DP013-XCTL-DISPLAY-RESTART TO TRUE               49910099
                   PERFORM DP013-0000-PROCESS-ABEND                     49920099
           END-EVALUATE.                                                49930099
                                                                        49940099
       EJECT                                                            49950099
      *----------------------------------------------------------------*49960099
      *    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE    *49970099
      *    BLOCKS IN THE ARRAY.  WHENEVER BOTH BLOCKS BECOME FULL,     *49980099
      *    WRITE OUT THE 1ST BLOCK TO TEMPORARY STORAGE, MOVE THE 2ND  *49990099
      *    BLOCK IN THE ARRAY TO THE 1ST BLOCK, AND INITIALIZE THE     *50000099
      *    2ND BLOCK MAKING IT AVAILABLE TO BE USED.                   *50010099
      *                                                                *50020099
      *    DUE TO THE SIZE OF THE TABLE, AND THE ORDER IN WHICH THE    *50030099
      *    ROWS ARE SORTED, THE ENTIRE TABLE IS READ INTO THE PROGRAM  *50040099
      *    UPON INITIALIZATION.                                        *50050099
      *----------------------------------------------------------------*50060099
                                                                        50070099
       4300-READ-ITEMS-FROM-DB.                                         50080099
                                                                        50090099
           SET ASC-ITEMS-LEFT-ON-DB      TO TRUE.                       50100099
           SET PS-FIRST-FETCH            TO TRUE.                       50110099
           PERFORM                                                      50120099
               VARYING PV-READ-COUNT                                    50130099
               FROM 1 BY 1                                              50140099
               UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                    50150099
                  OR (ASC-NO-ITEMS-LEFT-ON-DB)                          50160099
                  OR (PS-ERROR-DB2))                                    50170099
                                                                        50180099
               PERFORM 4310-FETCH-CURSOR                                50190099
                                                                        50200099
               IF  ASC-ITEMS-LEFT-ON-DB AND                             50210099
                   PS-NO-ERROR-DB2                                      50220099
                   IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                50230099
                       ADD +1            TO ASC-ITEM-SUB                50240099
                   ELSE                                                 50250099
                       ADD +1            TO ASC-BLK-SUB                 50260099
                       MOVE +1           TO ASC-ITEM-SUB                50270099
                                                                        50280099
                       IF  ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY         50290099
                           MOVE +1       TO ASC-BLK-SUB                 50300099
                           SET ASC-BLOCK-MODIFIED (1)                   50310099
                                         TO TRUE                        50320099
                           PERFORM 5100-WRITE-TEMP-STORAGE              50330099
                           MOVE ASC-BLOCK-ENTRIES                       50340099
                                     (PC-MAX-BLOCKS-IN-ARRAY)           50350099
                                      TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB) 50360099
                           ADD +1        TO ASC-BLK-SUB                 50370099
                           INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)   50380099
                           SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)      50390099
                                         TO TRUE                        50400099
                       END-IF                                           50410099
                   END-IF                                               50420099
                   ADD +1                TO ASC-NUMBER-OF-ITEMS-READ    50430099
                   MOVE ASC-NUMBER-OF-ITEMS-READ                        50440099
                                         TO ASC-LIST-ITEM-NUMBER        50450099
                                            (ASC-BLK-SUB ASC-ITEM-SUB)  50460099
                   MOVE TFMSTR-FR-STR-NBR                               50470099
                                         TO PV-DISPL-XFER-1-4           50480099
                   IF PV-XFER-SEQ-NBR-NULL < ZERO                       50490099
                       MOVE ZERO         TO PV-DISPL-XFER-5-10          50500099
                   ELSE                                                 50510099
                       MOVE TFMSTR-XFER-SEQ-NBR                         50520099
                                         TO PV-DISPL-XFER-5-10          50530099
                   END-IF                                               50540099
                   MOVE PV-DISPL-XFER-NBR TO ASC-TRANSFER-NBR           50550099
                                            (ASC-BLK-SUB ASC-ITEM-SUB)  50560099
                   EVALUATE TFSTAT-XFER-STAT-CDE                        50570099
                      WHEN PC-POS-RECEIVED-STATUS                       50580099
                       MOVE 'REC'        TO ASC-STATUS                  50590099
                                            (ASC-BLK-SUB ASC-ITEM-SUB)  50600099
                       IF PS-RECEIPT-NOT-SELECTED                       50610099
                           PERFORM 4320-SELECT-RECEIPT-DATE             50620099
                       END-IF                                           50630099
                       MOVE TFRCPT-RCV-XFER-BEG-TMST(1:4)               50640099
                                         TO  PV-DATE-MMDDYR(7:4)        50650099
                       MOVE TFRCPT-RCV-XFER-BEG-TMST(6:2)               50660099
                                         TO  PV-DATE-MMDDYR(1:2)        50670099
                       MOVE TFRCPT-RCV-XFER-BEG-TMST(9:2)               50680099
                                         TO  PV-DATE-MMDDYR(4:2)        50690099
                       MOVE PV-DATE-MMDDYR TO ASC-DATE                  50700099
                                             (ASC-BLK-SUB ASC-ITEM-SUB) 50710099
                       PERFORM 4350-SELECT-RCVD-QTY                     50720099
                      WHEN PC-VOID-STATUS                               50730099
                       MOVE 'VD '        TO ASC-STATUS                  50740099
                                            (ASC-BLK-SUB ASC-ITEM-SUB)  50750099
                       PERFORM 4360-SELECT-VOID-DATE                    50760099
                       MOVE TFSTAT-XFER-STAT-TMST(1:4)                  50770099
                                         TO  PV-DATE-MMDDYR(7:4)        50780099
                       MOVE TFSTAT-XFER-STAT-TMST(6:2)                  50790099
                                         TO  PV-DATE-MMDDYR(1:2)        50800099
                       MOVE TFSTAT-XFER-STAT-TMST(9:2)                  50810099
                                         TO  PV-DATE-MMDDYR(4:2)        50820099
                       MOVE PV-DATE-MMDDYR TO ASC-DATE                  50830099
                                             (ASC-BLK-SUB ASC-ITEM-SUB) 50840099
                       MOVE ZEROES       TO ML1-RECEIVE-RETAIL          50850099
                      WHEN OTHER                                        50860099
                       MOVE 'CMP'        TO ASC-STATUS                  50870099
                                            (ASC-BLK-SUB ASC-ITEM-SUB)  50880099
                       MOVE TFMSTR-CMPT-XFER-END-TMST(1:4)              50890099
                                         TO  PV-DATE-MMDDYR(7:4)        50900099
                       MOVE TFMSTR-CMPT-XFER-END-TMST(6:2)              50910099
                                         TO  PV-DATE-MMDDYR(1:2)        50920099
                       MOVE TFMSTR-CMPT-XFER-END-TMST(9:2)              50930099
                                         TO  PV-DATE-MMDDYR(4:2)        50940099
                       MOVE PV-DATE-MMDDYR TO ASC-DATE                  50950099
                                             (ASC-BLK-SUB ASC-ITEM-SUB) 50960099
                       MOVE ZEROES       TO ASC-REC-QTY                 50970099
                                             (ASC-BLK-SUB ASC-ITEM-SUB) 50980099
                       MOVE ZEROES       TO ML1-RECEIVE-RETAIL          50990099
                   END-EVALUATE                                         51000099
                   PERFORM 4330-SELECT-XFER-QTY                         51010099
                   PERFORM 4301-FILL-MISC-INFO                          51020099
                   MOVE TFMSTR-XFER-DKEY-ID                             51030099
                                         TO ASC-XFER-DKEY-ID            51040099
                                            (ASC-BLK-SUB ASC-ITEM-SUB)  51050099
                                            DK-XFER-DKEY-ID             51060099
                   IF TFSTAT-XFER-STAT-CDE = PC-POS-RECEIVED-STATUS     51060199
                       PERFORM 8000-CHECK-XFER-DISCREPANCY              51060203
                   END-IF                                               51060399
               END-IF                                                   51060499
           END-PERFORM.                                                 51060599
                                                                        51060699
           IF  ASC-NUMBER-OF-ITEMS-READ > ZERO  AND                     51060799
               PS-NO-ERROR-DB2                                          51060899
               MOVE +1               TO ASC-BLK-SUB                     51060999
               PERFORM 5100-WRITE-TEMP-STORAGE                          51061099
               ADD +1                TO ASC-BLK-SUB                     51062099
               PERFORM 5100-WRITE-TEMP-STORAGE                          51063099
                                                                        51064099
               MOVE 1                TO ASC-BLK-SUB                     51065099
                                        PV-BLOCK-NUMBER                 51066099
               PERFORM 4410-READ-TEMP-STORAGE                           51067099
               IF  ASC-HIGHEST-BLOCK-WRITTEN GREATER THAN 1             51068099
                   MOVE 2            TO ASC-BLK-SUB                     51069099
                                        PV-BLOCK-NUMBER                 51070099
                   PERFORM 4410-READ-TEMP-STORAGE                       51080099
               END-IF                                                   51090099
           END-IF.                                                      51100099
                                                                        51110099
       EJECT                                                            51120099
      *----------------------------------------------------------------*51130099
      * FILL THE MISCELLANEOUS INFO FOR THE ITEM LINE.                 *51140099
      *----------------------------------------------------------------*51150099
                                                                        51160099
       4301-FILL-MISC-INFO.                                             51170099
                                                                        51180099
           IF ASC-ALL-TYPES                                             51190099
               MOVE TFMSTR-XFER-TYP-CDE(2:1)                            51200099
                                         TO PV-STATUS-TBL-SUB           51210099
111703************************************************************              
111703** DEFECTIVE DAMAGED SORT1 XFER TYPE OF 0 CANNOT BE USED AS               
111703** A SUBSCRIPT.  DEFAULT IT TO MAX TYPE CODE OF 8                         
111703************************************************************              
111703         IF PV-STATUS-TBL-SUB = 0                                         
111703             MOVE 8 TO PV-STATUS-TBL-SUB                                  
111703         END-IF                                                           
               MOVE PV-XFER-TYPE-LINE-DESC (PV-STATUS-TBL-SUB)          51220099
                                         TO ML1-REMAINDER               51230099
               MOVE ML1-MISC-LINE        TO ASC-MISC-INFO               51240099
                                            (ASC-BLK-SUB ASC-ITEM-SUB)  51250099
           END-IF.                                                      51260099
                                                                        51270099
111703*    IF ASC-DEFECTS-DAMAGES-TYPE                                  51280099
111703     IF ASC-DEFECTIVE-DAMAGE-SORT1                                        
111703         MOVE ML1-MISC-LINE        TO ASC-MISC-INFO               51290099
111703                                      (ASC-BLK-SUB ASC-ITEM-SUB)  51300099
111703     END-IF.                                                      51310099
                                                                                
111703     IF ASC-DEFECTIVE-DAMAGE-SORT2                                        
111703         MOVE ML1-MISC-LINE        TO ASC-MISC-INFO               51290099
111703                                      (ASC-BLK-SUB ASC-ITEM-SUB)  51300099
111703     END-IF.                                                      51310099
                                                                        51320099
           IF ASC-CALLBACK-TYPE                                         51330099
               MOVE TFMSTR-TO-STR-NBR    TO ML1-TO-STORE                51340099
               MOVE TFMSTR-CLBK-NBR      TO MRCI-CALLBACK-NBR           51350099
               MOVE MISC-REM-CALLBACK-INFO                              51360099
                                         TO ML1-TO-STR-EXTRA            51370099
               MOVE ML1-MISC-LINE        TO ASC-MISC-INFO               51380099
                                            (ASC-BLK-SUB ASC-ITEM-SUB)  51390099
           END-IF.                                                      51400099
                                                                        51410099
           IF ASC-STOCK-BAL-CORP-TYPE                                   51420099
               MOVE TFMSTR-TO-STR-NBR    TO ML1-TO-STORE                51430099
               MOVE TFMSTR-STK-BAL-APVL-NBR                             51440099
                                         TO MRCI-APPROVAL-NBR           51450099
               MOVE MISC-REM-APPROVAL-INFO                              51460099
                                         TO ML1-TO-STR-EXTRA            51470099
               MOVE ML1-MISC-LINE        TO ASC-MISC-INFO               51480099
                                            (ASC-BLK-SUB ASC-ITEM-SUB)  51490099
           END-IF.                                                      51500099
                                                                        51510099
           IF ASC-STOCK-BAL-STORE-TYPE                                  51520099
               MOVE TFMSTR-TO-STR-NBR    TO ML1-TO-STORE                51530099
               MOVE ML1-MISC-LINE        TO ASC-MISC-INFO               51540099
                                            (ASC-BLK-SUB ASC-ITEM-SUB)  51550099
           END-IF.                                                      51560099
                                                                        51570099
           IF ASC-CUSTOMER-TYPE OR ASC-OFFSITE-STORAGE-TYPE             51580099
               PERFORM 4340-SELECT-CUST-INFO                            51590099
               MOVE TFCUST-CUST-NM       TO CUST-ML-NAME                51600099
               MOVE TFCUST-PHN-NBR(1:3)  TO CUST-ML-PHONE-1-3           51610099
               MOVE TFCUST-PHN-NBR(4:3)  TO CUST-ML-PHONE-4-6           51620099
               MOVE TFCUST-PHN-NBR(7:4)  TO CUST-ML-PHONE-7-10          51630099
               MOVE CUST-MISC-LINE       TO ASC-MISC-INFO               51640099
                                            (ASC-BLK-SUB ASC-ITEM-SUB)  51650099
           END-IF.                                                      51660099
                                                                        51670099
           IF ASC-NON-RETAIL-TYPE                                       51680099
               MOVE TFMSTR-ATTN-INIT-1ST-NM                             51690099
                                         TO NONR-ML-ATTN-INIT-NM        51700099
               MOVE TFMSTR-ATTN-LAST-NM  TO NONR-ML-ATTN-LAST-NM        51710099
               MOVE NON-RETL-MISC-LINE   TO ASC-MISC-INFO               51720099
                                            (ASC-BLK-SUB ASC-ITEM-SUB)  51730099
           END-IF.                                                      51740099
                                                                        51750099
       EJECT                                                            51760099
      *----------------------------------------------------------------*51770099
      * FETCH THE APPROPRIATE TRANSFER CURSOR.                         *51780099
      *----------------------------------------------------------------*51790099
                                                                        51800099
       4310-FETCH-CURSOR.                                               51810099
                                                                        51820099
           IF PS-XFER-LIST-CSR                                          51830099
               PERFORM 4311-FETCH-LIST-CURSOR                           51840099
           ELSE                                                         51850099
               IF PS-XFER-ITEM-CSR                                      51860099
                   PERFORM 4312-FETCH-ITEM-CURSOR                       51870099
               ELSE                                                     51880099
                   IF PS-XFER-RCVR-CSR                                  51890099
                       PERFORM 4313-FETCH-RCVR-CURSOR                   51900099
                   ELSE                                                 51910099
                       PERFORM 4314-FETCH-ALL-CURSOR                    51920099
                   END-IF                                               51930099
               END-IF                                                   51940099
           END-IF.                                                      51950099
                                                                        51960099
       EJECT                                                            51970099
      *----------------------------------------------------------------*51980099
      * FETCH THE TRANSFER LIST CURSOR.                                *51990099
      *----------------------------------------------------------------*52000099
                                                                        52010099
       4311-FETCH-LIST-CURSOR.                                          52020099
                                                                        52030099
           EXEC SQL                                                     52040099
                FETCH XFER-LIST-CSR                                     52050099
                INTO  :TFMSTR-XFER-DKEY-ID                              52060099
                    , :TFMSTR-XFER-TYP-CDE                              52070099
                    , :TFMSTR-FR-STR-NBR                                52080099
                    , :TFMSTR-XFER-SEQ-NBR :PV-XFER-SEQ-NBR-NULL        52090099
                    , :TFMSTR-TO-STR-NBR                                52100099
                    , :TFMSTR-CLBK-NBR                                  52110099
                    , :TFMSTR-STK-BAL-APVL-NBR                          52120099
                    , :TFMSTR-ATTN-INIT-1ST-NM                          52130099
                    , :TFMSTR-ATTN-LAST-NM                              52140099
                    , :TFMSTR-CMPT-XFER-BEG-TMST                        52150099
                    , :TFMSTR-CMPT-XFER-END-TMST                        52160099
                    , :TFSTAT-XFER-STAT-CDE                             52170099
           END-EXEC.                                                    52180099
                                                                        52190099
           EVALUATE TRUE                                                52200099
               WHEN SQLCODE = ZERO                                      52210099
               WHEN SQLCODE = +100                                      52220099
                    CONTINUE                                            52230099
               WHEN OTHER                                               52240099
                    MOVE '4311-FETCH-LIST-CURSOR'                       52260099
                                     TO DP013-PARAGRAPH                 52270099
                    MOVE 'FETCH TRANSFER LIST CURSOR'                   52280099
                                     TO DP013-MESSAGE-TEXT (1)          52290099
                    MOVE SQLCA       TO DP013-SQLCA                     52300099
                    MOVE 'TTFMSTR'   TO DP013-DB2-TABLE-NAME (1)        52310099
                    MOVE 'TTFSTAT'   TO DP013-DB2-TABLE-NAME (2)        52320099
                    SET DP013-DB2-ABEND                                 52330099
                                     TO TRUE                            52340099
                    SET PS-ERROR-DB2  TO TRUE                           52350099
                    PERFORM DP013-0000-PROCESS-ABEND                    52360099
           END-EVALUATE.                                                52370099
                                                                        52380099
           IF  SQLCODE EQUAL +100                                       52390099
               SET ASC-NO-ITEMS-LEFT-ON-DB                              52400099
                                         TO TRUE                        52410099
           END-IF.                                                      52420099
                                                                        52430099
       EJECT                                                            52440099
      *----------------------------------------------------------------*52450099
      * FETCH THE TRANSFER ITEM CURSOR.                                *52460099
      *----------------------------------------------------------------*52470099
                                                                        52480099
       4312-FETCH-ITEM-CURSOR.                                          52490099
                                                                        52500099
           EXEC SQL                                                     52510099
                FETCH XFER-ITEM-CSR                                     52520099
                INTO  :TFMSTR-XFER-DKEY-ID                              52530099
                    , :TFMSTR-XFER-TYP-CDE                              52540099
                    , :TFMSTR-FR-STR-NBR                                52550099
                    , :TFMSTR-XFER-SEQ-NBR :PV-XFER-SEQ-NBR-NULL        52560099
                    , :TFMSTR-TO-STR-NBR                                52570099
                    , :TFMSTR-CLBK-NBR                                  52580099
                    , :TFMSTR-STK-BAL-APVL-NBR                          52590099
                    , :TFMSTR-ATTN-INIT-1ST-NM                          52600099
                    , :TFMSTR-ATTN-LAST-NM                              52610099
                    , :TFMSTR-CMPT-XFER-BEG-TMST                        52620099
                    , :TFMSTR-CMPT-XFER-END-TMST                        52630099
                    , :TFSTAT-XFER-STAT-CDE                             52640099
           END-EXEC.                                                    52650099
                                                                        52660099
           EVALUATE TRUE                                                52670099
               WHEN SQLCODE = ZERO                                      52680099
               WHEN SQLCODE = +100                                      52690099
                    CONTINUE                                            52700099
               WHEN OTHER                                               52710099
                    MOVE '4312-FETCH-ITEM-CURSOR'                       52730099
                                     TO DP013-PARAGRAPH                 52740099
                    MOVE 'FETCH TRANSFER ITEM CURSOR'                   52750099
                                     TO DP013-MESSAGE-TEXT (1)          52760099
                    MOVE SQLCA       TO DP013-SQLCA                     52770099
                    MOVE 'TTFMSTR'   TO DP013-DB2-TABLE-NAME (1)        52780099
                    MOVE 'TTFSTAT'   TO DP013-DB2-TABLE-NAME (2)        52790099
                    MOVE 'TTFITEM'   TO DP013-DB2-TABLE-NAME (3)        52800099
                    SET DP013-DB2-ABEND                                 52810099
                                     TO TRUE                            52820099
                    SET PS-ERROR-DB2  TO TRUE                           52830099
                    PERFORM DP013-0000-PROCESS-ABEND                    52840099
           END-EVALUATE.                                                52850099
                                                                        52860099
           IF  SQLCODE EQUAL +100                                       52870099
               SET ASC-NO-ITEMS-LEFT-ON-DB                              52880099
                                         TO TRUE                        52890099
           END-IF.                                                      52900099
                                                                        52910099
       EJECT                                                            52920099
      *----------------------------------------------------------------*52930099
      * FETCH THE TRANSFER RECEIVER CURSOR.                            *52940099
      *----------------------------------------------------------------*52950099
                                                                        52960099
       4313-FETCH-RCVR-CURSOR.                                          52970099
                                                                        52980099
           EXEC SQL                                                     52990099
                FETCH XFER-RCVR-CSR                                     53000099
                INTO  :TFMSTR-XFER-DKEY-ID                              53010099
                    , :TFMSTR-XFER-TYP-CDE                              53020099
                    , :TFMSTR-FR-STR-NBR                                53030099
                    , :TFMSTR-XFER-SEQ-NBR :PV-XFER-SEQ-NBR-NULL        53040099
                    , :TFMSTR-TO-STR-NBR                                53050099
                    , :TFMSTR-CLBK-NBR                                  53060099
                    , :TFMSTR-STK-BAL-APVL-NBR                          53070099
                    , :TFMSTR-ATTN-INIT-1ST-NM                          53080099
                    , :TFMSTR-ATTN-LAST-NM                              53090099
                    , :TFMSTR-CMPT-XFER-BEG-TMST                        53100099
                    , :TFMSTR-CMPT-XFER-END-TMST                        53110099
                    , :TFSTAT-XFER-STAT-CDE                             53120099
                    , :TFRCPT-RCV-XFER-BEG-TMST                         53130099
                    , :TFRCPT-RCV-XFER-END-TMST                         53140099
           END-EXEC.                                                    53150099
                                                                        53160099
           EVALUATE TRUE                                                53170099
               WHEN SQLCODE = ZERO                                      53180099
               WHEN SQLCODE = +100                                      53190099
                    CONTINUE                                            53200099
               WHEN OTHER                                               53210099
                    MOVE '4313-FETCH-RCVR-CURSOR'                       53230099
                                     TO DP013-PARAGRAPH                 53240099
                    MOVE 'FETCH TRANSFER RECEIVER CURSOR'               53250099
                                     TO DP013-MESSAGE-TEXT (1)          53260099
                    MOVE SQLCA       TO DP013-SQLCA                     53270099
                    MOVE 'TTFMSTR'   TO DP013-DB2-TABLE-NAME (1)        53280099
                    MOVE 'TTFSTAT'   TO DP013-DB2-TABLE-NAME (2)        53290099
                    MOVE 'TTFRCPT'   TO DP013-DB2-TABLE-NAME (3)        53300099
                    SET DP013-DB2-ABEND                                 53310099
                                     TO TRUE                            53320099
                    SET PS-ERROR-DB2  TO TRUE                           53330099
                    PERFORM DP013-0000-PROCESS-ABEND                    53340099
           END-EVALUATE.                                                53350099
                                                                        53360099
           IF  SQLCODE EQUAL +100                                       53370099
               SET ASC-NO-ITEMS-LEFT-ON-DB                              53380099
                                         TO TRUE                        53390099
           END-IF.                                                      53400099
                                                                        53410099
       EJECT                                                            53420099
      *----------------------------------------------------------------*53430099
      * FETCH THE TRANSFER ALL CURSOR.                                 *53440099
      *----------------------------------------------------------------*53450099
                                                                        53460099
       4314-FETCH-ALL-CURSOR.                                           53470099
                                                                        53480099
           EXEC SQL                                                     53490099
                FETCH XFER-ALL-CSR                                      53500099
                INTO  :TFMSTR-XFER-DKEY-ID                              53510099
                    , :TFMSTR-XFER-TYP-CDE                              53520099
                    , :TFMSTR-FR-STR-NBR                                53530099
                    , :TFMSTR-XFER-SEQ-NBR :PV-XFER-SEQ-NBR-NULL        53540099
                    , :TFMSTR-TO-STR-NBR                                53550099
                    , :TFMSTR-CLBK-NBR                                  53560099
                    , :TFMSTR-STK-BAL-APVL-NBR                          53570099
                    , :TFMSTR-ATTN-INIT-1ST-NM                          53580099
                    , :TFMSTR-ATTN-LAST-NM                              53590099
                    , :TFMSTR-CMPT-XFER-BEG-TMST                        53600099
                    , :TFMSTR-CMPT-XFER-END-TMST                        53610099
                    , :TFSTAT-XFER-STAT-CDE                             53620099
                    , :TFRCPT-RCV-XFER-BEG-TMST                         53630099
                    , :TFRCPT-RCV-XFER-END-TMST                         53640099
           END-EXEC.                                                    53650099
                                                                        53660099
           EVALUATE TRUE                                                53670099
               WHEN SQLCODE = ZERO                                      53680099
               WHEN SQLCODE = +100                                      53690099
                    CONTINUE                                            53700099
               WHEN OTHER                                               53710099
                    MOVE '4314-FETCH-ALL-CURSOR'                        53730099
                                     TO DP013-PARAGRAPH                 53740099
                    MOVE 'FETCH TRANSFER ALL CURSOR'                    53750099
                                     TO DP013-MESSAGE-TEXT (1)          53760099
                    MOVE SQLCA       TO DP013-SQLCA                     53770099
                    MOVE 'TTFMSTR'   TO DP013-DB2-TABLE-NAME (1)        53780099
                    MOVE 'TTFSTAT'   TO DP013-DB2-TABLE-NAME (2)        53790099
                    MOVE 'TTFITEM'   TO DP013-DB2-TABLE-NAME (3)        53800099
                    MOVE 'TTFRCPT'   TO DP013-DB2-TABLE-NAME (4)        53810099
                    SET DP013-DB2-ABEND                                 53820099
                                     TO TRUE                            53830099
                    SET PS-ERROR-DB2  TO TRUE                           53840099
                    PERFORM DP013-0000-PROCESS-ABEND                    53850099
           END-EVALUATE.                                                53860099
                                                                        53870099
           IF  SQLCODE EQUAL +100                                       53880099
               SET ASC-NO-ITEMS-LEFT-ON-DB                              53890099
                                         TO TRUE                        53900099
           END-IF.                                                      53910099
                                                                        53920099
       EJECT                                                            53930099
      *----------------------------------------------------------------*53940099
      *    SELECT THE RECEIPT TABLE TIMESTAMP FOR THE ITEM LINE DATE    53950099
      *----------------------------------------------------------------*53960099
                                                                        53970099
       4320-SELECT-RECEIPT-DATE.                                        53980099
                                                                        53990099
           MOVE TFMSTR-XFER-DKEY-ID    TO TFRCPT-XFER-DKEY-ID.          54000099
                                                                        54010099
           EXEC SQL                                                     54020099
               SELECT MAX(RCV_XFER_BEG_TMST)                            54030099
                INTO :TFRCPT-RCV-XFER-BEG-TMST :PV-RCV-BEG-TMST-NULL    54040099
                FROM TTFRCPT                                            54050099
                WHERE XFER_DKEY_ID = :TFRCPT-XFER-DKEY-ID               54060099
           END-EXEC.                                                    54070099
                                                                        54080099
           EVALUATE TRUE                                                54090099
               WHEN SQLCODE = ZERO                                      54100099
                   IF PV-RCV-BEG-TMST-NULL < ZERO                       54110099
                       MOVE ZEROES     TO TFRCPT-RCV-XFER-BEG-TMST      54120099
                   END-IF                                               54130099
               WHEN OTHER                                               54140099
                   MOVE '4320-SELECT-RECEIPT-DATE'                      54150099
                                       TO DP013-PARAGRAPH               54160099
                   MOVE 'SELECT RECEIPT DATE'                           54170099
                                       TO DP013-MESSAGE-TEXT (1)        54180099
                   MOVE SQLCA          TO DP013-SQLCA                   54190099
                   MOVE 'TTFRCPT'      TO DP013-DB2-TABLE-NAME (1)      54200099
                   SET DP013-DB2-ABEND TO TRUE                          54210099
                   PERFORM DP013-0000-PROCESS-ABEND                     54220099
           END-EVALUATE.                                                54230099
                                                                        54240099
       EJECT                                                            54250099
      *----------------------------------------------------------------*54260099
      *    SELECT AND SUM THE TRANSFER ITEM QUANTITIES                  54270099
      *----------------------------------------------------------------*54280099
                                                                        54290099
       4330-SELECT-XFER-QTY.                                            54300099
                                                                        54310099
           MOVE TFMSTR-XFER-DKEY-ID    TO TFITEM-XFER-DKEY-ID.          54320099
                                                                        54330099
           EXEC SQL                                                     54340099
               SELECT                                                   54350099
                     SUM (XFER_QTY)                                     54360099
                   , SUM (XFER_QTY * XFER_PRIC_AMT)                     54370099
                INTO :PV-ITEM-TRANSFER-QTY    :PV-ITEM-TRN-QTY-NULL     54380099
                   , :PV-ITEM-TRANSFER-RETAIL :PV-ITEM-TRN-RET-NULL     54390099
                FROM TTFITEM                                            54400099
                WHERE XFER_DKEY_ID = :TFITEM-XFER-DKEY-ID               54410099
           END-EXEC.                                                    54420099
                                                                        54430099
           EVALUATE TRUE                                                54440099
               WHEN SQLCODE = ZERO                                      54450099
                   IF PV-ITEM-TRN-QTY-NULL < ZERO                       54460099
                       MOVE ZEROES     TO ASC-TRN-QTY                   54470099
                                          (ASC-BLK-SUB ASC-ITEM-SUB)    54480099
                   ELSE                                                 54490099
                       ADD PV-ITEM-TRANSFER-QTY                         54500099
                                       TO ASC-XFER-QTY-TOTAL            54510099
                       MOVE PV-ITEM-TRANSFER-QTY                        54520099
                                       TO ASC-TRN-QTY                   54530099
                                          (ASC-BLK-SUB ASC-ITEM-SUB)    54540099
                   END-IF                                               54550099
                   IF PV-ITEM-TRN-RET-NULL < ZERO                       54560099
                       MOVE ZEROES     TO ML1-TRANSFER-RETAIL           54570099
                   ELSE                                                 54580099
                       ADD PV-ITEM-TRANSFER-RETAIL                      54590099
                                       TO ASC-XFER-RETAIL-TOTAL         54600099
                       MOVE PV-ITEM-TRANSFER-RETAIL                     54610099
                                       TO ML1-TRANSFER-RETAIL           54620099
                   END-IF                                               54630099
               WHEN OTHER                                               54640099
                   MOVE '4330-SELECT-XFER-QTY'                          54650099
                                       TO DP013-PARAGRAPH               54660099
                   MOVE 'SELECT XFER ITEM QUANTITIES'                   54670099
                                       TO DP013-MESSAGE-TEXT (1)        54680099
                   MOVE SQLCA          TO DP013-SQLCA                   54690099
                   MOVE 'TTFITEM'      TO DP013-DB2-TABLE-NAME (1)      54700099
                   SET DP013-DB2-ABEND TO TRUE                          54710099
                   PERFORM DP013-0000-PROCESS-ABEND                     54720099
           END-EVALUATE.                                                54730099
                                                                        54740099
       EJECT                                                            54750099
      *----------------------------------------------------------------*54760099
      *    SELECT CUSTOMER INFO FOR THE ITEM LINE.                      54770099
      *----------------------------------------------------------------*54780099
                                                                        54790099
       4340-SELECT-CUST-INFO.                                           54800099
                                                                        54810099
           MOVE TFMSTR-XFER-DKEY-ID    TO TFCUST-XFER-DKEY-ID.          54820099
                                                                        54830099
           EXEC SQL                                                     54840099
               SELECT                                                   54850099
                     CUST_NM                                            54860099
                   , PHN_NBR                                            54870099
                INTO  :TFCUST-CUST-NM                                   54880099
                    , :TFCUST-PHN-NBR                                   54890099
                FROM TTFCUST                                            54900099
                WHERE XFER_DKEY_ID = :TFCUST-XFER-DKEY-ID               54910099
           END-EXEC.                                                    54920099
                                                                        54930099
           EVALUATE TRUE                                                54940099
               WHEN SQLCODE = ZERO                                      54950099
                   CONTINUE                                             54960099
               WHEN SQLCODE = +100                                      54970099
                   MOVE SPACES         TO TFCUST-CUST-NM                54980099
                   MOVE SPACES         TO TFCUST-PHN-NBR                54990099
               WHEN OTHER                                               55000099
                   MOVE '4340-SELECT-CUST-INFO'                         55010099
                                       TO DP013-PARAGRAPH               55020099
                   MOVE 'SELECT TRANSFER CUSTOMER INFO'                 55030099
                                       TO DP013-MESSAGE-TEXT (1)        55040099
                   MOVE SQLCA          TO DP013-SQLCA                   55050099
                   MOVE 'TTFCUST'      TO DP013-DB2-TABLE-NAME (1)      55060099
                   SET DP013-DB2-ABEND TO TRUE                          55070099
                   PERFORM DP013-0000-PROCESS-ABEND                     55080099
           END-EVALUATE.                                                55090099
                                                                        55100099
       EJECT                                                            55110099
      *----------------------------------------------------------------*55120099
      *    SELECT AND SUM THE ITEM RECEIPT QUANTITIES                   55130099
      *----------------------------------------------------------------*55140099
                                                                        55150099
       4350-SELECT-RCVD-QTY.                                            55160099
                                                                        55170099
           MOVE TFMSTR-XFER-DKEY-ID      TO TFITRC-XFER-DKEY-ID.        55180099
           MOVE TFRCPT-RCV-XFER-BEG-TMST TO TFITRC-XFER-RCPT-TMST.      55190099
                                                                        55200099
           EXEC SQL                                                     55210099
               SELECT                                                   55220099
                     SUM (RCVD_XFER_QTY)                                55230099
                   , SUM (RCVD_XFER_QTY * RCVD_XFER_PRIC_AMT)           55240099
                INTO :PV-ITEM-RECEIVE-QTY     :PV-ITEM-REC-QTY-NULL     55250099
                   , :PV-ITEM-RECEIVE-RETAIL  :PV-ITEM-REC-RET-NULL     55260099
                FROM TTFITRC                                            55270099
                WHERE XFER_DKEY_ID   = :TFITRC-XFER-DKEY-ID             55280099
                  AND XFER_RCPT_TMST = :TFITRC-XFER-RCPT-TMST           55290099
           END-EXEC.                                                    55300099
                                                                        55310099
           EVALUATE TRUE                                                55320099
               WHEN SQLCODE = ZERO                                      55330099
                   IF PV-ITEM-REC-QTY-NULL < ZERO                       55340099
                       MOVE ZEROES     TO ASC-REC-QTY                   55350099
                                          (ASC-BLK-SUB ASC-ITEM-SUB)    55360099
                   ELSE                                                 55370099
                       ADD PV-ITEM-RECEIVE-QTY                          55380099
                                       TO ASC-RECV-QTY-TOTAL            55390099
                       MOVE PV-ITEM-RECEIVE-QTY                         55400099
                                       TO ASC-REC-QTY                   55410099
                                          (ASC-BLK-SUB ASC-ITEM-SUB)    55420099
                   END-IF                                               55430099
                   IF PV-ITEM-REC-RET-NULL < ZERO                       55440099
                       MOVE ZEROES     TO ML1-RECEIVE-RETAIL            55450099
                   ELSE                                                 55460099
                       ADD PV-ITEM-RECEIVE-RETAIL                       55470099
                                       TO ASC-RECV-RETAIL-TOTAL         55480099
                       MOVE PV-ITEM-RECEIVE-RETAIL                      55490099
                                       TO ML1-RECEIVE-RETAIL            55500099
                   END-IF                                               55510099
               WHEN OTHER                                               55520099
                   MOVE '4350-SELECT-XFER-RCVD-QTY'                     55530099
                                       TO DP013-PARAGRAPH               55540099
                   MOVE 'SELECT ITEM RECEIPT QUANTITIES'                55550099
                                       TO DP013-MESSAGE-TEXT (1)        55560099
                   MOVE SQLCA          TO DP013-SQLCA                   55570099
                   MOVE 'TTFITRC'      TO DP013-DB2-TABLE-NAME (1)      55580099
                   SET DP013-DB2-ABEND TO TRUE                          55590099
                   PERFORM DP013-0000-PROCESS-ABEND                     55600099
           END-EVALUATE.                                                55610099
                                                                        55620099
       EJECT                                                            55630099
      *----------------------------------------------------------------*55640099
      *    SELECT THE STATUS TABLE TIMESTAMP FOR VOIDED TRANSFERS       55650099
      *----------------------------------------------------------------*55660099
                                                                        55670099
       4360-SELECT-VOID-DATE.                                           55680099
                                                                        55690099
           MOVE TFMSTR-XFER-DKEY-ID    TO TFSTAT-XFER-DKEY-ID.          55700099
                                                                        55710099
           EXEC SQL                                                     55720099
               SELECT XFER_STAT_TMST                                    55730099
                INTO :TFSTAT-XFER-STAT-TMST                             55740099
                FROM TTFSTAT                                            55750099
                WHERE XFER_DKEY_ID  = :TFSTAT-XFER-DKEY-ID   AND        55760099
                      XFER_STAT_CDE = :PC-VOID-STATUS                   55770099
           END-EXEC.                                                    55780099
                                                                        55790099
           EVALUATE TRUE                                                55800099
               WHEN SQLCODE = ZERO                                      55810099
                   CONTINUE                                             55820099
               WHEN OTHER                                               55830099
                   MOVE '4360-SELECT-VOID-DATE'                         55840099
                                       TO DP013-PARAGRAPH               55850099
                   MOVE 'SELECT RECEIPT DATE'                           55860099
                                       TO DP013-MESSAGE-TEXT (1)        55870099
                   MOVE SQLCA          TO DP013-SQLCA                   55880099
                   MOVE 'TTFRCPT'      TO DP013-DB2-TABLE-NAME (1)      55890099
                   SET DP013-DB2-ABEND TO TRUE                          55900099
                   PERFORM DP013-0000-PROCESS-ABEND                     55910099
           END-EVALUATE.                                                55920099
                                                                        55930099
       EJECT                                                            55940099
      *----------------------------------------------------------------*55950099
      * MOVE THE DISPLAYED FIELDS FROM THE COMMAREA TO THE SCREEN.     *55960099
      *----------------------------------------------------------------*55970099
                                                                        55980099
       4400-MOVE-COMMAREA-TO-SCREEN.                                    55990099
           PERFORM                                                      56000099
               VARYING PV-SUB                                           56010099
               FROM 1 BY 1                                              56020099
               UNTIL PV-SUB > PC-ITEMS-PER-PANEL                        56030099
                   MOVE DP015-ASK-NOR-OFF                               56040099
                                       TO MR-TRANSFER-NBRA (PV-SUB)     56040099
                                          MR-STATUSA       (PV-SUB)     56050099
                                          MR-DATEA         (PV-SUB)     56060099
                                          MR-TRANSFER-QTYA (PV-SUB)     56070099
                                          MR-RECEIVED-QTYA (PV-SUB)     56080099
                                          MR-MISC-INFOA    (PV-SUB)     56090099
                   MOVE DP015-HL-OFF   TO MR-TRANSFER-NBRH (PV-SUB)     56040099
                                          MR-STATUSH       (PV-SUB)     56050099
                                          MR-DATEH         (PV-SUB)     56060099
                                          MR-TRANSFER-QTYH (PV-SUB)     56070099
                                          MR-RECEIVED-QTYH (PV-SUB)     56080099
                                          MR-MISC-INFOH    (PV-SUB)     56090099
                   MOVE DP015-BLUE     TO MR-TRANSFER-NBRC (PV-SUB)     56100099
                                          MR-STATUSC       (PV-SUB)     56110099
                                          MR-DATEC         (PV-SUB)     56120099
                                          MR-TRANSFER-QTYC (PV-SUB)     56130099
                                          MR-RECEIVED-QTYC (PV-SUB)     56140099
                                          MR-MISC-INFOC    (PV-SUB)     56150099
           END-PERFORM.                                                 56160099
           IF  (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1))             56170099
               AND (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1)))          56180099
               OR  (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)))          56190099
                   MOVE +1    TO ASC-BLK-SUB                            56200099
                   PERFORM 5100-WRITE-TEMP-STORAGE                      56210099
                   ADD +1     TO ASC-BLK-SUB                            56220099
                   PERFORM 5100-WRITE-TEMP-STORAGE                      56230099
                   DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             56240099
                       GIVING PV-BLOCK-NUMBER                           56250099
                       REMAINDER PV-REMAINDER                           56260099
                   IF  PV-REMAINDER > ZERO                              56270099
                       ADD +1 TO PV-BLOCK-NUMBER                        56280099
                   END-IF                                               56290099
                   MOVE +1    TO ASC-BLK-SUB                            56300099
                   PERFORM 4410-READ-TEMP-STORAGE                       56310099
                   ADD +1     TO ASC-BLK-SUB                            56320099
                                 PV-BLOCK-NUMBER                        56330099
                   PERFORM 4410-READ-TEMP-STORAGE                       56340099
           END-IF.                                                      56350099
           MOVE +1            TO ASC-BLK-SUB.                           56360099
           COMPUTE ASC-ITEM-SUB =                                       56370099
               ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              56380099
               + PC-ITEMS-PER-PANEL).                                   56390099
      *                                                                 56400099
           IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        56410099
               ADD +1         TO ASC-BLK-SUB                            56420099
               SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            56430099
           END-IF.                                                      56440099
      *                                                                 56450099
           COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           56460099
               ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                56470099
           PERFORM 4430-CHECK-FOR-BEGIN-AND-END.                        DPKCS036
           PERFORM 4420-FORMAT-LIST-LINES                               56480099
               VARYING PV-SUB                                           56490099
               FROM PC-ITEMS-PER-PANEL BY -1                            56500099
               UNTIL PV-SUB < +1.                                       56510099
      *                                                                 56520099
           COMPUTE ASC-ITEMS-DISPLAYED =                                56530099
               ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).          56540099
           MOVE PV-TOP-ITEM              TO ASC-ITEM-AT-TOP-OF-PANEL    56550099
                                            ASTRTITO.                   56560099
           MOVE ASC-ITEM-AT-BOT-OF-PANEL TO AENDITO.                    56570099
           MOVE ASC-NUMBER-OF-ITEMS-READ TO ATOTITO.                    56580099
           MOVE ASC-TRANSFER-TYPE-DESC   TO ATRTYPEO.                   56590099
           MOVE ASC-MISC-INFO-HEADER-1   TO ALHDL1O.                    56600099
           MOVE ASC-MISC-INFO-HEADER-2   TO ALHDL2O.                    56610099
           IF  ASC-DISPLAY-TOTALS                                       56620099
               MOVE 'TOTALS....'         TO ATOTSTITLO                  56630099
               MOVE ASC-XFER-QTY-TOTAL   TO PV-DISPLAY-NUM-6            56640099
               MOVE PV-DISPLAY-NUM-6     TO ATRNQYTOTO                  56650099
               MOVE ASC-RECV-QTY-TOTAL   TO PV-DISPLAY-NUM-6            56660099
               MOVE PV-DISPLAY-NUM-6     TO ARECQYTOTO                  56670099
               MOVE ASC-XFER-RETAIL-TOTAL TO PV-DISPLAY-DOL-11          56680099
               MOVE PV-DISPLAY-DOL-11    TO AXFRETTOTO                  56690099
               MOVE ASC-RECV-RETAIL-TOTAL TO PV-DISPLAY-DOL-11          56700099
               MOVE PV-DISPLAY-DOL-11    TO ARCRETTOTO                  56710099
           ELSE                                                         56720099
               MOVE SPACES               TO ATOTSTITLO                  56730099
               MOVE SPACES               TO ATRNQYTOTO                  56740099
               MOVE SPACES               TO ARECQYTOTO                  56750099
               MOVE SPACES               TO AXFRETTOTO                  56760099
               MOVE SPACES               TO ARCRETTOTO                  56770099
           END-IF.                                                      56780099
                                                                        56790099
           IF  DP020-MSG-NUMBER-X = SPACE                               56800099
               IF  ASC-ITEM-AT-BOT-OF-PANEL < ASC-NUMBER-OF-ITEMS-READ  56810099
      *            --- MORE ITEMS TO DISPLAY ----                       56820099
                   MOVE PC-TSYMSG-00279  TO DP020-MSG-NUMBER            56830099
                   SET DP020-MSG-INFORMATIONAL TO TRUE                  56840099
               END-IF                                                   56850099
           END-IF.                                                      56860099
      *----------------------------------------------------------------*56870099
      *    READ A BLOCK FROM TEMPORARY STORAGE INTO THE ARRAY.         *56880099
      *----------------------------------------------------------------*56890099
                                                                        56900099
       4410-READ-TEMP-STORAGE.                                          56910099
                                                                        56920099
           EXEC CICS                                                    56930099
               READQ TS                                                 56940099
                   QUEUE (ASC-LIST-QUEUE-NAME)                          56950099
                   INTO  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               56960099
                   ITEM  (PV-BLOCK-NUMBER)                              56970099
                   RESP  (PV-CICS-RESP)                                 56980099
           END-EXEC.                                                    56990099
                                                                        57000099
           IF  ((PV-CICS-RESP = DFHRESP (NORMAL))                       57010099
             OR (PV-CICS-RESP = DFHRESP (ITEMERR)))                     57020099
               CONTINUE                                                 57030099
           ELSE                                                         57040099
               SET DP013-CICS-ABEND     TO TRUE                         57050099
               SET DP013-NO-ROLLBACK    TO TRUE                         57060099
               MOVE '4410-READ-TEMP-STORAGE'                            57070099
                                        TO DP013-PARAGRAPH              57080099
               MOVE 'ERROR TRYING TO READ FROM TEMP STORAGE QUEUE'      57090099
                                        TO DP013-MESSAGE-TEXT(1)        57100099
               PERFORM DP013-0000-PROCESS-ABEND                         57110099
           END-IF.                                                      57120099
                                                                        57130099
           SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             57140099
      *                                                                 57150099
           IF  PV-CICS-RESP = DFHRESP (ITEMERR)                         57160099
               INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               57170099
           END-IF.                                                      57180099
       EJECT                                                            57190099
      *----------------------------------------------------------------*57200099
      *    PROCESS THE ITEMS IN THE ARRAY AND MOVE THEM TO THE MAP.    *57210099
      *----------------------------------------------------------------*57220099
                                                                        57230099
       4420-FORMAT-LIST-LINES.                                          57240099
           IF  ASC-ITEM-AT-BOT-OF-PANEL > ASC-NUMBER-OF-ITEMS-READ      57250099
               SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                57260099
               MOVE DP015-ASK-DRK-OFF  TO MR-SELECTA (PV-SUB)           57270099
               MOVE DP015-HL-OFF       TO MR-SELECTH (PV-SUB)           57280099
               MOVE SPACE              TO MR-SELECTI (PV-SUB)           57290099
                                          MR-TRANSFER-NBR (PV-SUB)      57300099
                                          MR-STATUS (PV-SUB)            57310099
                                          MR-DATE (PV-SUB)              57320099
                                          MR-TRANSFER-QTY-X (PV-SUB)    57330099
                                          MR-RECEIVED-QTY-X (PV-SUB)    57340099
                                          MR-MISC-INFO  (PV-SUB)        57350099
           ELSE                                                         57360099
               IF ASC-DISCREPANCY-EXISTS (ASC-BLK-SUB ASC-ITEM-SUB)     57370099
                   MOVE DP015-ASK-BRT-OFF                               57380099
                                         TO MR-TRANSFER-NBRA (PV-SUB)   57390099
                                            MR-STATUSA       (PV-SUB)   57400099
                                            MR-DATEA         (PV-SUB)   57410099
                                            MR-TRANSFER-QTYA (PV-SUB)   57420099
                                            MR-RECEIVED-QTYA (PV-SUB)   57430099
                                            MR-MISC-INFOA    (PV-SUB)   57440099
                   MOVE DP015-HL-OFF     TO MR-TRANSFER-NBRH (PV-SUB)   57390099
                                            MR-STATUSH       (PV-SUB)   57400099
                                            MR-DATEH         (PV-SUB)   57410099
                                            MR-TRANSFER-QTYH (PV-SUB)   57420099
                                            MR-RECEIVED-QTYH (PV-SUB)   57430099
                                            MR-MISC-INFOH    (PV-SUB)   57440099
                   MOVE DP015-YELLOW     TO MR-TRANSFER-NBRC (PV-SUB)   57450099
                                            MR-STATUSC       (PV-SUB)   57460099
                                            MR-DATEC         (PV-SUB)   57470099
                                            MR-TRANSFER-QTYC (PV-SUB)   57480099
                                            MR-RECEIVED-QTYC (PV-SUB)   57490099
                                            MR-MISC-INFOC    (PV-SUB)   57500099
               END-IF                                                   57680099
               MOVE DP015-UNP-ALP-NOR-OFF                               57690099
                                       TO MR-SELECTA (PV-SUB)           57700099
               MOVE DP015-GREEN        TO MR-SELECTC (PV-SUB)           57710099
               MOVE DP015-UNDERLINE    TO MR-SELECTH (PV-SUB)           57720099
               IF  ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      57730099
                                                         > SPACE        57740099
                   MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 57750099
                                       TO MR-SELECTI (PV-SUB)           57760099
               ELSE                                                     57770099
                   MOVE ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      57780099
                                       TO MR-SELECTI (PV-SUB)           57790099
               END-IF                                                   57800099
      *                                                                 57810099
               IF  DP030-SET-CURSOR-TRAILER                             57820099
                   IF  ((ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)57830099
                       > SPACE)                                         57840099
                     OR (PV-SUB = 1))                                   57850099
                      SET DP030-SET-CURSOR-APPL-1 TO TRUE               57860099
                      MOVE -1          TO MR-SELECTL (PV-SUB)           57870099
                   END-IF                                               57880099
               END-IF                                                   57890099
      *                                                                 57900099
               IF  PV-TOP-ITEM NOT = ASC-ITEM-AT-TOP-OF-PANEL           57910099
                   MOVE ASC-TRANSFER-NBR (ASC-BLK-SUB ASC-ITEM-SUB)     57920099
                                       TO MR-TRANSFER-NBR (PV-SUB)      57930099
                   MOVE ASC-STATUS (ASC-BLK-SUB ASC-ITEM-SUB)           57940099
                                       TO MR-STATUS (PV-SUB)            57950099
                   MOVE ASC-DATE (ASC-BLK-SUB ASC-ITEM-SUB)             57960099
                                       TO MR-DATE (PV-SUB)              57970099
                   MOVE ASC-TRN-QTY (ASC-BLK-SUB ASC-ITEM-SUB)          57980099
                                       TO MR-TRANSFER-QTY (PV-SUB)      57990099
                   MOVE ASC-REC-QTY (ASC-BLK-SUB ASC-ITEM-SUB)          58000099
                                       TO MR-RECEIVED-QTY (PV-SUB)      58010099
                   MOVE ASC-MISC-INFO (ASC-BLK-SUB ASC-ITEM-SUB)        58020099
                                       TO MR-MISC-INFO  (PV-SUB)        58030099
               END-IF                                                   58040099
           END-IF.                                                      58050099
           SUBTRACT +1 FROM ASC-ITEM-SUB                                58060099
           IF  ASC-ITEM-SUB < + 1                                       58070099
               MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  58080099
               MOVE +1                 TO ASC-BLK-SUB                   58090099
           END-IF.                                                      58100099
       EJECT                                                            58110099
      ******************************************************************DPKCS036
      ** IF A BEGINNING OF RANGE WAS SPECIFIED, MAKE SURE AN END OF   **DPKCS036
      ** RANGE WAS SPECIFIED AND VICE-VERSA.  IF ONE IS MISSING,      **DPKCS036
      ** ISSUE A WARNING.                                             **DPKCS036
      ******************************************************************DPKCS036
       4430-CHECK-FOR-BEGIN-AND-END.                                    DPKCS036
           IF  ASC-START-OF-SELECTED-RANGE > ZERO                       DPKCS036
               IF  ASC-END-OF-SELECTED-RANGE = ZERO                     DPKCS036
      *            -- NO END-OF-RANGE SPECFIED ---                      DPKCS036
                   MOVE PC-TSYMSG-00051  TO DP020-MSG-NUMBER            DPKCS036
                   SET DP020-MSG-WARNING TO TRUE                        DPKCS036
                   PERFORM 4431-POSITION-AT-WARNING                     DPKCS036
               END-IF                                                   DPKCS036
           ELSE                                                         DPKCS036
               IF  ASC-END-OF-SELECTED-RANGE > ZERO                     DPKCS036
      *            -- NO BEGINNING-OF-RANGE SPECFIED ---                DPKCS036
                   MOVE PC-TSYMSG-00053  TO DP020-MSG-NUMBER            DPKCS036
                   SET DP020-MSG-WARNING TO TRUE                        DPKCS036
                   PERFORM 4431-POSITION-AT-WARNING                     DPKCS036
               END-IF                                                   DPKCS036
           END-IF.                                                      DPKCS036
      ******************************************************************DPKCS036
      ** ONCE IT HAS BEEN DETERMINED THAT A WARNING IS TO BE ISSUED,  **DPKCS036
      ** DETERMINE IF EITHER THE BEGINNING OF RANGE OR END OF RANGE   **DPKCS036
      ** IS ON THE CURRENT SCREEN.  IF IT IS, HIGHLIGHT IT AND        **DPKCS036
      ** POSITION THE CURSOR THERE.                                   **DPKCS036
      ******************************************************************DPKCS036
       4431-POSITION-AT-WARNING.                                        DPKCS036
           COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 DPKCS036
                          - PV-TOP-ITEM + 1.                            DPKCS036
           IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      DPKCS036
               CONTINUE                                                 DPKCS036
           ELSE                                                         DPKCS036
               SET DP030-SET-CURSOR-APPL-1                              DPKCS036
                                         TO TRUE                        DPKCS036
               MOVE -1                   TO MR-SELECTL (PV-SUB)         DPKCS036
               MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         DPKCS036
               MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         DPKCS036
           END-IF.                                                      DPKCS036
      *                                                                 DPKCS036
           COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   DPKCS036
                          - PV-TOP-ITEM + 1.                            DPKCS036
           IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      DPKCS036
               CONTINUE                                                 DPKCS036
           ELSE                                                         DPKCS036
               SET DP030-SET-CURSOR-APPL-1                              DPKCS036
                                         TO TRUE                        DPKCS036
               MOVE -1                   TO MR-SELECTL (PV-SUB)         DPKCS036
               MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         DPKCS036
               MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         DPKCS036
           END-IF.                                                      DPKCS036
       EJECT                                                            DPKCS036
      *----------------------------------------------------------------*58120099
      * PREPARE THE SELECTED ITEMS TEMP STORAGE QUEUE.  MOVE ALL SEL-  *58130099
      * ECTED ITEMS FROM THE LIST TEMP STORAGE QUEUE TO THE LAYOUT     *58140099
      * FOR THE SELECTED ITEMS QUEUE.                                  *58150099
      *                                                                *58160099
      * FIRST, DELETE THE SELECTION QUEUE, NEXT LOAD THE SELECTION     *58170099
      * QUEUE RECORD.  FINALLY, WRITE THE SELECTION QUEUE ITEM WHEN    *58180099
      * THE ARRAY IS FULL.                                             *58190099
      *----------------------------------------------------------------*58200099
                                                                        58210099
       5000-PREPARE-SEL-QUEUE.                                          58220099
                                                                        58230099
           MOVE +1                   TO  ASC-BLK-SUB.                   58240099
           PERFORM 5100-WRITE-TEMP-STORAGE.                             58250099
           ADD +1                    TO  ASC-BLK-SUB.                   58260099
           PERFORM 5100-WRITE-TEMP-STORAGE.                             58270099
                                                                        58280099
           MOVE ASC-SEL-QUEUE-NAME   TO  TF001-SEL-QUEUE-NAME.          58290099
           PERFORM 6010-DELETE-SEL-QUEUE.                               58300099
                                                                        58310099
           SET ASC-UPDATE-TSQ        TO  TRUE.                          58320099
                                                                        58330099
           SET TF002-IDX             TO  1.                             58340099
           MOVE ZERO                 TO TF001-NUMBER-OF-TS-ITEMS.       58350099
           INITIALIZE TF002-SELECTED-ITEM-ARRAY.                        58360099
           PERFORM 5200-FILL-SEL-QUEUE-RECORD                           58370099
                   VARYING PV-ITEM                                      58380099
                   FROM 1 BY 1                                          58390099
                   UNTIL PV-ITEM GREATER ASC-HIGHEST-BLOCK-WRITTEN.     58400099
                                                                        58410099
           IF  TF002-IDX > 1                                            58420099
               PERFORM 5205-WRITE-SEL-QUEUE                             58430099
               ADD +1                TO TF001-NUMBER-OF-TS-ITEMS        58440099
           END-IF.                                                      58450099
       EJECT                                                            58460099
      *----------------------------------------------------------------*58470099
      *    WRITE A NEW BLOCK FROM THE ARRAY TO TEMPORARY STORAGE.      *58480099
      *    REWRITE AN EXISITING BLOCK ONLY IF IT HAS BEEN MODIFIED.    *58490099
      *----------------------------------------------------------------*58500099
                                                                        58510099
       5100-WRITE-TEMP-STORAGE.                                         58520099
           MOVE ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1)                     58530099
                                         TO PV-LIST-ITEM-NUMBER.        58540099
           COMPUTE PV-BLOCK-NUMBER =                                    58550099
               1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    58560099
                                                                        58570099
           IF (PV-BLOCK-NUMBER < ASC-HIGHEST-BLOCK-WRITTEN)             58580099
           OR (PV-BLOCK-NUMBER = ASC-HIGHEST-BLOCK-WRITTEN)             58590099
               IF  ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                      58600099
                   PERFORM 5105-REWRITE-ASC-LISTQ                       58610099
               END-IF                                                   58620099
           ELSE                                                         58630099
               COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                       58640099
               ASC-HIGHEST-BLOCK-WRITTEN + 1                            58650099
               PERFORM 5110-WRITE-ASC-LISTQ                             58660099
               ADD +1                    TO ASC-HIGHEST-BLOCK-WRITTEN   58670099
           END-IF.                                                      58680099
                                                                        58690099
           SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             58700099
      ******************************************************************58710099
      ** REWRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-    **58720099
      ** SPECIFIC COMMAREA.                                           **58730099
      ******************************************************************58740099
       5105-REWRITE-ASC-LISTQ.                                          58750099
           EXEC CICS                                                    58760099
               WRITEQ TS                                                58770099
                   QUEUE (ASC-LIST-QUEUE-NAME)                          58780099
                   FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               58790099
                   ITEM  (PV-BLOCK-NUMBER)                              58800099
                   REWRITE                                              58810099
                   RESP  (PV-CICS-RESP)                                 58820099
           END-EXEC.                                                    58830099
                                                                        58840099
           IF  PV-CICS-RESP = DFHRESP(NORMAL)                           58850099
               CONTINUE                                                 58860099
           ELSE                                                         58870099
               SET DP013-CICS-ABEND            TO TRUE                  58880099
               SET DP013-NO-ROLLBACK           TO TRUE                  58890099
               MOVE '5105-REWRITE-ASC-LISTQ'   TO DP013-PARAGRAPH       58900099
               MOVE 'ATTEMPTING TO REWRITE LIST TEMP STORAGE QUEUE'     58910099
                                               TO DP013-MESSAGE-TEXT(1) 58920099
               PERFORM DP013-0000-PROCESS-ABEND                         58930099
           END-IF.                                                      58940099
                                                                        58950099
      ******************************************************************58960099
      ** WRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-      **58970099
      ** SPECIFIC COMMAREA.                                           **58980099
      ******************************************************************58990099
       5110-WRITE-ASC-LISTQ.                                            59000099
           EXEC CICS                                                    59010099
               WRITEQ TS                                                59020099
                   QUEUE (ASC-LIST-QUEUE-NAME)                          59030099
                   FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               59040099
                   ITEM  (PV-BLOCK-NUMBER)                              59050099
                   RESP  (PV-CICS-RESP)                                 59060099
           END-EXEC.                                                    59070099
           IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      59080099
               SET DP013-CICS-ABEND      TO TRUE                        59090099
               SET DP013-NO-ROLLBACK     TO TRUE                        59100099
               MOVE '5110-WRITE-ASC-LISTQ'                              59110099
                                         TO DP013-PARAGRAPH             59120099
               MOVE 'ATTEMPTING TO DELETE TEMP STORAGE QUEUE'           59130099
                                         TO DP013-MESSAGE-TEXT(1)       59140099
               PERFORM DP013-0000-PROCESS-ABEND                         59150099
           END-IF.                                                      59160099
       EJECT                                                            59170099
      *----------------------------------------------------------------*59180099
      * READ A LIST QUEUE RECORD AND MOVE THE KEYS OF SELECTED OBJECTS *59190099
      * TO THE SELECTED ITEMS TEMP STORAGE QUEUE RECORD.               *59200099
      *----------------------------------------------------------------*59210099
                                                                        59220099
       5200-FILL-SEL-QUEUE-RECORD.                                      59230099
                                                                        59240099
           PERFORM 6112-READ-LIST-QUEUE.                                59250099
                                                                        59260099
           IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       59270099
               PERFORM                                                  59280099
               VARYING LQW-IDX                                          59290099
               FROM 1 BY 1                                              59300099
               UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            59310099
                 OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          59320099
                                                                        59330099
                   IF  LQW-SELECT (LQW-IDX)                             59340099
                       MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)              59350099
                                     TO TF002-ITEM (TF002-IDX)          59360099
                       IF LQW-TRANSFER-NBR (LQW-IDX) NOT =              59370099
                                                     ASC-SEL-XFER-NBR   59380099
                         AND ASC-SEL-XFER-NBR NOT = SPACES              59390099
                           SET PS-XFER-NBR-CHG TO TRUE                  59400099
                       END-IF                                           59410099
                       MOVE LQW-TRANSFER-NBR (LQW-IDX)                  59420099
                                     TO TF002-TRANSFER-NBR (TF002-IDX)  59430099
                                        ASC-SEL-XFER-NBR                59440099
                       MOVE LQW-XFER-DKEY-ID (LQW-IDX)                  59450099
                                     TO ASC-SEL-XFER-DKEY-ID            59460099
                       IF PS-UPDATE-SEL-QUEUE                           59470099
                           MOVE 'S'   TO TF002-ACTION-SW(TF002-IDX)     59480099
                       ELSE                                             59490099
                           MOVE SPACE TO TF002-ACTION-SW(TF002-IDX)     59500099
                       END-IF                                           59510099
                       SET TF002-IDX UP BY 1                            59520099
                       IF  TF002-IDX > TF002-MAX-ITEMS                  59530099
                           PERFORM 5205-WRITE-SEL-QUEUE                 59540099
                           ADD +1        TO TF001-NUMBER-OF-TS-ITEMS    59550099
                           INITIALIZE TF002-SELECTED-ITEM-ARRAY         59560099
                           SET TF002-IDX TO  1                          59570099
                       END-IF                                           59580099
                   END-IF                                               59590099
               END-PERFORM                                              59600099
           END-IF.                                                      59610099
                                                                        59620099
      *----------------------------------------------------------------*59630099
      *    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE.                *59640099
      *----------------------------------------------------------------*59650099
                                                                        59660099
       5205-WRITE-SEL-QUEUE.                                            59670099
                                                                        59680099
           EXEC CICS                                                    59690099
                WRITEQ TS                                               59700099
                    QUEUE (ASC-SEL-QUEUE-NAME)                          59710099
                    FROM  (TF002-TRANSFER-SEL-REC)                      59720099
                    ITEM  (PV-SEL-QUEUE-ITEM)                           59730099
                    RESP  (PV-CICS-RESP)                                59740099
           END-EXEC.                                                    59750099
                                                                        59760099
           IF  PV-CICS-RESP = DFHRESP (NORMAL)                          59770099
               CONTINUE                                                 59780099
           ELSE                                                         59790099
               SET DP013-CICS-ABEND      TO TRUE                        59800099
               SET DP013-NO-ROLLBACK     TO TRUE                        59810099
               MOVE '5205-WRITE-SEL-QUEUE'                              59820099
                                         TO DP013-PARAGRAPH             59830099
               MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          59840099
                                         TO DP013-MESSAGE-TEXT(1)       59850099
               PERFORM DP013-0000-PROCESS-ABEND                         59860099
           END-IF.                                                      59870099
       EJECT                                                            59880099
      ******************************************************************59890099
      ** WHEN RETURNING TO THIS TRANSACTION FROM ANOTHER TRANSACTION, **59900099
      ** SETUP THE ARRAY AS IT WAS WHEN WE HAD LEFT PREVIOUSLY.  EDIT **59910099
      ** THE SELECTIONS MADE AT THAT TIME AND DISPLAY THE PANEL TO    **59920099
      ** THE USER.                                                    **59930099
      ******************************************************************59940099
       6000-REFRESH-PANEL-FROM-TEMP.                                    59950099
           IF  ASC-UPDATE-TSQ AND                                       59960099
               ASC-NUMBER-OF-SELECTED-ITEMS > 0                         59970099
               SET ASC-NO-TSQ-UPDATE TO TRUE                            59980099
               MOVE ZERO                 TO PV-SAVE-ITEM                59990099
                                            PV-SEL-QUEUE-ITEM           60000099
               MOVE ASC-NUMBER-OF-SELECTED-ITEMS                        60010099
                                         TO PV-HOLD-SELECTED-ITEMS      60020099
               MOVE +1                   TO PV-ITEMS-PROCESSED          DPKCS036
               PERFORM 6100-UPDATE-TSQ                                  60030099
                   UNTIL PV-ITEMS-PROCESSED >                           60040099
                                           PV-HOLD-SELECTED-ITEMS       60050099
               PERFORM 6010-DELETE-SEL-QUEUE                            60060099
               INITIALIZE ASC-BLOCK-ENTRIES (1)                         60070099
                          ASC-BLOCK-ENTRIES (2)                         60080099
               MOVE SPACES               TO ASC-SEL-XFER-NBR            60090099
               MOVE ZERO                 TO ASC-SEL-XFER-DKEY-ID        60100099
           END-IF.                                                      60110099
                                                                        60120099
      *----------------------------------------------------------------*60130099
      *    DELETE THE SELECTED ITEMS TEMP STORAGE QUEUE.               *60140099
      *----------------------------------------------------------------*60150099
       6010-DELETE-SEL-QUEUE.                                           60160099
                                                                        60170099
           EXEC CICS                                                    60180099
               DELETEQ TS                                               60190099
                   QUEUE (ASC-SEL-QUEUE-NAME)                           60200099
                   RESP  (PV-CICS-RESP)                                 60210099
           END-EXEC.                                                    60220099
      *                                                                 60230099
           IF ((PV-CICS-RESP = DFHRESP(NORMAL)) OR                      60240099
              (PV-CICS-RESP = DFHRESP(QIDERR)))                         60250099
               CONTINUE                                                 60260099
           ELSE                                                         60270099
               SET DP013-CICS-ABEND TO TRUE                             60280099
               SET DP013-NO-ROLLBACK TO TRUE                            60290099
               MOVE '6010-DELETE-SEL-QUEUE'                             60300099
                              TO DP013-PARAGRAPH                        60310099
               MOVE 'ERROR TRYING TO DELETE SELECTION TS QUEUE'         60320099
                              TO DP013-MESSAGE-TEXT (1)                 60330099
               PERFORM DP013-0000-PROCESS-ABEND                         60340099
           END-IF.                                                      60350099
                                                                        60360099
      *----------------------------------------------------------------*60370099
      *    INCREMENT THE TSQ ITEM NUMBER AND READ THE LIST QUEUE.      *60380099
      *    LOOP THROUGH THE LIST QUEUE TO OBTAIN THE LINE ITEM NUMBER  *60390099
      *    TO BE USED TO UPDATE (DESELECT) THE CORRECT LINE ITEM IN    *60400099
      *    THE TEMP QUEUE.                                             *60410099
      *----------------------------------------------------------------*60420099
                                                                        60430099
       6100-UPDATE-TSQ.                                                 60440099
                                                                        60450099
           ADD 1                     TO  PV-SEL-QUEUE-ITEM.             60460099
           PERFORM 6105-READ-SEL-QUEUE.                                 60470099
           PERFORM                                                      60480099
               VARYING TF002-IDX                                        60490099
               FROM 1 BY 1                                              60500099
               UNTIL ((PV-ITEMS-PROCESSED >                             60510099
                                    PV-HOLD-SELECTED-ITEMS)             60520099
               OR (TF002-IDX GREATER THAN TF002-MAX-ITEMS))             60530099
               IF  TF002-ACTION-SW (TF002-IDX) > SPACE                  60540099
                   PERFORM 6110-PROCESS-ITEMS                           60550099
               END-IF                                                   60560099
               ADD +1                TO PV-ITEMS-PROCESSED              60570099
           END-PERFORM.                                                 60580099
           PERFORM 6111-WRITE-LIST-QUEUE.                               60590099
      *----------------------------------------------------------------*60600099
      *    READ THE LIST QUEUE RECORD.                                 *60610099
      *----------------------------------------------------------------*60620099
                                                                        60630099
       6105-READ-SEL-QUEUE.                                             60640099
                                                                        60650099
           EXEC CICS                                                    60660099
                READQ TS                                                60670099
                    QUEUE (ASC-SEL-QUEUE-NAME)                          60680099
                    INTO  (TF002-TRANSFER-SEL-REC)                      60690099
                    ITEM  (PV-SEL-QUEUE-ITEM)                           60700099
                    RESP  (PV-CICS-RESP)                                60710099
           END-EXEC.                                                    60720099
      *                                                                 60730099
           IF  PV-CICS-RESP = DFHRESP (NORMAL)                          60740099
               CONTINUE                                                 60750099
           ELSE                                                         60760099
               SET DP013-CICS-ABEND      TO  TRUE                       60770099
               SET DP013-NO-ROLLBACK     TO  TRUE                       60780099
               MOVE '6105-READ-SEL-QUEUE'                               60790099
                                         TO  DP013-PARAGRAPH            60800099
               MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           60810099
                                         TO  DP013-MESSAGE-TEXT(1)      60820099
               PERFORM DP013-0000-PROCESS-ABEND                         60830099
           END-IF.                                                      60840099
       EJECT                                                            60850099
      *----------------------------------------------------------------*60860099
      *    CALCULATE THE TEMP QUEUE ITEM THAT MUST BE READ AND READ IT.*60870099
      *    REWRITE THE CURRENT TEMP QUEUE ITEM IF NECESSARY.  CALCULATE*60880099
      *    THE LINE ITEM OCCURENCE AND UPDATE (DESELECT) IT.           *60890099
      *----------------------------------------------------------------*60900099
                                                                        60910099
       6110-PROCESS-ITEMS.                                              60920099
                                                                        60930099
           COMPUTE PV-ITEM = 1 + ((TF002-ITEM (TF002-IDX) - 1)          60940099
                           / PC-ITEMS-PER-PANEL).                       60950099
                                                                        60960099
           IF  PV-ITEM NOT EQUAL PV-SAVE-ITEM                           60970099
               IF  PV-SAVE-ITEM NOT EQUAL ZERO                          60980099
                   PERFORM 6111-WRITE-LIST-QUEUE                        60990099
               END-IF                                                   61000099
               MOVE PV-ITEM          TO PV-SAVE-ITEM                    61010099
                                                                        61020099
               PERFORM 6112-READ-LIST-QUEUE                             61030099
               IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)               61040099
                   CONTINUE                                             61050099
               END-IF                                                   61060099
           END-IF.                                                      61070099
                                                                        61080099
           COMPUTE PV-SUB = (TF002-ITEM (TF002-IDX)                     61090099
                          - LQW-LIST-ITEM-NUMBER (1)) + 1.              61100099
           SET LQW-DESELECT (PV-SUB) TO    TRUE                         61110099
           MOVE LQW-SELECTED-SW (PV-SUB)                                61120099
                                     TO LQW-TEMP-SELECTED-SW (PV-SUB).  61130099
           SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                61140099
                                                                        61150099
      *----------------------------------------------------------------*61160099
      *    WRITE THE TS QUEUE RECORD JUST UPDATED IN C600.             *61170099
      *----------------------------------------------------------------*61180099
                                                                        61190099
       6111-WRITE-LIST-QUEUE.                                           61200099
                                                                        61210099
           EXEC CICS                                                    61220099
               WRITEQ TS                                                61230099
                   QUEUE (ASC-LIST-QUEUE-NAME)                          61240099
                   FROM  (LQW-LIST-QUEUE-WORK-AREA)                     61250099
                   ITEM  (PV-SAVE-ITEM)                                 61260099
                   REWRITE                                              61270099
                   RESP  (PV-CICS-RESP)                                 61280099
           END-EXEC.                                                    61290099
      *                                                                 61300099
           IF  PV-CICS-RESP = DFHRESP (NORMAL)                          61310099
               CONTINUE                                                 61320099
           ELSE                                                         61330099
               SET DP013-CICS-ABEND  TO  TRUE                           61340099
               SET DP013-NO-ROLLBACK TO  TRUE                           61350099
               MOVE '6111-WRITE-LIST-QUEUE'                             61360099
                                     TO  DP013-PARAGRAPH                61370099
               MOVE 'ATTEMPTING TO REWRITE LIST QUEUE'                  61380099
                                     TO  DP013-MESSAGE-TEXT(1)          61390099
               PERFORM DP013-0000-PROCESS-ABEND                         61400099
           END-IF.                                                      61410099
                                                                        61420099
       EJECT                                                            61430099
      *----------------------------------------------------------------*61440099
      *    READ THE TEMPORARY STORAGE QUEUE INTO A TEMPORARY WORK AREA.*61450099
      *----------------------------------------------------------------*61460099
                                                                        61470099
       6112-READ-LIST-QUEUE.                                            61480099
                                                                        61490099
           EXEC CICS                                                    61500099
               READQ TS                                                 61510099
                   QUEUE (ASC-LIST-QUEUE-NAME)                          61520099
                   INTO  (LQW-LIST-QUEUE-WORK-AREA)                     61530099
                   ITEM  (PV-ITEM)                                      61540099
                   RESP  (PV-CICS-RESP)                                 61550099
           END-EXEC.                                                    61560099
      *                                                                 61570099
           IF  PV-CICS-RESP = DFHRESP (NORMAL)                          61580099
               CONTINUE                                                 61590099
           ELSE                                                         61600099
               SET DP013-CICS-ABEND        TO TRUE                      61610099
               SET DP013-NO-ROLLBACK       TO TRUE                      61620099
               MOVE '6112-READ-LIST-QUEUE' TO DP013-PARAGRAPH           61630099
               MOVE 'ATTEMPTING TO READQ LIST QUEUE'                    61640099
                                           TO DP013-MESSAGE-TEXT(1)     61650099
               PERFORM DP013-0000-PROCESS-ABEND                         61660099
           END-IF.                                                      61670099
                                                                        61680099
       EJECT                                                            61690099
       7000-PRINT-LIST.                                                 61700099
                                                                        61710099
           PERFORM 7010-INITIALIZE.                                     61720099
           MOVE PC-PUT                 TO DRS01-DRRB-FUNC.              61730099
           PERFORM 7020-READ-LIST-QUEUE                                 61740099
                   VARYING PV-ITEM                                      61750099
                   FROM 1 BY 1                                          61760099
                   UNTIL PV-ITEM GREATER ASC-HIGHEST-BLOCK-WRITTEN.     61770099
           IF ASC-DISPLAY-TOTALS                                        61780099
               PERFORM 7040-TOTALS-LINE                                 61790099
           END-IF.                                                      61800099
                                                                        61810099
           MOVE PC-TERM                TO DRS01-DRRB-FUNC.              61820099
           PERFORM 7500-LINK-TO-DRS.                                    61830099
                                                                        61840099
       7010-INITIALIZE.                                                 61850099
           PERFORM 7600-FORMAT-TIME.                                    61860099
                                                                        61870099
           IF TF001-PRINTER-DEST = 'XXXX'                               61880099
               MOVE 'R'                TO DRS02-DRIB-CLASS              61890099
               MOVE 'N'                TO DRS02-DRIB-HOLD               61900099
               MOVE 'LOCAL'            TO DRS02-DRIB-DEST               61910099
           ELSE                                                         61920099
               MOVE 'A'                TO DRS02-DRIB-CLASS              61930099
               MOVE 'N'                TO DRS02-DRIB-HOLD               61940099
               MOVE TF001-PRINTER-DEST TO DRS02-DRIB-DEST               61950099
           END-IF.                                                      61960099
                                                                        61970099
           MOVE PC-INIT                TO DRS01-DRRB-FUNC.              61980099
           MOVE DRS02-DRIB-HEADER      TO DRS01-COMM-DRIB-HDR.          61990099
           MOVE DRS02-DRIB-ATTRIB      TO DRS01-COMM-DRIB-AT1.          62000099
                                                                        62010099
           PERFORM 7500-LINK-TO-DRS.                                    62020099
                                                                        62030099
           MOVE PC-CURRENT-PROGRAM-NAME TO DP132O-PROGRAM-NAME.         62040099
           MOVE 1                       TO DP132O-REPORT-NUMBER.        62050099
           MOVE ASC-TRANSFER-TYPE-DESC  TO HL3-XFER-TYPE-DESC.          62060099
           MOVE ASC-MISC-INFO-HEADER-1  TO HL4-MISC-INFO-HDR-1.         62070099
           MOVE ASC-MISC-INFO-HEADER-2  TO HL5-MISC-INFO-HDR-2.         62080099
           MOVE 99                      TO PV-LINE-COUNT.               62090099
           MOVE 0                       TO PV-PAGE-COUNT.               62100099
                                                                        62110099
      *----------------------------------------------------------------*62120099
      * READ A LIST QUEUE RECORD AND MOVE THE DATA TO THE REPORT LINES.*62130099
      *----------------------------------------------------------------*62140099
       7020-READ-LIST-QUEUE.                                            62150099
                                                                        62160099
           PERFORM 6112-READ-LIST-QUEUE.                                62170099
                                                                        62180099
           IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       62190099
               PERFORM 7030-PRINT-REPORT                                62200099
                 VARYING LQW-IDX                                        62210099
                   FROM 1 BY 1                                          62220099
                   UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL        62230099
                     OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO      62240099
           END-IF.                                                      62250099
                                                                        62260099
       EJECT                                                            62270099
       7030-PRINT-REPORT.                                               62280099
                                                                        62290099
           IF PV-LINE-COUNT > PC-LINE-MAX                               62300099
               PERFORM 7700-PRINT-HEADINGS                              62310099
           END-IF.                                                      62320099
                                                                        62330099
           MOVE LQW-TRANSFER-NBR (LQW-IDX) TO DL1-XFER-NBR.             62340099
           MOVE LQW-STATUS       (LQW-IDX) TO DL1-STATUS.               62350099
           MOVE LQW-DATE         (LQW-IDX) TO DL1-DATE.                 62360099
           MOVE LQW-TRN-QTY      (LQW-IDX) TO DL1-TRN-QTY.              62370099
           MOVE LQW-REC-QTY      (LQW-IDX) TO DL1-REC-QTY.              62380099
           MOVE LQW-MISC-INFO    (LQW-IDX) TO DL1-MISC.                 62390099
           MOVE DL-DETAIL-LINE-1           TO DRS01-COMM-DATA.          62400099
           MOVE PC-SINGLE-SPACE            TO DRS01-COMM-CTL.           62410099
           PERFORM 7500-LINK-TO-DRS.                                    62420099
           ADD 1                           TO PV-LINE-COUNT.            62430099
                                                                        62440099
       EJECT                                                            62450099
       7040-TOTALS-LINE.                                                62460099
                                                                        62470099
           MOVE ASC-XFER-QTY-TOTAL     TO RPTL-TRN-QTY.                 62480099
           MOVE ASC-RECV-QTY-TOTAL     TO RPTL-REC-QTY.                 62490099
           MOVE ASC-XFER-RETAIL-TOTAL  TO RPTL-XFER-RETAIL.             62500099
           MOVE ASC-RECV-RETAIL-TOTAL  TO RPTL-RECV-RETAIL.             62510099
                                                                        62520099
           MOVE BL-BLANK-LINE          TO DRS01-COMM-DATA.              62530099
           MOVE PC-SINGLE-SPACE        TO DRS01-COMM-CTL.               62540099
           PERFORM 7500-LINK-TO-DRS.                                    62550099
                                                                        62560099
           MOVE RP-TOTALS-LINE         TO DRS01-COMM-DATA.              62570099
           MOVE PC-SINGLE-SPACE        TO DRS01-COMM-CTL.               62580099
           PERFORM 7500-LINK-TO-DRS.                                    62590099
                                                                        62600099
       EJECT                                                            62610099
      *----------------------------------------------------------------*        
      *  GET THE MAX RECEIPT TIMESTAMP.                                         
      *----------------------------------------------------------------*        
       7150-SELECT-MAX-RCPT-TMST.                                               
           MOVE ASC-SEL-XFER-DKEY-ID      TO  TFMSTR-XFER-DKEY-ID.              
           PERFORM                                                              
               WITH TEST AFTER                                                  
               VARYING PV-RETRY-COUNTER                                         
               FROM 1 BY 1                                                      
               UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)                       
                   OR (SQLCODE = +0)                                            
                   OR (SQLCODE = +100))                                         
                                                                                
               EXEC SQL                                                         
                   SELECT  MAX(RCV_XFER_BEG_TMST)                               
                     INTO  :TFRCPT-RCV-XFER-BEG-TMST                            
                               :PV-NULL-IND                                     
                     FROM  TTFRCPT                                              
                    WHERE  (XFER_DKEY_ID  =  :TFMSTR-XFER-DKEY-ID)              
               END-EXEC                                                         
                                                                                
               EVALUATE TRUE                                                    
                   WHEN SQLCODE = ZERO                                          
                   WHEN SQLCODE = +100                                          
                   WHEN SQLCODE = -904                                          
                   WHEN SQLCODE = -913                                          
                       CONTINUE                                                 
                   WHEN OTHER                                                   
                       MOVE '7150-SELECT-MAX-RCPT-TMST'                         
                                             TO DP013-PARAGRAPH                 
                       MOVE 'SELECT MAX TIMESTAMP FOR DATALESS KEY: '           
                                             TO DP013-MESSAGE-TEXT (1)          
                       MOVE TFMSTR-XFER-DKEY-ID                                 
                                             TO PV-DISPLAY-XFER-DKEY-ID         
                       MOVE PV-DISPLAY-XFER-DKEY-ID                             
                                             TO DP013-MESSAGE-TEXT (2)          
                       MOVE SQLCA            TO DP013-SQLCA                     
                       MOVE 'TTFRCPT'        TO DP013-DB2-TABLE-NAME (1)        
                       SET DP013-DB2-ABEND                                      
                           DP013-XCTL-DISPLAY-RESTART                           
                                             TO TRUE                            
                       PERFORM DP013-0000-PROCESS-ABEND                         
               END-EVALUATE                                                     
           END-PERFORM.                                                         
                                                                                
           IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                                
                   MOVE '7150-SELECT-MAX-RCPT-TMST'                             
                                             TO DP013-PARAGRAPH                 
                   MOVE 'SELECT MAX TIMESTAMP FOR DATALESS KEY: '               
                                             TO DP013-MESSAGE-TEXT (1)          
                   MOVE TFMSTR-XFER-DKEY-ID  TO PV-DISPLAY-XFER-DKEY-ID         
                   MOVE PV-DISPLAY-XFER-DKEY-ID                                 
                                             TO DP013-MESSAGE-TEXT (2)          
                   MOVE SQLCA                TO DP013-SQLCA                     
                   MOVE 'TTFRCPT'            TO DP013-DB2-TABLE-NAME (1)        
                   SET DP013-DB2-ABEND                                          
                       DP013-XCTL-DISPLAY-RESTART                               
                                            TO TRUE                             
                   PERFORM DP013-0000-PROCESS-ABEND                             
           END-IF.                                                              
      *                                                                         
      *----------------------------------------------------------------*        
      *  GET THE CURRENT RECEIPT END TIMESTAMP.                                 
      *----------------------------------------------------------------*        
       7200-SELECT-CURRENT-RCPT.                                                
           PERFORM                                                              
               WITH TEST AFTER                                                  
               VARYING PV-RETRY-COUNTER                                         
               FROM 1 BY 1                                                      
               UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)                       
                   OR (SQLCODE = +0)                                            
                   OR (SQLCODE = +100))                                         
                                                                                
               EXEC SQL                                                         
                   SELECT  RCV_XFER_END_TMST                                    
                     INTO  :TFRCPT-RCV-XFER-END-TMST                            
                     FROM  TTFRCPT                                              
                    WHERE  (XFER_DKEY_ID  =  :TFMSTR-XFER-DKEY-ID  AND          
                       RCV_XFER_BEG_TMST  =  :TFRCPT-RCV-XFER-BEG-TMST)         
               END-EXEC                                                         
                                                                                
               EVALUATE TRUE                                                    
                   WHEN SQLCODE = ZERO                                          
                   WHEN SQLCODE = +100                                          
                   WHEN SQLCODE = -904                                          
                   WHEN SQLCODE = -913                                          
                       CONTINUE                                                 
                   WHEN OTHER                                                   
                       MOVE '7200-SELECT-CURRENT-RCPT'                          
                                             TO DP013-PARAGRAPH                 
                       MOVE 'SELECT CURRENT RECEIPT FOR DATALESS KEY/TIM        
      -                 'MP: '           TO DP013-MESSAGE-TEXT (1)              
                       MOVE TFMSTR-XFER-DKEY-ID                                 
                                             TO PV-DISPLAY-XFER-DKEY-ID         
                       MOVE PV-DISPLAY-XFER-DKEY-ID                             
                                             TO DP013-MESSAGE-TEXT (2)          
                       MOVE TFRCPT-RCV-XFER-BEG-TMST                            
                                             TO DP013-MESSAGE-TEXT (3)          
                       MOVE SQLCA            TO DP013-SQLCA                     
                       MOVE 'TTFRCPT'        TO DP013-DB2-TABLE-NAME (1)        
                       SET DP013-DB2-ABEND                                      
                       DP013-XCTL-DISPLAY-RESTART                               
                                            TO TRUE                             
                       PERFORM DP013-0000-PROCESS-ABEND                         
               END-EVALUATE                                                     
           END-PERFORM.                                                         
           IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                                
                   MOVE '7200-SELECT-CURRENT-RCPT'                              
                                             TO DP013-PARAGRAPH                 
                   MOVE 'SELECT CURRENT RECEIPT FOR DATALESS KEY/TIMESTA        
      -                 'MP: '               TO DP013-MESSAGE-TEXT (1)          
                   MOVE TFMSTR-XFER-DKEY-ID  TO PV-DISPLAY-XFER-DKEY-ID         
                   MOVE PV-DISPLAY-XFER-DKEY-ID                                 
                                             TO DP013-MESSAGE-TEXT (2)          
                   MOVE TFRCPT-RCV-XFER-BEG-TMST                                
                                             TO DP013-MESSAGE-TEXT (3)          
                   MOVE SQLCA                TO DP013-SQLCA                     
                   MOVE 'TTFRCPT'            TO DP013-DB2-TABLE-NAME (1)        
                   SET DP013-DB2-ABEND                                          
                       DP013-XCTL-DISPLAY-RESTART                               
                                            TO TRUE                             
                   PERFORM DP013-0000-PROCESS-ABEND                             
           END-IF.                                                              
      ******************************************************************62620099
      * THIS MODULE EXECUTES A LINK TO DRS (DYNAMIC REPORT SYSTEM).     62630099
      ******************************************************************62640099
       7500-LINK-TO-DRS.                                                62650099
                                                                        62660099
           EXEC CICS                                                    62670099
               LINK                                                     62680099
                   PROGRAM   ('DRS1INTC')                               62690099
                   COMMAREA  (DRS01-COMMAREA)                           62700099
           END-EXEC.                                                    62710099
                                                                        62720099
       7600-FORMAT-TIME.                                                62730099
                                                                        62740099
           EXEC CICS                                                    62750099
               ASKTIME ABSTIME (PV-ABSTIME)                             62760099
           END-EXEC.                                                    62770099
                                                                        62780099
           EXEC CICS                                                    62790099
               FORMATTIME ABSTIME  (PV-ABSTIME)                         62800099
                          MMDDYY   (DP132O-RUN-DATE)                    62810099
                          DATESEP  ('/')                                62820099
                          TIME     (DP132O-RUN-TIME)                    62830099
                          TIMESEP  (':')                                62840099
           END-EXEC.                                                    62850099
                                                                        62860099
       EJECT                                                            62870099
       7700-PRINT-HEADINGS.                                             62880099
           ADD 1                       TO PV-PAGE-COUNT.                62890099
           MOVE PV-PAGE-COUNT          TO DP132O-PAGE-NUMBER.           62900099
           MOVE DP132O-STANDRD-HEADER-132-COLS                          62910099
                                       TO DRS01-COMM-DATA.              62920099
           MOVE PC-TOP-OF-PAGE         TO DRS01-COMM-CTL.               62930099
           PERFORM 7500-LINK-TO-DRS.                                    62940099
                                                                        62950099
           MOVE HL2-HEADING-LINE-2     TO DRS01-COMM-DATA.              62960099
           MOVE PC-SINGLE-SPACE        TO DRS01-COMM-CTL.               62970099
           PERFORM 7500-LINK-TO-DRS.                                    62980099
                                                                        62990099
           MOVE HL3-HEADING-LINE-3     TO DRS01-COMM-DATA.              63000099
           MOVE PC-SINGLE-SPACE        TO DRS01-COMM-CTL.               63010099
           PERFORM 7500-LINK-TO-DRS.                                    63020099
                                                                        63030099
           MOVE BL-BLANK-LINE          TO DRS01-COMM-DATA.              63040099
           MOVE PC-SINGLE-SPACE        TO DRS01-COMM-CTL.               63050099
           PERFORM 7500-LINK-TO-DRS.                                    63060099
                                                                        63070099
           MOVE HL4-HEADING-LINE-4     TO DRS01-COMM-DATA.              63080099
           MOVE PC-SINGLE-SPACE        TO DRS01-COMM-CTL.               63090099
           PERFORM 7500-LINK-TO-DRS.                                    63100099
                                                                        63110099
           MOVE HL5-HEADING-LINE-5     TO DRS01-COMM-DATA.              63120099
           MOVE PC-SINGLE-SPACE        TO DRS01-COMM-CTL.               63130099
           PERFORM 7500-LINK-TO-DRS.                                    63140099
                                                                        63150099
           MOVE BL-BLANK-LINE          TO DRS01-COMM-DATA.              63160099
           MOVE PC-SINGLE-SPACE        TO DRS01-COMM-CTL.               63170099
           PERFORM 7500-LINK-TO-DRS.                                    63180099
                                                                        63190099
           MOVE 7                        TO PV-LINE-COUNT.              63200099
                                                                        63210099
       EJECT                                                            63210199
      *----------------------------------------------------------------*63210202
      *    DETERMINE WHETHER THERE IS A TRANSFER DISCREPANCY.          *63210302
      *----------------------------------------------------------------*63210402
                                                                        63210502
       8000-CHECK-XFER-DISCREPANCY.                                     63210602
           SET ASC-NO-DISCREPANCY (ASC-BLK-SUB ASC-ITEM-SUB) TO TRUE.   63210702
           PERFORM                                                      63210802
               WITH TEST AFTER                                          63210902
               VARYING PV-RETRY-COUNTER                                 63211002
               FROM 1 BY 1                                              63211102
               UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               63211202
                         OR (SQLCODE = ZERO)                            63211302
                         OR (SQLCODE = +100))                           63211402
      *                                                                 63211502
               EXEC SQL                                                 63211602
                   SELECT RCVD_AT_STR_NBR                               63211720
                   INTO   :TFDSCP-RCVD-AT-STR-NBR                       63211820
                   FROM   TTFDSCP D                                     63211918
                         ,TTFSTAT S                                     63212018
                   WHERE  D.XFER_DKEY_ID   = :DK-XFER-DKEY-ID  AND      63212115
                          S.XFER_DKEY_ID   = D.XFER_DKEY_ID     AND     63212215
                          S.XFER_STAT_CDE  = :PC-POS-RECEIVED-STATUS    63212323
                                                                AND     63212499
                          S.XFER_STAT_TMST = D.RCV_XFER_BEG_TMST        63212599
               END-EXEC                                                 63212602
                                                                        63212702
               EVALUATE TRUE                                            63212802
                   WHEN SQLCODE = ZERO                                  63212902
                       SET ASC-DISCREPANCY-EXISTS                       63213002
                                (ASC-BLK-SUB ASC-ITEM-SUB) TO TRUE      63213102
                   WHEN SQLCODE = +100                                  63213202
                       PERFORM 8100-CHECK-ITEM-DISCREPANCY              63213302
                   WHEN SQLCODE = -904                                  63213402
                   WHEN SQLCODE = -913                                  63213502
                       CONTINUE                                         63213602
                   WHEN OTHER                                           63213702
                       MOVE '8000-CHECK-XFER-DISCREPANCY'               63214002
                                         TO DP013-PARAGRAPH             63214102
                       MOVE 'SELECT DISCREPANCY ROW'                    63214202
                                         TO DP013-MESSAGE-TEXT (1)      63214302
                       MOVE SQLCA        TO DP013-SQLCA                 63214402
                       MOVE 'TTFDSCP'    TO DP013-DB2-TABLE-NAME (1)    63214518
                       SET DP013-DB2-ABEND                              63214602
                           DP013-XCTL-DISPLAY-RESTART                   63214702
                                         TO TRUE                        63214802
                       PERFORM DP013-0000-PROCESS-ABEND                 63214902
               END-EVALUATE                                             63215002
           END-PERFORM.                                                 63215102
      *                                                                 63215202
           IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        63215302
               MOVE '8000-CHECK-XFER-DISCREPANCY'                       63215402
                                         TO DP013-PARAGRAPH             63215502
               MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     63215602
                                         TO DP013-MESSAGE-TEXT (1)      63215702
               MOVE 'DISCREPANCY DATA'   TO DP013-MESSAGE-TEXT (2)      63215826
               MOVE SQLCA                TO DP013-SQLCA                 63215902
               MOVE 'TTFDSCP'            TO DP013-DB2-TABLE-NAME (1)    63216018
               SET DP013-DB2-ABEND                                      63216102
                   DP013-XCTL-DISPLAY-RESTART                           63216202
                                         TO TRUE                        63216302
               PERFORM DP013-0000-PROCESS-ABEND                         63216402
           END-IF.                                                      63216502
       EJECT                                                            63216602
      *----------------------------------------------------------------*63216702
      *    DETERMINE WHETHER THERE IS A TRANSFER ITEM DISCREPANCY.     *63216802
      *----------------------------------------------------------------*63216902
                                                                        63217002
       8100-CHECK-ITEM-DISCREPANCY.                                     63217102
           PERFORM                                                      63217202
               WITH TEST AFTER                                          63217302
               VARYING PV-RETRY-COUNTER                                 63217402
               FROM 1 BY 1                                              63217502
               UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               63217602
                         OR (SQLCODE = ZERO)                            63217702
                         OR (SQLCODE = +100))                           63217802
      *                                                                 63217902
               EXEC SQL                                                 63218002
                   SELECT DISTINCT R.XFER_DKEY_ID                       63218120
                   INTO   :TFITRC-XFER-DKEY-ID                          63218220
                   FROM                                                 63218302
                         TTFITRC R                                      63218402
                       , TTFSTAT S                                      63218502
                   WHERE                                                63218602
                       R.XFER_DKEY_ID    = :DK-XFER-DKEY-ID       AND   63218702
                       S.XFER_DKEY_ID    = :DK-XFER-DKEY-ID       AND   63218802
                       S.XFER_STAT_CDE   = :PC-POS-RECEIVED-STATUS AND  63218902
                       S.XFER_STAT_TMST  = R.XFER_RCPT_TMST        AND  63219002
                       R.XFER_ITM_DSCRP_IND = 'Y'                       63219199
               END-EXEC                                                 63219202
                                                                        63219302
               EVALUATE TRUE                                            63219402
                   WHEN SQLCODE = ZERO                                  63219502
                       SET ASC-DISCREPANCY-EXISTS                       63219602
                                (ASC-BLK-SUB ASC-ITEM-SUB) TO TRUE      63219702
                   WHEN SQLCODE = +100                                  63219802
                   WHEN SQLCODE = -904                                  63219902
                   WHEN SQLCODE = -913                                  63220002
                       CONTINUE                                         63220102
                   WHEN OTHER                                           63220202
                       MOVE '8100-CHECK-ITEM-DISCREPANCY'               63220502
                                         TO DP013-PARAGRAPH             63220602
                       MOVE 'SELECT ITEM RECEIPT ROW'                   63220702
                                         TO DP013-MESSAGE-TEXT (1)      63220802
                       MOVE SQLCA        TO DP013-SQLCA                 63220902
                       MOVE 'TTFITRC'    TO DP013-DB2-TABLE-NAME (1)    63221018
                       MOVE 'TTFSTAT'    TO DP013-DB2-TABLE-NAME (2)    63221118
                       SET DP013-DB2-ABEND                              63221202
                           DP013-XCTL-DISPLAY-RESTART                   63221302
                                         TO TRUE                        63221402
                       PERFORM DP013-0000-PROCESS-ABEND                 63221502
               END-EVALUATE                                             63221602
           END-PERFORM.                                                 63221702
      *                                                                 63221802
           IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        63221902
               MOVE '8100-CHECK-ITEM-DISCREPANCY'                       63222002
                                         TO DP013-PARAGRAPH             63222102
               MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     63222202
                                         TO DP013-MESSAGE-TEXT (1)      63222302
               MOVE 'ITEM RECEIPT DATA'  TO DP013-MESSAGE-TEXT (2)      63222426
               MOVE SQLCA                TO DP013-SQLCA                 63222502
               MOVE 'TTFITRC'            TO DP013-DB2-TABLE-NAME (1)    63222618
               MOVE 'TTFSTAT'            TO DP013-DB2-TABLE-NAME (2)    63222718
               SET DP013-DB2-ABEND                                      63222802
                   DP013-XCTL-DISPLAY-RESTART                           63222902
                                         TO TRUE                        63223002
               PERFORM DP013-0000-PROCESS-ABEND                         63223102
           END-IF.                                                      63223202
       EJECT                                                            63223302
      *----------------------------------------------------------------*63223499
      *    ABEND PROCESSOR MODULE                                      *63223599
      *----------------------------------------------------------------*63223699
                                                                        63223799
           COPY DPPD013.                                                63223899
