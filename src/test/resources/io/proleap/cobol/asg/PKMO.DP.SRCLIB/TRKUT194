000100*-----------------------*                                                 
000200 IDENTIFICATION DIVISION.                                                 
000300*-----------------------*                                                 
000400 PROGRAM-ID.    TRKUT194.                                                 
000500 AUTHOR.        DIANE DARR.                                               
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                                  
000700 DATE-WRITTEN.  1/15/2000.                                                
000800 DATE-COMPILED.                                                           
000900*                                                                         
001000*---------------------------------------------------------------*         
001100*    THIS IS A COPY OF TRKCS196 THAT WILL BE EXECUTED IN BATCH  *         
001200*    TO PROCESS THE SQL CREATED IN  TRKCS196 AND WRITE THE      *         
001300*    OUTPUT TO A FILE INSTEAD OF TO THE SCREEN IN CICS.         *         
001400*    EVENTUALLY THERE MAY ALSO BE A REPORT PRODUCED.            *         
001500*---------------------------------------------------------------*         
001600*---------------------------------------------------------------*         
001700*    Y196 - REFER TO THE PROGRAM DOCUMENTATION (TRKCS196)       *         
001800*    FOR THE MAJORITY OF PROGRAM DOCUMENTATION.                 *         
001900* ------------------------------------------------------------  *         
002000* | FIELDS FROM THE PASSED COPYBOOK TRWS195.                 |  *         
002100* |----------------------------------------------------------|  *         
002200* | PO NUMBER               | ANY KOHL'S PO                  |  *         
002300* | DEPARTMENT              | ANY KOHL'S DEPARTMENT          |  *         
002400* | LAST XFACTORY RANGE     | FOR IMPORT ORDERS              |  *         
002500* | SHIP DATE RANGE         | FOR ALL ORDERS                 |  *         
002600* | SKU                     | ANY KOHL'S SKU                 |  *         
002700* | CLASS                   | ANY KOHL'S CLASS               |  *         
002800* | SUBCLASS                | ANY KOHL'S SUBCLASS            |  *         
002900* | OTB                     | AN OTB PERIOD                  |  *         
003000* | AD DATE                 | ANY AD EVENT DATE              |  *         
003100* | NEW STORE INDICATOR     | ANY ORDER FOR A NEW STORE      |  *         
003200* | FOB CODE                | FREE ON BOARD POINT CODE       |  *         
003300* | POE CODE                | POINT OF ENTRY CODE            |  *         
003400* | CNTRY ORG               | IMPORT COUNTRY OF ORIGIN       |  *         
003500* | CNTRY PLC               | IMPORT COUNTRY OF PLACEMENT    |  *         
003600* | VENDOR STYLE            | ANY KOHL'S VENDOR STYLE        |  *         
003700* | VENDOR NAME             | KOHL'S VENDOR                  |  *         
003800* | MAKER NAME              | A FACTORY NAME FOR IMPORT      |  *         
003900* | SEASONAL SET            | SEASONAL SET SHORT NAME        |  *         
004000* | DMM                     | DMM                            |  *         
004100* | GROUP CODE              | GROUP CODE                     |  *         
004200* | EDI INDICATOR           | ONLY POS HANDLED BY EDI        |  *         
004300* | PACK BY STORE           | A PACK BY STORE ORDER          |  *         
004400* | DIRECT STORE            | A PO FOR DIRECT STORE          |  *         
004500* | PRE TICKET              | ANY PO WITH PRE TICKETING      |  *         
004600* | PACK TYP(C,S,M,I,B)     | THE PREPACK INDICATOR          |  *         
004700* | STATUS CODE             | SELECT POS WITH ONE STATUS     |  *         
004800* | STATUS GROUP            | SELECT POS UNDER A STATUS GROUP|  *         
004900* | STORE                   | SELECT A STORE WITH ALLOCATION |  *         
005000* | PICTURED AD             | A PO PART OF A PICTURED AD     |  *         
005100* | PO TYPE                 | SELECT THE PO TYPE             |  *         
005200* ------------------------------------------------------------  *         
005300*                                                               *         
005400* ------------------------------------------------------------  *         
005500* | THE ABOVE SECTION INCLUDES THE FIXED DISPLAY AREA.       |  *         
005600* | THE NEXT GROUP INCLUDES THE VARIABLE DISPLAY AREA.       |  *         
005700* |----------------------------------------------------------|  *         
005800* | PO NUMBER               | DISPLAY OF PO IS FIXED         |  *         
005900* | DEPARTMENT              | DEPARTMENT IS ALSO FIXED       |  *         
006000* | VENDOR                  | VENDOR IS ALSO FIXED           |  *         
006100* | DMM                     | DMM IS ALSO FIXED              |  *         
006200* |----------------------------------------------------------|  *         
006300* | THE REMAINING FIELDS CAN BE INCLUDED OR EXCLUDED IN      |  *         
006400* | THE QUERY.  THE ORDER OF THE FIELDS ON THE VIRTUAL       |  *         
006500* | SCREEN ARE DICTATED BY A DEFAULT ORDER.  THE PLACEMENT   |  *         
006600* | CAN ALSO BE OVERRIDEN IN TRKCS195.                       |  *         
006700* |----------------------------------------------------------|  *         
006800* | FOB CODE                | TPLNSHP                        |  *         
006900* | POE CODE                | TPLNSHP                        |  *         
007000* | START & LAST FCTRY DATES| TPLNSHP                        |  *         
007100* | BOOKING DELIVERY        | IMPORT_DATA_CSR                |  *         
007200* | FOB RECEIPT             | IMPORT_DATA_CSR                |  *         
007300* | SAIL DATE               | IMPORT_DATA_CSR                |  *         
007400* | POE ARRIVAL             | IMPORT_DATA_CSR                |  *         
007500* | CUSTOMS RELEASE         | TIMCSEN AND TIMCSPO            |  *         
007600* | DEVAN DATE              | TIMCNTK AND TIMCNPO            |  *         
007700* | ETA TO ANY OPEN DC      | SHIP_DATA_CSR                  |  *         
007800* | DONT SHIP BEFORE DATE   | TPLNSHP                        |  *         
007900* | CANCEL DATE             | TPLNSHP                        |  *         
008000* | AD DATE                 | TPURITM                        |  *         
008100* | OPEN TO BUY             | TPURCHS                        |  *         
008200* | PACK TYPE               | TPURCHS                        |  *         
008300* | EDI INDICATOR           | TPURCHS                        |  *         
008400* | STATUS CODE             | SELECT POS WITH ONE STATUS     |  *         
008500* | DOLLARS                 | TPURCHS, TPURITM AND TRECEIV   |  *         
008600* | UNITS                   | TRECEIV                        |  *         
008700* | TRIP TYPE               | TIMCSEN/TIMCNTK                |  *         
008800* | DC SPLITS               | TIMPORL/TALLPLN                |  *         
008900* | STORE DISTRO            | TMESTDS                        |  *         
009000* | QUOTA CT                | ???????????????                |  *         
009100* | VENDOR STYLE            | XLT_VND_STYL                   |  *         
009200* | CONTAINER RELEASE DATE  | TIMCNTK                        |  *         
009300* | TRAILER AVAILABLE DATE  | TSHIPST                        |  *         
009400*-------------------------------------------------------------  *         
009500*-------------------------------------------------------------  *         
009600*                                                               *         
009700*    TO AID IN UNDERSTANDING THIS PROGRAM LOOK FOR THE          *         
009800*    FOLLOWING:                                                 *         
009900*                                                               *         
010000*    1. ANY TEXT: "#VARIABLE_LOGIC_GROUP_#" DESCRIBES THE       *         
010100*    SPECIAL PROGRAM LOGIC FOR HANDLING THE VARIABLE SCREEN     *         
010200*    PROCESSING.                                                *         
010300*                                                               *         
010400*    2. PROGRAM CODE WITH TEXT: "#VERY_IMPORTANT"               *         
010500*    SHOULD BE HANDLED WITH EXTREME CARE.                       *         
010600*                                                               *         
010700*    3. COMMENTS  WITH THE NAME "#TIP" AID IN DESCRIBING        *         
010800*    MAINTENANCE REQUIREMENTS.                                  *         
010900*                                                               *         
011000* ------------------------------------------------------------  *         
011100* | DOCUMENTATION ON GROUP 1 CODE                            |  *         
011200* |----------------------------------------------------------|  *         
011300* | GROUP 1 CODE IS CALLED IN THE BEGINNING DURING THE       |  *         
011400* | CALL TO 1100-PROCESS-INTER-APPL-COMM.                    |  *         
011500* | THE MAIN PURPOSE OF GROUP 1 CODE IS TO INTEROGATE THE    |  *         
011600* | PASSED SELECTION CRITERIA, DISPLAY CRITERIA AND          |  *         
011700* | SETTING UP THE PAGING OF THE VIRTUAL SCREENS.            |  *         
011800* | THE OUTPUT OF GROUP 1 IS ULTIMATELY A SORTED             |  *         
011900* | TABLE OF THE DISPLAY CONTROL VARIABLES.                  |  *         
012000* |----------------------------------------------------------|  *         
012100* | PARAGRAPHS CALLED IN GROUP 1.                            |  *         
012200* |----------------------------------------------------------|  *         
012300* | LVL 0=  1100-PROCESS-INTER-APPL-COMM (ARCHITECTURE)      |  *         
012400* |      1=    9410-SETUP-VARIABLE-PARAMETERS                |  *         
012500* |       2=      9420-SORT-VARIABLE-CNTL-TABLE              |  *         
012600* |----------------------------------------------------------|  *         
012700* |----------------------------------------------------------|  *         
012800* | DOCUMENTATION ON GROUP 2 CODE                            |  *         
012900* |----------------------------------------------------------|  *         
013000* | GROUP 2 CONTAINS THE MOST CODE FOR HANDLING THE          |  *         
013100* | VARIABLE LOGIC. THE FIRST PART OF THE VARIABLE PART      |  *         
013200* | BEGINS IN 2100-CHECK-FUNCTION-KEY.                       |  *         
013300* |----------------------------------------------------------|  *         
013400* | PARAGRAPHS CALLED IN GROUP 2.                            |  *         
013500* |----------------------------------------------------------|  *         
013600* | LVL 0=     2100-CHECK-FUNCTION-KEY (ARCHITECTURE)        |  *         
013700* | LVL 0=     4400-MOVE-COMMAREA-TO-SCREEN (ARCHITECTURE)   |  *         
013800* |      1=       9500-FORMAT-VARIABLE-DATA                  |  *         
013900* |       2=         10000-REBUILD-CONTROL-TABLES            |  *         
014000* |       2=         9510-PREPARE-VFLD-FOR-DISPLAY           |  *         
014100* |        3=           9530-BUILD-HEADER-SCREEN-AREA        |  *         
014200* |         4=             9550-MOVE-VDATA-TO-SCREEN         |  *         
014300* |      1=       4420-FORMAT-LIST-LINES (ARCHITECTURE)      |  *         
014400* |       2=         9500-FORMAT-VARIABLE-DATA               |  *         
014500* |        3=           10000-REBUILD-CONTROL-TABLES         |  *         
014600* |        3=           9510-PREPARE-VFLD-FOR-DISPLAY        |  *         
014700* |         4=             9520-BUILD-LIST-SCREEN-AREA       |  *         
014800* |          5=               9550-MOVE-VDATA-TO-SCREEN      |  *         
014900* |      1=       9500-FORMAT-VARIABLE-DATA                  |  *         
015000* |       2=         10000-REBUILD-CONTROL-TABLES            |  *         
015100* |       2=         9510-PREPARE-VFLD-FOR-DISPLAY           |  *         
015200* |        3=           9540-BUILD-TOTAL-SCREEN-AREA         |  *         
015300* |         4=             9550-MOVE-VFLD-TO-SCREEN          |  *         
015400* ------------------------------------------------------------  *         
CICS  * CHANGED 11/18/2022    BY JIM HUNTER      WR: CHG0278495                 
CICS  * THIS PROGRAM DOES NOT CALL THE CICS ARCHITECTURE - REMOVE               
CICS  * COPYBOOK DPWS030, WHICH WAS ALREADY COMMENTED OUT.                      
CICS  *-----------------------------------------------------------------        
015500                                                                          
015600 ENVIRONMENT DIVISION.                                                    
015700                                                                          
015800 CONFIGURATION SECTION.                                                   
015900                                                                          
016000 SOURCE-COMPUTER.        IBM-3090.                                        
016100 OBJECT-COMPUTER.        IBM-3090.                                        
016200                                                                          
016300 INPUT-OUTPUT SECTION.                                                    
016400                                                                          
016500 FILE-CONTROL.                                                            
016600                                                                          
016700     SELECT TR196-SQL-STATEMENT                                           
016800         ASSIGN TO INP01.                                                 
016900                                                                          
017000     SELECT TR196-SELECTIONS                                              
017100         ASSIGN TO INP02.                                                 
017200                                                                          
017300     SELECT TR194-EXCEL-FILE                                              
017400         ASSIGN TO OUT01.                                                 
017500                                                                          
017600                                                                          
017700 DATA DIVISION.                                                           
017800                                                                          
017900 FILE SECTION.                                                            
018000                                                                          
018100 FD  TR196-SQL-STATEMENT                                                  
018200     RECORDING MODE IS F                                                  
018300     LABEL RECORDS ARE STANDARD                                           
018400     BLOCK CONTAINS 0 RECORDS                                             
018500     RECORD CONTAINS 80 CHARACTERS                                        
018600     DATA RECORD IS TR196-SQLSTMT-RECORD.                                 
018700                                                                          
018800 01  TR196-SQLSTMT-RECORD            PIC X(80).                           
018900                                                                          
019000 FD  TR196-SELECTIONS                                                     
019100     RECORDING MODE IS F                                                  
019200     LABEL RECORDS ARE STANDARD                                           
019300     BLOCK CONTAINS 0 RECORDS                                             
019400     RECORD CONTAINS 80 CHARACTERS                                        
019500     DATA RECORD IS TR196-SLCTION-RECORD.                                 
019600                                                                          
019700 01  TR196-SLCTION-RECORD            PIC X(80).                           
019800                                                                          
019900 FD  TR194-EXCEL-FILE                                                     
020000     RECORDING MODE IS F                                                  
020100     LABEL RECORDS ARE STANDARD                                           
020200     BLOCK CONTAINS 0 RECORDS                                             
020300     RECORD CONTAINS 500 CHARACTERS                                       
020400     DATA RECORD IS TR194-EXCEL-RECORD.                                   
020500                                                                          
020600 01  TR194-EXCEL-RECORD              PIC X(500).                          
020700                                                                          
020800                                                                          
020900 WORKING-STORAGE SECTION.                                                 
021000                                                                          
021100 01  DK-DB2-KEYS.                                                         
021200     05  DK-PO-NBR                 PIC S9(9) COMP VALUE +0.               
021300     05  DK-SHIPT-ID               PIC S9(9) COMP VALUE +0.               
021400     05  DK-SHIPT-ID-NULL          PIC S9(4) COMP VALUE +0.               
021500     05  DK-OPER-UNT-ID            PIC S9(4) COMP VALUE +0.               
021600     05  DK-CL-NBR-BEG             PIC X(2)  VALUE SPACES.                
021700     05  DK-CL-NBR-END             PIC X(2)  VALUE SPACES.                
021800     05  DK-STR-NBR                PIC S9(04) COMP VALUE +0.              
021900     05  DK-AGRMT-TYP-ID           PIC X(01)  VALUE SPACES.               
022000     05  DK-TYP-CDE                PIC S9(04) VALUE +0                    
022100                                              COMP.                       
022200 01  PC-PROGRAM-CONSTANTS.                                                
022300     05  PC-CURRENT-PROGRAM-NAME        PIC  X(08)  VALUE                 
022400                                                    'TRKUT194'.           
022500     05  PC-LIST-QUEUE-SEQ              PIC  9(01)  VALUE 1.              
022600     05  PC-SEL-QUEUE-SEQ               PIC  9(01)  VALUE 2.              
022700     05  PC-PO-QUEUE-SEQ                PIC  9(01)  VALUE 3.              
022800     05  PC-EXTENDED-QUEUE-SEQ          PIC  9(01)  VALUE 4.              
022900     05  PC-LIST-FORMAT                 PIC  X(01)  VALUE '1'.            
023000     05  PC-PO-CRIT-SUMM-FORMAT         PIC  X(01)  VALUE '2'.            
023100     05  PC-ITEMS-PER-PANEL             PIC S9(04)  VALUE +13             
023200                                                    COMP SYNC.            
023300     05  PC-MAX-BLOCKS-IN-ARRAY         PIC S9(04)  VALUE +2              
023400                                                    COMP SYNC.            
023500     05  PC-MAX-ITEMS                   PIC S9(09)  VALUE                 
023600                                                    +1000000              
023700                                                    COMP-3.               
023800     05  PC-MAX-GROUPS                  PIC S9(09)  VALUE                 
023900                                                    +1                    
024000                                                    COMP-3.               
024100     05  PC-MSG-NUMBER-LENGTH           PIC S9(04)  VALUE +5              
024200                                                    COMP SYNC.            
024300     05  PC-MAX-RETRIES                 PIC S9(03)  VALUE 3               
024400                                                    COMP-3.               
024500     05  PC-INIT-DATE                   PIC  X(10)  VALUE                 
024600                                                    '0001-01-01'.         
024700     05  PC-INQ                         PIC  X(03)  VALUE 'INQ'.          
024800     05  PC-CNT-MINUS-2                 PIC S9(04)  VALUE -2              
024900                                                    COMP SYNC.            
025000     05  PC-CNT-6                       PIC S9(04)  VALUE +6              
025100                                                    COMP SYNC.            
025200     05  PC-CNT-7                       PIC S9(04)  VALUE +7              
025300                                                    COMP SYNC.            
025400     05  PC-A                           PIC  X(01)  VALUE 'A'.            
025500     05  PC-E                           PIC  X(01)  VALUE 'E'.            
025600     05  PC-N                           PIC  X(01)  VALUE 'N'.            
025700     05  PC-O                           PIC  X(01)  VALUE 'O'.            
025800     05  PC-R                           PIC  X(01)  VALUE 'R'.            
025900     05  PC-Y                           PIC  X(01)  VALUE 'Y'.            
026000     05  PC-AJ                          PIC  X(02)  VALUE 'AJ'.           
026100     05  PC-AIR                         PIC  X(03)  VALUE 'AIR'.          
026200     05  PC-ACT                         PIC  X(03)  VALUE 'ACT'.          
026300     05  PC-CMP                         PIC  X(03)  VALUE 'CMP'.          
026400     05  PC-OCEAN                       PIC  X(03)  VALUE 'OCN'.          
026500     05  PC-MULTI                       PIC  X(05)  VALUE                 
026600                                                    'MULTI'.              
026700     05  PC-PERCENT                     PIC  X(01)  VALUE '%'.            
026800     05  PC-SEL                         PIC  X(01)  VALUE 'Y'.            
026900     05  PC-QUOTE                       PIC  X(01)  VALUE X'7D'.          
027000     05  PC-DELIMITER                   PIC  X(01)  VALUE '~'.            
027100     05  PC-ITEMS-PER-PO-QUEUE          PIC S9(04)  VALUE +26             
027200                                                    COMP SYNC.            
027300     05  PC-MAX-VFLDS-LIMIT             PIC  9(02)  VALUE 47.             
027400     05  PC-MAX-DATA-VFLD-LENGTH        PIC  9(02)  VALUE 14.             
027500     05  PC-FIRST-FIELD                 PIC  9(02)  VALUE 1.              
027600     05  PC-SPACES                      PIC  X(500) VALUE ' '.            
027700     05  PC-DASH                        PIC  X(01)  VALUE '-'.            
027800     05  PC-SCREEN-WIDTH                PIC 999  VALUE 500.               
027900     05  PC-DCSTORE-LIMIT               PIC  99  VALUE 12.                
028000     05  PC-FIRST-VSCREEN               PIC  99  VALUE 1.                 
028100     05  PC-TRIP                        PIC  X  VALUE '1'.                
028200     05  PC-DEVAN                       PIC  X  VALUE '2'.                
028300     05  PC-LABEL                       PIC  X(20)                        
028400                               VALUE 'TOTALS FOR LIST---->'.              
028500                                                                          
028600*---------------------------------------------------------------*         
028700* #VERY_IMPORTANT  ===>                                         *         
028800* THE ORDER BELOW MUST ALWAYS MATCH PV-VARIABLE-DATA-FIELDS     *         
028900* AND THE DISPLAY CONTROL FIELDS IN PV-VARIABLE-CONTROL-FIELDS. *         
029000* IF NOT UNPREDICTABLE RESULTS WILL OCCUR.                      *         
029100*                                                               *         
029200* FURTHERMORE THE ORDER OF THE LIST BELOW DOES NOT CONTROL      *         
029300* THE ORDER A FIELD IS DISPLAYED IN THE VARIABLE VIEW.          *         
029400*---------------------------------------------------------------*         
029500     05  PC-VFLD-FOB-I                  PIC  9(03)  VALUE 1.              
029600     05  PC-VFLD-POE-I                  PIC  9(03)  VALUE 2.              
029700     05  PC-VFLD-DSB-I                  PIC  9(03)  VALUE 3.              
029800     05  PC-VFLD-SXF-I                  PIC  9(03)  VALUE 4.              
029900     05  PC-VFLD-LXF-I                  PIC  9(03)  VALUE 5.              
030000     05  PC-VFLD-CNL-I                  PIC  9(03)  VALUE 6.              
030100     05  PC-VFLD-FRD-I                  PIC  9(03)  VALUE 7.              
030200     05  PC-VFLD-SLD-I                  PIC  9(03)  VALUE 8.              
030300     05  PC-VFLD-PRD-I                  PIC  9(03)  VALUE 9.              
030400     05  PC-VFLD-CNT-I                  PIC  9(03)  VALUE 10.             
030500     05  PC-VFLD-CSR-I                  PIC  9(03)  VALUE 11.             
030600     05  PC-VFLD-DC1-I                  PIC  9(03)  VALUE 12.             
030700     05  PC-VFLD-DC2-I                  PIC  9(03)  VALUE 13.             
030800     05  PC-VFLD-DC3-I                  PIC  9(03)  VALUE 14.             
030900     05  PC-VFLD-DC4-I                  PIC  9(03)  VALUE 15.             
031000     05  PC-VFLD-DC5-I                  PIC  9(03)  VALUE 16.             
031100     05  PC-VFLD-DC6-I                  PIC  9(03)  VALUE 17.             
031200     05  PC-VFLD-DC7-I                  PIC  9(03)  VALUE 18.             
031300     05  PC-VFLD-DC8-I                  PIC  9(03)  VALUE 19.             
031400     05  PC-VFLD-DC9-I                  PIC  9(03)  VALUE 20.             
031500     05  PC-VFLD-DC10-I                 PIC  9(03)  VALUE 21.             
031600     05  PC-VFLD-DC11-I                 PIC  9(03)  VALUE 22.             
031700     05  PC-VFLD-DC12-I                 PIC  9(03)  VALUE 23.             
031800     05  PC-VFLD-DVN-I                  PIC  9(03)  VALUE 24.             
031900     05  PC-VFLD-BKD-I                  PIC  9(03)  VALUE 25.             
032000     05  PC-VFLD-FSC-I                  PIC  9(03)  VALUE 26.             
032100     05  PC-VFLD-TTC-I                  PIC  9(03)  VALUE 27.             
032200     05  PC-VFLD-TVC-I                  PIC  9(03)  VALUE 28.             
032300     05  PC-VFLD-UOR-I                  PIC  9(03)  VALUE 29.             
032400     05  PC-VFLD-URC-I                  PIC  9(03)  VALUE 30.             
032500     05  PC-VFLD-URP-I                  PIC  9(03)  VALUE 31.             
032600     05  PC-VFLD-DOR-I                  PIC  9(03)  VALUE 32.             
032700     05  PC-VFLD-DRC-I                  PIC  9(03)  VALUE 33.             
032800     05  PC-VFLD-DRP-I                  PIC  9(03)  VALUE 34.             
032900     05  PC-VFLD-OTB-I                  PIC  9(03)  VALUE 35.             
033000     05  PC-VFLD-EDI-I                  PIC  9(03)  VALUE 36.             
033100     05  PC-VFLD-PPK-I                  PIC  9(03)  VALUE 37.             
033200     05  PC-VFLD-STA-I                  PIC  9(03)  VALUE 38.             
033300     05  PC-VFLD-AED-I                  PIC  9(03)  VALUE 39.             
033400     05  PC-VFLD-TRP-I                  PIC  9(03)  VALUE 40.             
033500     05  PC-VFLD-SPL-CRT-I              PIC  9(03)  VALUE 41.             
033600     05  PC-VFLD-SPL-SNT-I              PIC  9(03)  VALUE 42.             
033700     05  PC-VFLD-STD-I                  PIC  9(03)  VALUE 43.             
033800     05  PC-VFLD-QCT-I                  PIC  9(03)  VALUE 44.             
033900     05  PC-VFLD-VNS-I                  PIC  9(03)  VALUE 45.             
034000     05  PC-VFLD-CRL-I                  PIC  9(03)  VALUE 46.             
034100     05  PC-VFLD-TRA-I                  PIC  9(03)  VALUE 47.             
034200                                                                          
034300 01  PS-PROGRAM-SWITCHES.                                                 
034400     05  PS-ERROR-SW                    PIC  X(01)  VALUE 'Y'.            
034500         88  PS-NO-ERROR                            VALUE 'Y'.            
034600         88  PS-ERROR                               VALUE 'N'.            
034700     05  PS-LIST-SW                     PIC  X(01)  VALUE 'N'.            
034800         88  PS-LIST-END                            VALUE 'Y'.            
034900         88  PS-NO-LIST-END                         VALUE 'N'.            
035000     05  PS-COMMAREA-SW                 PIC  X(01)  VALUE 'N'.            
035100         88  PS-COMMAREA-VALID                      VALUE 'Y'.            
035200         88  PS-COMMAREA-NOT-VALID                  VALUE 'N'.            
035300     05  PS-DONE-SW                     PIC  X(01)  VALUE 'N'.            
035400         88  PS-DONE                                VALUE 'Y'.            
035500         88  PS-NOT-DONE                            VALUE 'N'.            
035600     05  PS-BKR-FRGT-RLSE-SW            PIC  X(01)  VALUE 'N'.            
035700         88  PS-BKR-FRGT-RLSE                       VALUE 'Y'.            
035800         88  PS-BKR-FRGT-RLSE-NO                    VALUE 'N'.            
035900     05  PS-SKIP-SW                     PIC  X(01)  VALUE 'N'.            
036000         88  PS-DONT-SKIP                           VALUE 'N'.            
036100         88  PS-SKIP                                VALUE 'Y'.            
036200     05  PS-PURITM-SW                   PIC  X(01)  VALUE 'Y'.            
036300         88  PS-206-PURITM                          VALUE 'Y'.            
036400         88  PS-000-PURITM                          VALUE 'N'.            
036500     05  PS-TPURITM-SW                  PIC  X(01)  VALUE 'N'.            
036600         88  PS-DONT-USE-TPURITM                    VALUE 'N'.            
036700         88  PS-USE-TPURITM                         VALUE 'Y'.            
036800     05  PS-XFC-INLINE-SW               PIC  X(01)  VALUE 'N'.            
036900         88  PS-DONT-USE-XFC-INLINE                 VALUE 'N'.            
037000         88  PS-USE-XFC-INLINE                      VALUE 'Y'.            
037100     05  PS-DSB-INLINE-SW               PIC  X(01)  VALUE 'N'.            
037200         88  PS-DONT-USE-DSB-INLINE                 VALUE 'N'.            
037300         88  PS-USE-DSB-INLINE                      VALUE 'Y'.            
037400     05  PS-TENTNME-SW                  PIC  X(01)  VALUE 'N'.            
037500         88  PS-DONT-USE-TENTNME                    VALUE 'N'.            
037600         88  PS-USE-TENTNME                         VALUE 'Y'.            
037700     05  PS-TMDSEAR-SW                  PIC  X(01)  VALUE 'N'.            
037800         88  PS-DONT-USE-TMDSEAR                    VALUE 'N'.            
037900         88  PS-USE-TMDSEAR                         VALUE 'Y'.            
038000     05  PS-TSK-SW                      PIC  X(01)  VALUE 'N'.            
038100         88  PS-DONT-USE-TSK                        VALUE 'N'.            
038200         88  PS-USE-TSK                             VALUE 'Y'.            
038300     05  PS-DISP-CNTL1-SW               PIC  X(01)  VALUE ' '.            
038400         88  BUILD-HEADER-1                         VALUE '1'.            
038500         88  BUILD-HEADER-2                         VALUE '2'.            
038600         88  BUILD-LINE                             VALUE '3'.            
038700         88  BUILD-TOTAL                            VALUE '4'.            
038800     05  PS-DISP-CNTL2-SW               PIC  X(01)  VALUE ' '.            
038900         88  DISPLAY-HEADER                         VALUE 'H'.            
039000         88  DISPLAY-LIST                           VALUE 'D'.            
039100         88  DISPLAY-TOTAL                          VALUE 'T'.            
039200     05  PS-DISP-CNTL3-SW               PIC  X(01)  VALUE 'N'.            
039300         88  DO-SCREEN-DIMENSION                    VALUE 'Y'.            
039400         88  NO-SCREEN-DIMENSION                    VALUE 'N'.            
039500     05  PS-DISP-CNTL4-SW               PIC  X(01)  VALUE 'N'.            
039600         88  FIRST-FIELD                            VALUE 'Y'.            
039700         88  NOT-FIRST-FIELD                        VALUE 'N'.            
039800     05  PS-TABLE-SELPO-SW              PIC X(03)  VALUE 'NO '.           
039900         88  MORE-SELPO-DATA                       VALUE 'YES'.           
040000         88  NO-MORE-SELPO-DATA                    VALUE 'NO '.           
040100     05  PS-TABLE-LISTPO-SW             PIC X(03) VALUE 'NO '.            
040200         88  MORE-CURSOR-DATA                      VALUE 'YES'.           
040300         88  NO-MORE-CURSOR-DATA                   VALUE 'NO '.           
040400     05  PS-TABLE-STORE-SW              PIC X(03)  VALUE 'NO '.           
040500         88  MORE-STORE-DATA                       VALUE 'YES'.           
040600         88  NO-MORE-STORE-DATA                    VALUE 'NO '.           
040700     05  PS-DISPLAY-DC-SPLITS-SW        PIC  X(01)  VALUE 'N'.            
040800         88  PS-DISPLAY-DC-SPLITS                   VALUE 'Y'.            
040900         88  PS-DISPLAY-DC-SPLITS-NO                VALUE 'N'.            
041000     05  PS-EOC-DC-SPLITS-SW           PIC  X(01)    VALUE 'N'.           
041100         88  PS-EOC-DC-SPLITS                        VALUE 'Y'.           
041200         88  PS-EOC-DC-SPLITS-NO                     VALUE 'N'.           
041300     05  PS-EOF-SQL-STMT-SW            PIC  X(01)    VALUE 'N'.           
041400         88  PS-EOF-SQL-STMT                         VALUE 'Y'.           
041500     05  PS-DC-SPLT-ORD-SNT-DTE-SW      PIC X(01)  VALUE 'N'.             
041600         88  PS-DC-SPLT-ORD-SNT-DTE                VALUE 'Y'.             
041700         88  PS-DC-SPLT-ORD-SNT-DTE-NO             VALUE 'N'.             
041800     05  PS-DC-SPLT-SHPT-SNT-DTE-SW     PIC X(01)  VALUE 'N'.             
041900         88  PS-DC-SPLT-SHPT-SNT-DTE               VALUE 'Y'.             
042000         88  PS-DC-SPLT-SHPT-SNT-DTE-NO            VALUE 'N'.             
042100                                                                          
042200                                                                          
042300 01  PV-PROGRAM-VARIABLES.                                                
042400     05  PV-SUB                         PIC S9(04)  VALUE +0              
042500                                                    COMP SYNC.            
042600     05  PV-REMAINDER                   PIC S9(04)  VALUE +0              
042700                                                    COMP SYNC.            
042800     05  PV-SELECT-BYTES                PIC S9(04)  VALUE +137            
042900                                                    COMP SYNC.            
043000     05  PV-STRING-POINTER-SELECT       PIC S9(04)  VALUE +0              
043100                                                    COMP   SYNC.          
043200     05  PV-STRING-POINTER-FROM         PIC S9(04)  VALUE +0              
043300                                                    COMP   SYNC.          
043400     05  PV-STRING-POINTER-WHERE        PIC S9(04)  VALUE +0              
043500                                                    COMP   SYNC.          
043600     05  PV-TALLY-1                     PIC S9(04)  VALUE +0              
043700                                                    COMP   SYNC.          
043800     05  PV-TALLY-2                     PIC S9(04)  VALUE +0              
043900                                                    COMP   SYNC.          
044000     05  PV-READ-COUNT                  PIC S9(09)  VALUE +0              
044100                                                    COMP-3.               
044200     05  WS-WRITE-COUNT                 PIC S9(09)  VALUE +0              
044300                                                    COMP-3.               
044400     05  PV-PO-COUNT                    PIC S9(09)  VALUE +0              
044500                                                    COMP-3.               
044600     05  PV-ITEMS-PROCESSED             PIC S9(09)  VALUE +0              
044700                                                    COMP-3.               
044800     05  PV-HOLD-SELECTED-ITEMS         PIC S9(09)  VALUE +0              
044900                                                    COMP-3.               
045000     05  PV-ITEM-IN-USE                 PIC S9(09)  VALUE +0              
045100                                                    COMP-3.               
045200     05  PV-TOP-ITEM                    PIC S9(09)  VALUE +0              
045300                                                    COMP-3.               
045400     05  PV-BOTTOM-ITEM                 PIC S9(09)  VALUE +0              
045500                                                    COMP-3.               
045600     05  PV-MAX-ITEMS                   PIC S9(09)  VALUE +0              
045700                                                    COMP-3.               
045800     05  PV-TEMP-NUM                    PIC S9(09)  VALUE +0              
045900                                                    COMP-3.               
046000     05  PV-GROUPS-TO-READ              PIC S9(09)  VALUE +0              
046100                                                    COMP-3.               
046200     05  PV-TEMP-BLOCK-NUMBER           PIC S9(09)  VALUE +0              
046300                                                    COMP-3.               
046400     05  PV-BLOCK-NUMBER                PIC S9(04)  VALUE +0              
046500                                                    COMP SYNC.            
046600     05  PV-CICS-RESP                   PIC S9(04)  VALUE +0              
046700                                                    COMP SYNC.            
046800     05  ABEND-CODE                     PIC S9(04)  VALUE +0              
046900                                                    COMP SYNC.            
047000     05  PV-ITEM                        PIC S9(04)  VALUE +0              
047100                                                    COMP SYNC.            
047200     05  PV-SEL-QUEUE-ITEM              PIC S9(04)  VALUE +0              
047300                                                    COMP SYNC.            
047400     05  PV-SAVE-ITEM                   PIC S9(04)  VALUE +0              
047500                                                    COMP SYNC.            
047600     05  PV-HIGHEST-BLOCK-WRITTEN       PIC S9(04)  VALUE +0              
047700                                                    COMP SYNC.            
047800     05  PV-LIST-ITEM-NUMBER            PIC S9(04)  VALUE +0              
047900                                                    COMP SYNC.            
048000     05  PV-FIRST-BLOCK-IN-ARRAY        PIC S9(04)  VALUE +0              
048100                                                    COMP SYNC.            
048200     05  PV-NEXT-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0              
048300                                                    COMP SYNC.            
048400     05  PV-PREV-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0              
048500                                                    COMP SYNC.            
048600     05  PV-FIRST-BLOCK-IN-RANGE        PIC S9(04)  VALUE +0              
048700                                                    COMP SYNC.            
048800     05  PV-LAST-BLOCK-IN-RANGE         PIC S9(04)  VALUE +0              
048900                                                    COMP SYNC.            
049000     05  PV-START-OF-SELECTED-RANGE     PIC S9(04)  VALUE +0              
049100                                                    COMP SYNC.            
049200     05  PV-END-OF-SELECTED-RANGE       PIC S9(04)  VALUE +0              
049300                                                    COMP SYNC.            
049400     05  PV-SQL-SUB                     PIC S9(04)  VALUE +0              
049500                                                    COMP SYNC.            
049600*    05  PV-RETRY-COUNTER               PIC S9(04)  VALUE +0              
049700*                                                   COMP SYNC.            
049800     05  PV-TEMP-PO-NBR                 PIC 9(09) VALUE ZEROS.            
049900     05  PV-NULL-IND                    PIC S9(04)  VALUE +0 COMP.        
050000     05  PV-NULL-IND-1                  PIC S9(04)  VALUE +0 COMP.        
050100     05  PV-NULL-IND-2                  PIC S9(04)  VALUE +0 COMP.        
050200     05  PV-NULL-IND-3                  PIC S9(04)  VALUE +0 COMP.        
050300     05  PV-NULL-IND-4                  PIC S9(04)  VALUE +0 COMP.        
050400     05  PV-I                           PIC S9(09)  VALUE +0              
050500                                                    COMP-3.               
050600     05  PV-J                           PIC S9(09)  VALUE +0              
050700                                                    COMP-3.               
050800     05  PV-DC-I                        PIC S9(09)  VALUE +0              
050900                                                    COMP-3.               
051000     05  PV-INCREMENT                   PIC S9(09)  VALUE +0              
051100                                                    COMP-3.               
051200     05  PV-INDEX                       PIC S9(09)  VALUE +0              
051300                                                    COMP-3.               
051400     05  PV-DB2-COUNT                   PIC S9(09)  VALUE +0              
051500                                                    COMP-3.               
051600     05  PV-DB2-COUNT2                  PIC S9(09)  VALUE +0              
051700                                                    COMP-3.               
051800     05  PV-GP-DOLLARS-RECEIVED         PIC S9(15)V99 COMP-3.             
051900     05  PV-TOT-FIRST-COST              PIC S9(9)V99 COMP-3.              
052000     05  PV-TOT-TTC                     PIC S9(9)V99 COMP-3.              
052100     05  PV-TOT-TVC                     PIC S9(9)V99 COMP-3.              
052200     05  PV-TOTAL-CURR-SPLIT-QTY        PIC  S9(13)  VALUE +0             
052300                                                     COMP-3.              
052400     05  PV-TOTAL-CURR-SPLIT-QTY-NULL   PIC S9(04)   VALUE +0             
052500                                                     COMP.                
052600     05  PV-WORK-DT                     PIC X(8).                         
052700     05  PV-WORK-ETA-ATA                PIC X(02).                        
052800     05  PV-WORK-ETA-ATA-DC1            PIC X(02).                        
052900     05  PV-WORK-ETA-ATA-DC2            PIC X(02).                        
053000     05  PV-WORK-ETA-ATA-DC3            PIC X(02).                        
053100     05  PV-WORK-ETA-ATA-DC4            PIC X(02).                        
053200     05  PV-WORK-ETA-ATA-DC5            PIC X(02).                        
053300     05  PV-WORK-ETA-ATA-DC6            PIC X(02).                        
053400     05  PV-WORK-ETA-ATA-DC7            PIC X(02).                        
053500     05  PV-WORK-ETA-ATA-DC8            PIC X(02).                        
053600     05  PV-WORK-ETA-ATA-DC9            PIC X(02).                        
053700     05  PV-WORK-ETA-ATA-DC10           PIC X(02).                        
053800     05  PV-WORK-ETA-ATA-DC11           PIC X(02).                        
053900     05  PV-WORK-ETA-ATA-DC12           PIC X(02).                        
054000     05  PV-WORK-OTB                    PIC X(6).                         
054100     05  PV-DATE                        PIC X(5).                         
054200     05  FILLER REDEFINES PV-DATE.                                        
054300         10  PV-DATE-MONTH              PIC XX.                           
054400         10  PV-DATE-SLASH              PIC X.                            
054500         10  PV-DATE-DAY                PIC XX.                           
054600     05  PV-DATE-FIELD.                                                   
054700         10 PV-DT-MM                    PIC  X(02).                       
054800         10 PV-DT-DD                    PIC  X(02).                       
054900         10 PV-DT-CC                    PIC  X(02).                       
055000         10 PV-DT-YY                    PIC  X(02).                       
055100     05  PV-TABLE-QUALIFIER.                                              
055200         10 FILLER                      PIC X(03) VALUE 'DB2'.            
055300         10 PV-QUALIFIER                PIC X(01) VALUE ' '.              
055400         10 FILLER                      PIC X(03) VALUE 'DBA'.            
055500         10 FILLER                      PIC X(01) VALUE '.'.              
055600     05  PV-TABLE-QUALIFIER-COMMA.                                        
055700         10 FILLER                      PIC X(04) VALUE ',DB2'.           
055800         10 PV-QUALIFIER-COMMA          PIC X(01) VALUE ' '.              
055900         10 FILLER                      PIC X(03) VALUE 'DBA'.            
056000         10 FILLER                      PIC X(01) VALUE '.'.              
056100                                                                          
056200*    05  PV-CICS-MSG-SQL1               PIC X(120) VALUE SPACE.           
056300*    05  PV-CICS-MSG-SQL2               PIC X(120) VALUE SPACE.           
056400*    05  PV-CICS-MSG-SQL3               PIC X(120) VALUE SPACE.           
056500*    05  PV-CICS-MSG-SQL4               PIC X(120) VALUE SPACE.           
056600*    05  PV-CICS-MSG-SQL5               PIC X(120) VALUE SPACE.           
056700*    05  PV-TASK-DUR-DUMP               PIC ZZ9.99.                       
056800*    05  PV-MAX-GROUP-FMT               PIC X.                            
056900*    05  PV-POS-READ-FMT                PIC ZZZZZZ.                       
057000*    05  PV-CICS-MSG-AREA               PIC X(120).                       
057100                                                                          
057200     05  PV-MAKER-DESC                  PIC X(37) VALUE SPACES.           
057300     05  PV-QUOTA-CATEGORY              PIC X(05).                        
057400     05  PV-ENT-NAME-DESC               PIC X(32) VALUE SPACES.           
057500     05  PV-VEND-STYL-NME               PIC X(22) VALUE SPACES.           
057600     05  PV-PARAGRAPH-NAME              PIC X(30)   VALUE SPACE.          
057700     05  PV-ABEND-MESSAGE               PIC X(75)   VALUE SPACE.          
057800     05  PV-DB2-OPERATION-ATTEMPTED     PIC X(30)   VALUE SPACE.          
057900*    05  PV-SYSTEM-ID.                                                    
058000*        10  FILLER                     PIC  X(04)  VALUE SPACE.          
058100*        10  PV-REGION-IND              PIC  X(01).                       
058200*            88  PV-TEST-CICS                 VALUE 'T'.                  
058300*            88  PV-QA-CICS                   VALUE 'Q'.                  
058400*            88  PV-PROD-CICS                 VALUE 'P'.                  
058500*            88  PV-LEARN-CICS                VALUE 'L'.                  
058600*        10  FILLER                     PIC X(01)    VALUE SPACES.        
058700     05  FILLER                         PIC X(02)    VALUE SPACES.        
058800                                                                          
058900*---------------------------------------------------------------*         
059000*  WORKING STORAGE AREA USED TO BUILD SQL STATEMENTS            *         
059100*---------------------------------------------------------------*         
059200                                                                          
059300 01  PV-SQL-STMT.                                                         
059400     49  PV-SQL-STMT-LEN                PIC S9(04)  COMP  VALUE 0.        
059500*        SELECT 137 LENGTH PLUS                                           
059600*        FROM   275 LENGTH PLUS  (MAX)                                    
059700*        WHERE 1100 LENGTH       (MAX)                                    
059800     49  PV-SQL-STMT-TEXT               PIC X(1512)  VALUE SPACES.        
059900                                                                          
060000 01  PV-SELECT-CLAUSE                   PIC X(137)  VALUE SPACES.         
060100                                                                          
060200 01  TR196-REC-SQL-STMT-TBL.                                              
060300     05  TR196-REC-SQL-STATEMENT    OCCURS 19 TIMES                       
060400                                    INDEXED BY READX.                     
060500         10 TR196-REC-SQL-STMT      PIC X(80).                            
060600                                                                          
060700 01  TR196-REC-SLCTIONS-TBL.                                              
060800     05  TR196-REC-SELECTIONS       OCCURS  3 TIMES                       
060900                                    INDEXED BY SLCTX.                     
061000         10 TR196-REC-SLCTIONS      PIC X(80).                            
061100                                                                          
061200 01  WS-RDX                         PIC S9(2) VALUE 0.                    
061300                                                                          
061400 01  WS-SLX                         PIC S9(2) VALUE 0.                    
061500                                                                          
061600 01  TR196-REC-SQL-STMT-ALL.                                              
061700*01  PV-QUERY-STRING-FINAL.                                               
061800     49  HOST-SQL-LEN   PIC S9(4) COMP VALUE +1512.                       
061900     49  HOST-SQL-ARR   PIC X(1512).                                      
062000                                                                          
062100 01  TR196-REC-SLCT-STMT-ALL.                                             
062200     49  HOST-SLCT-LEN  PIC S9(4) COMP VALUE +200.                        
062300     49  HOST-SLCT-ARR  PIC X(200).                                       
062400                                                                          
062500 01  PV-BUILD-SELECT-REC.                                                 
062600     05  PV-BUILD-SELECT-LEN            PIC S9(04)  COMP  VALUE 0         
062700                                                          SYNC.           
062800     05  PV-BUILD-SELECT-STMT.                                            
062900         10  FILLER                     PIC  X(24) VALUE                  
063000             'SELECT DISTINCT A.PO_NBR'.                                  
063100         10  FILLER                     PIC  X(10) VALUE                  
063200             ',C.FOB_CDE'.                                                
063300         10  FILLER                     PIC  X(11) VALUE                  
063400             ',A.DEPT_NBR'.                                               
063500         10  FILLER                     PIC  X(17) VALUE                  
063600             ',C.LAST_FCTRY_DTE'.                                         
063700         10  FILLER                     PIC  X(20) VALUE                  
063800             ',C.DONT_SHIP_BEF_DTE'.                                      
063900         10  FILLER                     PIC  X(18) VALUE                  
064000             ',A.TOT_VAL_RTL_AMT'.                                        
064100         10  FILLER                     PIC  X(15) VALUE                  
064200             ',A.TOT_UNT_QTY '.                                           
064300         10  FILLER                     PIC  X(22) VALUE                  
064400             '                      '.                                    
064500                                                                          
064600     05  PV-BUILD-SELECT-STMT-VS.                                         
064700         10  FILLER                     PIC  X(24) VALUE                  
064800             'SELECT DISTINCT A.PO_NBR'.                                  
064900         10  FILLER                     PIC  X(10) VALUE                  
065000             ',C.FOB_CDE'.                                                
065100         10  FILLER                     PIC  X(11) VALUE                  
065200             ',A.DEPT_NBR'.                                               
065300         10  FILLER                     PIC  X(17) VALUE                  
065400             ',C.LAST_FCTRY_DTE'.                                         
065500         10  FILLER                     PIC  X(20) VALUE                  
065600             ',C.DONT_SHIP_BEF_DTE'.                                      
065700         10  FILLER                     PIC  X(18) VALUE                  
065800             ',A.TOT_VAL_RTL_AMT'.                                        
065900         10  FILLER                     PIC  X(15) VALUE                  
066000             ',A.TOT_UNT_QTY '.                                           
066210         10  FILLER                     PIC  X(14) VALUE                  
066220             ',MIN(K.VS_NBR)'.                                            
066250         10  FILLER                     PIC  X(08) VALUE                  
066260             '        '.                                                  
066300                                                                          
066400     05  PV-FROM-CLAUSE.                                                  
066500         10  FILLER                     PIC  X(275).                      
066600                                                                          
066700     05  PV-WHERE-CLAUSE.                                                 
066800         10  FILLER                     PIC  X(1100).                     
066900                                                                          
067000     05  PV-SV-OPER-UNIT               PIC S9(04) COMP.                   
067100     05  PV-SV-FCLTY                   PIC S9(04) COMP.                   
067200     05  PV-SV-PO-NBR                  PIC S9(9) COMP VALUE +0.           
067300     05  PV-DEPT-COMPARE               PIC 9(04).                         
067400     05  PV-DEPT-COMPARE-X REDEFINES                                      
067500         PV-DEPT-COMPARE.                                                 
067600         10 PV-DEPT-COMPARE-X-1        PIC X(01).                         
067700         10 PV-DEPT-COMPARE-X-2        PIC X(03).                         
067800     05  PV-SV-STATUS-CODE             PIC X(02).                         
067900     05  PV-SELPO-DATA.                                                   
068000         10 PV-PO-NBR-IN               PIC S9(9) COMP.                    
068100         10 PV-FOB-CDE-IN              PIC X(03).                         
068200         10 PV-POE-CDE-IN              PIC X(03).                         
068300         10 PV-DEPT-NBR                PIC X(03).                         
068400         10 PV-DUMMY1-DATE             PIC X(10).                         
068500         10 PV-DUMMY2-DATE             PIC X(10).                         
068600     05  PV-SCREEN-DATA-ITEMS.                                            
068700         10 PV-DEPT                     PIC X(03) VALUE SPACES.           
068800         10 PV-CHAR-OPER-UNT-ID         PIC X(03) VALUE SPACES.           
068900         10 PV-SM-AD-EVNT-DT            PIC X(08) VALUE SPACES.           
069000         10 PV-SM-VENDOR-STYLE          PIC X(08) VALUE SPACES.           
069100         10 PV-SM-OTB-PER-NBR           PIC X(06) VALUE SPACES.           
069200         10 PV-SM-STRT-FCTRY-DTE        PIC X(08) VALUE SPACES.           
069300         10 PV-SM-LAST-FCTRY-DTE        PIC X(08) VALUE SPACES.           
069400         10 PV-SM-DONT-SHP-DTE          PIC X(08) VALUE SPACES.           
069500         10 PV-SM-CAN-IFNOT-SHIP-DTE    PIC X(08) VALUE SPACES.           
069600         10 PV-SM-EXT-CAN-DTE           PIC X(08) VALUE SPACES.           
069700         10 PV-SM-EST-DELY-DT           PIC X(08) VALUE SPACES.           
069800         10 PV-SM-BKNG-DELY-DT          PIC X(08) VALUE SPACES.           
069900         10 PV-SM-ACTL-DELY-DT          PIC X(08) VALUE SPACES.           
070000         10 PV-SM-IMPRT-DPRTR-DT        PIC X(08) VALUE SPACES.           
070100         10 PV-SM-IMPRT-POE-DELY-DT     PIC X(08) VALUE SPACES.           
070200         10 PV-SM-ACTL-CLR-DATE         PIC X(08) VALUE SPACES.           
070300         10 PV-SM-TRIP-ETA-DC1          PIC X(08) VALUE SPACES.           
070400         10 PV-SM-TRIP-ETA-DC2          PIC X(08) VALUE SPACES.           
070500         10 PV-SM-TRIP-ETA-DC3          PIC X(08) VALUE SPACES.           
070600         10 PV-SM-TRIP-ETA-DC4          PIC X(08) VALUE SPACES.           
070700         10 PV-SM-TRIP-ETA-DC5          PIC X(08) VALUE SPACES.           
070800         10 PV-SM-TRIP-ETA-DC6          PIC X(08) VALUE SPACES.           
070900         10 PV-SM-TRIP-ETA-DC7          PIC X(08) VALUE SPACES.           
071000         10 PV-SM-TRIP-ETA-DC8          PIC X(08) VALUE SPACES.           
071100         10 PV-SM-TRIP-ETA-DC9          PIC X(08) VALUE SPACES.           
071200         10 PV-SM-TRIP-ETA-DC10         PIC X(08) VALUE SPACES.           
071300         10 PV-SM-TRIP-ETA-DC11         PIC X(08) VALUE SPACES.           
071400         10 PV-SM-TRIP-ETA-DC12         PIC X(08) VALUE SPACES.           
071500         10 PV-SM-TRIP-ATA-DC1          PIC X(08) VALUE SPACES.           
071600         10 PV-SM-TRIP-ATA-DC2          PIC X(08) VALUE SPACES.           
071700         10 PV-SM-TRIP-ATA-DC3          PIC X(08) VALUE SPACES.           
071800         10 PV-SM-TRIP-ATA-DC4          PIC X(08) VALUE SPACES.           
071900         10 PV-SM-TRIP-ATA-DC5          PIC X(08) VALUE SPACES.           
072000         10 PV-SM-TRIP-ATA-DC6          PIC X(08) VALUE SPACES.           
072100         10 PV-SM-TRIP-ATA-DC7          PIC X(08) VALUE SPACES.           
072200         10 PV-SM-TRIP-ATA-DC8          PIC X(08) VALUE SPACES.           
072300         10 PV-SM-TRIP-ATA-DC9          PIC X(08) VALUE SPACES.           
072400         10 PV-SM-TRIP-ATA-DC10         PIC X(08) VALUE SPACES.           
072500         10 PV-SM-TRIP-ATA-DC11         PIC X(08) VALUE SPACES.           
072600         10 PV-SM-TRIP-ATA-DC12         PIC X(08) VALUE SPACES.           
072700         10 PV-SM-DEVAN-DT              PIC X(08) VALUE SPACES.           
072800         10 PV-SM-SPL-CRT-DT            PIC X(08) VALUE SPACES.           
072900         10 PV-SM-SPL-SNT-DT            PIC X(08) VALUE SPACES.           
073000         10 PV-SM-BKR-FRGT-RLSE-DT      PIC X(08) VALUE SPACES.           
073100         10 PV-SM-TRLR-AVAIL-DT         PIC X(08) VALUE SPACES.           
073200         10 PV-SM-CONTNR-ID             PIC X(12) VALUE SPACES.           
073300         10 PV-SM-STORE-DISTRO          PIC X(01) VALUE SPACES.           
073400         10 PV-ACTL-CLR-DATE            PIC X(10) VALUE SPACES.           
073500         10 PV-FILD-DATE                PIC X(10) VALUE SPACES.           
073600         10 PV-MOM-DPRTR-DATE           PIC X(10) VALUE SPACES.           
073700         10 PV-FDR-DPRTR-DATE           PIC X(10) VALUE SPACES.           
073800         10 PV-TRIP-TYP-CDE             PIC X(01) VALUE SPACES.           
073900         10 PV-TRIP-TYP-CDE-FULL        PIC X(03) VALUE SPACES.           
074000         10 PV-DOLLARS-RECEIVED         PIC S9(15)V99 COMP-3              
074100                                            VALUE 0.                      
074200         10 PV-UNITS-RECEIVED           PIC S9(15) COMP-3                 
074300                                            VALUE 0.                      
074400         10 PV-DOLLARS-ORDERED          PIC S9(15)V99 COMP-3              
074500                                            VALUE 0.                      
074600         10 PV-UNITS-ORDERED            PIC S9(15) COMP-3                 
074700                                            VALUE 0.                      
074800         10 PV-TOT-VAL-RTL-AMT          PIC S9(8)V9(2) COMP-3             
074900                                         VALUE 0.                         
075000         10 PV-TOT-VAL-COST-AMT         PIC S9(8)V9(2) COMP-3             
075100                                         VALUE 0.                         
075200         10 PV-TOT-UNT-QTY              PIC S9(9) COMP VALUE 0.           
075300     05  PV-IMPORT-DATA.                                                  
075400         10 PV-BKNG-DELY-DT               PIC X(10).                      
075500         10 PV-ACTL-DELY-DT               PIC X(10).                      
075600         10 PV-FEEDER-DPRTR-DT            PIC X(10).                      
075700         10 PV-IMPRT-DPRTR-DT             PIC X(10).                      
075800         10 PV-IMPRT-POE-DELY-DT          PIC X(10).                      
075900         10 PV-IMPRT-ACT-DELY-DT          PIC X(10).                      
076000         10 PV-IMPRT-BKR-FRGT-RLSE-DT     PIC X(10).                      
076100         10 PV-CONTNR-ID                  PIC X(12).                      
076200         10 PV-TRLR-AVAIL-DT              PIC X(10).                      
076300         10 PV-SPL-CRE-DT                 PIC X(10).                      
076400         10 PV-SPL-SNT-DT                 PIC X(10).                      
076500         10 PV-ORD-SPL-SNT-DT             PIC X(10).                      
076600         10 PV-SHPT-SPL-SNT-DT            PIC X(10).                      
076700         10 PV-STORE-DISTRO               PIC X(01).                      
076800         10 PV-DEVAN-DT                   PIC X(10).                      
076900         10 PV-RECORD-TYPE                PIC X(01).                      
077000         10 PV-PRTY-CODE                  PIC X(02).                      
077100         10 PV-STATUS-CODE                PIC X(02).                      
077200     05  PV-SHIP-DATA.                                                    
077300         10 PV-OPER-UNT-ID                PIC S9(4) COMP.                 
077400         10 PV-FCLTY-ID                   PIC S9(4) COMP.                 
077500         10 PV-SHIP-STAT-DT               PIC X(10).                      
077600         10 PV-SHIP-STAT-DT1              PIC X(10).                      
077700         10 PV-SHIP-STAT-DT2              PIC X(10).                      
077800         10 PV-SHIP-ETA-DT                PIC X(10).                      
077900     05  PV-NULLS.                                                        
078000         10 PV-BKNG-DELY-DT-NULL          PIC S9(04) COMP.                
078100         10 PV-ACTL-DELY-DT-NULL          PIC S9(04) COMP.                
078200         10 PV-IMPRT-DPRTR-DT-NULL        PIC S9(04) COMP.                
078300         10 PV-FEEDER-DPRTR-DT-NULL       PIC S9(04) COMP.                
078400         10 PV-IMPRT-POE-DELY-DT-NULL     PIC S9(04) COMP.                
078500         10 PV-IMPRT-ACT-DELY-DT-NULL     PIC S9(04) COMP.                
078600         10 PV-IMPRT-BKR-FRGT-RLSE-DT-NULL PIC S9(4) COMP.                
078700         10 PV-TRLR-AVAIL-DT-NULL         PIC S9(04) COMP.                
078800         10 PV-OPER-UNT-ID-NULL           PIC S9(04) COMP.                
078900         10 PV-FCLTY-ID-NULL              PIC S9(04) COMP.                
079000         10 PV-SHIP-STAT-DT-NULL          PIC S9(04) COMP.                
079100         10 PV-SHIP-ETA-DT-NULL           PIC S9(04) COMP.                
079200         10 PV-ACTL-CLR-DATE-NULL         PIC S9(04) COMP.                
079300         10 PV-FILD-DATE-NULL             PIC S9(04) COMP.                
079400         10 PV-MOM-DPRTR-DATE-NULL        PIC S9(04) COMP.                
079500         10 PV-FDR-DPRTR-DATE-NULL        PIC S9(04) COMP.                
079600         10 PV-SPL-CRE-DT-NULL            PIC S9(04) COMP.                
079700         10 PV-SPL-SNT-DT-NULL            PIC S9(04) COMP.                
079800         10 PV-ORD-SPL-SNT-DT-NULL        PIC S9(04) COMP.                
079900         10 PV-SHPT-SPL-SNT-DT-NULL       PIC S9(04) COMP.                
080000         10 PV-DEVAN-DT-NULL              PIC S9(04) COMP.                
080100         10 PV-CONT-RLS-DT-NULL           PIC S9(04) COMP.                
080200         10 PV-TRLR-AVL-DT-NULL           PIC S9(04) COMP.                
080300     05  PV-DATE-DB2-FIELD.                                               
080400         10 PV-DB2-CC                    PIC  X(02).                      
080500         10 PV-DB2-YY                    PIC  X(02).                      
080600         10 FILLER                      PIC  X(01) VALUE '-'.             
080700         10 PV-DB2-MM                    PIC  X(02).                      
080800         10 FILLER                      PIC  X(01) VALUE '-'.             
080900         10 PV-DB2-DD                    PIC  X(02).                      
081000     05  PV-DISPLAY-CONTROL-VARIABLES.                                    
081100         10 PV-LAST-VFLD-LENGTH           PIC 9(03).                      
081200         10 PV-WORK-POS                   PIC 9(03).                      
081300         10 PV-WORK-PCT                   PIC 9(3)V9(4) COMP-3.           
081400         10 PV-VSCREEN-XPOS               PIC 9(03).                      
081500         10 PV-LAST-VSCREEN-XPOS          PIC 9(03).                      
081600         10 PV-SPACING-XPOS               PIC 9(03).                      
081700         10 PV-FIELD-LENGTH-SO-FAR        PIC 9(03).                      
081800         10 PV-LAST-FIELD-LENGTH-SO-FAR   PIC 9(03).                      
081900         10 PV-VSCN-I                     PIC 9(03).                      
082000         10 PV-BEGIN-FIELD                PIC 9(03).                      
082100         10 PV-START-FIELD                PIC 9(03).                      
082200         10 PV-LAST-FIELD                 PIC 9(03).                      
082300         10 PV-COUNTER1                   PIC 9(03).                      
082400         10 PV-COUNTER2                   PIC 9(03).                      
082500         10  PV-PURCHS-DEPT.                                              
082600             15 PV-PURCHS-DEPT-X-1        PIC X(01).                      
082700             15 PV-PURCHS-DEPT-X-2        PIC X(03).                      
082800         10  PV-PURCHS-DEPT-9 REDEFINES                                   
082900             PV-PURCHS-DEPT               PIC 9(04).                      
083000***      10 PV-WORK-DATA                  PIC X(54).                      
083100***      10 PV-SAVE-DATA                  PIC X(54).                      
083200         10  PV-WORK-HDR1                 PIC X(477).                     
083300         10  PV-VHDR1                     PIC X(477).                     
083400         10  PV-WORK-HDR2                 PIC X(477).                     
083500         10  PV-VHDR2                     PIC X(477).                     
083600         10 PV-WORK-DATA                  PIC X(477).                     
083700         10 PV-SAVE-DATA.                                                 
083800             15 PVS-PO-NBR                PIC 9(9).                       
083900             15 PVS-PO-NBR-RDF REDEFINES PVS-PO-NBR.                      
084000                 20 PVS-PO-TXT            PIC X(9).                       
084100             15 DELIM1                    PIC X(1).                       
084200             15 PVS-DEPT                  PIC X(04).                      
084300             15 PVS-DEPT-9 REDEFINES PVS-DEPT                             
084400                                          PIC 9(04).                      
084500             15 DELIM2                    PIC X(1).                       
084600             15 PVS-VND                   PIC X(8).                       
084700             15 DELIM3                    PIC X(1).                       
084800             15 PVS-DMM                   PIC X(3).                       
084900             15 DELIM4                    PIC X(1).                       
085000             15 PVS-DATA                  PIC X(472).                     
085100         10 PV-WORK-FIELD                 PIC X(08).                      
085200         10 PV-WORK-PAGE-CURR             PIC 9(2).                       
085300         10 PV-WORK-PAGE-ALT              PIC 9(2).                       
085400*---------------------------------------------------------------*         
085500*  #TIP ==>                                                     *         
085600*  THE ORDER OF THE FIELDS ON THE VIRTUAL SCREEN ARE CONTROLLED *         
085700*  BY THE VALUES SET IN DORDER. CHANGING THE VALUES HERE CHANGE *         
085800*  THE PLACEMENT OF THE FIELDS ON THE VIRTUAL SCREENS. NO OTHER *         
085900*  CODING IS EVER NECESSARY TO CHANGE THE DISPLAY ORDER.        *         
086000*---------------------------------------------------------------*         
086100          10  PV-VFLD-STA-DORDER             PIC 9(02) VALUE 010.         
086200          10  PV-VFLD-QCT-DORDER             PIC 9(02) VALUE 012.         
086300          10  PV-VFLD-VNS-DORDER             PIC 9(02) VALUE 014.         
086400          10  PV-VFLD-FOB-DORDER             PIC 9(02) VALUE 016.         
086500          10  PV-VFLD-POE-DORDER             PIC 9(02) VALUE 018.         
086600          10  PV-VFLD-SXF-DORDER             PIC 9(02) VALUE 019.         
086700          10  PV-VFLD-LXF-DORDER             PIC 9(02) VALUE 020.         
086800          10  PV-VFLD-BKD-DORDER             PIC 9(02) VALUE 022.         
086900          10  PV-VFLD-FRD-DORDER             PIC 9(02) VALUE 024.         
087000          10  PV-VFLD-SLD-DORDER             PIC 9(02) VALUE 026.         
087100          10  PV-VFLD-PRD-DORDER             PIC 9(02) VALUE 028.         
087200          10  PV-VFLD-CNT-DORDER             PIC 9(02) VALUE 030.         
087300          10  PV-VFLD-CSR-DORDER             PIC 9(02) VALUE 032.         
087400          10  PV-VFLD-DVN-DORDER             PIC 9(02) VALUE 034.         
087500          10  PV-VFLD-DC1-DORDER             PIC 9(02) VALUE 036.         
087600          10  PV-VFLD-DC2-DORDER             PIC 9(02) VALUE 038.         
087700          10  PV-VFLD-DC3-DORDER             PIC 9(02) VALUE 040.         
087800          10  PV-VFLD-DC4-DORDER             PIC 9(02) VALUE 042.         
087900          10  PV-VFLD-DC5-DORDER             PIC 9(02) VALUE 044.         
088000          10  PV-VFLD-DC6-DORDER             PIC 9(02) VALUE 046.         
088100          10  PV-VFLD-DC7-DORDER             PIC 9(02) VALUE 048.         
088200          10  PV-VFLD-DC8-DORDER             PIC 9(02) VALUE 050.         
088300          10  PV-VFLD-DC9-DORDER             PIC 9(02) VALUE 052.         
088400          10  PV-VFLD-DC10-DORDER            PIC 9(02) VALUE 054.         
088500          10  PV-VFLD-DC11-DORDER            PIC 9(02) VALUE 056.         
088600          10  PV-VFLD-DC12-DORDER            PIC 9(02) VALUE 058.         
088700          10  PV-VFLD-DSB-DORDER             PIC 9(02) VALUE 060.         
088800          10  PV-VFLD-CNL-DORDER             PIC 9(02) VALUE 062.         
088900          10  PV-VFLD-AED-DORDER             PIC 9(02) VALUE 064.         
089000          10  PV-VFLD-OTB-DORDER             PIC 9(02) VALUE 066.         
089100          10  PV-VFLD-PPK-DORDER             PIC 9(02) VALUE 068.         
089200          10  PV-VFLD-EDI-DORDER             PIC 9(02) VALUE 070.         
089300          10  PV-VFLD-FSC-DORDER             PIC 9(02) VALUE 072.         
089400          10  PV-VFLD-TTC-DORDER             PIC 9(02) VALUE 074.         
089500          10  PV-VFLD-TVC-DORDER             PIC 9(02) VALUE 076.         
089600          10  PV-VFLD-UOR-DORDER             PIC 9(02) VALUE 078.         
089700          10  PV-VFLD-URC-DORDER             PIC 9(02) VALUE 080.         
089800          10  PV-VFLD-URP-DORDER             PIC 9(02) VALUE 082.         
089900          10  PV-VFLD-DOR-DORDER             PIC 9(02) VALUE 084.         
090000          10  PV-VFLD-DRC-DORDER             PIC 9(02) VALUE 086.         
090100          10  PV-VFLD-DRP-DORDER             PIC 9(02) VALUE 088.         
090200          10  PV-VFLD-TRP-DORDER             PIC 9(02) VALUE 090.         
090300          10  PV-VFLD-SPL-CRT-DORDER         PIC 9(02) VALUE 092.         
090400          10  PV-VFLD-SPL-SNT-DORDER         PIC 9(02) VALUE 094.         
090500          10  PV-VFLD-STD-DORDER             PIC 9(02) VALUE 096.         
090600          10  PV-VFLD-CRL-DORDER             PIC 9(02) VALUE 097.         
090700          10  PV-VFLD-TRA-DORDER             PIC 9(02) VALUE 098.         
090800*---------------------------------------------------------------*         
090900*   THE SCREEN CAN DISPLAY UP TO 47 DIFFERENT FIELDS.           *         
091000*   THE USER CAN CHOOSE ANY ONE OF THEM OR ALL BY SETTING THE   *         
091100*   DISPLAY CRITERIA FIELDS IN TRKCS195.                        *         
091200*---------------------------------------------------------------*         
091300* #VERY_IMPORTANT ==>                                           *         
091400*   ASC-VCTL-SORTED-TABLE MUST CORRESPOND TO THE TOTAL LENGTH   *         
091500*   OF PV-VFLD-TABLE.                                           *         
091600*---------------------------------------------------------------*         
091700* #VERY_IMPORTANT ==>                                           *         
091800*    NEVER CHANGE THE ORDER OF THE 10 LEVELS IN                 *         
091900*    PV-VARIABLE-DATA-FIELDS UNLESS THE ORDER IN                *         
092000*    PC-VFLD-XXX-I FIELDS ARE MADE TO CORRESPOND BY             *         
092100*    THE SAME POSITION.                                         *         
092200*---------------------------------------------------------------*         
092300* #VERY_IMPORTANT ==>                                           *         
092400*    NEVER INITIALIZE THE 05 OR 10 LEVEL OF THE                 *         
092500*    PV-VARIABLE-DATA-FIELDS. ONLY INITIALIZE THE               *         
092600*    15 LEVEL.                                                  *         
092700*---------------------------------------------------------------*         
092800* #TIP ==>                                                      *         
092900*    TO ADD A NEW VARIABLE FIELD ADD THE FIELD TO THE           *         
093000*    BOTTOM OF PV-VARIABLE-DATA-FIELDS AND THEN SET IT          *         
093100*    UP USING THE STANDARD CONVENTIONS.  FINALLY                *         
093200*    ADD THE FIELD TO PC-VFLD-XXX-I WITH POSITION 36.           *         
093300*    ALSO SCAN THROUGH THE PROGRAM AND CHANGE ANY ARRAY         *         
093400*    SIZE AND ADD 1 TO PC-MAX-VFLDS-LIMIT. ALSO CHANGE          *         
093500*    THE COMMON AREA AND ANY LOGIC IN THE PROGRAM THAT          *         
093600*    DEALS WITH VARIABLE DATA.  REMEMBER TO SCAN FOR            *         
093700*    THE COMMENT #VARIABLE_LOGIC AS LOGIC IN THIS AREA          *         
093800*    PROBABLY NEEDS CHANGES.                                    *         
093900*---------------------------------------------------------------*         
094000     05  PV-VARIABLE-DATA-FIELDS.                                         
094100*                    FOB CODE                                             
094200         10 PV-FIELD-FOB.                                                 
094300            15 PV-HEADER-FOB-LEVEL-1 PIC X(4) VALUE 'FOB '.               
094400            15 PV-DELIM-FOB-LEVEL-1  PIC X(1) VALUE '~'.                  
094500            15 FILLER                PIC X(9) VALUE SPACES.               
094600            15 PV-HEADER-FOB-LEVEL-2 PIC X(4) VALUE 'CODE'.               
094700            15 PV-DELIM-FOB-LEVEL-2  PIC X(1) VALUE '~'.                  
094800            15 FILLER                PIC X(9) VALUE SPACES.               
094900            15 PV-DATA-FOB           PIC X(3) VALUE SPACES.               
095000            15 FILLER                PIC X(1) VALUE SPACES.               
095100            15 PV-DELIM-FOB          PIC X(1) VALUE '~'.                  
095200            15 FILLER                PIC X(9) VALUE SPACES.               
095300            15 PV-FOB-SUMMARY        PIC X(1) VALUE 'N'.                  
095400            15 PV-FOB-LENGTH         PIC 9(2) VALUE 5.                    
095500            15 PV-FOB-JUSTIFIED      PIC X(1) VALUE 'L'.                  
095600            15 FILLER                PIC X(14) VALUE SPACES.              
095700*                    POE CODE                                             
095800         10 PV-FIELD-POE.                                                 
095900            15 PV-HEADER-POE-LEVEL-1 PIC X(4) VALUE 'POE '.               
096000            15 PV-DELIM-POE-LEVEL-1  PIC X(1) VALUE '~'.                  
096100            15 FILLER                PIC X(9) VALUE SPACES.               
096200            15 PV-HEADER-POE-LEVEL-2 PIC X(4) VALUE 'CODE'.               
096300            15 PV-DELIM-POE-LEVEL-2  PIC X(1) VALUE '~'.                  
096400            15 FILLER                PIC X(9) VALUE SPACES.               
096500            15 PV-DATA-POE           PIC X(3) VALUE SPACES.               
096600            15 FILLER                PIC X(1) VALUE SPACES.               
096700            15 PV-DELIM-POE          PIC X(1) VALUE '~'.                  
096800            15 FILLER                PIC X(9) VALUE SPACES.               
096900            15 PV-POE-SUMMARY        PIC X(1) VALUE 'N'.                  
097000            15 PV-POE-LENGTH         PIC 9(2) VALUE 5.                    
097100            15 PV-POE-JUSTIFIED      PIC X(1) VALUE 'L'.                  
097200            15 FILLER                PIC X(14) VALUE SPACES.              
097300*                    DONT SHIP BY DATE                                    
097400         10 PV-FIELD-DSB.                                                 
097500            15 PV-HEADER-DSB-LEVEL-1 PIC X(10) VALUE '   DONT   '.        
097600            15 PV-DELIM-DSB-LEVEL-1  PIC X(1) VALUE '~'.                  
097700            15 FILLER                PIC X(3) VALUE SPACES.               
097800            15 PV-HEADER-DSB-LEVEL-2 PIC X(10) VALUE '   SHPBY  '.        
097900            15 PV-DELIM-DSB-LEVEL-2  PIC X(1) VALUE '~'.                  
098000            15 FILLER                PIC X(3) VALUE SPACES.               
098100            15 PV-DATA-DSB           PIC X(10) VALUE SPACES.              
098200            15 PV-DELIM-DSB          PIC X(1) VALUE '~'.                  
098300            15 FILLER                PIC X(3) VALUE SPACES.               
098400            15 PV-DSB-SUMMARY        PIC X(1) VALUE 'N'.                  
098500            15 PV-DSB-LENGTH         PIC 9(2) VALUE 11.                   
098600            15 PV-DSB-JUSTIFIED      PIC X(1) VALUE 'L'.                  
098700            15 FILLER                PIC X(14) VALUE SPACES.              
098800*                   START XFACTORY DATE                                   
098900         10 PV-FIELD-SXF.                                                 
099000            15 PV-HEADER-SXF-LEVEL-1 PIC X(10) VALUE '   STRT   '.        
099100            15 PV-DELIM-SXF-LEVEL-1  PIC X(1) VALUE '~'.                  
099200            15 FILLER                PIC X(3) VALUE SPACES.               
099300            15 PV-HEADER-SXF-LEVEL-2 PIC X(10) VALUE '   XFACT  '.        
099400            15 PV-DELIM-SXF-LEVEL-2  PIC X(1) VALUE '~'.                  
099500            15 FILLER                PIC X(3) VALUE SPACES.               
099600            15 PV-DATA-SXF           PIC X(10) VALUE SPACES.              
099700            15 PV-DELIM-SXF          PIC X(1) VALUE '~'.                  
099800            15 FILLER                PIC X(3) VALUE SPACES.               
099900            15 PV-SXF-SUMMARY        PIC X(1) VALUE 'N'.                  
100000            15 PV-SXF-LENGTH         PIC 9(2) VALUE 11.                   
100100            15 PV-SXF-JUSTIFIED      PIC X(1) VALUE 'L'.                  
100200            15 FILLER                PIC X(14) VALUE SPACES.              
100300*                    LAST XFACTORY DATE                                   
100400         10 PV-FIELD-LXF.                                                 
100500            15 PV-HEADER-LXF-LEVEL-1 PIC X(10) VALUE '   LAST   '.        
100600            15 PV-DELIM-LXF-LEVEL-1  PIC X(1) VALUE '~'.                  
100700            15 FILLER                PIC X(3) VALUE SPACES.               
100800            15 PV-HEADER-LXF-LEVEL-2 PIC X(10) VALUE '   XFACT  '.        
100900            15 PV-DELIM-LXF-LEVEL-2  PIC X(1) VALUE '~'.                  
101000            15 FILLER                PIC X(3) VALUE SPACES.               
101100            15 PV-DATA-LXF           PIC X(10) VALUE SPACES.              
101200            15 PV-DELIM-LXF          PIC X(1) VALUE '~'.                  
101300            15 FILLER                PIC X(3) VALUE SPACES.               
101400            15 PV-LXF-SUMMARY        PIC X(1) VALUE 'N'.                  
101500            15 PV-LXF-LENGTH         PIC 9(2) VALUE 11.                   
101600            15 PV-LXF-JUSTIFIED      PIC X(1) VALUE 'L'.                  
101700            15 FILLER                PIC X(14) VALUE SPACES.              
101800*                    CANCEL OR EXTENDED CANCEL DATE                       
101900         10 PV-FIELD-CNL.                                                 
102000            15 PV-HEADER-CNL-LEVEL-1 PIC X(10) VALUE 'CAN  '.             
102100            15 PV-DELIM-CNL-LEVEL-1  PIC X(1) VALUE '~'.                  
102200            15 FILLER                PIC X(3) VALUE SPACES.               
102300            15 PV-HEADER-CNL-LEVEL-2 PIC X(10) VALUE 'DATE '.             
102400            15 PV-DELIM-CNL-LEVEL-2  PIC X(1) VALUE '~'.                  
102500            15 FILLER                PIC X(3) VALUE SPACES.               
102600            15 PV-DATA-CNL           PIC X(10) VALUE SPACES.              
102700            15 PV-DELIM-CNL          PIC X(1) VALUE '~'.                  
102800            15 FILLER                PIC X(3) VALUE SPACES.               
102900            15 PV-CNL-SUMMARY        PIC X(1) VALUE 'N'.                  
103000            15 PV-CNL-LENGTH         PIC 9(2) VALUE 11.                   
103100            15 PV-CNL-JUSTIFIED      PIC X(1) VALUE 'L'.                  
103200            15 FILLER                PIC X(14) VALUE SPACES.              
103300*                    FOB OVERSEAS RECEIPT DATE                            
103400         10 PV-FIELD-FRD.                                                 
103500            15 PV-HEADER-FRD-LEVEL-1 PIC X(10) VALUE '   FOB    '.        
103600            15 PV-DELIM-FRD-LEVEL-1  PIC X(1) VALUE '~'.                  
103700            15 FILLER                PIC X(3) VALUE SPACES.               
103800            15 PV-HEADER-FRD-LEVEL-2 PIC X(10) VALUE '   RCPT   '.        
103900            15 PV-DELIM-FRD-LEVEL-2  PIC X(1) VALUE '~'.                  
104000            15 FILLER                PIC X(3) VALUE SPACES.               
104100            15 PV-DATA-FRD           PIC X(10) VALUE SPACES.              
104200            15 PV-DELIM-FRD          PIC X(1) VALUE '~'.                  
104300            15 FILLER                PIC X(3) VALUE SPACES.               
104400            15 PV-FRD-SUMMARY        PIC X(1) VALUE 'N'.                  
104500            15 PV-FRD-LENGTH         PIC 9(2) VALUE 11.                   
104600            15 PV-FRD-JUSTIFIED      PIC X(1) VALUE 'L'.                  
104700            15 FILLER                PIC X(14) VALUE SPACES.              
104800*                    IMPORT SAIL DATE                                     
104900         10 PV-FIELD-SLD.                                                 
105000            15 PV-HEADER-SLD-LEVEL-1 PIC X(10) VALUE '   SAIL   '.        
105100            15 PV-DELIM-SLD-LEVEL-1  PIC X(1) VALUE '~'.                  
105200            15 FILLER                PIC X(3) VALUE SPACES.               
105300            15 PV-HEADER-SLD-LEVEL-2 PIC X(10) VALUE '   DATE   '.        
105400            15 PV-DELIM-SLD-LEVEL-2  PIC X(1) VALUE '~'.                  
105500            15 FILLER                PIC X(3) VALUE SPACES.               
105600            15 PV-DATA-SLD           PIC X(10) VALUE SPACES.              
105700            15 PV-DELIM-SLD          PIC X(1) VALUE '~'.                  
105800            15 FILLER                PIC X(3) VALUE SPACES.               
105900            15 PV-SLD-SUMMARY        PIC X(1) VALUE 'N'.                  
106000            15 PV-SLD-LENGTH         PIC 9(2) VALUE 11.                   
106100            15 PV-SLD-JUSTIFIED      PIC X(1) VALUE 'L'.                  
106200            15 FILLER                PIC X(14) VALUE SPACES.              
106300*                    PORT ARRIVAL DATE                                    
106400         10 PV-FIELD-PRD.                                                 
106500            15 PV-HEADER-PRD-LEVEL-1 PIC X(10)                            
106600                                          VALUE '  ETA/ATA '.             
106700            15 PV-DELIM-PRD-LEVEL-1  PIC X(1) VALUE '~'.                  
106800            15 FILLER                PIC X(3) VALUE SPACES.               
106900            15 PV-HEADER-PRD-LEVEL-2 PIC X(10)                            
107000                                          VALUE '  POE ARV '.             
107100            15 PV-DELIM-PRD-LEVEL-2  PIC X(1) VALUE '~'.                  
107200            15 FILLER                PIC X(3) VALUE SPACES.               
107300            15 PV-DATA-PRD           PIC X(10) VALUE SPACES.              
107400            15 PV-DELIM-PRD          PIC X(1) VALUE '~'.                  
107500            15 FILLER                PIC X(3) VALUE SPACES.               
107600            15 PV-PRD-SUMMARY        PIC X(1) VALUE 'N'.                  
107700            15 PV-PRD-LENGTH         PIC 9(2) VALUE 11.                   
107800            15 PV-PRD-JUSTIFIED      PIC X(1) VALUE 'L'.                  
107900            15 FILLER                PIC X(14) VALUE SPACES.              
108000*                    CONTAINER ID (FOR POE E/ATA)                         
108100         10 PV-FIELD-CNT.                                                 
108200            15 PV-HEADER-CNT-LEVEL-1 PIC X(7) VALUE 'CONTNR '.            
108300            15 FILLER                PIC X(5) VALUE SPACES.               
108400            15 PV-DELIM-CNT-LEVEL-1  PIC X(1) VALUE '~'.                  
108500            15 FILLER                PIC X(1) VALUE SPACES.               
108600            15 PV-HEADER-CNT-LEVEL-2 PIC X(7) VALUE '  ID   '.            
108700            15 FILLER                PIC X(5) VALUE SPACES.               
108800            15 PV-DELIM-CNT-LEVEL-2  PIC X(1) VALUE '~'.                  
108900            15 FILLER                PIC X(1) VALUE SPACES.               
109000            15 PV-DATA-CNT           PIC X(12) VALUE SPACES.              
109100            15 PV-DELIM-CNT          PIC X(1) VALUE '~'.                  
109200            15 FILLER                PIC X(1) VALUE SPACES.               
109300            15 PV-CNT-SUMMARY        PIC X(1) VALUE 'N'.                  
109400            15 PV-CNT-LENGTH         PIC 9(2) VALUE 13.                   
109500            15 PV-CNT-JUSTIFIED      PIC X(1) VALUE 'L'.                  
109600            15 FILLER                PIC X(14) VALUE SPACES.              
109700*                    CUSTOMS RELEASE DATE                                 
109800         10 PV-FIELD-CSR.                                                 
109900            15 PV-HEADER-CSR-LEVEL-1 PIC X(10) VALUE '   CUST   '.        
110000            15 PV-DELIM-CSR-LEVEL-1  PIC X(1) VALUE '~'.                  
110100            15 FILLER                PIC X(3) VALUE SPACES.               
110200            15 PV-HEADER-CSR-LEVEL-2 PIC X(10) VALUE '   RLS    '.        
110300            15 PV-DELIM-CSR-LEVEL-2  PIC X(1) VALUE '~'.                  
110400            15 FILLER                PIC X(3) VALUE SPACES.               
110500            15 PV-DATA-CSR           PIC X(10) VALUE SPACES.              
110600            15 PV-DELIM-CSR          PIC X(1) VALUE '~'.                  
110700            15 FILLER                PIC X(3) VALUE SPACES.               
110800            15 PV-CSR-SUMMARY        PIC X(1) VALUE 'N'.                  
110900            15 PV-CSR-LENGTH         PIC 9(2) VALUE 11.                   
111000            15 PV-CSR-JUSTIFIED      PIC X(1) VALUE 'L'.                  
111100            15 FILLER                PIC X(14) VALUE SPACES.              
111200*                    ETA TO DC 1                                          
111300         10 PV-FIELD-DC1.                                                 
111400            15 PV-HEADER-DC1-LEVEL-1 PIC X(10)                            
111500                                        VALUE 'ETA/ATA   '.               
111600            15 PV-DELIM-DC1-LEVEL-1  PIC X(1)  VALUE '~'.                 
111700            15 FILLER                PIC X(3) VALUE SPACES.               
111800            15 PV-HEADER-DC1-LEVEL-2 PIC X(10)                            
111900                                        VALUE '   DC     '.               
112000            15 PV-DELIM-DC1-LEVEL-2  PIC X(1) VALUE '~'.                  
112100            15 FILLER                PIC X(3) VALUE SPACES.               
112200                                                                          
112300            15 PV-DATA-DC1           PIC X(10) VALUE SPACES.              
112400            15 PV-DELIM-DC1          PIC X(1) VALUE '~'.                  
112500            15 FILLER                PIC X(3) VALUE SPACES.               
112600            15 PV-DC1-SUMMARY        PIC X(1) VALUE 'N'.                  
112700            15 PV-DC1-LENGTH         PIC 9(2) VALUE 11.                   
112800            15 PV-DC1-JUSTIFIED      PIC X(1) VALUE 'L'.                  
112900            15 FILLER                PIC X(14) VALUE SPACES.              
113000*                    ETA TO DC 2                                          
113100         10 PV-FIELD-DC2.                                                 
113200            15 PV-HEADER-DC2-LEVEL-1 PIC X(10)                            
113300                                        VALUE 'ETA/ATA   '.               
113400            15 PV-DELIM-DC2-LEVEL-1  PIC X(1) VALUE '~'.                  
113500            15 FILLER                PIC X(3) VALUE SPACES.               
113600            15 PV-HEADER-DC2-LEVEL-2 PIC X(10)                            
113700                                        VALUE '   DC     '.               
113800            15 PV-DELIM-DC2-LEVEL-2  PIC X(1) VALUE '~'.                  
113900            15 FILLER                PIC X(3) VALUE SPACES.               
114000                                                                          
114100            15 PV-DATA-DC2           PIC X(10) VALUE SPACES.              
114200            15 PV-DELIM-DC2          PIC X(1) VALUE '~'.                  
114300            15 FILLER                PIC X(3) VALUE SPACES.               
114400            15 PV-DC2-SUMMARY        PIC X(1) VALUE 'N'.                  
114500            15 PV-DC2-LENGTH         PIC 9(2) VALUE 11.                   
114600            15 PV-DC2-JUSTIFIED      PIC X(1) VALUE 'L'.                  
114700            15 FILLER                PIC X(14) VALUE SPACES.              
114800*                    ETA TO DC 3                                          
114900         10 PV-FIELD-DC3.                                                 
115000            15 PV-HEADER-DC3-LEVEL-1 PIC X(10)                            
115100                                        VALUE 'ETA/ATA   '.               
115200            15 PV-DELIM-DC3-LEVEL-1  PIC X(1) VALUE '~'.                  
115300            15 FILLER                PIC X(3) VALUE SPACES.               
115400            15 PV-HEADER-DC3-LEVEL-2 PIC X(10)                            
115500                                        VALUE '   DC     '.               
115600            15 PV-DELIM-DC3-LEVEL-2  PIC X(1) VALUE '~'.                  
115700            15 FILLER                PIC X(3) VALUE SPACES.               
115800                                                                          
115900            15 PV-DATA-DC3           PIC X(10) VALUE SPACES.              
116000            15 PV-DELIM-DC3          PIC X(1) VALUE '~'.                  
116100            15 FILLER                PIC X(3) VALUE SPACES.               
116200            15 PV-DC3-SUMMARY        PIC X(1) VALUE 'N'.                  
116300            15 PV-DC3-LENGTH         PIC 9(2) VALUE 11.                   
116400            15 PV-DC3-JUSTIFIED      PIC X(1) VALUE 'L'.                  
116500            15 FILLER                PIC X(14) VALUE SPACES.              
116600*                    ETA TO DC 4                                          
116700         10 PV-FIELD-DC4.                                                 
116800            15 PV-HEADER-DC4-LEVEL-1 PIC X(10)                            
116900                                        VALUE 'ETA/ATA   '.               
117000            15 PV-DELIM-DC4-LEVEL-1  PIC X(1) VALUE '~'.                  
117100            15 FILLER                PIC X(3) VALUE SPACES.               
117200            15 PV-HEADER-DC4-LEVEL-2 PIC X(10)                            
117300                                        VALUE '   DC     '.               
117400            15 PV-DELIM-DC4-LEVEL-2  PIC X(1) VALUE '~'.                  
117500            15 FILLER                PIC X(3) VALUE SPACES.               
117600                                                                          
117700            15 PV-DATA-DC4           PIC X(10) VALUE SPACES.              
117800            15 PV-DELIM-DC4          PIC X(1) VALUE '~'.                  
117900            15 FILLER                PIC X(3) VALUE SPACES.               
118000            15 PV-DC4-SUMMARY        PIC X(1) VALUE 'N'.                  
118100            15 PV-DC4-LENGTH         PIC 9(2) VALUE 11.                   
118200            15 PV-DC4-JUSTIFIED      PIC X(1) VALUE 'L'.                  
118300            15 FILLER                PIC X(14) VALUE SPACES.              
118400*                    ETA TO DC 5                                          
118500         10 PV-FIELD-DC5.                                                 
118600            15 PV-HEADER-DC5-LEVEL-1 PIC X(10)                            
118700                                        VALUE 'ETA/ATA   '.               
118800            15 PV-DELIM-DC5-LEVEL-1  PIC X(1) VALUE '~'.                  
118900            15 FILLER                PIC X(3) VALUE SPACES.               
119000            15 PV-HEADER-DC5-LEVEL-2 PIC X(10)                            
119100                                        VALUE '   DC     '.               
119200            15 PV-DELIM-DC5-LEVEL-2  PIC X(1) VALUE '~'.                  
119300            15 FILLER                PIC X(3) VALUE SPACES.               
119400                                                                          
119500            15 PV-DATA-DC5           PIC X(10) VALUE SPACES.              
119600            15 PV-DELIM-DC5          PIC X(1) VALUE '~'.                  
119700            15 FILLER                PIC X(3) VALUE SPACES.               
119800            15 PV-DC5-SUMMARY        PIC X(1) VALUE 'N'.                  
119900            15 PV-DC5-LENGTH         PIC 9(2) VALUE 11.                   
120000            15 PV-DC5-JUSTIFIED      PIC X(1) VALUE 'L'.                  
120100            15 FILLER                PIC X(14) VALUE SPACES.              
120200*                    ETA TO DC 6                                          
120300         10 PV-FIELD-DC6.                                                 
120400            15 PV-HEADER-DC6-LEVEL-1 PIC X(10)                            
120500                                        VALUE 'ETA/ATA   '.               
120600            15 PV-DELIM-DC6-LEVEL-1  PIC X(1) VALUE '~'.                  
120700            15 FILLER                PIC X(3) VALUE SPACES.               
120800            15 PV-HEADER-DC6-LEVEL-2 PIC X(10)                            
120900                                        VALUE '   DC     '.               
121000            15 PV-DELIM-DC6-LEVEL-1  PIC X(1) VALUE '~'.                  
121100            15 FILLER                PIC X(3) VALUE SPACES.               
121200                                                                          
121300            15 PV-DATA-DC6           PIC X(10) VALUE SPACES.              
121400            15 PV-DELIM-DC6          PIC X(1) VALUE '~'.                  
121500            15 FILLER                PIC X(3) VALUE SPACES.               
121600            15 PV-DC6-SUMMARY        PIC X(1) VALUE 'N'.                  
121700            15 PV-DC6-LENGTH         PIC 9(2) VALUE 11.                   
121800            15 PV-DC6-JUSTIFIED      PIC X(1) VALUE 'L'.                  
121900            15 FILLER                PIC X(14) VALUE SPACES.              
122000*                    ETA TO DC 7                                          
122100         10 PV-FIELD-DC7.                                                 
122200            15 PV-HEADER-DC7-LEVEL-1 PIC X(10)                            
122300                                        VALUE 'ETA/ATA   '.               
122400            15 PV-DELIM-DC7-LEVEL-1  PIC X(1) VALUE '~'.                  
122500            15 FILLER                PIC X(3) VALUE SPACES.               
122600            15 PV-HEADER-DC7-LEVEL-2 PIC X(10)                            
122700                                     VALUE '   DC     '.                  
122800            15 PV-DELIM-DC7-LEVEL-2  PIC X(1) VALUE '~'.                  
122900            15 FILLER                PIC X(3) VALUE SPACES.               
123000                                                                          
123100            15 PV-DATA-DC7           PIC X(10) VALUE SPACES.              
123200            15 PV-DELIM-DC7          PIC X(1) VALUE '~'.                  
123300            15 FILLER                PIC X(3) VALUE SPACES.               
123400            15 PV-DC7-SUMMARY        PIC X(1) VALUE 'N'.                  
123500            15 PV-DC7-LENGTH         PIC 9(2) VALUE 11.                   
123600            15 PV-DC7-JUSTIFIED      PIC X(1) VALUE 'L'.                  
123700            15 FILLER                PIC X(14) VALUE SPACES.              
123800*                    ETA TO DC 8                                          
123900         10 PV-FIELD-DC8.                                                 
124000            15 PV-HEADER-DC8-LEVEL-1 PIC X(10)                            
124100                                        VALUE 'ETA/ATA   '.               
124200            15 PV-DELIM-DC8-LEVEL-1  PIC X(1) VALUE '~'.                  
124300            15 FILLER                PIC X(3) VALUE SPACES.               
124400            15 PV-HEADER-DC8-LEVEL-2 PIC X(10)                            
124500                                        VALUE '   DC     '.               
124600            15 PV-DELIM-DC8-LEVEL-2  PIC X(1) VALUE '~'.                  
124700            15 FILLER                PIC X(3) VALUE SPACES.               
124800                                                                          
124900            15 PV-DATA-DC8           PIC X(10) VALUE SPACES.              
125000            15 PV-DELIM-DC8          PIC X(1) VALUE '~'.                  
125100            15 FILLER                PIC X(3) VALUE SPACES.               
125200            15 PV-DC8-SUMMARY        PIC X(1) VALUE 'N'.                  
125300            15 PV-DC8-LENGTH         PIC 9(2) VALUE 11.                   
125400            15 PV-DC8-JUSTIFIED      PIC X(1) VALUE 'L'.                  
125500            15 FILLER                PIC X(14) VALUE SPACES.              
125600*                    ETA TO DC 9                                          
125700         10 PV-FIELD-DC9.                                                 
125800            15 PV-HEADER-DC9-LEVEL-1 PIC X(10)                            
125900                                        VALUE 'ETA/ATA   '.               
126000            15 PV-DELIM-DC9-LEVEL-1  PIC X(1) VALUE '~'.                  
126100            15 FILLER                PIC X(3) VALUE SPACES.               
126200            15 PV-HEADER-DC9-LEVEL-2 PIC X(10)                            
126300                                        VALUE '   DC     '.               
126400            15 PV-DELIM-DC9-LEVEL-2  PIC X(1) VALUE '~'.                  
126500            15 FILLER                PIC X(3) VALUE SPACES.               
126600                                                                          
126700            15 PV-DATA-DC9           PIC X(10) VALUE SPACES.              
126800            15 PV-DELIM-DC9          PIC X(1) VALUE '~'.                  
126900            15 FILLER                PIC X(3) VALUE SPACES.               
127000            15 PV-DC9-SUMMARY        PIC X(1) VALUE 'N'.                  
127100            15 PV-DC9-LENGTH         PIC 9(2) VALUE 11.                   
127200            15 PV-DC9-JUSTIFIED      PIC X(1) VALUE 'L'.                  
127300            15 FILLER                PIC X(14) VALUE SPACES.              
127400*                    ETA TO DC 10                                         
127500         10 PV-FIELD-DC10.                                                
127600            15 PV-HEADER-DC10-LEVEL-1 PIC X(10)                           
127700                                         VALUE 'ETA/ATA   '.              
127800            15 PV-DELIM-DC10-LEVEL-1 PIC X(1) VALUE '~'.                  
127900            15 FILLER                PIC X(3) VALUE SPACES.               
128000            15 PV-HEADER-DC10-LEVEL-2 PIC X(10)                           
128100                                         VALUE '   DC     '.              
128200            15 PV-DELIM-DC10-LEVEL-2 PIC X(1) VALUE '~'.                  
128300            15 FILLER                PIC X(3) VALUE SPACES.               
128400                                                                          
128500            15 PV-DATA-DC10          PIC X(10) VALUE SPACES.              
128600            15 PV-DELIM-DC10         PIC X(1) VALUE '~'.                  
128700            15 FILLER                PIC X(3) VALUE SPACES.               
128800            15 PV-DC10-SUMMARY       PIC X(1) VALUE 'N'.                  
128900            15 PV-DC10-LENGTH        PIC 9(2) VALUE 11.                   
129000            15 PV-DC10-JUSTIFIED     PIC X(1) VALUE 'L'.                  
129100            15 FILLER                PIC X(14) VALUE SPACES.              
129200*                    ETA TO DC 11                                         
129300         10 PV-FIELD-DC11.                                                
129400            15 PV-HEADER-DC11-LEVEL-1 PIC X(10)                           
129500                                         VALUE 'ETA/ATA   '.              
129600            15 PV-DELIM-DC11-LEVEL-1 PIC X(1) VALUE '~'.                  
129700            15 FILLER                PIC X(3) VALUE SPACES.               
129800            15 PV-HEADER-DC11-LEVEL-2 PIC X(10)                           
129900                                         VALUE '   DC     '.              
130000            15 PV-DELIM-DC11-LEVEL-2 PIC X(1) VALUE '~'.                  
130100            15 FILLER                PIC X(3) VALUE SPACES.               
130200                                                                          
130300            15 PV-DATA-DC11          PIC X(10) VALUE SPACES.              
130400            15 PV-DELIM-DC11         PIC X(1) VALUE '~'.                  
130500            15 FILLER                PIC X(3) VALUE SPACES.               
130600            15 PV-DC11-SUMMARY       PIC X(1) VALUE 'N'.                  
130700            15 PV-DC11-LENGTH        PIC 9(2) VALUE 11.                   
130800            15 PV-DC11-JUSTIFIED     PIC X(1) VALUE 'L'.                  
130900            15 FILLER                PIC X(14) VALUE SPACES.              
131000*                    ETA TO DC 12                                         
131100         10 PV-FIELD-DC12.                                                
131200            15 PV-HEADER-DC12-LEVEL-1 PIC X(10)                           
131300                                         VALUE 'ETA/ATA   '.              
131400            15 PV-DELIM-DC12-LEVEL-1 PIC X(1) VALUE '~'.                  
131500            15 FILLER                PIC X(3) VALUE SPACES.               
131600            15 PV-HEADER-DC12-LEVEL-2 PIC X(10)                           
131700                                         VALUE '   DC     '.              
131800            15 PV-DELIM-DC12-LEVEL-2 PIC X(1) VALUE '~'.                  
131900            15 FILLER                PIC X(3) VALUE SPACES.               
132000                                                                          
132100            15 PV-DATA-DC12          PIC X(10) VALUE SPACES.              
132200            15 PV-DELIM-DC12         PIC X(1) VALUE '~'.                  
132300            15 FILLER                PIC X(3) VALUE SPACES.               
132400            15 PV-DC12-SUMMARY       PIC X(1) VALUE 'N'.                  
132500            15 PV-DC12-LENGTH        PIC 9(2) VALUE 11.                   
132600            15 PV-DC12-JUSTIFIED     PIC X(1) VALUE 'L'.                  
132700            15 FILLER                PIC X(14) VALUE SPACES.              
132800*                    DEVAN DATE AT DECONSOLIDATOR                         
132900         10 PV-FIELD-DVN.                                                 
133000            15 PV-HEADER-DVN-LEVEL-1 PIC X(10) VALUE '   DEVAN  '.        
133100            15 PV-DELIM-DVN-LEVEL-1  PIC X(1) VALUE '~'.                  
133200            15 FILLER                PIC X(3) VALUE SPACES.               
133300            15 PV-HEADER-DVN-LEVEL-2 PIC X(10) VALUE '   DATE   '.        
133400            15 PV-DELIM-DVN-LEVEL-2  PIC X(1) VALUE '~'.                  
133500            15 FILLER                PIC X(3) VALUE SPACES.               
133600            15 PV-DATA-DVN           PIC X(10) VALUE SPACES.              
133700            15 PV-DELIM-DVN          PIC X(1) VALUE '~'.                  
133800            15 FILLER                PIC X(3) VALUE SPACES.               
133900            15 PV-DVN-SUMMARY        PIC X(1) VALUE 'N'.                  
134000            15 PV-DVN-LENGTH         PIC 9(2) VALUE 11.                   
134100            15 PV-DVN-JUSTIFIED      PIC X(1) VALUE 'L'.                  
134200            15 FILLER                PIC X(14) VALUE SPACES.              
134300*                    OVERSEAS BOOKING DATE                                
134400         10 PV-FIELD-BKD.                                                 
134500            15 PV-HEADER-BKD-LEVEL-1 PIC X(10) VALUE '   BKNG   '.        
134600            15 PV-DELIM-BKD-LEVEL-1  PIC X(1) VALUE '~'.                  
134700            15 FILLER                PIC X(3) VALUE SPACES.               
134800            15 PV-HEADER-BKD-LEVEL-2 PIC X(10) VALUE '   DELY   '.        
134900            15 PV-DELIM-BKD-LEVEL-2  PIC X(1) VALUE '~'.                  
135000            15 FILLER                PIC X(3) VALUE SPACES.               
135100            15 PV-DATA-BKD           PIC X(10) VALUE SPACES.              
135200            15 PV-DELIM-BKD          PIC X(1) VALUE '~'.                  
135300            15 FILLER                PIC X(3) VALUE SPACES.               
135400            15 PV-BKD-SUMMARY        PIC X(1) VALUE 'N'.                  
135500            15 PV-BKD-LENGTH         PIC 9(2) VALUE 11.                   
135600            15 PV-BKD-JUSTIFIED      PIC X(1) VALUE 'L'.                  
135700            15 FILLER                PIC X(14) VALUE SPACES.              
135800*                    IMPORT EXTENDED FIRST COST                           
135900         10 PV-FIELD-FSC.                                                 
136000            15 FILLER                PIC X(1) VALUE SPACES.               
136100            15 PV-HEADER-FSC-LEVEL-1 PIC X(12)                            
136200                         VALUE '      1ST   '.                            
136300            15 PV-DELIM-FSC-LEVEL-1  PIC X(1) VALUE '~'.                  
136400            15 FILLER                PIC X(1) VALUE SPACES.               
136500            15 PV-HEADER-FSC-LEVEL-2 PIC X(12)                            
136600                         VALUE '     COST   '.                            
136700            15 PV-DELIM-FSC-LEVEL-2  PIC X(1) VALUE '~'.                  
136800            15 FILLER                PIC X(1) VALUE SPACES.               
136900            15 PV-DATA-FSC           PIC ZZZZZZZZ9.99.                    
137000            15 PV-DELIM-FSC          PIC X(1) VALUE '~'.                  
137100            15 PV-FSC-SUMMARY        PIC X(1) VALUE 'Y'.                  
137200            15 PV-FSC-LENGTH         PIC 9(2) VALUE 13.                   
137300            15 PV-FSC-JUSTIFIED      PIC X(1) VALUE 'R'.                  
137400            15 FILLER                PIC X(1) VALUE SPACES.               
137500            15 PV-TOTAL-FSC          PIC ZZZZZZZZZZZ9.                    
137600            15 PV-DELIM-FSC-TOT      PIC X(1) VALUE '~'.                  
137700*                    IMPORT EXTENDED ESTIMATED LANDED COST                
137800         10 PV-FIELD-TTC.                                                 
137900            15 FILLER                PIC X(1) VALUE SPACES.               
138000            15 PV-HEADER-TTC-LEVEL-1 PIC X(12)                            
138100                         VALUE '    TOTAL   '.                            
138200            15 PV-DELIM-TTC-LEVEL-1  PIC X(1) VALUE '~'.                  
138300            15 FILLER                PIC X(1) VALUE SPACES.               
138400            15 PV-HEADER-TTC-LEVEL-2 PIC X(12)                            
138500                         VALUE '     COST   '.                            
138600            15 PV-DELIM-TTC-LEVEL-2  PIC X(1) VALUE '~'.                  
138700            15 FILLER                PIC X(1) VALUE SPACES.               
138800            15 PV-DATA-TTC           PIC ZZZZZZZZ9.99.                    
138900            15 PV-DELIM-TTC          PIC X(1) VALUE '~'.                  
139000            15 PV-TTC-SUMMARY        PIC X(1) VALUE 'Y'.                  
139100            15 PV-TTC-LENGTH         PIC 9(2) VALUE 13.                   
139200            15 PV-TTC-JUSTIFIED      PIC X(1) VALUE 'R'.                  
139300            15 FILLER                PIC X(1) VALUE SPACES.               
139400            15 PV-TOTAL-TTC          PIC ZZZZZZZZZZZ9.                    
139500            15 PV-DELIM-TTC-TOT      PIC X(1) VALUE '~'.                  
139600*                    TOTAL COST FOR VERIFIED UNITS                        
139700         10 PV-FIELD-TVC.                                                 
139800            15 FILLER                PIC X(1) VALUE SPACES.               
139900            15 PV-HEADER-TVC-LEVEL-1 PIC X(12)                            
140000                         VALUE '    TOT VER '.                            
140100            15 PV-DELIM-TVC-LEVEL-1  PIC X(1) VALUE '~'.                  
140200            15 FILLER                PIC X(1) VALUE SPACES.               
140300            15 PV-HEADER-TVC-LEVEL-2 PIC X(12)                            
140400                         VALUE '     COST   '.                            
140500            15 PV-DELIM-TVC-LEVEL-2  PIC X(1) VALUE '~'.                  
140600            15 FILLER                PIC X(1) VALUE SPACES.               
140700            15 PV-DATA-TVC           PIC ZZZZZZZZ9.99.                    
140800            15 PV-DELIM-TVC          PIC X(1) VALUE '~'.                  
140900            15 PV-TVC-SUMMARY        PIC X(1) VALUE 'Y'.                  
141000            15 PV-TVC-LENGTH         PIC 9(2) VALUE 13.                   
141100            15 PV-TVC-JUSTIFIED      PIC X(1) VALUE 'R'.                  
141200            15 FILLER                PIC X(1) VALUE SPACES.               
141300            15 PV-TOTAL-TVC          PIC ZZZZZZZZZZZ9.                    
141400            15 PV-DELIM-TVC-TOT      PIC X(1) VALUE '~'.                  
141500*                    UNITS ORDERED                                        
141600         10 PV-FIELD-UOR.                                                 
141700            15 FILLER                PIC X(6) VALUE SPACES.               
141800            15 PV-HEADER-UOR-LEVEL-1 PIC X(7) VALUE ' UNITS '.            
141900            15 PV-DELIM-UOR-LEVEL-1  PIC X(1) VALUE '~'.                  
142000            15 FILLER                PIC X(6) VALUE SPACES.               
142100            15 PV-HEADER-UOR-LEVEL-2 PIC X(7) VALUE '  ORD  '.            
142200            15 PV-DELIM-UOR-LEVEL-2  PIC X(1) VALUE '~'.                  
142300            15 FILLER                PIC X(4) VALUE SPACES.               
142400            15 PV-DATA-UOR           PIC ZZZZZZZZ9.                       
142500            15 PV-DELIM-UOR          PIC X(1) VALUE '~'.                  
142600            15 PV-UOR-SUMMARY        PIC X(1) VALUE 'Y'.                  
142700            15 PV-UOR-LENGTH         PIC 9(2) VALUE 10.                   
142800            15 PV-UOR-JUSTIFIED      PIC X(1) VALUE 'R'.                  
142900            15 FILLER                PIC X(4) VALUE SPACES.               
143000            15 PV-TOTAL-UOR          PIC ZZZZZZZZ9.                       
143100            15 PV-DELIM-UOR-TOT      PIC X(1) VALUE '~'.                  
143200*                    UNITS RECEIVED                                       
143300         10 PV-FIELD-URC.                                                 
143400            15 FILLER                PIC X(6) VALUE SPACES.               
143500            15 PV-HEADER-URC-LEVEL-1 PIC X(7) VALUE ' UNITS '.            
143600            15 PV-DELIM-URC-LEVEL-1  PIC X(1) VALUE '~'.                  
143700            15 FILLER                PIC X(6) VALUE SPACES.               
143800            15 PV-HEADER-URC-LEVEL-2 PIC X(7) VALUE ' RECVD '.            
143900            15 PV-DELIM-URC-LEVEL-2  PIC X(1) VALUE '~'.                  
144000            15 FILLER                PIC X(4) VALUE SPACES.               
144100            15 PV-DATA-URC           PIC ZZZZZZZZ9.                       
144200            15 PV-DELIM-URC          PIC X(1) VALUE '~'.                  
144300            15 PV-URC-SUMMARY        PIC X(1) VALUE 'Y'.                  
144400            15 PV-URC-LENGTH         PIC 9(2) VALUE 10.                   
144500            15 PV-URC-JUSTIFIED      PIC X(1) VALUE 'R'.                  
144600            15 FILLER                PIC X(4) VALUE SPACES.               
144700            15 PV-TOTAL-URC          PIC ZZZZZZZZ9.                       
144800            15 PV-DELIM-URC-TOT      PIC X(1) VALUE '~'.                  
144900*                    PERCENT OF UNITS RECEIVED                            
145000         10 PV-FIELD-URP.                                                 
145100            15 FILLER                PIC X(8) VALUE SPACES.               
145200            15 PV-0EADER-URP-LEVEL-1 PIC X(5) VALUE 'UNITS'.              
145300            15 PV-DELIM-URP-LEVEL-1  PIC X(1) VALUE '~'.                  
145400            15 FILLER                PIC X(8) VALUE SPACES.               
145500            15 PV-HEADER-URP-LEVEL-2 PIC X(5) VALUE '%RCVD'.              
145600            15 PV-DELIM-URP-LEVEL-2  PIC X(1) VALUE '~'.                  
145700            15 FILLER                PIC X(9) VALUE SPACES.               
145800            15 PV-DATA-URP           PIC ZZ9.                             
145900            15 FILLER                PIC X(1) VALUE '%'.                  
146000            15 PV-DELIM-URP          PIC X(1) VALUE '~'.                  
146100            15 PV-URP-SUMMARY        PIC X(1) VALUE 'Y'.                  
146200            15 PV-URP-LENGTH         PIC 9(2) VALUE 6.                    
146300            15 PV-URP-JUSTIFIED      PIC X(1) VALUE 'R'.                  
146400            15 FILLER                PIC X(9) VALUE SPACES.               
146500            15 PV-TOTAL-URP          PIC ZZ9.                             
146600            15 FILLER                PIC X(1) VALUE '%'.                  
146700            15 PV-DELIM-URP-TOT      PIC X(1) VALUE '~'.                  
146800*                    RETAIL DOLLARS ORDERED                               
146900         10 PV-FIELD-DOR.                                                 
147000            15 FILLER                PIC X(1) VALUE SPACES.               
147100            15 PV-HEADER-DOR-LEVEL-1 PIC X(12)                            
147200                         VALUE '   DOLLARS  '.                            
147300            15 PV-DELIM-DOR-LEVEL-1  PIC X(1) VALUE '~'.                  
147400            15 FILLER                PIC X(1) VALUE SPACES.               
147500            15 PV-HEADER-DOR-LEVEL-2 PIC X(12)                            
147600                         VALUE '   ORDERED  '.                            
147700            15 PV-DELIM-DOR-LEVEL-2  PIC X(1) VALUE '~'.                  
147800            15 FILLER                PIC X(1) VALUE SPACES.               
147900            15 PV-DATA-DOR           PIC ZZZZZZZZ9.99.                    
148000            15 PV-DELIM-DOR          PIC X(1) VALUE '~'.                  
148100            15 PV-DOR-SUMMARY        PIC X(1) VALUE 'Y'.                  
148200            15 PV-DOR-LENGTH         PIC 9(2) VALUE 13.                   
148300            15 PV-DOR-JUSTIFIED      PIC X(1) VALUE 'R'.                  
148400            15 FILLER                PIC X(1) VALUE SPACES.               
148500            15 PV-TOTAL-DOR          PIC ZZZZZZZZZZZ9.                    
148600            15 PV-DELIM-DOR-TOT      PIC X(1) VALUE '~'.                  
148700*                    RETAIL DOLLARS RECEIVED                              
148800         10 PV-FIELD-DRC.                                                 
148900            15 FILLER                PIC X(1) VALUE SPACES.               
149000            15 PV-HEADER-DRC-LEVEL-1 PIC X(12)                            
149100                         VALUE '   DOLLARS  '.                            
149200            15 PV-DELIM-DRC-LEVEL-1  PIC X(1) VALUE '~'.                  
149300            15 FILLER                PIC X(1) VALUE SPACES.               
149400            15 PV-HEADER-DRC-LEVEL-2 PIC X(12)                            
149500                         VALUE '    RECVD   '.                            
149600            15 PV-DELIM-DRC-LEVEL-2  PIC X(1) VALUE '~'.                  
149700            15 FILLER                PIC X(1) VALUE SPACES.               
149800            15 PV-DATA-DRC           PIC ZZZZZZZZ9.99.                    
149900            15 PV-DELIM-DRC          PIC X(1) VALUE '~'.                  
150000            15 PV-DRC-SUMMARY        PIC X(1) VALUE 'Y'.                  
150100            15 PV-DRC-LENGTH         PIC 9(2) VALUE 13.                   
150200            15 PV-DOR-JUSTIFIED      PIC X(1) VALUE 'R'.                  
150300            15 FILLER                PIC X(1) VALUE SPACES.               
150400            15 PV-TOTAL-DRC          PIC ZZZZZZZZZZZ9.                    
150500            15 PV-DELIM-DRC-TOT      PIC X(1) VALUE '~'.                  
150600*                    PERCENT OF RETAIL DOLLARS RECEIVED                   
150700         10 PV-FIELD-DRP.                                                 
150800            15 FILLER                PIC X(8) VALUE SPACES.               
150900            15 PV-HEADER-DRP-LEVEL-1 PIC X(5) VALUE 'DOLLR'.              
151000            15 PV-DELIM-DRP-LEVEL-1  PIC X(1) VALUE '~'.                  
151100            15 FILLER                PIC X(8) VALUE SPACES.               
151200            15 PV-HEADER-DRP-LEVEL-2 PIC X(5) VALUE '%RCVD'.              
151300            15 PV-DELIM-DRP-LEVEL-2  PIC X(1) VALUE '~'.                  
151400            15 FILLER                PIC X(9) VALUE SPACES.               
151500            15 PV-DATA-DRP           PIC ZZ9.                             
151600            15 FILLER                PIC X(1) VALUE '%'.                  
151700            15 PV-DELIM-DRP          PIC X(1) VALUE '~'.                  
151800            15 PV-DRP-SUMMARY        PIC X(1) VALUE 'Y'.                  
151900            15 PV-DRP-LENGTH         PIC 9(2) VALUE 6.                    
152000            15 PV-DRP-JUSTIFIED      PIC X(1) VALUE 'R'.                  
152100            15 FILLER                PIC X(9) VALUE SPACES.               
152200            15 PV-TOTAL-DRP          PIC ZZ9.                             
152300            15 FILLER                PIC X(1) VALUE '%'.                  
152400            15 PV-DELIM-DRP-TOT      PIC X(1) VALUE '~'.                  
152500*                    OPEN TO BUY                                          
152600         10 PV-FIELD-OTB.                                                 
152700            15 PV-HEADER-OTB-LEVEL-1 PIC X(4) VALUE '    '.               
152800            15 PV-DELIM-OTB-LEVEL-1  PIC X(1) VALUE '~'.                  
152900            15 FILLER                PIC X(9) VALUE SPACES.               
153000            15 PV-HEADER-OTB-LEVEL-2 PIC X(4) VALUE 'OTB '.               
153100            15 PV-DELIM-OTB-LEVEL-2  PIC X(1) VALUE '~'.                  
153200            15 FILLER                PIC X(9) VALUE SPACES.               
153300            15 PV-DATA-OTB           PIC X(4) VALUE SPACES.               
153400            15 PV-DELIM-OTB          PIC X(1) VALUE '~'.                  
153500            15 FILLER                PIC X(9) VALUE SPACES.               
153600            15 PV-OTB-SUMMARY        PIC X(1) VALUE 'N'.                  
153700            15 PV-OTB-LENGTH         PIC 9(2) VALUE 5.                    
153800            15 PV-OTB-JUSTIFIED      PIC X(1) VALUE 'L'.                  
153900            15 FILLER                PIC X(14) VALUE SPACES.              
154000*                    EDI INDICATOR                                        
154100         10 PV-FIELD-EDI.                                                 
154200            15 PV-HEADER-EDI-LEVEL-1 PIC X(3) VALUE '   '.                
154300            15 PV-DELIM-EDI-LEVEL-1  PIC X(1) VALUE '~'.                  
154400            15 FILLER                PIC X(10) VALUE SPACES.              
154500            15 PV-HEADER-EDI-LEVEL-2 PIC X(3) VALUE 'EDI'.                
154600            15 PV-DELIM-EDI-LEVEL-2  PIC X(1) VALUE '~'.                  
154700            15 FILLER                PIC X(10) VALUE SPACES.              
154800            15 FILLER                PIC X(1) VALUE SPACES.               
154900            15 PV-DATA-EDI           PIC X(1) VALUE SPACES.               
155000            15 FILLER                PIC X(1) VALUE SPACES.               
155100            15 PV-DELIM-EDI          PIC X(1) VALUE '~'.                  
155200            15 FILLER                PIC X(10) VALUE SPACES.              
155300            15 PV-EDI-SUMMARY        PIC X(1) VALUE 'N'.                  
155400            15 PV-EDI-LENGTH         PIC 9(2) VALUE 4.                    
155500            15 PV-EDI-JUSTIFIED      PIC X(1) VALUE 'L'.                  
155600            15 FILLER                PIC X(14) VALUE SPACES.              
155700*                    PREPACK VALUE                                        
155800         10 PV-FIELD-PPK.                                                 
155900            15 PV-HEADER-PPK-LEVEL-1 PIC X(4) VALUE 'PACK'.               
156000            15 PV-DELIM-PPK-LEVEL-1  PIC X(1) VALUE '~'.                  
156100            15 FILLER                PIC X(9) VALUE SPACES.               
156200            15 PV-HEADER-PPK-LEVEL-2 PIC X(4) VALUE 'TYPE'.               
156300            15 PV-DELIM-PPK-LEVEL-2  PIC X(1) VALUE '~'.                  
156400            15 FILLER                PIC X(9) VALUE SPACES.               
156500            15 FILLER                PIC X(1) VALUE SPACES.               
156600            15 PV-DATA-PPK           PIC X(1) VALUE SPACES.               
156700            15 FILLER                PIC X(2) VALUE SPACES.               
156800            15 PV-DELIM-PPK          PIC X(1) VALUE '~'.                  
156900            15 FILLER                PIC X(9) VALUE SPACES.               
157000            15 PV-PPK-SUMMARY        PIC X(1) VALUE 'N'.                  
157100            15 PV-PPK-LENGTH         PIC 9(2) VALUE 5.                    
157200            15 PV-PPK-JUSTIFIED      PIC X(1) VALUE 'L'.                  
157300            15 FILLER                PIC X(14) VALUE SPACES.              
157400*                    PURCHASE ORDER HEADER LEVEL STATUS                   
157500         10 PV-FIELD-STA.                                                 
157600            15 PV-HEADER-STA-LEVEL-1 PIC X(4) VALUE 'STAT'.               
157700            15 PV-DELIM-STA-LEVEL-1  PIC X(1) VALUE '~'.                  
157800            15 FILLER                PIC X(9) VALUE SPACES.               
157900            15 PV-HEADER-STA-LEVEL-2 PIC X(4) VALUE 'CODE'.               
158000            15 PV-DELIM-STA-LEVEL-2  PIC X(1) VALUE '~'.                  
158100            15 FILLER                PIC X(9) VALUE SPACES.               
158200            15 FILLER                PIC X(1) VALUE SPACES.               
158300            15 PV-DATA-STA           PIC X(2) VALUE SPACES.               
158400            15 FILLER                PIC X(1) VALUE SPACES.               
158500            15 PV-DELIM-STA          PIC X(1) VALUE '~'.                  
158600            15 FILLER                PIC X(9) VALUE SPACES.               
158700            15 PV-STA-SUMMARY        PIC X(1) VALUE 'N'.                  
158800            15 PV-STA-LENGTH         PIC 9(2) VALUE 5.                    
158900            15 PV-STA-JUSTIFIED      PIC X(1) VALUE 'L'.                  
159000            15 FILLER                PIC X(14) VALUE SPACES.              
159100*                    MINIMUM AD EVENT DATE                                
159200         10 PV-FIELD-AED.                                                 
159300            15 PV-HEADER-AED-LEVEL-1 PIC X(10) VALUE '   AD     '.        
159400            15 PV-DELIM-AED-LEVEL-1  PIC X(1) VALUE '~'.                  
159500            15 FILLER                PIC X(3) VALUE SPACES.               
159600            15 PV-HEADER-AED-LEVEL-2 PIC X(10) VALUE '   DATE   '.        
159700            15 PV-DELIM-AED-LEVEL-2  PIC X(1) VALUE '~'.                  
159800            15 FILLER                PIC X(3) VALUE SPACES.               
159900            15 PV-DATA-AED           PIC X(10) VALUE SPACES.              
160000            15 PV-DELIM-AED          PIC X(1) VALUE '~'.                  
160100            15 FILLER                PIC X(3) VALUE SPACES.               
160200            15 PV-AED-SUMMARY        PIC X(1) VALUE 'N'.                  
160300            15 PV-AED-LENGTH         PIC 9(2) VALUE 11.                   
160400            15 PV-AED-JUSTIFIED      PIC X(1) VALUE 'L'.                  
160500            15 FILLER                PIC X(14) VALUE SPACES.              
160600*                    TRIP TYPE                                            
160700         10 PV-FIELD-TRP.                                                 
160800            15 PV-HEADER-TRP-LEVEL-1 PIC X(4) VALUE 'TRIP'.               
160900            15 PV-DELIM-TRP-LEVEL-1  PIC X(1) VALUE '~'.                  
161000            15 FILLER                PIC X(9) VALUE SPACES.               
161100            15 PV-HEADER-TRP-LEVEL-2 PIC X(4) VALUE 'TYPE'.               
161200            15 PV-DELIM-TRP-LEVEL-2  PIC X(1) VALUE '~'.                  
161300            15 FILLER                PIC X(9) VALUE SPACES.               
161400            15 PV-DATA-TRP           PIC X(3) VALUE SPACES.               
161500            15 FILLER                PIC X(1) VALUE SPACES.               
161600            15 PV-DELIM-TRP          PIC X(1) VALUE '~'.                  
161700            15 FILLER                PIC X(9) VALUE SPACES.               
161800            15 PV-TRP-SUMMARY        PIC X(1) VALUE 'N'.                  
161900            15 PV-TRP-LENGTH         PIC 9(2) VALUE 5.                    
162000            15 PV-TRP-JUSTIFIED      PIC X(1) VALUE 'L'.                  
162100            15 FILLER                PIC X(14) VALUE SPACES.              
162200*                    DC SPLITS CREATED                                    
162300         10 PV-FIELD-SPL-CRT.                                             
162400            15 PV-HEADER-SPL-CRT-LEVEL-1 PIC X(10) VALUE                  
162500                                                   '  SPLITS  '.          
162600            15 PV-DELIM-SPL-CRT-LEVEL-1  PIC X(1) VALUE '~'.              
162700            15 FILLER                    PIC X(3) VALUE SPACES.           
162800            15 PV-HEADER-SPL-CRT-LEVEL-2 PIC X(10) VALUE                  
162900                                                   '  CREATE  '.          
163000            15 PV-DELIM-SPL-CRT-LEVEL-2  PIC X(1) VALUE '~'.              
163100            15 FILLER                    PIC X(3) VALUE SPACES.           
163200            15 PV-DATA-SPL-CRT           PIC X(10) VALUE SPACES.          
163300            15 PV-DELIM-SPL-CRT          PIC X(1) VALUE '~'.              
163400            15 FILLER                    PIC X(3) VALUE SPACES.           
163500            15 PV-SPL-CRT-SUMMARY        PIC X(1) VALUE 'N'.              
163600            15 PV-SPL-CRT-LENGTH         PIC 9(2) VALUE 11.               
163700            15 PV-SPL-CRT-JUSTIFIED      PIC X(1) VALUE 'L'.              
163800            15 FILLER                    PIC X(14) VALUE SPACES.          
163900*                    DC SPLITS SENT                                       
164000         10 PV-FIELD-SPL-SNT.                                             
164100            15 PV-HEADER-SPL-SNT-LEVEL-1 PIC X(10) VALUE                  
164200                                                   '  SPLT TO '.          
164300            15 PV-DELIM-SPL-SNT-LEVEL-1  PIC X(1) VALUE '~'.              
164400            15 FILLER                    PIC X(3) VALUE SPACES.           
164500            15 PV-HEADER-SPL-SNT-LEVEL-2 PIC X(10) VALUE                  
164600                                                   '  DECONSL '.          
164700            15 PV-DELIM-SPL-SNT-LEVEL-2  PIC X(1) VALUE '~'.              
164800            15 FILLER                    PIC X(3) VALUE SPACES.           
164900            15 PV-DATA-SPL-SNT           PIC X(10) VALUE SPACES.          
165000            15 PV-DELIM-SPL-SNT          PIC X(1) VALUE '~'.              
165100            15 FILLER                    PIC X(3) VALUE SPACES.           
165200            15 PV-SPL-SNT-SUMMARY        PIC X(1) VALUE 'N'.              
165300            15 PV-SPL-SNT-LENGTH         PIC 9(2) VALUE 11.               
165400            15 PV-SPL-SNT-JUSTIFIED      PIC X(1) VALUE 'L'.              
165500            15 FILLER                    PIC X(14) VALUE SPACES.          
165600*                    STORE DISTRO                                         
165700         10 PV-FIELD-STD.                                                 
165800            15 PV-HEADER-STD-LEVEL-1     PIC X(6)  VALUE                  
165900                                                   'STORE '.              
166000            15 PV-DELIM-STD-LEVEL-1      PIC X(1) VALUE '~'.              
166100            15 FILLER                    PIC X(07) VALUE SPACES.          
166200            15 PV-HEADER-STD-LEVEL-2     PIC X(6)  VALUE                  
166300                                                   'DISTRO'.              
166400            15 PV-DELIM-STD-LEVEL-2      PIC X(1) VALUE '~'.              
166500            15 FILLER                    PIC X(07) VALUE SPACES.          
166600            15 PV-DATA-STD               PIC X(01) VALUE SPACES.          
166700            15 FILLER                    PIC X(05) VALUE SPACES.          
166800            15 PV-DELIM-STD              PIC X(1) VALUE '~'.              
166900            15 FILLER                    PIC X(05) VALUE SPACES.          
167000            15 FILLER                    PIC X(02) VALUE SPACES.          
167100            15 PV-SPL-STD-SUMMARY        PIC X(1) VALUE 'N'.              
167200            15 PV-SPL-STD-LENGTH         PIC 9(2) VALUE 7.                
167300            15 PV-SPL-STD-JUSTIFIED      PIC X(1) VALUE 'L'.              
167400            15 FILLER                    PIC X(14) VALUE SPACES.          
167500*                    QUOTA CATEGORY                                       
167600         10 PV-FIELD-QCT.                                                 
167700            15 PV-HEADER-QCT-LEVEL-1     PIC X(5)  VALUE                  
167800                                                   'QUOTA'.               
167900            15 PV-DELIM-QCT-LEVEL-1      PIC X(1) VALUE '~'.              
168000            15 FILLER                    PIC X(8) VALUE SPACES.           
168100            15 PV-HEADER-QCT-LEVEL-2     PIC X(5)  VALUE                  
168200                                                   'CATEG'.               
168300            15 PV-DELIM-QCT-LEVEL-2      PIC X(1) VALUE '~'.              
168400            15 FILLER                    PIC X(8) VALUE SPACES.           
168500            15 PV-DATA-QCT               PIC X(5) VALUE SPACES.           
168600            15 PV-DELIM-QCT              PIC X(1) VALUE '~'.              
168700            15 FILLER                    PIC X(8) VALUE SPACES.           
168800            15 PV-QCT-SUMMARY            PIC X(1) VALUE 'N'.              
168900            15 PV-QCT-LENGTH             PIC 9(2) VALUE 6.                
169000            15 PV-QCT-JUSTIFIED          PIC X(1) VALUE 'L'.              
169100            15 FILLER                    PIC X(14) VALUE SPACES.          
169200*                    VENDOR STYLE                                         
169300         10 PV-FIELD-VNS.                                                 
169400            15 PV-HEADER-VNS-LEVEL-1     PIC X(8)  VALUE                  
169500                                                   'VENDOR  '.            
169600            15 PV-DELIM-VNS-LEVEL-1      PIC X(1) VALUE '~'.              
169700            15 FILLER                    PIC X(5) VALUE SPACES.           
169800            15 PV-HEADER-VNS-LEVEL-2     PIC X(8)  VALUE                  
169900                                                   'STYLE   '.            
170000            15 PV-DELIM-VNS-LEVEL-2      PIC X(1) VALUE '~'.              
170100            15 FILLER                    PIC X(5) VALUE SPACES.           
170200            15 PV-DATA-VNS               PIC X(8) VALUE SPACES.           
170300            15 PV-DELIM-VNS              PIC X(1) VALUE '~'.              
170400            15 FILLER                    PIC X(5) VALUE SPACES.           
170500            15 PV-VNS-SUMMARY            PIC X(1) VALUE 'N'.              
170600            15 PV-VNS-LENGTH             PIC 9(2) VALUE 9.                
170700            15 PV-VNS-JUSTIFIED          PIC X(1) VALUE 'L'.              
170800            15 FILLER                    PIC X(14) VALUE SPACES.          
170900*                    CONTAINER RELEASE                                    
171000         10 PV-FIELD-CRL.                                                 
171100            15 PV-HEADER-CRL-LEVEL-1     PIC X(7)  VALUE                  
171200                                                   'CONTNR '.             
171300            15 PV-DELIM-CRL-LEVEL-1      PIC X(1) VALUE '~'.              
171400            15 FILLER                    PIC X(6) VALUE SPACES.           
171500            15 PV-HEADER-CRL-LEVEL-2     PIC X(7)  VALUE                  
171600                                                   'RELEASE'.             
171700            15 PV-DELIM-CRL-LEVEL-2      PIC X(1) VALUE '~'.              
171800            15 FILLER                    PIC X(06) VALUE SPACES.          
171900            15 PV-DATA-CRL               PIC X(05) VALUE SPACES.          
172000            15 FILLER                    PIC X(02) VALUE SPACES.          
172100            15 PV-DELIM-CRL              PIC X(1) VALUE '~'.              
172200            15 FILLER                    PIC X(06) VALUE SPACES.          
172300            15 PV-CRL-SUMMARY            PIC X(1) VALUE 'N'.              
172400            15 PV-CRL-LENGTH             PIC 9(2) VALUE 8.                
172500            15 PV-CRL-JUSTIFIED          PIC X(1) VALUE 'L'.              
172600            15 FILLER                    PIC X(14) VALUE SPACES.          
172700*                    TRAILER AVAILABLE                                    
172800         10 PV-FIELD-TRA.                                                 
172900            15 PV-HEADER-TRA-LEVEL-1     PIC X(5)  VALUE                  
173000                                                   'TRLR '.               
173100            15 PV-DELIM-TRA-LEVEL-1      PIC X(1) VALUE '~'.              
173200            15 FILLER                    PIC X(8) VALUE SPACES.           
173300            15 PV-HEADER-TRA-LEVEL-2     PIC X(5)  VALUE                  
173400                                                   'AVAIL'.               
173500            15 PV-DELIM-TRA-LEVEL-2      PIC X(1) VALUE '~'.              
173600            15 FILLER                    PIC X(08) VALUE SPACES.          
173700            15 PV-DATA-TRA               PIC X(05) VALUE SPACES.          
173800            15 PV-DELIM-TRA              PIC X(1) VALUE '~'.              
173900            15 FILLER                    PIC X(08) VALUE SPACES.          
174000            15 PV-TRA-SUMMARY            PIC X(1) VALUE 'N'.              
174100            15 PV-TRA-LENGTH             PIC 9(2) VALUE 6.                
174200            15 PV-TRA-JUSTIFIED          PIC X(1) VALUE 'L'.              
174300            15 FILLER                    PIC X(14) VALUE SPACES.          
174400                                                                          
174500*---------------------------------------------------------------*         
174600*    PV-VARIABLE-DATA-FIELDS REDEFINED AS AN ARRAY                        
174700*---------------------------------------------------------------*         
174800     05  PV-VFLD-TABLE REDEFINES PV-VARIABLE-DATA-FIELDS.                 
174900         10  PV-VFLD-TABLE-VALUES                                         
175000               OCCURS 47 TIMES                                            
175100                 INDEXED BY VFLD-I.                                       
175200             15 PV-HEADER-LEVEL-1     PIC X(14).                          
175300             15 PV-HEADER-LEVEL-2     PIC X(14).                          
175400             15 PV-DATA               PIC X(14).                          
175500             15 PV-SUMMARY            PIC X(1).                           
175600             15 PV-LENGTH             PIC 9(2).                           
175700             15 PV-JUSTIFIED          PIC X(1).                           
175800             15 PV-TOTAL              PIC X(14).                          
175900*---------------------------------------------------------------*         
176000*    #VERY_IMPORTANT ===>                                       *         
176100*    RELATED FIELDS TO CONTROL VARIABLE DISPLAY                 *         
176200*    THE FOLLOWING CONTROL FIELDS SHOULD NEVER CHANGE           *         
176300*    AFTER START UP. MODIFYING THE CONTENTS OUTSIDE OF          *         
176400*    THE INITIAL SET UP STAGE WILL CAUSE UNPREDICTABLE RESULTS  *         
176500*---------------------------------------------------------------*         
176600     05  PV-VARIABLE-CONTROL-FIELDS.                                      
176700*                    FOB CODE                                             
176800         10 PV-CONTROL-FOB.                                               
176900            15 PV-FOB-OORDER         PIC 9(2) VALUE 99.                   
177000            15 PV-FOB-POINTER        PIC 9(2) VALUE ZEROS.                
177100            15 PV-FOB-SELECTED       PIC X(1) VALUE 'N'.                  
177200            15 PV-FOB-ONVSCREEN      PIC 9(2) VALUE ZERO.                 
177300            15 PV-FOB-VFLD-SPACING   PIC 9(1) VALUE 0.                    
177400*                    POE CODE                                             
177500         10 PV-CONTROL-POE.                                               
177600            15 PV-POE-OORDER         PIC 9(2) VALUE 99.                   
177700            15 PV-POE-POINTER        PIC 9(2) VALUE ZEROS.                
177800            15 PV-POE-SELECTED       PIC X(1) VALUE 'N'.                  
177900            15 PV-POE-ONVSCREEN      PIC 9(2) VALUE ZERO.                 
178000            15 PV-POE-VFLD-SPACING   PIC 9(1) VALUE 0.                    
178100*                    DONT SHIP BY DATE                                    
178200         10 PV-CONTROL-DSB.                                               
178300            15 PV-DSB-OORDER         PIC 9(2) VALUE 99.                   
178400            15 PV-DSB-POINTER        PIC 9(2) VALUE ZEROS.                
178500            15 PV-DSB-SELECTED       PIC X(1) VALUE 'N'.                  
178600            15 PV-DSB-ONVSCREEN      PIC 9(2) VALUE ZERO.                 
178700            15 PV-DSB-VFLD-SPACING   PIC 9(1) VALUE 0.                    
178800*                   START XFACTORY DATE                                   
178900         10 PV-CONTROL-SXF.                                               
179000            15 PV-SXF-OORDER         PIC 9(2) VALUE 99.                   
179100            15 PV-SXF-POINTER        PIC 9(2) VALUE ZEROS.                
179200            15 PV-SXF-SELECTED       PIC X(1) VALUE 'N'.                  
179300            15 PV-SXF-ONVSCREEN      PIC 9(2) VALUE ZERO.                 
179400            15 PV-SXF-VFLD-SPACING   PIC 9(1) VALUE 0.                    
179500*                    LAST XFACTORY DATE                                   
179600         10 PV-CONTROL-LXF.                                               
179700            15 PV-LXF-OORDER         PIC 9(2) VALUE 99.                   
179800            15 PV-LXF-POINTER        PIC 9(2) VALUE ZEROS.                
179900            15 PV-LXF-SELECTED       PIC X(1) VALUE 'N'.                  
180000            15 PV-LXF-ONVSCREEN      PIC 9(2) VALUE ZERO.                 
180100            15 PV-LXF-VFLD-SPACING   PIC 9(1) VALUE 0.                    
180200*                    CANCEL OR EXTENDED CANCEL DATE                       
180300         10 PV-CONTROL-CNL.                                               
180400            15 PV-CNL-OORDER         PIC 9(2) VALUE 99.                   
180500            15 PV-CNL-POINTER        PIC 9(2) VALUE ZEROS.                
180600            15 PV-CNL-SELECTED       PIC X(1) VALUE 'N'.                  
180700            15 PV-CNL-ONVSCREEN      PIC 9(2) VALUE ZERO.                 
180800            15 PV-CNL-VFLD-SPACING   PIC 9(1) VALUE 0.                    
180900*                    FOB OVERSEAS RECEIPT DATE                            
181000         10 PV-CONTROL-FRD.                                               
181100            15 PV-FRD-OORDER         PIC 9(2) VALUE 99.                   
181200            15 PV-FRD-POINTER        PIC 9(2) VALUE ZEROS.                
181300            15 PV-FRD-SELECTED       PIC X(1) VALUE 'N'.                  
181400            15 PV-FRD-ONVSCREEN      PIC 9(2) VALUE ZERO.                 
181500            15 PV-FRD-VFLD-SPACING   PIC 9(1) VALUE 0.                    
181600*                    IMPORT SAIL DATE                                     
181700         10 PV-CONTROL-SLD.                                               
181800            15 PV-SLD-OORDER         PIC 9(2) VALUE 99.                   
181900            15 PV-SLD-POINTER        PIC 9(2) VALUE ZEROS.                
182000            15 PV-SLD-SELECTED       PIC X(1) VALUE 'N'.                  
182100            15 PV-SLD-ONVSCREEN      PIC 9(2) VALUE ZERO.                 
182200            15 PV-SLD-VFLD-SPACING   PIC 9(1) VALUE 0.                    
182300*                    PORT ARRIVAL DATE                                    
182400         10 PV-CONTROL-PRD.                                               
182500            15 PV-PRD-OORDER         PIC 9(2) VALUE 99.                   
182600            15 PV-PRD-POINTER        PIC 9(2) VALUE ZEROS.                
182700            15 PV-PRD-SELECTED       PIC X(1) VALUE 'N'.                  
182800            15 PV-PRD-ONVSCREEN      PIC 9(2) VALUE ZERO.                 
182900            15 PV-PRD-VFLD-SPACING   PIC 9(1) VALUE 0.                    
183000*                    CONTAINER ID                                         
183100         10 PV-CONTROL-CNT.                                               
183200            15 PV-CNT-OORDER         PIC 9(2) VALUE 99.                   
183300            15 PV-CNT-POINTER        PIC 9(2) VALUE ZEROS.                
183400            15 PV-CNT-SELECTED       PIC X(1) VALUE 'N'.                  
183500            15 PV-CNT-ONVSCREEN      PIC 9(2) VALUE ZERO.                 
183600            15 PV-CNT-VFLD-SPACING   PIC 9(1) VALUE 0.                    
183700*                    CUSTOMS RELEASE DATE                                 
183800         10 PV-CONTROL-CSR.                                               
183900            15 PV-CSR-OORDER         PIC 9(2) VALUE 99.                   
184000            15 PV-CSR-POINTER        PIC 9(2) VALUE ZEROS.                
184100            15 PV-CSR-SELECTED       PIC X(1) VALUE 'N'.                  
184200            15 PV-CSR-ONVSCREEN      PIC 9(2) VALUE ZERO.                 
184300            15 PV-CSR-VFLD-SPACING   PIC 9(1) VALUE 0.                    
184400*                    ETA TO DC 1                                          
184500         10 PV-CONTROL-DC1.                                               
184600            15 PV-DC1-OORDER         PIC 9(2) VALUE 99.                   
184700            15 PV-DC1-POINTER        PIC 9(2) VALUE ZEROS.                
184800            15 PV-DC1-SELECTED       PIC X(1) VALUE 'N'.                  
184900            15 PV-DC1-ONVSCREEN      PIC 9(2) VALUE ZERO.                 
185000            15 PV-DC1-VFLD-SPACING   PIC 9(1) VALUE 0.                    
185100*                    ETA TO DC 2                                          
185200         10 PV-CONTROL-DC2.                                               
185300            15 PV-DC2-OORDER         PIC 9(2) VALUE 99.                   
185400            15 PV-DC2-POINTER        PIC 9(2) VALUE ZEROS.                
185500            15 PV-DC2-SELECTED       PIC X(1) VALUE 'N'.                  
185600            15 PV-DC2-ONVSCREEN      PIC 9(2) VALUE ZERO.                 
185700            15 PV-DC2-VFLD-SPACING   PIC 9(1) VALUE 0.                    
185800*                    ETA TO DC 3                                          
185900         10 PV-CONTROL-DC3.                                               
186000            15 PV-DC3-OORDER         PIC 9(2) VALUE 99.                   
186100            15 PV-DC3-POINTER        PIC 9(2) VALUE ZEROS.                
186200            15 PV-DC3-SELECTED       PIC X(1) VALUE 'N'.                  
186300            15 PV-DC3-ONVSCREEN      PIC 9(2) VALUE ZERO.                 
186400            15 PV-DC3-VFLD-SPACING   PIC 9(1) VALUE 0.                    
186500*                    ETA TO DC 4                                          
186600         10 PV-CONTROL-DC4.                                               
186700            15 PV-DC4-OORDER         PIC 9(2) VALUE 99.                   
186800            15 PV-DC4-POINTER        PIC 9(2) VALUE ZEROS.                
186900            15 PV-DC4-SELECTED       PIC X(1) VALUE 'N'.                  
187000            15 PV-DC4-ONVSCREEN      PIC 9(2) VALUE ZERO.                 
187100            15 PV-DC4-VFLD-SPACING   PIC 9(1) VALUE 0.                    
187200*                    ETA TO DC 5                                          
187300         10 PV-CONTROL-DC5.                                               
187400            15 PV-DC5-OORDER         PIC 9(2) VALUE 99.                   
187500            15 PV-DC5-POINTER        PIC 9(2) VALUE ZEROS.                
187600            15 PV-DC5-SELECTED       PIC X(1) VALUE 'N'.                  
187700            15 PV-DC5-ONVSCREEN      PIC 9(2) VALUE ZERO.                 
187800            15 PV-DC5-VFLD-SPACING   PIC 9(1) VALUE 0.                    
187900*                    ETA TO DC 6                                          
188000         10 PV-CONTROL-DC6.                                               
188100            15 PV-DC6-OORDER         PIC 9(2) VALUE 99.                   
188200            15 PV-DC6-POINTER        PIC 9(2) VALUE ZEROS.                
188300            15 PV-DC6-SELECTED       PIC X(1) VALUE 'N'.                  
188400            15 PV-DC6-ONVSCREEN      PIC 9(2) VALUE ZERO.                 
188500            15 PV-DC6-VFLD-SPACING   PIC 9(1) VALUE 0.                    
188600*                    ETA TO DC 7                                          
188700         10 PV-CONTROL-DC7.                                               
188800            15 PV-DC7-OORDER         PIC 9(2) VALUE 99.                   
188900            15 PV-DC7-POINTER        PIC 9(2) VALUE ZEROS.                
189000            15 PV-DC7-SELECTED       PIC X(1) VALUE 'N'.                  
189100            15 PV-DC7-ONVSCREEN      PIC 9(2) VALUE ZERO.                 
189200            15 PV-DC7-VFLD-SPACING   PIC 9(1) VALUE 0.                    
189300*                    ETA TO DC 8                                          
189400         10 PV-CONTROL-DC8.                                               
189500            15 PV-DC8-OORDER         PIC 9(2) VALUE 99.                   
189600            15 PV-DC8-POINTER        PIC 9(2) VALUE ZEROS.                
189700            15 PV-DC8-SELECTED       PIC X(1) VALUE 'N'.                  
189800            15 PV-DC8-ONVSCREEN      PIC 9(2) VALUE ZERO.                 
189900            15 PV-DC8-VFLD-SPACING   PIC 9(1) VALUE 0.                    
190000*                    ETA TO DC 9                                          
190100         10 PV-CONTROL-DC9.                                               
190200            15 PV-DC9-OORDER         PIC 9(2) VALUE 99.                   
190300            15 PV-DC9-POINTER        PIC 9(2) VALUE ZEROS.                
190400            15 PV-DC9-SELECTED       PIC X(1) VALUE 'N'.                  
190500            15 PV-DC9-ONVSCREEN      PIC 9(2) VALUE ZERO.                 
190600            15 PV-DC9-VFLD-SPACING   PIC 9(1) VALUE 0.                    
190700*                    ETA TO DC 10                                         
190800         10 PV-CONTROL-DC10.                                              
190900            15 PV-DC10-OORDER        PIC 9(2) VALUE 99.                   
191000            15 PV-DC10-POINTER       PIC 9(2) VALUE ZEROS.                
191100            15 PV-DC10-SELECTED      PIC X(1) VALUE 'N'.                  
191200            15 PV-DC10-ONVSCREEN     PIC 9(2) VALUE ZERO.                 
191300            15 PV-DC10-VFLD-SPACING  PIC 9(1) VALUE 0.                    
191400*                    ETA TO DC 11                                         
191500         10 PV-CONTROL-DC11.                                              
191600            15 PV-DC11-OORDER        PIC 9(2) VALUE 99.                   
191700            15 PV-DC11-POINTER       PIC 9(2) VALUE ZEROS.                
191800            15 PV-DC11-SELECTED      PIC X(1) VALUE 'N'.                  
191900            15 PV-DC11-ONVSCREEN     PIC 9(2) VALUE ZERO.                 
192000            15 PV-DC11-VFLD-SPACING  PIC 9(1) VALUE 0.                    
192100*                    ETA TO DC 12                                         
192200         10 PV-CONTROL-DC12.                                              
192300            15 PV-DC12-OORDER        PIC 9(2) VALUE 99.                   
192400            15 PV-DC12-POINTER       PIC 9(2) VALUE ZEROS.                
192500            15 PV-DC12-SELECTED      PIC X(1) VALUE 'N'.                  
192600            15 PV-DC12-ONVSCREEN     PIC 9(2) VALUE ZERO.                 
192700            15 PV-DC12-VFLD-SPACING  PIC 9(1) VALUE 0.                    
192800*                    DEVAN DATE AT DECONSOLIDATOR                         
192900         10 PV-CONTROL-DVN.                                               
193000            15 PV-DVN-OORDER         PIC 9(2) VALUE 99.                   
193100            15 PV-DVN-POINTER        PIC 9(2) VALUE ZEROS.                
193200            15 PV-DVN-SELECTED       PIC X(1) VALUE 'N'.                  
193300            15 PV-DVN-ONVSCREEN      PIC 9(2) VALUE ZERO.                 
193400            15 PV-DVN-VFLD-SPACING   PIC 9(1) VALUE 0.                    
193500*                    OVERSEAS BOOKING DATE                                
193600         10 PV-CONTROL-BKD.                                               
193700            15 PV-BKD-OORDER         PIC 9(2) VALUE 99.                   
193800            15 PV-BKD-POINTER        PIC 9(2) VALUE ZEROS.                
193900            15 PV-BKD-SELECTED       PIC X(1) VALUE 'N'.                  
194000            15 PV-BKD-ONVSCREEN      PIC 9(2) VALUE ZERO.                 
194100            15 PV-BKD-VFLD-SPACING   PIC 9(1) VALUE 0.                    
194200*                    IMPORT EXTENDED FIRST COST                           
194300         10 PV-CONTROL-FSC.                                               
194400            15 PV-FSC-OORDER         PIC 9(2) VALUE 99.                   
194500            15 PV-FSC-POINTER        PIC 9(2) VALUE ZEROS.                
194600            15 PV-FSC-SELECTED       PIC X(1) VALUE 'N'.                  
194700            15 PV-FSC-ONVSCREEN      PIC 9(2) VALUE ZERO.                 
194800            15 PV-FSC-VFLD-SPACING   PIC 9(1) VALUE 0.                    
194900*                    IMPORT EXTENDED ESTIMATED LANDED COST                
195000         10 PV-CONTROL-TTC.                                               
195100            15 PV-TTC-OORDER         PIC 9(2) VALUE 99.                   
195200            15 PV-TTC-POINTER        PIC 9(2) VALUE ZEROS.                
195300            15 PV-TTC-SELECTED       PIC X(1) VALUE 'N'.                  
195400            15 PV-TTC-ONVSCREEN      PIC 9(2) VALUE ZERO.                 
195500            15 PV-TTC-VFLD-SPACING   PIC 9(1) VALUE 0.                    
195600*                    TOTAL COST FOR VERIFIED UNITS                        
195700         10 PV-CONTROL-TVC.                                               
195800            15 PV-TVC-OORDER         PIC 9(2) VALUE 99.                   
195900            15 PV-TVC-POINTER        PIC 9(2) VALUE ZEROS.                
196000            15 PV-TVC-SELECTED       PIC X(1) VALUE 'N'.                  
196100            15 PV-TVC-ONVSCREEN      PIC 9(2) VALUE ZERO.                 
196200            15 PV-TVC-VFLD-SPACING   PIC 9(1) VALUE 0.                    
196300*                    UNITS ORDERED                                        
196400         10 PV-CONTROL-UOR.                                               
196500            15 PV-UOR-OORDER         PIC 9(2) VALUE 99.                   
196600            15 PV-UOR-POINTER        PIC 9(2) VALUE ZEROS.                
196700            15 PV-UOR-SELECTED       PIC X(1) VALUE 'N'.                  
196800            15 PV-UOR-ONVSCREEN      PIC 9(2) VALUE ZERO.                 
196900            15 PV-UOR-VFLD-SPACING   PIC 9(1) VALUE 0.                    
197000*                    UNITS RECEIVED                                       
197100         10 PV-CONTROL-URC.                                               
197200            15 PV-URC-OORDER         PIC 9(2) VALUE 99.                   
197300            15 PV-URC-POINTER        PIC 9(2) VALUE ZEROS.                
197400            15 PV-URC-SELECTED       PIC X(1) VALUE 'N'.                  
197500            15 PV-URC-ONVSCREEN      PIC 9(2) VALUE ZERO.                 
197600            15 PV-URC-VFLD-SPACING   PIC 9(1) VALUE 0.                    
197700*                    PERCENT OF UNITS RECEIVED                            
197800         10 PV-CONTROL-URP.                                               
197900            15 PV-URP-OORDER         PIC 9(2) VALUE 99.                   
198000            15 PV-URP-POINTER        PIC 9(2) VALUE ZEROS.                
198100            15 PV-URP-SELECTED       PIC X(1) VALUE 'N'.                  
198200            15 PV-URP-ONVSCREEN      PIC 9(2) VALUE ZERO.                 
198300            15 PV-URP-VFLD-SPACING   PIC 9(1) VALUE 0.                    
198400*                    RETAIL DOLLARS ORDERED                               
198500         10 PV-CONTROL-DOR.                                               
198600            15 PV-DOR-OORDER         PIC 9(2) VALUE 99.                   
198700            15 PV-DOR-POINTER        PIC 9(2) VALUE ZEROS.                
198800            15 PV-DOR-SELECTED       PIC X(1) VALUE 'N'.                  
198900            15 PV-DOR-ONVSCREEN      PIC 9(2) VALUE ZERO.                 
199000            15 PV-DOR-VFLD-SPACING   PIC 9(1) VALUE 0.                    
199100*                    RETAIL DOLLARS RECEIVED                              
199200         10 PV-CONTROL-DRC.                                               
199300            15 PV-DRC-OORDER         PIC 9(2) VALUE 99.                   
199400            15 PV-DRC-POINTER        PIC 9(2) VALUE ZEROS.                
199500            15 PV-DRC-SELECTED       PIC X(1) VALUE 'N'.                  
199600            15 PV-DRC-ONVSCREEN      PIC 9(2) VALUE ZERO.                 
199700            15 PV-DRC-VFLD-SPACING   PIC 9(1) VALUE 0.                    
199800*                    PERCENT OF RETAIL DOLLARS RECEIVED                   
199900         10 PV-CONTROL-DRP.                                               
200000            15 PV-DRP-OORDER         PIC 9(2) VALUE 99.                   
200100            15 PV-DRP-POINTER        PIC 9(2) VALUE ZEROS.                
200200            15 PV-DRP-SELECTED       PIC X(1) VALUE 'N'.                  
200300            15 PV-DRP-ONVSCREEN      PIC 9(2) VALUE ZERO.                 
200400            15 PV-DRP-VFLD-SPACING   PIC 9(1) VALUE 0.                    
200500*                    OPEN TO BUY                                          
200600         10 PV-CONTROL-OTB.                                               
200700            15 PV-OTB-OORDER         PIC 9(2) VALUE 99.                   
200800            15 PV-OTB-POINTER        PIC 9(2) VALUE ZEROS.                
200900            15 PV-OTB-SELECTED       PIC X(1) VALUE 'N'.                  
201000            15 PV-OTB-ONVSCREEN      PIC 9(2) VALUE ZERO.                 
201100            15 PV-OTB-VFLD-SPACING   PIC 9(1) VALUE 0.                    
201200*                    EDI INDICATOR                                        
201300         10 PV-CONTROL-EDI.                                               
201400            15 PV-EDI-OORDER         PIC 9(2) VALUE 99.                   
201500            15 PV-EDI-POINTER        PIC 9(2) VALUE ZEROS.                
201600            15 PV-EDI-SELECTED       PIC X(1) VALUE 'N'.                  
201700            15 PV-EDI-ONVSCREEN      PIC 9(2) VALUE ZERO.                 
201800            15 PV-EDI-VFLD-SPACING   PIC 9(1) VALUE 0.                    
201900*                    PREPACK VALUE                                        
202000         10 PV-CONTROL-PPK.                                               
202100            15 PV-PPK-OORDER         PIC 9(2) VALUE 99.                   
202200            15 PV-PPK-POINTER        PIC 9(2) VALUE ZEROS.                
202300            15 PV-PPK-SELECTED       PIC X(1) VALUE 'N'.                  
202400            15 PV-PPK-ONVSCREEN      PIC 9(2) VALUE ZERO.                 
202500            15 PV-PPK-VFLD-SPACING   PIC 9(1) VALUE 0.                    
202600*                    PURCHASE ORDER HEADER LEVEL STATUS                   
202700         10 PV-CONTROL-STA.                                               
202800            15 PV-STA-OORDER         PIC 9(2) VALUE 99.                   
202900            15 PV-STA-POINTER        PIC 9(2) VALUE ZEROS.                
203000            15 PV-STA-SELECTED       PIC X(1) VALUE 'N'.                  
203100            15 PV-STA-ONVSCREEN      PIC 9(2) VALUE ZERO.                 
203200            15 PV-STA-VFLD-SPACING   PIC 9(1) VALUE 0.                    
203300*                    MINIMUM AD EVENT DATE                                
203400         10 PV-CONTROL-AED.                                               
203500            15 PV-AED-OORDER         PIC 9(2) VALUE 99.                   
203600            15 PV-AED-POINTER        PIC 9(2) VALUE ZEROS.                
203700            15 PV-AED-SELECTED       PIC X(1) VALUE 'N'.                  
203800            15 PV-AED-ONVSCREEN      PIC 9(2) VALUE ZERO.                 
203900            15 PV-AED-VFLD-SPACING   PIC 9(1) VALUE 0.                    
204000*                    TRIP TYPE                                            
204100         10 PV-CONTROL-TRP.                                               
204200            15 PV-TRP-OORDER         PIC 9(2) VALUE 99.                   
204300            15 PV-TRP-POINTER        PIC 9(2) VALUE ZEROS.                
204400            15 PV-TRP-SELECTED       PIC X(1) VALUE 'N'.                  
204500            15 PV-TRP-ONVSCREEN      PIC 9(2) VALUE ZERO.                 
204600            15 PV-TRP-VFLD-SPACING   PIC 9(1) VALUE 0.                    
204700*                    DC SPLITS CREATED                                    
204800         10 PV-CONTROL-SPL-CRT.                                           
204900            15 PV-SPL-CRT-OORDER         PIC 9(2) VALUE 99.               
205000            15 PV-SPL-CRT-POINTER        PIC 9(2) VALUE ZEROS.            
205100            15 PV-SPL-CRT-SELECTED       PIC X(1) VALUE 'N'.              
205200            15 PV-SPL-CRT-ONVSCREEN      PIC 9(2) VALUE ZERO.             
205300            15 PV-SPL-CRT-VFLD-SPACING   PIC 9(1) VALUE 0.                
205400*                    DC SPLITS SENT                                       
205500         10 PV-CONTROL-SPL-SNT.                                           
205600            15 PV-SPL-SNT-OORDER         PIC 9(2) VALUE 99.               
205700            15 PV-SPL-SNT-POINTER        PIC 9(2) VALUE ZEROS.            
205800            15 PV-SPL-SNT-SELECTED       PIC X(1) VALUE 'N'.              
205900            15 PV-SPL-SNT-ONVSCREEN      PIC 9(2) VALUE ZERO.             
206000            15 PV-SPL-SNT-VFLD-SPACING   PIC 9(1) VALUE 0.                
206100*                    STORE DISTRO                                         
206200         10 PV-CONTROL-STD.                                               
206300            15 PV-STD-OORDER             PIC 9(2) VALUE 99.               
206400            15 PV-STD-POINTER            PIC 9(2) VALUE ZEROS.            
206500            15 PV-STD-SELECTED           PIC X(1) VALUE 'N'.              
206600            15 PV-STD-ONVSCREEN          PIC 9(2) VALUE ZERO.             
206700            15 PV-STD-VFLD-SPACING       PIC 9(1) VALUE 0.                
206800*                    QUOTA COUNT                                          
206900         10 PV-CONTROL-QCT.                                               
207000            15 PV-QCT-OORDER         PIC 9(2) VALUE 99.                   
207100            15 PV-QCT-POINTER        PIC 9(2) VALUE ZEROS.                
207200            15 PV-QCT-SELECTED       PIC X(1) VALUE 'N'.                  
207300            15 PV-QCT-ONVSCREEN      PIC 9(2) VALUE ZERO.                 
207400            15 PV-QCT-VFLD-SPACING   PIC 9(1) VALUE 0.                    
207500*                    VENDOR STYLE                                         
207600         10 PV-CONTROL-VNS.                                               
207700            15 PV-VNS-OORDER         PIC 9(2) VALUE 99.                   
207800            15 PV-VNS-POINTER        PIC 9(2) VALUE ZEROS.                
207900            15 PV-VNS-SELECTED       PIC X(1) VALUE 'N'.                  
208000            15 PV-VNS-ONVSCREEN      PIC 9(2) VALUE ZERO.                 
208100            15 PV-VNS-VFLD-SPACING   PIC 9(1) VALUE 0.                    
208200*                    CONTAINER RELEASE                                    
208300         10 PV-CONTROL-CRL.                                               
208400            15 PV-CRL-OORDER         PIC 9(2) VALUE 99.                   
208500            15 PV-CRL-POINTER        PIC 9(2) VALUE ZEROS.                
208600            15 PV-CRL-SELECTED       PIC X(1) VALUE 'N'.                  
208700            15 PV-CRL-ONVSCREEN      PIC 9(2) VALUE ZERO.                 
208800            15 PV-CRL-VFLD-SPACING   PIC 9(1) VALUE 0.                    
208900*                    TRAILER AVAILABLE                                    
209000         10 PV-CONTROL-TRA.                                               
209100            15 PV-TRA-OORDER         PIC 9(2) VALUE 99.                   
209200            15 PV-TRA-POINTER        PIC 9(2) VALUE ZEROS.                
209300            15 PV-TRA-SELECTED       PIC X(1) VALUE 'N'.                  
209400            15 PV-TRA-ONVSCREEN      PIC 9(2) VALUE ZERO.                 
209500            15 PV-TRA-VFLD-SPACING   PIC 9(1) VALUE 0.                    
209600*---------------------------------------------------------------*         
209700*  PV-VARIABLE-CONTROL-FIELDS DEFINED AS AN ARRAY               *         
209800*---------------------------------------------------------------*         
209900     05  PV-VCTL-TABLE.                                                   
210000         10 PV-VFLD-CONTROL-VALUES                                        
210100               OCCURS 47 TIMES                                            
210200                 INDEXED BY VCTL-I.                                       
210300             15 PV-USORT-ORDER        PIC 9(2).                           
210400             15 PV-USORT-POINTER      PIC 9(2).                           
210500             15 PV-USORT-SELECTED     PIC X(1).                           
210600             15 PV-USORT-ONVSCREEN    PIC 9(2).                           
210700             15 PV-USORT-VFLD-SPACING PIC 9(1).                           
210800*---------------------------------------------------------------*         
210900*  PV-VARIABLE-CONTROL-FIELDS AS SORTED                         *         
211000*---------------------------------------------------------------*         
211100     05  PV-VCTL-SORTED-TABLE.                                            
211200         10 PV-VFLD-CONTROL-SORTED-VALUES                                 
211300               OCCURS 47 TIMES                                            
211400                 INDEXED BY PV-VSCTL-I.                                   
211500             15 PV-SORT-ORDER         PIC 9(2).                           
211600             15 PV-SORT-POINTER       PIC 9(2).                           
211700             15 PV-SORT-SELECTED      PIC X(1).                           
211800             15 PV-SORT-ONVSCREEN     PIC 9(2).                           
211900             15 PV-SORT-VFLD-SPACING  PIC 9(1).                           
212000*---------------------------------------------------------------*         
212100*  DC ARRAY THE PROGRAM CAN CURRENTLY HANDLE 12 DCS.            *         
212200*---------------------------------------------------------------*         
212300      05  PV-DC-TABLE.                                                    
212400          10  PV-DC-TABLE-VALUES                                          
212500               OCCURS 12 TIMES                                            
212600                 INDEXED BY DC-I.                                         
212700              15 DC-STORE-NMBR             PIC S9(04) COMP.               
212800              15 DC-STORE-NAME             PIC X(05).                     
212900                                                                          
213000*----------------------------------------------------------------*        
213100*   THIS IS THE LAYOUT FOR THE LIST ITEMS TEMP STORAGE QUEUE.    *        
213200*   THIS MUST BE THE EXACT SAME FORMAT A BLOCK IN THE            *        
213300*   APPLICATION-SPECIFIC COMMAREA.                               *        
213400*----------------------------------------------------------------*        
213500 01  LQW-LIST-QUEUE-WORK-AREA.                                            
213600     05  LQW-BLOCK-MODIFIED             PIC  X(01)  VALUE SPACE.          
213700     05  LQW-ITEM-ENTRIES               OCCURS 13   TIMES                 
213800                                        INDEXED BY  LQW-IDX.              
213900         10  LQW-LIST-ITEM-NUMBER       PIC S9(09)  COMP-3.               
214000         10  LQW-TEMP-SELECTED-SW       PIC  X(01).                       
214100         10  LQW-SELECTED-SW            PIC  X(01).                       
214200             88 LQW-SELECT              VALUE 'S'.                        
214300             88 LQW-DESELECT            VALUE ' '.                        
214400         10  LQW-PO   PIC S9(09) COMP.                                    
214500         10  LQW-DEPT PIC  X(03).                                         
214600         10  LQW-VND  PIC  X(8).                                          
214700         10  LQW-IP   PIC  X(1).                                          
214800 EJECT                                                                    
214900*----------------------------------------------------------------*        
215000*   THIS IS THE LAYOUT FOR THE EXTENDED DATA TEMP STORAGE QUEUE. *        
215100*   THE NUMBER OF BLOCKS AND ITEM ARRAY MUST CORRESPOND TO THE   *        
215200*   APPLICATION SPECIFIC COMMAREA.                               *        
215300*                                                                *        
215400*   THE EXTENDED TEMPORARY STORAGE QUEUE WAS BUILT TO BE AN      *        
215500*   EXTENSION TO THE APPLICATION SPECIFIC COMMAREA.  THE         *        
215600*   APPLICATION SPECIFIC COMMAREA COULD NOT HOLD THE ENTIRE      *        
215700*   VARIABLE DATA SO AN EXTENDED AREA WAS NEEDED.                *        
215800*----------------------------------------------------------------*        
215900 01  EXT-LIST-QUEUE-WORK-AREA.                                            
216000     15  EXT-BLOCK-ENTRIES OCCURS 2 TIMES.                                
216100         20  EXT-ITEM-ARRAY             OCCURS 13   TIMES                 
216200                                        INDEXED BY  EXT-IDX.              
216300             30  EXT-LIST-ITEM-NUMBER   PIC S9(09)  COMP-3.               
216400             30  EXT-PO                 PIC S9(09)  COMP.                 
216500             30  EXT-FOB                PIC  X(03).                       
216600             30  EXT-POE                PIC  X(03).                       
216700             30  EXT-DSB                PIC  X(08).                       
216800             30  EXT-SXF                PIC  X(08).                       
216900             30  EXT-LXF                PIC  X(08).                       
217000             30  EXT-CNL                PIC  X(08).                       
217100             30  EXT-FRD                PIC  X(08).                       
217200             30  EXT-SLD                PIC  X(08).                       
217300             30  EXT-PRD                PIC  X(08).                       
217400             30  EXT-PRD-ETA-ATA        PIC  X(02).                       
217500             30  EXT-CNT                PIC  X(12).                       
217600             30  EXT-CSR                PIC  X(08).                       
217700             30  EXT-DC1                PIC  X(08).                       
217800             30  EXT-DC1-ETA-ATA        PIC  X(02).                       
217900             30  EXT-DC2                PIC  X(08).                       
218000             30  EXT-DC2-ETA-ATA        PIC  X(02).                       
218100             30  EXT-DC3                PIC  X(08).                       
218200             30  EXT-DC3-ETA-ATA        PIC  X(02).                       
218300             30  EXT-DC4                PIC  X(08).                       
218400             30  EXT-DC4-ETA-ATA        PIC  X(02).                       
218500             30  EXT-DC5                PIC  X(08).                       
218600             30  EXT-DC5-ETA-ATA        PIC  X(02).                       
218700             30  EXT-DC6                PIC  X(08).                       
218800             30  EXT-DC6-ETA-ATA        PIC  X(02).                       
218900             30  EXT-DC7                PIC  X(08).                       
219000             30  EXT-DC7-ETA-ATA        PIC  X(02).                       
219100             30  EXT-DC8                PIC  X(08).                       
219200             30  EXT-DC8-ETA-ATA        PIC  X(02).                       
219300             30  EXT-DC9                PIC  X(08).                       
219400             30  EXT-DC9-ETA-ATA        PIC  X(02).                       
219500             30  EXT-DC10               PIC  X(08).                       
219600             30  EXT-DC10-ETA-ATA       PIC  X(02).                       
219700             30  EXT-DC11               PIC  X(08).                       
219800             30  EXT-DC11-ETA-ATA       PIC  X(02).                       
219900             30  EXT-DC12               PIC  X(08).                       
220000             30  EXT-DC12-ETA-ATA       PIC  X(02).                       
220100             30  EXT-DVN                PIC  X(08).                       
220200             30  EXT-BKD                PIC  X(08).                       
220300             30  EXT-AED                PIC  X(08).                       
220400             30  EXT-FSC                PIC  9(9)V9(2) COMP-3.            
220500             30  EXT-TTC                PIC  9(9)V9(2) COMP-3.            
220600             30  EXT-TVC                PIC  9(9)V9(2) COMP-3.            
220700             30  EXT-UOR                PIC S9(9) COMP.                   
220800             30  EXT-URC                PIC S9(9) COMP.                   
220900             30  EXT-DOR                PIC  9(9)V9(2) COMP-3.            
221000             30  EXT-DRC                PIC  9(9)V9(2) COMP-3.            
221100             30  EXT-OTB                PIC  X(06).                       
221200             30  EXT-STA                PIC  X(02).                       
221300             30  EXT-INP                PIC  X(01).                       
221400             30  EXT-EDI                PIC  X(01).                       
221500             30  EXT-PPK                PIC  X(01).                       
221600             30  EXT-TRP                PIC  X(03).                       
221700             30  EXT-SPL-CRT            PIC  X(08).                       
221800             30  EXT-SPL-SNT            PIC  X(08).                       
221900             30  EXT-STD                PIC  X(01).                       
222000             30  EXT-QCT                PIC  X(05).                       
222100             30  EXT-VNS                PIC  X(08).                       
222200             30  EXT-CRL                PIC  X(08).                       
222300             30  EXT-TRA                PIC  X(08).                       
222400 EJECT                                                                    
222500*----------------------------------------------------------------*        
222600*   THIS IS THE LAYOUT FOR THE PO QUEUE TEMP STORAGE AREA.       *        
222700*   THE NUMBER OF BLOCKS AND ITEM ARRAY MUST CORRESPOND TO THE   *        
222800*   APPLICATION SPECIFIC COMMAREA.                               *        
222900*----------------------------------------------------------------*        
223000*01  POQ-LIST-QUEUE-WORK-AREA.                                            
223100*    15  POQ-ITEM-ARRAY             OCCURS 26  TIMES                      
223200*                                   INDEXED BY POQ-IDX.                   
223300*        20  POQ-PO                 PIC S9(09) COMP.                      
223400*        20  POQ-FSC                PIC 9(9)V9(2) COMP-3.                 
223500*        20  POQ-TTC                PIC 9(9)V9(2) COMP-3.                 
223600*        20  POQ-TVC                PIC 9(9)V9(2) COMP-3.                 
223700*        20  POQ-DOR                PIC 9(9)V9(2) COMP-3.                 
223800*        20  POQ-DRC                PIC 9(9)V9(2) COMP-3.                 
223900*        20  POQ-UOR                PIC S9(9) COMP.                       
224000*        20  POQ-URC                PIC S9(9) COMP.                       
224100 01  POX-LIST-QUEUE-WORK-AREA.                                            
224200     15  POX-ITEM-ARRAY.                                                  
224300         20  POX-PO                 PIC S9(09) COMP.                      
224400         20  POX-FSC                PIC 9(9)V9(2) COMP-3.                 
224500         20  POX-TTC                PIC 9(9)V9(2) COMP-3.                 
224600         20  POX-TVC                PIC 9(9)V9(2) COMP-3.                 
224700         20  POX-DOR                PIC 9(9)V9(2) COMP-3.                 
224800         20  POX-DRC                PIC 9(9)V9(2) COMP-3.                 
224900         20  POX-UOR                PIC S9(9) COMP.                       
225000         20  POX-URC                PIC S9(9) COMP.                       
225100 EJECT                                                                    
225200*---------------------------------------------------------------*         
225300*  RECORD LAYOUT FOR THE PO SELECTION TEMP STORAGE QUEUE.       *         
225400*---------------------------------------------------------------*         
225500     COPY POWS012.                                                        
225600                                                                          
225700 EJECT                                                                    
225800*---------------------------------------------------------------*         
225900*    MAP LAYOUT                                                 *         
226000*---------------------------------------------------------------*         
226100*                                                                         
226200*    COPY TRKM196.                                                        
226300*01  MR-OCCURS-LAYOUT                   REDEFINES  TR196AO.               
226400*    05  FILLER                         PIC X(42).                        
226500*                                                                         
226600*    05  MR-VHEADER-LEVEL1-AREA.                                          
226700*        10  MR-VHDR1L                  PIC S9(04) COMP.                  
226800*        10  MR-VHDR1A                  PIC  X(01).                       
226900*        10  MR-VHDR1-FILLER            PIC  X(02).                       
227000*        10  MR-VHDR1                   PIC  X(275).                      
227100*                                                                         
227200*    05  MR-VHEADER-LEVEL2-AREA.                                          
227300*        10  MR-VHDR2L                  PIC S9(04) COMP.                  
227400*        10  MR-VHDR2A                  PIC  X(01).                       
227500*        10  MR-VHDR2-FILLER            PIC  X(02).                       
227600*        10  MR-VHDR2                   PIC  X(54).                       
227700*                                                                         
227800*    05  MR-SCROLL-AREA                 OCCURS 13 TIMES.                  
227900*        10  MR-SELECTL                 PIC S9(04) COMP.                  
228000*        10  MR-SELECTA                 PIC  X(01).                       
228100*        10  MR-SELECTC                 PIC  X(01).                       
228200*        10  MR-SELECTH                 PIC  X(01).                       
228300*        10  MR-SELECTI                 PIC  X(01).                       
228400*                                                                         
228500*        10  MR-POL                     PIC S9(04) COMP.                  
228600*        10  MR-POA                     PIC  X(01).                       
228700*        10  MR-POC                     PIC  X(01).                       
228800*        10  MR-POH                     PIC  X(01).                       
228900*        10  MR-PO                      PIC  ZZZZZZZZ.                    
229000*                                                                         
229100*        10  MR-DEPTL                   PIC S9(04) COMP.                  
229200*        10  MR-DEPTA                   PIC  X(01).                       
229300*        10  MR-DEPTC                   PIC  X(01).                       
229400*        10  MR-DEPTH                   PIC  X(01).                       
229500*        10  MR-DEPT                    PIC  X(03).                       
229600*                                                                         
229700*        10  MR-VENDORL                 PIC S9(04) COMP.                  
229800*        10  MR-VENDORA                 PIC  X(01).                       
229900*        10  MR-VENDORC                 PIC  X(01).                       
230000*        10  MR-VENDORH                 PIC  X(01).                       
230100*        10  MR-VENDOR                  PIC  X(08).                       
230200*                                                                         
230300*        10  MR-VFLDL                   PIC S9(04) COMP.                  
230400*        10  MR-VFLDA                   PIC  X(01).                       
230500*        10  MR-VFLDC                   PIC  X(01).                       
230600*        10  MR-VFLDH                   PIC  X(01).                       
230700*        10  MR-VFLD                    PIC  X(54).                       
230800*                                                                         
230900*    05  MR-TOTAL-AREA.                                                   
231000*                                                                         
231100*        10  MR-TTXTL               PIC S9(04) COMP.                      
231200*        10  MR-TTXTA               PIC  X(01).                           
231300*        10  MR-TTXTC               PIC  X(01).                           
231400*        10  MR-TTXTH               PIC  X(01).                           
231500*        10  MR-TTXT                PIC  X(20).                           
231600*                                                                         
231700*        10  MR-TFLDL               PIC S9(04) COMP.                      
231800*        10  MR-TFLDA               PIC  X(01).                           
231900*        10  MR-TFLDC               PIC  X(01).                           
232000*        10  MR-TFLDH               PIC  X(01).                           
232100*        10  MR-TFLD                PIC  X(54).                           
232200*                                                                         
232300*EJECT                                                                    
232400*---------------------------------------------------------------*         
232500*    ATTRIBUTE SETTINGS COPYBOOK.                               *         
232600*---------------------------------------------------------------*         
232700*                                                                         
232800*    COPY DPWS015.                                                        
232900*                                                                         
233000*EJECT                                                                    
233100*---------------------------------------------------------------*         
233200*    FUNCTION KEYS COPYBOOK.                                    *         
233300*---------------------------------------------------------------*         
233400*                                                                         
233500*    COPY DPWS016.                                                        
233600*                                                                         
233700*EJECT                                                                    
233800*---------------------------------------------------------------*         
233900*    NUMERIC EDIT LAYOUT.                                       *         
234000*---------------------------------------------------------------*         
234100                                                                          
234200     COPY DPWS010I.                                                       
234300                                                                          
234400 EJECT                                                                    
235200*---------------------------------------------------------------*         
235300*    STANDARD COMMAREA.                                         *         
235400*---------------------------------------------------------------*         
235500                                                                          
235600     COPY DPWS020.                                                        
235700     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                        
235800                                                                          
235900*---------------------------------------------------------------*         
236000* INTER-APPLICATION COMMAREA.                                   *         
236100*   TRWS105 - ARE THE INPUT LAYOUTS FOR THIS PROGRAM            *         
236200*---------------------------------------------------------------*         
236300                                                                          
236400         10  INTER-APPL-COMM-AREA       PIC X(200).                       
236500     COPY TRWS105.                                                        
236600     COPY TRWS195.                                                        
236700     COPY POWS013.                                                        
236800     COPY DPWS004.                                                        
236900                                                                          
237000*---------------------------------------------------------------*         
237100*  THIS IS THE APPLICATION-SPECIFIC COMMAREA.                   *         
237200*---------------------------------------------------------------*         
237300         10  ASC-SPECIFIC-COMMAREA.                                       
237400             15  ASC-CLASS-RANGE-SW            PIC X(01).                 
237500                 88  ASC-CLASS-RANGE           VALUE 'Y'.                 
237600             15  ASC-SEL-CRIT-FIELDS.                                     
237700                 20  ASC-KEY-PO-NBR          PIC S9(9) COMP.              
237800                 20  ASC-KEY-CNTRY-ORG       PIC X(3).                    
237900                 20  ASC-KEY-CNTRY-PLC       PIC X(3).                    
238000                 20  ASC-XFACT-BEF-DTE       PIC X(10).                   
238100                 20  ASC-XFACT-END-DTE       PIC X(10).                   
238200                 20  ASC-DEPT-NBR            PIC 9(4) COMP.               
238300                 20  ASC-STR-NBR             PIC S9(04) COMP.             
238400                 20  ASC-CLASS               PIC 9(4) COMP.               
238500                 20  ASC-SUBCLASS            PIC 9(4) COMP.               
238600                 20  ASC-SKU                 PIC 9(8) COMP.               
238700                 20  ASC-SHPDT-BEF-DTE       PIC X(10).                   
238800                 20  ASC-SHPDT-END-DTE       PIC X(10).                   
238900                 20  ASC-OTB-PER-NBR-BEG     PIC X(6).                    
239000                 20  ASC-OTB-PER-NBR-END     PIC X(6).                    
239100                 20  ASC-EDI-IND             PIC X(01).                   
239200                 20  ASC-STATUS-CDE          PIC X(2).                    
239300                 20  ASC-AD-EVNT-DTE         PIC X(10).                   
239400                 20  ASC-PACK-BY-STORE-IND   PIC X(01).                   
239500                 20  ASC-STATUS-CLS          PIC X(3).                    
239600                 20  ASC-NEW-STR-IND         PIC X(01).                   
239700                 20  ASC-PRE-TICKET-IND      PIC X(01).                   
239800                 20  ASC-PO-TYP-CDE          PIC X(2).                    
239900                 20  ASC-FOB-CDE             PIC X(03).                   
240000                 20  ASC-POE-CDE             PIC X(03).                   
240100                 20  ASC-DIRECT-STORE-IND    PIC X(01).                   
240200                 20  ASC-PIC-AD-IND          PIC X(01).                   
240300                 20  ASC-PRE-PACK-IND        PIC X(01).                   
240400                 20  ASC-MAKER-NME           PIC X(35).                   
240500                 20  ASC-ENT-NAME-DESC       PIC X(30).                   
240600                 20  ASC-VEND-STYL-NME       PIC X(20).                   
240700                 20  ASC-SEASONAL-SET        PIC X(05).                   
240800                 20  ASC-QUOTA-CATEGORY      PIC X(05).                   
240900                 20  ASC-DMM                 PIC X(02).                   
241000                 20  ASC-GROUP-CDE           PIC X(03).                   
241100                 20  ASC-SORT1-BY-IND        PIC X(01).                   
241200                 20  ASC-SORT2-BY-IND        PIC X(01).                   
241300             15  ASC-LIST-TOTALS.                                         
241400                 20  ASC-TFSC   PIC 9(12)V9(2) COMP-3.                    
241500                 20  ASC-TTTC   PIC 9(12)V9(2) COMP-3.                    
241600                 20  ASC-TTVC   PIC 9(12)V9(2) COMP-3.                    
241700                 20  ASC-TUOR   PIC S9(9) COMP.                           
241800                 20  ASC-TURC   PIC S9(9) COMP.                           
241900                 20  ASC-TDOR   PIC 9(12)V9(2) COMP-3.                    
242000                 20  ASC-TDRC   PIC 9(12)V9(2) COMP-3.                    
242100             15  ASC-TASK-DOCUMENTING.                                    
242200                 20 ASC-DOC-SW                PIC X(01).                  
242300                    88  ASC-WRITE-TO-CSSL      VALUE 'Y'.                 
242400                    88  ASC-DONT-WRITE-TO-CSSL VALUE 'N'.                 
242500                 20 ASC-CICS-ABSTIME     PIC S9(15) COMP-3 SYNC.          
242600                 20 ASC-CICS-CURRENT-SECONDS                              
242700                                         PIC S9(8)V9(2) COMP-3.           
242800                 20 ASC-CICS-LAST-SECONDS                                 
242900                                         PIC S9(8)V9(2) COMP-3.           
243000                 20 ASC-LAST-DB-SECONDS                                   
243100                                         PIC S9(8)V9(2) COMP-3.           
243200                 20 ASC-CICS-TIME        PIC X(8).                        
243300                 20 ASC-GROUPS-LOADED    PIC ZZZZ9.                       
243400                 20 ASC-TASK-ID          PIC 9(01).                       
243500                 20 ASC-TASK-DURATION    PIC 9(3)V9(2).                   
243600                 20 ASC-TASK-TIME        PIC 9(3)V9(2).                   
243700                 20 ASC-TASK-POINTER     PIC S9(04)                       
243800                                             COMP SYNC.                   
243900                 20 ASC-DB-LOAD1-CNT     PIC S9(04)                       
244000                                             COMP SYNC.                   
244100                 20 ASC-DB-LOAD2-CNT     PIC S9(04)                       
244200                                             COMP SYNC.                   
244300                 20 ASC-DB-LOAD3-CNT     PIC S9(04)                       
244400                                             COMP SYNC.                   
244500                 20 ASC-DB-LOAD1-SECONDS                                  
244600                                         PIC S9(8)V9(2) COMP-3.           
244700                 20 ASC-DB-LOAD2-SECONDS                                  
244800                                         PIC S9(8)V9(2) COMP-3.           
244900                 20 ASC-DB-LOAD3-SECONDS                                  
245000                                         PIC S9(8)V9(2) COMP-3.           
245100                 20 ASC-DB-LOAD1-AVG                                      
245200                                         PIC S9(8)V9(2) COMP-3.           
245300                 20 ASC-DB-LOAD2-AVG                                      
245400                                         PIC S9(8)V9(2) COMP-3.           
245500                 20 ASC-DB-LOAD3-AVG                                      
245600                                         PIC S9(8)V9(2) COMP-3.           
245700             15  ASC-BLOCK-ENTRIES OCCURS 2 TIMES.                        
245800                 20  ASC-BLOCK-MODIFIED-SW          PIC  X(01).           
245900                     88  ASC-BLOCK-NOT-MODIFIED     VALUE 'N'.            
246000                     88  ASC-BLOCK-MODIFIED         VALUE 'Y'.            
246100                                                                          
246200                 20  ASC-ITEM-ARRAY.                                      
246300                     25  ASC-ITEM-ENTRIES OCCURS 13 TIMES.                
246400                         30  ASC-LIST-ITEM-NUMBER                         
246500                                                     PIC S9(09)           
246600                                                     COMP-3.              
246700                         30  ASC-TEMP-SELECTED-SW    PIC  X(01).          
246800                             88  ASC-VALID-SELECT    VALUE ' '            
246900                                                           'S'            
247000                                                           'B'            
247100                                                           'E'.           
247200                             88  ASC-TEMP-NO-SELECT  VALUE ' '.           
247300                             88  ASC-TEMP-SELECT     VALUE 'S'.           
247400                             88  ASC-TEMP-BEGIN      VALUE 'B'.           
247500                             88  ASC-TEMP-END        VALUE 'E'.           
247600                         30  ASC-SELECTED-SW         PIC  X(01).          
247700                             88  ASC-NO-SELECT       VALUE ' '.           
247800                             88  ASC-SELECT          VALUE 'S'.           
247900                             88  ASC-BEGIN           VALUE 'B'.           
248000                             88  ASC-END             VALUE 'E'.           
248100                         30  ASC-PO    PIC  S9(09) COMP.                  
248200                         30  ASC-DEPT  PIC  9(04) COMP.                   
248300                         30  ASC-VND   PIC  X(08).                        
248400                         30  ASC-IP    PIC  X(01).                        
248500                                                                          
248600             15  ASC-BLK-SUB                         PIC S9(04)           
248700                                                          COMP            
248800                                                          SYNC.           
248900             15  ASC-EXT-SUB                         PIC S9(04)           
249000                                                          COMP            
249100                                                          SYNC.           
249200             15  ASC-ITEM-SUB                        PIC S9(04)           
249300                                                          COMP            
249400                                                          SYNC.           
249500             15  ASC-POQ-ITEM-SUB                    PIC S9(04)           
249600                                                          COMP            
249700                                                          SYNC.           
249800             15  ASC-POQ-BLK-SUB                     PIC S9(04)           
249900                                                          COMP            
250000                                                          SYNC.           
250100             15  ASC-POQ-LAST-SUB                    PIC S9(04)           
250200                                                          COMP            
250300                                                          SYNC.           
250400             15  ASC-POQ-LAST-ITEM                   PIC S9(04)           
250500                                                          COMP            
250600                                                          SYNC.           
250700             15  ASC-POQ-LAST-BLK                    PIC S9(04)           
250800                                                          COMP            
250900                                                          SYNC.           
251000             15  ASC-MAX-GROUPS                      PIC S9(09)           
251100                                                          COMP            
251200                                                          SYNC.           
251300             15  ASC-SEL-ITEM                        PIC S9(04)           
251400                                                          COMP            
251500                                                          SYNC.           
251600             15  ASC-SEL-SUB                         PIC S9(04)           
251700                                                          COMP            
251800                                                          SYNC.           
251900             15  ASC-NUMBER-OF-ITEMS-READ            PIC S9(09)           
252000                                                          COMP-3.         
252100             15  ASC-NUMBER-OF-POS-READ              PIC S9(09)           
252200                                                          COMP-3.         
252300             15  ASC-NBR-OF-POS-DISPLAYED            PIC S9(09)           
252400                                                          COMP-3.         
252500             15  ASC-NUMBER-OF-SELECTED-ITEMS        PIC S9(09)           
252600                                                          COMP-3.         
252700             15  ASC-ITEMS-DISPLAYED                 PIC S9(03)           
252800                                                          COMP-3.         
252900             15  ASC-ITEM-AT-TOP-OF-PANEL            PIC S9(09)           
253000                                                          COMP-3.         
253100             15  ASC-ITEM-AT-BOT-OF-PANEL            PIC S9(09)           
253200                                                          COMP-3.         
253300             15  ASC-HIGHEST-BLOCK-WRITTEN           PIC S9(04)           
253400                                                          COMP            
253500                                                          SYNC.           
253600             15  ASC-START-OF-SELECTED-RANGE         PIC S9(09)           
253700                                                          COMP-3.         
253800             15  ASC-END-OF-SELECTED-RANGE           PIC S9(09)           
253900                                                          COMP-3.         
254000             15  ASC-WRITE-EXTENDED-STORAGE-SW       PIC  X(01).          
254100                 88  ASC-WRITE-EXTENDED-STORAGE      VALUE 'Y'.           
254200                 88  ASC-DONT-WRITE-EXT-STORAGE      VALUE 'N'.           
254300             15  ASC-ITEMS-LEFT-INDICATOR            PIC  X(01).          
254400                 88  ASC-ITEMS-LEFT-ON-DB            VALUE 'Y'.           
254500                 88  ASC-NO-ITEMS-LEFT-ON-DB         VALUE 'N'.           
254600             15  ASC-ITEMS-LEFT-ON-PO--IND           PIC  X(01).          
254700                 88  ASC-ITEMS-LEFT-ON-PO            VALUE 'Y'.           
254800                 88  ASC-NO-ITEMS-LEFT-ON-PO         VALUE 'N'.           
254900             15  ASC-TEMP-QUEUE-UPDATE-SW            PIC  X(01).          
255000                 88  ASC-UPDATE-TSQ                  VALUE 'Y'.           
255100                 88  ASC-NO-TSQ-UPDATE               VALUE ' '.           
255200             15  ASC-LIST-QUEUE-NAME.                                     
255300                 20  ASC-LIST-TERM-ID                PIC  X(04).          
255400                 20  ASC-LIST-TASK-NUMBER            PIC S9(05)           
255500                                                          COMP-3.         
255600                 20  ASC-LIST-SEQ                    PIC  9(01).          
255700             15  ASC-SEL-QUEUE-NAME.                                      
255800                 20  ASC-SEL-TERM-ID                 PIC  X(04).          
255900                 20  ASC-SEL-TASK-NUMBER             PIC S9(05)           
256000                                                          COMP-3.         
256100                 20  ASC-SEL-SEQ                     PIC  9(01).          
256200             15  ASC-PO-QUEUE-NAME.                                       
256300                 20  ASC-PO-TERM-ID                  PIC  X(04).          
256400                 20  ASC-PO-TASK-NUMBER              PIC S9(05)           
256500                                                          COMP-3.         
256600                 20  ASC-PO-SEQ                      PIC  9(01).          
256700             15  ASC-EXTENDED-QUEUE-NAME.                                 
256800                 20  ASC-EXTENDED-TERM-ID            PIC  X(04).          
256900                 20  ASC-EXTENDED-TASK-NUMBER        PIC S9(05)           
257000                                                          COMP-3.         
257100                 20  ASC-EXTENDED-SEQ                PIC  9(01).          
257200             15  ASC-USE-SEL-QUEUE-SW    PIC  X(01).                      
257300                 88  ASC-USE-SELECTION-QUEUE         VALUE 'Y'.           
257400                 88  ASC-NO-USE-SELECTION-QUEUE      VALUE 'N'.           
257500             15  ASC-NUMBER-OF-TS-ITEMS              PIC S9(09)           
257600                                                          COMP-3.         
257700             15  ASC-START-ITEM-REQUEST.                                  
257800                 20  ASC-START-ITEM-REQUEST-N        PIC 9(05).           
257900*---------------------------------------------------------------*         
258000*    ADDITIONAL COMMAREA VARIABLE DISPLAY VARIABLES             *         
258100*---------------------------------------------------------------*         
258200*    VCTL-SORTED-TABLE CONTAINS THE CONTROL INFORMATION FOR THE *         
258300*    VARIABLE DISPLAY.  DURING THE PROGRAM START UP PHASE       *         
258400*    THIS TABLE IS BUILT.                                       *         
258500*---------------------------------------------------------------*         
258600             15  ASC-VCTL-SORTED-TABLE               PIC X(376).          
258700             15  ASC-DC-TABLE                        PIC X(84).           
258800             15  ASC-DC-NMBR                         PIC 9(2).            
258900*---------------------------------------------------------------*         
259000*    REDRAW-VARIABLE-SCREEN INDICATES WHETHER THE SCREEN        *         
259100*    SHOULD BE DRAWN AGAIN.                                     *         
259200*---------------------------------------------------------------*         
259300             15  ASC-REDRAW-VARIABLE-SCREEN          PIC S9.              
259400*---------------------------------------------------------------*         
259500*    SEL-VARIABLE-SCREEN CONTAINS THE CURRENT DISPLAYED SCREEN. *         
259600*    IN THE BEGINNING THE FIELD IS SET TO 0 & THEN AS THE USER  *         
259700*    SELECTS F10/F11 THIS FIELD IS DECREMENTED OR INCREMENTED.  *         
259800*---------------------------------------------------------------*         
259900             15  ASC-SEL-VARIABLE-SCREEN             PIC S9.              
260000*---------------------------------------------------------------*         
260100*    ASC-VSCREEN HOLDS THE LAST VIRTUAL SCREEN. CURRENTLY ONLY  *         
260200*    5 SCREENS ARE EVER USED.  IF MORE FIELDS ARE ADDED TO THE  *         
260300*    VARIABLE SCREEN THIS FIELD SHOULD BE ADDED AS A PIC 99.   .*         
260400*---------------------------------------------------------------*         
260500             15  ASC-MAX-VARIABLE-SCREENS            PIC S9.              
260600                                                                          
260700 EJECT                                                                    
260800*---------------------------------------------------------------*         
260900*    ABEND PROCESSING COPYBOOK.                                 *         
261000*---------------------------------------------------------------*         
261100                                                                          
261200     COPY DPWS013.                                                        
261300                                                                          
261400 EJECT                                                                    
261500*---------------------------------------------------------------*         
261600*    DB2 AREA FOR COMMUNICATIONS                                *         
261700*---------------------------------------------------------------*         
261800     EXEC SQL                                                             
261900          INCLUDE SQLCA                                                   
262000     END-EXEC.                                                            
262100*---------------------------------------------------------------*         
262200*  DCLGEN FOR ALL TRECEIV                                                 
262300*---------------------------------------------------------------*         
262400     EXEC SQL                                                             
262500          INCLUDE TRECEIV                                                 
262600     END-EXEC.                                                            
262700 EJECT                                                                    
262800*---------------------------------------------------------------*         
262900*  DCLGEN FOR ALL TSTATCD                                                 
263000*---------------------------------------------------------------*         
263100     EXEC SQL                                                             
263200          INCLUDE TSTATCD                                                 
263300     END-EXEC.                                                            
263400 EJECT                                                                    
263500*---------------------------------------------------------------*         
263600*  DCLGEN FOR ALL TRECDIS                                                 
263700*---------------------------------------------------------------*         
263800     EXEC SQL                                                             
263900          INCLUDE TRECDIS                                                 
264000     END-EXEC.                                                            
264100 EJECT                                                                    
264200*---------------------------------------------------------------*         
264300*  DCLGEN FOR ALL TRECITM                                                 
264400*---------------------------------------------------------------*         
264500     EXEC SQL                                                             
264600          INCLUDE TRECITM                                                 
264700     END-EXEC.                                                            
264800 EJECT                                                                    
264900*---------------------------------------------------------------*         
265000*  DCLGEN FOR ALL TMESTDS                                                 
265100*---------------------------------------------------------------*         
265200     EXEC SQL                                                             
265300          INCLUDE TMESTDS                                                 
265400     END-EXEC.                                                            
265500 EJECT                                                                    
265600*---------------------------------------------------------------*         
265700*  DCLGEN FOR ALL TPOAGMT                                                 
265800*---------------------------------------------------------------*         
265900     EXEC SQL                                                             
266000          INCLUDE TPOAGMT                                                 
266100     END-EXEC.                                                            
266200 EJECT                                                                    
266300*---------------------------------------------------------------*         
266400*  DCLGEN FOR ALL TIMFOB                                                  
266500*---------------------------------------------------------------*         
266600     EXEC SQL                                                             
266700          INCLUDE TIMFOB                                                  
266800     END-EXEC.                                                            
266900 EJECT                                                                    
267000*---------------------------------------------------------------*         
267100*  DCLGEN FOR ALL TIMPOE                                                  
267200*---------------------------------------------------------------*         
267300     EXEC SQL                                                             
267400          INCLUDE TIMPOE                                                  
267500     END-EXEC.                                                            
267600 EJECT                                                                    
267700*---------------------------------------------------------------*         
267800*  DCLGEN FOR ALL TPOTYCD                                                 
267900*---------------------------------------------------------------*         
268000     EXEC SQL                                                             
268100          INCLUDE TPOTYCD                                                 
268200     END-EXEC.                                                            
268300 EJECT                                                                    
268400*---------------------------------------------------------------*         
268500*  DCLGEN FOR ALL TIMCSEN                                                 
268600*---------------------------------------------------------------*         
268700     EXEC SQL                                                             
268800          INCLUDE TIMCSEN                                                 
268900     END-EXEC.                                                            
269000 EJECT                                                                    
269100*---------------------------------------------------------------*         
269200*  DCLGEN FOR ALL TIMCSPO                                                 
269300*---------------------------------------------------------------*         
269400     EXEC SQL                                                             
269500          INCLUDE TIMCSPO                                                 
269600     END-EXEC.                                                            
269700 EJECT                                                                    
269800*---------------------------------------------------------------*         
269900*  DCLGEN FOR ALL TMDSEAR                                                 
270000*---------------------------------------------------------------*         
270100     EXEC SQL                                                             
270200          INCLUDE TMDSEAR                                                 
270300     END-EXEC.                                                            
270400 EJECT                                                                    
270500*---------------------------------------------------------------*         
270600*  DCLGEN FOR ALL TSK                                                     
270700*---------------------------------------------------------------*         
270800     EXEC SQL                                                             
270900          INCLUDE TSK                                                     
271000     END-EXEC.                                                            
271100 EJECT                                                                    
271200*---------------------------------------------------------------*         
271300*  DCLGEN FOR ALL TSHPTPO                                                 
271400*---------------------------------------------------------------*         
271500     EXEC SQL                                                             
271600          INCLUDE TSHPTPO                                                 
271700     END-EXEC.                                                            
271800 EJECT                                                                    
271900*---------------------------------------------------------------*         
272000*  DCLGEN FOR ALL TIMRCPO                                                 
272100*---------------------------------------------------------------*         
272200     EXEC SQL                                                             
272300          INCLUDE TIMRCPO                                                 
272400     END-EXEC.                                                            
272500 EJECT                                                                    
272600*---------------------------------------------------------------*         
272700*  DCLGEN FOR ALL TPLNSHP                                                 
272800*---------------------------------------------------------------*         
272900     EXEC SQL                                                             
273000          INCLUDE TPLNSHP                                                 
273100     END-EXEC.                                                            
273200 EJECT                                                                    
273910*---------------------------------------------------------------*         
273920*    DB2 AREA FOR LOGISTICS LOCATION TABLE - XLT_LOC            *         
273930*---------------------------------------------------------------*         
273940     EXEC SQL                                                             
273950          INCLUDE XLT00010                                                
273960     END-EXEC.                                                            
273961 EJECT                                                                    
273962*---------------------------------------------------------------*         
273963*    DB2 AREA FOR LOGISTICS LOCATION TABLE - XLT_DC_LOC_ASGMT   *         
273964*---------------------------------------------------------------*         
273965     EXEC SQL                                                             
273966          INCLUDE XLT00014                                                
273967     END-EXEC.                                                            
273968 EJECT                                                                    
274000*---------------------------------------------------------------*         
274100*  DCLGEN FOR ALL TPURITM                                                 
274200*---------------------------------------------------------------*         
274300     EXEC SQL                                                             
274400          INCLUDE TPURITM                                                 
274500     END-EXEC.                                                            
274600 EJECT                                                                    
274700*---------------------------------------------------------------*         
274800*  DCLGEN FOR ALL TPURCHS                                                 
274900*---------------------------------------------------------------*         
275000     EXEC SQL                                                             
275100          INCLUDE TPURCHS                                                 
275200     END-EXEC.                                                            
275300 EJECT                                                                    
275400*---------------------------------------------------------------*         
275500*  DCLGEN FOR ALL TALLPLN                                                 
275600*---------------------------------------------------------------*         
275700     EXEC SQL                                                             
275800          INCLUDE TALLPLN                                                 
275900     END-EXEC.                                                            
276000 EJECT                                                                    
276100*---------------------------------------------------------------*         
276200*  DCLGEN FOR ALL TIMBKPO                                                 
276300*---------------------------------------------------------------*         
276400     EXEC SQL                                                             
276500          INCLUDE TIMBKPO                                                 
276600     END-EXEC.                                                            
276700 EJECT                                                                    
276800 EJECT                                                                    
276900*---------------------------------------------------------------*         
277000*  DCLGEN FOR ALL TIMCNPO                                                 
277100*---------------------------------------------------------------*         
277200     EXEC SQL                                                             
277300          INCLUDE TIMCNPO                                                 
277400     END-EXEC.                                                            
277500 EJECT                                                                    
277600*---------------------------------------------------------------*         
277700*  DCLGEN FOR ALL TIMCNTK                                                 
277800*---------------------------------------------------------------*         
277900     EXEC SQL                                                             
278000          INCLUDE TIMCNTK                                                 
278100     END-EXEC.                                                            
278200 EJECT                                                                    
278300*---------------------------------------------------------------*         
278400*  DCLGEN FOR ALL TSHIPST                                                 
278500*---------------------------------------------------------------*         
278600     EXEC SQL                                                             
278700          INCLUDE TSHIPST                                                 
278800     END-EXEC.                                                            
278900 EJECT                                                                    
279000*---------------------------------------------------------------*         
279100*  DCLGEN FOR ALL TTRIPST                                                 
279200*---------------------------------------------------------------*         
279300     EXEC SQL                                                             
279400          INCLUDE TTRIPST                                                 
279500     END-EXEC.                                                            
279600 EJECT                                                                    
279700*---------------------------------------------------------------*         
279800*  DCLGEN FOR ALL TSHIPMT                                                 
279900*---------------------------------------------------------------*         
280000     EXEC SQL                                                             
280100          INCLUDE TSHIPMT                                                 
280200     END-EXEC.                                                            
280300 EJECT                                                                    
280400*---------------------------------------------------------------*         
280500*  DCLGEN FOR ALL TVHTRIP                                                 
280600*---------------------------------------------------------------*         
280700     EXEC SQL                                                             
280800          INCLUDE TVHTRIP                                                 
280900     END-EXEC.                                                            
281000 EJECT                                                                    
281100*---------------------------------------------------------------*         
281200*  DCLGEN FOR ALL TENTNME                                                 
281300*---------------------------------------------------------------*         
281400     EXEC SQL                                                             
281500          INCLUDE TENTNME                                                 
281600     END-EXEC.                                                            
281700 EJECT                                                                    
281800*---------------------------------------------------------------*         
281900*  DCLGEN FOR ALL TIMPORL                                                 
282000*---------------------------------------------------------------*         
282100     EXEC SQL                                                             
282200          INCLUDE TIMPORL                                                 
282300     END-EXEC.                                                            
282400 EJECT                                                                    
282500*---------------------------------------------------------------*         
282600*  DCLGEN FOR ALL TIMCNRL                                                 
282700*---------------------------------------------------------------*         
282800     EXEC SQL                                                             
282900          INCLUDE TIMCNRL                                                 
283000     END-EXEC.                                                            
283100 EJECT                                                                    
283110*---------------------------------------------------------------*         
283120*  DCLGEN FOR ALL XLT_SKU                                                 
283130*---------------------------------------------------------------*         
283140     EXEC SQL                                                             
283150          INCLUDE XLT00003                                                
283160     END-EXEC.                                                            
283170 EJECT                                                                    
283180*---------------------------------------------------------------*         
283190*  DCLGEN FOR ALL XLT_VND_STYL                                            
283191*---------------------------------------------------------------*         
283192     EXEC SQL                                                             
283193          INCLUDE XLT00004                                                
283194     END-EXEC.                                                            
283195 EJECT                                                                    
283200*---------------------------------------------------------------*         
283300*  CURSOR TO PULL SHIPMENT DATA                                           
283400*---------------------------------------------------------------*         
283500     EXEC SQL                                                             
283600       DECLARE SHIP_DATA_CSR CURSOR FOR                                   
283700           SELECT MIN(COALESCE(DATE(U.EST_AR_TMST),                       
283800                                    DATE('9999-09-09')))                  
283900                 ,MIN(COALESCE(V.STATUS_DTE,DATE('9999-09-09')))          
284000                 ,MIN(COALESCE(W.STATUS_DTE,DATE('9999-09-09')))          
284100                 ,U.OPER_UNT_ID                                           
284200           FROM (((SELECT C.EST_AR_TMST                                   
284300                         ,D.OPER_UNT_ID                                   
284400                         ,A.SHIPT_ID                                      
284500                    FROM  TSHPTPO A                                       
284600                         ,TSHIPMT B                                       
284700                         ,TVHTRIP C                                       
284800                         ,TTRIPST D                                       
284900                    WHERE A.PO_NBR          = :DK-PO-NBR                  
285000                      AND A.SHIPT_ID        = B.SHIPT_ID                  
285100                      AND B.TRIP_ID         = C.TRIP_ID                   
285200                      AND B.TRIP_ID         = D.TRIP_ID                   
285300                      AND C.VEH_NBR         IS NOT NULL                   
285400                      AND D.TRIP_STATUS_CDE = 'EN') AS U                  
285500                      LEFT OUTER JOIN                                     
285600                      (SELECT B.SHIPT_ID                                  
285700                             ,A.STATUS_DTE                                
285800                         FROM  TSHIPST A                                  
285900                              ,TSHPTPO B                                  
286000                         WHERE B.PO_NBR         = :DK-PO-NBR              
286100                         AND A.SHIPT_ID         = B.SHIPT_ID              
286200                         AND A.SHIPT_STATUS_CDE = 'AR') AS V              
286300                         ON U.SHIPT_ID = V.SHIPT_ID)                      
286400                      LEFT OUTER JOIN                                     
286500                      (SELECT B.SHIPT_ID                                  
286600                             ,A.STATUS_DTE                                
286700                         FROM  TSHIPST A                                  
286800                              ,TSHPTPO B                                  
286900                         WHERE B.PO_NBR         = :DK-PO-NBR              
287000                         AND A.SHIPT_ID         = B.SHIPT_ID              
287100                         AND A.SHIPT_STATUS_CDE = 'AG') AS W              
287200                         ON U.SHIPT_ID = W.SHIPT_ID)                      
287300               GROUP BY                                                   
287400                  U.OPER_UNT_ID                                           
287500*              OPTIMIZE FOR 9 ROWS                                        
287600     END-EXEC.                                                            
287700 EJECT                                                                    
287710*---------------------------------------------------------------*         
287720*  CURSOR TO PULL BACK DC STORE NUMBER                                    
287730*---------------------------------------------------------------*         
287740                                                                          
287750     EXEC SQL                                                             
287760       DECLARE STORE_CSR CURSOR FOR                                       
287770        SELECT A.LOC_NBR                                                  
287780              ,A.LOC_5_ABBR_NM                                            
287790        FROM XLT_LOC  A                                                   
287791           , XLT_DC_LOC_ASGMT  B                                          
287792        WHERE A.LOC_TYP_CDE = 'DC'                                        
287793          AND A.LOC_NBR = B.LOC_NBR                                       
287794          AND (CURRENT DATE <  (A.CLO_DTE + 30 DAYS)                      
287795           OR  '9999-09-09'  =  A.CLO_DTE)                                
287796          AND (A.ZIP_10_CDE <> '0'                                        
287797           OR  A.ZIP_10_CDE <> ' ')                                       
287798          AND B.EFF_BEG_DTE =                                             
287799              (SELECT MAX(C.EFF_BEG_DTE)                                  
287800                 FROM XLT_DC_LOC_ASGMT  C                                 
287801                WHERE C.LOC_NBR = A.LOC_NBR)                              
287802          AND (CURRENT DATE) > (B.EFF_BEG_DTE - 50 DAYS)                  
287803     END-EXEC.                                                            
287804 EJECT                                                                    
287805*---------------------------------------------------------------*         
287806*    CURSOR DECLARATION FOR SELECTING POE CODE CITY AND STATE   *         
287807*---------------------------------------------------------------*         
287808                                                                          
287809     EXEC SQL                                                             
287810          DECLARE  POE-CSR CURSOR                                         
287820              FOR  SELECT DISTINCT                                        
287830                   A.POE_CDE                                              
287840             FROM  TIMPOE  A                                              
287850            WHERE  A.POE_CDE        = :TR195-POE-CDE                      
287860     END-EXEC.                                                            
287870                                                                          
287880 EJECT                                                                    
290600*---------------------------------------------------------------*         
290700*    CURSOR DECLARATION TO OBTAIN ALL LINES FOR PURCHASE ORDERS *         
290800*---------------------------------------------------------------*         
290900                                                                          
291000     EXEC SQL                                                             
291100          DECLARE DC-SPLITS-CSR CURSOR FOR                                
291200           SELECT                                                         
291300                  A.APP_PO_LNE_NBR                                        
291400             FROM                                                         
291500                  TPURITM   A                                             
291600                , TPURCHS   B                                             
291700             WHERE A.PO_NBR         =  :DK-PO-NBR                         
291800               AND A.PO_NBR         =  B.PO_NBR                           
291900               AND A.VER_STATUS_CDE = 'A'                                 
292000               AND B.VER_STATUS_CDE = 'A'                                 
292100               AND A.STATUS_CDE     IN ('AC','AP','CM','CB','RV')         
292200               AND B.STATUS_CDE     IN ('AC','AP','CM','CA')              
292300             ORDER BY A.APP_PO_LNE_NBR                                    
292400     END-EXEC.                                                            
292500 LINKAGE SECTION.                                                         
292600                                                                          
292700                                                                          
292800 PROCEDURE DIVISION.                                                      
292900                                                                          
293000******************************************************************        
293100*  0000-MAINLINE - CONTROLS THE MAIN PROCESSING OF THE PROGRAM.  *        
293200******************************************************************        
293300 0000-PROGRAM-MAINLINE.                                                   
293400                                                                          
293500     PERFORM 1000-INITIALIZE.                                             
293600                                                                          
293700     PERFORM 2000-MAIN-LINE-PROCESS.                                      
293800                                                                          
293900     PERFORM 8000-EOJ-ROUTINE.                                            
294000     STOP RUN.                                                            
294100                                                                          
294200******************************************************************        
294300*  OPENS INPUT AND OUTPUT FILES AND PERFORMS OTHER BEGINNING OF  *        
294400*  JOB PROCESSES.                                                *        
294500******************************************************************        
294600                                                                          
294700 1000-INITIALIZE.                                                         
294800                                                                          
294900     OPEN INPUT TR196-SQL-STATEMENT                                       
295000                TR196-SELECTIONS                                          
295100         OUTPUT TR194-EXCEL-FILE.                                         
295200                                                                          
295300     INITIALIZE TR196-REC-SQL-STMT-TBL.                                   
295400*----------------------------------------------------------------*        
295500*    INITIALIZE BOTH BLOCKS IN THE ARRAY.                        *        
295600*    INITIALIZE ALL COUNTERS AND FLAGS.                          *        
295700*    READ THE DATA BASE FOR THE 1ST TIME AND FILL UP THE ARRAY.  *        
295800*    DISPLAY THE PANEL TO USER.                                  *        
295900*----------------------------------------------------------------*        
296000                                                                          
296100                                                                          
296200     INITIALIZE                 ASC-BLOCK-ENTRIES (1)                     
296300                                ASC-BLOCK-ENTRIES (2)                     
296400                                EXT-BLOCK-ENTRIES (1)                     
296500                                EXT-BLOCK-ENTRIES (2).                    
296600                                                                          
296700     MOVE +1                 TO ASC-BLK-SUB                               
296800                                ASC-ITEM-SUB                              
296900                                ASC-POQ-BLK-SUB                           
297000                                PV-STRING-POINTER-SELECT                  
297100                                PV-STRING-POINTER-FROM                    
297200                                PV-STRING-POINTER-WHERE.                  
297300                                                                          
297400     SET ASC-ITEMS-LEFT-ON-DB                                             
297500                             TO TRUE.                                     
297600     SET ASC-ITEMS-LEFT-ON-PO                                             
297700                             TO TRUE.                                     
297800     MOVE ASC-MAX-GROUPS     TO PV-GROUPS-TO-READ.                        
297900                                                                          
298000**** MOVE +0                 TO ASC-ITEM-SUB                              
298100     MOVE +0                 TO ASC-POQ-ITEM-SUB                          
298200                                ASC-POQ-LAST-SUB                          
298300                                ASC-NUMBER-OF-POS-READ                    
298400                                ASC-NBR-OF-POS-DISPLAYED                  
298500                                ASC-NUMBER-OF-ITEMS-READ                  
298600                                ASC-NUMBER-OF-SELECTED-ITEMS              
298700                                ASC-HIGHEST-BLOCK-WRITTEN                 
298800                                ASC-START-OF-SELECTED-RANGE               
298900                                ASC-END-OF-SELECTED-RANGE                 
299000                                ASC-ITEM-AT-TOP-OF-PANEL.                 
299100                                                                          
299200                                                                          
299300     MOVE SPACES        TO PV-FROM-CLAUSE                                 
299400                           PV-SELECT-CLAUSE                               
299500                           PV-WHERE-CLAUSE                                
299600                           PVS-DATA.                                      
299700                                                                          
299800     MOVE PC-DELIMITER  TO DELIM1                                         
299900                           DELIM2                                         
300000                           DELIM3                                         
300100                           DELIM4.                                        
300200                                                                          
300300     INITIALIZE  ASC-TFSC                                                 
300400                 ASC-TTTC                                                 
300500                 ASC-TDOR                                                 
300600                 ASC-TDRC                                                 
300700                 ASC-TURC                                                 
300800                 ASC-TUOR.                                                
300900                                                                          
301000     PERFORM 6000-READ-SQL-STATEMENT.                                     
301100     PERFORM 6100-READ-SELECTIONS.                                        
301200                                                                          
301300*    MOVE TR196-REC-SQL-STMT-TBL TO TR196-REC-SQL-STMT-ALL.               
301400     MOVE TR196-REC-SQL-STMT-TBL TO HOST-SQL-ARR.                         
301500     MOVE TR196-REC-SLCTIONS-TBL TO HOST-SLCT-ARR.                        
301600     MOVE HOST-SLCT-ARR          TO INTER-APPL-COMM-AREA.                 
301700     MOVE +0         TO ASC-MAX-VARIABLE-SCREENS.                         
301800     MOVE +1         TO ASC-MAX-GROUPS.                                   
301900     PERFORM 9400-SETUP-VARIABLE-PARAMETERS.                              
302000     MOVE +0 TO ASC-SEL-VARIABLE-SCREEN.                                  
302100     MOVE -1 TO ASC-REDRAW-VARIABLE-SCREEN.                               
302200                                                                          
302300     MOVE TR195-PO-NBR                TO ASC-KEY-PO-NBR.                  
302400     MOVE TR195-CNTRY-ORG             TO ASC-KEY-CNTRY-ORG.               
302500     MOVE TR195-CNTRY-PLC             TO ASC-KEY-CNTRY-PLC.               
302600     MOVE TR195-DEPT-NBR              TO ASC-DEPT-NBR.                    
302700     MOVE TR195-STATUS-GRP            TO ASC-STATUS-CLS.                  
302800     MOVE TR195-STATUS-CDE            TO ASC-STATUS-CDE.                  
302900     MOVE TR195-CLASS                 TO ASC-CLASS.                       
303000     MOVE TR195-SUBCLASS              TO ASC-SUBCLASS.                    
303100     MOVE TR195-PO-TYP-CDE            TO ASC-PO-TYP-CDE.                  
303200     MOVE TR195-SKU                   TO ASC-SKU.                         
303300     MOVE TR195-ENT-NAME-DESC         TO ASC-ENT-NAME-DESC.               
303400     MOVE TR195-VEND-STYL-NME         TO ASC-VEND-STYL-NME.               
303500     MOVE TR195-SEASONAL-SET          TO ASC-SEASONAL-SET.                
303600     MOVE TR195-DMM                   TO ASC-DMM.                         
303700     MOVE TR195-GROUP-CDE             TO ASC-GROUP-CDE.                   
303800                                                                          
303900     IF TR195-AD-EVNT-DTE > SPACES                                        
304000       MOVE TR195-AD-EVNT-DTE           TO PV-DATE-FIELD                  
304100       MOVE PV-DT-DD                    TO PV-DB2-DD                      
304200       MOVE PV-DT-MM                    TO PV-DB2-MM                      
304300       MOVE PV-DT-CC                    TO PV-DB2-CC                      
304400       MOVE PV-DT-YY                    TO PV-DB2-YY                      
304500       MOVE PV-DATE-DB2-FIELD           TO ASC-AD-EVNT-DTE                
304600     END-IF.                                                              
304700                                                                          
304800     MOVE TR195-PRE-PACK-IND          TO ASC-PRE-PACK-IND.                
304900     MOVE TR195-PIC-AD-IND            TO ASC-PIC-AD-IND.                  
305000     MOVE TR195-FOB-CDE               TO ASC-FOB-CDE.                     
305100     MOVE TR195-POE-CDE               TO ASC-POE-CDE.                     
305200     MOVE TR195-MAKER-NME             TO ASC-MAKER-NME.                   
305300     MOVE TR195-STR-NBR               TO ASC-STR-NBR.                     
305400     MOVE TR195-NEW-STR-IND           TO ASC-NEW-STR-IND.                 
305500                                                                          
305600     IF TR195-XFACT-BEF-DTE > SPACES                                      
305700       MOVE TR195-XFACT-BEF-DTE         TO PV-DATE-FIELD                  
305800       MOVE PV-DT-DD                    TO PV-DB2-DD                      
305900       MOVE PV-DT-MM                    TO PV-DB2-MM                      
306000       MOVE PV-DT-CC                    TO PV-DB2-CC                      
306100       MOVE PV-DT-YY                    TO PV-DB2-YY                      
306200       MOVE PV-DATE-DB2-FIELD           TO ASC-XFACT-BEF-DTE              
306300     END-IF.                                                              
306400                                                                          
306500     IF TR195-XFACT-END-DTE > SPACES                                      
306600       MOVE TR195-XFACT-END-DTE         TO PV-DATE-FIELD                  
306700       MOVE PV-DT-DD                    TO PV-DB2-DD                      
306800       MOVE PV-DT-MM                    TO PV-DB2-MM                      
306900       MOVE PV-DT-CC                    TO PV-DB2-CC                      
307000       MOVE PV-DT-YY                    TO PV-DB2-YY                      
307100       MOVE PV-DATE-DB2-FIELD           TO ASC-XFACT-END-DTE              
307200     END-IF.                                                              
307300                                                                          
307400     IF TR195-SHPDT-BEF-DTE > SPACES                                      
307500       MOVE TR195-SHPDT-BEF-DTE         TO PV-DATE-FIELD                  
307600       MOVE PV-DT-DD                    TO PV-DB2-DD                      
307700       MOVE PV-DT-MM                    TO PV-DB2-MM                      
307800       MOVE PV-DT-CC                    TO PV-DB2-CC                      
307900       MOVE PV-DT-YY                    TO PV-DB2-YY                      
308000       MOVE PV-DATE-DB2-FIELD           TO ASC-SHPDT-BEF-DTE              
308100     END-IF.                                                              
308200                                                                          
308300     IF TR195-SHPDT-END-DTE > SPACES                                      
308400       MOVE TR195-SHPDT-END-DTE         TO PV-DATE-FIELD                  
308500       MOVE PV-DT-DD                    TO PV-DB2-DD                      
308600       MOVE PV-DT-MM                    TO PV-DB2-MM                      
308700       MOVE PV-DT-CC                    TO PV-DB2-CC                      
308800       MOVE PV-DT-YY                    TO PV-DB2-YY                      
308900       MOVE PV-DATE-DB2-FIELD           TO ASC-SHPDT-END-DTE              
309000     END-IF.                                                              
309100                                                                          
309200     MOVE TR195-OTB-PER-NBR-BEG       TO ASC-OTB-PER-NBR-BEG.             
309300     MOVE TR195-OTB-PER-NBR-END       TO ASC-OTB-PER-NBR-END.             
309400     MOVE TR195-SORT1-BY-IND          TO ASC-SORT1-BY-IND.                
309500     MOVE TR195-SORT2-BY-IND          TO ASC-SORT2-BY-IND.                
309600     MOVE TR195-EDI-IND               TO ASC-EDI-IND.                     
309700     MOVE TR195-PRE-TICKET-IND        TO ASC-PRE-TICKET-IND.              
309800     MOVE TR195-DIRECT-STORE-IND      TO ASC-DIRECT-STORE-IND.            
309900     MOVE TR195-PACK-BY-STORE-IND     TO ASC-PACK-BY-STORE-IND.           
310000     MOVE TR195-QUOTA-CATEGORY        TO ASC-QUOTA-CATEGORY.              
310100                                                                          
310200     SET DISPLAY-HEADER TO TRUE.                                          
310300     PERFORM 9500-FORMAT-VARIABLE-DATA.                                   
310400                                                                          
310500 EJECT                                                                    
310600******************************************************************        
310700* MAIN PROCESSING PARAGRAPH.                                     *        
310800******************************************************************        
310900                                                                          
311000 2000-MAIN-LINE-PROCESS.                                                  
311100                                                                          
311200     DISPLAY ' TOP OF MAINLINE 2000-'.                                    
311300     PERFORM 4000-PREPARE-DYNAMIC-SQL.                                    
311400                                                                          
311500     DISPLAY ' 4000- EXECUTED SUCCESSFULLY '.                             
311600                                                                          
311700     PERFORM 4300-PROCESS-CURSOR                                          
311800         UNTIL ASC-NO-ITEMS-LEFT-ON-PO.                                   
311900                                                                          
312000     PERFORM 4400-CLOSE-CURSOR.                                           
312100                                                                          
312200     DISPLAY ' 4400-  CURSOR CLOSED '.                                    
312300                                                                          
312400****************************************************************          
312500* EXECUTES DECLARE, PREPARE, OPEN CSR FOR PASSED SELECT STMT              
312600****************************************************************          
312700                                                                          
312800 4000-PREPARE-DYNAMIC-SQL.                                                
312900                                                                          
313000     DISPLAY 'TOP OF 4000-PREP... '.                                      
313100     EXEC SQL                                                             
313200         DECLARE TASK-CSR CURSOR                                          
313300             FOR DYNMSQL                                                  
313400     END-EXEC.                                                            
313500                                                                          
313600     DISPLAY 'CURSOR DECLARED - SQLCODE = ' SQLCODE.                      
313700     EVALUATE TRUE                                                        
313800         WHEN SQLCODE = +0                                                
313900              CONTINUE                                                    
314000         WHEN SQLWARN0 NOT = SPACE                                        
314100         WHEN SQLCODE  NOT = +0                                           
314200           MOVE '4000-PREPARE-DYNAMIC-SQL' TO PV-PARAGRAPH-NAME           
314300           MOVE 'DECLARE TASK-CSR' TO PV-DB2-OPERATION-ATTEMPTED          
314400           PERFORM 9999-SQL-ABEND                                         
314500      END-EVALUATE.                                                       
314600                                                                          
314700     EXEC SQL                                                             
314800         PREPARE DYNMSQL FROM :TR196-REC-SQL-STMT-ALL                     
314900     END-EXEC.                                                            
315000                                                                          
315100     DISPLAY 'CURSOR PREPARED - SQLCODE = ' SQLCODE.                      
315200      EVALUATE TRUE                                                       
315300         WHEN SQLCODE = +0                                                
315400              CONTINUE                                                    
315500         WHEN SQLWARN0 NOT = SPACE                                        
315600         WHEN SQLCODE  NOT = +0                                           
315700           MOVE '4000-PREPARE-DYNAMIC-SQL' TO PV-PARAGRAPH-NAME           
315800           MOVE 'PREPARE TASK-CSR' TO PV-DB2-OPERATION-ATTEMPTED          
315900           PERFORM 9999-SQL-ABEND                                         
316000      END-EVALUATE.                                                       
316100                                                                          
316200                                                                          
316300                                                                          
316400     EXEC SQL                                                             
316500         OPEN TASK-CSR                                                    
316600     END-EXEC.                                                            
316700                                                                          
316800     DISPLAY 'CURSOR OPENED  - SQLCODE = ' SQLCODE.                       
316900      EVALUATE TRUE                                                       
317000         WHEN SQLCODE = +0                                                
317100              CONTINUE                                                    
317200         WHEN SQLWARN0 NOT = SPACE                                        
317300         WHEN SQLCODE  NOT = +0                                           
317400           MOVE '4000-PREPARE-DYNAMIC-SQL' TO PV-PARAGRAPH-NAME           
317500           MOVE '  OPEN  TASK-CSR' TO PV-DB2-OPERATION-ATTEMPTED          
317600           PERFORM 9999-SQL-ABEND                                         
317700      END-EVALUATE.                                                       
317800                                                                          
317900 4000-EXIT.                                                               
318000     EXIT.                                                                
318100                                                                          
318200                                                                          
318300 4300-PROCESS-CURSOR.                                                     
318400                                                                          
318500     PERFORM 4310-FETCH-CURSOR.                                           
318600                                                                          
318700     IF  ASC-ITEMS-LEFT-ON-PO                                             
318800      AND DK-PO-NBR NOT = PV-SV-PO-NBR                                    
318900                                                                          
319000         ADD +1  TO  ASC-NUMBER-OF-POS-READ                               
319100                     PV-READ-COUNT                                        
319200         MOVE DK-PO-NBR TO POX-PO                                         
319300         MOVE DK-PO-NBR TO PVS-PO-NBR                                     
319400         MOVE DK-PO-NBR TO PV-SV-PO-NBR                                   
319500                                                                          
319600         IF PV-USORT-SELECTED (PC-VFLD-DOR-I) = 'Y'                       
319700         OR PV-USORT-SELECTED (PC-VFLD-DRC-I) = 'Y'                       
319800         OR PV-USORT-SELECTED (PC-VFLD-DRP-I) = 'Y'                       
319900         OR PV-USORT-SELECTED (PC-VFLD-UOR-I) = 'Y'                       
320000         OR PV-USORT-SELECTED (PC-VFLD-URC-I) = 'Y'                       
320100         OR PV-USORT-SELECTED (PC-VFLD-URP-I) = 'Y'                       
320200            PERFORM 9930-GET-DOLLARS-RECEIVED                             
320300            PERFORM 9950-GET-UNITS-RECEIVED                               
320400            PERFORM 9970-GET-TOTAL-COST                                   
320500            PERFORM 9975-GET-TOTAL-VERIFIED-COST                          
320600            MOVE PV-TOT-FIRST-COST                                        
320700                 TO POX-FSC                                               
320800            MOVE PV-TOT-TTC                                               
320900                 TO POX-TTC                                               
321000            MOVE PV-TOT-TVC                                               
321100                 TO POX-TVC                                               
321200            MOVE PURCHS-TOT-VAL-RTL-AMT                                   
321300                 TO POX-DOR                                               
321400            MOVE PV-DOLLARS-RECEIVED                                      
321500                 TO POX-DRC                                               
321600            MOVE PV-UNITS-RECEIVED                                        
321700                 TO POX-URC                                               
321800            MOVE PURCHS-TOT-UNT-QTY                                       
321900                 TO POX-UOR                                               
322000            ADD      PV-UNITS-RECEIVED      TO ASC-TURC                   
322100            ADD      PURCHS-TOT-UNT-QTY     TO ASC-TUOR                   
322200            ADD      PV-TOT-FIRST-COST      TO ASC-TFSC                   
322300            ADD      PV-TOT-TTC             TO ASC-TTTC                   
322400            ADD      PV-TOT-TVC             TO ASC-TTVC                   
322500            ADD      PURCHS-TOT-VAL-RTL-AMT TO ASC-TDOR                   
322600            ADD      PV-DOLLARS-RECEIVED    TO ASC-TDRC                   
322700         END-IF                                                           
322800         PERFORM 9600-DB2-LOAD-PO-DATA                                    
322900         PERFORM 9610-DB2-LOAD-IMPORT-DATA                                
323000         PERFORM 9620-DB2-LOAD-DC-DATA                                    
323100         PERFORM 9910-GET-VENDOR-SHORT-NAME                               
323200         PERFORM 9923-SELECT-DMM-NBR                                      
323300         SET DISPLAY-LIST TO TRUE                                         
323400         PERFORM 9500-FORMAT-VARIABLE-DATA                                
323500         PERFORM 5111-WRITE-EXCEL-FILE                                    
323600     END-IF.                                                              
323700                                                                          
323800***  IF  ASC-NUMBER-OF-POS-READ > ZERO                                    
323900***      NEXT SENTENCE                                                    
324000***  END-IF.                                                              
324100                                                                          
324200 4300-EXIT.                                                               
324300     EXIT.                                                                
324400                                                                          
324500                                                                          
324600 4310-FETCH-CURSOR.                                                       
324700                                                                          
324800     IF ASC-SORT1-BY-IND = 'V'                                            
324900      OR ASC-SORT2-BY-IND = 'V'                                           
325000       EXEC SQL                                                           
325100         FETCH TASK-CSR                                                   
325200         INTO  :PV-PO-NBR-IN                                              
325300              ,:PV-FOB-CDE-IN                                             
325400              ,:PV-DEPT-NBR                                               
325500              ,:PLNSHP-LAST-FCTRY-DTE                                     
325600              ,:PLNSHP-DONT-SHIP-BEF-DTE                                  
325700              ,:PURCHS-TOT-VAL-RTL-AMT                                    
325800              ,:PURCHS-TOT-UNT-QTY                                        
325910              ,:XLT00004-VS-NBR                                           
326000       END-EXEC                                                           
326100     ELSE                                                                 
326200       EXEC SQL                                                           
326300         FETCH TASK-CSR                                                   
326400         INTO  :PV-PO-NBR-IN                                              
326500              ,:PV-FOB-CDE-IN                                             
326600              ,:PV-DEPT-NBR                                               
326700              ,:PLNSHP-LAST-FCTRY-DTE                                     
326800              ,:PLNSHP-DONT-SHIP-BEF-DTE                                  
326900              ,:PURCHS-TOT-VAL-RTL-AMT                                    
327000              ,:PURCHS-TOT-UNT-QTY                                        
327100       END-EXEC                                                           
327200     END-IF.                                                              
327300                                                                          
327400***  DISPLAY 'CURSOR FETCHED - SQLCODE = ' SQLCODE.                       
327500                                                                          
327600      EVALUATE TRUE                                                       
327700        WHEN SQLCODE = +0                                                 
327800            MOVE PV-PO-NBR-IN TO DK-PO-NBR                                
327900***         DISPLAY 'PO NBR = ' PV-PO-NBR-IN                              
328000        WHEN SQLCODE = +100                                               
328100            SET ASC-NO-ITEMS-LEFT-ON-PO TO TRUE                           
328200                                                                          
328300        WHEN SQLWARN0 NOT = SPACE                                         
328400        WHEN SQLCODE NOT = +0                                             
328500            MOVE '4310-FETCH-CURSOR ' TO PV-PARAGRAPH-NAME                
328600            MOVE '  FETCH TASK-CSR' TO PV-DB2-OPERATION-ATTEMPTED         
328700            PERFORM 9999-SQL-ABEND                                        
328800      END-EVALUATE.                                                       
328900                                                                          
329000 4310-EXIT.                                                               
329100     EXIT.                                                                
329200                                                                          
329300                                                                          
329400 4400-CLOSE-CURSOR.                                                       
329500                                                                          
329600     EXEC SQL                                                             
329700         CLOSE TASK-CSR                                                   
329800     END-EXEC.                                                            
329900                                                                          
330000     DISPLAY 'CURSOR CLOSED  - SQLCODE = ' SQLCODE.                       
330100      EVALUATE TRUE                                                       
330200         WHEN SQLCODE = +0                                                
330300              CONTINUE                                                    
330400         WHEN SQLWARN0 NOT = SPACE                                        
330500         WHEN SQLCODE  NOT = +0                                           
330600           MOVE '4400-CLOSE-CURSOR' TO PV-PARAGRAPH-NAME                  
330700           MOVE '  CLOSE TASK-CSR' TO PV-DB2-OPERATION-ATTEMPTED          
330800           PERFORM 9999-SQL-ABEND                                         
330900      END-EVALUATE.                                                       
331000 4400-EXIT.                                                               
331100     EXIT.                                                                
331200                                                                          
331300 EJECT                                                                    
331400******************************************************************        
331500 5111-WRITE-EXCEL-FILE.                                                   
331600                                                                          
331700         WRITE TR194-EXCEL-RECORD                                         
331800             FROM PV-SAVE-DATA.                                           
331900                                                                          
332000     ADD +1 TO WS-WRITE-COUNT.                                            
332100     EVALUATE TRUE                                                        
332200       WHEN WS-WRITE-COUNT = 16000                                        
332300         DISPLAY 'WROTE ' WS-WRITE-COUNT ' PO NBR = ' PV-PO-NBR-IN        
332400       WHEN WS-WRITE-COUNT = 15000                                        
332500         DISPLAY 'WROTE ' WS-WRITE-COUNT ' PO NBR = ' PV-PO-NBR-IN        
332600       WHEN WS-WRITE-COUNT = 14000                                        
332700         DISPLAY 'WROTE ' WS-WRITE-COUNT ' PO NBR = ' PV-PO-NBR-IN        
332800       WHEN WS-WRITE-COUNT = 13000                                        
332900         DISPLAY 'WROTE ' WS-WRITE-COUNT ' PO NBR = ' PV-PO-NBR-IN        
333000       WHEN WS-WRITE-COUNT = 12000                                        
333100         DISPLAY 'WROTE ' WS-WRITE-COUNT ' PO NBR = ' PV-PO-NBR-IN        
333200       WHEN WS-WRITE-COUNT = 11000                                        
333300         DISPLAY 'WROTE ' WS-WRITE-COUNT ' PO NBR = ' PV-PO-NBR-IN        
333400       WHEN WS-WRITE-COUNT = 10000                                        
333500         DISPLAY 'WROTE ' WS-WRITE-COUNT ' PO NBR = ' PV-PO-NBR-IN        
333600       WHEN WS-WRITE-COUNT = 9000                                         
333700         DISPLAY 'WROTE ' WS-WRITE-COUNT ' PO NBR = ' PV-PO-NBR-IN        
333800       WHEN WS-WRITE-COUNT = 8000                                         
333900         DISPLAY 'WROTE ' WS-WRITE-COUNT ' PO NBR = ' PV-PO-NBR-IN        
334000       WHEN WS-WRITE-COUNT = 7000                                         
334100         DISPLAY 'WROTE ' WS-WRITE-COUNT ' PO NBR = ' PV-PO-NBR-IN        
334200       WHEN WS-WRITE-COUNT = 6000                                         
334300         DISPLAY 'WROTE ' WS-WRITE-COUNT ' PO NBR = ' PV-PO-NBR-IN        
334400       WHEN WS-WRITE-COUNT = 5000                                         
334500         DISPLAY 'WROTE ' WS-WRITE-COUNT ' PO NBR = ' PV-PO-NBR-IN        
334600       WHEN WS-WRITE-COUNT = 4000                                         
334700         DISPLAY 'WROTE ' WS-WRITE-COUNT ' PO NBR = ' PV-PO-NBR-IN        
334800       WHEN WS-WRITE-COUNT = 3000                                         
334900         DISPLAY 'WROTE ' WS-WRITE-COUNT ' PO NBR = ' PV-PO-NBR-IN        
335000       WHEN WS-WRITE-COUNT = 2000                                         
335100         DISPLAY 'WROTE ' WS-WRITE-COUNT ' PO NBR = ' PV-PO-NBR-IN        
335200       WHEN WS-WRITE-COUNT = 1000                                         
335300         DISPLAY 'WROTE ' WS-WRITE-COUNT ' PO NBR = ' PV-PO-NBR-IN        
335400     END-EVALUATE.                                                        
335500                                                                          
335600******************************************************************        
335700* READ THE ENTIRE SQL STATEMENT PASSED FROM TRKCS196                      
335800******************************************************************        
335900 6000-READ-SQL-STATEMENT.                                                 
336000     DISPLAY 'TOP OF 6000- READ PARAGRAPH'.                               
336100                                                                          
336200     SET READX TO 1.                                                      
336300     READ TR196-SQL-STATEMENT                                             
336400         INTO TR196-REC-SQL-STMT(READX).                                  
336500     SET WS-RDX TO READX.                                                 
336600                                                                          
336700     IF TR196-REC-SQL-STMT(READX) = SPACES                                
336800         DISPLAY '**************************************'                 
336900         DISPLAY '** ABEND                            **'                 
337000         DISPLAY '** PROGRAM = TRKUT194               **'                 
337100         DISPLAY '** PARAGRAPH = 1000-INITIALIZE      **'                 
337200         DISPLAY '** NO SQL PASSED FROM POKCS196      **'                 
337300         DISPLAY '**************************************'                 
337400         PERFORM 9999-SQL-ABEND                                           
337500     ELSE                                                                 
337600         DISPLAY 'LINE # ' WS-RDX ' = ' TR196-REC-SQL-STMT(READX)         
337700         SET READX UP BY 1                                                
337800         PERFORM UNTIL READX > 19                                         
337900             READ TR196-SQL-STATEMENT                                     
338000                 INTO TR196-REC-SQL-STMT(READX)                           
338100               SET WS-RDX TO READX                                        
338200     DISPLAY 'LINE # ' WS-RDX ' = ' TR196-REC-SQL-STMT(READX)             
338300             SET READX UP BY 1                                            
338400         END-PERFORM                                                      
338500     END-IF.                                                              
338600******************************************************************        
338700* READ THE ENTIRE SELECTION FILE PASSED FROM TRKCS195                     
338800******************************************************************        
338900 6100-READ-SELECTIONS.                                                    
339000     DISPLAY 'TOP OF 6100- READ PARAGRAPH'.                               
339100                                                                          
339200     SET SLCTX TO 1.                                                      
339300     READ TR196-SELECTIONS                                                
339400         INTO TR196-REC-SLCTIONS(SLCTX).                                  
339500     SET WS-SLX TO SLCTX.                                                 
339600                                                                          
339700     IF TR196-REC-SLCTIONS(SLCTX) = SPACES                                
339800         DISPLAY '**************************************'                 
339900         DISPLAY '** ABEND                            **'                 
340000         DISPLAY '** PROGRAM = TRKUT194               **'                 
340100         DISPLAY '** PARAGRAPH = 1000-INITIALIZE      **'                 
340200         DISPLAY '** NO SELECTIONS FROM POKCS195      **'                 
340300         DISPLAY '**************************************'                 
340400         PERFORM 9999-SQL-ABEND                                           
340500     ELSE                                                                 
340600         DISPLAY 'LINE # ' WS-SLX ' = ' TR196-REC-SLCTIONS(SLCTX)         
340700         SET SLCTX UP BY 1                                                
340800         PERFORM UNTIL SLCTX >  3                                         
340900             READ TR196-SELECTIONS                                        
341000                 INTO TR196-REC-SLCTIONS(SLCTX)                           
341100               SET WS-SLX TO SLCTX                                        
341200     DISPLAY 'LINE # ' WS-SLX ' = ' TR196-REC-SLCTIONS(SLCTX)             
341300             SET SLCTX UP BY 1                                            
341400         END-PERFORM                                                      
341500     END-IF.                                                              
341600*****************************************************************         
341700     MOVE TR196-REC-SLCTIONS-TBL TO HOST-SLCT-ARR.                        
341800     MOVE HOST-SLCT-ARR TO INTER-APPL-COMM-AREA.                          
341900                                                                          
342000******************************************************************        
342100* CLOSE THE INPUT AND OUTPUT FILES AND DISPLAY MISCELLANEOUS     *        
342200* JOB SUMMARY INFORMATION.                                       *        
342300* THE LAST RECORD ON THE FILE MUST BE AN EDI IEA RECORD.  IF IT  *        
342400* IS NOT, CALL THE EDI GROUP AND HAVE THEM CHECK THE INBOUND     *        
342500* TRANSMISSION.  IF ONE RECORD IS EVEN 1 BYTE TO LONG, THE EDI   *        
342600* TRANSLATOR STOPS TRANSLATING AND ENDS AS IF NOTHING WENT WRONG.*        
342700* NO RETURN CODE OR MESSAGE IS SENT.                             *        
342800******************************************************************        
342900 8000-EOJ-ROUTINE.                                                        
343000                                                                          
343100     CLOSE TR196-SQL-STATEMENT                                            
343200           TR196-SELECTIONS                                               
343300           TR194-EXCEL-FILE.                                              
343400                                                                          
343500     DISPLAY '*************************************************'.         
343600     DISPLAY '** TRKUT194 SUMMARY                            **'.         
343700     DISPLAY '*************************************************'.         
343800     DISPLAY 'TOTAL RECORDS READ     = ' PV-READ-COUNT.                   
343900     DISPLAY '*************************************************'.         
344000*----------------------------------------------------------------*        
344100*  SET UP THE VARIABLE CONTROL TABLE                             *        
344200*----------------------------------------------------------------*        
344300                                                                          
344400 9400-SETUP-VARIABLE-PARAMETERS.                                          
344500                                                                          
344600*#VARIABLE_LOGIC_GROUP_1-----------------------------------------*        
344700*  THIS CODE IS PART OF THE INITIAL PROGRAM START UP PHASE.      *        
344800*  IT BEGINS BY LOADING ALL OF THE DC STORE NUMBERS.  THEN       *        
344900*  IT SCANS THE TR19-DISPLAY-DXXX CRITERIA FIELDS TO DETERMINE   *        
345000*  WHAT FIELDS SHOULD DISPLAY.  IF THE USERS OVERRIDE THE        *        
345100*  PLACEMENT OF COLUMNS ON THE VARIABLE DISPLAY, THEN THIS       *        
345200*  SECTION SETS UP THE OVERRIDE ORDER.                           *        
345300*----------------------------------------------------------------*        
345400*---------------------------------------------------------------*         
345500*  #TIP ==>                                                     *         
345600*  IF MORE THAN 12 DCS ARE NEEDED THEN PARAGRAPH                *         
345700*  9870-FETCH-STORE WILL NEED TO CHANGE.                        *         
345800*---------------------------------------------------------------*         
345900     SET MORE-STORE-DATA TO TRUE.                                         
346000     PERFORM 9860-OPEN-STORE-CURSOR.                                      
346100     PERFORM 9870-FETCH-STORE                                             
346200                    UNTIL NO-MORE-STORE-DATA                              
346300     PERFORM 9880-CLOSE-STORE-CURSOR.                                     
346400     MOVE PV-DC-TABLE TO ASC-DC-TABLE.                                    
346500     MOVE PV-DC-I     TO ASC-DC-NMBR.                                     
346600                                                                          
346700*---------------------------------------------------------------*         
346800*  #TIP ==>                                                     *         
346900*  IF ADDING A NEW DISPLAY CRITERIA FIELD THEN A CLONE          *         
347000*  OF ONE OF THE FOLLOWING.                                     *         
347100*                                                               *         
347200*  NORMALLY THE CONVENTION FOR EACH BLOCK SHOULD NEVER          *         
347300*  CHANGE.                                                      *         
347400*---------------------------------------------------------------*         
347500     IF TR195-DISPLAY-DFOB                                                
347600        SET DO-SCREEN-DIMENSION TO TRUE                                   
347700        MOVE TR195-DFOB         TO PV-FOB-SELECTED                        
347800        MOVE PC-VFLD-FOB-I      TO PV-FOB-POINTER                         
347900        MOVE PV-VFLD-FOB-DORDER TO PV-FOB-OORDER                          
348000        IF TR195-DISPLAY-OFOB                                             
348100           MOVE PC-SEL     TO PV-FOB-SELECTED                             
348200           MOVE TR195-DFOB TO PV-FOB-OORDER.                              
348300                                                                          
348400     IF TR195-DISPLAY-DPOE                                                
348500        SET DO-SCREEN-DIMENSION TO TRUE                                   
348600        MOVE TR195-DPOE         TO PV-POE-SELECTED                        
348700        MOVE PC-VFLD-POE-I      TO PV-POE-POINTER                         
348800        MOVE PV-VFLD-POE-DORDER TO PV-POE-OORDER                          
348900        IF TR195-DISPLAY-OPOE                                             
349000           MOVE PC-SEL     TO PV-POE-SELECTED                             
349100           MOVE TR195-DPOE TO PV-POE-OORDER.                              
349200                                                                          
349300     IF TR195-DISPLAY-DDSB                                                
349400        SET DO-SCREEN-DIMENSION TO TRUE                                   
349500        MOVE TR195-DDSB         TO PV-DSB-SELECTED                        
349600        MOVE PC-VFLD-DSB-I      TO PV-DSB-POINTER                         
349700        MOVE PV-VFLD-DSB-DORDER TO PV-DSB-OORDER                          
349800        IF TR195-DISPLAY-ODSB                                             
349900           MOVE PC-SEL     TO PV-DSB-SELECTED                             
350000           MOVE TR195-DDSB TO PV-DSB-OORDER.                              
350100                                                                          
350200     IF TR195-DISPLAY-DXFC                                                
350300        SET DO-SCREEN-DIMENSION TO TRUE                                   
350400        MOVE TR195-DXFC         TO PV-SXF-SELECTED                        
350500        MOVE PC-VFLD-SXF-I      TO PV-SXF-POINTER                         
350600        MOVE PV-VFLD-SXF-DORDER TO PV-SXF-OORDER                          
350700        IF TR195-DISPLAY-OXFC                                             
350800           MOVE PC-SEL     TO PV-SXF-SELECTED                             
350900           MOVE TR195-DXFC TO PV-SXF-OORDER.                              
351000                                                                          
351100     IF TR195-DISPLAY-DXFC                                                
351200        SET DO-SCREEN-DIMENSION TO TRUE                                   
351300        MOVE TR195-DXFC         TO PV-LXF-SELECTED                        
351400        MOVE PC-VFLD-LXF-I      TO PV-LXF-POINTER                         
351500        MOVE PV-VFLD-LXF-DORDER TO PV-LXF-OORDER                          
351600        IF TR195-DISPLAY-OXFC                                             
351700           MOVE PC-SEL     TO PV-LXF-SELECTED                             
351800           MOVE TR195-DXFC TO PV-LXF-OORDER.                              
351900                                                                          
352000     IF TR195-DISPLAY-DCNL                                                
352100        SET DO-SCREEN-DIMENSION TO TRUE                                   
352200        MOVE TR195-DCNL         TO PV-CNL-SELECTED                        
352300        MOVE PC-VFLD-CNL-I      TO PV-CNL-POINTER                         
352400        MOVE PV-VFLD-CNL-DORDER TO PV-CNL-OORDER                          
352500        IF TR195-DISPLAY-OCNL                                             
352600           MOVE PC-SEL     TO PV-CNL-SELECTED                             
352700           MOVE TR195-DCNL TO PV-CNL-OORDER.                              
352800                                                                          
352900     IF TR195-DISPLAY-DFRD                                                
353000        SET DO-SCREEN-DIMENSION TO TRUE                                   
353100        MOVE TR195-DFRD         TO PV-FRD-SELECTED                        
353200        MOVE PC-VFLD-FRD-I      TO PV-FRD-POINTER                         
353300        MOVE PV-VFLD-FRD-DORDER TO PV-FRD-OORDER                          
353400        IF TR195-DISPLAY-OFRD                                             
353500           MOVE PC-SEL     TO PV-FRD-SELECTED                             
353600           MOVE TR195-DFRD TO PV-FRD-OORDER.                              
353700                                                                          
353800     IF TR195-DISPLAY-DSLD                                                
353900        SET DO-SCREEN-DIMENSION TO TRUE                                   
354000        MOVE TR195-DSLD         TO PV-SLD-SELECTED                        
354100        MOVE PC-VFLD-SLD-I      TO PV-SLD-POINTER                         
354200        MOVE PV-VFLD-SLD-DORDER TO PV-SLD-OORDER                          
354300        IF TR195-DISPLAY-OSLD                                             
354400           MOVE PC-SEL     TO PV-SLD-SELECTED                             
354500           MOVE TR195-DSLD TO PV-SLD-OORDER.                              
354600                                                                          
354700     IF TR195-DISPLAY-DPRD                                                
354800        SET DO-SCREEN-DIMENSION TO TRUE                                   
354900        MOVE TR195-DPRD         TO PV-PRD-SELECTED                        
355000        MOVE PC-VFLD-PRD-I      TO PV-PRD-POINTER                         
355100        MOVE PV-VFLD-PRD-DORDER TO PV-PRD-OORDER                          
355200        IF TR195-DISPLAY-OPRD                                             
355300           MOVE PC-SEL     TO PV-PRD-SELECTED                             
355400           MOVE TR195-DPRD TO PV-PRD-OORDER.                              
355500                                                                          
355600     IF TR195-DISPLAY-DPRD                                                
355700        SET DO-SCREEN-DIMENSION TO TRUE                                   
355800        MOVE TR195-DPRD         TO PV-CNT-SELECTED                        
355900        MOVE PC-VFLD-CNT-I      TO PV-CNT-POINTER                         
356000        MOVE PV-VFLD-CNT-DORDER TO PV-CNT-OORDER                          
356100        IF TR195-DISPLAY-OPRD                                             
356200           MOVE PC-SEL     TO PV-CNT-SELECTED                             
356300           MOVE TR195-DPRD TO PV-CNT-OORDER.                              
356400                                                                          
356500     IF TR195-DISPLAY-DCSR                                                
356600        SET DO-SCREEN-DIMENSION TO TRUE                                   
356700        MOVE TR195-DCSR         TO PV-CSR-SELECTED                        
356800        MOVE PC-VFLD-CSR-I      TO PV-CSR-POINTER                         
356900        MOVE PV-VFLD-CSR-DORDER TO PV-CSR-OORDER                          
357000        IF TR195-DISPLAY-OCSR                                             
357100           MOVE PC-SEL     TO PV-CSR-SELECTED                             
357200           MOVE TR195-DCSR TO PV-CSR-OORDER.                              
357300                                                                          
357400     IF TR195-DISPLAY-DETA                                                
357500      IF DC-STORE-NMBR(1) NOT = ZEROS                                     
357600        SET DO-SCREEN-DIMENSION TO TRUE                                   
357700        MOVE TR195-DETA         TO PV-DC1-SELECTED                        
357800        MOVE PC-VFLD-DC1-I      TO PV-DC1-POINTER                         
357900        MOVE PV-VFLD-DC1-DORDER TO PV-DC1-OORDER                          
358000        IF TR195-DISPLAY-OETA                                             
358100           MOVE PC-SEL     TO PV-DC1-SELECTED                             
358200           MOVE TR195-DETA TO PV-DC1-OORDER.                              
358300                                                                          
358400     IF TR195-DISPLAY-DETA                                                
358500      IF DC-STORE-NMBR(2) NOT = ZEROS                                     
358600        SET DO-SCREEN-DIMENSION TO TRUE                                   
358700        MOVE TR195-DETA         TO PV-DC2-SELECTED                        
358800        MOVE PC-VFLD-DC2-I      TO PV-DC2-POINTER                         
358900        MOVE PV-VFLD-DC2-DORDER TO PV-DC2-OORDER                          
359000        IF TR195-DISPLAY-OETA                                             
359100           MOVE PC-SEL     TO PV-DC2-SELECTED                             
359200           MOVE TR195-DETA TO PV-DC2-OORDER.                              
359300                                                                          
359400     IF TR195-DISPLAY-DETA                                                
359500      IF DC-STORE-NMBR(3) NOT = ZEROS                                     
359600        SET DO-SCREEN-DIMENSION TO TRUE                                   
359700        MOVE TR195-DETA         TO PV-DC3-SELECTED                        
359800        MOVE PC-VFLD-DC3-I      TO PV-DC3-POINTER                         
359900        MOVE PV-VFLD-DC3-DORDER TO PV-DC3-OORDER                          
360000        IF TR195-DISPLAY-OETA                                             
360100           MOVE PC-SEL     TO PV-DC3-SELECTED                             
360200           MOVE TR195-DETA TO PV-DC3-OORDER.                              
360300                                                                          
360400     IF TR195-DISPLAY-DETA                                                
360500      IF DC-STORE-NMBR(4) NOT = ZEROS                                     
360600        SET DO-SCREEN-DIMENSION TO TRUE                                   
360700        MOVE TR195-DETA         TO PV-DC4-SELECTED                        
360800        MOVE PC-VFLD-DC4-I      TO PV-DC4-POINTER                         
360900        MOVE PV-VFLD-DC4-DORDER TO PV-DC4-OORDER                          
361000        IF TR195-DISPLAY-OETA                                             
361100           MOVE PC-SEL     TO PV-DC4-SELECTED                             
361200           MOVE TR195-DETA TO PV-DC4-OORDER.                              
361300                                                                          
361400     IF TR195-DISPLAY-DETA                                                
361500      IF DC-STORE-NMBR(5) NOT = ZEROS                                     
361600        SET DO-SCREEN-DIMENSION TO TRUE                                   
361700        MOVE TR195-DETA         TO PV-DC5-SELECTED                        
361800        MOVE PC-VFLD-DC5-I      TO PV-DC5-POINTER                         
361900        MOVE PV-VFLD-DC5-DORDER TO PV-DC5-OORDER                          
362000        IF TR195-DISPLAY-OETA                                             
362100           MOVE PC-SEL     TO PV-DC5-SELECTED                             
362200           MOVE TR195-DETA TO PV-DC5-OORDER.                              
362300                                                                          
362400     IF TR195-DISPLAY-DETA                                                
362500      IF DC-STORE-NMBR(6) NOT = ZEROS                                     
362600        SET DO-SCREEN-DIMENSION TO TRUE                                   
362700        MOVE TR195-DETA         TO PV-DC6-SELECTED                        
362800        MOVE PC-VFLD-DC6-I      TO PV-DC6-POINTER                         
362900        MOVE PV-VFLD-DC6-DORDER TO PV-DC6-OORDER                          
363000        IF TR195-DISPLAY-OETA                                             
363100           MOVE PC-SEL     TO PV-DC6-SELECTED                             
363200           MOVE TR195-DETA TO PV-DC6-OORDER.                              
363300                                                                          
363400     IF TR195-DISPLAY-DETA                                                
363500      IF DC-STORE-NMBR(7) NOT = ZEROS                                     
363600        SET DO-SCREEN-DIMENSION TO TRUE                                   
363700        MOVE TR195-DETA         TO PV-DC7-SELECTED                        
363800        MOVE PC-VFLD-DC7-I      TO PV-DC7-POINTER                         
363900        MOVE PV-VFLD-DC7-DORDER TO PV-DC7-OORDER                          
364000        IF TR195-DISPLAY-OETA                                             
364100           MOVE PC-SEL     TO PV-DC7-SELECTED                             
364200           MOVE TR195-DETA TO PV-DC7-OORDER.                              
364300                                                                          
364400     IF TR195-DISPLAY-DETA                                                
364500      IF DC-STORE-NMBR(8) NOT = ZEROS                                     
364600        SET DO-SCREEN-DIMENSION TO TRUE                                   
364700        MOVE TR195-DETA         TO PV-DC8-SELECTED                        
364800        MOVE PC-VFLD-DC8-I      TO PV-DC8-POINTER                         
364900        MOVE PV-VFLD-DC8-DORDER TO PV-DC8-OORDER                          
365000        IF TR195-DISPLAY-OETA                                             
365100           MOVE PC-SEL     TO PV-DC8-SELECTED                             
365200           MOVE TR195-DETA TO PV-DC8-OORDER.                              
365300                                                                          
365400     IF TR195-DISPLAY-DETA                                                
365500      IF DC-STORE-NMBR(9) NOT = ZEROS                                     
365600        SET DO-SCREEN-DIMENSION TO TRUE                                   
365700        MOVE TR195-DETA         TO PV-DC9-SELECTED                        
365800        MOVE PC-VFLD-DC9-I      TO PV-DC9-POINTER                         
365900        MOVE PV-VFLD-DC9-DORDER TO PV-DC9-OORDER                          
366000        IF TR195-DISPLAY-OETA                                             
366100           MOVE PC-SEL     TO PV-DC9-SELECTED                             
366200           MOVE TR195-DETA TO PV-DC9-OORDER.                              
366300                                                                          
366400     IF TR195-DISPLAY-DETA                                                
366500      IF DC-STORE-NMBR(10) NOT = ZEROS                                    
366600        SET DO-SCREEN-DIMENSION TO TRUE                                   
366700        MOVE TR195-DETA          TO PV-DC10-SELECTED                      
366800        MOVE PC-VFLD-DC10-I      TO PV-DC10-POINTER                       
366900        MOVE PV-VFLD-DC10-DORDER TO PV-DC10-OORDER                        
367000        IF TR195-DISPLAY-OETA                                             
367100           MOVE PC-SEL     TO PV-DC10-SELECTED                            
367200           MOVE TR195-DETA TO PV-DC10-OORDER.                             
367300                                                                          
367400     IF TR195-DISPLAY-DETA                                                
367500      IF DC-STORE-NMBR(11) NOT = ZEROS                                    
367600        SET DO-SCREEN-DIMENSION TO TRUE                                   
367700        MOVE TR195-DETA          TO PV-DC11-SELECTED                      
367800        MOVE PC-VFLD-DC11-I      TO PV-DC11-POINTER                       
367900        MOVE PV-VFLD-DC11-DORDER TO PV-DC11-OORDER                        
368000        IF TR195-DISPLAY-OETA                                             
368100           MOVE PC-SEL     TO PV-DC11-SELECTED                            
368200           MOVE TR195-DETA TO PV-DC11-OORDER.                             
368300                                                                          
368400     IF TR195-DISPLAY-DETA                                                
368500      IF DC-STORE-NMBR(12) NOT = ZEROS                                    
368600        SET DO-SCREEN-DIMENSION TO TRUE                                   
368700        MOVE TR195-DETA          TO PV-DC12-SELECTED                      
368800        MOVE PC-VFLD-DC12-I      TO PV-DC12-POINTER                       
368900        MOVE PV-VFLD-DC12-DORDER TO PV-DC12-OORDER                        
369000        IF TR195-DISPLAY-OETA                                             
369100           MOVE PC-SEL     TO PV-DC12-SELECTED                            
369200           MOVE TR195-DETA TO PV-DC12-OORDER.                             
369300                                                                          
369400     IF TR195-DISPLAY-DDVN                                                
369500        SET DO-SCREEN-DIMENSION TO TRUE                                   
369600        MOVE TR195-DDVN         TO PV-DVN-SELECTED                        
369700        MOVE PC-VFLD-DVN-I      TO PV-DVN-POINTER                         
369800        MOVE PV-VFLD-DVN-DORDER TO PV-DVN-OORDER                          
369900        IF TR195-DISPLAY-ODVN                                             
370000           MOVE PC-SEL     TO PV-DVN-SELECTED                             
370100           MOVE TR195-DDVN TO PV-DVN-OORDER.                              
370200                                                                          
370300     IF TR195-DISPLAY-DBKD                                                
370400        SET DO-SCREEN-DIMENSION TO TRUE                                   
370500        MOVE TR195-DBKD         TO PV-BKD-SELECTED                        
370600        MOVE PC-VFLD-BKD-I      TO PV-BKD-POINTER                         
370700        MOVE PV-VFLD-BKD-DORDER TO PV-BKD-OORDER                          
370800        IF TR195-DISPLAY-OBKD                                             
370900           MOVE PC-SEL     TO PV-BKD-SELECTED                             
371000           MOVE TR195-DBKD TO PV-BKD-OORDER.                              
371100                                                                          
371200     IF TR195-DISPLAY-DDOL                                                
371300        SET DO-SCREEN-DIMENSION TO TRUE                                   
371400        MOVE TR195-DDOL         TO PV-FSC-SELECTED                        
371500        MOVE PC-VFLD-FSC-I      TO PV-FSC-POINTER                         
371600        MOVE PV-VFLD-FSC-DORDER TO PV-FSC-OORDER                          
371700        IF TR195-DISPLAY-ODOL                                             
371800           MOVE PC-SEL     TO PV-FSC-SELECTED                             
371900           MOVE TR195-DDOL TO PV-FSC-OORDER.                              
372000                                                                          
372100     IF TR195-DISPLAY-DDOL                                                
372200        SET DO-SCREEN-DIMENSION TO TRUE                                   
372300        MOVE TR195-DDOL         TO PV-TTC-SELECTED                        
372400        MOVE PC-VFLD-TTC-I      TO PV-TTC-POINTER                         
372500        MOVE PV-VFLD-TTC-DORDER TO PV-TTC-OORDER                          
372600        IF TR195-DISPLAY-ODOL                                             
372700           MOVE PC-SEL     TO PV-TTC-SELECTED                             
372800           MOVE TR195-DDOL TO PV-TTC-OORDER.                              
372900                                                                          
373000     IF TR195-DISPLAY-DDOL                                                
373100        SET DO-SCREEN-DIMENSION TO TRUE                                   
373200        MOVE TR195-DDOL         TO PV-TVC-SELECTED                        
373300        MOVE PC-VFLD-TVC-I      TO PV-TVC-POINTER                         
373400        MOVE PV-VFLD-TVC-DORDER TO PV-TVC-OORDER                          
373500        IF TR195-DISPLAY-ODOL                                             
373600           MOVE PC-SEL     TO PV-TVC-SELECTED                             
373700           MOVE TR195-DDOL TO PV-TVC-OORDER.                              
373800                                                                          
373900     IF TR195-DISPLAY-DUNT                                                
374000        SET DO-SCREEN-DIMENSION TO TRUE                                   
374100        MOVE TR195-DUNT         TO PV-UOR-SELECTED                        
374200        MOVE PC-VFLD-UOR-I      TO PV-UOR-POINTER                         
374300        MOVE PV-VFLD-UOR-DORDER TO PV-UOR-OORDER                          
374400        IF TR195-DISPLAY-OUNT                                             
374500           MOVE PC-SEL     TO PV-UOR-SELECTED                             
374600           MOVE TR195-DUNT TO PV-UOR-OORDER.                              
374700                                                                          
374800     IF TR195-DISPLAY-DUNT                                                
374900        SET DO-SCREEN-DIMENSION TO TRUE                                   
375000        MOVE TR195-DUNT         TO PV-URC-SELECTED                        
375100        MOVE PC-VFLD-URC-I      TO PV-URC-POINTER                         
375200        MOVE PV-VFLD-URC-DORDER TO PV-URC-OORDER                          
375300        IF TR195-DISPLAY-OUNT                                             
375400           MOVE PC-SEL     TO PV-URC-SELECTED                             
375500           MOVE TR195-DUNT TO PV-URC-OORDER.                              
375600                                                                          
375700     IF TR195-DISPLAY-DUNT                                                
375800        SET DO-SCREEN-DIMENSION TO TRUE                                   
375900        MOVE TR195-DUNT         TO PV-URP-SELECTED                        
376000        MOVE PC-VFLD-URP-I      TO PV-URP-POINTER                         
376100        MOVE PV-VFLD-URP-DORDER TO PV-URP-OORDER                          
376200        IF TR195-DISPLAY-OUNT                                             
376300           MOVE PC-SEL     TO PV-URP-SELECTED                             
376400           MOVE TR195-DUNT TO PV-URP-OORDER.                              
376500                                                                          
376600     IF TR195-DISPLAY-DDOL                                                
376700        SET DO-SCREEN-DIMENSION TO TRUE                                   
376800        MOVE TR195-DDOL         TO PV-DOR-SELECTED                        
376900        MOVE PC-VFLD-DOR-I      TO PV-DOR-POINTER                         
377000        MOVE PV-VFLD-DOR-DORDER TO PV-DOR-OORDER                          
377100        IF TR195-DISPLAY-ODOL                                             
377200           MOVE PC-SEL     TO PV-DOR-SELECTED                             
377300           MOVE TR195-DDOL TO PV-DOR-OORDER.                              
377400                                                                          
377500     IF TR195-DISPLAY-DDOL                                                
377600        SET DO-SCREEN-DIMENSION TO TRUE                                   
377700        MOVE TR195-DDOL         TO PV-DRC-SELECTED                        
377800        MOVE PC-VFLD-DRC-I      TO PV-DRC-POINTER                         
377900        MOVE PV-VFLD-DRC-DORDER TO PV-DRC-OORDER                          
378000        IF TR195-DISPLAY-ODOL                                             
378100           MOVE PC-SEL     TO PV-DRC-SELECTED                             
378200           MOVE TR195-DDOL TO PV-DRC-OORDER.                              
378300                                                                          
378400     IF TR195-DISPLAY-DDOL                                                
378500        SET DO-SCREEN-DIMENSION TO TRUE                                   
378600        MOVE TR195-DDOL         TO PV-DRP-SELECTED                        
378700        MOVE PC-VFLD-DRP-I      TO PV-DRP-POINTER                         
378800        MOVE PV-VFLD-DRP-DORDER TO PV-DRP-OORDER                          
378900        IF TR195-DISPLAY-ODOL                                             
379000           MOVE PC-SEL     TO PV-DRP-SELECTED                             
379100           MOVE TR195-DDOL TO PV-DRP-OORDER.                              
379200                                                                          
379300     IF TR195-DISPLAY-DOTB                                                
379400        SET DO-SCREEN-DIMENSION TO TRUE                                   
379500        MOVE TR195-DOTB         TO PV-OTB-SELECTED                        
379600        MOVE PC-VFLD-OTB-I      TO PV-OTB-POINTER                         
379700        MOVE PV-VFLD-OTB-DORDER TO PV-OTB-OORDER                          
379800        IF TR195-DISPLAY-OOTB                                             
379900           MOVE PC-SEL     TO PV-OTB-SELECTED                             
380000           MOVE TR195-DOTB TO PV-OTB-OORDER.                              
380100                                                                          
380200     IF TR195-DISPLAY-DEDI                                                
380300        SET DO-SCREEN-DIMENSION TO TRUE                                   
380400        MOVE TR195-DEDI         TO PV-EDI-SELECTED                        
380500        MOVE PC-VFLD-EDI-I      TO PV-EDI-POINTER                         
380600        MOVE PV-VFLD-EDI-DORDER TO PV-EDI-OORDER                          
380700        IF TR195-DISPLAY-OEDI                                             
380800           MOVE PC-SEL     TO PV-EDI-SELECTED                             
380900           MOVE TR195-DEDI TO PV-EDI-OORDER.                              
381000                                                                          
381100     IF TR195-DISPLAY-DPPK                                                
381200        SET DO-SCREEN-DIMENSION TO TRUE                                   
381300        MOVE TR195-DPPK         TO PV-PPK-SELECTED                        
381400        MOVE PC-VFLD-PPK-I      TO PV-PPK-POINTER                         
381500        MOVE PV-VFLD-PPK-DORDER TO PV-PPK-OORDER                          
381600        IF TR195-DISPLAY-OPPK                                             
381700           MOVE PC-SEL     TO PV-PPK-SELECTED                             
381800           MOVE TR195-DPPK TO PV-PPK-OORDER.                              
381900                                                                          
382000     IF TR195-DISPLAY-DSTA                                                
382100        SET DO-SCREEN-DIMENSION TO TRUE                                   
382200        MOVE TR195-DSTA         TO PV-STA-SELECTED                        
382300        MOVE PC-VFLD-STA-I      TO PV-STA-POINTER                         
382400        MOVE PV-VFLD-STA-DORDER TO PV-STA-OORDER                          
382500        IF TR195-DISPLAY-OSTA                                             
382600           MOVE PC-SEL     TO PV-STA-SELECTED                             
382700           MOVE TR195-DSTA TO PV-STA-OORDER.                              
382800                                                                          
382900     IF TR195-DISPLAY-DTRP                                                
383000        SET DO-SCREEN-DIMENSION TO TRUE                                   
383100        MOVE TR195-DTRP         TO PV-TRP-SELECTED                        
383200        MOVE PC-VFLD-TRP-I      TO PV-TRP-POINTER                         
383300        MOVE PV-VFLD-TRP-DORDER TO PV-TRP-OORDER                          
383400        IF TR195-DISPLAY-OTRP                                             
383500           MOVE PC-SEL     TO PV-TRP-SELECTED                             
383600           MOVE TR195-DTRP TO PV-TRP-OORDER.                              
383700                                                                          
383800     IF TR195-DISPLAY-DSPL                                                
383900        SET DO-SCREEN-DIMENSION TO TRUE                                   
384000        MOVE TR195-DSPL             TO PV-SPL-CRT-SELECTED                
384100        MOVE PC-VFLD-SPL-CRT-I      TO PV-SPL-CRT-POINTER                 
384200        MOVE PV-VFLD-SPL-CRT-DORDER TO PV-SPL-CRT-OORDER                  
384300        IF TR195-DISPLAY-OSPL                                             
384400           MOVE PC-SEL     TO PV-SPL-CRT-SELECTED                         
384500           MOVE TR195-DSPL TO PV-SPL-CRT-OORDER.                          
384600                                                                          
384700     IF TR195-DISPLAY-DSPL                                                
384800        SET DO-SCREEN-DIMENSION TO TRUE                                   
384900        MOVE TR195-DSPL             TO PV-SPL-SNT-SELECTED                
385000        MOVE PC-VFLD-SPL-SNT-I      TO PV-SPL-SNT-POINTER                 
385100        MOVE PV-VFLD-SPL-SNT-DORDER TO PV-SPL-SNT-OORDER                  
385200        IF TR195-DISPLAY-OSPL                                             
385300           MOVE PC-SEL     TO PV-SPL-SNT-SELECTED                         
385400           MOVE TR195-DSPL TO PV-SPL-SNT-OORDER.                          
385500                                                                          
385600     IF TR195-DISPLAY-DSPL                                                
385700        SET DO-SCREEN-DIMENSION TO TRUE                                   
385800        MOVE TR195-DSPL             TO PV-STD-SELECTED                    
385900        MOVE PC-VFLD-STD-I          TO PV-STD-POINTER                     
386000        MOVE PV-VFLD-STD-DORDER     TO PV-STD-OORDER                      
386100        IF TR195-DISPLAY-OSPL                                             
386200           MOVE PC-SEL     TO PV-STD-SELECTED                             
386300           MOVE TR195-DSPL TO PV-STD-OORDER.                              
386400                                                                          
386500     IF TR195-DISPLAY-DADD                                                
386600        SET DO-SCREEN-DIMENSION TO TRUE                                   
386700        MOVE TR195-DADD         TO PV-AED-SELECTED                        
386800        MOVE PC-VFLD-AED-I      TO PV-AED-POINTER                         
386900        MOVE PV-VFLD-AED-DORDER TO PV-AED-OORDER                          
387000        IF TR195-DISPLAY-OADD                                             
387100           MOVE PC-SEL     TO PV-AED-SELECTED                             
387200           MOVE TR195-DADD TO PV-AED-OORDER.                              
387300                                                                          
387400     IF TR195-DISPLAY-DQCT                                                
387500        SET DO-SCREEN-DIMENSION TO TRUE                                   
387600        MOVE TR195-DQCT         TO PV-QCT-SELECTED                        
387700        MOVE PC-VFLD-QCT-I      TO PV-QCT-POINTER                         
387800        MOVE PV-VFLD-QCT-DORDER TO PV-QCT-OORDER                          
387900        IF TR195-DISPLAY-OQCT                                             
388000           MOVE PC-SEL     TO PV-QCT-SELECTED                             
388100           MOVE TR195-DQCT TO PV-QCT-OORDER.                              
388200                                                                          
388300     IF TR195-DISPLAY-DVNS                                                
388400        SET DO-SCREEN-DIMENSION TO TRUE                                   
388500        MOVE TR195-DVNS         TO PV-VNS-SELECTED                        
388600        MOVE PC-VFLD-VNS-I      TO PV-VNS-POINTER                         
388700        MOVE PV-VFLD-VNS-DORDER TO PV-VNS-OORDER                          
388800        IF TR195-DISPLAY-OVNS                                             
388900           MOVE PC-SEL     TO PV-VNS-SELECTED                             
389000           MOVE TR195-DVNS TO PV-VNS-OORDER.                              
389100                                                                          
389200     IF TR195-DISPLAY-DCRL                                                
389300        SET DO-SCREEN-DIMENSION TO TRUE                                   
389400        MOVE TR195-DCRL         TO PV-CRL-SELECTED                        
389500        MOVE PC-VFLD-CRL-I      TO PV-CRL-POINTER                         
389600        MOVE PV-VFLD-CRL-DORDER TO PV-CRL-OORDER                          
389700        IF TR195-DISPLAY-OCRL                                             
389800           MOVE PC-SEL     TO PV-CRL-SELECTED                             
389900           MOVE TR195-DCRL TO PV-CRL-OORDER.                              
390000                                                                          
390100     IF TR195-DISPLAY-DTRA                                                
390200        SET DO-SCREEN-DIMENSION TO TRUE                                   
390300        MOVE TR195-DTRA         TO PV-TRA-SELECTED                        
390400        MOVE PC-VFLD-TRA-I      TO PV-TRA-POINTER                         
390500        MOVE PV-VFLD-TRA-DORDER TO PV-TRA-OORDER                          
390600        IF TR195-DISPLAY-OTRA                                             
390700           MOVE PC-SEL     TO PV-TRA-SELECTED                             
390800           MOVE TR195-DTRA TO PV-TRA-OORDER.                              
390900                                                                          
391000        IF TR195-DISPLAY-DDOL OR TR195-DISPLAY-DUNT                       
391100           MOVE PC-MAX-GROUPS      TO ASC-MAX-GROUPS.                     
391200                                                                          
391300* ------------------------------------------------------------  *         
391400* |  #TIP ==> WHEN DEALING WITH THE CONTROL VARABLE DATA     |  *         
391500* |  STRUCTURE ALWAYS DEAL WITH THE SORTED TABLE ONLY        |  *         
391600* |  AS THIS STRUCTURE IS THE ONE ORGAINIZED IN THE ORDER    |  *         
391700* |  THE FIELDS ARE PLACED ON THE SCREEN. PLUS THIS IS THE   |  *         
391800* |  ONLY DATA STRUCTURE SAVED IN THE COMMON AREA.           |  *         
391900* ------------------------------------------------------------  *         
392000     MOVE +1 TO PV-I.                                                     
392100     PERFORM 9410-SORT-VARIABLE-CNTL-TABLE.                               
392200*#END_OF_VARIABLE_LOGIC------------------------------------------*        
392300                                                                          
392400     IF DO-SCREEN-DIMENSION                                               
392500*#VARIABLE_LOGIC_GROUP_1----------------------------------------*         
392600*  THE FOLLOWING LOGIC IS A KEY PART OF THE PROGRAM. THIS LOGIC *         
392700*  SETS THE VIRTUAL SCREEN FOR EVERY VARIABLE FIELD.            *         
392800*  THE ALGORITHM IS BASICALLY SIMPLE.  THE LOGIC LOOPS THROUGH  *         
392900*  EVERY SELECTED FIELD, CHECKS THE LENGTH AND DETERMINES WHAT  *         
393000*  SCREEN IT CAN FIT ON.  SPACING IS NOT CHANGED IN THIS LOGIC. *         
393100*  IF MORE SOPHISTICATED CONTROL OF SCREENS & SPACING IS NEEDED *         
393200*  THEN THIS AREA OF CODE SHOULD CHANGE.                        *         
393300*---------------------------------------------------------------*         
393400       MOVE +0 TO PV-VSCN-I                                               
393500       PERFORM WITH TEST BEFORE                                           
393600        VARYING PV-I FROM PC-FIRST-FIELD BY 1                             
393700        UNTIL PV-I > PC-MAX-VFLDS-LIMIT                                   
393800          IF PV-SORT-SELECTED(PV-I) = 'Y'                                 
393900              MOVE PV-SORT-POINTER(PV-I) TO PV-INDEX                      
394000              COMPUTE PV-FIELD-LENGTH-SO-FAR =                            
394100                       PV-FIELD-LENGTH-SO-FAR                             
394200                     + PV-LENGTH(PV-INDEX)                                
394300                     + PV-SORT-VFLD-SPACING(PV-I)                         
394400            IF PV-FIELD-LENGTH-SO-FAR > PC-SCREEN-WIDTH                   
394500               COMPUTE PV-FIELD-LENGTH-SO-FAR =                           
394600                               PV-LENGTH(PV-INDEX)                        
394700                             + PV-SORT-VFLD-SPACING(PV-I)                 
394800               ADD  +1 TO PV-VSCN-I                                       
394900               MOVE PV-VSCN-I TO PV-SORT-ONVSCREEN(PV-I)                  
395000            ELSE                                                          
395100               MOVE PV-VSCN-I TO PV-SORT-ONVSCREEN(PV-I)                  
395200               IF PV-FIELD-LENGTH-SO-FAR = PC-SCREEN-WIDTH                
395300                AND PV-I NOT = PC-MAX-VFLDS-LIMIT                         
395400                  ADD +1 TO PV-VSCN-I                                     
395500                  MOVE 0 TO PV-FIELD-LENGTH-SO-FAR                        
395600               END-IF                                                     
395700            END-IF                                                        
395800          END-IF                                                          
395900       END-PERFORM                                                        
396000       MOVE PV-VSCN-I TO ASC-MAX-VARIABLE-SCREENS                         
396100*#END_OF_VARIABLE_LOGIC------------------------------------------*        
396200     END-IF.                                                              
396300                                                                          
396400     MOVE PV-VCTL-SORTED-TABLE TO ASC-VCTL-SORTED-TABLE.                  
396500                                                                          
396600 EJECT                                                                    
396700*----------------------------------------------------------------*        
396800*  SORT ROUTINE IMPLEMENTS THE BASIC BUBBLE SORT                 *        
396900*  IT SIMPLY REORGANIZES THE DISPLAY CRITERIA FIELDS INTO        *        
397000*  A SPECIFIC DISPLAY ORDER                                      *        
397100*----------------------------------------------------------------*        
397200                                                                          
397300 9410-SORT-VARIABLE-CNTL-TABLE.                                           
397400                                                                          
397500*#VARIABLE_LOGIC_GROUP_1----------------------------------------*         
397600*  CURRENTLY A SIMPLE BUBBLE SORT IS USED TO SORT THE UNSORTED  *         
397700*  VARIABLE CONTROL TABLE.  SORTING WILL ENSURE THE PLACEMENT   *         
397800*  OF THE COLUMNS ON THE DISPLAY ARE MAINTAINED.                *         
397900*---------------------------------------------------------------*         
398000     MOVE PV-VARIABLE-CONTROL-FIELDS TO PV-VCTL-TABLE.                    
398100     MOVE PV-VCTL-TABLE TO PV-VCTL-SORTED-TABLE.                          
398200*  TOP LOOP                                                               
398300     PERFORM WITH TEST BEFORE                                             
398400      VARYING PV-COUNTER1 FROM 1 BY 1                                     
398500        UNTIL PV-COUNTER1 > PC-MAX-VFLDS-LIMIT                            
398600*  INNER LOOP                                                             
398700        COMPUTE PV-COUNTER2 = PV-COUNTER1 + 1                             
398800        PERFORM WITH TEST BEFORE                                          
398900         VARYING PV-COUNTER2                                              
399000           FROM PV-COUNTER2 BY 1                                          
399100           UNTIL PV-COUNTER2 > PC-MAX-VFLDS-LIMIT                         
399200            IF (PV-SORT-ORDER (PV-COUNTER2) <                             
399300                                  PV-SORT-ORDER (PV-COUNTER1))            
399400* ------------------------------------------------------------  *         
399500* |  #TIP ==> IF PV-VFLD-CONTROL-SORTED-VALUES INCREASES     |  *         
399600* |  IN SIZE MAKE SURE THE SIZE OF THIS DATA STRUCTURE       |  *         
399700* |  IS MATCHED IN PV-WORK-FIELD.                            |  *         
399800* ------------------------------------------------------------  *         
399900              MOVE PV-VFLD-CONTROL-SORTED-VALUES (PV-COUNTER1)            
400000                TO PV-WORK-FIELD                                          
400100              MOVE PV-VFLD-CONTROL-SORTED-VALUES (PV-COUNTER2)            
400200                TO PV-VFLD-CONTROL-SORTED-VALUES (PV-COUNTER1)            
400300              MOVE PV-WORK-FIELD                                          
400400                TO PV-VFLD-CONTROL-SORTED-VALUES (PV-COUNTER2)            
400500           END-IF                                                         
400600        END-PERFORM                                                       
400700     END-PERFORM.                                                         
400800*#END_OF_VARIABLE_LOGIC------------------------------------------*        
400900 EJECT                                                                    
401000*---------------------------------------------------------------*         
401100*  #VERY_IMPORTANT ==>                                          *         
401200*  WHEN EVER THE PROGRAM DEALS WITH A PV-USORT-XXXX FIELD       *         
401300*  10000-REBUILD-CONTROL-TABLE HAS TO BE CALLED TO REBUILD THE  *         
401400*  DATA STRUCTURE AS ONLY THE SORTED TABLE IS EVER SAVED IN THE *         
401500*  COMMAREA.                                                    *         
401600*---------------------------------------------------------------*         
401700                                                                          
401800 9500-FORMAT-VARIABLE-DATA.                                               
401900*#VARIABLE_LOGIC_GROUP_2----------------------------------------*         
402000*  DO THE INTERMEDIATE STEP BY BUILDING AND REFORMATING THE     *         
402100*  DATA STORAGE FIELDS. THE NEXT PARAGRAPH USES THE RE-         *         
402200*  FORMATTED DATA AND SUBSCRIPTS IT INTO A LONG STRING.         *         
402300*  THE LONG STRING REPRESENTS THE ACTUAL SCREEN FIELD.          *         
402400*---------------------------------------------------------------*         
402500                                                                          
402600*    PERFORM 10000-REBUILD-CONTROL-TABLES.                                
402700                                                                          
402800*---------------------------------------------------------------*         
402900*  #TIP ==>                                                     *         
403000*  IF ADDING A NEW DISPLAY CRITERIA FIELD THEN A CLONE          *         
403100*  OF ONE OF THE FOLLOWING.                                     *         
403200*  NORMALLY THE CONVENTION FOR EACH IF BLOCK SHOULD NEVER       *         
403300*  CHANGE.                                                      *         
403400*---------------------------------------------------------------*         
403500                                                                          
403600     IF DISPLAY-HEADER                                                    
403700                                                                          
403800       MOVE DC-STORE-NAME(1) TO PV-HEADER-DC1-LEVEL-2                     
403900       MOVE DC-STORE-NAME(2) TO PV-HEADER-DC2-LEVEL-2                     
404000       MOVE DC-STORE-NAME(3) TO PV-HEADER-DC3-LEVEL-2                     
404100       MOVE DC-STORE-NAME(4) TO PV-HEADER-DC4-LEVEL-2                     
404200       MOVE DC-STORE-NAME(5) TO PV-HEADER-DC5-LEVEL-2                     
404300       MOVE DC-STORE-NAME(6) TO PV-HEADER-DC6-LEVEL-2                     
404400       MOVE DC-STORE-NAME(7) TO PV-HEADER-DC7-LEVEL-2                     
404500       MOVE DC-STORE-NAME(8) TO PV-HEADER-DC8-LEVEL-2                     
404600       MOVE DC-STORE-NAME(9) TO PV-HEADER-DC9-LEVEL-2                     
404700       MOVE DC-STORE-NAME(10) TO PV-HEADER-DC10-LEVEL-2                   
404800       MOVE DC-STORE-NAME(11) TO PV-HEADER-DC11-LEVEL-2                   
404900       MOVE DC-STORE-NAME(12) TO PV-HEADER-DC12-LEVEL-2                   
405000                                                                          
405100     END-IF.                                                              
405200                                                                          
405300     IF DISPLAY-LIST                                                      
405400                                                                          
405500     IF PV-USORT-SELECTED (PC-VFLD-FOB-I) = 'Y'                           
405600        MOVE EXT-FOB (ASC-BLK-SUB ASC-ITEM-SUB) TO PV-DATA-FOB            
405700     END-IF                                                               
405800                                                                          
405900     IF PV-USORT-SELECTED (PC-VFLD-POE-I) = 'Y'                           
406000        MOVE EXT-POE (ASC-BLK-SUB ASC-ITEM-SUB) TO PV-DATA-POE            
406100     END-IF                                                               
406200                                                                          
406300     IF PV-USORT-SELECTED (PC-VFLD-SXF-I) = 'Y'                           
406400        MOVE EXT-SXF (ASC-BLK-SUB ASC-ITEM-SUB) TO PV-WORK-DT             
406500        IF PV-WORK-DT = SPACES                                            
406600           MOVE '09/09/9999' TO PV-DATA-SXF                               
406700        ELSE                                                              
406800        MOVE PV-WORK-DT (5:2) TO PV-DATA-SXF (1:2)                        
406900        MOVE '/'              TO PV-DATA-SXF (3:1)                        
407000        MOVE PV-WORK-DT (7:2) TO PV-DATA-SXF (4:2)                        
407100        MOVE '/'              TO PV-DATA-SXF (6:1)                        
407200        MOVE PV-WORK-DT (1:4) TO PV-DATA-SXF (7:4)                        
407300        END-IF                                                            
407400     END-IF                                                               
407500                                                                          
407600     IF PV-USORT-SELECTED (PC-VFLD-LXF-I) = 'Y'                           
407700        MOVE EXT-LXF (ASC-BLK-SUB ASC-ITEM-SUB) TO PV-WORK-DT             
407800        IF PV-WORK-DT = SPACES                                            
407900           MOVE '09/09/9999' TO PV-DATA-LXF                               
408000        ELSE                                                              
408100        MOVE PV-WORK-DT (5:2) TO PV-DATA-LXF (1:2)                        
408200        MOVE '/'              TO PV-DATA-LXF (3:1)                        
408300        MOVE PV-WORK-DT (7:2) TO PV-DATA-LXF (4:2)                        
408400        MOVE '/'              TO PV-DATA-LXF (6:1)                        
408500        MOVE PV-WORK-DT (1:4) TO PV-DATA-LXF (7:4)                        
408600        END-IF                                                            
408700     END-IF                                                               
408800                                                                          
408900     IF PV-USORT-SELECTED (PC-VFLD-DSB-I) = 'Y'                           
409000        MOVE EXT-DSB (ASC-BLK-SUB ASC-ITEM-SUB) TO PV-WORK-DT             
409100        IF PV-WORK-DT = SPACES                                            
409200           MOVE '09/09/9999' TO PV-DATA-DSB                               
409300        ELSE                                                              
409400        MOVE PV-WORK-DT (5:2) TO PV-DATA-DSB (1:2)                        
409500        MOVE '/'              TO PV-DATA-DSB (3:1)                        
409600        MOVE PV-WORK-DT (7:2) TO PV-DATA-DSB (4:2)                        
409700        MOVE '/'              TO PV-DATA-DSB (6:1)                        
409800        MOVE PV-WORK-DT (1:4) TO PV-DATA-DSB (7:4)                        
409900        END-IF                                                            
410000     END-IF                                                               
410100                                                                          
410200     IF PV-USORT-SELECTED (PC-VFLD-CNL-I) = 'Y'                           
410300        MOVE EXT-CNL (ASC-BLK-SUB ASC-ITEM-SUB) TO PV-WORK-DT             
410400        IF PV-WORK-DT = SPACES                                            
410500           MOVE '09/09/9999' TO PV-DATA-CNL                               
410600        ELSE                                                              
410700        MOVE PV-WORK-DT (5:2) TO PV-DATA-CNL (1:2)                        
410800        MOVE '/'              TO PV-DATA-CNL (3:1)                        
410900        MOVE PV-WORK-DT (7:2) TO PV-DATA-CNL (4:2)                        
411000        MOVE '/'              TO PV-DATA-CNL (6:1)                        
411100        MOVE PV-WORK-DT (1:4) TO PV-DATA-CNL (7:4)                        
411200        END-IF                                                            
411300     END-IF                                                               
411400                                                                          
411500     IF PV-USORT-SELECTED (PC-VFLD-FRD-I) = 'Y'                           
411600        MOVE EXT-FRD (ASC-BLK-SUB ASC-ITEM-SUB) TO PV-WORK-DT             
411700        IF PV-WORK-DT = SPACES                                            
411800           MOVE '09/09/9999' TO PV-DATA-FRD                               
411900        ELSE                                                              
412000        MOVE PV-WORK-DT (5:2) TO PV-DATA-FRD (1:2)                        
412100        MOVE '/'              TO PV-DATA-FRD (3:1)                        
412200        MOVE PV-WORK-DT (7:2) TO PV-DATA-FRD (4:2)                        
412300        MOVE '/'              TO PV-DATA-FRD (6:1)                        
412400        MOVE PV-WORK-DT (1:4) TO PV-DATA-FRD (7:4)                        
412500        END-IF                                                            
412600     END-IF                                                               
412700                                                                          
412800     IF PV-USORT-SELECTED (PC-VFLD-SLD-I) = 'Y'                           
412900        MOVE EXT-SLD (ASC-BLK-SUB ASC-ITEM-SUB) TO PV-WORK-DT             
413000        IF PV-WORK-DT = SPACES                                            
413100           MOVE '09/09/9999' TO PV-DATA-SLD                               
413200        ELSE                                                              
413300        MOVE PV-WORK-DT (5:2) TO PV-DATA-SLD (1:2)                        
413400        MOVE '/'              TO PV-DATA-SLD (3:1)                        
413500        MOVE PV-WORK-DT (7:2) TO PV-DATA-SLD (4:2)                        
413600        MOVE '/'              TO PV-DATA-SLD (6:1)                        
413700        MOVE PV-WORK-DT (1:4) TO PV-DATA-SLD (7:4)                        
413800        END-IF                                                            
413900     END-IF                                                               
414000                                                                          
414100     IF PV-USORT-SELECTED (PC-VFLD-PRD-I) = 'Y'                           
414200        MOVE EXT-CNT (ASC-BLK-SUB ASC-ITEM-SUB) TO PV-DATA-CNT            
414300        MOVE EXT-PRD (ASC-BLK-SUB ASC-ITEM-SUB) TO PV-WORK-DT             
414400        MOVE EXT-PRD-ETA-ATA (ASC-BLK-SUB ASC-ITEM-SUB) TO                
414500                  PV-WORK-ETA-ATA                                         
414600        IF PV-WORK-DT = SPACES                                            
414700           MOVE '09/09/9999' TO PV-DATA-PRD                               
414800        ELSE                                                              
414900        MOVE PV-WORK-DT (5:2) TO PV-DATA-PRD (1:2)                        
415000        MOVE '/'              TO PV-DATA-PRD (3:1)                        
415100        MOVE PV-WORK-DT (7:2) TO PV-DATA-PRD (4:2)                        
415200        MOVE '/'              TO PV-DATA-PRD (6:1)                        
415300        MOVE PV-WORK-DT (1:4) TO PV-DATA-PRD (7:4)                        
415400***     MOVE PV-WORK-ETA-ATA  TO PV-DATA-PRD (11:2)                       
415500        END-IF                                                            
415600     END-IF                                                               
415700                                                                          
415800     IF PV-USORT-SELECTED (PC-VFLD-CSR-I) = 'Y'                           
415900        MOVE EXT-CSR (ASC-BLK-SUB ASC-ITEM-SUB) TO PV-WORK-DT             
416000        IF PV-WORK-DT = SPACES                                            
416100           MOVE '09/09/9999' TO PV-DATA-CSR                               
416200        ELSE                                                              
416300        MOVE PV-WORK-DT (5:2) TO PV-DATA-CSR (1:2)                        
416400        MOVE '/'              TO PV-DATA-CSR (3:1)                        
416500        MOVE PV-WORK-DT (7:2) TO PV-DATA-CSR (4:2)                        
416600        MOVE '/'              TO PV-DATA-CSR (6:1)                        
416700        MOVE PV-WORK-DT (1:4) TO PV-DATA-CSR (7:4)                        
416800        END-IF                                                            
416900     END-IF                                                               
417000                                                                          
417100     IF PV-USORT-SELECTED (PC-VFLD-DC1-I) = 'Y'                           
417200        MOVE EXT-DC1 (ASC-BLK-SUB ASC-ITEM-SUB) TO PV-WORK-DT             
417300        MOVE EXT-DC1-ETA-ATA (ASC-BLK-SUB ASC-ITEM-SUB) TO                
417400                  PV-WORK-ETA-ATA-DC1                                     
417500        IF PV-WORK-DT = SPACES                                            
417600           MOVE '09/09/9999' TO PV-DATA-DC1                               
417700        ELSE                                                              
417800        MOVE PV-WORK-DT (5:2)    TO PV-DATA-DC1 (1:2)                     
417900        MOVE '/'                 TO PV-DATA-DC1 (3:1)                     
418000        MOVE PV-WORK-DT (7:2)    TO PV-DATA-DC1 (4:2)                     
418100        MOVE '/'                 TO PV-DATA-DC1 (6:1)                     
418200        MOVE PV-WORK-DT (1:4)    TO PV-DATA-DC1 (7:4)                     
418300***     MOVE PV-WORK-ETA-ATA-DC1 TO PV-DATA-DC1 (11:2)                    
418400        END-IF                                                            
418500     END-IF                                                               
418600                                                                          
418700     IF PV-USORT-SELECTED (PC-VFLD-DC2-I) = 'Y'                           
418800        MOVE EXT-DC2 (ASC-BLK-SUB ASC-ITEM-SUB) TO PV-WORK-DT             
418900        MOVE EXT-DC2-ETA-ATA (ASC-BLK-SUB ASC-ITEM-SUB) TO                
419000                  PV-WORK-ETA-ATA-DC2                                     
419100        IF PV-WORK-DT = SPACES                                            
419200           MOVE '09/09/9999' TO PV-DATA-DC2                               
419300        ELSE                                                              
419400        MOVE PV-WORK-DT (5:2)     TO PV-DATA-DC2 (1:2)                    
419500        MOVE '/'                  TO PV-DATA-DC2 (3:1)                    
419600        MOVE PV-WORK-DT (7:2)     TO PV-DATA-DC2 (4:2)                    
419700        MOVE '/'                  TO PV-DATA-DC2 (6:1)                    
419800        MOVE PV-WORK-DT (1:4)     TO PV-DATA-DC2 (7:4)                    
419900***     MOVE PV-WORK-ETA-ATA-DC2  TO PV-DATA-DC2 (11:2)                   
420000        END-IF                                                            
420100     END-IF                                                               
420200                                                                          
420300     IF PV-USORT-SELECTED (PC-VFLD-DC3-I) = 'Y'                           
420400        MOVE EXT-DC3 (ASC-BLK-SUB ASC-ITEM-SUB) TO PV-WORK-DT             
420500        MOVE EXT-DC3-ETA-ATA (ASC-BLK-SUB ASC-ITEM-SUB) TO                
420600                  PV-WORK-ETA-ATA-DC3                                     
420700        IF PV-WORK-DT = SPACES                                            
420800           MOVE '09/09/9999' TO PV-DATA-DC3                               
420900        ELSE                                                              
421000        MOVE PV-WORK-DT (5:2)     TO PV-DATA-DC3 (1:2)                    
421100        MOVE '/'                  TO PV-DATA-DC3 (3:1)                    
421200        MOVE PV-WORK-DT (7:2)     TO PV-DATA-DC3 (4:2)                    
421300        MOVE '/'                  TO PV-DATA-DC3 (6:1)                    
421400        MOVE PV-WORK-DT (1:4)     TO PV-DATA-DC3 (7:4)                    
421500***     MOVE PV-WORK-ETA-ATA-DC3  TO PV-DATA-DC3 (11:2)                   
421600        END-IF                                                            
421700     END-IF                                                               
421800                                                                          
421900     IF PV-USORT-SELECTED (PC-VFLD-DC4-I) = 'Y'                           
422000        MOVE EXT-DC4 (ASC-BLK-SUB ASC-ITEM-SUB) TO PV-WORK-DT             
422100        MOVE EXT-DC4-ETA-ATA (ASC-BLK-SUB ASC-ITEM-SUB) TO                
422200                  PV-WORK-ETA-ATA-DC4                                     
422300        IF PV-WORK-DT = SPACES                                            
422400           MOVE '09/09/9999' TO PV-DATA-DC4                               
422500        ELSE                                                              
422600        MOVE PV-WORK-DT (5:2)     TO PV-DATA-DC4 (1:2)                    
422700        MOVE '/'                  TO PV-DATA-DC4 (3:1)                    
422800        MOVE PV-WORK-DT (7:2)     TO PV-DATA-DC4 (4:2)                    
422900        MOVE '/'                  TO PV-DATA-DC4 (6:1)                    
423000        MOVE PV-WORK-DT (1:4)     TO PV-DATA-DC4 (7:4)                    
423100***     MOVE PV-WORK-ETA-ATA-DC4  TO PV-DATA-DC4 (11:2)                   
423200        END-IF                                                            
423300     END-IF                                                               
423400                                                                          
423500     IF PV-USORT-SELECTED (PC-VFLD-DC5-I) = 'Y'                           
423600        MOVE EXT-DC5 (ASC-BLK-SUB ASC-ITEM-SUB) TO PV-WORK-DT             
423700        MOVE EXT-DC5-ETA-ATA (ASC-BLK-SUB ASC-ITEM-SUB) TO                
423800                  PV-WORK-ETA-ATA-DC5                                     
423900        IF PV-WORK-DT = SPACES                                            
424000           MOVE '09/09/9999' TO PV-DATA-DC5                               
424100        ELSE                                                              
424200        MOVE PV-WORK-DT (5:2)     TO PV-DATA-DC5 (1:2)                    
424300        MOVE '/'                  TO PV-DATA-DC5 (3:1)                    
424400        MOVE PV-WORK-DT (7:2)     TO PV-DATA-DC5 (4:2)                    
424500        MOVE '/'                  TO PV-DATA-DC5 (6:1)                    
424600        MOVE PV-WORK-DT (1:4)     TO PV-DATA-DC5 (7:4)                    
424700***     MOVE PV-WORK-ETA-ATA-DC5  TO PV-DATA-DC5 (11:2)                   
424800        END-IF                                                            
424900     END-IF                                                               
425000                                                                          
425100     IF PV-USORT-SELECTED (PC-VFLD-DC6-I) = 'Y'                           
425200        MOVE EXT-DC6 (ASC-BLK-SUB ASC-ITEM-SUB) TO PV-WORK-DT             
425300        MOVE EXT-DC6-ETA-ATA (ASC-BLK-SUB ASC-ITEM-SUB) TO                
425400                  PV-WORK-ETA-ATA-DC6                                     
425500        IF PV-WORK-DT = SPACES                                            
425600           MOVE '09/09/9999' TO PV-DATA-DC6                               
425700        ELSE                                                              
425800        MOVE PV-WORK-DT (5:2)     TO PV-DATA-DC6 (1:2)                    
425900        MOVE '/'                  TO PV-DATA-DC6 (3:1)                    
426000        MOVE PV-WORK-DT (7:2)     TO PV-DATA-DC6 (4:2)                    
426100        MOVE '/'                  TO PV-DATA-DC6 (6:1)                    
426200        MOVE PV-WORK-DT (1:4)     TO PV-DATA-DC6 (7:4)                    
426300***     MOVE PV-WORK-ETA-ATA-DC6  TO PV-DATA-DC6 (11:2)                   
426400        END-IF                                                            
426500     END-IF                                                               
426600                                                                          
426700     IF PV-USORT-SELECTED (PC-VFLD-DC7-I) = 'Y'                           
426800        MOVE EXT-DC7 (ASC-BLK-SUB ASC-ITEM-SUB) TO PV-WORK-DT             
426900        MOVE EXT-DC7-ETA-ATA (ASC-BLK-SUB ASC-ITEM-SUB) TO                
427000                  PV-WORK-ETA-ATA-DC7                                     
427100        IF PV-WORK-DT = SPACES                                            
427200           MOVE '09/09/9999' TO PV-DATA-DC7                               
427300        ELSE                                                              
427400        MOVE PV-WORK-DT (5:2)     TO PV-DATA-DC7 (1:2)                    
427500        MOVE '/'                  TO PV-DATA-DC7 (3:1)                    
427600        MOVE PV-WORK-DT (7:2)     TO PV-DATA-DC7 (4:2)                    
427700        MOVE '/'                  TO PV-DATA-DC7 (6:1)                    
427800        MOVE PV-WORK-DT (1:4)     TO PV-DATA-DC7 (7:4)                    
427900***     MOVE PV-WORK-ETA-ATA-DC7  TO PV-DATA-DC7 (11:2)                   
428000        END-IF                                                            
428100     END-IF                                                               
428200                                                                          
428300     IF PV-USORT-SELECTED (PC-VFLD-DC8-I) = 'Y'                           
428400        MOVE EXT-DC8 (ASC-BLK-SUB ASC-ITEM-SUB) TO PV-WORK-DT             
428500        MOVE EXT-DC8-ETA-ATA (ASC-BLK-SUB ASC-ITEM-SUB) TO                
428600                  PV-WORK-ETA-ATA-DC8                                     
428700        IF PV-WORK-DT = SPACES                                            
428800           MOVE '09/09/9999' TO PV-DATA-DC8                               
428900        ELSE                                                              
429000        MOVE PV-WORK-DT (5:2)     TO PV-DATA-DC8 (1:2)                    
429100        MOVE '/'                  TO PV-DATA-DC8 (3:1)                    
429200        MOVE PV-WORK-DT (7:2)     TO PV-DATA-DC8 (4:2)                    
429300        MOVE '/'                  TO PV-DATA-DC8 (6:1)                    
429400        MOVE PV-WORK-DT (1:4)     TO PV-DATA-DC8 (7:4)                    
429500***     MOVE PV-WORK-ETA-ATA-DC8  TO PV-DATA-DC8 (11:2)                   
429600        END-IF                                                            
429700     END-IF                                                               
429800                                                                          
429900     IF PV-USORT-SELECTED (PC-VFLD-DC9-I) = 'Y'                           
430000        MOVE EXT-DC9 (ASC-BLK-SUB ASC-ITEM-SUB) TO PV-WORK-DT             
430100        MOVE EXT-DC9-ETA-ATA (ASC-BLK-SUB ASC-ITEM-SUB) TO                
430200                  PV-WORK-ETA-ATA-DC9                                     
430300        IF PV-WORK-DT = SPACES                                            
430400           MOVE '09/09/9999' TO PV-DATA-DC9                               
430500        ELSE                                                              
430600        MOVE PV-WORK-DT (5:2)     TO PV-DATA-DC9 (1:2)                    
430700        MOVE '/'                  TO PV-DATA-DC9 (3:1)                    
430800        MOVE PV-WORK-DT (7:2)     TO PV-DATA-DC9 (4:2)                    
430900        MOVE '/'                  TO PV-DATA-DC9 (6:1)                    
431000        MOVE PV-WORK-DT (1:4)     TO PV-DATA-DC9 (7:4)                    
431100***     MOVE PV-WORK-ETA-ATA-DC9  TO PV-DATA-DC9 (11:2)                   
431200        END-IF                                                            
431300     END-IF                                                               
431400                                                                          
431500     IF PV-USORT-SELECTED (PC-VFLD-DC10-I) = 'Y'                          
431600        MOVE EXT-DC10 (ASC-BLK-SUB ASC-ITEM-SUB) TO PV-WORK-DT            
431700        MOVE EXT-DC10-ETA-ATA (ASC-BLK-SUB ASC-ITEM-SUB) TO               
431800                  PV-WORK-ETA-ATA-DC10                                    
431900        IF PV-WORK-DT = SPACES                                            
432000           MOVE '09/09/9999' TO PV-DATA-DC10                              
432100        ELSE                                                              
432200        MOVE PV-WORK-DT (5:2)     TO PV-DATA-DC10 (1:2)                   
432300        MOVE '/'                  TO PV-DATA-DC10 (3:1)                   
432400        MOVE PV-WORK-DT (7:2)     TO PV-DATA-DC10 (4:2)                   
432500        MOVE '/'                  TO PV-DATA-DC10 (6:1)                   
432600        MOVE PV-WORK-DT (1:4)     TO PV-DATA-DC10 (7:4)                   
432700***     MOVE PV-WORK-ETA-ATA-DC10 TO PV-DATA-DC10 (11:2)                  
432800        END-IF                                                            
432900     END-IF                                                               
433000                                                                          
433100     IF PV-USORT-SELECTED (PC-VFLD-DC11-I) = 'Y'                          
433200        MOVE EXT-DC11 (ASC-BLK-SUB ASC-ITEM-SUB) TO PV-WORK-DT            
433300        MOVE EXT-DC11-ETA-ATA (ASC-BLK-SUB ASC-ITEM-SUB) TO               
433400                  PV-WORK-ETA-ATA-DC11                                    
433500        IF PV-WORK-DT = SPACES                                            
433600           MOVE '09/09/9999' TO PV-DATA-DC11                              
433700        ELSE                                                              
433800        MOVE PV-WORK-DT (5:2)     TO PV-DATA-DC11 (1:2)                   
433900        MOVE '/'                  TO PV-DATA-DC11 (3:1)                   
434000        MOVE PV-WORK-DT (7:2)     TO PV-DATA-DC11 (4:2)                   
434100        MOVE '/'                  TO PV-DATA-DC11 (6:1)                   
434200        MOVE PV-WORK-DT (1:4)     TO PV-DATA-DC11 (7:4)                   
434300***     MOVE PV-WORK-ETA-ATA-DC11 TO PV-DATA-DC11 (11:2)                  
434400        END-IF                                                            
434500     END-IF                                                               
434600                                                                          
434700     IF PV-USORT-SELECTED (PC-VFLD-DC12-I) = 'Y'                          
434800        MOVE EXT-DC12 (ASC-BLK-SUB ASC-ITEM-SUB) TO PV-WORK-DT            
434900        MOVE EXT-DC12-ETA-ATA (ASC-BLK-SUB ASC-ITEM-SUB) TO               
435000                  PV-WORK-ETA-ATA-DC12                                    
435100        IF PV-WORK-DT = SPACES                                            
435200           MOVE '09/09/9999' TO PV-DATA-DC12                              
435300        ELSE                                                              
435400        MOVE PV-WORK-DT (5:2)     TO PV-DATA-DC12 (1:2)                   
435500        MOVE '/'                  TO PV-DATA-DC12 (3:1)                   
435600        MOVE PV-WORK-DT (7:2)     TO PV-DATA-DC12 (4:2)                   
435700        MOVE '/'                  TO PV-DATA-DC12 (6:1)                   
435800        MOVE PV-WORK-DT (1:4)     TO PV-DATA-DC12 (7:4)                   
435900***     MOVE PV-WORK-ETA-ATA-DC12 TO PV-DATA-DC12 (11:2)                  
436000        END-IF                                                            
436100     END-IF                                                               
436200                                                                          
436300     IF PV-USORT-SELECTED (PC-VFLD-DVN-I) = 'Y'                           
436400        MOVE EXT-DVN (ASC-BLK-SUB ASC-ITEM-SUB) TO PV-WORK-DT             
436500        IF PV-WORK-DT = SPACES                                            
436600           MOVE '09/09/9999' TO PV-DATA-DVN                               
436700        ELSE                                                              
436800        MOVE PV-WORK-DT (5:2) TO PV-DATA-DVN (1:2)                        
436900        MOVE '/'              TO PV-DATA-DVN (3:1)                        
437000        MOVE PV-WORK-DT (7:2) TO PV-DATA-DVN (4:2)                        
437100        MOVE '/'              TO PV-DATA-DVN (6:1)                        
437200        MOVE PV-WORK-DT (1:4) TO PV-DATA-DVN (7:4)                        
437300        END-IF                                                            
437400     END-IF                                                               
437500                                                                          
437600     IF PV-USORT-SELECTED (PC-VFLD-BKD-I) = 'Y'                           
437700        MOVE EXT-BKD (ASC-BLK-SUB ASC-ITEM-SUB) TO PV-WORK-DT             
437800        IF PV-WORK-DT = SPACES                                            
437900           MOVE '09/09/9999' TO PV-DATA-BKD                               
438000        ELSE                                                              
438100        MOVE PV-WORK-DT (5:2) TO PV-DATA-BKD (1:2)                        
438200        MOVE '/'              TO PV-DATA-BKD (3:1)                        
438300        MOVE PV-WORK-DT (7:2) TO PV-DATA-BKD (4:2)                        
438400        MOVE '/'              TO PV-DATA-BKD (6:1)                        
438500        MOVE PV-WORK-DT (1:4) TO PV-DATA-BKD (7:4)                        
438600        END-IF                                                            
438700     END-IF                                                               
438800                                                                          
438900     IF PV-USORT-SELECTED (PC-VFLD-FSC-I) = 'Y'                           
439000        MOVE EXT-FSC (ASC-BLK-SUB ASC-ITEM-SUB) TO PV-DATA-FSC            
439100     END-IF                                                               
439200                                                                          
439300     IF PV-USORT-SELECTED (PC-VFLD-TTC-I) = 'Y'                           
439400        MOVE EXT-TTC (ASC-BLK-SUB ASC-ITEM-SUB) TO PV-DATA-TTC            
439500     END-IF                                                               
439600                                                                          
439700     IF PV-USORT-SELECTED (PC-VFLD-TVC-I) = 'Y'                           
439800        MOVE EXT-TVC (ASC-BLK-SUB ASC-ITEM-SUB) TO PV-DATA-TVC            
439900     END-IF                                                               
440000                                                                          
440100     IF PV-USORT-SELECTED (PC-VFLD-UOR-I) = 'Y'                           
440200        MOVE EXT-UOR (ASC-BLK-SUB ASC-ITEM-SUB) TO PV-DATA-UOR            
440300     END-IF                                                               
440400                                                                          
440500     IF PV-USORT-SELECTED (PC-VFLD-URC-I) = 'Y'                           
440600        MOVE EXT-URC (ASC-BLK-SUB ASC-ITEM-SUB) TO PV-DATA-URC            
440700     END-IF                                                               
440800                                                                          
440900     IF PV-USORT-SELECTED (PC-VFLD-URP-I) = 'Y'                           
441000        IF EXT-UOR (ASC-BLK-SUB ASC-ITEM-SUB) > 0                         
441100          COMPUTE PV-WORK-PCT =                                           
441200            (EXT-URC (ASC-BLK-SUB ASC-ITEM-SUB) /                         
441300                  EXT-UOR (ASC-BLK-SUB ASC-ITEM-SUB)) * 100               
441400        ELSE                                                              
441500            MOVE 0  TO PV-WORK-PCT                                        
441600        END-IF                                                            
441700        MOVE PV-WORK-PCT TO PV-DATA-URP                                   
441800     END-IF                                                               
441900                                                                          
442000     IF PV-USORT-SELECTED (PC-VFLD-DOR-I) = 'Y'                           
442100        MOVE EXT-DOR (ASC-BLK-SUB ASC-ITEM-SUB) TO PV-DATA-DOR            
442200     END-IF                                                               
442300                                                                          
442400     IF PV-USORT-SELECTED (PC-VFLD-DRC-I) = 'Y'                           
442500        MOVE EXT-DRC (ASC-BLK-SUB ASC-ITEM-SUB) TO PV-DATA-DRC            
442600     END-IF                                                               
442700                                                                          
442800     IF PV-USORT-SELECTED (PC-VFLD-DRP-I) = 'Y'                           
442900        IF EXT-DOR (ASC-BLK-SUB ASC-ITEM-SUB) > 0                         
443000          COMPUTE PV-WORK-PCT =                                           
443100            (EXT-DRC (ASC-BLK-SUB ASC-ITEM-SUB) /                         
443200                  EXT-DOR (ASC-BLK-SUB ASC-ITEM-SUB)) * 100               
443300        ELSE                                                              
443400            MOVE 0  TO PV-WORK-PCT                                        
443500        END-IF                                                            
443600        MOVE PV-WORK-PCT TO PV-DATA-DRP                                   
443700     END-IF                                                               
443800                                                                          
443900     IF PV-USORT-SELECTED (PC-VFLD-OTB-I) = 'Y'                           
444000        MOVE EXT-OTB (ASC-BLK-SUB ASC-ITEM-SUB) TO PV-WORK-OTB            
444100        IF PV-WORK-OTB = SPACES                                           
444200           MOVE SPACES TO PV-DATA-OTB                                     
444300        ELSE                                                              
444400        MOVE PV-WORK-OTB (3:2) TO PV-DATA-OTB (1:2)                       
444500        MOVE PV-WORK-OTB (5:2) TO PV-DATA-OTB (3:2)                       
444600        END-IF                                                            
444700     END-IF                                                               
444800                                                                          
444900     IF PV-USORT-SELECTED (PC-VFLD-EDI-I) = 'Y'                           
445000        MOVE EXT-EDI (ASC-BLK-SUB ASC-ITEM-SUB) TO PV-DATA-EDI            
445100     END-IF                                                               
445200                                                                          
445300     IF PV-USORT-SELECTED (PC-VFLD-PPK-I) = 'Y'                           
445400        MOVE EXT-PPK (ASC-BLK-SUB ASC-ITEM-SUB) TO PV-DATA-PPK            
445500     END-IF                                                               
445600                                                                          
445700     IF PV-USORT-SELECTED (PC-VFLD-STA-I) = 'Y'                           
445800        MOVE EXT-STA (ASC-BLK-SUB ASC-ITEM-SUB) TO PV-DATA-STA            
445900     END-IF                                                               
446000                                                                          
446100     IF PV-USORT-SELECTED (PC-VFLD-QCT-I) = 'Y'                           
446200        MOVE EXT-QCT (ASC-BLK-SUB ASC-ITEM-SUB) TO PV-DATA-QCT            
446300     END-IF                                                               
446400                                                                          
446500     IF PV-USORT-SELECTED (PC-VFLD-VNS-I) = 'Y'                           
446600        MOVE EXT-VNS (ASC-BLK-SUB ASC-ITEM-SUB) TO PV-DATA-VNS            
446700     END-IF                                                               
446800                                                                          
446900     IF PV-USORT-SELECTED (PC-VFLD-TRP-I) = 'Y'                           
447000        MOVE EXT-TRP (ASC-BLK-SUB ASC-ITEM-SUB) TO PV-DATA-TRP            
447100     END-IF                                                               
447200                                                                          
447300                                                                          
447400     IF PV-USORT-SELECTED (PC-VFLD-SPL-CRT-I) = 'Y'                       
447500        MOVE EXT-SPL-CRT (ASC-BLK-SUB ASC-ITEM-SUB) TO PV-WORK-DT         
447600        IF PV-WORK-DT = SPACES                                            
447700           MOVE '09/09/9999' TO PV-DATA-SPL-CRT                           
447800        ELSE                                                              
447900        MOVE PV-WORK-DT (5:2) TO PV-DATA-SPL-CRT (1:2)                    
448000        MOVE '/'              TO PV-DATA-SPL-CRT (3:1)                    
448100        MOVE PV-WORK-DT (7:2) TO PV-DATA-SPL-CRT (4:2)                    
448200        MOVE '/'              TO PV-DATA-SPL-CRT (6:1)                    
448300        MOVE PV-WORK-DT (1:4) TO PV-DATA-SPL-CRT (7:4)                    
448400        END-IF                                                            
448500     END-IF                                                               
448600                                                                          
448700     IF PV-USORT-SELECTED (PC-VFLD-SPL-SNT-I) = 'Y'                       
448800        MOVE EXT-STD (ASC-BLK-SUB ASC-ITEM-SUB) TO PV-DATA-STD            
448900        MOVE EXT-SPL-SNT (ASC-BLK-SUB ASC-ITEM-SUB) TO PV-WORK-DT         
449000        IF PV-WORK-DT = SPACES                                            
449100           MOVE '09/09/9999' TO PV-DATA-SPL-SNT                           
449200        ELSE                                                              
449300        MOVE PV-WORK-DT (5:2) TO PV-DATA-SPL-SNT (1:2)                    
449400        MOVE '/'              TO PV-DATA-SPL-SNT (3:1)                    
449500        MOVE PV-WORK-DT (7:2) TO PV-DATA-SPL-SNT (4:2)                    
449600        MOVE '/'              TO PV-DATA-SPL-SNT (6:1)                    
449700        MOVE PV-WORK-DT (1:4) TO PV-DATA-SPL-SNT (7:4)                    
449800        END-IF                                                            
449900     END-IF                                                               
450000                                                                          
450100     IF PV-USORT-SELECTED (PC-VFLD-AED-I) = 'Y'                           
450200        MOVE EXT-AED (ASC-BLK-SUB ASC-ITEM-SUB) TO PV-WORK-DT             
450300        IF PV-WORK-DT = SPACES                                            
450400           MOVE '09/09/9999' TO PV-DATA-AED                               
450500        ELSE                                                              
450600        MOVE PV-WORK-DT (5:2) TO PV-DATA-AED (1:2)                        
450700        MOVE '/'              TO PV-DATA-AED (3:1)                        
450800        MOVE PV-WORK-DT (7:2) TO PV-DATA-AED (4:2)                        
450900        MOVE '/'              TO PV-DATA-AED (6:1)                        
451000        MOVE PV-WORK-DT (1:4) TO PV-DATA-AED (7:4)                        
451100        END-IF                                                            
451200     END-IF                                                               
451300                                                                          
451400     IF PV-USORT-SELECTED (PC-VFLD-CRL-I) = 'Y'                           
451500        MOVE EXT-CRL (ASC-BLK-SUB ASC-ITEM-SUB) TO PV-WORK-DT             
451600        IF PV-WORK-DT = SPACES                                            
451700           MOVE SPACES TO PV-DATA-CRL                                     
451800        ELSE                                                              
451900        MOVE PV-WORK-DT (5:2) TO PV-DATA-CRL (1:2)                        
452000        MOVE '/'              TO PV-DATA-CRL (3:1)                        
452100        MOVE PV-WORK-DT (7:2) TO PV-DATA-CRL (4:2)                        
452200        END-IF                                                            
452300     END-IF                                                               
452400                                                                          
452500     IF PV-USORT-SELECTED (PC-VFLD-TRA-I) = 'Y'                           
452600        MOVE EXT-TRA (ASC-BLK-SUB ASC-ITEM-SUB) TO PV-WORK-DT             
452700        IF PV-WORK-DT = SPACES                                            
452800           MOVE SPACES TO PV-DATA-TRA                                     
452900        ELSE                                                              
453000        MOVE PV-WORK-DT (5:2) TO PV-DATA-TRA (1:2)                        
453100        MOVE '/'              TO PV-DATA-TRA (3:1)                        
453200        MOVE PV-WORK-DT (7:2) TO PV-DATA-TRA (4:2)                        
453300        END-IF                                                            
453400     END-IF                                                               
453500                                                                          
453600     END-IF.                                                              
453700                                                                          
453800     IF DISPLAY-TOTAL                                                     
453900                                                                          
454000     IF PV-USORT-SELECTED (PC-VFLD-FSC-I) = 'Y'                           
454100        MOVE ASC-TFSC TO PV-TOTAL-FSC                                     
454200     END-IF                                                               
454300                                                                          
454400     IF PV-USORT-SELECTED (PC-VFLD-TTC-I) = 'Y'                           
454500        MOVE ASC-TTTC TO PV-TOTAL-TTC                                     
454600     END-IF                                                               
454700                                                                          
454800     IF PV-USORT-SELECTED (PC-VFLD-TVC-I) = 'Y'                           
454900        MOVE ASC-TTTC TO PV-TOTAL-TVC                                     
455000     END-IF                                                               
455100                                                                          
455200     IF PV-USORT-SELECTED (PC-VFLD-UOR-I) = 'Y'                           
455300        MOVE ASC-TUOR TO PV-TOTAL-UOR                                     
455400     END-IF                                                               
455500                                                                          
455600     IF PV-USORT-SELECTED (PC-VFLD-URC-I) = 'Y'                           
455700        MOVE ASC-TURC TO PV-TOTAL-URC                                     
455800     END-IF                                                               
455900                                                                          
456000     IF PV-USORT-SELECTED (PC-VFLD-URP-I) = 'Y'                           
456100        IF ASC-TUOR > 0                                                   
456200          COMPUTE PV-WORK-PCT =                                           
456300            (ASC-TURC / ASC-TUOR) * 100                                   
456400        ELSE                                                              
456500            MOVE 0  TO PV-WORK-PCT                                        
456600        END-IF                                                            
456700        MOVE PV-WORK-PCT TO PV-TOTAL-URP                                  
456800     END-IF                                                               
456900                                                                          
457000     IF PV-USORT-SELECTED (PC-VFLD-DOR-I) = 'Y'                           
457100        MOVE ASC-TDOR TO PV-TOTAL-DOR                                     
457200     END-IF                                                               
457300                                                                          
457400     IF PV-USORT-SELECTED (PC-VFLD-DRC-I) = 'Y'                           
457500        MOVE ASC-TDRC TO PV-TOTAL-DRC                                     
457600     END-IF                                                               
457700                                                                          
457800     IF PV-USORT-SELECTED (PC-VFLD-DRP-I) = 'Y'                           
457900        IF ASC-TDOR > 0                                                   
458000          COMPUTE PV-WORK-PCT =                                           
458100            (ASC-TDRC  / ASC-TDOR) * 100                                  
458200        ELSE                                                              
458300            MOVE 0  TO PV-WORK-PCT                                        
458400        END-IF                                                            
458500        MOVE PV-WORK-PCT  TO PV-TOTAL-DRP                                 
458600     END-IF                                                               
458700                                                                          
458800                                                                          
458900     END-IF.                                                              
459000                                                                          
459100     PERFORM 9510-PREPARE-VFLD-FOR-DISPLAY.                               
459200                                                                          
459300*#END_OF_VARIABLE_LOGIC------------------------------------------*        
459400                                                                          
459500 EJECT                                                                    
459600*----------------------------------------------------------------*        
459700* THIS ROUTINE PASSES THROUGH THE SCREEN FIELDS AND              *        
459800* CALLS EITHER 9520-BUILD-LIST-SCREEN-AREA OR                    *        
459900* 9530-REFORMAT-VFLD-HEADER-PART OR 9540-BUILD-TOTAL-SCREEN-AREA *        
460000*----------------------------------------------------------------*        
460100                                                                          
460200 9510-PREPARE-VFLD-FOR-DISPLAY.                                           
460300                                                                          
460400*#VARIABLE_LOGIC_GROUP_2----------------------------------------*         
460500*  THIS IS THE FINAL PARAGRAPH WHERE THE CICS MAP FIELDS ARE    *         
460600*  ACTUALLY BUILT.  IT TAKES A VARIABLE FORMATTED DATA          *         
460700*  FIELD AND THEN BASED ON THE FIELD SIZE SUBSCRIPT THE FIELD   *         
460800*  ONTO A STRING. THIS PARAGRAPH HAS TO LOOP THROUGH THE SORTED *         
460900*  CONTROL TABLE, DETERMINE IF A FIELD IS ON THE CURRENT        *         
461000*  REQUESTED PAGE, SET THE X POSITION OF THE FIELD AND THEN     *         
461100*  EITHER THE LIST OR HEADER OR TOTAL PARAGRAPHS TO PERFORM THE *         
461200*  ACTUAL MOVE OF DATA ONTO THE MR FIELD.                       *         
461300*---------------------------------------------------------------*         
461400     MOVE 0 TO PV-LAST-VFLD-LENGTH.                                       
461500     IF DISPLAY-HEADER                                                    
461600       MOVE SPACES TO PV-WORK-HDR1                                        
461700       MOVE SPACES TO PV-WORK-HDR2                                        
461800       MOVE SPACES TO PV-VHDR1                                            
461900       MOVE SPACES TO PV-VHDR2                                            
462000*    ELSE                                                                 
462100*      IF DISPLAY-TOTAL                                                   
462200*        MOVE SPACES TO MR-TTXT                                           
462300*        MOVE SPACES TO MR-TFLD                                           
462400*      ELSE                                                               
462500*        MOVE SPACES TO MR-VFLD (PV-SUB)                                  
462600*      END-IF                                                             
462700     END-IF.                                                              
462800                                                                          
462900     SET FIRST-FIELD TO TRUE.                                             
463000                                                                          
463100     PERFORM WITH TEST BEFORE                                             
463200      VARYING PV-I FROM PC-FIRST-FIELD BY +1                              
463300        UNTIL PV-I > PC-MAX-VFLDS-LIMIT                                   
463400                                                                          
463500          IF PV-SORT-SELECTED(PV-I) = 'Y'                                 
463600           AND PV-SORT-ONVSCREEN(PV-I) = ASC-SEL-VARIABLE-SCREEN          
463700                                                                          
463800             MOVE PV-SORT-POINTER (PV-I) TO PV-J                          
463900                                                                          
464000             IF FIRST-FIELD                                               
464100                 COMPUTE PV-VSCREEN-XPOS = 1                              
464200                                + PV-SORT-VFLD-SPACING(PV-I)              
464300             ELSE                                                         
464400                 COMPUTE PV-VSCREEN-XPOS = PV-LAST-VSCREEN-XPOS           
464500                                + PV-LAST-VFLD-LENGTH                     
464600                                + PV-SORT-VFLD-SPACING(PV-I)              
464700            END-IF                                                        
464800                                                                          
464900            COMPUTE PV-SPACING-XPOS = PV-VSCREEN-XPOS -                   
465000                                - PV-SORT-VFLD-SPACING(PV-I)              
465100                                                                          
465200            IF DISPLAY-HEADER                                             
465300              PERFORM 9530-BUILD-HEADER-SCREEN-AREA                       
465400            ELSE                                                          
465500              IF DISPLAY-TOTAL                                            
465600                PERFORM 9540-BUILD-TOTAL-SCREEN-AREA                      
465700              ELSE                                                        
465800                PERFORM 9520-BUILD-LIST-SCREEN-AREA                       
465900              END-IF                                                      
466000            END-IF                                                        
466100                                                                          
466200            SET  NOT-FIRST-FIELD TO TRUE                                  
466300            MOVE PV-VSCREEN-XPOS TO PV-LAST-VSCREEN-XPOS                  
466400            MOVE PV-LENGTH(PV-J) TO PV-LAST-VFLD-LENGTH                   
466500                                                                          
466600          END-IF                                                          
466700     END-PERFORM.                                                         
466800************* TRY THIS ONCE ************************                      
466900     IF DISPLAY-HEADER                                                    
467000         MOVE '   PO    ' TO PVS-PO-TXT                                   
467100         MOVE '    '      TO PVS-DEPT                                     
467200         MOVE 'VENDOR  '  TO PVS-VND                                      
467300         MOVE '   '       TO PVS-DMM                                      
467400         MOVE PV-VHDR1    TO PVS-DATA                                     
467500         PERFORM 5111-WRITE-EXCEL-FILE                                    
467600         MOVE '  NUMBER ' TO PVS-PO-TXT                                   
467700         MOVE 'DEPT'      TO PVS-DEPT                                     
467800         MOVE 'NAME    '  TO PVS-VND                                      
467900         MOVE 'DMM'       TO PVS-DMM                                      
468000         MOVE PV-VHDR2    TO PVS-DATA                                     
468100         PERFORM 5111-WRITE-EXCEL-FILE                                    
468200     END-IF.                                                              
468300************* TRY THIS ONCE ************************                      
468400*#END_OF_VARIABLE_LOGIC------------------------------------------*        
468500                                                                          
468600 EJECT                                                                    
468700*----------------------------------------------------------------*        
468800* THIS ROUTINE BUILDS THE PHYSICAL LINE AND TOTAL PART.          *        
468900*----------------------------------------------------------------*        
469000                                                                          
469100 9520-BUILD-LIST-SCREEN-AREA.                                             
469200                                                                          
469300*#VARIABLE_LOGIC_GROUP_2-----------------------------------------*        
469400*  THE FOLLOWING LOGIC HANDLES THE FORMATTING OF THE LIST       *         
469500*  AND TOTAL PART OF THE CICS MAP FIELDS.                       *         
469600*---------------------------------------------------------------*         
469700     SET BUILD-LINE TO TRUE.                                              
469800     MOVE PV-DATA (PV-J) TO PV-WORK-DATA.                                 
469900*    MOVE MR-VFLD (PV-SUB) TO PV-SAVE-DATA.                               
470000     PERFORM 9550-MOVE-VDATA-TO-SCREEN.                                   
470100*    MOVE PV-SAVE-DATA TO MR-VFLD (PV-SUB).                               
470200*#END_OF_VARIABLE_LOGIC------------------------------------------*        
470300                                                                          
470400 EJECT                                                                    
470500*----------------------------------------------------------------*        
470600* THIS ROUTINE BUILDS 54 CHARACTER PHYSICAL HEADER PART.         *        
470700* THIS ROUTINE BUILDS 165 CHARACTER PHYSICAL HEADER PART.        *        
470800*----------------------------------------------------------------*        
470900                                                                          
471000 9530-BUILD-HEADER-SCREEN-AREA.                                           
471100                                                                          
471200*#VARIABLE_LOGIC_GROUP_2-----------------------------------------*        
471300*  THE FOLLOWING LOGIC HANDLES THE FORMATTING OF THE HEADER     *         
471400*  LEVEL 1 AND LEVEL 2 ONLY.                                    *         
471500*---------------------------------------------------------------*         
471600*     MOVE PV-HEADER-LEVEL-1 (PV-J) TO PV-WORK-DATA.                      
471700      MOVE PV-HEADER-LEVEL-1 (PV-J) TO PV-WORK-HDR1.                      
471800      SET BUILD-HEADER-1 TO TRUE.                                         
471900      PERFORM 9550-MOVE-VDATA-TO-SCREEN.                                  
472000***   PERFORM 5111-WRITE-EXCEL-FILE.                                      
472100                                                                          
472200*     MOVE PV-HEADER-LEVEL-2 (PV-J) TO PV-WORK-DATA.                      
472300      MOVE PV-HEADER-LEVEL-2 (PV-J) TO PV-WORK-HDR2.                      
472400      SET BUILD-HEADER-2 TO TRUE.                                         
472500      PERFORM 9550-MOVE-VDATA-TO-SCREEN.                                  
472600***   PERFORM 5111-WRITE-EXCEL-FILE.                                      
472700*#END_OF_VARIABLE_LOGIC------------------------------------------*        
472800                                                                          
472900 EJECT                                                                    
473000*----------------------------------------------------------------*        
473100* THIS ROUTINE BUILDS THE TOTAL PART.                            *        
473200*----------------------------------------------------------------*        
473300                                                                          
473400 9540-BUILD-TOTAL-SCREEN-AREA.                                            
473500                                                                          
473600*#VARIABLE_LOGIC_GROUP_2-----------------------------------------*        
473700*  THE FOLLOWING LOGIC HANDLES THE FORMATTING OF THE LIST       *         
473800*  AND TOTAL PART OF THE CICS MAP FIELDS.                       *         
473900*---------------------------------------------------------------*         
474000     SET BUILD-TOTAL     TO TRUE.                                         
474100     MOVE PV-TOTAL(PV-J) TO PV-WORK-DATA.                                 
474200     PERFORM 9550-MOVE-VDATA-TO-SCREEN.                                   
474300*#END_OF_VARIABLE_LOGIC------------------------------------------*        
474400                                                                          
474500 EJECT                                                                    
474600*----------------------------------------------------------------*        
474700* BUILD THE PHYSICAL SCREEN PART WHICH IS 165 BYTES LONG FROM    *        
474800* THE VARIABLE DATA. THIS ROUTINE REFORMATS THE VARIABLE HEADER  *        
474900* LINE AND TOTAL LINE INTO THE ACTUAL PHYSICAL SCREEN DIMENSIONS.*        
475000*----------------------------------------------------------------*        
475100                                                                          
475200 9550-MOVE-VDATA-TO-SCREEN.                                               
475300                                                                          
475400*#VARIABLE_LOGIC_GROUP_2-----------------------------------------*        
475500*  THE FOLLOWING LOGIC HANDLES THE FORMATTING OF SPACING AND    *         
475600*  POSITIONING OF THE DATA ON THE SCREEN.                       *         
475700*---------------------------------------------------------------*         
475800*  #VERY_IMPORTANT ==>                                          *         
475900*  THIS LOGIC SHOULD NEVER CHANGE REGARDLESS OF                 *         
476000*  HOW MANY VARIABLE FIELDS EXIST. THIS CODE IS FLEXIBLE        *         
476100*  ENOUGH TO HANDLE GROWTH SO IT SHOULD BE STATIC.              *         
476200*---------------------------------------------------------------*         
476300*  #VERY_IMPORTANT ==>                                          *         
476400*  NOTE THE DIFFERENCE BETWEEN PV-I AND PV-J.  PV-I IS THE      *         
476500*  INDEX TO THE SORTED VARIABLE CONTROL TABLE.  WHERE AS THE    *         
476600*  PV-J VARIABLE IS THE POINTER TO THE UNSORTED VARIABLE        *         
476700*  CONTROL DATA ARRAY.                                          *         
476800*---------------------------------------------------------------*         
476900     MOVE PC-SPACES(1:PV-SORT-VFLD-SPACING(PV-I)) TO                      
477000       PVS-DATA(PV-SPACING-XPOS:PV-SORT-VFLD-SPACING(PV-I))               
477100                                                                          
477200     IF PV-JUSTIFIED (PV-J) = 'L'                                         
477300       COMPUTE PV-WORK-POS = 1                                            
477400     ELSE                                                                 
477500       COMPUTE PV-WORK-POS =                                              
477600          (PC-MAX-DATA-VFLD-LENGTH - PV-LENGTH(PV-J)) + 1.                
477700                                                                          
477800     EVALUATE TRUE                                                        
477900                                                                          
478000       WHEN BUILD-HEADER-1                                                
478100*       MOVE PV-WORK-DATA (PV-WORK-POS:PV-LENGTH(PV-J)) TO                
478200        MOVE PV-WORK-HDR1 (PV-WORK-POS:PV-LENGTH(PV-J)) TO                
478300          PV-VHDR1(PV-VSCREEN-XPOS:PV-LENGTH(PV-J))                       
478400                                                                          
478500       WHEN BUILD-HEADER-2                                                
478600*       MOVE PV-WORK-DATA (PV-WORK-POS:PV-LENGTH(PV-J)) TO                
478700        MOVE PV-WORK-HDR2 (PV-WORK-POS:PV-LENGTH(PV-J)) TO                
478800          PV-VHDR2(PV-VSCREEN-XPOS:PV-LENGTH(PV-J))                       
478900                                                                          
479000       WHEN BUILD-LINE                                                    
479100        MOVE PV-WORK-DATA (PV-WORK-POS:PV-LENGTH(PV-J)) TO                
479200          PVS-DATA(PV-VSCREEN-XPOS:PV-LENGTH(PV-J))                       
479300                                                                          
479400       WHEN BUILD-TOTAL                                                   
479500        MOVE PV-WORK-DATA (PV-WORK-POS:PV-LENGTH(PV-J)) TO                
479600          PVS-DATA(PV-VSCREEN-XPOS:PV-LENGTH(PV-J))                       
479700                                                                          
479800     END-EVALUATE.                                                        
479900*#END_OF_VARIABLE_LOGIC------------------------------------------*        
480000                                                                          
480100 EJECT                                                                    
480200*----------------------------------------------------------------*        
480300*  LOAD ASC DATA AS ITS REQUESTED                                         
480400*----------------------------------------------------------------*        
480500                                                                          
480600 9600-DB2-LOAD-PO-DATA.                                                   
480700                                                                          
480800     MOVE SPACES     TO PV-SM-STRT-FCTRY-DTE.                             
480900     MOVE SPACES     TO PV-SM-LAST-FCTRY-DTE.                             
481000     MOVE SPACES     TO PV-SM-OTB-PER-NBR.                                
481100     MOVE SPACES     TO PV-SM-DONT-SHP-DTE.                               
481200     MOVE SPACES     TO PV-SM-CAN-IFNOT-SHIP-DTE.                         
481300     MOVE SPACES     TO PV-SM-EXT-CAN-DTE.                                
481400     MOVE SPACES     TO PV-SM-VENDOR-STYLE.                               
481500     MOVE SPACES     TO PV-SM-TRLR-AVAIL-DT.                              
481600                                                                          
481700*#VARIABLE_LOGIC_GROUP_2_AND_GROUP_2-----------------------------*        
481800*  THIS LOGIC GOES OUT TO DB2 AND PULLS IN THE DATA             *         
481900*  ONLY WHEN THE DATA IS SELECTED BY THE USER WILL              *         
482000*  DB2 DATA BE RETRIEVED.  THUS THE LESS DATA SELECTED          *         
482100*  TO BE DISPLAYED THE FASTER THE PROGRAM SHOULD PERFORM.       *         
482200*---------------------------------------------------------------*         
482300                                                                          
482400     PERFORM 9900-LOAD-PO-DETAILS.                                        
482500                                                                          
482600     IF PLNSHP-STRT-FCTRY-DTE NOT = '0001-01-01'                          
482700        MOVE PLNSHP-STRT-FCTRY-DTE (1:4) TO                               
482800                        PV-SM-STRT-FCTRY-DTE (1:4)                        
482900        MOVE PLNSHP-STRT-FCTRY-DTE (6:2) TO                               
483000                        PV-SM-STRT-FCTRY-DTE (5:2)                        
483100        MOVE PLNSHP-STRT-FCTRY-DTE (9:2) TO                               
483200                        PV-SM-STRT-FCTRY-DTE (7:2)                        
483300     END-IF.                                                              
483400                                                                          
483500     IF PLNSHP-LAST-FCTRY-DTE NOT = '0001-01-01'                          
483600        MOVE PLNSHP-LAST-FCTRY-DTE (1:4) TO                               
483700                        PV-SM-LAST-FCTRY-DTE (1:4)                        
483800        MOVE PLNSHP-LAST-FCTRY-DTE (6:2) TO                               
483900                        PV-SM-LAST-FCTRY-DTE (5:2)                        
484000        MOVE PLNSHP-LAST-FCTRY-DTE (9:2) TO                               
484100                        PV-SM-LAST-FCTRY-DTE (7:2)                        
484200     END-IF.                                                              
484300                                                                          
484400     IF PURCHS-OTB-PER-NBR NOT = '000101'                                 
484500        MOVE PURCHS-OTB-PER-NBR TO                                        
484600                       PV-SM-OTB-PER-NBR                                  
484700     END-IF.                                                              
484800                                                                          
484900     IF PLNSHP-DONT-SHIP-BEF-DTE NOT = '0001-01-01'                       
485000        MOVE PLNSHP-DONT-SHIP-BEF-DTE (1:4) TO                            
485100                        PV-SM-DONT-SHP-DTE(1:4)                           
485200        MOVE PLNSHP-DONT-SHIP-BEF-DTE (6:2) TO                            
485300                        PV-SM-DONT-SHP-DTE(5:2)                           
485400        MOVE PLNSHP-DONT-SHIP-BEF-DTE (9:2) TO                            
485500                        PV-SM-DONT-SHP-DTE(7:2)                           
485600     END-IF.                                                              
485700                                                                          
485800     IF PLNSHP-CAN-IFNOT-SHIP-DTE NOT = '0001-01-01'                      
485900        MOVE PLNSHP-CAN-IFNOT-SHIP-DTE (1:4) TO                           
486000                     PV-SM-CAN-IFNOT-SHIP-DTE(1:4)                        
486100        MOVE PLNSHP-CAN-IFNOT-SHIP-DTE (6:2) TO                           
486200                     PV-SM-CAN-IFNOT-SHIP-DTE(5:2)                        
486300        MOVE PLNSHP-CAN-IFNOT-SHIP-DTE (9:2) TO                           
486400                     PV-SM-CAN-IFNOT-SHIP-DTE(7:2)                        
486500     END-IF.                                                              
486600                                                                          
486700     IF PLNSHP-EXT-CAN-DTE NOT = '0001-01-01'                             
486800        MOVE PLNSHP-EXT-CAN-DTE (1:4) TO                                  
486900                        PV-SM-EXT-CAN-DTE(1:4)                            
487000        MOVE PLNSHP-EXT-CAN-DTE (6:2) TO                                  
487100                        PV-SM-EXT-CAN-DTE(5:2)                            
487200        MOVE PLNSHP-EXT-CAN-DTE (9:2) TO                                  
487300                        PV-SM-EXT-CAN-DTE(7:2)                            
487400     END-IF.                                                              
487500                                                                          
487600     MOVE PV-SM-OTB-PER-NBR                                               
487700          TO EXT-OTB (ASC-BLK-SUB ASC-ITEM-SUB).                          
487800     MOVE PV-SM-DONT-SHP-DTE                                              
487900          TO EXT-DSB (ASC-BLK-SUB ASC-ITEM-SUB).                          
488000     MOVE PV-SM-STRT-FCTRY-DTE                                            
488100          TO EXT-SXF (ASC-BLK-SUB ASC-ITEM-SUB).                          
488200     MOVE PV-SM-LAST-FCTRY-DTE                                            
488300          TO EXT-LXF (ASC-BLK-SUB ASC-ITEM-SUB).                          
488400     MOVE PV-SM-CAN-IFNOT-SHIP-DTE                                        
488500          TO EXT-CNL (ASC-BLK-SUB ASC-ITEM-SUB).                          
488600     IF PV-SM-EXT-CAN-DTE NOT = SPACES                                    
488700          MOVE PV-SM-EXT-CAN-DTE TO                                       
488800              EXT-CNL (ASC-BLK-SUB ASC-ITEM-SUB)                          
488900     END-IF.                                                              
489000                                                                          
489100     IF PLNSHP-FOB-CDE = LOW-VALUES                                       
489200         MOVE SPACES TO EXT-FOB (ASC-BLK-SUB ASC-ITEM-SUB)                
489300     ELSE                                                                 
489400         MOVE PLNSHP-FOB-CDE                                              
489500                     TO EXT-FOB (ASC-BLK-SUB ASC-ITEM-SUB)                
489600     END-IF.                                                              
489700                                                                          
489800     IF PLNSHP-POE-CDE = LOW-VALUES                                       
489900         MOVE SPACES TO EXT-POE (ASC-BLK-SUB ASC-ITEM-SUB)                
490000     ELSE                                                                 
490100         MOVE PLNSHP-POE-CDE                                              
490200                     TO EXT-POE (ASC-BLK-SUB ASC-ITEM-SUB)                
490300     END-IF.                                                              
490400                                                                          
490500     MOVE PURCHS-EDI-IND                                                  
490600          TO EXT-EDI (ASC-BLK-SUB ASC-ITEM-SUB).                          
490700     MOVE PURCHS-PKGNG-CDE                                                
490800          TO EXT-PPK (ASC-BLK-SUB ASC-ITEM-SUB).                          
490900     MOVE PURCHS-STATUS-CDE                                               
491000          TO EXT-STA (ASC-BLK-SUB ASC-ITEM-SUB).                          
491100     MOVE PURCHS-DEPT-NBR                                                 
491200          TO ASC-DEPT (ASC-BLK-SUB ASC-ITEM-SUB).                         
491300                                                                          
491400     IF PV-USORT-SELECTED (PC-VFLD-AED-I) = 'Y'                           
491500        PERFORM 9960-GET-MIN-AD-DATE                                      
491600        MOVE PV-SM-AD-EVNT-DT                                             
491700             TO EXT-AED (ASC-BLK-SUB ASC-ITEM-SUB)                        
491800     END-IF.                                                              
491900                                                                          
492000     IF PV-USORT-SELECTED (PC-VFLD-QCT-I) = 'Y'                           
492100        MOVE PURCHS-QTA-CTG-CDE                                           
492200             TO EXT-QCT (ASC-BLK-SUB ASC-ITEM-SUB)                        
492300     END-IF.                                                              
492400                                                                          
492500     IF PV-USORT-SELECTED (PC-VFLD-VNS-I) = 'Y'                           
492600        PERFORM 9965-GET-VENDOR-STYLE                                     
492700        MOVE PV-SM-VENDOR-STYLE                                           
492800             TO EXT-VNS (ASC-BLK-SUB ASC-ITEM-SUB)                        
492900     END-IF.                                                              
493000                                                                          
493100     IF PV-USORT-SELECTED (PC-VFLD-TRA-I) = 'Y'                           
493200        PERFORM 9962-GET-TRLR-AVAIL-DATE                                  
493300        MOVE PV-SM-TRLR-AVAIL-DT                                          
493400             TO EXT-TRA (ASC-BLK-SUB ASC-ITEM-SUB)                        
493500     END-IF.                                                              
493600                                                                          
493700     MOVE    +0   TO PV-DB2-COUNT2                                        
493800     PERFORM 9940-CHECK-IN-PROCESS                                        
493900     IF PV-DB2-COUNT2 > 0                                                 
494000       MOVE 'Y'            TO ASC-IP                                      
494100                      (ASC-BLK-SUB ASC-ITEM-SUB)                          
494200     ELSE                                                                 
494300       MOVE 'N'            TO ASC-IP                                      
494400                      (ASC-BLK-SUB ASC-ITEM-SUB)                          
494500     END-IF.                                                              
494600                                                                          
494700*---------------------------------------------------------------*         
494800*  #TIP ==>                                                     *         
494900*  IF ADDING A NEW DISPLAY CRITERIA FIELD THEN A CLONE          *         
495000*  OF ONE OF THE FOLLOWING IF CONDTIONS SHOULD BE DONE.         *         
495100*  NORMALLY THE CONVENTION FOR EACH IF BLOCK SHOULD NEVER       *         
495200*  CHANGE.  IN THE FOLLOWING SECTION ONLY THE DOLLAR AND        *         
495300*  UNIT TYPE FIELDS SHOULD BE ADDED. OTHERWISE THE CODE SHOULD  *         
495400*  GO IN THE DATA-LOAD-IMPORT-DATA SECTION.                     *         
495500*---------------------------------------------------------------*         
495600                                                                          
495700     IF PV-USORT-SELECTED (PC-VFLD-DOR-I) = 'Y'                           
495800     OR PV-USORT-SELECTED (PC-VFLD-DRC-I) = 'Y'                           
495900     OR PV-USORT-SELECTED (PC-VFLD-DRP-I) = 'Y'                           
496000        MOVE POX-FSC                                                      
496100             TO EXT-FSC (ASC-BLK-SUB ASC-ITEM-SUB)                        
496200        MOVE POX-TTC                                                      
496300             TO EXT-TTC (ASC-BLK-SUB ASC-ITEM-SUB)                        
496400        MOVE POX-TVC                                                      
496500             TO EXT-TVC (ASC-BLK-SUB ASC-ITEM-SUB)                        
496600        MOVE POX-DOR                                                      
496700             TO EXT-DOR (ASC-BLK-SUB ASC-ITEM-SUB)                        
496800        MOVE POX-DRC                                                      
496900             TO EXT-DRC (ASC-BLK-SUB ASC-ITEM-SUB)                        
497000     END-IF.                                                              
497100                                                                          
497200     IF PV-USORT-SELECTED (PC-VFLD-UOR-I) = 'Y'                           
497300     OR PV-USORT-SELECTED (PC-VFLD-URC-I) = 'Y'                           
497400     OR PV-USORT-SELECTED (PC-VFLD-URP-I) = 'Y'                           
497500        MOVE POX-URC                                                      
497600             TO EXT-URC (ASC-BLK-SUB ASC-ITEM-SUB)                        
497700        MOVE POX-UOR                                                      
497800             TO EXT-UOR (ASC-BLK-SUB ASC-ITEM-SUB)                        
497900     END-IF.                                                              
498000*#END_OF_VARIABLE_LOGIC------------------------------------------*        
498100                                                                          
498200*----------------------------------------------------------------*        
498300*  LOAD ASC DATA AS ITS REQUESTED                                         
498400*----------------------------------------------------------------*        
498500                                                                          
498600 9610-DB2-LOAD-IMPORT-DATA.                                               
498700                                                                          
498800*#VARIABLE_LOGIC_GROUP_2----------------------------------------*         
498900*  THIS LOGIC GOES OUT TO DB2 AND PULLS IN THE DATA             *         
499000*  ONLY WHEN THE DATA IS SELECTED BY THE USER WILL              *         
499100*  DB2 DATA BE RETRIEVED.  THUS THE LESS DATA SELECTED          *         
499200*  TO BE DISPLAYED THE FASTER THE PROGRAM SHOULD PERFORM.       *         
499300*---------------------------------------------------------------*         
499400                                                                          
499500     MOVE SPACES     TO PV-SM-BKNG-DELY-DT.                               
499600     MOVE SPACES     TO PV-SM-ACTL-DELY-DT.                               
499700     MOVE SPACES     TO PV-SM-IMPRT-DPRTR-DT.                             
499800     MOVE SPACES     TO PV-SM-IMPRT-POE-DELY-DT.                          
499900     MOVE SPACES     TO PV-WORK-ETA-ATA.                                  
500000     MOVE SPACES     TO PV-TRIP-TYP-CDE-FULL.                             
500100     MOVE SPACES     TO PV-SM-SPL-CRT-DT.                                 
500200     MOVE SPACES     TO PV-SM-SPL-SNT-DT.                                 
500300     MOVE SPACES     TO PV-SM-STORE-DISTRO.                               
500400     MOVE SPACES     TO PV-SM-DEVAN-DT.                                   
500500     MOVE SPACES     TO PV-SM-BKR-FRGT-RLSE-DT.                           
500600     MOVE SPACES     TO PV-SM-CONTNR-ID.                                  
500700                                                                          
500800*---------------------------------------------------------------*         
500900*  #TIP ==>                                                     *         
501000*  IF ADDING A NEW DISPLAY CRITERIA FIELD THEN A CLONE          *         
501100*  OF ONE OF THE FOLLOWING IF CONDTIONS SHOULD BE DONE.         *         
501200*  NORMALLY THE CONVENTION FOR EACH IF BLOCK SHOULD NEVER       *         
501300*  CHANGE.                                                      *         
501400*---------------------------------------------------------------*         
501500                                                                          
501600     IF PV-USORT-SELECTED (PC-VFLD-SLD-I) = 'Y'                           
501700     OR PV-USORT-SELECTED (PC-VFLD-PRD-I) = 'Y'                           
501800     OR PV-USORT-SELECTED (PC-VFLD-CRL-I) = 'Y'                           
501900        PERFORM 9820-SELECT-CONTAINER-DATA                                
502000        MOVE PV-SM-IMPRT-DPRTR-DT                                         
502100             TO EXT-SLD (ASC-BLK-SUB ASC-ITEM-SUB)                        
502200        MOVE PV-SM-IMPRT-POE-DELY-DT                                      
502300             TO EXT-PRD (ASC-BLK-SUB ASC-ITEM-SUB)                        
502400        MOVE PV-WORK-ETA-ATA                                              
502500             TO EXT-PRD-ETA-ATA (ASC-BLK-SUB ASC-ITEM-SUB)                
502600                                                                          
502700        SET PS-BKR-FRGT-RLSE-NO TO TRUE                                   
502800        PERFORM 9822-SELECT-CONTNR-RLSE-CDE                               
502900        IF PS-BKR-FRGT-RLSE                                               
503000            MOVE PV-SM-BKR-FRGT-RLSE-DT                                   
503100                 TO EXT-CRL (ASC-BLK-SUB ASC-ITEM-SUB)                    
503200        ELSE                                                              
503300            MOVE SPACES                                                   
503400                 TO EXT-CRL (ASC-BLK-SUB ASC-ITEM-SUB)                    
503500        END-IF                                                            
503600                                                                          
503700        PERFORM 9825-SELECT-CONTNR-ID                                     
503800        MOVE PV-SM-CONTNR-ID                                              
503900             TO EXT-CNT (ASC-BLK-SUB ASC-ITEM-SUB)                        
504000     END-IF.                                                              
504100                                                                          
504200     IF PV-USORT-SELECTED (PC-VFLD-FRD-I) = 'Y'                           
504300        PERFORM 9810-SELECT-RECEIPT-DATA                                  
504400        MOVE PV-SM-ACTL-DELY-DT                                           
504500             TO EXT-FRD (ASC-BLK-SUB ASC-ITEM-SUB)                        
504600     END-IF.                                                              
504700                                                                          
504800     IF PV-USORT-SELECTED (PC-VFLD-BKD-I) = 'Y'                           
504900        PERFORM 9800-SELECT-BOOKING-DATA                                  
505000        MOVE PV-SM-BKNG-DELY-DT                                           
505100             TO EXT-BKD (ASC-BLK-SUB ASC-ITEM-SUB)                        
505200     END-IF.                                                              
505300                                                                          
505400     IF PV-USORT-SELECTED (PC-VFLD-CSR-I) = 'Y'                           
505500        PERFORM 9890-LOAD-CUSTOMS-DATA                                    
505600        MOVE PV-SM-ACTL-CLR-DATE                                          
505700             TO EXT-CSR (ASC-BLK-SUB ASC-ITEM-SUB)                        
505800     END-IF.                                                              
505900                                                                          
506000     IF PV-USORT-SELECTED (PC-VFLD-DVN-I) = 'Y'                           
506100        PERFORM 9895-SELECT-DEVAN-DATA                                    
506200        MOVE PV-SM-DEVAN-DT                                               
506300             TO EXT-DVN (ASC-BLK-SUB ASC-ITEM-SUB)                        
506400     END-IF.                                                              
506500                                                                          
506600     IF PV-USORT-SELECTED (PC-VFLD-TRP-I) = 'Y'                           
506700        PERFORM 9905-LOAD-TRIP-TYPE-DATA                                  
506800        MOVE PV-TRIP-TYP-CDE-FULL                                         
506900             TO EXT-TRP (ASC-BLK-SUB ASC-ITEM-SUB)                        
507000     END-IF.                                                              
507100                                                                          
507200     IF PV-USORT-SELECTED (PC-VFLD-SPL-CRT-I) = 'Y' OR                    
507300        PV-USORT-SELECTED (PC-VFLD-SPL-SNT-I) = 'Y'                       
507400        PERFORM 9912-LOAD-DC-SPLIT-CREATE-DATE                            
507500        PERFORM 9917-LOAD-DC-SPLIT-SENT-DATE                              
507600        MOVE PV-SM-SPL-CRT-DT                                             
507700             TO EXT-SPL-CRT (ASC-BLK-SUB ASC-ITEM-SUB)                    
507800        MOVE PV-SM-SPL-SNT-DT                                             
507900             TO EXT-SPL-SNT (ASC-BLK-SUB ASC-ITEM-SUB)                    
508000        INITIALIZE PV-DB2-COUNT                                           
508100        PERFORM 9928-SELECT-STORE-DISTRO                                  
508200        MOVE PV-SM-STORE-DISTRO                                           
508300             TO EXT-STD (ASC-BLK-SUB ASC-ITEM-SUB)                        
508400     END-IF.                                                              
508500                                                                          
508600*#END_OF_VARIABLE_LOGIC------------------------------------------*        
508700                                                                          
508800 EJECT                                                                    
508900*----------------------------------------------------------------*        
509000*  LOAD ASC DATA AS ITS REQUESTED                                         
509100*----------------------------------------------------------------*        
509200                                                                          
509300 9620-DB2-LOAD-DC-DATA.                                                   
509400                                                                          
509500     MOVE SPACES     TO PV-SM-TRIP-ETA-DC1.                               
509600     MOVE SPACES     TO PV-SM-TRIP-ETA-DC2.                               
509700     MOVE SPACES     TO PV-SM-TRIP-ETA-DC3.                               
509800     MOVE SPACES     TO PV-SM-TRIP-ETA-DC4.                               
509900     MOVE SPACES     TO PV-SM-TRIP-ETA-DC5.                               
510000     MOVE SPACES     TO PV-SM-TRIP-ETA-DC6.                               
510100     MOVE SPACES     TO PV-SM-TRIP-ETA-DC7.                               
510200     MOVE SPACES     TO PV-SM-TRIP-ETA-DC8.                               
510300     MOVE SPACES     TO PV-SM-TRIP-ETA-DC9.                               
510400     MOVE SPACES     TO PV-SM-TRIP-ETA-DC10.                              
510500     MOVE SPACES     TO PV-SM-TRIP-ETA-DC11.                              
510600     MOVE SPACES     TO PV-SM-TRIP-ETA-DC12.                              
510700                                                                          
510800     MOVE SPACES     TO PV-WORK-ETA-ATA                                   
510900                        PV-WORK-ETA-ATA-DC1                               
511000                        PV-WORK-ETA-ATA-DC2                               
511100                        PV-WORK-ETA-ATA-DC3                               
511200                        PV-WORK-ETA-ATA-DC4                               
511300                        PV-WORK-ETA-ATA-DC5                               
511400                        PV-WORK-ETA-ATA-DC6                               
511500                        PV-WORK-ETA-ATA-DC7                               
511600                        PV-WORK-ETA-ATA-DC8                               
511700                        PV-WORK-ETA-ATA-DC9                               
511800                        PV-WORK-ETA-ATA-DC10                              
511900                        PV-WORK-ETA-ATA-DC11                              
512000                        PV-WORK-ETA-ATA-DC12.                             
512100                                                                          
512200     IF PV-USORT-SELECTED (PC-VFLD-DC1-I) = 'Y'                           
512300     OR PV-USORT-SELECTED (PC-VFLD-DC2-I) = 'Y'                           
512400     OR PV-USORT-SELECTED (PC-VFLD-DC3-I) = 'Y'                           
512500     OR PV-USORT-SELECTED (PC-VFLD-DC4-I) = 'Y'                           
512600     OR PV-USORT-SELECTED (PC-VFLD-DC5-I) = 'Y'                           
512700     OR PV-USORT-SELECTED (PC-VFLD-DC6-I) = 'Y'                           
512800     OR PV-USORT-SELECTED (PC-VFLD-DC7-I) = 'Y'                           
512900     OR PV-USORT-SELECTED (PC-VFLD-DC8-I) = 'Y'                           
513000     OR PV-USORT-SELECTED (PC-VFLD-DC9-I) = 'Y'                           
513100     OR PV-USORT-SELECTED (PC-VFLD-DC10-I) = 'Y'                          
513200     OR PV-USORT-SELECTED (PC-VFLD-DC11-I) = 'Y'                          
513300     OR PV-USORT-SELECTED (PC-VFLD-DC12-I) = 'Y'                          
513400                                                                          
513500        MOVE ZEROS TO PV-SV-OPER-UNIT                                     
513600        MOVE ZEROS TO PV-SV-FCLTY                                         
513700        MOVE ASC-DC-TABLE TO PV-DC-TABLE                                  
513800                                                                          
513900        SET MORE-CURSOR-DATA TO TRUE                                      
514000        PERFORM 9980-OPEN-SHIP-CSR                                        
514100        PERFORM 9850-FETCH-DC-ETA-ATA-DATA                                
514200                UNTIL NO-MORE-CURSOR-DATA                                 
514300        PERFORM 9990-CLOSE-SHIP-CSR                                       
514400                                                                          
514500        MOVE PV-SM-TRIP-ETA-DC1                                           
514600             TO EXT-DC1 (ASC-BLK-SUB ASC-ITEM-SUB)                        
514700        MOVE PV-WORK-ETA-ATA-DC1                                          
514800             TO EXT-DC1-ETA-ATA (ASC-BLK-SUB ASC-ITEM-SUB)                
514900        MOVE PV-SM-TRIP-ETA-DC2                                           
515000             TO EXT-DC2 (ASC-BLK-SUB ASC-ITEM-SUB)                        
515100        MOVE PV-WORK-ETA-ATA-DC2                                          
515200             TO EXT-DC2-ETA-ATA (ASC-BLK-SUB ASC-ITEM-SUB)                
515300        MOVE PV-SM-TRIP-ETA-DC3                                           
515400             TO EXT-DC3 (ASC-BLK-SUB ASC-ITEM-SUB)                        
515500        MOVE PV-WORK-ETA-ATA-DC3                                          
515600             TO EXT-DC3-ETA-ATA (ASC-BLK-SUB ASC-ITEM-SUB)                
515700        MOVE PV-SM-TRIP-ETA-DC4                                           
515800             TO EXT-DC4 (ASC-BLK-SUB ASC-ITEM-SUB)                        
515900        MOVE PV-WORK-ETA-ATA-DC4                                          
516000             TO EXT-DC4-ETA-ATA (ASC-BLK-SUB ASC-ITEM-SUB)                
516100        MOVE PV-SM-TRIP-ETA-DC5                                           
516200             TO EXT-DC5 (ASC-BLK-SUB ASC-ITEM-SUB)                        
516300        MOVE PV-WORK-ETA-ATA-DC5                                          
516400             TO EXT-DC5-ETA-ATA (ASC-BLK-SUB ASC-ITEM-SUB)                
516500        MOVE PV-SM-TRIP-ETA-DC6                                           
516600             TO EXT-DC6 (ASC-BLK-SUB ASC-ITEM-SUB)                        
516700        MOVE PV-WORK-ETA-ATA-DC6                                          
516800             TO EXT-DC6-ETA-ATA (ASC-BLK-SUB ASC-ITEM-SUB)                
516900        MOVE PV-SM-TRIP-ETA-DC7                                           
517000             TO EXT-DC7 (ASC-BLK-SUB ASC-ITEM-SUB)                        
517100        MOVE PV-WORK-ETA-ATA-DC7                                          
517200             TO EXT-DC7-ETA-ATA (ASC-BLK-SUB ASC-ITEM-SUB)                
517300        MOVE PV-SM-TRIP-ETA-DC8                                           
517400             TO EXT-DC8 (ASC-BLK-SUB ASC-ITEM-SUB)                        
517500        MOVE PV-WORK-ETA-ATA-DC8                                          
517600             TO EXT-DC8-ETA-ATA (ASC-BLK-SUB ASC-ITEM-SUB)                
517700        MOVE PV-SM-TRIP-ETA-DC9                                           
517800             TO EXT-DC9 (ASC-BLK-SUB ASC-ITEM-SUB)                        
517900        MOVE PV-WORK-ETA-ATA-DC9                                          
518000             TO EXT-DC9-ETA-ATA (ASC-BLK-SUB ASC-ITEM-SUB)                
518100        MOVE PV-SM-TRIP-ETA-DC10                                          
518200             TO EXT-DC10 (ASC-BLK-SUB ASC-ITEM-SUB)                       
518300        MOVE PV-WORK-ETA-ATA-DC10                                         
518400             TO EXT-DC10-ETA-ATA (ASC-BLK-SUB ASC-ITEM-SUB)               
518500        MOVE PV-SM-TRIP-ETA-DC11                                          
518600             TO EXT-DC11 (ASC-BLK-SUB ASC-ITEM-SUB)                       
518700        MOVE PV-WORK-ETA-ATA-DC11                                         
518800             TO EXT-DC11-ETA-ATA (ASC-BLK-SUB ASC-ITEM-SUB)               
518900        MOVE PV-SM-TRIP-ETA-DC12                                          
519000             TO EXT-DC12 (ASC-BLK-SUB ASC-ITEM-SUB)                       
519100        MOVE PV-WORK-ETA-ATA-DC12                                         
519200             TO EXT-DC12-ETA-ATA (ASC-BLK-SUB ASC-ITEM-SUB)               
519300     END-IF.                                                              
519400*#END_OF_VARIABLE_LOGIC------------------------------------------*        
519500                                                                          
519600 EJECT                                                                    
519700*----------------------------------------------------------------*        
519800*  VALIDATE THE DEPARTMENT NUMBER                                *        
519900*----------------------------------------------------------------*        
520000                                                                          
520100 9700-VALIDATE-DEPT.                                                      
520200                                                                          
520300         EXEC SQL                                                         
520400              SELECT COUNT(*)                                             
520500                INTO :PV-DB2-COUNT                                        
520600                FROM TMDSEAR                                              
520700               WHERE DEPT_NBR   = :PV-DEPT-COMPARE-X-2                    
520800                 AND OPERCO_NBR = '03'                                    
520900                 AND MDSELV_CDE = 'DPT'                                   
521000                 AND STRT_DTE  <= CURRENT DATE                            
521100                 AND END_DTE   >= CURRENT DATE                            
521200         END-EXEC                                                         
521300                                                                          
521400         EVALUATE TRUE                                                    
521500             WHEN SQLCODE = +0                                            
521600             WHEN SQLCODE = +100                                          
521700             WHEN SQLCODE = -904                                          
521800             WHEN SQLCODE = -913                                          
521900                  CONTINUE                                                
522000                                                                          
522100             WHEN SQLWARN0 NOT = SPACES                                   
522200             WHEN SQLCODE < +0                                            
522300             WHEN SQLCODE > +0                                            
522400                  MOVE '9700-VALIDATE-DEPT'                               
522500                                  TO DP013-PARAGRAPH                      
522600                  MOVE 'UNSUCCESSFUL COUNT ON DEPARTMENT'                 
522700                                  TO DP013-MESSAGE-TEXT (1)               
522800                  MOVE SQLCA      TO DP013-SQLCA                          
522900                  MOVE 'TMDSEAR ' TO DP013-DB2-TABLE-NAME (1)             
523000                  SET DP013-DB2-ABEND                                     
523100                      DP013-XCTL-DISPLAY-RESTART                          
523200                                  TO TRUE                                 
523300                  PERFORM 9999-SQL-ABEND                                  
523400         END-EVALUATE.                                                    
523500                                                                          
523600 EJECT                                                                    
523700*----------------------------------------------------------------*        
523800*  VALIDATE THE STATUS CODE                                      *        
523900*----------------------------------------------------------------*        
524000                                                                          
524100 9710-VALIDATE-STATUS-CODE.                                               
524200                                                                          
524300         EXEC SQL                                                         
524400              SELECT COUNT(*)                                             
524500                INTO :PV-DB2-COUNT                                        
524600                FROM TSTATCD                                              
524700               WHERE STATUS_TYP_CDE = 'P'                                 
524800                 AND STATUS_CDE     = :STATCD-STATUS-CDE                  
524900         END-EXEC                                                         
525000                                                                          
525100         EVALUATE TRUE                                                    
525200             WHEN SQLCODE = +0                                            
525300             WHEN SQLCODE = +100                                          
525400             WHEN SQLCODE = -904                                          
525500             WHEN SQLCODE = -913                                          
525600                  CONTINUE                                                
525700                                                                          
525800             WHEN SQLWARN0 NOT = SPACES                                   
525900             WHEN SQLCODE < +0                                            
526000             WHEN SQLCODE > +0                                            
526100                  MOVE '9710-VALIDATE-STATUS-CODE'                        
526200                                  TO DP013-PARAGRAPH                      
526300                  MOVE 'UNSUCCESSFUL COUNT ON STATUS CODE'                
526400                                  TO DP013-MESSAGE-TEXT (1)               
526500                  MOVE SQLCA      TO DP013-SQLCA                          
526600                  MOVE 'TSTATCD ' TO DP013-DB2-TABLE-NAME (1)             
526700                  SET DP013-DB2-ABEND                                     
526800                      DP013-XCTL-DISPLAY-RESTART                          
526900                                  TO TRUE                                 
527000                  PERFORM 9999-SQL-ABEND                                  
527100         END-EVALUATE.                                                    
527200                                                                          
527300    EJECT                                                                 
527400*----------------------------------------------------------------*        
527500*  VALIDATE THE STATUS CODE                                      *        
527600*----------------------------------------------------------------*        
527700                                                                          
527800 9720-VALIDATE-PO-TYPE-CODE.                                              
527900                                                                          
528000         EXEC SQL                                                         
528100              SELECT COUNT(*)                                             
528200                INTO :PV-DB2-COUNT                                        
528300                FROM TPOTYCD                                              
528400               WHERE PO_VARIETY_CDE = 'T'                                 
528500                 AND PO_TYP_CDE     = :TR195-PO-TYP-CDE                   
528600         END-EXEC                                                         
528700                                                                          
528800         EVALUATE TRUE                                                    
528900             WHEN SQLCODE = +0                                            
529000             WHEN SQLCODE = +100                                          
529100             WHEN SQLCODE = -904                                          
529200             WHEN SQLCODE = -913                                          
529300                  CONTINUE                                                
529400                                                                          
529500             WHEN SQLWARN0 NOT = SPACES                                   
529600             WHEN SQLCODE < +0                                            
529700             WHEN SQLCODE > +0                                            
529800                  MOVE '9720-VALIDATE-PO-TYPE-CODE'                       
529900                                  TO DP013-PARAGRAPH                      
530000                  MOVE 'UNSUCCESSFUL COUNT ON TYPE CODE'                  
530100                                  TO DP013-MESSAGE-TEXT (1)               
530200                  MOVE SQLCA      TO DP013-SQLCA                          
530300                  MOVE 'TPOTYCD ' TO DP013-DB2-TABLE-NAME (1)             
530400                  SET DP013-DB2-ABEND                                     
530500                      DP013-XCTL-DISPLAY-RESTART                          
530600                                  TO TRUE                                 
530700                  PERFORM 9999-SQL-ABEND                                  
530800         END-EVALUATE.                                                    
530900 EJECT                                                                    
531000*----------------------------------------------------------------*        
531100*  VALIDATE THE PO TABLE                                         *        
531200*----------------------------------------------------------------*        
531300                                                                          
531400 9730-VALIDATE-PO.                                                        
531500                                                                          
531600         EXEC SQL                                                         
531700              SELECT COUNT(*)                                             
531800                INTO :PV-DB2-COUNT                                        
531900                FROM TPURCHS                                              
532000               WHERE PO_NBR         = :TR195-PO-NBR                       
532100                 AND VER_STATUS_CDE = 'A'                                 
532200         END-EXEC.                                                        
532300                                                                          
532400         EVALUATE TRUE                                                    
532500             WHEN SQLCODE = +0                                            
532600             WHEN SQLCODE = +100                                          
532700             WHEN SQLCODE = -904                                          
532800             WHEN SQLCODE = -913                                          
532900                  CONTINUE                                                
533000                                                                          
533100             WHEN SQLWARN0 NOT = SPACES                                   
533200             WHEN SQLCODE < +0                                            
533300             WHEN SQLCODE > +0                                            
533400                  MOVE '9730-VALIDATE-PO'                                 
533500                                  TO DP013-PARAGRAPH                      
533600                  MOVE 'UNSUCCESSFUL COUNT ON PO'                         
533700                                  TO DP013-MESSAGE-TEXT (1)               
533800                  MOVE SQLCA      TO DP013-SQLCA                          
533900                  MOVE 'TPURCHS ' TO DP013-DB2-TABLE-NAME (1)             
534000                  SET DP013-DB2-ABEND                                     
534100                      DP013-XCTL-DISPLAY-RESTART                          
534200                                  TO TRUE                                 
534300                  PERFORM 9999-SQL-ABEND                                  
534400         END-EVALUATE.                                                    
534500 EJECT                                                                    
534600*----------------------------------------------------------------*        
534700*  VALIDATE THE FOB CODE                                         *        
534800*----------------------------------------------------------------*        
534900                                                                          
535000 9740-VALIDATE-FOB-CODE.                                                  
535100                                                                          
535200         EXEC SQL                                                         
535300              SELECT COUNT(*)                                             
535400                INTO :PV-DB2-COUNT                                        
535500                FROM TIMFOB                                               
535600               WHERE FOB_CDE        = :TR195-FOB-CDE                      
535700         END-EXEC.                                                        
535800                                                                          
535900         EVALUATE TRUE                                                    
536000             WHEN SQLCODE = +0                                            
536100             WHEN SQLCODE = +100                                          
536200             WHEN SQLCODE = -811                                          
536300             WHEN SQLCODE = -904                                          
536400             WHEN SQLCODE = -913                                          
536500                  CONTINUE                                                
536600                                                                          
536700             WHEN SQLWARN0 NOT = SPACES                                   
536800             WHEN SQLCODE < +0                                            
536900             WHEN SQLCODE > +0                                            
537000                  MOVE '9740-VALIDATE-FOB-CODE'                           
537100                                  TO DP013-PARAGRAPH                      
537200                  MOVE 'UNSUCCESSFUL COUNT ON TYPE CODE'                  
537300                                  TO DP013-MESSAGE-TEXT (1)               
537400                  MOVE SQLCA      TO DP013-SQLCA                          
537500                  MOVE 'TIMFOB  ' TO DP013-DB2-TABLE-NAME (1)             
537600                  SET DP013-DB2-ABEND                                     
537700                      DP013-XCTL-DISPLAY-RESTART                          
537800                                  TO TRUE                                 
537900                  PERFORM 9999-SQL-ABEND                                  
538000         END-EVALUATE.                                                    
538100 EJECT                                                                    
538200*----------------------------------------------------------------*        
538300*   OPEN THE POE CODE CURSOR                                     *        
538400*----------------------------------------------------------------*        
538500 9750-OPEN-POE-CURSOR.                                                    
538600                                                                          
538700         EXEC SQL                                                         
538800              OPEN POE-CSR                                                
538900         END-EXEC.                                                        
539000                                                                          
539100         EVALUATE TRUE                                                    
539200             WHEN SQLCODE = ZERO                                          
539300             WHEN SQLCODE = -904                                          
539400             WHEN SQLCODE = -913                                          
539500                 CONTINUE                                                 
539600             WHEN SQLWARN0 NOT = SPACES                                   
539700             WHEN SQLCODE < ZERO                                          
539800             WHEN SQLCODE > ZERO                                          
539900                 MOVE '9750-OPEN-POE-CURSOR'                              
540000                                   TO DP013-PARAGRAPH                     
540100                 MOVE 'OPEN POE CURSOR - '                                
540200                                   TO DP013-MESSAGE-TEXT (1)              
540300                 MOVE SQLCA        TO DP013-SQLCA                         
540400                 MOVE 'TIMPOE  '   TO DP013-DB2-TABLE-NAME (1)            
540500                 SET DP013-DB2-ABEND                                      
540600                     DP013-XCTL-DISPLAY-RESTART TO TRUE                   
540700                  PERFORM 9999-SQL-ABEND                                  
540800         END-EVALUATE.                                                    
540900                                                                          
541000 EJECT                                                                    
541100*----------------------------------------------------------------*        
541200*   CLOSE THE POE CODE CURSOR                                    *        
541300*----------------------------------------------------------------*        
541400 9752-CLOSE-POE-CURSOR.                                                   
541500                                                                          
541600     EXEC SQL                                                             
541700          CLOSE POE-CSR                                                   
541800     END-EXEC.                                                            
541900                                                                          
542000     EVALUATE TRUE                                                        
542100         WHEN SQLCODE = ZERO                                              
542200             CONTINUE                                                     
542300         WHEN SQLWARN0 NOT = SPACES                                       
542400         WHEN SQLCODE < ZERO                                              
542500         WHEN SQLCODE > ZERO                                              
542600             MOVE '9752-CLOSE-POE-CURSOR'                                 
542700                               TO DP013-PARAGRAPH                         
542800             MOVE 'CLOSE POE CURSOR '                                     
542900                               TO DP013-MESSAGE-TEXT (1)                  
543000             MOVE SQLCA        TO DP013-SQLCA                             
543100             MOVE 'TIMPOE  '   TO DP013-DB2-TABLE-NAME (1)                
543200             SET DP013-DB2-ABEND                                          
543300                 DP013-XCTL-DISPLAY-RESTART TO TRUE                       
543400             PERFORM 9999-SQL-ABEND                                       
543500     END-EVALUATE.                                                        
543600                                                                          
543700 EJECT                                                                    
543800*----------------------------------------------------------------*        
543900*    FETCH THE POE CODE CURSOR                                   *        
544000*----------------------------------------------------------------*        
544100 9754-FETCH-POE-CURSOR.                                                   
544200                                                                          
544300     EXEC SQL                                                             
544400          FETCH POE-CSR                                                   
544500          INTO  :IMPOE-POE-CDE                                            
544600     END-EXEC.                                                            
544700                                                                          
544800     EVALUATE TRUE                                                        
544900         WHEN SQLCODE = ZERO                                              
545000         WHEN SQLCODE = -811                                              
545100             CONTINUE                                                     
545200         WHEN SQLCODE = +100                                              
545300             SET PS-ERROR                                                 
545400                 PS-COMMAREA-NOT-VALID                                    
545500                 DP020-MSG-FATAL TO TRUE                                  
545600         WHEN SQLWARN0 NOT = SPACE                                        
545700         WHEN SQLCODE NOT = ZERO                                          
545800              MOVE '9754-FETCH-POE-CURSOR'                                
545900                               TO DP013-PARAGRAPH                         
546000              MOVE 'FETCH POE CURSOR'                                     
546100                               TO DP013-MESSAGE-TEXT (1)                  
546200              MOVE SQLCA       TO DP013-SQLCA                             
546300              SET DP013-DB2-ABEND                                         
546400                               TO TRUE                                    
546500              PERFORM 9999-SQL-ABEND                                      
546600     END-EVALUATE.                                                        
546700                                                                          
546800 EJECT                                                                    
546900*----------------------------------------------------------------*        
547000*  VALIDATE THE STORE NUMBER FROM SELECTION CRITERIA             *        
547100*----------------------------------------------------------------*        
547200                                                                          
547300 9760-VALIDATE-STORE.                                                     
547400                                                                          
547410         EXEC SQL                                                         
547420              SELECT COUNT(*)                                             
547430                INTO :PV-DB2-COUNT                                        
547440                FROM XLT_LOC                                              
547450               WHERE LOC_NBR = :TR195-STR-NBR                             
547460         END-EXEC.                                                        
548200                                                                          
548300         EVALUATE TRUE                                                    
548400             WHEN SQLCODE = +0                                            
548500             WHEN SQLCODE = +100                                          
548600             WHEN SQLCODE = -904                                          
548700             WHEN SQLCODE = -913                                          
548800                  CONTINUE                                                
548900                                                                          
549000             WHEN SQLWARN0 NOT = SPACES                                   
549100             WHEN SQLCODE < +0                                            
549200             WHEN SQLCODE > +0                                            
549300                  MOVE '9760-VALIDATE-STORE'                              
549400                                  TO DP013-PARAGRAPH                      
549500                  MOVE 'UNSUCCESSFUL COUNT ON STORE'                      
549600                                  TO DP013-MESSAGE-TEXT (1)               
549700                  MOVE SQLCA      TO DP013-SQLCA                          
549800                  MOVE 'XLT_LOC ' TO DP013-DB2-TABLE-NAME (1)             
549900                  SET DP013-DB2-ABEND                                     
550000                      DP013-XCTL-DISPLAY-RESTART                          
550100                                  TO TRUE                                 
550200              PERFORM 9999-SQL-ABEND                                      
550300         END-EVALUATE.                                                    
550400 EJECT                                                                    
550500*----------------------------------------------------------------*        
550600* CHECK IF PO HAS ANY STORE ALLOCATIONS                          *        
550700*----------------------------------------------------------------*        
550800                                                                          
550900 9770-CHECK-STORE-ALLOC.                                                  
551000                                                                          
551100     EXEC SQL                                                             
551200          SELECT COUNT(*)                                                 
551300            INTO :PV-DB2-COUNT                                            
551400            FROM TMESTDS                                                  
551500           WHERE PO_NBR  = :DK-PO-NBR                                     
551600             AND STR_NBR = :DK-STR-NBR                                    
551700     END-EXEC.                                                            
551800                                                                          
551900     EVALUATE TRUE                                                        
552000         WHEN SQLCODE = +0                                                
552100         WHEN SQLCODE = +100                                              
552200         WHEN SQLCODE = -904                                              
552300         WHEN SQLCODE = -913                                              
552400              CONTINUE                                                    
552500                                                                          
552600         WHEN SQLWARN0 NOT = SPACES                                       
552700         WHEN SQLCODE < +0                                                
552800         WHEN SQLCODE > +0                                                
552900              MOVE '9770-CHECK-STORE-ALLOC'                               
553000                              TO DP013-PARAGRAPH                          
553100              MOVE 'UNSUCCESSFUL SELECT STORE ALLOCATIONS '               
553200                              TO DP013-MESSAGE-TEXT (1)                   
553300              MOVE SQLCA      TO DP013-SQLCA                              
553400              MOVE 'TMESTDS ' TO DP013-DB2-TABLE-NAME (1)                 
553500              SET DP013-DB2-ABEND                                         
553600                  DP013-XCTL-DISPLAY-RESTART                              
553700                              TO TRUE                                     
553800              PERFORM 9999-SQL-ABEND                                      
553900     END-EVALUATE.                                                        
554000                                                                          
554100 EJECT                                                                    
554200*----------------------------------------------------------------*        
554300* CHECK IF PO OFFERS A PARTICULAR TYPE OF SERVICE                *        
554400*----------------------------------------------------------------*        
554500                                                                          
554600 9780-CHECK-SERVICE.                                                      
554700                                                                          
554800     EXEC SQL                                                             
554900          SELECT COUNT(*)                                                 
555000            INTO :PV-DB2-COUNT                                            
555100            FROM TPOAGMT                                                  
555200           WHERE PO_NBR         = :DK-PO-NBR                              
555300             AND AGRMT_TYP_ID   = :DK-AGRMT-TYP-ID                        
555400             AND VER_STATUS_CDE = 'A'                                     
555500             AND TYP_CDE        = :DK-TYP-CDE                             
555600     END-EXEC.                                                            
555700                                                                          
555800     EVALUATE TRUE                                                        
555900         WHEN SQLCODE = +0                                                
556000         WHEN SQLCODE = +100                                              
556100         WHEN SQLCODE = -904                                              
556200         WHEN SQLCODE = -913                                              
556300              CONTINUE                                                    
556400                                                                          
556500         WHEN SQLWARN0 NOT = SPACES                                       
556600         WHEN SQLCODE < +0                                                
556700         WHEN SQLCODE > +0                                                
556800              MOVE '9780-CHECK-SERVICE'                                   
556900                              TO DP013-PARAGRAPH                          
557000              MOVE 'UNSUCCESSFUL SELECT PURCHASE AGREEMENT'               
557100                              TO DP013-MESSAGE-TEXT (1)                   
557200              MOVE SQLCA      TO DP013-SQLCA                              
557300              MOVE 'TPOAGMT ' TO DP013-DB2-TABLE-NAME (1)                 
557400              SET DP013-DB2-ABEND                                         
557500                  DP013-XCTL-DISPLAY-RESTART                              
557600                              TO TRUE                                     
557700              PERFORM 9999-SQL-ABEND                                      
557800     END-EVALUATE.                                                        
557900                                                                          
558000 EJECT                                                                    
558100*----------------------------------------------------------------*        
558200*  READ BOOKING DATA                                             *        
558300*----------------------------------------------------------------*        
558400 9800-SELECT-BOOKING-DATA.                                                
558500         EXEC SQL                                                         
558600             SELECT MIN(DATE(PO_BKG_DELY_TMST))                           
558700             INTO                                                         
558800               :PV-BKNG-DELY-DT                                           
558900               :PV-BKNG-DELY-DT-NULL                                      
559000             FROM   TIMBKPO                                               
559100             WHERE  PO_NBR IN (:DK-PO-NBR)                                
559200             AND    DATE(PO_BKG_DELY_TMST)  <>                            
559300                            '0001-01-01'                                  
559400         END-EXEC.                                                        
559500                                                                          
559600     EVALUATE TRUE                                                        
559700         WHEN SQLCODE = ZERO                                              
559800         WHEN SQLCODE = -811                                              
559900             IF PV-BKNG-DELY-DT-NULL = 0                                  
560000              AND PV-BKNG-DELY-DT NOT = '0001-01-01'                      
560100                MOVE PV-BKNG-DELY-DT (1:4) TO                             
560200                                PV-SM-BKNG-DELY-DT(1:4)                   
560300                MOVE PV-BKNG-DELY-DT (6:2) TO                             
560400                                PV-SM-BKNG-DELY-DT(5:2)                   
560500                MOVE PV-BKNG-DELY-DT (9:2) TO                             
560600                                PV-SM-BKNG-DELY-DT(7:2)                   
560700             END-IF                                                       
560800         WHEN SQLWARN0 NOT = SPACES                                       
560900         WHEN SQLCODE < ZERO                                              
561000         WHEN SQLCODE > ZERO                                              
561100             MOVE '9800-SELECT-BOOKING-DATA'                              
561200                               TO DP013-PARAGRAPH                         
561300             MOVE 'SELECT DATA'                                           
561400                               TO DP013-MESSAGE-TEXT (1)                  
561500             MOVE SQLCA        TO DP013-SQLCA                             
561600             MOVE 'TIMBKPO'    TO DP013-DB2-TABLE-NAME (1)                
561700             SET DP013-DB2-ABEND                                          
561800                 DP013-XCTL-DISPLAY-RESTART TO TRUE                       
561900              PERFORM 9999-SQL-ABEND                                      
562000     END-EVALUATE.                                                        
562100 EJECT                                                                    
562200*----------------------------------------------------------------*        
562300*  READ IMPORT RECEIPT DATA                                      *        
562400*----------------------------------------------------------------*        
562500 9810-SELECT-RECEIPT-DATA.                                                
562600                                                                          
562700         EXEC SQL                                                         
562800             SELECT MIN(DATE(PO_RCVD_DELY_TMST))                          
562900             INTO                                                         
563000               :PV-ACTL-DELY-DT                                           
563100               :PV-ACTL-DELY-DT-NULL                                      
563200             FROM   TIMRCPO                                               
563300             WHERE  PO_NBR IN (:DK-PO-NBR)                                
563400             AND    DATE(PO_RCVD_DELY_TMST)  <>                           
563500                                '0001-01-01'                              
563600         END-EXEC.                                                        
563700                                                                          
563800     EVALUATE TRUE                                                        
563900         WHEN SQLCODE = ZERO                                              
564000         WHEN SQLCODE = -811                                              
564100             IF PV-ACTL-DELY-DT-NULL = 0                                  
564200              AND PV-ACTL-DELY-DT NOT = '0001-01-01'                      
564300                MOVE PV-ACTL-DELY-DT (1:4) TO                             
564400                                PV-SM-ACTL-DELY-DT(1:4)                   
564500                MOVE PV-ACTL-DELY-DT (6:2) TO                             
564600                                PV-SM-ACTL-DELY-DT(5:2)                   
564700                MOVE PV-ACTL-DELY-DT (9:2) TO                             
564800                                PV-SM-ACTL-DELY-DT(7:2)                   
564900             END-IF                                                       
565000         WHEN SQLWARN0 NOT = SPACES                                       
565100         WHEN SQLCODE < ZERO                                              
565200         WHEN SQLCODE > ZERO                                              
565300             MOVE '9810-SELECT-RECEIPT-DATA'                              
565400                               TO DP013-PARAGRAPH                         
565500             MOVE 'SELECT DATA'                                           
565600                               TO DP013-MESSAGE-TEXT (1)                  
565700             MOVE SQLCA        TO DP013-SQLCA                             
565800             MOVE 'TIMRCPO'      TO DP013-DB2-TABLE-NAME (1)              
565900             SET DP013-DB2-ABEND                                          
566000                 DP013-XCTL-DISPLAY-RESTART TO TRUE                       
566100              PERFORM 9999-SQL-ABEND                                      
566200     END-EVALUATE.                                                        
566300 EJECT                                                                    
566400*----------------------------------------------------------------*        
566500*    FETCH THE IMPORT CURSOR                                     *        
566600*----------------------------------------------------------------*        
566700                                                                          
566800 9820-SELECT-CONTAINER-DATA.                                              
566900                                                                          
567000     EXEC SQL                                                             
567100            SELECT MIN(T.MOM_DPRTR_DTE)                                   
567200                  ,MIN(T.MOM_POE_DELY_DTE)                                
567300                  ,MIN(T.ACTL_POE_DELY_DTE)                               
567400                  ,MIN(T.FDR_DPRTR_DTE)                                   
567500                  ,MIN(T.BKR_FRGT_RLSE_DTE)                               
567600            INTO                                                          
567700              :PV-IMPRT-DPRTR-DT                                          
567800              :PV-IMPRT-DPRTR-DT-NULL                                     
567900             ,:PV-IMPRT-POE-DELY-DT                                       
568000              :PV-IMPRT-POE-DELY-DT-NULL                                  
568100             ,:PV-IMPRT-ACT-DELY-DT                                       
568200              :PV-IMPRT-ACT-DELY-DT-NULL                                  
568300             ,:PV-FEEDER-DPRTR-DT                                         
568400              :PV-FEEDER-DPRTR-DT-NULL                                    
568500             ,:PV-IMPRT-BKR-FRGT-RLSE-DT                                  
568600              :PV-IMPRT-BKR-FRGT-RLSE-DT-NULL                             
568700            FROM (SELECT CASE                                             
568800                           WHEN DATE(B.MOM_DPRTR_TMST)                    
568900                                    = '0001-01-01'                        
569000                             THEN DATE('9999-09-09')                      
569100                           WHEN DATE(B.MOM_DPRTR_TMST)                    
569200                                   <> '0001-01-01'                        
569300                             THEN DATE(B.MOM_DPRTR_TMST)                  
569400                           END AS MOM_DPRTR_DTE                           
569500                        ,CASE                                             
569600                           WHEN DATE(B.MOM_POE_DELY_TMST)                 
569700                                    = '0001-01-01'                        
569800                             THEN DATE('9999-09-09')                      
569900                           WHEN DATE(B.MOM_POE_DELY_TMST)                 
570000                                   <> '0001-01-01'                        
570100                             THEN DATE(B.MOM_POE_DELY_TMST)               
570200                           END AS MOM_POE_DELY_DTE                        
570300                         ,CASE                                            
570400                           WHEN DATE(B.ACTL_POE_DELY_TMST)                
570500                                    = '0001-01-01'                        
570600                             THEN DATE('9999-09-09')                      
570700                           WHEN DATE(B.ACTL_POE_DELY_TMST)                
570800                                   <> '0001-01-01'                        
570900                             THEN DATE(B.ACTL_POE_DELY_TMST)              
571000                          END AS ACTL_POE_DELY_DTE                        
571100                         ,CASE                                            
571200                            WHEN DATE(B.FDR_DPRTR_TMST)                   
571300                                   = '0001-01-01'                         
571400                              THEN DATE('9999-09-09')                     
571500                            WHEN DATE(B.FDR_DPRTR_TMST)                   
571600                                  <> '0001-01-01'                         
571700                              THEN DATE(B.FDR_DPRTR_TMST)                 
571800                          END AS FDR_DPRTR_DTE                            
571900                         ,CASE                                            
572000                            WHEN DATE(B.BKR_FRGT_RLSE_TMST)               
572100                                   = '0001-01-01'                         
572200                              THEN DATE('9999-09-09')                     
572300                            WHEN DATE(B.BKR_FRGT_RLSE_TMST)               
572400                                  <> '0001-01-01'                         
572500                              THEN DATE(B.BKR_FRGT_RLSE_TMST)             
572600                          END AS BKR_FRGT_RLSE_DTE                        
572700                  FROM  TIMCNPO A                                         
572800                       ,TIMCNTK B                                         
572900                  WHERE A.PO_NBR         = :DK-PO-NBR                     
573000                  AND   A.CONTNR_ID      = B.CONTNR_ID                    
573100                  AND   A.CONTNR_SEQ_NBR =                                
573200                                 B.CONTNR_SEQ_NBR) AS T                   
573300     END-EXEC.                                                            
573400                                                                          
573500     EVALUATE TRUE                                                        
573600         WHEN SQLCODE = ZERO                                              
573700         WHEN SQLCODE = -811                                              
573800                                                                          
573900             IF (PV-IMPRT-DPRTR-DT-NULL = 0                               
574000              AND PV-FEEDER-DPRTR-DT-NULL = 0                             
574100               AND PV-FEEDER-DPRTR-DT NOT = '9999-09-09'                  
574200                AND PV-FEEDER-DPRTR-DT < PV-IMPRT-DPRTR-DT)               
574300                   OR (PV-FEEDER-DPRTR-DT-NULL = 0                        
574400                       AND PV-FEEDER-DPRTR-DT NOT = '9999-09-09'          
574500                         AND PV-IMPRT-DPRTR-DT-NULL = -1)                 
574600                           MOVE PV-FEEDER-DPRTR-DT TO                     
574700                                           PV-IMPRT-DPRTR-DT              
574800                           MOVE +0 TO PV-IMPRT-DPRTR-DT-NULL              
574900             END-IF                                                       
575000                                                                          
575100             IF PV-IMPRT-DPRTR-DT-NULL = 0                                
575200              AND PV-IMPRT-DPRTR-DT NOT = '9999-09-09'                    
575300                 MOVE PV-IMPRT-DPRTR-DT (1:4) TO                          
575400                               PV-SM-IMPRT-DPRTR-DT(1:4)                  
575500                 MOVE PV-IMPRT-DPRTR-DT (6:2) TO                          
575600                               PV-SM-IMPRT-DPRTR-DT(5:2)                  
575700                 MOVE PV-IMPRT-DPRTR-DT (9:2) TO                          
575800                               PV-SM-IMPRT-DPRTR-DT(7:2)                  
575900             END-IF                                                       
576000                                                                          
576100             IF PV-IMPRT-ACT-DELY-DT-NULL = 0                             
576200               AND PV-IMPRT-ACT-DELY-DT NOT = '9999-09-09'                
576300                MOVE PV-IMPRT-ACT-DELY-DT (1:4) TO                        
576400                            PV-SM-IMPRT-POE-DELY-DT(1:4)                  
576500                MOVE PV-IMPRT-ACT-DELY-DT (6:2) TO                        
576600                            PV-SM-IMPRT-POE-DELY-DT(5:2)                  
576700                MOVE PV-IMPRT-ACT-DELY-DT (9:2) TO                        
576800                            PV-SM-IMPRT-POE-DELY-DT(7:2)                  
576900                MOVE PC-DASH TO PV-WORK-ETA-ATA (1:1)                     
577000                MOVE PC-A    TO PV-WORK-ETA-ATA (2:1)                     
577100             ELSE                                                         
577200                IF PV-IMPRT-POE-DELY-DT-NULL = 0                          
577300                 AND PV-IMPRT-POE-DELY-DT NOT = '9999-09-09'              
577400                  MOVE PV-IMPRT-POE-DELY-DT (1:4) TO                      
577500                              PV-SM-IMPRT-POE-DELY-DT(1:4)                
577600                  MOVE PV-IMPRT-POE-DELY-DT (6:2) TO                      
577700                              PV-SM-IMPRT-POE-DELY-DT(5:2)                
577800                  MOVE PV-IMPRT-POE-DELY-DT (9:2) TO                      
577900                              PV-SM-IMPRT-POE-DELY-DT(7:2)                
578000                  MOVE PC-DASH TO PV-WORK-ETA-ATA (1:1)                   
578100                  MOVE PC-E    TO PV-WORK-ETA-ATA (2:1)                   
578200                END-IF                                                    
578300             END-IF                                                       
578400                                                                          
578500             IF PV-IMPRT-BKR-FRGT-RLSE-DT-NULL = 0                        
578600              AND PV-IMPRT-BKR-FRGT-RLSE-DT NOT = '9999-09-09'            
578700                 MOVE PV-IMPRT-BKR-FRGT-RLSE-DT (1:4) TO                  
578800                         PV-SM-BKR-FRGT-RLSE-DT(1:4)                      
578900                 MOVE PV-IMPRT-BKR-FRGT-RLSE-DT (6:2) TO                  
579000                         PV-SM-BKR-FRGT-RLSE-DT(5:2)                      
579100                 MOVE PV-IMPRT-BKR-FRGT-RLSE-DT (9:2) TO                  
579200                         PV-SM-BKR-FRGT-RLSE-DT(7:2)                      
579300             END-IF                                                       
579400                                                                          
579500         WHEN SQLCODE = +100                                              
579600             CONTINUE                                                     
579700         WHEN SQLWARN0 NOT = SPACE                                        
579800         WHEN SQLCODE NOT = ZERO                                          
579900              MOVE '9820-SELECT-CONTAINER-DATA'                           
580000                               TO DP013-PARAGRAPH                         
580100              MOVE 'SELECT CONTAINER DATA'                                
580200                               TO DP013-MESSAGE-TEXT (1)                  
580300              MOVE SQLCA       TO DP013-SQLCA                             
580400              MOVE 'TIMCNPO'   TO DP013-DB2-TABLE-NAME (1)                
580500              MOVE 'TIMCNTK'   TO DP013-DB2-TABLE-NAME (2)                
580600              SET DP013-DB2-ABEND                                         
580700                               TO TRUE                                    
580800              PERFORM 9999-SQL-ABEND                                      
580900     END-EVALUATE.                                                        
581000                                                                          
581100 EJECT                                                                    
581200*----------------------------------------------------------------*        
581300*  SELECT THE CONTAINER RELEASE DATE                             *        
581400*----------------------------------------------------------------*        
581500 9822-SELECT-CONTNR-RLSE-CDE.                                             
581600                                                                          
581700         EXEC SQL                                                         
581800             SELECT A.BKR_FRGT_RLSE_CDE                                   
581900               INTO                                                       
582000                   :IMCNPO-BKR-FRGT-RLSE-CDE                              
582100              FROM  TIMCNPO A                                             
582200                   ,TIMCNTK B                                             
582300             WHERE A.PO_NBR         = :DK-PO-NBR                          
582400               AND A.CONTNR_ID      = B.CONTNR_ID                         
582500               AND A.CONTNR_SEQ_NBR = B.CONTNR_SEQ_NBR                    
582600         END-EXEC.                                                        
582700*                                                                         
582800     EVALUATE TRUE                                                        
582900         WHEN SQLCODE = ZERO                                              
583000         WHEN SQLCODE = -811                                              
583100             IF IMCNPO-BKR-FRGT-RLSE-CDE = SPACES                         
583200                 SET PS-BKR-FRGT-RLSE-NO TO TRUE                          
583300             ELSE                                                         
583400                 SET PS-BKR-FRGT-RLSE TO TRUE                             
583500             END-IF                                                       
583600                                                                          
583700         WHEN SQLCODE = +100                                              
583800             SET PS-BKR-FRGT-RLSE-NO TO TRUE                              
583900                                                                          
584000         WHEN SQLWARN0 NOT = SPACES                                       
584100         WHEN SQLCODE < ZERO                                              
584200         WHEN SQLCODE > ZERO                                              
584300             MOVE '9822-SELECT-CONTNR-RLSE-CDE'                           
584400                               TO DP013-PARAGRAPH                         
584500             MOVE 'SELECT DATA'                                           
584600                               TO DP013-MESSAGE-TEXT (1)                  
584700             MOVE SQLCA        TO DP013-SQLCA                             
584800             MOVE 'TIMCNPO'      TO DP013-DB2-TABLE-NAME (1)              
584900             SET DP013-DB2-ABEND TO TRUE                                  
585000             PERFORM 9999-SQL-ABEND                                       
585100     END-EVALUATE.                                                        
585200                                                                          
585300 EJECT                                                                    
585400*----------------------------------------------------------------*        
585500*  SELECT THE CONTAINER ID                                       *        
585600*----------------------------------------------------------------*        
585700 9825-SELECT-CONTNR-ID.                                                   
585800                                                                          
585900         EXEC SQL                                                         
586000             SELECT A.CONTNR_ID                                           
586100               INTO                                                       
586200                   :PV-CONTNR-ID                                          
586300              FROM  TIMCNPO A                                             
586400             WHERE A.PO_NBR         = :DK-PO-NBR                          
586500         END-EXEC.                                                        
586600*                                                                         
586700     EVALUATE TRUE                                                        
586800         WHEN SQLCODE = ZERO                                              
586900             MOVE PV-CONTNR-ID TO PV-SM-CONTNR-ID                         
587000                                                                          
587100         WHEN SQLCODE = -811                                              
587200             MOVE PC-MULTI TO PV-SM-CONTNR-ID                             
587300                                                                          
587400         WHEN SQLCODE = +100                                              
587500             MOVE SPACES TO PV-SM-CONTNR-ID                               
587600                                                                          
587700         WHEN SQLWARN0 NOT = SPACES                                       
587800         WHEN SQLCODE < ZERO                                              
587900         WHEN SQLCODE > ZERO                                              
588000             MOVE '9825-SELECT-CONTNR-ID'                                 
588100                               TO DP013-PARAGRAPH                         
588200             MOVE 'SELECT DATA'                                           
588300                               TO DP013-MESSAGE-TEXT (1)                  
588400             MOVE SQLCA        TO DP013-SQLCA                             
588500             MOVE 'TIMCNTK'      TO DP013-DB2-TABLE-NAME (1)              
588600             SET DP013-DB2-ABEND TO TRUE                                  
588700             PERFORM 9999-SQL-ABEND                                       
588800     END-EVALUATE.                                                        
588900 EJECT                                                                    
589000*----------------------------------------------------------------*        
589100*    FETCH THE SHIP CURSOR                                       *        
589200*----------------------------------------------------------------*        
589300                                                                          
589400 9850-FETCH-DC-ETA-ATA-DATA.                                              
589500                                                                          
589600     MOVE '9999-09-09' TO PV-SHIP-ETA-DT.                                 
589700     MOVE '9999-09-09' TO PV-SHIP-STAT-DT.                                
589800     MOVE '9999-09-09' TO PV-SHIP-STAT-DT1.                               
589900     MOVE '9999-09-09' TO PV-SHIP-STAT-DT2.                               
590000                                                                          
590100     EXEC SQL                                                             
590200           FETCH SHIP_DATA_CSR                                            
590300           INTO                                                           
590400              :PV-SHIP-ETA-DT:PV-NULL-IND-1                               
590500             ,:PV-SHIP-STAT-DT1:PV-NULL-IND-2                             
590600             ,:PV-SHIP-STAT-DT2:PV-NULL-IND-3                             
590700             ,:PV-OPER-UNT-ID                                             
590800              :PV-OPER-UNT-ID-NULL                                        
590900     END-EXEC.                                                            
591000                                                                          
591100     EVALUATE TRUE                                                        
591200         WHEN SQLCODE = ZERO                                              
591300            IF PV-OPER-UNT-ID-NULL = 0                                    
591400                 IF PV-SHIP-STAT-DT1 = '9999-09-09'                       
591500                     MOVE PV-SHIP-STAT-DT2 TO PV-SHIP-STAT-DT             
591600                     MOVE PC-DASH TO PV-WORK-ETA-ATA (1:1)                
591700                     MOVE PC-A    TO PV-WORK-ETA-ATA (2:1)                
591800                 ELSE                                                     
591900                     MOVE PV-SHIP-STAT-DT1 TO PV-SHIP-STAT-DT             
592000                     MOVE PC-DASH TO PV-WORK-ETA-ATA (1:1)                
592100                     MOVE PC-A    TO PV-WORK-ETA-ATA (2:1)                
592200                 END-IF                                                   
592300                                                                          
592400                 IF PV-SHIP-STAT-DT = '9999-09-09'                        
592500                  AND PV-SHIP-ETA-DT NOT = '9999-09-09'                   
592600                   MOVE PV-SHIP-ETA-DT TO PV-SHIP-STAT-DT                 
592700                   MOVE PC-DASH TO PV-WORK-ETA-ATA (1:1)                  
592800                   MOVE PC-E    TO PV-WORK-ETA-ATA (2:1)                  
592900                 END-IF                                                   
593000                                                                          
593100                 IF PV-SHIP-STAT-DT NOT = '9999-09-09'                    
593200                   EVALUATE TRUE                                          
593300                     WHEN PV-OPER-UNT-ID = DC-STORE-NMBR(1)               
593400                      MOVE PV-SHIP-STAT-DT (1:4) TO                       
593500                              PV-SM-TRIP-ETA-DC1(1:4)                     
593600                      MOVE PV-SHIP-STAT-DT (6:2) TO                       
593700                              PV-SM-TRIP-ETA-DC1(5:2)                     
593800                      MOVE PV-SHIP-STAT-DT (9:2) TO                       
593900                              PV-SM-TRIP-ETA-DC1(7:2)                     
594000                      MOVE PV-WORK-ETA-ATA TO PV-WORK-ETA-ATA-DC1         
594100                     WHEN PV-OPER-UNT-ID = DC-STORE-NMBR(2)               
594200                      MOVE PV-SHIP-STAT-DT (1:4) TO                       
594300                              PV-SM-TRIP-ETA-DC2(1:4)                     
594400                      MOVE PV-SHIP-STAT-DT (6:2) TO                       
594500                              PV-SM-TRIP-ETA-DC2(5:2)                     
594600                      MOVE PV-SHIP-STAT-DT (9:2) TO                       
594700                              PV-SM-TRIP-ETA-DC2(7:2)                     
594800                      MOVE PV-WORK-ETA-ATA TO PV-WORK-ETA-ATA-DC2         
594900                     WHEN PV-OPER-UNT-ID = DC-STORE-NMBR(3)               
595000                      MOVE PV-SHIP-STAT-DT (1:4) TO                       
595100                              PV-SM-TRIP-ETA-DC3(1:4)                     
595200                      MOVE PV-SHIP-STAT-DT (6:2) TO                       
595300                              PV-SM-TRIP-ETA-DC3(5:2)                     
595400                      MOVE PV-SHIP-STAT-DT (9:2) TO                       
595500                              PV-SM-TRIP-ETA-DC3(7:2)                     
595600                      MOVE PV-WORK-ETA-ATA TO PV-WORK-ETA-ATA-DC3         
595700                     WHEN PV-OPER-UNT-ID = DC-STORE-NMBR(4)               
595800                      MOVE PV-SHIP-STAT-DT (1:4) TO                       
595900                              PV-SM-TRIP-ETA-DC4(1:4)                     
596000                      MOVE PV-SHIP-STAT-DT (6:2) TO                       
596100                              PV-SM-TRIP-ETA-DC4(5:2)                     
596200                      MOVE PV-SHIP-STAT-DT (9:2) TO                       
596300                              PV-SM-TRIP-ETA-DC4(7:2)                     
596400                      MOVE PV-WORK-ETA-ATA TO PV-WORK-ETA-ATA-DC4         
596500                     WHEN PV-OPER-UNT-ID = DC-STORE-NMBR(5)               
596600                      MOVE PV-SHIP-STAT-DT (1:4) TO                       
596700                              PV-SM-TRIP-ETA-DC5(1:4)                     
596800                      MOVE PV-SHIP-STAT-DT (6:2) TO                       
596900                              PV-SM-TRIP-ETA-DC5(5:2)                     
597000                      MOVE PV-SHIP-STAT-DT (9:2) TO                       
597100                              PV-SM-TRIP-ETA-DC5(7:2)                     
597200                      MOVE PV-WORK-ETA-ATA TO PV-WORK-ETA-ATA-DC5         
597300                     WHEN PV-OPER-UNT-ID = DC-STORE-NMBR(6)               
597400                      MOVE PV-SHIP-STAT-DT (1:4) TO                       
597500                              PV-SM-TRIP-ETA-DC6(1:4)                     
597600                      MOVE PV-SHIP-STAT-DT (6:2) TO                       
597700                              PV-SM-TRIP-ETA-DC6(5:2)                     
597800                      MOVE PV-SHIP-STAT-DT (9:2) TO                       
597900                              PV-SM-TRIP-ETA-DC6(7:2)                     
598000                      MOVE PV-WORK-ETA-ATA TO PV-WORK-ETA-ATA-DC6         
598100                     WHEN PV-OPER-UNT-ID = DC-STORE-NMBR(7)               
598200                      MOVE PV-SHIP-STAT-DT (1:4) TO                       
598300                              PV-SM-TRIP-ETA-DC7(1:4)                     
598400                      MOVE PV-SHIP-STAT-DT (6:2) TO                       
598500                              PV-SM-TRIP-ETA-DC7(5:2)                     
598600                      MOVE PV-SHIP-STAT-DT (9:2) TO                       
598700                              PV-SM-TRIP-ETA-DC7(7:2)                     
598800                      MOVE PV-WORK-ETA-ATA TO PV-WORK-ETA-ATA-DC7         
598900                     WHEN PV-OPER-UNT-ID = DC-STORE-NMBR(8)               
599000                      MOVE PV-SHIP-STAT-DT (1:4) TO                       
599100                              PV-SM-TRIP-ETA-DC8(1:4)                     
599200                      MOVE PV-SHIP-STAT-DT (6:2) TO                       
599300                              PV-SM-TRIP-ETA-DC8(5:2)                     
599400                      MOVE PV-SHIP-STAT-DT (9:2) TO                       
599500                              PV-SM-TRIP-ETA-DC8(7:2)                     
599600                      MOVE PV-WORK-ETA-ATA TO PV-WORK-ETA-ATA-DC8         
599700                     WHEN PV-OPER-UNT-ID = DC-STORE-NMBR(9)               
599800                      MOVE PV-SHIP-STAT-DT (1:4) TO                       
599900                              PV-SM-TRIP-ETA-DC9(1:4)                     
600000                      MOVE PV-SHIP-STAT-DT (6:2) TO                       
600100                              PV-SM-TRIP-ETA-DC9(5:2)                     
600200                      MOVE PV-SHIP-STAT-DT (9:2) TO                       
600300                              PV-SM-TRIP-ETA-DC9(7:2)                     
600400                      MOVE PV-WORK-ETA-ATA TO PV-WORK-ETA-ATA-DC9         
600500                     WHEN PV-OPER-UNT-ID = DC-STORE-NMBR(10)              
600600                      MOVE PV-SHIP-STAT-DT (1:4) TO                       
600700                              PV-SM-TRIP-ETA-DC10(1:4)                    
600800                      MOVE PV-SHIP-STAT-DT (6:2) TO                       
600900                              PV-SM-TRIP-ETA-DC10(5:2)                    
601000                      MOVE PV-SHIP-STAT-DT (9:2) TO                       
601100                              PV-SM-TRIP-ETA-DC10(7:2)                    
601200                      MOVE PV-WORK-ETA-ATA TO PV-WORK-ETA-ATA-DC10        
601300                     WHEN PV-OPER-UNT-ID = DC-STORE-NMBR(11)              
601400                      MOVE PV-SHIP-STAT-DT (1:4) TO                       
601500                              PV-SM-TRIP-ETA-DC11(1:4)                    
601600                      MOVE PV-SHIP-STAT-DT (6:2) TO                       
601700                              PV-SM-TRIP-ETA-DC11(5:2)                    
601800                      MOVE PV-SHIP-STAT-DT (9:2) TO                       
601900                              PV-SM-TRIP-ETA-DC11(7:2)                    
602000                      MOVE PV-WORK-ETA-ATA TO PV-WORK-ETA-ATA-DC11        
602100                     WHEN PV-OPER-UNT-ID = DC-STORE-NMBR(12)              
602200                      MOVE PV-SHIP-STAT-DT (1:4) TO                       
602300                              PV-SM-TRIP-ETA-DC12(1:4)                    
602400                      MOVE PV-SHIP-STAT-DT (6:2) TO                       
602500                              PV-SM-TRIP-ETA-DC12(5:2)                    
602600                      MOVE PV-SHIP-STAT-DT (9:2) TO                       
602700                              PV-SM-TRIP-ETA-DC12(7:2)                    
602800                      MOVE PV-WORK-ETA-ATA TO PV-WORK-ETA-ATA-DC12        
602900                   END-EVALUATE                                           
603000                 END-IF                                                   
603100            END-IF                                                        
603200         WHEN SQLCODE = +100                                              
603300              SET NO-MORE-CURSOR-DATA  TO TRUE                            
603400         WHEN SQLWARN0 NOT = SPACE                                        
603500         WHEN SQLCODE NOT = ZERO                                          
603600                 MOVE '9850-FETCH-DC-ETA-ATA-DATA'                        
603700                                  TO DP013-PARAGRAPH                      
603800                 MOVE 'FETCH SHIP CURSOR'                                 
603900                                  TO DP013-MESSAGE-TEXT (1)               
604000                 MOVE SQLCA       TO DP013-SQLCA                          
604100                 SET DP013-DB2-ABEND                                      
604200                                  TO TRUE                                 
604300                 PERFORM 9999-SQL-ABEND                                   
604400     END-EVALUATE.                                                        
604500 EJECT                                                                    
604600*----------------------------------------------------------------*        
604700*  LOAD STORE NUMBER                                             *        
604800*----------------------------------------------------------------*        
604900                                                                          
605000 9860-OPEN-STORE-CURSOR.                                                  
605100                                                                          
605200         EXEC SQL                                                         
605300             OPEN STORE_CSR                                               
605400         END-EXEC.                                                        
605500                                                                          
605600         EVALUATE TRUE                                                    
605700             WHEN SQLCODE = ZERO                                          
605800             WHEN SQLCODE = -904                                          
605900             WHEN SQLCODE = -913                                          
606000                 CONTINUE                                                 
606100             WHEN SQLWARN0 NOT = SPACES                                   
606200             WHEN SQLCODE < ZERO                                          
606300             WHEN SQLCODE > ZERO                                          
606400                 MOVE '9860-OPEN-CURSOR'                                  
606500                                   TO DP013-PARAGRAPH                     
606600                 MOVE 'OPEN CURSOR - '                                    
606700                                   TO DP013-MESSAGE-TEXT (1)              
606800                 MOVE SQLCA        TO DP013-SQLCA                         
606900                 MOVE 'XLT_LOC'    TO DP013-DB2-TABLE-NAME (1)            
607000                 SET DP013-DB2-ABEND                                      
607100                     DP013-XCTL-DISPLAY-RESTART TO TRUE                   
607200                 PERFORM 9999-SQL-ABEND                                   
607300         END-EVALUATE.                                                    
607400 EJECT                                                                    
607500*----------------------------------------------------------------*        
607600*    FETCH THE STORE CURSOR                                      *        
607700*----------------------------------------------------------------*        
607800                                                                          
607900 9870-FETCH-STORE.                                                        
608000                                                                          
608100     EXEC SQL                                                             
608200        FETCH STORE_CSR                                                   
608300        INTO                                                              
608310           :XLT00010-LOC-NBR                                              
608320          ,:XLT00010-LOC-5-ABBR-NM                                        
608600     END-EXEC                                                             
608700                                                                          
608800     EVALUATE TRUE                                                        
608900         WHEN SQLCODE = ZERO                                              
609000           ADD +1 TO PV-DC-I                                              
609100           IF PV-DC-I < PC-DCSTORE-LIMIT                                  
609200            OR PV-DC-I = PC-DCSTORE-LIMIT                                 
609610              MOVE XLT00010-LOC-NBR TO                                    
609620                          DC-STORE-NMBR(PV-DC-I)                          
609630              MOVE XLT00010-LOC-5-ABBR-NM TO                              
609640                          DC-STORE-NAME(PV-DC-I)                          
609700           ELSE                                                           
609800             SET NO-MORE-STORE-DATA  TO TRUE                              
609900           END-IF                                                         
610000         WHEN SQLCODE = +100                                              
610100           SET NO-MORE-STORE-DATA  TO TRUE                                
610200         WHEN SQLWARN0 NOT = SPACE                                        
610300         WHEN SQLCODE NOT = ZERO                                          
610400              MOVE '9870-FETCH-STORE'                                     
610500                               TO DP013-PARAGRAPH                         
610600              MOVE 'FETCH STORE CURSOR'                                   
610700                               TO DP013-MESSAGE-TEXT (1)                  
610800              MOVE SQLCA       TO DP013-SQLCA                             
610900              SET DP013-DB2-ABEND                                         
611000                               TO TRUE                                    
611100              PERFORM 9999-SQL-ABEND                                      
611200     END-EVALUATE.                                                        
611300*                                                                         
611400 EJECT                                                                    
611500*----------------------------------------------------------------*        
611600*  LOAD STORE NUMBER                                             *        
611700*----------------------------------------------------------------*        
611800                                                                          
611900 9880-CLOSE-STORE-CURSOR.                                                 
612000                                                                          
612100         EXEC SQL                                                         
612200             CLOSE STORE_CSR                                              
612300         END-EXEC.                                                        
612400                                                                          
612500         EVALUATE TRUE                                                    
612600             WHEN SQLCODE = ZERO                                          
612700             WHEN SQLCODE = -904                                          
612800             WHEN SQLCODE = -913                                          
612900                 CONTINUE                                                 
613000             WHEN SQLWARN0 NOT = SPACES                                   
613100             WHEN SQLCODE < ZERO                                          
613200             WHEN SQLCODE > ZERO                                          
613300                 MOVE '9880-CLOSE-CURSOR'                                 
613400                                   TO DP013-PARAGRAPH                     
613500                 MOVE 'CLOSE CURSOR - '                                   
613600                                   TO DP013-MESSAGE-TEXT (1)              
613700                 MOVE SQLCA        TO DP013-SQLCA                         
613800                 MOVE 'XLT_LOC'    TO DP013-DB2-TABLE-NAME (1)            
613900                 SET DP013-DB2-ABEND                                      
614000                     DP013-XCTL-DISPLAY-RESTART TO TRUE                   
614100                 PERFORM 9999-SQL-ABEND                                   
614200         END-EVALUATE.                                                    
614300 EJECT                                                                    
614400*----------------------------------------------------------------*        
614500*  DETERMINE CUSTOMS RELEASE DATE                                *        
614600*----------------------------------------------------------------*        
614700                                                                          
614800 9890-LOAD-CUSTOMS-DATA.                                                  
614900                                                                          
615000     EXEC SQL                                                             
615100          SELECT MIN(DATE(A.ACTL_CLR_TMST))                               
615200            INTO :PV-ACTL-CLR-DATE:PV-ACTL-CLR-DATE-NULL                  
615300            FROM TIMCSEN A                                                
615400                ,TIMCSPO B                                                
615500           WHERE B.PO_NBR        = :DK-PO-NBR                             
615600           AND   A.CSTM_ENTR_ID = B.CSTM_ENTR_ID                          
615700     END-EXEC.                                                            
615800                                                                          
615900     EVALUATE TRUE                                                        
616000         WHEN SQLCODE = +0                                                
616100         WHEN SQLCODE = -811                                              
616200             IF PV-ACTL-CLR-DATE-NULL = 0                                 
616300              AND PV-ACTL-CLR-DATE NOT = '0001-01-01'                     
616400                 MOVE PV-ACTL-CLR-DATE (1:4) TO                           
616500                                PV-SM-ACTL-CLR-DATE(1:4)                  
616600                 MOVE PV-ACTL-CLR-DATE (6:2) TO                           
616700                                PV-SM-ACTL-CLR-DATE(5:2)                  
616800                 MOVE PV-ACTL-CLR-DATE (9:2) TO                           
616900                                PV-SM-ACTL-CLR-DATE(7:2)                  
617000              ELSE                                                        
617100                  MOVE SPACES     TO PV-SM-ACTL-CLR-DATE                  
617200             END-IF                                                       
617300         WHEN SQLCODE = +100                                              
617400         WHEN SQLCODE = -904                                              
617500         WHEN SQLCODE = -913                                              
617600              CONTINUE                                                    
617700         WHEN SQLWARN0 NOT = SPACES                                       
617800         WHEN SQLCODE < +0                                                
617900         WHEN SQLCODE > +0                                                
618000              MOVE '9890-LOAD-CUSTOMS-DATA'                               
618100                              TO DP013-PARAGRAPH                          
618200              MOVE 'UNSUCCESSFUL SELECT IN-PROCESS'                       
618300                              TO DP013-MESSAGE-TEXT (1)                   
618400              MOVE SQLCA      TO DP013-SQLCA                              
618500              MOVE 'TIMCSEN ' TO DP013-DB2-TABLE-NAME (1)                 
618600              MOVE 'TIMCSPO ' TO DP013-DB2-TABLE-NAME (2)                 
618700              SET DP013-DB2-ABEND                                         
618800                  DP013-XCTL-DISPLAY-RESTART                              
618900                              TO TRUE                                     
619000              PERFORM 9999-SQL-ABEND                                      
619100     END-EVALUATE.                                                        
619200 EJECT                                                                    
619300*----------------------------------------------------------------*        
619400*  DETERMINE DEVAN DATE                                          *        
619500*----------------------------------------------------------------*        
619600                                                                          
619700 9895-SELECT-DEVAN-DATA.                                                  
619800                                                                          
619900                                                                          
620000       EXEC SQL                                                           
620100            SELECT MIN(DATE(A.DVN_TMST))                                  
620200            INTO                                                          
620300              :PV-DEVAN-DT:PV-DEVAN-DT-NULL                               
620400            FROM  TIMCNTK A                                               
620500                 ,TIMCNPO B                                               
620600            WHERE B.PO_NBR         =  :DK-PO-NBR                          
620700              AND A.CONTNR_ID      =  B.CONTNR_ID                         
620800              AND A.CONTNR_SEQ_NBR =  B.CONTNR_SEQ_NBR                    
620900              AND DATE(A.DVN_TMST) <> '0001-01-01'                        
621000              AND B.DVN_CDE =         :PC-Y                               
621100       END-EXEC.                                                          
621200                                                                          
621300     EVALUATE TRUE                                                        
621400         WHEN SQLCODE = +0                                                
621500         WHEN SQLCODE = -811                                              
621600              IF PV-DEVAN-DT-NULL = 0                                     
621700                  MOVE PV-DEVAN-DT (1:4) TO                               
621800                                PV-SM-DEVAN-DT(1:4)                       
621900                  MOVE PV-DEVAN-DT (6:2) TO                               
622000                                PV-SM-DEVAN-DT(5:2)                       
622100                  MOVE PV-DEVAN-DT (9:2) TO                               
622200                                PV-SM-DEVAN-DT(7:2)                       
622300              END-IF                                                      
622400         WHEN SQLCODE = +100                                              
622500         WHEN SQLCODE = -904                                              
622600         WHEN SQLCODE = -913                                              
622700              CONTINUE                                                    
622800         WHEN SQLWARN0 NOT = SPACES                                       
622900         WHEN SQLCODE < +0                                                
623000         WHEN SQLCODE > +0                                                
623100              MOVE '9895-SELECT-DEVAN-DATA'                               
623200                              TO DP013-PARAGRAPH                          
623300              MOVE 'UNSUCCESSFUL SELECT IN-PROCESS'                       
623400                              TO DP013-MESSAGE-TEXT (1)                   
623500              MOVE SQLCA      TO DP013-SQLCA                              
623600              MOVE 'TIMCNTK ' TO DP013-DB2-TABLE-NAME (1)                 
623700              MOVE 'TIMCNPO ' TO DP013-DB2-TABLE-NAME (2)                 
623800              SET DP013-DB2-ABEND                                         
623900                  DP013-XCTL-DISPLAY-RESTART                              
624000                              TO TRUE                                     
624100              PERFORM 9999-SQL-ABEND                                      
624200     END-EVALUATE.                                                        
624300 EJECT                                                                    
624400*---------------------------------------------------------------*         
624500*  CURSOR TO PULL BACK DATA BY PO NUMBER SELECTION                        
624600*---------------------------------------------------------------*         
624700                                                                          
624800 9900-LOAD-PO-DETAILS.                                                    
624900                                                                          
625000     INITIALIZE PV-SCREEN-DATA-ITEMS                                      
625100     REPLACING NUMERIC BY ZEROS                                           
625200               ALPHANUMERIC BY SPACES.                                    
625300                                                                          
625400         EXEC SQL                                                         
625500                SELECT DISTINCT M.PO_NBR                                  
625600                      ,M.STATUS_CDE                                       
625700                      ,M.PO_TYP_CDE                                       
625800                      ,M.DEPT_NBR                                         
625900                      ,M.ENT_ID                                           
626000                      ,O.DONT_SHIP_BEF_DTE                                
626100                      ,O.STRT_FCTRY_DTE                                   
626200                      ,O.LAST_FCTRY_DTE                                   
626300                      ,O.CAN_IFNOT_SHIP_DTE                               
626400                      ,O.EXT_CAN_DTE                                      
626500                      ,O.FOB_CDE                                          
626600                      ,O.POE_CDE                                          
626700                      ,M.OTB_PER_NBR                                      
626800                      ,M.EDI_IND                                          
626900                      ,M.PKGNG_CDE                                        
627000                      ,M.QTA_CTG_CDE                                      
627100                  INTO                                                    
627200                     :PURCHS-PO-NBR                                       
627300                    ,:PURCHS-STATUS-CDE                                   
627400                    ,:PURCHS-PO-TYP-CDE                                   
627500                    ,:PURCHS-DEPT-NBR                                     
627600                    ,:PURCHS-ENT-ID                                       
627700                    ,:PLNSHP-DONT-SHIP-BEF-DTE                            
627800                    ,:PLNSHP-STRT-FCTRY-DTE                               
627900                    ,:PLNSHP-LAST-FCTRY-DTE                               
628000                    ,:PLNSHP-CAN-IFNOT-SHIP-DTE                           
628100                    ,:PLNSHP-EXT-CAN-DTE                                  
628200                    ,:PLNSHP-FOB-CDE                                      
628300                    ,:PLNSHP-POE-CDE                                      
628400                    ,:PURCHS-OTB-PER-NBR                                  
628500                    ,:PURCHS-EDI-IND                                      
628600                    ,:PURCHS-PKGNG-CDE                                    
628700                    ,:PURCHS-QTA-CTG-CDE                                  
628800                  FROM   TPURCHS M                                        
628900                        ,TPLNSHP O                                        
629000                  WHERE  M.PO_NBR = :DK-PO-NBR                            
629100                  AND    M.PO_NBR  = O.PO_NBR                             
629200                  AND    M.VER_STATUS_CDE  = 'A'                          
629300                  AND    O.VER_STATUS_CDE  = 'A'                          
629400         END-EXEC.                                                        
629500                                                                          
629600         EVALUATE TRUE                                                    
629700          WHEN SQLCODE = +0                                               
629800          WHEN SQLCODE = -811                                             
629900           MOVE ZEROES TO PV-PURCHS-DEPT                                  
630000           MOVE PURCHS-DEPT-NBR           TO PV-DEPT                      
630100                                             PV-PURCHS-DEPT-X-2           
630200           MOVE PV-PURCHS-DEPT-9          TO PVS-DEPT-9                   
630300          WHEN SQLCODE = +100                                             
630400          WHEN SQLCODE = -904                                             
630500          WHEN SQLCODE = -913                                             
630600               CONTINUE                                                   
630700          WHEN SQLWARN0 NOT = SPACES                                      
630800          WHEN SQLCODE < +0                                               
630900          WHEN SQLCODE > +0                                               
631000                  MOVE '9900-LOAD-PO-DETAILS'                             
631100                                  TO DP013-PARAGRAPH                      
631200                  MOVE 'UNSUCCESSFUL FETCH OF PO DETAILS'                 
631300                                  TO DP013-MESSAGE-TEXT (1)               
631400                  MOVE SQLCA      TO DP013-SQLCA                          
631500                  MOVE 'TPURCHS ' TO DP013-DB2-TABLE-NAME (1)             
631600                  MOVE 'TPLNSHP ' TO DP013-DB2-TABLE-NAME (2)             
631700                  SET DP013-DB2-ABEND                                     
631800                      DP013-XCTL-DISPLAY-RESTART                          
631900                                  TO TRUE                                 
632000                  PERFORM 9999-SQL-ABEND                                  
632100         END-EVALUATE.                                                    
632200                                                                          
632300 EJECT                                                                    
632400*----------------------------------------------------------------*        
632500*  DETERMINE TRIP TYPE FROM CUSTOMS PO TABLE                     *        
632600*----------------------------------------------------------------*        
632700 9905-LOAD-TRIP-TYPE-DATA.                                                
632800                                                                          
632900     EXEC SQL                                                             
633000          SELECT MIN(DATE(A.FILD_TMST))                                   
633100            INTO :PV-FILD-DATE:PV-FILD-DATE-NULL                          
633200            FROM TIMCSEN A                                                
633300                ,TIMCSPO B                                                
633400           WHERE B.PO_NBR       = :DK-PO-NBR                              
633500           AND   A.CSTM_ENTR_ID = B.CSTM_ENTR_ID                          
633600     END-EXEC.                                                            
633700                                                                          
633800     EVALUATE TRUE                                                        
633900         WHEN SQLCODE = +0                                                
634000         WHEN SQLCODE = -811                                              
634100             IF PV-FILD-DATE > SPACES                                     
634200                 PERFORM 9906-LOAD-TRIP-TYPE-DATA-2                       
634300             ELSE                                                         
634400                 PERFORM 9907-LOAD-TRIP-TYPE-CNTR-1                       
634500             END-IF                                                       
634600         WHEN SQLCODE = +100                                              
634700                 PERFORM 9907-LOAD-TRIP-TYPE-CNTR-1                       
634800         WHEN SQLCODE = -904                                              
634900         WHEN SQLCODE = -913                                              
635000              CONTINUE                                                    
635100         WHEN SQLWARN0 NOT = SPACES                                       
635200         WHEN SQLCODE < +0                                                
635300         WHEN SQLCODE > +0                                                
635400              MOVE '9905-LOAD-TRIP-TYPE-DATA'                             
635500                              TO DP013-PARAGRAPH                          
635600              MOVE 'UNSUCCESSFUL SELECT IN-PROCESS'                       
635700                              TO DP013-MESSAGE-TEXT (1)                   
635800              MOVE SQLCA      TO DP013-SQLCA                              
635900              MOVE 'TIMCSEN ' TO DP013-DB2-TABLE-NAME (1)                 
636000              MOVE 'TIMCSPO ' TO DP013-DB2-TABLE-NAME (2)                 
636100              SET DP013-DB2-ABEND                                         
636200                  DP013-XCTL-DISPLAY-RESTART                              
636300                              TO TRUE                                     
636400              PERFORM 9999-SQL-ABEND                                      
636500     END-EVALUATE.                                                        
636600 EJECT                                                                    
636700*----------------------------------------------------------------*        
636800*  DETERMINE TRIP TYPE                                           *        
636900*----------------------------------------------------------------*        
637000 9906-LOAD-TRIP-TYPE-DATA-2.                                              
637100                                                                          
637200                                                                          
637300     EXEC SQL                                                             
637400          SELECT A.MOM_TRIP_TYP_CDE                                       
637500            INTO :PV-TRIP-TYP-CDE                                         
637600            FROM TIMCSEN A                                                
637700                ,TIMCSPO B                                                
637800           WHERE B.PO_NBR             = :DK-PO-NBR                        
637900           AND   A.CSTM_ENTR_ID       = B.CSTM_ENTR_ID                    
638000           AND   DATE(A.FILD_TMST)    = :PV-FILD-DATE                     
638100     END-EXEC                                                             
638200                                                                          
638300     EVALUATE TRUE                                                        
638400         WHEN SQLCODE = +0                                                
638500         WHEN SQLCODE = -811                                              
638600             IF PV-TRIP-TYP-CDE = PC-A                                    
638700                 MOVE PC-AIR TO PV-TRIP-TYP-CDE-FULL                      
638800             ELSE                                                         
638900                 IF PV-TRIP-TYP-CDE = PC-O                                
639000                     MOVE PC-OCEAN TO PV-TRIP-TYP-CDE-FULL                
639100                 ELSE                                                     
639200                     PERFORM 9907-LOAD-TRIP-TYPE-CNTR-1                   
639300                 END-IF                                                   
639400             END-IF                                                       
639500         WHEN SQLCODE = +100                                              
639600         WHEN SQLCODE = -904                                              
639700         WHEN SQLCODE = -913                                              
639800              CONTINUE                                                    
639900         WHEN SQLWARN0 NOT = SPACES                                       
640000         WHEN SQLCODE < +0                                                
640100         WHEN SQLCODE > +0                                                
640200              MOVE '9906-LOAD-TRIP-TYPE-DATA-2'                           
640300                              TO DP013-PARAGRAPH                          
640400              MOVE 'UNSUCCESSFUL SELECT IN-PROCESS'                       
640500                              TO DP013-MESSAGE-TEXT (1)                   
640600              MOVE SQLCA      TO DP013-SQLCA                              
640700              MOVE 'TIMCSEN ' TO DP013-DB2-TABLE-NAME (1)                 
640800              MOVE 'TIMCSPO ' TO DP013-DB2-TABLE-NAME (2)                 
640900              SET DP013-DB2-ABEND                                         
641000                  DP013-XCTL-DISPLAY-RESTART                              
641100                              TO TRUE                                     
641200              PERFORM 9999-SQL-ABEND                                      
641300     END-EVALUATE.                                                        
641400 EJECT                                                                    
641500*----------------------------------------------------------------*        
641600*  DETERMINE TRIP TYPE FROM CONTAINER TABLE                      *        
641700*----------------------------------------------------------------*        
641800 9907-LOAD-TRIP-TYPE-CNTR-1.                                              
641900                                                                          
642000     EXEC SQL                                                             
642100          SELECT MIN(DATE(A.MOM_DPRTR_TMST))                              
642200               , MIN(DATE(A.FDR_DPRTR_TMST))                              
642300            INTO :PV-MOM-DPRTR-DATE:PV-MOM-DPRTR-DATE-NULL                
642400               , :PV-FDR-DPRTR-DATE:PV-FDR-DPRTR-DATE-NULL                
642500            FROM TIMCNTK A                                                
642600                ,TIMCNPO B                                                
642700           WHERE B.PO_NBR         = :DK-PO-NBR                            
642800           AND   A.CONTNR_ID      = B.CONTNR_ID                           
642900           AND   A.CONTNR_SEQ_NBR = B.CONTNR_SEQ_NBR                      
643000     END-EXEC.                                                            
643100                                                                          
643200     EVALUATE TRUE                                                        
643300         WHEN SQLCODE = +0                                                
643400         WHEN SQLCODE = -811                                              
643500                 IF (PV-MOM-DPRTR-DATE > '0001-01-01' AND                 
643600                     PV-FDR-DPRTR-DATE = '0001-01-01')       OR           
643700                    (PV-MOM-DPRTR-DATE > '0001-01-01' AND                 
643800                     PV-MOM-DPRTR-DATE < PV-FDR-DPRTR-DATE)               
643900                      PERFORM 9908-LOAD-TRIP-TYPE-CNTR-2                  
644000                 ELSE                                                     
644100                 IF (PV-FDR-DPRTR-DATE > '0001-01-01' AND                 
644200                     PV-MOM-DPRTR-DATE = '0001-01-01')       OR           
644300                    (PV-FDR-DPRTR-DATE > '0001-01-01' AND                 
644400                     PV-FDR-DPRTR-DATE < PV-MOM-DPRTR-DATE)               
644500                      PERFORM 9909-LOAD-TRIP-TYPE-CNTR-3                  
644600                 ELSE                                                     
644700                 IF (PV-MOM-DPRTR-DATE = '0001-01-01' AND                 
644800                     PV-FDR-DPRTR-DATE = '0001-01-01')                    
644900                      MOVE SPACES TO PV-TRIP-TYP-CDE-FULL                 
645000                 END-IF                                                   
645100                 END-IF                                                   
645200                 END-IF                                                   
645300         WHEN SQLCODE = +100                                              
645400             MOVE SPACES TO PV-TRIP-TYP-CDE-FULL                          
645500         WHEN SQLCODE = -904                                              
645600         WHEN SQLCODE = -913                                              
645700              CONTINUE                                                    
645800         WHEN SQLWARN0 NOT = SPACES                                       
645900         WHEN SQLCODE < +0                                                
646000         WHEN SQLCODE > +0                                                
646100              MOVE '9907-LOAD-TRIP-TYPE-CNTR-1'                           
646200                              TO DP013-PARAGRAPH                          
646300              MOVE 'UNSUCCESSFUL SELECT IN-PROCESS'                       
646400                              TO DP013-MESSAGE-TEXT (1)                   
646500              MOVE SQLCA      TO DP013-SQLCA                              
646600              MOVE 'TIMCNTK ' TO DP013-DB2-TABLE-NAME (1)                 
646700              MOVE 'TIMCSPO ' TO DP013-DB2-TABLE-NAME (2)                 
646800              SET DP013-DB2-ABEND                                         
646900                  DP013-XCTL-DISPLAY-RESTART                              
647000                              TO TRUE                                     
647100              PERFORM 9999-SQL-ABEND                                      
647200     END-EVALUATE.                                                        
647300 EJECT                                                                    
647400*----------------------------------------------------------------*        
647500*  DETERMINE TRIP TYPE                                           *        
647600*----------------------------------------------------------------*        
647700 9908-LOAD-TRIP-TYPE-CNTR-2.                                              
647800                                                                          
647900     EXEC SQL                                                             
648000          SELECT A.MOM_TRIP_TYP_CDE                                       
648100            INTO :PV-TRIP-TYP-CDE                                         
648200            FROM TIMCNTK A                                                
648300                ,TIMCNPO B                                                
648400           WHERE B.PO_NBR               = :DK-PO-NBR                      
648500           AND   A.CONTNR_ID            = B.CONTNR_ID                     
648600           AND   A.CONTNR_SEQ_NBR       = B.CONTNR_SEQ_NBR                
648700           AND   DATE(A.MOM_DPRTR_TMST) = :PV-MOM-DPRTR-DATE              
648800     END-EXEC.                                                            
648900                                                                          
649000     EVALUATE TRUE                                                        
649100         WHEN SQLCODE = +0                                                
649200         WHEN SQLCODE = -811                                              
649300             IF PV-TRIP-TYP-CDE = PC-A                                    
649400                 MOVE PC-AIR TO PV-TRIP-TYP-CDE-FULL                      
649500             ELSE                                                         
649600                 IF PV-TRIP-TYP-CDE = PC-O                                
649700                     MOVE PC-OCEAN TO PV-TRIP-TYP-CDE-FULL                
649800                 ELSE                                                     
649900                     MOVE SPACES TO PV-TRIP-TYP-CDE-FULL                  
650000                 END-IF                                                   
650100             END-IF                                                       
650200         WHEN SQLCODE = +100                                              
650300         WHEN SQLCODE = -904                                              
650400         WHEN SQLCODE = -913                                              
650500              CONTINUE                                                    
650600         WHEN SQLWARN0 NOT = SPACES                                       
650700         WHEN SQLCODE < +0                                                
650800         WHEN SQLCODE > +0                                                
650900              MOVE '9908-LOAD-TRIP-TYPE-CNTR-2'                           
651000                              TO DP013-PARAGRAPH                          
651100              MOVE 'UNSUCCESSFUL SELECT IN-PROCESS'                       
651200                              TO DP013-MESSAGE-TEXT (1)                   
651300              MOVE SQLCA      TO DP013-SQLCA                              
651400              MOVE 'TIMCNTK ' TO DP013-DB2-TABLE-NAME (1)                 
651500              MOVE 'TIMCNPO ' TO DP013-DB2-TABLE-NAME (2)                 
651600              SET DP013-DB2-ABEND                                         
651700                  DP013-XCTL-DISPLAY-RESTART                              
651800                              TO TRUE                                     
651900              PERFORM 9999-SQL-ABEND                                      
652000     END-EVALUATE.                                                        
652100 EJECT                                                                    
652200*----------------------------------------------------------------*        
652300*  DETERMINE TRIP TYPE                                           *        
652400*----------------------------------------------------------------*        
652500 9909-LOAD-TRIP-TYPE-CNTR-3.                                              
652600                                                                          
652700                                                                          
652800     EXEC SQL                                                             
652900          SELECT A.FDR_TRIP_TYP_CDE                                       
653000            INTO :PV-TRIP-TYP-CDE                                         
653100            FROM TIMCNTK A                                                
653200                ,TIMCNPO B                                                
653300           WHERE B.PO_NBR               = :DK-PO-NBR                      
653400           AND   A.CONTNR_ID            = B.CONTNR_ID                     
653500           AND   A.CONTNR_SEQ_NBR       = B.CONTNR_SEQ_NBR                
653600           AND   DATE(A.FDR_DPRTR_TMST) = :PV-FDR-DPRTR-DATE              
653700     END-EXEC.                                                            
653800                                                                          
653900     EVALUATE TRUE                                                        
654000         WHEN SQLCODE = +0                                                
654100         WHEN SQLCODE = -811                                              
654200             IF PV-TRIP-TYP-CDE = PC-A                                    
654300                 MOVE PC-AIR TO PV-TRIP-TYP-CDE-FULL                      
654400             ELSE                                                         
654500                 IF PV-TRIP-TYP-CDE = PC-O                                
654600                     MOVE PC-OCEAN TO PV-TRIP-TYP-CDE-FULL                
654700                 ELSE                                                     
654800                     MOVE SPACES TO PV-TRIP-TYP-CDE-FULL                  
654900                 END-IF                                                   
655000             END-IF                                                       
655100         WHEN SQLCODE = +100                                              
655200         WHEN SQLCODE = -904                                              
655300         WHEN SQLCODE = -913                                              
655400              CONTINUE                                                    
655500         WHEN SQLWARN0 NOT = SPACES                                       
655600         WHEN SQLCODE < +0                                                
655700         WHEN SQLCODE > +0                                                
655800              MOVE '9909-LOAD-TRIP-TYPE-CNTR-3'                           
655900                              TO DP013-PARAGRAPH                          
656000              MOVE 'UNSUCCESSFUL SELECT IN-PROCESS'                       
656100                              TO DP013-MESSAGE-TEXT (1)                   
656200              MOVE SQLCA      TO DP013-SQLCA                              
656300              MOVE 'TIMCNTK ' TO DP013-DB2-TABLE-NAME (1)                 
656400              MOVE 'TIMCNPO ' TO DP013-DB2-TABLE-NAME (2)                 
656500              SET DP013-DB2-ABEND                                         
656600                  DP013-XCTL-DISPLAY-RESTART                              
656700                              TO TRUE                                     
656800              PERFORM 9999-SQL-ABEND                                      
656900     END-EVALUATE.                                                        
657000 EJECT                                                                    
657100*----------------------------------------------------------------*        
657200* GET THE VENDOR SHORT NAME                                      *        
657300*----------------------------------------------------------------*        
657400                                                                          
657500 9910-GET-VENDOR-SHORT-NAME.                                              
657600                                                                          
657700     MOVE SPACES TO ENTNME-ENT-NAME-DESC.                                 
657800     EXEC SQL                                                             
657900         SELECT ENT_NAME_DESC                                             
658000              , ENT_ID                                                    
658100          INTO  :ENTNME-ENT-NAME-DESC                                     
658200              , :ENTNME-ENT-ID                                            
658300          FROM  TENTNME                                                   
658400          WHERE ENT_ID   = :PURCHS-ENT-ID                                 
658500            AND TYPE_CDE = '04'                                           
658600     END-EXEC.                                                            
658700                                                                          
658800     EVALUATE TRUE                                                        
658900         WHEN SQLCODE = +0                                                
659000         WHEN SQLCODE = +100                                              
659100         WHEN SQLCODE = -904                                              
659200         WHEN SQLCODE = -913                                              
659300             CONTINUE                                                     
659400         WHEN SQLWARN0 NOT = SPACE                                        
659500         WHEN SQLCODE < +0                                                
659600         WHEN SQLCODE > +0                                                
659700             MOVE '9910-GET-VENDOR-SHORT-NAME'                            
659800                                 TO DP013-PARAGRAPH                       
659900             MOVE 'SELECT ON ENTERPRISE NAME TABLE'                       
660000                                 TO DP013-MESSAGE-TEXT (1)                
660100             MOVE SQLCA          TO DP013-SQLCA                           
660200             MOVE 'TENTNME'      TO DP013-DB2-TABLE-NAME (1)              
660300                 SET DP013-DB2-ABEND                                      
660400                     DP013-XCTL-DISPLAY-RESTART                           
660500                                 TO TRUE                                  
660600              PERFORM 9999-SQL-ABEND                                      
660700     END-EVALUATE.                                                        
660800     MOVE ENTNME-ENT-NAME-DESC TO PVS-VND.                                
660900 EJECT                                                                    
661000*----------------------------------------------------------------*        
661100*  DETERMINE DC SPLITS CREATE DATE                               *        
661200*----------------------------------------------------------------*        
661300 9912-LOAD-DC-SPLIT-CREATE-DATE.                                          
661400                                                                          
661500     PERFORM 9925-OPEN-DC-SPLITS-CURSOR.                                  
661600     SET PS-EOC-DC-SPLITS-NO TO TRUE.                                     
661700     SET PS-DISPLAY-DC-SPLITS TO TRUE.                                    
661800     INITIALIZE PV-TOTAL-CURR-SPLIT-QTY                                   
661900                PV-TOTAL-CURR-SPLIT-QTY-NULL.                             
662000     PERFORM 9913-PROCESS-DC-SPLIT-CRT-DATE                               
662100         UNTIL PS-EOC-DC-SPLITS OR                                        
662200               PS-DISPLAY-DC-SPLITS-NO.                                   
662300                                                                          
662400     PERFORM 9926-CLOSE-DC-SPLITS-CURSOR.                                 
662500                                                                          
662600     IF PS-DISPLAY-DC-SPLITS                                              
662700         PERFORM 9915-SELECT-DC-SPLIT-CRT-DATE                            
662800     END-IF.                                                              
662900                                                                          
663000*----------------------------------------------------------------*        
663100*  DETERMINE DC SPLITS CREATE DATE                               *        
663200*----------------------------------------------------------------*        
663300 9913-PROCESS-DC-SPLIT-CRT-DATE.                                          
663400                                                                          
663500     PERFORM 9927-FETCH-DC-SPLITS-CURSOR.                                 
663600                                                                          
663700     IF PS-EOC-DC-SPLITS                                                  
663800*        *******************************************                      
663900*        *  BELOW 'IF' CHECKS TO SEE IF YOU'VE HIT *                      
664000*        *  EOC ON THE FIRST FETCH OF TH DC CURSOR *                      
664100*        *  WHICH MEANS THERE ARE NO SPLITS, OR    *                      
664200*        *  THE LINE STATUSES ARE ALL INVALID.     *                      
664300*        *******************************************                      
664400         IF PV-TOTAL-CURR-SPLIT-QTY = ZERO                                
664500            SET PS-DISPLAY-DC-SPLITS-NO TO TRUE                           
664600         END-IF                                                           
664700     ELSE                                                                 
664800         PERFORM 9914-SUM-TALLPLN-LINES                                   
664900     END-IF.                                                              
665000                                                                          
665100*----------------------------------------------------------------*        
665200*  SUMMARY OF TALLPLN LINES FOR DC SPLITS CREATE DATE            *        
665300*----------------------------------------------------------------*        
665400 9914-SUM-TALLPLN-LINES.                                                  
665500                                                                          
665600     EXEC SQL                                                             
665700           SELECT                                                         
665800                  SUM (A.CURR_SPLIT_QTY)                                  
665900             INTO                                                         
666000            :PV-TOTAL-CURR-SPLIT-QTY:PV-TOTAL-CURR-SPLIT-QTY-NULL         
666100             FROM                                                         
666200                  TALLPLN   A                                             
666300             WHERE A.PO_NBR         = :DK-PO-NBR                          
666400               AND A.PO_LNE_NBR     = :PURITM-APP-PO-LNE-NBR              
666500     END-EXEC                                                             
666600                                                                          
666700     EVALUATE TRUE                                                        
666800         WHEN SQLCODE = ZERO                                              
666900             IF PV-TOTAL-CURR-SPLIT-QTY = ZERO                            
667000                 SET PS-DISPLAY-DC-SPLITS-NO TO TRUE                      
667100             END-IF                                                       
667200                                                                          
667300         WHEN SQLCODE = +100                                              
667400             SET PS-DISPLAY-DC-SPLITS-NO TO TRUE                          
667500                                                                          
667600         WHEN SQLWARN0 NOT = SPACES                                       
667700         WHEN SQLCODE < ZERO                                              
667800         WHEN SQLCODE > ZERO                                              
667900             MOVE '9914-SUM-TALLPLN-LINES'                                
668000                               TO DP013-PARAGRAPH                         
668100             MOVE 'SUM DATE'   TO DP013-MESSAGE-TEXT (1)                  
668200             MOVE SQLCA        TO DP013-SQLCA                             
668300             MOVE 'TALLPLN'      TO DP013-DB2-TABLE-NAME (1)              
668400             SET DP013-DB2-ABEND TO TRUE                                  
668500              PERFORM 9999-SQL-ABEND                                      
668600     END-EVALUATE.                                                        
668700                                                                          
668800*----------------------------------------------------------------*        
668900*  SELECT DC SPLITS CREATE DATE                                  *        
669000*----------------------------------------------------------------*        
669100 9915-SELECT-DC-SPLIT-CRT-DATE.                                           
669200                                                                          
669300         EXEC SQL                                                         
669400             SELECT MAX(DATE(SPLIT_CRE_DATE))                             
669500             INTO                                                         
669600               :PV-SPL-CRE-DT                                             
669700               :PV-SPL-CRE-DT-NULL                                        
669800             FROM   TALLPLN                                               
669900             WHERE  PO_NBR IN (:DK-PO-NBR)                                
670000             AND    DATE(SPLIT_CRE_DATE) <>                               
670100                                '0001-01-01'                              
670200         END-EXEC.                                                        
670300                                                                          
670400     EVALUATE TRUE                                                        
670500         WHEN SQLCODE = ZERO                                              
670600         WHEN SQLCODE = -811                                              
670700             IF PV-SPL-CRE-DT-NULL = 0                                    
670800              AND PV-SPL-CRE-DT NOT = '0001-01-01'                        
670900                MOVE PV-SPL-CRE-DT (1:4) TO                               
671000                              PV-SM-SPL-CRT-DT(1:4)                       
671100                MOVE PV-SPL-CRE-DT (6:2) TO                               
671200                              PV-SM-SPL-CRT-DT(5:2)                       
671300                MOVE PV-SPL-CRE-DT (9:2) TO                               
671400                              PV-SM-SPL-CRT-DT(7:2)                       
671500             END-IF                                                       
671600         WHEN SQLWARN0 NOT = SPACES                                       
671700         WHEN SQLCODE < ZERO                                              
671800         WHEN SQLCODE > ZERO                                              
671900             MOVE '9915-SELECT-DC-SPLIT-CRT-DATE'                         
672000                               TO DP013-PARAGRAPH                         
672100             MOVE 'SELECT DATA'                                           
672200                               TO DP013-MESSAGE-TEXT (1)                  
672300             MOVE SQLCA        TO DP013-SQLCA                             
672400             MOVE 'TALLPLN'      TO DP013-DB2-TABLE-NAME (1)              
672500             SET DP013-DB2-ABEND                                          
672600                 DP013-XCTL-DISPLAY-RESTART TO TRUE                       
672700             PERFORM 9999-SQL-ABEND                                       
672800     END-EVALUATE.                                                        
672900 EJECT                                                                    
673000*----------------------------------------------------------------*        
673100*  SELECT DC SPLITS CREATE DATE                                  *        
673200*----------------------------------------------------------------*        
673300 9917-LOAD-DC-SPLIT-SENT-DATE.                                            
673400                                                                          
673500     PERFORM 9918-GET-DC-SPLIT-ORDR-SNT-DTE.                              
673600     PERFORM 9919-GET-DC-SPLIT-SHPT-SNT-DTE.                              
673700     IF  PS-DC-SPLT-ORD-SNT-DTE                                           
673800     AND PS-DC-SPLT-SHPT-SNT-DTE                                          
673900         IF  PV-ORD-SPL-SNT-DT < PV-SHPT-SPL-SNT-DT                       
674000             MOVE PV-ORD-SPL-SNT-DT (1:4) TO                              
674100                           PV-SM-SPL-SNT-DT(1:4)                          
674200             MOVE PV-ORD-SPL-SNT-DT (6:2) TO                              
674300                           PV-SM-SPL-SNT-DT(5:2)                          
674400             MOVE PV-ORD-SPL-SNT-DT (9:2) TO                              
674500                           PV-SM-SPL-SNT-DT(7:2)                          
674600         ELSE                                                             
674700             MOVE PV-SHPT-SPL-SNT-DT (1:4) TO                             
674800                           PV-SM-SPL-SNT-DT(1:4)                          
674900             MOVE PV-SHPT-SPL-SNT-DT (6:2) TO                             
675000                           PV-SM-SPL-SNT-DT(5:2)                          
675100             MOVE PV-SHPT-SPL-SNT-DT (9:2) TO                             
675200                           PV-SM-SPL-SNT-DT(7:2)                          
675300         END-IF                                                           
675400     ELSE                                                                 
675500         IF PS-DC-SPLT-ORD-SNT-DTE                                        
675600             MOVE PV-ORD-SPL-SNT-DT (1:4) TO                              
675700                           PV-SM-SPL-SNT-DT(1:4)                          
675800             MOVE PV-ORD-SPL-SNT-DT (6:2) TO                              
675900                           PV-SM-SPL-SNT-DT(5:2)                          
676000             MOVE PV-ORD-SPL-SNT-DT (9:2) TO                              
676100                           PV-SM-SPL-SNT-DT(7:2)                          
676200         ELSE                                                             
676300             IF PS-DC-SPLT-SHPT-SNT-DTE                                   
676400                 MOVE PV-SHPT-SPL-SNT-DT (1:4) TO                         
676500                               PV-SM-SPL-SNT-DT(1:4)                      
676600                 MOVE PV-SHPT-SPL-SNT-DT (6:2) TO                         
676700                               PV-SM-SPL-SNT-DT(5:2)                      
676800                 MOVE PV-SHPT-SPL-SNT-DT (9:2) TO                         
676900                               PV-SM-SPL-SNT-DT(7:2)                      
677000             ELSE                                                         
677100                 MOVE SPACES TO PV-SM-SPL-SNT-DT                          
677200             END-IF                                                       
677300         END-IF                                                           
677400     END-IF.                                                              
677500*----------------------------------------------------------------*        
677600*  DETERMINE DC SPLITS ORDR SENT DATE                            *        
677700*----------------------------------------------------------------*        
677800 9918-GET-DC-SPLIT-ORDR-SNT-DTE.                                          
677900                                                                          
678000     SET PS-DC-SPLT-ORD-SNT-DTE-NO TO TRUE.                               
678100         EXEC SQL                                                         
678200             SELECT MIN(DATE(DCONSLR_ACTL_DTE))                           
678300             INTO                                                         
678400               :PV-ORD-SPL-SNT-DT                                         
678500               :PV-ORD-SPL-SNT-DT-NULL                                    
678600             FROM   TIMPORL                                               
678700             WHERE  PO_NBR IN (:DK-PO-NBR)                                
678800             AND    VER_STATUS_CDE   = 'A'                                
678900             AND    DCONSLR_RLSE_CDE IN(:PC-R, :PC-Y)                     
679000             AND    DATE(DCONSLR_ACTL_DTE)   <>                           
679100                                '0001-01-01'                              
679200         END-EXEC.                                                        
679300                                                                          
679400     EVALUATE TRUE                                                        
679500         WHEN SQLCODE = ZERO                                              
679600         WHEN SQLCODE = -811                                              
679700             IF PV-ORD-SPL-SNT-DT-NULL = 0                                
679800              AND PV-ORD-SPL-SNT-DT NOT = '0001-01-01'                    
679900                SET PS-DC-SPLT-ORD-SNT-DTE TO TRUE                        
680000             END-IF                                                       
680100         WHEN SQLWARN0 NOT = SPACES                                       
680200         WHEN SQLCODE < ZERO                                              
680300         WHEN SQLCODE > ZERO                                              
680400             MOVE '9918-LOAD-DC-SPLIT-ORDR-SNT-DTE'                       
680500                               TO DP013-PARAGRAPH                         
680600             MOVE 'SELECT DATA'                                           
680700                               TO DP013-MESSAGE-TEXT (1)                  
680800             MOVE SQLCA        TO DP013-SQLCA                             
680900             MOVE 'TIMPORL'      TO DP013-DB2-TABLE-NAME (1)              
681000             SET DP013-DB2-ABEND                                          
681100                 DP013-XCTL-DISPLAY-RESTART TO TRUE                       
681200             PERFORM 9999-SQL-ABEND                                       
681300     END-EVALUATE.                                                        
681400 EJECT                                                                    
681500*----------------------------------------------------------------*        
681600*  DETERMINE DC SPLITS SHPT SENT DATE                            *        
681700*----------------------------------------------------------------*        
681800 9919-GET-DC-SPLIT-SHPT-SNT-DTE.                                          
681900                                                                          
682000     SET PS-DC-SPLT-SHPT-SNT-DTE-NO TO TRUE.                              
682100         EXEC SQL                                                         
682200             SELECT MIN(DATE(DCONSLR_ACTL_DTE))                           
682300             INTO                                                         
682400               :PV-SHPT-SPL-SNT-DT                                        
682500               :PV-SHPT-SPL-SNT-DT-NULL                                   
682600             FROM   TIMCNRL                                               
682700             WHERE  PO_NBR IN (:DK-PO-NBR)                                
682800             AND    DCONSLR_RLSE_CDE IN(:PC-R, :PC-Y)                     
682900             AND    DATE(DCONSLR_ACTL_DTE)   <>                           
683000                                '0001-01-01'                              
683100         END-EXEC.                                                        
683200                                                                          
683300     EVALUATE TRUE                                                        
683400         WHEN SQLCODE = ZERO                                              
683500         WHEN SQLCODE = -811                                              
683600             IF PV-SHPT-SPL-SNT-DT-NULL = 0                               
683700              AND PV-SHPT-SPL-SNT-DT NOT = '0001-01-01'                   
683800                SET PS-DC-SPLT-SHPT-SNT-DTE TO TRUE                       
683900             END-IF                                                       
684000         WHEN SQLWARN0 NOT = SPACES                                       
684100         WHEN SQLCODE < ZERO                                              
684200         WHEN SQLCODE > ZERO                                              
684300             MOVE '9919-LOAD-DC-SPLIT-SHPT-SNT-DTE'                       
684400                               TO DP013-PARAGRAPH                         
684500             MOVE 'SELECT DATA'                                           
684600                               TO DP013-MESSAGE-TEXT (1)                  
684700             MOVE SQLCA        TO DP013-SQLCA                             
684800             MOVE 'TIMCNRL'      TO DP013-DB2-TABLE-NAME (1)              
684900             SET DP013-DB2-ABEND                                          
685000                 DP013-XCTL-DISPLAY-RESTART TO TRUE                       
685100             PERFORM 9999-SQL-ABEND                                       
685200     END-EVALUATE.                                                        
685300 EJECT                                                                    
685400*----------------------------------------------------------------*        
685500* GET THE VENDOR PRIMARY NAME                                    *        
685600*----------------------------------------------------------------*        
685700                                                                          
685800 9920-GET-VENDOR-PRIMARY-NAME.                                            
685900                                                                          
686000     EXEC SQL                                                             
686100         SELECT ENT_NAME_DESC                                             
686200              , ENT_ID                                                    
686300          INTO  :ENTNME-ENT-NAME-DESC                                     
686400              , :ENTNME-ENT-ID                                            
686500          FROM  TENTNME                                                   
686600          WHERE ENT_ID   = :PURCHS-ENT-ID                                 
686700            AND TYPE_CDE = '01'                                           
686800     END-EXEC.                                                            
686900                                                                          
687000     EVALUATE TRUE                                                        
687100         WHEN SQLCODE = +0                                                
687200         WHEN SQLCODE = +100                                              
687300         WHEN SQLCODE = -904                                              
687400         WHEN SQLCODE = -913                                              
687500             CONTINUE                                                     
687600         WHEN SQLWARN0 NOT = SPACE                                        
687700         WHEN SQLCODE < +0                                                
687800         WHEN SQLCODE > +0                                                
687900             MOVE '9920-GET-VENDOR-PRIMARY-NAME'                          
688000                                 TO DP013-PARAGRAPH                       
688100             MOVE 'SELECT ON ENTERPRISE NAME TABLE'                       
688200                                 TO DP013-MESSAGE-TEXT (1)                
688300             MOVE SQLCA          TO DP013-SQLCA                           
688400             MOVE 'TENTNME'      TO DP013-DB2-TABLE-NAME (1)              
688500                 SET DP013-DB2-ABEND                                      
688600                     DP013-XCTL-DISPLAY-RESTART                           
688700                                 TO TRUE                                  
688800             PERFORM 9999-SQL-ABEND                                       
688900     END-EVALUATE.                                                        
689000 EJECT                                                                    
689100*----------------------------------------------------------------*        
689200* SELECT DMM (DMA) NUMBER                                        *        
689300*----------------------------------------------------------------*        
689400 9923-SELECT-DMM-NBR.                                                     
689500                                                                          
689600     MOVE SPACES TO MDSEAR-DMA-NBR.                                       
689700                                                                          
689800     EXEC SQL                                                             
689900         SELECT DMA_NBR                                                   
690000          INTO  :MDSEAR-DMA-NBR                                           
690100          FROM  TMDSEAR                                                   
690200          WHERE DEPT_NBR  = :PURCHS-DEPT-NBR                              
690300     END-EXEC.                                                            
690400                                                                          
690500     EVALUATE TRUE                                                        
690600         WHEN SQLCODE = +0                                                
690700         WHEN SQLCODE = -811                                              
690800         WHEN SQLCODE = -904                                              
690900         WHEN SQLCODE = -913                                              
691000             CONTINUE                                                     
691100                                                                          
691200         WHEN SQLCODE = +100                                              
691300             MOVE SPACES TO MDSEAR-DMA-NBR                                
691400                                                                          
691500         WHEN SQLWARN0 NOT = SPACE                                        
691600         WHEN SQLCODE < +0                                                
691700         WHEN SQLCODE > +0                                                
691800             MOVE '9923-SELECT-DMM-NBR'                                   
691900                                 TO DP013-PARAGRAPH                       
692000             MOVE 'SELECT ON TMDSEAR TABLE'                               
692100                                 TO DP013-MESSAGE-TEXT (1)                
692200             MOVE SQLCA          TO DP013-SQLCA                           
692300             MOVE 'TMDSEAR'      TO DP013-DB2-TABLE-NAME (1)              
692400                 SET DP013-DB2-ABEND                                      
692500                     DP013-XCTL-DISPLAY-RESTART                           
692600                                 TO TRUE                                  
692700             PERFORM 9999-SQL-ABEND                                       
692800     END-EVALUATE.                                                        
692900                                                                          
693000     MOVE MDSEAR-DMA-NBR TO PVS-DMM.                                      
693100 EJECT                                                                    
693200*----------------------------------------------------------------*        
693300*   OPEN THE DC SPLITS CREATE DATE CURSOR                        *        
693400*----------------------------------------------------------------*        
693500 9925-OPEN-DC-SPLITS-CURSOR.                                              
693600                                                                          
693700         MOVE 'CURSOR:  DC-SPLITS-CSR' TO DP013-MESSAGE-TEXT (2)          
693800                                                                          
693900         EXEC SQL                                                         
694000              OPEN DC-SPLITS-CSR                                          
694100         END-EXEC.                                                        
694200                                                                          
694300         EVALUATE TRUE                                                    
694400             WHEN SQLCODE = ZERO                                          
694500             WHEN SQLCODE = -904                                          
694600             WHEN SQLCODE = -913                                          
694700                 CONTINUE                                                 
694800             WHEN SQLWARN0 NOT = SPACES                                   
694900             WHEN SQLCODE < ZERO                                          
695000             WHEN SQLCODE > ZERO                                          
695100                 MOVE '9925-OPEN-DC-SPLITS-CURSOR'                        
695200                                   TO DP013-PARAGRAPH                     
695300                 MOVE 'OPEN DC SPLITS CURSOR - '                          
695400                                   TO DP013-MESSAGE-TEXT (1)              
695500                 MOVE SQLCA        TO DP013-SQLCA                         
695600                 MOVE 'TPURITM '   TO DP013-DB2-TABLE-NAME (1)            
695700                 SET DP013-DB2-ABEND                                      
695800                     DP013-XCTL-DISPLAY-RESTART TO TRUE                   
695900                 PERFORM 9999-SQL-ABEND                                   
696000         END-EVALUATE.                                                    
696100 EJECT                                                                    
696200*----------------------------------------------------------------*        
696300*   CLOSE THE DC SPLITS CREATE DATE CURSOR                       *        
696400*----------------------------------------------------------------*        
696500 9926-CLOSE-DC-SPLITS-CURSOR.                                             
696600                                                                          
696700     EXEC SQL                                                             
696800          CLOSE DC-SPLITS-CSR                                             
696900     END-EXEC.                                                            
697000                                                                          
697100     EVALUATE TRUE                                                        
697200         WHEN SQLCODE = ZERO                                              
697300             CONTINUE                                                     
697400         WHEN SQLWARN0 NOT = SPACES                                       
697500         WHEN SQLCODE < ZERO                                              
697600         WHEN SQLCODE > ZERO                                              
697700             MOVE '9926-CLOSE-DC-SPLITS-CURSOR'                           
697800                               TO DP013-PARAGRAPH                         
697900             MOVE 'CLOSE DC SPLITS CURSOR'                                
698000                               TO DP013-MESSAGE-TEXT (1)                  
698100             MOVE SQLCA        TO DP013-SQLCA                             
698200             MOVE 'TPURITM '   TO DP013-DB2-TABLE-NAME (1)                
698300             SET DP013-DB2-ABEND                                          
698400                 DP013-XCTL-DISPLAY-RESTART TO TRUE                       
698500             PERFORM 9999-SQL-ABEND                                       
698600     END-EVALUATE.                                                        
698700                                                                          
698800 EJECT                                                                    
698900*----------------------------------------------------------------*        
699000*    FETCH THE DC SPLITS CREATE DATE CURSOR                      *        
699100*----------------------------------------------------------------*        
699200 9927-FETCH-DC-SPLITS-CURSOR.                                             
699300                                                                          
699400     EXEC SQL                                                             
699500          FETCH DC-SPLITS-CSR                                             
699600          INTO  :PURITM-APP-PO-LNE-NBR                                    
699700     END-EXEC.                                                            
699800                                                                          
699900     EVALUATE TRUE                                                        
700000         WHEN SQLCODE = ZERO                                              
700100         WHEN SQLCODE = -811                                              
700200             SET PS-EOC-DC-SPLITS-NO TO TRUE                              
700300                                                                          
700400         WHEN SQLCODE = +100                                              
700500             SET PS-EOC-DC-SPLITS TO TRUE                                 
700600                                                                          
700700         WHEN SQLWARN0 NOT = SPACE                                        
700800         WHEN SQLCODE NOT = ZERO                                          
700900              MOVE '9927-FETCH-DC-SPLITS-CURSOR'                          
701000                               TO DP013-PARAGRAPH                         
701100              MOVE 'FETCH DC SPLIT CURSOR'                                
701200                               TO DP013-MESSAGE-TEXT (1)                  
701300              MOVE SQLCA       TO DP013-SQLCA                             
701400              SET DP013-DB2-ABEND                                         
701500                               TO TRUE                                    
701600             PERFORM 9999-SQL-ABEND                                       
701700     END-EVALUATE.                                                        
701800                                                                          
701900 EJECT                                                                    
702000*----------------------------------------------------------------*        
702100*  SELECT STORE DISTRO                                           *        
702200*----------------------------------------------------------------*        
702300 9928-SELECT-STORE-DISTRO.                                                
702400                                                                          
702500         EXEC SQL                                                         
702600            SELECT COUNT(*)                                               
702700              INTO :PV-DB2-COUNT                                          
702800              FROM  TMESTDS                                               
702900              WHERE PO_NBR = :DK-PO-NBR                                   
703000         END-EXEC.                                                        
703100*                                                                         
703200     EVALUATE TRUE                                                        
703300         WHEN SQLCODE = ZERO                                              
703400         WHEN SQLCODE = -811                                              
703500             IF PV-DB2-COUNT > +0                                         
703600                 MOVE PC-Y TO PV-SM-STORE-DISTRO                          
703700             ELSE                                                         
703800                 MOVE PC-N TO PV-SM-STORE-DISTRO                          
703900             END-IF                                                       
704000                                                                          
704100         WHEN SQLCODE = +100                                              
704200             MOVE PC-N TO PV-SM-STORE-DISTRO                              
704300                                                                          
704400         WHEN SQLWARN0 NOT = SPACES                                       
704500         WHEN SQLCODE < ZERO                                              
704600         WHEN SQLCODE > ZERO                                              
704700             MOVE '9928-SELECT-STORE-DISTRO'                              
704800                               TO DP013-PARAGRAPH                         
704900             MOVE 'SELECT DATA'                                           
705000                               TO DP013-MESSAGE-TEXT (1)                  
705100             MOVE SQLCA        TO DP013-SQLCA                             
705200             MOVE 'TMESTDS'      TO DP013-DB2-TABLE-NAME (1)              
705300             SET DP013-DB2-ABEND TO TRUE                                  
705400             PERFORM 9999-SQL-ABEND                                       
705500     END-EVALUATE.                                                        
705600*                                                                         
705700 EJECT                                                                    
705800*----------------------------------------------------------------*        
705900* GET DOLLARS RECEIVED                                           *        
706000*----------------------------------------------------------------*        
706100                                                                          
706200 9930-GET-DOLLARS-RECEIVED.                                               
706300                                                                          
706400     INITIALIZE PV-GP-DOLLARS-RECEIVED                                    
706500                PV-NULL-IND.                                              
706600     EXEC SQL                                                             
706700      SELECT SUM(DECIMAL                                                  
706800           (C.AP_VERIFY_ITM_QTY * (A.GP_RTL_AMT / A.GP_QTY),9,2))         
706900         INTO :PV-GP-DOLLARS-RECEIVED:PV-NULL-IND                         
707000         FROM TPURITM A,                                                  
707100              TRECITM B,                                                  
707200              TRECDIS C                                                   
707300         WHERE A.PO_NBR         = :DK-PO-NBR                              
707400           AND A.APP_PO_LNE_NBR = B.ORD_LNE_NBR                           
707500           AND A.VER_NBR        = B.PO_VER_NBR                            
707600           AND B.ORD_NBR        = A.PO_NBR                                
707700           AND B.STATUS_CDE     = 'VE'                                    
707800           AND B.VER_STATUS_CDE = 'A'                                     
707900           AND C.ORD_NBR        = A.PO_NBR                                
708000           AND C.ORD_LNE_NBR    = B.ORD_LNE_NBR                           
708100           AND C.REC_SEQ_NBR    = B.REC_SEQ_NBR                           
708300           AND A.GP_QTY         > 1                                       
708400     END-EXEC.                                                            
708500                                                                          
708600     EVALUATE TRUE                                                        
708700         WHEN SQLCODE = +0                                                
708800           IF PV-NULL-IND NOT = -1                                        
708900             CONTINUE                                                     
709000              ELSE                                                        
709100             MOVE ZEROES TO PV-GP-DOLLARS-RECEIVED                        
709200           END-IF                                                         
709300           CONTINUE                                                       
709400         WHEN SQLCODE = -904                                              
709500         WHEN SQLCODE = -913                                              
709600              CONTINUE                                                    
709700                                                                          
709800         WHEN SQLWARN0 NOT = SPACES                                       
709900         WHEN SQLCODE < +0                                                
710000         WHEN SQLCODE > +0                                                
710100              MOVE '9930-GET-DOLLARS-RECEIVED'                            
710200                              TO DP013-PARAGRAPH                          
710300              MOVE 'UNSUCCESSFUL SELECT GP DOLLARS RECEIVED'              
710400                              TO DP013-MESSAGE-TEXT (1)                   
710500              MOVE SQLCA      TO DP013-SQLCA                              
710600              MOVE 'TRECDIS ' TO DP013-DB2-TABLE-NAME (1)                 
710700              SET DP013-DB2-ABEND                                         
710800                  DP013-XCTL-DISPLAY-RESTART                              
710900                              TO TRUE                                     
711000             PERFORM 9999-SQL-ABEND                                       
711100     END-EVALUATE.                                                        
711200                                                                          
711300     INITIALIZE PV-DOLLARS-RECEIVED                                       
711400                PV-NULL-IND.                                              
711500     EXEC SQL                                                             
711600      SELECT SUM(C.AP_VERIFY_ITM_QTY * A.UNT_RTL_PR_AMT)                  
711700         INTO :PV-DOLLARS-RECEIVED:PV-NULL-IND                            
711800         FROM TPURITM A,                                                  
711900              TRECITM B,                                                  
712000              TRECDIS C                                                   
712100         WHERE A.PO_NBR         = :DK-PO-NBR                              
712200           AND A.APP_PO_LNE_NBR = B.ORD_LNE_NBR                           
712300           AND A.VER_NBR        = B.PO_VER_NBR                            
712400           AND B.ORD_NBR        = A.PO_NBR                                
712500           AND B.STATUS_CDE     = 'VE'                                    
712600           AND B.VER_STATUS_CDE = 'A'                                     
712700           AND C.ORD_NBR        = A.PO_NBR                                
712800           AND C.ORD_LNE_NBR    = B.ORD_LNE_NBR                           
712900           AND C.REC_SEQ_NBR    = B.REC_SEQ_NBR                           
713100           AND A.GP_QTY        <= 1                                       
713200     END-EXEC.                                                            
713300                                                                          
713400     EVALUATE TRUE                                                        
713500         WHEN SQLCODE = +0                                                
713600           IF PV-NULL-IND NOT = -1                                        
713700             CONTINUE                                                     
713800              ELSE                                                        
713900             MOVE ZEROES TO PV-DOLLARS-RECEIVED                           
714000           END-IF                                                         
714100           CONTINUE                                                       
714200         WHEN SQLCODE = -904                                              
714300         WHEN SQLCODE = -913                                              
714400              CONTINUE                                                    
714500                                                                          
714600         WHEN SQLWARN0 NOT = SPACES                                       
714700         WHEN SQLCODE < +0                                                
714800         WHEN SQLCODE > +0                                                
714900              MOVE '9930-GET-DOLLARS-RECEIVED'                            
715000                              TO DP013-PARAGRAPH                          
715100              MOVE 'UNSUCCESSFUL SELECT DOLLARS RECEIVED'                 
715200                              TO DP013-MESSAGE-TEXT (1)                   
715300              MOVE SQLCA      TO DP013-SQLCA                              
715400              MOVE 'TRECDIS ' TO DP013-DB2-TABLE-NAME (1)                 
715500              SET DP013-DB2-ABEND                                         
715600                  DP013-XCTL-DISPLAY-RESTART                              
715700                              TO TRUE                                     
715800             PERFORM 9999-SQL-ABEND                                       
715900     END-EVALUATE.                                                        
716000       ADD PV-DOLLARS-RECEIVED TO PV-GP-DOLLARS-RECEIVED GIVING           
716100          PV-DOLLARS-RECEIVED.                                            
716200                                                                          
716300 EJECT                                                                    
716400*----------------------------------------------------------------*        
716500*  DETERMINE IF ANY OF THE ORDERS ARE HAVE IN-PROCESS RECEIVERS, *        
716600*  IF THE ORDER DOES, HIGHLIGHT THE PO IN YELLOW ON THE SCREEN.  *        
716700*----------------------------------------------------------------*        
716800                                                                          
716900 9940-CHECK-IN-PROCESS.                                                   
717000                                                                          
717100     EXEC SQL                                                             
717200          SELECT COUNT(*)                                                 
717300            INTO :PV-DB2-COUNT2                                           
717400            FROM TRECEIV                                                  
717500           WHERE ORD_NBR        = :DK-PO-NBR                              
717600             AND VER_STATUS_CDE = 'A'                                     
717700             AND STATUS_CDE     = 'IP'                                    
717800     END-EXEC.                                                            
717900                                                                          
718000     EVALUATE TRUE                                                        
718100         WHEN SQLCODE = +0                                                
718200         WHEN SQLCODE = +100                                              
718300         WHEN SQLCODE = -904                                              
718400         WHEN SQLCODE = -913                                              
718500              CONTINUE                                                    
718600                                                                          
718700         WHEN SQLWARN0 NOT = SPACES                                       
718800         WHEN SQLCODE < +0                                                
718900         WHEN SQLCODE > +0                                                
719000              MOVE '9940-CHECK-IN-PROCESS'                                
719100                              TO DP013-PARAGRAPH                          
719200              MOVE 'UNSUCCESSFUL SELECT IN-PROCESS'                       
719300                              TO DP013-MESSAGE-TEXT (1)                   
719400              MOVE SQLCA      TO DP013-SQLCA                              
719500              MOVE 'TRECEIV ' TO DP013-DB2-TABLE-NAME (1)                 
719600              SET DP013-DB2-ABEND                                         
719700                  DP013-XCTL-DISPLAY-RESTART                              
719800                              TO TRUE                                     
719900             PERFORM 9999-SQL-ABEND                                       
720000     END-EVALUATE.                                                        
720100                                                                          
720200*----------------------------------------------------------------*        
720300*  DETERMINE UNITS RECEIVED                                      *        
720400*----------------------------------------------------------------*        
720500 9950-GET-UNITS-RECEIVED.                                                 
720600                                                                          
720700     INITIALIZE PV-UNITS-RECEIVED                                         
720800                PV-NULL-IND.                                              
720900         EXEC SQL                                                         
721000             SELECT SUM(B.AP_VERIFY_ITM_QTY)                              
721100             INTO :PV-UNITS-RECEIVED:PV-NULL-IND                          
721200             FROM TRECITM A,                                              
721300                  TRECDIS B                                               
721400             WHERE A.ORD_NBR        = :DK-PO-NBR                          
721500               AND A.ORD_NBR        = B.ORD_NBR                           
721600               AND A.STATUS_CDE     = 'VE'                                
721700               AND A.VER_STATUS_CDE = 'A'                                 
721800               AND B.ORD_LNE_NBR    = A.ORD_LNE_NBR                       
721900               AND B.REC_SEQ_NBR    = A.REC_SEQ_NBR                       
722100         END-EXEC.                                                        
722200                                                                          
722300         EVALUATE TRUE                                                    
722400             WHEN SQLCODE = +0                                            
722500             WHEN SQLCODE = +100                                          
722600             WHEN SQLCODE = -904                                          
722700             WHEN SQLCODE = -913                                          
722800                  CONTINUE                                                
722900                                                                          
723000             WHEN SQLWARN0 NOT = SPACES                                   
723100             WHEN SQLCODE < +0                                            
723200             WHEN SQLCODE > +0                                            
723300                  MOVE '9950-GET-UNITS-RCVD'                              
723400                                  TO DP013-PARAGRAPH                      
723500                  MOVE 'UNSUCCESSFUL SELECT UNITS RCVD  '                 
723600                                  TO DP013-MESSAGE-TEXT (1)               
723700                  MOVE SQLCA      TO DP013-SQLCA                          
723800                  MOVE 'TRECITM ' TO DP013-DB2-TABLE-NAME (1)             
723900                  MOVE 'TRECDIS ' TO DP013-DB2-TABLE-NAME (2)             
724000                  SET DP013-DB2-ABEND                                     
724100                      DP013-XCTL-DISPLAY-RESTART                          
724200                                  TO TRUE                                 
724300                 PERFORM 9999-SQL-ABEND                                   
724400         END-EVALUATE.                                                    
724500                                                                          
724600 EJECT                                                                    
724700                                                                          
724800*----------------------------------------------------------------*        
724900*  DETERMINE MIN AD DATE                                         *        
725000*----------------------------------------------------------------*        
725100                                                                          
725200 9960-GET-MIN-AD-DATE.                                                    
725300                                                                          
725400         EXEC SQL                                                         
725500             SELECT MIN(AD_EVNT_DTE)                                      
725600              INTO  :PURITM-AD-EVNT-DTE:PV-NULL-IND                       
725700              FROM  TPURITM                                               
725800              WHERE PO_NBR          = :DK-PO-NBR                          
725900                AND VER_STATUS_CDE  = 'A'                                 
726000                AND AD_EVNT_DTE     > '0001-01-01'                        
726100                AND STATUS_CDE NOT IN ('CA')                              
726200         END-EXEC.                                                        
726300                                                                          
726400         EVALUATE TRUE                                                    
726500             WHEN SQLCODE = +0                                            
726600                  IF  PV-NULL-IND < +0                                    
726700                      MOVE SPACES     TO PV-SM-AD-EVNT-DT                 
726800                  ELSE                                                    
726900                      MOVE PURITM-AD-EVNT-DTE (1:4) TO                    
727000                                       PV-SM-AD-EVNT-DT(1:4)              
727100                      MOVE PURITM-AD-EVNT-DTE (6:2) TO                    
727200                                       PV-SM-AD-EVNT-DT(5:2)              
727300                      MOVE PURITM-AD-EVNT-DTE (9:2) TO                    
727400                                       PV-SM-AD-EVNT-DT(7:2)              
727500                  END-IF                                                  
727600             WHEN SQLCODE = +100                                          
727700                  MOVE SPACES          TO PV-SM-AD-EVNT-DT                
727800             WHEN SQLCODE = -904                                          
727900             WHEN SQLCODE = -913                                          
728000                  CONTINUE                                                
728100                                                                          
728200             WHEN SQLWARN0 NOT = SPACES                                   
728300             WHEN SQLCODE < +0                                            
728400             WHEN SQLCODE > +0                                            
728500                  MOVE '9960-GET-MIN-AD-DTE'                              
728600                                  TO DP013-PARAGRAPH                      
728700                  MOVE 'UNSUCCESSFUL SELECT MIN AD DATE '                 
728800                                  TO DP013-MESSAGE-TEXT (1)               
728900                  MOVE SQLCA      TO DP013-SQLCA                          
729000                  MOVE 'TPURITM ' TO DP013-DB2-TABLE-NAME (1)             
729100                  SET DP013-DB2-ABEND                                     
729200                      DP013-XCTL-DISPLAY-RESTART                          
729300                                  TO TRUE                                 
729400                 PERFORM 9999-SQL-ABEND                                   
729500         END-EVALUATE.                                                    
729600                                                                          
729700*----------------------------------------------------------------*        
729800*      SELECT TRAILER AVAILABLE DATE FROM SHIPST                 *        
729900*----------------------------------------------------------------*        
730000 9962-GET-TRLR-AVAIL-DATE.                                                
730100                                                                          
730200         EXEC SQL                                                         
730300             SELECT DISTINCT                                              
730400                    MIN(C.STATUS_DTE)                                     
730500             INTO  :PV-TRLR-AVAIL-DT:PV-TRLR-AVAIL-DT-NULL                
730600             FROM   TSHPTPO A                                             
730700                   ,TSHIPMT B                                             
730800                   ,TSHIPST C                                             
730900            WHERE  A.PO_NBR        = :DK-PO-NBR                           
731000              AND  A.SHIPT_ID      = B.SHIPT_ID                           
731100              AND  A.SHIPT_ID      = C.SHIPT_ID                           
731200              AND  C.SHIPT_STATUS_CDE = :PC-AJ                            
731300         END-EXEC.                                                        
731400                                                                          
731500         EVALUATE TRUE                                                    
731600             WHEN SQLCODE = ZERO                                          
731700                  IF PV-TRLR-AVAIL-DT-NULL < +0                           
731800                      MOVE SPACES TO PV-SM-TRLR-AVAIL-DT                  
731900                  ELSE                                                    
732000                      MOVE PV-TRLR-AVAIL-DT (1:4) TO                      
732100                                       PV-SM-TRLR-AVAIL-DT (1:4)          
732200                      MOVE PV-TRLR-AVAIL-DT (6:2) TO                      
732300                                       PV-SM-TRLR-AVAIL-DT (5:2)          
732400                      MOVE PV-TRLR-AVAIL-DT (9:2) TO                      
732500                                       PV-SM-TRLR-AVAIL-DT (7:2)          
732600                  END-IF                                                  
732700                                                                          
732800             WHEN SQLCODE = +100                                          
732900                  MOVE SPACES TO PV-SM-TRLR-AVAIL-DT                      
733000                                                                          
733100             WHEN SQLCODE = -904                                          
733200             WHEN SQLCODE = -913                                          
733300                  CONTINUE                                                
733400                                                                          
733500             WHEN SQLWARN0 NOT = SPACES                                   
733600             WHEN SQLCODE < +0                                            
733700             WHEN SQLCODE > +0                                            
733800                  MOVE '9962-GET-TRLR-AVAIL-DATE'                         
733900                                  TO DP013-PARAGRAPH                      
734000                  MOVE 'SQL ERROR ON TRLR AVAIL DATE SELECT'              
734100                                  TO DP013-MESSAGE-TEXT (1)               
734200                  MOVE SQLCA      TO DP013-SQLCA                          
734300                  MOVE 'TSHIPST ' TO DP013-DB2-TABLE-NAME (1)             
734400                  SET DP013-DB2-ABEND TO TRUE                             
734500                  PERFORM 9999-SQL-ABEND                                  
734600         END-EVALUATE.                                                    
734700                                                                          
734800 EJECT                                                                    
734900*----------------------------------------------------------------*        
735000*  DETERMINE VENDOR STYLE                                        *        
735100*----------------------------------------------------------------*        
735200                                                                          
735300 9965-GET-VENDOR-STYLE.                                                   
735400                                                                          
736310         EXEC SQL                                                         
736320             SELECT DISTINCT VS_NBR                                       
736330              INTO  :XLT00004-VS-NBR                                      
736340              FROM  TPURITM A                                             
736350                  , XLT_SKU B                                             
736360                  , XLT_VND_STYL C                                        
736370              WHERE A.PO_NBR          = :DK-PO-NBR                        
736380                AND A.VER_STATUS_CDE  = 'A'                               
736390                AND STATUS_CDE NOT IN ('CA')                              
736391                AND A.ITM_NBR = B.ITM_NBR                                 
736392                AND B.STYL_ID = C.STYL_ID                                 
736393         END-EXEC                                                         
736394                                                                          
736400         EVALUATE TRUE                                                    
736500             WHEN SQLCODE = +0                                            
736510                  MOVE XLT00004-VS-NBR TO                                 
736520                                   PV-SM-VENDOR-STYLE                     
736800             WHEN SQLCODE = +100                                          
736900                  MOVE SPACES      TO PV-SM-VENDOR-STYLE                  
737000             WHEN SQLCODE = -811                                          
737100                  MOVE 'MULTI   '  TO PV-SM-VENDOR-STYLE                  
737200             WHEN SQLCODE = -904                                          
737300             WHEN SQLCODE = -913                                          
737400                  CONTINUE                                                
737500                                                                          
737600             WHEN SQLWARN0 NOT = SPACES                                   
737700             WHEN SQLCODE < +0                                            
737800             WHEN SQLCODE > +0                                            
737900                  MOVE '9965-GET-VENDOR-STYLE'                            
738000                                  TO DP013-PARAGRAPH                      
738100                  MOVE 'UNSUCCESSFUL SELECT MIN AD DATE '                 
738200                                  TO DP013-MESSAGE-TEXT (1)               
738300                  MOVE SQLCA      TO DP013-SQLCA                          
738400                  MOVE 'TPURITM ' TO DP013-DB2-TABLE-NAME (1)             
738500                  SET DP013-DB2-ABEND                                     
738600                      DP013-XCTL-DISPLAY-RESTART                          
738700                                  TO TRUE                                 
738800                 PERFORM 9999-SQL-ABEND                                   
738900         END-EVALUATE.                                                    
739000                                                                          
739100*----------------------------------------------------------------*        
739200*  DETERMINE TOTAL COST AND RETAIL DOLLARS AND UNITS             *        
739300*  IGNORE THE MIN  ,MIN(B.TOT_VAL_RTL_AMT)                       *        
739400*                  ,MIN(B.TOT_UNT_QTY)                           *        
739500*  SINCE THE SQL WILL ONLY PULL BACK 1 TPURCHS ROW THE           *        
739600*  TOTAL RETAIL AND UNIT WILL ALWAYS BE THE SAME                 *        
739700*  THE SQL WAS WRITTEN THIS WAY FOR THE PROGRAM TO BIND.         *        
739800*----------------------------------------------------------------*        
739900 9970-GET-TOTAL-COST.                                                     
740000                                                                          
740100         EXEC SQL                                                         
740200          SELECT SUM(DECIMAL                                              
740300                    (A.UNT_COST_AMT * A.UNT_QTY,9,2))                     
740400                ,SUM(DECIMAL                                              
740500                    (A.PRD_1ST_COST_AMT * A.UNT_QTY,9,2))                 
740600              INTO  :PV-TOT-TTC:PV-NULL-IND-1                             
740700                   ,:PV-TOT-FIRST-COST:PV-NULL-IND-2                      
740800             FROM TPURITM A                                               
740900             WHERE A.PO_NBR         = :DK-PO-NBR                          
741000               AND A.VER_STATUS_CDE = 'A'                                 
741100               AND A.STATUS_CDE    <> 'CA'                                
741200         END-EXEC.                                                        
741300                                                                          
741400         EVALUATE TRUE                                                    
741500             WHEN SQLCODE = +0                                            
741600             WHEN SQLCODE = -811                                          
741700                  IF  PV-NULL-IND-1 < +0                                  
741800                      MOVE +0      TO PV-TOT-TTC                          
741900                  END-IF                                                  
742000                  IF  PV-NULL-IND-2 < +0                                  
742100                      MOVE +0      TO PV-TOT-FIRST-COST                   
742200                  END-IF                                                  
742300             WHEN SQLCODE = +100                                          
742400             WHEN SQLCODE = -904                                          
742500             WHEN SQLCODE = -913                                          
742600                  MOVE +0     TO PV-TOT-FIRST-COST                        
742700                  MOVE +0     TO PV-TOT-TTC                               
742800             WHEN SQLWARN0 NOT = SPACES                                   
742900             WHEN SQLCODE < +0                                            
743000             WHEN SQLCODE > +0                                            
743100                  MOVE '9970-GET-TOTAL-COST'                              
743200                                  TO DP013-PARAGRAPH                      
743300                  MOVE 'UNSUCCESSFUL SELECT OF TOTAL COST'                
743400                                  TO DP013-MESSAGE-TEXT (1)               
743500                  MOVE SQLCA      TO DP013-SQLCA                          
743600                  MOVE 'TPURITM ' TO DP013-DB2-TABLE-NAME (1)             
743700                  SET DP013-DB2-ABEND                                     
743800                      DP013-XCTL-DISPLAY-RESTART                          
743900                                  TO TRUE                                 
744000                 PERFORM 9999-SQL-ABEND                                   
744100         END-EVALUATE.                                                    
744200                                                                          
744300                                                                          
744400 EJECT                                                                    
744500*----------------------------------------------------------------*        
744600*  DETERMINE TOTAL COST FOR VERIFIED UNITS                       *        
744700*----------------------------------------------------------------*        
744800 9975-GET-TOTAL-VERIFIED-COST.                                            
744900                                                                          
745000         EXEC SQL                                                         
745100          SELECT SUM(DECIMAL                                              
745200                    (A.UNT_COST_AMT * C.AP_VERIFY_ITM_QTY))               
745300              INTO  :PV-TOT-TVC:PV-NULL-IND-1                             
745400              FROM  TPURITM A                                             
745500                   ,TRECITM B                                             
745600                   ,TRECDIS C                                             
745700             WHERE A.PO_NBR         = :DK-PO-NBR                          
745800               AND A.APP_PO_LNE_NBR = B.ORD_LNE_NBR                       
745900               AND A.VER_NBR        = B.PO_VER_NBR                        
746000               AND B.ORD_NBR        = A.PO_NBR                            
746100               AND B.STATUS_CDE     = 'VE'                                
746200               AND B.VER_STATUS_CDE = 'A'                                 
746300               AND C.ORD_NBR        = A.PO_NBR                            
746400               AND C.ORD_LNE_NBR    = B.ORD_LNE_NBR                       
746500               AND C.REC_SEQ_NBR    = B.REC_SEQ_NBR                       
746700         END-EXEC.                                                        
746800                                                                          
746900         EVALUATE TRUE                                                    
747000             WHEN SQLCODE = +0                                            
747100             WHEN SQLCODE = -811                                          
747200                  IF  PV-NULL-IND-1 < +0                                  
747300                      MOVE +0      TO PV-TOT-TVC                          
747400                  END-IF                                                  
747500             WHEN SQLCODE = +100                                          
747600             WHEN SQLCODE = -904                                          
747700             WHEN SQLCODE = -913                                          
747800                  MOVE +0     TO PV-TOT-TVC                               
747900             WHEN SQLWARN0 NOT = SPACES                                   
748000             WHEN SQLCODE < +0                                            
748100             WHEN SQLCODE > +0                                            
748200                  MOVE '9975-GET-TOTAL-VERIFIED-COST'                     
748300                                  TO DP013-PARAGRAPH                      
748400                  MOVE 'UNSUCCESSFUL SELECT OF VERIFIED COST'             
748500                                  TO DP013-MESSAGE-TEXT (1)               
748600                  MOVE SQLCA      TO DP013-SQLCA                          
748700                  MOVE 'TRECDIS ' TO DP013-DB2-TABLE-NAME (1)             
748800                  SET DP013-DB2-ABEND TO TRUE                             
748900                  PERFORM 9999-SQL-ABEND                                  
749000         END-EVALUATE.                                                    
749100                                                                          
749200 EJECT                                                                    
749300*----------------------------------------------------------------*        
749400*   OPEN THE CURSOR                                              *        
749500*----------------------------------------------------------------*        
749600                                                                          
749700 9980-OPEN-SHIP-CSR.                                                      
749800         EXEC SQL                                                         
749900             OPEN SHIP_DATA_CSR                                           
750000         END-EXEC.                                                        
750100                                                                          
750200         EVALUATE TRUE                                                    
750300             WHEN SQLCODE = ZERO                                          
750400             WHEN SQLCODE = -904                                          
750500             WHEN SQLCODE = -913                                          
750600                 CONTINUE                                                 
750700             WHEN SQLWARN0 NOT = SPACES                                   
750800             WHEN SQLCODE < ZERO                                          
750900             WHEN SQLCODE > ZERO                                          
751000                 MOVE '9980-OPEN-CURSOR'                                  
751100                                   TO DP013-PARAGRAPH                     
751200                 MOVE 'OPEN CURSOR - '                                    
751300                                   TO DP013-MESSAGE-TEXT (1)              
751400                 MOVE SQLCA        TO DP013-SQLCA                         
751500                 MOVE 'SHIP'        TO DP013-DB2-TABLE-NAME (1)           
751600                 SET DP013-DB2-ABEND                                      
751700                     DP013-XCTL-DISPLAY-RESTART TO TRUE                   
751800                 PERFORM 9999-SQL-ABEND                                   
751900         END-EVALUATE.                                                    
752000 EJECT                                                                    
752100*----------------------------------------------------------------*        
752200*   CLOSE THE CURSOR                                             *        
752300*----------------------------------------------------------------*        
752400 9990-CLOSE-SHIP-CSR.                                                     
752500                                                                          
752600         EXEC SQL                                                         
752700             CLOSE SHIP_DATA_CSR                                          
752800         END-EXEC.                                                        
752900                                                                          
753000         EVALUATE TRUE                                                    
753100             WHEN SQLCODE = ZERO                                          
753200             WHEN SQLCODE = -904                                          
753300             WHEN SQLCODE = -913                                          
753400                 CONTINUE                                                 
753500             WHEN SQLWARN0 NOT = SPACES                                   
753600             WHEN SQLCODE < ZERO                                          
753700             WHEN SQLCODE > ZERO                                          
753800                 MOVE '9990-CLOSE-CURSOR'                                 
753900                                   TO DP013-PARAGRAPH                     
754000                 MOVE 'OPEN CURSOR - '                                    
754100                                   TO DP013-MESSAGE-TEXT (1)              
754200                 MOVE SQLCA        TO DP013-SQLCA                         
754300                 MOVE 'SHIP'        TO DP013-DB2-TABLE-NAME (1)           
754400                 SET DP013-DB2-ABEND                                      
754500                     DP013-XCTL-DISPLAY-RESTART TO TRUE                   
754600                 PERFORM 9999-SQL-ABEND                                   
754700         END-EVALUATE.                                                    
754800 EJECT                                                                    
754900******************************************************************        
755000*  STANDARD DB2 ERROR ABEND ROUTINE                                       
755100*  THIS ROUTINE FORCES AN ABEND DUE TO A DB2 PROBLEM.                     
755200******************************************************************        
755300 9999-SQL-ABEND.                                                          
755400                                                                          
755500     MOVE +4013                 TO ABEND-CODE.                            
755600     DISPLAY '**  ABEND     **'.                                          
755700     DISPLAY '**  PROGRAM   **  = TRKUT194'.                              
755800     DISPLAY '**  PARAGRAPH **  = ' PV-PARAGRAPH-NAME.                    
755900     DISPLAY '**  OPERATION **  = ' PV-DB2-OPERATION-ATTEMPTED.           
756000                                                                          
756100*    THE FOLLOWING COPYBOOK UTILIZES THE DB2 ABEND MODULE                 
756200*    DSNTIAR TO CONVERT SQLCA INTO UNDERSTANDABLE VERBAGE.                
756300                                                                          
756400     COPY DPPD004.                                                        
756500                                                                          
756600     CALL 'ILBOABN0'  USING ABEND-CODE.                                   
756700                                                                          
756800*----------------------------------------------------------------*        
