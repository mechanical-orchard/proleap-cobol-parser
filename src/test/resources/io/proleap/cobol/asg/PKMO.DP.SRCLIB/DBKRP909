      ***************************************************************** 00010000
       IDENTIFICATION DIVISION.                                         00020000
      ***************************************************************** 00030000
       PROGRAM-ID.      DBKRP909.                                       00040000
       AUTHOR.          COLLEEN VOIGT.                                  00050000
       INSTALLATION.    KOHLS DEPARTMENT STORES.                        00060000
       DATE-WRITTEN.    DECEMBER 2003.                                  00070000
                                                                        00080000
      ***************************************************************** 00090000
      *           DB2 DATASET EXTENT REPORT                           * 00100000
      ***************************************************************** 00110000
      *  THIS PROGRAM PROCESS THE EXTENT FILE CREATED IN DBKUT909.    * 00120000
      *  THE REPORT SHOWS THE NUMBER OF EXTENTS IN DESCENDING ORDER   * 00130000
      *  BY DATASET NAME.                                             * 00140000
      *                                                               * 00150000
      ***************************************************************** 00180000
      *    WR/PITS#     DATE        DESCRIPTION                       * 00190000
      *    --------   ----------   ---------------------------------  * 00200000
      *                                                               * 00210000
      ***************************************************************** 00220000
       ENVIRONMENT DIVISION.                                            00230000
      ***************************************************************** 00240000
                                                                        00250000
       CONFIGURATION SECTION.                                           00260000
                                                                        00270000
       SOURCE-COMPUTER.       IBM-3090.                                 00280000
       OBJECT-COMPUTER.       IBM-3090.                                 00290000
                                                                        00300000
       INPUT-OUTPUT SECTION.                                            00310000
                                                                        00320000
       FILE-CONTROL.                                                    00330000
           SELECT EXTENT-FILE     ASSIGN TO INP01.                      00340002
           SELECT EXTENT-RPT      ASSIGN TO RPT01.                      00360006
                                                                        00370006
                                                                        00380000
                                                                        00390000
      ***************************************************************** 00400000
       DATA DIVISION.                                                   00410000
      ***************************************************************** 00420000
       FILE SECTION.                                                    00430000
                                                                        00440000
       FD  EXTENT-FILE                                                  00450002
           RECORDING MODE F                                             00460000
           BLOCK CONTAINS 0 RECORDS                                     00470000
           LABEL RECORDS ARE OMITTED.                                   00480000
       01  EXTENT-FILE-DATA                 PIC  X(80).                 00490006
                                                                        00500000
       FD  EXTENT-RPT                                                   00570003
           RECORDING MODE F                                             00580000
           LABEL RECORDS ARE STANDARD                                   00590000
           RECORD CONTAINS 132 CHARACTERS                               00600000
           BLOCK CONTAINS  0 RECORDS                                    00610000
           DATA RECORD IS EXTENT-RPT-REC.                               00620006
       01  EXTENT-RPT-REC                   PIC X(132).                 00630006
                                                                        00640000
      ***************************************************************** 00650000
       WORKING-STORAGE SECTION.                                         00660000
      ***************************************************************** 00670000
      *                                                                 00680009
       01  WS-EXTENT-FILE.                                              00880009
           05  WS-DATASET-NAME           PIC X(42).                     00890009
           05  WS-VOL                    PIC X(04).                     00891009
           05  WS-TRK                    PIC X(08).                     00892009
           05  WS-XTS                    PIC X(04).                     00893009
           05  FILLER                    PIC X(22).                     00894004
                                                                        01060000
      ***************************************************************** 01070000
      *    PROGRAM CONSTANTS                                            01080000
      ***************************************************************** 01090000
       01  WS-PROGRAM-CONSTANTS.                                        01100010
           05  WS-PAGE-SIZE              PIC S9(02)    VALUE +55.       01171010
                                                                        01180000
      ***************************************************************** 01190000
      *    PROGRAM SWITCHES                                             01200000
      ***************************************************************** 01210000
       01  PS-PROGRAM-SWITCHES.                                         01220000
           05  PS-EXTENT-FILE-SW         PIC X(01) VALUE 'N'.           01230002
               88  PS-EXTENT-FILE-END              VALUE 'Y'.           01240002
               88  PS-EXTENT-FILE-START            VALUE 'N'.           01250002
                                                                        01350000
      ***************************************************************** 01360000
      *    PROGRAM VARIABLES                                            01370000
      ***************************************************************** 01380000
       01  WS-PROGRAM-VARIABLES.                                        01390009
           05  WS-LINE-CNT                PIC S9(02)   VALUE +56.       01420009
           05  WS-PAGE-NBR                PIC S9(05)   VALUE ZERO.      01422009
                                                                        01430000
           05  SD-SYSTEM-DATE.                                          01440000
               10  SD-SYSTEM-YEAR         PIC 9(02)    VALUE ZERO.      01450000
               10  SD-SYSTEM-MONTH        PIC 9(02)    VALUE ZERO.      01460000
               10  SD-SYSTEM-DAY          PIC 9(02)    VALUE ZERO.      01470000
                                                                        01480000
           05  ST-SYSTEM-TIME.                                          01490000
               10  ST-SYSTEM-TIME-FORMAT.                               01500000
                   15  ST-SYSTEM-HOUR     PIC 9(02)    VALUE ZERO.      01510000
                   15  ST-SYSTEM-MINUTE   PIC 9(02)    VALUE ZERO.      01520000
                   15  ST-SYSTEM-SECOND   PIC 9(02)    VALUE ZERO.      01530000
               10  ST-SYSTEM-TIME-NUM  REDEFINES                        01540000
                                        ST-SYSTEM-TIME-FORMAT           01550000
                                          PIC 9(06).                    01560000
               10  FILLER                 PIC X(4)      VALUE SPACES.   01570000
                                                                        01580000
      ***************************************************************** 02030000
      *  STANDARD HEADING FOR 132 COLUMNS                               02040000
      ***************************************************************** 02050000
           COPY DPWS132O.                                               02060000
                                                                        02070000
       01  HL1-HEADING-LINE.                                            02080000
           05  FILLER                PIC X(53)     VALUE SPACES.        02090019
           05  FILLER                PIC X(26)     VALUE                02100019
               'DB2 DATASET EXTENTS REPORT'.                            02110019
           05  FILLER                PIC X(53)     VALUE SPACES.        02120019
                                                                        02120107
       01  DH1-DETAIL-HEADING-LINE-1.                                   02121007
           05  FILLER                      PIC  X(16)      VALUE SPACES.02122007
00119      05  FILLER                      PIC  X(13)      VALUE        02123007
00120          'DATASET NAME '.                                         02124007
00123      05  FILLER                      PIC  X(29)      VALUE SPACES.02125016
00123      05  FILLER                      PIC  X(06)      VALUE        02126007
00124          'NUMBER'.                                                02127007
00123      05  FILLER                      PIC  X(15)      VALUE SPACES.02128016
00125      05  FILLER                      PIC  X(05)      VALUE        02129007
00126          'TOTAL'.                                                 02129107
00123      05  FILLER                      PIC  X(19)      VALUE SPACES.02129207
00127      05  FILLER                      PIC  X(05)      VALUE        02129307
00128          'TOTAL'.                                                 02129407
00129                                                                   02129507
00130  01  DH1-DETAIL-HEADING-LINE-2.                                   02129607
00131      05  FILLER                      PIC  X(58)      VALUE SPACES.02129716
00132      05  FILLER                      PIC  X(07)      VALUE        02129807
00133          'VOLUMES'.                                               02129907
00131      05  FILLER                      PIC  X(14)      VALUE SPACES.02130016
00132      05  FILLER                      PIC  X(06)      VALUE        02130107
00133          'TRACKS'.                                                02130207
00131      05  FILLER                      PIC  X(17)      VALUE SPACES.02130315
00132      05  FILLER                      PIC  X(07)      VALUE        02130407
00133          'EXTENTS'.                                               02130507
00150                                                                   02130607
00151  01  DL-DETAIL-LINE.                                              02130707
00152      05  FILLER                      PIC  X(05)      VALUE SPACES.02130807
00153      05  DL-DATASET-NAME             PIC  X(42)      VALUE SPACES.02130908
00154      05  FILLER                      PIC  X(11)      VALUE SPACES.02131018
00155      05  DL-VOL                      PIC  ZZZ9       VALUE ZERO.  02131107
00156      05  FILLER                      PIC  X(14)      VALUE SPACES.02131218
00157      05  DL-TRK                      PIC  ZZZZZZZ9   VALUE ZERO.  02131307
00158      05  FILLER                      PIC  X(19)      VALUE SPACES.02131507
00159      05  DL-XTS                      PIC  ZZZ9       VALUE ZERO.  02131607
           05  FILLER                      PIC  X(25)      VALUE SPACES.02131715
00287                                                                   02131907
00288  01  END-OF-REPORT-LINE.                                          02132007
00289      05  FILLER                      PIC  X(54)      VALUE SPACE. 02132107
00290      05  FILLER                      PIC  X(25)      VALUE        02132207
00291          '***** END OF REPORT *****'.                             02132307
00292      05  FILLER                      PIC  X(53)      VALUE SPACE. 02132407
00293                                                                   02132507
00294  01  BLANK-LINE                      PIC X(132)      VALUE SPACES.02132607
00295                                                                   02132707
                                                                        02510000
                                                                        02810000
      ***************************************************************** 02830000
      *    ABEND CODES                                                  02840009
      ***************************************************************** 02850000
       01  WS-ABEND-CODE               PIC S9(4)    VALUE ZEROS         02860010
                                                    COMP SYNC.          02870000
                                                                        02910000
      ***************************************************************** 02920000
       PROCEDURE DIVISION.                                              02930000
      ***************************************************************** 02940000
       0000-MAINLINE.                                                   02950000
                                                                        02960000
           PERFORM 1000-INITIALIZE.                                     02970000
           PERFORM 1050-PREPARE-HEADING-DATA.                           02980000
                                                                        02980108
           PERFORM 8000-READ-EXTENT-FILE.                               02980208
                                                                        02990000
           PERFORM 2000-PROCESS-EXTENT-FILE                             03110009
                    UNTIL PS-EXTENT-FILE-END.                           03120008
                                                                        03150000
           PERFORM 3000-EOJ-PROCESSING.                                 03160000
                                                                        03170000
           GOBACK.                                                      03180008
                                                                        03190000
      ***************************************************************** 03200000
      *  INITIALIZATION ROUTINE.                                        03210000
      ***************************************************************** 03220000
       1000-INITIALIZE.                                                 03230000
                                                                        03240000
           SET PS-EXTENT-FILE-START TO TRUE.                            03280002
           INITIALIZE DL-DETAIL-LINE.                                   03300009
                                                                        03320000
           OPEN INPUT EXTENT-FILE                                       03330002
           OPEN OUTPUT EXTENT-RPT.                                      03350003
                                                                        03360000
      ***************************************************************** 03930000
      *  THIS PARAGRAPH PREPARES THE HEADING DATA THAT WILL BE PRINTED  03940008
      *  ON THE REPORT.                                                 03950000
      ***************************************************************** 03960000
       1050-PREPARE-HEADING-DATA.                                       03970000
                                                                        03980000
           ACCEPT SD-SYSTEM-DATE FROM DATE.                             03990000
           MOVE SD-SYSTEM-MONTH        TO DP132O-RUN-MONTH.             04000000
           MOVE SD-SYSTEM-DAY          TO DP132O-RUN-DAY.               04010000
           MOVE SD-SYSTEM-YEAR         TO DP132O-RUN-YEAR.              04020000
                                                                        04030000
           ACCEPT ST-SYSTEM-TIME FROM TIME.                             04040000
           MOVE ST-SYSTEM-HOUR         TO DP132O-RUN-HOUR.              04050000
           MOVE ST-SYSTEM-MINUTE       TO DP132O-RUN-MINUTE.            04060000
                                                                        04061008
           MOVE 'DBKRP909'             TO DP132O-PROGRAM-NAME.          04062008
           MOVE 1                      TO DP132O-REPORT-NUMBER.         04063011
                                                                        06080000
      ***************************************************************** 06090000
      *  PROCESS EXTENT FILE.                                           06100008
      ***************************************************************** 06110000
       2000-PROCESS-EXTENT-FILE.                                        06120008
                                                                        06130000
           MOVE WS-DATASET-NAME            TO DL-DATASET-NAME.          06140009
           MOVE WS-VOL                     TO DL-VOL.                   06140109
           MOVE WS-TRK                     TO DL-TRK.                   06140209
           MOVE WS-XTS                     TO DL-XTS.                   06140309
                                                                        06141000
                                                                        06290000
           IF WS-LINE-CNT > WS-PAGE-SIZE                                06452009
              PERFORM 2200-WRITE-PAGE-HEADINGS                          06453011
           END-IF.                                                      06460200
                                                                        06460311
           PERFORM 2400-WRITE-RPT-RECORD                                06460411
                                                                        06461000
           PERFORM 8000-READ-EXTENT-FILE.                               06461111
                                                                        06461211
      ***************************************************************** 06461300
      *  THIS PARAGRAPH WILL WRITE THE PAGE HEADINGS.                   06461411
      ***************************************************************** 06461500
       2200-WRITE-PAGE-HEADINGS.                                        06461611
                                                                        06461700
           ADD +1   TO WS-PAGE-NBR.                                     06461909
           MOVE WS-PAGE-NBR TO DP132O-PAGE-NUMBER.                      06462109
                                                                        06462300
           WRITE EXTENT-RPT-REC FROM DP132O-STANDRD-HEADER-132-COLS     06463411
                AFTER ADVANCING PAGE.                                   06463609
                                                                        06463709
           MOVE SPACES TO DP132O-LASER-NEW-PAGE-INDICATR.               06463809
                                                                        06463909
           WRITE EXTENT-RPT-REC FROM HL1-HEADING-LINE                   06464011
                AFTER ADVANCING 2 LINE.                                 06464211
                                                                        06464309
           WRITE EXTENT-RPT-REC FROM DH1-DETAIL-HEADING-LINE-1          06464811
              AFTER ADVANCING 2 LINE.                                   06465011
                                                                        06465109
           WRITE EXTENT-RPT-REC FROM DH1-DETAIL-HEADING-LINE-2          06465211
              AFTER ADVANCING 1 LINE.                                   06465311
                                                                        06465411
           WRITE EXTENT-RPT-REC FROM BLANK-LINE                         06465511
              AFTER ADVANCING 1 LINES.                                  06465611
                                                                        06465711
           MOVE +7  TO WS-LINE-CNT.                                     06465811
                                                                        06465911
      ***************************************************************** 06466011
      *  WRITE THE REPORT RECORD.                                       06466111
      ***************************************************************** 06466211
       2400-WRITE-RPT-RECORD.                                           06466311
                                                                        06466411
           WRITE EXTENT-RPT-REC FROM DL-DETAIL-LINE                     06466511
              AFTER ADVANCING 2 LINES.                                  06466611
                                                                        06466711
           ADD +2 TO WS-LINE-CNT.                                       06466811
                                                                        06466911
      ***************************************************************** 06467011
      *  CLOSE FILES AND DISPLAY PROGRAM TOTALS.                        06467111
      ***************************************************************** 06467211
       3000-EOJ-PROCESSING.                                             06467311
                                                                        06467400
           WRITE EXTENT-RPT-REC FROM DL-DETAIL-LINE                     06468011
              AFTER ADVANCING 2 LINES.                                  06469011
                                                                        06530000
           CLOSE EXTENT-FILE                                            06540004
                 EXTENT-RPT.                                            06570011
                                                                        06580000
      ***************************************************************** 06671000
      * READ INPUT FILE TO GET EXTENT INFORMATION.                      06680008
      ***************************************************************** 06690000
       8000-READ-EXTENT-FILE.                                           06700002
                                                                        06710000
            READ EXTENT-FILE INTO WS-EXTENT-FILE                        06720009
                AT END                                                  06730000
                    SET PS-EXTENT-FILE-END TO TRUE.                     06740002
                                                                        06750000
      ************************************************************      06760009
      * THIS PARAGRAPH PERFORMS ABEND PROCESSING                 *      06770009
      ************************************************************      06780009
                                                                        06790009
       9999-ABEND.                                                      06800009
                                                                        06810009
           CALL 'ILBOABN0' USING WS-ABEND-CODE.                         06820012
                                                                        06830009
