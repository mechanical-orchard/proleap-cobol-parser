000100******************************************************************11/10/93
000200 IDENTIFICATION DIVISION.                                         PSKRP063
000300******************************************************************   LV001
000400                                                                  PSKRP063
000500 PROGRAM-ID.             PSKRP063.                                PSKRP063
000600 AUTHOR.                 MEL MATTSON.                             PSKRP063
000700 INSTALLATION.           KOHLS DEPARTMENT STORES.                 PSKRP063
000800 DATE-WRITTEN            JANUARY 1991.                            PSKRP063
000900 DATE-COMPILED.                                                   PSKRP063
001000                                                                  PSKRP063
001100******************************************************************PSKRP063
001200*  REPLACES KDU1007  (ALSO DYL280)                               *PSKRP063
001300*  THE MAINSTREET REFERENCE WAS REMOVED AND STANDARD REPORT      *PSKRP063
001400*  HEADER INSERTED, ETC.                                         *PSKRP063
001500*                                                                *PSKRP063
001600*  PROGRAM SIMPLY PRINTS THE GIFT CERTIFICATE DETAIL FOR A GIVEN *PSKRP063
001700*  DATE BY STORE, SHOWING THE SALE AMOUNT, REDEMPTION AMOUNT,    *   CL*12
001800*  STORE NUMBER, GIFT CERTIFICATE NUMBER, CLERK, TRANSACTION     *   CL*12
001900*  NUMBER, TRANSACTION TIME, AND SALE TYPE  (QUALIFICATION CODE).*   CL*12
002000*                                                                *PSKRP063
002100*  06/12/97 - A. REILAND - WR 5220 GIFT CARDS.                   *   CL*12
002200*  PROGRAM WAS CHANGED FROM DYL TO COBOL.                        *   CL*12
002300*  PROGRAM WAS CHANGED TO HANDLE GIFT CARDS.  THE REPORT WAS     *   CL*12
002400*  CHANGED TO BE SORTED INTO STORE, REGISTER, GIFT CERT/CARD     *   CL*12
002500*  SEQUENCE.  STORE AND COMPANY TOTALS WILL BE ACCUMULATED BY    *   CL*12
002600*  GIFT CARD TYPE (CERTIFICATE VS. CARD).                        *   CL*12
002700*                                                                *        
002800*  10/23/97 - D. ROUSAR                                          *        
002900*  CHANGED THE STORE NUMBER FROM ZZZZ TO 9(04) FOR INFOPAK USE   *        
003000*                                                                *        
003100*  10/10/98 - A. REILAND                                         *        
003200*  ADDED TOTALS FOR KOHL'S CARES FOR KIDS CARDS.  CARD TYPE 3 ON *        
003300*  THE INPUT FILE.                                               *        
003400*  A NEW SET OF PAYMENT TOTALS FOR CARDS REDEEMED VIA A PAYMENT  *        
003500*  TRANSATION WILL ALSO BE PRODUCED ON THE REPORT AT A STORE AND *        
003600*  COMPANY LEVEL.                                                *        
003601*                                                                         
003610*  01/21/02 - MICHELE RINDFLEISCH   WR#: WR23176                *         
003611*  ADDED CODE FOR NEW STORED VALUE TABLES FOR MULTI-CHANNEL     *         
003612*  GIFT CARDS.                                                  *         
003612*  FIXED PAYMENT TRAN TYPE TO LOOK AT 30 RATHER THAN 5.        *          
FL0902******************************************************************        
FL0902*  04/20/09  JIM HUNTER             WR#: WR36454                          
FL0902*  (REFER TO 'FL0902' FOR ALL CHANGES)                                    
FL0902*  THESE ARE THE FALL 2009 POS CHANGES FOR THE EXPANSION OF THE           
FL0902*  KOHL'S GIFT CARDS FROM 13 DIGITS TO 30 DIGITS.  ONLY THE LAST          
FL0902*  12 DIGITS WILL BE REQUIRED FOR REPORTING PURPOSES.                     
FL0902******************************************************************        
268841*  04/07/22  BARB SCHULTZ          CHG#: CHG0268841                       
268841*  ADDED SEPHORA GIFT CARD TOTALS FOR EACH STORE, THE COMPANY             
268841*  TOTALS AND COMPANY PAYMENTS.  CHANGED THE TITLE OF THE REPORT          
268841*  TO GIFT CARD REPORTING. ALSO ADDED A GIFT TYPE COLUMN TO               
268841*  DISTINGUISH WHAT TYPE OF GIFT CARD IT IS.                              
268841******************************************************************        
003713******************************************************************        
003800                                                                  PSKRP063
003900******************************************************************PSKRP063
004000 ENVIRONMENT DIVISION.                                            PSKRP063
004100******************************************************************PSKRP063
004200                                                                  PSKRP063
004300 CONFIGURATION SECTION.                                           PSKRP063
004400                                                                  PSKRP063
004500 SOURCE-COMPUTER.        IBM-3090.                                PSKRP063
004600 OBJECT-COMPUTER.        IBM-3090.                                PSKRP063
004700                                                                  PSKRP063
004800 INPUT-OUTPUT SECTION.                                            PSKRP063
004900                                                                  PSKRP063
005000 FILE-CONTROL.                                                    PSKRP063
005100                                                                  PSKRP063
005200     SELECT GIFT-CERTIFICATE-FILE                                 PSKRP063
005300         ASSIGN TO INP01.                                         PSKRP063
005400                                                                  PSKRP063
005500     SELECT GIFT-CERT-DETAIL-REPORT                               PSKRP063
005600         ASSIGN TO RPT01.                                         PSKRP063
005700                                                                  PSKRP063
005800******************************************************************PSKRP063
005900 DATA DIVISION.                                                   PSKRP063
006000******************************************************************PSKRP063
006100                                                                  PSKRP063
006200 FILE SECTION.                                                    PSKRP063
006300                                                                  PSKRP063
006400 FD  GIFT-CERTIFICATE-FILE                                        PSKRP063
006500     RECORDING MODE IS F                                          PSKRP063
006600     LABEL RECORDS ARE STANDARD                                   PSKRP063
006700     BLOCK CONTAINS 0 RECORDS                                     PSKRP063
006800     RECORD CONTAINS 50 CHARACTERS                                PSKRP063
006900     DATA RECORD IS GC-GIFT-CERTIFICATE-RECORD.                   PSKRP063
007000                                                                  PSKRP063
007100 01  GC-GIFT-CERTIFICATE-RECORD  PIC X(50).                       PSKRP063
007200                                                                  PSKRP063
007300 FD  GIFT-CERT-DETAIL-REPORT                                      PSKRP063
007400     RECORDING MODE IS F                                          PSKRP063
007500     LABEL RECORDS ARE STANDARD                                   PSKRP063
007600     BLOCK CONTAINS 0 RECORDS                                     PSKRP063
007700     RECORD CONTAINS 75 CHARACTERS                                PSKRP063
007800     DATA RECORD IS GC-GIFT-CERT-DETAIL-LINE.                     PSKRP063
007900                                                                  PSKRP063
008000 01  GC-GIFT-CERT-DETAIL-LINE    PIC X(75).                       PSKRP063
008100                                                                  PSKRP063
008200 WORKING-STORAGE SECTION.                                         PSKRP063
008300                                                                  PSKRP063
008400*                                                                 PSKRP063
008500*  GIFT CERTIFICATE FILE RECORD LAYOUT                            PSKRP063
008600*                                                                 PSKRP063
008700                                                                  PSKRP063
008800     COPY PSRD003.                                                PSKRP063
008900*                                                                 PSKRP063
009000*  STANDARD REPORT HEADER FOR A 75 COLUMN REPORT                  PSKRP063
009100*                                                                 PSKRP063
009200                                                                  PSKRP063
009300     COPY DPWS075O.                                               PSKRP063
009400                                                                  PSKRP063
009500 01  ABEND-CODE                  PIC S9(4)    VALUE ZEROS         PSKRP063
009600                                              COMP SYNC.          PSKRP063
009700                                                                  PSKRP063
009800 01  PS-PROGRAM-SWITCHES.                                         PSKRP063
009900     05  PS-END-OF-GIFT-CERT-FILE-IND                             PSKRP063
010000                                 PIC X(1)     VALUE 'N'.          PSKRP063
010100         88  PS-END-OF-GIFT-CERT-FILE         VALUE 'Y'.          PSKRP063
010200         88  PS-NOT-END-OF-GIFT-CERT-FILE     VALUE 'N'.          PSKRP063
010300                                                                  PSKRP063
010400 01  PC-PROGRAM-CONSTANTS.                                        PSKRP063
010500     05  PC-CURRENT-PROGRAM-NAME PIC X(8)     VALUE 'PSKRP063'.   PSKRP063
010600     05  PC-STORE-TOTAL-CERT.                                        CL**5
010700         10  FILLER              PIC X(06)    VALUE                  CL**5
010800         'STORE '.                                                   CL**5
010900         10  PC-STORE-NBR-CERT   PIC X(04)    VALUE SPACES.          CL**5
011000         10  FILLER              PIC X(19)    VALUE                  CL**5
011100         ' TOTAL GIFT CERT:  '.                                      CL**5
011200     05  PC-STORE-TOTAL-CARD.                                        CL**5
011300         10  FILLER              PIC X(06)    VALUE                  CL**5
011400         'STORE '.                                                   CL**5
011500         10  PC-STORE-NBR-CARD   PIC X(04)    VALUE SPACES.          CL**5
011600         10  FILLER              PIC X(19)    VALUE                  CL**5
011700         ' TOTAL GIFT CARD:  '.                                      CL**5
268841     05  PC-STORE-TOTAL-SEGC.                                        CL**5
268841         10  FILLER              PIC X(06)    VALUE                  CL**5
268841         'STORE '.                                                   CL**5
268841         10  PC-STORE-NBR-SEGC   PIC X(04)    VALUE SPACES.          CL**5
268841         10  FILLER              PIC X(19)    VALUE                  CL**5
268841         ' TOTAL SEPHOR GC:  '.                                      CL**5
011800     05  PC-STORE-TOTAL-KCK.                                         CL**5
011900         10  FILLER              PIC X(06)    VALUE                  CL**5
012000         'STORE '.                                                   CL**5
012100         10  PC-STORE-NBR-KCK    PIC X(04)    VALUE SPACES.          CL**5
012200         10  FILLER              PIC X(19)    VALUE                  CL**5
012300         ' TOTAL  KCK CARD:  '.                                      CL**5
012400     05  PC-STORE-TOTAL          PIC X(29)    VALUE                  CL**5
012500         '             TOTAL STORE:  '.                              CL**5
012600     05  PC-COMPANY-TOTAL-CERT   PIC X(29)    VALUE                  CL**5
012700         '   COMPANY TOTAL GIFT CERT:  '.                            CL**5
012800     05  PC-COMPANY-TOTAL-CARD   PIC X(29)    VALUE                  CL**5
012900         '   COMPANY TOTAL GIFT CARD:  '.                            CL**5
268841     05  PC-COMPANY-TOTAL-SEGC        PIC X(29)    VALUE             CL**5
268841         '   COMPANY TOTAL SEPHOR GC:  '.                            CL**5
013000     05  PC-COMPANY-TOTAL-KCK    PIC X(29)    VALUE                  CL**5
013100         '   COMPANY TOTAL  KCK CARD:  '.                            CL**5
013200     05  PC-COMPANY-TOTAL        PIC X(29)    VALUE                  CL**5
013300         '             TOTAL COMPANY:  '.                            CL**5
013400     05  PC-PAGE-SIZE            PIC S9(4)    VALUE +60           PSKRP063
013500                                              COMP SYNC.          PSKRP063
013600     05  PC-PAGE-BREAK           PIC S9(4)    VALUE +61           PSKRP063
013700                                              COMP SYNC.          PSKRP063
013800     05  PC-COMPANY-LINE-COUNT   PIC S9(4)    VALUE +16              CL**3
013900                                              COMP SYNC.          PSKRP063
014000     05  PC-HEADING-LINE-COUNT   PIC S9(4)    VALUE +6               CL**3
014100                                              COMP SYNC.          PSKRP063
014200     05  PC-STORE-BREAK-LINE-COUNT                                PSKRP063
014300                                 PIC S9(4)    VALUE +6               CL**3
014400                                              COMP SYNC.          PSKRP063
014500     05  PC-PAYMENT-LINE-COUNT   PIC S9(4)    VALUE +7               CL**3
014600                                              COMP SYNC.          PSKRP063
014700     05  PC-REPORT-NUMBER        PIC S9(4)    VALUE +1            PSKRP063
014800                                              COMP SYNC.          PSKRP063
014900                                                                  PSKRP063
015000 01  PV-PROGRAM-VARIABLES.                                        PSKRP063
015100     05  PV-HOLD-STORE           PIC X(04)    VALUE SPACES.       PSKRP063
015200     05  PV-HOLD-DATE.                                            PSKRP063
015300         10  PV-HOLD-MM          PIC 9(02)    VALUE ZEROS.        PSKRP063
015400         10  PV-HOLD-DD          PIC 9(02)    VALUE ZEROS.        PSKRP063
015500         10  PV-HOLD-YY          PIC 9(02)    VALUE ZEROS.        PSKRP063
015600     05  PV-HOLD-TERM            PIC 9(04)    VALUE ZEROS.        PSKRP063
015700     05  PV-REFORMAT-REGISTER    PIC 9(04)    VALUE ZEROS.        PSKRP063
015800     05  PV-PAGE-COUNT           PIC S9(5)    VALUE ZEROS         PSKRP063
015900                                              COMP-3.             PSKRP063
016000     05  PV-LINE-COUNT           PIC S9(4)    VALUE +61           PSKRP063
016100                                              COMP SYNC.          PSKRP063
016200     05  PV-TOT-SALE-STORE-CERT  PIC S9(7)V99 VALUE +0.           PSKRP063
016300     05  PV-TOT-SALE-STORE-CARD  PIC S9(7)V99 VALUE +0.           PSKRP063
268841     05  PV-TOT-SALE-STORE-SEGC  PIC S9(7)V99 VALUE +0.           PSKRP063
016400     05  PV-TOT-SALE-STORE-KCK   PIC S9(7)V99 VALUE +0.           PSKRP063
016500     05  PV-TOT-SALE-STORE       PIC S9(7)V99 VALUE +0.           PSKRP063
016600     05  PV-TOT-REDEM-STORE-CERT PIC S9(7)V99 VALUE +0.           PSKRP063
016700     05  PV-TOT-REDEM-STORE-CARD PIC S9(7)V99 VALUE +0.           PSKRP063
268841     05  PV-TOT-REDEM-STORE-SEGC PIC S9(7)V99 VALUE +0.           PSKRP063
016800     05  PV-TOT-REDEM-STORE-KCK  PIC S9(7)V99 VALUE +0.           PSKRP063
016900     05  PV-TOT-REDEM-STORE      PIC S9(7)V99 VALUE +0.           PSKRP063
017000     05  PV-TOT-PAY-STORE-CERT   PIC S9(7)V99 VALUE +0.           PSKRP063
017100     05  PV-TOT-PAY-STORE-CARD   PIC S9(7)V99 VALUE +0.           PSKRP063
268841     05  PV-TOT-PAY-STORE-SEGC   PIC S9(7)V99 VALUE +0.           PSKRP063
017200     05  PV-TOT-PAY-STORE-KCK    PIC S9(7)V99 VALUE +0.           PSKRP063
017300     05  PV-TOT-PAY-STORE        PIC S9(7)V99 VALUE +0.           PSKRP063
017400     05  PV-NBR-PAY-STORE-CERT   PIC S9(7)    VALUE +0.           PSKRP063
017500     05  PV-NBR-PAY-STORE-CARD   PIC S9(7)    VALUE +0.           PSKRP063
268841     05  PV-NBR-PAY-STORE-SEGC   PIC S9(7)    VALUE +0.           PSKRP063
017600     05  PV-NBR-PAY-STORE-KCK    PIC S9(7)    VALUE +0.           PSKRP063
017700     05  PV-NBR-PAY-STORE        PIC S9(7)    VALUE +0.           PSKRP063
017800                                                                  PSKRP063
017900     05  PV-TOT-SALE-COMPANY-CERT                                 PSKRP063
018000                                 PIC S9(7)V99 VALUE +0.           PSKRP063
018100     05  PV-TOT-SALE-COMPANY-CARD                                 PSKRP063
018200                                 PIC S9(7)V99 VALUE +0.           PSKRP063
268841     05  PV-TOT-SALE-COMPANY-SEGC                                 PSKRP063
268841                                 PIC S9(7)V99 VALUE +0.           PSKRP063
018300     05  PV-TOT-SALE-COMPANY-KCK                                  PSKRP063
018400                                 PIC S9(7)V99 VALUE +0.           PSKRP063
018500     05  PV-TOT-SALE-COMPANY     PIC S9(7)V99 VALUE +0.           PSKRP063
018600     05  PV-TOT-REDEM-COMPANY-CERT                                PSKRP063
018700                                 PIC S9(7)V99 VALUE +0.           PSKRP063
018800     05  PV-TOT-REDEM-COMPANY-CARD                                PSKRP063
018900                                 PIC S9(7)V99 VALUE +0.           PSKRP063
268841     05  PV-TOT-REDEM-COMPANY-SEGC                                PSKRP063
268841                                 PIC S9(7)V99 VALUE +0.           PSKRP063
019000     05  PV-TOT-REDEM-COMPANY-KCK                                 PSKRP063
019100                                 PIC S9(7)V99 VALUE +0.           PSKRP063
019200     05  PV-TOT-REDEM-COMPANY    PIC S9(7)V99 VALUE +0.           PSKRP063
019300     05  PV-TOT-PAY-COMPANY-CERT PIC S9(7)V99 VALUE +0.           PSKRP063
019400     05  PV-TOT-PAY-COMPANY-CARD PIC S9(7)V99 VALUE +0.           PSKRP063
268841     05  PV-TOT-PAY-COMPANY-SEGC PIC S9(7)V99 VALUE +0.           PSKRP063
019500     05  PV-TOT-PAY-COMPANY-KCK  PIC S9(7)V99 VALUE +0.           PSKRP063
019600     05  PV-TOT-PAY-COMPANY      PIC S9(7)V99 VALUE +0.           PSKRP063
019700     05  PV-NBR-PAY-COMPANY-CERT PIC S9(7)    VALUE +0.           PSKRP063
019800     05  PV-NBR-PAY-COMPANY-CARD PIC S9(7)    VALUE +0.           PSKRP063
268841     05  PV-NBR-PAY-COMPANY-SEGC PIC S9(7)    VALUE +0.           PSKRP063
019900     05  PV-NBR-PAY-COMPANY-KCK  PIC S9(7)    VALUE +0.           PSKRP063
020000     05  PV-NBR-PAY-COMPANY      PIC S9(7)    VALUE +0.           PSKRP063
020100                                                                  PSKRP063
020200 01  CD-CURRENT-DATE.                                             PSKRP063
020300     05  CD-CURRENT-YEAR         PIC 9(2)     VALUE ZERO.         PSKRP063
020400     05  CD-CURRENT-MONTH        PIC 9(2)     VALUE ZERO.         PSKRP063
020500     05  CD-CURRENT-DAY          PIC 9(2)     VALUE ZERO.         PSKRP063
020600                                                                  PSKRP063
020700 01  CT-CURRENT-TIME.                                             PSKRP063
020800     05  CT-CURRENT-HOUR         PIC 9(2)     VALUE ZERO.         PSKRP063
020900     05  CT-CURRENT-MINUTE       PIC 9(2)     VALUE ZERO.         PSKRP063
021000     05  FILLER                  PIC 9(4)     VALUE ZERO.         PSKRP063
021100                                                                  PSKRP063
021200 01  HL2A-HEADING-LINE.                                           PSKRP063
268841     05  FILLER                  PIC X(22)    VALUE SPACES.       PSKRP063
268841     05  FILLER                  PIC X(24)    VALUE               PSKRP063
268841         'GIFT CARD REPORTING FOR '.                              PSKRP063
021600     05  HL2A-POS-MM             PIC X(02)    VALUE SPACES.       PSKRP063
021700     05  FILLER                  PIC X(01)    VALUE '/'.          PSKRP063
021800     05  HL2A-POS-DD             PIC X(02)    VALUE SPACES.       PSKRP063
021900     05  FILLER                  PIC X(01)    VALUE '/'.          PSKRP063
022000     05  HL2A-POS-YY             PIC X(02)    VALUE SPACES.       PSKRP063
268841     05  FILLER                  PIC X(17)    VALUE SPACES.       PSKRP063
022200                                                                  PSKRP063
022300 01  HL3A-HEADING-LINE.                                           PSKRP063
268841     05  FILLER                  PIC X(26)    VALUE SPACES.       PSKRP063
268841     05  FILLER                  PIC X(04)    VALUE 'GIFT'.       PSKRP063
268841     05  FILLER                  PIC X(09)    VALUE SPACES.       PSKRP063
268841     05  FILLER                  PIC X(31)    VALUE               PSKRP063
268841         'SALE          SALE        KOHLS'.                       PSKRP063
022700     05  FILLER                  PIC X(06)    VALUE SPACES.       PSKRP063
022800                                                                  PSKRP063
022900 01  HL4A-HEADING-LINE.                                           PSKRP063
268841     05  FILLER                  PIC X(01)    VALUE SPACES.       PSKRP063
268841     05  FILLER                  PIC X(42)    VALUE               PSKRP063
268841         'TERM  TRAN     GIFT NBR  TYPE  CLERK  TYPE'.                    
268841     05  FILLER                  PIC X(15)    VALUE               PSKRP063
268841         '         AMOUNT'.                                               
023300     05  FILLER                  PIC X(15)    VALUE               PSKRP063
023400         '    REDEMPTIONS'.                                       PSKRP063
023500     05  FILLER                  PIC X(02)    VALUE SPACES.       PSKRP063
023600                                                                  PSKRP063
023700 01  SB-STORE-BREAK.                                              PSKRP063
023800     05  FILLER                  PIC X(07)    VALUE 'STORE: '.    PSKRP063
023900     05  SB-STORE-NBR            PIC 9(04)    VALUE ZEROS.        PSKRP063
024000     05  FILLER                  PIC X(64)    VALUE SPACES.       PSKRP063
024100                                                                     CL**3
024200 01  DL-DETAIL-LINE.                                                 CL**3
268841     05  FILLER                  PIC X(1)     VALUE SPACES.          CL**5
024400     05  DL-TERMINAL             PIC X(04)    VALUE SPACES.          CL**5
024500     05  FILLER                  PIC X(02)    VALUE SPACES.          CL**5
024600     05  DL-TRANSACTION          PIC 9(04)    VALUE ZEROS.           CL**5
FL0902     05  FILLER                  PIC X(02)    VALUE SPACES.               
024800     05  DL-GIFT-NBR             PIC ZZZZZZZ99999                         
024900                                              VALUE ZEROS.           CL**5
FL0902     05  FILLER                  PIC X(01)    VALUE SPACES.          CL**5
268841     05  DL-GIFT-TYPE            PIC X(04)    VALUE SPACES.          CL**5
025100     05  DL-CLERK                PIC ZZZZZZZ9 VALUE ZEROS.           CL**5
025200     05  FILLER                  PIC X(02)    VALUE SPACES.               
025300     05  DL-SALE-TYPE            PIC X(02)    VALUE SPACES.          CL**5
268841     05  FILLER                  PIC X(08)    VALUE SPACES.          CL**5
025500     05  DL-SALE-AMT             PIC ZZ,ZZZ.99-                      CL**5
025600                                              VALUE ZERO.            CL**5
025700     05  FILLER                  PIC X(04)    VALUE SPACES.          CL**5
025800     05  DL-REDEMPTION-AMT       PIC ZZ,ZZZ.99-                      CL**5
025900                                              VALUE ZERO.            CL**5
026000                                                                     CL**3
026100 01  DL-DASH-LINE.                                                   CL**3
026200     05  FILLER                  PIC X(47)    VALUE SPACES.          CL**5
026300     05  FILLER                  PIC X(27)    VALUE                  CL**5
026400         '------------- -------------'.                              CL**5
026500 01  DL-PAYMENT-STORE-HEADER.                                        CL**3
026600     05  FILLER                  PIC X(05)    VALUE SPACES.          CL**5
026700     05  FILLER                  PIC X(06)    VALUE 'STORE '.        CL**5
026800     05  DL-PAYMENT-STORE        PIC X(04)    VALUE SPACES.          CL**3
026900     05  FILLER                  PIC X(55)    VALUE                  CL**3
027000      ' PAYMENTS (INCLUDED IN REDEMPTION TOTAL LISTED ABOVE):'.      CL**3
027100     05  FILLER                  PIC X(03)    VALUE SPACES.          CL**3
027200 01  DL-PAYMENT-COMPANY-HEADER.                                      CL**3
268841     05  FILLER                  PIC X(05)    VALUE SPACES.          CL**5
027400     05  FILLER                  PIC X(08)    VALUE 'COMPANY '.      CL**5
027500     05  FILLER                  PIC X(55)    VALUE                  CL**3
027600      ' PAYMENTS (INCLUDED IN REDEMPTION TOTAL LISTED ABOVE):'.      CL**3
027700     05  FILLER                  PIC X(05)    VALUE SPACES.          CL**3
027800                                                                     CL**3
027900 01  TL-TOTAL-LINE.                                                  CL**3
028000     05  FILLER                  PIC X(18)    VALUE SPACES.          CL**5
028100     05  TL-DESCRIPTION          PIC X(29)    VALUE SPACES.          CL**5
028200     05  TL-SALE-AMOUNT          PIC Z,ZZZ,ZZZ.99-                   CL**5
028300                                              VALUE ZERO.            CL**5
028400     05  FILLER                  PIC X(01)    VALUE SPACES.          CL**5
028500     05  TL-REDEMPTION-AMOUNT    PIC Z,ZZZ,ZZZ.99-                   CL**5
028600                                              VALUE ZERO.            CL**5
028700 01  TL-TOTAL-LINE-PAYMENT.                                          CL**3
028800     05  FILLER                  PIC X(18)    VALUE SPACES.          CL**5
028900     05  TL-DESCRIPTION-PAYMENT  PIC X(29)    VALUE SPACES.          CL**5
029000     05  FILLER                  PIC X(03)    VALUE SPACES.          CL**5
029100     05  TL-PAYMENT-COUNT        PIC Z,ZZZ,ZZ9                       CL**5
029200                                              VALUE ZERO.            CL**5
029300     05  FILLER                  PIC X(02)    VALUE SPACES.          CL**5
029400     05  TL-PAYMENT-AMOUNT       PIC Z,ZZZ,ZZZ.99-                   CL**5
029500                                              VALUE ZERO.            CL**5
029600                                                                     CL**3
029700******************************************************************PSKRP063
029800 PROCEDURE DIVISION.                                              PSKRP063
029900******************************************************************PSKRP063
030000                                                                  PSKRP063
030100 0000-MAINLINE.                                                   PSKRP063
030200     PERFORM 1000-INITIALIZE.                                     PSKRP063
030300                                                                  PSKRP063
030400     IF PS-NOT-END-OF-GIFT-CERT-FILE                              PSKRP063
030500         PERFORM 2000-PROCESS-STORE                               PSKRP063
030600             UNTIL PS-END-OF-GIFT-CERT-FILE                          CL**4
030700                                                                  PSKRP063
030800         ADD PC-STORE-BREAK-LINE-COUNT TO PV-LINE-COUNT           PSKRP063
030900         PERFORM 3000-CHECK-NEXT-PAGE                             PSKRP063
031000         PERFORM 6000-STORE-CONTROL-BREAK                         PSKRP063
031100         ADD PC-COMPANY-LINE-COUNT     TO PV-LINE-COUNT           PSKRP063
031200         PERFORM 3000-CHECK-NEXT-PAGE                             PSKRP063
031300         MOVE ZEROS                    TO PV-HOLD-STORE           PSKRP063
031400         PERFORM 6100-COMPANY-CONTROL-BREAK                       PSKRP063
031500     END-IF.                                                      PSKRP063
031600                                                                  PSKRP063
031700     PERFORM 9000-EOJ-ROUTINE.                                    PSKRP063
031800                                                                  PSKRP063
031900     STOP RUN.                                                    PSKRP063
032000                                                                  PSKRP063
032100******************************************************************PSKRP063
032200*1000-INITIALIZE.                                                    CL**2
032300*  SET UP FOR PROGRAM PROCESSING BY ACCEPTING AND VALIDATING THE *   CL**5
032400*  CONTROL CARD, OPENING ALL FILES, FILLING ALL THE FIELDS OF    *   CL**5
032500*  THE STANDARD REPORT HEADER, READING THE FIRST GIFT            *   CL**5
032600*  CERTIFICATE/CARD RECORD, DETERMINING THE REPORTING PERIOD,    *   CL**5
032700*  FILLING THE FIELDS OF THE OTHER REPORT TITLE LINES, BUILDING  *   CL**5
032800*  THE CORE STORE TABLE, AND INITIALIZING REQUIRED VARIABLES.    *   CL**5
032900******************************************************************PSKRP063
033000                                                                  PSKRP063
033100 1000-INITIALIZE.                                                    CL**2
033200                                                                     CL**2
033300                                                                  PSKRP063
033400     OPEN INPUT  GIFT-CERTIFICATE-FILE                               CL**2
033500          OUTPUT GIFT-CERT-DETAIL-REPORT.                            CL**6
033600                                                                     CL**2
033700     ACCEPT CD-CURRENT-DATE FROM DATE.                               CL**2
033800     MOVE CD-CURRENT-YEAR TO DP075O-RUN-YEAR.                        CL**2
033900     MOVE CD-CURRENT-MONTH TO DP075O-RUN-MONTH.                      CL**2
034000     MOVE CD-CURRENT-DAY TO DP075O-RUN-DAY.                          CL**2
034100     ACCEPT CT-CURRENT-TIME FROM TIME.                               CL**2
034200     MOVE CT-CURRENT-HOUR TO DP075O-RUN-HOUR.                        CL**2
034300     MOVE CT-CURRENT-MINUTE TO DP075O-RUN-MINUTE.                    CL**2
034400     MOVE PC-CURRENT-PROGRAM-NAME TO DP075O-PROGRAM-NAME.            CL**2
034500     MOVE PC-REPORT-NUMBER TO DP075O-REPORT-NUMBER.                  CL**5
034600                                                                     CL**2
034700     PERFORM 7000-READ-GIFT-CERT-FILE.                               CL**2
034800     IF  PS-NOT-END-OF-GIFT-CERT-FILE                             PSKRP063
034900         MOVE PS003-GIFT-DATE         TO PV-HOLD-DATE                CL**4
035000         MOVE PV-HOLD-MM              TO HL2A-POS-MM                 CL**4
035100         MOVE PV-HOLD-DD              TO HL2A-POS-DD                 CL**4
035200         MOVE PV-HOLD-YY              TO HL2A-POS-YY                 CL**4
035300         MOVE PS003-STORE-NBR         TO PV-HOLD-STORE               CL**5
035400         MOVE 0000                    TO PV-HOLD-TERM             PSKRP063
035500         MOVE PC-PAGE-BREAK           TO PV-LINE-COUNT               CL**5
035600     END-IF.                                                         CL**4
035700                                                                     CL**2
035800*1000-EXIT.                                                       PSKRP063
035900                                                                  PSKRP063
036000******************************************************************PSKRP063
036100*2000-PROCESS-STORE.                                                 CL**3
036200*  PROCESS EVERY RECORD ON THE GIFT CERTIFICATE/CARD FILE.       *   CL*12
036300*  ONE DETAIL LINE WILL PRINT FOR EACH RECORD ON THE FILE.       *   CL*12
036400*  TOTALS WILL BE ACCUMULATED BY SALES AND REDEMPTIONS, AND WHEN *   CL*12
036500*  A STORE BREAK IS FOUND, STORE LEVEL TOTALS WILL PRINT.        *   CL**5
036600******************************************************************PSKRP063
036700                                                                  PSKRP063
036800 2000-PROCESS-STORE.                                                 CL**3
036900                                                                     CL**4
037000     IF PS003-STORE-NBR = PV-HOLD-STORE                              CL**5
037100         PERFORM 3000-CHECK-NEXT-PAGE                                CL**4
037200     ELSE                                                            CL**7
037300         ADD PC-STORE-BREAK-LINE-COUNT                            PSKRP063
037400                                      TO PV-LINE-COUNT            PSKRP063
037500         PERFORM 3000-CHECK-NEXT-PAGE                             PSKRP063
037600         PERFORM 6000-STORE-CONTROL-BREAK                         PSKRP063
037700         MOVE ZEROS                   TO PV-HOLD-TERM             PSKRP063
037800     END-IF.                                                         CL**5
037900                                                                     CL**4
038000     IF PS003-TERMINAL = PV-HOLD-TERM                                CL**5
038100         MOVE SPACES                  TO DL-TERMINAL                 CL**5
038200     ELSE                                                            CL**5
038300         MOVE PS003-TERMINAL          TO PV-REFORMAT-REGISTER        CL**5
038400         MOVE PV-REFORMAT-REGISTER    TO DL-TERMINAL                 CL**5
038500                                         PV-HOLD-TERM                CL**5
038600     END-IF.                                                         CL**5
038700     MOVE PS003-TRANSACTION           TO DL-TRANSACTION.             CL**5
038800     IF PS003-GIFT-CERT-TYPE                                         CL**5
038900         MOVE PS003-GIFT-CERT-NBR     TO DL-GIFT-NBR                 CL**5
039000     ELSE                                                            CL**5
039100         MOVE PS003-GIFT-CARD-ID      TO DL-GIFT-NBR                 CL**5
039200     END-IF.                                                         CL**5
039300                                                                     CL**5
268841     IF PS003-GIFT-CERT-TYPE                                              
268841        MOVE 'CERT'                   TO DL-GIFT-TYPE                     
268841     ELSE                                                                 
268841        IF PS003-GIFT-CARD-TYPE                                           
268841           MOVE 'GIFT'                TO DL-GIFT-TYPE                     
268841        ELSE                                                              
268841           IF PS003-KCK-CARD-TYPE                                         
268841              MOVE 'KCK '             TO DL-GIFT-TYPE                     
268841           ELSE                                                           
268841              IF PS003-SEPH-CARD-TYPE                                     
268841                 MOVE 'SEPH'          TO DL-GIFT-TYPE                     
268841              ELSE                                                        
268841                 MOVE '    '          TO DL-GIFT-TYPE                     
268841              END-IF                                                 CL**5
268841           END-IF                                                    CL**5
268841        END-IF                                                       CL**5
268841     END-IF.                                                         CL**5
268841                                                                     CL**5
039400     MOVE PS003-OPERATOR              TO DL-CLERK.                   CL**5
039500     MOVE PS003-TRAN-TYPE             TO DL-SALE-TYPE.               CL**5
039600     IF PS003-AMOUNT < 0                                             CL**5
039700         MOVE ZERO                    TO DL-SALE-AMT                 CL**5
039800         MOVE PS003-AMOUNT            TO DL-REDEMPTION-AMT           CL**5
039900         IF PS003-GIFT-CERT-TYPE                                     CL**5
040000             ADD PS003-AMOUNT         TO PV-TOT-REDEM-STORE-CERT     CL**5
040100         ELSE                                                        CL**5
040200             IF PS003-GIFT-CARD-TYPE                                 CL**5
040300                 ADD PS003-AMOUNT     TO PV-TOT-REDEM-STORE-CARD     CL**5
040400             ELSE                                                    CL**5
268841                 IF PS003-SEPH-CARD-TYPE                             CL**5
268841                    ADD PS003-AMOUNT  TO PV-TOT-REDEM-STORE-SEGC     CL**5
040400                 ELSE                                                CL**5
040500                    ADD PS003-AMOUNT  TO PV-TOT-REDEM-STORE-KCK      CL**5
268841                 END-IF                                              CL**5
040600             END-IF                                                  CL**5
040700         END-IF                                                      CL**5
040800*        IF PS003-REDEEM-TYPE-05                                     CL**5
040810         IF PS003-TRAN-TYPE-30                                            
040900             IF PS003-GIFT-CERT-TYPE                                 CL**5
041000                 ADD 1                TO PV-NBR-PAY-STORE-CERT       CL**5
041100                 ADD PS003-AMOUNT     TO PV-TOT-PAY-STORE-CERT       CL**5
041200             ELSE                                                    CL**5
041300                 IF PS003-GIFT-CARD-TYPE                             CL**5
041400                     ADD 1            TO PV-NBR-PAY-STORE-CARD       CL**5
041500                     ADD PS003-AMOUNT TO PV-TOT-PAY-STORE-CARD       CL**5
041600                 ELSE                                                CL**5
268841                    IF PS003-SEPH-CARD-TYPE                          CL**5
268841                       ADD 1        TO PV-NBR-PAY-STORE-SEGC         CL**5
268841                       ADD PS003-AMOUNT TO PV-TOT-PAY-STORE-SEGC     CL**5
268841                    ELSE                                             CL**5
041700                       ADD 1            TO PV-NBR-PAY-STORE-KCK      CL**5
041800                       ADD PS003-AMOUNT TO PV-TOT-PAY-STORE-KCK      CL**5
268841                    END-IF                                           CL**5
041900                 END-IF                                              CL**5
042000             END-IF                                                  CL**5
042100         END-IF                                                      CL**5
042200     ELSE                                                            CL**5
042300         MOVE ZERO                    TO DL-REDEMPTION-AMT           CL**5
042400         MOVE PS003-AMOUNT            TO DL-SALE-AMT                 CL**5
042500         IF PS003-GIFT-CERT-TYPE                                     CL**5
042600             ADD PS003-AMOUNT         TO PV-TOT-SALE-STORE-CERT      CL**5
042700         ELSE                                                        CL**5
042800             IF PS003-GIFT-CARD-TYPE                                 CL**5
042900                 ADD PS003-AMOUNT     TO PV-TOT-SALE-STORE-CARD      CL**5
043000             ELSE                                                    CL**5
268841                 IF PS003-SEPH-CARD-TYPE                             CL**5
268841                    ADD PS003-AMOUNT  TO PV-TOT-SALE-STORE-SEGC      CL**5
268841                 ELSE                                                CL**5
043100                    ADD PS003-AMOUNT  TO PV-TOT-SALE-STORE-KCK       CL**5
268841                 END-IF                                              CL**5
043200             END-IF                                                  CL**5
043300         END-IF                                                      CL**5
043400     END-IF.                                                         CL**5
043500     WRITE GC-GIFT-CERT-DETAIL-LINE                                  CL**3
043600         FROM DL-DETAIL-LINE                                         CL**3
043700         AFTER ADVANCING 1 LINE.                                  PSKRP063
043800     ADD 1                            TO PV-LINE-COUNT.           PSKRP063
043900                                                                  PSKRP063
044000     PERFORM 7000-READ-GIFT-CERT-FILE.                               CL**2
044100*2000-EXIT.                                                          CL**5
044200                                                                  PSKRP063
044300******************************************************************PSKRP063
044400*3000-CHECK-NEXT-PAGE.                                            PSKRP063
044500*  CHECK TO SEE IF A PAGE BREAK IS NEEDED                        *   CL**5
044600******************************************************************PSKRP063
044700                                                                  PSKRP063
044800 3000-CHECK-NEXT-PAGE.                                            PSKRP063
044900     IF PV-LINE-COUNT >= PC-PAGE-SIZE                             PSKRP063
045000         PERFORM 8000-PRINT-TITLE-LINES                           PSKRP063
045100     END-IF.                                                      PSKRP063
045200                                                                  PSKRP063
045300******************************************************************PSKRP063
045400*6000-STORE-CONTROL-BREAK.                                        PSKRP063
045500*  HANDLE A CONTROL BREAK FOR THE REPORT.  COMPUTE THE REQUIRED  *   CL**5
045600*  TOTALS FOR THAT CONTROL BREAK LEVEL, AND BUILD/WRITE THE      *   CL**5
045700*  DETAIL LINE.  IF THE CONTROL BREAK IS NOT FOR THE COMPANY     *   CL**5
045800*  TOTAL LEVEL, ACCUMULATE THE TOTALS INTO THE NEXT HIGHER LEVEL *   CL**5
045900*  OF CONTROL BREAK TOTALS.                                      *   CL**5
046000******************************************************************PSKRP063
046100                                                                  PSKRP063
046200 6000-STORE-CONTROL-BREAK.                                        PSKRP063
046300     WRITE GC-GIFT-CERT-DETAIL-LINE                                  CL**3
046400         FROM DL-DASH-LINE                                           CL**3
046500         AFTER ADVANCING 1 LINES.                                 PSKRP063
046600                                                                          
046700     MOVE PV-TOT-SALE-STORE-CERT    TO TL-SALE-AMOUNT.            PSKRP063
046800     MOVE PV-TOT-REDEM-STORE-CERT   TO TL-REDEMPTION-AMOUNT.      PSKRP063
046900     MOVE PV-HOLD-STORE             TO PC-STORE-NBR-CERT.            CL**5
047000     MOVE PC-STORE-TOTAL-CERT       TO TL-DESCRIPTION.               CL**5
047100     WRITE GC-GIFT-CERT-DETAIL-LINE                                  CL**3
047200         FROM TL-TOTAL-LINE                                          CL**3
047300         AFTER ADVANCING 1 LINES.                                 PSKRP063
047400                                                                          
047500     MOVE PV-TOT-SALE-STORE-CARD    TO TL-SALE-AMOUNT.            PSKRP063
047600     MOVE PV-TOT-REDEM-STORE-CARD   TO TL-REDEMPTION-AMOUNT.      PSKRP063
047700     MOVE PV-HOLD-STORE             TO PC-STORE-NBR-CARD.            CL**5
047800     MOVE PC-STORE-TOTAL-CARD       TO TL-DESCRIPTION.               CL**5
047900     WRITE GC-GIFT-CERT-DETAIL-LINE                                  CL**3
048000         FROM TL-TOTAL-LINE                                          CL**3
048100         AFTER ADVANCING 1 LINES.                                 PSKRP063
048200                                                                          
048300     MOVE PV-TOT-SALE-STORE-KCK     TO TL-SALE-AMOUNT.            PSKRP063
048400     MOVE PV-TOT-REDEM-STORE-KCK    TO TL-REDEMPTION-AMOUNT.      PSKRP063
048500     MOVE PV-HOLD-STORE             TO PC-STORE-NBR-KCK.             CL**5
048600     MOVE PC-STORE-TOTAL-KCK        TO TL-DESCRIPTION.               CL**5
048700     WRITE GC-GIFT-CERT-DETAIL-LINE                                  CL**3
048800         FROM TL-TOTAL-LINE                                          CL**3
048900         AFTER ADVANCING 1 LINES.                                 PSKRP063
049000                                                                          
268841     MOVE PV-TOT-SALE-STORE-SEGC    TO TL-SALE-AMOUNT.            PSKRP063
268841     MOVE PV-TOT-REDEM-STORE-SEGC   TO TL-REDEMPTION-AMOUNT.      PSKRP063
268841     MOVE PV-HOLD-STORE             TO PC-STORE-NBR-SEGC.            CL**5
268841     MOVE PC-STORE-TOTAL-SEGC       TO TL-DESCRIPTION.               CL**5
268841     WRITE GC-GIFT-CERT-DETAIL-LINE                                  CL**3
268841         FROM TL-TOTAL-LINE                                          CL**3
268841         AFTER ADVANCING 1 LINES.                                 PSKRP063
268841                                                                          
049100     WRITE GC-GIFT-CERT-DETAIL-LINE                                  CL**3
049200         FROM DL-DASH-LINE                                           CL**3
049300         AFTER ADVANCING 1 LINES.                                 PSKRP063
049400                                                                          
049500     COMPUTE PV-TOT-SALE-STORE                                    PSKRP063
049600      = (PV-TOT-SALE-STORE-CERT + PV-TOT-SALE-STORE-CARD          PSKRP063
049700                                + PV-TOT-SALE-STORE-KCK           PSKRP063
268841                                + PV-TOT-SALE-STORE-SEGC).        PSKRP063
049800     COMPUTE PV-TOT-REDEM-STORE                                   PSKRP063
049900      = (PV-TOT-REDEM-STORE-CERT + PV-TOT-REDEM-STORE-CARD        PSKRP063
050000                                 + PV-TOT-REDEM-STORE-KCK         PSKRP063
268841                                 + PV-TOT-REDEM-STORE-SEGC).      PSKRP063
050100                                                                  PSKRP063
050200     MOVE PV-TOT-SALE-STORE         TO TL-SALE-AMOUNT.            PSKRP063
050300     MOVE PV-TOT-REDEM-STORE        TO TL-REDEMPTION-AMOUNT.      PSKRP063
050400     MOVE PC-STORE-TOTAL            TO TL-DESCRIPTION.               CL**5
050500     WRITE GC-GIFT-CERT-DETAIL-LINE                                  CL**3
050600         FROM TL-TOTAL-LINE                                          CL**3
050700         AFTER ADVANCING 1 LINES.                                 PSKRP063
050800                                                                  PSKRP063
050900******************************************************************PSKRP063
051000*  PAYMENT TOTALS ARE WRITTEN                                    *PSKRP063
051100******************************************************************PSKRP063
051200     ADD PC-PAYMENT-LINE-COUNT      TO PV-LINE-COUNT.             PSKRP063
051300     PERFORM 3000-CHECK-NEXT-PAGE.                                PSKRP063
051400                                                                  PSKRP063
051500     MOVE PV-HOLD-STORE             TO DL-PAYMENT-STORE.             CL**5
051600     WRITE GC-GIFT-CERT-DETAIL-LINE                                  CL**3
051700         FROM DL-PAYMENT-STORE-HEADER                                CL**3
051800         AFTER ADVANCING 2 LINES.                                 PSKRP063
051900                                                                          
052000     MOVE PV-NBR-PAY-STORE-CERT     TO TL-PAYMENT-COUNT.          PSKRP063
052100     MOVE PV-TOT-PAY-STORE-CERT     TO TL-PAYMENT-AMOUNT.         PSKRP063
052200     MOVE PV-HOLD-STORE             TO PC-STORE-NBR-CERT.            CL**5
052300     MOVE PC-STORE-TOTAL-CERT       TO TL-DESCRIPTION-PAYMENT.       CL**5
052400     WRITE GC-GIFT-CERT-DETAIL-LINE                                  CL**3
052500         FROM TL-TOTAL-LINE-PAYMENT                                  CL**3
052600         AFTER ADVANCING 1 LINES.                                 PSKRP063
052700                                                                          
052800     MOVE PV-NBR-PAY-STORE-CARD     TO TL-PAYMENT-COUNT.          PSKRP063
052900     MOVE PV-TOT-PAY-STORE-CARD     TO TL-PAYMENT-AMOUNT.         PSKRP063
053000     MOVE PV-HOLD-STORE             TO PC-STORE-NBR-CARD.            CL**5
053100     MOVE PC-STORE-TOTAL-CARD       TO TL-DESCRIPTION-PAYMENT        CL**5
053200     WRITE GC-GIFT-CERT-DETAIL-LINE                                  CL**3
053300         FROM TL-TOTAL-LINE-PAYMENT                                  CL**3
053400         AFTER ADVANCING 1 LINES.                                 PSKRP063
053500                                                                          
053600     MOVE PV-NBR-PAY-STORE-KCK      TO TL-PAYMENT-COUNT.          PSKRP063
053700     MOVE PV-TOT-PAY-STORE-KCK      TO TL-PAYMENT-AMOUNT.         PSKRP063
053800     MOVE PV-HOLD-STORE             TO PC-STORE-NBR-KCK.             CL**5
053900     MOVE PC-STORE-TOTAL-KCK        TO TL-DESCRIPTION-PAYMENT.       CL**5
054000     WRITE GC-GIFT-CERT-DETAIL-LINE                                  CL**3
054100         FROM TL-TOTAL-LINE-PAYMENT                                  CL**3
054200         AFTER ADVANCING 1 LINES.                                 PSKRP063
054300                                                                          
268841     MOVE PV-NBR-PAY-STORE-SEGC     TO TL-PAYMENT-COUNT.          PSKRP063
268841     MOVE PV-TOT-PAY-STORE-SEGC     TO TL-PAYMENT-AMOUNT.         PSKRP063
268841     MOVE PV-HOLD-STORE             TO PC-STORE-NBR-SEGC.            CL**5
268841     MOVE PC-STORE-TOTAL-SEGC       TO TL-DESCRIPTION-PAYMENT.       CL**5
268841     WRITE GC-GIFT-CERT-DETAIL-LINE                                  CL**3
268841         FROM TL-TOTAL-LINE-PAYMENT                                  CL**3
268841         AFTER ADVANCING 1 LINES.                                 PSKRP063
268841                                                                          
054400     WRITE GC-GIFT-CERT-DETAIL-LINE                                  CL**3
054500         FROM DL-DASH-LINE                                           CL**3
054600         AFTER ADVANCING 1 LINES.                                 PSKRP063
054700                                                                          
054800     COMPUTE PV-NBR-PAY-STORE                                     PSKRP063
054900      = (PV-NBR-PAY-STORE-CERT + PV-NBR-PAY-STORE-CARD            PSKRP063
055000                               + PV-NBR-PAY-STORE-KCK             PSKRP063
268841                               + PV-NBR-PAY-STORE-SEGC).          PSKRP063
055100     COMPUTE PV-TOT-PAY-STORE                                     PSKRP063
055200      = (PV-TOT-PAY-STORE-CERT + PV-TOT-PAY-STORE-CARD            PSKRP063
055300                               + PV-TOT-PAY-STORE-KCK             PSKRP063
268841                               + PV-TOT-PAY-STORE-SEGC).          PSKRP063
055400                                                                  PSKRP063
055500     MOVE PV-NBR-PAY-STORE          TO TL-PAYMENT-COUNT.          PSKRP063
055600     MOVE PV-TOT-PAY-STORE          TO TL-PAYMENT-AMOUNT.         PSKRP063
055700     MOVE PC-STORE-TOTAL            TO TL-DESCRIPTION-PAYMENT.       CL**5
055800     WRITE GC-GIFT-CERT-DETAIL-LINE                                  CL**3
055900         FROM TL-TOTAL-LINE-PAYMENT                                  CL**3
056000         AFTER ADVANCING 1 LINES.                                 PSKRP063
056100                                                                  PSKRP063
056200******************************************************************PSKRP063
056300*  COMPANY LEVEL TOTALS ARE ACCUMULATED                          *PSKRP063
056400******************************************************************PSKRP063
056500                                                                  PSKRP063
056600     COMPUTE PV-TOT-SALE-COMPANY-CERT                             PSKRP063
056700      = (PV-TOT-SALE-STORE-CERT + PV-TOT-SALE-COMPANY-CERT).      PSKRP063
056800     COMPUTE PV-TOT-SALE-COMPANY-CARD                             PSKRP063
056900      = (PV-TOT-SALE-STORE-CARD + PV-TOT-SALE-COMPANY-CARD).      PSKRP063
057000     COMPUTE PV-TOT-SALE-COMPANY-KCK                              PSKRP063
057100      = (PV-TOT-SALE-STORE-KCK + PV-TOT-SALE-COMPANY-KCK).        PSKRP063
268841     COMPUTE PV-TOT-SALE-COMPANY-SEGC                             PSKRP063
268841      = (PV-TOT-SALE-STORE-SEGC + PV-TOT-SALE-COMPANY-SEGC).      PSKRP063
057200     COMPUTE PV-TOT-REDEM-COMPANY-CERT                            PSKRP063
057300      = (PV-TOT-REDEM-STORE-CERT + PV-TOT-REDEM-COMPANY-CERT).    PSKRP063
057400     COMPUTE PV-TOT-REDEM-COMPANY-CARD                            PSKRP063
057500      = (PV-TOT-REDEM-STORE-CARD + PV-TOT-REDEM-COMPANY-CARD).    PSKRP063
057600     COMPUTE PV-TOT-REDEM-COMPANY-KCK                             PSKRP063
057700      = (PV-TOT-REDEM-STORE-KCK + PV-TOT-REDEM-COMPANY-KCK).      PSKRP063
268841     COMPUTE PV-TOT-REDEM-COMPANY-SEGC                            PSKRP063
268841      = (PV-TOT-REDEM-STORE-SEGC + PV-TOT-REDEM-COMPANY-SEGC).    PSKRP063
057800                                                                  PSKRP063
057900     COMPUTE PV-NBR-PAY-COMPANY-CERT                              PSKRP063
058000      = (PV-NBR-PAY-STORE-CERT + PV-NBR-PAY-COMPANY-CERT).        PSKRP063
058100     COMPUTE PV-NBR-PAY-COMPANY-CARD                              PSKRP063
058200      = (PV-NBR-PAY-STORE-CARD + PV-NBR-PAY-COMPANY-CARD).        PSKRP063
058300     COMPUTE PV-NBR-PAY-COMPANY-KCK                               PSKRP063
058400      = (PV-NBR-PAY-STORE-KCK + PV-NBR-PAY-COMPANY-KCK).          PSKRP063
268841     COMPUTE PV-NBR-PAY-COMPANY-SEGC                              PSKRP063
268841      = (PV-NBR-PAY-STORE-SEGC + PV-NBR-PAY-COMPANY-SEGC).        PSKRP063
058500     COMPUTE PV-TOT-PAY-COMPANY-CERT                              PSKRP063
058600      = (PV-TOT-PAY-STORE-CERT + PV-TOT-PAY-COMPANY-CERT).        PSKRP063
058700     COMPUTE PV-TOT-PAY-COMPANY-CARD                              PSKRP063
058800      = (PV-TOT-PAY-STORE-CARD + PV-TOT-PAY-COMPANY-CARD).        PSKRP063
058900     COMPUTE PV-TOT-PAY-COMPANY-KCK                               PSKRP063
059000      = (PV-TOT-PAY-STORE-KCK + PV-TOT-PAY-COMPANY-KCK).          PSKRP063
268841     COMPUTE PV-TOT-PAY-COMPANY-SEGC                              PSKRP063
268841      = (PV-TOT-PAY-STORE-SEGC + PV-TOT-PAY-COMPANY-SEGC).        PSKRP063
059100                                                                  PSKRP063
059200     MOVE ZEROS                     TO PV-TOT-SALE-STORE-CERT     PSKRP063
059300                                       PV-TOT-SALE-STORE-CARD     PSKRP063
059400                                       PV-TOT-SALE-STORE-KCK      PSKRP063
268841                                       PV-TOT-SALE-STORE-SEGC     PSKRP063
059500                                       PV-TOT-SALE-STORE          PSKRP063
059600                                       PV-TOT-REDEM-STORE-CERT    PSKRP063
059700                                       PV-TOT-REDEM-STORE-CARD    PSKRP063
059800                                       PV-TOT-REDEM-STORE-KCK     PSKRP063
268841                                       PV-TOT-REDEM-STORE-SEGC    PSKRP063
059900                                       PV-TOT-REDEM-STORE.        PSKRP063
060000     MOVE ZEROS                     TO PV-NBR-PAY-STORE-CERT      PSKRP063
060100                                       PV-NBR-PAY-STORE-CARD      PSKRP063
060200                                       PV-NBR-PAY-STORE-KCK       PSKRP063
268841                                       PV-NBR-PAY-STORE-SEGC      PSKRP063
060300                                       PV-NBR-PAY-STORE           PSKRP063
060400                                       PV-TOT-PAY-STORE-CERT      PSKRP063
060500                                       PV-TOT-PAY-STORE-CARD      PSKRP063
060600                                       PV-TOT-PAY-STORE-KCK       PSKRP063
268841                                       PV-TOT-PAY-STORE-SEGC      PSKRP063
060700                                       PV-TOT-PAY-STORE.          PSKRP063
060800     IF PS-NOT-END-OF-GIFT-CERT-FILE                              PSKRP063
060900         MOVE PC-PAGE-BREAK         TO PV-LINE-COUNT              PSKRP063
061000         MOVE PS003-STORE-NBR       TO PV-HOLD-STORE              PSKRP063
061100         PERFORM 3000-CHECK-NEXT-PAGE                             PSKRP063
061200     END-IF.                                                      PSKRP063
061300*6000-EXIT.                                                       PSKRP063
061400******************************************************************PSKRP063
061500*6100-COMPANY-CONTROL-BREAK.                                      PSKRP063
061600*  COMPUTE AND PRINT THE FINAL COMPANY LEVEL TOTALS ON THE       *   CL**5
061700*  REPORT.                                                       *   CL**5
061800******************************************************************PSKRP063
061900                                                                  PSKRP063
062000 6100-COMPANY-CONTROL-BREAK.                                      PSKRP063
062100                                                                  PSKRP063
062200     MOVE PV-TOT-SALE-COMPANY-CERT  TO TL-SALE-AMOUNT.            PSKRP063
062300     MOVE PV-TOT-REDEM-COMPANY-CERT TO TL-REDEMPTION-AMOUNT.      PSKRP063
062400     MOVE PC-COMPANY-TOTAL-CERT     TO TL-DESCRIPTION.               CL**5
062500     WRITE GC-GIFT-CERT-DETAIL-LINE                                  CL**3
062600         FROM TL-TOTAL-LINE                                          CL**3
062700         AFTER ADVANCING 3 LINES.                                 PSKRP063
062800                                                                  PSKRP063
062900     MOVE PV-TOT-SALE-COMPANY-CARD  TO TL-SALE-AMOUNT.            PSKRP063
063000     MOVE PV-TOT-REDEM-COMPANY-CARD TO TL-REDEMPTION-AMOUNT.      PSKRP063
063100     MOVE PC-COMPANY-TOTAL-CARD     TO TL-DESCRIPTION.               CL**5
063200     WRITE GC-GIFT-CERT-DETAIL-LINE                                  CL**3
063300         FROM TL-TOTAL-LINE                                          CL**3
063400         AFTER ADVANCING 1 LINES.                                 PSKRP063
063500                                                                  PSKRP063
063600     MOVE PV-TOT-SALE-COMPANY-KCK   TO TL-SALE-AMOUNT.            PSKRP063
063700     MOVE PV-TOT-REDEM-COMPANY-KCK  TO TL-REDEMPTION-AMOUNT.      PSKRP063
063800     MOVE PC-COMPANY-TOTAL-KCK      TO TL-DESCRIPTION.               CL**5
063900     WRITE GC-GIFT-CERT-DETAIL-LINE                                  CL**3
064000         FROM TL-TOTAL-LINE                                          CL**3
064100         AFTER ADVANCING 1 LINES.                                 PSKRP063
064200                                                                     CL**5
268841     MOVE PV-TOT-SALE-COMPANY-SEGC  TO TL-SALE-AMOUNT.            PSKRP063
268841     MOVE PV-TOT-REDEM-COMPANY-SEGC TO TL-REDEMPTION-AMOUNT.      PSKRP063
268841     MOVE PC-COMPANY-TOTAL-SEGC     TO TL-DESCRIPTION.               CL**5
268841     WRITE GC-GIFT-CERT-DETAIL-LINE                                  CL**3
268841         FROM TL-TOTAL-LINE                                          CL**3
268841         AFTER ADVANCING 1 LINES.                                 PSKRP063
064200                                                                     CL**5
064300     WRITE GC-GIFT-CERT-DETAIL-LINE                                  CL**3
064400         FROM DL-DASH-LINE                                           CL**3
064500         AFTER ADVANCING 1 LINES.                                 PSKRP063
064600                                                                  PSKRP063
064700     COMPUTE PV-TOT-SALE-COMPANY                                  PSKRP063
064800      = (PV-TOT-SALE-COMPANY-CERT + PV-TOT-SALE-COMPANY-CARD      PSKRP063
064900                                  + PV-TOT-SALE-COMPANY-KCK       PSKRP063
268841                                  + PV-TOT-SALE-COMPANY-SEGC).    PSKRP063
065000     COMPUTE PV-TOT-REDEM-COMPANY                                 PSKRP063
065100      = (PV-TOT-REDEM-COMPANY-CERT + PV-TOT-REDEM-COMPANY-CARD    PSKRP063
065200                                   + PV-TOT-REDEM-COMPANY-KCK     PSKRP063
268841                                   + PV-TOT-REDEM-COMPANY-SEGC).  PSKRP063
065300                                                                     CL**5
065400     MOVE PV-TOT-SALE-COMPANY       TO TL-SALE-AMOUNT.            PSKRP063
065500     MOVE PV-TOT-REDEM-COMPANY      TO TL-REDEMPTION-AMOUNT.      PSKRP063
065600     MOVE PC-COMPANY-TOTAL          TO TL-DESCRIPTION.               CL**5
065700     WRITE GC-GIFT-CERT-DETAIL-LINE                                  CL**3
065800         FROM TL-TOTAL-LINE                                          CL**3
065900         AFTER ADVANCING 1 LINES.                                 PSKRP063
066000******************************************************************PSKRP063
066100*  PAYMENT TOTALS ARE WRITTEN                                    *PSKRP063
066200******************************************************************PSKRP063
066300     WRITE GC-GIFT-CERT-DETAIL-LINE                                  CL**3
066400         FROM DL-PAYMENT-COMPANY-HEADER                              CL**3
066500         AFTER ADVANCING 3 LINES.                                 PSKRP063
066600                                                                          
066700     MOVE PV-NBR-PAY-COMPANY-CERT   TO TL-PAYMENT-COUNT.          PSKRP063
066800     MOVE PV-TOT-PAY-COMPANY-CERT   TO TL-PAYMENT-AMOUNT.         PSKRP063
066900     MOVE PC-COMPANY-TOTAL-CERT     TO TL-DESCRIPTION-PAYMENT.       CL**5
067000     WRITE GC-GIFT-CERT-DETAIL-LINE                                  CL**3
067100         FROM TL-TOTAL-LINE-PAYMENT                                  CL**3
067200         AFTER ADVANCING 1 LINES.                                 PSKRP063
067300                                                                  PSKRP063
067400     MOVE PV-NBR-PAY-COMPANY-CARD   TO TL-PAYMENT-COUNT.          PSKRP063
067500     MOVE PV-TOT-PAY-COMPANY-CARD   TO TL-PAYMENT-AMOUNT.         PSKRP063
067600     MOVE PC-COMPANY-TOTAL-CARD     TO TL-DESCRIPTION-PAYMENT.       CL**5
067700     WRITE GC-GIFT-CERT-DETAIL-LINE                                  CL**3
067800         FROM TL-TOTAL-LINE-PAYMENT                                  CL**3
067900         AFTER ADVANCING 1 LINES.                                 PSKRP063
068000                                                                  PSKRP063
068100     MOVE PV-NBR-PAY-COMPANY-KCK    TO TL-PAYMENT-COUNT.          PSKRP063
068200     MOVE PV-TOT-PAY-COMPANY-KCK    TO TL-PAYMENT-AMOUNT.         PSKRP063
068300     MOVE PC-COMPANY-TOTAL-KCK      TO TL-DESCRIPTION-PAYMENT.       CL**5
068400     WRITE GC-GIFT-CERT-DETAIL-LINE                                  CL**3
068500         FROM TL-TOTAL-LINE-PAYMENT                                  CL**3
068600         AFTER ADVANCING 1 LINES.                                 PSKRP063
068700                                                                     CL**5
268841     MOVE PV-NBR-PAY-COMPANY-SEGC   TO TL-PAYMENT-COUNT.          PSKRP063
268841     MOVE PV-TOT-PAY-COMPANY-SEGC   TO TL-PAYMENT-AMOUNT.         PSKRP063
268841     MOVE PC-COMPANY-TOTAL-SEGC     TO TL-DESCRIPTION-PAYMENT.       CL**5
268841     WRITE GC-GIFT-CERT-DETAIL-LINE                                  CL**3
268841         FROM TL-TOTAL-LINE-PAYMENT                                  CL**3
268841         AFTER ADVANCING 1 LINES.                                 PSKRP063
268841                                                                     CL**5
068800     WRITE GC-GIFT-CERT-DETAIL-LINE                                  CL**3
068900         FROM DL-DASH-LINE                                           CL**3
069000         AFTER ADVANCING 1 LINES.                                 PSKRP063
069100                                                                  PSKRP063
069200     COMPUTE PV-NBR-PAY-COMPANY                                   PSKRP063
069300      = (PV-NBR-PAY-COMPANY-CERT + PV-NBR-PAY-COMPANY-CARD        PSKRP063
069400                                 + PV-NBR-PAY-COMPANY-KCK         PSKRP063
268841                                 + PV-NBR-PAY-COMPANY-SEGC).      PSKRP063
069500     COMPUTE PV-TOT-PAY-COMPANY                                   PSKRP063
069600      = (PV-TOT-PAY-COMPANY-CERT + PV-TOT-PAY-COMPANY-CARD        PSKRP063
069700                                 + PV-TOT-PAY-COMPANY-KCK         PSKRP063
268841                                 + PV-TOT-PAY-COMPANY-SEGC).      PSKRP063
069800                                                                     CL**5
069900     MOVE PV-NBR-PAY-COMPANY        TO TL-PAYMENT-COUNT.          PSKRP063
070000     MOVE PV-TOT-PAY-COMPANY        TO TL-PAYMENT-AMOUNT.         PSKRP063
070100     MOVE PC-COMPANY-TOTAL          TO TL-DESCRIPTION-PAYMENT.       CL**5
070200     WRITE GC-GIFT-CERT-DETAIL-LINE                                  CL**3
070300         FROM TL-TOTAL-LINE-PAYMENT                                  CL**3
070400         AFTER ADVANCING 1 LINES.                                 PSKRP063
070500*6100-EXIT.                                                       PSKRP063
070600******************************************************************PSKRP063
070700*7000-READ-GIFT-CERT-FILE.                                        PSKRP063
070800*  READ A GIFT CERTIFICATE FILE RECORD.                          *   CL**5
070900******************************************************************PSKRP063
071000                                                                  PSKRP063
071100 7000-READ-GIFT-CERT-FILE.                                        PSKRP063
071200     READ GIFT-CERTIFICATE-FILE                                   PSKRP063
071300         INTO PS003-GIFT-RECORD                                   PSKRP063
071400         AT END                                                   PSKRP063
071500             SET PS-END-OF-GIFT-CERT-FILE TO TRUE                 PSKRP063
071600     END-READ.                                                    PSKRP063
071700*7000-EXIT.                                                       PSKRP063
071800                                                                  PSKRP063
071900******************************************************************PSKRP063
072000*8000-PRINT-TITLE-LINES.                                          PSKRP063
072100*  PRINT TITLE LINES ON THE REPORT AT EACH PAGE BREAK.  UPDATE   *   CL**5
072200*  THE PAGE NUMBER.                                              *   CL**5
072300******************************************************************PSKRP063
072400                                                                  PSKRP063
072500 8000-PRINT-TITLE-LINES.                                          PSKRP063
072600     ADD +1 TO PV-PAGE-COUNT.                                     PSKRP063
072700     MOVE PV-PAGE-COUNT TO DP075O-PAGE-NUMBER.                    PSKRP063
072800     WRITE GC-GIFT-CERT-DETAIL-LINE                               PSKRP063
072900         FROM DP075O-STANDARD-HEADER-75-COLS                      PSKRP063
073000         AFTER ADVANCING PAGE.                                    PSKRP063
073100                                                                  PSKRP063
073200     WRITE GC-GIFT-CERT-DETAIL-LINE                                  CL**3
073300         FROM HL2A-HEADING-LINE                                      CL**3
073400         AFTER ADVANCING 1 LINES.                                 PSKRP063
268841                                                                  PSKRP063
268841     MOVE PV-HOLD-STORE           TO SB-STORE-NBR.                   CL**5
268841     WRITE GC-GIFT-CERT-DETAIL-LINE                                  CL**3
268841         FROM SB-STORE-BREAK                                         CL**3
268841         AFTER ADVANCING 1 LINE.                                  PSKRP063
074600                                                                  PSKRP063
073500     WRITE GC-GIFT-CERT-DETAIL-LINE                                  CL**3
073600         FROM HL3A-HEADING-LINE                                      CL**3
073700         AFTER ADVANCING 2 LINES.                                 PSKRP063
073800     WRITE GC-GIFT-CERT-DETAIL-LINE                                  CL**3
073900         FROM HL4A-HEADING-LINE                                      CL**3
074000         AFTER ADVANCING 1 LINE.                                  PSKRP063
074100                                                                  PSKRP063
074700     MOVE PC-HEADING-LINE-COUNT   TO PV-LINE-COUNT.               PSKRP063
074800     MOVE ZEROS                   TO PV-HOLD-TERM.                PSKRP063
074900*8000-EXIT.                                                       PSKRP063
075000                                                                  PSKRP063
075100******************************************************************PSKRP063
075200*9000-EOJ-ROUTINE.                                                PSKRP063
075300*  CLOSE ALL FILES.                                              *PSKRP063
075400******************************************************************PSKRP063
075500                                                                  PSKRP063
075600 9000-EOJ-ROUTINE.                                                PSKRP063
075700     CLOSE GIFT-CERTIFICATE-FILE                                  PSKRP063
075800           GIFT-CERT-DETAIL-REPORT.                               PSKRP063
075900*9000-EXIT.                                                       PSKRP063
076000                                                                  PSKRP063
