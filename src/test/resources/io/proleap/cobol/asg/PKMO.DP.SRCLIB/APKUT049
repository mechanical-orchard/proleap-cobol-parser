000100*-----------------------*                                         00010002
000200 IDENTIFICATION DIVISION.                                         00020002
000300*-----------------------*                                         00030002
000400 PROGRAM-ID.    APKUT049.                                         00040002
000500 AUTHOR.        JOYCE KNOKE - TCC.                                00050002
000600 DATE-WRITTEN.  08/25/97.                                         00060002
000700                                                                  00070002
000800*---------------------------------------------------------------* 00080002
002600*                                                               * 00260002
002601*        COMPILE IMPORT PURCHASE ORDER COST INFORMATION         * 00260106
002602*                                                               * 00260202
002603* THE MAIN PROCESS OF THIS PROGRAM IS TO READ IN THE            * 00260306
002604* RECEIVING AND INVOICE SUMMARY FILES, AND PROCESS BY PO.       * 00260406
002605* EACH PO MUST BE CHECKED FOR REPORTABILITY AND WHETHER         * 00260506
002606* FOUND ON EITHER ONE OR BOTH SUMMARY FILES. FOR A PO ON THE    * 00260606
002607* RECEIVING FILE, COMPARE THE VERIFY DATE TO THE RECEIPT        * 00260706
002608* REPORT CUTOFF DATE. WHEN THE VERIFY DATE IS LESS THAN OF      * 00260806
002609* EQUAL TO THE CUTOFF DATE, CREATE RECEIVING REPORT RECORDS     * 00260906
002610* FOR THE PO, CREATING ALL OF THE VARIOUS TYPES OF RECORDS      * 00261006
002620* POSSIBLE. FOR A PO ON THE INVOICE SUMMARY FILE, IF NO         * 00262006
002630* MATCHING PO IS FOUND ON THE RECEIVING FILE, COMPARE THE FIRST * 00263006
002640* INVOICE DATE TO THE ALC CUTOFF DATE. IF THE INVOICE DATE IS   * 00264006
002650* LESS THAN OR EQUAL TO THE CUTOFF, CREATE NO-RECEIPT RECORDS   * 00265006
002660* FOR THE PO. THIS WILL INCLUDE EVERYTHING BUT THE RECEIVING    * 00266006
002661* INFO TYPE RECORDS.                                            * 00266106
002662*                                                               * 00266202
002663*---------------------------------------------------------------* 00266302
002664*                                                               * 00266402
002665* DB2 TABLES:                                                   * 00266502
002666*  1. AP CONTROL TABLE                 (TAPCNTL)                * 00266605
002667*  2. AP CHARGE TYPE TABLE             (TACCTYP)                * 00266705
002669*  3. AP INVOICE TABLE                 (TINVOIC)                * 00266908
002670*                                                               * 00267002
002671* INPUT:                                                        * 00267105
002672*                                                               * 00267205
002673*  1. RECEIVING-SUMMARY-FILE           (APRD033)                * 00267306
002674*  2. INVOICE-SUMMARY-FILE             (APRD062)                * 00267405
002675*  3. RECEIVING-COST-FILE              (APRD034)                * 00267505
002676*  4. INVOICE-COST-FILE                (APRD063)                * 00267605
002677*  5. ESTIMATE-COST-FILE               (APRD064)                * 00267705
002678*                                                               * 00267802
002679* OUTPUT:                                                       * 00267905
002680*                                                               * 00268005
002681*  1. IMPORT-PO-REPORT-FILE            (APRD031)                * 00268105
002682*                                                               * 00268205
003600*---------------------------------------------------------------* 00360002
003800*   CHANGES:                                                    * 00380002
003900*                                                               * 00390002
004000* WR/IR# 4164 11/17/97  MIKE BESKE                              * 00400002
004010*        CODE WAS MODIFIED TO ADD A NEW REPORT TYPE TO AP031    * 00401006
004100*        RECORDS BEING WRITTEN.  THE NEW TYPE WILL BE 'POSTING' * 00410002
004101*        REPORT.  WHERE EVER THE 'JOURNALIZE' REPORT IS BEING   * 00410106
004102*        PROCESSED, A CHECK IF THE AP-PRC-CDE IS 'M' WAS ADDED. * 00410202
004103*        WHEN IT IS, THE AP031 REPORT TYPE IS SET TO POSTING    * 00410302
004104*        INSTEAD OF JOURNALIZE.  ADDED COUNTER DISPLAYS FOR THE * 00410402
004105*        3 KINDS OF REPORT TYPES TO THE INPUT COUNTER DISPLAYS. * 00410502
004106*        (B200, B300, D100, D200, D300, D400, D500, D600, D700, * 00410602
004107*        AND D800 PARAGRAPHS MODIFIED).                         * 00410702
004108*                                                               * 00410802
004109* WR/IR# 4164 12/10/97  MIKE BESKE                              * 00410902
004110*        UPDATED THE THE COPYBOOK APRD031 TO HOLD A NEW FIELD:  * 00411006
004111*        AP031-HDR-DTL-CDE.  THIS WAS ADDED TO ALLOW FOR THE    * 00411102
004112*        GROUPING OF HEADER AND DETAIL RECORDS USED IN APKRP053.* 00411202
004113*        WHENEVER AP031-RECORD-TYP-CDE IS SET FOR 1, 2 OR 3, THE* 00411302
004114*        AP031-HDR-DTL-CDE IS SET TO 1.  AP031-HDR-DTL-CDE IS   * 00411402
004115*        SET TO 2 FOR ALL OTHER VALUES OF AP031-RECORD-TYP-CDE. * 00411502
004116*        NOW THE DATASET CAN BE SORTED BY THIS NEW FIELD SO THAT* 00411602
004117*        COMPONENT TYPES FROM MULTIPLE INVOICES CAN BE GROUPED. * 00411702
004118*        THIS WILL SOLVE THE PROBLEM OF MULTIPLE REPORT LINES   * 00411802
004119*        OF THE SAME COMPONENT TYPE PER PO NUMBER.              * 00411902
004120*                                                               * 00412002
004130* WR/IR# 4164/4  01/16/98  MIKE BESKE                           * 00413006
004131*        ADDED AN INVOICE CURSOR TO SELECT ALL PAID AND OPEN TO * 00413106
004132*        PAY INVOICES FOR A PO THAT HAS ONLY RECEIVING DATA FROM* 00413202
004133*        THE INPUT FILES.  IF THE CURSOR FINDS ANY SUCH INVOICES* 00413302
004134*        THEN NONE OF THE DATA FOR THAT PO WILL BE WRITTEN OUT  * 00413402
004135*        TO THE REPORT FILE.  PARAGRAPHS THAT WERE MODIFIED OR  * 00413502
004136*        CREATED ARE B200-, D100-, D200-, D300-, D400-, D500-,  * 00413602
004137*        D600-, D700-, D800-, R600-, W100-, Y100- AND Y110-.    * 00413702
004138*                                                               * 00413802
004139* WR/IR# 4164    01/22/98  MARK BURNSIDE                        * 00413906
004140*        RECOMPILED DUE TO ADDITIONAL FIELD IN COPYBOOK APRD062.* 00414006
004150*                                                               * 00415006
004160*                01/27/98  MARK BURNSIDE                        * 00416006
004170*        REMOVED THE INITIALIZE STATEMENT FOR THE PROGRAM       * 00417006
004180*        SWITCHES IN PARAGRAPH B100.                            * 00418006
004190*                                                               * 00419006
004200* WR/IR# 6059    02/02/98  ROBIN BERNOSKI                       * 00420006
004300*        THE CODE ADDED WILL MOVE THE FOB CODE FROM THE VARIOUS * 00430006
004400*        INPUT FILE TO THE REPORT OUTPUT FILE.                  * 00440006
004500*                                                               * 00450006
004600* WR/IR# 4164    08/26/98  CHRIS KUNSTMANN                      * 00460006
004700*        ADDED LOGIC TO SELECT 4 NEW FIELDS FOR APRD033. THE    * 00470006
004800*        'JOURNALIZE' REPORT TYPE CODE WAS REPLACED ON THE      * 00480006
004900*        APRD033 COPYBOOK WITH A 'RECEIVING' REPORT TYPE. ALL   * 00490006
005000*        'JOURNALIZE' REFERENCES IN THIS PROGRAM HAVE BEEN      * 00500006
005100*        CHANGED. ADDED 'NOT AT END' CLAUSE TO ALL READ STMTS   * 00510006
005200*        SO THE COUNTERS AREN'T INCREMENTED ON EOF CONDITION.   * 00520006
005300*        USE THE FOB-CDE FROM AP033 ONLY. REMOVED D800- PARA.   * 00530006
005400*        FOR AP064 FCL & LCL PROCESSING. MOVE AP062-PO-TOT-COST * 00540006
005500*        TO AP031-EST-COST AND AP062-PO-1ST-COST TO AP031-EST-  * 00550006
005600*        COST. THIS WAS REVERSED, WHICH WAS WRONG. MOVED THE    * 00560006
005700*        INITIALIZE OF AP031 RECORD TO THE B100-INITIALIZE AND  * 00570006
005800*        W100-IMPORT-REPORT-RECORD PARA., INSTEAD OF IN EACH    * 00580006
005900*        FORMAT PARAGRAPH(D100- THRU D700-). CHANGED AP033      * 00590006
006000*        (INP01) REC LENGTH FROM 135 TO 150 AND AP031 (OUT01)   * 00600006
006001*        REC LENGTH FROM 150 TO 175.                            * 00600106
006002*                                                               * 00600207
006003*  06/17/2002                                                   * 00600307
006004*     ARK PO PROJECT PHASE 1.  RECOMPILE FROM PRODUCTION.       * 00600407
006005*  MADE BY: KEVIN CATLIN                WR#: 23500              * 00600507
006006*                                                               * 00600607
006007*  06/18/2002                                                   * 00600708
006008*     REMOVED TABLE TPAYREQ.  REPLACED ALL COLUMN REFERENCES    * 00600808
006009*     WITH TINVOIC REPLACEMENT.                                 * 00600908
006010*  MADE BY: NANCY EILBES                WR#: 23500              * 00601008
006011*                                                               * 00601108
006007*  11/04/2002                                                   * 00601211
006008*     MODIFICATIONS FOR COLBY DATING PROJECT.                   * 00601310
006008*     ADDED LOGIC IN PARAGRAPH S200 TO ACCEPT AN SQLCODE OF     * 00601410
006009*     -811 ON SELECT FROM TACCTYP.  THIS WILL STILL RETURN      * 00601510
006009*     A VALUE IN THE DESCRIPTION FIELD.  ALSO ADDED LOGIC AT    * 00601610
006009*     ALL POINTS WHERE S200 WAS BEING PERFORMED TO ONLY PERFORM * 00601710
006009*     WHEN THE NO RECEIVING REPORT IS BEING PROCESSED, BECAUSE  * 00601810
006009*     THE DESCRIPTION RETRIEVED IS ONLY USED FOR THAT REPORT.   * 00601910
006010*  MADE BY: NANCY EILBES                WR#: 23750              * 00602010
006011*                                                               * 00602110
006007*  03/11/2007                                                   * 00602212
006008*     MBDC PROJECT. RECOMPILE                                   * 00602312
006010*  MADE BY: GREG WISIALOWSKI            WR#: 21578              * 00603012
006011*                                                               * 00603112
006012*---------------------------------------------------------------* 00603212
006013 EJECT                                                            00603312
006014                                                                  00603412
006015 ENVIRONMENT DIVISION.                                            00603512
006016 CONFIGURATION SECTION.                                           00603612
006017 SOURCE-COMPUTER. IBM-3090.                                       00603712
006018 OBJECT-COMPUTER. IBM-3090.                                       00603812
006019                                                                  00603912
006020*                                                                 00604012
006021 INPUT-OUTPUT SECTION.                                            00604112
006022 FILE-CONTROL.                                                    00604212
006023*                                                                 00604312
006024     SELECT RECEIVING-SUMMARY-FILE     ASSIGN TO UT-S-INP01.      00604412
006025     SELECT INVOICE-SUMMARY-FILE       ASSIGN TO UT-S-INP02.      00604512
006026     SELECT RECEIVING-COST-FILE        ASSIGN TO UT-S-INP03.      00604612
006027     SELECT INVOICE-COST-FILE          ASSIGN TO UT-S-INP04.      00604712
006028     SELECT ESTIMATE-COST-FILE         ASSIGN TO UT-S-INP05.      00604812
006029     SELECT IMPORT-PO-REPORT-FILE      ASSIGN TO UT-S-OUT01.      00604912
006030*                                                                 00605012
006031 DATA DIVISION.                                                   00605112
006032 FILE SECTION.                                                    00605212
006033*                                                                 00605312
006034 FD  RECEIVING-SUMMARY-FILE                                       00605412
006040     RECORDING MODE IS F                                          00606012
006100     BLOCK CONTAINS 0 CHARACTERS                                  00610007
006200     LABEL RECORDS ARE STANDARD                                   00620007
006300     DATA RECORD IS RECEIVING-SUMMARY-RECORD.                     00630007
006400*                                                                 00640007
006500 01  RECEIVING-SUMMARY-RECORD     PIC X(150).                     00650007
006600*                                                                 00660007
006601 FD  INVOICE-SUMMARY-FILE                                         00660107
006602     RECORDING MODE IS F                                          00660207
006603     BLOCK CONTAINS 0 CHARACTERS                                  00660307
006604     LABEL RECORDS ARE STANDARD                                   00660407
006605     DATA RECORD IS INVOICE-SUMMARY-RECORD.                       00660507
006606*                                                                 00660607
006607 01  INVOICE-SUMMARY-RECORD       PIC X(150).                     00660707
006608*                                                                 00660807
006609 FD  RECEIVING-COST-FILE                                          00660907
006610     RECORDING MODE IS F                                          00661007
006611     BLOCK CONTAINS 0 CHARACTERS                                  00661107
006612     LABEL RECORDS ARE STANDARD                                   00661207
006613     DATA RECORD IS RECEIVING-COST-RECORD.                        00661307
006614*                                                                 00661407
006615 01  RECEIVING-COST-RECORD        PIC X(80).                      00661507
006616*                                                                 00661607
006617 FD  INVOICE-COST-FILE                                            00661707
006618     RECORDING MODE IS F                                          00661807
006619     BLOCK CONTAINS 0 CHARACTERS                                  00661907
006620     LABEL RECORDS ARE STANDARD                                   00662007
006621     DATA RECORD IS INVOICE-COST-RECORD.                          00662107
006622*                                                                 00662207
006623 01  INVOICE-COST-RECORD          PIC X(120).                     00662307
006624*                                                                 00662407
006625 FD  ESTIMATE-COST-FILE                                           00662507
006626     RECORDING MODE IS F                                          00662607
006627     BLOCK CONTAINS 0 CHARACTERS                                  00662707
006628     LABEL RECORDS ARE STANDARD                                   00662807
006629     DATA RECORD IS ESTIMATE-COST-RECORD.                         00662907
006630*                                                                 00663007
006631 01  ESTIMATE-COST-RECORD         PIC X(50).                      00663107
006632*                                                                 00663207
006633 FD  IMPORT-PO-REPORT-FILE                                        00663307
006634     RECORDING MODE IS F                                          00663407
006635     BLOCK CONTAINS 0 CHARACTERS                                  00663507
006636     LABEL RECORDS ARE STANDARD                                   00663607
006637     DATA RECORD IS IMPORT-PO-REPORT-RECORD.                      00663707
006638*                                                                 00663807
006639 01  IMPORT-PO-REPORT-RECORD      PIC X(175).                     00663907
006640*                                                                 00664007
006700 EJECT                                                            00670007
006800 WORKING-STORAGE SECTION.                                         00680007
006900                                                                  00690007
007000 01  PC-PROGRAM-CONSTANTS.                                        00700007
007100     05  PC-WS-PROGRAM           PIC  X(40)  VALUE                00710007
007200         '**** WORKING STORAGE ** APKUT049 ****'.                 00720007
008700                                                                  00870007
008800 01  PV-PROGRAM-VARIABLES.                                        00880007
008900     05  PV-CURRENT-PARAGRAPH    PIC  X(35).                      00890007
009000     05  PV-NULL-IND             PIC S9(4)     VALUE ZERO         00900007
009100                                               COMP SYNC.         00910007
010600     05  PV-PO-NBR               PIC  S9(9)    VALUE ZEROS        01060007
010700                                               COMP.              01070007
010800     05  PV-SAVE-PO-NBR-COMP     PIC S9(09)    VALUE ZEROS        01080007
010900                                               COMP.              01090007
011000     05  PV-VENDOR-NBR           PIC  X(09)    VALUE SPACES.      01100007
011100     05  PV-VENDOR-NAME          PIC  X(30)    VALUE SPACES.      01110007
011200     05  PV-ALW-CHRG-CDE         PIC  X(03)    VALUE SPACES.      01120007
011300     05  PV-ALC-RPT-CUTOFF-DATE  PIC  X(10)    VALUE SPACES.      01130007
011400     05  PV-ALC-RPT-CUTOFF-DTE.                                   01140007
011500         10  PV-ALC-RPT-CUTOFF-CC PIC 99.                         01150007
011600         10  PV-ALC-RPT-CUTOFF-YY PIC 99.                         01160007
011700         10  FILLER               PIC X.                          01170007
011800         10  PV-ALC-RPT-CUTOFF-MM PIC 99.                         01180007
011900         10  FILLER               PIC X.                          01190007
012000         10  PV-ALC-RPT-CUTOFF-DD PIC 99.                         01200007
012100                                                                  01210007
012200     05  PV-RCV-RPT-CUTOFF-DATE  PIC  X(10)    VALUE SPACES.      01220007
012300     05  PV-RCV-RPT-CUTOFF-DTE.                                   01230007
012400         10  PV-RVC-RPT-CUTOFF-CC PIC 99.                         01240007
012500         10  PV-RVC-RPT-CUTOFF-YY PIC 99.                         01250007
012600         10  FILLER               PIC X.                          01260007
012700         10  PV-RVC-RPT-CUTOFF-MM PIC 99.                         01270007
012800         10  FILLER               PIC X.                          01280007
012900         10  PV-RVC-RPT-CUTOFF-DD PIC 99.                         01290007
013000                                                                  01300007
013100     05  PV-RECV-CUTOFF-DATE     PIC  9(08)    VALUE ZEROS.       01310007
013200     05  PV-INVC-CUTOFF-DATE     PIC  9(08)    VALUE ZEROS.       01320007
013300     05  PV-VERFYD-DATE          PIC  9(08)    VALUE ZEROS.       01330007
013400     05  PV-INVOICE-DATE         PIC 9(08)     VALUE ZEROS.       01340007
013700     05  PV-AP033-COUNT          PIC S9(9)     VALUE ZEROS        01370007
013800                                               COMP.              01380007
013801     05  PV-AP062-COUNT          PIC S9(9)     VALUE ZEROS        01380107
013802                                               COMP.              01380207
013803     05  PV-AP034-COUNT          PIC S9(9)     VALUE ZEROS        01380307
013804                                               COMP.              01380407
013805     05  PV-AP063-COUNT          PIC S9(9)     VALUE ZEROS        01380507
013806                                               COMP.              01380607
013807     05  PV-AP064-COUNT          PIC S9(9)     VALUE ZEROS        01380707
013808                                               COMP.              01380807
013809     05  PV-RECEIVING-COUNT      PIC S9(9)     VALUE ZEROS        01380907
013810                                               COMP.              01381007
013811     05  PV-NO-RECEIPTS-COUNT    PIC S9(9)     VALUE ZEROS        01381107
013812                                               COMP.              01381207
013813     05  PV-POSTING-COUNT        PIC S9(9)     VALUE ZEROS        01381307
013814                                               COMP.              01381407
014300                                                                  01430007
014400 01  PS-PROGRAM-SWITCHES.                                         01440007
015100     05  PS-RECEIPT-RPT-SW       PIC  X(01)  VALUE ' '.           01510007
015200         88  PS-RECEIPT-RPTS                 VALUE 'Y'.           01520007
034200         88  PS-NO-RECEIPT-RPT-RECS          VALUE ' '.           03420007
034201     05  PS-END-INVOICES-SW      PIC  X(01)  VALUE ' '.           03420107
034202         88  PS-END-INVOICES                 VALUE 'Y'.           03420207
034203     05  PS-RECEIVING-SW         PIC  X(01)  VALUE ' '.           03420307
034204         88  PS-END-RECEIVING                VALUE 'Y'.           03420407
116900     05  PS-RECEIVING-COST-SW    PIC  X(01)  VALUE ' '.           11690007
116901         88  PS-END-RECEIVING-COST           VALUE 'Y'.           11690107
116902     05  PS-INVOICE-COST-SW      PIC  X(01)  VALUE ' '.           11690207
116903         88  PS-END-INVOICE-COST             VALUE 'Y'.           11690307
116904     05  PS-ESTIMATE-COST-SW     PIC  X(01)  VALUE ' '.           11690407
116905         88  PS-END-ESTIMATE-COST            VALUE 'Y'.           11690507
116906     05  PS-INVOIC-PAID-SW       PIC  X(01)  VALUE 'N'.           11690607
116907         88  PS-MI-INVOIC-PAID               VALUE 'Y'.           11690707
116908         88  PS-MI-INVOIC-NOT-PAID           VALUE 'N'.           11690807
116909/                                                                 11690907
116910*                                                                 11691007
116911*    RECEIVING-SUMMARY-RECORD                                     11691107
116912*                                                                 11691207
116913     COPY APRD033.                                                11691307
116914/                                                                 11691407
116915*                                                                 11691507
116916*    INVOICE-SUMMARY-RECORD                                       11691607
116917*                                                                 11691707
116918     COPY APRD062.                                                11691807
116919/                                                                 11691907
116920*                                                                 11692007
116921*    RECEIVING-COST-RECORD                                        11692107
116922*                                                                 11692207
116923     COPY APRD034.                                                11692307
116924/                                                                 11692407
116925*                                                                 11692507
116926*    INVOICE-COST-RECORD                                          11692607
116927*                                                                 11692707
116928     COPY APRD063.                                                11692807
116929/                                                                 11692907
116930*                                                                 11693007
116931*    ESTIMATE-COST-RECORD                                         11693107
116932*                                                                 11693207
116933     COPY APRD064.                                                11693307
116934/                                                                 11693407
116935*                                                                 11693507
116936*    IMPORT-PO-REPORT-RECORD                                      11693607
116937*                                                                 11693707
116938     COPY APRD031.                                                11693807
116939/                                                                 11693907
116940*                                                                 11694007
116941*    TAPCNTL DCLGEN                                               11694107
116942*                                                                 11694207
116943     EXEC SQL                                                     11694307
116944         INCLUDE TAPCNTL                                          11694407
116945     END-EXEC.                                                    11694507
116946/                                                                 11694607
116947*                                                                 11694707
116948*    TACCTYP DCLGEN                                               11694807
116949*                                                                 11694907
116950     EXEC SQL                                                     11695007
116951         INCLUDE TACCTYP                                          11695107
116952     END-EXEC.                                                    11695207
116953/                                                                 11695307
116961*                                                                 11696107
116962*    TINVOIC DCLGEN                                               11696207
116963*                                                                 11696307
116964     EXEC SQL                                                     11696407
116965         INCLUDE TINVOIC                                          11696507
116966     END-EXEC.                                                    11696607
116967/                                                                 11696707
116968 EJECT                                                            11696807
116969*----------------------------------------------------------------*11696907
116970* INVOICES_CSR GETS ALL OPEN TO PAY AND PAID MI INVOICES FOR THE *11697007
116980* PURCHASE ORDER BEING PROCESSED.                                *11698007
116990*----------------------------------------------------------------*11699007
117000     EXEC SQL                                                     11700007
117100       DECLARE INVOICES_CSR CURSOR FOR                            11710007
117200         SELECT PO_NBR                                            11720008
117400               ,STR_NBR                                           11740008
117500               ,INVC_ID                                           11750008
117600               ,INVC_DTE                                          11760008
117700           FROM TINVOIC                                           11770008
118000          WHERE PO_NBR       = :PV-SAVE-PO-NBR-COMP               11800008
118200            AND STATUS_CDE   IN ('OP', 'PD')                      11820008
118300            AND INVC_TYP_CDE IN ('MI')                            11830008
118400       ORDER BY PO_NBR                                            11840008
118500               ,INVC_ID                                           11850008
118600               ,STR_NBR                                           11860008
118700     END-EXEC.                                                    11870007
118701 EJECT                                                            11870107
118702/                                                                 11870207
118703*                                                                 11870307
118704*    SQL COMMUNICATIONS AREA DCLGEN                               11870407
118705*                                                                 11870507
118706     EXEC SQL                                                     11870607
118707         INCLUDE SQLCA                                            11870707
118708     END-EXEC.                                                    11870807
118709/                                                                 11870907
118710*---------------------------------------------------------------- 11871007
118711*  ABEND DATA AREAS                                               11871107
118712*---------------------------------------------------------------- 11871207
118713 01  ABEND-CODE                  PIC S9(04)  VALUE ZEROS          11871307
118714                                             COMP SYNC.           11871407
118715     88  AC-DB2-ERROR                        VALUE +4013.         11871507
118716                                                                  11871607
118717                                                                  11871707
118718 01  ABEND-AREAS.                                                 11871807
118719     05  AA-ABEND-LIT            PIC  X(40)  VALUE                11871907
118720             '*****       ABEND'.                                 11872007
118721     05  AA-PROGRAM-LIT          PIC  X(40)  VALUE                11872107
118722             '*****   PROGRAM: APKUT049'.                         11872207
118723     05  AA-PARAGRAPH-LIT.                                        11872307
118724         10  FILLER              PIC  X(17)  VALUE                11872407
118725             '***** PARAGRAPH: '.                                 11872507
118726         10  AA-PARAGRAPH-NAME   PIC  X(35)  VALUE SPACES.        11872607
118727     05  AA-MESSAGE-LINE.                                         11872707
118728         10  FILLER              PIC  X(06)  VALUE '*****'.       11872807
118729         10  AA-MESSAGE          PIC  X(127) VALUE SPACES.        11872907
118730     05  AA-DB2-ERROR-LIT        PIC  X(40)  VALUE                11873007
118731             '*****    DB2 ERROR'.                                11873107
118732     05  AA-DB2-OPERATION-LIT.                                    11873207
118733         10  FILLER              PIC  X(17)  VALUE                11873307
118734             '***** OPERATION: '.                                 11873407
118735         10  AA-DB2-OPERATION.                                    11873507
118736             15  AA-DB2-OP-1     PIC  X(25)  VALUE SPACES.        11873607
118737             15  AA-DB2-OP-2     PIC  X(25)  VALUE SPACES.        11873707
118738     05  AA-DB2-TABLE-1          PIC  X(08)  VALUE SPACES.        11873807
118739     05  AA-DB2-TABLE-2          PIC  X(08)  VALUE SPACES.        11873907
118740     05  AA-DB2-TABLE-3          PIC  X(08)  VALUE SPACES.        11874007
118741                                                                  11874107
118742/                                                                 11874207
118743*---------------------------------------------------------------- 11874307
118744*  SQLCA FORMATTED MESSAGE AREA                                   11874407
118745*---------------------------------------------------------------- 11874507
118746     COPY DPWS004.                                                11874607
118747*                                                                 11874707
118748/                                                                 11874807
118749 01  FILLER                      PIC  X(35)  VALUE                11874907
118750     '**** END OF W/S ** APKUT049 ****'.                          11875007
118751 EJECT                                                            11875107
118752 PROCEDURE DIVISION.                                              11875207
118753                                                                  11875307
118754     PERFORM A100-MAINLINE.                                       11875407
118755     GOBACK.                                                      11875507
118756                                                                  11875607
118757 EJECT                                                            11875707
118758 A100-MAINLINE.                                                   11875807
118759                                                                  11875907
118760     MOVE 'A100-MAINLINE' TO PV-CURRENT-PARAGRAPH.                11876007
118761                                                                  11876107
118762     PERFORM B100-INITIALIZE.                                     11876207
118763                                                                  11876307
118764     PERFORM B200-PROCESS-SUMMARY-FILES                           11876407
118765         UNTIL PS-END-RECEIVING                                   11876507
118766           AND PS-END-INVOICES.                                   11876607
118767                                                                  11876707
118768     PERFORM B300-END-OF-PROGRAM.                                 11876807
118769                                                                  11876907
118770 EJECT                                                            11877007
118771*---------------------------------------------------------------- 11877107
118772*    INITIALIZATION PROCESSING                                    11877207
118773*---------------------------------------------------------------- 11877307
118774 B100-INITIALIZE.                                                 11877407
118775                                                                  11877507
118776     MOVE 'B100-INITIALIZE' TO PV-CURRENT-PARAGRAPH.              11877607
118777                                                                  11877707
118778     OPEN INPUT  RECEIVING-SUMMARY-FILE                           11877807
118779                 INVOICE-SUMMARY-FILE                             11877907
118780                 RECEIVING-COST-FILE                              11878007
118781                 INVOICE-COST-FILE                                11878107
118782                 ESTIMATE-COST-FILE.                              11878207
118783     OPEN OUTPUT IMPORT-PO-REPORT-FILE.                           11878307
118784                                                                  11878407
118785     INITIALIZE DCLTAPCNTL                                        11878507
118786                DCLTACCTYP                                        11878607
118788                DCLTINVOIC                                        11878807
118789                AP031-IMPORT-REPORT-FILE.                         11878907
118790                                                                  11879007
118800     PERFORM S100-SELECT-TAPCNTL.                                 11880007
118900                                                                  11890007
119000     MOVE PV-RCV-RPT-CUTOFF-DATE TO PV-RCV-RPT-CUTOFF-DTE.        11900007
119100     STRING PV-RVC-RPT-CUTOFF-CC    DELIMITED BY SIZE             11910007
119200            PV-RVC-RPT-CUTOFF-YY    DELIMITED BY SIZE             11920007
119300            PV-RVC-RPT-CUTOFF-MM    DELIMITED BY SIZE             11930007
119400            PV-RVC-RPT-CUTOFF-DD    DELIMITED BY SIZE             11940007
119500                                INTO PV-RECV-CUTOFF-DATE          11950007
119600     END-STRING.                                                  11960007
119700                                                                  11970007
119800     MOVE PV-ALC-RPT-CUTOFF-DATE TO PV-ALC-RPT-CUTOFF-DTE.        11980007
119900     STRING PV-ALC-RPT-CUTOFF-CC    DELIMITED BY SIZE             11990007
120000            PV-ALC-RPT-CUTOFF-YY    DELIMITED BY SIZE             12000007
120100            PV-ALC-RPT-CUTOFF-MM    DELIMITED BY SIZE             12010007
120200            PV-ALC-RPT-CUTOFF-DD    DELIMITED BY SIZE             12020007
120300                                INTO PV-INVC-CUTOFF-DATE          12030007
120400     END-STRING.                                                  12040007
120401                                                                  12040107
120402     PERFORM R100-READ-RECEIVING-FILE.                            12040207
120403     PERFORM R200-READ-INVOICE-FILE.                              12040307
120404     PERFORM R300-READ-RECEIVING-COST-FILE.                       12040407
120405     PERFORM R400-READ-INVOICE-COST-FILE.                         12040507
120406     PERFORM R500-READ-ESTIMATE-COST-FILE.                        12040607
120407                                                                  12040707
120408 EJECT                                                            12040807
120409*---------------------------------------------------------------- 12040907
120410*    CONTROLS THE PROCESSING OF RECEIVING AND INVOICE SUMMARIES   12041007
120411*      BY PO .                                                    12041107
120412*---------------------------------------------------------------- 12041207
120413 B200-PROCESS-SUMMARY-FILES.                                      12041307
120414                                                                  12041407
120415     MOVE 'B200-PROCESS-SUMMARY-FILES' TO                         12041507
120416                             PV-CURRENT-PARAGRAPH.                12041607
120417                                                                  12041707
120418     IF AP033-PO-NBR = AP062-PO-NBR                               12041807
120419       OR AP033-PO-NBR < AP062-PO-NBR                             12041907
120420         MOVE AP033-PO-NBR TO PV-PO-NBR                           12042007
120430         SET PS-RECEIPT-RPTS TO TRUE                              12043007
120440         STRING AP033-VERFYD-DATE-CC    DELIMITED BY SIZE         12044007
120450                AP033-VERFYD-DATE-YY    DELIMITED BY SIZE         12045007
120460                AP033-VERFYD-DATE-MM    DELIMITED BY SIZE         12046007
120470                AP033-VERFYD-DATE-DD    DELIMITED BY SIZE         12047007
120480                                    INTO PV-VERFYD-DATE           12048007
120490         END-STRING                                               12049007
120500     ELSE                                                         12050007
120600         MOVE AP062-PO-NBR TO PV-PO-NBR                           12060007
120700         SET PS-NO-RECEIPT-RPT-RECS TO TRUE                       12070007
120800         STRING AP062-FIRST-INVC-CC    DELIMITED BY SIZE          12080007
120900                AP062-FIRST-INVC-YY    DELIMITED BY SIZE          12090007
121000                AP062-FIRST-INVC-MM    DELIMITED BY SIZE          12100007
121100                AP062-FIRST-INVC-DD    DELIMITED BY SIZE          12110007
121200                                    INTO PV-INVOICE-DATE          12120007
121300         END-STRING                                               12130007
121301     END-IF.                                                      12130107
121302                                                                  12130207
121303     IF AP033-PO-NBR = AP062-PO-NBR                               12130307
121304         IF ((PV-VERFYD-DATE = PV-RECV-CUTOFF-DATE)               12130407
121305               OR (PV-VERFYD-DATE < PV-RECV-CUTOFF-DATE))         12130507
121306             PERFORM D100-CREATE-PO-INFO-TYPE1                    12130607
121307             PERFORM D200-CREATE-RCV-TOT-INFO-TYPE2               12130707
121308             PERFORM D300-CREATE-INV-TOT-INFO-TYPE3               12130807
121309             PERFORM C100-PROCESS-RECEIVING-COST                  12130907
121310             IF NOT PS-END-RECEIVING                              12131007
121320                 PERFORM R100-READ-RECEIVING-FILE                 12132007
121330             END-IF                                               12133007
121331             IF NOT PS-END-INVOICES                               12133107
121332                 PERFORM R200-READ-INVOICE-FILE                   12133207
121333             END-IF                                               12133307
121334         ELSE                                                     12133407
121335         IF NOT PS-END-RECEIVING                                  12133507
121336             PERFORM R100-READ-RECEIVING-FILE                     12133607
121337         END-IF                                                   12133707
121338         IF NOT PS-END-INVOICES                                   12133807
121339             PERFORM R200-READ-INVOICE-FILE                       12133907
121340         END-IF                                                   12134007
121350     ELSE                                                         12135007
121360       IF AP033-PO-NBR < AP062-PO-NBR                             12136007
121370         IF ((PV-VERFYD-DATE = PV-RECV-CUTOFF-DATE)               12137007
121380               OR (PV-VERFYD-DATE < PV-RECV-CUTOFF-DATE))         12138007
121390             MOVE AP033-PO-NBR TO PV-SAVE-PO-NBR-COMP             12139007
121400             PERFORM Y100-OPEN-INVOICES-CSR                       12140007
121500             PERFORM R600-FETCH-INVOICES                          12150007
121501             PERFORM Y110-CLOSE-INVOICES-CSR                      12150107
121502             PERFORM D100-CREATE-PO-INFO-TYPE1                    12150207
121503             PERFORM D200-CREATE-RCV-TOT-INFO-TYPE2               12150307
121504             PERFORM C100-PROCESS-RECEIVING-COST                  12150407
121505             IF PS-MI-INVOIC-PAID                                 12150507
121506                SET PS-MI-INVOIC-NOT-PAID TO TRUE                 12150607
121507             END-IF                                               12150707
121508             IF NOT PS-END-RECEIVING                              12150807
121509                 PERFORM R100-READ-RECEIVING-FILE                 12150907
121510             END-IF                                               12151007
121520         ELSE                                                     12152007
121521         IF NOT PS-END-RECEIVING                                  12152107
121522             PERFORM R100-READ-RECEIVING-FILE                     12152207
121523         END-IF                                                   12152307
121524     ELSE                                                         12152407
121525       IF AP033-PO-NBR > AP062-PO-NBR                             12152507
121526         IF PV-INVOICE-DATE = PV-INVC-CUTOFF-DATE                 12152607
121527           OR PV-INVOICE-DATE < PV-INVC-CUTOFF-DATE               12152707
121528             PERFORM D100-CREATE-PO-INFO-TYPE1                    12152807
121529             PERFORM D300-CREATE-INV-TOT-INFO-TYPE3               12152907
121530             PERFORM C100-PROCESS-RECEIVING-COST                  12153007
121531             IF NOT PS-END-INVOICES                               12153107
121532                 PERFORM R200-READ-INVOICE-FILE                   12153207
121533             END-IF                                               12153307
121534         ELSE                                                     12153407
121535         IF NOT PS-END-INVOICES                                   12153507
121536             PERFORM R200-READ-INVOICE-FILE                       12153607
121537         END-IF                                                   12153707
121538       END-IF.                                                    12153807
121539                                                                  12153907
121540 EJECT                                                            12154007
121541*---------------------------------------------------------------- 12154107
121542*  END OF PROGRAM - DISPLAYS COUNTERS AND CLOSES FILES            12154207
121543*---------------------------------------------------------------- 12154307
121544 B300-END-OF-PROGRAM.                                             12154407
121545                                                                  12154507
121546     MOVE 'B300-END-OF-PROGRAM' TO PV-CURRENT-PARAGRAPH.          12154607
121547                                                                  12154707
121548     DISPLAY '**************************'.                        12154807
121549     DISPLAY 'PROGRAM APKUT049 RECORD COUNTS'.                    12154907
121550     DISPLAY 'NBR OF AP033 RECS READ  = ' PV-AP033-COUNT.         12155007
121551     DISPLAY 'NBR OF AP062 RECS READ  = ' PV-AP062-COUNT.         12155107
121552     DISPLAY 'NBR OF AP034 RECS READ  = ' PV-AP034-COUNT.         12155207
121553     DISPLAY 'NBR OF AP063 RECS READ  = ' PV-AP063-COUNT.         12155307
121554     DISPLAY 'NBR OF AP064 RECS READ  = ' PV-AP064-COUNT.         12155407
121555     DISPLAY 'NBR OF RECEIVING WRITTEN   = ' PV-RECEIVING-COUNT.  12155507
121556     DISPLAY 'NBR OF NO RECEIPTS WRITTEN = ' PV-NO-RECEIPTS-COUNT.12155607
121557     DISPLAY 'NBR OF POSTING WRITTEN     = ' PV-POSTING-COUNT.    12155707
121558     DISPLAY '**************************'.                        12155807
121559                                                                  12155907
121560     CLOSE RECEIVING-SUMMARY-FILE                                 12156007
121561           INVOICE-SUMMARY-FILE                                   12156107
121562           RECEIVING-COST-FILE                                    12156207
121563           INVOICE-COST-FILE                                      12156307
121564           ESTIMATE-COST-FILE                                     12156407
121565           IMPORT-PO-REPORT-FILE.                                 12156507
121566                                                                  12156607
121567 EJECT                                                            12156707
121568*---------------------------------------------------------------- 12156807
121569*  PROCESSES THE COST FILES AND CHECKS REPORT RUN TYPE            12156907
121570*---------------------------------------------------------------- 12157007
121580 C100-PROCESS-RECEIVING-COST.                                     12158007
121590     IF PS-END-RECEIVING-COST                                     12159007
121600         CONTINUE                                                 12160007
121700     ELSE                                                         12170007
121800       IF AP034-PO-NBR < PV-PO-NBR                                12180007
121900           PERFORM R300-READ-RECEIVING-COST-FILE                  12190007
122000                   UNTIL AP034-PO-NBR = PV-PO-NBR                 12200007
122100                      OR AP034-PO-NBR > PV-PO-NBR                 12210007
122200       END-IF                                                     12220007
122201       IF AP034-PO-NBR = PV-PO-NBR                                12220107
122202           PERFORM D700-CREATE-RCV-VAR-INFO-TYPE7                 12220207
122203                   UNTIL AP034-PO-NBR > PV-PO-NBR                 12220307
122204       END-IF                                                     12220407
122205     END-IF.                                                      12220507
122206                                                                  12220607
122207     IF PS-END-INVOICE-COST                                       12220707
122208       AND PS-END-ESTIMATE-COST                                   12220807
122209           CONTINUE                                               12220907
122210     ELSE                                                         12221007
122220         PERFORM C200-PROCESS-COST-FILES                          12222007
122230             UNTIL AP063-PO-NBR > PV-PO-NBR                       12223007
122240               AND AP064-PO-NBR > PV-PO-NBR                       12224007
122241     END-IF.                                                      12224107
122242                                                                  12224207
122243 EJECT                                                            12224307
122244*---------------------------------------------------------------- 12224407
122245*  RECORD TYPES AP063 AND AP064 ARE PROCESSED HERE. THE FILES     12224507
122246*  ARE BUMPED FOR THE PO BEING PROCESSED TO FINE MATCHING         12224607
122247*  ALW-CHRG-CDE. RECORD TYPES INV-INFO, PPD-INFO AND ELC-INFO     12224707
122248*  ARE CREATED DEPENDING UPON TYPE OF MATCH. IF THE INCLUDE       12224807
122249*  COST IN PO INDICATOR IS 'N' RECORDS ARE CONSIDERED NOT FOUND.  12224907
122250*---------------------------------------------------------------- 12225007
122251 C200-PROCESS-COST-FILES.                                         12225107
122252                                                                  12225207
122253     MOVE 'C200-PROCESS-COST-FILES' TO                            12225307
122254                             PV-CURRENT-PARAGRAPH.                12225407
122255                                                                  12225507
122256     IF PS-END-INVOICE-COST                                       12225607
122257         CONTINUE                                                 12225707
122258     ELSE                                                         12225807
122259       IF AP063-PO-NBR < PV-PO-NBR                                12225907
122260           PERFORM R400-READ-INVOICE-COST-FILE                    12226007
122270               UNTIL AP063-PO-NBR = PV-PO-NBR                     12227007
122280                  OR AP063-PO-NBR > PV-PO-NBR                     12228007
122290       END-IF                                                     12229007
122291     END-IF.                                                      12229107
122292                                                                  12229207
122293     IF PS-END-ESTIMATE-COST                                      12229307
122294         CONTINUE                                                 12229407
122295     ELSE                                                         12229507
122296       IF AP064-PO-NBR < PV-PO-NBR                                12229607
122297           PERFORM R500-READ-ESTIMATE-COST-FILE                   12229707
122298               UNTIL AP064-PO-NBR = PV-PO-NBR                     12229807
122299                  OR AP064-PO-NBR > PV-PO-NBR                     12229907
122300       END-IF                                                     12230007
122400     END-IF.                                                      12240007
122500                                                                  12250007
122600     IF ((AP063-PO-NBR = PV-PO-NBR)                               12260007
122700       AND (AP064-PO-NBR = PV-PO-NBR))                            12270007
122800         IF AP063-ALW-CHRG-CDE = AP064-ALW-CHRG-CDE               12280007
122900           PERFORM D500-CREATE-PPD-INFO-TYPE5                     12290007
122901           IF NOT PS-END-INVOICE-COST                             12290107
122902               PERFORM R400-READ-INVOICE-COST-FILE                12290207
122903           END-IF                                                 12290307
122904           IF NOT PS-END-ESTIMATE-COST                            12290407
122905               PERFORM R500-READ-ESTIMATE-COST-FILE               12290507
122906           END-IF                                                 12290607
122907         ELSE                                                     12290707
122908         IF AP063-ALW-CHRG-CDE < AP064-ALW-CHRG-CDE               12290807
122909           PERFORM D400-CREATE-INV-INFO-TYPE4                     12290907
122910           IF NOT PS-END-INVOICE-COST                             12291007
122920               PERFORM R400-READ-INVOICE-COST-FILE                12292007
122930           END-IF                                                 12293007
122940         ELSE                                                     12294007
122950         IF AP063-ALW-CHRG-CDE > AP064-ALW-CHRG-CDE               12295007
122960           PERFORM D600-CREATE-ELC-INFO-TYPE6                     12296007
122961           IF NOT PS-END-ESTIMATE-COST                            12296107
122962               PERFORM R500-READ-ESTIMATE-COST-FILE               12296207
122963           END-IF                                                 12296307
122964         END-IF                                                   12296407
122965     ELSE                                                         12296507
122966       IF AP063-PO-NBR = PV-PO-NBR                                12296607
122967           PERFORM D400-CREATE-INV-INFO-TYPE4                     12296707
122968         IF NOT PS-END-INVOICE-COST                               12296807
122969           PERFORM R400-READ-INVOICE-COST-FILE                    12296907
122970         END-IF                                                   12297007
122980       ELSE                                                       12298007
122990         IF AP064-PO-NBR = PV-PO-NBR                              12299007
123000             PERFORM D600-CREATE-ELC-INFO-TYPE6                   12300007
123001           IF NOT PS-END-ESTIMATE-COST                            12300107
123002             PERFORM R500-READ-ESTIMATE-COST-FILE                 12300207
123003           END-IF                                                 12300307
123004         END-IF                                                   12300407
123005       END-IF                                                     12300507
123006     END-IF.                                                      12300607
123007 EJECT                                                            12300707
126000*---------------------------------------------------------------- 12600007
126100* THESE RECORDS ARE CREATED EITHER FROM PO TOTALS ON AP033,       12610007
126200* IF CREATING A RECEIVING REPORT RECORD, OR FROM PO TOTALS ON     12620007
126201* AP062, IF CREATING NO-RCV REPORT RECORD.                        12620107
126202*---------------------------------------------------------------- 12620207
126203 D100-CREATE-PO-INFO-TYPE1.                                       12620307
126204                                                                  12620407
126205     MOVE 'D100-CREATE-PO-INFO-TYPE1' TO                          12620507
126206                             PV-CURRENT-PARAGRAPH.                12620607
126207                                                                  12620707
126208     IF PS-RECEIPT-RPTS                                           12620807
126209         IF AP033-AP-PRC-CDE = 'M'                                12620907
126210            SET AP031-POSTING-RPT TO TRUE                         12621007
126220            IF PS-MI-INVOIC-NOT-PAID                              12622007
126230               ADD +1 TO PV-POSTING-COUNT                         12623007
126240            END-IF                                                12624007
126250         ELSE                                                     12625007
126260            SET AP031-RCVING-RPT TO TRUE                          12626007
126270            IF PS-MI-INVOIC-NOT-PAID                              12627007
126280               ADD +1 TO PV-RECEIVING-COUNT                       12628007
126290            END-IF                                                12629007
126300         END-IF                                                   12630007
126400         MOVE AP033-VENDOR-NAME      TO AP031-VENDOR-NAME         12640007
126500                                        PV-VENDOR-NAME            12650007
126600         MOVE AP033-PO-NBR           TO AP031-PO-NBR              12660007
126700         SET  AP031-PO-INFO          TO TRUE                      12670007
126800         SET  AP031-HEADER           TO TRUE                      12680007
126900         MOVE AP033-VENDOR-NBR       TO AP031-VENDOR-NBR          12690007
127000                                        PV-VENDOR-NBR             12700007
127100         MOVE AP033-PO-TOT-QTY       TO AP031-TOTAL-QTY           12710007
127200         MOVE AP033-PO-1ST-COST-AMT  TO AP031-ACT-COST-AMT        12720007
127300         MOVE AP033-PO-ELC-COST-AMT  TO AP031-EST-COST-AMT        12730007
127400         MOVE AP033-FIRST-VERFYD-DATE TO AP031-FIRST-VERFYD-DTE   12740007
127500         MOVE AP033-DEPT-NBR         TO AP031-DEPT-NBR            12750007
127600         MOVE AP033-FOB-CDE          TO AP031-FOB-CDE             12760007
127700         MOVE AP033-OTB-PER-NBR      TO AP031-OTB-PER-NBR         12770007
127800         MOVE AP033-PO-STATUS-CDE    TO AP031-PO-STATUS-CDE       12780007
127900         MOVE AP033-LAST-VERFYD-DATE TO AP031-LAST-VERFYD-DATE    12790007
128000     ELSE                                                         12800007
128100         SET  AP031-NO-RCV-RPT       TO TRUE                      12810007
128200         MOVE AP062-VENDOR-NAME      TO AP031-VENDOR-NAME         12820007
128300                                        PV-VENDOR-NAME            12830007
128400         MOVE AP062-PO-NBR           TO AP031-PO-NBR              12840007
128500         SET  AP031-PO-INFO          TO TRUE                      12850007
128600         SET  AP031-HEADER           TO TRUE                      12860007
128700         MOVE AP062-VENDOR-NBR       TO AP031-VENDOR-NBR          12870007
128800                                        PV-VENDOR-NBR             12880007
128900         MOVE AP062-PO-UNT-QTY       TO AP031-TOTAL-QTY           12890007
129000         MOVE AP062-PO-TOT-COST-AMT  TO AP031-EST-COST-AMT        12900007
129100         MOVE AP062-PO-1ST-COST-AMT  TO AP031-ACT-COST-AMT        12910007
129200         MOVE SPACES                 TO AP031-OTB-PER-NBR         12920007
129300                                        AP031-PO-STATUS-CDE       12930007
129400                                        AP031-LAST-VERFYD-DATE    12940007
129500         ADD +1                      TO PV-NO-RECEIPTS-COUNT.     12950007
129600     PERFORM W100-IMPORT-REPORT-RECORD.                           12960007
129601                                                                  12960107
129602 EJECT                                                            12960207
129603*---------------------------------------------------------------- 12960307
129604*  THESE RECORD TYPES ARE CREATED FORM THE AP033 RECORD           12960407
129605*---------------------------------------------------------------- 12960507
129606 D200-CREATE-RCV-TOT-INFO-TYPE2.                                  12960607
129607                                                                  12960707
129608     MOVE 'D200-CREATE-RCV-TOT-INFO-TYPE2' TO                     12960807
129609                             PV-CURRENT-PARAGRAPH.                12960907
129610                                                                  12961007
129620     IF AP033-AP-PRC-CDE = 'M'                                    12962007
129630        SET AP031-POSTING-RPT TO TRUE                             12963007
129640        IF PS-MI-INVOIC-NOT-PAID                                  12964007
129650           ADD +1 TO PV-POSTING-COUNT                             12965007
129660        END-IF                                                    12966007
129670     ELSE                                                         12967007
129680        SET AP031-RCVING-RPT TO TRUE                              12968007
129690        IF PS-MI-INVOIC-NOT-PAID                                  12969007
129700           ADD +1 TO PV-RECEIVING-COUNT                           12970007
129800        END-IF                                                    12980007
129900     END-IF.                                                      12990007
130000     MOVE PV-VENDOR-NAME             TO AP031-VENDOR-NAME.        13000007
130100     MOVE AP033-PO-NBR               TO AP031-PO-NBR.             13010007
130200     SET  AP031-RCV-TOT-INFO         TO TRUE.                     13020007
130300     SET  AP031-HEADER               TO TRUE.                     13030007
130400     MOVE PV-VENDOR-NBR              TO AP031-VENDOR-NBR.         13040007
130500     MOVE AP033-FIRST-VERFYD-DATE    TO AP031-IMPRT-RPT-DTE.      13050007
130600     MOVE AP033-REC-TOT-QTY          TO AP031-TOTAL-QTY.          13060007
130700     MOVE AP033-REC-1ST-COST-AMT     TO AP031-ACT-COST-AMT.       13070007
130800     MOVE AP033-REC-ELC-COST-AMT     TO AP031-EST-COST-AMT.       13080007
130900     MOVE AP033-FIRST-VERFYD-DATE    TO AP031-FIRST-VERFYD-DTE.   13090007
131000     MOVE AP033-DEPT-NBR             TO AP031-DEPT-NBR.           13100007
131100     MOVE AP033-FOB-CDE              TO AP031-FOB-CDE.            13110007
131200     MOVE AP033-OTB-PER-NBR          TO AP031-OTB-PER-NBR.        13120007
131300     MOVE AP033-PO-STATUS-CDE        TO AP031-PO-STATUS-CDE.      13130007
131400     MOVE AP033-LAST-VERFYD-DATE     TO AP031-LAST-VERFYD-DATE.   13140007
131401     PERFORM W100-IMPORT-REPORT-RECORD.                           13140107
131402 EJECT                                                            13140207
131403*---------------------------------------------------------------- 13140307
131404*  THESE RECORD TYPES ARE CREATED FORM THE AP062 RECORD.          13140407
131405*---------------------------------------------------------------- 13140507
131406 D300-CREATE-INV-TOT-INFO-TYPE3.                                  13140607
131407                                                                  13140707
131408     MOVE 'D300-CREATE-INV-TOT-INFO-TYPE3' TO                     13140807
131409                             PV-CURRENT-PARAGRAPH.                13140907
131410                                                                  13141007
131420     IF PS-RECEIPT-RPTS                                           13142007
131430        IF AP033-AP-PRC-CDE = 'M'                                 13143007
131440           SET AP031-POSTING-RPT TO TRUE                          13144007
131450           IF PS-MI-INVOIC-NOT-PAID                               13145007
131460              ADD +1 TO PV-POSTING-COUNT                          13146007
131470           END-IF                                                 13147007
131480        ELSE                                                      13148007
131490           SET AP031-RCVING-RPT TO TRUE                           13149007
131500           IF PS-MI-INVOIC-NOT-PAID                               13150007
131600              ADD +1 TO PV-RECEIVING-COUNT                        13160007
131700           END-IF                                                 13170007
131800        END-IF                                                    13180007
131900        MOVE AP033-FIRST-VERFYD-DATE TO AP031-FIRST-VERFYD-DTE    13190007
132000        MOVE AP033-DEPT-NBR          TO AP031-DEPT-NBR            13200007
132100        MOVE AP033-FOB-CDE           TO AP031-FOB-CDE             13210007
132200        MOVE AP033-OTB-PER-NBR       TO AP031-OTB-PER-NBR         13220007
132300        MOVE AP033-PO-STATUS-CDE     TO AP031-PO-STATUS-CDE       13230007
132400        MOVE AP033-LAST-VERFYD-DATE  TO AP031-LAST-VERFYD-DATE    13240007
132500     ELSE                                                         13250007
132600        SET  AP031-NO-RCV-RPT   TO TRUE                           13260007
132700        ADD +1                  TO PV-NO-RECEIPTS-COUNT           13270007
132800     END-IF.                                                      13280007
132900     MOVE PV-VENDOR-NAME         TO AP031-VENDOR-NAME.            13290007
133000     MOVE AP062-PO-NBR           TO AP031-PO-NBR.                 13300007
133100     SET  AP031-INV-TOT-INFO     TO TRUE.                         13310007
133200     SET  AP031-HEADER           TO TRUE.                         13320007
133300     MOVE PV-VENDOR-NBR          TO AP031-VENDOR-NBR.             13330007
133400     MOVE AP062-INV-UNT-QTY      TO AP031-TOTAL-QTY.              13340007
133500     MOVE AP062-INV-1ST-COST-AMT TO AP031-ACT-COST-AMT.           13350007
133600     MOVE AP062-EST-1ST-COST-AMT TO AP031-EST-COST-AMT.           13360007
133700     MOVE AP062-FIRST-INVC-DTE   TO AP031-IMPRT-RPT-DTE.          13370007
133800     PERFORM W100-IMPORT-REPORT-RECORD.                           13380007
133801                                                                  13380107
133802 EJECT                                                            13380207
133803*---------------------------------------------------------------- 13380307
133804* THESE RECORDS ARE CREATED FORM THE AP063 RECORD WHEN NO MATCH   13380407
133805* IS FOUND ON THE AP064 FILE.                                     13380507
133806* -INV-CHRG-AMT GOES IN THE ACT-COST                              13380607
133807* -EST-COST WILL BE ZEROS                                         13380707
133808* -VAR-COST IS CALCULATED ACT-COST MINUS EST-COST                 13380807
133809* -CST-DESC NEEDS TO BE RETREIVED FROM THE TACCTYP TABLE FOR THE  13380907
133810*   ALW-CHRG-CDE BEING PROCESSED.                                 13381007
133811*---------------------------------------------------------------- 13381107
133812 D400-CREATE-INV-INFO-TYPE4.                                      13381207
133813                                                                  13381307
133814     MOVE 'D400-CREATE-INV-INFO-TYPE4' TO                         13381407
133815                             PV-CURRENT-PARAGRAPH.                13381507
133816                                                                  13381607
133817     IF PS-RECEIPT-RPTS                                           13381707
133818        IF AP033-AP-PRC-CDE = 'M'                                 13381807
133819           SET AP031-POSTING-RPT TO TRUE                          13381907
133820           IF PS-MI-INVOIC-NOT-PAID                               13382007
133830              ADD +1 TO PV-POSTING-COUNT                          13383007
133840           END-IF                                                 13384007
133850        ELSE                                                      13385007
133860           SET AP031-RCVING-RPT TO TRUE                           13386007
133870           IF PS-MI-INVOIC-NOT-PAID                               13387007
133880              ADD +1 TO PV-RECEIVING-COUNT                        13388007
133890           END-IF                                                 13389007
133900        END-IF                                                    13390007
134000        MOVE AP033-FIRST-VERFYD-DATE TO AP031-FIRST-VERFYD-DTE    13400007
134100        MOVE AP033-DEPT-NBR          TO AP031-DEPT-NBR            13410007
134200        MOVE AP033-FOB-CDE           TO AP031-FOB-CDE             13420007
134300        MOVE AP033-OTB-PER-NBR       TO AP031-OTB-PER-NBR         13430007
134400        MOVE AP033-PO-STATUS-CDE     TO AP031-PO-STATUS-CDE       13440007
134500        MOVE AP033-LAST-VERFYD-DATE  TO AP031-LAST-VERFYD-DATE    13450007
134600     ELSE                                                         13460007
134700         ADD +1                  TO PV-NO-RECEIPTS-COUNT          13470007
134800         SET  AP031-NO-RCV-RPT   TO TRUE                          13480007
134900     END-IF.                                                      13490007
135000     MOVE PV-VENDOR-NAME         TO AP031-VENDOR-NAME.            13500007
135100     MOVE AP063-PO-NBR           TO AP031-PO-NBR.                 13510007
135200     SET  AP031-INV-INFO         TO TRUE.                         13520007
135300     SET  AP031-DETAIL           TO TRUE.                         13530007
135400     MOVE PV-VENDOR-NBR          TO AP031-VENDOR-NBR.             13540007
135500     MOVE AP063-INV-CHRG-AMT     TO AP031-ACT-COST-AMT.           13550007
135600     COMPUTE AP031-VAR-COST-AMT = AP031-ACT-COST-AMT -            13560007
135700                         AP031-EST-COST-AMT.                      13570007
135800     MOVE AP063-ALW-CHRG-CDE     TO AP031-IMPRT-CST-CDE           13580007
135900                                    PV-ALW-CHRG-CDE.              13590007
135901                                                                  13590109
135910     IF  AP031-NO-RCV-RPT                                         13591009
136000         PERFORM S200-SELECT-ACCTYP                               13600009
136100         MOVE ACCTYP-ALW-CHRG-DESC (1:30) TO AP031-IMPRT-CST-DESC 13610009
136110     END-IF.                                                      13611009
136120                                                                  13612009
136200     PERFORM W100-IMPORT-REPORT-RECORD.                           13620007
136201                                                                  13620107
136202 EJECT                                                            13620207
136203*---------------------------------------------------------------- 13620307
136204* THESE RECORDS ARE CREATED WHEN A MATCH IS FOUND BETWEEN THE     13620407
136205* AP063 AND AP064 FILES.                                          13620507
136206* -INV-CHRG-AMT GOES IN THE ACT-COST                              13620607
136207* -AP064 EST-COST GOES IN THE EST-COST                            13620707
136208* -VAR-COST IS CALCULATED ACT-COST MINUS EST-COST                 13620807
136209* -CST-DESC NEEDS TO BE RETREIVED FROM THE TACCTYP TABLE FOR THE  13620907
136210*   ALW-CHRG-CDE BEING PROCESSED.                                 13621007
136220*---------------------------------------------------------------- 13622007
136230 D500-CREATE-PPD-INFO-TYPE5.                                      13623007
136231                                                                  13623107
136232     MOVE 'D500-CREATE-PPD-INFO-TYPE5' TO                         13623207
136233                             PV-CURRENT-PARAGRAPH.                13623307
136234                                                                  13623407
136235     IF PS-RECEIPT-RPTS                                           13623507
136236        IF AP033-AP-PRC-CDE = 'M'                                 13623607
136237           SET AP031-POSTING-RPT TO TRUE                          13623707
136238           IF PS-MI-INVOIC-NOT-PAID                               13623807
136239              ADD +1 TO PV-POSTING-COUNT                          13623907
136240           END-IF                                                 13624007
136250        ELSE                                                      13625007
136260           SET AP031-RCVING-RPT TO TRUE                           13626007
136270           IF PS-MI-INVOIC-NOT-PAID                               13627007
136280              ADD +1 TO PV-RECEIVING-COUNT                        13628007
136290           END-IF                                                 13629007
136300        END-IF                                                    13630007
136400        MOVE AP033-FIRST-VERFYD-DATE TO AP031-FIRST-VERFYD-DTE    13640007
136500        MOVE AP033-DEPT-NBR          TO AP031-DEPT-NBR            13650007
136600        MOVE AP033-FOB-CDE           TO AP031-FOB-CDE             13660007
136700        MOVE AP033-OTB-PER-NBR       TO AP031-OTB-PER-NBR         13670007
136800        MOVE AP033-PO-STATUS-CDE     TO AP031-PO-STATUS-CDE       13680007
136900        MOVE AP033-LAST-VERFYD-DATE  TO AP031-LAST-VERFYD-DATE    13690007
137000     ELSE                                                         13700007
137100         ADD +1                  TO PV-NO-RECEIPTS-COUNT          13710007
137200         SET  AP031-NO-RCV-RPT   TO TRUE                          13720007
137300     END-IF.                                                      13730007
137400     MOVE PV-VENDOR-NAME         TO AP031-VENDOR-NAME.            13740007
137500     MOVE AP063-PO-NBR           TO AP031-PO-NBR.                 13750007
137600     SET  AP031-PPD-INFO         TO TRUE.                         13760007
137700     SET  AP031-DETAIL           TO TRUE.                         13770007
137800     MOVE PV-VENDOR-NBR          TO AP031-VENDOR-NBR.             13780007
137900     MOVE AP063-INV-CHRG-AMT     TO AP031-ACT-COST-AMT.           13790007
138000     MOVE AP064-EST-COST-AMT     TO AP031-EST-COST-AMT.           13800007
138100     COMPUTE AP031-VAR-COST-AMT = AP031-ACT-COST-AMT -            13810007
138200                         AP031-EST-COST-AMT.                      13820007
138300     MOVE AP063-ALW-CHRG-CDE     TO AP031-IMPRT-CST-CDE           13830007
138400                                    PV-ALW-CHRG-CDE.              13840007
138410     IF  AP031-NO-RCV-RPT                                         13841009
138500         PERFORM S200-SELECT-ACCTYP                               13850009
138600         MOVE ACCTYP-ALW-CHRG-DESC (1:30) TO AP031-IMPRT-CST-DESC 13860009
138601     END-IF.                                                      13860109
138602                                                                  13860209
138603     PERFORM W100-IMPORT-REPORT-RECORD.                           13860307
138604 EJECT                                                            13860407
138605*---------------------------------------------------------------- 13860507
138606* THESE RECORDS ARE CREATED FROM THE AP064 RECORD WHEN NO MATCH   13860607
138607* IS FOUND ON AP063 FILE.                                         13860707
138608* -INV-CHRG-AMT CONTAINS ZEROS                                    13860807
138609* -AP064 EST-COST GOES IN THE EST-COST                            13860907
138610* -VAR-COST IS CALCULATED ACT-COST MINUS EST-COST                 13861007
138611* -CST-DESC NEEDS TO BE RETREIVED FROM THE TACCTYP TABLE FOR THE  13861107
138612*   ALW-CHRG-CDE BEING PROCESSED.                                 13861207
138620*---------------------------------------------------------------- 13862007
138630 D600-CREATE-ELC-INFO-TYPE6.                                      13863007
138631                                                                  13863107
138632     MOVE 'D600-CREATE-ELC-INFO-TYPE6' TO                         13863207
138633                             PV-CURRENT-PARAGRAPH.                13863307
138634                                                                  13863407
138635     IF PS-RECEIPT-RPTS                                           13863507
138636        IF AP033-AP-PRC-CDE = 'M'                                 13863607
138637           SET AP031-POSTING-RPT TO TRUE                          13863707
138638           IF PS-MI-INVOIC-NOT-PAID                               13863807
138639              ADD +1 TO PV-POSTING-COUNT                          13863907
138640           END-IF                                                 13864007
138650        ELSE                                                      13865007
138660           SET AP031-RCVING-RPT TO TRUE                           13866007
138670           IF PS-MI-INVOIC-NOT-PAID                               13867007
138680              ADD +1 TO PV-RECEIVING-COUNT                        13868007
138690           END-IF                                                 13869007
138700        END-IF                                                    13870007
138800        MOVE AP033-FIRST-VERFYD-DATE TO AP031-FIRST-VERFYD-DTE    13880007
138900        MOVE AP033-DEPT-NBR          TO AP031-DEPT-NBR            13890007
139000        MOVE AP033-FOB-CDE           TO AP031-FOB-CDE             13900007
139100        MOVE AP033-OTB-PER-NBR       TO AP031-OTB-PER-NBR         13910007
139200        MOVE AP033-PO-STATUS-CDE     TO AP031-PO-STATUS-CDE       13920007
139300        MOVE AP033-LAST-VERFYD-DATE  TO AP031-LAST-VERFYD-DATE    13930007
139400     ELSE                                                         13940007
139500         ADD +1                  TO PV-NO-RECEIPTS-COUNT          13950007
139600         SET  AP031-NO-RCV-RPT   TO TRUE                          13960007
139700     END-IF.                                                      13970007
139800     MOVE PV-VENDOR-NAME         TO AP031-VENDOR-NAME.            13980007
139900     MOVE AP064-PO-NBR           TO AP031-PO-NBR.                 13990007
140000     SET  AP031-ELC-INFO         TO TRUE.                         14000007
140100     SET  AP031-DETAIL           TO TRUE.                         14010007
140200     MOVE PV-VENDOR-NBR          TO AP031-VENDOR-NBR.             14020007
140300     MOVE AP064-EST-COST-AMT     TO AP031-EST-COST-AMT.           14030007
140400     COMPUTE AP031-VAR-COST-AMT = AP031-ACT-COST-AMT -            14040007
140500                         AP031-EST-COST-AMT.                      14050007
140600     MOVE AP064-ALW-CHRG-CDE     TO AP031-IMPRT-CST-CDE           14060007
140700                                    PV-ALW-CHRG-CDE.              14070007
140710                                                                  14071009
140720     IF  AP031-NO-RCV-RPT                                         14072009
140800         PERFORM S200-SELECT-ACCTYP                               14080009
140900         MOVE ACCTYP-ALW-CHRG-DESC (1:30) TO AP031-IMPRT-CST-DESC 14090009
140910     END-IF.                                                      14091009
140920                                                                  14092009
141000     PERFORM W100-IMPORT-REPORT-RECORD.                           14100007
141001                                                                  14100107
141002 EJECT                                                            14100207
141003*---------------------------------------------------------------- 14100307
141004* THESE RECORDS ARE CREATED FROM THE AP034 RECORD. IN ADDITION,   14100407
141005* THE CST-DESC NEEDS TO BE RETREIVED FROM THE TACCTYP TABLE       14100507
141006* FOR THE ALW-CHRG-CDE BEING PROCESSED.                           14100607
141007*---------------------------------------------------------------- 14100707
141008 D700-CREATE-RCV-VAR-INFO-TYPE7.                                  14100807
141009                                                                  14100907
141010     MOVE 'D700-CREATE-RCV-VAR-INFO-TYPE7' TO                     14101007
141020                             PV-CURRENT-PARAGRAPH.                14102007
141030                                                                  14103007
141040     IF PS-RECEIPT-RPTS                                           14104007
141050        IF AP033-AP-PRC-CDE = 'M'                                 14105007
141060           SET AP031-POSTING-RPT TO TRUE                          14106007
141070           IF PS-MI-INVOIC-NOT-PAID                               14107007
141080              ADD +1 TO PV-POSTING-COUNT                          14108007
141090           END-IF                                                 14109007
141100        ELSE                                                      14110007
141200           SET AP031-RCVING-RPT TO TRUE                           14120007
141300           IF PS-MI-INVOIC-NOT-PAID                               14130007
141400              ADD +1 TO PV-RECEIVING-COUNT                        14140007
141500           END-IF                                                 14150007
141600        END-IF                                                    14160007
141700        MOVE AP033-FIRST-VERFYD-DATE TO AP031-FIRST-VERFYD-DTE    14170007
141800        MOVE AP033-DEPT-NBR          TO AP031-DEPT-NBR            14180007
141900        MOVE AP033-FOB-CDE           TO AP031-FOB-CDE             14190007
142000        MOVE AP033-OTB-PER-NBR       TO AP031-OTB-PER-NBR         14200007
142100        MOVE AP033-PO-STATUS-CDE     TO AP031-PO-STATUS-CDE       14210007
142200        MOVE AP033-LAST-VERFYD-DATE  TO AP031-LAST-VERFYD-DATE    14220007
142300     ELSE                                                         14230007
142400         ADD +1                  TO PV-NO-RECEIPTS-COUNT          14240007
142500         SET  AP031-NO-RCV-RPT   TO TRUE                          14250007
142600     END-IF.                                                      14260007
142700     MOVE PV-VENDOR-NAME              TO AP031-VENDOR-NAME.       14270007
142800     MOVE AP034-PO-NBR                TO AP031-PO-NBR.            14280007
142900     MOVE PV-VENDOR-NBR               TO AP031-VENDOR-NBR.        14290007
143000     SET  AP031-RCV-VAR-INFO          TO TRUE.                    14300007
143100     SET  AP031-DETAIL                TO TRUE.                    14310007
143200     MOVE AP034-REC-UNT-QTY           TO AP031-TOTAL-QTY.         14320007
143300     MOVE AP034-REC-ELC-COST-AMT      TO AP031-ACT-COST-AMT.      14330007
143400     MOVE AP034-EST-ELC-COST-AMT      TO AP031-EST-COST-AMT.      14340007
143500     MOVE AP034-VAR-ELC-COST-AMT      TO AP031-VAR-COST-AMT.      14350007
143600     MOVE AP034-ALW-CHRG-CDE          TO AP031-IMPRT-CST-CDE      14360007
143700                                         PV-ALW-CHRG-CDE.         14370007
143710                                                                  14371009
143720     IF  AP031-NO-RCV-RPT                                         14372009
143800         PERFORM S200-SELECT-ACCTYP                               14380009
143900         MOVE ACCTYP-ALW-CHRG-DESC (1:30) TO AP031-IMPRT-CST-DESC 14390009
143910     END-IF.                                                      14391009
143920                                                                  14392009
144000     PERFORM W100-IMPORT-REPORT-RECORD.                           14400007
144100                                                                  14410007
144200     PERFORM R300-READ-RECEIVING-COST-FILE.                       14420007
144201                                                                  14420107
144202 EJECT                                                            14420207
144203*---------------------------------------------------------------- 14420307
144204*  READS THE RECEIVING FILE (AP033)                               14420407
144205*---------------------------------------------------------------- 14420507
144206 R100-READ-RECEIVING-FILE.                                        14420607
144207                                                                  14420707
144208     MOVE 'R100-RECEIVING-FILE' TO                                14420807
144209                             PV-CURRENT-PARAGRAPH.                14420907
144210                                                                  14421007
144211     READ RECEIVING-SUMMARY-FILE INTO AP033-RECORD                14421107
144212         AT END                                                   14421207
144213             MOVE ALL '9' TO AP033-RECORD                         14421307
144214             SET PS-END-RECEIVING TO TRUE                         14421407
144215         NOT AT END                                               14421507
144216             ADD +1              TO PV-AP033-COUNT.               14421607
144217                                                                  14421707
144218 EJECT                                                            14421807
144219*---------------------------------------------------------------- 14421907
144220*  READS THE INVOICE FILE (AP062)                                 14422007
144221*---------------------------------------------------------------- 14422107
144222 R200-READ-INVOICE-FILE.                                          14422207
144223                                                                  14422307
144224     MOVE 'R200-INVOICE-FILE' TO                                  14422407
144225                             PV-CURRENT-PARAGRAPH.                14422507
144226                                                                  14422607
144227     READ INVOICE-SUMMARY-FILE INTO AP062-RECORD                  14422707
144228         AT END                                                   14422807
144229             MOVE ALL '9' TO AP062-RECORD                         14422907
144230             SET PS-END-INVOICES TO TRUE                          14423007
144240         NOT AT END                                               14424007
144241             ADD +1              TO PV-AP062-COUNT.               14424107
144242 EJECT                                                            14424207
144243*---------------------------------------------------------------- 14424307
144244*  READS THE RECEIVING COST FILE AP034                            14424407
144245*---------------------------------------------------------------- 14424507
144246 R300-READ-RECEIVING-COST-FILE.                                   14424607
144247                                                                  14424707
144248     MOVE 'R300-READ-RECEIVING-COST-FILE' TO                      14424807
144249                             PV-CURRENT-PARAGRAPH.                14424907
144250                                                                  14425007
144251     READ RECEIVING-COST-FILE INTO AP034-RECORD                   14425107
144252         AT END                                                   14425207
144253             MOVE ALL '9' TO AP034-RECORD                         14425307
144254             SET PS-END-RECEIVING-COST TO TRUE                    14425407
144255         NOT AT END                                               14425507
144256             ADD +1              TO PV-AP034-COUNT.               14425607
144257                                                                  14425707
144258                                                                  14425807
144259 EJECT                                                            14425907
144260*---------------------------------------------------------------- 14426007
144261* READS THE INVOICE COST FILE AP063                               14426107
144262*---------------------------------------------------------------- 14426207
144263 R400-READ-INVOICE-COST-FILE.                                     14426307
144264                                                                  14426407
144265     MOVE 'R400-READ-INVOICE-COST-FILE' TO                        14426507
144266                             PV-CURRENT-PARAGRAPH.                14426607
144267                                                                  14426707
144268     READ INVOICE-COST-FILE INTO AP063-RECORD                     14426807
144269         AT END                                                   14426907
144270             MOVE ALL '9' TO AP063-RECORD                         14427007
144271             SET PS-END-INVOICE-COST TO TRUE                      14427107
144272         NOT AT END                                               14427207
144273             ADD +1              TO PV-AP063-COUNT.               14427307
144274                                                                  14427407
144275                                                                  14427507
144276 EJECT                                                            14427607
144277*---------------------------------------------------------------- 14427707
144278*  READ THE ESTIMATE COST FILE AP064                              14427807
144279*---------------------------------------------------------------- 14427907
144280 R500-READ-ESTIMATE-COST-FILE.                                    14428007
144281                                                                  14428107
144282     MOVE 'R500-READ-ESTIMATE-COST-FILE' TO                       14428207
144283                             PV-CURRENT-PARAGRAPH.                14428307
144284                                                                  14428407
144285     READ ESTIMATE-COST-FILE INTO AP064-RECORD                    14428507
144286         AT END                                                   14428607
144287             MOVE ALL '9' TO AP064-RECORD                         14428707
144288             SET PS-END-ESTIMATE-COST TO TRUE                     14428807
144289         NOT AT END                                               14428907
144290             ADD +1 TO PV-AP064-COUNT.                            14429007
144291                                                                  14429107
144292                                                                  14429207
144293 EJECT                                                            14429307
144294*----------------------------------------------------------------*14429407
144295*  RETRIEVES THE MI INVOICES THAT ARE PAID OR OPEN TO PAY STATUS *14429507
144296*  NOTE:  A NOT FOUND CONDITION IN THIS INSTANCE RESULTS IN      *14429607
144297*         THE MI INVOICES NOT PAID SWITCH BEING SET.             *14429707
144298*----------------------------------------------------------------*14429807
144299 R600-FETCH-INVOICES.                                             14429907
144300                                                                  14430007
144400     EXEC SQL                                                     14440007
144500         FETCH INVOICES_CSR                                       14450007
144600         INTO :INVOIC-PO-NBR                                      14460008
144700             ,:INVOIC-STR-NBR                                     14470007
144800             ,:INVOIC-INVC-ID                                     14480007
144900             ,:INVOIC-INVC-DTE                                    14490007
145000     END-EXEC.                                                    14500007
145100                                                                  14510007
145200     EVALUATE TRUE                                                14520007
145201         WHEN SQLCODE = ZERO                                      14520107
145202            SET PS-MI-INVOIC-PAID TO TRUE                         14520207
145203                                                                  14520307
145204         WHEN SQLCODE = +100                                      14520407
145205            SET PS-MI-INVOIC-NOT-PAID TO TRUE                     14520507
145206                                                                  14520607
145207         WHEN SQLWARN0 NOT = SPACES                               14520707
145208         WHEN SQLCODE  NOT = ZERO                                 14520807
145209             DISPLAY 'PO NUMBER: ' AP033-PO-NBR                   14520907
145210             MOVE 'R600-FETCH-INVOICES'    TO AA-PARAGRAPH-NAME   14521007
145220             MOVE 'UNSUCCESSFUL FETCH WITH INVOICES_CSR'          14522007
145230                                           TO AA-DB2-OPERATION    14523007
145250             MOVE 'TINVOIC'                TO AA-DB2-TABLE-1      14525008
145260             MOVE SPACES                   TO AA-DB2-TABLE-2      14526008
145261                                              AA-DB2-TABLE-3      14526108
145270             PERFORM Z999-DB2-ABEND                               14527007
145271     END-EVALUATE.                                                14527107
145272 EJECT                                                            14527207
145273*---------------------------------------------------------------- 14527307
145274*  SELECT BTCH-PRC-DTE AND CALCULATE THE ALC AND RCV              14527407
145275*  REPORT CUTOFF DATE                                             14527507
145276*---------------------------------------------------------------- 14527607
145277 S100-SELECT-TAPCNTL.                                             14527707
145278                                                                  14527807
145279     MOVE 'S100-SELECT-TAPCNTL' TO PV-CURRENT-PARAGRAPH.          14527907
145280                                                                  14528007
145290     EXEC SQL                                                     14529007
145300         SELECT BTCH_PRC_DTE - IMPRT_ALC_DAY_QTY DAYS             14530007
145400               ,BTCH_PRC_DTE - IMPRT_RCV_DAY_QTY DAYS             14540007
145500         INTO   :PV-ALC-RPT-CUTOFF-DATE                           14550007
145600               ,:PV-RCV-RPT-CUTOFF-DATE                           14560007
145700         FROM TAPCNTL                                             14570007
145800     END-EXEC.                                                    14580007
145900                                                                  14590007
146000     EVALUATE TRUE                                                14600007
146100         WHEN SQLCODE = ZERO                                      14610007
146200              CONTINUE                                            14620007
146300                                                                  14630007
146400         WHEN SQLWARN0 NOT = SPACES                               14640007
146500         WHEN SQLCODE  NOT = ZERO                                 14650007
146600         MOVE PV-CURRENT-PARAGRAPH                                14660007
146700                            TO AA-PARAGRAPH-NAME                  14670007
146800         MOVE 'UNSUCCESSFUL SELECT OF PAYMENT CONTROL TBL'        14680007
146900                            TO AA-DB2-OPERATION                   14690007
147000         MOVE 'TAPCNTL'     TO AA-DB2-TABLE-1                     14700007
147100         MOVE SPACES        TO AA-DB2-TABLE-2                     14710007
147200                                                                  14720007
147300         PERFORM Z999-DB2-ABEND                                   14730007
147400     END-EVALUATE.                                                14740007
147500                                                                  14750007
147501 EJECT                                                            14750107
147502*---------------------------------------------------------------- 14750207
147503* SELECT ACCTYP FOR THE ALW-CHRG-DESC                             14750307
147504*---------------------------------------------------------------- 14750407
147505 S200-SELECT-ACCTYP.                                              14750507
147506                                                                  14750607
147507     MOVE 'S200-SELECT-ACCTYP'   TO PV-CURRENT-PARAGRAPH.         14750707
147508                                                                  14750807
147509     EXEC SQL                                                     14750907
147510         SELECT                                                   14751007
147511             ALW_CHRG_DESC                                        14751107
147512         INTO                                                     14751207
147513             :ACCTYP-ALW-CHRG-DESC                                14751307
147514         FROM TACCTYP                                             14751407
147515         WHERE ALW_CHRG_CDE = :PV-ALW-CHRG-CDE                    14751507
147516     END-EXEC.                                                    14751607
147517                                                                  14751707
147518     EVALUATE TRUE                                                14751807
147519         WHEN SQLCODE = ZERO                                      14751907
147520         WHEN SQLCODE = -811                                      14752009
147521            CONTINUE                                              14752109
147522                                                                  14752209
147523         WHEN SQLCODE = +100                                      14752309
147524             DISPLAY 'PO = ' AP031-PO-NBR                         14752409
147525             DISPLAY 'ALW-CHRG-CDE = ' PV-ALW-CHRG-CDE            14752509
147526             IF PV-ALW-CHRG-CDE = 'LCC'                           14752609
147527                MOVE 'LETTER OF CREDIT AGENT COMMISSION'          14752709
147528                  TO ACCTYP-ALW-CHRG-DESC                         14752809
147529             END-IF                                               14752909
147530                                                                  14753009
147531         WHEN SQLWARN0 NOT = SPACES                               14753109
147532         WHEN SQLCODE  NOT = ZERO                                 14753209
147533             MOVE PV-CURRENT-PARAGRAPH                            14753309
147534                                 TO AA-PARAGRAPH-NAME             14753409
147535             MOVE 'UNSUCCESSFUL SELECT FOR ACCTYP'                14753509
147536                                 TO AA-DB2-OPERATION              14753609
147537             MOVE 'TACCTYP'      TO AA-DB2-TABLE-1                14753709
147538             MOVE SPACES         TO AA-DB2-TABLE-2                14753809
147539                                    AA-DB2-TABLE-3                14753909
147540             PERFORM Z999-DB2-ABEND                               14754009
147541     END-EVALUATE.                                                14754109
147550                                                                  14755007
147560 EJECT                                                            14756007
147570 W100-IMPORT-REPORT-RECORD.                                       14757007
147580     IF PS-MI-INVOIC-NOT-PAID                                     14758007
147590        WRITE IMPORT-PO-REPORT-RECORD                             14759007
147600                        FROM AP031-IMPORT-REPORT-FILE             14760007
147700     END-IF.                                                      14770007
147800                                                                  14780007
147900     INITIALIZE AP031-IMPORT-REPORT-FILE.                         14790007
148000                                                                  14800007
148100 EJECT                                                            14810007
148200*---------------------------------------------------------------- 14820007
148300*    OPENS THE INVOICES CURSOR.                                   14830007
148400*---------------------------------------------------------------- 14840007
148500 Y100-OPEN-INVOICES-CSR.                                          14850007
148600                                                                  14860007
148700     EXEC SQL                                                     14870007
148800         OPEN INVOICES_CSR                                        14880007
148900     END-EXEC.                                                    14890007
149000                                                                  14900007
149100     EVALUATE TRUE                                                14910007
149200         WHEN SQLCODE = ZERO                                      14920007
149300              CONTINUE                                            14930007
149400                                                                  14940007
149500         WHEN SQLWARN0 NOT = SPACES                               14950007
149600         WHEN SQLCODE  NOT = ZERO                                 14960007
149700             MOVE 'Y100-OPEN-INVOICES-CSR' TO AA-PARAGRAPH-NAME   14970007
149800             MOVE 'UNSUCCESSFUL OPEN ON INVOICES_CSR'             14980007
149900                                           TO AA-DB2-OPERATION    14990007
150100             MOVE 'TINVOIC'      TO AA-DB2-TABLE-1                15010008
150200             MOVE SPACES         TO AA-DB2-TABLE-2                15020008
150210                                    AA-DB2-TABLE-3                15021008
150300             PERFORM Z999-DB2-ABEND                               15030007
150400     END-EVALUATE.                                                15040007
150500                                                                  15050007
150600                                                                  15060007
150700 EJECT                                                            15070007
150800*---------------------------------------------------------------- 15080007
150900*    CLOSES THE INVOICES CURSOR.                                  15090007
151000*---------------------------------------------------------------- 15100007
151100 Y110-CLOSE-INVOICES-CSR.                                         15110007
151200                                                                  15120007
151300       EXEC SQL                                                   15130007
151400           CLOSE INVOICES_CSR                                     15140007
151500       END-EXEC.                                                  15150007
151600                                                                  15160007
151700       EVALUATE TRUE                                              15170007
151800           WHEN SQLCODE = ZERO                                    15180007
151900                CONTINUE                                          15190007
152000                                                                  15200007
152100           WHEN SQLWARN0 NOT = SPACES                             15210007
152200           WHEN SQLCODE  NOT = ZERO                               15220007
152300               MOVE 'Y110-CLOSE-INVOICES-CSR'                     15230007
152400                                         TO AA-PARAGRAPH-NAME     15240007
152500               MOVE 'UNSUCCESSFUL CLOSE ON INVOICES_CSR'          15250007
152600                                         TO AA-DB2-OPERATION      15260007
152800               MOVE 'TINVOIC'      TO AA-DB2-TABLE-1              15280008
152900               MOVE SPACES         TO AA-DB2-TABLE-2              15290008
152910                                      AA-DB2-TABLE-3              15291008
153000               PERFORM Z999-DB2-ABEND                             15300007
153100       END-EVALUATE.                                              15310007
153101 EJECT                                                            15310107
153102*---------------------------------------------------------------- 15310207
153103*    ABEND ROUTINE FOR DB2 ERRORS                                 15310307
153104*---------------------------------------------------------------- 15310407
153105 Z999-DB2-ABEND.                                                  15310507
153106                                                                  15310607
153107     CLOSE RECEIVING-SUMMARY-FILE                                 15310707
153108           INVOICE-SUMMARY-FILE                                   15310807
153109           RECEIVING-COST-FILE                                    15310907
153110           INVOICE-COST-FILE                                      15311007
153111           ESTIMATE-COST-FILE                                     15311107
153112           IMPORT-PO-REPORT-FILE.                                 15311207
153113                                                                  15311307
153114     DISPLAY AA-ABEND-LIT.                                        15311407
153115     DISPLAY AA-DB2-ERROR-LIT.                                    15311507
153116     DISPLAY AA-PROGRAM-LIT.                                      15311607
153117     DISPLAY AA-PARAGRAPH-LIT.                                    15311707
153118     DISPLAY AA-DB2-OPERATION-LIT.                                15311807
153119     DISPLAY AA-DB2-TABLE-1.                                      15311907
153120     DISPLAY AA-DB2-TABLE-2.                                      15312007
153121     DISPLAY AA-DB2-TABLE-3.                                      15312107
153122     SET AC-DB2-ERROR TO TRUE.                                    15312207
153123                                                                  15312307
153124     COPY DPPD004.                                                15312407
153125                                                                  15312507
153126     CALL 'ILBOABN0' USING ABEND-CODE.                            15312607
