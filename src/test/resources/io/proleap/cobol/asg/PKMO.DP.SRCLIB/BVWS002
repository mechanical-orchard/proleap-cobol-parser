      ******************************************************************        
      *  THIS WORKING-STORAGE COPYBOOK IS NEEDED FOR BVPD002 COPY CODE.         
      *                                                                         
      *  FOR INSTRUCTIONS, PLEASE SEE BVPD002                                   
      ******************************************************************        
      *         06/19/2008   NEW COPY CODE TO GET % CONTRIBUTION OF    *        
      *                      EACH VENDOR                                        
      *         03/05/2012   COGNIZANT - REMOVED  ALL 10 REFERENCES OF          
      *                        BV002-PV-LBL-SEQ-IN* & INCLUDED                  
      *                        BV002-PV-EXP-TYP-NBR-IN                          
      ******************************************************************        
                                                                                
       01  BV002-PV-PROGRAM-VARIABLE.                                           
           05  BV002-PV-INPUT-AREA.                                             
               10  BV002-PV-DEPT-IN            PIC S9(04) COMP-3.               
               10  FILLER REDEFINES BV002-PV-DEPT-IN.                           
                   15  BV002-PV-DEPT-IN-X      PIC X(3).                        
               10  BV002-PV-PRO-DTE-IN.                                         
                   15 BV002-PV-PRO-DTE-IN-YR   PIC X(04) VALUE SPACES.          
                   15 FILLER                   PIC X(01) VALUE SPACES.          
                   15 BV002-PV-PRO-DTE-IN-MN   PIC X(02) VALUE SPACES.          
                   15 FILLER                   PIC X(01) VALUE SPACES.          
                   15 BV002-PV-PRO-DTE-IN-DY   PIC X(02) VALUE SPACES.          
               10  BV002-PV-FSC-WK-ST-IN.                                       
                   15 BV002-PV-FSC-WK-ST-IN-YR PIC X(04) VALUE SPACES.          
                   15 FILLER                   PIC X(01) VALUE SPACES.          
                   15 BV002-PV-FSC-WK-ST-IN-MN PIC X(02) VALUE SPACES.          
                   15 FILLER                   PIC X(01) VALUE SPACES.          
                   15 BV002-PV-FSC-WK-ST-IN-DY PIC X(02) VALUE SPACES.          
               10  BV002-PV-FSC-WK-ED-IN.                                       
                   15 BV002-PV-FSC-WK-ED-IN-YR PIC X(04) VALUE SPACES.          
                   15 FILLER                   PIC X(01) VALUE SPACES.          
                   15 BV002-PV-FSC-WK-ED-IN-MN PIC X(02) VALUE SPACES.          
                   15 FILLER                   PIC X(01) VALUE SPACES.          
                   15 BV002-PV-FSC-WK-ED-IN-DY PIC X(02) VALUE SPACES.          
PK9934*        10  BV002-PV-LBL-SEQ-IN1        PIC S9(04).                      
PK9934*        10  FILLER REDEFINES BV002-PV-LBL-SEQ-IN1.                       
PK9934*            15  BV002-PV-LBL-SEQ-IN1-X  PIC X(04).                       
PK9934*        10  BV002-PV-LBL-SEQ-IN2        PIC S9(04).                      
PK9934*        10  FILLER REDEFINES BV002-PV-LBL-SEQ-IN2.                       
PK9934*            15  BV002-PV-LBL-SEQ-IN2-X  PIC X(04).                       
PK9934*        10  BV002-PV-LBL-SEQ-IN3        PIC S9(04).                      
PK9934*        10  FILLER REDEFINES BV002-PV-LBL-SEQ-IN3.                       
PK9934*            15  BV002-PV-LBL-SEQ-IN3-X  PIC X(04).                       
PK9934*        10  BV002-PV-LBL-SEQ-IN4        PIC S9(04).                      
PK9934*        10  FILLER REDEFINES BV002-PV-LBL-SEQ-IN4.                       
PK9934*            15  BV002-PV-LBL-SEQ-IN4-X  PIC X(04).                       
PK9934*        10  BV002-PV-LBL-SEQ-IN5        PIC S9(04).                      
PK9934*        10  FILLER REDEFINES BV002-PV-LBL-SEQ-IN5.                       
PK9934*            15  BV002-PV-LBL-SEQ-IN5-X  PIC X(04).                       
PK9934*        10  BV002-PV-LBL-SEQ-IN6        PIC S9(04).                      
PK9934*        10  FILLER REDEFINES BV002-PV-LBL-SEQ-IN6.                       
PK9934*            15  BV002-PV-LBL-SEQ-IN6-X  PIC X(04).                       
PK9934*        10  BV002-PV-LBL-SEQ-IN7        PIC S9(04).                      
PK9934*        10  FILLER REDEFINES BV002-PV-LBL-SEQ-IN7.                       
PK9934*            15  BV002-PV-LBL-SEQ-IN7-X  PIC X(04).                       
PK9934*        10  BV002-PV-LBL-SEQ-IN8        PIC S9(04).                      
PK9934*        10  FILLER REDEFINES BV002-PV-LBL-SEQ-IN8.                       
PK9934*            15  BV002-PV-LBL-SEQ-IN8-X  PIC X(04).                       
PK9934*        10  BV002-PV-LBL-SEQ-IN9        PIC S9(04).                      
PK9934*        10  FILLER REDEFINES BV002-PV-LBL-SEQ-IN9.                       
PK9934*            15  BV002-PV-LBL-SEQ-IN9-X  PIC X(04).                       
PK9934*        10  BV002-PV-LBL-SEQ-IN10       PIC S9(04).                      
PK9934*        10  FILLER REDEFINES BV002-PV-LBL-SEQ-IN10.                      
PK9934*            15  BV002-PV-LBL-SEQ-IN10-X PIC X(04).                       
PK9934         10  BV002-PV-EXP-TYP-NBR-IN     PIC S9(04) COMP.                 
PK9934         10  FILLER REDEFINES BV002-PV-EXP-TYP-NBR-IN.                    
PK9934             15  BV002-PV-EXP-TYP-NBR-IN-X PIC X(02).                     
           05  BV002-PV-OUTPUT-AREA.                                            
               10  BV002-PV-RESULT-TABLE OCCURS 99999 TIMES.                    
                   20  BV002-RT-DEPT-OUT        PIC S9(4) COMP-3.               
                   20  BV002-RT-BRND-OUT        PIC S9(4) COMP.                 
                   20  BV002-RT-ENT-ID-OUT      PIC S9(9) COMP.                 
                   20  BV002-RT-RCPT-GR-CST-OUT PIC S9(11)V9(2) COMP-3.         
                   20  BV002-RT-PERCENTAGE      PIC S9(3)V9(7) VALUE +0         
                                                          COMP-3.               
               10  BV002-PV-RETURN-STATUS-AREA.                                 
                   15  BV002-PV-RETURN-CDE PIC S9(04) VALUE ZEROES              
                               COMP.                                            
                       88  BV002-BAD-DEPT             VALUE +1.                 
                       88  BV002-BAD-PROCESS-DT       VALUE +2.                 
                       88  BV002-BAD-FSC-WK           VALUE +3.                 
                       88  BV002-PV-SQL-ERROR         VALUE +4.                 
                   15  BV002-PV-RETURN-MSG-1 PIC X(80) VALUE SPACES.            
                   15  BV002-PV-RETURN-MSG-2 PIC X(80) VALUE SPACES.            
               10  BV002-PV-SQLCODE-OUT    PIC S9(09) COMP-4.                   
           05  BV002-PV-WORK-AREA.                                              
               10 BV002-END-OF-CSR-SWITCH PIC X(01) VALUE 'N'.                  
                  88 BV002-END-OF-CSR               VALUE 'Y'.                  
               10 BV002-EQUAL-PRORATE-SW  PIC X(01) VALUE 'Y'.                  
                  88 BV002-EQUAL-PRORATE-YES        VALUE 'Y'.                  
                  88 BV002-EQUAL-PRORATE-NO         VALUE 'N'.                  
               10 BV002-PV-IDX            PIC 9(05) VALUE ZERO.                 
               10 BV002-PV-HOLD-IDX       PIC 9(05) VALUE ZERO.                 
               10 BV002-PV-RCPT-GRO-CST-AMT PIC  S9(11)V9(2) COMP-3             
                                              VALUE ZERO.                       
               10 BV002-PV-TOTAL-GROSS-COST PIC  S9(15)V9(2) COMP-3             
                                              VALUE ZERO.                       
               10 BV002-PV-DEPT-IN-WRK        PIC S9(04) COMP-3                 
                                           VALUE ZEROS.                         
               10 BV002-PV-PRO-DTE-IN-WRK     PIC X(10) VALUE SPACES.           
               10 BV002-PV-FSC-WK-ST-IN-WRK   PIC X(10) VALUE SPACES.           
               10 BV002-PV-FSC-WK-ED-IN-WRK   PIC X(10) VALUE SPACES.           
PK9934*        10 BV002-PV-LBL-SEQ-IN-WRK1    PIC S9(04) COMP VALUE +0.         
PK9934*        10 BV002-PV-LBL-SEQ-IN-WRK2    PIC S9(04) COMP VALUE +0.         
PK9934*        10 BV002-PV-LBL-SEQ-IN-WRK3    PIC S9(04) COMP VALUE +0.         
PK9934*        10 BV002-PV-LBL-SEQ-IN-WRK4    PIC S9(04) COMP VALUE +0.         
PK9934*        10 BV002-PV-LBL-SEQ-IN-WRK5    PIC S9(04) COMP VALUE +0.         
PK9934*        10 BV002-PV-LBL-SEQ-IN-WRK6    PIC S9(04) COMP VALUE +0.         
PK9934*        10 BV002-PV-LBL-SEQ-IN-WRK7    PIC S9(04) COMP VALUE +0.         
PK9934*        10 BV002-PV-LBL-SEQ-IN-WRK8    PIC S9(04) COMP VALUE +0.         
PK9934*        10 BV002-PV-LBL-SEQ-IN-WRK9    PIC S9(04) COMP VALUE +0.         
PK9934*        10 BV002-PV-LBL-SEQ-IN-WRK10   PIC S9(04) COMP VALUE +0.         
PK9934         10 BV002-PV-EXP-TYP-NBR-WRK    PIC S9(04) COMP.                  
               10 BV002-PV-PERCENT-SO-FAR   PIC S9(3)V9(7) VALUE +0             
                                                          COMP-3.               
           05  BV002-PC-CONSTANTS.                                              
               10 BV002-PC-UNK-VNDR              PIC S9(09) VALUE +5161         
                                                 COMP.                          
               10 BV002-PC-UNK-BRAND             PIC S9(04) VALUE +2230         
                                                 COMP.                          
      ******************************************************************        
      * ITEM DEPT BRAND VEND CURSOR                                             
      ******************************************************************        
           EXEC SQL                                                             
               DECLARE IMT_BRND_VND CURSOR FOR                                  
                 SELECT A.DEPT_BRND_VND_ID                                      
                       ,A.DEPT_NBR                                              
                       ,A.ENT_ID                                                
                       ,A.LBL_SEQ_NBR                                           
                   FROM IMT_DEPT_BRND_VND A                                     
                   WHERE A.EFF_BEG_DTE <= :BV002-PV-PRO-DTE-IN-WRK              
                  AND (A.EFF_END_DTE >= :BV002-PV-PRO-DTE-IN-WRK OR             
                       A.EFF_END_DTE IS NULL)                                   
                  AND A.DEPT_NBR  = :BV002-PV-DEPT-IN-WRK                       
                  AND A.LBL_SEQ_NBR IN (                                        
PK9934*               :BV002-PV-LBL-SEQ-IN-WRK1                                 
PK9934*              ,:BV002-PV-LBL-SEQ-IN-WRK2                                 
PK9934*              ,:BV002-PV-LBL-SEQ-IN-WRK3                                 
PK9934*              ,:BV002-PV-LBL-SEQ-IN-WRK4                                 
PK9934*              ,:BV002-PV-LBL-SEQ-IN-WRK5                                 
PK9934*              ,:BV002-PV-LBL-SEQ-IN-WRK6                                 
PK9934*              ,:BV002-PV-LBL-SEQ-IN-WRK7                                 
PK9934*              ,:BV002-PV-LBL-SEQ-IN-WRK8                                 
PK9934*              ,:BV002-PV-LBL-SEQ-IN-WRK9                                 
PK9934*              ,:BV002-PV-LBL-SEQ-IN-WRK10                                
PK9934               SELECT B.LBL_SEQ_NBR                                       
PK9934               FROM MLT_VND_ALLOC B                                       
PK9934               WHERE B.EXP_TYP_NBR = :BV002-PV-EXP-TYP-NBR-WRK            
                      )                                                         
                  ORDER BY ENT_ID                                               
                  WITH UR                                                       
                  FOR FETCH ONLY                                                
           END-EXEC.                                                            
