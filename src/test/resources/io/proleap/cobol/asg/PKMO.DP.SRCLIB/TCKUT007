000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.               TCKUT007.                              00020000
000300 AUTHOR.                   ROBERTA DEBARTOLO.                     00030000
000400 INSTALLATION.             KOHLS DEPARTMENT STORES.               00040000
000500 DATE-WRITTEN.             APRIL, 2002.                           00050000
000600 DATE-COMPILED.                                                   00060000
000700*----------------------------------------------------------------*00070000
000800*            CREDIT PROCESSOR CONVERSION PROJECT                 *00080000
000900*----------------------------------------------------------------*00090000
001000*  PROGRAM NARRATIVE:                                            *00100000
001100*                                                                *00110000
001200*   PROGRAM PROCESSES THE EARLY EXTRACT OF BANKCARD/AMEX CREDIT  *00120000
001300*   TRANSACTIONS FOR FIFTH THIRD BANK.                           *00130000
001400*   THE INPUT FILE IS AN UNLOAD OF THE COSA TABLES RUN BEFORE    *00140000
001500*   THIS PROGRAM.                                                *00150000
001600*   TWO SEPARATE FILES ARE WRITTEN OUT.  ONE IS A BANK SETTLEMENT*00160000
001700*   FILE AND THE OTHER IS A FILE THAT IS SENT TO AJB FOR         *00170000
001800*   REAUTHORIZATION OF ECOMMERCE TRANSACTIONS WITH A TRANS DATE  *00180000
001900*   MORE THAN 7 DAYS AFTER THE SALES DATE OR MODIFIED ORDER.     *00190000
002000*----------------------------------------------------------------*00200000
002100*                                                                *00210000
002200* DATE:        2014-01-16                                        *00220000
002300* WR/IR#:      P9696 - AJB SETTLEMENT                            *00230000
002400* PROGRAMMER:  COGNIZANT                                         *00240000
002500* DESCRIPTION: REMOVED 'SFS' OMNI-CHNL-FFLMT-TYP-CDE CHECK FOR   *00250000
002600*              RETURN IN 1850-CHECK-ECOMMERCE-STORE PARA.        *00260000
002700*              BECASUE RETURN TRANSACTIONS NOT MARKED WITH       *00270000
002800*              OMNI-CHNL-FFLMT-TYP-CDE AS 'SFS'.                 *00280000
002900*              BOPUS (BPS) TRANSACTIONS WILL ALSO BE PROCESSED   *00290000
003000*              AS LIKE SFS TRANSACTIONS. I.E., E-BUS-IND SET TO  *00300000
003100*              'Y', STORE 873 TO SETTLE STORE NUMBER, ORDER NUM  *00310000
003200*              MOVED TO TC005-ECOMM-ORD-NBR.                     *00320000
003300*              INCLUDED STATEMENT IN 1850-CHECK-ECOMMERCE-STORE  *00330000
003400*              PARA TO PERFORM SELECT FROM TEPCRR TO GET AUTH    *00340000
003500*              REFERENCE NUMBER TO TC005-AUTH-REF-NBR FOR ALL    *00350000
003600*              ECOMM TRANSACTIONS INCLUDING SFS AND BOPUS AND TO *00360000
003700*              PASS AUTH REF NUMBER TO SBS.                      *00370000
003800*              REMOVED 2900-SELECT-TEPCRR PERFORM IN             *00380000
003900*              2500-CHECK-IF-EXPIRED PARA.                       *00390000
004000*----------------------------------------------------------------*00400000
004100* DATE:        01/29/2015                                        *00410000
004200* WR/IR#:      CHG0103486                                        *00420000
004300* PROGRAMMER:  COGNIZANT                                         *00430000
004400* DESCRIPTION: FIX FOR SALES CORRECTION SEQUENCE NUMBER ISSUE    *00440000
004500*              IN TEPCRR TABLE.                                  *00450000
004000*----------------------------------------------------------------*00460000
004100* DATE:        03/35/2015                                        *00470000
004200* WR/IR#:      CHG0108147                                        *00480000
004300* PROGRAMMER:  COGNIZANT                                         *00490000
004400* DESCRIPTION: FIX FOR SALES CORRECTION SEQUENCE NUMBER AND      *00500000
004500*              TENDER SEQUENCE NUMBER MISMATCH ISSUE IN TEPCRR   *00510000
004500*              TABLE.                                            *00520000
004600*----------------------------------------------------------------*00530000
SHIP  * DATE:        03/20/2019                                        *00531000
SHIP  * WR/IR#:      CHG0220426                                        *00532000
SHIP  * PROGRAMMER:  BARB SCHULTZ                                      *00533000
SHIP  * DESCRIPTION: MOVED 3 NEW FIELDS FROM TCRD004 TO TCRD005.       *00534000
SHIP  *              PLUS ADDED THE FULFILLMENT TYPE ON TO TCRD005.    *00535000
SHIP  *              THIS WAS DONE FOR THE SETTLE BY SHIP PROJECT.     *00536000
SHIP  *----------------------------------------------------------------*00537000
SHIP2 * DATE:        01/20/2020                                        *00538000
SHIP2 * WR/IR#:      CHG0233046                                        *00539000
SHIP2 * PROGRAMMER:  BARB SCHULTZ                                      *00539100
SHIP2 * DESCRIPTION: DELETED THE MC FIELDS TO USE THE VISA FIELDS.     *00539200
SHIP2 *              BOTH VISA AND MC ARE GOING TO BE USING THE SAME   *00539300
SHIP2 *              MULT CLEAR FIELDS FROM THE DATABASE. ADDED        *00539400
SHIP2 *              TC005-PAR-SHIP-IND TO KEEP A TRACK OF THE         *00539500
SHIP2 *              PARTIAL SHIPMENTS.                                *00539600
SHIP2 *----------------------------------------------------------------*00539700
052523*  CHANGE MADE: ADD CHANGES FOR NEW COBRAND TENDER TYPE           00539900
052523*               ADD CHANGES FOR NEW COBRAND PAYMENTS              00540000
052523*  DATE: 05/25/2023                                               00540100
052523*  MADE BY: DAN PAYNTER              WR/IR #: CHG0289014          00540201
052523*----------------------------------------------------------------*00540300
004700                                                                  00541000
004800 ENVIRONMENT DIVISION.                                            00550000
004900                                                                  00560000
005000                                                                  00570000
005100 CONFIGURATION SECTION.                                           00580000
005200                                                                  00590000
005300 SOURCE-COMPUTER.    IBM-3090.                                    00600000
005400 OBJECT-COMPUTER.    IBM-3090.                                    00610000
005500                                                                  00620000
005600                                                                  00630000
005700 INPUT-OUTPUT SECTION.                                            00640000
005800                                                                  00650000
005900 FILE-CONTROL.                                                    00660000
006000                                                                  00670000
006100     SELECT COSA-EXTRACT-FILE          ASSIGN TO INP01.           00680000
006200     SELECT BANK-SETTLEMENT-FILE       ASSIGN TO OUT01.           00690000
006300     SELECT AJB-REAUTH-FILE            ASSIGN TO OUT02.           00700000
006400     EJECT                                                        00710000
006500                                                                  00720000
006600 DATA DIVISION.                                                   00730000
006700                                                                  00740000
006800 FILE SECTION.                                                    00750000
006900                                                                  00760000
007000 FD  COSA-EXTRACT-FILE                                            00770000
007100     RECORDING MODE IS F                                          00780000
007200     BLOCK CONTAINS 0 RECORDS                                     00790000
007300     LABEL RECORDS ARE STANDARD.                                  00800000
007400                                                                  00810000
007500 01  COSA-EXTRACT-RECORD              PIC X(191).                 00820000
007600                                                                  00830000
007700                                                                  00840000
007800 FD  BANK-SETTLEMENT-FILE                                         00850000
007900     RECORDING MODE IS F                                          00860000
008000     BLOCK CONTAINS 0 RECORDS                                     00870000
008100     LABEL RECORDS ARE STANDARD.                                  00880000
008200 01  BANK-SETTLEMENT-RECORD           PIC X(298).                 00890000
008300                                                                  00900000
008400                                                                  00910000
008500 FD  AJB-REAUTH-FILE                                              00920000
008600     RECORDING MODE IS F                                          00930000
008700     BLOCK CONTAINS 0                                             00940000
008800     LABEL RECORDS ARE STANDARD.                                  00950000
008900                                                                  00960000
009000 01  AJB-REAUTH-RECORD                PIC X(298).                 00970000
009100                                                                  00980000
009200 WORKING-STORAGE SECTION.                                         00990000
009300                                                                  01000000
009400 01  FILLER                           PIC X(32)  VALUE            01010000
009500     'TCKUT007 WORKING STORAGE BEGINS:'.                          01020000
009600                                                                  01030000
009700******************************************************************01040000
009800 01  PC-PROGRAM-CONSTANTS.                                        01050000
009900                                                                  01060000
010000     05  PC-PROGRAM-NUMBER            PIC X(08)      VALUE        01070000
010100         'TCKUT007'.                                              01080000
010200     05  PC-AMEX-TRANS                PIC X(02)      VALUE '08'.  01090000
010300     05  PC-RETURN-TRANS              PIC X(02)      VALUE '11'.  01100000
010400     05  PC-ECOMMERCE-STORE           PIC X(01)      VALUE 'Y'.   01110000
010500     05  PC-EXP-AUTH-IND              PIC X(01)      VALUE 'E'.   01120000
010600     05  PC-YES-IND                   PIC X(01)      VALUE 'Y'.   01130000
010700     05  PC-NO-IND                    PIC X(01)      VALUE 'N'.   01140000
010800     05  PC-MOD-IND                   PIC X(01)      VALUE 'M'.   01150000
010900     05  PC-START-PGM-MSG             PIC X(06)      VALUE        01160000
011000         'START '.                                                01170000
011100     05  PC-NORMAL-EOJ-MSG            PIC X(13)      VALUE        01180000
011200         '- NORMAL EOJ '.                                         01190000
011300     05  PC-ABEND-MSG                 PIC X(12)      VALUE        01200000
011400         '** ABEND ** '.                                          01210000
011500     05  PC-DB-ERROR-PREFIX           PIC X(09)      VALUE        01220000
011600         'DB2 ERROR'.                                             01230000
011700     05  PC-DB-ATTEMPTING-MSG         PIC X(14)      VALUE        01240000
011800         'ATTEMPTING TO '.                                        01250000
011900                                                                  01260000
012000 01  PS-PROCESS-SWITCHES.                                         01270000
012100     05  PS-END-OF-COSA-FILE-SW        PIC X(01) VALUE 'N'.       01280000
012200         88  PS-END-OF-COSA-FILE                 VALUE 'Y'.       01290000
012300         88  PS-NOT-END-OF-COSA-FILE             VALUE 'N'.       01300000
012400     05  PS-WRITE-FILE-SW              PIC X(01).                 01310000
012500         88  PS-WRITE-AJB-FILE                   VALUE 'Y'.       01320000
012600         88  PS-WRITE-BANK-SETTLE-FILE           VALUE 'N'.       01330000
012700*    05  PS-DROP-AMEX-TRANS-SW         PIC X(01) VALUE 'N'.       01340000
012800*        88  PS-DROP-AMEX-TRANS                  VALUE 'Y'.       01350000
012900*        88  PS-NOT-AMEX-TRANS                   VALUE 'N'.       01360000
013000     05  PS-RETURN-INFO-SW             PIC X(01) VALUE 'N'.       01370000
013100         88  PS-RETURN-INFO                      VALUE 'Y'.       01380000
013200         88  PS-NO-RETURN-INFO                   VALUE 'N'.       01390000
013300     05  PS-TEPCRR-FOUND-SW            PIC X(01) VALUE 'N'.       01400000
013400         88  PS-TEPCRR-FOUND                     VALUE 'Y'.       01410000
013500         88  PS-TEPCRR-NOT-FOUND                 VALUE 'N'.       01420000
013600                                                                  01430000
013700 01  PV-PROGRAM-VARIABLES.                                        01440000
013800     05  PV-SAVE-E-BUS-LOC-IND       PIC X(01)    VALUE SPACE.    01450000
013900     05  PV-STORE-NBR                PIC S9(04)   COMP.           01460000
014000     05  PV-READ-CNT                 PIC 9(07)    VALUE ZEROES.   01470000
014100     05  PV-WRITE-AJB                PIC 9(07)    VALUE ZEROES.   01480000
014200     05  PV-WRITE-BANK               PIC 9(07)    VALUE ZEROES.   01490000
014300*    05  PV-DROP-AMEX                PIC 9(07)    VALUE ZEROES.   01500000
014400     05  PV-DISPLAY-CNT              PIC Z,ZZZ,ZZ9.               01510000
014500     05  PV-PARAGRAPH-NAME           PIC X(30)      VALUE SPACES. 01520000
014600     05  PV-DB2-ERROR-MSG            PIC X(40)      VALUE SPACES. 01530000
014700     05  PV-MOD-IND                  PIC X(01)      VALUE SPACE.  01540000
014800     05  PV-SYS-TRC-AUD-NBR          PIC 9(06)      VALUE ZEROES. 01550000
014900     05  PV-CRD-LVL-RSLT-CDE.                                     01560000
015000         10  PV-CRD-LVL-RSLT-CDE-1   PIC X(01)      VALUE SPACES. 01570000
015100         10  PV-CRD-LVL-RSLT-CDE-2   PIC X(01)      VALUE SPACES. 01580000
015200     05  PV-ORIGINAL-STR-NBR         PIC S9(04)     COMP.         01590000
015300     05  PV-ORIG-PARTN-NBR           PIC S9(04)     COMP.         01600000
015400     05  PV-ORIG-STR-NBR             PIC S9(04)     COMP.         01610000
015500     05  PV-ORIG-RGST-ID             PIC S9(04)     COMP.         01620000
015600     05  PV-ORIG-TRN-NBR             PIC S9(04)     COMP.         01630000
015700     05  PV-ORIG-STRT-TM             PIC X(8).                    01640000
015800     05  PV-ORIG-SLS-DTE             PIC X(10).                   01650000
015900     05  PV-OMNI-CHNL-FFLMT-TYP-CDE  PIC X(03).                   01660000
016000     05  PV-HOLD-FIELD               PIC 9(01).                   01670000
SHIP       05  PV-FULFILLMENT-TYPE         PIC X(01)    VALUE SPACES.   01680000
SHIP           88  PV-OMNI-BPS-BOS                       VALUE 'O'.     01682000
SHIP           88  PV-SHIP-TO-HOME                       VALUE 'S'.     01682100
016100                                                                  01683000
016200                                                                  01690000
016300 01  ABEND-CODE  COMP                 PIC S9(04)    VALUE ZEROS.  01700000
016400     88  ABEND-4013-DB2-ERROR                       VALUE +4013.  01710000
016500*----------------------------------------------------------------*01720000
016600*  DATE VALIDATION CALLING PARAMETER LIST                        *01730000
016700*----------------------------------------------------------------*01740000
016800     COPY DPWS500.                                                01750000
016900*----------------------------------------------------------------*01760000
017000*    STANDARD FILE LAYOUT FOR THE COSA SETTLEMENT FILE           *01770000
017100*----------------------------------------------------------------*01780000
017200     COPY TCRD004.                                                01790000
017300*----------------------------------------------------------------*01800000
017400*    STANDARD FILE LAYOUT FOR THE AJB SETTLEMENT FILE            *01810000
017500*----------------------------------------------------------------*01820000
017600     COPY TCRD005.                                                01830000
017700*----------------------------------------------------------------*01840000
017800*    STANDARD DB2 ERROR HANDLING AREA                            *01850000
017900*----------------------------------------------------------------*01860000
018000     COPY DPWS004.                                                01870000
018100*----------------------------------------------------------------*01880000
018200*    LOCATION DOMAIN TABLE                                       *01890000
018300*----------------------------------------------------------------*01900000
018400     EXEC SQL                                                     01910000
018500         INCLUDE XST00001                                         01920000
018600     END-EXEC.                                                    01930000
018700*----------------------------------------------------------------*01940000
018800*    PARTITION TABLE TEPPART                                     *01950000
018900*----------------------------------------------------------------*01960000
019000     EXEC SQL                                                     01970000
019100         INCLUDE TEPPART                                          01980000
019200     END-EXEC.                                                    01990000
019300*----------------------------------------------------------------*02000000
019400*    ORDER TABLE TEPORD                                          *02010000
019500*----------------------------------------------------------------*02020000
019600     EXEC SQL                                                     02030000
019700         INCLUDE TEPORD                                           02040000
019800     END-EXEC.                                                    02050000
019900*----------------------------------------------------------------*02060000
020000*    ITEM RETURN TABLE TEPIRT                                    *02070000
020100*----------------------------------------------------------------*02080000
020200     EXEC SQL                                                     02090000
020300         INCLUDE TEPIRT                                           02100000
020400     END-EXEC.                                                    02110000
020500*----------------------------------------------------------------*02120000
020600*    TABLE TEPCRR                                                *02130000
020700*----------------------------------------------------------------*02140000
020800     EXEC SQL                                                     02150000
020900         INCLUDE TEPCRR                                           02160000
021000     END-EXEC.                                                    02170000
021100*----------------------------------------------------------------*02180000
021200*    STANDARD DB2 COMMUNICATIONS AREA                            *02190000
021300*----------------------------------------------------------------*02200000
021400     EXEC SQL                                                     02210000
021500         INCLUDE SQLCA                                            02220000
021600     END-EXEC.                                                    02230000
021700*----------------------------------------------------------------*02240000
021800*----------------------------------------------------------------*02250000
021900*    CURSOR TO OBTAIN ORIGINAL STORE AND TRANS INFO              *02260000
022000*----------------------------------------------------------------*02270000
022100     EXEC SQL                                                     02280000
022200         DECLARE ORIG-INFO-CSR CURSOR                             02290000
022300         FOR SELECT ORIG_SLS_DTE                                  02300000
022400                   ,ORIG_STR_NBR                                  02310000
022500                   ,ORIG_RGST_ID                                  02320000
022600                   ,ORIG_TRN_NBR                                  02330000
022700                   ,ORIG_STRT_TM                                  02340000
022800          FROM  TEPIRT   A                                        02350000
022900               ,XST_LOC  B                                        02360000
023000          WHERE ((A.PARTN_NBR        = :TC004-PARTN-NBR)          02370000
023100            AND (A.STR_NBR           = :TC004-STR-NBR)            02380000
023200            AND (A.RGST_ID           = :TC004-RGST-ID)            02390000
023300            AND (A.TRN_NBR           = :TC004-TRN-NBR)            02400000
023400            AND (A.STRT_TM           = :TC004-STRT-TM)            02410000
023500            AND (A.SLS_CORR_SEQ_NBR  = :TC004-SLS-CORR-SEQ-NBR)   02420000
023600            AND (A.ORIG_STR_NBR      = B.LOC_NBR))                02430000
023700          WITH UR                                                 02440000
023800     END-EXEC.                                                    02450000
023900                                                                  02460000
024000****************************************************************  02470000
024100 PROCEDURE DIVISION.                                              02480000
024200****************************************************************  02490000
024300* 0000-PROGRAM-MAINLINE - CONTROLS THE MAIN PROCESSING OF THE  *  02500000
024400* PROGRAM.                                                     *  02510000
024500****************************************************************  02520000
024600                                                                  02530000
024700 0000-PROGRAM-MAINLINE.                                           02540000
024800                                                                  02550000
024900     PERFORM 1000-INITIALIZATION.                                 02560000
025000                                                                  02570000
025100     PERFORM 1600-PROCESS-FILE                                    02580000
025200        UNTIL PS-END-OF-COSA-FILE.                                02590000
025300                                                                  02600000
025400     PERFORM 9999-END-ROUTINE.                                    02610000
025500                                                                  02620000
025600     GOBACK.                                                      02630000
025700                                                                  02640000
025800     EJECT                                                        02650000
025900****************************************************************  02660000
026000* 1000-INITIALIZATION OPENS ALL FILES                          *  02670000
026100*      READS THE FIRST COSA RECORD                             *  02680000
026200****************************************************************  02690000
026300 1000-INITIALIZATION.                                             02700000
026400                                                                  02710000
026500     DISPLAY PC-START-PGM-MSG   PC-PROGRAM-NUMBER.                02720000
026600                                                                  02730000
026700     OPEN INPUT  COSA-EXTRACT-FILE                                02740000
026800          OUTPUT BANK-SETTLEMENT-FILE                             02750000
026900                 AJB-REAUTH-FILE.                                 02760000
027000                                                                  02770000
027100     MOVE SPACES                 TO  PS-WRITE-FILE-SW.            02780000
027200                                                                  02790000
027300     PERFORM 1500-READ-INPUT-FILE.                                02800000
027400                                                                  02810000
027500                                                                  02820000
027600****************************************************************  02830000
027700* 1500-READ COSA EXTRACT INPUT FILE                            *  02840000
027800****************************************************************  02850000
027900 1500-READ-INPUT-FILE.                                            02860000
028000                                                                  02870000
028100     INITIALIZE TC004-EXTRACT-RECORD.                             02880000
028200     INITIALIZE TC005-EXTRACT-RECORD.                             02890000
028300                                                                  02900000
028400     READ COSA-EXTRACT-FILE                                       02910000
028500         INTO TC004-EXTRACT-RECORD                                02920000
028600         AT END                                                   02930000
028700             SET PS-END-OF-COSA-FILE TO TRUE                      02940000
028800     END-READ.                                                    02950000
028900                                                                  02960000
029000                                                                  02970000
029100****************************************************************  02980000
029200* 1600-PROCESS-FILE                                            *  02990000
029300****************************************************************  03000000
029400 1600-PROCESS-FILE.                                               03010000
029500                                                                  03020000
029600     MOVE TC004-PARTN-NBR        TO TC005-PARTN-NBR.              03030000
029700     MOVE TC004-STR-NBR          TO TC005-STR-NBR.                03040000
029800     MOVE TC004-RGST-ID          TO TC005-RGST-ID.                03050000
029900     MOVE TC004-TRN-NBR          TO TC005-TRN-NBR.                03060000
030000     MOVE TC004-STRT-TM          TO TC005-STRT-TM.                03070000
030100     MOVE TC004-SLS-CORR-SEQ-NBR TO TC005-SLS-CORR-SEQ-NBR.       03080000
030200     MOVE TC004-TRN-TYP-CDE      TO TC005-TRN-TYP-CDE.            03090000
030300     MOVE TC004-SLS-DTE          TO TC005-SLS-DTE.                03100000
030400     MOVE TC004-TRN-DTE          TO TC005-TRN-DTE.                03110000
030500     MOVE TC004-TNDR-SEQ-NBR     TO TC005-TNDR-SEQ-NBR.           03120000
030600     MOVE TC004-TNDR-TYP-CDE     TO TC005-TNDR-TYP-CDE.           03130000
030700     MOVE TC004-TNDR-ID          TO TC005-TNDR-ID.                03140000
030800     MOVE TC004-TNDR-AMT         TO TC005-TNDR-AMT.               03150000
030900     MOVE TC004-TNDR-ID-SRC-CDE  TO TC005-TNDR-ID-SRC-CDE.        03160000
031000     MOVE TC004-AUTH-NBR         TO TC005-AUTH-NBR.               03170000
031100     MOVE TC004-AUTH-SRC-CDE     TO TC005-AUTH-SRC-CDE.           03180000
031200     MOVE TC004-CPS-TRN-ID       TO TC005-CPS-TRN-ID.             03190000
031300     MOVE TC004-MC-CMPLIN-CDE    TO TC005-MC-CMPLIN-CDE.          03200000
031400     MOVE TC004-VIP-SRC-CDE      TO TC005-VIP-SRC-CDE.            03210000
031500     MOVE TC004-VIP-RSPN-CDE     TO TC005-VIP-RSPN-CDE.           03220000
031600     MOVE TC004-BNKNET-NBR       TO TC005-BNKNET-NBR.             03230000
                                                                        03230100
SHIP       MOVE TC004-VISA-MULT-CLR-SEQ-NBR TO                          03231000
SHIP            TC005-VISA-MULT-CLR-SEQ-NBR.                            03232000
SHIP       MOVE TC004-VISA-TOT-SHP-NBR TO TC005-VISA-TOT-SHP-NBR.       03233000
SHIP  * SET A SWITCH TO INDICATE OMNI TYPE ORDERS                       03234000
SHIP       IF TC004-OMNI-CHNL-FFLMT-TYP-CDE = SPACES OR                 03234100
SHIP          TC004-OMNI-CHNL-FFLMT-TYP-CDE = 'SFS' OR                  03235000
SHIP          TC004-OMNI-CHNL-FFLMT-TYP-CDE = 'SDD'                     03236000
SHIP             SET PV-SHIP-TO-HOME TO TRUE                            03237000
SHIP       ELSE                                                         03238000
SHIP             SET PV-OMNI-BPS-BOS TO TRUE                            03239000
SHIP       END-IF.                                                      03239100
SHIP       MOVE PV-FULFILLMENT-TYPE    TO TC005-FULFILLMENT-TYPE.       03239300
052523     MOVE TC004-TRLING-TRN-IND   TO TC005-TRLING-TRN-IND.         03239400
052523     MOVE TC004-COBRAND-PYMT-IND TO TC005-COBRAND-PYMT-IND.       03239500
                                                                        03239800
031700     MOVE TC004-AVS-RSPN-CDE     TO TC005-AVS-RSPN-CDE.           03240000
031800     MOVE TC004-SLS-TX-AMT       TO TC005-SLS-TX-AMT.             03250000
SHIP2      MOVE SPACES                 TO TC005-PAR-SHIP-IND.           03262000
032000     MOVE SPACES                 TO PV-CRD-LVL-RSLT-CDE.          03270000
032100     MOVE TC004-CRD-LVL-RSLT-CDE TO PV-CRD-LVL-RSLT-CDE.          03280000
032200     IF PV-CRD-LVL-RSLT-CDE-1 = SPACES AND                        03290000
032300        PV-CRD-LVL-RSLT-CDE-2 NOT = SPACES                        03300000
032400       MOVE PV-CRD-LVL-RSLT-CDE-2 TO PV-CRD-LVL-RSLT-CDE-1        03310000
032500       MOVE SPACES                TO PV-CRD-LVL-RSLT-CDE-2        03320000
032600       MOVE PV-CRD-LVL-RSLT-CDE  TO TC005-CRD-LVL-RSLT-CDE        03330000
032700     ELSE                                                         03340000
032800       MOVE PV-CRD-LVL-RSLT-CDE  TO TC005-CRD-LVL-RSLT-CDE        03350000
032900     END-IF.                                                      03360000
033000                                                                  03370000
033100     MOVE TC004-CVV-RSPN-CDE     TO TC005-CVV-RSPN-CDE.           03380000
033200                                                                  03390000
033300     ADD  1                      TO  PV-READ-CNT.                 03400000
033400                                                                  03410000
033500*    IF TC004-STR-NBR = PV-STORE-NBR                              03420000
033600*       PERFORM 1850-CHECK-ECOMMERCE-STORE                        03430000
033700*    ELSE                                                         03440000
033800     MOVE TC004-STR-NBR TO PV-STORE-NBR.                          03450000
033900     PERFORM 1800-SELECT-XST00001.                                03460000
034000     MOVE XST00001-E-BUS-IND TO PV-SAVE-E-BUS-LOC-IND.            03470000
034100     PERFORM 1850-CHECK-ECOMMERCE-STORE.                          03480000
034200*    END-IF.                                                      03490000
034300     MOVE PV-SAVE-E-BUS-LOC-IND  TO TC005-E-BUS-IND.              03500000
034400     MOVE TC004-NETWK-REF-ID     TO TC005-NETWK-REF-ID.           03510000
034500     MOVE TC004-TRSM-TMST        TO TC005-TRSM-TMST.              03520000
034600     MOVE TC004-SYS-TRC-AUD-NBR  TO PV-SYS-TRC-AUD-NBR.           03530000
034700     MOVE PV-SYS-TRC-AUD-NBR     TO TC005-SYS-TRC-AUD-NBR.        03540000
034800     MOVE TC004-TRK-DAT-CND-CDE  TO TC005-TRK-DAT-CND-CDE.        03550000
034900     MOVE TC004-OMNI-CHNL-FFLMT-TYP-CDE  TO                       03560000
035000                              TC005-OMNI-CHNL-FFLMT-TYP-CDE.      03570000
035100     IF PS-WRITE-AJB-FILE                                         03580000
035200        PERFORM 8500-WRITE-AJB-REAUTH-FILE                        03590000
035300     ELSE                                                         03600000
035400        PERFORM 8400-WRITE-BANK-SETTLE-FILE                       03610000
035500     END-IF.                                                      03620000
035600                                                                  03630000
035700     MOVE SPACES                 TO  PS-WRITE-FILE-SW.            03640000
035800                                                                  03650000
035900     PERFORM 1500-READ-INPUT-FILE.                                03660000
036000                                                                  03670000
036100******************************************************************03680000
036200*    SELECT XST00001 TO CHECK TO SEE IF ECOMMERCE STORE          *03690000
036300******************************************************************03700000
036400 1800-SELECT-XST00001.                                            03710000
036500                                                                  03720000
036600     EXEC SQL                                                     03730000
036700          SELECT E_BUS_IND                                        03740000
036800          INTO   :XST00001-E-BUS-IND                              03750000
036900          FROM   XST_LOC                                          03760000
037000          WHERE  LOC_NBR = :PV-STORE-NBR                          03770000
037100           WITH UR                                                03780000
037200     END-EXEC.                                                    03790000
037300                                                                  03800000
037400     EVALUATE TRUE                                                03810000
037500         WHEN SQLWARN0 NOT EQUAL SPACE                            03820000
037600         WHEN SQLCODE NOT EQUAL ZERO                              03830000
037700             MOVE '1800-SELECT-XST00001'                          03840000
037800                                            TO PV-PARAGRAPH-NAME  03850000
037900             MOVE 'TO SELECT FROM XST00001 '                      03860000
038000                                            TO PV-DB2-ERROR-MSG   03870000
038100             DISPLAY 'STORE # :  ' TC004-STR-NBR                  03880000
038200             PERFORM 9300-DB2-ERROR                               03890000
038300     END-EVALUATE.                                                03900000
038400                                                                  03910000
038500******************************************************************03920000
038600*    CHECK IF ECOMMERCE STORE                                    *03930000
038700*    IF IT IS AN ECOMMERCE STORE THEN WE NEED TO SPACE OUT THE   *03940000
038800*       AVS, CVV AND CRD LVL RESULTS CODE UNTIL ECOMMERCE HAS    *03950000
038900*       FIXED THE PROBLEM - DONE IN 2009                         *03960000
039000*    IN 2013 WE DID NOT SPACE OUT THE CRD LVL RESULTS CODE       *03970000
039100*       AND WE PASSED THE AMEX DATA                              *03980000
039200******************************************************************03990000
039300 1850-CHECK-ECOMMERCE-STORE.                                      04000000
039400                                                                  04010000
039500     IF PV-SAVE-E-BUS-LOC-IND = PC-ECOMMERCE-STORE OR             04020000
039600        TC004-OMNI-CHNL-FFLMT-TYP-CDE NOT EQUAL SPACES            04030000
039700        MOVE '873' TO TC005-SETTLE-STORE-NBR                      04040000
039800        MOVE 'Y' TO PV-SAVE-E-BUS-LOC-IND                         04050000
039900        PERFORM 1900-SELECT-TEPORD                                04060000
040000        IF SQLCODE = 0                                            04070000
040100          SET PS-TEPCRR-NOT-FOUND TO TRUE                         04080000
040200          PERFORM 2900-SELECT-TEPCRR                              04090000
040300          IF PS-TEPCRR-NOT-FOUND                                  04100000
040400              PERFORM 2910-SELECT-TEPCRR-WO-TNDR-SEQ              04110000
040500              IF PS-TEPCRR-NOT-FOUND                              04120000
040600                  MOVE SPACES TO TC005-AUTH-REF-NBR               04130000
040700              END-IF                                              04140000
040800          END-IF                                                  04150000
040900          PERFORM 2500-CHECK-IF-EXPIRED                           04160000
041000        END-IF                                                    04170000
041100        SET PS-WRITE-BANK-SETTLE-FILE TO TRUE                     04180000
041200        MOVE SPACES TO TC005-AVS-RSPN-CDE                         04190000
041300                       TC005-CVV-RSPN-CDE                         04200000
041400     ELSE                                                         04210000
041500        MOVE TC004-STR-NBR TO TC005-SETTLE-STORE-NBR              04220000
041600        SET PS-WRITE-BANK-SETTLE-FILE TO TRUE                     04230000
041700        MOVE 'N' TO PV-SAVE-E-BUS-LOC-IND                         04240000
041800     END-IF.                                                      04250000
041900                                                                  04260000
042000                                                                  04270000
042100******************************************************************04280000
042200*    SELECT-TEPORD.                                              *04290000
042300******************************************************************04300000
042400 1900-SELECT-TEPORD.                                              04310000
042500                                                                  04320000
042600     EXEC SQL                                                     04330000
042700          SELECT ORD_MOD_IND                                      04340000
042800                ,ORD_NBR                                          04350000
042900          INTO  :EPORD-ORD-MOD-IND                                04360000
043000               ,:EPORD-ORD-NBR                                    04370000
043100          FROM  TEPORD                                            04380000
043200          WHERE ((PARTN_NBR   = :TC004-PARTN-NBR)                 04390000
043300            AND  (STR_NBR     = :TC004-STR-NBR)                   04400000
043400            AND  (RGST_ID     = :TC004-RGST-ID)                   04410000
043500            AND  (TRN_NBR     = :TC004-TRN-NBR)                   04420000
043600            AND  (STRT_TM     = :TC004-STRT-TM)                   04430000
043700            AND  (SLS_CORR_SEQ_NBR  = :TC004-SLS-CORR-SEQ-NBR))   04440000
043800             WITH UR                                              04450000
043900     END-EXEC.                                                    04460000
044000                                                                  04470000
044100     EVALUATE TRUE                                                04480000
044200         WHEN SQLCODE EQUAL ZERO                                  04490000
044300             MOVE EPORD-ORD-NBR-TEXT (1:EPORD-ORD-NBR-LEN) TO     04500000
044400                                 TC005-ECOMM-ORD-NBR              04510000
044500             MOVE EPORD-ORD-MOD-IND TO PV-MOD-IND                 04520000
044600         WHEN SQLCODE EQUAL +100                                  04530000
044700             MOVE SPACES TO TC005-ECOMM-ORD-NBR                   04540000
044800             MOVE PC-NO-IND TO PV-MOD-IND                         04550000
044900         WHEN OTHER                                               04560000
045000             MOVE '1900-SELECT-TEPORD'                            04570000
045100                                            TO PV-PARAGRAPH-NAME  04580000
045200             MOVE 'SELECT FROM TEPORD  '                          04590000
045300                                            TO PV-DB2-ERROR-MSG   04600000
045400             DISPLAY 'PARTITION NBR     : ' TC004-PARTN-NBR       04610000
045500             DISPLAY 'STORE NUMBER      : ' TC004-STR-NBR         04620000
045600             DISPLAY 'REGISTER ID       : ' TC004-RGST-ID         04630000
045700             DISPLAY 'TRANSACTION NUMBER: ' TC004-TRN-NBR         04640000
045800             DISPLAY 'START TIME        : ' TC004-STRT-TM         04650000
045900             DISPLAY 'SALES CORR SEQ NBR: ' TC004-SLS-CORR-SEQ-NBR04660000
046000             PERFORM 9300-DB2-ERROR                               04670000
046100     END-EVALUATE.                                                04680000
046200                                                                  04690000
046300******************************************************************04700000
046400*    CHECK IF THE AUTHORIZATION HAS EXPIRED.                     *04710000
046500******************************************************************04720000
046600 2500-CHECK-IF-EXPIRED.                                           04730000
046700                                                                  04740000
046800     INITIALIZE DPG51                                             04750000
046900                DPG52                                             04760000
047000                DPG53                                             04770000
047100                DPG54                                             04780000
047200                DPG55                                             04790000
047300                DPG56.                                            04800000
047400                                                                  04810000
047500     SET DPG51-ACTUAL-CALENDAR-ONLY TO TRUE.                      04820000
047600     SET DPG51-DO-NOT-INCR-DECR-DATE TO TRUE .                    04830000
047700                                                                  04840000
047800     MOVE TC004-TRN-DTE              TO DPG52-LK-DATE-INPUT.      04850000
047900     SET DPG52-LK-DTE-ISO-FMT        TO TRUE.                     04860000
048000                                                                  04870000
048100     MOVE TC004-SLS-DTE              TO DPG53-LK-CMPR-DATE-INPUT. 04880000
048200     SET DPG53-LK-CMPR-DTE-ISO-FMT   TO TRUE.                     04890000
048300                                                                  04900000
048400     CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51                04910000
048500                                             DPG52                04920000
048600                                             DPG53                04930000
048700                                             DPG54                04940000
048800                                             DPG55                04950000
048900                                             DPG56.               04960000
049000                                                                  04970000
049100     EVALUATE TRUE                                                04980000
049200         WHEN DPG54-NO-ERROR                                      04990000
049300             IF DPG55-DAYS-DIFFERENCE > 7                         05000000
049400                 MOVE PC-EXP-AUTH-IND TO TC005-ECOMM-REAUTH-IND   05010000
049500                 SET PS-WRITE-AJB-FILE TO TRUE                    05020000
049600             ELSE                                                 05030000
049700                 IF PV-MOD-IND = PC-YES-IND                       05040000
049800                   MOVE PC-MOD-IND TO TC005-ECOMM-REAUTH-IND      05050000
049900                   SET PS-WRITE-AJB-FILE TO TRUE                  05060000
050000                 ELSE                                             05070000
050100                   SET PS-WRITE-BANK-SETTLE-FILE TO TRUE          05080000
050200                 END-IF                                           05090000
050300             END-IF                                               05100000
050400                                                                  05110000
050500         WHEN DPG54-DATE-INVALID                                  05120000
050600             DISPLAY '** ABEND **'                                05130000
050700             DISPLAY '** PROGRAM = TCKUT007 -- CALLED MODULE '    05140000
050800                     'DPKUT500 **'                                05150000
050900             DISPLAY '** PARAGRAPH = 2775-CHECK-IF-EXPIRED **'    05160000
051000             DISPLAY '** INVALID TRANS DATE: '                    05170000
051100                                         TC004-TRN-DTE            05180000
051200             DISPLAY '** ERROR MESSAGE FROM CALLED MODULE:   '    05190000
051300             DISPLAY DPG54-ERROR-MESSAGE                          05200000
051400             MOVE +4003 TO ABEND-CODE                             05210000
051500             CALL 'ILBOABN0' USING ABEND-CODE                     05220000
051600                                                                  05230000
051700         WHEN DPG54-CMPR-DATE-INVALID                             05240000
051800             DISPLAY '** ABEND **'                                05250000
051900             DISPLAY '** PROGRAM = TCKUT007 -- CALLED MODULE '    05260000
052000                     'DPKUT500 **'                                05270000
052100             DISPLAY '** PARAGRAPH = 2500-CHECK-IF-EXPIRED **'    05280000
052200             DISPLAY '** INVALID SALES DATE: '                    05290000
052300                                         TC004-SLS-DTE            05300000
052400             DISPLAY '** ERROR MESSAGE FROM CALLED MODULE:   '    05310000
052500             DISPLAY DPG54-ERROR-MESSAGE                          05320000
052600             MOVE +4003 TO ABEND-CODE                             05330000
052700             CALL 'ILBOABN0' USING ABEND-CODE                     05340000
052800                                                                  05350000
052900         WHEN OTHER                                               05360000
053000             DISPLAY '** ABEND **'                                05370000
053100             DISPLAY '** PROGRAM = TCKUT007 -- CALLED MODULE '    05380000
053200                     'DPKUT500 **'                                05390000
053300             DISPLAY '** PARAGRAPH = 2500-CHECK-IF-EXPIRED **'    05400000
053400             DISPLAY DPG54-ERROR-MESSAGE                          05410000
053500             MOVE +4003 TO ABEND-CODE                             05420000
053600             CALL 'ILBOABN0' USING ABEND-CODE                     05430000
053700                                                                  05440000
053800     END-EVALUATE.                                                05450000
053900                                                                  05460000
054000******************************************************************05470000
054100*    SELECT TEPCRR FOR AUTH REF NBR                              *05480000
054200******************************************************************05490000
054300 2900-SELECT-TEPCRR.                                              05500000
054400                                                                  05510000
054500     EXEC SQL                                                     05520000
054600          SELECT AUTH_REF_NBR                                     05530000
054700          INTO :EPCRR-AUTH-REF-NBR                                05540000
054800          FROM  TEPCRR A                                          05550000
054900          WHERE A.PARTN_NBR        = :TC004-PARTN-NBR             05560000
055000            AND  A.STR_NBR          = :TC004-STR-NBR              05570000
055100            AND  A.RGST_ID          = :TC004-RGST-ID              05580000
055200            AND  A.TRN_NBR          = :TC004-TRN-NBR              05590000
055300            AND  A.STRT_TM          = :TC004-STRT-TM              05600000
055400            AND  A.TNDR_SEQ_NBR     = :TC004-TNDR-SEQ-NBR         05610000
055500            AND  A.SLS_CORR_SEQ_NBR =                             05620000
055600               (SELECT MAX(B.SLS_CORR_SEQ_NBR)                    05630000
055700                FROM TEPCRR B                                     05640000
055800                WHERE A.PARTN_NBR = B.PARTN_NBR                   05650000
055900                  AND A.STR_NBR   = B.STR_NBR                     05660000
056000                  AND A.RGST_ID   = B.RGST_ID                     05670000
056100                  AND A.TRN_NBR   = B.TRN_NBR                     05680000
056200                  AND A.STRT_TM   = B.STRT_TM                     05690000
056300                  AND A.TNDR_SEQ_NBR = B.TNDR_SEQ_NBR)            05700000
056400              WITH UR                                             05710000
056500     END-EXEC.                                                    05720000
056600                                                                  05730000
056700     EVALUATE TRUE                                                05740000
056800         WHEN SQLCODE = 0                                         05750000
056900           MOVE EPCRR-AUTH-REF-NBR-TEXT (1:EPCRR-AUTH-REF-NBR-LEN)05760000
057000                               TO TC005-AUTH-REF-NBR              05770000
057100           SET PS-TEPCRR-FOUND TO TRUE                            05780000
057200         WHEN SQLCODE = +100                                      05790000
057300             SET PS-TEPCRR-NOT-FOUND TO TRUE                      05800000
057400         WHEN SQLWARN0 NOT EQUAL SPACE                            05810000
057500         WHEN SQLCODE NOT EQUAL ZERO                              05820000
057600             MOVE '2900-SELECT-TEPCRR'                            05830000
057700                                            TO PV-PARAGRAPH-NAME  05840000
057800             MOVE 'TO SELECT FROM TEPCRR  '                       05850000
057900                                            TO PV-DB2-ERROR-MSG   05860000
058000             DISPLAY 'STORE NBR  :  '    TC004-STR-NBR            05870000
058100             DISPLAY 'REGISTER ID:  '    TC004-RGST-ID            05880000
058200             DISPLAY 'TRANS NBR  :  '    TC004-TRN-NBR            05890000
058300             DISPLAY 'START TIME :  '    TC004-STRT-TM            05900000
058400             PERFORM 9300-DB2-ERROR                               05910000
058500     END-EVALUATE.                                                05920000
058600                                                                  05930000
058700******************************************************************05940000
058800*    SELECT TEPCRR FOR AUTH REF NBR WO TNDR-SEQ-NBR              *05950000
058900******************************************************************05960000
059000 2910-SELECT-TEPCRR-WO-TNDR-SEQ.                                  05970000
059100                                                                  05980000
059200     EXEC SQL                                                     05990000
059300          SELECT AUTH_REF_NBR                                     06000000
059400          INTO :EPCRR-AUTH-REF-NBR                                06010000
059500          FROM  TEPCRR A                                          06020000
059600          WHERE A.PARTN_NBR        = :TC004-PARTN-NBR             06030000
059700            AND  A.STR_NBR          = :TC004-STR-NBR              06040000
059800            AND  A.RGST_ID          = :TC004-RGST-ID              06050000
059900            AND  A.TRN_NBR          = :TC004-TRN-NBR              06060000
060000            AND  A.STRT_TM          = :TC004-STRT-TM              06070000
060100            AND  A.TNDR_SEQ_NBR     =                             06080000
060200               (SELECT MAX(C.TNDR_SEQ_NBR)                        06090000
060300                FROM TEPCRR C                                     06100000
060400                WHERE A.PARTN_NBR = C.PARTN_NBR                   06110000
060500                  AND A.STR_NBR   = C.STR_NBR                     06120000
060600                  AND A.RGST_ID   = C.RGST_ID                     06130000
060700                  AND A.TRN_NBR   = C.TRN_NBR                     06140000
060800                  AND A.STRT_TM   = C.STRT_TM)                    06150000
060900            AND  A.SLS_CORR_SEQ_NBR =                             06160000
061000               (SELECT MAX(B.SLS_CORR_SEQ_NBR)                    06170000
061100                FROM TEPCRR B                                     06180000
061200                WHERE A.PARTN_NBR = B.PARTN_NBR                   06190000
061300                  AND A.STR_NBR   = B.STR_NBR                     06200000
061400                  AND A.RGST_ID   = B.RGST_ID                     06210000
061500                  AND A.TRN_NBR   = B.TRN_NBR                     06220000
061600                  AND A.STRT_TM   = B.STRT_TM                     06230000
061700                  AND A.TNDR_SEQ_NBR = B.TNDR_SEQ_NBR)            06240000
061800              WITH UR                                             06250000
061900     END-EXEC.                                                    06260000
062000                                                                  06270000
062100     EVALUATE TRUE                                                06280000
062200         WHEN SQLCODE = 0                                         06290000
062300           MOVE EPCRR-AUTH-REF-NBR-TEXT (1:EPCRR-AUTH-REF-NBR-LEN)06300000
062400                               TO TC005-AUTH-REF-NBR              06310000
062500           SET PS-TEPCRR-FOUND TO TRUE                            06320000
062600         WHEN SQLCODE = +100                                      06330000
062700             SET PS-TEPCRR-NOT-FOUND TO TRUE                      06340000
062800         WHEN SQLWARN0 NOT EQUAL SPACE                            06350000
062900         WHEN SQLCODE NOT EQUAL ZERO                              06360000
063000             MOVE '2910-SELECT-TEPCRR-WO-TNDR-SEQ'                06370000
063100                                            TO PV-PARAGRAPH-NAME  06380000
063200             MOVE 'TO SELECT FROM TEPCRR  '                       06390000
063300                                            TO PV-DB2-ERROR-MSG   06400000
063400             DISPLAY 'STORE NBR  :  '    TC004-STR-NBR            06410000
063500             DISPLAY 'REGISTER ID:  '    TC004-RGST-ID            06420000
063600             DISPLAY 'TRANS NBR  :  '    TC004-TRN-NBR            06430000
063700             DISPLAY 'START TIME :  '    TC004-STRT-TM            06440000
063800             PERFORM 9300-DB2-ERROR                               06450000
063900     END-EVALUATE.                                                06460000
064000                                                                  06470000
064100***************************************************************** 06480000
064200*    WRITE BANK SETTLEMENT FILE                                  *06490000
064300***************************************************************** 06500000
064400 8400-WRITE-BANK-SETTLE-FILE.                                     06510000
064500                                                                  06520000
064600     WRITE BANK-SETTLEMENT-RECORD FROM TC005-EXTRACT-RECORD.      06530000
064700                                                                  06540000
064800     ADD 1 TO PV-WRITE-BANK.                                      06550000
064900                                                                  06560000
065000***************************************************************** 06570000
065100*    WRITE AJB REAUTH FILE                                      * 06580000
065200***************************************************************** 06590000
065300 8500-WRITE-AJB-REAUTH-FILE.                                      06600000
065400                                                                  06610000
065500     WRITE AJB-REAUTH-RECORD FROM TC005-EXTRACT-RECORD.           06620000
065600                                                                  06630000
065700     ADD 1 TO PV-WRITE-AJB.                                       06640000
065800                                                                  06650000
065900***************************************************************** 06660000
066000*    DB2 ERROR ROUTINE                                          * 06670000
066100***************************************************************** 06680000
066200 9300-DB2-ERROR.                                                  06690000
066300     DISPLAY PV-PARAGRAPH-NAME.                                   06700000
066400     DISPLAY PC-ABEND-MSG  PC-PROGRAM-NUMBER.                     06710000
066500     DISPLAY PC-DB-ERROR-PREFIX.                                  06720000
066600     DISPLAY PC-DB-ATTEMPTING-MSG PV-DB2-ERROR-MSG.               06730000
066700                                                                  06740000
066800     COPY DPPD004.                                                06750000
066900                                                                  06760000
067000     SET ABEND-4013-DB2-ERROR         TO TRUE.                    06770000
067100     CALL 'ILBOABN0' USING ABEND-CODE.                            06780000
067200***************************************************************** 06790000
067300* 9999-END-ROUTINE                                              * 06800000
067400* CLOSE FILES                                                   * 06810000
067500***************************************************************** 06820000
067600                                                                  06830000
067700 9999-END-ROUTINE.                                                06840000
067800                                                                  06850000
067900                                                                  06860000
068000     CLOSE COSA-EXTRACT-FILE.                                     06870000
068100     CLOSE BANK-SETTLEMENT-FILE.                                  06880000
068200     CLOSE AJB-REAUTH-FILE.                                       06890000
068300                                                                  06900000
068400     MOVE PV-READ-CNT TO PV-DISPLAY-CNT.                          06910000
068500     DISPLAY 'RECORDS READ:                     ' PV-DISPLAY-CNT. 06920000
068600     MOVE PV-WRITE-AJB TO PV-DISPLAY-CNT.                         06930000
068700     DISPLAY 'RECORDS WRITTEN TO AJB FILE:      ' PV-DISPLAY-CNT. 06940000
068800     MOVE PV-WRITE-BANK TO PV-DISPLAY-CNT.                        06950000
068900     DISPLAY 'RECORDS WRITTEN TO BANK FILE:     ' PV-DISPLAY-CNT. 06960000
069000*    MOVE PV-DROP-AMEX TO PV-DISPLAY-CNT.                         06970000
069100*    DISPLAY 'AMEX TRANS DROPPED:               ' PV-DISPLAY-CNT. 06980000
069200     DISPLAY PC-NORMAL-EOJ-MSG   PC-PROGRAM-NUMBER.               06990000
