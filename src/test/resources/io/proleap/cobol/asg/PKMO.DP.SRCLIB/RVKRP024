000100******************************************************************00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300******************************************************************00030000
000400                                                                  00040000
000500 PROGRAM-ID.             RVKRP024.                                00050000
000600 AUTHOR.                 VIRGENE LENNEMAN.                        00060000
000700 INSTALLATION.           KOHLS.                                   00070000
000800 DATE-WRITTEN            JUNE 2007.                               00080000
000900 DATE-COMPILED.                                                   00090000
001000                                                                  00100000
001100******************************************************************00110000
001200*  THIS PROGRAM WILL CREATE A DETAIL AND SUMMARY REPORT BY        00120000
001300*  BUYER FOR PHYSICAL INVENTORY.                                  00130000
001400*  THE PROGRAM WILL BE EXECUTED MULTIPLE TIMES AND THE TYPE OF    00140000
001500*    REPORT WILL BE DETERMINED BY A PARAMETER ON THE DATE CARD.   00150000
001600******************************************************************00160000
001700*--------------------------------------------------------------*  00170000
001800* HISTORY LOG:                                                    00180000
001900*--------------------------------------------------------------*  00190000
002000* DATE:        2011/10/30                                         00200000
002100* PROJ#:       3219  GENCO/RTV UPGRADE PROJECT                    00210000
002200* WR/IR#:      WR40134                                            00220000
002300* PROGRAMMER:  STEVE ANDERSON - CODEWORKS                         00230000
002400* DESCRIPTION: CHANGE REPORT FIELD HEADINGS FROM "BL" (BILL OF    00240000
002500*              LADING) TO "SB" (SLOT BY) ON BOTH DETAIL AND       00250000
002600*              SUMMARY REPORT.                                    00260000
002700*--------------------------------------------------------------*  00270000
002800                                                                  00280000
002900******************************************************************00290000
003000 ENVIRONMENT DIVISION.                                            00300000
003100******************************************************************00310000
003200                                                                  00320000
003300 CONFIGURATION SECTION.                                           00330000
003400                                                                  00340000
003500 SOURCE-COMPUTER.        IBM-3090.                                00350000
003600 OBJECT-COMPUTER.        IBM-3090.                                00360000
003700                                                                  00370000
003800 INPUT-OUTPUT SECTION.                                            00380000
003900                                                                  00390000
004000 FILE-CONTROL.                                                    00400000
004100                                                                  00410000
004200     SELECT INVENTORY-FILE              ASSIGN TO INP01.          00420000
004300                                                                  00430000
004400     SELECT REPORT-FILE                 ASSIGN TO RPT01.          00440000
004500                                                                  00450000
004600******************************************************************00460000
004700 DATA DIVISION.                                                   00470000
004800******************************************************************00480000
004900                                                                  00490000
005000 FILE SECTION.                                                    00500000
005100                                                                  00510000
005200 FD  INVENTORY-FILE                                               00520000
005300     RECORDING MODE IS F                                          00530000
005400     LABEL RECORDS ARE STANDARD                                   00540000
005500     BLOCK CONTAINS 0 RECORDS.                                    00550000
005600                                                                  00560000
005700 01  INVENTORY-REC                       PIC  X(610).             00570000
005800                                                                  00580000
005900 FD  REPORT-FILE                                                  00590000
006000     RECORDING MODE IS F                                          00600000
006100     LABEL RECORDS ARE STANDARD                                   00610000
006200     BLOCK CONTAINS 0 RECORDS.                                    00620000
006300                                                                  00630000
006400 01  REPORT-LINE                         PIC  X(132).             00640000
006500                                                                  00650000
006600******************************************************************00660000
006700 WORKING-STORAGE SECTION.                                         00670000
006800******************************************************************00680000
006900*                                                                 00690000
007000*  STANDARD REPORT HEADER FOR A 132 COLUMN REPORT.                00700000
007100*                                                                 00710000
007200     COPY DPWS132.                                                00720000
007300*                                                                 00730000
007400*  WORK AREA FOR FISCAL CALENDAR ROUTINE.                         00740000
007500*                                                                 00750000
007600     COPY DPWS500.                                                00760000
007700*                                                                 00770000
007800*  WORK AREA FOR SQL ERROR ROUTINE 'DSNTIAR'                      00780000
007900*                                                                 00790000
008000     COPY DPWS004.                                                00800000
008100*                                                                 00810000
008200*  COPYBOOK FOR INPUT INVENTORY DETAIL REPORT FILE                00820000
008300*                                                                 00830000
008400     COPY RVRD027.                                                00840000
008500*                                                                 00850000
008600*  COPYBOOK FOR INPUT INVENTORY SUMMARY REPORT FILE               00860000
008700*                                                                 00870000
008800     COPY RVRD028.                                                00880000
008900                                                                  00890000
009000 01  ABEND-CODE                          PIC S9(04) VALUE +0      00900000
009100                                                     COMP SYNC.   00910000
009200 01  CC-CONTROL-CARD.                                             00920000
009300     05  FILLER                          PIC  X(22).              00930000
009400     05  CC-REPORT-TYPE                  PIC  X(01).              00940000
009500         88  CC-VALID-REPORT-TYPE             VALUE 'D', 'S'.     00950000
009600         88  CC-DETAIL-REPORT                 VALUE 'D'.          00960000
009700         88  CC-SUMMARY-REPORT                VALUE 'S'.          00970000
009800                                                                  00980000
009900 01  PC-CONSTANTS.                                                00990000
010000     05  PC-DAYS-TO-INCREMENT            PIC S9(03)  VALUE +1.    01000000
010100     05  PC-LOC-NBR                      PIC S9(4) COMP VALUE +0. 01010000
010200     05  PC-MAX-REPORT-LINES             PIC S9(04)  VALUE +60    01020000
010300                                                     COMP SYNC.   01030000
010400     05  PC-CURRENT-PROGRAM-NAME         PIC  X(08)  VALUE        01040000
010500         'RVKRP024'.                                              01050000
010600     05  PC-TOTAL-DESRIPTIONS.                                    01060000
010700         10  PC-BL-TOTAL                 PIC  X(21)  VALUE        01070000
010800             '     SB NUMBER TOTAL:'.                             01080000
010900         10  PC-BUYER-TOTAL              PIC  X(21)  VALUE        01090000
011000             '         BUYER TOTAL:'.                             01100000
011100                                                                  01110000
011200 01  PS-PROGRAM-SWITCHES.                                         01120000
011300     05  PS-END-OF-FILE-SWITCH        PIC  X(01) VALUE 'N'.       01130000
011400         88  PS-EOF                              VALUE 'Y'.       01140000
011500         88  PS-NOT-EOF                          VALUE 'N'.       01150000
011600                                                                  01160000
011700 01  PV-PROGRAM-VARIABLES.                                        01170000
011800     05  PV-DATE-RETURNED-FROM-ROUTINE   PIC  9(08).              01180000
011900     05  PV-INV-DATE                     PIC  X(10)  VALUE SPACES.01190000
012000     05  PV-REC-READ                     PIC  9(10)  VALUE ZEROES.01200000
012100     05  PV-DETAIL-PAGE-COUNT            PIC S9(04)  VALUE +0     01210000
012200                                                     COMP SYNC.   01220000
012300     05  PV-DETAIL-LINE-COUNT            PIC S9(04)  VALUE +0     01230000
012400                                                     COMP SYNC.   01240000
012500     05  PV-SUM-PAGE-COUNT               PIC S9(04)  VALUE +0     01250000
012600                                                     COMP SYNC.   01260000
012700     05  PV-SUM-LINE-COUNT               PIC S9(04)  VALUE +0     01270000
012800                                                     COMP SYNC.   01280000
012900     05  PV-PREV-BL-NBR                  PIC  X(15).              01290000
013000     05  PV-PREV-BUYER-NBR               PIC  9(03).              01300000
013100     05  PV-PREV-BUYER-NAME              PIC  X(32).              01310000
013200     05  PV-HOLD-SCAN-DATE.                                       01320000
013300         10  PV-HOLD-SCAN-MONTH          PIC  9(02).              01330000
013400         10  PV-HOLD-SCAN-DAY            PIC  9(02).              01340000
013500         10  PV-HOLD-SCAN-YEAR.                                   01350000
013600             15 PV-HOLD-SCAN-CC          PIC  9(02).              01360000
013700             15 PV-HOLD-SCAN-DD          PIC  9(02).              01370000
013800     05  PV-HOLD-PUTAWAY-DATE.                                    01380000
013900         10  PV-HOLD-PUTA-MONTH          PIC  9(02).              01390000
014000         10  PV-HOLD-PUTA-DAY            PIC  9(02).              01400000
014100         10  PV-HOLD-PUTA-YEAR.                                   01410000
014200             15 PV-HOLD-PUTA-CC          PIC  9(02).              01420000
014300             15 PV-HOLD-PUTA-YY          PIC  9(02).              01430000
014400     05  PV-HOLD-TRANSFER-STORE          PIC  9(04).              01440000
014500     05  PV-HOLD-TRANSFER-NBR            PIC  9(06).              01450000
014600     05  PV-TRANSFER.                                             01460000
014700         10  PV-TRANSFER-STORE           PIC  9(04).              01470000
014800         10  FILLER                      PIC  X(01) VALUE '-'.    01480000
014900         10  PV-TRANSFER-NBR             PIC  9(06).              01490000
015000     05  PV-DISPLAY-BL-NBR               PIC  Z(14)9.             01500000
015100     05  PV-PARAGRAPH-NAME               PIC  X(30)  VALUE SPACE. 01510000
015200     05  PV-DB2-OPERATION-ATTEMPTED      PIC  X(30)  VALUE SPACE. 01520000
015300     05  PV-DB2-OPER-UNT-ID              PIC S9(04) COMP VALUE +0.01530000
015400     05  PV-START-DATE-D-NUM             PIC 9(08) VALUE ZEROES.  01540000
015500     05  PV-START-DATE-D.                                         01550000
015600         10  PV-START-D-CENTURY          PIC  9(02).              01560000
015700         10  PV-START-D-YEAR             PIC  9(02).              01570000
015800         10  PV-START-D-MONTH            PIC  9(02).              01580000
015900         10  PV-START-D-DAY              PIC  9(02).              01590000
016000     05  PV-START-DATE-F                 PIC  9(08) VALUE ZEROES. 01600000
016100     05  PV-START-DATE.                                           01610000
016200         10  PV-START-MONTH              PIC  9(02).              01620000
016300         10  FILLER                      PIC  X(01) VALUE '/'.    01630000
016400         10  PV-START-DAY                PIC  9(02).              01640000
016500         10  FILLER                      PIC  X(01) VALUE '/'.    01650000
016600         10  PV-START-CENTURY            PIC  9(02).              01660000
016700         10  PV-START-YEAR               PIC  9(02).              01670000
016800     05  PV-END-DATE.                                             01680000
016900         10  PV-END-MONTH                PIC  9(02).              01690000
017000         10  FILLER                      PIC  X(01) VALUE '/'.    01700000
017100         10  PV-END-DAY                  PIC  9(02).              01710000
017200         10  FILLER                      PIC  X(01) VALUE '/'.    01720000
017300         10  PV-END-CENTURY              PIC  9(02).              01730000
017400         10  PV-END-YEAR                 PIC  9(02).              01740000
017500     05  PV-WORK-DATE.                                            01750000
017600         10  PV-WORK-MONTH               PIC  9(02).              01760000
017700         10  FILLER                      PIC  X(01) VALUE '/'.    01770000
017800         10  PV-WORK-DAY                 PIC  9(02).              01780000
017900         10  FILLER                      PIC  X(01) VALUE '/'.    01790000
018000         10  PV-WORK-YEAR                PIC  9(02).              01800000
018100     05  PV-WORK-DATE2.                                           01810000
018200         10  PV-WORK-MONTH2              PIC  9(02).              01820000
018300         10  FILLER                      PIC  X(01) VALUE '/'.    01830000
018400         10  PV-WORK-DAY2                PIC  9(02).              01840000
018500         10  FILLER                      PIC  X(01) VALUE '/'.    01850000
018600         10  PV-WORK-YEAR2               PIC  9(04).              01860000
018700     05  PV-DEPT-TOTAL-LINE.                                      01870000
018800         10  FILLER                     PIC X(11)                 01880000
018900             VALUE 'DEPARTMENT '.                                 01890000
019000         10  PV-TOTAL-LINE-DPT          PIC X(03).                01900000
019100         10  FILLER                     PIC X(07)                 01910000
019200             VALUE ' TOTAL:'.                                     01920000
019300                                                                  01930000
019400 01  SD-SYSTEM-DATE.                                              01940000
019500     05  SD-SYSTEM-YEAR                  PIC  9(04)  VALUE ZEROS. 01950000
019600     05  SD-SYSTEM-MONTH                 PIC  9(02)  VALUE ZEROS. 01960000
019700     05  SD-SYSTEM-DAY                   PIC  9(02)  VALUE ZEROS. 01970000
019800 01  ST-SYSTEM-TIME.                                              01980000
019900     05  ST-SYSTEM-HOUR                  PIC  9(02)  VALUE ZEROS. 01990000
020000     05  ST-SYSTEM-MINUTE                PIC  9(02)  VALUE ZEROS. 02000000
020100                                                                  02010000
020200 01  PH2-PAGE-HEADING-2.                                          02020000
020300     05  FILLER                          PIC  X(33)  VALUE SPACE. 02030000
020400     05  FILLER                          PIC  X(45)  VALUE        02040000
020500         'RETURN-TO-VENDOR - INVENTORY DETAIL REPORT - '.         02050000
020600     05  PH2-STORE-NUMBER                PIC  X(4).               02060000
020700     05  FILLER                          PIC  X(1)   VALUE ' '.   02070000
020800     05  PH2-STORE-DESC                  PIC  X(15).              02080000
020900     05  FILLER                          PIC  X(34)  VALUE SPACE. 02090000
021000                                                                  02100000
021100 01  PH3-PAGE-HEADING-3.                                          02110000
021200     05  FILLER                          PIC  X(44)  VALUE SPACE. 02120000
021300     05  FILLER                          PIC  X(12)  VALUE        02130000
021400         'BEGIN DATE: '.                                          02140000
021500     05  PH3-START-DATE                  PIC  X(10)  VALUE SPACE. 02150000
021600     05  FILLER                          PIC  X(13)  VALUE        02160000
021700         ' - END DATE: '.                                         02170000
021800     05  PH3-END-DATE                    PIC  X(10)  VALUE SPACE. 02180000
021900     05  FILLER                          PIC  X(43)  VALUE SPACE. 02190000
022000                                                                  02200000
022100**********  BUYER INFO                                            02210000
022200 01  PH5-PAGE-HEADING-5.                                          02220000
022300     05  FILLER                          PIC  X(14)  VALUE        02230000
022400         '  BUYER NAME: '.                                        02240000
022500     05  PH5-BUYER-NAME                  PIC  X(32)  VALUE SPACE. 02250000
022600     05  FILLER                          PIC  X(86)  VALUE SPACE. 02260000
022700                                                                  02270000
022800 01  PH6-PAGE-HEADING-6.                                          02280000
022900     05  FILLER                          PIC  X(14)  VALUE        02290000
023000         'BUYER NUMBER: '.                                        02300000
023100     05  PH6-BUYER-NBR                   PIC  X(03)  VALUE SPACE. 02310000
023200     05  FILLER                          PIC  X(115) VALUE SPACE. 02320000
023300                                                                  02330000
023400**********  BL INFO                                               02340000
023500 01  PH7-PAGE-HEADING-7.                                          02350000
023600     05  FILLER                          PIC  X(04)  VALUE        02360000
023700         'SB: '.                                                  02370000
023800     05  PH7-BL-NBR                      PIC  X(15)  VALUE SPACE. 02380000
023900     05  FILLER                          PIC  X(07)  VALUE        02390000
024000         ' TYPE: '.                                               02400000
024100     05  PH7-TYPE                        PIC  X(01)  VALUE SPACE. 02410000
024200     05  FILLER                          PIC  X(01)  VALUE SPACE. 02420000
024300     05  FILLER                          PIC  X(08)  VALUE        02430000
024400         'STATUS: '.                                              02440000
024500     05  PH7-STATUS                      PIC  X(01)  VALUE SPACE. 02450000
024600     05  FILLER                          PIC  X(01)  VALUE SPACE. 02460000
024700     05  FILLER                          PIC  X(14)  VALUE        02470000
024800         'PUTAWAY DATE: '.                                        02480000
024900     05  PH7-PUTAWAY-DT                  PIC  X(10)  VALUE SPACE. 02490000
025000     05  FILLER                          PIC  X(70)  VALUE SPACE. 02500000
025100                                                                  02510000
025200******  DETAIL LINES FOR DETAIL REPORT                            02520000
025300 01  DH1-DETAIL-HEADING-1.                                        02530000
025400     05  FILLER                          PIC  X(06)  VALUE SPACES.02540000
025500     05  FILLER                          PIC  X(04)  VALUE        02550000
025600         'SCAN'.                                                  02560000
025700     05  FILLER                          PIC  X(63)  VALUE SPACE. 02570000
025800     05  FILLER                          PIC  X(08)  VALUE        02580000
025900         'EXTENDED'.                                              02590000
026000     05  FILLER                          PIC  X(22)  VALUE SPACE. 02600000
026100     05  FILLER                          PIC  X(08)  VALUE        02610000
026200         'EXTENDED'.                                              02620000
026300     05  FILLER                          PIC  X(20)  VALUE SPACE. 02630000
026400                                                                  02640000
026500 01  DH2-DETAIL-HEADING-2.                                        02650000
026600     05  FILLER                          PIC  X(03)  VALUE        02660000
026700         'DPT'.                                                   02670000
026800     05  FILLER                          PIC  X(01)  VALUE SPACE. 02680000
026900     05  FILLER                          PIC  X(08)  VALUE        02690000
027000         '  DATE  '.                                              02700000
027100     05  FILLER                          PIC  X(01)  VALUE SPACE. 02710000
027200     05  FILLER                          PIC  X(20)  VALUE        02720000
027300         'CURRENT LOCATION    '.                                  02730000
027400     05  FILLER                          PIC  X(01)  VALUE SPACE. 02740000
027500     05  FILLER                          PIC  X(08)  VALUE        02750000
027600         '   SKU  '.                                              02760000
027700     05  FILLER                          PIC  X(01)  VALUE SPACE. 02770000
027800     05  FILLER                          PIC  X(08)  VALUE        02780000
027900         '  QTY   '.                                              02790000
028000     05  FILLER                          PIC  X(01)  VALUE SPACE. 02800000
028100     05  FILLER                          PIC  X(14)  VALUE        02810000
028200         '          COST'.                                        02820000
028300     05  FILLER                          PIC  X(01)  VALUE SPACE. 02830000
028400     05  FILLER                          PIC  X(14)  VALUE        02840000
028500         '          COST'.                                        02850000
028600     05  FILLER                          PIC  X(01)  VALUE SPACE. 02860000
028700     05  FILLER                          PIC  X(14)  VALUE        02870000
028800         '        RETAIL'.                                        02880000
028900     05  FILLER                          PIC  X(01)  VALUE SPACE. 02890000
029000     05  FILLER                          PIC  X(14)  VALUE        02900000
029100         '        RETAIL'.                                        02910000
029200     05  FILLER                          PIC  X(01)  VALUE SPACE. 02920000
029300     05  FILLER                          PIC  X(13)  VALUE        02930000
029400         ' TRANSFER    '.                                         02940000
029500     05  FILLER                          PIC  X(05)  VALUE SPACE. 02950000
029600                                                                  02960000
029700 01  DH3-DETAIL-HEADING-3.                                        02970000
029800     05  FILLER                        PIC  X(03)  VALUE ALL '_'. 02980000
029900     05  FILLER                        PIC  X(01)  VALUE SPACE.   02990000
030000     05  FILLER                        PIC  X(08)  VALUE ALL '_'. 03000000
030100     05  FILLER                        PIC  X(01)  VALUE SPACE.   03010000
030200     05  FILLER                        PIC  X(20)  VALUE ALL '_'. 03020000
030300     05  FILLER                        PIC  X(01)  VALUE SPACE.   03030000
030400     05  FILLER                        PIC  X(08)  VALUE ALL '_'. 03040000
030500     05  FILLER                        PIC  X(01)  VALUE SPACE.   03050000
030600     05  FILLER                        PIC  X(08)  VALUE ALL '_'. 03060000
030700     05  FILLER                        PIC  X(01)  VALUE SPACE.   03070000
030800     05  FILLER                        PIC  X(14)  VALUE ALL '_'. 03080000
030900     05  FILLER                        PIC  X(02)  VALUE SPACE.   03090000
031000     05  FILLER                        PIC  X(13)  VALUE ALL '_'. 03100000
031100     05  FILLER                        PIC  X(02)  VALUE SPACE.   03110000
031200     05  FILLER                        PIC  X(13)  VALUE ALL '_'. 03120000
031300     05  FILLER                        PIC  X(02)  VALUE SPACE.   03130000
031400     05  FILLER                        PIC  X(13)  VALUE ALL '_'. 03140000
031500     05  FILLER                        PIC  X(01)  VALUE SPACE.   03150000
031600     05  FILLER                        PIC  X(11)  VALUE ALL '_'. 03160000
031700     05  FILLER                        PIC  X(10)  VALUE SPACE.   03170000
031800                                                                  03180000
031900 01  DL-DETAIL-LINE.                                              03190000
032000     05  DL-DEPT-NBR                     PIC  X(03)  VALUE SPACE. 03200000
032100     05  FILLER                          PIC  X(01)  VALUE SPACE. 03210000
032200     05  DL-SCAN-DATE                    PIC  X(08)  VALUE SPACE. 03220000
032300     05  FILLER                          PIC  X(01)  VALUE SPACE. 03230000
032400     05  DL-LOC-ID                       PIC  X(20)  VALUE SPACE. 03240000
032500     05  FILLER                          PIC  X(01)  VALUE SPACE. 03250000
032600     05  DL-SKU                          PIC  X(08)  VALUE SPACE. 03260000
032700     05  FILLER                          PIC  X(01)  VALUE SPACE. 03270000
032800     05  DL-QTY                          PIC  ZZZZ,ZZ9.           03280000
032900     05  FILLER                          PIC  X(02)  VALUE SPACE. 03290000
033000     05  DL-COST                         PIC  ZZ,ZZZ,ZZ9.99.      03300000
033100     05  FILLER                          PIC  X(02)  VALUE SPACE. 03310000
033200     05  DL-EXTEND-COST                  PIC  ZZ,ZZZ,ZZ9.99.      03320000
033300     05  FILLER                          PIC  X(02)  VALUE SPACE. 03330000
033400     05  DL-RETAIL                       PIC  ZZ,ZZZ,ZZ9.99.      03340000
033500     05  FILLER                          PIC  X(02)  VALUE SPACE. 03350000
033600     05  DL-EXTEND-RETAIL                PIC  ZZ,ZZZ,ZZ9.99.      03360000
033700     05  FILLER                          PIC  X(01)  VALUE SPACE. 03370000
033800     05  DL-TRANSFER                     PIC  X(11)  VALUE SPACE. 03380000
033900                                                                  03390000
034000 01  TL-TOTAL-LINE.                                               03400000
034100     05  FILLER                          PIC  X(20)  VALUE SPACE. 03410000
034200     05  TL-TOTAL-DESCRIPTION            PIC  X(21)  VALUE SPACE. 03420000
034300     05  FILLER                          PIC  X(02)  VALUE SPACE. 03430000
034400     05  TL-QTY                          PIC  ZZZZ,ZZ9.           03440000
034500     05  FILLER                          PIC  X(01)  VALUE SPACE. 03450000
034600     05  TL-TOTAL-COST                   PIC  ZZZ,ZZZ,ZZ9.99.     03460000
034700     05  FILLER                          PIC  X(01)  VALUE SPACE. 03470000
034800     05  TL-TOTAL-EXT-COST               PIC  ZZZ,ZZZ,ZZ9.99.     03480000
034900     05  FILLER                          PIC  X(01)  VALUE SPACE. 03490000
035000     05  TL-TOTAL-RETAIL                 PIC  ZZZ,ZZZ,ZZ9.99.     03500000
035100     05  FILLER                          PIC  X(01)  VALUE SPACE. 03510000
035200     05  TL-TOTAL-EXT-RETAIL             PIC  ZZZ,ZZZ,ZZ9.99.     03520000
035300     05  FILLER                          PIC  X(50)  VALUE SPACE. 03530000
035400                                                                  03540000
035500******  SUMMARY REPORT REPORT LINES ******************************03550000
035600 01  PH2-PAGE-HEADING-2-SUM.                                      03560000
035700     05  FILLER                          PIC  X(33)  VALUE SPACE. 03570000
035800     05  FILLER                          PIC  X(46)  VALUE        03580000
035900         'RETURN-TO-VENDOR - INVENTORY SUMMARY REPORT - '.        03590000
036000     05  PH2S-STORE-NUMBER               PIC  X(4).               03600000
036100     05  FILLER                          PIC  X(1)   VALUE ' '.   03610000
036200     05  PH2S-STORE-DESC                 PIC  X(15).              03620000
036300     05  FILLER                          PIC  X(33)  VALUE SPACE. 03630000
036400                                                                  03640000
036500******  DETAIL LINES FOR SUMMARY REPORT                           03650000
036600 01  DH1-DETAIL-HEADING-1-SUM.                                    03660000
036700     05  FILLER                          PIC  X(29)  VALUE SPACES.03670000
036800     05  FILLER                          PIC  X(07)  VALUE        03680000
036900         'PUTAWAY'.                                               03690000
037000     05  FILLER                          PIC  X(52)  VALUE SPACE. 03700000
037100     05  FILLER                          PIC  X(08)  VALUE        03710000
037200         'EXTENDED'.                                              03720000
037300     05  FILLER                          PIC  X(21)  VALUE SPACE. 03730000
037400     05  FILLER                          PIC  X(09)  VALUE        03740000
037500         ' EXTENDED'.                                             03750000
037600     05  FILLER                          PIC  X(10)  VALUE SPACE. 03760000
037700                                                                  03770000
037800 01  DH2-DETAIL-HEADING-2-SUM.                                    03780000
037900     05  FILLER                          PIC  X(03)  VALUE        03790000
038000         'DPT'.                                                   03800000
038100     05  FILLER                          PIC  X(01)  VALUE SPACE. 03810000
038200     05  FILLER                          PIC  X(09)  VALUE        03820000
038300         'SB NUMBER'.                                             03830000
038400     05  FILLER                          PIC  X(07)  VALUE SPACE. 03840000
038500     05  FILLER                          PIC  X(03)  VALUE        03850000
038600         'TYP'.                                                   03860000
038700     05  FILLER                          PIC  X(01)  VALUE SPACE. 03870000
038800     05  FILLER                          PIC  X(03)  VALUE        03880000
038900         'STA'.                                                   03890000
039000     05  FILLER                          PIC  X(03)  VALUE SPACE. 03900000
039100     05  FILLER                          PIC  X(04)  VALUE        03910000
039200         'DATE'.                                                  03920000
039300     05  FILLER                          PIC  X(03)  VALUE SPACE. 03930000
039400     05  FILLER                          PIC  X(16)  VALUE        03940000
039500         'CURRENT LOCATION'.                                      03950000
039600     05  FILLER                          PIC  X(09)  VALUE SPACE. 03960000
039700     05  FILLER                          PIC  X(03)  VALUE        03970000
039800         'QTY'.                                                   03980000
039900     05  FILLER                          PIC  X(10)  VALUE SPACE. 03990000
040000     05  FILLER                          PIC  X(06)  VALUE        04000000
040100         '  COST'.                                                04010000
040200     05  FILLER                          PIC  X(09)  VALUE SPACE. 04020000
040300     05  FILLER                          PIC  X(06)  VALUE        04030000
040400         '  COST'.                                                04040000
040500     05  FILLER                          PIC  X(09)  VALUE SPACE. 04050000
040600     05  FILLER                          PIC  X(06)  VALUE        04060000
040700         'RETAIL'.                                                04070000
040800     05  FILLER                          PIC  X(09)  VALUE SPACE. 04080000
040900     05  FILLER                          PIC  X(06)  VALUE        04090000
041000         'RETAIL'.                                                04100000
041100     05  FILLER                          PIC  X(01)  VALUE SPACE. 04110000
041200                                                                  04120000
041300 01  DH3-DETAIL-HEADING-3-SUM.                                    04130000
041400     05  FILLER                        PIC  X(03)  VALUE ALL '_'. 04140000
041500     05  FILLER                        PIC  X(01)  VALUE SPACE.   04150000
041600     05  FILLER                        PIC  X(15)  VALUE ALL '_'. 04160000
041700     05  FILLER                        PIC  X(01)  VALUE SPACE.   04170000
041800     05  FILLER                        PIC  X(03)  VALUE ALL '_'. 04180000
041900     05  FILLER                        PIC  X(01)  VALUE SPACE.   04190000
042000     05  FILLER                        PIC  X(03)  VALUE ALL '_'. 04200000
042100     05  FILLER                        PIC  X(01)  VALUE SPACE.   04210000
042200     05  FILLER                        PIC  X(08)  VALUE ALL '_'. 04220000
042300     05  FILLER                        PIC  X(01)  VALUE SPACE.   04230000
042400     05  FILLER                        PIC  X(20)  VALUE ALL '_'. 04240000
042500     05  FILLER                        PIC  X(01)  VALUE SPACE.   04250000
042600     05  FILLER                        PIC  X(08)  VALUE ALL '_'. 04260000
042700     05  FILLER                        PIC  X(02)  VALUE SPACE.   04270000
042800     05  FILLER                        PIC  X(13)  VALUE ALL '_'. 04280000
042900     05  FILLER                        PIC  X(02)  VALUE SPACE.   04290000
043000     05  FILLER                        PIC  X(13)  VALUE ALL '_'. 04300000
043100     05  FILLER                        PIC  X(02)  VALUE SPACE.   04310000
043200     05  FILLER                        PIC  X(13)  VALUE ALL '_'. 04320000
043300     05  FILLER                        PIC  X(02)  VALUE SPACE.   04330000
043400     05  FILLER                        PIC  X(13)  VALUE ALL '_'. 04340000
043500     05  FILLER                        PIC  X(07)  VALUE SPACE.   04350000
043600                                                                  04360000
043700 01  DLS-DETAIL-LINE-SUM.                                         04370000
043800     05  DLS-DEPT-NBR                    PIC  X(03)  VALUE SPACE. 04380000
043900     05  FILLER                          PIC  X(01)  VALUE SPACE. 04390000
044000     05  DLS-BL-NBR                      PIC  X(15)  VALUE SPACE. 04400000
044100     05  FILLER                          PIC  X(02)  VALUE SPACE. 04410000
044200     05  DLS-BL-TYPE                     PIC  X(01)  VALUE SPACE. 04420000
044300     05  FILLER                          PIC  X(03)  VALUE SPACE. 04430000
044400     05  DLS-BL-STATUS                   PIC  X(01)  VALUE SPACE. 04440000
044500     05  FILLER                          PIC  X(02)  VALUE SPACE. 04450000
044600     05  DLS-PUTAWAY-DATE                PIC  X(08)  VALUE SPACE. 04460000
044700     05  FILLER                          PIC  X(01)  VALUE SPACE. 04470000
044800     05  DLS-LOC-ID                      PIC  X(20)  VALUE SPACE. 04480000
044900     05  FILLER                          PIC  X(01)  VALUE SPACE. 04490000
045000     05  DLS-QTY                         PIC  ZZZZ,ZZ9.           04500000
045100     05  FILLER                          PIC  X(02)  VALUE SPACE. 04510000
045200     05  DLS-COST                        PIC  ZZ,ZZZ,ZZ9.99.      04520000
045300     05  FILLER                          PIC  X(02)  VALUE SPACE. 04530000
045400     05  DLS-EXTEND-COST                 PIC  ZZ,ZZZ,ZZ9.99.      04540000
045500     05  FILLER                          PIC  X(02)  VALUE SPACE. 04550000
045600     05  DLS-RETAIL                      PIC  ZZ,ZZZ,ZZ9.99.      04560000
045700     05  FILLER                          PIC  X(02)  VALUE SPACE. 04570000
045800     05  DLS-EXTEND-RETAIL               PIC  ZZ,ZZZ,ZZ9.99.      04580000
045900     05  FILLER                          PIC  X(01)  VALUE SPACE. 04590000
046000                                                                  04600000
046100 01  TLS-TOTAL-LINE-SUM.                                          04610000
046200     05  FILLER                          PIC  X(35)  VALUE SPACE. 04620000
046300     05  TLS-TOTAL-DESCRIPTION           PIC  X(21)  VALUE SPACE. 04630000
046400     05  FILLER                          PIC  X(02)  VALUE SPACE. 04640000
046500     05  TLS-QTY                         PIC  ZZZZ,ZZ9.           04650000
046600     05  FILLER                          PIC  X(01)  VALUE SPACE. 04660000
046700     05  TLS-TOTAL-COST                  PIC  ZZZ,ZZZ,ZZ9.99.     04670000
046800     05  FILLER                          PIC  X(01)  VALUE SPACE. 04680000
046900     05  TLS-TOTAL-EXT-COST              PIC  ZZZ,ZZZ,ZZ9.99.     04690000
047000     05  FILLER                          PIC  X(01)  VALUE SPACE. 04700000
047100     05  TLS-TOTAL-RETAIL                PIC  ZZZ,ZZZ,ZZ9.99.     04710000
047200     05  FILLER                          PIC  X(01)  VALUE SPACE. 04720000
047300     05  TLS-TOTAL-EXT-RETAIL            PIC  ZZZ,ZZZ,ZZ9.99.     04730000
047400     05  FILLER                          PIC  X(01)  VALUE SPACE. 04740000
047500                                                                  04750000
047600******  GRAND TOTAL LINES FOR BOTH DETAIL AND SUMMARY REPORT      04760000
047700 01  GT-GRAND-TOTAL-HEADER.                                       04770000
047800     05  FILLER                          PIC  X(54)  VALUE        04780000
047900                                                     ALL '* '.    04790000
048000     05  FILLER                          PIC  X(25)  VALUE        04800000
048100         '  G R A N D   T O T A L  '.                             04810000
048200     05  FILLER                          PIC  X(52)  VALUE        04820000
048300                                                     ALL '* '.    04830000
048400 01  GT-GRAND-TOTAL-QTY.                                          04840000
048500     05  FILLER                          PIC  X(10)  VALUE SPACE. 04850000
048600     05  FILLER                          PIC  X(30)  VALUE        04860000
048700         'REPORT TOTAL      (QUANTITY): '.                        04870000
048800     05  FILLER                          PIC  X(12)  VALUE SPACE. 04880000
048900     05  GT-QTY                          PIC  ZZZ,ZZ9.            04890000
049000                                                                  04900000
049100 01  GT-GRAND-TOTAL-COST.                                         04910000
049200     05  FILLER                          PIC  X(10)  VALUE SPACE. 04920000
049300     05  FILLER                          PIC  X(30)  VALUE        04930000
049400         '                (TOTAL COST): '.                        04940000
049500     05  FILLER                          PIC  X(04)  VALUE SPACE. 04950000
049600     05  GT-TOTAL-COST                   PIC  $$$$,$$$,$$9.99.    04960000
049700     05  FILLER                          PIC  X(03)  VALUE SPACE. 04970000
049800                                                                  04980000
049900 01  GT-GRAND-TOTAL-EXT-COST.                                     04990000
050000     05  FILLER                          PIC  X(10)  VALUE SPACE. 05000000
050100     05  FILLER                          PIC  X(30)  VALUE        05010000
050200         '       (TOTAL EXTENDED COST): '.                        05020000
050300     05  FILLER                          PIC  X(04)  VALUE SPACE. 05030000
050400     05  GT-TOTAL-EXT-COST               PIC  $$$$,$$$,$$9.99.    05040000
050500     05  FILLER                          PIC  X(03)  VALUE SPACE. 05050000
050600                                                                  05060000
050700 01  GT-GRAND-TOTAL-RETAIL.                                       05070000
050800     05  FILLER                          PIC  X(10)  VALUE SPACE. 05080000
050900     05  FILLER                          PIC  X(30)  VALUE        05090000
051000         '              (TOTAL RETAIL): '.                        05100000
051100     05  FILLER                          PIC  X(04)  VALUE SPACE. 05110000
051200     05  GT-TOTAL-RETAIL                 PIC  $$$$,$$$,$$9.99.    05120000
051300     05  FILLER                          PIC  X(03)  VALUE SPACE. 05130000
051400                                                                  05140000
051500 01  GT-GRAND-TOTAL-EXT-RETAIL.                                   05150000
051600     05  FILLER                          PIC  X(10)  VALUE SPACE. 05160000
051700     05  FILLER                          PIC  X(30)  VALUE        05170000
051800         '     (TOTAL EXTENDED RETAIL): '.                        05180000
051900     05  FILLER                          PIC  X(04)  VALUE SPACE. 05190000
052000     05  GT-TOTAL-EXT-RETAIL             PIC  $$$$,$$$,$$9.99.    05200000
052100     05  FILLER                          PIC  X(03)  VALUE SPACE. 05210000
052200                                                                  05220000
052300 01  ER-EMPTY-REPORT-LINE.                                        05230000
052400     05  FILLER                          PIC  X(42)  VALUE SPACE. 05240000
052500     05  FILLER                          PIC  X(48)  VALUE        05250000
052600         '*** INPUT FILE CONTAINS NO DATA TO REPORT  *****'.      05260000
052700     05  FILLER                          PIC  X(42)  VALUE SPACE. 05270000
052800                                                                  05280000
052900 01  BLANK-LINE.                                                  05290000
053000     05  FILLER                          PIC  X(132) VALUE SPACE. 05300000
053100                                                                  05310000
053200 01  END-OF-REPORT-LINE.                                          05320000
053300     05  FILLER                          PIC  X(54)  VALUE SPACE. 05330000
053400     05  FILLER                          PIC  X(25)  VALUE        05340000
053500         '***** END OF REPORT *****'.                             05350000
053600     05  FILLER                          PIC  X(53)  VALUE SPACE. 05360000
053700                                                                  05370000
053800******************************************************************05380000
053900*  DB2 COMMUNICATION AREA.                                        05390000
054000******************************************************************05400000
054100     EXEC SQL                                                     05410000
054200          INCLUDE SQLCA                                           05420000
054300     END-EXEC.                                                    05430000
054400                                                                  05440000
054500******************************************************************05450000
054600*  DB2 TABLE DB2PDBA.XLT_LOC                                      05460000
054700******************************************************************05470000
054800     EXEC SQL                                                     05480000
054900          INCLUDE XLT00010                                        05490000
055000     END-EXEC.                                                    05500000
055100                                                                  05510000
055200******************************************************************05520000
055300*  DB2 TABLE DB2PDBA.XLT_MDSE_INV_PARM                            05530000
055400******************************************************************05540000
055500     EXEC SQL                                                     05550000
055600          INCLUDE XLT00025                                        05560000
055700     END-EXEC.                                                    05570000
055800                                                                  05580000
055900*                                                                 05590000
056000*  CURSOR DECLARATION FOR BEGIN DATE & END DATE                   05600000
056100*                                                                 05610000
056200                                                                  05620000
056300     EXEC SQL                                                     05630000
056400          DECLARE INV-DATE-CSR CURSOR FOR                         05640000
056500             SELECT PLND_INV_DTE                                  05650000
056600               FROM XLT_MDSE_INV_PARM                             05660000
056700              WHERE LOC_NBR              = :PC-LOC-NBR            05670000
056800                AND LOC_INV_STAT_CDE     = 'IN'                   05680000
056900             ORDER BY PLND_INV_DTE DESC                           05690000
057000     END-EXEC.                                                    05700000
057100*                                                                 05710000
057200* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 05720000
057300 PROCEDURE DIVISION.                                              05730000
057400* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 05740000
057500                                                                  05750000
057600******************************************************************05760000
057700*  0000-MAINLINE - CONTROLS THE MAIN PROCESSING OF THE PROGRAM    05770000
057800*                  BASED ON THE PARAMETER ON THE CONTROL CARD     05780000
057900*                  EITHER A DETAIL REPORT OR A SUMMARY REPORT     05790000
058000*                  WILL BE CREATED. VALID VALUES ARE 'D' FOR      05800000
058100*                  DETAIL AND 'S' FOR SUMMARY.                    05810000
058200******************************************************************05820000
058300 0000-PROGRAM-MAINLINE.                                           05830000
058400     PERFORM 1000-INITIALIZE.                                     05840000
058500                                                                  05850000
058600     IF CC-DETAIL-REPORT                                          05860000
058700         PERFORM 2000-PROCESS UNTIL PS-EOF                        05870000
058800     ELSE                                                         05880000
058900         IF CC-SUMMARY-REPORT                                     05890000
059000             PERFORM 3000-PROCESS-SUMMARY UNTIL PS-EOF            05900000
059100         END-IF                                                   05910000
059200     END-IF.                                                      05920000
059300                                                                  05930000
059400     PERFORM 9000-EOJ-ROUTINE.                                    05940000
059500     GOBACK.                                                      05950000
059600                                                                  05960000
059700******************************************************************05970000
059800*  1000-INITIALIZE -  OPENS ALL FILE, ACCEPTS, EDITS,             05980000
059900*  AND DISPLAYS CONTROL CARD INFORMATION, PRINTS INTIAL HEADINGS  05990000
060000*  TO REPORT FILE                                                 06000000
060100******************************************************************06010000
060200 1000-INITIALIZE.                                                 06020000
060300     OPEN INPUT INVENTORY-FILE                                    06030000
060400         OUTPUT REPORT-FILE.                                      06040000
060500                                                                  06050000
060600     ACCEPT CC-CONTROL-CARD FROM SYSIN.                           06060000
060700     DISPLAY '**'                                                 06070000
060800     DISPLAY '** RVKRP024 - CONTROL CARD = ' CC-CONTROL-CARD.     06080000
060900                                                                  06090000
061000     IF CC-VALID-REPORT-TYPE                                      06100000
061100         CONTINUE                                                 06110000
061200     ELSE                                                         06120000
061300         DISPLAY '** ABEND **'                                    06130000
061400         DISPLAY '** PROGRAM = RVKRP024 **'                       06140000
061500         DISPLAY '** PARAGRAPH = 1000-INITIALIZE **'              06150000
061600         DISPLAY '** INVALID REPORT TYPE.  VALID VALUES ARE: **'  06160000
061700         DISPLAY '** D = DETAIL REPORT  **'                       06170000
061800         DISPLAY '** S = SUMMARY REPORT **'                       06180000
061900         DISPLAY '** REPORT TYPE ENTERED = '                      06190000
062000                 CC-REPORT-TYPE '  **'                            06200000
062100         MOVE +4003 TO ABEND-CODE                                 06210000
062200         CALL 'ILBOABN0' USING ABEND-CODE                         06220000
062300     END-IF.                                                      06230000
062400                                                                  06240000
062500                                                                  06250000
062600     MOVE FUNCTION CURRENT-DATE (1:8) TO  SD-SYSTEM-DATE.         06260000
062700     MOVE FUNCTION CURRENT-DATE (9:6) TO  ST-SYSTEM-TIME.         06270000
062800                                                                  06280000
062900     MOVE SD-SYSTEM-YEAR   TO DP132-RUN-YEAR.                     06290000
063000     MOVE SD-SYSTEM-MONTH  TO DP132-RUN-MONTH.                    06300000
063100     MOVE SD-SYSTEM-DAY    TO DP132-RUN-DAY.                      06310000
063200                                                                  06320000
063300     MOVE ST-SYSTEM-HOUR   TO DP132-RUN-HOUR.                     06330000
063400     MOVE ST-SYSTEM-MINUTE TO DP132-RUN-MINUTE.                   06340000
063500                                                                  06350000
063600     MOVE 'RVKRP024'       TO DP132-PROGRAM-NAME.                 06360000
063700                                                                  06370000
063800     PERFORM 7000-READ-INPUT.                                     06380000
063900     IF PS-NOT-EOF                                                06390000
064000**  JH  10/30/2011  BEG                                           06400000
064100         IF CC-DETAIL-REPORT                                      06410000
064200             MOVE RV027-RTV-LOC TO PC-LOC-NBR                     06420000
064300         ELSE                                                     06430000
064400             MOVE RV028-RTV-LOC TO PC-LOC-NBR                     06440000
064500         END-IF                                                   06450000
064600**  JH  10/30/2011  END                                           06460000
064700         PERFORM 1100-OPEN-INV-DATE-CSR                           06470000
064800         PERFORM 1200-FETCH-INV-DATE-CSR                          06480000
064900         IF SQLCODE  = 0                                          06490000
065000          IF FUNCTION CURRENT-DATE (1:4) EQUAL                    06500000
065100             XLT00025-PLND-INV-DTE(1:4)                           06510000
065200            MOVE XLT00025-PLND-INV-DTE(6:2) TO PV-END-MONTH       06520000
065300            MOVE XLT00025-PLND-INV-DTE(9:2) TO PV-END-DAY         06530000
065400            MOVE XLT00025-PLND-INV-DTE(1:2) TO PV-END-CENTURY     06540000
065500            MOVE XLT00025-PLND-INV-DTE(3:2) TO PV-END-YEAR        06550000
065600            PERFORM 1200-FETCH-INV-DATE-CSR                       06560000
065700            IF SQLCODE  = 0                                       06570000
065800               PERFORM 1400-START-DATE-VALIDATION                 06580000
065900            ELSE                                                  06590000
066000               MOVE 'XX/XX/XXXX'            TO PV-START-DATE      06600000
066100            END-IF                                                06610000
066200          ELSE                                                    06620000
066300            PERFORM 1400-START-DATE-VALIDATION                    06630000
066400            MOVE 'XX/XX/XXXX'          TO  PV-END-DATE            06640000
066500          END-IF                                                  06650000
066600         ELSE                                                     06660000
066700           MOVE 'XX/XX/XXXX'           TO PV-END-DATE             06670000
066800           PERFORM 1200-FETCH-INV-DATE-CSR                        06680000
066900           IF SQLCODE  = 0                                        06690000
067000              PERFORM 1400-START-DATE-VALIDATION                  06700000
067100           ELSE                                                   06710000
067200              MOVE 'XX/XX/XXXX'        TO PV-START-DATE           06720000
067300           END-IF                                                 06730000
067400         END-IF                                                   06740000
067500         PERFORM 1300-CLOSE-INV-DATE-CSR                          06750000
067600         MOVE PV-START-DATE          TO PH3-START-DATE            06760000
067700         MOVE PV-END-DATE            TO PH3-END-DATE              06770000
067800         PERFORM 1010-GET-LOC-NAME                                06780000
067900         IF CC-DETAIL-REPORT                                      06790000
068000             PERFORM 8000-WRITE-DETAIL-PAGE-HEAD                  06800000
068100             PERFORM 8100-WRITE-DETAIL-COL-HEAD                   06810000
068200****  PH5, PH6 -- BUYER NAME AND NUMBER                           06820000
068300             MOVE RV027-BUYER-NAME TO  PH5-BUYER-NAME             06830000
068400             MOVE RV027-BUYER-NBR  TO  PH6-BUYER-NBR              06840000
068500                                       PV-PREV-BUYER-NBR          06850000
068600             PERFORM 8200-WRITE-BUYER-INFO                        06860000
068700****  PH7 -- BL INFO                                              06870000
068800             MOVE RV027-BL-NBR (24:15) TO  PV-DISPLAY-BL-NBR      06880000
068900                                           PV-PREV-BL-NBR         06890000
069000             MOVE PV-DISPLAY-BL-NBR TO PH7-BL-NBR                 06900000
069100             MOVE RV027-RETURN-TYPE TO PH7-TYPE                   06910000
069200             MOVE RV027-BL-STATUS TO PH7-STATUS                   06920000
069300             MOVE RV027-PUT-AWAY-DATE TO PV-HOLD-PUTAWAY-DATE     06930000
069400             MOVE PV-HOLD-PUTA-YEAR TO PV-WORK-YEAR2              06940000
069500             MOVE PV-HOLD-PUTA-MONTH TO PV-WORK-MONTH2            06950000
069600             MOVE PV-HOLD-PUTA-DAY TO PV-WORK-DAY2                06960000
069700             MOVE PV-WORK-DATE2  TO  PH7-PUTAWAY-DT               06970000
069800*            PERFORM 8300-WRITE-BL-INFO                           06980001
069900         ELSE                                                     06990000
070000********  THIS IS THE SUMMARY REPORT                              07000000
070100             PERFORM 8600-WRITE-SUM-PAGE-HEAD                     07010000
070200             PERFORM 8700-WRITE-SUM-COL-HEAD                      07020000
070300****  PH5, PH6 -- BUYER NAME AND NUMBER                           07030000
070400             MOVE RV028-BUYER-NAME TO  PH5-BUYER-NAME             07040000
070500             MOVE RV028-BUYER-NBR  TO  PH6-BUYER-NBR              07050000
070600                                       PV-PREV-BUYER-NBR          07060000
070700             PERFORM 8200-WRITE-BUYER-INFO                        07070000
070800         END-IF                                                   07080000
070900     ELSE                                                         07090000
071000         DISPLAY 'NO DATA TO REPORT'                              07100000
071100         WRITE REPORT-LINE                                        07110000
071200            FROM ER-EMPTY-REPORT-LINE                             07120000
071300            AFTER ADVANCING 3 LINES                               07130000
071400     END-IF.                                                      07140000
071500                                                                  07150000
071600******************************************************************07160000
071700* 1010-GET-LOC-NAME   GET NAME OF FINDLAY RTV                     07170000
071800******************************************************************07180000
071900 1010-GET-LOC-NAME.                                               07190000
072000     IF CC-DETAIL-REPORT                                          07200000
072100         MOVE RV027-RTV-LOC     TO PV-DB2-OPER-UNT-ID             07210000
072200     ELSE                                                         07220000
072300         MOVE RV028-RTV-LOC     TO PV-DB2-OPER-UNT-ID             07230000
072400     END-IF.                                                      07240000
072500                                                                  07250000
072600     EXEC SQL                                                     07260000
072700         SELECT A.LOC_NM                                          07270000
072800           INTO :XLT00010-LOC-NM                                  07280000
072900           FROM XLT_LOC A                                         07290000
073000          WHERE A.LOC_NBR     = :PV-DB2-OPER-UNT-ID               07300000
073100     END-EXEC.                                                    07310000
073200                                                                  07320000
073300     EVALUATE TRUE                                                07330000
073400         WHEN SQLCODE = ZERO                                      07340000
073500             IF CC-DETAIL-REPORT                                  07350000
073600                 MOVE RV027-RTV-LOC   TO PH2-STORE-NUMBER         07360000
073700                 MOVE XLT00010-LOC-NM TO PH2-STORE-DESC           07370000
073800             ELSE                                                 07380000
073900                 MOVE RV028-RTV-LOC   TO PH2S-STORE-NUMBER        07390000
074000                 MOVE XLT00010-LOC-NM TO PH2S-STORE-DESC          07400000
074100             END-IF                                               07410000
074200         WHEN SQLWARN0 NOT EQUAL SPACE                            07420000
074300         WHEN SQLCODE NOT EQUAL ZERO                              07430000
074400              MOVE '1010-GET-LOC-NAME' TO PV-PARAGRAPH-NAME       07440000
074500              MOVE 'GET LOCATION NAME' TO                         07450000
074600                                       PV-DB2-OPERATION-ATTEMPTED 07460000
074700              PERFORM 9999-SQL-ABEND                              07470000
074800     END-EVALUATE.                                                07480000
074900                                                                  07490000
075000******************************************************************07500000
075100 1100-OPEN-INV-DATE-CSR.                                          07510000
075200******************************************************************07520000
075300                                                                  07530000
075400         EXEC SQL                                                 07540000
075500              OPEN INV-DATE-CSR                                   07550000
075600         END-EXEC                                                 07560000
075700                                                                  07570000
075800         EVALUATE TRUE                                            07580000
075900*            WHEN SQLCODE = -904                                  07590000
076000*            WHEN SQLCODE = -911                                  07600000
076100*                CONTINUE                                         07610000
076200             WHEN SQLWARN0 NOT = SPACES                           07620000
076300             WHEN SQLCODE < ZERO                                  07630000
076400             WHEN SQLCODE > ZERO                                  07640000
076500                 MOVE '1100-OPEN-INV-DATE-CSR'                    07650000
076600                                 TO PV-PARAGRAPH-NAME             07660000
076700                 MOVE 'OPEN THE INV-DATE-CSR '                    07670000
076800                                 TO PV-DB2-OPERATION-ATTEMPTED    07680000
076900                 PERFORM 9999-SQL-ABEND                           07690000
077000             WHEN SQLCODE = ZERO                                  07700000
077100                 CONTINUE                                         07710000
077200         END-EVALUATE.                                            07720000
077300/                                                                 07730000
077400******************************************************************07740000
077500 1200-FETCH-INV-DATE-CSR.                                         07750000
077600******************************************************************07760000
077700     EXEC SQL                                                     07770000
077800         FETCH INV-DATE-CSR                                       07780000
077900         INTO   :XLT00025-PLND-INV-DTE                            07790000
078000     END-EXEC.                                                    07800000
078100                                                                  07810000
078200     EVALUATE TRUE                                                07820000
078300         WHEN SQLCODE = ZERO                                      07830000
078400             MOVE XLT00025-PLND-INV-DTE    TO PV-INV-DATE         07840000
078500         WHEN SQLCODE = +100                                      07850000
078600             MOVE 'XX-XX-XXXX'             TO PV-INV-DATE         07860000
078700         WHEN SQLWARN0 NOT = SPACES                               07870000
078800         WHEN SQLCODE < ZERO                                      07880000
078900         WHEN SQLCODE > ZERO                                      07890000
079000             MOVE '1200-FETCH-INV-DATE-CSR     '                  07900000
079100                                 TO PV-PARAGRAPH-NAME             07910000
079200             MOVE 'FETCH-INV-DATE-CSR          '                  07920000
079300                                 TO PV-DB2-OPERATION-ATTEMPTED    07930000
079400             PERFORM 9999-SQL-ABEND                               07940000
079500     END-EVALUATE.                                                07950000
079600/                                                                 07960000
079700******************************************************************07970000
079800 1300-CLOSE-INV-DATE-CSR.                                         07980000
079900******************************************************************07990000
080000                                                                  08000000
080100         EXEC SQL                                                 08010000
080200              CLOSE INV-DATE-CSR                                  08020000
080300         END-EXEC                                                 08030000
080400                                                                  08040000
080500         EVALUATE TRUE                                            08050000
080600*            WHEN SQLCODE = -904                                  08060000
080700*            WHEN SQLCODE = -911                                  08070000
080800*                CONTINUE                                         08080000
080900             WHEN SQLWARN0 NOT = SPACES                           08090000
081000             WHEN SQLCODE < ZERO                                  08100000
081100             WHEN SQLCODE > ZERO                                  08110000
081200                 MOVE '1300-CLOSE-INV-DATE-CSR     '              08120000
081300                                 TO PV-PARAGRAPH-NAME             08130000
081400                 MOVE 'CLOSE THE INV-DATE-CSR       '             08140000
081500                                 TO PV-DB2-OPERATION-ATTEMPTED    08150000
081600                 PERFORM 9999-SQL-ABEND                           08160000
081700             WHEN SQLCODE = ZERO                                  08170000
081800                 CONTINUE                                         08180000
081900         END-EVALUATE.                                            08190000
082000/                                                                 08200000
082100******************************************************************08210000
082200 1400-START-DATE-VALIDATION.                                      08220000
082300******************************************************************08230000
082400/                                                                 08240000
082500         MOVE XLT00025-PLND-INV-DTE(1:2) TO                       08250000
082600              PV-START-D-CENTURY                                  08260000
082700         MOVE XLT00025-PLND-INV-DTE(3:2) TO                       08270000
082800              PV-START-D-YEAR                                     08280000
082900         MOVE XLT00025-PLND-INV-DTE(6:2) TO                       08290000
083000              PV-START-D-MONTH                                    08300000
083100         MOVE XLT00025-PLND-INV-DTE(9:2) TO                       08310000
083200              PV-START-D-DAY                                      08320000
083300         MOVE PV-START-DATE-D       TO PV-START-DATE-D-NUM        08330000
083400         INITIALIZE DPG51 DPG52 DPG53                             08340000
083500                    DPG54 DPG55 DPG56                             08350000
083600                                                                  08360000
083700         SET DPG51-ACTUAL-CALENDAR-ONLY TO TRUE                   08370000
083800         SET DPG51-INCREMENT-DATE       TO TRUE                   08380000
083900         MOVE PC-DAYS-TO-INCREMENT TO DPG51-INCR-DECR-DAYS-9      08390000
084000         MOVE ZEROES           TO DPG51-INCR-DECR-BUS-DAYS-9      08400000
084100                                                                  08410000
084200         MOVE PV-START-DATE-D  TO DPG52-LK-DATE-INPUT             08420000
084300         SET DPG52-LK-DTE-ISO  TO TRUE                            08430000
084400                                                                  08440000
084500         CALL  DP500-KOHLS-CALENDAR-ROUTINE                       08450000
084600         USING DPG51 DPG52 DPG53 DPG54 DPG55 DPG56                08460000
084700                                                                  08470000
084800         EVALUATE TRUE                                            08480000
084900          WHEN DPG54-SEVERE-ERROR                                 08490000
085000          WHEN DPG54-DATE-INVALID                                 08500000
085100          DISPLAY ' '                                             08510000
085200          DISPLAY '*********** ABEND *************************'   08520000
085300          DISPLAY '** PROGRAM   **  = ' PC-CURRENT-PROGRAM-NAME   08530000
085400          DISPLAY '** PARAGRAPH **  = 1000-INITIALIZE  **'        08540000
085500          DISPLAY '** BAD CALL TO CALENDAR MODULE        '        08550000
085600          DISPLAY '** ADDING ONE DAY TO START DATE       '        08560000
085700          DISPLAY '** ' DPG54-ERROR-MESSAGE  PV-START-DATE-D      08570000
085800          DISPLAY '*******************************************'   08580000
085900          DISPLAY ' '                                             08590000
086000          MOVE +4019 TO ABEND-CODE                                08600000
086100          CALL 'ILBOABN0' USING ABEND-CODE                        08610000
086200         END-EVALUATE                                             08620000
086300                                                                  08630000
086400          MOVE DPG55-DB2-ISO-DATE     TO                          08640000
086500               PV-DATE-RETURNED-FROM-ROUTINE                      08650000
086600          MOVE PV-DATE-RETURNED-FROM-ROUTINE(5:2) TO              08660000
086700               PV-START-MONTH                                     08670000
086800          MOVE PV-DATE-RETURNED-FROM-ROUTINE(7:2) TO              08680000
086900               PV-START-DAY                                       08690000
087000          MOVE PV-DATE-RETURNED-FROM-ROUTINE(1:2) TO              08700000
087100               PV-START-CENTURY                                   08710000
087200          MOVE PV-DATE-RETURNED-FROM-ROUTINE(3:2) TO              08720000
087300               PV-START-YEAR.                                     08730000
087400/                                                                 08740000
087500******************************************************************08750000
087600* 2000-PROCESS                                                    08760000
087700*     PROCESS ALL RECORDS ON INPUT FILE                           08770000
087800******************************************************************08780000
087900 2000-PROCESS.                                                    08790000
088000     INITIALIZE DL-DETAIL-LINE.                                   08800000
088100                                                                  08810000
088200     EVALUATE TRUE                                                08820000
088300         WHEN RV027-DTL                                           08830000
088400             PERFORM 2100-DTL-LINE                                08840000
088500*        WHEN RV027-BL-TOTAL                                      08850001
088600*            PERFORM 2200-BL-TOTAL                                08860001
088700         WHEN RV027-DEPT-TOTAL                                    08870000
088800             PERFORM 2300-DEPT-TOTAL                              08880000
088900         WHEN RV027-BUYER-TOTAL                                   08890000
089000             PERFORM 2400-BUYER-TOTAL                             08900000
089100         WHEN RV027-GRAND-TOTAL                                   08910000
089200             PERFORM 2500-GRAND-TOTAL                             08920000
089300     END-EVALUATE.                                                08930000
089400                                                                  08940000
089500     PERFORM 7000-READ-INPUT.                                     08950000
089600                                                                  08960000
089700******************************************************************08970000
089800* 2100-DTL-LINE.                                                  08980000
089900*     PROCESS TYPE 1 RECORDS. WHEN BL NBR OR BUYER NUMBER CHANGES 08990000
090000*     WRITE APPROPRIATE LINES IN ADDITION TO DETAIL LINES         09000000
090100******************************************************************09010000
090200 2100-DTL-LINE.                                                   09020000
090300     IF RV027-BUYER-NBR = PV-PREV-BUYER-NBR                       09030000
090400         CONTINUE                                                 09040000
090500     ELSE                                                         09050000
090600         MOVE RV027-BUYER-NAME TO PH5-BUYER-NAME                  09060000
090700         MOVE RV027-BUYER-NBR  TO PH6-BUYER-NBR                   09070000
090800                                  PV-PREV-BUYER-NBR               09080000
090900         PERFORM 8200-WRITE-BUYER-INFO                            09090000
091000     END-IF.                                                      09100000
091100                                                                  09110000
091200*    IF RV027-BL-NBR (24:15) = PV-PREV-BL-NBR                     09120000
091300*        CONTINUE                                                 09130000
091400*    ELSE                                                         09140000
091500*        MOVE RV027-BL-NBR (24:15)   TO PV-DISPLAY-BL-NBR         09150000
091600*                                       PV-PREV-BL-NBR            09160000
091700*        MOVE PV-DISPLAY-BL-NBR      TO PH7-BL-NBR                09170000
091800*        MOVE RV027-RETURN-TYPE      TO PH7-TYPE                  09180000
091900*        MOVE RV027-BL-STATUS        TO PH7-STATUS                09190000
092000*        MOVE RV027-PUT-AWAY-DATE    TO PV-HOLD-PUTAWAY-DATE      09200000
092100*        MOVE PV-HOLD-PUTA-YEAR      TO PV-WORK-YEAR2             09210000
092200*        MOVE PV-HOLD-PUTA-MONTH     TO PV-WORK-MONTH2            09220000
092300*        MOVE PV-HOLD-PUTA-DAY       TO PV-WORK-DAY2              09230000
092400*        MOVE PV-WORK-DATE2          TO  PH7-PUTAWAY-DT           09240000
092500*        PERFORM 8300-WRITE-BL-INFO                               09250000
092600*    END-IF.                                                      09260000
092700                                                                  09270000
092800     MOVE RV027-DEPT-NBR             TO DL-DEPT-NBR.              09280000
092900     MOVE RV027-SCN-DATE             TO PV-HOLD-SCAN-DATE.        09290000
093000     MOVE PV-HOLD-SCAN-DD            TO PV-WORK-YEAR.             09300000
093100     MOVE PV-HOLD-SCAN-DAY           TO PV-WORK-DAY.              09310000
093200     MOVE PV-HOLD-SCAN-MONTH         TO PV-WORK-MONTH.            09320000
093300     MOVE PV-WORK-DATE               TO DL-SCAN-DATE.             09330000
093400     MOVE RV027-LOC-ID               TO DL-LOC-ID.                09340000
093500     MOVE RV027-SKU                  TO DL-SKU.                   09350000
093600     MOVE RV027-DTL-UNT-QTY          TO DL-QTY.                   09360000
093700     MOVE RV027-DTL-UNT-COST-AMT     TO DL-COST.                  09370000
093800     MOVE RV027-DTL-EXT-UNT-COST-AMT TO DL-EXTEND-COST.           09380000
093900     MOVE RV027-DTL-RTL-COST-AMT     TO DL-RETAIL.                09390000
094000     MOVE RV027-DTL-EXT-RTL-COST-AMT TO DL-EXTEND-RETAIL.         09400000
094100     MOVE RV027-TRNS-NBR-STR         TO PV-HOLD-TRANSFER-STORE    09410000
094200                                        PV-TRANSFER-STORE.        09420000
094300     MOVE RV027-TRNS-NBR             TO PV-HOLD-TRANSFER-NBR      09430000
094400                                        PV-TRANSFER-NBR.          09440000
094500     MOVE PV-TRANSFER                TO DL-TRANSFER.              09450000
094600                                                                  09460000
094700     PERFORM 8500-WRITE-DETAIL-LINE.                              09470000
094800                                                                  09480000
094900******************************************************************09490000
095000* 2200-BL-TOTAL.                                                  09500000
095100*     PROCESS TYPE 2 RECORDS. WRITE BL TOTALS FOR THAT BUYER      09510000
095200******************************************************************09520000
095300 2200-BL-TOTAL.                                                   09530000
095400     MOVE PC-BL-TOTAL               TO TL-TOTAL-DESCRIPTION.      09540000
095500     MOVE RV027-BL-UNT-QTY          TO TL-QTY.                    09550000
095600     MOVE RV027-BL-UNT-COST-AMT     TO TL-TOTAL-COST.             09560000
095700     MOVE RV027-BL-EXT-UNT-COST-AMT TO TL-TOTAL-EXT-COST.         09570000
095800     MOVE RV027-BL-RTL-COST-AMT     TO TL-TOTAL-RETAIL.           09580000
095900     MOVE RV027-BL-EXT-RTL-COST-AMT TO TL-TOTAL-EXT-RETAIL.       09590000
096000     PERFORM 8400-WRITE-TOTAL.                                    09600000
096100                                                                  09610000
096200******************************************************************09620000
096300* 2300-DEPT-TOTAL.                                                09630000
096400*     PROCESS TYPE 3 RECORDS. WRITE DEPT TOTALS FOR THAT BUYER    09640000
096500******************************************************************09650000
096600 2300-DEPT-TOTAL.                                                 09660000
096700     MOVE RV027-DEPT-NBR              TO PV-TOTAL-LINE-DPT.       09670000
096800     MOVE PV-DEPT-TOTAL-LINE          TO TL-TOTAL-DESCRIPTION.    09680000
096900     MOVE RV027-DEPT-UNT-QTY          TO TL-QTY.                  09690000
097000     MOVE RV027-DEPT-UNT-COST-AMT     TO TL-TOTAL-COST.           09700000
097100     MOVE RV027-DEPT-EXT-UNT-COST-AMT TO TL-TOTAL-EXT-COST.       09710000
097200     MOVE RV027-DEPT-RTL-COST-AMT     TO TL-TOTAL-RETAIL.         09720000
097300     MOVE RV027-DEPT-EXT-RTL-COST-AMT TO TL-TOTAL-EXT-RETAIL.     09730000
097400     PERFORM 8400-WRITE-TOTAL.                                    09740000
097500                                                                  09750000
097600******************************************************************09760000
097700* 2400-BUYER-TOTAL.                                               09770000
097800*     PROCESS TYPE 4 RECORDS. WRITE DEPT TOTALS FOR THAT BUYER    09780000
097900******************************************************************09790000
098000 2400-BUYER-TOTAL.                                                09800000
098100     MOVE PC-BUYER-TOTAL               TO TL-TOTAL-DESCRIPTION.   09810000
098200     MOVE RV027-BUYER-UNT-QTY          TO TL-QTY.                 09820000
098300     MOVE RV027-BUYER-UNT-COST-AMT     TO TL-TOTAL-COST.          09830000
098400     MOVE RV027-BUYER-EXT-UNT-COST-AMT TO TL-TOTAL-EXT-COST.      09840000
098500     MOVE RV027-BUYER-RTL-COST-AMT     TO TL-TOTAL-RETAIL.        09850000
098600     MOVE RV027-BUYER-EXT-RTL-COST-AMT TO TL-TOTAL-EXT-RETAIL.    09860000
098700     PERFORM 8400-WRITE-TOTAL.                                    09870000
098800     PERFORM 8900-WRITE-BLANK-LINE.                               09880000
098900                                                                  09890000
099000******************************************************************09900000
099100* 2500-GRAND-TOTAL.                                               09910000
099200*     PROCESS TYPE 5 RECORDS. WRITE GRAND TOTALS AT END OF JOB    09920000
099300******************************************************************09930000
099400 2500-GRAND-TOTAL.                                                09940000
099500     MOVE RV027-GRAND-UNT-QTY          TO GT-QTY.                 09950000
099600     MOVE RV027-GRAND-UNT-COST-AMT     TO GT-TOTAL-COST.          09960000
099700     MOVE RV027-GRAND-EXT-UNT-COST-AMT TO GT-TOTAL-EXT-COST.      09970000
099800     MOVE RV027-GRAND-RTL-COST-AMT     TO GT-TOTAL-RETAIL.        09980000
099900     MOVE RV027-GRAND-EXT-RTL-COST-AMT TO GT-TOTAL-EXT-RETAIL.    09990000
100000     PERFORM 6000-GRAND-TOTAL.                                    10000000
100100                                                                  10010000
100200******************************************************************10020000
100300* 3000-PROCESS-SUMMARY                                            10030000
100400*     PROCESS ALL RECORDS ON INPUT FILE                           10040000
100500******************************************************************10050000
100600 3000-PROCESS-SUMMARY.                                            10060000
100700     INITIALIZE DLS-DETAIL-LINE-SUM.                              10070000
100800                                                                  10080000
100900     EVALUATE TRUE                                                10090000
101000         WHEN RV028-DTL                                           10100000
101100             PERFORM 3100-DTL-LINE-SUM                            10110000
101200         WHEN RV028-DEPT-TOTAL                                    10120000
101300             PERFORM 3300-DEPT-TOTAL-SUM                          10130000
101400         WHEN RV028-BUYER-TOTAL                                   10140000
101500             PERFORM 3400-BUYER-TOTAL-SUM                         10150000
101600         WHEN RV028-GRAND-TOTAL                                   10160000
101700             PERFORM 3500-GRAND-TOTAL-SUM                         10170000
101800     END-EVALUATE.                                                10180000
101900                                                                  10190000
102000     PERFORM 7000-READ-INPUT.                                     10200000
102100                                                                  10210000
102200******************************************************************10220000
102300* 3100-DTL-LINE-SUM                                               10230000
102400*       THIS PARAGRAPH WILL BE PERFORMED TO SET UP THE SUMMARY    10240000
102500*       DETAIL LINE                                               10250000
102600******************************************************************10260000
102700 3100-DTL-LINE-SUM.                                               10270000
102800     IF RV028-BUYER-NBR = PV-PREV-BUYER-NBR                       10280000
102900         CONTINUE                                                 10290000
103000     ELSE                                                         10300000
103100         MOVE RV028-BUYER-NAME TO PH5-BUYER-NAME                  10310000
103200         MOVE RV028-BUYER-NBR  TO PH6-BUYER-NBR                   10320000
103300                                  PV-PREV-BUYER-NBR               10330000
103400         PERFORM 8200-WRITE-BUYER-INFO                            10340000
103500     END-IF.                                                      10350000
103600                                                                  10360000
103700     MOVE RV028-DEPT-NBR             TO DLS-DEPT-NBR.             10370000
103800     MOVE RV028-BL-NBR (24:15)       TO PV-DISPLAY-BL-NBR.        10380000
103900     MOVE PV-DISPLAY-BL-NBR          TO DLS-BL-NBR.               10390000
104000     MOVE RV028-RETURN-TYPE          TO DLS-BL-TYPE               10400000
104100     MOVE RV028-BL-STATUS            TO DLS-BL-STATUS             10410000
104200     MOVE RV028-PUT-AWAY-DATE        TO PV-HOLD-PUTAWAY-DATE      10420000
104300     MOVE PV-HOLD-PUTA-YEAR          TO PV-WORK-YEAR2             10430000
104400     MOVE PV-HOLD-PUTA-MONTH         TO PV-WORK-MONTH2            10440000
104500     MOVE PV-HOLD-PUTA-DAY           TO PV-WORK-DAY2              10450000
104600     MOVE PV-WORK-DATE2              TO DLS-PUTAWAY-DATE          10460000
104700     MOVE RV028-LOC-ID (1:20)        TO DLS-LOC-ID.               10470000
104800     MOVE RV028-DTL-UNT-QTY          TO DLS-QTY.                  10480000
104900     MOVE RV028-DTL-UNT-COST-AMT     TO DLS-COST.                 10490000
105000     MOVE RV028-DTL-EXT-UNT-COST-AMT TO DLS-EXTEND-COST.          10500000
105100     MOVE RV028-DTL-RTL-COST-AMT     TO DLS-RETAIL.               10510000
105200     MOVE RV028-DTL-EXT-RTL-COST-AMT TO DLS-EXTEND-RETAIL.        10520000
105300                                                                  10530000
105400     PERFORM 8800-WRITE-SUM-LINE.                                 10540000
105500                                                                  10550000
105600******************************************************************10560000
105700* 3300-DEPT-TOTAL-SUM                                             10570000
105800*     PROCESS TYPE 3 RECORDS. WRITE DEPT TOTALS FOR THAT BUYER    10580000
105900******************************************************************10590000
106000 3300-DEPT-TOTAL-SUM.                                             10600000
106100     MOVE RV028-DEPT-NBR              TO PV-TOTAL-LINE-DPT.       10610000
106200     MOVE PV-DEPT-TOTAL-LINE          TO TLS-TOTAL-DESCRIPTION.   10620000
106300     MOVE RV028-DEPT-UNT-QTY          TO TLS-QTY.                 10630000
106400     MOVE RV028-DEPT-UNT-COST-AMT     TO TLS-TOTAL-COST.          10640000
106500     MOVE RV028-DEPT-EXT-UNT-COST-AMT TO TLS-TOTAL-EXT-COST.      10650000
106600     MOVE RV028-DEPT-RTL-COST-AMT     TO TLS-TOTAL-RETAIL.        10660000
106700     MOVE RV028-DEPT-EXT-RTL-COST-AMT TO TLS-TOTAL-EXT-RETAIL.    10670000
106800     PERFORM 8400-WRITE-TOTAL.                                    10680000
106900                                                                  10690000
107000******************************************************************10700000
107100* 3400-BUYER-TOTAL-SUM                                            10710000
107200*     PROCESS TYPE 4 RECORDS. WRITE DEPT TOTALS FOR THAT BUYER    10720000
107300******************************************************************10730000
107400 3400-BUYER-TOTAL-SUM.                                            10740000
107500     MOVE PC-BUYER-TOTAL               TO TLS-TOTAL-DESCRIPTION.  10750000
107600     MOVE RV028-BUYER-UNT-QTY          TO TLS-QTY.                10760000
107700     MOVE RV028-BUYER-UNT-COST-AMT     TO TLS-TOTAL-COST.         10770000
107800     MOVE RV028-BUYER-EXT-UNT-COST-AMT TO TLS-TOTAL-EXT-COST.     10780000
107900     MOVE RV028-BUYER-RTL-COST-AMT     TO TLS-TOTAL-RETAIL.       10790000
108000     MOVE RV028-BUYER-EXT-RTL-COST-AMT TO TLS-TOTAL-EXT-RETAIL.   10800000
108100     PERFORM 8400-WRITE-TOTAL.                                    10810000
108200     PERFORM 8900-WRITE-BLANK-LINE.                               10820000
108300                                                                  10830000
108400******************************************************************10840000
108500* 3500-GRAND-TOTAL-SUM                                            10850000
108600*     PROCESS TYPE 5 RECORDS. WRITE GRAND TOTALS AT END OF JOB    10860000
108700******************************************************************10870000
108800 3500-GRAND-TOTAL-SUM.                                            10880000
108900     MOVE RV028-GRAND-UNT-QTY          TO GT-QTY.                 10890000
109000     MOVE RV028-GRAND-UNT-COST-AMT     TO GT-TOTAL-COST.          10900000
109100     MOVE RV028-GRAND-EXT-UNT-COST-AMT TO GT-TOTAL-EXT-COST.      10910000
109200     MOVE RV028-GRAND-RTL-COST-AMT     TO GT-TOTAL-RETAIL.        10920000
109300     MOVE RV028-GRAND-EXT-RTL-COST-AMT TO GT-TOTAL-EXT-RETAIL.    10930000
109400     PERFORM 6000-GRAND-TOTAL.                                    10940000
109500                                                                  10950000
109600******************************************************************10960000
109700* 6000-GRAND-TOTAL.                                               10970000
109800******************************************************************10980000
109900 6000-GRAND-TOTAL.                                                10990000
110000     IF CC-DETAIL-REPORT                                          11000000
110100         PERFORM 8000-WRITE-DETAIL-PAGE-HEAD                      11010000
110200         PERFORM 8100-WRITE-DETAIL-COL-HEAD                       11020000
110300         ADD +2 TO PV-DETAIL-LINE-COUNT                           11030000
110400     ELSE                                                         11040000
110500         PERFORM 8600-WRITE-SUM-PAGE-HEAD                         11050000
110600         PERFORM 8700-WRITE-SUM-COL-HEAD                          11060000
110700         ADD +2 TO PV-SUM-LINE-COUNT                              11070000
110800     END-IF.                                                      11080000
110900                                                                  11090000
111000     WRITE REPORT-LINE                                            11100000
111100         FROM GT-GRAND-TOTAL-HEADER                               11110000
111200         AFTER ADVANCING 2 LINES                                  11120000
111300                                                                  11130000
111400     WRITE REPORT-LINE                                            11140000
111500           FROM GT-GRAND-TOTAL-QTY                                11150000
111600           AFTER ADVANCING 2 LINES.                               11160000
111700                                                                  11170000
111800     WRITE REPORT-LINE                                            11180000
111900           FROM GT-GRAND-TOTAL-COST                               11190000
112000           AFTER ADVANCING 2 LINES.                               11200000
112100                                                                  11210000
112200     WRITE REPORT-LINE                                            11220000
112300           FROM GT-GRAND-TOTAL-EXT-COST                           11230000
112400           AFTER ADVANCING 2 LINES.                               11240000
112500                                                                  11250000
112600     WRITE REPORT-LINE                                            11260000
112700           FROM GT-GRAND-TOTAL-RETAIL                             11270000
112800           AFTER ADVANCING 2 LINES.                               11280000
112900                                                                  11290000
113000     WRITE REPORT-LINE                                            11300000
113100           FROM GT-GRAND-TOTAL-EXT-RETAIL                         11310000
113200           AFTER ADVANCING 2 LINES.                               11320000
113300                                                                  11330000
113400******************************************************************11340000
113500* 7000-READ-INPUT                                                 11350000
113600******************************************************************11360000
113700 7000-READ-INPUT.                                                 11370000
113800     IF CC-DETAIL-REPORT                                          11380000
113900         READ INVENTORY-FILE INTO RV027-INV-DTL-RPT-PREP-REC      11390000
114000              AT END SET PS-EOF TO TRUE                           11400000
114100              NOT AT END ADD 1 TO PV-REC-READ                     11410000
114200         END-READ                                                 11420000
114300     ELSE                                                         11430000
114400         READ INVENTORY-FILE INTO RV028-INV-SUM-RPT-PREP-REC      11440000
114500              AT END SET PS-EOF TO TRUE                           11450000
114600              NOT AT END ADD 1 TO PV-REC-READ                     11460000
114700         END-READ                                                 11470000
114800     END-IF.                                                      11480000
114900                                                                  11490000
115000******************************************************************11500000
115100* 8000-WRITE-PAGE-HEADING - WRITE THE PAGE AND DETAIL HEADINGS FOR11510000
115200* THE DEFECTIVE ITEM DETAIL REPORT.                               11520000
115300******************************************************************11530000
115400 8000-WRITE-DETAIL-PAGE-HEAD.                                     11540000
115500     ADD 1                     TO PV-DETAIL-PAGE-COUNT.           11550000
115600     MOVE 1                    TO DP132-REPORT-NUMBER.            11560000
115700     MOVE PV-DETAIL-PAGE-COUNT TO DP132-PAGE-NUMBER.              11570000
115800                                                                  11580000
115900     WRITE REPORT-LINE                                            11590000
116000         FROM DP132-STANDRD-HEADER-132-COLS                       11600000
116100         AFTER ADVANCING PAGE.                                    11610000
116200     INITIALIZE REPORT-LINE.                                      11620000
116300     WRITE REPORT-LINE                                            11630000
116400         FROM PH2-PAGE-HEADING-2                                  11640000
116500         AFTER ADVANCING 1 LINES.                                 11650000
116600     INITIALIZE REPORT-LINE.                                      11660000
116700     WRITE REPORT-LINE                                            11670000
116800         FROM PH3-PAGE-HEADING-3                                  11680000
116900         AFTER ADVANCING 1 LINES.                                 11690000
117000     WRITE REPORT-LINE                                            11700000
117100         FROM BLANK-LINE                                          11710000
117200         AFTER ADVANCING 1 LINES.                                 11720000
117300                                                                  11730000
117400     MOVE +4                   TO PV-DETAIL-LINE-COUNT.           11740000
117500                                                                  11750000
117600******************************************************************11760000
117700* 8100-WRITE-DETAIL-COL-HEAD - WRITE THE COLUMN HEADINGS FOR     *11770000
117800* THE DEFECTIVE ITEM REPORT.                                     *11780000
117900******************************************************************11790000
118000 8100-WRITE-DETAIL-COL-HEAD.                                      11800000
118100     WRITE REPORT-LINE                                            11810000
118200         FROM DH1-DETAIL-HEADING-1                                11820000
118300         AFTER ADVANCING 2 LINES.                                 11830000
118400                                                                  11840000
118500     WRITE REPORT-LINE                                            11850000
118600         FROM DH2-DETAIL-HEADING-2                                11860000
118700         AFTER ADVANCING 1 LINES.                                 11870000
118800                                                                  11880000
118900     WRITE REPORT-LINE                                            11890000
119000         FROM DH3-DETAIL-HEADING-3                                11900000
119100         AFTER ADVANCING 0 LINES.                                 11910000
119200                                                                  11920000
119300     WRITE REPORT-LINE                                            11930000
119400         FROM BLANK-LINE                                          11940000
119500         AFTER ADVANCING 1 LINES.                                 11950000
119600                                                                  11960000
119700     ADD +4 TO PV-DETAIL-LINE-COUNT.                              11970000
119800                                                                  11980000
119900******************************************************************11990000
120000* 8200-WRITE-BUYER-INFO                                          *12000000
120100******************************************************************12010000
120200 8200-WRITE-BUYER-INFO.                                           12020000
120300     IF CC-DETAIL-REPORT                                          12030000
120400         IF PV-DETAIL-LINE-COUNT > PC-MAX-REPORT-LINES            12040000
120500             PERFORM 8000-WRITE-DETAIL-PAGE-HEAD                  12050000
120600             PERFORM 8100-WRITE-DETAIL-COL-HEAD                   12060000
120700             ADD +2 TO PV-DETAIL-LINE-COUNT                       12070000
120800         END-IF                                                   12080000
120900     ELSE                                                         12090000
121000         IF PV-SUM-LINE-COUNT > PC-MAX-REPORT-LINES               12100000
121100             PERFORM 8600-WRITE-SUM-PAGE-HEAD                     12110000
121200             PERFORM 8700-WRITE-SUM-COL-HEAD                      12120000
121300             ADD +2 TO PV-SUM-LINE-COUNT                          12130000
121400         END-IF                                                   12140000
121500     END-IF                                                       12150000
121600                                                                  12160000
121700     WRITE REPORT-LINE                                            12170000
121800         FROM PH5-PAGE-HEADING-5                                  12180000
121900         AFTER ADVANCING 1 LINES                                  12190000
122000                                                                  12200000
122100     WRITE REPORT-LINE                                            12210000
122200         FROM PH6-PAGE-HEADING-6                                  12220000
122300         AFTER ADVANCING 1 LINES.                                 12230000
122400                                                                  12240000
122500******************************************************************12250000
122600* 8300-WRITE-BL-INFO                                              12260000
122700******************************************************************12270000
122800 8300-WRITE-BL-INFO.                                              12280000
122900     IF PV-DETAIL-LINE-COUNT > PC-MAX-REPORT-LINES                12290000
123000         PERFORM 8000-WRITE-DETAIL-PAGE-HEAD                      12300000
123100         PERFORM 8100-WRITE-DETAIL-COL-HEAD                       12310000
123200     END-IF.                                                      12320000
123300                                                                  12330000
123400     WRITE REPORT-LINE                                            12340000
123500         FROM PH7-PAGE-HEADING-7                                  12350000
123600         AFTER ADVANCING 2 LINES.                                 12360000
123700                                                                  12370000
123800     WRITE REPORT-LINE                                            12380000
123900         FROM BLANK-LINE                                          12390000
124000         AFTER ADVANCING 1 LINES.                                 12400000
124100                                                                  12410000
124200     ADD +4                   TO PV-DETAIL-LINE-COUNT.            12420000
124300                                                                  12430000
124400******************************************************************12440000
124500* 8400-WRITE-TOTAL                                                12450000
124600******************************************************************12460000
124700 8400-WRITE-TOTAL.                                                12470000
124800     IF CC-DETAIL-REPORT                                          12480000
124900         IF PV-DETAIL-LINE-COUNT > PC-MAX-REPORT-LINES            12490000
125000             PERFORM 8000-WRITE-DETAIL-PAGE-HEAD                  12500000
125100             PERFORM 8100-WRITE-DETAIL-COL-HEAD                   12510000
125200         END-IF                                                   12520000
125300         WRITE REPORT-LINE                                        12530000
125400             FROM TL-TOTAL-LINE                                   12540000
125500             AFTER ADVANCING 2 LINES                              12550000
125600             ADD +2 TO PV-DETAIL-LINE-COUNT                       12560000
125700     ELSE                                                         12570000
125800         IF PV-SUM-LINE-COUNT > PC-MAX-REPORT-LINES               12580000
125900             PERFORM 8600-WRITE-SUM-PAGE-HEAD                     12590000
126000             PERFORM 8700-WRITE-SUM-COL-HEAD                      12600000
126100         END-IF                                                   12610000
126200         WRITE REPORT-LINE                                        12620000
126300             FROM TLS-TOTAL-LINE-SUM                              12630000
126400             AFTER ADVANCING 2 LINES                              12640000
126500             ADD +2 TO PV-SUM-LINE-COUNT                          12650000
126600     END-IF.                                                      12660000
126700                                                                  12670000
126800******************************************************************12680000
126900* 8500-WRITE-DETAIL-LINE - CHECKS IF THE PAGE SIZE HAS BEEN EX-   12690000
127000* CEEDED.  IF SO, THE HEADING LINES ARE WRITTEN AND THE LINE COUNT12700000
127100* INITIALIZED.  THE DETAIL LINE IS THEN WRITTEN.                  12710000
127200******************************************************************12720000
127300 8500-WRITE-DETAIL-LINE.                                          12730000
127400     IF PV-DETAIL-LINE-COUNT > PC-MAX-REPORT-LINES                12740000
127500         PERFORM 8000-WRITE-DETAIL-PAGE-HEAD                      12750000
127600         PERFORM 8100-WRITE-DETAIL-COL-HEAD                       12760000
127700     END-IF.                                                      12770000
127800                                                                  12780000
127900     WRITE REPORT-LINE                                            12790000
128000         FROM DL-DETAIL-LINE                                      12800000
128100         AFTER ADVANCING 1 LINES.                                 12810000
128200                                                                  12820000
128300     ADD +1 TO PV-DETAIL-LINE-COUNT.                              12830000
128400                                                                  12840000
128500******************************************************************12850000
128600* 8600-WRITE-SUM-PAGE-HEAD                                        12860000
128700******************************************************************12870000
128800 8600-WRITE-SUM-PAGE-HEAD.                                        12880000
128900     ADD 1                     TO PV-SUM-PAGE-COUNT.              12890000
129000     MOVE 2                    TO DP132-REPORT-NUMBER             12900000
129100     MOVE PV-SUM-PAGE-COUNT    TO DP132-PAGE-NUMBER.              12910000
129200                                                                  12920000
129300     WRITE REPORT-LINE                                            12930000
129400         FROM DP132-STANDRD-HEADER-132-COLS                       12940000
129500         AFTER ADVANCING PAGE.                                    12950000
129600                                                                  12960000
129700         WRITE REPORT-LINE                                        12970000
129800             FROM PH2-PAGE-HEADING-2-SUM                          12980000
129900         AFTER ADVANCING 1 LINES                                  12990000
130000                                                                  13000000
130100     WRITE REPORT-LINE                                            13010000
130200         FROM PH3-PAGE-HEADING-3                                  13020000
130300         AFTER ADVANCING 1 LINES.                                 13030000
130400                                                                  13040000
130500     WRITE REPORT-LINE                                            13050000
130600         FROM BLANK-LINE                                          13060000
130700         AFTER ADVANCING 1 LINES.                                 13070000
130800                                                                  13080000
130900     MOVE +4                   TO PV-SUM-LINE-COUNT.              13090000
131000                                                                  13100000
131100******************************************************************13110000
131200* 8700-WRITE-SUM-COL-HEAD                                         13120000
131300******************************************************************13130000
131400 8700-WRITE-SUM-COL-HEAD.                                         13140000
131500     WRITE REPORT-LINE                                            13150000
131600         FROM DH1-DETAIL-HEADING-1-SUM                            13160000
131700         AFTER ADVANCING 2 LINES.                                 13170000
131800                                                                  13180000
131900     WRITE REPORT-LINE                                            13190000
132000        FROM DH2-DETAIL-HEADING-2-SUM                             13200000
132100        AFTER ADVANCING 1 LINES.                                  13210000
132200                                                                  13220000
132300     WRITE REPORT-LINE                                            13230000
132400         FROM DH3-DETAIL-HEADING-3-SUM                            13240000
132500         AFTER ADVANCING 0 LINES.                                 13250000
132600                                                                  13260000
132700     WRITE REPORT-LINE                                            13270000
132800         FROM BLANK-LINE                                          13280000
132900         AFTER ADVANCING 1 LINES.                                 13290000
133000                                                                  13300000
133100     ADD +4      TO PV-SUM-LINE-COUNT.                            13310000
133200                                                                  13320000
133300******************************************************************13330000
133400* 8800-WRITE-SUM-LINE                                             13340000
133500******************************************************************13350000
133600 8800-WRITE-SUM-LINE.                                             13360000
133700     IF PV-SUM-LINE-COUNT > PC-MAX-REPORT-LINES                   13370000
133800         PERFORM 8600-WRITE-SUM-PAGE-HEAD                         13380000
133900         PERFORM 8700-WRITE-SUM-COL-HEAD                          13390000
134000     END-IF.                                                      13400000
134100                                                                  13410000
134200     WRITE REPORT-LINE                                            13420000
134300         FROM DLS-DETAIL-LINE-SUM                                 13430000
134400         AFTER ADVANCING 1 LINES.                                 13440000
134500                                                                  13450000
134600     ADD +1      TO PV-SUM-LINE-COUNT.                            13460000
134700                                                                  13470000
134800******************************************************************13480000
134900* 8900-WRITE-BLANK-LINE - WRITES A BLANK LINE TO THE REPORT.     *13490000
135000******************************************************************13500000
135100 8900-WRITE-BLANK-LINE.                                           13510000
135200     WRITE REPORT-LINE                                            13520000
135300         FROM BLANK-LINE                                          13530000
135400         AFTER ADVANCING 1 LINES.                                 13540000
135500                                                                  13550000
135600     IF CC-DETAIL-REPORT                                          13560000
135700         ADD +1      TO PV-DETAIL-LINE-COUNT                      13570000
135800     ELSE                                                         13580000
135900         ADD +1      TO PV-SUM-LINE-COUNT                         13590000
136000     END-IF.                                                      13600000
136100                                                                  13610000
136200******************************************************************13620000
136300* 9000-EOJ-ROUTINE - PRINTS A GRAND TOTAL, AND CLOSES THE DRIVER  13630000
136400* CURSOR AND THE REPORT FILE.                                     13640000
136500******************************************************************13650000
136600 9000-EOJ-ROUTINE.                                                13660000
136700     WRITE REPORT-LINE                                            13670000
136800         FROM END-OF-REPORT-LINE                                  13680000
136900         AFTER ADVANCING 3 LINES                                  13690000
137000                                                                  13700000
137100     DISPLAY '**********  END OF RVKRP024 ***********'            13710000
137200     DISPLAY '********** RECORDS READ: ' PV-REC-READ              13720000
137300                                                                  13730000
137400     CLOSE INVENTORY-FILE                                         13740000
137500           REPORT-FILE.                                           13750000
137600                                                                  13760000
137700******************************************************************13770000
137800* 9999-SQL-ABEND - PERFORMS THE ABEND FOR THE PROGRAM IN THE *    13780000
137900* EVENT THAT AN SQL ERROR OR WARNING CODE OCCURS. *               13790000
138000******************************************************************13800000
138100 9999-SQL-ABEND.                                                  13810000
138200     DISPLAY '** ABEND     **'.                                   13820000
138300     DISPLAY '** PROGRAM   ** = RVKRP024'.                        13830000
138400     DISPLAY '** PARAGRAPH ** = ' PV-PARAGRAPH-NAME.              13840000
138500     DISPLAY '** OPERATION ** = ' PV-DB2-OPERATION-ATTEMPTED.     13850000
138600                                                                  13860000
138700******************************************************************13870000
138800* THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION STATE-   *13880000
138900* MENTS THAT ARE REQUIRED TO UTILIZE THE DB2 ABEND MODULE        *13890000
139000* 'DSNTIAR' AND CONVERT THE SQLCA INFORMATION INTO A READABLE    *13900000
139100* FORMAT.                                                        *13910000
139200******************************************************************13920000
139300     COPY DPPD004.                                                13930000
139400                                                                  13940000
139500     MOVE +4013 TO ABEND-CODE.                                    13950000
139600     CALL 'ILBOABN0' USING ABEND-CODE.                            13960000
139700****************************  END OF RVKRP024 ********************13970000
