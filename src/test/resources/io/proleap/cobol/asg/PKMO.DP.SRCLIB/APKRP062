000100 IDENTIFICATION DIVISION.                                         00000157
000200 PROGRAM-ID.     APKRP062.                                        00000257
000300 AUTHOR.         MIKE BESKE.                                      00000357
000400 DATE-WRITTEN.   JUNE 1997.                                       00000457
000500 DATE-COMPILED.                                                   00000557
000600*************************************************************     00000657
000700*    COBOL 2                                                *     00000757
000800*                                                           *     00000857
000900*    IMPORT ELC ERROR REPORT                                *     00000957
001000*                    APKRP062                               *     00001057
001100*                                                           *     00001157
001200*   PROGRAM OVERVIEW:                                       *     00001257
001300*     THIS PROGRAM GENERATES A DAILY REPORT FOR POS THAT ARE*     00001357
001400*   FOUND DURING AP PROCESSING THAT HAVE NO ELCS LOADED, OR *     00001457
001500*   ARE MISSING ELCS FOR PO LINES.  THIS ERROR REPORT WILL  *     00001557
001600*   BE USED FOR FOLLOWUP TO ENSURE THAT ELCS ARE PROPERLY   *     00001657
001700*   LOADED.                                                 *     00001757
001800*                                                           *     00001857
001900*   INPUT:                                                  *     00001957
002000*     I. ELC ERROR FILE SORTED BY VENDOR NAME/PO NUMBER/PO  *     00002057
002100*        LINE NUMBER.  COPYBOOK IS APRD035.                 *     00002157
002200*                                                           *     00002257
002300*   OUTPUT:                                                 *     00002357
002400*     I. IMPORT ELC ERROR REPORT                            *     00002457
002500*        EACH RECORD ON THE INPUT FILE WILL BE USED TO      *     00002557
002600*        CREATE A DETAIL LINE ON THE REPORT.  EACH DETAIL   *     00002657
002700*        LINE WILL SHOW THE VENDOR NAME, PO NUMBER, PO LINE *     00002757
002800*        NUMBER AND ERROR DESCRIPTION.  THE PO LINE NUMBER  *     00002857
002900*        WILL BE BLANK FOR ERROR CODE 01 AND 03.  THE ERROR *     00002957
003000*        MESSAGES THAT WILL BE DISPLAYED ARE AS FOLLOWS:    *     00003057
003100*        CODE 01 - 'NO ESTIMATES FOUND FOR THIS PO.'        *     00003157
003200*        CODE 02 - 'NO ESTIMATES FOUND FOR THIS PO LINE.    *     00003257
003300*        CODE 03 - 'NO ESTIMATES FOUND WHILE PROCESSING     *     00003357
003400*                   INVOICES FOR THIS PO.'                  *     00003457
003500*                                                           *     00003557
003600*************************************************************     00003657
003700* CHANGE LOG:                                              *      00003757
003800*   /  /   - DESC                                          *      00003857
003900*        BY: NAME                           PITS/WR #      *      00003957
004000*************************************************************     00004057
004100                                                                          
004200 EJECT                                                            02380051
004300 ENVIRONMENT DIVISION.                                            00004257
004400 CONFIGURATION SECTION.                                           00004357
004500 SOURCE-COMPUTER.    IBM-3090.                                    00004457
004600 OBJECT-COMPUTER.    IBM-3090.                                    00004557
004700                                                                  00004657
004800                                                                  00004757
004900 INPUT-OUTPUT SECTION.                                            00004857
005000 FILE-CONTROL.                                                    00004957
005100     SELECT ELC-ERROR-FILE    ASSIGN TO UT-S-INP01.               00005057
005200     SELECT REPORT-FILE       ASSIGN TO UT-S-RPT01.                     51
005300*                                                                 00005257
005400 DATA DIVISION.                                                   00005357
005500 FILE SECTION.                                                    00005457
005600 FD  ELC-ERROR-FILE                                               00005557
005700     RECORDING MODE IS F                                          00005657
005800     LABEL RECORDS ARE STANDARD                                   00005757
005900     BLOCK CONTAINS 0 RECORDS                                     00005857
006000     DATA RECORD IS ELC-ERROR-RECORD.                             00005957
006100 01  ELC-ERROR-RECORD            PIC  X(80).                      00006057
006200                                                                  00006157
006300 FD  REPORT-FILE                                                  00320051
006400     RECORDING MODE IS F                                          00330051
006500     LABEL RECORDS ARE STANDARD                                   00340051
006600     BLOCK CONTAINS 0 RECORDS                                     00350051
006700     DATA RECORD IS REPORT-RECORD.                                00360051
006800 01  REPORT-RECORD               PIC X(132).                      00370053
006900                                                                  00380051
007000 EJECT                                                            00390051
007100 WORKING-STORAGE SECTION.                                         00400051
007200 01  PROGRAM-WORKAREA.                                            APKRP263
007300     05  FILLER                      PIC  X(30) VALUE             APKRP263
007400             '** BEGINING OF APKRP062 W/S **'.                    APKRP263
007500     05  PW-CURRENT-PARAGRAPH         PIC  X(30).                 APKRP263
007600                                                                  00410051
007700 01  PROGRAM-VARIABLES.                                           00420051
007800     05  PV-PROGRAM-NAME         PIC  X(08)  VALUE 'APKRP062'.    00430051
007900     05  PV-CURRENT-DATE.                                         00440051
008000         10  PV-CURRENT-YEAR     PIC  9(02)  VALUE ZEROS.         00450051
008100         10  PV-CURRENT-MONTH    PIC  9(02)  VALUE ZEROS.         00460051
008200         10  PV-CURRENT-DAY      PIC  9(02)  VALUE ZEROS.         00470051
008300     05  PV-CURRENT-TIME.                                         00480051
008400         10  PV-CURRENT-HOUR     PIC  9(02)  VALUE ZEROS.         00490051
008500         10  PV-CURRENT-MINUTE   PIC  9(02)  VALUE ZEROS.         00500051
008600         10  FILLER              PIC  9(02)  VALUE ZEROS.         00510051
008700     05  PV-MAX-LINES            PIC S9(03)  VALUE +60            00520051
008800                                             COMP-3.              00530051
008900     05  PV-LINE-COUNT           PIC S9(03)  VALUE +99            00540051
009000                                             COMP-3.              00550051
009100     05  PV-PAGE-COUNT           PIC S9(05)  VALUE ZEROS          00560051
009200                                             COMP-3.              00570051
009300     05  PV-PO-LNE-NBR.                                           00560051
009400         10  FILLER              PIC  X(06)  VALUE SPACES.        00490051
009500         10  PV-PO-LNE-NBR-3X    PIC  X(03)  VALUE SPACES.        00500051
009600                                                                  00661053
009700 01  PROGRAM-SWITCHES.                                            00670053
009800     05  EOF-SW                  PIC  X      VALUE 'N'.           00670053
009900         88  ELC-EOF                         VALUE 'Y'.           00680053
010000     05  ELC-DATA-SW             PIC  X      VALUE 'N'.           00670053
010100         88  NO-ELC-DATA                     VALUE 'Y'.           00680053
010200                                                                  00670053
010300 01  ERROR-DESCRIPTIONS.                                          00700053
010400     05  ERROR-1                 PIC  X(57)  VALUE                00710053
010500     'NO ESTIMATES FOUND FOR THIS PO.                          '.       53
010600     05  ERROR-2                 PIC  X(57)  VALUE                00730053
010700     'NO ESTIMATES FOUND FOR THIS PO LINE.                     '.       53
010800     05  ERROR-3                 PIC  X(57)  VALUE                00750053
010900     'NO ESTIMATES FOUND WHILE PROCESSING INVOICES FOR THIS PO.'. 00760053
011000                                                                          
011100 01  NO-DATA-DESCRIPTION.                                         00770051
011200     05  FILLER                  PIC  X(43)  VALUE                00710053
011300             'THERE IS NO DATA TO REPORT ON FOR THIS RUN.'.             53
011400     05  FILLER                  PIC  X(89)  VALUE SPACES.        00710053
011500                                                                          
011600 EJECT                                                            00780051
011700*  INPUT RECORD LAYOUT - IMPORT ELC ERROR RECORDS                 00790053
011800     COPY APRD035.                                                00800053
011900                                                                  00810051
012000 EJECT                                                            00860051
012100*----------------------------------------------------------------*00870051
012200*  STANDARD HEADER LAYOUT                                        *00880051
012300*----------------------------------------------------------------*00890051
012400     COPY DPWS132O.                                               00900051
012500                                                                  00910051
012600 EJECT                                                            00920051
012700 01  H2-HEADER2.                                                  00940051
012800     05  FILLER                  PIC   X(54) VALUE SPACES.        00950053
012900     05  FILLER                  PIC   X(23) VALUE                00960053
013000         'IMPORT ELC ERROR REPORT'.                                     53
013100     05  FILLER                  PIC   X(55) VALUE SPACES.        00980053
013200                                                                  00990051
013300 01  DH-DETAIL-HEADER1.                                           01000051
013400     05  FILLER                  PIC   X(06) VALUE 'VENDOR'.      01070053
013500     05  FILLER                  PIC   X(26) VALUE SPACES.        01080053
013600     05  FILLER                  PIC   X(02) VALUE 'PO'.                53
013700     05  FILLER                  PIC   X(11) VALUE SPACES.        01020053
013800     05  FILLER                  PIC   X(07) VALUE 'PO LINE'.     01050053
013900     05  FILLER                  PIC   X(02) VALUE SPACES.        01060053
014000     05  FILLER                  PIC   X(05) VALUE 'ERROR'.       01030053
014100     05  FILLER                  PIC   X(78) VALUE SPACES.        01100053
014200                                                                  01180051
014300 01  DH-DETAIL-HEADER2.                                           01190051
014400     05  FILLER                  PIC   X(04) VALUE 'NAME'.        01260053
014500     05  FILLER                  PIC   X(28) VALUE SPACES.        01270053
014600     05  FILLER                  PIC   X(06) VALUE 'NUMBER'.      01240053
014700     05  FILLER                  PIC   X(07) VALUE SPACES.        01200053
014800     05  FILLER                  PIC   X(06) VALUE 'NUMBER'.      01240053
014900     05  FILLER                  PIC   X(03) VALUE SPACES.        01250053
015000     05  FILLER                  PIC   X(11) VALUE 'DESCRIPTION'.       53
015100     05  FILLER                  PIC   X(67) VALUE SPACES.        01290053
015200                                                                  01440051
015300 01  DL-DETAIL-LINE.                                              01450053
015400     05  DL-VENDOR-NAME          PIC   X(30) VALUE SPACES.        01530053
015500     05  FILLER                  PIC   X(02) VALUE SPACES.        01540053
015600     05  DL-PO-NBR               PIC   X(09) VALUE SPACES.        01460053
015700     05  FILLER                  PIC   X(06) VALUE SPACES.        01470053
015800     05  DL-PO-LNE-NBR           PIC   X(03) VALUE SPACES.        01510053
015900     05  FILLER                  PIC   X(04) VALUE SPACES.        01520053
016000     05  DL-ERROR-DESCRIPTION    PIC   X(57) VALUE SPACES.        01480053
016100     05  FILLER                  PIC   X(21) VALUE SPACES.        01570053
016200                                                                          
016300 01  EOR-END-OF-REPORT.                                           APKRP263
016400     05  FILLER                  PIC  X(52)  VALUE SPACES.        APKRP263
016500     05  FILLER                  PIC  X(80)  VALUE                APKRP263
016600         '*****  END OF REPORT *****'.                            APKRP263
016700                                                                  APKRP263
016800 01  FILLER                      PIC  X(25)  VALUE                02360051
016900         '** END OF APKRP062 W/S **'.                             02370051
017000                                                                          
017100 EJECT                                                            02380051
017200 PROCEDURE DIVISION.                                              02390051
017300 A100-MAIN.                                                       02400051
017400                                                                  02410051
017500     PERFORM B100-INITIALIZE.                                     02420051
017600                                                                          
017700     IF NO-ELC-DATA                                                       
017800        PERFORM N100-NO-DATA                                              
017900     ELSE                                                                 
018000        PERFORM B200-PROCESS-DATA UNTIL ELC-EOF                   02430051
018100     END-IF.                                                              
018200                                                                          
018300     PERFORM B300-END.                                            02440053
018400     GOBACK.                                                      02450051
018500                                                                          
018600 EJECT                                                            02460051
018700*----------------------------------------------------------------*02470051
018800*    INITIALIZATION PROCESSING                                   *02480051
018900*----------------------------------------------------------------*02490051
019000 B100-INITIALIZE.                                                 02500051
019100                                                                  02510051
019200     OPEN INPUT  ELC-ERROR-FILE                                   02520051
019300          OUTPUT REPORT-FILE.                                     02530051
019400                                                                  02540051
019500     ACCEPT PV-CURRENT-DATE FROM DATE.                            02550051
019600     MOVE PV-CURRENT-MONTH            TO DP132O-RUN-MONTH.        02560051
019700     MOVE PV-CURRENT-DAY              TO DP132O-RUN-DAY.          02570051
019800     MOVE PV-CURRENT-YEAR             TO DP132O-RUN-YEAR.         02580051
019900                                                                  02590051
020000     ACCEPT PV-CURRENT-TIME FROM TIME.                            02600051
020100     MOVE PV-CURRENT-HOUR             TO DP132O-RUN-HOUR.         02610051
020200     MOVE PV-CURRENT-MINUTE           TO DP132O-RUN-MINUTE.       02620051
020300     MOVE PV-PROGRAM-NAME             TO DP132O-PROGRAM-NAME.     02630051
020400     MOVE 1                           TO DP132O-REPORT-NUMBER.    02640051
020500                                                                  02650051
020600     PERFORM R100-READ-ELC-ERROR-FILE.                                  51
020700                                                                  02670051
020800     IF ELC-EOF THEN                                                      
020900        SET NO-ELC-DATA TO TRUE                                           
021000     END-IF.                                                              
021100                                                                          
021200 EJECT                                                            02680051
021300 B200-PROCESS-DATA.                                               02690051
021400                                                                  02700051
021500     PERFORM M100-MOVE-DATA.                                      02760053
021600     PERFORM W100-WRITE-DETAIL-LINE.                              02760053
021700     PERFORM R100-READ-ELC-ERROR-FILE.                                  53
021800                                                                  02960051
021900 EJECT                                                            02970051
022000 B300-END.                                                        02980053
022100                                                                  02990051
022200     MOVE SPACES TO REPORT-RECORD.                                04431053
022300     WRITE REPORT-RECORD AFTER 1.                                 04432053
022400     WRITE REPORT-RECORD FROM EOR-END-OF-REPORT AFTER 2.          APKRP263
022500                                                                          
022600     CLOSE ELC-ERROR-FILE                                         03000051
022700           REPORT-FILE.                                           03010051
022800                                                                  03020051
022900 EJECT                                                            03030051
023000 M100-MOVE-DATA.                                                  03050051
023100                                                                          
023200     MOVE AP035-VENDOR-NAME      TO DL-VENDOR-NAME.               02740053
023300     MOVE AP035-PO-NBR           TO DL-PO-NBR.                    02710053
023400                                                                          
023500     EVALUATE TRUE                                                        
023600         WHEN AP035-NO-ELC-FOR-PO                                         
023700             MOVE ERROR-1 TO DL-ERROR-DESCRIPTION                         
023800         WHEN AP035-NO-ELC-FOR-LINE                                       
023900             MOVE AP035-PO-LNE-NBR TO PV-PO-LNE-NBR               02730053
024000             MOVE PV-PO-LNE-NBR-3X TO DL-PO-LNE-NBR               02730053
024100             MOVE ERROR-2 TO DL-ERROR-DESCRIPTION                         
024200         WHEN AP035-NO-ELC-FOR-ALC                                        
024300             MOVE ERROR-3 TO DL-ERROR-DESCRIPTION                         
024400     END-EVALUATE.                                                        
024500                                                                  03020051
024600 EJECT                                                            03030051
024700 N100-NO-DATA.                                                    03050051
024800                                                                          
024900     PERFORM W300-WRITE-HEADING.                                  03250053
025000     WRITE REPORT-RECORD FROM NO-DATA-DESCRIPTION AFTER 2.        04430053
025100                                                                          
025200 EJECT                                                            03030051
025300 R100-READ-ELC-ERROR-FILE.                                        03050051
025400                                                                  03060051
025500     READ ELC-ERROR-FILE INTO AP035-RECORD                        03070051
025600         AT END SET ELC-EOF TO TRUE.                              03080051
025700                                                                  03090051
025800 EJECT                                                            03100051
025900 W100-WRITE-DETAIL-LINE.                                          03220053
026000                                                                  03230051
026100     IF PV-LINE-COUNT > PV-MAX-LINES                              03240051
026200         PERFORM W300-WRITE-HEADING                               03250053
026300     END-IF.                                                      03260051
026400                                                                  03550051
026500     WRITE REPORT-RECORD FROM DL-DETAIL-LINE AFTER 1.             03560053
026600     INITIALIZE DL-DETAIL-LINE.                                   03570053
026700                                                                  03580051
026800     ADD 1  TO PV-LINE-COUNT.                                     03590051
026900                                                                  03600051
027000 EJECT                                                            04120051
027100 W300-WRITE-HEADING.                                              04470053
027200                                                                  04480051
027300     ADD 1                            TO PV-PAGE-COUNT.           04490051
027400     MOVE PV-PAGE-COUNT               TO DP132O-PAGE-NUMBER.      04500051
027500                                                                  04510051
027600     WRITE REPORT-RECORD FROM                                     04520053
027700                   DP132O-STANDRD-HEADER-132-COLS AFTER PAGE.     04530051
027800     WRITE REPORT-RECORD FROM H2-HEADER2 AFTER 1.                 04540053
027900     WRITE REPORT-RECORD FROM DH-DETAIL-HEADER1 AFTER 2.          04550053
028000     WRITE REPORT-RECORD FROM DH-DETAIL-HEADER2 AFTER 1.          04560053
028100     MOVE SPACES TO REPORT-RECORD.                                        
028200     WRITE REPORT-RECORD AFTER 1.                                       53
028300     MOVE 6  TO PV-LINE-COUNT.                                    04590053
