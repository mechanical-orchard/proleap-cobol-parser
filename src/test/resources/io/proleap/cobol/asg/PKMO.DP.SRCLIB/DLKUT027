000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.    DLKUT027.                                         00020000
000300 AUTHOR.        DENISE HAHN.                                              
000400                                                                  00040000
000500 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00050000
000600 DATE-WRITTEN.  OCTOBER 2007.                                     00060000
000700 DATE-COMPILED.                                                   00070000
000800                                                                  00080000
000900 ENVIRONMENT DIVISION.                                            00090000
001000 CONFIGURATION SECTION.                                           00100000
001100 SOURCE-COMPUTER. IBM-3090.                                       00110000
001200 OBJECT-COMPUTER. IBM-3090.                                       00120000
001300                                                                  00130000
001400****************************************************************  00180018
001510*  NOTE: THERE IS A CICS VERSION OF THIS PROGRAM CALLED        *          
001520*        DLKUT006.  ANY CHANGES MADE TO THIS PROGRAM           *          
001530*        SHOULD ALSO BE MADE IN THE BATCH VERSION.             *          
001600****************************************************************  00180018
001700*    COMMAREA INCLUDE - DLWS023                                *  00190018
001800*                                                              *  00200018
001900*    CALLED ONLY WHEN SHIPPING ASSIGNMENTS ARE BEING CLOSED.   *  00210016
002000*        THIS PROGRAM WILL TAKE THE DOOR GROUP TEMPLATE ID     *  00220016
002100*        AND GENERATE A SHIPPING DOOR SUMMARY BUSINESS EVENT   *  00230016
002200*        (PCT00011 OR SUT00037) FOR EVERY DOOR WITHIN THE      *  00240016
002300*        DOOR GROUP TEMPLATE ID.                               *  00250016
002400*                                                              *  00260016
002500*    CALLED BY:                                                *  00270001
002600*        DLKUP002 - ADD OR END ASSOCIATES RELATIONSHIP TO AN   *  00280016
002700*                   ASSIGNMENT.                                *  00290016
002800*        DLKUP003 - CREATE, COPY, AND / OR END ASSIGNMENTS.    *  00300016
002900*                                                              *  00310016
003000*    CALLS:                                                    *  00320016
003100*        XLKUP033 - INSERTS BUSINESS EVENTS                    *  00330016
003200*                                                              *  00340000
003300*                                                              *  00370000
003400*  DB2 ACCESS:                                                 *  00380000
003500*    DLT_DOOR_GP_TMPL (DLT00000) TABLE (DOOR GROUP TEMPLATE)   *  00390029
003600*               SELECTS                                        *  00400000
003700*                                                              *  00410000
003800*    DLT_DOOR_GP (DLT00001) TABLE (DOOR GROUP)                 *  00420029
003900*               SELECTS                                        *  00430000
004000*                                                              *  00440000
004100*    TSUOBTS TABLE (OUTBOUND TRAILER TRIP STATUS)              *  00441029
004200*               SELECTS                                        *  00442029
004300*                                                              *  00443029
004400****************************************************************  00450000
004500                                                                  00460000
004600 DATA DIVISION.                                                   00470000
004700 WORKING-STORAGE SECTION.                                         00480000
004800                                                                  00490000
004900 01  PV-CHARACTER-FIELDS.                                         00500000
005000     05  PV-DOOR-GP-NBR           PIC S9(4)  VALUE 0 COMP.        00530031
005100     05  PV-DC-NBR                PIC S9(4)  VALUE 0 COMP.        00540011
005200                                                                  00550000
005300 01  PV-COMP-FIELDS.                                              00560000
005400     05  PV-RETRY-COUNTER         PIC S9(04) VALUE 0 COMP.        00570000
005500                                                                  00600000
005600 01  PS-SWITCHES.                                                 00610000
005700     05  PS-END-OF-DOOR-CURSOR-SW     PIC X(01)  VALUE SPACE.     00660013
005800         88  PS-END-OF-DOOR-CURSOR               VALUE 'Y'.       00670013
005900         88  PS-NOT-END-OF-DOOR-CURSOR           VALUE 'N'.       00680013
006000     05  PS-END-OF-TRIP-CURSOR-SW     PIC X(01)  VALUE SPACE.     00690022
006100         88  PS-END-OF-TRIP-CURSOR               VALUE 'Y'.       00700022
006200         88  PS-NOT-END-OF-TRIP-CURSOR           VALUE 'N'.       00710022
006300                                                                  00720000
006400 01  PC-CONSTANTS.                                                00730000
006500     05  PC-MAX-RETRIES           PIC S9(04) VALUE +3 COMP.       00740000
006600     05  PC-N                     PIC X      VALUE 'N'.           00750012
006700     05  PC-PROGRAM-NAME          PIC X(08)  VALUE 'DLKUT027'.    00760012
006800     05  PC-SHIPPING              PIC X(08)  VALUE 'SHIPPING'.    00770012
006900     05  PC-DOOR-SUMMARY          PIC X(12)  VALUE                00780012
007000         'DOOR SUMMARY'.                                          00790012
007100                                                                  00800000
007200****************************************************************  00810017
007300*    XLWS091 - XLKUP046 COMMAREA - INSERTS BUSINESS EVENTS.    *  00820017
007400*    PCWS242 - USED TO DEFINE INFORMATION FOR BUSINESS EVENT   *  00821035
007500*              DETAIL ROWS.                                    *  00830035
007600****************************************************************  00840017
007700                                                                  00850017
007800     COPY XLWS091.                                                00860000
007900                                                                  00870000
008000     COPY PCWS242.                                                00880000
008100                                                                  00890000
008200****************************************************************  00900000
008300*    DLT00000 - DOOR GROUP TEMPLATE                            *  00910016
008400*    DLT00001 - DOOR GROUP                                     *  00920016
008500*                                                              *  00930000
008600****************************************************************  00940000
008700                                                                  00950000
008800     EXEC SQL                                                     00960000
008900         INCLUDE DLT00000                                         00970000
009000     END-EXEC.                                                    00980000
009100                                                                  00990000
009200     EXEC SQL                                                     01000000
009300         INCLUDE DLT00001                                         01010000
009400     END-EXEC.                                                    01020000
009500                                                                  01030021
009600     EXEC SQL                                                     01040021
009700         INCLUDE TSUOBTS                                          01050021
009800     END-EXEC.                                                    01060021
009900                                                                  01070000
010000     EXEC SQL                                                     01080000
010100          INCLUDE SQLCA                                           01090000
010200     END-EXEC.                                                    01100000
010300                                                                  01110000
010400                                                                  01120003
010500****************************************************************  01130003
010600*    GROUP-DOORS CURSOR - SELECTS ALL DOORS FOR A SPECIFC DC   *  01140035
010700*         AND DOOR GROUP WITHIN THAT DC.                       *  01141035
010800*                                                              *  01142035
010900*    TRIP-CURSOR - SELECTS ALL TRIP ROWS FOR A SPECIFIC DC AND *  01143035
011000*         A SPECIFIC DOOR SORTED IN DESCENDING ORDER OF THE    *  01150035
011100*         STATUS DATE.                                         *  01151035
011200****************************************************************  01160003
011300                                                                  01170000
011400     EXEC SQL                                                     01180003
011500          DECLARE GROUP-DOORS CURSOR FOR                          01190003
011600           SELECT                                                 01200003
011700                  GP.DOOR_ID                                      01210003
011800             FROM DLT_DOOR_GP       GP                            01220003
011900                 ,DLT_DOOR_GP_TMPL  TMPL                          01230007
012000            WHERE GP.DOOR_GP_NBR     = :PV-DOOR-GP-NBR            01240032
012100              AND TMPL.DC_NBR        = :PV-DC-NBR                 01250010
012200              AND TMPL.ACTV_IND      = 'Y'                        01251033
012300              AND GP.DOOR_GP_TMPL_ID = TMPL.DOOR_GP_TMPL_ID       01260008
012400         ORDER BY GP.DOOR_ID                                      01270003
012500                                                                  01280003
012600     END-EXEC.                                                    01290003
012700                                                                  01300022
012800     EXEC SQL                                                     01310022
012900          DECLARE TRIP-CURSOR CURSOR FOR                          01320022
013000           SELECT                                                 01330022
013100                  OBTS.OTBND_TRIP_ID                              01340025
013200             FROM TSUOBTS           OBTS                          01370022
013300            WHERE OBTS.DOOR_ID          = :DLT00001-DOOR-ID       01380022
013400              AND OBTS.STAT_OPER_UNT_ID = :PV-DC-NBR              01390022
013500         ORDER BY OBTS.OTBND_STAT_TMST  DESC                      01400022
013600                                                                  01410022
013700     END-EXEC.                                                    01420022
013800                                                                  01430003
013900                                                                  01440003
014000 LINKAGE SECTION.                                                 01450000
014100     COPY DLWS017.                                                01460000
014200                                                                  01470000
014300                                                                  01480000
014400 PROCEDURE DIVISION USING DL017-ASGMT-COMMAREA.                   01490000
014500                                                                  01500000
014600     SET DL017-SUCCESSFUL TO TRUE.                                01510000
014700                                                                  01520000
014800     EVALUATE TRUE                                                01530000
014900         WHEN DL017-BY-DOOR-GROUP-ID                              01540001
015000              PERFORM 1000-VALIDATE-INPUT                         01550005
015100                                                                  01560000
015200         WHEN OTHER                                               01570000
015300              SET DL017-INVALID-ACCESS TO TRUE                    01580000
015400                                                                  01590000
015500     END-EVALUATE.                                                01600000
015600                                                                  01610000
015700     MOVE SQLCA                       TO DL017-SQLCA.             01620000
015800                                                                  01630000
015900     GOBACK.                                                      01640000
016000                                                                  01650000
016100****************************************************************  01660000
016200*    VALIDATE THAT ALL REQUIRED FIELDS ARE PRESENT AND THAT    *  01670016
016300*        THEY ARE VALID VALUES.                                *  01680029
016400****************************************************************  01690000
016500                                                                  01700000
016600 1000-VALIDATE-INPUT.                                             01710005
016700                                                                  01720000
016800     EVALUATE TRUE                                                01730000
016900         WHEN DL017-ASGMT-START-DTE = SPACES                      01740012
017000              SET DL017-INPUT-FIELD-01-MISSING TO TRUE            01750030
017100                                                                  01760000
017200         WHEN DL017-ASGMT-NBR-TXT = SPACES                        01770005
017300              SET DL017-INPUT-FIELD-02-MISSING TO TRUE            01780030
017400                                                                  01790005
017500         WHEN DL017-ASGMT-NBR-SEQ-NBR = 0                         01800005
017600              SET DL017-INPUT-FIELD-03-MISSING TO TRUE            01810030
017700                                                                  01820005
017800         WHEN DL017-DOOR-GP-NBR = 0                               01830031
017900              SET DL017-INPUT-FIELD-04-MISSING TO TRUE            01840030
018000                                                                  01850005
018100         WHEN DL017-DC-NBR = 0                                    01860005
018200              SET DL017-INPUT-FIELD-05-MISSING TO TRUE            01870030
018300                                                                  01910005
018400         WHEN DL017-ASGMT-STRT-TMST = SPACES                      01920005
018500              SET DL017-INPUT-FIELD-07-MISSING TO TRUE            01930030
018600                                                                  01940005
018700         WHEN DL017-ASGMT-STOP-TMST = SPACES                      01950005
018800              SET DL017-INPUT-FIELD-08-MISSING TO TRUE            01960030
018900                                                                  01970005
019000         WHEN DL017-BEGIN-DETAIL-SEQ-NBR = 0                      01980005
019100              SET DL017-INPUT-FIELD-09-MISSING TO TRUE            01990030
019200                                                                  02000005
019300         WHEN DL017-NBR-DOORS = 0                                 02010005
019400              SET DL017-INPUT-FIELD-10-MISSING TO TRUE            02020030
019500                                                                  02030005
019600         WHEN DL017-COMMIT-UPDATE OR                              02040005
019700              DL017-DO-NOT-COMMIT-UPDATE                          02050005
019800              SET DL017-COMMIT-CODE-INVALID TO TRUE               02060005
019900                                                                  02070005
020000         WHEN OTHER                                               02080000
020100              PERFORM 2000-PROCESS-DOORS                          02090005
020200                                                                  02100000
020300     END-EVALUATE.                                                02110000
020400                                                                  02120000
020500****************************************************************  02130000
020600*    FETCH EACH OF THE DOORS FOR A SPECIFIC DC AND DOOR GROUP. *  02140035
020700*        PUT OUT A DOOR SUMMARY BUSINESS EVENT FOR EACH DOOR.  *  02150035
020800*                                                              *  02160000
020900****************************************************************  02170000
021000                                                                  02180000
021100 2000-PROCESS-DOORS.                                              02190005
021200                                                                  02200000
021300     MOVE DL017-DC-NBR TO PV-DC-NBR.                              02210020
021400     MOVE DL017-DOOR-GP-NBR TO PV-DOOR-GP-NBR.                    02220031
021500                                                                  02230020
021600     PERFORM 4000-OPEN-DOOR-CURSOR.                               02240005
021700                                                                  02250005
021800     SET PS-NOT-END-OF-DOOR-CURSOR TO TRUE.                       02260005
021900     PERFORM 4200-FETCH-DOORS.                                    02270005
022000                                                                  02280000
022100     PERFORM UNTIL (PS-END-OF-DOOR-CURSOR)                        02290005
022200                                                                  02300005
022300         PERFORM 5000-CALL-XLKUP033                               02310012
022400                                                                  02320005
022500         PERFORM 4200-FETCH-DOORS                                 02330005
022600                                                                  02340005
022700     END-PERFORM.                                                 02350005
022800                                                                  02360005
022900     PERFORM 4400-CLOSE-DOOR-CURSOR.                              02370005
023000                                                                  02380000
023100                                                                  02390003
023200****************************************************************  02400003
023300*                                                              *  02410003
023400*                                                              *  02420003
023500****************************************************************  02430003
023600                                                                  02440003
023700 4000-OPEN-DOOR-CURSOR.                                           02450005
023800                                                                  02460003
023900     EXEC SQL                                                     02470003
024000          OPEN  GROUP-DOORS                                       02480005
024100     END-EXEC.                                                    02490003
024200                                                                  02500003
024300     EVALUATE SQLCODE                                             02510003
024400         WHEN 0                                                   02520003
024500              CONTINUE                                            02530003
024600                                                                  02540003
024700         WHEN +100                                                02550003
024800              SET PS-END-OF-DOOR-CURSOR TO TRUE                   02560014
024900                                                                  02570003
025000         WHEN OTHER                                               02580003
025100              SET DL017-SQL-ERROR TO TRUE                         02590005
025200              MOVE '4000-' TO DL017-SQL-ERROR-PARA                02600005
025300              MOVE SQLCA   TO DL017-SQLCA                         02610005
025400              MOVE SQLCODE TO DL017-ASGMT-SQLCODE                 02620005
025500                                                                  02630005
025600     END-EVALUATE.                                                02640003
025700                                                                  02650005
025800****************************************************************  02660005
025900*    FETCH EACH OF THE DOORS FOR THE DC AND DOOR GROUP         *  02670035
026000*                                                              *  02680005
026100****************************************************************  02690005
026200                                                                  02700005
026300 4200-FETCH-DOORS.                                                02710005
026400                                                                  02720005
026500     EXEC SQL                                                     02730005
026600          FETCH GROUP-DOORS                                       02740005
026700           INTO                                                   02750005
026800                 :DLT00001-DOOR-ID                                02760006
026900                                                                  02770005
027000     END-EXEC.                                                    02780005
027100                                                                  02790005
027200     EVALUATE SQLCODE                                             02800005
027300         WHEN 0                                                   02810005
027400              CONTINUE                                            02820005
027500                                                                  02830005
027600         WHEN +100                                                02840005
027700              SET PS-END-OF-DOOR-CURSOR TO TRUE                   02850014
027800                                                                  02860005
027900         WHEN OTHER                                               02870005
028000              SET DL017-SQL-ERROR TO TRUE                         02880005
028100              MOVE '4200-' TO DL017-SQL-ERROR-PARA                02890005
028200              MOVE SQLCA   TO DL017-SQLCA                         02900005
028300              MOVE SQLCODE TO DL017-ASGMT-SQLCODE                 02910005
028400                                                                  02920005
028500     END-EVALUATE.                                                02930005
028600                                                                  02940005
028700                                                                  02950012
028800****************************************************************  02960012
028900*                                                              *  02970012
029000*                                                              *  02980012
029100****************************************************************  02990012
029200                                                                  03000012
029300 4400-CLOSE-DOOR-CURSOR.                                          03010013
029400                                                                  03020012
029500     EXEC SQL                                                     03030012
029600          CLOSE GROUP-DOORS                                       03040012
029700     END-EXEC.                                                    03050012
029800                                                                  03060012
029900     EVALUATE SQLCODE                                             03070012
030000         WHEN 0                                                   03080012
030100              CONTINUE                                            03090012
030200                                                                  03100012
030300         WHEN OTHER                                               03110012
030400              SET DL017-SQL-ERROR TO TRUE                         03120012
030500              MOVE '4400-' TO DL017-SQL-ERROR-PARA                03130012
030600              MOVE SQLCA   TO DL017-SQLCA                         03140012
030700              MOVE SQLCODE TO DL017-ASGMT-SQLCODE                 03150012
030800                                                                  03160012
030900     END-EVALUATE.                                                03170012
031000                                                                  03180005
031100****************************************************************  03190005
031200*    CALL XLKUP033 TO INSERT THE DOOR SUMMARY BUSINESS EVENTS. *  03200035
031300*                                                              *  03210005
031400****************************************************************  03220005
031500                                                                  03230005
031600 5000-CALL-XLKUP033.                                              03240012
031700                                                                  03250005
031800     INITIALIZE XL091-EAI-EXPORT-COMMAREA.                        03260005
031900                                                                  03270005
032000     SET XL091-PC-APP-ID          TO TRUE.                        03280005
032100                                                                  03290005
032200     MOVE PC-SHIPPING             TO XL091-EVNT-OBJ-TXT.          03300005
032300     MOVE PC-DOOR-SUMMARY         TO XL091-EVNT-OBJ-ACTN-TXT.     03310005
032400     MOVE DL017-USR-ID            TO XL091-CRE-BY-USR-ID.         03320021
032500     MOVE PC-PROGRAM-NAME         TO XL091-CRE-PGM-NM.            03330012
032600                                                                  03340021
032700     SET PS-NOT-END-OF-TRIP-CURSOR TO TRUE.                       03350022
032800                                                                  03360022
032900     PERFORM 6000-OPEN-TRIP-CURSOR.                               03370022
033000                                                                  03380022
033100     PERFORM 6200-FETCH-TRIPS.                                    03390022
033200                                                                  03400022
033300     PERFORM 6400-CLOSE-TRIP-CURSOR.                              03410022
033400                                                                  03420022
033500     IF PS-END-OF-TRIP-CURSOR                                     03430027
033600        MOVE 0 TO XL091-EVNT-KY-1-NBR                             03440034
033700     ELSE                                                         03440127
033800        MOVE SUOBTS-OTBND-TRIP-ID TO XL091-EVNT-KY-1-NBR.         03441026
033900                                                                  03450021
034000     MOVE DL017-DC-NBR            TO XL091-EVNT-KY-2-NBR.         03460005
034100     MOVE DL017-DOOR-GP-NBR       TO XL091-EVNT-KY-3-NBR.         03470031
034200     MOVE DLT00001-DOOR-ID        TO XL091-EVNT-KY-1-TXT.         03480012
034300     MOVE DL017-ASGMT-STRT-TMST   TO XL091-EVNT-KY-1-TMST.        03490005
034400     MOVE DL017-ASGMT-STOP-TMST   TO XL091-EVNT-KY-2-TMST.        03500005
034500                                                                  03510005
034600****************************************************************  03220005
034700*    FOLLOWING CHANGE TO MAKE THE LAST 6 SIX POSITIONS OF THE  *  03210005
034800*    EVENT KEY 2 TIMESTAMP WAS REQUESTED BY BUDDY BARNES SO    *  03210005
034900*    THAT THE DATA WOULDN'T BE COUNTED TWICE IN RED PRAIRIE.   *  03210005
035000*                                                              *  03210005
035100****************************************************************  03220005
035200     MOVE '000000' TO XL091-EVNT-KY-2-TMST (21:6).                        
035300                                                                  03520005
035400     SET XL091-DO-NOT-COMMIT-UPDATE TO TRUE.                      03530005
035500     MOVE PC-PROGRAM-NAME         TO XL091-ORIG-CALLING-PGM-NM.   03540013
035600                                                                  03550005
035700     SET XL091-PCWS242-COPYBOOK TO TRUE.                          03560005
035800                                                                  03570005
035900     INITIALIZE PC242-DTL-TXT-AREA.                               03580005
036000     SET  PC242-SUMMARIZE-SHIP-DOOR TO TRUE.                      03590005
036100     MOVE DL017-ASGMT-START-DTE   TO PC242-AE-ASGMT-STRT-DTE.     03600012
036200     MOVE DL017-ASGMT-NBR-TXT     TO PC242-AE-ASGMT-NBR-TXT.      03610005
036300     MOVE DL017-ASGMT-NBR-SEQ-NBR TO PC242-AE-ASGMT-NBR-SEQ-NBR.  03620005
036400     MOVE DL017-BEGIN-DETAIL-SEQ-NBR TO                           03630005
036500                                 PC242-AE-ASGMT-SEQ-DTL-NBR.      03640005
036600     ADD  1 TO DL017-BEGIN-DETAIL-SEQ-NBR.                        03641026
036700                                                                  03650005
036800     MOVE PC242-DTL-TXT-AREA      TO XL091-DTL-TXT.               03660005
036900                                                                  03670005
037000     CALL XL091-USER-PGM USING XL091-EAI-EXPORT-COMMAREA.         03680005
037300                                                                  03710005
037400     IF XL091-SUCCESSFUL                                          03720005
037500        CONTINUE                                                  03730005
037600     ELSE                                                         03740005
037700        SET  DL017-CALLED-MODULE-FAILURE TO TRUE                  03750013
037800        MOVE XL091-USER-PGM        TO DL017-CALL-MOD-FAIL-NM      03760013
037900        MOVE XL091-RETURN-CODE     TO DL017-CALL-MOD-FAIL-ERR-CDE 03770013
038000        MOVE XL091-RETURN-SQLCODES TO DL017-RETURN-SQLCODES       03780013
038100     END-IF.                                                      03790005
038200                                                                  03800022
038300****************************************************************  03810022
038400*                                                              *  03820022
038500*                                                              *  03830022
038600****************************************************************  03840022
038700                                                                  03850022
038800 6000-OPEN-TRIP-CURSOR.                                           03860022
038900                                                                  03870022
039000     EXEC SQL                                                     03880022
039100          OPEN  TRIP-CURSOR                                       03890022
039200     END-EXEC.                                                    03900022
039300                                                                  03910022
039400     EVALUATE SQLCODE                                             03920022
039500         WHEN 0                                                   03930022
039600              CONTINUE                                            03940022
039700                                                                  03950022
039800         WHEN +100                                                03960022
039900              SET PS-END-OF-TRIP-CURSOR TO TRUE                   03970022
040000                                                                  03980022
040100         WHEN OTHER                                               03990022
040200              SET DL017-SQL-ERROR TO TRUE                         04000022
040300              MOVE '6000-' TO DL017-SQL-ERROR-PARA                04010022
040400              MOVE SQLCA   TO DL017-SQLCA                         04020022
040500              MOVE SQLCODE TO DL017-ASGMT-SQLCODE                 04030022
040600                                                                  04040022
040700     END-EVALUATE.                                                04050022
040800                                                                  04060022
040900****************************************************************  04070022
041000*    FETCHES THE LATEST TRIP INFORMATION FOR A SPECIFIC DOOR   *  04080035
041100*    AND DC.                                                   *  04090035
041200****************************************************************  04100022
041300                                                                  04110022
041400 6200-FETCH-TRIPS.                                                04120022
041500                                                                  04130022
041600     EXEC SQL                                                     04140022
041700          FETCH TRIP-CURSOR                                       04150022
041800           INTO                                                   04160022
041900                 :SUOBTS-OTBND-TRIP-ID                            04170024
042000                                                                  04180022
042100     END-EXEC.                                                    04190022
042200                                                                  04200022
042300     EVALUATE SQLCODE                                             04210022
042400         WHEN 0                                                   04220022
042500              CONTINUE                                            04230022
042600                                                                  04240022
042700         WHEN +100                                                04250022
042800              SET PS-END-OF-TRIP-CURSOR TO TRUE                   04260022
042900                                                                  04270022
043000         WHEN OTHER                                               04280022
043100              SET DL017-SQL-ERROR TO TRUE                         04290022
043200              MOVE '6200-' TO DL017-SQL-ERROR-PARA                04300022
043300              MOVE SQLCA   TO DL017-SQLCA                         04310022
043400              MOVE SQLCODE TO DL017-ASGMT-SQLCODE                 04320022
043500                                                                  04330022
043600     END-EVALUATE.                                                04340022
043700                                                                  04350022
043800                                                                  04360022
043900****************************************************************  04370022
044000*                                                              *  04380022
044100*                                                              *  04390022
044200****************************************************************  04400022
044300                                                                  04410022
044400 6400-CLOSE-TRIP-CURSOR.                                          04420022
044500                                                                  04430022
044600     EXEC SQL                                                     04440022
044700          CLOSE TRIP-CURSOR                                       04450022
044800     END-EXEC.                                                    04460022
044900                                                                  04470022
045000     EVALUATE SQLCODE                                             04480022
045100         WHEN 0                                                   04490022
045200              CONTINUE                                            04500022
045300                                                                  04510022
045400         WHEN OTHER                                               04520022
045500              SET DL017-SQL-ERROR TO TRUE                         04530022
045600              MOVE '6400-' TO DL017-SQL-ERROR-PARA                04540022
045700              MOVE SQLCA   TO DL017-SQLCA                         04550022
045800              MOVE SQLCODE TO DL017-ASGMT-SQLCODE                 04560022
045900                                                                  04570022
046000     END-EVALUATE.                                                04580022
046100                                                                  04590012
046200****************************************************************  04600012
046300*                                                              *  04610012
046400*                                                              *  04620012
046500****************************************************************  04630012
046600                                                                  04640012
046700 8000-COMMIT.                                                     04650012
046800                                                                  04660012
046900     EXEC SQL                                                             
047000          COMMIT                                                          
047100     END-EXEC.                                                            
047110                                                                          
047120     EVALUATE TRUE                                                        
047130         WHEN SQLCODE = ZERO                                              
047140         WHEN SQLCODE = +100                                              
047150             CONTINUE                                                     
047160         WHEN OTHER                                                       
047170              DISPLAY 'DLKUT027 - ERROR ON COMMIT'                        
047180     END-EVALUATE.                                                        
047200                                                                  04700012
