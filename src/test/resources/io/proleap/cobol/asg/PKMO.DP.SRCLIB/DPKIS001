000100******************************************************************00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300******************************************************************00030000
000400                                                                  00040000
000500 PROGRAM-ID.             DPKIS001.                                00050000
000600 AUTHOR.                 RICK TULLOCH.                            00060047
000700 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00070000
000800 DATE-WRITTEN            JULY 30, 1998.                           00080047
000900 DATE-COMPILED.                                                   00090000
001000                                                                  00100000
001100******************************************************************00110000
001200*  THIS PROGRAM IS AN ISPF DIALOG TO EXERCISE KOHLS CALENDAR     *00120000
001300*  ROUTINE REQUESTS, AND FORMAT THE RESULTS OF THE REQUEST.      *00130000
001400*  THREE ISPF PANELS ARE DIRECTLY USED IN THE DIALOG:            *00140055
001500*       CMNETC0 - INPUT - CALENDAR ROUTINE REQUEST SPECIFICATION *00150000
001600*       CMNETC1 - OUTPUT - CALENDAR ROUTINE REQUEST RESULTS      *00160000
001700*       CMNETC2 - OUTPUT - BROWSE CALENDAR ROUTINE CALL DETAILS  *00170055
001800*  REQUESTS WILL BE PROCESSED UNTIL AN END IS REQUESTED FROM     *00180000
001900*  THE CALENDAR ROUTINE REQUEST SPECIFICATION PANEL.  REQUESTS   *00190000
002000*  WILL BE EDITED BY THE APPLICATION, AS APPROPRIATE, PRIOR TO   *00200055
002100*  CALLING THE KOHLS CALENDAR ROUTINE.  IF THE REQUEST PASSES    *00210000
002200*  LOCAL EDITS, THE CALENDAR ROUTINE WILL BE CALLED.  IF THERE   *00220000
002300*  ARE ANY FAILURES IN THE LOCAL EDIT OR IN THE CALENDAR ROUTINE *00230000
002400*  CALL, THE CALENDAR ROUTINE REQUEST SPECIFICATION PANEL WILL   *00240000
002500*  BE REDISPLAYED, WITH THE APPROPRIATE ERROR MESSAGE, AND THE   *00250000
002600*  CURSOR POSITIONED ON THE FIELD IN ERROR.  IF THE CALL IS      *00260000
002700*  SUCCESSFUL, THE CALENDAR RESULTS WILL BE FORMATTED AND THE    *00270000
002800*  CALENDAR ROUTINE REQUEST RESULTS PANEL WILL BE DISPLAYED, AND *00280000
002900*  REMAIN DISPLAYED UNTIL AN END IS REQUESTED FROM THE PANEL.    *00290000
003000*  WHEN AN END (PF3) IS REQUESTED, CONTROL IS RETURNED TO THE    *00300000
003100*  REQUEST SPECIFICATION PANEL, WITH ALL THE REQUEST FIELDS      *00310000
003200*  INITIALIZED FOR A NEW SPECIFICATION.  FROM THE RESULTS PANEL, *00320055
003210*  A COMMAND CAN BE ENTERED TO VIEW THE DETAILS BEHIND THE       *00321055
003220*  CALENDAR CALL.  A BROWSABLE FILE WILL BE CREATED TO FORMAT    *00322055
003230*  AND PRESENT THE ENTIRE PARAMETER LIST FROM THE ORIGINAL       *00323055
003240*  CALENDAR ROUTINE CALL.  CONTROL WILL BE PASSED TO ALLOW AN    *00324055
003241*  ISPF BROWSE OF THE DETAIL FILE.  THE BROWSE PANEL WILL REMAIN *00324155
003250*  DISPLAYED UNTIL AN END IS REQUESTED FROM THE PANEL.  WHEN AN  *00325055
003260*  END (PF3) IS REQUESTED, CONTROL IS PASSED TO THE COMMON PRINT *00326055
003270*  REQUEST PANEL, TO ALLOW THE BROWSED FILE TO BE PRINTED.       *00327055
003280*  AFTER RESPONDING TO THE PRINT REQUEST, CONTROL IS RETURNED TO *00328055
003290*  THE CALENDAR ROUTINE REQUEST RESULTS PANEL.                   *00329055
003300*                                                                *00330000
003400*  THIS PROGRAM IS INVOKED VIA CLIST CMNETC0, FROM THE E.T.C.    *00340055
003500*  (EXTENSIONS - TOOLS - CALENDAR) PANEL (CMNET00), OR UNDER     *00350000
003600*  THE ISPF CUSTOMIZATION OPTION "CALENDAR" (WHICH ISSUES A      *00360000
003700*  CMD %CMNETC0).                                                *00370000
003800******************************************************************00380000
003900                                                                  00390000
004000******************************************************************00400000
004100 ENVIRONMENT DIVISION.                                            00410000
004200******************************************************************00420000
004300                                                                  00430000
004400 CONFIGURATION SECTION.                                           00440000
004500 SOURCE-COMPUTER.        IBM-3090.                                00450000
004600 OBJECT-COMPUTER.        IBM-3090.                                00460000
004700                                                                  00470038
004800 INPUT-OUTPUT SECTION.                                            00480038
004900                                                                  00490038
005000 FILE-CONTROL.                                                    00500038
005100                                                                  00510038
005200     SELECT CALENDAR-DETAILS-FILE                                 00520038
005300         ASSIGN TO CALDTLS.                                       00530038
005400                                                                  00540000
005500******************************************************************00550000
005600 DATA DIVISION.                                                   00560000
005700******************************************************************00570000
005800                                                                  00580000
005900 FILE SECTION.                                                    00590038
006000                                                                  00600038
006100 FD  CALENDAR-DETAILS-FILE                                        00610038
006200     RECORDING MODE IS F                                          00620038
006300     LABEL RECORDS ARE STANDARD                                   00630038
006400     BLOCK CONTAINS 0 RECORDS                                     00640038
006500     RECORD CONTAINS 80 CHARACTERS                                00650038
006600     DATA RECORD IS CD-CALENDAR-DETAILS-RECORD.                   00660038
006700                                                                  00670038
006800 01  CD-CALENDAR-DETAILS-RECORD  PIC X(80).                       00680038
006900                                                                  00690038
007000 WORKING-STORAGE SECTION.                                         00700000
007100                                                                  00710000
007200*                                                                 00720000
007300*  PARAMETER LIST FOR CALLING THE KOHLS CALENDAR ROUTINE          00730000
007400*                                                                 00740000
007500     COPY DPWS500.                                                00750000
007600                                                                  00760038
007700*                                                                 00770000
007800*  PARAMETER LIST FOR CALLING THE NUMERIC EDIT ROUTINE            00780000
007900*                                                                 00790000
008000     COPY DPWS010I.                                               00800000
008100                                                                  00810000
008200*                                                                 00820038
008300*  PARAMETER LIST FOR THE DYNAMIC ALLOCATION ROUTINE              00830038
008400*                                                                 00840038
008500     COPY DPWS023.                                                00850038
008600                                                                  00860038
008700*                                                                 00870038
008800*  PARAMETER LIST FOR THE ISPF PRINT PANEL ROUTINE                00880038
008900*                                                                 00890038
009000     COPY DPWS300.                                                00900038
009100                                                                  00910038
009200 01  PS-PROGRAM-SWITCHES.                                         00920000
009300     05  PS-EDIT-ERROR-IND       PIC X(1)     VALUE 'N'.          00930038
009400         88  PS-EDIT-ERROR                    VALUE 'Y'.          00940038
009500         88  PS-NO-EDIT-ERRORS                VALUE 'N'.          00950038
009600     05  PS-CAL-DETAILS-FILE-ALLOC-IND                            00960038
009700                                 PIC X(1)     VALUE 'N'.          00970038
009800         88  PS-CAL-DETAILS-ALLOCATED         VALUE 'Y'.          00980038
009900         88  PS-CAL-DETAILS-NOT-ALLOCATED     VALUE 'N'.          00990038
010000                                                                  01000000
010100 01  PC-PROGRAM-CONSTANTS.                                        01010000
010200     05  PC-CURRENT-PROGRAM-NAME PIC X(8)     VALUE 'DPKIS001'.   01020038
010300     05  PC-1-DAY                PIC 9(1)     VALUE 1.            01030038
010400     05  PC-1-WEEK               PIC 9(1)     VALUE 1.            01040038
010500     05  PC-DAYS-PER-WEEK        PIC 9(1)     VALUE 7.            01050038
010600     05  PC-COMMA-SEPARATOR      PIC X(2)     VALUE ', '.         01060038
010700     05  PC-CNTL-DSN-QUALIFIER   PIC X(5)     VALUE '.CNTL'.      01070038
010800     05  PC-CAL-DETAILS-DSN-QUALIFIER                             01080040
010900                                 PIC X(5)     VALUE '.CDTL'.      01090040
011000     05  PC-DSN-QUALIFIER-SEP    PIC X(1)     VALUE '.'.          01100038
011100     05  PC-CAL-DETAILS-DDNAME   PIC X(8)     VALUE 'CALDTLS'.    01110038
011200     05  PC-CAL-DETAILS-RECORD-COUNT                              01120038
011300                                 PIC 9(7)     VALUE 200.          01130038
011400     05  PC-CAL-DETAILS-INDENT   PIC X(5)     VALUE SPACES.       01140039
011500                                                                  01150000
011600 01  PV-PROGRAM-VARIABLES.                                        01160000
011700     05  PV-RESULT-DATE          PIC X(10)    VALUE SPACES.       01170038
011800     05  PV-INCR-DECR-CTR        PIC S9(3)    VALUE +0.           01180038
011900     05  PV-ZERO-SUPPRESS-DAY    PIC Z9       VALUE ZERO.         01190038
012000     05  FILLER                  REDEFINES PV-ZERO-SUPPRESS-DAY.  01200038
012100         10  PV-ZERO-SUPPRESS-DAY-1                               01210038
012200                                 PIC X(1).                        01220038
012300         10  PV-ZERO-SUPPRESS-DAY-2                               01230038
012400                                 PIC X(1).                        01240038
012500     05  PV-DAYS                 PIC 9(3)     VALUE ZERO.         01250038
012600     05  PV-WEEKS                PIC 9(2)     VALUE ZERO.         01260038
012700     05  PV-TALLY                PIC S9(4)    VALUE ZEROS         01270038
012800                                              COMP SYNC.          01280038
012810     05  PV-HEADING-LINE-COUNT   PIC 9(2)     VALUE ZERO.         01281051
012900     05  PV-CALENDAR-DETAILS-ENTRIES                              01290041
013000                                 PIC 9(3)     VALUE ZEROS.        01300041
013100     05  PV-DAYS-DIFF-FMT        PIC 99999-   VALUE ZEROS.        01310039
013200     05  PV-FISCAL-DIFF-FMT      PIC 9999-    VALUE ZEROS.        01320039
013300     05  PV-CAL-DETAILS-DSN      PIC X(44)    VALUE SPACES.       01330040
013400     05  PV-CAL-DETAILS-DSN-WO-USERID                             01340040
013500                                 PIC X(44)    VALUE SPACES.       01350038
013600     05  PV-CAL-DETAILS-VOLUME   PIC X(6)     VALUE SPACES.       01360040
013700     05  PV-CAL-DETAILS-PASSWORD                                  01370040
013800                                 PIC X(8)     VALUE SPACES.       01380038
013900     05  PV-DYNALC-ROUTINE-ERROR-MSG.                             01390038
014000         10  FILLER              PIC X(13)    VALUE               01400038
014100             'DYNALC ERROR '.                                     01410038
014200         10  PV-DR-RETURN-CODE   PIC 9999     VALUE ZEROS.        01420038
014300         10  FILLER              PIC X(2)     VALUE '; '.         01430038
014400         10  PV-DR-DDNAME        PIC X(8)     VALUE SPACES.       01440038
014500         10  FILLER              PIC X(5)     VALUE ' DD; '.      01450038
014600         10  PV-DR-ERROR-DESC    PIC X(41)    VALUE SPACES.       01460038
014700                                                                  01470000
014800 01  CD-CALENDAR-DETAILS-TABLE.                                   01480039
014900     05  CD-CALENDAR-DETAILS-ENTRY                                01490039
015000                                 OCCURS 200 TIMES                 01500039
015100                                 INDEXED BY CD-INDEX              01510039
015200                                 PIC X(80).                       01520039
015300                                                                  01530039
015400***************************************************************   01540000
015500*  ISPF CONSTANTS                                                 01550000
015600***************************************************************   01560000
015700 01  IC-ISPF-CONSTANTS.                                           01570000
015800     05  IC-ISPF-SERVICE-LINK    PIC X(7)     VALUE 'ISPLINK'.    01580038
015900     05  IC-MISC-SERVICE-CONTROL PIC X(7)     VALUE 'CONTROL'.    01590038
016000     05  IC-DISPLAY-SERVICE-DISPLAY                               01600038
016100                                 PIC X(7)     VALUE 'DISPLAY'.    01610038
016200     05  IC-PDF-SERVICE-BROWSE   PIC X(8)     VALUE 'BROWSE'.     01620043
016300     05  IC-REFRESH-STATEMENT    PIC X(7)     VALUE 'REFRESH'.    01630038
016400*                                                                 01640038
016500*  DEFINE VARIABLES TO ISPF THROUGH THE FUNCTION POOL             01650038
016600*                                                                 01660038
016700     05  IC-VARIABLE-SERVICE-VDEFINE                              01670038
016800                                 PIC X(8)     VALUE 'VDEFINE'.    01680038
016900*                                                                 01690042
017000*  RETRIEVE VARIABLES FROM THE SHARED POOL OR PROFILE POOL        01700042
017100*                                                                 01710042
017200     05  IC-VARIABLE-SERVICE-VGET                                 01720042
017300                                 PIC X(8)     VALUE 'VGET'.       01730042
017400*                                                                 01740042
017500     05  IC-FIELD-FORMAT-CHAR    PIC X(8)     VALUE 'CHAR'.       01750038
017600     05  IC-SHARED-VARIABLE-POOL PIC X(8)     VALUE 'SHARED'.     01760042
017700                                                                  01770000
017800 01  IV-ISPF-VARIABLES.                                           01780000
017900***************************************************************   01790000
018000*  CURSOR POSITIONING IS ACTIVATED ON THE DISPLAY OF THE PANEL.   01800000
018100*  THE FIELD NAME (SEE RELATED ISPF CONSTANTS) IS USED BY ISPF    01810000
018200*  TO SPECIFY CURSOR POSITIONING.                                 01820000
018300***************************************************************   01830000
018400     05  IV-CURSOR-POSITION      PIC X(8)     VALUE SPACE.        01840038
018500     05  IV-FIELD-LENGTH         PIC 9(8)     VALUE ZEROS         01850038
018600                                              COMP SYNC.          01860038
018700     05  IV-ERROR-MESSAGE-FORMAT PIC X(8) VALUE SPACES.           01870038
018800         88  IV-EM-DYNAMIC-SHORT-LONG-MSG     VALUE 'CMN000  '.   01880038
018900                                                                  01890000
019000***************************************************************   01900000
019100*  NAMED CONSTANTS FOR ALL PANELS AND DIALOG VARIABLES.           01910055
019200***************************************************************   01920000
019300 01  IN-ISPF-NAMED-DIALOG-VARIABLES.                              01930000
019400***************************************************************   01940000
019500*  PANEL NAMES                                                    01950000
019600***************************************************************   01960000
019700     05  IN-PANEL-CMNETC0        PIC X(8)     VALUE 'CMNETC0'.    01970038
019800     05  IN-PANEL-CMNETC1        PIC X(8)     VALUE 'CMNETC1'.    01980038
019900     05  IN-PANEL-CMNETC2        PIC X(8)     VALUE 'CMNETC2'.    01990043
020000***************************************************************   02000000
020100*  DIALOG VARIABLE NAMES COMMON TO ALL PANELS                     02010000
020200*  - ZCMD IS A SYSTEM VARIABLE                                    02020000
020300***************************************************************   02030000
020400     05  IN-FIELD-COMMAND-LINE   PIC X(8)     VALUE 'ZCMD'.       02040038
020500     05  IN-FIELD-SHORT-MESSAGE  PIC X(8)     VALUE 'SMSG'.       02050038
020600     05  IN-FIELD-LONG-MESSAGE   PIC X(8)     VALUE 'LMSG'.       02060038
020700***************************************************************   02070042
020800*  DIALOG VARIABLES IN THE SHARED POOL                            02080056
020900***************************************************************   02090042
021000     05  IN-FIELD-ISPF-TEMP-FILE-DSN                              02100042
021100                                 PIC X(8)     VALUE 'ZTEMPF'.     02110042
021200***************************************************************   02120000
021300*  CMNETC0 PANEL DIALOG VARIABLE NAMES                            02130055
021400***************************************************************   02140000
021500     05  IN-FIELD-CMNETCSR       PIC X(8)     VALUE 'CMNETCSR'.   02150038
021600     05  IN-FIELD-CMNETCPD       PIC X(8)     VALUE 'CMNETCPD'.   02160038
021700     05  IN-FIELD-CMNETCPF       PIC X(8)     VALUE 'CMNETCPF'.   02170038
021800     05  IN-FIELD-CMNETCCT       PIC X(8)     VALUE 'CMNETCCT'.   02180038
021900     05  IN-FIELD-CMNETCCD       PIC X(8)     VALUE 'CMNETCCD'.   02190038
022000     05  IN-FIELD-CMNETCCF       PIC X(8)     VALUE 'CMNETCCF'.   02200038
022100     05  IN-FIELD-CMNETCPY       PIC X(8)     VALUE 'CMNETCPY'.   02210038
022200     05  IN-FIELD-CMNETCID       PIC X(8)     VALUE 'CMNETCID'.   02220038
022300     05  IN-FIELD-CMNETCIY       PIC X(8)     VALUE 'CMNETCIY'.   02230038
022400     05  IN-FIELD-CMNETCIB       PIC X(8)     VALUE 'CMNETCIB'.   02240038
022500     05  IN-FIELD-CMNETCIW       PIC X(8)     VALUE 'CMNETCIW'.   02250038
022600     05  IN-FIELD-CMNETCIP       PIC X(8)     VALUE 'CMNETCIP'.   02260038
022700***************************************************************   02270000
022800*  CMNETC1 PANEL DIALOG VARIABLE NAMES                            02280055
022900*  - DIALOG VARIABLES DEFINED IN THE FUNCTION POOL FOR CMNETC0    02290056
023000*    AND JUST REDISPLAYED ON CMNETC1 DO NOT NEED TO BE DEFINED    02300056
023100*    IN THIS CONTEXT, SINCE THEY HAVE ALREADY BEEN DEFINED FOR    02310056
023110*    THIS APPLICATION -- THE DEFINITION IS COMMENTED TO           02311056
023120*    HIGHLIGHT ITS USE ON CMNETC1                                 02312056
023300***************************************************************   02330000
023400***************************************************************   02340000
023500*  CMNETC1 - ROW 1 OF DIALOG VARIABLES                            02350055
023600***************************************************************   02360000
023700*    05  IN-FIELD-CMNETCPD       PIC X(8)     VALUE 'CMNETCPD'.   02370038
023800*    05  IN-FIELD-CMNETCCT       PIC X(8)     VALUE 'CMNETCCT'.   02380038
023900     05  IN-FIELD-CMNETCFC       PIC X(8)     VALUE 'CMNETCFC'.   02390038
024000*    05  IN-FIELD-CMNETCCD       PIC X(8)     VALUE 'CMNETCCD'.   02400038
024100*    05  IN-FIELD-CMNETCID       PIC X(8)     VALUE 'CMNETCID'.   02410038
024200     05  IN-FIELD-CMNETCIA       PIC X(8)     VALUE 'CMNETCIA'.   02420038
024300     05  IN-FIELD-CMNETCCP       PIC X(8)     VALUE 'CMNETCCP'.   02430038
024400***************************************************************   02440000
024500*  CMNETC1 - ROW 2 OF DIALOG VARIABLES                            02450055
024600***************************************************************   02460000
024700*    05  IN-FIELD-CMNETCPF       PIC X(8)     VALUE 'CMNETCPF'.   02470038
024800*    05  IN-FIELD-CMNETCCF       PIC X(8)     VALUE 'CMNETCCF'.   02480038
024900     05  IN-FIELD-CMNETCII       PIC X(8)     VALUE 'CMNETCII'.   02490038
025000***************************************************************   02500000
025100*  CMNETC1 - ROW 3 OF DIALOG VARIABLES                            02510055
025200***************************************************************   02520000
025300     05  IN-FIELD-CMNETCRD       PIC X(8)     VALUE 'CMNETCRD'.   02530038
025400     05  IN-FIELD-CMNETCCI       PIC X(8)     VALUE 'CMNETCCI'.   02540038
025500     05  IN-FIELD-CMNETCDC       PIC X(8)     VALUE 'CMNETCDC'.   02550038
025600     05  IN-FIELD-CMNETCWI       PIC X(8)     VALUE 'CMNETCWI'.   02560038
025700     05  IN-FIELD-CMNETCDW       PIC X(8)     VALUE 'CMNETCDW'.   02570038
025800***************************************************************   02580000
025900*  CMNETC1 - ROW 4 OF DIALOG VARIABLES                            02590055
026000***************************************************************   02600000
026100     05  IN-FIELD-CMNETCGD       PIC X(8)     VALUE 'CMNETCGD'.   02610038
026200     05  IN-FIELD-CMNETCJD       PIC X(8)     VALUE 'CMNETCJD'.   02620038
026300     05  IN-FIELD-CMNETCBI       PIC X(8)     VALUE 'CMNETCBI'.   02630038
026400     05  IN-FIELD-CMNETCDB       PIC X(8)     VALUE 'CMNETCDB'.   02640038
026500     05  IN-FIELD-CMNETCPI       PIC X(8)     VALUE 'CMNETCPI'.   02650038
026600     05  IN-FIELD-CMNETCDP       PIC X(8)     VALUE 'CMNETCDP'.   02660038
026700***************************************************************   02670000
026800*  CMNETC1 - ROW 5 OF DIALOG VARIABLES                            02680055
026900***************************************************************   02690000
027000     05  IN-FIELD-CMNETCBD       PIC X(8)     VALUE 'CMNETCBD'.   02700038
027100     05  IN-FIELD-CMNETCAH       PIC X(8)     VALUE 'CMNETCAH'.   02710038
027200     05  IN-FIELD-CMNETCCH       PIC X(8)     VALUE 'CMNETCCH'.   02720038
027300     05  IN-FIELD-CMNETCSH       PIC X(8)     VALUE 'CMNETCSH'.   02730038
027400     05  IN-FIELD-CMNETCHN       PIC X(8)     VALUE 'CMNETCHN'.   02740038
027500***************************************************************   02750000
027600*  CMNETC1 - ROW 6 OF DIALOG VARIABLES                            02760055
027700***************************************************************   02770000
027800     05  IN-FIELD-CMNETCA2       PIC X(8)     VALUE 'CMNETCA2'.   02780038
027900     05  IN-FIELD-CMNETCA3       PIC X(8)     VALUE 'CMNETCA3'.   02790038
028000     05  IN-FIELD-CMNETCA6       PIC X(8)     VALUE 'CMNETCA6'.   02800038
028100     05  IN-FIELD-CMNETCA7       PIC X(8)     VALUE 'CMNETCA7'.   02810038
028200***************************************************************   02820000
028300*  CMNETC1 - ROW 7 OF DIALOG VARIABLES                            02830055
028400***************************************************************   02840000
028500     05  IN-FIELD-CMNETCY1       PIC X(8)     VALUE 'CMNETCY1'.   02850038
028600     05  IN-FIELD-CMNETCY2       PIC X(8)     VALUE 'CMNETCY2'.   02860038
028700     05  IN-FIELD-CMNETCY3       PIC X(8)     VALUE 'CMNETCY3'.   02870038
028800     05  IN-FIELD-CMNETCY4       PIC X(8)     VALUE 'CMNETCY4'.   02880038
028900     05  IN-FIELD-CMNETCY5       PIC X(8)     VALUE 'CMNETCY5'.   02890038
029000     05  IN-FIELD-CMNETCY6       PIC X(8)     VALUE 'CMNETCY6'.   02900038
029100     05  IN-FIELD-CMNETCY7       PIC X(8)     VALUE 'CMNETCY7'.   02910038
029200***************************************************************   02920000
029300*  CMNETC1 - ROW 8 OF DIALOG VARIABLES                            02930055
029400***************************************************************   02940000
029500     05  IN-FIELD-CMNETCS1       PIC X(8)     VALUE 'CMNETCS1'.   02950038
029600     05  IN-FIELD-CMNETCS2       PIC X(8)     VALUE 'CMNETCS2'.   02960038
029700     05  IN-FIELD-CMNETCS3       PIC X(8)     VALUE 'CMNETCS3'.   02970038
029800     05  IN-FIELD-CMNETCS4       PIC X(8)     VALUE 'CMNETCS4'.   02980038
029900     05  IN-FIELD-CMNETCS5       PIC X(8)     VALUE 'CMNETCS5'.   02990038
030000     05  IN-FIELD-CMNETCS6       PIC X(8)     VALUE 'CMNETCS6'.   03000038
030100     05  IN-FIELD-CMNETCS7       PIC X(8)     VALUE 'CMNETCS7'.   03010038
030200***************************************************************   03020000
030300*  CMNETC1 - ROW 9 OF DIALOG VARIABLES                            03030055
030400***************************************************************   03040000
030500     05  IN-FIELD-CMNETCQ1       PIC X(8)     VALUE 'CMNETCQ1'.   03050038
030600     05  IN-FIELD-CMNETCQ2       PIC X(8)     VALUE 'CMNETCQ2'.   03060038
030700     05  IN-FIELD-CMNETCQ3       PIC X(8)     VALUE 'CMNETCQ3'.   03070038
030800     05  IN-FIELD-CMNETCQ4       PIC X(8)     VALUE 'CMNETCQ4'.   03080038
030900     05  IN-FIELD-CMNETCQ5       PIC X(8)     VALUE 'CMNETCQ5'.   03090038
031000     05  IN-FIELD-CMNETCQ6       PIC X(8)     VALUE 'CMNETCQ6'.   03100038
031100     05  IN-FIELD-CMNETCQ7       PIC X(8)     VALUE 'CMNETCQ7'.   03110038
031200***************************************************************   03120000
031300*  CMNETC1 - ROW 10 OF DIALOG VARIABLES                           03130055
031400***************************************************************   03140000
031500     05  IN-FIELD-CMNETCP1       PIC X(8)     VALUE 'CMNETCP1'.   03150038
031600     05  IN-FIELD-CMNETCP2       PIC X(8)     VALUE 'CMNETCP2'.   03160038
031700     05  IN-FIELD-CMNETCP3       PIC X(8)     VALUE 'CMNETCP3'.   03170038
031800     05  IN-FIELD-CMNETCP4       PIC X(8)     VALUE 'CMNETCP4'.   03180038
031900     05  IN-FIELD-CMNETCP5       PIC X(8)     VALUE 'CMNETCP5'.   03190038
032000     05  IN-FIELD-CMNETCP6       PIC X(8)     VALUE 'CMNETCP6'.   03200038
032100     05  IN-FIELD-CMNETCP7       PIC X(8)     VALUE 'CMNETCP7'.   03210038
032200                                                                  03220000
032300 01  ID-ISPF-DIALOG-VARIABLES.                                    03230000
032400     05  ID-COMMAND-LINE         PIC X(72)    VALUE SPACES.       03240040
032500         88  ID-CL-CALENDAR-DETAILS-COMMAND   VALUE 'CALDTL'.     03250040
032600     05  ID-SHORT-MESSAGE        PIC X(24)    VALUE SPACES.       03260040
032700         88  ID-SM-CALENDAR-DETAILS-MSG       VALUE               03270042
032800             'CALDTL FOR CALL DETAILS'.                           03280041
032900     05  ID-LONG-MESSAGE         PIC X(72)    VALUE SPACES.       03290038
033000         88  ID-LM-CALENDAR-DETAILS-MSG       VALUE               03300042
033100             'ENTER CALDTL ON THE COMMAND LINE FOR THE DETAILS OF 03310041
033200-            'THE CALENDAR CALL'.                                 03320041
033300     05  ID-ISPF-TEMP-FILE-DSN   PIC X(44)    VALUE SPACES.       03330042
033400     05  ID-CMNETC0-VARIABLES.                                    03340000
033500         10  ID-CMNETC0-CMNETCSR PIC X(1)     VALUE SPACES.       03350038
033600             88  ID-CMNETC0-CMNETCSR-REFRESH  VALUE 'Y'.          03360038
033700             88  ID-CMNETC0-CMNETCSR-RETAIN   VALUE 'N'.          03370038
033800         10  ID-CMNETC0-CMNETCPD PIC X(10)    VALUE SPACES.       03380038
033900         10  ID-CMNETC0-CMNETCPF PIC X(10)    VALUE SPACES.       03390038
034000             88  ID-CMNETC0-CMNETCPF-DEFAULT  VALUE 'MMDDYY'.     03400038
034100         10  ID-CMNETC0-CMNETCCT PIC X(2)     VALUE SPACES.       03410038
034200         10  ID-CMNETC0-CMNETCCD PIC X(10)    VALUE SPACES.       03420038
034300         10  ID-CMNETC0-CMNETCCF PIC X(10)    VALUE SPACES.       03430038
034400         10  ID-CMNETC0-CMNETCPY PIC X(2)     VALUE SPACES.       03440038
034500         10  ID-CMNETC0-CMNETCID PIC X(1)     VALUE SPACES.       03450038
034600             88  ID-CMNETC0-CMNETCID-NO-REQUEST                   03460038
034700                                              VALUE ' '.          03470038
034800         10  ID-CMNETC0-CMNETCIY PIC X(5)     VALUE SPACES.       03480038
034900         10  ID-CMNETC0-CMNETCIY-N                                03490038
035000                                 REDEFINES ID-CMNETC0-CMNETCIY    03500038
035100                                 PIC 9(5).                        03510038
035200         10  ID-CMNETC0-CMNETCIB PIC X(5)     VALUE SPACES.       03520038
035300         10  ID-CMNETC0-CMNETCIB-N                                03530038
035400                                 REDEFINES ID-CMNETC0-CMNETCIB    03540038
035500                                 PIC 9(5).                        03550038
035600         10  ID-CMNETC0-CMNETCIW PIC X(3)     VALUE SPACES.       03560038
035700         10  ID-CMNETC0-CMNETCIW-N                                03570038
035800                                 REDEFINES ID-CMNETC0-CMNETCIW    03580038
035900                                 PIC 9(3).                        03590038
036000         10  ID-CMNETC0-CMNETCIP PIC X(3)     VALUE SPACES.       03600038
036100         10  ID-CMNETC0-CMNETCIP-N                                03610038
036200                                 REDEFINES ID-CMNETC0-CMNETCIP    03620038
036300                                 PIC 9(3).                        03630038
036400     05  ID-CMNETC1-VARIABLES.                                    03640000
036500         10  ID-CMNETC1-CMNETCFC PIC X(5)     VALUE SPACES.       03650038
036600             88  ID-CMNETC1-CMNETCFC-ACTL-DESC                    03660038
036700                                              VALUE 'ACTL '.      03670038
036800             88  ID-CMNETC1-CMNETCFC-F2-DESC  VALUE '4-5-4'.      03680038
036900             88  ID-CMNETC1-CMNETCFC-F4-DESC  VALUE '4-4-5'.      03690038
037000         10  ID-CMNETC1-CMNETCIA PIC X(5)     VALUE SPACES.       03700038
037100         10  ID-CMNETC1-CMNETCCP PIC X(7)     VALUE SPACES.       03710038
037200             88  ID-CMNETC1-CMNETCCP-DEFAULT  VALUE 'DEFAULT'.    03720038
037300         10  FILLER              REDEFINES ID-CMNETC1-CMNETCCP.   03730038
037400             15  FILLER          PIC X(2).                        03740038
037500             15  ID-CMNETC1-CMNETCCP-PIVOT-YR                     03750000
037600                                 PIC X(2).                        03760038
037700             15  FILLER          PIC X(3).                        03770038
037800         10  ID-CMNETC1-CMNETCII PIC X(14)    VALUE SPACES.       03780038
037900             88  ID-CMNETC1-CMNETCII-CAL-DAYS VALUE               03790038
038000                 ' CALENDAR DAYS'.                                03800038
038100             88  ID-CMNETC1-CMNETCII-BUS-DAYS VALUE               03810038
038200                 ' BUSINESS DAYS'.                                03820038
038300             88  ID-CMNETC1-CMNETCII-FISC-WKS VALUE               03830038
038400                 ' FISCAL WEEKS '.                                03840038
038500             88  ID-CMNETC1-CMNETCII-FISC-PRDS                    03850038
038600                                              VALUE               03860038
038700                 'FISCAL PERIODS'.                                03870038
038800         10  ID-CMNETC1-CMNETCRD PIC X(29)    VALUE SPACES.       03880038
038900         10  ID-CMNETC1-CMNETCCI PIC X(15)    VALUE SPACES.       03890038
039000             88  ID-CMNETC1-CMNETCCI-ELIGIBLE VALUE               03900038
039100                 'CALENDAR DAYS: '.                               03910038
039200         10  ID-CMNETC1-CMNETCDC PIC X(6)     VALUE SPACES.       03920038
039300         10  ID-CMNETC1-CMNETCDC-FORMATTED                        03930000
039400                                 REDEFINES ID-CMNETC1-CMNETCDC    03940038
039500                                 PIC ZZZZ9-.                      03950038
039600         10  ID-CMNETC1-CMNETCWI PIC X(12)    VALUE SPACES.       03960038
039700             88  ID-CMNETC1-CMNETCWI-ELIGIBLE VALUE               03970038
039800                 'FISCAL WKS: '.                                  03980038
039900         10  ID-CMNETC1-CMNETCDW PIC X(5)     VALUE SPACES.       03990038
040000         10  ID-CMNETC1-CMNETCDW-FORMATTED                        04000000
040100                                 REDEFINES ID-CMNETC1-CMNETCDW    04010038
040200                                 PIC ZZZ9-.                       04020038
040300         10  ID-CMNETC1-CMNETCGD PIC X(10)    VALUE SPACES.       04030038
040400         10  ID-CMNETC1-CMNETCJD PIC X(6)     VALUE SPACES.       04040038
040500         10  ID-CMNETC1-CMNETCBI PIC X(15)    VALUE SPACES.       04050038
040600             88  ID-CMNETC1-CMNETCBI-ELIGIBLE VALUE               04060038
040700                 'BUSINESS DAYS: '.                               04070038
040800         10  ID-CMNETC1-CMNETCDB PIC X(6)     VALUE SPACES.       04080038
040900         10  ID-CMNETC1-CMNETCDB-FORMATTED                        04090000
041000                                 REDEFINES ID-CMNETC1-CMNETCDB    04100038
041100                                 PIC ZZZZ9-.                      04110038
041200         10  ID-CMNETC1-CMNETCPI PIC X(13)    VALUE SPACES.       04120038
041300             88  ID-CMNETC1-CMNETCPI-ELIGIBLE VALUE               04130038
041400                 'FISCAL PRDS: '.                                 04140038
041500         10  ID-CMNETC1-CMNETCDP PIC X(5)     VALUE SPACES.       04150038
041600         10  ID-CMNETC1-CMNETCDP-FORMATTED                        04160000
041700                                 REDEFINES ID-CMNETC1-CMNETCDP    04170038
041800                                 PIC ZZZ9-.                       04180038
041900         10  ID-CMNETC1-CMNETCBD PIC X(1)     VALUE SPACES.       04190038
042000         10  ID-CMNETC1-CMNETCAH PIC X(1)     VALUE SPACES.       04200038
042100         10  ID-CMNETC1-CMNETCCH PIC X(1)     VALUE SPACES.       04210038
042200         10  ID-CMNETC1-CMNETCSH PIC X(1)     VALUE SPACES.       04220038
042300         10  ID-CMNETC1-CMNETCHN PIC X(15)    VALUE SPACES.       04230038
042400         10  ID-CMNETC1-CMNETCA2 PIC X(3)     VALUE SPACES.       04240038
042500         10  ID-CMNETC1-CMNETCA2-FORMATTED                        04250000
042600                                 REDEFINES ID-CMNETC1-CMNETCA2    04260038
042700                                 PIC ZZ9.                         04270038
042800         10  ID-CMNETC1-CMNETCA3 PIC X(2)     VALUE SPACES.       04280038
042900         10  ID-CMNETC1-CMNETCA3-FORMATTED                        04290000
043000                                 REDEFINES ID-CMNETC1-CMNETCA3    04300038
043100                                 PIC Z9.                          04310038
043200         10  ID-CMNETC1-CMNETCA6 PIC X(10)    VALUE SPACES.       04320038
043300         10  ID-CMNETC1-CMNETCA6-FORMATTED                        04330000
043400                                 REDEFINES ID-CMNETC1-CMNETCA6    04340038
043500                                 PIC 99/99/9999.                  04350038
043600         10  ID-CMNETC1-CMNETCA7 PIC X(10)    VALUE SPACES.       04360038
043700         10  ID-CMNETC1-CMNETCA7-FORMATTED                        04370000
043800                                 REDEFINES                        04380038
043900                                           ID-CMNETC1-CMNETCA7    04390038
044000                                 PIC 99/99/9999.                  04400038
044100         10  ID-CMNETC1-CMNETCY1 PIC X(4)     VALUE SPACES.       04410038
044200         10  ID-CMNETC1-CMNETCY2 PIC X(3)     VALUE SPACES.       04420038
044300         10  ID-CMNETC1-CMNETCY2-FORMATTED                        04430000
044400                                 REDEFINES ID-CMNETC1-CMNETCY2    04440038
044500                                 PIC ZZ9.                         04450038
044600         10  ID-CMNETC1-CMNETCY3 PIC X(3)     VALUE SPACES.       04460038
044700         10  ID-CMNETC1-CMNETCY3-FORMATTED                        04470000
044800                                 REDEFINES ID-CMNETC1-CMNETCY3    04480038
044900                                 PIC ZZ9.                         04490038
045000         10  ID-CMNETC1-CMNETCY4 PIC X(2)     VALUE SPACES.       04500038
045100         10  ID-CMNETC1-CMNETCY4-FORMATTED                        04510000
045200                                 REDEFINES ID-CMNETC1-CMNETCY4    04520038
045300                                 PIC Z9.                          04530038
045400         10  ID-CMNETC1-CMNETCY5 PIC X(2)     VALUE SPACES.       04540038
045500         10  ID-CMNETC1-CMNETCY5-FORMATTED                        04550000
045600                                 REDEFINES ID-CMNETC1-CMNETCY5    04560038
045700                                 PIC Z9.                          04570038
045800         10  ID-CMNETC1-CMNETCY6 PIC X(10)    VALUE SPACES.       04580038
045900         10  ID-CMNETC1-CMNETCY6-FORMATTED                        04590000
046000                                 REDEFINES ID-CMNETC1-CMNETCY6    04600038
046100                                 PIC 99/99/9999.                  04610038
046200         10  ID-CMNETC1-CMNETCY7 PIC X(10)    VALUE SPACES.       04620038
046300         10  ID-CMNETC1-CMNETCY7-FORMATTED                        04630000
046400                                 REDEFINES ID-CMNETC1-CMNETCY7    04640038
046500                                 PIC 99/99/9999.                  04650038
046600         10  ID-CMNETC1-CMNETCS1 PIC X(6)     VALUE SPACES.       04660038
046700         10  ID-CMNETC1-CMNETCS2 PIC X(3)     VALUE SPACES.       04670038
046800         10  ID-CMNETC1-CMNETCS2-FORMATTED                        04680000
046900                                 REDEFINES ID-CMNETC1-CMNETCS2    04690038
047000                                 PIC ZZ9.                         04700038
047100         10  ID-CMNETC1-CMNETCS3 PIC X(3)     VALUE SPACES.       04710038
047200         10  ID-CMNETC1-CMNETCS3-FORMATTED                        04720000
047300                                 REDEFINES ID-CMNETC1-CMNETCS3    04730038
047400                                 PIC ZZ9.                         04740038
047500         10  ID-CMNETC1-CMNETCS4 PIC X(2)     VALUE SPACES.       04750038
047600         10  ID-CMNETC1-CMNETCS4-FORMATTED                        04760000
047700                                 REDEFINES ID-CMNETC1-CMNETCS4    04770038
047800                                 PIC Z9.                          04780038
047900         10  ID-CMNETC1-CMNETCS5 PIC X(2)     VALUE SPACES.       04790038
048000         10  ID-CMNETC1-CMNETCS5-FORMATTED                        04800000
048100                                 REDEFINES ID-CMNETC1-CMNETCS5    04810038
048200                                 PIC Z9.                          04820038
048300         10  ID-CMNETC1-CMNETCS6 PIC X(10)    VALUE SPACES.       04830038
048400         10  ID-CMNETC1-CMNETCS6-FORMATTED                        04840000
048500                                 REDEFINES ID-CMNETC1-CMNETCS6    04850038
048600                                 PIC 99/99/9999.                  04860038
048700         10  ID-CMNETC1-CMNETCS7 PIC X(10)    VALUE SPACES.       04870038
048800         10  ID-CMNETC1-CMNETCS7-FORMATTED                        04880000
048900                                 REDEFINES ID-CMNETC1-CMNETCS7    04890038
049000                                 PIC 99/99/9999.                  04900038
049100         10  ID-CMNETC1-CMNETCQ1 PIC X(1)     VALUE SPACES.       04910038
049200         10  ID-CMNETC1-CMNETCQ2 PIC X(3)     VALUE SPACES.       04920038
049300         10  ID-CMNETC1-CMNETCQ2-FORMATTED                        04930000
049400                                 REDEFINES ID-CMNETC1-CMNETCQ2    04940038
049500                                 PIC ZZ9.                         04950038
049600         10  ID-CMNETC1-CMNETCQ3 PIC X(3)     VALUE SPACES.       04960038
049700         10  ID-CMNETC1-CMNETCQ3-FORMATTED                        04970000
049800                                 REDEFINES ID-CMNETC1-CMNETCQ3    04980038
049900                                 PIC ZZ9.                         04990038
050000         10  ID-CMNETC1-CMNETCQ4 PIC X(2)     VALUE SPACES.       05000038
050100         10  ID-CMNETC1-CMNETCQ4-FORMATTED                        05010000
050200                                 REDEFINES ID-CMNETC1-CMNETCQ4    05020038
050300                                 PIC Z9.                          05030038
050400         10  ID-CMNETC1-CMNETCQ5 PIC X(2)     VALUE SPACES.       05040038
050500         10  ID-CMNETC1-CMNETCQ5-FORMATTED                        05050000
050600                                 REDEFINES ID-CMNETC1-CMNETCQ5    05060038
050700                                 PIC Z9.                          05070038
050800         10  ID-CMNETC1-CMNETCQ6 PIC X(10)    VALUE SPACES.       05080038
050900         10  ID-CMNETC1-CMNETCQ6-FORMATTED                        05090000
051000                                 REDEFINES ID-CMNETC1-CMNETCQ6    05100038
051100                                 PIC 99/99/9999.                  05110038
051200         10  ID-CMNETC1-CMNETCQ7 PIC X(10)    VALUE SPACES.       05120038
051300         10  ID-CMNETC1-CMNETCQ7-FORMATTED                        05130000
051400                                 REDEFINES ID-CMNETC1-CMNETCQ7    05140038
051500                                 PIC 99/99/9999.                  05150038
051600         10  ID-CMNETC1-CMNETCP1 PIC X(6)     VALUE SPACES.       05160038
051700         10  FILLER              REDEFINES ID-CMNETC1-CMNETCP1.   05170038
051800             15  ID-CMNETC1-CMNETCP1-PERIOD-NBR                   05180000
051900                                 PIC 9(2).                        05190038
052000             15  FILLER          PIC X(1).                        05200038
052100                 88  ID-CMNETC1-CMNETCP1-SEPARATOR                05210000
052200                                              VALUE '-'.          05220038
052300             15  ID-CMNETC1-CMNETCP1-NAME-ABBR3                   05230000
052400                                 PIC X(3).                        05240038
052500         10  ID-CMNETC1-CMNETCP2 PIC X(3)     VALUE SPACES.       05250038
052600         10  ID-CMNETC1-CMNETCP2-FORMATTED                        05260000
052700                                 REDEFINES ID-CMNETC1-CMNETCP2    05270038
052800                                 PIC ZZ9.                         05280038
052900         10  ID-CMNETC1-CMNETCP3 PIC X(3)     VALUE SPACES.       05290038
053000         10  ID-CMNETC1-CMNETCP3-FORMATTED                        05300000
053100                                 REDEFINES ID-CMNETC1-CMNETCP3    05310038
053200                                 PIC ZZ9.                         05320038
053300         10  ID-CMNETC1-CMNETCP4 PIC X(2)     VALUE SPACES.       05330038
053400         10  ID-CMNETC1-CMNETCP4-FORMATTED                        05340000
053500                                 REDEFINES ID-CMNETC1-CMNETCP4    05350038
053600                                 PIC Z9.                          05360038
053700         10  ID-CMNETC1-CMNETCP5 PIC X(2)     VALUE SPACES.       05370038
053800         10  ID-CMNETC1-CMNETCP5-FORMATTED                        05380000
053900                                 REDEFINES ID-CMNETC1-CMNETCP5    05390038
054000                                 PIC Z9.                          05400038
054100         10  ID-CMNETC1-CMNETCP6 PIC X(10)    VALUE SPACES.       05410038
054200         10  ID-CMNETC1-CMNETCP6-FORMATTED                        05420000
054300                                 REDEFINES ID-CMNETC1-CMNETCP6    05430038
054400                                 PIC 99/99/9999.                  05440038
054500         10  ID-CMNETC1-CMNETCP7 PIC X(10)    VALUE SPACES.       05450038
054600         10  ID-CMNETC1-CMNETCP7-FORMATTED                        05460000
054700                                 REDEFINES ID-CMNETC1-CMNETCP7    05470038
054800                                 PIC 99/99/9999.                  05480038
054900                                                                  05490000
055000                                                                  05500000
055100******************************************************************05510000
055200 PROCEDURE DIVISION.                                              05520000
055300******************************************************************05530000
055400                                                                  05540000
055500 0000-MAINLINE.                                                   05550000
055600                                                                  05560000
055700*                                                                 05570000
055800*  REFRESH ENTIRE SCREEN ON NEXT DISPLAY.  ALL SCREEN VARIABLES   05580000
055900*  SPECIFIED IN THE PANEL BODY WILL BE RETRIEVED PRIOR TO THE     05590000
056000*  REDISPLAY.                                                     05600000
056100*                                                                 05610000
056200     CALL IC-ISPF-SERVICE-LINK USING IC-MISC-SERVICE-CONTROL      05620038
056300                                     IC-DISPLAY-SERVICE-DISPLAY   05630038
056400                                     IC-REFRESH-STATEMENT.        05640038
056500                                                                  05650000
056600     PERFORM 1000-INITIALIZE.                                     05660038
056700                                                                  05670000
056800     INITIALIZE ID-CMNETC0-VARIABLES                              05680000
056900                ID-CMNETC1-VARIABLES.                             05690000
057000     SET ID-CMNETC0-CMNETCSR-REFRESH                              05700033
057100         ID-CMNETC0-CMNETCPF-DEFAULT TO TRUE.                     05710033
057200     MOVE IN-FIELD-CMNETCSR TO IV-CURSOR-POSITION.                05720033
057300                                                                  05730000
057400     PERFORM 9000-DISPLAY-REQUEST-PANEL.                          05740000
057500                                                                  05750000
057600     PERFORM 2000-PROCESS-CALENDAR-REQUEST                        05760000
057700         UNTIL RETURN-CODE NOT = ZERO.                            05770000
057800                                                                  05780038
057900     IF PS-CAL-DETAILS-ALLOCATED                                  05790038
058000         PERFORM 9600-DELETE-DETAILS-FILE                         05800038
058100     END-IF.                                                      05810038
058200                                                                  05820000
058300     GOBACK.                                                      05830000
058400                                                                  05840000
058500******************************************************************05850000
058801*  INITIALIZE FOR PROGRAM PROCESSING.  DEFINE VARIABLES TO ISPF  *05880160
058802*  THROUGH THE FUNCTION POOL FOR ALL SCREEN I/O NEEDS, AND       *05880260
058803*  SHARED OR PROFILE POOL RETRIEVAL (IF NOT DIRECTLY REFERENCED  *05880360
058810*  IN SCREEN I/O).  RETRIEVE THE CURRENT VALUES FOR ALL REQUIRED *05881061
058820*  SHARED OR PROFILE POOL VARIABLES.  DETERMINE THE DSN TO BE    *05882061
058830*  USED FOR CALENDAR ROUTINE CALL DETAILS.                       *05883061
058900******************************************************************05890000
059000                                                                  05900000
059100 1000-INITIALIZE.                                                 05910038
059110                                                                  05911056
059120*                                                                 05912056
059130*  DEFINE SYSTEM VARIABLES TO ISPF THROUGH THE FUNCTION POOL      05913056
059140*                                                                 05914056
059150                                                                  05915056
059200     MOVE LENGTH OF ID-COMMAND-LINE TO IV-FIELD-LENGTH.           05920040
059300     CALL IC-ISPF-SERVICE-LINK USING IC-VARIABLE-SERVICE-VDEFINE  05930038
059400                                     IN-FIELD-COMMAND-LINE        05940040
059500                                     ID-COMMAND-LINE              05950040
059600                                     IC-FIELD-FORMAT-CHAR         05960000
059700                                     IV-FIELD-LENGTH.             05970000
061200                                                                  06120042
061300*                                                                 06130042
061400*  DEFINE NON-DISPLAYED DIALOG VARIABLES TO ISPF THROUGH THE      06140056
061410*  FUNCTION POOL                                                  06141056
061500*                                                                 06150042
061510                                                                  06151056
061600     MOVE LENGTH OF ID-ISPF-TEMP-FILE-DSN TO IV-FIELD-LENGTH.     06160042
061700     CALL IC-ISPF-SERVICE-LINK USING IC-VARIABLE-SERVICE-VDEFINE  06170042
061800                                     IN-FIELD-ISPF-TEMP-FILE-DSN  06180042
061900                                     ID-ISPF-TEMP-FILE-DSN        06190042
062000                                     IC-FIELD-FORMAT-CHAR         06200042
062100                                     IV-FIELD-LENGTH.             06210042
062110                                                                  06211056
062120*                                                                 06212056
062130*  DEFINE DIALOG VARIABLES COMMON TO ALL PANELS TO ISPF THROUGH   06213056
062131*  THE FUNCTION POOL                                              06213156
062140*                                                                 06214056
062150                                                                  06215056
062160     MOVE LENGTH OF ID-SHORT-MESSAGE TO IV-FIELD-LENGTH.          06216056
062170     CALL IC-ISPF-SERVICE-LINK USING IC-VARIABLE-SERVICE-VDEFINE  06217056
062180                                     IN-FIELD-SHORT-MESSAGE       06218056
062190                                     ID-SHORT-MESSAGE             06219056
062191                                     IC-FIELD-FORMAT-CHAR         06219156
062192                                     IV-FIELD-LENGTH.             06219256
062193                                                                  06219356
062194     MOVE LENGTH OF ID-LONG-MESSAGE TO IV-FIELD-LENGTH.           06219456
062195     CALL IC-ISPF-SERVICE-LINK USING IC-VARIABLE-SERVICE-VDEFINE  06219556
062196                                     IN-FIELD-LONG-MESSAGE        06219656
062197                                     ID-LONG-MESSAGE              06219756
062198                                     IC-FIELD-FORMAT-CHAR         06219856
062199                                     IV-FIELD-LENGTH.             06219956
062200                                                                  06220000
062300*                                                                 06230044
062400*  DEFINE DIALOG VARIABLES FOR LOCAL PANEL USAGE TO ISPF THROUGH  06240056
062410*  THE FUNCTION POOL                                              06241056
062500*                                                                 06250044
062600                                                                  06260044
062700     PERFORM 1100-DEFINE-CMNETC0-VARIABLES.                       06270000
062800     PERFORM 1200-DEFINE-CMNETC1-VARIABLES.                       06280000
062900*                                                                 06290044
063000     PERFORM 1300-RETRIEVE-POOL-VARIABLES.                        06300044
063100                                                                  06310038
063200*                                                                 06320038
063300*  DETERMINE THE DSN TO BE USED FOR THE CALENDAR ROUTINE          06330038
063400*  CALL DETAILS.  THE DSN SHOULD TAKE ALL ISPF TEMP FILE DSN      06340038
063500*  QUALIFIERS UP TO THE CONTROL QUALIFIER, AND ADD A NEW          06350038
063600*  QUALIFIER FOR CALENDAR ROUTINE CALL DETAILS.  CREATE A VERSION 06360038
063700*  OF THE DSN WITHOUT THE USER ID QUALIFER FOR USE BY THE ISPF    06370038
063800*  BROWSE FUNCTION.                                               06380038
063900*                                                                 06390038
064000                                                                  06400038
064100     INITIALIZE PV-TALLY                                          06410038
064200                PV-CAL-DETAILS-DSN                                06420040
064300                PV-CAL-DETAILS-DSN-WO-USERID.                     06430040
064400     INSPECT ID-ISPF-TEMP-FILE-DSN                                06440038
064500         TALLYING PV-TALLY                                        06450038
064600         FOR CHARACTERS BEFORE INITIAL PC-CNTL-DSN-QUALIFIER.     06460038
064700     MOVE ID-ISPF-TEMP-FILE-DSN (1:PV-TALLY) TO                   06470038
064800               PV-CAL-DETAILS-DSN.                                06480040
064900     ADD +1 TO PV-TALLY.                                          06490038
065000     MOVE PC-CAL-DETAILS-DSN-QUALIFIER TO                         06500040
065100               PV-CAL-DETAILS-DSN                                 06510040
065200                (PV-TALLY:LENGTH OF PC-CAL-DETAILS-DSN-QUALIFIER).06520040
065300*                                                                 06530038
065400     INITIALIZE PV-TALLY.                                         06540038
065500     INSPECT PV-CAL-DETAILS-DSN                                   06550040
065600         TALLYING PV-TALLY                                        06560038
065700         FOR CHARACTERS BEFORE INITIAL PC-DSN-QUALIFIER-SEP.      06570038
065800     ADD +2 TO PV-TALLY.                                          06580038
065900     MOVE PV-CAL-DETAILS-DSN (PV-TALLY:                           06590040
066000                  (LENGTH OF PV-CAL-DETAILS-DSN - PV-TALLY + 1))  06600040
066100               TO PV-CAL-DETAILS-DSN-WO-USERID.                   06610040
066200                                                                  06620045
066300     INITIALIZE PV-CALENDAR-DETAILS-ENTRIES                       06630045
066400                CD-CALENDAR-DETAILS-TABLE.                        06640045
066500*1000-EXIT.                                                       06650038
066600                                                                  06660000
066700******************************************************************06670000
066800*  DEFINE THE CMNETC0 DIALOG VARIABLES TO ISPF THROUGH THE       *06680056
066810*  FUNCTION POOL.  CMNETC0 IS THE CALENDAR ROUTINE REQUEST       *06681056
066820*  SPECIFICATION PANEL.                                          *06682056
066900******************************************************************06690000
067000                                                                  06700000
067100 1100-DEFINE-CMNETC0-VARIABLES.                                   06710000
067200                                                                  06720000
067300*--------------------------------------------                     06730000
067400* REFRESH BEFORE NEXT REQUEST INDICATOR                           06740033
067500*--------------------------------------------                     06750000
067600     MOVE LENGTH OF ID-CMNETC0-CMNETCSR TO IV-FIELD-LENGTH.       06760033
067700     CALL IC-ISPF-SERVICE-LINK USING IC-VARIABLE-SERVICE-VDEFINE  06770038
067800                                     IN-FIELD-CMNETCSR            06780033
067900                                     ID-CMNETC0-CMNETCSR          06790033
068000                                     IC-FIELD-FORMAT-CHAR         06800000
068100                                     IV-FIELD-LENGTH.             06810000
068200                                                                  06820033
068300*--------------------------------------------                     06830033
068400* PRIMARY DATE - DATA                                             06840033
068500*--------------------------------------------                     06850033
068600     MOVE LENGTH OF ID-CMNETC0-CMNETCPD TO IV-FIELD-LENGTH.       06860033
068700     CALL IC-ISPF-SERVICE-LINK USING IC-VARIABLE-SERVICE-VDEFINE  06870038
068800                                     IN-FIELD-CMNETCPD            06880033
068900                                     ID-CMNETC0-CMNETCPD          06890033
069000                                     IC-FIELD-FORMAT-CHAR         06900033
069100                                     IV-FIELD-LENGTH.             06910033
069200                                                                  06920000
069300*--------------------------------------------                     06930000
069400* PRIMARY DATE - FORMAT                                           06940000
069500*--------------------------------------------                     06950000
069600     MOVE LENGTH OF ID-CMNETC0-CMNETCPF TO IV-FIELD-LENGTH.       06960000
069700     CALL IC-ISPF-SERVICE-LINK USING IC-VARIABLE-SERVICE-VDEFINE  06970038
069800                                     IN-FIELD-CMNETCPF            06980000
069900                                     ID-CMNETC0-CMNETCPF          06990000
070000                                     IC-FIELD-FORMAT-CHAR         07000000
070100                                     IV-FIELD-LENGTH.             07010000
070200                                                                  07020000
070300*--------------------------------------------                     07030000
070400* PRIMARY DATE - CALENDAR                                         07040000
070500*--------------------------------------------                     07050000
070600     MOVE LENGTH OF ID-CMNETC0-CMNETCCT TO IV-FIELD-LENGTH.       07060000
070700     CALL IC-ISPF-SERVICE-LINK USING IC-VARIABLE-SERVICE-VDEFINE  07070038
070800                                     IN-FIELD-CMNETCCT            07080000
070900                                     ID-CMNETC0-CMNETCCT          07090000
071000                                     IC-FIELD-FORMAT-CHAR         07100000
071100                                     IV-FIELD-LENGTH.             07110000
071200                                                                  07120000
071300*--------------------------------------------                     07130000
071400* COMPARE DATE - DATA                                             07140000
071500*--------------------------------------------                     07150000
071600     MOVE LENGTH OF ID-CMNETC0-CMNETCCD TO IV-FIELD-LENGTH.       07160000
071700     CALL IC-ISPF-SERVICE-LINK USING IC-VARIABLE-SERVICE-VDEFINE  07170038
071800                                     IN-FIELD-CMNETCCD            07180000
071900                                     ID-CMNETC0-CMNETCCD          07190000
072000                                     IC-FIELD-FORMAT-CHAR         07200000
072100                                     IV-FIELD-LENGTH.             07210000
072200                                                                  07220000
072300*--------------------------------------------                     07230000
072400* COMPARE DATE - FORMAT                                           07240000
072500*--------------------------------------------                     07250000
072600     MOVE LENGTH OF ID-CMNETC0-CMNETCCF TO IV-FIELD-LENGTH.       07260000
072700     CALL IC-ISPF-SERVICE-LINK USING IC-VARIABLE-SERVICE-VDEFINE  07270038
072800                                     IN-FIELD-CMNETCCF            07280000
072900                                     ID-CMNETC0-CMNETCCF          07290000
073000                                     IC-FIELD-FORMAT-CHAR         07300000
073100                                     IV-FIELD-LENGTH.             07310000
073200                                                                  07320000
073300                                                                  07330000
073400*--------------------------------------------                     07340000
073500* CENTURY PIVOT YEAR                                              07350000
073600*--------------------------------------------                     07360000
073700     MOVE LENGTH OF ID-CMNETC0-CMNETCPY TO IV-FIELD-LENGTH.       07370000
073800     CALL IC-ISPF-SERVICE-LINK USING IC-VARIABLE-SERVICE-VDEFINE  07380038
073900                                     IN-FIELD-CMNETCPY            07390000
074000                                     ID-CMNETC0-CMNETCPY          07400000
074100                                     IC-FIELD-FORMAT-CHAR         07410000
074200                                     IV-FIELD-LENGTH.             07420000
074300                                                                  07430000
074400*--------------------------------------------                     07440000
074500* INCR/DECR FLAG                                                  07450000
074600*--------------------------------------------                     07460000
074700     MOVE LENGTH OF ID-CMNETC0-CMNETCID TO IV-FIELD-LENGTH.       07470000
074800     CALL IC-ISPF-SERVICE-LINK USING IC-VARIABLE-SERVICE-VDEFINE  07480038
074900                                     IN-FIELD-CMNETCID            07490000
075000                                     ID-CMNETC0-CMNETCID          07500000
075100                                     IC-FIELD-FORMAT-CHAR         07510000
075200                                     IV-FIELD-LENGTH.             07520000
075300                                                                  07530000
075400*--------------------------------------------                     07540000
075500* INCR/DECR - DAYS                                                07550000
075600*--------------------------------------------                     07560000
075700     MOVE LENGTH OF ID-CMNETC0-CMNETCIY TO IV-FIELD-LENGTH.       07570000
075800     CALL IC-ISPF-SERVICE-LINK USING IC-VARIABLE-SERVICE-VDEFINE  07580038
075900                                     IN-FIELD-CMNETCIY            07590000
076000                                     ID-CMNETC0-CMNETCIY          07600000
076100                                     IC-FIELD-FORMAT-CHAR         07610000
076200                                     IV-FIELD-LENGTH.             07620000
076300                                                                  07630000
076400*--------------------------------------------                     07640000
076500* INCR/DECR - BUSINESS DAYS                                       07650000
076600*--------------------------------------------                     07660000
076700     MOVE LENGTH OF ID-CMNETC0-CMNETCIB TO IV-FIELD-LENGTH.       07670000
076800     CALL IC-ISPF-SERVICE-LINK USING IC-VARIABLE-SERVICE-VDEFINE  07680038
076900                                     IN-FIELD-CMNETCIB            07690000
077000                                     ID-CMNETC0-CMNETCIB          07700000
077100                                     IC-FIELD-FORMAT-CHAR         07710000
077200                                     IV-FIELD-LENGTH.             07720000
077300                                                                  07730000
077400*--------------------------------------------                     07740000
077500* INCR/DECR - FISCAL WEEKS                                        07750000
077600*--------------------------------------------                     07760000
077700     MOVE LENGTH OF ID-CMNETC0-CMNETCIW TO IV-FIELD-LENGTH.       07770000
077800     CALL IC-ISPF-SERVICE-LINK USING IC-VARIABLE-SERVICE-VDEFINE  07780038
077900                                     IN-FIELD-CMNETCIW            07790000
078000                                     ID-CMNETC0-CMNETCIW          07800000
078100                                     IC-FIELD-FORMAT-CHAR         07810000
078200                                     IV-FIELD-LENGTH.             07820000
078300                                                                  07830000
078400*--------------------------------------------                     07840000
078500* INCR/DECR - FISCAL PERIODS                                      07850000
078600*--------------------------------------------                     07860000
078700     MOVE LENGTH OF ID-CMNETC0-CMNETCIP TO IV-FIELD-LENGTH.       07870000
078800     CALL IC-ISPF-SERVICE-LINK USING IC-VARIABLE-SERVICE-VDEFINE  07880038
078900                                     IN-FIELD-CMNETCIP            07890000
079000                                     ID-CMNETC0-CMNETCIP          07900000
079100                                     IC-FIELD-FORMAT-CHAR         07910000
079200                                     IV-FIELD-LENGTH.             07920000
079300*1100-EXIT.                                                       07930038
079400                                                                  07940000
079500******************************************************************07950000
079510*  DEFINE THE CMNETC1 DIALOG VARIABLES TO ISPF THROUGH THE       *07951056
079520*  FUNCTION POOL.  CMNETC1 IS THE CALENDAR ROUTINE REQUEST       *07952056
079530*  RESULTS PANEL.                                                *07953056
079700******************************************************************07970000
079800                                                                  07980000
079900 1200-DEFINE-CMNETC1-VARIABLES.                                   07990000
080000                                                                  08000000
080100*--------------------------------------------                     08010000
080200* CALENDAR TYPE DESCRIPTION                                       08020000
080300*--------------------------------------------                     08030000
080400     MOVE LENGTH OF ID-CMNETC1-CMNETCFC TO IV-FIELD-LENGTH.       08040000
080500     CALL IC-ISPF-SERVICE-LINK USING IC-VARIABLE-SERVICE-VDEFINE  08050038
080600                                     IN-FIELD-CMNETCFC            08060000
080700                                     ID-CMNETC1-CMNETCFC          08070000
080800                                     IC-FIELD-FORMAT-CHAR         08080000
080900                                     IV-FIELD-LENGTH.             08090000
081000                                                                  08100000
081100*--------------------------------------------                     08110000
081200* INCR/DECR - AMOUNT                                              08120000
081300*--------------------------------------------                     08130000
081400     MOVE LENGTH OF ID-CMNETC1-CMNETCIA TO IV-FIELD-LENGTH.       08140000
081500     CALL IC-ISPF-SERVICE-LINK USING IC-VARIABLE-SERVICE-VDEFINE  08150038
081600                                     IN-FIELD-CMNETCIA            08160000
081700                                     ID-CMNETC1-CMNETCIA          08170000
081800                                     IC-FIELD-FORMAT-CHAR         08180000
081900                                     IV-FIELD-LENGTH.             08190000
082000                                                                  08200000
082100*--------------------------------------------                     08210000
082200* CENTURY PIVOT YEAR                                              08220000
082300*--------------------------------------------                     08230000
082400     MOVE LENGTH OF ID-CMNETC1-CMNETCCP TO IV-FIELD-LENGTH.       08240000
082500     CALL IC-ISPF-SERVICE-LINK USING IC-VARIABLE-SERVICE-VDEFINE  08250038
082600                                     IN-FIELD-CMNETCCP            08260000
082700                                     ID-CMNETC1-CMNETCCP          08270000
082800                                     IC-FIELD-FORMAT-CHAR         08280000
082900                                     IV-FIELD-LENGTH.             08290000
083000                                                                  08300000
083100*--------------------------------------------                     08310000
083200* INCR/DECR - AMOUNT TYPE                                         08320000
083300*--------------------------------------------                     08330000
083400     MOVE LENGTH OF ID-CMNETC1-CMNETCII TO IV-FIELD-LENGTH.       08340000
083500     CALL IC-ISPF-SERVICE-LINK USING IC-VARIABLE-SERVICE-VDEFINE  08350038
083600                                     IN-FIELD-CMNETCII            08360000
083700                                     ID-CMNETC1-CMNETCII          08370000
083800                                     IC-FIELD-FORMAT-CHAR         08380000
083900                                     IV-FIELD-LENGTH.             08390000
084000                                                                  08400000
084100*--------------------------------------------                     08410000
084200* RESULT DATE - FORMATTED                                         08420000
084300*--------------------------------------------                     08430000
084400     MOVE LENGTH OF ID-CMNETC1-CMNETCRD TO IV-FIELD-LENGTH.       08440000
084500     CALL IC-ISPF-SERVICE-LINK USING IC-VARIABLE-SERVICE-VDEFINE  08450038
084600                                     IN-FIELD-CMNETCRD            08460000
084700                                     ID-CMNETC1-CMNETCRD          08470000
084800                                     IC-FIELD-FORMAT-CHAR         08480000
084900                                     IV-FIELD-LENGTH.             08490000
085000                                                                  08500000
085100*--------------------------------------------                     08510000
085200* COMPARISON DIFFERENCES - CALENDAR DAYS ID                       08520000
085300*--------------------------------------------                     08530000
085400     MOVE LENGTH OF ID-CMNETC1-CMNETCCI TO IV-FIELD-LENGTH.       08540000
085500     CALL IC-ISPF-SERVICE-LINK USING IC-VARIABLE-SERVICE-VDEFINE  08550038
085600                                     IN-FIELD-CMNETCCI            08560000
085700                                     ID-CMNETC1-CMNETCCI          08570000
085800                                     IC-FIELD-FORMAT-CHAR         08580000
085900                                     IV-FIELD-LENGTH.             08590000
086000                                                                  08600000
086100*--------------------------------------------                     08610000
086200* COMPARISON DIFFERENCES - CALENDAR DAYS                          08620000
086300*--------------------------------------------                     08630000
086400     MOVE LENGTH OF ID-CMNETC1-CMNETCDC TO IV-FIELD-LENGTH.       08640000
086500     CALL IC-ISPF-SERVICE-LINK USING IC-VARIABLE-SERVICE-VDEFINE  08650038
086600                                     IN-FIELD-CMNETCDC            08660000
086700                                     ID-CMNETC1-CMNETCDC          08670000
086800                                     IC-FIELD-FORMAT-CHAR         08680000
086900                                     IV-FIELD-LENGTH.             08690000
087000                                                                  08700000
087100*--------------------------------------------                     08710000
087200* COMPARISON DIFFERENCES - FISCAL WEEKS ID                        08720000
087300*--------------------------------------------                     08730000
087400     MOVE LENGTH OF ID-CMNETC1-CMNETCWI TO IV-FIELD-LENGTH.       08740000
087500     CALL IC-ISPF-SERVICE-LINK USING IC-VARIABLE-SERVICE-VDEFINE  08750038
087600                                     IN-FIELD-CMNETCWI            08760000
087700                                     ID-CMNETC1-CMNETCWI          08770000
087800                                     IC-FIELD-FORMAT-CHAR         08780000
087900                                     IV-FIELD-LENGTH.             08790000
088000                                                                  08800000
088100*--------------------------------------------                     08810000
088200* COMPARISON DIFFERENCES - FISCAL WEEKS                           08820000
088300*--------------------------------------------                     08830000
088400     MOVE LENGTH OF ID-CMNETC1-CMNETCDW TO IV-FIELD-LENGTH.       08840000
088500     CALL IC-ISPF-SERVICE-LINK USING IC-VARIABLE-SERVICE-VDEFINE  08850038
088600                                     IN-FIELD-CMNETCDW            08860000
088700                                     ID-CMNETC1-CMNETCDW          08870000
088800                                     IC-FIELD-FORMAT-CHAR         08880000
088900                                     IV-FIELD-LENGTH.             08890000
089000                                                                  08900000
089100*--------------------------------------------                     08910000
089200* RESULT DATE - GREGORIAN                                         08920000
089300*--------------------------------------------                     08930000
089400     MOVE LENGTH OF ID-CMNETC1-CMNETCGD TO IV-FIELD-LENGTH.       08940000
089500     CALL IC-ISPF-SERVICE-LINK USING IC-VARIABLE-SERVICE-VDEFINE  08950038
089600                                     IN-FIELD-CMNETCGD            08960000
089700                                     ID-CMNETC1-CMNETCGD          08970000
089800                                     IC-FIELD-FORMAT-CHAR         08980000
089900                                     IV-FIELD-LENGTH.             08990000
090000                                                                  09000000
090100*--------------------------------------------                     09010000
090200* RESULT DATE - JULIAN                                            09020000
090300*--------------------------------------------                     09030000
090400     MOVE LENGTH OF ID-CMNETC1-CMNETCJD TO IV-FIELD-LENGTH.       09040000
090500     CALL IC-ISPF-SERVICE-LINK USING IC-VARIABLE-SERVICE-VDEFINE  09050038
090600                                     IN-FIELD-CMNETCJD            09060000
090700                                     ID-CMNETC1-CMNETCJD          09070000
090800                                     IC-FIELD-FORMAT-CHAR         09080000
090900                                     IV-FIELD-LENGTH.             09090000
091000                                                                  09100000
091100*--------------------------------------------                     09110000
091200* COMPARISON DIFFERENCES - BUSINESS DAYS ID                       09120000
091300*--------------------------------------------                     09130000
091400     MOVE LENGTH OF ID-CMNETC1-CMNETCBI TO IV-FIELD-LENGTH.       09140000
091500     CALL IC-ISPF-SERVICE-LINK USING IC-VARIABLE-SERVICE-VDEFINE  09150038
091600                                     IN-FIELD-CMNETCBI            09160000
091700                                     ID-CMNETC1-CMNETCBI          09170000
091800                                     IC-FIELD-FORMAT-CHAR         09180000
091900                                     IV-FIELD-LENGTH.             09190000
092000                                                                  09200000
092100*--------------------------------------------                     09210000
092200* COMPARISON DIFFERENCES - BUSINESS DAYS                          09220000
092300*--------------------------------------------                     09230000
092400     MOVE LENGTH OF ID-CMNETC1-CMNETCDB TO IV-FIELD-LENGTH.       09240000
092500     CALL IC-ISPF-SERVICE-LINK USING IC-VARIABLE-SERVICE-VDEFINE  09250038
092600                                     IN-FIELD-CMNETCDB            09260000
092700                                     ID-CMNETC1-CMNETCDB          09270000
092800                                     IC-FIELD-FORMAT-CHAR         09280000
092900                                     IV-FIELD-LENGTH.             09290000
093000                                                                  09300000
093100*--------------------------------------------                     09310000
093200* COMPARISON DIFFERENCES - FISCAL PERIODS ID                      09320000
093300*--------------------------------------------                     09330000
093400     MOVE LENGTH OF ID-CMNETC1-CMNETCPI TO IV-FIELD-LENGTH.       09340000
093500     CALL IC-ISPF-SERVICE-LINK USING IC-VARIABLE-SERVICE-VDEFINE  09350038
093600                                     IN-FIELD-CMNETCPI            09360000
093700                                     ID-CMNETC1-CMNETCPI          09370000
093800                                     IC-FIELD-FORMAT-CHAR         09380000
093900                                     IV-FIELD-LENGTH.             09390000
094000                                                                  09400000
094100*--------------------------------------------                     09410000
094200* COMPARISON DIFFERENCES - FISCAL PERIODS                         09420000
094300*--------------------------------------------                     09430000
094400     MOVE LENGTH OF ID-CMNETC1-CMNETCDP TO IV-FIELD-LENGTH.       09440000
094500     CALL IC-ISPF-SERVICE-LINK USING IC-VARIABLE-SERVICE-VDEFINE  09450038
094600                                     IN-FIELD-CMNETCDP            09460000
094700                                     ID-CMNETC1-CMNETCDP          09470000
094800                                     IC-FIELD-FORMAT-CHAR         09480000
094900                                     IV-FIELD-LENGTH.             09490000
095000                                                                  09500000
095100*--------------------------------------------                     09510000
095200* CORPORATE BUSINESS DAY                                          09520000
095300*--------------------------------------------                     09530000
095400     MOVE LENGTH OF ID-CMNETC1-CMNETCBD TO IV-FIELD-LENGTH.       09540000
095500     CALL IC-ISPF-SERVICE-LINK USING IC-VARIABLE-SERVICE-VDEFINE  09550038
095600                                     IN-FIELD-CMNETCBD            09560000
095700                                     ID-CMNETC1-CMNETCBD          09570000
095800                                     IC-FIELD-FORMAT-CHAR         09580000
095900                                     IV-FIELD-LENGTH.             09590000
096000                                                                  09600000
096100*--------------------------------------------                     09610000
096200* ACTUAL HOLIDAY                                                  09620000
096300*--------------------------------------------                     09630000
096400     MOVE LENGTH OF ID-CMNETC1-CMNETCAH TO IV-FIELD-LENGTH.       09640000
096500     CALL IC-ISPF-SERVICE-LINK USING IC-VARIABLE-SERVICE-VDEFINE  09650038
096600                                     IN-FIELD-CMNETCAH            09660000
096700                                     ID-CMNETC1-CMNETCAH          09670000
096800                                     IC-FIELD-FORMAT-CHAR         09680000
096900                                     IV-FIELD-LENGTH.             09690000
097000                                                                  09700000
097100*--------------------------------------------                     09710000
097200* CORPORATE HOLIDAY                                               09720000
097300*--------------------------------------------                     09730000
097400     MOVE LENGTH OF ID-CMNETC1-CMNETCCH TO IV-FIELD-LENGTH.       09740000
097500     CALL IC-ISPF-SERVICE-LINK USING IC-VARIABLE-SERVICE-VDEFINE  09750038
097600                                     IN-FIELD-CMNETCCH            09760000
097700                                     ID-CMNETC1-CMNETCCH          09770000
097800                                     IC-FIELD-FORMAT-CHAR         09780000
097900                                     IV-FIELD-LENGTH.             09790000
098000                                                                  09800000
098100*--------------------------------------------                     09810000
098200* STORE HOLIDAY                                                   09820000
098300*--------------------------------------------                     09830000
098400     MOVE LENGTH OF ID-CMNETC1-CMNETCSH TO IV-FIELD-LENGTH.       09840000
098500     CALL IC-ISPF-SERVICE-LINK USING IC-VARIABLE-SERVICE-VDEFINE  09850038
098600                                     IN-FIELD-CMNETCSH            09860000
098700                                     ID-CMNETC1-CMNETCSH          09870000
098800                                     IC-FIELD-FORMAT-CHAR         09880000
098900                                     IV-FIELD-LENGTH.             09890000
099000                                                                  09900000
099100*--------------------------------------------                     09910000
099200* HOLIDAY NAME                                                    09920000
099300*--------------------------------------------                     09930000
099400     MOVE LENGTH OF ID-CMNETC1-CMNETCHN TO IV-FIELD-LENGTH.       09940000
099500     CALL IC-ISPF-SERVICE-LINK USING IC-VARIABLE-SERVICE-VDEFINE  09950038
099600                                     IN-FIELD-CMNETCHN            09960000
099700                                     ID-CMNETC1-CMNETCHN          09970000
099800                                     IC-FIELD-FORMAT-CHAR         09980000
099900                                     IV-FIELD-LENGTH.             09990000
100000                                                                  10000000
100100*--------------------------------------------                     10010000
100200* ACTUAL - # DAYS                                                 10020000
100300*--------------------------------------------                     10030000
100400     MOVE LENGTH OF ID-CMNETC1-CMNETCA2 TO IV-FIELD-LENGTH.       10040000
100500     CALL IC-ISPF-SERVICE-LINK USING IC-VARIABLE-SERVICE-VDEFINE  10050038
100600                                     IN-FIELD-CMNETCA2            10060000
100700                                     ID-CMNETC1-CMNETCA2          10070000
100800                                     IC-FIELD-FORMAT-CHAR         10080000
100900                                     IV-FIELD-LENGTH.             10090000
101000                                                                  10100000
101100*--------------------------------------------                     10110000
101200* ACTUAL - DAYS OF                                                10120000
101300*--------------------------------------------                     10130000
101400     MOVE LENGTH OF ID-CMNETC1-CMNETCA3 TO IV-FIELD-LENGTH.       10140000
101500     CALL IC-ISPF-SERVICE-LINK USING IC-VARIABLE-SERVICE-VDEFINE  10150038
101600                                     IN-FIELD-CMNETCA3            10160000
101700                                     ID-CMNETC1-CMNETCA3          10170000
101800                                     IC-FIELD-FORMAT-CHAR         10180000
101900                                     IV-FIELD-LENGTH.             10190000
102000                                                                  10200000
102100*--------------------------------------------                     10210000
102200* ACTUAL - 1ST DAY OF                                             10220000
102300*--------------------------------------------                     10230000
102400     MOVE LENGTH OF ID-CMNETC1-CMNETCA6 TO IV-FIELD-LENGTH.       10240000
102500     CALL IC-ISPF-SERVICE-LINK USING IC-VARIABLE-SERVICE-VDEFINE  10250038
102600                                     IN-FIELD-CMNETCA6            10260000
102700                                     ID-CMNETC1-CMNETCA6          10270000
102800                                     IC-FIELD-FORMAT-CHAR         10280000
102900                                     IV-FIELD-LENGTH.             10290000
103000                                                                  10300000
103100*--------------------------------------------                     10310000
103200* ACTUAL - LAST DAY OF                                            10320000
103300*--------------------------------------------                     10330000
103400     MOVE LENGTH OF ID-CMNETC1-CMNETCA7 TO IV-FIELD-LENGTH.       10340000
103500     CALL IC-ISPF-SERVICE-LINK USING IC-VARIABLE-SERVICE-VDEFINE  10350038
103600                                     IN-FIELD-CMNETCA7            10360000
103700                                     ID-CMNETC1-CMNETCA7          10370000
103800                                     IC-FIELD-FORMAT-CHAR         10380000
103900                                     IV-FIELD-LENGTH.             10390000
104000                                                                  10400000
104100                                                                  10410000
104200*--------------------------------------------                     10420000
104300* YEAR - DESCRIPTION                                              10430000
104400*--------------------------------------------                     10440000
104500     MOVE LENGTH OF ID-CMNETC1-CMNETCY1 TO IV-FIELD-LENGTH.       10450000
104600     CALL IC-ISPF-SERVICE-LINK USING IC-VARIABLE-SERVICE-VDEFINE  10460038
104700                                     IN-FIELD-CMNETCY1            10470000
104800                                     ID-CMNETC1-CMNETCY1          10480000
104900                                     IC-FIELD-FORMAT-CHAR         10490000
105000                                     IV-FIELD-LENGTH.             10500000
105100                                                                  10510000
105200*--------------------------------------------                     10520000
105300* YEAR - # DAYS                                                   10530000
105400*--------------------------------------------                     10540000
105500     MOVE LENGTH OF ID-CMNETC1-CMNETCY2 TO IV-FIELD-LENGTH.       10550000
105600     CALL IC-ISPF-SERVICE-LINK USING IC-VARIABLE-SERVICE-VDEFINE  10560038
105700                                     IN-FIELD-CMNETCY2            10570000
105800                                     ID-CMNETC1-CMNETCY2          10580000
105900                                     IC-FIELD-FORMAT-CHAR         10590000
106000                                     IV-FIELD-LENGTH.             10600000
106100                                                                  10610000
106200*--------------------------------------------                     10620000
106300* YEAR - DAYS OF                                                  10630000
106400*--------------------------------------------                     10640000
106500     MOVE LENGTH OF ID-CMNETC1-CMNETCY3 TO IV-FIELD-LENGTH.       10650000
106600     CALL IC-ISPF-SERVICE-LINK USING IC-VARIABLE-SERVICE-VDEFINE  10660038
106700                                     IN-FIELD-CMNETCY3            10670000
106800                                     ID-CMNETC1-CMNETCY3          10680000
106900                                     IC-FIELD-FORMAT-CHAR         10690000
107000                                     IV-FIELD-LENGTH.             10700000
107100                                                                  10710000
107200*--------------------------------------------                     10720000
107300* YEAR - NUM OF WEEKS                                             10730000
107400*--------------------------------------------                     10740000
107500     MOVE LENGTH OF ID-CMNETC1-CMNETCY4 TO IV-FIELD-LENGTH.       10750000
107600     CALL IC-ISPF-SERVICE-LINK USING IC-VARIABLE-SERVICE-VDEFINE  10760038
107700                                     IN-FIELD-CMNETCY4            10770000
107800                                     ID-CMNETC1-CMNETCY4          10780000
107900                                     IC-FIELD-FORMAT-CHAR         10790000
108000                                     IV-FIELD-LENGTH.             10800000
108100                                                                  10810000
108200*--------------------------------------------                     10820000
108300* YEAR - WEEK OF                                                  10830000
108400*--------------------------------------------                     10840000
108500     MOVE LENGTH OF ID-CMNETC1-CMNETCY5 TO IV-FIELD-LENGTH.       10850000
108600     CALL IC-ISPF-SERVICE-LINK USING IC-VARIABLE-SERVICE-VDEFINE  10860038
108700                                     IN-FIELD-CMNETCY5            10870000
108800                                     ID-CMNETC1-CMNETCY5          10880000
108900                                     IC-FIELD-FORMAT-CHAR         10890000
109000                                     IV-FIELD-LENGTH.             10900000
109100                                                                  10910000
109200*--------------------------------------------                     10920000
109300* YEAR - 1ST DAY OF                                               10930000
109400*--------------------------------------------                     10940000
109500     MOVE LENGTH OF ID-CMNETC1-CMNETCY6 TO IV-FIELD-LENGTH.       10950000
109600     CALL IC-ISPF-SERVICE-LINK USING IC-VARIABLE-SERVICE-VDEFINE  10960038
109700                                     IN-FIELD-CMNETCY6            10970000
109800                                     ID-CMNETC1-CMNETCY6          10980000
109900                                     IC-FIELD-FORMAT-CHAR         10990000
110000                                     IV-FIELD-LENGTH.             11000000
110100                                                                  11010000
110200*--------------------------------------------                     11020000
110300* YEAR - LAST DAY OF                                              11030000
110400*--------------------------------------------                     11040000
110500     MOVE LENGTH OF ID-CMNETC1-CMNETCY7 TO IV-FIELD-LENGTH.       11050000
110600     CALL IC-ISPF-SERVICE-LINK USING IC-VARIABLE-SERVICE-VDEFINE  11060038
110700                                     IN-FIELD-CMNETCY7            11070000
110800                                     ID-CMNETC1-CMNETCY7          11080000
110900                                     IC-FIELD-FORMAT-CHAR         11090000
111000                                     IV-FIELD-LENGTH.             11100000
111100                                                                  11110000
111200                                                                  11120000
111300*--------------------------------------------                     11130000
111400* SEASON - DESCRIPTION                                            11140000
111500*--------------------------------------------                     11150000
111600     MOVE LENGTH OF ID-CMNETC1-CMNETCS1 TO IV-FIELD-LENGTH.       11160000
111700     CALL IC-ISPF-SERVICE-LINK USING IC-VARIABLE-SERVICE-VDEFINE  11170038
111800                                     IN-FIELD-CMNETCS1            11180000
111900                                     ID-CMNETC1-CMNETCS1          11190000
112000                                     IC-FIELD-FORMAT-CHAR         11200000
112100                                     IV-FIELD-LENGTH.             11210000
112200                                                                  11220000
112300*--------------------------------------------                     11230000
112400* SEASON - # DAYS                                                 11240000
112500*--------------------------------------------                     11250000
112600     MOVE LENGTH OF ID-CMNETC1-CMNETCS2 TO IV-FIELD-LENGTH.       11260000
112700     CALL IC-ISPF-SERVICE-LINK USING IC-VARIABLE-SERVICE-VDEFINE  11270038
112800                                     IN-FIELD-CMNETCS2            11280000
112900                                     ID-CMNETC1-CMNETCS2          11290000
113000                                     IC-FIELD-FORMAT-CHAR         11300000
113100                                     IV-FIELD-LENGTH.             11310000
113200                                                                  11320000
113300*--------------------------------------------                     11330000
113400* SEASON - DAY OF                                                 11340000
113500*--------------------------------------------                     11350000
113600     MOVE LENGTH OF ID-CMNETC1-CMNETCS3 TO IV-FIELD-LENGTH.       11360000
113700     CALL IC-ISPF-SERVICE-LINK USING IC-VARIABLE-SERVICE-VDEFINE  11370038
113800                                     IN-FIELD-CMNETCS3            11380000
113900                                     ID-CMNETC1-CMNETCS3          11390000
114000                                     IC-FIELD-FORMAT-CHAR         11400000
114100                                     IV-FIELD-LENGTH.             11410000
114200                                                                  11420000
114300*--------------------------------------------                     11430000
114400* SEASON - NUM OF WEEKS                                           11440000
114500*--------------------------------------------                     11450000
114600     MOVE LENGTH OF ID-CMNETC1-CMNETCS4 TO IV-FIELD-LENGTH.       11460000
114700     CALL IC-ISPF-SERVICE-LINK USING IC-VARIABLE-SERVICE-VDEFINE  11470038
114800                                     IN-FIELD-CMNETCS4            11480000
114900                                     ID-CMNETC1-CMNETCS4          11490000
115000                                     IC-FIELD-FORMAT-CHAR         11500000
115100                                     IV-FIELD-LENGTH.             11510000
115200                                                                  11520000
115300*--------------------------------------------                     11530000
115400* SEASON - WEEK OF                                                11540000
115500*--------------------------------------------                     11550000
115600     MOVE LENGTH OF ID-CMNETC1-CMNETCS5 TO IV-FIELD-LENGTH.       11560000
115700     CALL IC-ISPF-SERVICE-LINK USING IC-VARIABLE-SERVICE-VDEFINE  11570038
115800                                     IN-FIELD-CMNETCS5            11580000
115900                                     ID-CMNETC1-CMNETCS5          11590000
116000                                     IC-FIELD-FORMAT-CHAR         11600000
116100                                     IV-FIELD-LENGTH.             11610000
116200                                                                  11620000
116300*--------------------------------------------                     11630000
116400* SEASON - 1ST DAY OF                                             11640000
116500*--------------------------------------------                     11650000
116600     MOVE LENGTH OF ID-CMNETC1-CMNETCS6 TO IV-FIELD-LENGTH.       11660000
116700     CALL IC-ISPF-SERVICE-LINK USING IC-VARIABLE-SERVICE-VDEFINE  11670038
116800                                     IN-FIELD-CMNETCS6            11680000
116900                                     ID-CMNETC1-CMNETCS6          11690000
117000                                     IC-FIELD-FORMAT-CHAR         11700000
117100                                     IV-FIELD-LENGTH.             11710000
117200                                                                  11720000
117300*--------------------------------------------                     11730000
117400* SEASON - LAST DAY OF                                            11740000
117500*--------------------------------------------                     11750000
117600     MOVE LENGTH OF ID-CMNETC1-CMNETCS7 TO IV-FIELD-LENGTH.       11760000
117700     CALL IC-ISPF-SERVICE-LINK USING IC-VARIABLE-SERVICE-VDEFINE  11770038
117800                                     IN-FIELD-CMNETCS7            11780000
117900                                     ID-CMNETC1-CMNETCS7          11790000
118000                                     IC-FIELD-FORMAT-CHAR         11800000
118100                                     IV-FIELD-LENGTH.             11810000
118200                                                                  11820000
118300                                                                  11830000
118400*--------------------------------------------                     11840000
118500* QUARTER - DESCRIPTION                                           11850000
118600*--------------------------------------------                     11860000
118700     MOVE LENGTH OF ID-CMNETC1-CMNETCQ1 TO IV-FIELD-LENGTH.       11870000
118800     CALL IC-ISPF-SERVICE-LINK USING IC-VARIABLE-SERVICE-VDEFINE  11880038
118900                                     IN-FIELD-CMNETCQ1            11890000
119000                                     ID-CMNETC1-CMNETCQ1          11900000
119100                                     IC-FIELD-FORMAT-CHAR         11910000
119200                                     IV-FIELD-LENGTH.             11920000
119300                                                                  11930000
119400*--------------------------------------------                     11940000
119500* QUARTER - # DAYS                                                11950000
119600*--------------------------------------------                     11960000
119700     MOVE LENGTH OF ID-CMNETC1-CMNETCQ2 TO IV-FIELD-LENGTH.       11970000
119800     CALL IC-ISPF-SERVICE-LINK USING IC-VARIABLE-SERVICE-VDEFINE  11980038
119900                                     IN-FIELD-CMNETCQ2            11990000
120000                                     ID-CMNETC1-CMNETCQ2          12000000
120100                                     IC-FIELD-FORMAT-CHAR         12010000
120200                                     IV-FIELD-LENGTH.             12020000
120300                                                                  12030000
120400*--------------------------------------------                     12040000
120500* QUARTER - DAYS OF                                               12050000
120600*--------------------------------------------                     12060000
120700     MOVE LENGTH OF ID-CMNETC1-CMNETCQ3 TO IV-FIELD-LENGTH.       12070000
120800     CALL IC-ISPF-SERVICE-LINK USING IC-VARIABLE-SERVICE-VDEFINE  12080038
120900                                     IN-FIELD-CMNETCQ3            12090000
121000                                     ID-CMNETC1-CMNETCQ3          12100000
121100                                     IC-FIELD-FORMAT-CHAR         12110000
121200                                     IV-FIELD-LENGTH.             12120000
121300                                                                  12130000
121400*--------------------------------------------                     12140000
121500* QUARTER - NUM OF WEEKS                                          12150000
121600*--------------------------------------------                     12160000
121700     MOVE LENGTH OF ID-CMNETC1-CMNETCQ4 TO IV-FIELD-LENGTH.       12170000
121800     CALL IC-ISPF-SERVICE-LINK USING IC-VARIABLE-SERVICE-VDEFINE  12180038
121900                                     IN-FIELD-CMNETCQ4            12190000
122000                                     ID-CMNETC1-CMNETCQ4          12200000
122100                                     IC-FIELD-FORMAT-CHAR         12210000
122200                                     IV-FIELD-LENGTH.             12220000
122300                                                                  12230000
122400*--------------------------------------------                     12240000
122500* QUARTER - WEEK OF                                               12250000
122600*--------------------------------------------                     12260000
122700     MOVE LENGTH OF ID-CMNETC1-CMNETCQ5 TO IV-FIELD-LENGTH.       12270000
122800     CALL IC-ISPF-SERVICE-LINK USING IC-VARIABLE-SERVICE-VDEFINE  12280038
122900                                     IN-FIELD-CMNETCQ5            12290000
123000                                     ID-CMNETC1-CMNETCQ5          12300000
123100                                     IC-FIELD-FORMAT-CHAR         12310000
123200                                     IV-FIELD-LENGTH.             12320000
123300                                                                  12330000
123400*--------------------------------------------                     12340000
123500* QUARTER - 1ST DAY OF                                            12350000
123600*--------------------------------------------                     12360000
123700     MOVE LENGTH OF ID-CMNETC1-CMNETCQ6 TO IV-FIELD-LENGTH.       12370000
123800     CALL IC-ISPF-SERVICE-LINK USING IC-VARIABLE-SERVICE-VDEFINE  12380038
123900                                     IN-FIELD-CMNETCQ6            12390000
124000                                     ID-CMNETC1-CMNETCQ6          12400000
124100                                     IC-FIELD-FORMAT-CHAR         12410000
124200                                     IV-FIELD-LENGTH.             12420000
124300                                                                  12430000
124400*--------------------------------------------                     12440000
124500* QUARTER - LAST DAY OF                                           12450000
124600*--------------------------------------------                     12460000
124700     MOVE LENGTH OF ID-CMNETC1-CMNETCQ7 TO IV-FIELD-LENGTH.       12470000
124800     CALL IC-ISPF-SERVICE-LINK USING IC-VARIABLE-SERVICE-VDEFINE  12480038
124900                                     IN-FIELD-CMNETCQ7            12490000
125000                                     ID-CMNETC1-CMNETCQ7          12500000
125100                                     IC-FIELD-FORMAT-CHAR         12510000
125200                                     IV-FIELD-LENGTH.             12520000
125300                                                                  12530000
125400                                                                  12540000
125500*--------------------------------------------                     12550000
125600* PERIOD - DESCRIPTION                                            12560000
125700*--------------------------------------------                     12570000
125800     MOVE LENGTH OF ID-CMNETC1-CMNETCP1 TO IV-FIELD-LENGTH.       12580000
125900     CALL IC-ISPF-SERVICE-LINK USING IC-VARIABLE-SERVICE-VDEFINE  12590038
126000                                     IN-FIELD-CMNETCP1            12600000
126100                                     ID-CMNETC1-CMNETCP1          12610000
126200                                     IC-FIELD-FORMAT-CHAR         12620000
126300                                     IV-FIELD-LENGTH.             12630000
126400                                                                  12640000
126500*--------------------------------------------                     12650000
126600* PERIOD - # DAYS                                                 12660000
126700*--------------------------------------------                     12670000
126800     MOVE LENGTH OF ID-CMNETC1-CMNETCP2 TO IV-FIELD-LENGTH.       12680000
126900     CALL IC-ISPF-SERVICE-LINK USING IC-VARIABLE-SERVICE-VDEFINE  12690038
127000                                     IN-FIELD-CMNETCP2            12700000
127100                                     ID-CMNETC1-CMNETCP2          12710000
127200                                     IC-FIELD-FORMAT-CHAR         12720000
127300                                     IV-FIELD-LENGTH.             12730000
127400                                                                  12740000
127500*--------------------------------------------                     12750000
127600* PERIOD - DAYS OF                                                12760000
127700*--------------------------------------------                     12770000
127800     MOVE LENGTH OF ID-CMNETC1-CMNETCP3 TO IV-FIELD-LENGTH.       12780000
127900     CALL IC-ISPF-SERVICE-LINK USING IC-VARIABLE-SERVICE-VDEFINE  12790038
128000                                     IN-FIELD-CMNETCP3            12800000
128100                                     ID-CMNETC1-CMNETCP3          12810000
128200                                     IC-FIELD-FORMAT-CHAR         12820000
128300                                     IV-FIELD-LENGTH.             12830000
128400                                                                  12840000
128500*--------------------------------------------                     12850000
128600* PERIOD - NUM OF WEEKS                                           12860000
128700*--------------------------------------------                     12870000
128800     MOVE LENGTH OF ID-CMNETC1-CMNETCP4 TO IV-FIELD-LENGTH.       12880000
128900     CALL IC-ISPF-SERVICE-LINK USING IC-VARIABLE-SERVICE-VDEFINE  12890038
129000                                     IN-FIELD-CMNETCP4            12900000
129100                                     ID-CMNETC1-CMNETCP4          12910000
129200                                     IC-FIELD-FORMAT-CHAR         12920000
129300                                     IV-FIELD-LENGTH.             12930000
129400                                                                  12940000
129500*--------------------------------------------                     12950000
129600* PERIOD - WEEK OF                                                12960000
129700*--------------------------------------------                     12970000
129800     MOVE LENGTH OF ID-CMNETC1-CMNETCP5 TO IV-FIELD-LENGTH.       12980000
129900     CALL IC-ISPF-SERVICE-LINK USING IC-VARIABLE-SERVICE-VDEFINE  12990038
130000                                     IN-FIELD-CMNETCP5            13000000
130100                                     ID-CMNETC1-CMNETCP5          13010000
130200                                     IC-FIELD-FORMAT-CHAR         13020000
130300                                     IV-FIELD-LENGTH.             13030000
130400                                                                  13040000
130500*--------------------------------------------                     13050000
130600* PERIOD - 1ST DAY OF                                             13060000
130700*--------------------------------------------                     13070000
130800     MOVE LENGTH OF ID-CMNETC1-CMNETCP6 TO IV-FIELD-LENGTH.       13080000
130900     CALL IC-ISPF-SERVICE-LINK USING IC-VARIABLE-SERVICE-VDEFINE  13090038
131000                                     IN-FIELD-CMNETCP6            13100000
131100                                     ID-CMNETC1-CMNETCP6          13110000
131200                                     IC-FIELD-FORMAT-CHAR         13120000
131300                                     IV-FIELD-LENGTH.             13130000
131400                                                                  13140000
131500*--------------------------------------------                     13150000
131600* PERIOD - LAST DAY OF                                            13160000
131700*--------------------------------------------                     13170000
131800     MOVE LENGTH OF ID-CMNETC1-CMNETCP7 TO IV-FIELD-LENGTH.       13180000
131900     CALL IC-ISPF-SERVICE-LINK USING IC-VARIABLE-SERVICE-VDEFINE  13190038
132000                                     IN-FIELD-CMNETCP7            13200000
132100                                     ID-CMNETC1-CMNETCP7          13210000
132200                                     IC-FIELD-FORMAT-CHAR         13220000
132300                                     IV-FIELD-LENGTH.             13230000
132400*1200-EXIT.                                                       13240038
132500                                                                  13250000
132600******************************************************************13260042
132700*  RETRIEVE VALUES FROM THE SHARED VARIABLE POOL OR APPLICATION  *13270042
132800*  PROFILE VARIABLE POOL AND PLACE THEM IN THE FUNCTION VARIABLE *13280042
132900*  POOL.                                                         *13290042
133000******************************************************************13300042
133100                                                                  13310042
133200 1300-RETRIEVE-POOL-VARIABLES.                                    13320042
133300     CALL IC-ISPF-SERVICE-LINK USING IC-VARIABLE-SERVICE-VGET     13330042
133400                                     IN-FIELD-ISPF-TEMP-FILE-DSN  13340042
133500                                     IC-SHARED-VARIABLE-POOL.     13350042
133600*1300-EXIT.                                                       13360042
133700                                                                  13370042
133800******************************************************************13380000
133900*  PROCESS A CALENDAR REQUEST ENTERED ON THE CMNETC0 PANEL.      *13390000
134000*  EDIT THE FIELDS TO ENSURE A PROPER CALL TO THE CALENDAR       *13400000
134100*  ROUTINE.  EDITS TO ENFORCE REQUIRED FIELDS, AND NUMERIC       *13410000
134200*  ENTRY ARE DEFINED IN THE BODY SECTION OF THE PANEL DEFINITION *13420000
134300*  AND ARE ENFORCED BY ISPF.  IF NO ERRORS ARE DETECTED BY THE   *13430000
134400*  LOCAL EDITS, CALL THE CALENDAR ROUTINE, AND CHECK FOR ERRORS  *13440000
134500*  DETECTED BY THE CALENDAR ROUTINE.  IF THE ENTIRE REQUEST IS   *13450000
134600*  ERROR-FREE, FORMAT AND PRESENT THE RESULTS PANEL.  CONTINUE   *13460000
134700*  TO FORMAT AND PRESENT THE RESULTS PANEL UNTIL AN END IS       *13470000
134800*  REQUESTED (VIA AN END COMMAND, OR PF3, WHICH EXECUTES AN      *13480000
134900*  END COMMAND).  IF ANY ERRORS ARE DETECTED WITH THE REQUEST,   *13490000
135000*  REDISPLAY THE SPECIFICATION PANEL WITH THE APPROPRIATE ERROR  *13500000
135100*  MESSAGE AND CURSOR POSITION.                                  *13510000
135200******************************************************************13520000
135300                                                                  13530000
135400 2000-PROCESS-CALENDAR-REQUEST.                                   13540000
135600     INITIALIZE DPG51                                             13560000
135700                DPG52                                             13570000
135800                DPG53                                             13580000
135900                DPG54                                             13590000
136000                DPG55                                             13600000
136100                DPG56.                                            13610000
136200     SET PS-NO-EDIT-ERRORS TO TRUE.                               13620000
136300                                                                  13630000
136310*                                                                 13631056
136320*  EDIT THE COMMAND LINE                                          13632057
136330*                                                                 13633056
136340                                                                  13634056
136400     IF ID-COMMAND-LINE NOT = SPACES                              13640047
136500         IF PS-NO-EDIT-ERRORS                                     13650047
136600             MOVE 'INVALID COMMAND' TO ID-SHORT-MESSAGE           13660054
136610             MOVE 'NO COMMANDS ARE SUPPORTED ON THIS PANEL' TO    13661054
136620                       ID-LONG-MESSAGE                            13662054
136700             SET PS-EDIT-ERROR TO TRUE                            13670047
136800             MOVE IN-FIELD-COMMAND-LINE TO                        13680047
136900                       IV-CURSOR-POSITION                         13690047
137000         END-IF                                                   13700047
137100     END-IF.                                                      13710047
137110                                                                  13711057
137120*                                                                 13712057
137131*  EDIT THE REFRESH BEFORE NEXT REQUEST INDICATOR                 13713157
137140*                                                                 13714057
137150                                                                  13715057
137300     IF ((NOT ID-CMNETC0-CMNETCSR-REFRESH)                        13730033
137400             AND (NOT ID-CMNETC0-CMNETCSR-RETAIN))                13740034
137500         IF PS-NO-EDIT-ERRORS                                     13750033
137600             MOVE 'INVALID RESPONSE - MUST BE Y OR N' TO          13760033
137700                       ID-LONG-MESSAGE                            13770033
137800             SET PS-EDIT-ERROR TO TRUE                            13780033
137900             MOVE IN-FIELD-CMNETCSR TO                            13790033
138000                       IV-CURSOR-POSITION                         13800033
138100         END-IF                                                   13810033
138200     END-IF.                                                      13820033
138210                                                                  13821057
138220*                                                                 13822057
138230*  BEGIN BUILDING THE PARAMETERS FOR THE CALENDAR ROUTINE CALL AS 13823057
138231*  THE DIALOG VARIABLES ARE EDITED.                               13823157
138240*                                                                 13824057
138300                                                                  13830033
138400     MOVE ID-CMNETC0-CMNETCPD TO DPG52-LK-DATE-INPUT.             13840000
138500                                                                  13850000
138510*                                                                 13851057
138520*  EDIT THE PRIMARY DATE FORMAT CODE                              13852057
138530*                                                                 13853057
138540                                                                  13854057
138600     MOVE ID-CMNETC0-CMNETCPF TO DPG52-LK-DATE-FORMAT-CODE.       13860000
138700     IF ((NOT DPG52-LK-DTE-ISO-FMT)                               13870000
138800             AND (NOT DPG52-LK-DTE-ISO)                           13880000
138900             AND (NOT DPG52-LK-DTE-GREG-CC-FMT)                   13890000
139000             AND (NOT DPG52-LK-DTE-GREG-CC)                       13900000
139100             AND (NOT DPG52-LK-DTE-GREG-FMT)                      13910000
139200             AND (NOT DPG52-LK-DTE-GREG)                          13920000
139300             AND (NOT DPG52-LK-DTE-JULIAN-CC)                     13930000
139400             AND (NOT DPG52-LK-DTE-JULIAN-FMT)                    13940000
139500             AND (NOT DPG52-LK-DTE-JULIAN)                        13950000
139600             AND (NOT DPG52-LK-DTE-FISC-WEEK-CC)                  13960000
139700             AND (NOT DPG52-LK-DTE-FISC-WEEK)                     13970000
139800             AND (NOT DPG52-LK-DTE-FISC-PRD-CC)                   13980000
139900             AND (NOT DPG52-LK-DTE-FISC-PRD))                     13990000
140000         IF PS-NO-EDIT-ERRORS                                     14000000
140100             MOVE 'INVALID PRIMARY DATE FORMAT CODE' TO           14010000
140200                       ID-LONG-MESSAGE                            14020000
140300             SET PS-EDIT-ERROR TO TRUE                            14030000
140400             MOVE IN-FIELD-CMNETCPF TO                            14040000
140500                       IV-CURSOR-POSITION                         14050000
140600         END-IF                                                   14060000
140700     END-IF.                                                      14070000
140710                                                                  14071057
140720*                                                                 14072057
140730*  EDIT THE CALENDAR TYPE                                         14073057
140740*                                                                 14074057
140800                                                                  14080000
140900     MOVE ID-CMNETC0-CMNETCCT TO DPG51-CALENDAR-TYPE.             14090000
141000     IF ((NOT DPG51-ACTUAL-CALENDAR-ONLY)                         14100000
141100             AND (NOT DPG51-FISCAL-454-CALENDAR)                  14110000
141200             AND (NOT DPG51-FISCAL-JAN-DEC-F2))                   14120000
141300         IF PS-NO-EDIT-ERRORS                                     14130000
141400             MOVE 'INVALID CALENDAR TYPE' TO ID-LONG-MESSAGE      14140000
141500             SET PS-EDIT-ERROR TO TRUE                            14150000
141600             MOVE IN-FIELD-CMNETCCT TO                            14160000
141700                       IV-CURSOR-POSITION                         14170000
141800         END-IF                                                   14180000
141900     END-IF.                                                      14190000
142000                                                                  14200000
142020*                                                                 14202057
142030*  EDIT THE COMPARE DATE FORMAT CODE, AND IF A COMPARE DATE WAS   14203057
142040*  SPECIFIED WITHOUT A COMPARE DATE FORMAT CODE, DEFAULT TO USING 14204057
142041*  THE PRIMARY DATE FORMAT CODE.                                  14204157
142042*                                                                 14204257
142050                                                                  14205057
142100     MOVE ID-CMNETC0-CMNETCCD TO DPG53-LK-CMPR-DATE-INPUT.        14210000
142200     MOVE ID-CMNETC0-CMNETCCF TO DPG53-LK-CMPR-DATE-FORMAT-CODE.  14220000
142300     EVALUATE TRUE                                                14230000
142400         WHEN ID-CMNETC0-CMNETCCF = SPACES                        14240000
142500             IF ID-CMNETC0-CMNETCCD NOT = SPACES                  14250000
142600                 MOVE ID-CMNETC0-CMNETCPF TO                      14260000
142700                           DPG53-LK-CMPR-DATE-FORMAT-CODE         14270000
142800                           ID-CMNETC0-CMNETCCF                    14280000
142900             END-IF                                               14290000
143000         WHEN ID-CMNETC0-CMNETCCD = SPACES                        14300000
143100             IF PS-NO-EDIT-ERRORS                                 14310000
143200                 MOVE 'COMPARE DATE REQUIRED WITH COMPARE DATE FOR14320000
143300-                          'MAT CODE' TO ID-LONG-MESSAGE          14330000
143400                 SET PS-EDIT-ERROR TO TRUE                        14340000
143500                 MOVE IN-FIELD-CMNETCCD TO                        14350000
143600                           IV-CURSOR-POSITION                     14360000
143700             END-IF                                               14370000
143800         WHEN DPG53-LK-CMPR-DTE-ISO-FMT                           14380000
143900         WHEN DPG53-LK-CMPR-DTE-ISO                               14390000
144000         WHEN DPG53-LK-CMPR-DTE-GREG-CC-FMT                       14400000
144100         WHEN DPG53-LK-CMPR-DTE-GREG-CC                           14410000
144200         WHEN DPG53-LK-CMPR-DTE-GREG-FMT                          14420000
144300         WHEN DPG53-LK-CMPR-DTE-GREG                              14430000
144400         WHEN DPG53-LK-CMPR-DTE-JULIAN-CC                         14440000
144500         WHEN DPG53-LK-CMPR-DTE-JULIAN-FMT                        14450000
144600         WHEN DPG53-LK-CMPR-DTE-JULIAN                            14460000
144700         WHEN DPG53-LK-CMPR-DTE-FISC-WEEK-CC                      14470000
144800         WHEN DPG53-LK-CMPR-DTE-FISC-WEEK                         14480000
144900         WHEN DPG53-LK-CMPR-DTE-FISC-PRD-CC                       14490000
145000         WHEN DPG53-LK-CMPR-DTE-FISC-PRD                          14500000
145100             CONTINUE                                             14510000
145200         WHEN OTHER                                               14520000
145300             IF PS-NO-EDIT-ERRORS                                 14530000
145400                 MOVE 'INVALID COMPARE DATE FORMAT CODE' TO       14540000
145500                           ID-LONG-MESSAGE                        14550000
145600                 SET PS-EDIT-ERROR TO TRUE                        14560000
145700                 MOVE IN-FIELD-CMNETCCF TO                        14570000
145800                           IV-CURSOR-POSITION                     14580000
145900             END-IF                                               14590000
146000     END-EVALUATE.                                                14600000
146010                                                                  14601057
146020*                                                                 14602057
146030*  EDIT THE CENTURY PIVOT YEAR                                    14603057
146060*                                                                 14606057
146100                                                                  14610000
146200     IF ID-CMNETC0-CMNETCPY NUMERIC                               14620000
146300         MOVE ID-CMNETC0-CMNETCPY TO                              14630000
146400                   DPG51-CENTURY-PIVOT-YEAR-X                     14640000
146500     ELSE                                                         14650000
146600         IF ID-CMNETC0-CMNETCPY NOT = SPACES                      14660000
146700             IF PS-NO-EDIT-ERRORS                                 14670000
146800                 MOVE 'PIVOT YEAR MUST BE TWO DIGITS, OR REMAIN BL14680000
146900-                          'ANK TO USE THE DEFAULT' TO            14690000
147000                           ID-LONG-MESSAGE                        14700000
147100                 SET PS-EDIT-ERROR TO TRUE                        14710000
147200                 MOVE IN-FIELD-CMNETCPY TO                        14720000
147300                      IV-CURSOR-POSITION                          14730000
147400             END-IF                                               14740000
147500         END-IF                                                   14750000
147600     END-IF.                                                      14760000
147700                                                                  14770000
147720*                                                                 14772057
147730*  EDIT THE INCREMENT/DECREMENT FLAG                              14773057
147740*                                                                 14774057
147750                                                                  14775057
147800     MOVE ID-CMNETC0-CMNETCID TO DPG51-INCREMENT-DECREMENT-FLAG.  14780000
147900     IF (NOT DPG51-INCR-DECR-FLAG-VALID)                          14790000
148000         IF PS-NO-EDIT-ERRORS                                     14800000
148100             MOVE 'INVALID INCREMENT/DECREMENT FLAG' TO           14810000
148200                       ID-LONG-MESSAGE                            14820000
148300             SET PS-EDIT-ERROR TO TRUE                            14830000
148400             MOVE IN-FIELD-CMNETCID TO                            14840000
148500                       IV-CURSOR-POSITION                         14850000
148600         END-IF                                                   14860000
148700     END-IF.                                                      14870000
148800                                                                  14880000
148810*                                                                 14881057
148820*  EDIT THE INDIVIDUAL INCREMENT/DECREMENT VALUE FIELDS, AND      14882057
148821*  COUNT THE NUMBER OF INCREMENT/DECREMENT FIELDS THAT ARE IN USE 14882157
148830*                                                                 14883057
148840                                                                  14884057
148900     INITIALIZE PV-INCR-DECR-CTR.                                 14890000
149000                                                                  14900000
149100     IF ID-CMNETC0-CMNETCIY NOT = SPACES                          14910000
149200         ADD 1 TO PV-INCR-DECR-CTR                                14920000
149300         MOVE ID-CMNETC0-CMNETCIY TO DP010I-UNEDITED-FIELD        14930000
149400         MOVE LENGTH OF ID-CMNETC0-CMNETCIY TO                    14940000
149500                   DP010I-MAXIMUM-DIGITS                          14950000
149600         INITIALIZE DP010I-MAXIMUM-DECIMALS                       14960000
149700         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  14970000
149800         CALL DP010I-NUMERIC-EDIT-ROUTINE                         14980000
149900             USING DP010I-NUMERIC-EDIT-AREA                       14990000
150000         IF DP010I-ERROR-DETECTED                                 15000000
150100             IF PS-NO-EDIT-ERRORS                                 15010000
150200                 MOVE 'INVALID INCR/DECR DAYS' TO ID-LONG-MESSAGE 15020000
150300                 SET PS-EDIT-ERROR TO TRUE                        15030000
150400                 MOVE IN-FIELD-CMNETCIY TO                        15040000
150500                           IV-CURSOR-POSITION                     15050000
150600             END-IF                                               15060000
150700         ELSE                                                     15070000
150800             MOVE DP010I-NUMERIC-FIELD TO ID-CMNETC0-CMNETCIY-N   15080000
150900             MOVE ID-CMNETC0-CMNETCIY-N TO DPG51-INCR-DECR-DAYS-9 15090000
151000         END-IF                                                   15100000
151100     END-IF.                                                      15110000
151200                                                                  15120000
151300     IF ID-CMNETC0-CMNETCIB NOT = SPACES                          15130000
151400         ADD 1 TO PV-INCR-DECR-CTR                                15140000
151500         MOVE ID-CMNETC0-CMNETCIB TO DP010I-UNEDITED-FIELD        15150000
151600         MOVE LENGTH OF ID-CMNETC0-CMNETCIB TO                    15160000
151700                   DP010I-MAXIMUM-DIGITS                          15170000
151800         INITIALIZE DP010I-MAXIMUM-DECIMALS                       15180000
151900         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  15190000
152000         CALL DP010I-NUMERIC-EDIT-ROUTINE                         15200000
152100             USING DP010I-NUMERIC-EDIT-AREA                       15210000
152200         IF DP010I-ERROR-DETECTED                                 15220000
152300             IF PS-NO-EDIT-ERRORS                                 15230000
152400                 MOVE 'INVALID INCR/DECR BUSINESS DAYS' TO        15240000
152500                           ID-LONG-MESSAGE                        15250000
152600                 SET PS-EDIT-ERROR TO TRUE                        15260000
152700                 MOVE IN-FIELD-CMNETCIB TO                        15270000
152800                           IV-CURSOR-POSITION                     15280000
152900             END-IF                                               15290000
153000         ELSE                                                     15300000
153100             MOVE DP010I-NUMERIC-FIELD TO ID-CMNETC0-CMNETCIB-N   15310000
153200             MOVE ID-CMNETC0-CMNETCIB-N TO                        15320000
153300                       DPG51-INCR-DECR-BUS-DAYS-9                 15330000
153400         END-IF                                                   15340000
153500     END-IF.                                                      15350000
153600                                                                  15360000
153700     IF ID-CMNETC0-CMNETCIW NOT = SPACES                          15370000
153800         ADD 1 TO PV-INCR-DECR-CTR                                15380000
153900         MOVE ID-CMNETC0-CMNETCIW TO DP010I-UNEDITED-FIELD        15390000
154000         MOVE LENGTH OF ID-CMNETC0-CMNETCIW TO                    15400000
154100                   DP010I-MAXIMUM-DIGITS                          15410000
154200         INITIALIZE DP010I-MAXIMUM-DECIMALS                       15420000
154300         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  15430000
154400         CALL DP010I-NUMERIC-EDIT-ROUTINE                         15440000
154500             USING DP010I-NUMERIC-EDIT-AREA                       15450000
154600         IF DP010I-ERROR-DETECTED                                 15460000
154700             IF PS-NO-EDIT-ERRORS                                 15470000
154800                 MOVE 'INVALID INCR/DECR FISCAL WEEKS' TO         15480000
154900                           ID-LONG-MESSAGE                        15490000
155000                 SET PS-EDIT-ERROR TO TRUE                        15500000
155100                 MOVE IN-FIELD-CMNETCIW TO                        15510000
155200                           IV-CURSOR-POSITION                     15520000
155300             END-IF                                               15530000
155400         ELSE                                                     15540000
155500             MOVE DP010I-NUMERIC-FIELD TO ID-CMNETC0-CMNETCIW-N   15550000
155600             MOVE ID-CMNETC0-CMNETCIW-N TO                        15560000
155700                       DPG51-INCR-DECR-FISCAL-WEEK-9              15570000
155800         END-IF                                                   15580000
155900     END-IF.                                                      15590000
156000                                                                  15600000
156100     IF ID-CMNETC0-CMNETCIP NOT = SPACES                          15610000
156200         ADD 1 TO PV-INCR-DECR-CTR                                15620000
156300         MOVE ID-CMNETC0-CMNETCIP TO DP010I-UNEDITED-FIELD        15630000
156400         MOVE LENGTH OF ID-CMNETC0-CMNETCIP TO                    15640000
156500                   DP010I-MAXIMUM-DIGITS                          15650000
156600         INITIALIZE DP010I-MAXIMUM-DECIMALS                       15660000
156700         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  15670000
156800         CALL DP010I-NUMERIC-EDIT-ROUTINE                         15680000
156900             USING DP010I-NUMERIC-EDIT-AREA                       15690000
157000         IF DP010I-ERROR-DETECTED                                 15700000
157100             IF PS-NO-EDIT-ERRORS                                 15710000
157200                 MOVE 'INVALID INCR/DECR FISCAL PERIODS' TO       15720000
157300                           ID-LONG-MESSAGE                        15730000
157400                 SET PS-EDIT-ERROR TO TRUE                        15740000
157500                 MOVE IN-FIELD-CMNETCIP TO                        15750000
157600                           IV-CURSOR-POSITION                     15760000
157700             END-IF                                               15770000
157800         ELSE                                                     15780000
157900             MOVE DP010I-NUMERIC-FIELD TO ID-CMNETC0-CMNETCIP-N   15790000
158000             MOVE ID-CMNETC0-CMNETCIP-N TO                        15800000
158100                       DPG51-INCR-DECR-FISCAL-PRD-9               15810000
158200         END-IF                                                   15820000
158300     END-IF.                                                      15830000
158310                                                                  15831057
158320*                                                                 15832057
158330*  CROSS EDIT THE INCREMENT/DECREMENT FLAG AND INCREMENT/DECREMENT15833057
158340*  FIELDS OPTIONS.  THE INCREMENT/DECREMENT FIELD OPTIONS ARE     15834057
158341*  MUTUALLY EXCLUSIVE, AND SHOULD NOT BE USED IF NO INCREMENT/    15834157
158342*  DECREMENT IS REQUESTED.                                        15834257
158350*                                                                 15835057
158400                                                                  15840000
158500     EVALUATE TRUE                                                15850000
158600         WHEN PS-EDIT-ERROR                                       15860000
158700             CONTINUE                                             15870000
158800         WHEN ((ID-CMNETC0-CMNETCID-NO-REQUEST) AND               15880000
158900                      (PV-INCR-DECR-CTR NOT = ZERO))              15890000
159000             MOVE 'INCR/DECR VALUE NOT ALLOWED WITHOUT INCR/DECR F15900000
159100-                      'LAG SET' TO ID-LONG-MESSAGE               15910000
159200             SET PS-EDIT-ERROR TO TRUE                            15920000
159300             EVALUATE TRUE                                        15930000
159400                 WHEN ID-CMNETC0-CMNETCIY NOT = SPACES            15940000
159500                     MOVE IN-FIELD-CMNETCIY TO                    15950000
159600                               IV-CURSOR-POSITION                 15960000
159700                 WHEN ID-CMNETC0-CMNETCIB NOT = SPACES            15970000
159800                     MOVE IN-FIELD-CMNETCIB TO                    15980000
159900                               IV-CURSOR-POSITION                 15990000
160000                 WHEN ID-CMNETC0-CMNETCIW NOT = SPACES            16000000
160100                     MOVE IN-FIELD-CMNETCIW TO                    16010000
160200                               IV-CURSOR-POSITION                 16020000
160300                 WHEN ID-CMNETC0-CMNETCIP NOT = SPACES            16030000
160400                     MOVE IN-FIELD-CMNETCIP TO                    16040000
160500                               IV-CURSOR-POSITION                 16050000
160600             END-EVALUATE                                         16060000
160700         WHEN ID-CMNETC0-CMNETCID-NO-REQUEST                      16070000
160800         WHEN PV-INCR-DECR-CTR = 1                                16080000
160900             CONTINUE                                             16090000
161000         WHEN PV-INCR-DECR-CTR > 1                                16100000
161100             MOVE 'ONLY ONE INCR/DECR VALUE IS ALLOWED PER CALL'  16110000
161200                      TO ID-LONG-MESSAGE                          16120000
161300             SET PS-EDIT-ERROR TO TRUE                            16130000
161400             EVALUATE TRUE                                        16140000
161500                 WHEN ID-CMNETC0-CMNETCIP NOT = SPACES            16150000
161600                     MOVE IN-FIELD-CMNETCIP TO                    16160000
161700                               IV-CURSOR-POSITION                 16170000
161800                 WHEN ID-CMNETC0-CMNETCIW NOT = SPACES            16180000
161900                     MOVE IN-FIELD-CMNETCIW TO                    16190000
162000                               IV-CURSOR-POSITION                 16200000
162100                 WHEN ID-CMNETC0-CMNETCIB NOT = SPACES            16210000
162200                     MOVE IN-FIELD-CMNETCIB TO                    16220000
162300                               IV-CURSOR-POSITION                 16230000
162400                 WHEN ID-CMNETC0-CMNETCIY NOT = SPACES            16240000
162500                     MOVE IN-FIELD-CMNETCIY TO                    16250000
162600                               IV-CURSOR-POSITION                 16260000
162700             END-EVALUATE                                         16270000
162800         WHEN PV-INCR-DECR-CTR = 0                                16280000
162900             MOVE 'AN INCR/DECR VALUE MUST BE PROVIDED WHEN INCR/D16290000
163000-                      'ECR FLAG IS SET' TO ID-LONG-MESSAGE       16300000
163100             SET PS-EDIT-ERROR TO TRUE                            16310000
163200             MOVE IN-FIELD-CMNETCIY TO                            16320000
163300                       IV-CURSOR-POSITION                         16330000
163400     END-EVALUATE.                                                16340000
163510                                                                  16351057
163520*                                                                 16352057
163530*  CALL THE CALENDAR ROUTINE IF A VALID REQUEST HAS BEEN          16353057
163540*  SPECIFIED                                                      16354057
163570*                                                                 16357057
163580                                                                  16358057
163600     IF PS-NO-EDIT-ERRORS                                         16360000
163700         CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51            16370000
163800                                                 DPG52            16380000
163900                                                 DPG53            16390000
164000                                                 DPG54            16400000
164100                                                 DPG55            16410000
164200                                                 DPG56            16420000
164300         EVALUATE TRUE                                            16430000
164400             WHEN DPG54-NO-ERROR                                  16440000
164500                 INITIALIZE ID-LONG-MESSAGE                       16450000
164600                 MOVE DPG55-DB2-ISO-DATE-FMT TO PV-RESULT-DATE    16460000
164620*                                                                 16462057
164630*  FORMAT AND DISPLAY THE RESULTS TO THE CALENDAR ROUTINE CALL    16463057
164650*                                                                 16465057
164700                 PERFORM 2100-PRESENT-CALENDAR-RESULTS            16470056
164800*                                                                 16480056
164900*  PREPARE TO REDISPLAY THE CALENDAR ROUTINE REQUEST SPECIFICATION16490056
164910*  PANEL                                                          16491056
165000*                                                                 16500056
167500                 MOVE IN-FIELD-CMNETCPD TO                        16750000
167600                           IV-CURSOR-POSITION                     16760000
167700                 IF ID-CMNETC0-CMNETCSR-REFRESH                   16770033
167800                     INITIALIZE ID-CMNETC0-VARIABLES              16780033
167900                     SET ID-CMNETC0-CMNETCPF-DEFAULT TO TRUE      16790036
168000                 END-IF                                           16800033
168100                 INITIALIZE ID-CMNETC1-VARIABLES                  16810000
168200                 SET ID-CMNETC0-CMNETCSR-REFRESH TO TRUE          16820036
168300                 INITIALIZE ID-SHORT-MESSAGE                      16830000
168400                            ID-LONG-MESSAGE                       16840000
168600                 INITIALIZE PV-CALENDAR-DETAILS-ENTRIES           16860056
168700                            CD-CALENDAR-DETAILS-TABLE             16870056
168900             WHEN DPG54-WARNING-ERROR                             16890000
169000             WHEN DPG54-SEVERE-ERROR                              16900000
169100                 STRING DP500-KOHLS-CALENDAR-ROUTINE              16910000
169200                                                DELIMITED BY SIZE 16920000
169300                        ' ERROR MESSAGE:  '     DELIMITED BY SIZE 16930000
169400                        DPG54-ERROR-MESSAGE     DELIMITED BY SIZE 16940000
169500                     INTO ID-LONG-MESSAGE                         16950000
169600                 EVALUATE TRUE                                    16960000
169700                     WHEN DPG54-CALENDAR-TYPE-INVALID             16970000
169800                         MOVE IN-FIELD-CMNETCCT TO                16980000
169900                                   IV-CURSOR-POSITION             16990000
170000                     WHEN DPG54-DATE-INVALID                      17000000
170100                         MOVE IN-FIELD-CMNETCPD TO                17010000
170200                                   IV-CURSOR-POSITION             17020000
170300                     WHEN DPG54-CMPR-DATE-INVALID                 17030000
170400                         MOVE IN-FIELD-CMNETCCD TO                17040000
170500                                   IV-CURSOR-POSITION             17050000
170600                     WHEN DPG54-INCR-DECR-INVALID                 17060000
170700                         MOVE IN-FIELD-CMNETCID TO                17070000
170800                                   IV-CURSOR-POSITION             17080000
170900                 END-EVALUATE                                     17090000
171000         END-EVALUATE                                             17100000
171100     END-IF.                                                      17110000
171101                                                                  17110157
171110*                                                                 17111057
171120*  REDISPLAY THE CALENDAR ROUTINE REQUEST SPECIFICATION PANEL TO  17112057
171130*  PRESENT ANY ERROR MESSAGES OR TO ALLOW THE ENTRY OF THE NEXT   17113057
171131*  CALENDAR REQUEST.                                              17113157
171140*                                                                 17114057
171200                                                                  17120000
171300     PERFORM 9000-DISPLAY-REQUEST-PANEL.                          17130000
171400*2000-EXIT.                                                       17140038
171500                                                                  17150000
171600******************************************************************17160000
171900*  PRESENT A FORMATTED RESULTS PANEL FOR A COMPLETED CALENDAR    *17190057
171910*  ROUTINE REQUEST.  FORMAT ALL DIALOG VARIABLES FOR THE         *17191057
171920*  FORMATTED RESULTS, AND DISPLAY THE CALENDAR ROUTINE REQUEST   *17192057
171930*  RESULTS PANEL.  CONTINUE TO DISPLAY THE PANEL UNTIL AN END    *17193057
171940*  IS REQUESTED.  IF THE CALENDAR ROUTINE DETAILS COMMAND IS     *17194057
171950*  SPECIFIED ON THIS PANEL, ALLOCATE A BROWSABLE FILE FOR THE    *17195057
171960*  DETAILS.  IF SUCCESSFULLY ALLOCATED, BUILD THE FILE FROM      *17196057
171961*  THE FORMATTED DETAILS TABLE, AND PASS CONTROL TO AN ISPF      *17196157
171962*  BROWSE PANEL TO BROWSE THE FILE.  THE BROWSE PANEL WILL       *17196257
171963*  REMAIN DISPLAYED UNTIL AN END IS REQUESTED FROM THE PANEL.    *17196357
171969*  WHEN AN END IS REQUESTED, PARAMETERS ARE BUILT FOR THE COMMON *17196962
171970*  PRINT REQUEST PANEL, AND THE COMMON PRINT REQUEST PANEL       *17197062
171971*  PROGRAM IS CALLED.  THIS WILL ALLOW THE BROWSED FILE TO BE    *17197162
171972*  PRINTED.  AFTER RESPONDING TO THE PRINT REQUEST, CONTROL IS   *17197262
171973*  RETURNED TO THE CALENDAR ROUTINE REQUEST RESULTS PANEL.  ANY  *17197362
171980*  ERRORS DETECTED THROUGH THIS PROCESS WILL BE PRESENTED ON THE *17198062
171990*  REDISPLAY THIS PANEL.                                         *17199057
172000******************************************************************17200000
172100                                                                  17210000
172200 2100-PRESENT-CALENDAR-RESULTS.                                   17220056
172201     PERFORM 3000-PREPARE-CMNETC1-PANEL.                          17220156
172202                                                                  17220256
172203     PERFORM 9100-DISPLAY-RESULTS-PANEL.                          17220356
172204                                                                  17220456
172205     PERFORM                                                      17220556
172206             UNTIL RETURN-CODE NOT = ZERO                         17220656
172207         IF ID-CL-CALENDAR-DETAILS-COMMAND                        17220756
172208             INITIALIZE ID-COMMAND-LINE                           17220856
172209             IF PS-CAL-DETAILS-NOT-ALLOCATED                      17220956
172210                 PERFORM 9500-ALLOCATE-DETAILS-FILE               17221056
172211             END-IF                                               17221156
172212             IF PS-CAL-DETAILS-ALLOCATED                          17221256
172213                 PERFORM 4100-BUILD-CAL-DETAILS-FILE              17221356
172214                 PERFORM 9200-DISPLAY-DETAILS-PANEL               17221456
172215*                                                                 17221557
172216*  CALL THE COMMON PRINT REQUEST PANEL TO ALLOW THE OPTION OF     17221657
172217*  PRINTING THE FILE THAT WAS JUST BROWSED.                       17221757
172218*                                                                 17221857
172219                 INITIALIZE DP300-ISPF-PRINT-PARMS                17221957
172220                 MOVE PC-CURRENT-PROGRAM-NAME TO                  17222057
172221                           DP300-CALLING-PROGRAM-NAME             17222157
172222                 MOVE 1 TO DP300-CALLING-REPORT-NUMBER            17222257
172224                 MOVE PV-CAL-DETAILS-DSN TO DP300-FILE-DSNAME     17222457
172225                 SET DP300-FR-FIXED-BLOCK TO TRUE                 17222557
172226                 MOVE LENGTH OF CD-CALENDAR-DETAILS-RECORD TO     17222657
172227                           DP300-FILE-LRECL                       17222757
172228                 SET DP300-PT-PRINT-TITLE-LINE                    17222857
172229                     DP300-RH-REPEAT-HEADINGS TO TRUE             17222957
172230                 MOVE PV-HEADING-LINE-COUNT TO                    17223057
172231                           DP300-HEADING-LINE-COUNT               17223157
172232                 CALL DP300-ISPF-PRINT-REQ-PROGRAM                17223257
172233                     USING DP300-ISPF-PRINT-PARMS                 17223357
172234*                                                                 17223457
172235*  PRESENT THE RESULTS FROM THE PRINT REQUEST AS AN ERROR OR      17223557
172236*  INFORMATIONAL MESSAGE.                                         17223657
172237*                                                                 17223757
172238                 MOVE DP300-ERROR-MESSAGE TO ID-LONG-MESSAGE      17223857
172239                 IF DP300-RI-PRINT-REQUESTED                      17223957
172240                     MOVE DP300-ERROR-MESSAGE TO ID-SHORT-MESSAGE 17224057
172241                 END-IF                                           17224157
172242             END-IF                                               17224257
172243         ELSE                                                     17224357
172244             IF ID-COMMAND-LINE NOT = SPACES                      17224457
172245                 MOVE 'INVALID COMMAND' TO ID-SHORT-MESSAGE       17224557
172246                 MOVE 'THE COMMAND SPECIFIED IS NOT SUPPORTED ON T17224657
172247-                          'HIS PANEL' TO ID-LONG-MESSAGE         17224757
172248             END-IF                                               17224857
172249         END-IF                                                   17224957
172250         PERFORM 9100-DISPLAY-RESULTS-PANEL                       17225057
172251     END-PERFORM.                                                 17225157
172252*2100-EXIT.                                                       17225257
172253                                                                  17225357
172254******************************************************************17225457
172255*  PREPARE THE CALENDAR ROUTINE RESULTS REQUEST PANEL (CMNETC1)  *17225557
172256*  BY LOADING THE RESULTS INFORMATION INTO THE DIALOG VARIABLES  *17225657
172257*  FOR THIS PANEL.  BUILD A CORE TABLE OF FORMATTED CALENDAR     *17225757
172258*  ROUTINE DETAILS, TO DOCUMENT THE RESULTS OF THE ORIGINAL      *17225857
172259*  CALENDAR ROUTINE CALL.  IF THE REQUEST IS FOR A FISCAL        *17225957
172260*  CALENDAR, FORMAT THE FISCAL PORTION OF THE RESULTS PANEL.     *17226057
172270******************************************************************17227056
172280                                                                  17228056
172290 3000-PREPARE-CMNETC1-PANEL.                                      17229056
172300                                                                  17230000
172400*                                                                 17240057
172410*  SINCE SOME OF THE DIALOG VARIABLES ARE DIRECT REDISPLAYS OF    17241057
172420*  INFORMATION FROM THE CMNETC0 PANEL, AND THE SAME DIALOG        17242057
172430*  VARIABLE IS USED, NO MOVE IS REQUIRED.  A COMMENT IS LEFT      17243057
172440*  IN PLACE OF THE MOVE TO DOCUMENT WHEN IT WOULD LOGICALLY       17244057
172441*  TAKE PLACE.                                                    17244157
172450*                                                                 17245057
172500                                                                  17250000
172600*-------- FILL SCREEN LINE 1 -----------------------------        17260000
172700*    ID-CMNETC0-CMNETCPD ==> ID-CMNETC1-CMNETCPD.                 17270000
172800*    ID-CMNETC0-CMNETCCT ==> ID-CMNETC1-CMNETCCT.                 17280000
172900     EVALUATE TRUE                                                17290000
173000         WHEN DPG51-ACTUAL-CALENDAR-ONLY                          17300000
173100             SET ID-CMNETC1-CMNETCFC-ACTL-DESC TO TRUE            17310000
173200         WHEN DPG51-FISCAL-454-CALENDAR                           17320000
173300             SET ID-CMNETC1-CMNETCFC-F2-DESC TO TRUE              17330000
173400         WHEN DPG51-FISCAL-JAN-DEC-F2                             17340000
173500             SET ID-CMNETC1-CMNETCFC-F4-DESC TO TRUE              17350000
173600     END-EVALUATE.                                                17360000
173700                                                                  17370000
173800*    ID-CMNETC0-CMNETCCD ==> ID-CMNETC1-CMNETCCD.                 17380000
173900*    ID-CMNETC0-CMNETCID ==> ID-CMNETC1-CMNETCID.                 17390000
174000     IF (NOT ID-CMNETC0-CMNETCID-NO-REQUEST)                      17400000
174100         EVALUATE TRUE                                            17410000
174200             WHEN ID-CMNETC0-CMNETCIY NOT = SPACES                17420000
174300                 MOVE ID-CMNETC0-CMNETCIY TO                      17430000
174400                           ID-CMNETC1-CMNETCIA                    17440000
174500                 SET ID-CMNETC1-CMNETCII-CAL-DAYS TO TRUE         17450000
174600             WHEN ID-CMNETC0-CMNETCIB NOT = SPACES                17460000
174700                 MOVE ID-CMNETC0-CMNETCIB TO                      17470000
174800                           ID-CMNETC1-CMNETCIA                    17480000
174900                 SET ID-CMNETC1-CMNETCII-BUS-DAYS TO TRUE         17490000
175000             WHEN ID-CMNETC0-CMNETCIW NOT = SPACES                17500000
175100                 MOVE ID-CMNETC0-CMNETCIW TO                      17510000
175200                           ID-CMNETC1-CMNETCIA                    17520000
175300                 SET ID-CMNETC1-CMNETCII-FISC-WKS TO TRUE         17530000
175400             WHEN ID-CMNETC0-CMNETCIP NOT = SPACES                17540000
175500                 MOVE ID-CMNETC0-CMNETCIP TO                      17550000
175600                           ID-CMNETC1-CMNETCIA                    17560000
175700                 SET ID-CMNETC1-CMNETCII-FISC-PRDS TO TRUE        17570000
175800         END-EVALUATE                                             17580000
175900         INSPECT ID-CMNETC1-CMNETCIA                              17590000
176000             REPLACING LEADING ZEROES BY SPACES                   17600000
176100     END-IF.                                                      17610000
176200                                                                  17620000
176300     IF ID-CMNETC0-CMNETCPY NUMERIC                               17630000
176400         MOVE ID-CMNETC0-CMNETCPY TO ID-CMNETC1-CMNETCCP-PIVOT-YR 17640000
176500     ELSE                                                         17650000
176600         SET ID-CMNETC1-CMNETCCP-DEFAULT TO TRUE                  17660000
176700     END-IF.                                                      17670000
176800                                                                  17680000
176900*-------- FILL SCREEN LINE 2 -----------------------------        17690000
177000*    ID-CMNETC0-CMNETCPF       ==> ID-CMNETC1-CMNETCPF.           17700000
177100*    ID-CMNETC0-CMNETCCF       ==> ID-CMNETC1-CMNETCCF.           17710000
177200*    (WITH CMNETCIA ON LINE 1) ==> ID-CMNETC1-CMNETCII.           17720000
177300                                                                  17730000
177400*-------- FILL SCREEN LINE 3 -----------------------------        17740000
177500     MOVE DPG55-GREG-CC-DATE-FMT-DY TO PV-ZERO-SUPPRESS-DAY.      17750000
177600     IF PV-ZERO-SUPPRESS-DAY-1 = SPACES                           17760000
177700         MOVE PV-ZERO-SUPPRESS-DAY-2 TO PV-ZERO-SUPPRESS-DAY-1    17770000
177800         INITIALIZE PV-ZERO-SUPPRESS-DAY-2                        17780000
177900     END-IF.                                                      17790000
178000     STRING DPG55-ALPHA-WEEK-DAY          DELIMITED BY SPACE      17800000
178100            PC-COMMA-SEPARATOR            DELIMITED BY SIZE       17810000
178200            DPG55-ALPHA-MONTH             DELIMITED BY SPACE      17820000
178300            ' '                           DELIMITED BY SIZE       17830000
178400            PV-ZERO-SUPPRESS-DAY          DELIMITED BY SPACE      17840000
178500            PC-COMMA-SEPARATOR            DELIMITED BY SIZE       17850000
178600            DPG55-GREG-CC-DATE-FMT-YR-X   DELIMITED BY SPACE      17860000
178700         INTO ID-CMNETC1-CMNETCRD.                                17870000
178800     IF ((DPG55-DAYS-DIFFERENCE NOT = ZERO)                       17880000
178900             OR (DPG55-BUS-DAYS-DIFFERENCE NOT = ZERO)            17890000
179000             OR (DPG53-LK-CMPR-DATE-FORMAT-CODE NOT = SPACES))    17900000
179100         SET ID-CMNETC1-CMNETCCI-ELIGIBLE TO TRUE                 17910000
179200         MOVE DPG55-DAYS-DIFFERENCE TO                            17920000
179300                   ID-CMNETC1-CMNETCDC-FORMATTED                  17930000
179400         INSPECT ID-CMNETC1-CMNETCDC                              17940000
179500             REPLACING LEADING ZEROES BY SPACES                   17950000
179600     END-IF.                                                      17960000
179700     IF DPG51-VALID-FISCAL-CALENDAR                               17970000
179800*                                                                 17980000
179900*  CHECKING FOR AN INCR/DECR OR COMPARE CAN BE DONE IN THIS       17990000
180000*  FASHION, SINCE THE EDITING IN THE BODY OF THE CMNETC0 PANEL    18000000
180100*  DEFINITION, AND THE INTERNAL EDITING IN THIS PROGRAM PREVENTS  18010000
180200*  AN INCR/DECR OR COMPARISON REQUEST FROM BEING EXECUTED WITHOUT 18020000
180300*  ALL THE REQUIRED PARAMETERS.                                   18030000
180400*                                                                 18040000
180500         IF ((DPG51-INCR-DECR-REQUESTED)                          18050000
180600                 OR (DPG53-LK-CMPR-DATE-FORMAT-CODE NOT = SPACES))18060000
180700             SET ID-CMNETC1-CMNETCWI-ELIGIBLE TO TRUE             18070000
180800             MOVE DPG56-WEEKS-DIFFERENCE TO                       18080000
180900                       ID-CMNETC1-CMNETCDW-FORMATTED              18090000
181000             INSPECT ID-CMNETC1-CMNETCDW                          18100000
181100                 REPLACING LEADING ZEROES BY SPACES               18110000
181200         END-IF                                                   18120000
181300     END-IF.                                                      18130000
181400                                                                  18140000
181500*-------- FILL SCREEN LINE 4 -----------------------------        18150000
181600     MOVE DPG55-GREG-CC-DATE-FMT    TO ID-CMNETC1-CMNETCGD.       18160000
181700     MOVE DPG55-JULIAN-DATE-FMT     TO ID-CMNETC1-CMNETCJD.       18170000
181800     IF ((DPG55-DAYS-DIFFERENCE NOT = ZERO)                       18180000
181900             OR (DPG55-BUS-DAYS-DIFFERENCE NOT = ZERO)            18190000
182000             OR (DPG53-LK-CMPR-DATE-FORMAT-CODE NOT = SPACES))    18200000
182100         SET ID-CMNETC1-CMNETCBI-ELIGIBLE TO TRUE                 18210000
182200         MOVE DPG55-BUS-DAYS-DIFFERENCE TO                        18220000
182300                   ID-CMNETC1-CMNETCDB-FORMATTED                  18230000
182400         INSPECT ID-CMNETC1-CMNETCDB                              18240000
182500             REPLACING LEADING ZEROES BY SPACES                   18250000
182600     END-IF.                                                      18260000
182700     IF DPG51-VALID-FISCAL-CALENDAR                               18270000
182800*                                                                 18280000
182900*  CHECKING FOR AN INCR/DECR OR COMPARE CAN BE DONE IN THIS       18290000
183000*  FASHION, SINCE THE EDITING IN THE BODY OF THE CMNETC0 PANEL    18300000
183100*  DEFINITION, AND THE INTERNAL EDITING IN THIS PROGRAM PREVENTS  18310000
183200*  AN INCR/DECR OR COMPARISON REQUEST FROM BEING EXECUTED WITHOUT 18320000
183300*  ALL THE REQUIRED PARAMETERS.                                   18330000
183400*                                                                 18340000
183500         IF ((DPG51-INCR-DECR-REQUESTED)                          18350000
183600                 OR (DPG53-LK-CMPR-DATE-FORMAT-CODE NOT = SPACES))18360000
183700             SET ID-CMNETC1-CMNETCPI-ELIGIBLE TO TRUE             18370000
183800             MOVE DPG56-PERIODS-DIFFERENCE TO                     18380000
183900                       ID-CMNETC1-CMNETCDP-FORMATTED              18390000
184000             INSPECT ID-CMNETC1-CMNETCDP                          18400000
184100                 REPLACING LEADING ZEROES BY SPACES               18410000
184200         END-IF                                                   18420000
184300     END-IF.                                                      18430000
184400                                                                  18440000
184500*-------- FILL SCREEN LINE 5 -----------------------------        18450000
184600     MOVE DPG55-CORP-BUS-DAY-IND    TO  ID-CMNETC1-CMNETCBD.      18460000
184700     MOVE DPG55-ACTUAL-HOLIDAY-IND  TO  ID-CMNETC1-CMNETCAH.      18470000
184800     MOVE DPG55-CORP-HOLIDAY-IND    TO  ID-CMNETC1-CMNETCCH.      18480000
184900     MOVE DPG55-STORE-HOLIDAY-IND   TO  ID-CMNETC1-CMNETCSH.      18490000
185000     MOVE DPG55-HOLIDAY-NAME        TO  ID-CMNETC1-CMNETCHN.      18500000
185100                                                                  18510000
185200*-------- FILL SCREEN LINE 6 -----------------------------        18520000
185300     MOVE DPG55-DAYS-IN-MONTH TO ID-CMNETC1-CMNETCA2-FORMATTED.   18530000
185400     MOVE DPG55-GREG-CC-DATE-DY TO                                18540000
185500               ID-CMNETC1-CMNETCA3-FORMATTED.                     18550000
185600     MOVE DPG55-1ST-WKDY-GREG-CC-N TO                             18560000
185700               ID-CMNETC1-CMNETCA6-FORMATTED.                     18570000
185800     MOVE DPG55-LAST-WKDY-GREG-CC-N TO                            18580000
185900               ID-CMNETC1-CMNETCA7-FORMATTED.                     18590000
186000                                                                  18600000
186010*                                                                 18601057
186011*  BUILD A CORE TABLE OF FORMATTED CALENDAR ROUTINE PARAMETER     18601157
186012*  LIST VARIABLES.                                                18601257
186013*                                                                 18601357
186020                                                                  18602057
186100     PERFORM 4000-FORMAT-CALENDAR-DETAILS.                        18610039
186200                                                                  18620039
186300*-------- TEST FOR OTHER SCREEN LINES --------------------        18630000
186400     IF DPG51-VALID-FISCAL-CALENDAR                               18640000
186500          PERFORM 3100-PREP-CMNETC1-FISC-DTL-TBL                  18650000
186600     END-IF.                                                      18660000
186700*3000-EXIT.                                                       18670038
186800                                                                  18680000
186900******************************************************************18690000
187000*  PREPARE THE FISCAL RESULTS PORTION OF THE RESULTS TABLE FOR   *18700000
187100*  A FISCAL CALENDAR REQUEST.  THE FISCAL SEASON INFORMATION     *18710000
187200*  THAT IS PRESENTED REQUIRES ADDITIONAL CALENDAR ROUTINE CALLS  *18720000
187300*  TO ACQUIRE THE INFORMATION THAT IS NECESSARY TO DERIVE THE    *18730000
187400*  RESULTS.                                                      *18740000
187500******************************************************************18750000
187600                                                                  18760000
187700 3100-PREP-CMNETC1-FISC-DTL-TBL.                                  18770000
187800                                                                  18780000
187900*-------- FILL SCREEN LINE 7 -----------------------------        18790000
188000     MOVE DPG56-FISCAL-YEAR-CCYY-X TO ID-CMNETC1-CMNETCY1.        18800000
188100                                                                  18810000
188200     COMPUTE PV-DAYS = (DPG56-NBR-FISCAL-WEEKS *                  18820000
188300                       PC-DAYS-PER-WEEK).                         18830000
188400     MOVE PV-DAYS TO ID-CMNETC1-CMNETCY2-FORMATTED.               18840000
188500                                                                  18850000
188600     MOVE DPG56-NBR-FISCAL-DAYS TO                                18860000
188700               ID-CMNETC1-CMNETCY3-FORMATTED.                     18870000
188800     MOVE DPG56-NBR-FISCAL-WEEKS TO                               18880000
188900               ID-CMNETC1-CMNETCY4-FORMATTED.                     18890000
189000     MOVE DPG56-FISCAL-WEEK-NBR TO                                18900000
189100               ID-CMNETC1-CMNETCY5-FORMATTED.                     18910000
189200                                                                  18920000
189300     MOVE DPG56-FIRST-FD-GREG-CC-N TO                             18930000
189400               ID-CMNETC1-CMNETCY6-FORMATTED.                     18940000
189500     MOVE DPG56-LAST-FD-GREG-CC-N TO                              18950000
189600               ID-CMNETC1-CMNETCY7-FORMATTED.                     18960000
189700                                                                  18970000
189800*-------- FILL SCREEN LINE 8 -----------------------------        18980000
189900     MOVE DPG56-CURR-FISCAL-SEASON TO  ID-CMNETC1-CMNETCS1.       18990000
190000                                                                  19000000
190100     STRING  DPG56-FIRST-FS-DB2-ISO-FMT-MO '/'                    19010000
190200             DPG56-FIRST-FS-DB2-ISO-FMT-DY '/'                    19020000
190300             DPG56-FIRST-FS-DB2-ISO-FMT-YR                        19030000
190400             DELIMITED BY SIZE                                    19040000
190500             INTO ID-CMNETC1-CMNETCS6.                            19050000
190600                                                                  19060000
190700     STRING  DPG56-LAST-FS-DB2-ISO-FMT-MO '/'                     19070000
190800             DPG56-LAST-FS-DB2-ISO-FMT-DY '/'                     19080000
190900             DPG56-LAST-FS-DB2-ISO-FMT-YR                         19090000
191000             DELIMITED BY SIZE                                    19100000
191100             INTO ID-CMNETC1-CMNETCS7.                            19110000
191200                                                                  19120000
191300*-------- FILL SCREEN LINE 9 -----------------------------        19130000
191400     MOVE DPG56-FISCAL-QTR-NBR-X TO  ID-CMNETC1-CMNETCQ1.         19140000
191500     COMPUTE PV-DAYS = (DPG56-NBR-FISCAL-QTR-WEEKS *              19150000
191600                       PC-DAYS-PER-WEEK).                         19160000
191700     MOVE PV-DAYS TO ID-CMNETC1-CMNETCQ2-FORMATTED.               19170000
191800                                                                  19180000
191900     COMPUTE PV-DAYS = (((DPG56-FISCAL-QTR-WEEK - PC-1-WEEK) *    19190000
192000                       PC-DAYS-PER-WEEK) +                        19200000
192100                       DPG55-NUMERIC-WEEK-DAY).                   19210000
192200     MOVE PV-DAYS TO ID-CMNETC1-CMNETCQ3-FORMATTED.               19220000
192300                                                                  19230000
192400     MOVE DPG56-NBR-FISCAL-QTR-WEEKS TO                           19240000
192500               ID-CMNETC1-CMNETCQ4-FORMATTED.                     19250000
192600     MOVE DPG56-FISCAL-QTR-WEEK TO                                19260000
192700               ID-CMNETC1-CMNETCQ5-FORMATTED.                     19270000
192800                                                                  19280000
192900     MOVE DPG56-FIRST-FQ-GREG-CC-N TO                             19290000
193000               ID-CMNETC1-CMNETCQ6-FORMATTED.                     19300000
193100     MOVE DPG56-LAST-FQ-GREG-CC-N TO                              19310000
193200               ID-CMNETC1-CMNETCQ7-FORMATTED.                     19320000
193300                                                                  19330000
193400*-------- FILL SCREEN LINE 10 ----------------------------        19340000
193500     MOVE DPG56-FISCAL-PERIOD-NBR TO                              19350000
193600               ID-CMNETC1-CMNETCP1-PERIOD-NBR.                    19360000
193700     SET ID-CMNETC1-CMNETCP1-SEPARATOR TO TRUE.                   19370000
193800     MOVE DPG56-FISCAL-PERIOD-NAME-ABBR3 TO                       19380000
193900               ID-CMNETC1-CMNETCP1-NAME-ABBR3.                    19390000
194000                                                                  19400000
194100     COMPUTE PV-DAYS = (DPG56-NBR-FISCAL-PERIOD-WEEKS *           19410000
194200                       PC-DAYS-PER-WEEK).                         19420000
194300     MOVE PV-DAYS TO ID-CMNETC1-CMNETCP2-FORMATTED.               19430000
194400                                                                  19440000
194500     COMPUTE PV-DAYS = (((DPG56-FISCAL-PERIOD-WEEK - PC-1-WEEK) * 19450000
194600                       PC-DAYS-PER-WEEK) +                        19460000
194700                       DPG55-NUMERIC-WEEK-DAY).                   19470000
194800     MOVE PV-DAYS TO ID-CMNETC1-CMNETCP3-FORMATTED.               19480000
194900                                                                  19490000
195000     MOVE DPG56-NBR-FISCAL-PERIOD-WEEKS TO                        19500000
195100               ID-CMNETC1-CMNETCP4-FORMATTED.                     19510000
195200     MOVE DPG56-FISCAL-PERIOD-WEEK TO                             19520000
195300               ID-CMNETC1-CMNETCP5-FORMATTED.                     19530000
195400                                                                  19540000
195500     MOVE DPG56-FIRST-FP-GREG-CC-N TO                             19550000
195600               ID-CMNETC1-CMNETCP6-FORMATTED.                     19560000
195700     MOVE DPG56-LAST-FP-GREG-CC-N TO                              19570000
195800               ID-CMNETC1-CMNETCP7-FORMATTED.                     19580000
195900                                                                  19590000
196000*-------- FILL REMAINDER OF SCREEN LINE 8 ----------------        19600000
196100                                                                  19610000
196200*                                                                 19620000
196300*  DETERMINE THE NUMBER OF DAYS IN THE FISCAL SEASON BY COMPARING 19630000
196400*  FIRST AND LAST DATES OF THE SEASON AND ADDING 1.  THE FIRST    19640000
196500*  DATE IS USED AS THE COMPARE DATE, TO GET A POSITIVE RESULT.    19650000
196600*  DERIVE THE NUMBER OF WEEKS IN THE FISCAL SEASON.               19660000
196700*                                                                 19670000
196800*                                                                 19680000
196900*                                                                 19690000
197000     INITIALIZE DPG51                                             19700000
197100                DPG52                                             19710000
197200                DPG53.                                            19720000
197300     MOVE ID-CMNETC0-CMNETCCT        TO DPG51-CALENDAR-TYPE.      19730000
197400     MOVE DPG56-LAST-FS-DB2-ISO-FMT  TO DPG52-LK-DATE-INPUT.      19740000
197500     SET  DPG52-LK-DTE-ISO-FMT       TO TRUE.                     19750000
197600     MOVE DPG56-FIRST-FS-DB2-ISO-FMT TO DPG53-LK-CMPR-DATE-INPUT. 19760000
197700     SET  DPG53-LK-CMPR-DTE-ISO-FMT  TO TRUE.                     19770000
197800     INITIALIZE DPG54                                             19780000
197900                DPG55                                             19790000
198000                DPG56.                                            19800000
198100                                                                  19810000
198200     CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51                19820000
198300                                             DPG52                19830000
198400                                             DPG53                19840000
198500                                             DPG54                19850000
198600                                             DPG55                19860000
198700                                             DPG56.               19870000
198800                                                                  19880000
198900     IF ((DPG54-SEVERE-ERROR)                                     19890000
199000             OR (DPG54-WARNING-ERROR))                            19900000
199100         INITIALIZE ID-LONG-MESSAGE                               19910032
199200         STRING 'ERROR DETERMINING DAYS IN SEASON: '              19920000
199300                                                DELIMITED BY SIZE 19930000
199400                DPG54-ERROR-MESSAGE             DELIMITED BY SIZE 19940000
199500             INTO ID-LONG-MESSAGE                                 19950000
199600     ELSE                                                         19960000
199700         COMPUTE PV-DAYS = (DPG55-DAYS-DIFFERENCE + PC-1-DAY)     19970000
199800         MOVE PV-DAYS TO ID-CMNETC1-CMNETCS2-FORMATTED            19980000
199900         COMPUTE PV-WEEKS = (PV-DAYS / PC-DAYS-PER-WEEK)          19990000
200000         MOVE PV-WEEKS TO ID-CMNETC1-CMNETCS4-FORMATTED           20000000
200100     END-IF.                                                      20010000
200200                                                                  20020000
200300*                                                                 20030000
200400*  DETERMINE THE DAY NUMBER OF THE FISCAL SEASON BY COMPARING     20040000
200500*  FIRST DAY OF THE SEASON TO THE RESULT DATE FROM THE ORIGINAL   20050000
200600*  CALENDAR REQUEST AND ADDING 1.  THE FIRST DATE IS USED AS THE  20060000
200700*  COMPARE DATE, TO GET A POSITIVE RESULT.  DERIVE THE WEEK NUMBER20070000
200800*  WITHIN THE FISCAL SEASON.                                      20080000
200900*                                                                 20090000
201000                                                                  20100000
201100     INITIALIZE DPG51                                             20110000
201200                DPG52                                             20120000
201300                DPG53.                                            20130000
201400     MOVE ID-CMNETC0-CMNETCCT        TO DPG51-CALENDAR-TYPE.      20140000
201500     MOVE PV-RESULT-DATE             TO DPG52-LK-DATE-INPUT.      20150000
201600     SET  DPG52-LK-DTE-ISO-FMT       TO TRUE.                     20160000
201700     MOVE DPG56-FIRST-FS-DB2-ISO-FMT TO DPG53-LK-CMPR-DATE-INPUT. 20170000
201800     SET  DPG53-LK-CMPR-DTE-ISO-FMT  TO TRUE.                     20180000
201900     INITIALIZE DPG54                                             20190000
202000                DPG55                                             20200000
202100                DPG56.                                            20210000
202200                                                                  20220000
202300     CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51                20230000
202400                                             DPG52                20240000
202500                                             DPG53                20250000
202600                                             DPG54                20260000
202700                                             DPG55                20270000
202800                                             DPG56.               20280000
202900                                                                  20290000
203000     IF ((DPG54-SEVERE-ERROR)                                     20300000
203100             OR (DPG54-WARNING-ERROR))                            20310000
203200         INITIALIZE ID-LONG-MESSAGE                               20320032
203300         STRING 'ERROR DETERMINING DAY OF SEASON: '               20330000
203400                                                DELIMITED BY SIZE 20340000
203500                DPG54-ERROR-MESSAGE             DELIMITED BY SIZE 20350000
203600             INTO ID-LONG-MESSAGE                                 20360000
203700     ELSE                                                         20370000
203800         COMPUTE PV-DAYS = (DPG55-DAYS-DIFFERENCE + PC-1-DAY)     20380000
203900         MOVE PV-DAYS TO ID-CMNETC1-CMNETCS3-FORMATTED            20390000
204000         DIVIDE PV-DAYS                                           20400000
204100                BY PC-DAYS-PER-WEEK                               20410000
204200                GIVING PV-WEEKS                                   20420000
204300                REMAINDER PV-DAYS                                 20430000
204400         IF PV-DAYS > ZERO                                        20440000
204500             COMPUTE PV-WEEKS = (PV-WEEKS + PC-1-WEEK)            20450000
204600         END-IF                                                   20460000
204700         MOVE PV-WEEKS TO ID-CMNETC1-CMNETCS5-FORMATTED           20470000
204800     END-IF.                                                      20480000
204900*3100-EXIT.                                                       20490038
205000                                                                  20500038
205100******************************************************************20510038
205200*  BUILD A FORMATTED TABLE OF THE DETAILS BEHIND THE CALENDAR    *20520057
205300*  ROUTINE CALL.  THIS WILL BE BUILT IN CORE STORAGE, AND NOT    *20530039
205400*  WRITTEN TO A FILE, UNTIL A CALENDAR ROUTINE CALL DETAILS      *20540057
205401*  BROWSE IS REQUESTED.  COMMENTS, INCLUDING THE DEFINITION OF   *20540157
205402*  THE VARIOUS INPUT AND OUTPUT PARAMETER SECTIONS, WILL BE      *20540257
205410*  INCLUDED IN THE TABLE, IN ADDITION TO FORMATTING AN ENTRY FOR *20541057
205411*  EACH INPUT AND OUTPUT PARAMETER.  THIS WILL PROVIDE           *20541157
205420*  ADDITIONAL CLARITY IF THE DETAILS ARE BROWSED, OR ULTIMATELY  *20542057
205430*  PRINTED.                                                      *20543057
205500******************************************************************20550038
205600                                                                  20560038
205700 4000-FORMAT-CALENDAR-DETAILS.                                    20570039
205701                                                                  20570157
205710*                                                                 20571058
205720*  FORMAT OPENING COMMENTS                                        20572058
205730*                                                                 20573058
205740                                                                  20574057
205800     SET CD-INDEX TO 1.                                           20580039
205900     STRING 'KOHLS CALENDAR ROUTINE ('    DELIMITED BY SIZE       20590039
206000            DP500-KOHLS-CALENDAR-ROUTINE  DELIMITED BY SIZE       20600039
206100            ') CALL DETAILS'              DELIMITED BY SIZE       20610039
206200         INTO CD-CALENDAR-DETAILS-ENTRY (CD-INDEX).               20620039
206300     SET CD-INDEX UP BY 1.                                        20630039
206400     SET CD-INDEX UP BY 1.                                        20640039
206500                                                                  20650039
206600     MOVE '** REVIEW THE PARAMETER LIST FOR ANY NUMERIC OR ELEMENT20660041
206700-              ' REDEFINITIONS OF THE' TO                         20670045
206800               CD-CALENDAR-DETAILS-ENTRY (CD-INDEX).              20680041
206900     SET CD-INDEX UP BY 1.                                        20690041
207000     MOVE '   FIELDS LISTED AMONG THE INPUT AND OUTPUT PARAMETERS 20700041
207100-              '**' TO                                            20710041
207200               CD-CALENDAR-DETAILS-ENTRY (CD-INDEX).              20720042
207300     SET CD-INDEX UP BY 1.                                        20730041
207410                                                                  20741048
207420     SET PV-HEADING-LINE-COUNT TO CD-INDEX.                       20742049
207430     SET CD-INDEX UP BY 1.                                        20743063
207500                                                                  20750041
207510     SET CD-INDEX UP BY 1.                                        20751049
207600     MOVE '----------------' TO                                   20760041
207700               CD-CALENDAR-DETAILS-ENTRY (CD-INDEX).              20770039
207800     SET CD-INDEX UP BY 1.                                        20780039
207900     MOVE 'INPUT PARAMETERS' TO                                   20790041
208000               CD-CALENDAR-DETAILS-ENTRY (CD-INDEX).              20800041
208100     SET CD-INDEX UP BY 1.                                        20810041
208200     MOVE '----------------' TO                                   20820041
208300               CD-CALENDAR-DETAILS-ENTRY (CD-INDEX).              20830041
208400     SET CD-INDEX UP BY 1.                                        20840039
208500     SET CD-INDEX UP BY 1.                                        20850041
208510                                                                  20851057
208520*                                                                 20852058
208530*  FORMAT DPG51 PARAMETERS                                        20853058
208540*                                                                 20854058
208600                                                                  20860041
208700     MOVE 'DPG51 - BASIC CALENDAR ROUTINE CALL INFORMATION' TO    20870039
208800               CD-CALENDAR-DETAILS-ENTRY (CD-INDEX).              20880039
208900     SET CD-INDEX UP BY 1.                                        20890039
209000     SET CD-INDEX UP BY 1.                                        20900039
209100                                                                  20910039
209200     STRING PC-CAL-DETAILS-INDENT                DELIMITED BY SIZE20920039
209300            'DPG51-CALENDAR-TYPE ('              DELIMITED BY SIZE20930039
209400            DPG51-CALENDAR-TYPE                  DELIMITED BY SIZE20940039
209500            ')'                                  DELIMITED BY SIZE20950039
209600         INTO CD-CALENDAR-DETAILS-ENTRY (CD-INDEX).               20960039
209700     SET CD-INDEX UP BY 1.                                        20970039
209800     STRING PC-CAL-DETAILS-INDENT                DELIMITED BY SIZE20980039
209900            'DPG51-INCREMENT-DECREMENT-FLAG ('   DELIMITED BY SIZE20990039
210000            DPG51-INCREMENT-DECREMENT-FLAG       DELIMITED BY SIZE21000039
210100            ')'                                  DELIMITED BY SIZE21010039
210200         INTO CD-CALENDAR-DETAILS-ENTRY (CD-INDEX).               21020039
210300     SET CD-INDEX UP BY 1.                                        21030039
210400     STRING PC-CAL-DETAILS-INDENT                DELIMITED BY SIZE21040039
210500            'DPG51-INCR-DECR-BUS-DAYS-X ('       DELIMITED BY SIZE21050039
210600            DPG51-INCR-DECR-BUS-DAYS-X           DELIMITED BY SIZE21060039
210700            ')'                                  DELIMITED BY SIZE21070039
210800         INTO CD-CALENDAR-DETAILS-ENTRY (CD-INDEX).               21080039
210900     SET CD-INDEX UP BY 1.                                        21090039
211000     STRING PC-CAL-DETAILS-INDENT                DELIMITED BY SIZE21100039
211100            'DPG51-INCR-DECR-DAYS-X ('           DELIMITED BY SIZE21110039
211200            DPG51-INCR-DECR-DAYS-X               DELIMITED BY SIZE21120039
211300            ')'                                  DELIMITED BY SIZE21130039
211400         INTO CD-CALENDAR-DETAILS-ENTRY (CD-INDEX).               21140039
211500     SET CD-INDEX UP BY 1.                                        21150039
211600     STRING PC-CAL-DETAILS-INDENT                DELIMITED BY SIZE21160039
211700            'DPG51-INCR-DECR-FISCAL-WEEK-X ('    DELIMITED BY SIZE21170039
211800            DPG51-INCR-DECR-FISCAL-WEEK-X        DELIMITED BY SIZE21180039
211900            ')'                                  DELIMITED BY SIZE21190039
212000         INTO CD-CALENDAR-DETAILS-ENTRY (CD-INDEX).               21200039
212100     SET CD-INDEX UP BY 1.                                        21210039
212200     STRING PC-CAL-DETAILS-INDENT                DELIMITED BY SIZE21220039
212300            'DPG51-INCR-DECR-FISCAL-PRD-X ('     DELIMITED BY SIZE21230039
212400            DPG51-INCR-DECR-FISCAL-PRD-X         DELIMITED BY SIZE21240039
212500            ')'                                  DELIMITED BY SIZE21250039
212600         INTO CD-CALENDAR-DETAILS-ENTRY (CD-INDEX).               21260039
212700     SET CD-INDEX UP BY 1.                                        21270039
212800     STRING PC-CAL-DETAILS-INDENT                DELIMITED BY SIZE21280039
212900            'DPG51-CENTURY-PIVOT-YEAR-X ('       DELIMITED BY SIZE21290039
213000            DPG51-CENTURY-PIVOT-YEAR-X           DELIMITED BY SIZE21300039
213100            ')'                                  DELIMITED BY SIZE21310039
213200         INTO CD-CALENDAR-DETAILS-ENTRY (CD-INDEX).               21320039
213300     SET CD-INDEX UP BY 1.                                        21330039
213310                                                                  21331057
213320*                                                                 21332058
213330*  FORMAT DPG52 PARAMETERS                                        21333058
213340*                                                                 21334058
213400                                                                  21340039
213500     SET CD-INDEX UP BY 1.                                        21350039
213600     MOVE 'DPG52 - PRIMARY INPUT DATE SPECIFICATION' TO           21360039
213700               CD-CALENDAR-DETAILS-ENTRY (CD-INDEX).              21370039
213800     SET CD-INDEX UP BY 1.                                        21380039
213900     SET CD-INDEX UP BY 1.                                        21390039
214000                                                                  21400039
214100     STRING PC-CAL-DETAILS-INDENT                DELIMITED BY SIZE21410039
214200            'DPG52-LK-DATE-FORMAT-CODE ('        DELIMITED BY SIZE21420039
214300            DPG52-LK-DATE-FORMAT-CODE            DELIMITED BY SIZE21430039
214400            ')'                                  DELIMITED BY SIZE21440039
214500         INTO CD-CALENDAR-DETAILS-ENTRY (CD-INDEX).               21450039
214600     SET CD-INDEX UP BY 1.                                        21460039
214700     STRING PC-CAL-DETAILS-INDENT                DELIMITED BY SIZE21470039
214800            'DPG52-LK-DATE-INPUT ('              DELIMITED BY SIZE21480039
214900            DPG52-LK-DATE-INPUT                  DELIMITED BY SIZE21490039
215000            ')'                                  DELIMITED BY SIZE21500039
215100         INTO CD-CALENDAR-DETAILS-ENTRY (CD-INDEX).               21510039
215200     SET CD-INDEX UP BY 1.                                        21520039
215210                                                                  21521057
215220*                                                                 21522058
215230*  FORMAT DPG53 PARAMETERS                                        21523058
215240*                                                                 21524058
215300                                                                  21530039
215400     SET CD-INDEX UP BY 1.                                        21540039
215500     MOVE 'DPG53 - COMPARISON DATE SPECIFICATION' TO              21550039
215600               CD-CALENDAR-DETAILS-ENTRY (CD-INDEX).              21560039
215700     SET CD-INDEX UP BY 1.                                        21570039
215800     SET CD-INDEX UP BY 1.                                        21580039
215900                                                                  21590039
216000     STRING PC-CAL-DETAILS-INDENT                DELIMITED BY SIZE21600039
216100            'DPG53-LK-CMPR-DATE-FORMAT-CODE ('   DELIMITED BY SIZE21610039
216200            DPG53-LK-CMPR-DATE-FORMAT-CODE       DELIMITED BY SIZE21620039
216300            ')'                                  DELIMITED BY SIZE21630039
216400         INTO CD-CALENDAR-DETAILS-ENTRY (CD-INDEX).               21640039
216500     SET CD-INDEX UP BY 1.                                        21650039
216600     STRING PC-CAL-DETAILS-INDENT                DELIMITED BY SIZE21660039
216700            'DPG53-LK-CMPR-DATE-INPUT ('         DELIMITED BY SIZE21670039
216800            DPG53-LK-CMPR-DATE-INPUT             DELIMITED BY SIZE21680039
216900            ')'                                  DELIMITED BY SIZE21690039
217000         INTO CD-CALENDAR-DETAILS-ENTRY (CD-INDEX).               21700039
217100     SET CD-INDEX UP BY 1.                                        21710039
217200                                                                  21720039
217300     SET CD-INDEX UP BY 1.                                        21730039
217400     MOVE '-----------------' TO                                  21740041
217500               CD-CALENDAR-DETAILS-ENTRY (CD-INDEX).              21750041
217600     SET CD-INDEX UP BY 1.                                        21760041
217700     MOVE 'OUTPUT PARAMETERS' TO                                  21770039
217800               CD-CALENDAR-DETAILS-ENTRY (CD-INDEX).              21780039
217900     SET CD-INDEX UP BY 1.                                        21790041
218000     MOVE '-----------------' TO                                  21800041
218100               CD-CALENDAR-DETAILS-ENTRY (CD-INDEX).              21810041
218200     SET CD-INDEX UP BY 1.                                        21820039
218300     SET CD-INDEX UP BY 1.                                        21830039
218310                                                                  21831057
218320*                                                                 21832058
218330*  FORMAT DPG54 PARAMETERS                                        21833058
218340*                                                                 21834058
218400                                                                  21840039
218500     SET CD-INDEX UP BY 1.                                        21850039
218600     MOVE 'DPG54 - CALL RESULTS/ERROR INDICATION' TO              21860039
218700               CD-CALENDAR-DETAILS-ENTRY (CD-INDEX).              21870039
218800     SET CD-INDEX UP BY 1.                                        21880039
218900     SET CD-INDEX UP BY 1.                                        21890039
219000                                                                  21900039
219100     STRING PC-CAL-DETAILS-INDENT                DELIMITED BY SIZE21910039
219200            'DPG54-CALENDAR-TYPE-IND ('          DELIMITED BY SIZE21920039
219300            DPG54-CALENDAR-TYPE-IND              DELIMITED BY SIZE21930039
219400            ')'                                  DELIMITED BY SIZE21940039
219500         INTO CD-CALENDAR-DETAILS-ENTRY (CD-INDEX).               21950039
219600     SET CD-INDEX UP BY 1.                                        21960039
219700     STRING PC-CAL-DETAILS-INDENT                DELIMITED BY SIZE21970039
219800            'DPG54-DATE-VALID-IND ('             DELIMITED BY SIZE21980039
219900            DPG54-DATE-VALID-IND                 DELIMITED BY SIZE21990039
220000            ')'                                  DELIMITED BY SIZE22000039
220100         INTO CD-CALENDAR-DETAILS-ENTRY (CD-INDEX).               22010039
220200     SET CD-INDEX UP BY 1.                                        22020039
220300     STRING PC-CAL-DETAILS-INDENT                DELIMITED BY SIZE22030039
220400            'DPG54-CMPR-DATE-VALID-IND ('        DELIMITED BY SIZE22040039
220500            DPG54-CMPR-DATE-VALID-IND            DELIMITED BY SIZE22050039
220600            ')'                                  DELIMITED BY SIZE22060039
220700         INTO CD-CALENDAR-DETAILS-ENTRY (CD-INDEX).               22070039
220800     SET CD-INDEX UP BY 1.                                        22080039
220900     STRING PC-CAL-DETAILS-INDENT                DELIMITED BY SIZE22090039
221000            'DPG54-INCR-DECR-IND ('              DELIMITED BY SIZE22100039
221100            DPG54-INCR-DECR-IND                  DELIMITED BY SIZE22110039
221200            ')'                                  DELIMITED BY SIZE22120039
221300         INTO CD-CALENDAR-DETAILS-ENTRY (CD-INDEX).               22130039
221400     SET CD-INDEX UP BY 1.                                        22140039
221500     STRING PC-CAL-DETAILS-INDENT                DELIMITED BY SIZE22150039
221600            'DPG54-ERROR-IND ('                  DELIMITED BY SIZE22160039
221700            DPG54-ERROR-IND                      DELIMITED BY SIZE22170039
221800            ')'                                  DELIMITED BY SIZE22180039
221900         INTO CD-CALENDAR-DETAILS-ENTRY (CD-INDEX).               22190039
222000     SET CD-INDEX UP BY 1.                                        22200039
222100     STRING PC-CAL-DETAILS-INDENT                DELIMITED BY SIZE22210039
222200            'DPG54-ERROR-MESSAGE ('              DELIMITED BY SIZE22220039
222300            DPG54-ERROR-MESSAGE                  DELIMITED BY SIZE22230039
222400            ')'                                  DELIMITED BY SIZE22240039
222500         INTO CD-CALENDAR-DETAILS-ENTRY (CD-INDEX).               22250039
222600     SET CD-INDEX UP BY 1.                                        22260039
222610                                                                  22261057
222620*                                                                 22262058
222630*  FORMAT DPG55 PARAMETERS                                        22263058
222640*                                                                 22264058
222700                                                                  22270039
222800     SET CD-INDEX UP BY 1.                                        22280039
222900     STRING 'DPG55 - ACTUAL CALENDAR RESULT '    DELIMITED BY SIZE22290039
223000            'INFORMATION FOR THE TARGET DATE '   DELIMITED BY SIZE22300039
223100         INTO CD-CALENDAR-DETAILS-ENTRY (CD-INDEX).               22310039
223200     SET CD-INDEX UP BY 1.                                        22320039
223300     STRING '        (PRIMARY INPUT DATE OR '    DELIMITED BY SIZE22330039
223400            'THE RESULT OF AN INCR/DECR)'        DELIMITED BY SIZE22340039
223500         INTO CD-CALENDAR-DETAILS-ENTRY (CD-INDEX).               22350039
223600     SET CD-INDEX UP BY 1.                                        22360039
223700     SET CD-INDEX UP BY 1.                                        22370039
223800                                                                  22380039
223900     STRING PC-CAL-DETAILS-INDENT                DELIMITED BY SIZE22390039
224000            'DPG55-DB2-ISO-DATE-FMT ('           DELIMITED BY SIZE22400039
224100            DPG55-DB2-ISO-DATE-FMT               DELIMITED BY SIZE22410039
224200            ')'                                  DELIMITED BY SIZE22420039
224300         INTO CD-CALENDAR-DETAILS-ENTRY (CD-INDEX).               22430039
224400     SET CD-INDEX UP BY 1.                                        22440039
224500     STRING PC-CAL-DETAILS-INDENT                DELIMITED BY SIZE22450039
224600            'DPG55-DB2-ISO-DATE ('               DELIMITED BY SIZE22460039
224700            DPG55-DB2-ISO-DATE                   DELIMITED BY SIZE22470039
224800            ')'                                  DELIMITED BY SIZE22480039
224900         INTO CD-CALENDAR-DETAILS-ENTRY (CD-INDEX).               22490039
225000     SET CD-INDEX UP BY 1.                                        22500039
225100     STRING PC-CAL-DETAILS-INDENT                DELIMITED BY SIZE22510039
225200            'DPG55-GREG-CC-DATE-FMT ('           DELIMITED BY SIZE22520039
225300            DPG55-GREG-CC-DATE-FMT               DELIMITED BY SIZE22530039
225400            ')'                                  DELIMITED BY SIZE22540039
225500         INTO CD-CALENDAR-DETAILS-ENTRY (CD-INDEX).               22550039
225600     SET CD-INDEX UP BY 1.                                        22560039
225700     STRING PC-CAL-DETAILS-INDENT                DELIMITED BY SIZE22570039
225800            'DPG55-GREG-CC-DATE ('               DELIMITED BY SIZE22580039
225900            DPG55-GREG-CC-DATE                   DELIMITED BY SIZE22590039
226000            ')'                                  DELIMITED BY SIZE22600039
226100         INTO CD-CALENDAR-DETAILS-ENTRY (CD-INDEX).               22610039
226200     SET CD-INDEX UP BY 1.                                        22620039
226300     STRING PC-CAL-DETAILS-INDENT                DELIMITED BY SIZE22630039
226400            'DPG55-GREG-DATE-FMT ('              DELIMITED BY SIZE22640039
226500            DPG55-GREG-DATE-FMT                  DELIMITED BY SIZE22650039
226600            ')'                                  DELIMITED BY SIZE22660039
226700         INTO CD-CALENDAR-DETAILS-ENTRY (CD-INDEX).               22670039
226800     SET CD-INDEX UP BY 1.                                        22680039
226900     STRING PC-CAL-DETAILS-INDENT                DELIMITED BY SIZE22690039
227000            'DPG55-GREG-DATE ('                  DELIMITED BY SIZE22700039
227100            DPG55-GREG-DATE                      DELIMITED BY SIZE22710039
227200            ')'                                  DELIMITED BY SIZE22720039
227300         INTO CD-CALENDAR-DETAILS-ENTRY (CD-INDEX).               22730039
227400     SET CD-INDEX UP BY 1.                                        22740039
227500     STRING PC-CAL-DETAILS-INDENT                DELIMITED BY SIZE22750039
227600            'DPG55-JULIAN-DATE-CCYYDDD ('        DELIMITED BY SIZE22760039
227700            DPG55-JULIAN-DATE-CCYYDDD            DELIMITED BY SIZE22770039
227800            ')'                                  DELIMITED BY SIZE22780039
227900         INTO CD-CALENDAR-DETAILS-ENTRY (CD-INDEX).               22790039
228000     SET CD-INDEX UP BY 1.                                        22800039
228100     STRING PC-CAL-DETAILS-INDENT                DELIMITED BY SIZE22810039
228200            'DPG55-JULIAN-DATE-FMT ('            DELIMITED BY SIZE22820039
228300            DPG55-JULIAN-DATE-FMT                DELIMITED BY SIZE22830039
228400            ')'                                  DELIMITED BY SIZE22840039
228500         INTO CD-CALENDAR-DETAILS-ENTRY (CD-INDEX).               22850039
228600     SET CD-INDEX UP BY 1.                                        22860039
228700     STRING PC-CAL-DETAILS-INDENT                DELIMITED BY SIZE22870039
228800            'DPG55-JULIAN-DATE ('                DELIMITED BY SIZE22880039
228900            DPG55-JULIAN-DATE                    DELIMITED BY SIZE22890039
229000            ')'                                  DELIMITED BY SIZE22900039
229100         INTO CD-CALENDAR-DETAILS-ENTRY (CD-INDEX).               22910039
229200     SET CD-INDEX UP BY 1.                                        22920039
229300     STRING PC-CAL-DETAILS-INDENT                DELIMITED BY SIZE22930039
229400            'DPG55-ALPHA-MONTH ('                DELIMITED BY SIZE22940039
229500            DPG55-ALPHA-MONTH                    DELIMITED BY SIZE22950039
229600            ')'                                  DELIMITED BY SIZE22960039
229700         INTO CD-CALENDAR-DETAILS-ENTRY (CD-INDEX).               22970039
229800     SET CD-INDEX UP BY 1.                                        22980039
229900     STRING PC-CAL-DETAILS-INDENT                DELIMITED BY SIZE22990039
230000            'DPG55-ALPHA-MONTH-ABBR3 ('          DELIMITED BY SIZE23000039
230100            DPG55-ALPHA-MONTH-ABBR3              DELIMITED BY SIZE23010039
230200            ')'                                  DELIMITED BY SIZE23020039
230300         INTO CD-CALENDAR-DETAILS-ENTRY (CD-INDEX).               23030039
230400     SET CD-INDEX UP BY 1.                                        23040039
230500     STRING PC-CAL-DETAILS-INDENT                DELIMITED BY SIZE23050039
230600            'DPG55-DAYS-IN-MONTH ('              DELIMITED BY SIZE23060039
230700            DPG55-DAYS-IN-MONTH                  DELIMITED BY SIZE23070039
230800            ')'                                  DELIMITED BY SIZE23080039
230900         INTO CD-CALENDAR-DETAILS-ENTRY (CD-INDEX).               23090039
231000     SET CD-INDEX UP BY 1.                                        23100039
231100     STRING PC-CAL-DETAILS-INDENT                DELIMITED BY SIZE23110039
231200            'DPG55-ALPHA-WEEK-DAY ('             DELIMITED BY SIZE23120039
231300            DPG55-ALPHA-WEEK-DAY                 DELIMITED BY SIZE23130039
231400            ')'                                  DELIMITED BY SIZE23140039
231500         INTO CD-CALENDAR-DETAILS-ENTRY (CD-INDEX).               23150039
231600     SET CD-INDEX UP BY 1.                                        23160039
231700     STRING PC-CAL-DETAILS-INDENT                DELIMITED BY SIZE23170039
231800            'DPG55-ALPHA-WEEK-DAY-ABBR3 ('       DELIMITED BY SIZE23180039
231900            DPG55-ALPHA-WEEK-DAY-ABBR3           DELIMITED BY SIZE23190039
232000            ')'                                  DELIMITED BY SIZE23200039
232100         INTO CD-CALENDAR-DETAILS-ENTRY (CD-INDEX).               23210039
232200     SET CD-INDEX UP BY 1.                                        23220039
232300     STRING PC-CAL-DETAILS-INDENT                DELIMITED BY SIZE23230039
232400            'DPG55-ALPHA-WEEK-DAY-ABBR2 ('       DELIMITED BY SIZE23240039
232500            DPG55-ALPHA-WEEK-DAY-ABBR2           DELIMITED BY SIZE23250039
232600            ')'                                  DELIMITED BY SIZE23260039
232700         INTO CD-CALENDAR-DETAILS-ENTRY (CD-INDEX).               23270039
232800     SET CD-INDEX UP BY 1.                                        23280039
232900     STRING PC-CAL-DETAILS-INDENT                DELIMITED BY SIZE23290039
233000            'DPG55-NUMERIC-WEEK-DAY ('           DELIMITED BY SIZE23300039
233100            DPG55-NUMERIC-WEEK-DAY               DELIMITED BY SIZE23310039
233200            ')'                                  DELIMITED BY SIZE23320039
233300         INTO CD-CALENDAR-DETAILS-ENTRY (CD-INDEX).               23330039
233400     SET CD-INDEX UP BY 1.                                        23340039
233500     STRING PC-CAL-DETAILS-INDENT                DELIMITED BY SIZE23350039
233600            'DPG55-1ST-WKDY-DB2ISO-FMT ('        DELIMITED BY SIZE23360039
233700            DPG55-1ST-WKDY-DB2ISO-FMT            DELIMITED BY SIZE23370039
233800            ')'                                  DELIMITED BY SIZE23380039
233900         INTO CD-CALENDAR-DETAILS-ENTRY (CD-INDEX).               23390039
234000     SET CD-INDEX UP BY 1.                                        23400039
234100     STRING PC-CAL-DETAILS-INDENT                DELIMITED BY SIZE23410039
234200            'DPG55-1ST-WKDY-GREG-CC ('           DELIMITED BY SIZE23420039
234300            DPG55-1ST-WKDY-GREG-CC               DELIMITED BY SIZE23430039
234400            ')'                                  DELIMITED BY SIZE23440039
234500         INTO CD-CALENDAR-DETAILS-ENTRY (CD-INDEX).               23450039
234600     SET CD-INDEX UP BY 1.                                        23460039
234700     STRING PC-CAL-DETAILS-INDENT                DELIMITED BY SIZE23470039
234800            'DPG55-1ST-WKDY-GREG-FMT ('          DELIMITED BY SIZE23480039
234900            DPG55-1ST-WKDY-GREG-FMT              DELIMITED BY SIZE23490039
235000            ')'                                  DELIMITED BY SIZE23500039
235100         INTO CD-CALENDAR-DETAILS-ENTRY (CD-INDEX).               23510039
235200     SET CD-INDEX UP BY 1.                                        23520039
235300     STRING PC-CAL-DETAILS-INDENT                DELIMITED BY SIZE23530039
235400            'DPG55-1ST-WKDY-GREG ('              DELIMITED BY SIZE23540039
235500            DPG55-1ST-WKDY-GREG                  DELIMITED BY SIZE23550039
235600            ')'                                  DELIMITED BY SIZE23560039
235700         INTO CD-CALENDAR-DETAILS-ENTRY (CD-INDEX).               23570039
235800     SET CD-INDEX UP BY 1.                                        23580039
235900     STRING PC-CAL-DETAILS-INDENT                DELIMITED BY SIZE23590039
236000            'DPG55-1ST-WKDY-JULIAN ('            DELIMITED BY SIZE23600039
236100            DPG55-1ST-WKDY-JULIAN                DELIMITED BY SIZE23610039
236200            ')'                                  DELIMITED BY SIZE23620039
236300         INTO CD-CALENDAR-DETAILS-ENTRY (CD-INDEX).               23630039
236400     SET CD-INDEX UP BY 1.                                        23640039
236500     STRING PC-CAL-DETAILS-INDENT                DELIMITED BY SIZE23650039
236600            'DPG55-LAST-WKDY-DB2ISO-FMT ('       DELIMITED BY SIZE23660039
236700            DPG55-LAST-WKDY-DB2ISO-FMT           DELIMITED BY SIZE23670039
236800            ')'                                  DELIMITED BY SIZE23680039
236900         INTO CD-CALENDAR-DETAILS-ENTRY (CD-INDEX).               23690039
237000     SET CD-INDEX UP BY 1.                                        23700039
237100     STRING PC-CAL-DETAILS-INDENT                DELIMITED BY SIZE23710039
237200            'DPG55-LAST-WKDY-GREG-CC ('          DELIMITED BY SIZE23720039
237300            DPG55-LAST-WKDY-GREG-CC              DELIMITED BY SIZE23730039
237400            ')'                                  DELIMITED BY SIZE23740039
237500         INTO CD-CALENDAR-DETAILS-ENTRY (CD-INDEX).               23750039
237600     SET CD-INDEX UP BY 1.                                        23760039
237700     STRING PC-CAL-DETAILS-INDENT                DELIMITED BY SIZE23770039
237800            'DPG55-LAST-WKDY-GREG-FMT ('         DELIMITED BY SIZE23780039
237900            DPG55-LAST-WKDY-GREG-FMT             DELIMITED BY SIZE23790039
238000            ')'                                  DELIMITED BY SIZE23800039
238100         INTO CD-CALENDAR-DETAILS-ENTRY (CD-INDEX).               23810039
238200     SET CD-INDEX UP BY 1.                                        23820039
238300     STRING PC-CAL-DETAILS-INDENT                DELIMITED BY SIZE23830039
238400            'DPG55-LAST-WKDY-GREG ('             DELIMITED BY SIZE23840039
238500            DPG55-LAST-WKDY-GREG                 DELIMITED BY SIZE23850039
238600            ')'                                  DELIMITED BY SIZE23860039
238700         INTO CD-CALENDAR-DETAILS-ENTRY (CD-INDEX).               23870039
238800     SET CD-INDEX UP BY 1.                                        23880039
238900     STRING PC-CAL-DETAILS-INDENT                DELIMITED BY SIZE23890039
239000            'DPG55-LAST-WKDY-JULIAN ('           DELIMITED BY SIZE23900039
239100            DPG55-LAST-WKDY-JULIAN               DELIMITED BY SIZE23910039
239200            ')'                                  DELIMITED BY SIZE23920039
239300         INTO CD-CALENDAR-DETAILS-ENTRY (CD-INDEX).               23930039
239400     SET CD-INDEX UP BY 1.                                        23940039
239500     STRING PC-CAL-DETAILS-INDENT                DELIMITED BY SIZE23950039
239600            'DPG55-CORP-BUS-DAY-IND ('           DELIMITED BY SIZE23960039
239700            DPG55-CORP-BUS-DAY-IND               DELIMITED BY SIZE23970039
239800            ')'                                  DELIMITED BY SIZE23980039
239900         INTO CD-CALENDAR-DETAILS-ENTRY (CD-INDEX).               23990039
240000     SET CD-INDEX UP BY 1.                                        24000039
240100     STRING PC-CAL-DETAILS-INDENT                DELIMITED BY SIZE24010039
240200            'DPG55-CORP-HOLIDAY-IND ('           DELIMITED BY SIZE24020039
240300            DPG55-CORP-HOLIDAY-IND               DELIMITED BY SIZE24030039
240400            ')'                                  DELIMITED BY SIZE24040039
240500         INTO CD-CALENDAR-DETAILS-ENTRY (CD-INDEX).               24050039
240600     SET CD-INDEX UP BY 1.                                        24060039
240700     STRING PC-CAL-DETAILS-INDENT                DELIMITED BY SIZE24070039
240800            'DPG55-STORE-HOLIDAY-IND ('          DELIMITED BY SIZE24080039
240900            DPG55-STORE-HOLIDAY-IND              DELIMITED BY SIZE24090039
241000            ')'                                  DELIMITED BY SIZE24100039
241100         INTO CD-CALENDAR-DETAILS-ENTRY (CD-INDEX).               24110039
241200     SET CD-INDEX UP BY 1.                                        24120039
241300     STRING PC-CAL-DETAILS-INDENT                DELIMITED BY SIZE24130039
241400            'DPG55-CMPR-GREG-CC-FMT ('           DELIMITED BY SIZE24140039
241500            DPG55-CMPR-GREG-CC-FMT               DELIMITED BY SIZE24150039
241600            ')'                                  DELIMITED BY SIZE24160039
241700         INTO CD-CALENDAR-DETAILS-ENTRY (CD-INDEX).               24170039
241800     SET CD-INDEX UP BY 1.                                        24180039
241900     MOVE DPG55-DAYS-DIFFERENCE TO PV-DAYS-DIFF-FMT.              24190039
242000     STRING PC-CAL-DETAILS-INDENT                DELIMITED BY SIZE24200039
242100            'DPG55-DAYS-DIFFERENCE ('            DELIMITED BY SIZE24210039
242200            PV-DAYS-DIFF-FMT                     DELIMITED BY SIZE24220039
242300            ')'                                  DELIMITED BY SIZE24230039
242400         INTO CD-CALENDAR-DETAILS-ENTRY (CD-INDEX).               24240039
242500     SET CD-INDEX UP BY 1.                                        24250039
242600     MOVE DPG55-BUS-DAYS-DIFFERENCE TO PV-DAYS-DIFF-FMT.          24260039
242700     STRING PC-CAL-DETAILS-INDENT                DELIMITED BY SIZE24270039
242800            'DPG55-BUS-DAYS-DIFFERENCE ('        DELIMITED BY SIZE24280039
242900            PV-DAYS-DIFF-FMT                     DELIMITED BY SIZE24290039
243000            ')'                                  DELIMITED BY SIZE24300039
243100         INTO CD-CALENDAR-DETAILS-ENTRY (CD-INDEX).               24310039
243200     SET CD-INDEX UP BY 1.                                        24320039
243300     STRING PC-CAL-DETAILS-INDENT                DELIMITED BY SIZE24330039
243400            'DPG55-ACTUAL-HOLIDAY-IND ('         DELIMITED BY SIZE24340039
243500            DPG55-ACTUAL-HOLIDAY-IND             DELIMITED BY SIZE24350039
243600            ')'                                  DELIMITED BY SIZE24360039
243700         INTO CD-CALENDAR-DETAILS-ENTRY (CD-INDEX).               24370039
243800     SET CD-INDEX UP BY 1.                                        24380039
243900     STRING PC-CAL-DETAILS-INDENT                DELIMITED BY SIZE24390039
244000            'DPG55-HOLIDAY-NAME ('               DELIMITED BY SIZE24400039
244100            DPG55-HOLIDAY-NAME                   DELIMITED BY SIZE24410039
244200            ')'                                  DELIMITED BY SIZE24420039
244300         INTO CD-CALENDAR-DETAILS-ENTRY (CD-INDEX).               24430039
244400     SET CD-INDEX UP BY 1.                                        24440039
244410                                                                  24441057
244420*                                                                 24442058
244430*  FORMAT DPG56 PARAMETERS                                        24443058
244440*                                                                 24444058
244500                                                                  24450039
244600     SET CD-INDEX UP BY 1.                                        24460039
244700     STRING 'DPG56 - FISCAL CALENDAR RESULT '    DELIMITED BY SIZE24470042
244800            'INFORMATION FOR THE TARGET DATE '   DELIMITED BY SIZE24480039
244900         INTO CD-CALENDAR-DETAILS-ENTRY (CD-INDEX).               24490039
245000     SET CD-INDEX UP BY 1.                                        24500039
245100     STRING '        (PRIMARY INPUT DATE OR '    DELIMITED BY SIZE24510039
245200            'THE RESULT OF AN INCR/DECR)'        DELIMITED BY SIZE24520039
245300         INTO CD-CALENDAR-DETAILS-ENTRY (CD-INDEX).               24530039
245400     SET CD-INDEX UP BY 1.                                        24540039
245500     STRING '        FOR THE FISCAL CALENDAR '   DELIMITED BY SIZE24550039
245600            'THAT WAS SPECIFIED'                 DELIMITED BY SIZE24560039
245700         INTO CD-CALENDAR-DETAILS-ENTRY (CD-INDEX).               24570039
245800     SET CD-INDEX UP BY 1.                                        24580039
245900     SET CD-INDEX UP BY 1.                                        24590039
246000                                                                  24600039
246100     STRING PC-CAL-DETAILS-INDENT                DELIMITED BY SIZE24610039
246200            'DPG56-FISCAL-YEAR-NBR-X ('          DELIMITED BY SIZE24620039
246300            DPG56-FISCAL-YEAR-NBR-X              DELIMITED BY SIZE24630039
246400            ')'                                  DELIMITED BY SIZE24640039
246500         INTO CD-CALENDAR-DETAILS-ENTRY (CD-INDEX).               24650039
246600     SET CD-INDEX UP BY 1.                                        24660039
246700     STRING PC-CAL-DETAILS-INDENT                DELIMITED BY SIZE24670039
246800            'DPG56-FIRST-FD-DB2-ISO-FMT ('       DELIMITED BY SIZE24680039
246900            DPG56-FIRST-FD-DB2-ISO-FMT           DELIMITED BY SIZE24690039
247000            ')'                                  DELIMITED BY SIZE24700039
247100         INTO CD-CALENDAR-DETAILS-ENTRY (CD-INDEX).               24710039
247200     SET CD-INDEX UP BY 1.                                        24720039
247300     STRING PC-CAL-DETAILS-INDENT                DELIMITED BY SIZE24730039
247400            'DPG56-FIRST-FD-GREG-CC ('           DELIMITED BY SIZE24740039
247500            DPG56-FIRST-FD-GREG-CC               DELIMITED BY SIZE24750039
247600            ')'                                  DELIMITED BY SIZE24760039
247700         INTO CD-CALENDAR-DETAILS-ENTRY (CD-INDEX).               24770039
247800     SET CD-INDEX UP BY 1.                                        24780039
247900     STRING PC-CAL-DETAILS-INDENT                DELIMITED BY SIZE24790039
248000            'DPG56-FIRST-FD-GREG-FMT ('          DELIMITED BY SIZE24800039
248100            DPG56-FIRST-FD-GREG-FMT              DELIMITED BY SIZE24810039
248200            ')'                                  DELIMITED BY SIZE24820039
248300         INTO CD-CALENDAR-DETAILS-ENTRY (CD-INDEX).               24830039
248400     SET CD-INDEX UP BY 1.                                        24840039
248500     STRING PC-CAL-DETAILS-INDENT                DELIMITED BY SIZE24850039
248600            'DPG56-FIRST-FD-GREG ('              DELIMITED BY SIZE24860039
248700            DPG56-FIRST-FD-GREG                  DELIMITED BY SIZE24870039
248800            ')'                                  DELIMITED BY SIZE24880039
248900         INTO CD-CALENDAR-DETAILS-ENTRY (CD-INDEX).               24890039
249000     SET CD-INDEX UP BY 1.                                        24900039
249100     STRING PC-CAL-DETAILS-INDENT                DELIMITED BY SIZE24910039
249200            'DPG56-FIRST-FD-JULIAN ('            DELIMITED BY SIZE24920039
249300            DPG56-FIRST-FD-JULIAN                DELIMITED BY SIZE24930039
249400            ')'                                  DELIMITED BY SIZE24940039
249500         INTO CD-CALENDAR-DETAILS-ENTRY (CD-INDEX).               24950039
249600     SET CD-INDEX UP BY 1.                                        24960039
249700     STRING PC-CAL-DETAILS-INDENT                DELIMITED BY SIZE24970039
249800            'DPG56-LAST-FD-DB2-ISO-FMT ('        DELIMITED BY SIZE24980039
249900            DPG56-LAST-FD-DB2-ISO-FMT            DELIMITED BY SIZE24990039
250000            ')'                                  DELIMITED BY SIZE25000039
250100         INTO CD-CALENDAR-DETAILS-ENTRY (CD-INDEX).               25010039
250200     SET CD-INDEX UP BY 1.                                        25020039
250300     STRING PC-CAL-DETAILS-INDENT                DELIMITED BY SIZE25030039
250400            'DPG56-LAST-FD-GREG-CC ('            DELIMITED BY SIZE25040039
250500            DPG56-LAST-FD-GREG-CC                DELIMITED BY SIZE25050039
250600            ')'                                  DELIMITED BY SIZE25060039
250700         INTO CD-CALENDAR-DETAILS-ENTRY (CD-INDEX).               25070039
250800     SET CD-INDEX UP BY 1.                                        25080039
250900     STRING PC-CAL-DETAILS-INDENT                DELIMITED BY SIZE25090039
251000            'DPG56-LAST-FD-GREG-FMT ('           DELIMITED BY SIZE25100039
251100            DPG56-LAST-FD-GREG-FMT               DELIMITED BY SIZE25110039
251200            ')'                                  DELIMITED BY SIZE25120039
251300         INTO CD-CALENDAR-DETAILS-ENTRY (CD-INDEX).               25130039
251400     SET CD-INDEX UP BY 1.                                        25140039
251500     STRING PC-CAL-DETAILS-INDENT                DELIMITED BY SIZE25150039
251600            'DPG56-LAST-FD-GREG ('               DELIMITED BY SIZE25160039
251700            DPG56-LAST-FD-GREG                   DELIMITED BY SIZE25170039
251800            ')'                                  DELIMITED BY SIZE25180039
251900         INTO CD-CALENDAR-DETAILS-ENTRY (CD-INDEX).               25190039
252000     SET CD-INDEX UP BY 1.                                        25200039
252100     STRING PC-CAL-DETAILS-INDENT                DELIMITED BY SIZE25210039
252200            'DPG56-LAST-FD-JULIAN ('             DELIMITED BY SIZE25220039
252300            DPG56-LAST-FD-JULIAN                 DELIMITED BY SIZE25230039
252400            ')'                                  DELIMITED BY SIZE25240039
252500         INTO CD-CALENDAR-DETAILS-ENTRY (CD-INDEX).               25250039
252600     SET CD-INDEX UP BY 1.                                        25260039
252700     STRING PC-CAL-DETAILS-INDENT                DELIMITED BY SIZE25270039
252800            'DPG56-NBR-FISCAL-WEEKS-X ('         DELIMITED BY SIZE25280039
252900            DPG56-NBR-FISCAL-WEEKS-X             DELIMITED BY SIZE25290039
253000            ')'                                  DELIMITED BY SIZE25300039
253100         INTO CD-CALENDAR-DETAILS-ENTRY (CD-INDEX).               25310039
253200     SET CD-INDEX UP BY 1.                                        25320039
253300     STRING PC-CAL-DETAILS-INDENT                DELIMITED BY SIZE25330039
253400            'DPG56-FISCAL-WEEK-NBR-X ('          DELIMITED BY SIZE25340039
253500            DPG56-FISCAL-WEEK-NBR-X              DELIMITED BY SIZE25350039
253600            ')'                                  DELIMITED BY SIZE25360039
253700         INTO CD-CALENDAR-DETAILS-ENTRY (CD-INDEX).               25370039
253800     SET CD-INDEX UP BY 1.                                        25380039
253900     STRING PC-CAL-DETAILS-INDENT                DELIMITED BY SIZE25390039
254000            'DPG56-NBR-FISCAL-DAYS-X ('          DELIMITED BY SIZE25400039
254100            DPG56-NBR-FISCAL-DAYS-X              DELIMITED BY SIZE25410039
254200            ')'                                  DELIMITED BY SIZE25420039
254300         INTO CD-CALENDAR-DETAILS-ENTRY (CD-INDEX).               25430039
254400     SET CD-INDEX UP BY 1.                                        25440039
254500     STRING PC-CAL-DETAILS-INDENT                DELIMITED BY SIZE25450039
254600            'DPG56-CURR-FISCAL-SEASON ('         DELIMITED BY SIZE25460039
254700            DPG56-CURR-FISCAL-SEASON             DELIMITED BY SIZE25470039
254800            ')'                                  DELIMITED BY SIZE25480039
254900         INTO CD-CALENDAR-DETAILS-ENTRY (CD-INDEX).               25490039
255000     SET CD-INDEX UP BY 1.                                        25500039
255100     STRING PC-CAL-DETAILS-INDENT                DELIMITED BY SIZE25510039
255200            'DPG56-FISCAL-QTR-NBR-X ('           DELIMITED BY SIZE25520039
255300            DPG56-FISCAL-QTR-NBR                 DELIMITED BY SIZE25530039
255400            ')'                                  DELIMITED BY SIZE25540039
255500         INTO CD-CALENDAR-DETAILS-ENTRY (CD-INDEX).               25550039
255600     SET CD-INDEX UP BY 1.                                        25560039
255700     STRING PC-CAL-DETAILS-INDENT                DELIMITED BY SIZE25570039
255800            'DPG56-FIRST-FQ-DB2-ISO-FMT ('       DELIMITED BY SIZE25580039
255900            DPG56-FIRST-FQ-DB2-ISO-FMT           DELIMITED BY SIZE25590039
256000            ')'                                  DELIMITED BY SIZE25600039
256100         INTO CD-CALENDAR-DETAILS-ENTRY (CD-INDEX).               25610039
256200     SET CD-INDEX UP BY 1.                                        25620039
256300     STRING PC-CAL-DETAILS-INDENT                DELIMITED BY SIZE25630039
256400            'DPG56-FIRST-FQ-GREG-CC ('           DELIMITED BY SIZE25640039
256500            DPG56-FIRST-FQ-GREG-CC               DELIMITED BY SIZE25650039
256600            ')'                                  DELIMITED BY SIZE25660039
256700         INTO CD-CALENDAR-DETAILS-ENTRY (CD-INDEX).               25670039
256800     SET CD-INDEX UP BY 1.                                        25680039
256900     STRING PC-CAL-DETAILS-INDENT                DELIMITED BY SIZE25690039
257000            'DPG56-FIRST-FQ-GREG-FMT ('          DELIMITED BY SIZE25700039
257100            DPG56-FIRST-FQ-GREG-FMT              DELIMITED BY SIZE25710039
257200            ')'                                  DELIMITED BY SIZE25720039
257300         INTO CD-CALENDAR-DETAILS-ENTRY (CD-INDEX).               25730039
257400     SET CD-INDEX UP BY 1.                                        25740039
257500     STRING PC-CAL-DETAILS-INDENT                DELIMITED BY SIZE25750039
257600            'DPG56-FIRST-FQ-GREG ('              DELIMITED BY SIZE25760039
257700            DPG56-FIRST-FQ-GREG                  DELIMITED BY SIZE25770039
257800            ')'                                  DELIMITED BY SIZE25780039
257900         INTO CD-CALENDAR-DETAILS-ENTRY (CD-INDEX).               25790039
258000     SET CD-INDEX UP BY 1.                                        25800039
258100     STRING PC-CAL-DETAILS-INDENT                DELIMITED BY SIZE25810039
258200            'DPG56-FIRST-FQ-JULIAN ('            DELIMITED BY SIZE25820039
258300            DPG56-FIRST-FQ-JULIAN                DELIMITED BY SIZE25830039
258400            ')'                                  DELIMITED BY SIZE25840039
258500         INTO CD-CALENDAR-DETAILS-ENTRY (CD-INDEX).               25850039
258600     SET CD-INDEX UP BY 1.                                        25860039
258700     STRING PC-CAL-DETAILS-INDENT                DELIMITED BY SIZE25870039
258800            'DPG56-LAST-FQ-DB2-ISO-FMT ('        DELIMITED BY SIZE25880039
258900            DPG56-LAST-FQ-DB2-ISO-FMT            DELIMITED BY SIZE25890039
259000            ')'                                  DELIMITED BY SIZE25900039
259100         INTO CD-CALENDAR-DETAILS-ENTRY (CD-INDEX).               25910039
259200     SET CD-INDEX UP BY 1.                                        25920039
259300     STRING PC-CAL-DETAILS-INDENT                DELIMITED BY SIZE25930039
259400            'DPG56-LAST-FQ-GREG-CC ('            DELIMITED BY SIZE25940039
259500            DPG56-LAST-FQ-GREG-CC                DELIMITED BY SIZE25950039
259600            ')'                                  DELIMITED BY SIZE25960039
259700         INTO CD-CALENDAR-DETAILS-ENTRY (CD-INDEX).               25970039
259800     SET CD-INDEX UP BY 1.                                        25980039
259900     STRING PC-CAL-DETAILS-INDENT                DELIMITED BY SIZE25990039
260000            'DPG56-LAST-FQ-GREG-FMT ('           DELIMITED BY SIZE26000039
260100            DPG56-LAST-FQ-GREG-FMT               DELIMITED BY SIZE26010039
260200            ')'                                  DELIMITED BY SIZE26020039
260300         INTO CD-CALENDAR-DETAILS-ENTRY (CD-INDEX).               26030039
260400     SET CD-INDEX UP BY 1.                                        26040039
260500     STRING PC-CAL-DETAILS-INDENT                DELIMITED BY SIZE26050039
260600            'DPG56-LAST-FQ-GREG ('               DELIMITED BY SIZE26060039
260700            DPG56-LAST-FQ-GREG                   DELIMITED BY SIZE26070039
260800            ')'                                  DELIMITED BY SIZE26080039
260900         INTO CD-CALENDAR-DETAILS-ENTRY (CD-INDEX).               26090039
261000     SET CD-INDEX UP BY 1.                                        26100039
261100     STRING PC-CAL-DETAILS-INDENT                DELIMITED BY SIZE26110039
261200            'DPG56-LAST-FQ-JULIAN ('             DELIMITED BY SIZE26120039
261300            DPG56-LAST-FQ-JULIAN                 DELIMITED BY SIZE26130039
261400            ')'                                  DELIMITED BY SIZE26140039
261500         INTO CD-CALENDAR-DETAILS-ENTRY (CD-INDEX).               26150039
261600     SET CD-INDEX UP BY 1.                                        26160039
261700     STRING PC-CAL-DETAILS-INDENT                DELIMITED BY SIZE26170039
261800            'DPG56-NBR-FISCAL-QTR-WEEKS-X ('     DELIMITED BY SIZE26180039
261900            DPG56-NBR-FISCAL-QTR-WEEKS-X         DELIMITED BY SIZE26190039
262000            ')'                                  DELIMITED BY SIZE26200039
262100         INTO CD-CALENDAR-DETAILS-ENTRY (CD-INDEX).               26210039
262200     SET CD-INDEX UP BY 1.                                        26220039
262300     STRING PC-CAL-DETAILS-INDENT                DELIMITED BY SIZE26230039
262400            'DPG56-FISCAL-QTR-WEEK-X ('          DELIMITED BY SIZE26240039
262500            DPG56-FISCAL-QTR-WEEK-X              DELIMITED BY SIZE26250039
262600            ')'                                  DELIMITED BY SIZE26260039
262700         INTO CD-CALENDAR-DETAILS-ENTRY (CD-INDEX).               26270039
262800     SET CD-INDEX UP BY 1.                                        26280039
262900     STRING PC-CAL-DETAILS-INDENT                DELIMITED BY SIZE26290039
263000            'DPG56-FISCAL-PERIOD-NBR-X ('        DELIMITED BY SIZE26300039
263100            DPG56-FISCAL-PERIOD-NBR-X            DELIMITED BY SIZE26310039
263200            ')'                                  DELIMITED BY SIZE26320039
263300         INTO CD-CALENDAR-DETAILS-ENTRY (CD-INDEX).               26330039
263400     SET CD-INDEX UP BY 1.                                        26340039
263500     STRING PC-CAL-DETAILS-INDENT                DELIMITED BY SIZE26350039
263600            'DPG56-FIRST-FP-DB2-ISO-FMT ('       DELIMITED BY SIZE26360039
263700            DPG56-FIRST-FP-DB2-ISO-FMT           DELIMITED BY SIZE26370039
263800            ')'                                  DELIMITED BY SIZE26380039
263900         INTO CD-CALENDAR-DETAILS-ENTRY (CD-INDEX).               26390039
264000     SET CD-INDEX UP BY 1.                                        26400039
264100     STRING PC-CAL-DETAILS-INDENT                DELIMITED BY SIZE26410039
264200            'DPG56-FIRST-FP-GREG-CC ('           DELIMITED BY SIZE26420039
264300            DPG56-FIRST-FP-GREG-CC               DELIMITED BY SIZE26430039
264400            ')'                                  DELIMITED BY SIZE26440039
264500         INTO CD-CALENDAR-DETAILS-ENTRY (CD-INDEX).               26450039
264600     SET CD-INDEX UP BY 1.                                        26460039
264700     STRING PC-CAL-DETAILS-INDENT                DELIMITED BY SIZE26470039
264800            'DPG56-FIRST-FP-GREG-FMT ('          DELIMITED BY SIZE26480039
264900            DPG56-FIRST-FP-GREG-FMT              DELIMITED BY SIZE26490039
265000            ')'                                  DELIMITED BY SIZE26500039
265100         INTO CD-CALENDAR-DETAILS-ENTRY (CD-INDEX).               26510039
265200     SET CD-INDEX UP BY 1.                                        26520039
265300     STRING PC-CAL-DETAILS-INDENT                DELIMITED BY SIZE26530039
265400            'DPG56-FIRST-FP-GREG ('              DELIMITED BY SIZE26540039
265500            DPG56-FIRST-FP-GREG                  DELIMITED BY SIZE26550039
265600            ')'                                  DELIMITED BY SIZE26560039
265700         INTO CD-CALENDAR-DETAILS-ENTRY (CD-INDEX).               26570039
265800     SET CD-INDEX UP BY 1.                                        26580039
265900     STRING PC-CAL-DETAILS-INDENT                DELIMITED BY SIZE26590039
266000            'DPG56-FIRST-FP-JULIAN ('            DELIMITED BY SIZE26600039
266100            DPG56-FIRST-FP-JULIAN                DELIMITED BY SIZE26610039
266200            ')'                                  DELIMITED BY SIZE26620039
266300         INTO CD-CALENDAR-DETAILS-ENTRY (CD-INDEX).               26630039
266400     SET CD-INDEX UP BY 1.                                        26640039
266500     STRING PC-CAL-DETAILS-INDENT                DELIMITED BY SIZE26650039
266600            'DPG56-LAST-FP-DB2-ISO-FMT ('        DELIMITED BY SIZE26660039
266700            DPG56-LAST-FP-DB2-ISO-FMT            DELIMITED BY SIZE26670039
266800            ')'                                  DELIMITED BY SIZE26680039
266900         INTO CD-CALENDAR-DETAILS-ENTRY (CD-INDEX).               26690039
267000     SET CD-INDEX UP BY 1.                                        26700039
267100     STRING PC-CAL-DETAILS-INDENT                DELIMITED BY SIZE26710039
267200            'DPG56-LAST-FP-GREG-CC ('            DELIMITED BY SIZE26720039
267300            DPG56-LAST-FP-GREG-CC                DELIMITED BY SIZE26730039
267400            ')'                                  DELIMITED BY SIZE26740039
267500         INTO CD-CALENDAR-DETAILS-ENTRY (CD-INDEX).               26750039
267600     SET CD-INDEX UP BY 1.                                        26760039
267700     STRING PC-CAL-DETAILS-INDENT                DELIMITED BY SIZE26770039
267800            'DPG56-LAST-FP-GREG-FMT ('           DELIMITED BY SIZE26780039
267900            DPG56-LAST-FP-GREG-FMT               DELIMITED BY SIZE26790039
268000            ')'                                  DELIMITED BY SIZE26800039
268100         INTO CD-CALENDAR-DETAILS-ENTRY (CD-INDEX).               26810039
268200     SET CD-INDEX UP BY 1.                                        26820039
268300     STRING PC-CAL-DETAILS-INDENT                DELIMITED BY SIZE26830039
268400            'DPG56-LAST-FP-GREG ('               DELIMITED BY SIZE26840039
268500            DPG56-LAST-FP-GREG                   DELIMITED BY SIZE26850039
268600            ')'                                  DELIMITED BY SIZE26860039
268700         INTO CD-CALENDAR-DETAILS-ENTRY (CD-INDEX).               26870039
268800     SET CD-INDEX UP BY 1.                                        26880039
268900     STRING PC-CAL-DETAILS-INDENT                DELIMITED BY SIZE26890039
269000            'DPG56-LAST-FP-JULIAN ('             DELIMITED BY SIZE26900039
269100            DPG56-LAST-FP-JULIAN                 DELIMITED BY SIZE26910039
269200            ')'                                  DELIMITED BY SIZE26920039
269300         INTO CD-CALENDAR-DETAILS-ENTRY (CD-INDEX).               26930039
269400     SET CD-INDEX UP BY 1.                                        26940039
269500     STRING PC-CAL-DETAILS-INDENT                DELIMITED BY SIZE26950039
269600            'DPG56-NBR-FISCAL-PERIOD-WEEK-X ('   DELIMITED BY SIZE26960039
269700            DPG56-NBR-FISCAL-PERIOD-WEEK-X       DELIMITED BY SIZE26970042
269800            ')'                                  DELIMITED BY SIZE26980039
269900         INTO CD-CALENDAR-DETAILS-ENTRY (CD-INDEX).               26990039
270000     SET CD-INDEX UP BY 1.                                        27000039
270100     STRING PC-CAL-DETAILS-INDENT                DELIMITED BY SIZE27010039
270200            'DPG56-FISCAL-PERIOD-WEEK-X ('       DELIMITED BY SIZE27020039
270300            DPG56-FISCAL-PERIOD-WEEK             DELIMITED BY SIZE27030039
270400            ')'                                  DELIMITED BY SIZE27040039
270500         INTO CD-CALENDAR-DETAILS-ENTRY (CD-INDEX).               27050039
270600     SET CD-INDEX UP BY 1.                                        27060039
270700     STRING PC-CAL-DETAILS-INDENT                DELIMITED BY SIZE27070039
270800            'DPG56-FISCAL-YEAR-CCYY-X ('         DELIMITED BY SIZE27080039
270900            DPG56-FISCAL-YEAR-CCYY-X             DELIMITED BY SIZE27090039
271000            ')'                                  DELIMITED BY SIZE27100039
271100         INTO CD-CALENDAR-DETAILS-ENTRY (CD-INDEX).               27110039
271200     SET CD-INDEX UP BY 1.                                        27120039
271300     STRING PC-CAL-DETAILS-INDENT                DELIMITED BY SIZE27130039
271400            'DPG56-FIRST-FS-DB2-ISO-FMT ('       DELIMITED BY SIZE27140039
271500            DPG56-FIRST-FS-DB2-ISO-FMT           DELIMITED BY SIZE27150039
271600            ')'                                  DELIMITED BY SIZE27160039
271700         INTO CD-CALENDAR-DETAILS-ENTRY (CD-INDEX).               27170039
271800     SET CD-INDEX UP BY 1.                                        27180039
271900     STRING PC-CAL-DETAILS-INDENT                DELIMITED BY SIZE27190039
272000            'DPG56-LAST-FS-DB2-ISO-FMT ('        DELIMITED BY SIZE27200039
272100            DPG56-LAST-FS-DB2-ISO-FMT            DELIMITED BY SIZE27210039
272200            ')'                                  DELIMITED BY SIZE27220039
272300         INTO CD-CALENDAR-DETAILS-ENTRY (CD-INDEX).               27230039
272400     SET CD-INDEX UP BY 1.                                        27240039
272500     MOVE DPG56-WEEKS-DIFFERENCE TO PV-FISCAL-DIFF-FMT.           27250039
272600     STRING PC-CAL-DETAILS-INDENT                DELIMITED BY SIZE27260039
272700            'DPG56-WEEKS-DIFFERENCE ('           DELIMITED BY SIZE27270039
272800            PV-FISCAL-DIFF-FMT                   DELIMITED BY SIZE27280039
272900            ')'                                  DELIMITED BY SIZE27290039
273000         INTO CD-CALENDAR-DETAILS-ENTRY (CD-INDEX).               27300039
273100     SET CD-INDEX UP BY 1.                                        27310039
273200     MOVE DPG56-PERIODS-DIFFERENCE TO PV-FISCAL-DIFF-FMT.         27320039
273300     STRING PC-CAL-DETAILS-INDENT                DELIMITED BY SIZE27330039
273400            'DPG56-PERIODS-DIFFERENCE ('         DELIMITED BY SIZE27340039
273500            PV-FISCAL-DIFF-FMT                   DELIMITED BY SIZE27350039
273600            ')'                                  DELIMITED BY SIZE27360039
273700         INTO CD-CALENDAR-DETAILS-ENTRY (CD-INDEX).               27370039
273800     SET CD-INDEX UP BY 1.                                        27380039
273900     STRING PC-CAL-DETAILS-INDENT                DELIMITED BY SIZE27390039
274000            'DPG56-FISCAL-PERIOD-NAME ('         DELIMITED BY SIZE27400039
274100            DPG56-FISCAL-PERIOD-NAME             DELIMITED BY SIZE27410039
274200            ')'                                  DELIMITED BY SIZE27420039
274300         INTO CD-CALENDAR-DETAILS-ENTRY (CD-INDEX).               27430039
274400     SET CD-INDEX UP BY 1.                                        27440039
274500     STRING PC-CAL-DETAILS-INDENT                DELIMITED BY SIZE27450039
274600            'DPG56-FISCAL-PERIOD-NAME-ABBR3 ('   DELIMITED BY SIZE27460039
274700            DPG56-FISCAL-PERIOD-NAME-ABBR3       DELIMITED BY SIZE27470039
274800            ')'                                  DELIMITED BY SIZE27480039
274900         INTO CD-CALENDAR-DETAILS-ENTRY (CD-INDEX).               27490039
275000     SET CD-INDEX UP BY 1.                                        27500041
275010                                                                  27501057
275020*                                                                 27502058
275030*  FORMAT CLOSING COMMENTS                                        27503058
275040*                                                                 27504058
275100                                                                  27510041
275110     SET CD-INDEX UP BY 1.                                        27511049
275200     SET CD-INDEX UP BY 1.                                        27520041
275300     MOVE '** SOME OF THE FISCAL SEASON INFORMATION PRESENTED ON T27530059
275400-              'HE RESULTS PANEL WAS' TO                          27540059
275500               CD-CALENDAR-DETAILS-ENTRY (CD-INDEX).              27550041
275600     SET CD-INDEX UP BY 1.                                        27560041
275700     MOVE '   DERIVED VIA COMPUTATIONS AND/OR A SERIES OF CALENDAR27570059
275710-              ' ROUTINE CALLS **' TO                             27571059
275800               CD-CALENDAR-DETAILS-ENTRY (CD-INDEX).              27580041
275900                                                                  27590038
275920*                                                                 27592058
275930*  SAVE DETAIL ENTRY COUNT                                        27593058
275940*                                                                 27594058
275950                                                                  27595057
276000     SET PV-CALENDAR-DETAILS-ENTRIES TO CD-INDEX.                 27600041
276100*4000-EXIT.                                                       27610038
276200                                                                  27620000
276300******************************************************************27630038
276400*  BUILD A BROWSABLE FORMATTED CALENDAR ROUTINE CALL DETAILS     *27640057
276500*  FILE FROM THE DETAILS THAT HAVE BEEN FORMATTED INTO THE       *27650057
276600*  CALENDAR DETAILS CORE TABLE.                                  *27660057
276700******************************************************************27670038
276800                                                                  27680038
276900 4100-BUILD-CAL-DETAILS-FILE.                                     27690041
277000     OPEN OUTPUT CALENDAR-DETAILS-FILE.                           27700041
277100                                                                  27710041
277200     PERFORM                                                      27720041
277300             VARYING CD-INDEX FROM 1 BY 1                         27730041
277400             UNTIL CD-INDEX > PV-CALENDAR-DETAILS-ENTRIES         27740041
277500         MOVE CD-CALENDAR-DETAILS-ENTRY (CD-INDEX) TO             27750041
277600                   CD-CALENDAR-DETAILS-RECORD                     27760041
277700         PERFORM 8000-WRITE-DETAILS-RECORD                        27770041
277800     END-PERFORM.                                                 27780041
277900                                                                  27790041
278000     CLOSE CALENDAR-DETAILS-FILE.                                 27800041
278100*4100-EXIT.                                                       27810041
278200                                                                  27820041
278300******************************************************************27830041
278400*  WRITE A CALENDAR ROUTINE CALL DETAILS RECORD.                 *27840041
278500******************************************************************27850041
278600                                                                  27860041
278700 8000-WRITE-DETAILS-RECORD.                                       27870041
278800     WRITE CD-CALENDAR-DETAILS-RECORD.                            27880038
278900*8000-EXIT.                                                       27890038
279000                                                                  27900038
279100******************************************************************27910000
279200*  DISPLAY THE CALENDAR ROUTINE REQUEST SPECIFICATION PANEL.     *27920000
279300******************************************************************27930000
279400                                                                  27940000
279500 9000-DISPLAY-REQUEST-PANEL.                                      27950000
279600     IF IV-CURSOR-POSITION = SPACES                               27960000
279700         MOVE IN-FIELD-CMNETCPD TO IV-CURSOR-POSITION             27970000
279800     END-IF.                                                      27980000
279900                                                                  27990000
280000     CALL IC-ISPF-SERVICE-LINK USING IC-DISPLAY-SERVICE-DISPLAY   28000038
280100                                     IN-PANEL-CMNETC0             28010000
280200                                     IV-ERROR-MESSAGE-FORMAT      28020000
280300                                     IV-CURSOR-POSITION.          28030000
280400                                                                  28040000
280500     INITIALIZE ID-SHORT-MESSAGE                                  28050000
280600                ID-LONG-MESSAGE                                   28060000
280700                IV-CURSOR-POSITION.                               28070000
280800                                                                  28080000
280900     SET IV-EM-DYNAMIC-SHORT-LONG-MSG TO TRUE.                    28090000
281000*9000-EXIT.                                                       28100038
281100                                                                  28110000
281200******************************************************************28120000
281300*  DISPLAY THE CALENDAR ROUTINE REQUEST RESULTS PANEL.           *28130000
281400******************************************************************28140000
281500                                                                  28150000
281600 9100-DISPLAY-RESULTS-PANEL.                                      28160000
281700     MOVE IN-FIELD-COMMAND-LINE TO IV-CURSOR-POSITION.            28170000
281800                                                                  28180041
281900     IF ID-LONG-MESSAGE = SPACES                                  28190041
282000         SET ID-SM-CALENDAR-DETAILS-MSG                           28200042
282100             ID-LM-CALENDAR-DETAILS-MSG TO TRUE                   28210042
282200     END-IF.                                                      28220041
282300                                                                  28230000
282400     CALL IC-ISPF-SERVICE-LINK USING IC-DISPLAY-SERVICE-DISPLAY   28240038
282500                                     IN-PANEL-CMNETC1             28250000
282600                                     IV-ERROR-MESSAGE-FORMAT      28260000
282700                                     IV-CURSOR-POSITION.          28270000
282800                                                                  28280041
282900     INITIALIZE ID-SHORT-MESSAGE                                  28290041
283000                ID-LONG-MESSAGE                                   28300041
283100                IV-CURSOR-POSITION.                               28310041
283200*9100-EXIT.                                                       28320038
283300                                                                  28330040
283400******************************************************************28340040
283500*  DISPLAY THE CALENDAR ROUTINE CALL DETAILS PANEL -- BROWSE     *28350040
283600*  THE TEMPORARY DATASET THAT CONTAINS THE FORMATTED DETAIL      *28360057
283610*  INFORMATION.                                                  *28361057
283700******************************************************************28370040
283800                                                                  28380040
283900 9200-DISPLAY-DETAILS-PANEL.                                      28390040
284000     MOVE IN-FIELD-COMMAND-LINE TO IV-CURSOR-POSITION.            28400040
284100                                                                  28410040
284200     CALL IC-ISPF-SERVICE-LINK USING IC-PDF-SERVICE-BROWSE        28420040
284300                                     PV-CAL-DETAILS-DSN-WO-USERID 28430040
284400                                     PV-CAL-DETAILS-VOLUME        28440040
284500                                     PV-CAL-DETAILS-PASSWORD      28450040
284600                                     IN-PANEL-CMNETC2.            28460042
284700*9200-EXIT.                                                       28470040
284800                                                                  28480038
284900******************************************************************28490038
285000*  ALLOCATE THE FORMATTED CALENDAR ROUTINE CALL DETAILS FILE     *28500057
285100*  USING THE DYNALC SUBROUTINE.  ATTEMPT TO DELETE ANY           *28510038
285200*  EQUIVALENT DSN THAT IS ALREADY CATALOGED.                     *28520038
285300******************************************************************28530038
285400                                                                  28540038
285500 9500-ALLOCATE-DETAILS-FILE.                                      28550038
285600     PERFORM 9600-DELETE-DETAILS-FILE.                            28560038
285700                                                                  28570038
285800     IF ((DP023-LASTRC = ZERO)                                    28580038
285900             OR (DP023-LASTRC = DP023-RC-DATASET-DOESNT-EXIST))   28590038
286000         INITIALIZE DP023-DYNALC-PARMS                            28600038
286100         MOVE PC-CAL-DETAILS-DDNAME TO DP023-DDNAME               28610038
286200         MOVE PV-CAL-DETAILS-DSN TO DP023-DSNAME                  28620038
286300         SET DP023-DISP-NEW TO TRUE                               28630038
286400         SET DP023-FREE-CLOSE-NO TO TRUE                          28640038
286500         SET DP023-RECFM-FIXED-BLOCK TO TRUE                      28650038
286600         MOVE LENGTH OF CD-CALENDAR-DETAILS-RECORD TO DP023-RECSZ 28660038
286700         MOVE PC-CAL-DETAILS-RECORD-COUNT TO DP023-RECOUNT        28670038
286800                                                                  28680038
286900         SET DP023-DISABLE-DISPLAY-ABEND TO TRUE                  28690038
287000                                                                  28700038
287100         PERFORM DP023-0000-DYNALC                                28710038
287200         IF DP023-LASTRC = ZERO                                   28720038
287300             SET PS-CAL-DETAILS-ALLOCATED TO TRUE                 28730038
287400         ELSE                                                     28740038
287500             SET PS-CAL-DETAILS-NOT-ALLOCATED TO TRUE             28750038
287600             MOVE DP023-DDNAME TO PV-DR-DDNAME                    28760038
287700             MOVE DP023-RC (DP023-SUB) TO PV-DR-RETURN-CODE       28770038
287800             MOVE DP023-DESC (DP023-SUB) TO PV-DR-ERROR-DESC      28780038
287900             MOVE PV-DYNALC-ROUTINE-ERROR-MSG TO ID-LONG-MESSAGE  28790038
288000         END-IF                                                   28800038
288100     ELSE                                                         28810038
288200         SET PS-CAL-DETAILS-NOT-ALLOCATED TO TRUE                 28820038
288300         MOVE DP023-DDNAME TO PV-DR-DDNAME                        28830038
288400         MOVE DP023-RC (DP023-SUB) TO PV-DR-RETURN-CODE           28840038
288500         MOVE DP023-DESC (DP023-SUB) TO PV-DR-ERROR-DESC          28850038
288600         MOVE PV-DYNALC-ROUTINE-ERROR-MSG TO ID-LONG-MESSAGE      28860038
288700     END-IF.                                                      28870038
288800*9500-EXIT.                                                       28880038
288900                                                                  28890038
289000******************************************************************28900038
289100*  DELETE THE FORMATTED CALENDAR ROUTINE CALL DETAILS FILE USING *28910057
289200*  THE DYNALC SUBROUTINE.                                        *28920038
289300******************************************************************28930038
289400                                                                  28940038
289500 9600-DELETE-DETAILS-FILE.                                        28950038
289600     INITIALIZE DP023-DYNALC-PARMS.                               28960038
289700     MOVE PC-CAL-DETAILS-DDNAME TO DP023-DDNAME                   28970038
289800     MOVE PV-CAL-DETAILS-DSN TO DP023-DSNAME                      28980038
289900     SET DP023-DISP-DELETE TO TRUE                                28990038
290000     SET DP023-FREE-CLOSE-NO TO TRUE                              29000038
290100     SET DP023-RECFM-FIXED-BLOCK TO TRUE                          29010038
290200     MOVE LENGTH OF CD-CALENDAR-DETAILS-RECORD TO DP023-RECSZ     29020038
290300     INITIALIZE DP023-RECOUNT.                                    29030038
290400                                                                  29040038
290500     SET DP023-DISABLE-DISPLAY-ABEND TO TRUE.                     29050038
290600                                                                  29060038
290700     PERFORM DP023-0000-DYNALC.                                   29070038
290800*9600-EXIT.                                                       29080038
290900                                                                  29090038
291000*                                                                 29100038
291100*  DYNAMIC ALLOCATION ROUTINE                                     29110038
291200*                                                                 29120038
291300     COPY DPPD023.                                                29130038
