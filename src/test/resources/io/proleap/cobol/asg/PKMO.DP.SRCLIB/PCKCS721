000200******************************************************************00020001
000300 IDENTIFICATION DIVISION.                                         00030001
000400******************************************************************00040001
000500                                                                  00050001
000600 PROGRAM-ID.    PCKCS721.                                         00060001
000700 AUTHOR.        PATRICK BURKE.                                    00070001
000800 INSTALLATION.  KOHLS.                                            00080001
000900 DATE-WRITTEN   OCTOBER, 2000.                                    00090001
001000 DATE-COMPILED.                                                   00100001
001100                                                                  00110001
001200******************************************************************00120001
001300*  THIS MODULE WILL BE CALLED BY PROGRAMS NEEDING THE MANIFEST NBR00130001
001400*  FROM TDCSTMF.                                                  00140001
001500******************************************************************00150001
001600******************************************************************00160001
001700 ENVIRONMENT DIVISION.                                            00170001
001800******************************************************************00180001
001900*                                                                 00190001
002000******************************************************************00200001
002100 DATA DIVISION.                                                   00210001
002200******************************************************************00220001
002300*                                                                 00230001
002400******************************************************************00240001
002500 WORKING-STORAGE SECTION.                                         00250001
002600******************************************************************00260001
002700*                                                                 00270001
002800******************************************************************00280001
002900*  DB2 FORMATTED MESSAGE AREA                                     00290001
003000******************************************************************00300001
003100     COPY DPWS004.                                                00310001
003200                                                                  00320001
003300******************************************************************00330001
003400*    COMMUNICATIONS AREA FOR DB2                                  00340001
003500******************************************************************00350001
003600                                                                  00360001
003700     EXEC SQL                                                     00370001
003800          INCLUDE SQLCA                                           00380001
003900     END-EXEC.                                                    00390001
004000                                                                  00400001
004100******************************************************************00410001
004200*                                                                 00420001
004300 01  ABEND-CODE                      PIC S9(04)    VALUE +0       00430001
004400                                                   COMP SYNC.     00440001
004500                                                                  00450001
004600 01  PS-PROGRAM-SWITCHES.                                         00460001
004700     05  PS-EOF-DCSTMF-CSR-SW       PIC  X(01)    VALUE 'N'.      00470001
004800         88  PS-EOF-DCSTMF-CSR                     VALUE 'Y'.     00480001
004900         88  PS-MORE-DCSTMF-CSR                    VALUE 'N'.     00490001
005000     05  PS-EOF-PROCESS-SW          PIC  X(01)    VALUE 'N'.      00500001
005100         88  PS-EOF-PROCESS                        VALUE 'Y'.     00510001
005200         88  PS-EOF-PROCESS-NO                     VALUE 'N'.     00520001
005300                                                                  00530001
005400                                                                  00540001
005500 01  PC-PROGRAM-CONSTANTS.                                        00550001
005600     05  PC-ROW-NOT-FOUND            PIC S9(04)    VALUE +100     00560001
005700                                                   COMP SYNC.     00570001
005800     05  PC-CURRENT-PROGRAM-NAME     PIC  X(08)    VALUE          00580001
005900         'PCKCS721'.                                              00590002
006000     05  PC-CURRENT-OPERATING-COMPANY                             00600001
006100                                     PIC  X(02)    VALUE '03'.    00610001
006200     05  PC-MAX-RETRIES              PIC S9(04)    VALUE +3       00620001
006300                                                   COMP SYNC.     00630001
006400     05  PC-CURRENT-TIMESTAMP        PIC  X(26)    VALUE SPACES.  00640001
006500                                                                  00650001
006600 01  PV-PROGRAM-VARIABLES.                                        00660001
006611     05  PV-SQL-RETURN-CD            PIC -999.                            
006612     05  PV-DISP-STR                 PIC 9(04).                           
006613     05  PV-DISP-LBL-QTY             PIC 9(05).                           
006620     05  PV-CICS-MSG-AREA            PIC  X(80)    VALUE SPACES.  00662033
006621     05  PV-COMMAREA-LENGTH          PIC S9(04)    VALUE +0       00662134
006622                                                   COMP SYNC.     00662234
006623     05  PV-CICS-RESPONSE            PIC S9(9)     VALUE ZERO     00662334
006624                                                   COMP SYNC.     00662434
006630                                                                  00663033
006700     05  PV-MFST-NBR                 PIC  S9(09)   VALUE ZERO     00670001
006800                                                   COMP SYNC.     00680001
006900     05  PV-DISPLAY-STR              PIC   9(04)   VALUE ZERO.    00690001
006910     05  PV-STR-NBR                  PIC  S9(04)   VALUE ZERO     00690001
007000                                                   COMP.          00700038
007010     05  PV-NO-OF-LBLS               PIC  S9(04)   VALUE ZERO     00701002
007020                                                   COMP SYNC.     00702002
007030     05  PV-DONE-PROCESSING-SW       PIC  X(01)    VALUE 'N'.     00703005
007040         88  PV-DONE-PROCESSING                    VALUE 'Y'.     00704005
007100     05  PV-ITEM-NBR                 PIC  9(15)    VALUE ZERO.    00710001
007200     05  PV-ABEND-PARAGRAPH          PIC  X(30)    VALUE SPACE.   00720001
007300     05  PV-PARAGRAPH-NAME           PIC  X(30)    VALUE SPACES.  00730001
007400     05  PV-DB2-OPERATION-ATTEMPTED  PIC  X(30)    VALUE SPACES.  00740001
007500     05  PV-OPEN-COUNTER             PIC S9(04)    VALUE ZERO     00750001
007600                                                   COMP SYNC.     00760001
007700     05  PV-CLOSE-COUNTER            PIC S9(04)    VALUE ZERO     00770001
007800                                                   COMP SYNC.     00780001
007900     05  PV-FETCH-COUNTER            PIC S9(04)    VALUE ZERO     00790001
008000                                                   COMP SYNC.     00800001
008100     05  PV-COMMIT-COUNTER           PIC S9(04)    VALUE ZERO     00810001
008200                                                   COMP SYNC.     00820001
008300     05  PV-INSERT-COUNTER           PIC S9(09)    VALUE ZERO     00830001
008400                                                   COMP SYNC.     00840001
008500     05  PV-RETRY-COUNTER           PIC S9(09)    VALUE ZERO      00850001
008600                                                   COMP SYNC.     00860001
008700     05  PV-DISPLAY-COUNT            PIC ZZZ,ZZZ,ZZ9.             00870001
008800                                                                  00880001
008900     05  PV-DB2-COUNT                PIC S9(09)    VALUE ZERO     00890001
009000                                                   COMP-3.        00900001
009100     05  PV-FORMAT-DATE.                                          00910001
009200         10  PV-YEAR                 PIC X(4)      VALUE '1999'.  00920001
009300         10  FILLER                  PIC X(1)      VALUE '-'.     00930001
009400         10  PV-MONTH                PIC X(2)      VALUE SPACES.  00940001
009500         10  FILLER                  PIC X(1)      VALUE '-'.     00950001
009600         10  PV-DAY                  PIC X(2)      VALUE SPACES.  00960001
009700                                                                  00970001
009800                                                                  00980001
009900 01  SD-SYSTEM-DATE.                                              00990001
010000     05  SD-SYSTEM-DATE-YY           PIC  9(02)      VALUE ZERO.  01000001
010100     05  SD-SYSTEM-DATE-MM           PIC  9(02)      VALUE ZERO.  01010001
010200     05  SD-SYSTEM-DATE-DD           PIC  9(02)      VALUE ZERO.  01020001
010300                                                                  01030001
010400******************************************************************01040002
010500*    ABEND PROCESSING COPYBOOK.                                   01050001
010600******************************************************************01060002
010700                                                                  01070001
010800     COPY DPWS013.                                                01080001
010900                                                                  01090001
011000     EJECT                                                        01100001
011010******************************************************************01101002
011020*    STORE MANIFEST LAYOUT.                                       01102002
011030******************************************************************01103002
011040                                                                  01104002
011050     COPY PCWS187.                                                01105015
011060                                                                  01106002
011070     EJECT                                                        01107002
011900******************************************************************01190001
012000*    DB2 AREA FOR THE STORE MANIFEST TABLE                        01200001
012100******************************************************************01210001
012200                                                                  01220001
012300     EXEC SQL                                                     01230001
012400         INCLUDE TDCSTMF                                          01240001
012500     END-EXEC.                                                    01250001
012600                                                                  01260001
013910******************************************************************01391001
013920*    DECLARATION FOR CURSOR SELECTING MANIFEST NBR FROM TDCSTMF   01392001
013930******************************************************************01393001
013940                                                                  01394001
013950     EXEC SQL                                                     01395001
013960         DECLARE  DCSTMF_CSR CURSOR FOR                           01396001
013970          SELECT  MFST_NBR                                        01397001
013980            FROM  TDCSTMF                                         01398001
013990        WHERE STR_NBR = :PV-STR-NBR                               01399003
013991        FOR UPDATE OF MFST_NBR                                    01399101
013992     END-EXEC.                                                    01399201
013993                                                                  01399301
013994******************************************************************01399419
013995 LINKAGE SECTION.                                                 01399519
013996******************************************************************01399619
013998 01  DFHCOMMAREA.                                                 01399837
013999     05  FILLER                         OCCURS  1 TO 4072 TIMES   01399937
014000                                        DEPENDING ON EIBCALEN.    01400037
014001         10  FILLER                   PIC X.                      01400137
014002                                                                  01400225
014010******************************************************************01401001
014100 PROCEDURE DIVISION.                                              01410001
014200******************************************************************01420001
014300                                                                  01430001
014400 0000-PROGRAM-MAINLINE.                                           01440001
014500******************************************************************01450001
014600* 0000-PROGRAM-MAINLINE - CONTROLS THE MAIN PROCESSING OF THE     01460001
014700*      PROGRAM.                                                   01470001
014800******************************************************************01480001
014810      MOVE DFHCOMMAREA                TO PC187-COMMAREA-REC.      01481032
014820                                                                  01482025
014900*                                                                 01490001
015000      PERFORM 1000-INITIALISE                                     01500033
015200      PERFORM 2000-PROCESS                                        01520033
015300              UNTIL PS-EOF-DCSTMF-CSR                             01530033
015301      MOVE  PC187-COMMAREA-REC    TO DFHCOMMAREA                  01530133
015302*     PERFORM 0500-EXIT-PROGRAM                                   01530233
015303      PERFORM 9000-RETURN-CALL.                                   01530335
015304      GOBACK.                                                     01530433
015600*                                                                 01560001
015610 0500-EXIT-PROGRAM.                                               01561017
015620      EXIT PROGRAM.                                               01562017
015630                                                                  01563017
015700 1000-INITIALISE.                                                 01570001
015800******************************************************************01580001
015900* 1000-INITIALISE.                                                01590001
016000******************************************************************01600001
016100*                                                                 01610001
016200             SET PS-MORE-DCSTMF-CSR  TO TRUE.                     01620001
016300                                                                  01630001
016400 2000-PROCESS.                                                    01640001
016500******************************************************************01650001
016600* 2000-PROCESS                                                    01660001
016700******************************************************************01670001
018020                                                                  01802001
018021     SET  PC187-CRA-SUCCESSFUL  TO  TRUE.                         01802133
018022     MOVE PC187-STR-NBR         TO  PV-STR-NBR.                   01802233
018023                                                                  01802333
018030     PERFORM 3310-OPEN-DCSTMF-CURSOR                              01803033
018040     PERFORM 3320-FETCH-DCSTMF-CURSOR                             01804033
018041                                                                  01804102
018042     IF DCSTMF-MFST-NBR > 90000000                                        
018043        INITIALIZE DCSTMF-MFST-NBR                                        
018044        MOVE +1 TO DCSTMF-MFST-NBR                                        
018045     END-IF                                                               
018046                                                                          
018050     COMPUTE PV-MFST-NBR =                                        01805033
018060             DCSTMF-MFST-NBR + 1                                  01806033
018062     ADD  PC187-NO-OF-LBLS  TO DCSTMF-MFST-NBR                    01806233
018063     MOVE DCSTMF-MFST-NBR   TO PC187-END-MFST-NBR                 01806333
018071     MOVE PV-MFST-NBR       TO PC187-START-MFST-NBR               01807133
018072                                                                  01807202
018080     PERFORM 3300-UPDATE-TDCSTMF                                  01808033
018090     PERFORM 3500-SYNCPOINT                                       01809033
018091     SET  PV-DONE-PROCESSING          TO TRUE.                    01809133
018100                                                                  01810001
020100 3310-OPEN-DCSTMF-CURSOR.                                         02010001
020200******************************************************************02020001
020300*  3310-OPEN-DCSTMF-CURSOR.                                       02030001
020400******************************************************************02040001
020500                                                                  02050001
020600     EXEC SQL                                                     02060001
020700         OPEN DCSTMF_CSR                                          02070001
020800     END-EXEC.                                                    02080001
020900                                                                  02090001
021000     EVALUATE TRUE                                                02100001
021100         WHEN SQLCODE = ZERO                                      02110001
021200             CONTINUE                                             02120001
021300         WHEN SQLWARN0 NOT = SPACES                               02130001
021400         WHEN SQLCODE < ZERO                                      02140001
021500         WHEN SQLCODE > ZERO                                      02150001
021510              INITIALIZE  PV-CICS-MSG-AREA                        02151033
021511              MOVE SQLCODE                TO PV-SQL-RETURN-CD     02151134
021520              STRING ' PCKCS721 - '          DELIMITED BY SIZE    02152038
021521                     ' SQLCODE - '           DELIMITED BY SIZE    02152133
021522                     PV-SQL-RETURN-CD        DELIMITED BY SIZE    02152234
021530                                        INTO PV-CICS-MSG-AREA     02153033
021540              MOVE LENGTH OF PV-CICS-MSG-AREA                     02154033
021550                     TO PV-COMMAREA-LENGTH                        02155033
021560              PERFORM 9999-WRITE-TO-CSSL                          02156033
021561              MOVE PC187-STR-NBR    TO  PV-DISP-STR                       
021562              MOVE PC187-NO-OF-LBLS TO  PV-DISP-LBL-QTY                   
021570              INITIALIZE  PV-CICS-MSG-AREA                        02157033
021580              STRING ' PCKCS721 - '                                       
021590                     'STORE # - '                                         
021591                     PV-DISP-STR                                          
021592                     '  # OF LBLS - '                                     
021593                     PV-DISP-LBL-QTY                                      
021594                     '  PARA-'                                            
021595                     '3310-OPEN-DCSTMF-CURSOR' DELIMITED BY SIZE  02159533
021596                                           INTO PV-CICS-MSG-AREA  02159633
021597              MOVE LENGTH OF PV-CICS-MSG-AREA                     02159733
021598                     TO PV-COMMAREA-LENGTH                        02159833
021599              PERFORM 9999-WRITE-TO-CSSL                          02159933
021610                                                                  02161033
021611             MOVE SQLCODE             TO PV-SQL-RETURN-CD         02161133
021612             STRING 'SQL ERR '           DELIMITED BY SIZE        02161233
021614                    PV-SQL-RETURN-CD     DELIMITED BY SIZE        02161433
021616                                    INTO PC187-CRA-RET-MSG        02161633
021617             SET  PC187-CRA-SQLERROR  TO TRUE                     02161733
021618             MOVE '3310-'             TO PC187-CRA-REQ-ID         02161833
021619             PERFORM 9000-RETURN-CALL                             02161933
021620                                                                  02162033
022600     END-EVALUATE.                                                02260001
022700                                                                  02270001
022800 3320-FETCH-DCSTMF-CURSOR.                                        02280001
022900******************************************************************02290001
023000*  3320-FETCH-DCSTMF-CURSOR.                                      02300001
023100******************************************************************02310001
023200                                                                  02320001
023300     EXEC SQL                                                     02330001
023400         FETCH DCSTMF_CSR                                         02340001
023600          INTO :DCSTMF-MFST-NBR                                   02360026
023700     END-EXEC.                                                    02370001
023800                                                                  02380001
023900     EVALUATE TRUE                                                02390001
024000         WHEN SQLCODE = ZERO                                      02400001
024100             CONTINUE                                             02410001
024200         WHEN SQLCODE = +100                                      02420001
024300              SET PS-EOF-DCSTMF-CSR  TO TRUE                      02430001
024310              INITIALIZE  PV-CICS-MSG-AREA                        02881033
024320              MOVE PC187-STR-NBR          TO PV-DISPLAY-STR       02881134
024321              MOVE SQLCODE                TO PV-SQL-RETURN-CD     02881134
024330              STRING ' PCKCS721 - 3320 - '   DELIMITED BY SIZE    02882038
024340                     ' SQLCODE - '           DELIMITED BY SIZE    02883033
024350                     PV-SQL-RETURN-CD        DELIMITED BY SIZE    02884034
024360                                        INTO PV-CICS-MSG-AREA     02885033
024370              MOVE LENGTH OF PV-CICS-MSG-AREA                     02886033
024380                     TO PV-COMMAREA-LENGTH                        02887033
024390              PERFORM 9999-WRITE-TO-CSSL                          02888033
024391              INITIALIZE  PV-CICS-MSG-AREA                        02889033
024392              STRING ' PCKCS721 - '                                       
024393                     'STORE # - '                                         
024394                     PV-DISPLAY-STR                                       
024395                     '  STORE NOT IN TDCSTMF DATABASE'                    
024396                                               DELIMITED BY SIZE  02889533
024399                                           INTO PV-CICS-MSG-AREA  02889833
024400              PERFORM 9999-WRITE-TO-CSSL                          02888033
024410         WHEN SQLWARN0 NOT = SPACES                               02440001
024500         WHEN SQLCODE < ZERO                                      02450001
024600         WHEN SQLCODE > ZERO                                      02460001
024610              INITIALIZE  PV-CICS-MSG-AREA                        02461033
024611              MOVE SQLCODE                TO PV-SQL-RETURN-CD     02461134
024620              STRING ' PCKCS721 - '          DELIMITED BY SIZE    02462038
024630                     ' SQLCODE - '           DELIMITED BY SIZE    02463033
024640                     PV-SQL-RETURN-CD        DELIMITED BY SIZE    02464034
024650                                        INTO PV-CICS-MSG-AREA     02465033
024660              MOVE LENGTH OF PV-CICS-MSG-AREA                     02466033
024670                     TO PV-COMMAREA-LENGTH                        02467033
024680              PERFORM 9999-WRITE-TO-CSSL                          02468033
024681              MOVE PC187-STR-NBR    TO  PV-DISP-STR                       
024690              MOVE PC187-NO-OF-LBLS TO  PV-DISP-LBL-QTY                   
024691              STRING ' PCKCS721 - '                                       
024692                     'STORE # - '                                         
024693                     PV-DISP-STR                                          
024694                     '  # OF LBLS - '                                     
024695                     PV-DISP-LBL-QTY                                      
024696                     '  PARA-'                                            
024697                     '3320-FETCH-DCSTMF-CURSO' DELIMITED BY SIZE  02469733
024698                                           INTO PV-CICS-MSG-AREA  02469833
024699              MOVE LENGTH OF PV-CICS-MSG-AREA                     02469933
024700                     TO PV-COMMAREA-LENGTH                        02470033
024701              PERFORM 9999-WRITE-TO-CSSL                          02470133
024702                                                                  02470233
024703             MOVE SQLCODE             TO PV-SQL-RETURN-CD         02470333
024704             STRING 'SQL ERR '           DELIMITED BY SIZE        02470433
024705                    PV-SQL-RETURN-CD     DELIMITED BY SIZE        02470533
024706                                    INTO PC187-CRA-RET-MSG        02470633
024707             SET  PC187-CRA-SQLERROR  TO TRUE                     02470733
024708             MOVE '3320-'             TO PC187-CRA-REQ-ID         02470833
024709             PERFORM 9000-RETURN-CALL                             02470933
024710                                                                  02471033
025700     END-EVALUATE.                                                02570001
025800                                                                  02580001
025900                                                                  02590001
026000 3300-UPDATE-TDCSTMF.                                             02600001
026100******************************************************************02610001
026200*  3300-UPDATE-TDCSTMF.                                           02620001
026300******************************************************************02630001
026400                                                                  02640001
027200     EXEC SQL                                                     02720033
027300          UPDATE TDCSTMF                                          02730033
027400             SET MFST_NBR   = :DCSTMF-MFST-NBR                    02740033
027500           WHERE CURRENT OF DCSTMF_CSR                            02750033
027600     END-EXEC.                                                    02760033
028000                                                                  02800001
028100     EVALUATE TRUE                                                02810033
028200         WHEN SQLCODE = ZERO                                      02820033
028500              CONTINUE                                            02850033
028510                                                                  02851033
028600         WHEN SQLWARN0 NOT = SPACES                               02860033
028700         WHEN SQLCODE < ZERO                                      02870033
028800         WHEN SQLCODE > ZERO                                      02880033
028810              INITIALIZE  PV-CICS-MSG-AREA                        02881033
028811              MOVE SQLCODE                TO PV-SQL-RETURN-CD     02881134
028820              STRING ' PCKCS721 - '          DELIMITED BY SIZE    02882038
028830                     ' SQLCODE - '           DELIMITED BY SIZE    02883033
028840                     PV-SQL-RETURN-CD        DELIMITED BY SIZE    02884034
028850                                        INTO PV-CICS-MSG-AREA     02885033
028860              MOVE LENGTH OF PV-CICS-MSG-AREA                     02886033
028870                     TO PV-COMMAREA-LENGTH                        02887033
028880              PERFORM 9999-WRITE-TO-CSSL                          02888033
028881              MOVE PC187-STR-NBR    TO  PV-DISP-STR                       
028882              MOVE PC187-NO-OF-LBLS TO  PV-DISP-LBL-QTY                   
028890              INITIALIZE  PV-CICS-MSG-AREA                        02889033
028891              STRING ' PCKCS721 - '                                       
028892                     'STORE # - '                                         
028893                     PV-DISP-STR                                          
028894                     '  # OF LBLS - '                                     
028895                     PV-DISP-LBL-QTY                                      
028896                     '  PARA-'                                            
028897                     '3300-UPDATE-TDCSTMF'     DELIMITED BY SIZE  02889733
028898                                           INTO PV-CICS-MSG-AREA  02889833
028899              MOVE LENGTH OF PV-CICS-MSG-AREA                     02889933
028900                     TO PV-COMMAREA-LENGTH                        02890033
028901              PERFORM 9999-WRITE-TO-CSSL                          02890133
028902                                                                  02890233
028903             MOVE SQLCODE             TO PV-SQL-RETURN-CD         02890333
028904             STRING 'SQL ERR '           DELIMITED BY SIZE        02890433
028905                    PV-SQL-RETURN-CD     DELIMITED BY SIZE        02890533
028906                                    INTO PC187-CRA-RET-MSG        02890633
028907             SET  PC187-CRA-SQLERROR  TO TRUE                     02890733
028908             MOVE '3300-'             TO PC187-CRA-REQ-ID         02890833
028909             PERFORM 9000-RETURN-CALL                             02890933
028910                                                                  02891033
030000     END-EVALUATE.                                                03000033
031600                                                                  03160001
031700                                                                  03170001
031800******************************************************************03180001
031900*    SYNCPOINT.                                                   03190027
032000******************************************************************03200001
032100 3500-SYNCPOINT.                                                  03210027
032200                                                                  03220001
032300     EXEC CICS                                                    03230033
032400          SYNCPOINT                                               03240033
032500     END-EXEC.                                                    03250033
032600                                                                  03260001
032700     SET  PS-EOF-DCSTMF-CSR  TO  TRUE.                            03270033
035600*                                                                 03560001
035700 9100-SQL-ABEND.                                                  03570001
035800******************************************************************03580001
035900*  PERFORMS THE ABEND FOR THE PROGRAM IN THE EVENT THAT AN SQL    03590001
036000*  ERROR OR WARNING CODE OCCURS.                                  03600001
036100******************************************************************03610001
036200                                                                  03620001
036300     DISPLAY '9100-SQL-ABEND'.                                    03630001
036400     DISPLAY '** ABEND     **'.                                   03640001
036500     DISPLAY '** PROGRAM   ** = ' PC-CURRENT-PROGRAM-NAME.        03650001
036600     DISPLAY '** PARAGRAPH ** = ' PV-ABEND-PARAGRAPH.             03660001
036700     DISPLAY '** OPERATION ** = ' PV-DB2-OPERATION-ATTEMPTED.     03670001
036800                                                                  03680001
037700     MOVE +4013                  TO ABEND-CODE.                   03770001
037800     CALL 'ILBOABN0' USING ABEND-CODE.                            03780001
037900                                                                  03790001
037902******************************************************************03790233
037903*  PREPARES INFO TO BE RETURNED TO THE 'CALLING' PROGRAM.         03790333
037904******************************************************************03790433
037906 9000-RETURN-CALL.                                                03790633
037907                                                                  03790733
037908     MOVE PC187-COMMAREA-REC           TO DFHCOMMAREA.            03790833
037909                                                                  03790933
037910     EXEC CICS                                                    03791033
037911         RETURN                                                   03791133
037912     END-EXEC.                                                    03791233
037913                                                                  03791333
037914******************************************************************03791433
037920*  WRITE ERROR MESSAGE TO CSSL                                   *03792033
037940******************************************************************03794033
038000 9999-WRITE-TO-CSSL.                                              03800033
038100        MOVE LENGTH OF PV-CICS-MSG-AREA                           03810033
038200            TO PV-COMMAREA-LENGTH                                 03820033
038300        EXEC CICS                                                 03830033
038400            WRITEQ TD                                             03840033
038500                QUEUE   ('CSSL')                                  03850033
038600                FROM    (PV-CICS-MSG-AREA)                        03860033
038700                LENGTH  (PV-COMMAREA-LENGTH)                      03870033
038800                RESP    (PV-CICS-RESPONSE)                        03880033
038900        END-EXEC.                                                 03890033
