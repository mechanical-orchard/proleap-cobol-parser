000100******************************************************************00010003
000200 IDENTIFICATION DIVISION.                                         00020003
000300******************************************************************00030003
000400                                                                  00040003
000500 PROGRAM-ID.             CEKUT006.                                00050099
000600 AUTHOR.                 LYNN MCADAMS.                            00060003
000700 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00070003
000800 DATE-WRITTEN            DECEMBER, 1999.                          00080099
000900 DATE-COMPILED.                                                   00090003
001000                                                                  00100003
001100*----------------------------------------------------------------*00110003
001200* THIS PROGRAM CREATES AN EXTRACT FILE THAT WILL BE USED IN      *00120089
001300* CREATING THE FASHION SALES AND MERCHANDISE LEDGER INTERFACE    *00130089
001400* FILES.                                                         *00140089
001500*----------------------------------------------------------------*00150003
001600                                                                  00160003
001700******************************************************************00170003
001800 ENVIRONMENT DIVISION.                                            00180003
001900******************************************************************00190003
002000                                                                  00200003
002100 CONFIGURATION SECTION.                                           00210003
002200                                                                  00220003
002300 SOURCE-COMPUTER.        IBM-3090.                                00230003
002400 OBJECT-COMPUTER.        IBM-3090.                                00240003
002500                                                                  00250003
002600 INPUT-OUTPUT SECTION.                                            00260003
002700                                                                  00270003
002800 FILE-CONTROL.                                                    00280003
002900                                                                  00290003
003000      SELECT EXTRACT-FILE-IN        ASSIGN TO INP01.              00300088
003100      SELECT EXTRACT-FILE-OUT       ASSIGN TO OUT01.              00310088
003200                                                                  00320003
003300******************************************************************00330003
003400 DATA DIVISION.                                                   00340003
003500******************************************************************00350003
003600                                                                  00360003
003700 FILE SECTION.                                                    00370003
003800 FD  EXTRACT-FILE-IN                                              00380091
003900     LABEL RECORDS ARE STANDARD                                   00390003
004000     BLOCK CONTAINS 0 RECORDS                                     00400003
004100     RECORDING MODE IS F                                          00410003
004200     RECORD CONTAINS 100 CHARACTERS                               00420088
004300     DATA RECORD IS EXTRACT-IN-RECORD.                            00430088
004400                                                                  00440003
004500 01  EXTRACT-IN-RECORD               PIC X(100).                  00450088
004600                                                                  00460003
004700 FD  EXTRACT-FILE-OUT                                             00470088
004800     LABEL RECORDS ARE STANDARD                                   00480003
004900     BLOCK CONTAINS 0 RECORDS                                     00490003
005000     RECORDING MODE IS F                                          00500003
005100     RECORD CONTAINS 80 CHARACTERS                                00510088
005200     DATA RECORD IS EXTRACT-OUT-RECORD.                           00520088
005300                                                                  00530003
005400 01  EXTRACT-OUT-RECORD              PIC X(80).                   00540088
005500*------------------------------------------------------*          00550003
005600 WORKING-STORAGE SECTION.                                         00560003
005700*------------------------------------------------------*          00570003
005800 01 PC-PROGRAM-CONSTANTS.                                         00580003
005900    05  PC-PROGRAM-NAME              PIC X(08) VALUE 'CEKUT006'.  00590089
006000                                                                  00600006
006100 01 PS-PROGRAM-SWITCHES.                                          00610003
006200    05 PS-END-OF-FILE-SW             PIC X(01)     VALUE SPACE.   00620024
006300       88 PS-EOF                     VALUE 'Y'.                   00630024
006400       88 PS-NOT-EOF                 VALUE 'N'.                   00640024
006500                                                                  00650025
006600 01 WS-CALC-FIELDS.                                               00660084
006700    05  WS-RECORDS-READ-QTY          PIC S9(07)    COMP-3         00670089
006800                                                   VALUE ZEROS.   00680003
006900    05  WS-RECORDS-WRITE-QTY         PIC S9(07)    COMP-3         00690089
007000                                                   VALUE ZEROS.   00700099
007100 01 WS-REQ-NMBR-FIELDS.                                           00710099
007200    05  PULL-NBR-8                   PIC 9(08).                   00720099
007300    05  PULL-NBR-N REDEFINES PULL-NBR-8.                          00730099
007400        10  PULL-NBR-3               PIC X(03).                   00740099
007500        10  PULL-NBR-5               PIC X(05).                   00750099
007600    05  LINE-NBR-4                   PIC 9(04).                   00760099
007700    05  LINE-NBR-N REDEFINES LINE-NBR-4.                          00770099
007800        10  LINE-NBR-1               PIC X(01).                   00780099
007900        10  LINE-NBR-3               PIC X(03).                   00790099
008000                                                                  00800099
008100 01 WS-REQ-NMBRS.                                                 00810099
008200    05  WS-PULL-NBR-5                PIC X(05).                   00820099
008300    05  WS-LINE-NBR-3                PIC X(03).                   00830099
008400                                                                  00840099
010000*** INPUT FILE RECORD LAYOUT ****                                 01000006
010100     COPY CERD012.                                                01010088
010200                                                                  01020091
010300*** OUTPUT FILE RECORD LAYOUT ****                                01030091
010400     COPY CERD004.                                                01040091
010500                                                                  01050004
010600*                                                                 01060035
010700********************************************************          01070003
010800 PROCEDURE DIVISION.                                              01080003
010900********************************************************          01090003
011000 0000-MAIN.                                                       01100003
011100     PERFORM 1000-INITIALIZATION.                                 01110087
011200                                                                  01120003
011300     PERFORM 2000-PROCESS-FILES UNTIL PS-EOF.                     01130097
011400                                                                  01140003
011500     CLOSE EXTRACT-FILE-IN                                        01150088
011600           EXTRACT-FILE-OUT.                                      01160088
011700                                                                  01170003
011800     DISPLAY 'NUMBER OF RECORDS READ IS:     '                    01180003
011900         WS-RECORDS-READ-QTY.                                     01190003
012000     DISPLAY 'NUMBER OF RECORDS WRITTEN IS:  '                    01200003
012100         WS-RECORDS-WRITE-QTY.                                    01210003
012200                                                                  01220051
012300     STOP RUN.                                                    01230087
012400                                                                  01240003
012500 1000-INITIALIZATION.                                             01250003
012600      OPEN INPUT  EXTRACT-FILE-IN                                 01260088
012700           OUTPUT EXTRACT-FILE-OUT.                               01270088
012800                                                                  01280003
012900*READ FIRST INPUT RECORD.                                         01290099
013000      PERFORM 8000-READ-INPUT-FILE.                               01300087
013100                                                                  01310003
013200 2000-PROCESS-FILES.                                              01320096
013300      MOVE CE012-BATCH-NMBR       TO CE004-BATCH-NMBR.            01330099
013301                                                                  01330199
013310      IF  CE012-ADJUST-SOURCE                                     01331099
013400          MOVE 02                 TO CE004-LINE-NMBR              01340099
013410      ELSE                                                        01341099
013420          MOVE 01                 TO CE004-LINE-NMBR              01342099
013430      END-IF.                                                     01343099
013440                                                                  01344099
013500      MOVE CE012-DEPT             TO CE004-DEPT.                  01350099
013600      MOVE CE012-CLASS            TO CE004-CLASS.                 01360099
013710      MOVE CE012-SKU-NBR          TO CE004-SKU.                   01371099
013800      MOVE CE012-PULL-NBR         TO PULL-NBR-8.                  01380099
013900      MOVE CE012-PULL-LNE-NBR     TO LINE-NBR-4.                  01390099
014000      MOVE PULL-NBR-5             TO WS-PULL-NBR-5.               01400099
014100      MOVE LINE-NBR-3             TO WS-LINE-NBR-3.               01410099
014200      MOVE WS-REQ-NMBRS           TO CE004-REQ-NMBR.              01420099
014300                                                                  01430099
014400      MOVE CE012-FILLED-DATE-MMDDCCYY-MM                          01440099
014500                                  TO CE004-FILLED-DATE-MMDDYY-MM. 01450099
014600      MOVE CE012-FILLED-DATE-MMDDCCYY-DD                          01460099
014700                                  TO CE004-FILLED-DATE-MMDDYY-DD. 01470099
014800      MOVE CE012-FILLED-DATE-MMDDCCYY-YY                          01480099
014900                                  TO CE004-FILLED-DATE-MMDDYY-YY. 01490099
015000                                                                  01500099
015100      MOVE CE012-DC-STORE-NMBR    TO CE004-DC-STORE-NMBR.         01510099
015400                                                                  01540099
015500      MOVE CE012-TOTAL-QTY        TO CE004-TOTAL-QTY.             01550099
015600      MOVE CE012-UNIT-PRICE       TO CE004-UNIT-PRICE.            01560099
015700                                                                  01570099
015800      MOVE CE012-RECV-STORE-NMBR  TO CE004-RECV-STORE-NMBR.       01580099
016100                                                                  01610099
016200      MOVE CE012-RECV-STORE-QTY   TO CE004-RECV-STORE-QTY.        01620099
016210                                                                  01621099
016220      MOVE 'C'                    TO CE004-TRAN-CODE.             01622099
016300                                                                  01630099
016400      PERFORM 3000-WRITE-HEADER-RECORD.                           01640099
016500                                                                  01650099
016600*READ NEXT INPUT RECORD.                                          01660099
016700      PERFORM 8000-READ-INPUT-FILE.                               01670099
016800                                                                  01680099
016900                                                                  01690099
017000 3000-WRITE-HEADER-RECORD.                                        01700099
017100                                                                  01710099
017200      WRITE EXTRACT-OUT-RECORD          FROM                      01720099
017300                                 CE004-CENTRAL-STK-XFER-RECORD.   01730099
017400      ADD  +1                    TO WS-RECORDS-WRITE-QTY.         01740099
017500                                                                  01750099
017600                                                                  01760099
017700 8000-READ-INPUT-FILE.                                            01770099
017800      INITIALIZE CE012-CENTRAL-STK-XFER-RECORD.                   01780099
017900      READ EXTRACT-FILE-IN       INTO                             01790099
018000                                  CE012-CENTRAL-STK-XFER-RECORD   01800099
018100         AT END                                                   01810099
018200            SET PS-EOF TO TRUE                                    01820099
018300         NOT AT END                                               01830099
018400           ADD  +1                    TO WS-RECORDS-READ-QTY      01840099
018500      END-READ.                                                   01850099
018600                                                                  01860099
