000100 IDENTIFICATION DIVISION.                                         00010002
000200 TITLE 'COUNT SYSTEM - EXTRACT MANIFESTING DETAILS FOR PRE-COUNT'.00020002
000300                                                                  00030002
000400 PROGRAM-ID.             PCKUT066.                                00040002
000500 AUTHOR.                 DENNIS STEFFEN.                          00050002
000600 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00060002
000700 DATE-WRITTEN            APRIL 2006.                              00070002
000800 DATE-COMPILED.                                                   00080002
000900                                                                  00090002
001000 ENVIRONMENT DIVISION.                                            00100002
001100 CONFIGURATION SECTION.                                           00110002
001200                                                                  00120002
001300 SOURCE-COMPUTER.        IBM-3090.                                00130002
001400 OBJECT-COMPUTER.        IBM-3090.                                00140002
001500                                                                  00150002
001600 INPUT-OUTPUT SECTION.                                            00160002
001700                                                                  00170002
001800 FILE-CONTROL.                                                    00180002
001900                                                                  00190002
002000     SELECT UPC-STORE-FILE                                        00200002
002100         ASSIGN TO INP01.                                         00210002
002200                                                                  00220002
002300     SELECT UNLOAD-SE-FILE                                        00230002
002400         ASSIGN TO OUT01.                                         00240002
002500                                                                  00250002
002600                                                                  00260002
002700 DATA DIVISION.                                                   00270002
002800 FILE SECTION.                                                    00280002
002900                                                                  00290002
003000                                                                  00300002
003100 FD  UPC-STORE-FILE                                               00310002
003200     RECORDING MODE IS F                                          00320002
003300     LABEL RECORDS ARE STANDARD                                   00330002
003400     BLOCK CONTAINS 0 RECORDS.                                    00340002
003500                                                                  00350002
003600 01  UPC-STORE-FILE-RECORD            PIC X(010).                 00360002
003700                                                                  00370002
003800 FD  UNLOAD-SE-FILE                                               00380002
003900     RECORDING MODE IS F                                          00390002
004000     LABEL RECORDS ARE STANDARD                                   00400002
004100     BLOCK CONTAINS 0 RECORDS.                                    00410002
004200                                                                  00420002
004300 01  UNLOAD-SE-REC                    PIC X(048).                 00430002
004400                                                                  00440002
004500                                                                  00450002
004600 WORKING-STORAGE SECTION.                                         00460002
004700                                                                  00470002
004800 01  FILLER.                                                      00480002
004900     05  FILLER                      PIC  X(36)    VALUE          00490002
005000         ' ***** WORKING STORAGE PGM=PCKUT066 '.                  00500002
005100     05  PGM-COMPILED                PIC  X(20)    VALUE SPACE.   00510002
005200     05  FILLER                      PIC  X(10)    VALUE          00520002
005300         ' LOCATION='.                                            00530002
005400     05  PGM-LOCATION                PIC  X(04)    VALUE SPACE.   00540002
005500     05  FILLER                      PIC  X(06)    VALUE          00550002
005600         ' *****'.                                                00560002
005700                                                                  00570002
005800 01  PS-SWITCHES.                                                 00580002
005900     05  PS-ERROR-SW                  PIC X(01) VALUE 'N'.        00590002
006000         88  PS-ERROR-YES                       VALUE 'Y'.        00600002
006100         88  PS-ERROR-NO                        VALUE 'N'.        00610002
006200     05  PS-STOP-SW                   PIC X(01) VALUE 'N'.        00620002
006300         88  PS-STOP-YES                        VALUE 'Y'.        00630002
006400         88  PS-STOP-NO                         VALUE 'N'.        00640002
006500                                                                  00650002
006600     05  PS-END-OF-FILE-SW            PIC X(01) VALUE 'N'.        00660002
006700         88  PS-END-OF-FILE-YES                 VALUE 'Y'.        00670002
006800     05  PS-END-OF-DTL-CSR-SW         PIC X(01) VALUE 'N'.        00680002
006900         88  PS-END-OF-DTL-CSR-YES              VALUE 'Y'.        00690002
007000         88  PS-END-OF-DTL-CSR-NO               VALUE 'N'.        00700002
007100                                                                  00710002
007200 01  DK-KEYS.                                                     00720002
007300     05  DK-INTR-UPC-ID               PIC S9(09) COMP VALUE ZERO. 00730002
007400     05  DK-LOC-NBR                   PIC S9(04) COMP VALUE ZERO. 00740002
007500                                                                  00750002
007600 01  PC-CONSTANTS.                                                00760002
007700     05  PC-CURRENT-PROGRAM-NAME     PIC  X(08)    VALUE          00770002
007800                                                   'PCKUT066'.    00780002
007900     05  PC-ILBOABN0                 PIC  X(08)    VALUE          00790002
008000                                                   'ILBOABN0'.    00800002
008100     05  PC-MAX-RETRIES              PIC S9(04)    VALUE  +3      00810002
008200                                                   COMP.          00820002
008300                                                                  00830002
008400 01  PV-MISC-STUFF.                                               00840002
008500     05  PV-ABEND-PARAGRAPH           PIC  X(30) VALUE SPACES.    00850002
008600     05  PV-DB2-OPERATION-ATTEMPTED   PIC  X(60) VALUE SPACE.     00860002
008700     05  PV-SQL-CODE                  PIC  9(04) VALUE ZERO.      00870002
008800     05  PV-ABEND-CODE                PIC S9(04) VALUE ZERO       00880002
008900                                                   COMP SYNC.     00890002
009000     05  PV-RETRY-COUNTER             PIC S9(04) VALUE ZERO       00900002
009100                                                 COMP SYNC.       00910002
009200     05  PV-READ-COUNT                PIC S9(09) COMP-3           00920002
009300                                              VALUE ZERO.         00930002
009400     05  PV-WRITE-COUNT               PIC S9(09) COMP-3           00940002
009500                                              VALUE ZERO.         00950002
009600     05  PV-GROUP-COUNT               PIC S9(09) COMP-3           00960002
009700                                              VALUE ZERO.         00970002
009800     05  PV-EMPTY-COUNT               PIC S9(09) COMP-3           00980002
009900                                              VALUE ZERO.         00990002
010000     05  PV-FOUND-COUNT               PIC S9(09) COMP-3           01000002
010100                                              VALUE ZERO.         01010002
010200                                                                  01020002
010300     05  PV-DISP-NBR                  PIC ZZZ,ZZZ,ZZ9.            01030002
010400     05  PV-ABEND-OPERATION           PIC X(20) VALUE SPACES.     01040002
010500     05  PV-ABEND-STRUCTURE-1         PIC X(20) VALUE SPACES.     01050002
010600                                                                  01060002
010700 01  ABEND-CODE                       PIC S9(04)     VALUE +0     01070002
010800                                                     COMP SYNC.   01080002
010900     88  ABEND-4001-WRITE-ERROR                      VALUE +4001. 01090002
011000     88  ABEND-4002-READ-ERROR                       VALUE +4002. 01100002
011100     88  ABEND-4003-CTRL-CARD-ERROR                  VALUE +4003. 01110002
011200     88  ABEND-4004-TABLE-ERROR                      VALUE +4004. 01120002
011300     88  ABEND-4005-OPEN-ERROR                       VALUE +4005. 01130002
011400     88  ABEND-4006-CLOSE-ERROR                      VALUE +4006. 01140002
011500     88  ABEND-4007-SEQUENCE-ERROR                   VALUE +4007. 01150002
011600     88  ABEND-4008-DATS-ERROR                       VALUE +4008. 01160002
011700     88  ABEND-4009-KEY-DATS-ERROR                   VALUE +4009. 01170002
011800     88  ABEND-4013-DB2-ERROR                        VALUE +4013. 01180002
011900                                                                  01190002
012000*    UPC/LOC EXTRACT                                              01200002
012100     COPY PCRD054.                                                01210002
012200                                                                  01220002
012300*    BMC UNLOAD                                                   01230002
012400     COPY PCRD037.                                                01240002
012500/                                                                 01250002
012600*  INTRANSIT DETAILS                                              01260002
012700     EXEC SQL                                                     01270002
012800         INCLUDE PCT00015                                         01280002
012900     END-EXEC.                                                    01290002
013000                                                                  01300002
013100     EXEC SQL                                                     01310002
013200         DECLARE DETAIL-CSR CURSOR FOR                            01320002
013300         SELECT                                                   01330002
013400             PO_NBR                                               01340002
013500         ,   RCVR_SEQ_NBR                                         01350002
013600         ,   IN_TRNST_TRN_TMST                                    01360002
013700         ,   TRN_TYP_CDE                                          01370002
013800         ,   TRN_CLSN_PRCG_QTY                                    01380002
013900         FROM                                                     01390002
014000             PCT_TRN_CLSN_DTL                                     01400002
014100         WHERE                                                    01410002
014200              INTR_UPC_ID      = :DK-INTR-UPC-ID                  01420002
014300         AND  LOC_NBR          = :DK-LOC-NBR                      01430002
014400         AND  TRN_CLSN_CDE     = 'SE'                             01440003
164325         AND  TRN_TYP_CDE NOT IN ('UM', 'NS', 'MM',               01450007
164325                                  'AM', 'SM')                     01460007
014600     END-EXEC.                                                    01470002
014700                                                                  01480002
014800     EXEC SQL                                                     01490002
014900         INCLUDE SQLCA                                            01500002
015000     END-EXEC.                                                    01510002
015100                                                                  01520002
015200     COPY SQLCA2.                                                 01530002
015300                                                                  01540002
015400     COPY DPWS004.                                                01550002
015500/                                                                 01560002
015600 PROCEDURE DIVISION.                                              01570002
015700                                                                  01580002
015800     PERFORM 1000-INITIALIZATION.                                 01590002
015900                                                                  01600002
016000     PERFORM 2000-PROCESS UNTIL                                   01610002
016100                        PS-END-OF-FILE-YES OR PS-ERROR-YES        01620002
016200                                                                  01630002
016300     PERFORM 9000-QUIT.                                           01640002
016400                                                                  01650002
016500     GOBACK.                                                      01660002
016600/                                                                 01670002
016700 1000-INITIALIZATION.                                             01680002
016800     MOVE '1000-INITIALIZATION         '  TO PV-ABEND-PARAGRAPH.  01690002
016900                                                                  01700002
017000     DISPLAY 'START PCKUT066'.                                    01710002
017100                                                                  01720002
017200     OPEN INPUT UPC-STORE-FILE                                    01730002
017300         OUTPUT UNLOAD-SE-FILE.                                   01740002
017400                                                                  01750002
017500     PERFORM 8000-READ-PCRD054.                                   01760002
017600                                                                  01770002
017700/                                                                 01780002
017800 2000-PROCESS.                                                    01790002
017900                                                                  01800002
018000     MOVE '2000-PROCESS'                  TO PV-ABEND-PARAGRAPH.  01810002
018100                                                                  01820002
018200     PERFORM 7000-OPEN-DTL-CSR                                    01830002
018300     PERFORM 7010-FETCH-DTL-CSR                                   01840002
018400                                                                  01850002
018500     IF PV-GROUP-COUNT = ZERO                                     01860002
018600         ADD 1               TO PV-EMPTY-COUNT                    01870002
018700     ELSE                                                         01880002
018800         ADD 1               TO PV-FOUND-COUNT                    01890002
018900     END-IF                                                       01900002
019000                                                                  01910002
019100     PERFORM UNTIL PS-END-OF-DTL-CSR-YES                          01920002
019200         PERFORM 2100-BUILD-PCRD037                               01930002
019300         PERFORM 8100-WRITE-PCRD037                               01940002
019400         PERFORM 7010-FETCH-DTL-CSR                               01950002
019500     END-PERFORM.                                                 01960002
019600                                                                  01970002
019700     PERFORM 7020-CLOSE-DTL-CSR.                                  01980002
019800     PERFORM 8000-READ-PCRD054.                                   01990002
019900/                                                                 02000002
020000 2100-BUILD-PCRD037.                                              02010002
020100                                                                  02020002
020200     INITIALIZE PC037-BMC-UNLOAD-SE-REC                           02030002
020300                                                                  02040002
020400     MOVE PCT00015-PO-NBR             TO PC037-PO-NBR             02050002
020500     MOVE PCT00015-RCVR-SEQ-NBR       TO PC037-RCVR-SEQ-NBR       02060002
020600     MOVE DK-INTR-UPC-ID              TO PC037-INTR-UPC-ID        02070002
020700     MOVE DK-LOC-NBR                  TO PC037-LOC-NBR            02080002
020800     MOVE PCT00015-IN-TRNST-TRN-TMST  TO PC037-IN-TRNST-TRN-TMST  02090002
020900     MOVE PCT00015-TRN-TYP-CDE        TO PC037-TRN-TYP-CDE        02100002
021000     MOVE PCT00015-TRN-CLSN-PRCG-QTY  TO PC037-TRN-CLSN-PRCG-QTY. 02110002
021100/                                                                 02120002
021200 7000-OPEN-DTL-CSR.                                               02130002
021300     MOVE '7000-OPEN-DTL-CSR'         TO PV-ABEND-PARAGRAPH.      02140002
021400                                                                  02150002
021500     MOVE PC054-INTR-UPC-ID           TO DK-INTR-UPC-ID           02160002
021600     MOVE PC054-LOC-NBR               TO DK-LOC-NBR               02170002
021700     SET PS-END-OF-DTL-CSR-NO         TO TRUE                     02180002
021800                                                                  02190002
021900     PERFORM                                                      02200002
022000         WITH TEST AFTER                                          02210002
022100         VARYING PV-RETRY-COUNTER                                 02220002
022200         FROM 1 BY 1                                              02230002
022300         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               02240002
022400            OR  (SQLCODE = +0))                                   02250002
022500                                                                  02260002
022600         EXEC SQL                                                 02270002
022700             OPEN DETAIL-CSR                                      02280002
022800         END-EXEC                                                 02290002
022900                                                                  02300002
023000         EVALUATE TRUE                                            02310002
023100             WHEN SQLCODE = ZERO                                  02320002
023200                 MOVE ZERO            TO PV-GROUP-COUNT           02330002
023300             WHEN SQLCODE = -904                                  02340002
023400             WHEN SQLCODE = -911                                  02350002
023500             WHEN SQLCODE = -913                                  02360002
023600                  CONTINUE                                        02370002
023700                                                                  02380002
023800             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')              02390002
023900                 DISPLAY '**************************************' 02400002
024000                 DISPLAY 'WARNING ISSUED '                        02410002
024100                 DISPLAY 'OPEN DETAIL-CSR                       ' 02420002
024200                 DISPLAY '**************************************' 02430002
024300                 PERFORM 9800-SQL-WARNING                         02440002
024400                                                                  02450002
024500             WHEN SQLCODE < ZERO                                  02460002
024600                 DISPLAY '**************************************' 02470002
024700                 DISPLAY 'ERROR ISSUED ON                       ' 02480002
024800                 DISPLAY 'OPEN DETAIL-CSR                       ' 02490002
024900                 DISPLAY '**************************************' 02500002
025000                 PERFORM 9900-SQL-ERROR                           02510002
025100                                                                  02520002
025200         END-EVALUATE                                             02530002
025300     END-PERFORM.                                                 02540002
025400                                                                  02550002
025500     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    02560002
025600         SQLCODE NOT = ZERO                                       02570002
025700         DISPLAY '**************************************'         02580002
025800         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '         02590002
025900         DISPLAY 'OPEN DETAIL-CSR'                                02600002
026000         DISPLAY '**************************************'         02610002
026100         PERFORM 9900-SQL-ERROR                                   02620002
026200     END-IF.                                                      02630002
026300                                                                  02640002
026400 7010-FETCH-DTL-CSR.                                              02650002
026500                                                                  02660002
026600     PERFORM                                                      02670002
026700         WITH TEST AFTER                                          02680002
026800         VARYING PV-RETRY-COUNTER                                 02690002
026900         FROM 1 BY 1                                              02700002
027000         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               02710002
027100            OR  (SQLCODE = +100)                                  02720002
027200            OR  (SQLCODE = +0))                                   02730002
027300                                                                  02740002
027400         EXEC SQL                                                 02750002
027500             FETCH DETAIL-CSR                                     02760002
027600             INTO                                                 02770002
027700             :PCT00015-PO-NBR                                     02780002
027800         ,   :PCT00015-RCVR-SEQ-NBR                               02790002
027900         ,   :PCT00015-IN-TRNST-TRN-TMST                          02800002
028000         ,   :PCT00015-TRN-TYP-CDE                                02810002
028100         ,   :PCT00015-TRN-CLSN-PRCG-QTY                          02820002
028200         END-EXEC                                                 02830002
028300                                                                  02840002
028400         EVALUATE TRUE                                            02850002
028500             WHEN SQLCODE = ZERO                                  02860002
028600                 ADD 1                TO PV-GROUP-COUNT           02870002
028700             WHEN SQLCODE = +100                                  02880002
028800                 SET PS-END-OF-DTL-CSR-YES                        02890002
028900                                      TO TRUE                     02900002
029000             WHEN SQLCODE = -904                                  02910002
029100             WHEN SQLCODE = -911                                  02920002
029200             WHEN SQLCODE = -913                                  02930002
029300                  CONTINUE                                        02940002
029400                                                                  02950002
029500             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')              02960002
029600                 DISPLAY '**************************************' 02970002
029700                 DISPLAY 'WARNING ISSUED '                        02980002
029800                 DISPLAY 'FETCH DTL-CSR                       '   02990002
029900                 DISPLAY '**************************************' 03000002
030000                 PERFORM 9800-SQL-WARNING                         03010002
030100                                                                  03020002
030200             WHEN SQLCODE < ZERO                                  03030002
030300                 DISPLAY '**************************************' 03040002
030400                 DISPLAY 'ERROR ISSUED ON                       ' 03050002
030500                 DISPLAY 'FETCH DTL-CSR                       '   03060002
030600                 DISPLAY '**************************************' 03070002
030700                 PERFORM 9900-SQL-ERROR                           03080002
030800                                                                  03090002
030900         END-EVALUATE                                             03100002
031000     END-PERFORM.                                                 03110002
031100                                                                  03120002
031200     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    03130002
031300         SQLCODE NOT = ZERO                                       03140002
031400         DISPLAY '**************************************'         03150002
031500         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '         03160002
031600         DISPLAY 'FETCH DTL-CSR                         '         03170002
031700         DISPLAY '**************************************'         03180002
031800         PERFORM 9900-SQL-ERROR                                   03190002
031900     END-IF.                                                      03200002
032000                                                                  03210002
032100                                                                  03220002
032200 7020-CLOSE-DTL-CSR.                                              03230002
032300     MOVE '7020-CLOSE-DTL-CSR'        TO PV-ABEND-PARAGRAPH.      03240002
032400                                                                  03250002
032500     PERFORM                                                      03260002
032600         WITH TEST AFTER                                          03270002
032700         VARYING PV-RETRY-COUNTER                                 03280002
032800         FROM 1 BY 1                                              03290002
032900         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               03300002
033000            OR  (SQLCODE = +0))                                   03310002
033100                                                                  03320002
033200         EXEC SQL                                                 03330002
033300             CLOSE DETAIL-CSR                                     03340002
033400         END-EXEC                                                 03350002
033500                                                                  03360002
033600         EVALUATE TRUE                                            03370002
033700             WHEN SQLCODE = ZERO                                  03380002
033800                 CONTINUE                                         03390002
033900             WHEN SQLCODE = -904                                  03400002
034000             WHEN SQLCODE = -911                                  03410002
034100             WHEN SQLCODE = -913                                  03420002
034200                  CONTINUE                                        03430002
034300                                                                  03440002
034400             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')              03450002
034500                 DISPLAY '**************************************' 03460002
034600                 DISPLAY 'WARNING ISSUED '                        03470002
034700                 DISPLAY 'CLOSE DETAIL-CSR                      ' 03480002
034800                 DISPLAY '**************************************' 03490002
034900                 PERFORM 9800-SQL-WARNING                         03500002
035000                                                                  03510002
035100             WHEN SQLCODE < ZERO                                  03520002
035200                 DISPLAY '**************************************' 03530002
035300                 DISPLAY 'ERROR ISSUED ON                       ' 03540002
035400                 DISPLAY 'CLOSE DETAIL-CSR                      ' 03550002
035500                 DISPLAY '**************************************' 03560002
035600                 PERFORM 9900-SQL-ERROR                           03570002
035700                                                                  03580002
035800         END-EVALUATE                                             03590002
035900     END-PERFORM.                                                 03600002
036000                                                                  03610002
036100     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    03620002
036200         SQLCODE NOT = ZERO                                       03630002
036300         DISPLAY '**************************************'         03640002
036400         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '         03650002
036500         DISPLAY 'CLOSE DETAIL-CSR                      '         03660002
036600         DISPLAY '**************************************'         03670002
036700         PERFORM 9900-SQL-ERROR                                   03680002
036800     END-IF.                                                      03690002
036900/                                                                 03700002
037000 8000-READ-PCRD054.                                               03710002
037100                                                                  03720002
037200     MOVE '8000-READ-PCRD054   '      TO PV-ABEND-PARAGRAPH.      03730002
037300*                                                                 03740002
037400     READ UPC-STORE-FILE                                          03750002
037500         INTO                                                     03760002
037600             PC054-UPC-STORE-EXTRACT                              03770002
037700         AT END                                                   03780002
037800             SET PS-END-OF-FILE-YES   TO TRUE                     03790002
037900         NOT AT END                                               03800002
038000             ADD 1                    TO PV-READ-COUNT            03810002
038100     END-READ.                                                    03820002
038200                                                                  03830002
038300 8100-WRITE-PCRD037.                                              03840002
038400                                                                  03850002
038500     MOVE '8100-WRITE-PCRD037  '  TO PV-ABEND-PARAGRAPH.          03860002
038600*                                                                 03870002
038700     WRITE UNLOAD-SE-REC                                          03880002
038800         FROM                                                     03890002
038900             PC037-BMC-UNLOAD-SE-REC                              03900002
039000     END-WRITE.                                                   03910002
039100     ADD 1                            TO PV-WRITE-COUNT.          03920002
039200/                                                                 03930002
039300 9000-QUIT.                                                       03940002
039400                                                                  03950002
039500     CLOSE UPC-STORE-FILE                                         03960002
039600           UNLOAD-SE-FILE.                                        03970002
039700                                                                  03980002
039800     MOVE PV-READ-COUNT               TO PV-DISP-NBR              03990002
039900     DISPLAY 'UPC/STORE EXTRACTS READ     = ' PV-DISP-NBR         04000002
040000                                                                  04010002
040100     MOVE PV-FOUND-COUNT              TO PV-DISP-NBR              04020002
040200     DISPLAY 'UPC/STORES FOUND            = '  PV-DISP-NBR.       04030002
040300                                                                  04040002
040400     MOVE PV-EMPTY-COUNT              TO PV-DISP-NBR              04050002
040500     DISPLAY 'UPC/STORES NOT FOUND        = '  PV-DISP-NBR.       04060002
040600                                                                  04070002
040700     DISPLAY SPACES.                                              04080002
040800     MOVE PV-WRITE-COUNT              TO PV-DISP-NBR              04090002
040900     DISPLAY 'PCRD037 EXTRACTS WRITTEN    = '  PV-DISP-NBR.       04100002
041000                                                                  04110002
041100/                                                                 04120002
041200 9100-SQL-ABEND.                                                  04130002
041300******************************************************************04140002
041400*  PERFORMS THE ABEND FOR THE PROGRAM IN THE EVENT THAT AN SQL    04150002
041500*  ERROR OR WARNING CODE OCCURS.                                  04160002
041600******************************************************************04170002
041700     DISPLAY '9100-SQL-ABEND'.                                    04180002
041800     DISPLAY '** ABEND     **'.                                   04190002
041900     DISPLAY '** PROGRAM   ** = ' PC-CURRENT-PROGRAM-NAME.        04200002
042000     DISPLAY '** PARAGRAPH ** = ' PV-ABEND-PARAGRAPH.             04210002
042100     DISPLAY '** OPERATION ** = ' PV-DB2-OPERATION-ATTEMPTED.     04220002
042200     DISPLAY '**              ** = '                              04230002
042300     MOVE SQLCODE TO PV-SQL-CODE.                                 04240002
042400     DISPLAY '** SQL CODE  ** = ' PV-SQL-CODE.                    04250002
042500     MOVE +4013 TO PV-ABEND-CODE.                                 04260002
042600     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         04270002
042700                                                                  04280002
042800******************************************************************04290002
042900*  THIS MODULE PERFORMS THE SQL WARNING.                         *04300002
043000******************************************************************04310002
043100                                                                  04320002
043200 9800-SQL-WARNING.                                                04330002
043300                                                                  04340002
043400     MOVE SQLCODE               TO SQLCODE2.                      04350002
043500     MOVE SQLERRD(3)            TO SQLERRD3.                      04360002
043600     DISPLAY '** ABEND **       ** = SQLWARNING'.                 04370002
043700     DISPLAY '** PROGRAM        ** = PCKUT900'.                   04380002
043800     DISPLAY '** PARAGRAPH      ** = ' PV-ABEND-PARAGRAPH.        04390002
043900     DISPLAY '** SQLCODE        ** = ' SQLCODE2.                  04400002
044000     DISPLAY '** ROWS PROCESSED ** = ' SQLERRD3.                  04410002
044100                                                                  04420002
044200     COPY DPPD004.                                                04430002
044300     SET ABEND-4013-DB2-ERROR   TO TRUE                           04440002
044400     CALL 'ILBOABN0' USING ABEND-CODE.                            04450002
044500/                                                                 04460002
044600******************************************************************04470002
044700* THIS MODULE PERFORMS THE SQL ERROR.                            *04480002
044800******************************************************************04490002
044900                                                                  04500002
045000 9900-SQL-ERROR.                                                  04510002
045100                                                                  04520002
045200     MOVE SQLCODE               TO SQLCODE2.                      04530002
045300     MOVE SQLERRD(3)            TO SQLERRD3.                      04540002
045400     DISPLAY '** ABEND **       ** = SQLERROR'.                   04550002
045500     DISPLAY '** PROGRAM        ** = PCKUT900'.                   04560002
045600     DISPLAY '** PARAGRAPH      ** = ' PV-ABEND-PARAGRAPH.        04570002
045700     DISPLAY '** OPERATION      ** = ' PV-ABEND-OPERATION         04580002
045800     DISPLAY '** TABLE          ** = ' PV-ABEND-STRUCTURE-1       04590002
045900     DISPLAY SPACES                                               04600002
046000                                                                  04610002
046100     COPY DPPD004.                                                04620002
046200     SET ABEND-4013-DB2-ERROR   TO TRUE                           04630002
046300     CALL 'ILBOABN0' USING ABEND-CODE.                            04640002
