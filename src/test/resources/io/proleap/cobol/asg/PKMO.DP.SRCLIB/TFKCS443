      ******************************************************************00010099
       IDENTIFICATION DIVISION.                                         00020099
      ******************************************************************00030099
       PROGRAM-ID.    TFKCS443.                                         00040099
       AUTHOR.        JACK KRAMER.                                      00050099
       INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060099
       DATE-WRITTEN.  JANUARY 1997.                                     00070099
       DATE-COMPILED.                                                   00080099
      *-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=*00090099
      * CONTAINS LOGIC TO OVERRIDE MENOMENEE FALLS AND FINDLAY DC'S TO *00100099
      * RTV'S. (085 BECOMES 801 AND 810 BECOMES 811'.                  *00110099
      *-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=*00120099
      ******************************************************************00130099
      * PROGRAM NUMBER: TFKCS443       SYSTEM: TF     LANGUAGE: COBOL II00140099
      *                                                                 00150099
      * TRANID:  P443       MNEMONIC:  TFSWKST       MAP: TFKM443      F00160099
      *                                                                 00170099
      * PROGRAM NAME : TRANSFER WORKSHEET CRITERIA SPECIFICATION        00180099
      *                                                                 00190099
      * ORIGINAL WORK REQUEST #: 3780                                   00200099
      *                                                                 00210099
      * PROGRAM OBJECTIVE:                                              00220099
      *                                                                 00230099
      *   TO DISPLAY THE TRANSFER WORKSHEET CRITERIA SPEC SCREEN        00240099
      *   AND PASS INFORMATION TO THE NEXT PROGRAM, ACCORDING TO THE    00250099
      *   FUNCTION KEY SELECTED.                                        00260099
      *                                                                 00270099
      * PROGRAM NARRATIVE:                                              00280099
      *                                                                 00290099
      *   THIS PROGRAM WILL ALLOW THE USER TO SPECIFY A SPECIFIC        00300099
      *   CONTROL NUMBER FOR WORKSHEET INQUIRY, WORKSHEET MAINTENANCE,  00310099
      *   TO COMPLETE THE WORKSHEET, OR TO START A PROGRAM TO PRINT THE 00320099
      *   WORKSHEET. THE PROGRAM CAN ALSO BE USED TO SPECIFY VARIOUS    00330099
      *   WORKSHEET CRITERIA FOR THE WORKSHEET LIST PROGRAM.            00340099
      *                                                                 00350099
      ***************************************************************** 00360099
      *  1/20/2003 - RAY GRAF                                           00361099
      *   PROCESS NONINTELLIGENT SKU.                                   00362099
111703******************************************************************00363099
111703* 11/17/2003 - RAY GRAF                                           00365099
111703*   SORT1/SORT2 TRANSFER TYPES.                                   00366099
111703******************************************************************00367099
080204**DATE:08/02/2004 CHANGED BY: RAY GRAF                            00368099
080204**     CHANGE PRINTER DESTINATION TO NEW 8 CHARACTER FORMAT       00369099
      ***************************************************************** 00370099
100404**DATE:10/04/2004 CHANGED BY: RAY GRAF                            00380099
100404**     EXPAND STORE NUMBER. MAKE DOMAIN COMPLIANT.                00390099
      ***************************************************************** 00400099
051705*  DATE 05/17/05 RAY GRAF                                         00410099
051705*  REMOVE PHYSICAL INVENTORY LOGIC                                00420099
051705******************************************************************00421099
060110*  DATE 06/01/10 JACKIE HELING                                    00422099
060110*  BLOCK CERTAIN LOCATIONS FROM SENDING/RECEIVING TRANSFERS.      00423099
      ***************************************************************** 00424099
033111* WR39649 -  DAVID WELLER - 03/31/2011                            00425099
033111*            MLOF - DO NOT EXCLUDE LOCATIONS 807, 808 AND 809     00426099
033111***************************************************************** 00427099
022212* PR3403  -  CHERI PARMLEY - 02/22/2012                           00429099
022212*            COMPILE DUE TO CHANGES TO TTFITEM TABLE              00429199
022212***************************************************************** 00429299
      * DATE:        09/24/2021                                         00429399
      * WR/IR#:      CHG0261678                                         00429499
      * PROGRAMMER:  GERMAN BANDA                                       00429599
      * DESCRIPTION: CHANGE CALL OF DPKUT100 TO                         00429699
      *              CALL DP010I-NUMERIC-EDIT-ROUTINE                   00429799
      *              MAKING THE CALL DYNAMIC VS STATIC                  00429899
      *----------------------------------------------------------------*00429999
CICS  * CHANGED 11/16/2022    BY JIM HUNTER      WR: CHG0278345         00430099
CICS  * ADD COPYBOOK DPWS930 AND MAKE THE CICS ARCHITECTURE CALL        00430199
CICS  * DYNAMIC INSTEAD OF STATIC BY CALLING DP930-CICS-ARCH-API.       00430299
CICS  *-----------------------------------------------------------------00430399
      * CHANGED 02/14/2023    BY JEAN KURK       WR: CHG0813695         00430499
      * REMOVED COPYBOOK FOR UPC CHECK DIGIT ROUTINE                    00430599
      *-----------------------------------------------------------------00430799
                                                                        00431099
       ENVIRONMENT DIVISION.                                            00440099
                                                                        00450099
       DATA DIVISION.                                                   00460099
                                                                        00470099
       WORKING-STORAGE SECTION.                                         00480099
      *                                                                 00480199
       01  DK-DB2-KEYS.                                                 00480299
           05  DK-XFER-TYPE                   PIC  X(02)  VALUE SPACE.  00480399
           05  DK-XFER-DKEY-ID                PIC  S9(9)  VALUE ZERO    00480499
                                                          COMP.         00480599
           05  DK-STORE-NBR                   PIC  S9(4)  VALUE ZERO    00480699
                                                          COMP.         00480799
           05  DK-STORE-NBR-9                 PIC S9(04)  VALUE ZERO    00480899
                                                          COMP.         00480999
           05  DK-UPC-NBR                     PIC S9(15)  VALUE ZERO    00481299
                                                          COMP-3.       00481399
           05  DK-ITEM-NBR                    PIC S9(15)  VALUE ZEROS   01990099
                                                           COMP-3.      02000099
           05  DK-SKU-STATUS-CODE             PIC S9(03)  VALUE ZEROS   02001099
                                                           COMP-3.      02002099
       01  PC-PROGRAM-CONSTANTS.                                        02010099
           05  PC-CURRENT-MAP-NAME       PIC  X(08)  VALUE  'TF443A  '. 02020099
           05  PC-CURRENT-MAPSET-NAME    PIC  X(08)  VALUE  'TFKM443 '. 02030099
           05  PC-CURRENT-PROGRAM-NAME   PIC  X(08)  VALUE  'TFKCS443'. 02030199
           05  PC-CLEARANCE              PIC  9(02)  VALUE 30.          02030299
111703*    05  PC-DEFECTIVE-DAMAGE       PIC  X(02)  VALUE '01'.        02030499
111703     05  PC-DEFECTIVE-DAMAGE-SORT1 PIC  X(02)  VALUE '00'.        02030599
111703     05  PC-DEFECTIVE-DAMAGE-SORT2 PIC  X(02)  VALUE '01'.        02030699
           05  PC-CALLBACK-1             PIC  X(01)  VALUE '2'.         02030799
           05  PC-STK-BAL-CORP-XFER      PIC  X(01)  VALUE '3'.         02030899
           05  PC-CALLBACK               PIC  X(02)  VALUE '02'.        02030999
           05  PC-STOCK-BAL-CORP         PIC  X(02)  VALUE '03'.        02031099
           05  PC-STOCK-BAL-STORE        PIC  X(02)  VALUE '04'.        02031199
           05  PC-CUSTOMER               PIC  X(02)  VALUE '05'.        02031299
           05  PC-NON-RETAIL             PIC  X(02)  VALUE '06'.        02032099
           05  PC-OFFSITE-STORAGE        PIC  X(02)  VALUE '07'.        02032199
           05  PC-SECURE-TOTE            PIC  X(02)  VALUE '02'.        02032299
           05  PC-TRAILER                PIC  X(02)  VALUE '04'.        02032399
           05  PC-HAND-CARRY             PIC  X(02)  VALUE '05'.        02032499
           05  PC-COMPLETE-STATUS        PIC  X(02)  VALUE  'CM'.       02032599
           05  PC-RTV-TYPE               PIC  X(02)  VALUE  'RV'.       02032699
           05  PC-STORE-TYPE             PIC  X(02)  VALUE  'DS'.       02032799
           05  PC-DC                     PIC  X(02)  VALUE  'DC'.       02032899
100404*    05  PC-RTV-MEN-FLS            PIC  X(03)  VALUE '801'.       02032999
100404     05  PC-RTV-MEN-FLS            PIC  9(04)  VALUE  801.        02033099
080204     05  PC-DC-MEN-FLS             PIC  9(05)  VALUE  085.        02033199
100404*    05  PC-RTV-FINDLAY            PIC  X(03)  VALUE '811'.       02034099
100404     05  PC-RTV-FINDLAY            PIC  9(04)  VALUE  811.        02034199
080204     05  PC-DC-FINDLAY             PIC  9(05)  VALUE  810.        02035099
           05  PC-MAX-RETRIES            PIC S9(03)  VALUE  +3  COMP-3. 02036099
           05  PC-MAX-TYPE-SCR-LINES     PIC S9(03)  VALUE  +18 COMP-3. 02037099
           05  PC-MAX-TYPES              PIC S9(03)  VALUE  +9  COMP-3. 02038099
           05  PC-MAX-RETAIL-ITEMS       PIC S9(03)  VALUE  +40 COMP-3. 02039099
           05  PC-MAX-NON-RETAIL-ITEMS   PIC S9(03)  VALUE  +20 COMP-3. 02039199
           05  PC-ITEMS-PER-RTL-PANEL         PIC S9(04)  VALUE +20     02039299
                                                          COMP SYNC.    02039399
           05  PC-ITEMS-PER-NRTL-PANEL        PIC S9(04)  VALUE +10     02039499
                                                          COMP SYNC.    02039599
           05  PC-MAX-BLOCKS-IN-ARRAY         PIC S9(04)  VALUE +2      02039699
                                                          COMP SYNC.    02039799
           05 PC-MAX-DATE               PIC X(10) VALUE '9999-09-09'.   03850299
           05  PC-RECEIVED-STATUS        PIC  X(02)  VALUE  'PR'.       03850399
           05  PC-RECEIVED-STATUS-DESC   PIC  X(08)  VALUE  'RECEIVED'. 03850499
           05  PC-FIVE-DAYS                   PIC 9(01) VALUE 5.        03850599
           05  PC-9-ZEROS                PIC  X(09)  VALUE '000000000'. 03850699
           05  PC-ZERO                   PIC S9(04)  VALUE ZERO         03850899
                                                           COMP SYNC.   03850999
           05  PC-VOID-STATUS            PIC  X(02)  VALUE  'VD'.       03851099
           05  PC-3270-ENTRY             PIC  X(02)  VALUE  '02'.       03851199
           05  PC-YES                         PIC  X(01)  VALUE 'Y'.    03851299
           05  PC-NO                          PIC  X(01)  VALUE 'N'.    03852099
           05  PC-SCL                         PIC  X(03)  VALUE 'SCL'.  03853099
           05  PC-KOHLS-OPERATING-COMPANY     PIC  X(02)  VALUE '03'.   03854099
           05  PC-TSYMSG-NUMBERS.                                       03855099
               10  PC-TSYMSG-00005       PIC  9(05)  VALUE  00005.      03856099
               10  PC-TSYMSG-00007       PIC  9(05)  VALUE  00007.      03857099
               10  PC-TSYMSG-00008       PIC  9(05)  VALUE  00008.      03858099
               10  PC-TSYMSG-00009       PIC  9(05)  VALUE  00009.      03859099
               10  PC-TSYMSG-00010       PIC  9(05)  VALUE  00010.      03860099
               10  PC-TSYMSG-00017       PIC  9(05)  VALUE  00017.      03870099
               10  PC-TSYMSG-00032       PIC  9(05)  VALUE  00032.      03880099
               10  PC-TSYMSG-00051       PIC  9(05)  VALUE  00051.      03890099
               10  PC-TSYMSG-00052       PIC  9(05)  VALUE  00052.      03900099
               10  PC-TSYMSG-00053       PIC  9(05)  VALUE  00053.      03910099
               10  PC-TSYMSG-00098       PIC  9(05)  VALUE  00098.      03920099
               10  PC-TSYMSG-00110       PIC  9(05)  VALUE  00110.      03930099
               10  PC-TSYMSG-01401       PIC  9(05)  VALUE  01401.      03940099
               10  PC-TSYMSG-01403       PIC  9(05)  VALUE  01403.      03950099
               10  PC-TSYMSG-01405       PIC  9(05)  VALUE  01405.      03960099
               10  PC-TSYMSG-01407       PIC  9(05)  VALUE  01407.      03970099
               10  PC-TSYMSG-01408       PIC  9(05)  VALUE  01408.      03980099
               10  PC-TSYMSG-01409       PIC  9(05)  VALUE  01409.      03990099
               10  PC-TSYMSG-01410       PIC  9(05)  VALUE  01410.      04000099
               10  PC-TSYMSG-01411       PIC  9(05)  VALUE  01411.      04010099
               10  PC-TSYMSG-01412       PIC  9(05)  VALUE  01412.      04020099
060110         10  PC-TSYMSG-01479       PIC  9(05)  VALUE  01479.      04030099
               10  PC-TSYMSG-01482       PIC  9(05)  VALUE  01482.      04031099
               10  PC-TSYMSG-01483       PIC  9(05)  VALUE  01483.      04040099
               10  PC-TSYMSG-01487       PIC  9(05)  VALUE  01487.      04050099
               10  PC-TSYMSG-01488       PIC  9(05)  VALUE  01488.      04060099
               10  PC-TSYMSG-01495       PIC  9(05)  VALUE  01495.      04070099
               10  PC-TSYMSG-01680       PIC  9(05)  VALUE  01680.      04080099
      *                                                                 04090099
       01  PS-PROGRAM-SWITCHES.                                         04090199
           05  PS-CRITLIST-INFO-CHG-IND  PIC X(01)   VALUE 'N'.         04090299
               88  PS-CRITLIST-INFO-NO-CHG           VALUE 'N'.         04090399
               88  PS-CRITLIST-INFO-CHG              VALUE 'Y'.         04090499
           05  PS-ERROR-SW               PIC  X      VALUE  'N'.        04090599
               88  PS-ERROR                          VALUE  'Y'.        04090699
               88  PS-NO-ERROR                       VALUE  'N'.        04090799
           05  PS-ITEMS-LEFT-ON-DB-SW    PIC  X      VALUE  'Y'.        04090899
               88  PS-ITEMS-LEFT-ON-DB               VALUE  'Y'.        04090999
               88  PS-NO-ITEMS-LEFT-ON-DB            VALUE  'N'.        04091099
           05  PS-SORT-FIELD-ERROR-SW    PIC  X      VALUE 'N'.         04092099
               88  PS-SORT-FIELD-ERROR               VALUE 'Y'.         04093099
               88  PS-NO-SORT-FIELD-ERROR            VALUE 'N'.         04094099
               88  PS-DUPLICATE-SORT-NR              VALUE 'D'.         04095099
               88  PS-SORT-SEQ-ERROR                 VALUE 'S'.         04095199
           05  PS-WKSHT-FOUND-IND        PIC X(01)   VALUE 'N'.         04095299
               88  PS-WKSHT-NOT-FOUND                VALUE 'N'.         04095399
               88  PS-WKSHT-FOUND                    VALUE 'Y'.         04095499
               88  PS-WKSHT-COMPLETED                VALUE 'C'.         04095599
           05  PS-XFER-NBR-CHG-IND       PIC X(01)   VALUE 'N'.         04095699
               88  PS-XFER-NBR-NO-CHG                VALUE 'N'.         04095799
               88  PS-XFER-NBR-CHG                   VALUE 'Y'.         04095899
           05  PS-STORE-FOUND-SW              PIC  X(01)  VALUE 'Y'.    04095999
               88  PS-STORE-FOUND                         VALUE 'Y'.    04096099
               88  PS-STORE-NOT-FOUND                     VALUE 'N'.    04096199
           05  PS-VALID-UPC-SW                PIC  X(01)  VALUE 'N'.    04096899
               88  PS-VALID-UPC                           VALUE 'Y'.    04096999
               88  PS-INVALID-UPC                         VALUE 'N'.    04097099
           05  PS-VALID-CHECK-DIGIT-SW        PIC  X(01)  VALUE 'N'.    04097199
               88  PS-VALID-CHECK-DIGIT                   VALUE 'Y'.    04097299
               88  PS-INVALID-CHECK-DIGIT                 VALUE 'N'.    04097399
                                                                        04098399
       01  PV-PROGRAM-VARIABLES.                                        04098499
100404*****HOLD FOR REGIONAL AND NONREGIONAL FIELDS                     04098599
100404     05  PV-NREGN-UNT-RTL-AMT          PIC S9(7)V9(2) VALUE ZERO. 04098699
100404     05  PV-NREGN-UPC-STAT-CHG-DTE     PIC  X(10)     VALUE SPACE.04098799
100404     05  PV-NREGN-UNT-RTL-CHG-DTE      PIC  X(10)     VALUE SPACE.04098899
100404     05  PV-NREGN-LOC-SKU-STAT-CDE     PIC  X(02)     VALUE SPACE.04098999
100404     05  PV-NREGN-LOC-SKU-STAT-CDE-9 REDEFINES                    04099099
100404             PV-NREGN-LOC-SKU-STAT-CDE PIC  9(02).                04099199
100404     05  PV-REGN-LOC-SKU-STAT-CDE      PIC  X(02)     VALUE SPACE.04099399
100404     05  PV-GP-RTL-QTY-NULL-IND        PIC S9(04)     VALUE +0    04099499
100404                                                      COMP SYNC.  04099599
100404     05  PV-GP-RTL-AMT-NULL-IND        PIC S9(04)     VALUE +0    04099699
100404                                                      COMP SYNC.  04099799
           05  PV-LINE-NBR             PIC S9(04)   VALUE +0  COMP.     04099899
           05  PV-ITEM                 PIC S9(04)   VALUE +0  COMP.     04099999
           05  PV-HOLD-QTY             PIC S9(04)   VALUE +0  COMP.     04100099
           05  PV-DEPT-CL-COUNT        PIC S9(09)   VALUE +0  COMP.     04100199
           05  PV-DEPT-NMBR-COUNT      PIC S9(09)   VALUE +0  COMP.     04100299
           05  PV-CICS-RESP            PIC S9(04)   VALUE +0  COMP.     04100399
           05  PV-READ-COUNT           PIC S9(04)   VALUE +0  COMP.     04100499
           05  PV-RETRY-COUNT          PIC S9(04)   VALUE +0  COMP.     04100599
           05  PV-SORT-TBL-SUB         PIC S9(04)   VALUE +0  COMP.     04100699
           05  PV-SEQ-NULL-IND         PIC S9(04)   VALUE +0  COMP.     04100799
           05  PV-XFER-SEQ-NBR         PIC S9(09)   VALUE +0  COMP.     04100899
           05  PV-MAX-SORT-SUB         PIC  9(01)   VALUE ZERO.         04100999
           05  PV-SORT-SUB             PIC  9(01)   VALUE ZERO.         04101099
           05  PV-XFER-STATUS-COUNT    PIC  9(01)   VALUE ZERO.         04101199
           05  PV-DB2-TIMESTAMP        PIC X(26).                       04101299
           05  PV-UPC-CODE                     PIC S9(15)  VALUE ZERO   04101399
                                                           COMP-3.      04101499
           05  PV-UPC-CODE-DISPLAY             PIC 9(15)  VALUE ZERO.   04101599
           05  PV-NULL-IND                    PIC S9(04)  VALUE +0      04101699
                                                    COMP SYNC.          04101799
100404*    05  PV-XFER-NBR                    PIC 9(09).                04101899
100404     05  PV-XFER-NBR                    PIC 9(10).                04101999
           05  FILLER REDEFINES PV-XFER-NBR.                            04102099
100404*        10  PV-FROM-STORE-NBR          PIC 9(03).                04102199
100404         10  PV-FROM-STORE-NBR          PIC 9(04).                04102299
               10  PV-SEQ-NBR                 PIC 9(06).                04102399
           05  PV-DISP-XFER-NBR.                                        04102499
100404*        10  PV-DISP-FROM-STORE-NBR     PIC X(03).                04102599
100404         10  PV-DISP-FROM-STORE-NBR     PIC X(04).                04102699
               10                             PIC X(01)  VALUE '-'.     04102799
               10  PV-DISP-SEQ-NBR            PIC 9(06).                04102899
           05  PV-DISPLAY-ITM-NBR              PIC  9(15)  VALUE ZEROS. 04102999
           05  PV-CHECK-TRANSFER-TYPE   PIC X(03).                      04108299
               88  PV-TRANSFER-TYPE-OK          VALUES                  04108399
                           '090', '271' THRU '280', '282', '283'.       04108499
           05  PV-ABSTIME                      PIC S9(16)  VALUE +0     04108599
                                                           COMP SYNC.   04108699
           05  PV-CURRENT-DATE.                                         04108799
               10  PV-CURRENT-YEAR             PIC  9(02)  VALUE ZEROS. 04108899
               10  PV-CURRENT-MONTH            PIC  9(02)  VALUE ZEROS. 04108999
               10  PV-CURRENT-DAY              PIC  9(02)  VALUE ZEROS. 04109099
           05  PV-CUR-RTL-AMT                  PIC S9(7)V9(2) COMP-3.   04200199
           05  PV-GP-QTY                       PIC S9(3)V COMP-3.       04200299
           05  PV-GP-RTL-AMT                   PIC S9(5)V9(2) COMP-3.   04201099
       01  SD-SYSTEM-DATE.                                              04210099
           05  SD-MMDDYY-FORMAT            PIC  X(08)  VALUE SPACE.     04220099
           05  FILLER  REDEFINES  SD-MMDDYY-FORMAT.                     04230099
               10  SD-SYSTEM-MONTH         PIC  X(02).                  04240099
               10  FILLER                  PIC  X(01).                  04250099
               10  SD-SYSTEM-DAY           PIC  X(02).                  04260099
               10  FILLER                  PIC  X(01).                  04270099
               10  SD-SYSTEM-YEAR          PIC  X(02).                  04280099
                                                                        04290099
       01  SORT-ORDER-FIELDS-TBL        PIC 9(3)    VALUE ZEROES.       04300099
       01  SORT-ORDER-FIELDS-TBL-REDEF REDEFINES SORT-ORDER-FIELDS-TBL. 04310099
           05  SORT-ORDER-FIELD OCCURS 3 TIMES                          04320099
                                        PIC 9(01).                      04330099
                                                                        04340099
       01  TYPE-FIELD.                                                  04350099
           05  TYPE-FIELD-CODE         PIC X(1)     VALUE SPACE.        04360099
           05  FILLER                  PIC X(1)     VALUE '-'.          04370099
           05  TYPE-FIELD-DESC         PIC X(20)    VALUE SPACES.       04380099
                                                                        04390099
       01  PW-PROGRAM-WORK-FIELDS.                                      04400099
           05  PW-XFER-DESC                                PIC  X(21).  05760099
           05  PW-CONTNR-TYPE                              PIC  X(02).  05770099
           05  PW-CONTNR-DESC                              PIC  X(18).  05780099
100404     05  PW-TO-STORE                                 PIC  X(04).  05791099
100404     05  PW-TO-STORE-N     REDEFINES PW-TO-STORE     PIC  9(04).  05810099
           05  PW-TO-STORE-TYPE                            PIC  X(02).  05820099
           05  PW-CUST-NAME                                PIC  X(20).  05830099
           05  PW-PHONE-NBR                                PIC  X(10).  05830199
           05  PW-COMP-BY-INT                              PIC  X(01).  05830299
           05  PW-COMP-BY-NAM                              PIC  X(20).  05840099
           05  PW-REQ-BY-INT                               PIC  X(01).  05850099
           05  PW-REQ-BY-NAM                               PIC  X(20).  05860099
           05  PW-CALLBACK-NBR                             PIC  X(04).  05890099
           05  PW-CALLBACK-NBR-N REDEFINES PW-CALLBACK-NBR              05900099
                                                           PIC  9(04).  05910099
           05  PW-APPROVAL-NBR                             PIC  X(09).  05920099
           05  PW-APPROVAL-NBR-N REDEFINES PW-APPROVAL-NBR              05930099
                                                           PIC  9(09).  05940099
           05  PW-LG-TOTE-SEAL1                            PIC  X(07).  06120099
           05  PW-LG-TOTE-SEAL2                            PIC  X(07).  06130099
           05  PW-SM-TOTE-SEAL                             PIC  X(07).  06140099
           05  PW-TRAILER-SEAL                             PIC  X(07).  06150099
           05  PW-TRAILER-NBR                              PIC  X(08).  06160099
           05 PW-ITEM-SUB                     PIC S9(04) COMP  SYNC.    06670099
                                                                        06671099
      *----------------------------------------------------------------*06672099
      *  RF COPYBOOK TO FORMAT PRINTER DESTINATION                      06673099
      *----------------------------------------------------------------*06674099
080204     COPY RFWS009.                                                06675099
                                                                        06676099
      *----------------------------------------------------------------*06677099
060110*  LCOATION EXCLUSION LIST                                        06678099
      *----------------------------------------------------------------*06679099
060110     COPY TFWS010.                                                06680099
                                                                        06681099
      ******************************************************************06690099
      *    MAP LAYOUT                                                  *06700099
      ******************************************************************06710099
           COPY TFKM443.                                                06720099
           EJECT                                                        06730099
      ******************************************************************06740099
      *  EXTENDED ATTRIBUTES COPYBOOK                                  *06750099
      ******************************************************************06760099
                                                                        06770099
           COPY DPWS015.                                                06780099
                                                                        06790099
      ******************************************************************06800099
      *  FUNCTION KEYS  COPYBOOK                                       *06810099
      ******************************************************************06820099
                                                                        06830099
           COPY DPWS016.                                                06840099
                                                                        06850099
      ******************************************************************06860099
      *    COPY BOOK FOR NUMERIC EDIT SUBROUTINE (DPKUT100) PARAMETER  *06870099
      *    LIST.                                                       *06880099
      ******************************************************************06890099
                                                                        06900099
           COPY DPWS010I.                                               06910099
                                                                        06910199
      ******************************************************************06910799
      *    COPY BOOK FOR CURRENT SYSTEM DATE/TIME PROCEDURE DIVISION   *06910899
      *    ROUTINE                                                      06910999
      ******************************************************************06911099
                                                                        06912099
           COPY DPWS017.                                                06913099
                                                                        06914099
      ******************************************************************06915099
      *  DATE VALIDATION CALLING PARAMETER LIST                        *06916099
      ******************************************************************06917099
                                                                        06918099
           COPY DPWS500.                                                06919099
                                                                        06920099
      ******************************************************************06930099
      ** THE CALLING PARAMETER LIST (DPWS030) FOR THE CICS            **06940099
      ** ARCHITECTURE API (BLACK BOX) SUB-ROUTINE.                    **06950099
      ******************************************************************06960099
           COPY DPWS030.                                                06970099
CICS       COPY DPWS930.                                                06971099
                                                                        06980099
      ***************************************************************** 06990099
      *    STANDARD COMMAREA.                                           07000099
      ***************************************************************** 07010099
                                                                        07020099
           COPY DPWS020.                                                07030099
           05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                07040099
                                                                        07050099
      ***************************************************************** 07060099
      *    INTER-APPLICATION COMMAREA.                                  07070099
      ***************************************************************** 07080099
                                                                        07090099
               10  INTER-APPL-COMM-AREA PIC X(200).                     07100099
                                                                        07110099
           COPY TFWS001.                                                07120099
      ***************************************************************** 07130099
      *    SPECIFIC COMMMAREA FOR TFKCS443.                             07140099
      ***************************************************************** 07150099
               10  ASC-SPECIFIC-COMMAREA.                               07160099
                   15  ASC-CONTROL-NBR             PIC  X(09).          07170099
                   15  ASC-CONTROL-NBR-N REDEFINES                      07180099
                           ASC-CONTROL-NBR         PIC  9(09).          07190099
                   15  ASC-XFER-SEQ-NBR            PIC  S9(09) COMP.    07200099
                   15  ASC-XFER-TYPE               PIC  X(01).          07210099
                   15  ASC-XFER-TYPE-DESC          PIC  X(20).          07220099
                   15  ASC-CONTNR-TYPE             PIC  X(01).          07230099
                   15  ASC-CONTNR-TYPE-DESC        PIC  X(18).          07240099
100404*            15  ASC-FROM-STORE              PIC  X(03).          07250099
100404             15  ASC-FROM-STORE              PIC  X(04).          07251099
                   15  ASC-FROM-STORE-N REDEFINES                       07260099
100404*                    ASC-FROM-STORE          PIC  9(03).          07270099
100404                     ASC-FROM-STORE          PIC  9(04).          07271099
100404             15  ASC-TO-STORE                PIC  X(04).          07281099
                   15  ASC-TO-STORE-N REDEFINES                         07290099
100404                     ASC-TO-STORE            PIC  9(04).          07301099
                   15  ASC-DEPT-NBR                PIC  X(03).          07310099
                   15  ASC-DEPT-NBR-N REDEFINES                         07320099
                           ASC-DEPT-NBR            PIC  9(03).          07330099
                   15  ASC-CLASS-NBR               PIC  X(03).          07340099
                   15  ASC-CLASS-NBR-N REDEFINES                        07350099
                           ASC-CLASS-NBR           PIC  9(03).          07360099
                   15  ASC-CALLBACK-NBR            PIC  X(04).          07370099
                   15  ASC-CALLBACK-NBR-N REDEFINES                     07380099
                           ASC-CALLBACK-NBR        PIC  9(04).          07390099
                   15  ASC-APPROVAL-NBR            PIC  X(09).          07400099
                   15  ASC-APPROVAL-NBR-N REDEFINES                     07410099
                           ASC-APPROVAL-NBR        PIC  9(09).          07420099
                   15  ASC-COMP-BY-FIRST-INIT      PIC  X(01).          07430099
                   15  ASC-COMP-BY-LAST-NAME       PIC  X(20).          07440099
                   15  ASC-SORT-ORDER-FIELDS.                           07450099
                       20  ASC-XFER-TYPE-SORT-NR   PIC  X(01).          07460099
                       20  ASC-CONTNR-TYPE-SORT-NR PIC  X(01).          07470099
                       20  ASC-TO-STORE-SORT-NR    PIC  X(01).          07480099
                   15  ASC-XFER-TYPE-STATUS-TBL.                        07490099
                       20  ASC-XFER-TY-ST-FIELD OCCURS 18 TIMES         07500099
                                                   PIC  X(22).          07500199
                   15  ASC-TYPE-TBL-SUB            PIC S9(04) COMP.     07500299
                   15  ASC-ACTION-SW               PIC  X(01).          07500399
                       88  ASC-CRITLIST-REQUESTED  VALUE 'L'.           07500499
                       88  ASC-PRT-WKSHT-REQUESTED VALUE 'P'.           07500599
                       88  ASC-PRT-DOC-REQUESTED   VALUE 'D'.           07500699
                       88  ASC-COMPLETE-REQUESTED  VALUE 'C'.           07500799
                   15  ASC-PROB-IND                PIC  X(01).          07500899
                       88  ASC-PROBLEM-EXISTS      VALUE 'Y'.           07500999
                       88  ASC-NO-PROBLEM-EXISTS   VALUE 'N'.           07501099
                   15  ASC-DO-NOT-SHIP-SW                  PIC  X(01).  07501199
                       88  ASC-DO-NOT-SHIP                 VALUE 'N'.   07501299
                       88  ASC-OK-TO-SHIP                  VALUE 'Y'.   07501399
                   15  ASC-FR-STR-OVRRID-IND       PIC  X(01).          07501499
                       88  ASC-FR-STR-OVERRIDE      VALUE 'Y'.          07501599
                   15  ASC-HOLD-FIELDS.                                 07501699
                       20  ASC-HOLD-CONTROL-NBR    PIC  X(09).          07501799
                       20  ASC-HOLD-XFER-TYPE      PIC  X(01).          07501899
                       20  ASC-HOLD-CONTNR-TYPE    PIC  X(01).          07501999
100404                 20  ASC-HOLD-TO-STORE       PIC  X(04).          07502199
                       20  ASC-HOLD-DEPT-NBR       PIC  9(03).          07503099
                       20  ASC-HOLD-CLASS-NBR      PIC  9(03).          07504099
                       20  ASC-HOLD-CALLBACK-NBR   PIC  X(04).          07505099
                       20  ASC-HOLD-APPROVAL-NBR   PIC  X(09).          07506099
                       20  ASC-HOLD-COMP-BY-FIRST-INIT                  07507099
                                                   PIC  X(01).          07508099
                       20  ASC-HOLD-COMP-BY-LAST-NAME                   07509099
                                                   PIC  X(20).          07509199
                   15  ASC-NBR-OF-LINES-ENTERED          PIC S9(03)     07509299
                                                              COMP-3.   07509399
                   15  ASC-CMPLT-XFER-TYPE                PIC  X(02).   07509499
                       88  ASC-NON-RETAIL-XFER             VALUE '06'.  07509599
                       88  ASC-RETAIL-XFER                 VALUE        07509699
111703                                           '00' THRU '05', '07'.  07509799
                   15  ASC-ITEMS-LEFT-INDICATOR            PIC  X(01).  07509899
                       88  ASC-ITEMS-LEFT-ON-DB            VALUE 'Y'.   07509999
                       88  ASC-NO-ITEMS-LEFT-ON-DB         VALUE 'N'.   07510099
                   15 ASC-RETAIL-ITEM-ARRAY.                            07510199
                       20 ASC-RETAIL-ENTRIES OCCURS 40 TIMES.           07510299
                           25 FILLER                     PIC  X(09).    07510399
                           25 ASC-UPC                    PIC  9(13).    07510799
                           25 ASC-UPC-XXX REDEFINES ASC-UPC.            07510899
                              45  ASC-KOHLS-UPC-DIGITS   PIC X(04).     07510999
                              45  ASC-KOHLS-DEPT         PIC X(03).     07511099
                              45  FILLER                 PIC X(02).     07511199
                              45  ASC-KOHLS-DUMMY-SKU    PIC X(03).     07511299
                              45  FILLER                 PIC X(01).     07511399
                           25 ASC-KOHLS-UPC              PIC S9(15)     07511499
                                                         COMP-3.        07511599
                           25 ASC-ITEM-NBR               PIC S9(15)     07511699
                                                         COMP-3.        07511799
                           25 ASC-PRICE                  PIC X(07).     07511899
                           25 ASC-PRICE-N REDEFINES ASC-PRICE           07511999
                                                         PIC  9(05)V99. 07512099
                           25 ASC-FILE-PRICE             PIC S9(05)V99  07512199
                                                         COMP-3.        07512299
                           25 ASC-RTL-QTY                PIC X(03).     07512399
                           25 ASC-RTL-QTY-N REDEFINES ASC-RTL-QTY       07512499
                                                         PIC  9(03).    07512599
                           25  ASC-RTL-ITEM-UPDATED-SW PIC X(01).       07512699
                               88 ASC-RTL-ITEM-UPDATED                  07512799
                                                            VALUE 'Y'.  07512899
                               88 ASC-RTL-ITEM-NOT-UPDATED              07512999
                                                            VALUE ' '.  07513099
                           25  ASC-GROUP-PRICED-SW     PIC X(01).       07513199
                               88  ASC-GROUP-PRICED-ITEM                07513299
                                                            VALUE 'Y'.  07513399
                               88  ASC-NOT-GROUP-PRICED-ITEM            07513499
                                                            VALUE 'N'.  07513599
                   15 ASC-NON-RETAIL-ITEM-ARRAY                         07513699
                           REDEFINES ASC-RETAIL-ITEM-ARRAY.             07513799
                       20 ASC-NON-RETAIL-ENTRIES OCCURS 20 TIMES.       07513899
                           25 ASC-ITEM-DESC.                            07513999
                               30 ASC-ITEM-DESC1         PIC X(20).     07514099
                               30 ASC-ITEM-DESC2         PIC X(20).     07514199
                           25 ASC-NRTL-DEPT              PIC  X(03).    07514299
                           25 ASC-FIXTURE                PIC  X(20).    07514399
                           25 ASC-NRTL-QTY               PIC X(03).     07514499
                           25 ASC-NRTL-QTY-N REDEFINES      ASC-NRTL-QTY07514599
                                                         PIC 9(03).     07514699
                           25 ASC-NRTL-ITEM-UPDATED-SW PIC X(01).       07514799
                               88 ASC-NRTL-ITEM-UPDATED                 07514899
                                                            VALUE 'Y'.  07514999
                               88 ASC-NRTL-ITEM-NOT-UPDATED             07515099
                                                            VALUE ' '.  07515199
           EJECT                                                        07515299
                                                                        07515399
      ***************************************************************** 07515499
      *   ABEND COPYBOOK.                                               07515599
      ***************************************************************** 07515699
           COPY DPWS013.                                                07516099
                                                                        07516199
           EJECT                                                        07516299
      *---------------------------------------------------------------* 07516399
      *    DB2 AREA FOR TRANSFER TABLE                                * 07516499
      *---------------------------------------------------------------* 07516599
           EXEC SQL                                                     07516699
                INCLUDE TTFMSTR                                         07516799
           END-EXEC.                                                    07516899
      *---------------------------------------------------------------* 07516999
      *    DB2 AREA FOR TRANSFER ITEM TABLE                           * 07517099
      *---------------------------------------------------------------* 07517199
           EXEC SQL                                                     07517299
                INCLUDE TTFITEM                                         07517399
           END-EXEC.                                                    07517499
      *---------------------------------------------------------------* 07517599
      *    DB2 AREA FOR TRANSFER TYPE TABLE                           * 07517699
      *---------------------------------------------------------------* 07517799
           EXEC SQL                                                     07517899
                INCLUDE TTFTYCD                                         07517999
           END-EXEC.                                                    07518099
      *---------------------------------------------------------------* 07518199
      *    DB2 AREA FOR TRANSFER STATUS TABLE                         * 07518299
      *---------------------------------------------------------------* 07518399
           EXEC SQL                                                     07518499
                INCLUDE TTFSTAT                                         07518599
           END-EXEC.                                                    07518699
      *---------------------------------------------------------------* 07518799
      *    DB2 AREA FOR TRANSFER CUSTOMER TABLE                       * 07518899
      *---------------------------------------------------------------* 07518999
           EXEC SQL                                                     07519099
                INCLUDE TTFCUST                                         07519199
           END-EXEC.                                                    07519299
      *---------------------------------------------------------------* 07519399
      *    DB2 AREA FOR CONTAINER TYPE TABLE                          * 07519499
      *---------------------------------------------------------------* 07519599
           EXEC SQL                                                     07519699
                INCLUDE TTFSHCT                                         07519799
           END-EXEC.                                                    07519899
      *---------------------------------------------------------------* 07519999
100404*    DB2 AREA FOR XST_LOC TABLE                                 * 07520099
      *---------------------------------------------------------------* 07520199
           EXEC SQL                                                     07520299
100404          INCLUDE XST00001                                        07520399
           END-EXEC.                                                    07520499
      *---------------------------------------------------------------* 07520599
100404*    DB2 AREA FOR XST_SKU_LOC TABLE                             * 07520699
      *---------------------------------------------------------------* 07520799
           EXEC SQL                                                     07520899
100404          INCLUDE XST00008                                        07520999
           END-EXEC.                                                    07521099
      *---------------------------------------------------------------* 07521199
100404*    DB2 AREA FOR XST_SKU TABLE                                 * 07521299
      *---------------------------------------------------------------* 07521399
           EXEC SQL                                                     07521499
100404          INCLUDE XST00010                                        07521599
           END-EXEC.                                                    07521699
      *---------------------------------------------------------------* 07521799
100404*    DB2 AREA FOR XST_UPC TABLE                                 * 07521899
      *---------------------------------------------------------------* 07521999
           EXEC SQL                                                     07522099
100404          INCLUDE XST00012                                        07522199
           END-EXEC.                                                    07522299
      *---------------------------------------------------------------* 07522399
      *    DB2 AREA FOR NI SKU CROSS REFERENCE TABLE                  * 07522499
      *---------------------------------------------------------------* 07522599
           EXEC SQL                                                     07522699
                INCLUDE TSKXREF                                         07522799
           END-EXEC.                                                    07522899
      *---------------------------------------------------------------* 07524799
      *    DB2 AREA FOR PERMANENT PRICE CHANGE HISTORY TABLE          * 07524899
      *---------------------------------------------------------------* 07524999
           EXEC SQL                                                     07525099
               INCLUDE TPPCPRC                                          07525199
           END-EXEC.                                                    07525299
      *---------------------------------------------------------------* 07526599
      *    DB2 AREA FOR COMMUNICATIONS                                * 07526699
      *---------------------------------------------------------------* 07526799
           EXEC SQL                                                     07526899
                INCLUDE SQLCA                                           07526999
           END-EXEC.                                                    07527099
      *---------------------------------------------------------------* 07527199
      *    CURSOR TO OBTAIN THE TRANSFER TYPE CODES AND DESCRIPTIONS  * 07527299
      *---------------------------------------------------------------* 07527399
                                                                        07527499
           EXEC SQL                                                     07527599
                DECLARE XFER-TYPE-CSR CURSOR                            07527699
                FOR                                                     07527799
                  SELECT                                                07527899
                      XFER_TYP_CDE                                      07527999
                     ,TYP_1ST_LNE_DESC                                  07528099
                     ,TYP_2ND_LNE_DESC                                  07528199
                  FROM                                                  07528299
                      TTFTYCD                                           07528399
                  ORDER BY XFER_TYP_CDE                                 07528499
100404            WITH UR                                               07528599
           END-EXEC.                                                    07528699
                                                                        07528799
      *---------------------------------------------------------------* 07528899
      *  CURSOR TO OBTAIN THE CONTAINER TYPE CODES AND DESCRIPTIONS   * 07528999
      *---------------------------------------------------------------* 07529099
                                                                        07529199
           EXEC SQL                                                     07529299
                DECLARE CONT-TYPE-CSR CURSOR                            07529399
                FOR                                                     07529499
                  SELECT                                                07529599
                      CONTNR_TYP_CDE                                    07529699
                     ,CONTNR_TYP_DESC                                   07529799
                  FROM                                                  07529899
                      TTFSHCT                                           07529999
                  ORDER BY CONTNR_TYP_CDE                               07530099
100404            WITH UR                                               07530199
           END-EXEC.                                                    07530299
      *---------------------------------------------------------------* 07530399
      *    CURSOR TO GET TRANSFER ITEMS FOR A RETAIL TRANSFER.        * 07530499
      *---------------------------------------------------------------* 07530599
                                                                        07530699
           EXEC SQL                                                     07530799
                DECLARE RTL-ITEM-CSR CURSOR                             07530899
                FOR SELECT                                              07530999
                      A.XFER_LNE_NBR                                    07531099
                     ,A.CPLD_RTL_PRIC_AMT                               07531199
                     ,A.SCN_UPC_NBR                                     07531299
                     ,A.KOHLS_UPC_NBR                                   07531399
                     ,A.ITM_NBR                                         07531499
                     ,A.XFER_PRIC_AMT                                   07531599
                     ,A.XFER_QTY                                        07531699
                FROM  TTFITEM A                                         07531799
               WHERE  XFER_DKEY_ID   = :DK-XFER-DKEY-ID                 07531899
               ORDER BY  XFER_LNE_NBR                                   07531999
100404         WITH UR                                                  07532099
                                                                        07532199
           END-EXEC.                                                    07532299
                                                                        07532399
      *---------------------------------------------------------------* 07532499
      *    CURSOR TO GET TRANSFER ITEMS FOR A NON-RETAIL TRANSFER.    * 07532599
      *---------------------------------------------------------------* 07532699
                                                                        07532799
           EXEC SQL                                                     07532899
                DECLARE NRTL-ITEM-CSR CURSOR                            07532999
                FOR SELECT                                              07533099
                      XFER_LNE_NBR                                      07533199
                     ,NRTL_1ST_LNE_DESC                                 07533299
                     ,NRTL_2ND_LNE_DESC                                 07533399
                     ,NRTL_FIXT_ID                                      07534099
                     ,NRTL_DEPT_NBR                                     07540099
                     ,XFER_QTY                                          07550099
                FROM  TTFITEM                                           07560099
               WHERE  XFER_DKEY_ID   = :DK-XFER-DKEY-ID                 07570099
               ORDER BY  XFER_LNE_NBR                                   07580099
100404         WITH UR                                                  07581099
                                                                        07590099
           END-EXEC.                                                    07600099
                                                                        07600199
           EJECT                                                        07600299
       LINKAGE SECTION.                                                 07600399
                                                                        07600499
       01  DFHCOMMAREA.                                                 07600599
           05  FILLER                         OCCURS  1 TO 4072 TIMES   07600699
                                              DEPENDING ON EIBCALEN.    07600799
               10  FILLER                     PIC X.                    07600899
                                                                        07600999
                                                                        07601099
       PROCEDURE DIVISION.                                              07602099
      ***************************************************************** 07603099
      ** THIS MODULE CONTROLS THE OVERALL PROCESSING IN THE PROGRAM. ** 07604099
      ** THE SETUP AND PERFORM OF PARAGRAPH 0001-CALL-CICS-ARCH-API  ** 07605099
      ** MUST BE THE FIRST CODE EXECUTED IN THIS PROGRAM.            ** 07606099
      **                                                             ** 07607099
      ** THE SECOND OR 'EXIT' PERFORM OF THIS PARAGRAPH MUST BE THE  ** 07608099
      ** LAST CODE EXECUTED ON EACH ITERATION OF THIS PROGRAM.       ** 07609099
      ***************************************************************** 07610099
       0000-MAIN-MODULE.                                                07620099
           INITIALIZE DP030-CICS-API-FIELDS.                            07630099
           MOVE +1                       TO DP030-NUMBER-OF-MAPS.       07640099
           MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          07650099
           MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         07660099
           SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       07670099
           MOVE LENGTH OF TF443AI        TO DP030-MAP-LENGTH (1).       07680099
           MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     07690099
           PERFORM 0001-CALL-CICS-ARCH-API.                             07700099
      *                                                                 07710099
           PERFORM 1000-CONTROL-PROCESSING.                             07720099
      *                                                                 07730099
           MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     07740099
           PERFORM 0001-CALL-CICS-ARCH-API.                             07750099
                                                                        07760099
       0001-CALL-CICS-ARCH-API.                                         07770099
CICS       CALL DP930-CICS-ARCH-API USING DFHEIBLK                      07780099
                                          DFHCOMMAREA                   07790099
                                          DP030-CICS-API-FIELDS         07800099
                                          DP020-STANDARD-COMMAREA       07810099
                                          TF443AI.                      07820099
      *                                                                 07830099
           IF  DP030-RC-CALL-SUCCESSFUL                                 07840099
               CONTINUE                                                 07850099
           ELSE                                                         07860099
               SET DP013-NO-ROLLBACK                                    07870099
                   DP013-XCTL-DISPLAY-RESTART                           07880099
                   DP013-CICS-ABEND      TO TRUE                        07890099
               MOVE 'BEFORE 0000-MAIN-MODULE'                           07900099
                                         TO DP013-PARAGRAPH             07910099
CICS           MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O07911099
CICS  -             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      07912099
               MOVE DP030-RETURN-CODE                                   07940099
                                         TO DP013-MESSAGE-TEXT (3)      07950099
               PERFORM DP013-0000-PROCESS-ABEND                         07960099
           END-IF.                                                      07970099
       EJECT                                                            07980099
      ******************************************************************07990099
      *    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT   *08000099
      *    COURSE OF ACTION IS FOR THIS TRANSACTION.                   *08010099
      ******************************************************************08020099
                                                                        08030099
       1000-CONTROL-PROCESSING.                                         08040099
                                                                        08050099
           EVALUATE TRUE                                                08060099
               WHEN DP020-NEXT-ACT-INITIAL                              08070099
                   INITIALIZE ASC-SPECIFIC-COMMAREA                     08080099
080204             IF DP020-LOCATION-NBR = PC-DC-MEN-FLS                08100099
100404                 MOVE PC-RTV-MEN-FLS         TO ASC-FROM-STORE-N  08110099
                   ELSE                                                 08120099
080204                 IF DP020-LOCATION-NBR = PC-DC-FINDLAY            08130099
100404                     MOVE PC-RTV-FINDLAY     TO ASC-FROM-STORE-N  08140099
                       ELSE                                             08150099
080204                     MOVE DP020-LOCATION-NBR TO ASC-FROM-STORE-N  08160099
                      END-IF                                            08170099
                   END-IF                                               08180099
                   PERFORM 4000-BUILD-INITIAL-PANEL                     08190099
                                                                        08200099
               WHEN DP020-NEXT-ACT-READ-MAP                             08210099
                   PERFORM 2000-FKEY-PROCESSING                         08220099
                                                                        08230099
               WHEN DP020-NEXT-ACT-RETURN                               08240099
                   IF TF001-FR-STR-OVERRIDE                             08250099
                       SET ASC-FR-STR-OVERRIDE  TO TRUE                 08260099
                       MOVE TF001-XFER-FROM-STR TO ASC-FROM-STORE-N     08270099
                   END-IF                                               08280099
                   IF ASC-PRT-WKSHT-REQUESTED      AND                  09260299
                         TF001-PRINT-YES            AND                 09260399
                         TF001-PRINTER-DEST NOT = SPACES                09260499
                       MOVE PC-TSYMSG-00098  TO DP020-MSG-NUMBER        09260699
                       SET DP020-MSG-INFORMATIONAL  TO TRUE             09260899
                   ELSE                                                 09260999
                       IF ASC-PRT-DOC-REQUESTED    AND                  09261099
                             TF001-PRINT-DOC                            09262099
                           IF ASC-DO-NOT-SHIP                           09263099
                               MOVE PC-TSYMSG-01680 TO DP020-MSG-NUMBER 09934099
                           ELSE                                         09934199
                               MOVE PC-TSYMSG-01495 TO DP020-MSG-NUMBER 09934299
                           END-IF                                       09934399
                           MOVE ASC-FROM-STORE   TO                     28400499
                                                 PV-DISP-FROM-STORE-NBR 28400599
                           MOVE ASC-XFER-SEQ-NBR TO PV-DISP-SEQ-NBR     28400699
                           MOVE PV-DISP-XFER-NBR TO DP020-MSG-TEXT      28401099
                           SET DP020-MSG-INFORMATIONAL TO TRUE          28401199
                           PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         28401299
                       ELSE                                             28401399
                           PERFORM 3000-EDIT-DATA-IN-COMMAREA           28401499
                           PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         28401599
                       END-IF                                           28401699
                   END-IF                                               28401799
                                                                        28401899
               WHEN OTHER                                               28401999
                   SET DP013-LOGIC-ABEND                                28402099
                       DP013-NO-ROLLBACK TO TRUE                        28403099
                   MOVE '1000-CONTROL-PROCESSING'                       28404099
                                         TO  DP013-PARAGRAPH            28405099
                   MOVE 'INVALID NEXT ACTIVITY RETURNED TO APPL PGM:'   28406099
                                         TO  DP013-MESSAGE-TEXT(1)      28407099
                   MOVE DP020-NEXT-APPL-ACTIVITY                        28408099
                                         TO DP013-MESSAGE-TEXT(2)       28409099
                   PERFORM DP013-0000-PROCESS-ABEND                     28410099
           END-EVALUATE.                                                28420099
                                                                        28430099
      ******************************************************************28440099
      * FURTHER DETERMINE PROCESSING PATH BASED ON FUNCTION KEY ACTIONS*28450099
      * SPECIFIC FUNCTION KEYS LISTED HERE ARE ACTED UPON REGARDLESS OF*28460099
      * EDITS.                                                         *28470099
      ******************************************************************28480099
                                                                        28490099
       2000-FKEY-PROCESSING.                                            28500099
           EVALUATE TRUE                                                28510099
                                                                        28520099
               WHEN DP020-SRC-AID = DP016-CLEAR                         28530099
                   PERFORM 3000-EDIT-DATA-IN-COMMAREA                   28540099
                   PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 28550099
                                                                        28560099
               WHEN DP020-FK-REFRESH(DP020-SRC-AID)                     28570099
                   INITIALIZE ASC-SPECIFIC-COMMAREA                     28580099
080204             IF DP020-LOCATION-NBR = PC-DC-MEN-FLS                28600099
100404                 MOVE PC-RTV-MEN-FLS         TO ASC-FROM-STORE-N  28610099
                   ELSE                                                 28620099
080204                 IF DP020-LOCATION-NBR = PC-DC-FINDLAY            28630099
100404                     MOVE PC-RTV-FINDLAY     TO ASC-FROM-STORE-N  28640099
                       ELSE                                             28650099
080204                     MOVE DP020-LOCATION-NBR TO ASC-FROM-STORE-N  28660099
                      END-IF                                            28670099
                   END-IF                                               28680099
                   PERFORM 4000-BUILD-INITIAL-PANEL                     28690099
                   PERFORM 3200-RESET-ATTRIBUTES                        28700099
                                                                        28710099
               WHEN DP020-FK-LOCAL-FUNC-06 (DP020-SRC-AID)              28720099
      * ------- FROM STR -----------------------------------------------28730099
                   PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 28740099
                   SET DP030-CONTINUE-GO TO TRUE                        28750099
                   INITIALIZE TF001-INTER-APPL-COMMAREA                 28760099
                   MOVE ASC-FROM-STORE-N TO TF001-XFER-FROM-STR         28770099
                                                                        28780099
               WHEN OTHER                                               28790099
                   PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 28800099
                   PERFORM 3000-EDIT-DATA-IN-COMMAREA                   28810099
                   IF  PS-NO-ERROR                                      28820099
                       SET DP030-CONTINUE-GO TO TRUE                    28830099
                       PERFORM 2100-CHECK-FUNCTION-KEY                  28840099
                       IF PS-ERROR                                      28850099
                           SET DP030-OVERRIDE-GO TO TRUE                28860099
                       END-IF                                           28870099
                   ELSE                                                 28880099
                       SET DP030-OVERRIDE-GO TO TRUE                    28890099
                   END-IF                                               28900099
           END-EVALUATE.                                                28910099
                                                                        28920099
                                                                        28930099
      ******************************************************************28940099
      * ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED       *28950099
      * FIRST. NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED    *28960099
      * FROM THE CICS ARCHITECTURE API.                                *28970099
      ******************************************************************28980099
                                                                        28990099
       2100-CHECK-FUNCTION-KEY.                                         29000099
                                                                        29010099
           EVALUATE TRUE                                                29020099
      *------------  CTL INQ  ------------------------------------------29030099
               WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              29040099
      *------------  CTL MNT  ------------------------------------------29050099
               WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              29060099
                   MOVE SPACE                   TO ASC-ACTION-SW        29070099
                   IF ASC-CONTROL-NBR NOT = SPACES                      29080099
                       PERFORM 5000-VERIFY-WORKSHEET-EXISTS             29090099
                       IF PS-WKSHT-FOUND                                29100099
      **                 ** MOVE DATA NECESSARY FOR A WORKSHEET         29110099
      **                 ** INQUIRY OR MAINTENANCE                      29120099
                           INITIALIZE TF001-INTER-APPL-COMMAREA         29130099
                           MOVE ASC-CONTROL-NBR-N TO TF001-DKEY-ID      29140099
                           MOVE ASC-FROM-STORE-N TO TF001-XFER-FROM-STR 29150099
                       ELSE                                             29160099
                           IF PS-WKSHT-COMPLETED                        29170099
                               SET PS-ERROR                             29170199
                                   DP030-OVERRIDE-GO                    29170299
                                   DP020-MSG-FATAL TO TRUE              29170399
      *                    -- WORKSHEET HAS BEEN COMPLETED --           29170499
                               MOVE PC-TSYMSG-01487 TO DP020-MSG-NUMBER 29170599
                               MOVE ASC-FROM-STORE                      29170699
                                              TO PV-DISP-FROM-STORE-NBR 29170799
                               MOVE ASC-XFER-SEQ-NBR                    29170899
                                                    TO PV-DISP-SEQ-NBR  29170999
                               MOVE PV-DISP-XFER-NBR                    29171099
                                                    TO DP020-MSG-TEXT   29172099
                               MOVE DP015-UNP-ALP-BRT-OFF               29173099
                                                    TO ACTRLNOA         29174099
                               MOVE DP015-RED       TO ACTRLNOC         29175099
                               MOVE DP015-REVERSE   TO ACTRLNOH         29176099
                               MOVE -1              TO ACTRLNOL         29177099
                               SET DP030-SET-CURSOR-APPL-1 TO TRUE      29178099
                           ELSE                                         29179099
                               SET PS-ERROR                             29179199
                                   DP030-OVERRIDE-GO                    29179299
                                   DP020-MSG-FATAL TO TRUE              29179399
      *                    -- INVALID CONTROL NUMBER --                 29179499
                               MOVE PC-TSYMSG-01401 TO DP020-MSG-NUMBER 29179599
                               MOVE DP015-UNP-ALP-BRT-OFF               29179699
                                                    TO ACTRLNOA         29179799
                               MOVE DP015-RED       TO ACTRLNOC         29179899
                               MOVE DP015-REVERSE   TO ACTRLNOH         29179999
                               MOVE -1              TO ACTRLNOL         29180099
                               SET DP030-SET-CURSOR-APPL-1 TO TRUE      29190099
                       END-IF                                           29200099
                   ELSE                                                 29210099
                       SET PS-ERROR                                     29210199
                           DP030-OVERRIDE-GO                            29210299
                           DP020-MSG-FATAL  TO TRUE                     29210399
      *                -- REQUIRED ENTRY --                             29210499
                       MOVE PC-TSYMSG-00007 TO DP020-MSG-NUMBER         29210599
                       MOVE DP015-UNP-ALP-BRT-OFF                       29210699
                                            TO ACTRLNOA                 29210799
                       MOVE DP015-RED       TO ACTRLNOC                 29210899
                       MOVE DP015-REVERSE   TO ACTRLNOH                 29210999
                       MOVE -1              TO ACTRLNOL                 29211099
                       SET DP030-SET-CURSOR-APPL-1 TO TRUE              29212099
                   END-IF                                               29213099
                   PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 29214099
                                                                        29215099
      *----------------  CRITLIST  -------------------------------------29216099
               WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)              29217099
                   IF PS-CRITLIST-INFO-CHG                              29218099
                       MOVE SPACE               TO ASC-ACTION-SW        29219099
                   END-IF                                               29220099
                   IF ASC-CRITLIST-REQUESTED                            29230099
                       MOVE SPACE               TO ASC-ACTION-SW        29240099
                       PERFORM 2120-PREP-CRITLIST-COMMAREA              29250099
                   ELSE                                                 29260099
                       PERFORM 2110-VERIFY-CRITLIST-FIELDS              29270099
                       IF PS-NO-ERROR                                   29280099
                           SET ASC-CRITLIST-REQUESTED                   29290099
                               PS-ERROR                                 29290199
                               DP030-OVERRIDE-GO                        29290299
                               DP020-MSG-FATAL  TO TRUE                 29290399
      *                    -- PRESS &VAR AGAIN TO CONFIRM --            29290499
                           MOVE PC-TSYMSG-01403 TO DP020-MSG-NUMBER     29290599
                           MOVE 'F17-FKEY'      TO DP020-MSG-TEXT       29420099
                       END-IF                                           29430099
                   END-IF                                               29440099
                   PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 29450099
                                                                        29460099
      *----------------  COMPLETE  -------------------------------------29470099
               WHEN DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)              29480099
                   IF ASC-CONTROL-NBR NOT = SPACES                      29490099
                       PERFORM 5000-VERIFY-WORKSHEET-EXISTS             29500099
                       IF PS-WKSHT-FOUND                                29510099
      **                 ** MOVE DATA NECESSARY FOR A WORKSHEET         29520099
      **                 ** INQUIRY OR MAINTENANCE                      29530099
                           PERFORM 2300-CHECK-COMPLETE                  29540099
                       ELSE                                             29550099
                           IF PS-WKSHT-COMPLETED                        29560099
                               SET PS-ERROR                             29560199
                                   DP030-OVERRIDE-GO                    29560299
                                   DP020-MSG-FATAL TO TRUE              29560399
      *                    -- WORKSHEET HAS BEEN COMPLETED --           29560499
                               MOVE PC-TSYMSG-01487 TO DP020-MSG-NUMBER 29560599
                               MOVE ASC-FROM-STORE                      29560699
                                              TO PV-DISP-FROM-STORE-NBR 29560799
                               MOVE ASC-XFER-SEQ-NBR                    29560899
                                                    TO PV-DISP-SEQ-NBR  29560999
                               MOVE PV-DISP-XFER-NBR                    29561099
                                                    TO DP020-MSG-TEXT   29562099
                               MOVE DP015-UNP-ALP-BRT-OFF               29563099
                                                    TO ACTRLNOA         29564099
                               MOVE DP015-RED       TO ACTRLNOC         29565099
                               MOVE DP015-REVERSE   TO ACTRLNOH         29566099
                               MOVE -1              TO ACTRLNOL         29567099
                               SET DP030-SET-CURSOR-APPL-1 TO TRUE      29568099
                           ELSE                                         29569099
                               SET PS-ERROR                             29569199
                                   DP030-OVERRIDE-GO                    29569299
                                   DP020-MSG-FATAL TO TRUE              29569399
      *                    -- INVALID CONTROL NUMBER --                 29569499
                               MOVE PC-TSYMSG-01401 TO DP020-MSG-NUMBER 29569599
                               MOVE DP015-UNP-ALP-BRT-OFF               29569699
                                                    TO ACTRLNOA         29569799
                               MOVE DP015-RED       TO ACTRLNOC         29569899
                               MOVE DP015-REVERSE   TO ACTRLNOH         29569999
                               MOVE -1              TO ACTRLNOL         29570099
                               SET DP030-SET-CURSOR-APPL-1 TO TRUE      29580099
                           END-IF                                       29590099
                       END-IF                                           29600099
                   ELSE                                                 29610099
                       SET PS-ERROR                                     29610199
                           DP030-OVERRIDE-GO                            29610299
                           DP020-MSG-FATAL  TO TRUE                     29610399
      *                -- REQUIRED ENTRY --                             29610499
                       MOVE PC-TSYMSG-00007 TO DP020-MSG-NUMBER         29610599
                       MOVE DP015-UNP-ALP-BRT-OFF                       29610699
                                            TO ACTRLNOA                 29610799
                       MOVE DP015-RED       TO ACTRLNOC                 29610899
                       MOVE DP015-REVERSE   TO ACTRLNOH                 29610999
                       MOVE -1              TO ACTRLNOL                 29611099
                       SET DP030-SET-CURSOR-APPL-1 TO TRUE              29612099
                   END-IF                                               29613099
                   PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 29614099
                                                                        29615099
      *---  PRINT WKST  --------------------------------------------*   29616099
               WHEN DP020-FK-LOCAL-FUNC-05 (DP020-SRC-AID)              29617099
                   IF ASC-CONTROL-NBR NOT = SPACES                      29618099
                       PERFORM 5000-VERIFY-WORKSHEET-EXISTS             29619099
                       IF PS-WKSHT-NOT-FOUND                            29620099
                           SET PS-ERROR                                 29620199
                               DP030-OVERRIDE-GO                        29620299
                               DP020-MSG-FATAL TO TRUE                  29620399
      *       -- INVALID TRANSFER NUMBER --                             29620499
                           MOVE PC-TSYMSG-01401 TO DP020-MSG-NUMBER     29620599
                           MOVE DP015-UNP-ALP-BRT-OFF                   29620699
                                                TO ACTRLNOA             29620799
                           MOVE DP015-RED       TO ACTRLNOC             29620899
                           MOVE DP015-REVERSE   TO ACTRLNOH             29620999
                           MOVE -1              TO ACTRLNOL             29621099
                           SET DP030-SET-CURSOR-APPL-1 TO TRUE          29622099
                       ELSE                                             29623099
                          IF PS-WKSHT-COMPLETED                         29624099
                             SET PS-ERROR                               29624199
                                 DP030-OVERRIDE-GO                      29624299
                                 DP020-MSG-FATAL TO TRUE                29624399
      *    -- WORKSHEET HAS BEEN COMPLETED --                           29624499
                             MOVE PC-TSYMSG-01487 TO DP020-MSG-NUMBER   29624599
                             MOVE ASC-FROM-STORE                        29624699
                                              TO PV-DISP-FROM-STORE-NBR 29624799
                             MOVE ASC-XFER-SEQ-NBR                      29624899
                                                    TO PV-DISP-SEQ-NBR  29624999
                             MOVE PV-DISP-XFER-NBR                      29625099
                                                    TO DP020-MSG-TEXT   29626099
                             MOVE DP015-UNP-ALP-BRT-OFF                 29627099
                                                  TO ACTRLNOA           29628099
                             MOVE DP015-RED       TO ACTRLNOC           29629099
                             MOVE DP015-REVERSE   TO ACTRLNOH           29630099
                             MOVE -1              TO ACTRLNOL           29640099
                             SET DP030-SET-CURSOR-APPL-1 TO TRUE        29650099
                         ELSE                                           29660099
                             SET ASC-PRT-WKSHT-REQUESTED TO TRUE        29670099
                             INITIALIZE TF001-INTER-APPL-COMMAREA       29680099
080204                       MOVE ASC-FROM-STORE TO RFWS009-STORE-NBR   29690099
080204                       MOVE RFWS009-STORE-PRINTER-DEST            29690199
080204                                           TO TF001-PRINTER-DEST  29690299
                             MOVE ASC-CONTROL-NBR-N TO TF001-DKEY-ID    29710099
                         END-IF                                         29720099
                      END-IF                                            29730099
                   ELSE                                                 29740099
                       SET PS-ERROR                                     29740199
                           DP030-OVERRIDE-GO                            29740299
                           DP020-MSG-FATAL TO TRUE                      29740399
      *      -- REQUIRED ENTRY --                                       29740499
                       MOVE PC-TSYMSG-00007 TO DP020-MSG-NUMBER         29740599
                       MOVE DP015-UNP-ALP-BRT-OFF                       29740699
                                            TO ACTRLNOA                 29740799
                       MOVE DP015-RED       TO ACTRLNOC                 29740899
                       MOVE DP015-REVERSE   TO ACTRLNOH                 29740999
                       MOVE -1              TO ACTRLNOL                 29741099
                       SET DP030-SET-CURSOR-APPL-1 TO TRUE              29742099
                   END-IF                                               29743099
                                                                        29744099
               WHEN DP020-SRC-AID = DP016-ENTER                         29745099
                   MOVE SPACE            TO ASC-ACTION-SW               29746099
                   PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 29747099
                                                                        29748099
               WHEN DP030-OVERRIDE-GO                                   29749099
                   CONTINUE                                             29750099
                                                                        29760099
               WHEN OTHER                                               29770099
                   SET DP013-NO-ROLLBACK                                29780099
                       DP013-XCTL-DISPLAY-RESTART                       29790099
                       DP013-CICS-ABEND  TO TRUE                        29800099
                   MOVE '2100-CHECK-FUNCTION-KEY'                       29810099
                                         TO DP013-PARAGRAPH             29820099
                   MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      29830099
                                         TO DP013-MESSAGE-TEXT (1)      29840099
                   PERFORM DP013-0000-PROCESS-ABEND                     29850099
           END-EVALUATE.                                                29860099
                                                                        29870099
      ******************************************************************29880099
      ** CHECK SELECTED CRITERIA FIELDS FOR VALID DATA THAT EXISTS.   **29890099
      ******************************************************************29900099
                                                                        29910099
       2110-VERIFY-CRITLIST-FIELDS.                                     29920099
                                                                        29930099
           IF ASC-TO-STORE NOT = SPACE                                  29940099
100404         MOVE ASC-TO-STORE         TO XST00001-LOC-NBR            29950099
               PERFORM 5400-SELECT-STORE                                29960099
               IF SQLCODE NOT = +0                                      29960199
                   SET DP020-MSG-FATAL   TO TRUE                        29960299
      *            -- STORE DOES NOT EXIST --                           29960399
                   MOVE DP015-UNP-ALP-BRT-OFF                           29960499
                                         TO ATOSTORA                    29960599
                   MOVE DP015-RED        TO ATOSTORC                    29960699
                   MOVE DP015-REVERSE    TO ATOSTORH                    29960799
                   IF PS-NO-ERROR                                       29960899
                       MOVE PC-TSYMSG-00017 TO DP020-MSG-NUMBER         29960999
                       MOVE -1           TO ATOSTORL                    29961099
                       SET DP030-SET-CURSOR-APPL-1                      29961199
                                         TO TRUE                        29961299
                       SET PS-ERROR      TO TRUE                        29961399
                   END-IF                                               29961499
               END-IF                                                   29961599
           END-IF.                                                      29961699
060110     IF ASC-TO-STORE NOT = SPACE                                  29961799
060110         MOVE ASC-TO-STORE         TO PV-LOC-EXCLUDE              29961899
060110         IF PV-EXCLUDE                                            29961999
060110             SET DP020-MSG-FATAL   TO TRUE                        29962199
060110*            -- INVALID LOCATION  --                              29962299
060110             MOVE DP015-UNP-ALP-BRT-OFF                           29962399
060110                                   TO ATOSTORA                    29962499
060110             MOVE DP015-RED        TO ATOSTORC                    29962599
060110             MOVE DP015-REVERSE    TO ATOSTORH                    29962699
060110             IF PS-NO-ERROR                                       29962799
060110                 MOVE PC-TSYMSG-01479 TO DP020-MSG-NUMBER         29962899
060110                 MOVE -1           TO ATOSTORL                    29962999
060110                 SET DP030-SET-CURSOR-APPL-1                      29963099
060110                                   TO TRUE                        29963199
060110                 SET PS-ERROR      TO TRUE                        29963299
060110             END-IF                                               29963399
060110         END-IF                                                   29963499
060110     END-IF.                                                      29963599
                                                                        29963699
           IF ASC-DEPT-NBR NOT = SPACES                                 29963799
             AND ASC-CLASS-NBR = SPACES                                 29963899
               MOVE ASC-DEPT-NBR-N       TO SKXREF-DEPT                 29963999
               PERFORM 5500-VERIFY-DEPARTMENT                           29964099
               IF PV-DEPT-NMBR-COUNT = ZERO                             29964199
                   SET DP020-MSG-FATAL   TO TRUE                        29964299
      *            -- DEPARTMENT DOES NOT EXIST --                      29964399
                   MOVE DP015-UNP-ALP-BRT-OFF                           29964499
                                         TO ADEPTA                      29964599
                   MOVE DP015-RED        TO ADEPTC                      29964699
                   MOVE DP015-REVERSE    TO ADEPTH                      29964799
                   IF PS-NO-ERROR                                       29964899
                       MOVE PC-TSYMSG-00032 TO DP020-MSG-NUMBER         29964999
                       MOVE -1           TO ADEPTL                      29965099
                       SET DP030-SET-CURSOR-APPL-1                      29965199
                                         TO TRUE                        29965299
                       SET PS-ERROR      TO TRUE                        29965399
                   END-IF                                               29965499
               END-IF                                                   29965599
           END-IF.                                                      29965699
                                                                        29965799
           IF ASC-CLASS-NBR NOT = SPACE                                 29965899
               MOVE ASC-DEPT-NBR-N       TO SKXREF-DEPT                 29965999
               MOVE ASC-CLASS-NBR-N      TO SKXREF-CLASS                29966099
               PERFORM 5600-VERIFY-DEPARTMENT-CLASS                     29966199
               IF PV-DEPT-CL-COUNT = ZERO                               29966299
                   SET DP020-MSG-FATAL   TO TRUE                        29966399
      *            -- DEPARTMENT/CLASS DOES NOT EXIST --                29966499
                   MOVE DP015-UNP-ALP-BRT-OFF                           29966599
                                         TO ADEPTA                      29966699
                                            ACLASSA                     29966799
                   MOVE DP015-RED        TO ADEPTC                      29966899
                                            ACLASSC                     29966999
                   MOVE DP015-REVERSE    TO ADEPTH                      29967099
                                            ACLASSH                     29967199
                   IF PS-NO-ERROR                                       29968099
                       MOVE PC-TSYMSG-00110 TO DP020-MSG-NUMBER         29969099
                       MOVE -1           TO ADEPTL                      29969199
                       SET DP030-SET-CURSOR-APPL-1                      29969299
                                         TO TRUE                        29969399
                       SET PS-ERROR      TO TRUE                        29969499
                   END-IF                                               29969599
               END-IF                                                   29969699
           END-IF.                                                      29969799
                                                                        29969899
      ******************************************************************29969999
      ** MOVE DATA NECESSARY TO THE DESTINATION PROGRAM(S) INTO THE   **29970099
      ** INTER-APPLICATION COMMAREA FOR A CRITERIA LIST SELECTION.    **29980099
      ******************************************************************29990099
                                                                        30000099
       2120-PREP-CRITLIST-COMMAREA.                                     30010099
                                                                        30020099
           INITIALIZE TF001-INTER-APPL-COMMAREA.                        30030099
           SET TF001-INITIALLY-FROM-CRIT-SPEC TO TRUE.                  30040099
                                                                        30050099
           IF ASC-XFER-TYPE  NOT = SPACE                                30060099
               MOVE ZERO           TO TF001-XFER-TYPE(1:1)              30070099
               MOVE ASC-XFER-TYPE  TO TF001-XFER-TYPE(2:1)              30080099
           END-IF.                                                      30090099
                                                                        30100099
           IF ASC-CONTNR-TYPE  NOT = SPACE                              30110099
               MOVE ZERO           TO TF001-CONTNR-TYPE(1:1)            30120099
               MOVE ASC-CONTNR-TYPE TO TF001-CONTNR-TYPE(2:1)           30130099
           END-IF.                                                      30140099
                                                                        30150099
           IF  ASC-TO-STORE = SPACES                                    30160099
               MOVE ZERO           TO TF001-XFER-TO-STR                 30170099
           ELSE                                                         30180099
               MOVE ASC-TO-STORE-N TO TF001-XFER-TO-STR                 30190099
           END-IF.                                                      30200099
                                                                        30210099
           IF  ASC-DEPT-NBR = SPACES                                    30220099
               MOVE ZERO           TO TF001-XFER-DPT                    30230099
           ELSE                                                         30240099
               MOVE ASC-DEPT-NBR-N TO TF001-XFER-DPT                    30250099
           END-IF.                                                      30260099
                                                                        30270099
           IF  ASC-CLASS-NBR = SPACES                                   30280099
               MOVE ZERO           TO TF001-XFER-CLASS                  30290099
           ELSE                                                         30300099
               MOVE ASC-CLASS-NBR-N                                     30310099
                                   TO TF001-XFER-CLASS                  30320099
           END-IF.                                                      30330099
                                                                        30340099
           IF  ASC-CALLBACK-NBR = SPACES                                30350099
               MOVE ZERO           TO TF001-XFER-CALLBACK-NBR           30360099
           ELSE                                                         30370099
               MOVE ASC-CALLBACK-NBR-N                                  30380099
                                   TO TF001-XFER-CALLBACK-NBR           30390099
           END-IF.                                                      30400099
                                                                        30410099
           IF  ASC-APPROVAL-NBR = SPACES                                30420099
               MOVE ZERO           TO TF001-XFER-APPROVAL-NBR           30430099
           ELSE                                                         30440099
               MOVE ASC-APPROVAL-NBR-N                                  30450099
                                   TO TF001-XFER-APPROVAL-NBR           30460099
           END-IF.                                                      30470099
                                                                        30480099
           MOVE ASC-COMP-BY-FIRST-INIT                                  30490099
                                   TO TF001-XFER-COMP-BY-FIRST-INIT.    30500099
           MOVE ASC-COMP-BY-LAST-NAME                                   30510099
                                   TO TF001-XFER-COMP-BY-LAST-NAME.     30520099
                                                                        30530099
           IF  ASC-XFER-TYPE-SORT-NR = SPACE                            30540099
               MOVE ZERO           TO TF001-XFER-TYPE-SORT-NR           30550099
           ELSE                                                         30560099
               MOVE ASC-XFER-TYPE-SORT-NR                               30570099
                                   TO TF001-XFER-TYPE-SORT-NR           30580099
           END-IF.                                                      30590099
                                                                        30600099
           IF  ASC-TO-STORE-SORT-NR = SPACE                             30610099
               MOVE ZERO           TO TF001-XFER-TO-STR-SORT-NR         30620099
           ELSE                                                         30630099
               MOVE ASC-TO-STORE-SORT-NR                                30640099
                                   TO TF001-XFER-TO-STR-SORT-NR         30650099
           END-IF.                                                      30660099
                                                                        30670099
           IF  ASC-CONTNR-TYPE-SORT-NR = SPACE                          30680099
               MOVE ZERO           TO TF001-XFER-CONTNR-TYPE-SORT-NR    30690099
           ELSE                                                         30700099
               MOVE ASC-CONTNR-TYPE-SORT-NR                             30710099
                                   TO TF001-XFER-CONTNR-TYPE-SORT-NR    30720099
           END-IF.                                                      30730099
           MOVE ASC-FROM-STORE-N        TO TF001-XFER-FROM-STR.         30740099
           MOVE ASC-FR-STR-OVRRID-IND   TO TF001-FR-STR-OVRRID-IND.     30750099
                                                                        30760099
      ******************************************************************30770099
      * MOVE FIELDS FROM THE MAP TO THE ASC COMMAREA                    30780099
      ******************************************************************30790099
       2200-MOVE-SCREEN-TO-COMMAREA.                                    30800099
                                                                        30810099
           IF  ACTRLNOL > ZERO                                          30820099
               MOVE ACTRLNOI      TO ASC-CONTROL-NBR                    30830099
           ELSE                                                         30840099
               IF  ACTRLNOF = DP015-ERASE-EOF                           30850099
                   MOVE SPACES     TO ASC-CONTROL-NBR                   30860099
               END-IF                                                   30870099
           END-IF.                                                      30880099
                                                                        30890099
           IF  ASXFRTYPL > ZERO                                         30900099
               MOVE ASXFRTYPI      TO ASC-XFER-TYPE-SORT-NR             30910099
           ELSE                                                         30920099
               IF  ASXFRTYPF = DP015-ERASE-EOF                          30930099
                   MOVE SPACE      TO ASC-XFER-TYPE-SORT-NR             30940099
               END-IF                                                   30950099
           END-IF.                                                      30960099
                                                                        30970099
           IF  AXFRTYPL > ZERO                                          30980099
               MOVE AXFRTYPI       TO ASC-XFER-TYPE                     30990099
           ELSE                                                         31000099
               IF  AXFRTYPF = DP015-ERASE-EOF                           31010099
                   MOVE SPACES     TO ASC-XFER-TYPE                     31020099
               END-IF                                                   31030099
           END-IF.                                                      31040099
                                                                        31050099
           IF  ASCONTYPL > ZERO                                         31060099
               MOVE ASCONTYPI      TO ASC-CONTNR-TYPE-SORT-NR           31070099
           ELSE                                                         31080099
               IF  ASCONTYPF = DP015-ERASE-EOF                          31090099
                   MOVE SPACE      TO ASC-CONTNR-TYPE-SORT-NR           31100099
               END-IF                                                   31110099
           END-IF.                                                      31120099
                                                                        31130099
           IF  ACONTYPL > ZERO                                          31140099
               MOVE ACONTYPI       TO ASC-CONTNR-TYPE                   31150099
           ELSE                                                         31160099
               IF  ACONTYPF = DP015-ERASE-EOF                           31170099
                   MOVE SPACES     TO ASC-CONTNR-TYPE                   31180099
               END-IF                                                   31190099
           END-IF.                                                      31200099
                                                                        31210099
           IF  ASTOSTORL > ZERO                                         31220099
               MOVE ASTOSTORI      TO ASC-TO-STORE-SORT-NR              31230099
           ELSE                                                         31240099
               IF  ASTOSTORF = DP015-ERASE-EOF                          31250099
                   MOVE SPACE      TO ASC-TO-STORE-SORT-NR              31260099
               END-IF                                                   31270099
           END-IF.                                                      31280099
                                                                        31290099
           IF  ATOSTORL > ZERO                                          31300099
               MOVE ATOSTORI       TO ASC-TO-STORE                      31310099
           ELSE                                                         31320099
               IF  ATOSTORF = DP015-ERASE-EOF                           31330099
                   MOVE SPACES     TO ASC-TO-STORE                      31340099
               END-IF                                                   31350099
           END-IF.                                                      31360099
                                                                        31370099
           IF  ADEPTL > ZERO                                            31380099
               MOVE ADEPTI         TO ASC-DEPT-NBR                      31390099
           ELSE                                                         31400099
               IF  ADEPTF = DP015-ERASE-EOF                             31410099
                   MOVE SPACES     TO ASC-DEPT-NBR                      31420099
               END-IF                                                   31430099
           END-IF.                                                      31440099
                                                                        31450099
           IF  ACLASSL > ZERO                                           31460099
               MOVE ACLASSI        TO ASC-CLASS-NBR                     31470099
           ELSE                                                         31480099
               IF  ACLASSF = DP015-ERASE-EOF                            31490099
                   MOVE SPACES     TO ASC-CLASS-NBR                     31500099
               END-IF                                                   31510099
           END-IF.                                                      31520099
                                                                        31530099
           IF  ACALLNOL > ZERO                                          31540099
               MOVE ACALLNOI       TO ASC-CALLBACK-NBR                  31550099
           ELSE                                                         31560099
               IF  ACALLNOF = DP015-ERASE-EOF                           31570099
                   MOVE SPACES     TO ASC-CALLBACK-NBR                  31580099
               END-IF                                                   31590099
           END-IF.                                                      31600099
                                                                        31610099
           IF  AAPPRNOL > ZERO                                          31620099
               MOVE AAPPRNOI       TO ASC-APPROVAL-NBR                  31630099
           ELSE                                                         31640099
               IF  AAPPRNOF = DP015-ERASE-EOF                           31650099
                   MOVE SPACES     TO ASC-APPROVAL-NBR                  31660099
               END-IF                                                   31670099
           END-IF.                                                      31680099
                                                                        31690099
           IF  ACMPBYINL > ZERO                                         31700099
               MOVE ACMPBYINI      TO ASC-COMP-BY-FIRST-INIT            31710099
           ELSE                                                         31720099
               IF  ACMPBYINF = DP015-ERASE-EOF                          31730099
                   MOVE SPACE      TO ASC-COMP-BY-FIRST-INIT            31740099
               END-IF                                                   31750099
           END-IF.                                                      31760099
                                                                        31770099
           IF  ACMPBYNML > ZERO                                         31780099
               MOVE ACMPBYNMI      TO ASC-COMP-BY-LAST-NAME             31790099
           ELSE                                                         31800099
               IF  ACMPBYNMF = DP015-ERASE-EOF                          31810099
                   MOVE SPACES     TO ASC-COMP-BY-LAST-NAME             31820099
               END-IF                                                   31830099
           END-IF.                                                      31840099
      ******************************************************************31850099
      * READ THE DATA FOR THE SELECTED WORKSHEET AND BUILD THE ARRAY   *31860099
      * IN PREPARATION FOR COMPLETING THE TRANSFER.                    *31870099
      ******************************************************************31880099
       2300-CHECK-COMPLETE.                                             31880199
           MOVE ASC-CONTROL-NBR-N        TO DK-XFER-DKEY-ID.            31880299
           MOVE +0                       TO ASC-NBR-OF-LINES-ENTERED.   31880399
           PERFORM 6000-GET-CONTROL-INFO.                               31880499
           PERFORM 3100-EDIT-DATA-IN-COMMAREA                           31880599
           IF PS-ERROR                                                  31880699
               SET ASC-PROBLEM-EXISTS  TO TRUE                          31880799
           END-IF                                                       31880899
           IF ASC-PROBLEM-EXISTS                                        31880999
               MOVE SPACE      TO ASC-ACTION-SW                         31881099
               MOVE PC-TSYMSG-01488       TO DP020-MSG-NUMBER           31881199
               SET DP020-MSG-FATAL                                      31881299
                   DP030-OVERRIDE-GO      TO TRUE                       31881399
               PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                     31881499
           ELSE                                                         31881599
               IF ASC-NBR-OF-LINES-ENTERED = 0                          31881699
                   MOVE SPACE      TO ASC-ACTION-SW                     31881799
                   MOVE PC-TSYMSG-01483    TO DP020-MSG-NUMBER          31881899
                   SET DP020-MSG-FATAL                                  31881999
                       DP030-OVERRIDE-GO  TO TRUE                       31882099
                   PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 31882199
               ELSE                                                     31882299
                   IF ASC-COMPLETE-REQUESTED                            31882399
                       IF PS-XFER-NBR-CHG                               31882499
                           SET ASC-COMPLETE-REQUESTED TO TRUE           31882599
                           MOVE PC-TSYMSG-01403 TO DP020-MSG-NUMBER     31882699
                           MOVE 'F23-COMPLETE'   TO DP020-MSG-TEXT      31882799
                           SET DP020-MSG-INFORMATIONAL                  31882899
                               DP030-OVERRIDE-GO      TO TRUE           31882999
                           PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         31883099
                       ELSE                                             31883199
                           PERFORM 7000-COMPLETE-TRANSFER               31883299
                           INITIALIZE TF001-INTER-APPL-COMMAREA         31883399
                           MOVE ASC-FROM-STORE   TO RFWS009-STORE-NBR   31883499
                                                    PV-FROM-STORE-NBR   31883599
                           MOVE ASC-XFER-SEQ-NBR TO PV-SEQ-NBR          31883699
                           MOVE PV-XFER-NBR      TO TF001-XFER-NBR      31883799
                           MOVE RFWS009-STORE-PRINTER-DEST              31883899
                                                 TO TF001-PRINTER-DEST  31883999
                           SET ASC-PRT-DOC-REQUESTED  TO TRUE           31884099
                       END-IF                                           31884199
                   ELSE                                                 31884299
                       SET ASC-COMPLETE-REQUESTED TO TRUE               31884399
                       MOVE PC-TSYMSG-01403 TO DP020-MSG-NUMBER         31884499
                       MOVE 'F23-COMPLETE'   TO DP020-MSG-TEXT          31884599
                       SET DP020-MSG-INFORMATIONAL                      31884699
                           DP030-OVERRIDE-GO      TO TRUE               31884799
                       PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             31884899
                   END-IF                                               31884999
               END-IF                                                   31885099
           END-IF.                                                      31886099
      ******************************************************************31887099
      * PERFORM EDITS ON EACH FIELD ENTERED BY THE USER.  IF AN ERROR  *31888099
      * IS FOUND, THE CURSOR IS POSITIONED AT THAT FIELD AND AN        *31889099
      * APPROPRIATE ERROR MESSAGE IS DISPLAYED.                        *31890099
      ******************************************************************31900099
       3000-EDIT-DATA-IN-COMMAREA.                                      31910099
                                                                        31920099
           PERFORM 3200-RESET-ATTRIBUTES.                               31930099
                                                                        31940099
      *    -- EDIT THE CONTROL NUMBER --                                31950099
           IF ASC-CONTROL-NBR > SPACES                                  31960099
               MOVE ASC-CONTROL-NBR      TO DP010I-UNEDITED-FIELD       31970099
               MOVE 9                    TO DP010I-MAXIMUM-DIGITS       31980099
               MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     31990099
               SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  32000099
               CALL DP010I-NUMERIC-EDIT-ROUTINE                         32010199
                         USING DP010I-NUMERIC-EDIT-AREA                 32010299
               IF  DP010I-ERROR-DETECTED                                32010399
                   SET DP020-MSG-FATAL   TO TRUE                        32010499
      *            -- MUST BE NUMERIC --                                32010599
                   MOVE DP015-UNP-ALP-BRT-OFF                           32010699
                                         TO ACTRLNOA                    32010799
                   MOVE DP015-RED        TO ACTRLNOC                    32010899
                   MOVE DP015-REVERSE    TO ACTRLNOH                    32010999
                   IF PS-NO-ERROR                                       32011099
                       MOVE PC-TSYMSG-00008 TO DP020-MSG-NUMBER         32011199
                       MOVE -1           TO ACTRLNOL                    32011299
                       SET DP030-SET-CURSOR-APPL-1                      32011399
                                         TO TRUE                        32011499
                       SET PS-ERROR      TO TRUE                        32011599
                   END-IF                                               32011699
               ELSE                                                     32011799
                   MOVE DP010I-NUMERIC-FIELD                            32011899
                                         TO ASC-CONTROL-NBR-N           32011999
               END-IF                                                   32012099
           ELSE                                                         32012199
               IF ASC-CONTROL-NBR       = PC-9-ZEROS                    32012299
                   SET DP020-MSG-FATAL   TO TRUE                        32013099
      *            -- CANNOT BE ZERO --                                 32014099
                   MOVE DP015-UNP-ALP-BRT-OFF                           32015099
                                         TO ACTRLNOA                    32016099
                   MOVE DP015-RED        TO ACTRLNOC                    32017099
                   MOVE DP015-REVERSE    TO ACTRLNOH                    32018099
                   IF PS-NO-ERROR                                       32019099
                       MOVE PC-TSYMSG-00010 TO DP020-MSG-NUMBER         32020099
                       MOVE -1           TO ACTRLNOL                    32020199
                       SET DP030-SET-CURSOR-APPL-1                      32020299
                                         TO TRUE                        32020399
                       SET PS-ERROR      TO TRUE                        32020499
                   END-IF                                               32020599
               END-IF                                                   32020699
           END-IF.                                                      32020799
                                                                        32020899
           IF ASC-XFER-TYPE-SORT-NR  = ZERO                             32020999
               SET DP020-MSG-FATAL   TO TRUE                            32021099
               SET PS-SORT-FIELD-ERROR TO TRUE                          32022099
      *        -- INVALID VALUE --                                      32023099
               MOVE DP015-UNP-ALP-BRT-OFF                               32024099
                                     TO ASXFRTYPA                       32025099
               MOVE DP015-RED        TO ASXFRTYPC                       32026099
               MOVE DP015-REVERSE    TO ASXFRTYPH                       32027099
               IF PS-NO-ERROR                                           32028099
                   MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER             32029099
                   MOVE -1           TO ASXFRTYPL                       32029199
                   SET DP030-SET-CURSOR-APPL-1                          32029299
                                     TO TRUE                            32029399
                   SET PS-ERROR      TO TRUE                            32029499
               END-IF                                                   32029599
           ELSE                                                         32029699
               IF ASC-XFER-TYPE-SORT-NR NUMERIC OR                      32029799
                  ASC-XFER-TYPE-SORT-NR = SPACE                         32029899
                  CONTINUE                                              32029999
               ELSE                                                     32030099
                   SET DP020-MSG-FATAL TO TRUE                          32030199
                   SET PS-SORT-FIELD-ERROR TO TRUE                      32030299
      *            -- MUST BE NUMERIC --                                32030399
                   MOVE DP015-UNP-ALP-BRT-OFF                           32030499
                                     TO ASXFRTYPA                       32030599
                   MOVE DP015-RED    TO ASXFRTYPC                       32030699
                   MOVE DP015-REVERSE TO ASXFRTYPH                      32030799
                   IF PS-NO-ERROR                                       32030899
                       MOVE PC-TSYMSG-00008 TO DP020-MSG-NUMBER         32030999
                       MOVE -1       TO ASXFRTYPL                       32031099
                       SET DP030-SET-CURSOR-APPL-1                      32031199
                                     TO TRUE                            32031299
                       SET PS-ERROR  TO TRUE                            32031399
                   END-IF                                               32031499
               END-IF                                                   32031599
           END-IF.                                                      32031699
                                                                        32031799
           IF ASC-XFER-TYPE  NUMERIC OR                                 32031899
              ASC-XFER-TYPE  = SPACE                                    32031999
              CONTINUE                                                  32032099
           ELSE                                                         32032199
               SET DP020-MSG-FATAL   TO TRUE                            32032299
      *        -- MUST BE NUMERIC --                                    32032399
               MOVE DP015-UNP-ALP-BRT-OFF                               32032499
                                     TO AXFRTYPA                        32032599
               MOVE DP015-RED        TO AXFRTYPC                        32032699
               MOVE DP015-REVERSE    TO AXFRTYPH                        32032799
               IF PS-NO-ERROR                                           32032899
                   MOVE PC-TSYMSG-00008 TO DP020-MSG-NUMBER             32032999
                   MOVE -1           TO AXFRTYPL                        32033099
                   SET DP030-SET-CURSOR-APPL-1                          32033199
                                     TO TRUE                            32033299
                   SET PS-ERROR      TO TRUE                            32033399
               END-IF                                                   32033499
           END-IF.                                                      32033599
                                                                        32033699
           IF ASC-XFER-TYPE NUMERIC                                     32033799
               MOVE ZERO                 TO  TFTYCD-XFER-TYP-CDE(1:1)   32033899
               MOVE ASC-XFER-TYPE        TO  TFTYCD-XFER-TYP-CDE(2:1)   32033999
               PERFORM 5200-SELECT-XFER-TYPE-CD-INFO                    32034099
               IF SQLCODE = +0                                          32035099
                   IF TFTYCD-TYP-2ND-LNE-DESC = SPACES                  32036099
                       MOVE TFTYCD-TYP-1ST-LNE-DESC                     32037099
                                         TO ASC-XFER-TYPE-DESC          32038099
                   ELSE                                                 32039099
                       STRING TFTYCD-TYP-1ST-LNE-DESC DELIMITED BY '  ' 32040099
                              TFTYCD-TYP-2ND-LNE-DESC DELIMITED BY '  ' 32050099
                           INTO ASC-XFER-TYPE-DESC                      32060099
                   END-IF                                               32070099
                   MOVE ASC-XFER-TYPE-DESC TO AXFRTYPDO                 32080099
               ELSE                                                     32080199
                   SET DP020-MSG-FATAL   TO TRUE                        32080299
      *            -- TRANSFER TYPE DOES NOT EXIST --                   32080399
                   MOVE DP015-UNP-ALP-BRT-OFF                           32080499
                                         TO AXFRTYPA                    32080599
                   MOVE DP015-RED        TO AXFRTYPC                    32080699
                   MOVE DP015-REVERSE    TO AXFRTYPH                    32080799
                   MOVE SPACES           TO ASC-XFER-TYPE-DESC          32080899
                   MOVE SPACES           TO AXFRTYPDO                   32080999
                   IF PS-NO-ERROR                                       32081099
                       MOVE PC-TSYMSG-01412 TO DP020-MSG-NUMBER         32082099
                       MOVE -1           TO AXFRTYPL                    32082199
                       SET DP030-SET-CURSOR-APPL-1                      32082299
                                         TO TRUE                        32082399
                       SET PS-ERROR      TO TRUE                        32082499
                   END-IF                                               32082599
               END-IF                                                   32082699
           ELSE                                                         32082799
               MOVE SPACES               TO ASC-XFER-TYPE-DESC          32082899
               MOVE SPACES               TO AXFRTYPDO                   32082999
           END-IF.                                                      32083099
                                                                        32084099
           IF ASC-CONTNR-TYPE NUMERIC                                   32085099
               MOVE ZERO                 TO  TFSHCT-CONTNR-TYP-CDE(1:1) 32086099
               MOVE ASC-CONTNR-TYPE      TO  TFSHCT-CONTNR-TYP-CDE(2:1) 32087099
               PERFORM 5300-SELECT-CONTAINER-TYPE                       32088099
               IF SQLCODE = +0                                          32089099
                   MOVE TFSHCT-CONTNR-TYP-DESC                          32090099
                                         TO ASC-CONTNR-TYPE-DESC        32100099
                   MOVE ASC-CONTNR-TYPE-DESC TO ACONTYPDO               32110099
               ELSE                                                     32110199
                   SET DP020-MSG-FATAL   TO TRUE                        32110299
      *            -- CONTAINER TYPE DOES NOT EXIST --                  32110399
                   MOVE DP015-UNP-ALP-BRT-OFF                           32110499
                                         TO ACONTYPA                    32110599
                   MOVE DP015-RED        TO ACONTYPC                    32110699
                   MOVE DP015-REVERSE    TO ACONTYPH                    32110799
                   MOVE SPACES           TO ASC-CONTNR-TYPE-DESC        32110899
                   MOVE SPACES           TO ACONTYPDO                   32110999
                   IF PS-NO-ERROR                                       32111099
                       MOVE PC-TSYMSG-01482 TO DP020-MSG-NUMBER         32112099
                       MOVE -1           TO ACONTYPL                    32112199
                       SET DP030-SET-CURSOR-APPL-1                      32112299
                                         TO TRUE                        32112399
                       SET PS-ERROR      TO TRUE                        32112499
                   END-IF                                               32112599
               END-IF                                                   32112699
           ELSE                                                         32112799
               MOVE SPACES               TO ASC-CONTNR-TYPE-DESC        32112899
               MOVE SPACES               TO ACONTYPDO                   32112999
           END-IF.                                                      32113099
                                                                        32114099
           IF ASC-CONTNR-TYPE-SORT-NR = ZERO                            32114199
               SET DP020-MSG-FATAL   TO TRUE                            32114299
               SET PS-SORT-FIELD-ERROR TO TRUE                          32114399
      *        -- INVALID VALUE --                                      32114499
               MOVE DP015-UNP-ALP-BRT-OFF                               32114599
                                     TO ACONTYPA                        32114699
               MOVE DP015-RED        TO ACONTYPC                        32114799
               MOVE DP015-REVERSE    TO ACONTYPH                        32114899
               IF PS-NO-ERROR                                           32114999
                   MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER             32115099
                   MOVE -1           TO ACONTYPL                        32115199
                   SET DP030-SET-CURSOR-APPL-1                          32115299
                                     TO TRUE                            32115399
                   SET PS-ERROR      TO TRUE                            32115499
               END-IF                                                   32115599
           ELSE                                                         32115699
               IF ASC-CONTNR-TYPE-SORT-NR NUMERIC OR                    32115799
                  ASC-CONTNR-TYPE-SORT-NR = SPACE                       32115899
                  CONTINUE                                              32115999
               ELSE                                                     32116099
                   SET DP020-MSG-FATAL TO TRUE                          32116199
                   SET PS-SORT-FIELD-ERROR TO TRUE                      32116299
      *            -- MUST BE NUMERIC --                                32116399
                   MOVE DP015-UNP-ALP-BRT-OFF                           32116499
                                     TO ACONTYPA                        32116599
                   MOVE DP015-RED    TO ACONTYPC                        32116699
                   MOVE DP015-REVERSE TO ACONTYPH                       32116799
                   IF PS-NO-ERROR                                       32116899
                       MOVE PC-TSYMSG-00008 TO DP020-MSG-NUMBER         32116999
                       MOVE -1       TO ACONTYPL                        32117099
                       SET DP030-SET-CURSOR-APPL-1                      32117199
                                     TO TRUE                            32117299
                       SET PS-ERROR  TO TRUE                            32117399
                   END-IF                                               32117499
               END-IF                                                   32117599
           END-IF.                                                      32117699
                                                                        32117799
           IF ASC-CONTNR-TYPE NUMERIC OR                                32117899
              ASC-CONTNR-TYPE = SPACE                                   32117999
              CONTINUE                                                  32118099
           ELSE                                                         32118199
               SET DP020-MSG-FATAL   TO TRUE                            32118299
      *        -- MUST BE NUMERIC --                                    32118399
               MOVE DP015-UNP-ALP-BRT-OFF                               32118499
                                     TO ACONTYPA                        32118599
               MOVE DP015-RED        TO ACONTYPC                        32118699
               MOVE DP015-REVERSE    TO ACONTYPH                        32118799
               IF PS-NO-ERROR                                           32118899
                   MOVE PC-TSYMSG-00008 TO DP020-MSG-NUMBER             32118999
                   MOVE -1           TO ACONTYPL                        32119099
                   SET DP030-SET-CURSOR-APPL-1                          32119199
                                     TO TRUE                            32119299
                   SET PS-ERROR      TO TRUE                            32119399
               END-IF                                                   32119499
           END-IF.                                                      32119599
                                                                        32119699
           IF ASC-TO-STORE-SORT-NR = ZERO                               32119799
               SET DP020-MSG-FATAL   TO TRUE                            32119899
               SET PS-SORT-FIELD-ERROR TO TRUE                          32119999
      *        -- INVALID VALUE --                                      32120099
               MOVE DP015-UNP-ALP-BRT-OFF                               32130099
                                     TO ASTOSTORA                       32140099
               MOVE DP015-RED        TO ASTOSTORC                       32150099
               MOVE DP015-REVERSE    TO ASTOSTORH                       32160099
               IF PS-NO-ERROR                                           32170099
                   MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER             32180099
                   MOVE -1           TO ASTOSTORL                       32180199
                   SET DP030-SET-CURSOR-APPL-1                          32180299
                                     TO TRUE                            32180399
                   SET PS-ERROR      TO TRUE                            32180499
               END-IF                                                   32180599
           ELSE                                                         32180699
               IF ASC-TO-STORE-SORT-NR NUMERIC OR                       32180799
                  ASC-TO-STORE-SORT-NR = SPACE                          32180899
                  CONTINUE                                              32180999
               ELSE                                                     32181099
                   SET DP020-MSG-FATAL TO TRUE                          32181199
                   SET PS-SORT-FIELD-ERROR TO TRUE                      32181299
      *            -- MUST BE NUMERIC --                                32181399
                   MOVE DP015-UNP-ALP-BRT-OFF                           32181499
                                     TO ASTOSTORA                       32181599
                   MOVE DP015-RED    TO ASTOSTORC                       32181699
                   MOVE DP015-REVERSE TO ASTOSTORH                      32181799
                   IF PS-NO-ERROR                                       32181899
                       MOVE PC-TSYMSG-00008 TO DP020-MSG-NUMBER         32181999
                       MOVE -1       TO ASTOSTORL                       32182099
                       SET DP030-SET-CURSOR-APPL-1                      32182199
                                     TO TRUE                            32182299
                       SET PS-ERROR  TO TRUE                            32182399
                   END-IF                                               32182499
               END-IF                                                   32182599
           END-IF.                                                      32182699
                                                                        32182799
           IF ASC-TO-STORE > SPACES                                     32182899
               MOVE ASC-TO-STORE         TO DP010I-UNEDITED-FIELD       32182999
               MOVE LENGTH OF ASC-TO-STORE                              32183099
                                         TO DP010I-MAXIMUM-DIGITS       32184099
               MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     32185099
               SET DP010I-NEGATIVE-NOT-ALLOWED                          32186099
                                         TO TRUE                        32187099
               CALL DP010I-NUMERIC-EDIT-ROUTINE                         32188199
                         USING DP010I-NUMERIC-EDIT-AREA                 32188299
               IF  DP010I-ERROR-DETECTED                                32189099
                   SET DP020-MSG-FATAL   TO TRUE                        32190099
      *            -- MUST BE NUMERIC --                                32200099
                   MOVE DP015-UNP-ALP-BRT-OFF                           32210099
                                         TO ATOSTORA                    32220099
                   MOVE DP015-RED        TO ATOSTORC                    32230099
                   MOVE DP015-REVERSE    TO ATOSTORH                    32240099
                   IF PS-NO-ERROR                                       32250099
                       MOVE PC-TSYMSG-00008 TO DP020-MSG-NUMBER         32260099
                       MOVE -1           TO ATOSTORL                    32270099
                       SET DP030-SET-CURSOR-APPL-1                      32280099
                                         TO TRUE                        32290099
                       SET PS-ERROR      TO TRUE                        32300099
                   END-IF                                               32310099
               ELSE                                                     32320099
                   MOVE DP010I-NUMERIC-FIELD                            32330099
                                         TO ASC-TO-STORE-N              32340099
               END-IF                                                   32350099
           END-IF.                                                      32360099
                                                                        32370099
           IF  ASC-DEPT-NBR > SPACES                                    32380099
               MOVE ASC-DEPT-NBR         TO DP010I-UNEDITED-FIELD       32390099
               MOVE LENGTH OF ASC-DEPT-NBR                              32400099
                                         TO DP010I-MAXIMUM-DIGITS       32410099
               MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     32420099
               SET DP010I-NEGATIVE-NOT-ALLOWED                          32430099
                                         TO TRUE                        32440099
               CALL DP010I-NUMERIC-EDIT-ROUTINE                         32451099
                         USING DP010I-NUMERIC-EDIT-AREA                 32452099
               IF  DP010I-ERROR-DETECTED                                32460099
                   SET DP020-MSG-FATAL   TO TRUE                        32470099
      *            -- MUST BE NUMERIC --                                32480099
                   MOVE DP015-UNP-ALP-BRT-OFF                           32490099
                                         TO ADEPTA                      32500099
                   MOVE DP015-RED        TO ADEPTC                      32510099
                   MOVE DP015-REVERSE    TO ADEPTH                      32520099
                   IF PS-NO-ERROR                                       32530099
                       MOVE PC-TSYMSG-00008 TO DP020-MSG-NUMBER         32540099
                       MOVE -1           TO ADEPTL                      32540199
                       SET DP030-SET-CURSOR-APPL-1                      32540299
                                         TO TRUE                        32540399
                       SET PS-ERROR      TO TRUE                        32540499
                   END-IF                                               32540599
               ELSE                                                     32540699
                   MOVE DP010I-NUMERIC-FIELD                            32540799
                                         TO ASC-DEPT-NBR-N              32540899
               END-IF                                                   32540999
           END-IF.                                                      32541099
                                                                        32542099
           IF  ASC-CLASS-NBR > SPACES                                   32543099
               MOVE ASC-CLASS-NBR        TO DP010I-UNEDITED-FIELD       32544099
               MOVE LENGTH OF ASC-CLASS-NBR                             32545099
                                         TO DP010I-MAXIMUM-DIGITS       32546099
               MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     32547099
               SET DP010I-NEGATIVE-NOT-ALLOWED                          32548099
                                         TO TRUE                        32549099
               CALL DP010I-NUMERIC-EDIT-ROUTINE                         32551099
                         USING DP010I-NUMERIC-EDIT-AREA                 32552099
               IF  DP010I-ERROR-DETECTED                                32560099
                   SET DP020-MSG-FATAL   TO TRUE                        32570099
      *            -- MUST BE NUMERIC --                                32580099
                   MOVE DP015-UNP-ALP-BRT-OFF                           32590099
                                         TO ACLASSA                     32600099
                   MOVE DP015-RED        TO ACLASSC                     32610099
                   MOVE DP015-REVERSE    TO ACLASSH                     32620099
                   IF PS-NO-ERROR                                       32630099
                       MOVE PC-TSYMSG-00008 TO DP020-MSG-NUMBER         32640099
                       MOVE -1           TO ACLASSL                     32640199
                       SET DP030-SET-CURSOR-APPL-1                      32640299
                                         TO TRUE                        32640399
                       SET PS-ERROR      TO TRUE                        32640499
                   END-IF                                               32640599
               ELSE                                                     32640699
                   MOVE DP010I-NUMERIC-FIELD                            32640799
                                         TO ASC-CLASS-NBR-N             32640899
               END-IF                                                   32640999
           END-IF.                                                      32641099
                                                                        32642099
           IF  ASC-DEPT-NBR = SPACES                                    32643099
             AND ASC-CLASS-NBR NOT = SPACES                             32643199
               SET DP020-MSG-FATAL   TO TRUE                            32643299
      *        -- DEPARTMENT IS REQUIRED WHEN CLASS IS ENTERED --       32643399
               MOVE DP015-UNP-ALP-BRT-OFF                               32643499
                                     TO ADEPTA                          32643599
               MOVE DP015-RED        TO ADEPTC                          32643699
               MOVE DP015-REVERSE    TO ADEPTH                          32643799
               IF PS-NO-ERROR                                           32643899
                   MOVE PC-TSYMSG-01409 TO DP020-MSG-NUMBER             32643999
                   MOVE -1           TO ADEPTL                          32644099
                   SET DP030-SET-CURSOR-APPL-1                          32644199
                                     TO TRUE                            32644299
                   SET PS-ERROR      TO TRUE                            32644399
               END-IF                                                   32644499
           END-IF.                                                      32644599
                                                                        32644699
           IF  ASC-CALLBACK-NBR > SPACES                                32644799
               MOVE ASC-CALLBACK-NBR     TO DP010I-UNEDITED-FIELD       32644899
               MOVE LENGTH OF ASC-CALLBACK-NBR                          32644999
                                         TO DP010I-MAXIMUM-DIGITS       32645099
               MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     32646099
               SET DP010I-NEGATIVE-NOT-ALLOWED                          32647099
                                         TO TRUE                        32648099
               CALL DP010I-NUMERIC-EDIT-ROUTINE                         32649199
                         USING DP010I-NUMERIC-EDIT-AREA                 32649299
               IF  DP010I-ERROR-DETECTED                                32650099
                   SET DP020-MSG-FATAL   TO TRUE                        32660099
      *            -- MUST BE NUMERIC --                                32670099
                   MOVE DP015-UNP-ALP-BRT-OFF                           32680099
                                         TO ACALLNOA                    32690099
                   MOVE DP015-RED        TO ACALLNOC                    32700099
                   MOVE DP015-REVERSE    TO ACALLNOH                    32710099
                   IF PS-NO-ERROR                                       32720099
                       MOVE PC-TSYMSG-00008 TO DP020-MSG-NUMBER         32730099
                       MOVE -1           TO ACALLNOL                    32730199
                       SET DP030-SET-CURSOR-APPL-1                      32730299
                                         TO TRUE                        32730399
                       SET PS-ERROR      TO TRUE                        32730499
                   END-IF                                               32730599
               ELSE                                                     32730699
                   MOVE DP010I-NUMERIC-FIELD                            32730799
                                         TO ASC-CALLBACK-NBR-N          32730899
               END-IF                                                   32730999
           END-IF.                                                      32731099
                                                                        32732099
           IF  ASC-CALLBACK-NBR NOT = SPACES                            32733099
             AND ASC-XFER-TYPE NOT = PC-CALLBACK-1                      32733199
               SET DP020-MSG-FATAL   TO TRUE                            32733299
      *        -- ONLY ALLOWED FOR TRANSFER TYPE 2 --                   32733399
               MOVE DP015-UNP-ALP-BRT-OFF                               32733499
                                     TO ACALLNOA                        32733599
               MOVE DP015-RED        TO ACALLNOC                        32733699
               MOVE DP015-REVERSE    TO ACALLNOH                        32733799
               IF PS-NO-ERROR                                           32733899
                   MOVE PC-TSYMSG-01407 TO DP020-MSG-NUMBER             32733999
                   MOVE -1           TO ACALLNOL                        32734099
                   SET DP030-SET-CURSOR-APPL-1                          32734199
                                     TO TRUE                            32734299
                   SET PS-ERROR      TO TRUE                            32734399
               END-IF                                                   32734499
           END-IF.                                                      32734599
                                                                        32734699
           IF  ASC-APPROVAL-NBR > SPACES                                32734799
               MOVE ASC-APPROVAL-NBR     TO DP010I-UNEDITED-FIELD       32734899
               MOVE LENGTH OF ASC-APPROVAL-NBR                          32734999
                                         TO DP010I-MAXIMUM-DIGITS       32735099
               MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     32736099
               SET DP010I-NEGATIVE-NOT-ALLOWED                          32737099
                                         TO TRUE                        32738099
               CALL DP010I-NUMERIC-EDIT-ROUTINE                         32739199
                         USING DP010I-NUMERIC-EDIT-AREA                 32739299
               IF  DP010I-ERROR-DETECTED                                32740099
                   SET DP020-MSG-FATAL   TO TRUE                        32750099
      *            -- MUST BE NUMERIC --                                32760099
                   MOVE DP015-UNP-ALP-BRT-OFF                           32770099
                                         TO AAPPRNOA                    32780099
                   MOVE DP015-RED        TO AAPPRNOC                    32790099
                   MOVE DP015-REVERSE    TO AAPPRNOH                    32800099
                   IF PS-NO-ERROR                                       32810099
                       MOVE PC-TSYMSG-00008 TO DP020-MSG-NUMBER         32820099
                       MOVE -1           TO AAPPRNOL                    32820199
                       SET DP030-SET-CURSOR-APPL-1                      32820299
                                         TO TRUE                        32820399
                       SET PS-ERROR      TO TRUE                        32820499
                   END-IF                                               32820599
               ELSE                                                     32820699
                   MOVE DP010I-NUMERIC-FIELD                            32820799
                                         TO ASC-APPROVAL-NBR-N          32820899
               END-IF                                                   32820999
           END-IF.                                                      32821099
                                                                        32822099
           IF  ASC-APPROVAL-NBR NOT = SPACES                            32823099
             AND ASC-XFER-TYPE NOT = PC-STK-BAL-CORP-XFER               32823199
               SET DP020-MSG-FATAL   TO TRUE                            32823299
      *        -- ONLY ALLOWED FOR A TRANSFER TYPE OF STOCK BALANCE-CORP32823399
               MOVE DP015-UNP-ALP-BRT-OFF                               32823499
                                     TO AAPPRNOA                        32823599
               MOVE DP015-RED        TO AAPPRNOC                        32823699
               MOVE DP015-REVERSE    TO AAPPRNOH                        32823799
               IF PS-NO-ERROR                                           32823899
                   MOVE PC-TSYMSG-01408 TO DP020-MSG-NUMBER             32823999
                   MOVE -1           TO AAPPRNOL                        32824099
                   SET DP030-SET-CURSOR-APPL-1                          32824199
                                     TO TRUE                            32824299
                   SET PS-ERROR      TO TRUE                            32824399
               END-IF                                                   32824499
           END-IF.                                                      32824599
                                                                        32824699
           IF  ASC-COMP-BY-FIRST-INIT NOT ALPHABETIC                    32824799
               SET DP020-MSG-FATAL   TO TRUE                            32824899
      *        -- INVALID VALUE --                                      32824999
               MOVE DP015-UNP-ALP-BRT-OFF                               32825099
                                     TO ACMPBYINA                       32826099
               MOVE DP015-RED        TO ACMPBYINC                       32827099
               MOVE DP015-REVERSE    TO ACMPBYINH                       32828099
               IF PS-NO-ERROR                                           32829099
                   MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER             32830099
                   MOVE -1           TO ACMPBYINL                       32830199
                   SET DP030-SET-CURSOR-APPL-1                          32830299
                                     TO TRUE                            32830399
                   SET PS-ERROR      TO TRUE                            32830499
               END-IF                                                   32830599
           END-IF.                                                      32830699
                                                                        32830799
           IF  ASC-COMP-BY-LAST-NAME NOT ALPHABETIC                     32830899
               SET DP020-MSG-FATAL   TO TRUE                            32830999
      *        -- INVALID VALUE --                                      32831099
               MOVE DP015-UNP-ALP-BRT-OFF                               32832099
                                     TO ACMPBYNMA                       32833099
               MOVE DP015-RED        TO ACMPBYNMC                       32834099
               MOVE DP015-REVERSE    TO ACMPBYNMH                       32835099
               IF PS-NO-ERROR                                           32836099
                   MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER             32837099
                   MOVE -1           TO ACMPBYNML                       32837199
                   SET DP030-SET-CURSOR-APPL-1                          32837299
                                     TO TRUE                            32837399
                   SET PS-ERROR      TO TRUE                            32837499
               END-IF                                                   32837599
           END-IF.                                                      32837699
                                                                        32837799
           IF (ASC-COMP-BY-FIRST-INIT NOT = SPACES                      32837899
               AND ASC-COMP-BY-LAST-NAME = SPACES)                      32837999
             OR (ASC-COMP-BY-FIRST-INIT = SPACES                        32838099
                 AND ASC-COMP-BY-LAST-NAME NOT = SPACES)                32838199
               SET DP020-MSG-FATAL   TO TRUE                            32838299
      *        -- FIRST AND LAST NAME REQUIRED --                       32838399
               MOVE DP015-UNP-ALP-BRT-OFF                               32838499
                                     TO ACMPBYINA                       32838599
                                        ACMPBYNMA                       32838699
               MOVE DP015-RED        TO ACMPBYINC                       32838799
                                        ACMPBYNMC                       32838899
               MOVE DP015-REVERSE    TO ACMPBYINH                       32838999
                                        ACMPBYNMH                       32839099
               IF PS-NO-ERROR                                           32840099
                   MOVE PC-TSYMSG-01405 TO DP020-MSG-NUMBER             32850099
                   MOVE -1           TO ACMPBYINL                       32850199
                   SET DP030-SET-CURSOR-APPL-1                          32850299
                                     TO TRUE                            32850399
                   SET PS-ERROR      TO TRUE                            32850499
               END-IF                                                   32850599
           END-IF.                                                      32850699
                                                                        32850799
           IF  PS-NO-SORT-FIELD-ERROR                                   32850899
             AND ASC-SORT-ORDER-FIELDS NOT = SPACES                     32850999
               PERFORM 3010-SORT-FIELDS-CHECK                           32851099
           END-IF.                                                      32852099
                                                                        32853099
           IF  PS-NO-ERROR                                              32854099
             AND ASC-CONTROL-NBR NOT = ASC-HOLD-CONTROL-NBR             32855099
               SET PS-XFER-NBR-CHG   TO TRUE                            32856099
           END-IF.                                                      32857099
                                                                        32858099
           IF  PS-NO-ERROR                                              32859099
             AND (   ASC-XFER-TYPE       NOT = ASC-HOLD-XFER-TYPE       32860099
                  OR ASC-CONTNR-TYPE     NOT = ASC-HOLD-CONTNR-TYPE     32870099
                  OR ASC-TO-STORE        NOT = ASC-HOLD-TO-STORE        32880099
                  OR ASC-DEPT-NBR-N      NOT = ASC-HOLD-DEPT-NBR        32890099
                  OR ASC-CLASS-NBR-N     NOT = ASC-HOLD-CLASS-NBR       32900099
                  OR ASC-CALLBACK-NBR    NOT = ASC-HOLD-CALLBACK-NBR    32910099
                  OR ASC-APPROVAL-NBR    NOT = ASC-HOLD-APPROVAL-NBR    32920099
                  OR ASC-COMP-BY-FIRST-INIT                             32930099
                                      NOT = ASC-HOLD-COMP-BY-FIRST-INIT 32940099
                  OR ASC-COMP-BY-LAST-NAME                              32950099
                                      NOT = ASC-HOLD-COMP-BY-LAST-NAME) 32960099
               SET PS-CRITLIST-INFO-CHG TO TRUE                         32970099
           END-IF.                                                      32980099
                                                                        32990099
           IF  PS-NO-ERROR                                              33000099
               MOVE ASC-CONTROL-NBR  TO ASC-HOLD-CONTROL-NBR            33010099
               MOVE ASC-CONTNR-TYPE  TO ASC-HOLD-CONTNR-TYPE            33020099
               MOVE ASC-XFER-TYPE    TO ASC-HOLD-XFER-TYPE              33030099
               MOVE ASC-TO-STORE     TO ASC-HOLD-TO-STORE               33040099
               MOVE ASC-DEPT-NBR-N   TO ASC-HOLD-DEPT-NBR               33050099
               MOVE ASC-CLASS-NBR-N  TO ASC-HOLD-CLASS-NBR              33060099
               MOVE ASC-CALLBACK-NBR TO ASC-HOLD-CALLBACK-NBR           33070099
               MOVE ASC-APPROVAL-NBR TO ASC-HOLD-APPROVAL-NBR           33080099
               MOVE ASC-COMP-BY-FIRST-INIT                              33090099
                                     TO ASC-HOLD-COMP-BY-FIRST-INIT     33100099
               MOVE ASC-COMP-BY-LAST-NAME                               33110099
                                     TO ASC-HOLD-COMP-BY-LAST-NAME      33120099
               MOVE -1               TO ACTRLNOL                        33130099
               SET DP030-SET-CURSOR-APPL-1                              33140099
                                     TO TRUE                            33150099
           END-IF.                                                      33160099
                                                                        33170099
      ******************************************************************33180099
      **  VERIFY THAT THE SORT NUMBERS ARE IN SEQUENCE WITH NO GAPS.    33190099
      ******************************************************************33200099
       3010-SORT-FIELDS-CHECK.                                          33210099
                                                                        33220099
           IF ASC-XFER-TYPE-SORT-NR NOT = SPACE                         33230099
               MOVE ASC-XFER-TYPE-SORT-NR TO PV-SORT-SUB                33240099
               PERFORM 3011-FILL-SORT-ORDER-FIELD                       33250099
               IF PS-DUPLICATE-SORT-NR                                  33250199
                   SET DP020-MSG-FATAL TO TRUE                          33250299
                   SET PS-SORT-FIELD-ERROR TO TRUE                      33250399
      *            -- DUPLICATE SORT NUMBER NOT ALLOWED --              33250499
                   MOVE DP015-UNP-ALP-BRT-OFF                           33250599
                                     TO ASXFRTYPA                       33250699
                   MOVE DP015-RED    TO ASXFRTYPC                       33250799
                   MOVE DP015-REVERSE TO ASXFRTYPH                      33250899
                   IF PS-NO-ERROR                                       33250999
                       MOVE PC-TSYMSG-01410 TO DP020-MSG-NUMBER         33251099
                       MOVE -1       TO ASXFRTYPL                       33251199
                       SET DP030-SET-CURSOR-APPL-1                      33251299
                                     TO TRUE                            33251399
                       SET PS-ERROR  TO TRUE                            33251499
                   END-IF                                               33251599
               END-IF                                                   33251699
           END-IF.                                                      33251799
                                                                        33251899
           IF ASC-CONTNR-TYPE-SORT-NR NOT = SPACE                       33251999
               MOVE ASC-CONTNR-TYPE-SORT-NR TO PV-SORT-SUB              33252099
               PERFORM 3011-FILL-SORT-ORDER-FIELD                       33253099
               IF PS-DUPLICATE-SORT-NR                                  33253199
                   SET DP020-MSG-FATAL TO TRUE                          33253299
                   SET PS-SORT-FIELD-ERROR TO TRUE                      33253399
      *            -- DUPLICATE SORT NUMBER NOT ALLOWED --              33253499
                   MOVE DP015-UNP-ALP-BRT-OFF                           33253599
                                     TO ASCONTYPA                       33253699
                   MOVE DP015-RED    TO ASCONTYPC                       33253799
                   MOVE DP015-REVERSE TO ASCONTYPH                      33253899
                   IF PS-NO-ERROR                                       33253999
                       MOVE PC-TSYMSG-01410 TO DP020-MSG-NUMBER         33254099
                       MOVE -1       TO ASCONTYPL                       33254199
                       SET DP030-SET-CURSOR-APPL-1                      33254299
                                     TO TRUE                            33254399
                       SET PS-ERROR  TO TRUE                            33254499
                   END-IF                                               33254599
               END-IF                                                   33254699
           END-IF.                                                      33254799
                                                                        33254899
           IF ASC-TO-STORE-SORT-NR NOT = SPACE                          33254999
               MOVE ASC-TO-STORE-SORT-NR TO PV-SORT-SUB                 33255099
               PERFORM 3011-FILL-SORT-ORDER-FIELD                       33256099
               IF PS-DUPLICATE-SORT-NR                                  33256199
                   SET DP020-MSG-FATAL TO TRUE                          33256299
                   SET PS-SORT-FIELD-ERROR TO TRUE                      33256399
      *            -- DUPLICATE SORT NUMBER NOT ALLOWED --              33256499
                   MOVE DP015-UNP-ALP-BRT-OFF                           33256599
                                     TO ASTOSTORA                       33256699
                   MOVE DP015-RED    TO ASTOSTORC                       33256799
                   MOVE DP015-REVERSE TO ASTOSTORH                      33256899
                   IF PS-NO-ERROR                                       33256999
                       MOVE PC-TSYMSG-01410 TO DP020-MSG-NUMBER         33257099
                       MOVE -1       TO ASTOSTORL                       33257199
                       SET DP030-SET-CURSOR-APPL-1                      33257299
                                     TO TRUE                            33257399
                       SET PS-ERROR  TO TRUE                            33257499
                   END-IF                                               33257599
               END-IF                                                   33257699
           END-IF.                                                      33257799
                                                                        33257899
           PERFORM 3012-CHECK-SORT-SEQ-ORDER                            33257999
               VARYING PV-SORT-TBL-SUB                                  33258099
               FROM 1 BY 1                                              33259099
               UNTIL PV-SORT-TBL-SUB > PV-MAX-SORT-SUB.                 33260099
                                                                        33270099
           IF PS-SORT-SEQ-ERROR                                         33270199
               SET DP020-MSG-FATAL TO TRUE                              33270299
      *        -- SORT NUMBERS MUST BE IN SEQUENCE --                   33270399
               IF PS-NO-ERROR                                           33270499
                   MOVE PC-TSYMSG-01411 TO DP020-MSG-NUMBER             33270599
                   SET PS-ERROR         TO TRUE                         33270699
               END-IF                                                   33270799
           END-IF.                                                      33270899
                                                                        33270999
      ******************************************************************33271099
      **  FILL THE SORT ORDER TABLE FIELD.                              33272099
      ******************************************************************33273099
       3011-FILL-SORT-ORDER-FIELD.                                      33274099
                                                                        33275099
           IF SORT-ORDER-FIELD (PV-SORT-SUB) = ZERO                     33276099
               MOVE PV-SORT-SUB      TO SORT-ORDER-FIELD (PV-SORT-SUB)  33277099
           ELSE                                                         33278099
               SET PS-DUPLICATE-SORT-NR TO TRUE                         33279099
           END-IF.                                                      33280099
                                                                        33290099
           IF PV-SORT-SUB > PV-MAX-SORT-SUB                             33300099
               MOVE PV-SORT-SUB      TO PV-MAX-SORT-SUB                 33310099
           END-IF.                                                      33320099
                                                                        33330099
      ******************************************************************33340099
      **  VERIFY THAT THERE ARE NO SEQUENCE NUMBER GAPS IN THE SORT     33350099
      **  ORDER TABLE.                                                  33360099
      ******************************************************************33370099
       3012-CHECK-SORT-SEQ-ORDER.                                       33380099
                                                                        33390099
           IF SORT-ORDER-FIELD (PV-SORT-TBL-SUB) = ZERO                 33400099
               SET PS-SORT-SEQ-ERROR TO TRUE                            33410099
           END-IF.                                                      33420099
                                                                        33420199
      ******************************************************************33420299
      ** EDIT ALL OF THE DATA ON THE SCREEN AS IT RESIDES IN THE      **33420399
      ** COMMAREA (EDITTING IS NOT DONE AGAINST THE SCREEN DIRECTLY). **33420499
      ******************************************************************33420599
       3100-EDIT-DATA-IN-COMMAREA.                                      33420699
051705     SET ASC-OK-TO-SHIP            TO TRUE.                       33420799
           SET PS-NO-ERROR               TO TRUE.                       33420899
           PERFORM 3300-EDIT-HEADER-INFO.                               33420999
           IF ASC-CMPLT-XFER-TYPE NOT = PC-NON-RETAIL                   33421099
               PERFORM 3400-EDIT-RTL-DETAIL-INFO                        33422099
                 VARYING PW-ITEM-SUB                                    38341499
                   FROM 1 BY 1                                          38341599
                   UNTIL PW-ITEM-SUB >   PC-MAX-RETAIL-ITEMS            38341699
           ELSE                                                         38341799
               PERFORM 3450-EDIT-NRTL-DETAIL-INFO                       38341899
                 VARYING PW-ITEM-SUB                                    38341999
                   FROM 1 BY 1                                          38342099
                   UNTIL PW-ITEM-SUB >   PC-MAX-NON-RETAIL-ITEMS        38342199
           END-IF.                                                      38342299
      ******************************************************************38343799
      **  MAKE ALL FIELDS UNPROTECTED, UNDERLINED, AND GREEN.           38343899
      ******************************************************************38343999
       3200-RESET-ATTRIBUTES.                                           38344099
                                                                        38345099
           MOVE DP015-UNP-ALP-NOR-OFF  TO ACTRLNOA                      38346099
                                          ASXFRTYPA                     38347099
                                          ASCONTYPA                     38348099
                                          AXFRTYPA                      38349099
                                          ACONTYPA                      38350099
                                          ASTOSTORA                     38360099
                                          ATOSTORA                      38370099
                                          ADEPTA                        38380099
                                          ACLASSA                       38390099
                                          ACALLNOA                      38400099
                                          AAPPRNOA                      38410099
                                          ACMPBYINA                     38420099
                                          ACMPBYNMA.                    38430099
           MOVE DP015-GREEN            TO ACTRLNOC                      38440099
                                          ASXFRTYPC                     38450099
                                          ASCONTYPC                     38460099
                                          AXFRTYPC                      38470099
                                          ACONTYPC                      38480099
                                          ASTOSTORC                     38490099
                                          ATOSTORC                      38500099
                                          ADEPTC                        38510099
                                          ACLASSC                       38520099
                                          ACALLNOC                      38530099
                                          AAPPRNOC                      38540099
                                          ACMPBYINC                     38550099
                                          ACMPBYNMC.                    38560099
           MOVE DP015-UNDERLINE        TO ACTRLNOH                      38570099
                                          ASXFRTYPH                     38580099
                                          ASCONTYPH                     38590099
                                          AXFRTYPH                      38600099
                                          ACONTYPH                      38610099
                                          ASTOSTORH                     38620099
                                          ATOSTORH                      38630099
                                          ADEPTH                        38640099
                                          ACLASSH                       38650099
                                          ACALLNOH                      38660099
                                          AAPPRNOH                      38670099
                                          ACMPBYINH                     38680099
                                          ACMPBYNMH.                    38680199
      ******************************************************************38680299
      ** EDIT THE HEADING INFORMATION.                                **38680399
      ******************************************************************38680499
       3300-EDIT-HEADER-INFO.                                           38680599
           IF PW-TO-STORE      NOT > SPACES                             38680699
               IF PS-NO-ERROR                                           38680799
                   SET PS-ERROR           TO TRUE                       38680899
               END-IF                                                   38680999
           ELSE                                                         38681099
               IF PW-TO-STORE      = ASC-FROM-STORE                     38681199
                   IF PS-NO-ERROR                                       38681299
                      SET  PS-ERROR           TO TRUE                   38681399
                   END-IF                                               38681499
               ELSE                                                     38681599
                   MOVE PW-TO-STORE-N         TO DK-STORE-NBR           38681699
                   SET PS-STORE-NOT-FOUND     TO TRUE                   38681799
                   PERFORM 4500-READ-STORE                              38681899
                   IF PS-STORE-NOT-FOUND                                38681999
                       IF PS-NO-ERROR                                   38682099
                           SET PS-ERROR           TO TRUE               38682199
                       END-IF                                           38682299
                   ELSE                                                 38682399
                     EVALUATE ASC-CMPLT-XFER-TYPE                       38682499
111703*                WHEN PC-DEFECTIVE-DAMAGE                         38682599
111703                 WHEN PC-DEFECTIVE-DAMAGE-SORT1                   38682699
111703                 WHEN PC-DEFECTIVE-DAMAGE-SORT2                   38682799
                       WHEN PC-CALLBACK                                 38682899
                         IF PW-TO-STORE-TYPE NOT = PC-RTV-TYPE          38682999
                           IF PS-NO-ERROR                               38683099
                               SET PS-ERROR           TO TRUE           38683199
                           END-IF                                       38683299
                         END-IF                                         38683399
                       WHEN PC-NON-RETAIL                               38683499
                         IF PW-TO-STORE-TYPE NOT = PC-STORE-TYPE  AND   38683599
                            PW-TO-STORE-TYPE NOT = PC-DC                38683699
                           IF PS-NO-ERROR                               38683799
                               SET PS-ERROR           TO TRUE           38683899
                           END-IF                                       38683999
                         END-IF                                         38684099
                       WHEN OTHER                                       38684199
                         IF PW-TO-STORE-TYPE NOT = PC-STORE-TYPE        38684299
                           IF PS-NO-ERROR                               38684399
                               SET PS-ERROR           TO TRUE           38684499
                           END-IF                                       38684599
                         END-IF                                         38684699
                     END-EVALUATE                                       38684799
                   END-IF                                               38684899
               END-IF                                                   38684999
           END-IF.                                                      38685099
           EVALUATE ASC-CMPLT-XFER-TYPE                                 38685199
111703*        WHEN PC-DEFECTIVE-DAMAGE                                 38685299
111703         WHEN PC-DEFECTIVE-DAMAGE-SORT1                           38685399
111703         WHEN PC-DEFECTIVE-DAMAGE-SORT2                           38685499
               WHEN PC-STOCK-BAL-STORE                                  38685599
                   PERFORM 3310-EDIT-DEF-DAMAGE                         38685699
               WHEN PC-CALLBACK                                         38685799
                   PERFORM 3320-EDIT-CALLBACK                           38685899
               WHEN PC-STOCK-BAL-CORP                                   38685999
                   PERFORM 3330-EDIT-STOCK-BAL-CORP                     38686099
               WHEN PC-CUSTOMER                                         38686199
                   PERFORM 3340-EDIT-CUSTOMER                           38686299
               WHEN PC-NON-RETAIL                                       38686399
                   PERFORM 3350-EDIT-NON-RETAIL                         38686499
           END-EVALUATE.                                                38686599
           EVALUATE PW-CONTNR-TYPE                                      38686699
               WHEN PC-TRAILER                                          38686799
                   PERFORM 3360-EDIT-TRAILER                            38686899
               WHEN PC-SECURE-TOTE                                      38686999
                   PERFORM 3370-EDIT-TOTE                               38687099
           END-EVALUATE.                                                38687199
                                                                        38687299
      ******************************************************************38687399
      ** EDIT THE HEADING INFO FOR DEFECTIVE/DAMAGE OR STOCK BAL-STORE *38687499
      ******************************************************************38687599
       3310-EDIT-DEF-DAMAGE.                                            38687699
           IF PW-COMP-BY-INT NOT > SPACES                               38687799
               IF PS-NO-ERROR                                           38687899
                   SET PS-ERROR           TO TRUE                       38687999
               END-IF                                                   38688099
           END-IF                                                       38688199
           IF PW-COMP-BY-NAM NOT > SPACES                               38688299
               IF PS-NO-ERROR                                           38688399
                   SET PS-ERROR           TO TRUE                       38688499
               END-IF                                                   38688599
           END-IF.                                                      38688699
      ******************************************************************38688799
      ** EDIT THE HEADING INFO FOR CALLBACK TRANSFERS.                **38688899
      ******************************************************************38688999
       3320-EDIT-CALLBACK.                                              38689099
           IF PW-COMP-BY-INT NOT > SPACES                               38689199
               IF PS-NO-ERROR                                           38689299
                   SET PS-ERROR           TO TRUE                       38689399
               END-IF                                                   38689499
           END-IF                                                       38689599
           IF PW-COMP-BY-NAM NOT > SPACES                               38689699
               IF PS-NO-ERROR                                           38689799
                   SET PS-ERROR           TO TRUE                       38689899
               END-IF                                                   38689999
           END-IF                                                       38690099
           IF PW-CALLBACK-NBR NOT > ZEROES                              38690199
               IF PS-NO-ERROR                                           38690299
                   SET PS-ERROR           TO TRUE                       38690399
               END-IF                                                   38690499
           END-IF.                                                      38690599
      ******************************************************************38690699
      ** EDIT THE HEADING INFO FOR STOCK BALANCE - CORP TRANSFERS.    **38690799
      ******************************************************************38690899
       3330-EDIT-STOCK-BAL-CORP.                                        38690999
           IF PW-COMP-BY-INT NOT > SPACES                               38691099
               IF PS-NO-ERROR                                           38691199
                   SET PS-ERROR           TO TRUE                       38691299
               END-IF                                                   38691399
           END-IF                                                       38691499
           IF PW-COMP-BY-NAM NOT > SPACES                               38691599
               IF PS-NO-ERROR                                           38691699
                   SET PS-ERROR           TO TRUE                       38691799
               END-IF                                                   38691899
           END-IF                                                       38691999
           IF PW-APPROVAL-NBR NOT > ZEROES                              38692099
               IF PS-NO-ERROR                                           38692199
                   SET PS-ERROR           TO TRUE                       38692299
               END-IF                                                   38692399
           END-IF.                                                      38692499
      ******************************************************************38692599
      ** EDIT THE HEADING INFO FOR CUSTOMER TRANSFERS.                **38692699
      ******************************************************************38692799
       3340-EDIT-CUSTOMER.                                              38692899
           IF PW-COMP-BY-INT NOT > SPACES                               38692999
               IF PS-NO-ERROR                                           38693099
                   SET PS-ERROR           TO TRUE                       38693199
               END-IF                                                   38693299
           END-IF                                                       38693399
           IF PW-COMP-BY-NAM NOT > SPACES                               38693499
               IF PS-NO-ERROR                                           38693599
                   SET PS-ERROR           TO TRUE                       38693699
               END-IF                                                   38693799
           END-IF                                                       38693899
           IF PW-REQ-BY-INT NOT > SPACES                                38693999
               IF PS-NO-ERROR                                           38694099
                   SET PS-ERROR           TO TRUE                       38694199
               END-IF                                                   38694299
           END-IF                                                       38694399
           IF PW-REQ-BY-NAM NOT > SPACES                                38694499
               IF PS-NO-ERROR                                           38694599
                   SET PS-ERROR           TO TRUE                       38694699
               END-IF                                                   38694799
           END-IF                                                       38694899
           IF PW-CUST-NAME NOT > SPACES                                 38694999
               IF PS-NO-ERROR                                           38695099
                   SET PS-ERROR           TO TRUE                       38695199
               END-IF                                                   38695299
           END-IF.                                                      38695399
           IF PW-PHONE-NBR NOT > SPACES                                 38695499
               IF PS-NO-ERROR                                           38695599
                   SET PS-ERROR           TO TRUE                       38695699
               END-IF                                                   38695799
           END-IF.                                                      38695899
      ******************************************************************38695999
      ** EDIT THE HEADING INFO FOR NON-RETAIL TRANSFERS.              **38696099
      ******************************************************************38696199
       3350-EDIT-NON-RETAIL.                                            38696299
           IF PW-COMP-BY-INT NOT > SPACES                               38696399
               IF PS-NO-ERROR                                           38696499
                   SET PS-ERROR           TO TRUE                       38696599
               END-IF                                                   38696699
           END-IF                                                       38696799
           IF PW-COMP-BY-NAM NOT > SPACES                               38696899
               IF PS-NO-ERROR                                           38696999
                   SET PS-ERROR           TO TRUE                       38697099
               END-IF                                                   38697199
           END-IF                                                       38697299
           IF PW-REQ-BY-INT NOT > SPACES                                38697399
               IF PS-NO-ERROR                                           38697499
                   SET PS-ERROR           TO TRUE                       38697599
               END-IF                                                   38697699
           END-IF                                                       38697799
           IF PW-REQ-BY-NAM NOT > SPACES                                38697899
               IF PS-NO-ERROR                                           38697999
                   SET PS-ERROR           TO TRUE                       38698099
               END-IF                                                   38698199
           END-IF.                                                      38698299
      ******************************************************************38698399
      ** EDIT THE TRAILER INFORMATION.                                **38698499
      ******************************************************************38698599
       3360-EDIT-TRAILER.                                               38698699
           IF PW-TRAILER-SEAL NOT > SPACES                              38698799
               IF PS-NO-ERROR                                           38698899
                   SET PS-ERROR           TO TRUE                       38698999
               END-IF                                                   38699099
           END-IF.                                                      38699199
           IF PW-TRAILER-NBR NOT > SPACES                               38699299
               IF PS-NO-ERROR                                           38699399
                   SET PS-ERROR           TO TRUE                       38699499
               END-IF                                                   38699599
           END-IF.                                                      38699699
      ******************************************************************38699799
      ** EDIT THE TOTE INFORMATION - ONLY REQUIRED FOR SECURE TOTES.  **38699899
      ******************************************************************38699999
       3370-EDIT-TOTE.                                                  38700099
           IF PW-LG-TOTE-SEAL1 NOT > SPACES                             38700199
               IF PS-NO-ERROR                                           38700299
                   SET PS-ERROR           TO TRUE                       38700399
               END-IF                                                   38700499
           END-IF.                                                      38700599
           IF PW-LG-TOTE-SEAL2 NOT > SPACES                             38700699
               IF PS-NO-ERROR                                           38700799
                   SET PS-ERROR           TO TRUE                       38700899
               END-IF                                                   38700999
           END-IF.                                                      38701099
      *                                                                 38950499
      ******************************************************************38950599
      ** EDIT THE RETAIL TRANSFER DETAIL INFORMATION.                 **38950699
      ******************************************************************38950799
       3400-EDIT-RTL-DETAIL-INFO.                                       38950899
           SET PS-INVALID-UPC               TO TRUE                     38951199
           IF ASC-UPC (PW-ITEM-SUB) > ZEROES                            38953299
               MOVE ASC-UPC (PW-ITEM-SUB)   TO DK-UPC-NBR               38953399
               PERFORM 3700-SELECT-UPC-NBR                              38953499
               IF PS-INVALID-UPC                                        38953599
                   IF PS-NO-ERROR                                       38953699
                       SET PS-ERROR         TO TRUE                     38953799
                   END-IF                                               38953899
               END-IF                                                   38953999
           END-IF.                                                      38954099
      *- IF A QTY OR PRICE IS ENTERED, THEN A UPC MUST BE ENTERED       38955499
           IF (ASC-RTL-QTY      (PW-ITEM-SUB) > SPACES            OR    38955599
               ASC-PRICE (PW-ITEM-SUB) > SPACES)                        38955699
               IF  ASC-UPC (PW-ITEM-SUB) = ZEROES                       38955899
      *            -- MUST ENTER UPC --                                 38955999
                   IF PS-NO-ERROR                                       38956099
                       SET PS-ERROR           TO TRUE                   38956199
                   END-IF                                               38956299
              END-IF                                                    38956399
           END-IF.                                                      38956499
           IF ASC-PRICE (PW-ITEM-SUB) > SPACES                          38956599
               IF (PS-VALID-UPC)                                        38956699
                   PERFORM 4600-VALIDATE-PRICE                          38956799
               END-IF                                                   38956899
           END-IF.                                                      38957999
           IF ASC-RTL-QTY (PW-ITEM-SUB) NOT > ZEROES                    38958099
               IF (ASC-UPC   (PW-ITEM-SUB) > ZEROES               OR    38958299
                   ASC-PRICE (PW-ITEM-SUB) > SPACES)                    38958399
      *            -- REQUIRED FIELD --                                 38958499
                   IF PS-NO-ERROR                                       38958599
                       SET PS-ERROR           TO TRUE                   38958699
                   END-IF                                               38958799
               END-IF                                                   38958899
           END-IF.                                                      38958999
      ******************************************************************38959099
      ** EDIT THE NON-RETAIL TRANSFER DETAIL INFORMATION.             **38959199
      ******************************************************************38959299
       3450-EDIT-NRTL-DETAIL-INFO.                                      38959399
      *- IF DEPT OR QTY OR FIXTURE WAS ENTERED, DESCRIPTION IS REQUIRED 38959499
           IF (ASC-NRTL-DEPT (PW-ITEM-SUB) > SPACES OR                  38959599
               ASC-NRTL-QTY (PW-ITEM-SUB) > SPACES               OR     38959699
               ASC-FIXTURE (PW-ITEM-SUB) > SPACES)                      38959799
               IF ASC-ITEM-DESC (PW-ITEM-SUB) NOT > SPACES              38959899
      *            -- REQUIRED FIELD --                                 38959999
                   IF PS-NO-ERROR                                       38960099
                       SET PS-ERROR           TO TRUE                   38960199
                   END-IF                                               38960299
               END-IF                                                   38960399
           END-IF.                                                      38960499
           IF ASC-NRTL-QTY (PW-ITEM-SUB) NOT > ZEROES                   38960599
      *- IF DEPT OR DESCRIPTION OR FIXTURE WAS ENTERED, QTY IS REQUIRED 38960699
               IF (ASC-NRTL-DEPT (PW-ITEM-SUB) > SPACES OR              38960799
                   ASC-ITEM-DESC (PW-ITEM-SUB) > SPACES OR              38960899
                   ASC-FIXTURE (PW-ITEM-SUB) > SPACES)                  38960999
      *            -- REQUIRED FIELD --                                 38961099
                   IF PS-NO-ERROR                                       38961199
                       SET PS-ERROR           TO TRUE                   38961299
                   END-IF                                               38961399
               END-IF                                                   38961499
           END-IF.                                                      38961599
      *----------------------------------------------------------------*41410399
      *    READ XST_UPC AND XST_SKU_LOC USING THE ENTERED UPC NUMBER   *41410499
      *----------------------------------------------------------------*41410699
       3700-SELECT-UPC-NBR.                                             41410799
100404     INITIALIZE DCLXST00008.                                      41410899
100404     INITIALIZE DCLXST00010.                                      41410999
           PERFORM                                                      41411199
             WITH TEST AFTER                                            41411299
               VARYING PV-RETRY-COUNT FROM 1 BY 1                       41411399
                 UNTIL PV-RETRY-COUNT > PC-MAX-RETRIES                  41411499
                    OR SQLCODE = ZERO                                   41411599
                    OR SQLCODE = +100                                   41411699
               EXEC SQL                                                 41411799
100404             SELECT B.UNT_RTL_AMT                                 41411999
100404                   ,B.UPC_STAT_CHG_DTE                            41412099
100404                   ,B.UNT_RTL_CHG_DTE                             41412199
100404                   ,B.LOC_SKU_STAT_CDE                            41412299
100404                   ,C.ITM_NBR                                     41412399
100404                   ,B.GP_RTL_AMT                                  41412499
100404                   ,B.GP_RTL_QTY                                  41412599
100404                   ,D.REGN_PRIC_IND                               41412699
100404                   ,B.INTR_UPC_ID                                 41412799
100404               INTO :XST00008-UNT-RTL-AMT                         41412899
100404                   ,:PV-NREGN-UPC-STAT-CHG-DTE                    41412999
100404                   ,:PV-NREGN-UNT-RTL-CHG-DTE                     41413099
100404                   ,:PV-NREGN-LOC-SKU-STAT-CDE                    41413199
100404                   ,:SKXREF-ITM-NBR                               41413299
100404                   ,:XST00008-GP-RTL-AMT                          41413399
100404                    :PV-GP-RTL-AMT-NULL-IND                       41413499
100404                   ,:XST00008-GP-RTL-QTY                          41413599
100404                    :PV-GP-RTL-QTY-NULL-IND                       41413699
100404                   ,:XST00010-REGN-PRIC-IND                       41413799
100404                   ,:XST00008-INTR-UPC-ID                         41413899
100404                FROM XST_UPC     A                                41413999
100404                    ,XST_SKU_LOC B                                41414099
100404                    ,TSKXREF     C                                41414199
100404                    ,XST_SKU     D                                41414299
100404          WHERE  (A.UPC_NBR               =  :DK-UPC-NBR   AND    41414399
100404                  A.LAST_ACTN_CDE        IN ('A', 'U')     AND    41414499
100404                  A.INTR_UPC_ID           = B.INTR_UPC_ID  AND    41414599
100404                  B.LOC_NBR               = 0              AND    41414699
100404                  B.END_TMST             IS NULL           AND    41414799
100404                  B.LOC_SKU_STAT_CDE NOT IN ('98')         AND    41414899
100404                  B.INTR_UPC_ID           = C.INTR_UPC_ID  AND    41414999
100404                  C.SKU_STAT_CDE     NOT IN ('98')         AND    41415099
100404                  A.INTR_UPC_ID           = D.INTR_UPC_ID)        41415199
               END-EXEC                                                 41415299
                                                                        41416099
               EVALUATE TRUE                                            41418599
                   WHEN SQLCODE = ZERO                                  41418699
                       SET PS-VALID-UPC          TO TRUE                41418799
100404                 MOVE SKXREF-ITM-NBR       TO ASC-ITEM-NBR        41418899
                                        (PW-ITEM-SUB)                   41418999
100404                 MOVE XST00008-UNT-RTL-AMT  TO PV-CUR-RTL-AMT     41419099
100404                 IF PV-GP-RTL-QTY-NULL-IND < 0                    41419199
100404                     MOVE ZEROS TO XST00008-GP-RTL-QTY            41419299
100404                 END-IF                                           41419399
100404                 IF PV-GP-RTL-AMT-NULL-IND < 0                    41419499
100404                     MOVE ZEROS TO XST00008-GP-RTL-AMT            41419599
100404                 END-IF                                           41419699
100404                 MOVE XST00008-GP-RTL-AMT   TO PV-GP-RTL-AMT      41419799
100404                 MOVE XST00008-GP-RTL-QTY   TO PV-GP-QTY          41419899
100404                 IF XST00010-REGN-PRIC-IND = PC-YES               41419999
                           EVALUATE ASC-CMPLT-XFER-TYPE                 41420199
111703*                        WHEN  PC-DEFECTIVE-DAMAGE                41420299
111703                         WHEN  PC-DEFECTIVE-DAMAGE-SORT1          41420399
111703                         WHEN  PC-DEFECTIVE-DAMAGE-SORT2          41420499
                               WHEN  PC-CALLBACK                        41420599
                                  MOVE ASC-FROM-STORE TO DK-STORE-NBR   41420699
                                  PERFORM 7800-CHECK-REGN-PRC           41420799
                               WHEN  PC-STOCK-BAL-CORP                  41420899
                               WHEN  PC-STOCK-BAL-STORE                 41420999
                               WHEN  PC-CUSTOMER                        41421099
                                  MOVE ASC-TO-STORE     TO DK-STORE-NBR 41421199
                                  PERFORM 7800-CHECK-REGN-PRC           41422099
                           END-EVALUATE                                 41422999
                       END-IF                                           41423099
                       MOVE PV-CUR-RTL-AMT TO ASC-FILE-PRICE            41423199
                                          (PW-ITEM-SUB)                 41423299
                       IF PV-GP-QTY > +1                                41423399
                           COMPUTE PV-CUR-RTL-AMT =                     41423499
                                        PV-GP-RTL-AMT / PV-GP-QTY       41423599
                           SET ASC-GROUP-PRICED-ITEM (PW-ITEM-SUB)      41423699
                                                 TO TRUE                41423799
                       ELSE                                             41423899
                           SET ASC-NOT-GROUP-PRICED-ITEM (PW-ITEM-SUB)  41423999
                                                 TO TRUE                41424099
                       END-IF                                           41424199
                   WHEN SQLCODE = +100                                  41424299
                       SET PS-INVALID-UPC          TO TRUE              41424399
                   WHEN SQLCODE = -904                                  41500299
                   WHEN SQLCODE = -913                                  41500399
                       CONTINUE                                         41500499
                   WHEN OTHER                                           41500799
                       MOVE '3700-SELECT-UPC-NBR'                       41501099
                                           TO DP013-PARAGRAPH           41501199
100404                 MOVE 'READ A ROW FROM XST_SKU_LOC'               41501299
                                           TO DP013-MESSAGE-TEXT (1)    41501399
                       MOVE SQLCA          TO DP013-SQLCA               41501499
100404                 MOVE 'XST_UPC'      TO DP013-DB2-TABLE-NAME (1)  41501599
100404                 MOVE 'XST_SKU_LOC'  TO DP013-DB2-TABLE-NAME (2)  41501699
                       SET DP013-DB2-ABEND TO TRUE                      41501799
                       PERFORM DP013-0000-PROCESS-ABEND                 41501899
               END-EVALUATE                                             41501999
           END-PERFORM.                                                 41502099
                                                                        41502199
           IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          41502299
               MOVE '3700-SELECT-UPC-NBR'  TO DP013-PARAGRAPH           41502399
               MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT '    41502499
                                           TO DP013-MESSAGE-TEXT (1)    41502599
100404         MOVE 'DATA FROM XST_SKU_LOC'                             41502699
                                           TO DP013-MESSAGE-TEXT (2)    41502799
               MOVE SQLCA                  TO DP013-SQLCA               41502899
100404         MOVE 'XST_UPC'              TO DP013-DB2-TABLE-NAME (1)  41502999
100404         MOVE 'XST_SKU_LOC'          TO DP013-DB2-TABLE-NAME (2)  41503099
               SET DP013-DB2-ABEND         TO TRUE                      41503199
               PERFORM DP013-0000-PROCESS-ABEND                         41503299
           END-IF.                                                      41503399
           IF PS-VALID-UPC                                              41503499
               PERFORM 3800-SELECT-KOHLS-INTERNAL-UPC                   41503599
               IF PS-INVALID-CHECK-DIGIT                                41503699
                   SET PS-INVALID-UPC      TO TRUE                      41503799
               END-IF                                                   41503899
           END-IF.                                                      41503999
                                                                        41504099
      ******************************************************************41504199
      *  GENERATE THE KOHL'S INTERNAL UPC NUMBER                        41504299
      ******************************************************************41504399
       3800-SELECT-KOHLS-INTERNAL-UPC.                                  41504499
           SET PS-VALID-CHECK-DIGIT        TO TRUE.                     41504599
           EXEC SQL                                                     41504699
100404         SELECT UPC_NBR                                           41504799
100404           INTO :XST00012-UPC-NBR                                 41504899
100404           FROM XST_UPC                                           41504999
100404          WHERE UPC_ID     =  :XST00008-INTR-UPC-ID               41505099
100404            AND LAST_ACTN_CDE IN ('A', 'U')                       41505199
           END-EXEC.                                                    41505799
                                                                        41505899
           EVALUATE TRUE                                                41505999
               WHEN SQLCODE = ZERO                                      41506099
100404             MOVE XST00012-UPC-NBR TO DK-UPC-NBR                  41506199
                                            ASC-KOHLS-UPC (PW-ITEM-SUB) 41506299
               WHEN SQLCODE = +100                                      41506399
                   SET PS-INVALID-CHECK-DIGIT  TO TRUE                  41506499
               WHEN OTHER                                               41506599
                   MOVE '3800-SELECT-KOHLS-INTERNAL-UPC'                41506699
                                       TO DP013-PARAGRAPH               41506799
                   MOVE 'SELECT-KOHLS-INTERNAL-UPC'                     41506899
                                       TO DP013-MESSAGE-TEXT (1)        41506999
                   MOVE SQLCA              TO DP013-SQLCA               41507099
100404             MOVE 'XST_SKU_LOC'      TO DP013-DB2-TABLE-NAME (1)  41507199
                   SET DP013-DB2-ABEND TO TRUE                          41507399
                   PERFORM DP013-0000-PROCESS-ABEND                     41507499
           END-EVALUATE.                                                41508299
      *                                                                 41508899
       EJECT                                                            41509099
                                                                        41546099
      ******************************************************************41547099
      *  POSITION THE CURSOR AT THE APPROPRIATE FIELD.                 *41548099
      *  IF THERE IS ANY DATA TO MOVE TO THE SCREEN ON INITIAL, MOVE   *41549099
      *  IT HERE.                                                      *41550099
      ******************************************************************41560099
                                                                        41570099
       4000-BUILD-INITIAL-PANEL.                                        41580099
                                                                        41590099
           MOVE ZERO                   TO ASC-TYPE-TBL-SUB.             41600099
                                                                        41610099
           PERFORM 4010-OPEN-XFER-TYPE-CURSOR.                          41620099
                                                                        41630099
           PERFORM 4020-READ-TRANSFER-TYPES.                            41640099
                                                                        41650099
           PERFORM 4030-CLOSE-XFER-TYPE-CURSOR.                         41660099
                                                                        41670099
           ADD +1                      TO ASC-TYPE-TBL-SUB              41680099
           MOVE SPACES                 TO ASC-XFER-TY-ST-FIELD          41690099
                                                (ASC-TYPE-TBL-SUB)      41700099
           ADD +1                      TO ASC-TYPE-TBL-SUB              41710099
           MOVE '  CONTAINER TYPE'     TO ASC-XFER-TY-ST-FIELD          41720099
                                                (ASC-TYPE-TBL-SUB)      41730099
                                                                        41740099
           PERFORM 4110-OPEN-CONTNR-TYPE-CURSOR.                        41750099
                                                                        41760099
           PERFORM 4120-READ-CONTAINER-TYPES.                           41770099
                                                                        41780099
           PERFORM 4130-CLOSE-CONTNR-TYPE-CURSOR.                       41790099
                                                                        41800099
           MOVE -1                     TO ACTRLNOL.                     41810099
           SET DP030-SET-CURSOR-APPL-1 TO TRUE.                         41820099
           PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        41830099
                                                                        41840099
       EJECT                                                            41850099
      *----------------------------------------------------------------*41860099
      * OPENS THE TRANSFER TYPE CURSOR                                 *41870099
      *----------------------------------------------------------------*41880099
                                                                        41890099
       4010-OPEN-XFER-TYPE-CURSOR.                                      41900099
                                                                        41910099
           EXEC SQL                                                     41920099
               OPEN XFER-TYPE-CSR                                       41930099
           END-EXEC.                                                    41940099
                                                                        41950099
           EVALUATE TRUE                                                41960099
               WHEN SQLCODE = +0                                        41970099
                   CONTINUE                                             41980099
               WHEN OTHER                                               41990099
                    MOVE '4010-OPEN-XFER-TYPE-CURSOR'                   42000099
                                     TO DP013-PARAGRAPH                 42010099
                    MOVE 'OPEN XFER-TYPE-CSR CURSOR'                    42020099
                                     TO DP013-MESSAGE-TEXT (1)          42030099
                    MOVE SQLCA           TO DP013-SQLCA                 42040099
                    SET DP013-DB2-ABEND                                 42050099
                                     TO TRUE                            42060099
                    PERFORM DP013-0000-PROCESS-ABEND                    42070099
           END-EVALUATE.                                                42080099
                                                                        42090099
       EJECT                                                            42100099
      *----------------------------------------------------------------*42110099
      *    READ THE TRANSFER TYPES AND DESCRIPTIONS AND PROCESS THEM   *42120099
      *----------------------------------------------------------------*42130099
                                                                        42140099
       4020-READ-TRANSFER-TYPES.                                        42150099
                                                                        42160099
           SET PS-ITEMS-LEFT-ON-DB       TO TRUE.                       42170099
           PERFORM                                                      42180099
               VARYING PV-READ-COUNT                                    42190099
               FROM 1 BY 1                                              42200099
               UNTIL ((PV-READ-COUNT > PC-MAX-TYPES)                    42210099
                  OR (PS-NO-ITEMS-LEFT-ON-DB))                          42220099
                                                                        42230099
               PERFORM 4025-FETCH-TRANSFER-TYPE                         42240099
                                                                        42250099
               IF  PS-ITEMS-LEFT-ON-DB                                  42260099
                 IF TFTYCD-XFER-TYP-CDE NOT = PC-OFFSITE-STORAGE        42270099
                   MOVE TFTYCD-XFER-TYP-CDE(2:1)                        42280099
                                         TO TYPE-FIELD-CODE             42290099
                   IF TFTYCD-TYP-2ND-LNE-DESC = SPACES                  42300099
                       MOVE TFTYCD-TYP-1ST-LNE-DESC                     42310099
                                         TO TYPE-FIELD-DESC             42320099
                   ELSE                                                 42330099
                       STRING TFTYCD-TYP-1ST-LNE-DESC DELIMITED BY '  ' 42340099
                              TFTYCD-TYP-2ND-LNE-DESC DELIMITED BY '  ' 42350099
                           INTO TYPE-FIELD-DESC                         42360099
                   END-IF                                               42370099
                   ADD +1                TO ASC-TYPE-TBL-SUB            42380099
                   MOVE TYPE-FIELD                                      42390099
                                         TO ASC-XFER-TY-ST-FIELD        42400099
                                                  (ASC-TYPE-TBL-SUB)    42410099
                 END-IF                                                 42420099
               END-IF                                                   42430099
           END-PERFORM.                                                 42440099
                                                                        42450099
       EJECT                                                            42460099
      *----------------------------------------------------------------*42470099
      *    FETCH THE TRANSFER TYPES AND DESCRIPTIONS                   *42480099
      *----------------------------------------------------------------*42490099
                                                                        42500099
       4025-FETCH-TRANSFER-TYPE.                                        42510099
                                                                        42520099
           EXEC SQL                                                     42530099
               FETCH XFER-TYPE-CSR                                      42540099
                   INTO                                                 42550099
                       :TFTYCD-XFER-TYP-CDE                             42560099
                     , :TFTYCD-TYP-1ST-LNE-DESC                         42570099
                     , :TFTYCD-TYP-2ND-LNE-DESC                         42580099
           END-EXEC.                                                    42590099
                                                                        42600099
           EVALUATE TRUE                                                42610099
               WHEN SQLCODE = ZERO                                      42620099
                    CONTINUE                                            42630099
               WHEN SQLCODE = +100                                      42640099
                    SET PS-NO-ITEMS-LEFT-ON-DB                          42650099
                                       TO TRUE                          42660099
               WHEN OTHER                                               42670099
                    MOVE '4025-FETCH-TRANSFER-TYPE'                     42690099
                                     TO DP013-PARAGRAPH                 42700099
                    MOVE 'FETCH XFER-TYPE-CSR CURSOR'                   42710099
                                     TO DP013-MESSAGE-TEXT (1)          42720099
                    MOVE SQLCA           TO DP013-SQLCA                 42730099
                    SET DP013-DB2-ABEND                                 42740099
                                     TO TRUE                            42750099
                    PERFORM DP013-0000-PROCESS-ABEND                    42760099
           END-EVALUATE.                                                42770099
                                                                        42780099
       EJECT                                                            42790099
      *----------------------------------------------------------------*42800099
      * CLOSE THE TRANSFER TYPE CURSOR                                 *42810099
      *----------------------------------------------------------------*42820099
                                                                        42830099
       4030-CLOSE-XFER-TYPE-CURSOR.                                     42840099
                                                                        42850099
           EXEC SQL                                                     42860099
               CLOSE XFER-TYPE-CSR                                      42870099
           END-EXEC.                                                    42880099
                                                                        42880199
           EVALUATE TRUE                                                42880299
               WHEN SQLCODE = ZERO                                      42880399
                    CONTINUE                                            42880499
               WHEN OTHER                                               42880599
                    MOVE '4030-CLOSE-XFER-TYPE-CURSOR'                  42880699
                                 TO  DP013-PARAGRAPH                    42880799
                    MOVE 'CLOSE XFER-TYPE-CSR CURSOR'                   42880899
                                 TO  DP013-MESSAGE-TEXT (1)             42880999
                    MOVE SQLCA   TO  DP013-SQLCA                        42881099
                    SET DP013-DB2-ABEND                                 42881199
                                 TO  TRUE                               42881299
                    PERFORM DP013-0000-PROCESS-ABEND                    42881399
           END-EVALUATE.                                                42881499
                                                                        42881599
       EJECT                                                            42881699
      *----------------------------------------------------------------*42881799
      * OPENS THE CONTAINER TYPE  CURSOR                               *42881899
      *----------------------------------------------------------------*42881999
                                                                        42882099
       4110-OPEN-CONTNR-TYPE-CURSOR.                                    42883099
                                                                        42884099
           EXEC SQL                                                     42885099
               OPEN CONT-TYPE-CSR                                       42886099
           END-EXEC.                                                    42887099
                                                                        42888099
           EVALUATE TRUE                                                42889099
               WHEN SQLCODE = +0                                        42890099
                   CONTINUE                                             42900099
               WHEN OTHER                                               42910099
                    MOVE '4110-OPEN-CONTNR-TYPE-CURSOR'                 42920099
                                     TO DP013-PARAGRAPH                 42930099
                    MOVE 'OPEN CONT-TYPE-CSR CURSOR'                    42940099
                                     TO DP013-MESSAGE-TEXT (1)          42950099
                    MOVE SQLCA           TO DP013-SQLCA                 42960099
                    SET DP013-DB2-ABEND                                 42970099
                                     TO TRUE                            42980099
                    PERFORM DP013-0000-PROCESS-ABEND                    42990099
           END-EVALUATE.                                                43000099
                                                                        43010099
       EJECT                                                            43020099
      *----------------------------------------------------------------*43030099
      *    READ THE CONTAINER TYPES AND DESCRIPTIONS AND PROCESS THEM   43040099
      *----------------------------------------------------------------*43050099
                                                                        43060099
       4120-READ-CONTAINER-TYPES.                                       43070099
                                                                        43080099
           SET PS-ITEMS-LEFT-ON-DB       TO TRUE.                       43090099
           PERFORM                                                      43100099
               VARYING PV-READ-COUNT                                    43110099
               FROM 1 BY 1                                              43120099
               UNTIL ((PV-READ-COUNT > PC-MAX-TYPES)                    43130099
                  OR (ASC-TYPE-TBL-SUB = PC-MAX-TYPE-SCR-LINES)         43140099
                  OR (PS-NO-ITEMS-LEFT-ON-DB))                          43150099
                                                                        43160099
               PERFORM 4125-FETCH-CONTAINER-TYPE                        43170099
                                                                        43180099
               IF  PS-ITEMS-LEFT-ON-DB                                  43190099
                   MOVE TFSHCT-CONTNR-TYP-CDE(2:1)                      43200099
                                         TO TYPE-FIELD-CODE             43210099
                   MOVE TFSHCT-CONTNR-TYP-DESC                          43220099
                                         TO TYPE-FIELD-DESC             43230099
                   ADD +1                TO ASC-TYPE-TBL-SUB            43240099
                   MOVE TYPE-FIELD                                      43250099
                                         TO ASC-XFER-TY-ST-FIELD        43260099
                                                  (ASC-TYPE-TBL-SUB)    43270099
               END-IF                                                   43280099
           END-PERFORM.                                                 43290099
                                                                        43300099
       EJECT                                                            43310099
      *----------------------------------------------------------------*43320099
      *    FETCH THE CONTAINER TYPE  AND DESCRIPTION                   *43330099
      *----------------------------------------------------------------*43340099
                                                                        43350099
       4125-FETCH-CONTAINER-TYPE.                                       43360099
                                                                        43370099
           EXEC SQL                                                     43380099
               FETCH CONT-TYPE-CSR                                      43390099
                   INTO                                                 43390199
                       :TFSHCT-CONTNR-TYP-CDE                           43390299
                     , :TFSHCT-CONTNR-TYP-DESC                          43390399
           END-EXEC.                                                    43390499
                                                                        43390599
           EVALUATE TRUE                                                43390699
               WHEN SQLCODE = ZERO                                      43390799
                    CONTINUE                                            43390899
               WHEN SQLCODE = +100                                      43390999
                    SET PS-NO-ITEMS-LEFT-ON-DB                          43391099
                                       TO TRUE                          43392099
               WHEN OTHER                                               43393099
                    MOVE '4125-FETCH-CONTAINER-TYPE'                    43395099
                                     TO DP013-PARAGRAPH                 43396099
                    MOVE 'FETCH CONT-TYPE-CSR CURSOR'                   43397099
                                     TO DP013-MESSAGE-TEXT (1)          43398099
                    MOVE SQLCA           TO DP013-SQLCA                 43399099
                    SET DP013-DB2-ABEND                                 43400099
                                     TO TRUE                            43410099
                    PERFORM DP013-0000-PROCESS-ABEND                    43420099
           END-EVALUATE.                                                43430099
                                                                        43440099
       EJECT                                                            43450099
      *----------------------------------------------------------------*43460099
      * CLOSE THE CONTAINER TYPE  CURSOR                               *43470099
      *----------------------------------------------------------------*43480099
                                                                        43490099
       4130-CLOSE-CONTNR-TYPE-CURSOR.                                   43500099
                                                                        43510099
           EXEC SQL                                                     43520099
               CLOSE CONT-TYPE-CSR                                      43530099
           END-EXEC.                                                    43540099
                                                                        43540199
           EVALUATE TRUE                                                43540299
               WHEN SQLCODE = ZERO                                      43540399
                    CONTINUE                                            43540499
               WHEN OTHER                                               43540599
                    MOVE '4130-CLOSE-CONTNR-TYPE-CURSOR'                43540699
                                 TO  DP013-PARAGRAPH                    43540799
                    MOVE 'CLOSE CONT-TYPE-CSR CURSOR'                   43540899
                                 TO  DP013-MESSAGE-TEXT (1)             43540999
                    MOVE SQLCA   TO  DP013-SQLCA                        43541099
                    SET DP013-DB2-ABEND                                 43541199
                                 TO  TRUE                               43541299
                    PERFORM DP013-0000-PROCESS-ABEND                    43541399
           END-EVALUATE.                                                43541499
                                                                        43541599
      ******************************************************************43541699
      *    RESTORE THE DATA ON THE SCREEN FROM THE COMM AREA.          *43541799
      ******************************************************************43541899
       4400-MOVE-COMMAREA-TO-SCREEN.                                    43541999
                                                                        43542099
           MOVE ASC-CONTROL-NBR          TO ACTRLNOO.                   43543099
           MOVE ASC-XFER-TYPE-SORT-NR    TO ASXFRTYPO.                  43544099
           MOVE ASC-XFER-TYPE            TO AXFRTYPO.                   43545099
           MOVE ASC-XFER-TYPE-DESC       TO AXFRTYPDO.                  43546099
           MOVE ASC-CONTNR-TYPE-SORT-NR  TO ASCONTYPO.                  43547099
           MOVE ASC-CONTNR-TYPE          TO ACONTYPO.                   43548099
           MOVE ASC-CONTNR-TYPE-DESC     TO ACONTYPDO.                  43549099
           MOVE ASC-TO-STORE-SORT-NR     TO ASTOSTORO.                  43550099
           MOVE ASC-TO-STORE             TO ATOSTORO.                   43560099
           MOVE ASC-FROM-STORE           TO ASTRNOO.                    43570099
           MOVE ASC-DEPT-NBR             TO ADEPTO.                     43580099
           MOVE ASC-CLASS-NBR            TO ACLASSO.                    43590099
           MOVE ASC-CALLBACK-NBR         TO ACALLNOO.                   43600099
           MOVE ASC-APPROVAL-NBR         TO AAPPRNOO.                   43610099
           MOVE ASC-COMP-BY-FIRST-INIT   TO ACMPBYINO.                  43620099
           MOVE ASC-COMP-BY-LAST-NAME    TO ACMPBYNMO.                  43630099
                                                                        43640099
           MOVE ASC-XFER-TY-ST-FIELD (1)  TO ATRTYST01O.                43650099
           MOVE ASC-XFER-TY-ST-FIELD (2)  TO ATRTYST02O.                43660099
           MOVE ASC-XFER-TY-ST-FIELD (3)  TO ATRTYST03O.                43670099
           MOVE ASC-XFER-TY-ST-FIELD (4)  TO ATRTYST04O.                43680099
           MOVE ASC-XFER-TY-ST-FIELD (5)  TO ATRTYST05O.                43690099
           MOVE ASC-XFER-TY-ST-FIELD (6)  TO ATRTYST06O.                43700099
           MOVE ASC-XFER-TY-ST-FIELD (7)  TO ATRTYST07O.                43710099
           MOVE ASC-XFER-TY-ST-FIELD (8)  TO ATRTYST08O.                43720099
           MOVE ASC-XFER-TY-ST-FIELD (9)  TO ATRTYST09O.                43730099
           MOVE ASC-XFER-TY-ST-FIELD (10) TO ATRTYST10O.                43740099
           MOVE ASC-XFER-TY-ST-FIELD (11) TO ATRTYST11O.                43750099
           MOVE ASC-XFER-TY-ST-FIELD (12) TO ATRTYST12O.                43760099
           MOVE ASC-XFER-TY-ST-FIELD (13) TO ATRTYST13O.                43770099
           MOVE ASC-XFER-TY-ST-FIELD (14) TO ATRTYST14O.                43780099
           MOVE ASC-XFER-TY-ST-FIELD (15) TO ATRTYST15O.                43790099
           MOVE ASC-XFER-TY-ST-FIELD (16) TO ATRTYST16O.                43800099
           MOVE ASC-XFER-TY-ST-FIELD (17) TO ATRTYST17O.                43810099
           MOVE ASC-XFER-TY-ST-FIELD (18) TO ATRTYST18O.                43820099
                                                                        43820199
           EJECT                                                        43820299
      *----------------------------------------------------------------*43820399
      *    GET THE STORE TYPE.                                         *43820499
      *----------------------------------------------------------------*43820599
       4500-READ-STORE.                                                 43820699
           PERFORM WITH TEST AFTER                                      43820799
               VARYING PV-RETRY-COUNT FROM 1 BY 1                       43820899
                 UNTIL PV-RETRY-COUNT > PC-MAX-RETRIES                  43820999
                    OR SQLCODE = ZERO                                   43821099
                    OR SQLCODE = +100                                   43821199
               EXEC SQL                                                 43821299
100404             SELECT LOC_TYP_CDE                                   43821399
100404                 INTO :XST00001-LOC-TYP-CDE                       43821499
100404                 FROM XST_LOC                                     43821599
100404                 WHERE   (LOC_NBR            = :DK-STORE-NBR)     43821899
100404                   AND   (CHAR(OPN_DTE) <= CURRENT DATE           43821999
                                         AND                            43822099
100404                          CHAR(CLO_DTE) >= CURRENT DATE)          43822199
               END-EXEC                                                 43822299
               EVALUATE TRUE                                            43822399
                   WHEN SQLCODE = ZERO                                  43822499
100404                 MOVE XST00001-LOC-TYP-CDE TO PW-TO-STORE-TYPE    43822599
                       SET PS-STORE-FOUND  TO TRUE                      43822699
                   WHEN SQLCODE = -904                                  43822799
                   WHEN SQLCODE = -913                                  43822899
                   WHEN SQLCODE = +100                                  43822999
                       CONTINUE                                         43823099
                   WHEN OTHER                                           43823299
                        MOVE '4500-READ-STORE'                          43823599
                                          TO DP013-PARAGRAPH            43823699
                        MOVE 'READ A ROW FROM THE STORE TABLE'          43823799
                                          TO DP013-MESSAGE-TEXT(1)      43823899
                        MOVE SQLCA        TO DP013-SQLCA                43823999
100404                  MOVE 'XST_LOC'    TO DP013-DB2-TABLE-NAME (1)   43824099
                        SET DP013-DB2-ABEND                             43824199
                            DP013-XCTL-DISPLAY-RESTART TO TRUE          43824299
                        PERFORM DP013-0000-PROCESS-ABEND                43824399
               END-EVALUATE                                             43824499
           END-PERFORM.                                                 43824599
                                                                        43824699
           IF PV-RETRY-COUNT > PC-MAX-RETRIES                           43824799
               MOVE '4500-READ-STORE' TO DP013-PARAGRAPH                43824899
               MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO READ'       43824999
                                          TO DP013-MESSAGE-TEXT (1)     43825099
               MOVE 'THE STORE TABLE'     TO DP013-MESSAGE-TEXT (2)     43825199
               MOVE SQLCA                 TO DP013-SQLCA                43825299
100404         MOVE 'XST_LOC'             TO DP013-DB2-TABLE-NAME (1)   43825399
               SET DP013-DB2-ABEND                                      43825499
                   DP013-XCTL-DISPLAY-RESTART                           43825599
                                          TO TRUE                       43825699
               PERFORM DP013-0000-PROCESS-ABEND                         43825799
           END-IF.                                                      43825899
       EJECT                                                            43825999
       4600-VALIDATE-PRICE.                                             44400299
           IF ASC-GROUP-PRICED-ITEM   (PW-ITEM-SUB)                     44400399
               IF ASC-PRICE-N(PW-ITEM-SUB)                              44400499
                                   NOT = PV-CUR-RTL-AMT                 44400599
      * -- THIS IS A GROUP PRICED ITEM; TRANSFER PRICE SHOULD BE --     44400699
                   IF PS-NO-ERROR                                       44400799
                       SET PS-ERROR          TO TRUE                    44400899
                   END-IF                                               44400999
               END-IF                                                   44401099
           ELSE                                                         44401199
             EVALUATE ASC-CMPLT-XFER-TYPE                               44401299
111703*         WHEN PC-DEFECTIVE-DAMAGE                                44401399
111703          WHEN PC-DEFECTIVE-DAMAGE-SORT1                          44401499
111703          WHEN PC-DEFECTIVE-DAMAGE-SORT2                          44401599
                   IF ASC-PRICE-N(PW-ITEM-SUB)                          44401699
                                   < PV-CUR-RTL-AMT                     44401799
      * -- DAMAGED TAG PRICE MUST MATCH CURRENT FILE PRICE --           44401899
                       IF PS-NO-ERROR                                   44401999
                           SET PS-ERROR           TO TRUE               44402099
                       END-IF                                           44402199
                   END-IF                                               44402299
                WHEN PC-CALLBACK                                        44403099
                   CONTINUE                                             44403199
                WHEN PC-STOCK-BAL-STORE                                 44403299
                WHEN PC-STOCK-BAL-CORP                                  44403399
                WHEN PC-CUSTOMER                                        44403499
100404            IF (PV-NREGN-LOC-SKU-STAT-CDE = PC-CLEARANCE AND      44403599
100404                XST00010-REGN-PRIC-IND NOT = PC-YES)              44403699
100404                IF PV-NREGN-UPC-STAT-CHG-DTE                      44403999
100404                                    < PV-NREGN-UNT-RTL-CHG-DTE    44404099
                          PERFORM 7750-GET-CLR-ITM-1ST-MKDN-PRIC        44404199
                      ELSE                                              44404299
100404                    MOVE XST00008-UNT-RTL-AMT TO PPCPRC-RTL-AMT   44404399
                      END-IF                                            44404499
                      IF ASC-PRICE-N(PW-ITEM-SUB)                       44404599
                                        >  PPCPRC-RTL-AMT               44404699
      * -- ITEM IS IN CLEARANCE STATUS - COMPLETE INSTORE PRICE CHANGE -44404799
                         IF PS-NO-ERROR                                 44404899
                             SET PS-ERROR           TO TRUE             44404999
                         END-IF                                         44405099
                      END-IF                                            44405199
                  ELSE                                                  44405299
                      IF ASC-PRICE-N(PW-ITEM-SUB)                       44405399
                                   NOT = PV-CUR-RTL-AMT                 44405499
      * -- PRICE MUST MATCH FILE PRICE - COMPLETE INSTORE PRICE CHANGE -44405599
                         IF PS-NO-ERROR                                 44405699
                             SET PS-ERROR           TO TRUE             44405799
                         END-IF                                         44405899
                      END-IF                                            44405999
                  END-IF                                                44406099
             END-EVALUATE                                               44406199
           END-IF.                                                      44406299
       EJECT                                                            44406399
      ******************************************************************44406499
      *    SELECT THE TTFMSTR TABLE ROW FOR A WORKSHEET. IF THE         44406599
      *    WORKSHEET IS NOT COMPLETED, THE XFER-SEQ-NBR WILL            44406699
      *    BE NULL.                                                     44406799
      ******************************************************************44406899
       5000-VERIFY-WORKSHEET-EXISTS.                                    44406999
                                                                        44407099
           MOVE ASC-CONTROL-NBR-N        TO  TFMSTR-XFER-DKEY-ID.       44407199
           MOVE ASC-FROM-STORE-N         TO  TFMSTR-FR-STR-NBR.         44407299
                                                                        44407399
           PERFORM                                                      44407499
               WITH TEST AFTER                                          44407599
               VARYING PV-RETRY-COUNT                                   44407699
               FROM 1 BY 1                                              44407799
               UNTIL ((PV-RETRY-COUNT > PC-MAX-RETRIES)                 44408099
                   OR (SQLCODE = +0)                                    44409099
                   OR (SQLCODE = +100))                                 44410099
                                                                        44420099
               EXEC SQL                                                 44430099
                   SELECT                                               44440099
                          XFER_SEQ_NBR                                  44450099
                         ,FR_STR_OVRRID_IND                             44460099
                    INTO :TFMSTR-XFER-SEQ-NBR                           44470099
                          :PV-SEQ-NULL-IND                              44480099
                         ,:TFMSTR-FR-STR-OVRRID-IND                     44490099
                    FROM TTFMSTR                                        44500099
                   WHERE FR_STR_NBR        = :TFMSTR-FR-STR-NBR         44510099
                     AND XFER_DKEY_ID      = :TFMSTR-XFER-DKEY-ID       44520099
                     AND ENTR_MTHD_TYP_CDE = :PC-3270-ENTRY             44530099
               END-EXEC                                                 44540099
                                                                        44550099
               EVALUATE TRUE                                            44560099
                   WHEN SQLCODE = +0                                    44570099
                       IF PV-SEQ-NULL-IND < +0                          44580099
                           SET PS-WKSHT-FOUND     TO TRUE               44590099
                           MOVE ZEROES              TO ASC-XFER-SEQ-NBR 44600099
                       ELSE                                             44610099
                           SET PS-WKSHT-COMPLETED TO TRUE               44620099
                           MOVE TFMSTR-XFER-SEQ-NBR TO ASC-XFER-SEQ-NBR 44630099
                       END-IF                                           44640099
                   WHEN SQLCODE = +100                                  44650099
                        SET PS-WKSHT-NOT-FOUND TO TRUE                  44660099
                   WHEN SQLCODE = -904                                  44670099
                   WHEN SQLCODE = -913                                  44680099
                        CONTINUE                                        44690099
                                                                        44700099
                   WHEN OTHER                                           44710099
                        MOVE '5000-VERIFY-WORKSHEET-EXISTS'             44740099
                                        TO DP013-PARAGRAPH              44750099
                        MOVE 'UNSUCCESSFUL SELECT'                      44760099
                                        TO DP013-MESSAGE-TEXT (1)       44770099
                        MOVE SQLCA      TO DP013-SQLCA                  44780099
                        MOVE 'TTFMSTR'  TO DP013-DB2-TABLE-NAME (1)     44790099
                        SET DP013-DB2-ABEND                             44800099
                            DP013-XCTL-DISPLAY-RESTART                  44810099
                                        TO TRUE                         44820099
                        PERFORM DP013-0000-PROCESS-ABEND                44830099
               END-EVALUATE                                             44840099
           END-PERFORM.                                                 44850099
                                                                        44860099
           IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          44870099
               MOVE '5000-VERIFY-WORKSHEET-EXISTS'                      44880099
                                        TO DP013-PARAGRAPH              44890099
               MOVE 'MAX RETRIES EXCEEDED FOR SELECT'                   44900099
                                        TO DP013-MESSAGE-TEXT (1)       44910099
               MOVE SQLCA               TO DP013-SQLCA                  44920099
               MOVE 'TTFMSTR   '        TO DP013-DB2-TABLE-NAME (1)     44930099
               SET DP013-DB2-ABEND                                      44940099
                   DP013-XCTL-DISPLAY-RESTART                           44950099
                                        TO TRUE                         44960099
               PERFORM DP013-0000-PROCESS-ABEND                         44970099
           END-IF.                                                      44980099
           IF PS-WKSHT-FOUND OR PS-WKSHT-COMPLETED                      44990099
               EVALUATE TFMSTR-FR-STR-OVRRID-IND  ALSO TRUE             45000099
                   WHEN PC-NO  ALSO  ASC-FR-STR-OVERRIDE                45010099
                       SET PS-WKSHT-NOT-FOUND        TO TRUE            45020099
                   WHEN PC-YES ALSO  NOT ASC-FR-STR-OVERRIDE            45030099
                       SET PS-WKSHT-NOT-FOUND        TO TRUE            45040099
               END-EVALUATE                                             45050099
           END-IF.                                                      45060099
                                                                        45060199
           EJECT                                                        45060299
      ******************************************************************45060399
      *    SELECT THE TTFTYCD TABLE ROW FOR A TRANSFER TYPE CODE.       45060499
      ******************************************************************45060599
       5200-SELECT-XFER-TYPE-CD-INFO.                                   45060699
                                                                        45060799
           PERFORM                                                      45060899
               WITH TEST AFTER                                          45060999
               VARYING PV-RETRY-COUNT                                   45061099
               FROM 1 BY 1                                              45062099
               UNTIL ((PV-RETRY-COUNT > PC-MAX-RETRIES)                 45063099
                   OR (SQLCODE = +0)                                    45064099
                   OR (SQLCODE = +100))                                 45065099
                                                                        45066099
               EXEC SQL                                                 45067099
                   SELECT                                               45068099
                          TYP_1ST_LNE_DESC                              45069099
                        , TYP_2ND_LNE_DESC                              45070099
                   INTO  :TFTYCD-TYP-1ST-LNE-DESC                       45080099
                        ,:TFTYCD-TYP-2ND-LNE-DESC                       45090099
                   FROM TTFTYCD                                         45100099
                   WHERE XFER_TYP_CDE = :TFTYCD-XFER-TYP-CDE            45110099
               END-EXEC                                                 45120099
                                                                        45130099
               EVALUATE TRUE                                            45140099
                   WHEN SQLCODE = +0                                    45150099
                   WHEN SQLCODE = +100                                  45160099
                   WHEN SQLCODE = -904                                  45170099
                   WHEN SQLCODE = -913                                  45180099
                        CONTINUE                                        45190099
                                                                        45200099
                   WHEN OTHER                                           45210099
                        MOVE '5200-SELECT-XFER-TYPE-CD-INFO'            45240099
                                        TO DP013-PARAGRAPH              45250099
                        MOVE 'UNSUCCESSFUL SELECT'                      45260099
                                        TO DP013-MESSAGE-TEXT (1)       45270099
                        MOVE SQLCA      TO DP013-SQLCA                  45280099
                        MOVE 'TTFTYCD'  TO DP013-DB2-TABLE-NAME (1)     45290099
                        SET DP013-DB2-ABEND                             45300099
                            DP013-XCTL-DISPLAY-RESTART                  45310099
                                        TO TRUE                         45320099
                        PERFORM DP013-0000-PROCESS-ABEND                45330099
               END-EVALUATE                                             45340099
           END-PERFORM.                                                 45350099
                                                                        45360099
           IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          45370099
               MOVE '5200-SELECT-XFER-TYPE-CD-INFO'                     45380099
                                        TO DP013-PARAGRAPH              45390099
               MOVE 'MAX RETRIES EXCEEDED FOR SELECT'                   45400099
                                        TO DP013-MESSAGE-TEXT (1)       45410099
               MOVE SQLCA               TO DP013-SQLCA                  45420099
               MOVE 'TTFTYCD '          TO DP013-DB2-TABLE-NAME (1)     45430099
               SET DP013-DB2-ABEND                                      45440099
                   DP013-XCTL-DISPLAY-RESTART                           45450099
                                        TO TRUE                         45460099
               PERFORM DP013-0000-PROCESS-ABEND                         45470099
           END-IF.                                                      45480099
           IF SQLCODE = +0                                              45490099
      * OFFSITE STORAGE SHOULD NOT BE DISPLAYED                         45500099
               IF TFTYCD-XFER-TYP-CDE = PC-OFFSITE-STORAGE              45510099
                   MOVE +100           TO SQLCODE                       45520099
               END-IF                                                   45530099
           END-IF.                                                      45540099
                                                                        45540199
           EJECT                                                        45540299
      ******************************************************************45540399
      *    SELECT THE TTFSHCT TABLE ROW FOR A CONTAINER TYPE CODE.      45540499
      ******************************************************************45540599
       5300-SELECT-CONTAINER-TYPE.                                      45540699
           PERFORM WITH TEST AFTER                                      45540799
               VARYING PV-RETRY-COUNT FROM 1 BY 1                       45540899
               UNTIL   SQLCODE = +100 OR                                45540999
                       SQLCODE = ZERO OR                                45541099
                       PV-RETRY-COUNT > PC-MAX-RETRIES                  45541199
                                                                        45541299
               EXEC SQL                                                 45541399
                  SELECT                                                45541499
                      CONTNR_TYP_DESC                                   45541599
                  INTO                                                  45541699
                      :TFSHCT-CONTNR-TYP-DESC                           45541799
                  FROM                                                  45541899
                      TTFSHCT                                           45541999
                  WHERE   CONTNR_TYP_CDE   = :TFSHCT-CONTNR-TYP-CDE     45542099
               END-EXEC                                                 45542199
                                                                        45542299
               EVALUATE TRUE                                            45542399
                   WHEN SQLCODE = ZERO                                  45542499
                        MOVE TFSHCT-CONTNR-TYP-DESC                     45542599
                                         TO ASC-CONTNR-TYPE-DESC        45542699
                   WHEN SQLCODE = +100                                  45542799
                   WHEN SQLCODE = -904                                  45542899
                   WHEN SQLCODE = -913                                  45542999
                        CONTINUE                                        45543099
                   WHEN OTHER                                           45543199
                        MOVE '5300-SELECT-CONTAINER-TYPE'               45543299
                                           TO DP013-PARAGRAPH           45543399
                        MOVE 'SELECT CONTAINER DESCRIPTION'             45543499
                                           TO DP013-MESSAGE-TEXT (1)    45543599
                        MOVE SQLCA         TO DP013-SQLCA               45543699
                        MOVE 'TTFSHCT'     TO DP013-DB2-TABLE-NAME (1)  45543799
                        SET DP013-DB2-ABEND                             45543899
                            DP013-XCTL-DISPLAY-RESTART                  45543999
                                           TO TRUE                      45544099
                        PERFORM DP013-0000-PROCESS-ABEND                45544199
               END-EVALUATE                                             45544299
           END-PERFORM.                                                 45544399
                                                                        45544499
           IF PV-RETRY-COUNT > PC-MAX-RETRIES AND                       45544599
              SQLCODE NOT = +100                                        45544699
               MOVE '5300-SELECT-CONTAINER-TYPE' TO DP013-PARAGRAPH     45544799
               MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     45544899
                                           TO DP013-MESSAGE-TEXT (1)    45544999
               MOVE 'CONTAINER DESCRIPTION'                             45545099
                                           TO DP013-MESSAGE-TEXT (2)    45545199
               MOVE SQLCA                  TO DP013-SQLCA               45545299
               MOVE 'TTFSHCT'              TO DP013-DB2-TABLE-NAME (1)  45545399
               SET DP013-DB2-ABEND                                      45545499
                   DP013-XCTL-DISPLAY-RESTART                           45545599
                                           TO TRUE                      45545699
               PERFORM DP013-0000-PROCESS-ABEND                         45545799
           END-IF.                                                      45545899
       EJECT                                                            45545999
      ******************************************************************45546099
      *    SELECT THE XST_LOC TABLE ROW FOR A STORE NUMBER.             45547099
      ******************************************************************45547199
       5400-SELECT-STORE.                                               45547299
                                                                        45547399
           PERFORM                                                      45547699
               WITH TEST AFTER                                          45547799
               VARYING PV-RETRY-COUNT                                   45547899
               FROM 1 BY 1                                              45547999
               UNTIL ((PV-RETRY-COUNT > PC-MAX-RETRIES)                 45548099
                   OR (SQLCODE = +0)                                    45549099
                   OR (SQLCODE = +100))                                 45550099
                                                                        45560099
               EXEC SQL                                                 45570099
100404             SELECT LOC_NBR                                       45580099
100404              INTO :XST00001-LOC-NBR                              45600099
100404              FROM XST_LOC                                        45610099
100404             WHERE LOC_NBR     = :XST00001-LOC-NBR                45630099
               END-EXEC                                                 45640099
                                                                        45650099
               EVALUATE TRUE                                            45660099
                   WHEN SQLCODE = +0                                    45670099
                   WHEN SQLCODE = +100                                  45680099
                   WHEN SQLCODE = -904                                  45690099
                   WHEN SQLCODE = -913                                  45700099
                        CONTINUE                                        45710099
                                                                        45720099
                   WHEN OTHER                                           45730099
                        MOVE '5400-SELECT-STORE'                        45760099
                                        TO DP013-PARAGRAPH              45770099
                        MOVE 'UNSUCCESSFUL SELECT'                      45780099
                                        TO DP013-MESSAGE-TEXT (1)       45790099
                        MOVE SQLCA      TO DP013-SQLCA                  45800099
100404                  MOVE 'XST_LOC'  TO DP013-DB2-TABLE-NAME (1)     45810099
                        SET DP013-DB2-ABEND                             45820099
                            DP013-XCTL-DISPLAY-RESTART                  45830099
                                        TO TRUE                         45840099
                        PERFORM DP013-0000-PROCESS-ABEND                45850099
               END-EVALUATE                                             45860099
           END-PERFORM.                                                 45870099
                                                                        45880099
           IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          45890099
               MOVE '5400-SELECT-STORE' TO DP013-PARAGRAPH              45900099
               MOVE 'MAX RETRIES EXCEEDED FOR SELECT'                   45910099
                                        TO DP013-MESSAGE-TEXT (1)       45920099
               MOVE SQLCA               TO DP013-SQLCA                  45930099
100404         MOVE 'XST_LOC '          TO DP013-DB2-TABLE-NAME (1)     45940099
               SET DP013-DB2-ABEND                                      45950099
                   DP013-XCTL-DISPLAY-RESTART                           45960099
                                        TO TRUE                         45970099
               PERFORM DP013-0000-PROCESS-ABEND                         45980099
           END-IF.                                                      45990099
                                                                        45990199
           EJECT                                                        45990299
      ******************************************************************45990399
      *    DETERMINE IF A TSKXREF TABLE ROW EXISTS FOR A DEPT NUMBER.   45990499
      ******************************************************************45990599
       5500-VERIFY-DEPARTMENT.                                          45990699
                                                                        45990799
           PERFORM                                                      45990899
               WITH TEST AFTER                                          45990999
               VARYING PV-RETRY-COUNT                                   45991099
               FROM 1 BY 1                                              45992099
               UNTIL ((PV-RETRY-COUNT > PC-MAX-RETRIES)                 45993099
                   OR (SQLCODE = +0))                                   45994099
                                                                        45995099
               EXEC SQL                                                 45996099
                   SELECT                                               45997099
                          COUNT (DISTINCT DEPT)                         45998099
                    INTO :PV-DEPT-NMBR-COUNT                            45999099
                    FROM TSKXREF                                        45999199
                   WHERE DEPT = :SKXREF-DEPT                            45999299
               END-EXEC                                                 45999399
                                                                        45999499
               EVALUATE TRUE                                            45999599
                   WHEN SQLCODE = +0                                    45999699
                   WHEN SQLCODE = -904                                  45999799
                   WHEN SQLCODE = -913                                  45999899
                        CONTINUE                                        45999999
                                                                        46000099
                   WHEN OTHER                                           46010099
                        MOVE '5500-VERIFY-DEPARTMENT'                   46040099
                                        TO DP013-PARAGRAPH              46050099
                        MOVE 'UNSUCCESSFUL SELECT'                      46060099
                                        TO DP013-MESSAGE-TEXT (1)       46070099
                        MOVE SQLCA      TO DP013-SQLCA                  46080099
                        MOVE 'TSKXREF'  TO DP013-DB2-TABLE-NAME (1)     46090099
                        SET DP013-DB2-ABEND                             46100099
                            DP013-XCTL-DISPLAY-RESTART                  46110099
                                        TO TRUE                         46120099
                        PERFORM DP013-0000-PROCESS-ABEND                46130099
               END-EVALUATE                                             46140099
           END-PERFORM.                                                 46150099
                                                                        46160099
           IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          46170099
               MOVE '5500-VERIFY-DEPARTMENT'                            46180099
                                        TO DP013-PARAGRAPH              46190099
               MOVE 'MAX RETRIES EXCEEDED FOR SELECT'                   46200099
                                        TO DP013-MESSAGE-TEXT (1)       46210099
               MOVE SQLCA               TO DP013-SQLCA                  46220099
               MOVE 'TSKXREF'           TO DP013-DB2-TABLE-NAME (1)     46230099
               SET DP013-DB2-ABEND                                      46240099
                   DP013-XCTL-DISPLAY-RESTART                           46250099
                                        TO TRUE                         46260099
               PERFORM DP013-0000-PROCESS-ABEND                         46270099
           END-IF.                                                      46280099
                                                                        46280199
           EJECT                                                        46280299
      ******************************************************************46280399
      *    DETERMINE IF A TSKXREF TABLE ROW EXISTS FOR A DEPT/CLASS NO. 46280499
      ******************************************************************46280599
       5600-VERIFY-DEPARTMENT-CLASS.                                    46280699
                                                                        46280799
           PERFORM                                                      46280899
               WITH TEST AFTER                                          46280999
               VARYING PV-RETRY-COUNT                                   46281099
               FROM 1 BY 1                                              46282099
               UNTIL ((PV-RETRY-COUNT > PC-MAX-RETRIES)                 46283099
                   OR (SQLCODE = +0))                                   46284099
                                                                        46285099
               EXEC SQL                                                 46286099
                   SELECT                                               46287099
                          COUNT (DISTINCT DEPT)                         46288099
                    INTO :PV-DEPT-CL-COUNT                              46289099
                    FROM TSKXREF                                        46289199
                   WHERE DEPT  = :SKXREF-DEPT                           46289299
                     AND CLASS = :SKXREF-CLASS                          46289399
               END-EXEC                                                 46289499
                                                                        46289599
               EVALUATE TRUE                                            46289699
                   WHEN SQLCODE = +0                                    46289799
                   WHEN SQLCODE = -904                                  46289899
                   WHEN SQLCODE = -913                                  46289999
                        CONTINUE                                        46290099
                                                                        46300099
                   WHEN OTHER                                           46310099
                        MOVE '5600-VERIFY-DEPARTMENT-CLASS'             46340099
                                        TO DP013-PARAGRAPH              46350099
                        MOVE 'UNSUCCESSFUL SELECT'                      46360099
                                        TO DP013-MESSAGE-TEXT (1)       46370099
                        MOVE SQLCA      TO DP013-SQLCA                  46380099
                        MOVE 'TSKXREF'  TO DP013-DB2-TABLE-NAME (1)     46390099
                        SET DP013-DB2-ABEND                             46400099
                            DP013-XCTL-DISPLAY-RESTART                  46410099
                                        TO TRUE                         46420099
                        PERFORM DP013-0000-PROCESS-ABEND                46430099
               END-EVALUATE                                             46440099
           END-PERFORM.                                                 46450099
                                                                        46460099
           IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          46470099
               MOVE '5600-VERIFY-DEPARTMENT-CLASS'                      46480099
                                        TO DP013-PARAGRAPH              46490099
               MOVE 'MAX RETRIES EXCEEDED FOR SELECT'                   46500099
                                        TO DP013-MESSAGE-TEXT (1)       46510099
               MOVE SQLCA               TO DP013-SQLCA                  46520099
               MOVE 'TSKXREF'           TO DP013-DB2-TABLE-NAME (1)     46530099
               SET DP013-DB2-ABEND                                      46540099
                   DP013-XCTL-DISPLAY-RESTART                           46550099
                                        TO TRUE                         46560099
               PERFORM DP013-0000-PROCESS-ABEND                         46570099
           END-IF.                                                      46580099
                                                                        46580199
           EJECT                                                        46580299
      *----------------------------------------------------------------*46580399
      * SELECT DATA FROM THE TRANSFER TABLES TO PREPARE FOR COMPLETE.   46580499
      *----------------------------------------------------------------*46580599
       6000-GET-CONTROL-INFO.                                           46580699
           PERFORM                                                      46580799
               WITH TEST AFTER                                          46580899
               VARYING PV-RETRY-COUNT                                   46580999
               FROM 1 BY 1                                              46581099
               UNTIL ((PV-RETRY-COUNT > PC-MAX-RETRIES)                 46581199
                         OR (SQLCODE = ZERO)                            46581299
                         OR (SQLCODE = +100))                           46581399
      *                                                                 46581499
               EXEC SQL                                                 46581599
                   SELECT XFER_TYP_CDE                                  46581699
                         ,CONTNR_TYP_CDE                                46581799
                         ,TO_STR_NBR                                    46581899
                         ,CPLD_INIT_1ST_NM                              46581999
                         ,CPLD_LAST_NM                                  46582099
                         ,LG_TTE_1ST_SEAL_ID                            46582199
                         ,LG_TTE_2ND_SEAL_ID                            46582299
                         ,SM_TTE_BAG_SEAL_ID                            46582399
                         ,TRLR_NBR                                      46582499
                         ,TRLR_SEAL_ID                                  46582599
                         ,CLBK_NBR                                      46582699
                         ,STK_BAL_APVL_NBR                              46582799
                         ,RQSTR_INIT_1ST_NM                             46582899
                         ,RQSTR_LAST_NM                                 46582999
                         ,WRKSHT_PROB_IND                               46583099
                   INTO   :TFMSTR-XFER-TYP-CDE                          46583199
                         ,:TFMSTR-CONTNR-TYP-CDE                        46583299
                         ,:TFMSTR-TO-STR-NBR                            46583399
                         ,:TFMSTR-CPLD-INIT-1ST-NM                      46583499
                         ,:TFMSTR-CPLD-LAST-NM                          46583599
                         ,:TFMSTR-LG-TTE-1ST-SEAL-ID                    46583699
                         ,:TFMSTR-LG-TTE-2ND-SEAL-ID                    46583799
                         ,:TFMSTR-SM-TTE-BAG-SEAL-ID                    46583899
                         ,:TFMSTR-TRLR-NBR                              46583999
                         ,:TFMSTR-TRLR-SEAL-ID                          46584099
                         ,:TFMSTR-CLBK-NBR                              46584199
                         ,:TFMSTR-STK-BAL-APVL-NBR                      46584299
                         ,:TFMSTR-RQSTR-INIT-1ST-NM                     46584399
                         ,:TFMSTR-RQSTR-LAST-NM                         46584499
                         ,:TFMSTR-WRKSHT-PROB-IND                       46584599
                   FROM   TTFMSTR                                       46584699
                   WHERE  XFER_DKEY_ID   = :DK-XFER-DKEY-ID             46584799
               END-EXEC                                                 46584899
                                                                        46584999
               EVALUATE TRUE                                            46585099
                   WHEN SQLCODE = ZERO                                  46585199
      *               SET PS-TRANSFER-FOUND     TO TRUE                 46585299
                      MOVE TFMSTR-XFER-TYP-CDE  TO ASC-CMPLT-XFER-TYPE  46585399
                      MOVE TFMSTR-CONTNR-TYP-CDE TO PW-CONTNR-TYPE      46585499
                      MOVE TFMSTR-TO-STR-NBR    TO PW-TO-STORE-N        46585599
                      MOVE TFMSTR-CPLD-INIT-1ST-NM                      46585699
                                                TO PW-COMP-BY-INT       46585799
                      MOVE TFMSTR-CPLD-LAST-NM  TO PW-COMP-BY-NAM       46585899
                      MOVE TFMSTR-LG-TTE-1ST-SEAL-ID                    46585999
                                                TO PW-LG-TOTE-SEAL1     46586099
                      MOVE TFMSTR-LG-TTE-2ND-SEAL-ID                    46586199
                                                TO PW-LG-TOTE-SEAL2     46586299
                      MOVE TFMSTR-SM-TTE-BAG-SEAL-ID                    46586399
                                                TO PW-SM-TOTE-SEAL      46586499
                      MOVE TFMSTR-TRLR-NBR      TO PW-TRAILER-NBR       46586599
                      MOVE TFMSTR-TRLR-SEAL-ID  TO PW-TRAILER-SEAL      46586699
                      MOVE TFMSTR-CLBK-NBR      TO PW-CALLBACK-NBR-N    46586799
                      MOVE TFMSTR-STK-BAL-APVL-NBR                      46586899
                                                TO PW-APPROVAL-NBR-N    46586999
                      MOVE TFMSTR-RQSTR-INIT-1ST-NM                     46587099
                                                TO PW-REQ-BY-INT        46587199
                      MOVE TFMSTR-RQSTR-LAST-NM TO PW-REQ-BY-NAM        46587299
                      MOVE TFMSTR-WRKSHT-PROB-IND                       46587399
                                                TO ASC-PROB-IND         46587499
                      IF ASC-CMPLT-XFER-TYPE = PC-CUSTOMER              46587599
                          PERFORM 6100-READ-CUSTOMER                    46587699
                      END-IF                                            46587799
                      IF ASC-CMPLT-XFER-TYPE NOT = PC-NON-RETAIL        46587899
                          INITIALIZE ASC-RETAIL-ITEM-ARRAY              46587999
                          PERFORM 6110-OPEN-RTL-CURSOR                  46588099
                          PERFORM 6120-READ-RTL-ITEMS-FROM-DB           46588199
                          PERFORM 6130-CLOSE-RTL-CURSOR                 46588299
                      ELSE                                              46588399
                          INITIALIZE ASC-NON-RETAIL-ITEM-ARRAY          46588499
                          PERFORM 6210-OPEN-NRTL-CURSOR                 46588599
                          PERFORM 6220-READ-NRTL-ITEMS-FROM-DB          46588699
                          PERFORM 6230-CLOSE-NRTL-CURSOR                46588799
                      END-IF                                            46588899
                                                                        46588999
                   WHEN SQLCODE = +100                                  46589099
                   WHEN SQLCODE = -904                                  46589199
                   WHEN SQLCODE = -913                                  46589299
                       CONTINUE                                         46589399
                   WHEN OTHER                                           46589499
                       MOVE '6000-GET-CONTROL-INFO'                     46589799
                                         TO DP013-PARAGRAPH             46589899
                       MOVE 'SELECT TRANSFER DATA'                      46589999
                                         TO DP013-MESSAGE-TEXT (1)      46590099
                       MOVE SQLCA        TO DP013-SQLCA                 46590199
                       MOVE 'TTFMSTR'    TO DP013-DB2-TABLE-NAME (1)    46590299
                       SET DP013-DB2-ABEND                              46590499
                           DP013-XCTL-DISPLAY-RESTART                   46590599
                                         TO TRUE                        46590699
                       PERFORM DP013-0000-PROCESS-ABEND                 46590799
               END-EVALUATE                                             46590899
           END-PERFORM.                                                 46590999
      *                                                                 46591099
           IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          46591199
               MOVE '6000-GET-CONTROL-INFO'                             46591299
                                         TO DP013-PARAGRAPH             46591399
               MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     46591499
                                         TO DP013-MESSAGE-TEXT (1)      46591599
               MOVE 'TRANSFER DATA'      TO DP013-MESSAGE-TEXT (2)      46591699
               MOVE SQLCA                TO DP013-SQLCA                 46591799
               MOVE 'TTFMSTR'            TO DP013-DB2-TABLE-NAME (1)    46591899
               SET DP013-DB2-ABEND                                      46592099
                   DP013-XCTL-DISPLAY-RESTART                           46592199
                                         TO TRUE                        46592299
               PERFORM DP013-0000-PROCESS-ABEND                         46592399
           END-IF.                                                      46592499
       EJECT                                                            46592599
      *----------------------------------------------------------------*46592699
      * SELECT DATA FROM THE TRANSFER THE CUSTOMER TABLE.              *46592799
      *----------------------------------------------------------------*46592899
       6100-READ-CUSTOMER.                                              46592999
           INITIALIZE DCLTTFCUST.                                       46593099
           PERFORM WITH TEST AFTER                                      46593199
               VARYING PV-RETRY-COUNT FROM 1 BY 1                       46593299
                 UNTIL PV-RETRY-COUNT > PC-MAX-RETRIES                  46593399
                    OR SQLCODE = ZERO                                   46593499
                    OR SQLCODE = +100                                   46593599
               EXEC SQL                                                 46593699
                   SELECT CUST_NM                                       46593799
                         ,PHN_NBR                                       46593899
                       INTO :TFCUST-CUST-NM                             46593999
                           ,:TFCUST-PHN-NBR                             46594099
                       FROM TTFCUST                                     46594199
                       WHERE XFER_DKEY_ID  = :DK-XFER-DKEY-ID           46594299
               END-EXEC                                                 46594399
               EVALUATE TRUE                                            46594499
                   WHEN SQLCODE = ZERO                                  46594599
                       MOVE TFCUST-CUST-NM TO PW-CUST-NAME              46594699
                       MOVE TFCUST-PHN-NBR TO PW-PHONE-NBR              46594799
                   WHEN SQLCODE = +100                                  46594899
                       MOVE SPACES        TO PW-CUST-NAME               46594999
                                             PW-PHONE-NBR               46595099
                   WHEN SQLCODE = -904                                  46595199
                   WHEN SQLCODE = -913                                  46595299
                       CONTINUE                                         46595399
                   WHEN OTHER                                           46595499
                       MOVE '6100-READ-CUSTOMER'                        46595799
                                         TO DP013-PARAGRAPH             46595899
                       MOVE 'READ DATA FROM TTFCUST'                    46595999
                                         TO DP013-MESSAGE-TEXT (1)      46596099
                       MOVE SQLCA        TO DP013-SQLCA                 46596199
                       MOVE 'TTFCUST'    TO DP013-DB2-TABLE-NAME (1)    46596299
                       SET DP013-DB2-ABEND                              46596399
                           DP013-XCTL-DISPLAY-RESTART                   46596499
                                         TO TRUE                        46596599
                       PERFORM DP013-0000-PROCESS-ABEND                 46596699
               END-EVALUATE                                             46596799
           END-PERFORM.                                                 46596899
      *                                                                 46596999
           IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          46597099
               MOVE '6100-READ-CUSTOMER'                                46597199
                                         TO DP013-PARAGRAPH             46597299
               MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     46597399
                                         TO DP013-MESSAGE-TEXT (1)      46597499
               MOVE 'DATA FROM TTFCUST'  TO DP013-MESSAGE-TEXT (2)      46597599
               MOVE SQLCA                TO DP013-SQLCA                 46597699
               MOVE 'TTFCUST'            TO DP013-DB2-TABLE-NAME (1)    46597799
               SET DP013-DB2-ABEND                                      46597899
                   DP013-XCTL-DISPLAY-RESTART                           46597999
                                         TO TRUE                        46598099
               PERFORM DP013-0000-PROCESS-ABEND                         46598199
           END-IF.                                                      46598299
       EJECT                                                            46598399
      *----------------------------------------------------------------*46598499
      * OPEN THE RETAIL TRANSFER ITEM CURSOR.                          *46598599
      *----------------------------------------------------------------*46598699
       6110-OPEN-RTL-CURSOR.                                            46598799
           PERFORM                                                      46598899
               WITH TEST AFTER                                          46598999
               VARYING PV-RETRY-COUNT                                   46599099
               FROM 1 BY 1                                              46599199
               UNTIL ((PV-RETRY-COUNT > PC-MAX-RETRIES)                 46599299
                         OR (SQLCODE = ZERO))                           46599399
                   EXEC SQL                                             46599499
                        OPEN RTL-ITEM-CSR                               46599599
                   END-EXEC                                             46599699
                                                                        46599799
               EVALUATE TRUE                                            46599899
                   WHEN SQLCODE = ZERO                                  46599999
                   WHEN SQLCODE = -904                                  46600099
                   WHEN SQLCODE = -913                                  46600199
                       CONTINUE                                         46600299
                   WHEN OTHER                                           46600399
                       MOVE '6110-OPEN-RTL-CURSOR'                      46600699
                                         TO DP013-PARAGRAPH             46600799
                       MOVE 'OPEN TRANSFER ITEM CURSOR - '              46600899
                                         TO DP013-MESSAGE-TEXT (1)      46600999
                       MOVE SQLCA        TO DP013-SQLCA                 46601099
                       MOVE 'TTFITEM '   TO DP013-DB2-TABLE-NAME (1)    46601199
                       SET DP013-DB2-ABEND                              46601299
                           DP013-XCTL-DISPLAY-RESTART TO TRUE           46601399
                       PERFORM DP013-0000-PROCESS-ABEND                 46601499
               END-EVALUATE                                             46601599
           END-PERFORM.                                                 46601699
      *                                                                 46601799
           IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          46601899
               MOVE '6110-OPEN-RTL-CURSOR'   TO DP013-PARAGRAPH         46601999
               MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR'   46602099
                                         TO DP013-MESSAGE-TEXT (1)      46602199
               MOVE SQLCA                TO DP013-SQLCA                 46602299
               MOVE 'TTFITEM '           TO DP013-DB2-TABLE-NAME (1)    46602399
               SET DP013-DB2-ABEND                                      46602499
                   DP013-XCTL-DISPLAY-RESTART                           46602599
                                         TO TRUE                        46602699
               PERFORM DP013-0000-PROCESS-ABEND                         46602799
           END-IF.                                                      46602899
                                                                        46602999
       EJECT                                                            46603099
      *----------------------------------------------------------------*46603199
      *    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE    *46603299
      *    BLOCKS IN THE ARRAY.  THE LIMIT IS 2 BLOCKS; WHEN THEY      *46603399
      *    BECOME FULL, STOP PROCESSING. (RETAIL TRANSFERS)            *46603499
      *----------------------------------------------------------------*46603599
                                                                        46603699
       6120-READ-RTL-ITEMS-FROM-DB.                                     46603799
                                                                        46603899
           SET ASC-ITEMS-LEFT-ON-DB      TO TRUE.                       46603999
           PERFORM                                                      46604099
               UNTIL  ASC-NO-ITEMS-LEFT-ON-DB                           46604199
                                                                        46604299
               PERFORM 6140-FETCH-RTL-ITEMS                             46604399
                                                                        46604499
               IF  ASC-ITEMS-LEFT-ON-DB                                 46604599
                   ADD +1                TO ASC-NBR-OF-LINES-ENTERED    46604699
                   MOVE TFITEM-XFER-LNE-NBR TO PW-ITEM-SUB              46604799
                   MOVE TFITEM-XFER-QTY                  TO             46605499
                           ASC-RTL-QTY-N     (PW-ITEM-SUB)              46605599
                   MOVE TFITEM-CPLD-RTL-PRIC-AMT         TO             46605699
                           ASC-FILE-PRICE    (PW-ITEM-SUB)              46605799
                   IF TFITEM-SCN-UPC-NBR > 0                            46605899
                       MOVE TFITEM-SCN-UPC-NBR           TO             46605999
                           ASC-UPC           (PW-ITEM-SUB)              46606099
                   END-IF                                               46606199
                   MOVE TFITEM-ITM-NBR                   TO             46606299
                           ASC-ITEM-NBR      (PW-ITEM-SUB)              46606399
                   MOVE TFITEM-KOHLS-UPC-NBR             TO             46606499
                           ASC-KOHLS-UPC     (PW-ITEM-SUB)              46606599
                   MOVE TFITEM-XFER-PRIC-AMT             TO             46606699
                           ASC-PRICE-N       (PW-ITEM-SUB)              46606799
               END-IF                                                   46606899
           END-PERFORM.                                                 46606999
                                                                        46607099
       EJECT                                                            46607199
      *----------------------------------------------------------------*46607299
      * CLOSE THE TRANSFER ITEM CURSOR.                                *46607399
      *----------------------------------------------------------------*46607499
                                                                        46607599
       6130-CLOSE-RTL-CURSOR.                                           46607699
           EXEC SQL                                                     46607799
               CLOSE RTL-ITEM-CSR                                       46607899
           END-EXEC                                                     46607999
      *                                                                 46608099
           EVALUATE TRUE                                                46608199
               WHEN SQLCODE = ZERO                                      46608299
                   CONTINUE                                             46608399
               WHEN OTHER                                               46608499
                   MOVE '6130-CLOSE-RTL-CURSOR'                         46608799
                                     TO DP013-PARAGRAPH                 46608899
                   MOVE 'CLOSE TRANSFER ITEM CURSOR '                   46608999
                                     TO DP013-MESSAGE-TEXT (1)          46609099
                   MOVE SQLCA        TO DP013-SQLCA                     46609199
                   MOVE 'TTFITEM '   TO DP013-DB2-TABLE-NAME (1)        46609299
                   SET DP013-DB2-ABEND                                  46609399
                       DP013-XCTL-DISPLAY-RESTART TO TRUE               46609499
                   PERFORM DP013-0000-PROCESS-ABEND                     46609599
           END-EVALUATE.                                                46609699
                                                                        46609799
       EJECT                                                            46609899
      *----------------------------------------------------------------*46609999
      *    FETCH THE TRANSFER ITEM CURSOR. (RETAIL TRANSFERS)          *46610099
      *----------------------------------------------------------------*46610199
                                                                        46610299
       6140-FETCH-RTL-ITEMS.                                            46610399
                                                                        46610499
           EXEC SQL                                                     46610599
               FETCH RTL-ITEM-CSR                                       46610699
               INTO                                                     46610799
                      :TFITEM-XFER-LNE-NBR                              46610899
                    , :TFITEM-CPLD-RTL-PRIC-AMT                         46611299
                    , :TFITEM-SCN-UPC-NBR                               46611399
                    , :TFITEM-KOHLS-UPC-NBR                             46611499
                    , :TFITEM-ITM-NBR                                   46611599
                    , :TFITEM-XFER-PRIC-AMT                             46611699
                    , :TFITEM-XFER-QTY                                  46611799
           END-EXEC                                                     46612199
                                                                        46612299
           EVALUATE TRUE                                                46612399
               WHEN SQLCODE = ZERO                                      46612499
                    CONTINUE                                            46612599
               WHEN SQLCODE = +100                                      46612699
                    SET ASC-NO-ITEMS-LEFT-ON-DB                         46612799
                                         TO TRUE                        46612899
               WHEN OTHER                                               46612999
                    MOVE '6140-FETCH-RTL-ITEMS'                         46613199
                                     TO DP013-PARAGRAPH                 46613299
                    MOVE 'FETCH RETAIL TRANSFER ITEM CURSOR'            46613399
                                     TO DP013-MESSAGE-TEXT (1)          46613499
                    MOVE 'TTFITEM '  TO DP013-DB2-TABLE-NAME (1)        46613599
                    MOVE SQLCA       TO DP013-SQLCA                     46613699
                    SET DP013-DB2-ABEND                                 46613799
                                     TO TRUE                            46613899
                    PERFORM DP013-0000-PROCESS-ABEND                    46613999
           END-EVALUATE.                                                46614099
                                                                        46614199
       EJECT                                                            46614299
      *----------------------------------------------------------------*46614399
      * OPEN THE NON-RETAIL TRANSFER ITEM CURSOR.                      *46614499
      *----------------------------------------------------------------*46614599
       6210-OPEN-NRTL-CURSOR.                                           46614699
           PERFORM                                                      46614799
               WITH TEST AFTER                                          46614899
               VARYING PV-RETRY-COUNT                                   46614999
               FROM 1 BY 1                                              46615099
               UNTIL ((PV-RETRY-COUNT > PC-MAX-RETRIES)                 46615199
                         OR (SQLCODE = ZERO))                           46615299
                   EXEC SQL                                             46615399
                        OPEN NRTL-ITEM-CSR                              46615499
                   END-EXEC                                             46615599
                                                                        46615699
               EVALUATE TRUE                                            46615799
                   WHEN SQLCODE = ZERO                                  46615899
                   WHEN SQLCODE = -904                                  46615999
                   WHEN SQLCODE = -913                                  46616099
                       CONTINUE                                         46616199
                   WHEN OTHER                                           46616299
                       MOVE '6210-OPEN-NRTL-CURSOR'                     46616599
                                         TO DP013-PARAGRAPH             46616699
                       MOVE 'OPEN TRANSFER ITEM CURSOR - '              46616799
                                         TO DP013-MESSAGE-TEXT (1)      46616899
                       MOVE SQLCA        TO DP013-SQLCA                 46616999
                       MOVE 'TTFITEM '   TO DP013-DB2-TABLE-NAME (1)    46617099
                       SET DP013-DB2-ABEND                              46617199
                           DP013-XCTL-DISPLAY-RESTART TO TRUE           46617299
                       PERFORM DP013-0000-PROCESS-ABEND                 46617399
               END-EVALUATE                                             46617499
           END-PERFORM.                                                 46617599
      *                                                                 46617699
           IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          46617799
               MOVE '6210-OPEN-NRTL-CURSOR'   TO DP013-PARAGRAPH        46617899
               MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR'   46617999
                                         TO DP013-MESSAGE-TEXT (1)      46618099
               MOVE SQLCA                TO DP013-SQLCA                 46618199
               MOVE 'TTFITEM '           TO DP013-DB2-TABLE-NAME (1)    46618299
               SET DP013-DB2-ABEND                                      46618399
                   DP013-XCTL-DISPLAY-RESTART                           46618499
                                         TO TRUE                        46618599
               PERFORM DP013-0000-PROCESS-ABEND                         46618699
           END-IF.                                                      46618799
                                                                        46618899
       EJECT                                                            46618999
      *----------------------------------------------------------------*46619099
      *    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE    *46619199
      *    BLOCKS IN THE ARRAY.  THE LIMIT IS 2 BLOCKS; WHEN THEY      *46619299
      *    BECOME FULL, STOP PROCESSING. (NON-RETAIL TRANSFERS)        *46619399
      *----------------------------------------------------------------*46619499
                                                                        46619599
       6220-READ-NRTL-ITEMS-FROM-DB.                                    46619699
                                                                        46619799
           SET ASC-ITEMS-LEFT-ON-DB      TO TRUE.                       46619899
           PERFORM                                                      46619999
               UNTIL  ASC-NO-ITEMS-LEFT-ON-DB                           46620099
                                                                        46620199
               PERFORM 6240-FETCH-NRTL-ITEMS                            46620299
                                                                        46620399
               IF  ASC-ITEMS-LEFT-ON-DB                                 46620499
                   ADD +1                TO ASC-NBR-OF-LINES-ENTERED    46620599
                   MOVE TFITEM-XFER-LNE-NBR TO PW-ITEM-SUB              46620699
                   MOVE TFITEM-NRTL-FIXT-ID              TO             46620799
                           ASC-FIXTURE       (PW-ITEM-SUB)              46620899
                   MOVE TFITEM-NRTL-DEPT-NBR             TO             46620999
                           ASC-NRTL-DEPT     (PW-ITEM-SUB)              46621099
                   MOVE TFITEM-NRTL-1ST-LNE-DESC         TO             46621199
                           ASC-ITEM-DESC1    (PW-ITEM-SUB)              46621299
                   MOVE TFITEM-NRTL-2ND-LNE-DESC         TO             46621399
                           ASC-ITEM-DESC2    (PW-ITEM-SUB)              46621499
                   MOVE TFITEM-XFER-QTY                  TO             46621599
                           ASC-NRTL-QTY-N    (PW-ITEM-SUB)              46621699
               END-IF                                                   46621799
           END-PERFORM.                                                 46621899
                                                                        46621999
       EJECT                                                            46622099
      *----------------------------------------------------------------*46622199
      * CLOSE THE NON-RETAIL TRANSFER ITEM CURSOR.                     *46622299
      *----------------------------------------------------------------*46622399
                                                                        46622499
       6230-CLOSE-NRTL-CURSOR.                                          46622599
           EXEC SQL                                                     46622699
               CLOSE NRTL-ITEM-CSR                                      46622799
           END-EXEC                                                     46622899
      *                                                                 46622999
           EVALUATE TRUE                                                46623099
               WHEN SQLCODE = ZERO                                      46623199
                   CONTINUE                                             46623299
               WHEN OTHER                                               46623399
                   MOVE '6230-CLOSE-NRTL-CURSOR'                        46623699
                                     TO DP013-PARAGRAPH                 46623799
                   MOVE 'CLOSE TRANSFER ITEM CURSOR '                   46623899
                                     TO DP013-MESSAGE-TEXT (1)          46623999
                   MOVE SQLCA        TO DP013-SQLCA                     46624099
                   MOVE 'TTFITEM '   TO DP013-DB2-TABLE-NAME (1)        46624199
                   SET DP013-DB2-ABEND                                  46624299
                       DP013-XCTL-DISPLAY-RESTART TO TRUE               46624399
                   PERFORM DP013-0000-PROCESS-ABEND                     46624499
           END-EVALUATE.                                                46624599
                                                                        46624699
       EJECT                                                            46624799
      *----------------------------------------------------------------*46624899
      *    FETCH THE TRANSFER ITEM CURSOR. (NON-RETAIL)                *46624999
      *----------------------------------------------------------------*46625099
                                                                        46625199
       6240-FETCH-NRTL-ITEMS.                                           46625299
                                                                        46625399
           EXEC SQL                                                     46625499
               FETCH NRTL-ITEM-CSR                                      46625599
               INTO                                                     46625699
                      :TFITEM-XFER-LNE-NBR                              46625799
                    , :TFITEM-NRTL-1ST-LNE-DESC                         46625899
                    , :TFITEM-NRTL-2ND-LNE-DESC                         46625999
                    , :TFITEM-NRTL-FIXT-ID                              46626099
                    , :TFITEM-NRTL-DEPT-NBR                             46626199
                    , :TFITEM-XFER-QTY                                  46626299
           END-EXEC                                                     46626399
                                                                        46626499
           EVALUATE TRUE                                                46626599
               WHEN SQLCODE = ZERO                                      46626699
                    CONTINUE                                            46626799
               WHEN SQLCODE = +100                                      46626899
                    SET ASC-NO-ITEMS-LEFT-ON-DB                         46626999
                                         TO TRUE                        46627099
               WHEN OTHER                                               46627199
                    MOVE '6240-FETCH-NRTL-ITEMS'                        46627399
                                     TO DP013-PARAGRAPH                 46627499
                    MOVE 'FETCH NON-RETAIL TRANSFER ITEM CURSOR'        46627599
                                     TO DP013-MESSAGE-TEXT (1)          46627699
                    MOVE 'TTFITEM '  TO DP013-DB2-TABLE-NAME (1)        46627799
                    MOVE SQLCA       TO DP013-SQLCA                     46627899
                    SET DP013-DB2-ABEND                                 46627999
                                     TO TRUE                            46628099
                    PERFORM DP013-0000-PROCESS-ABEND                    46628199
           END-EVALUATE.                                                46628299
       EJECT                                                            46628399
      *----------------------------------------------------------------*46628499
      *  UPDATE AND INSERT ROWS IN THE APPROPRIATE TABLES WHEN THE     *46628599
      *  COMPLETE TRANSFER FUNCTION IS SELECTED.                       *46628699
      *----------------------------------------------------------------*46628799
       7000-COMPLETE-TRANSFER.                                          46628899
           PERFORM 7100-PREPARE-COMPLETE.                               46628999
           INITIALIZE DCLTTFMSTR.                                       46629099
           MOVE ASC-CONTROL-NBR-N          TO TFMSTR-XFER-DKEY-ID.      46629199
           MOVE DP020-USERID               TO TFMSTR-CPLD-XFER-USR-ID.  46629299
           MOVE PV-XFER-SEQ-NBR            TO TFMSTR-XFER-SEQ-NBR       46629399
                                              ASC-XFER-SEQ-NBR.         46629499
           EXEC SQL                                                     46629599
               SET :PV-DB2-TIMESTAMP = CURRENT TIMESTAMP                46629699
           END-EXEC.                                                    46629799
           PERFORM 7200-COMPLETE-TTFMSTR                                46629899
           PERFORM 8000-DELETE-XFER-ITEMS.                              46629999
           MOVE 0                    TO PV-LINE-NBR.                    46630099
           IF ASC-CMPLT-XFER-TYPE NOT = PC-NON-RETAIL                   46630199
               PERFORM 9000-CHECK-RETAIL-ITEMS                          46630299
                 VARYING PW-ITEM-SUB                                    46630399
                   FROM 1 BY 1 UNTIL                                    46630499
                         PW-ITEM-SUB > PC-MAX-RETAIL-ITEMS              46630599
           ELSE                                                         46630699
               PERFORM 9200-CHECK-NON-RETAIL-ITEMS                      46630799
                 VARYING PW-ITEM-SUB                                    46630899
                   FROM 1 BY 1 UNTIL                                    46630999
                         PW-ITEM-SUB > PC-MAX-NON-RETAIL-ITEMS          46631099
           END-IF.                                                      46631199
           PERFORM 7400-INSERT-STATUS.                                  46631299
      *----------------------------------------------------------------*46631399
      *  DETERMINE THE NEXT SEQUENCE NUMBER TO BE ASSIGNED AS THE      *46631499
      *  TRANSFER NUMBER FOR THIS STORE.                               *46631599
      *----------------------------------------------------------------*46631699
       7100-PREPARE-COMPLETE.                                           46631799
           MOVE ASC-FROM-STORE-N   TO TFMSTR-FR-STR-NBR                 46631899
           PERFORM                                                      46631999
               WITH TEST AFTER                                          46632099
               VARYING PV-RETRY-COUNT                                   46632199
               FROM 1 BY 1                                              46632299
               UNTIL ((PV-RETRY-COUNT > PC-MAX-RETRIES)                 46632399
                         OR (SQLCODE = ZERO)                            46632499
                         OR (SQLCODE = +100))                           46632599
      *                                                                 46632699
               EXEC SQL                                                 46632799
                   SELECT MAX(XFER_SEQ_NBR)                             46632899
                   INTO   :PV-XFER-SEQ-NBR                              46632999
                          :PV-SEQ-NULL-IND                              46633099
                   FROM   TTFMSTR                                       46633199
                   WHERE  FR_STR_NBR     = :TFMSTR-FR-STR-NBR   AND     46633299
                          XFER_SEQ_NBR   IS NOT NULL                    46633399
               END-EXEC                                                 46633499
                                                                        46633599
               EVALUATE TRUE                                            46633699
                   WHEN SQLCODE = ZERO                                  46633799
                   WHEN SQLCODE = +100                                  46633899
                   WHEN SQLCODE = -904                                  46633999
                   WHEN SQLCODE = -913                                  46634099
                       CONTINUE                                         46634199
                   WHEN OTHER                                           46634299
                       MOVE '7100-PREPARE-COMPLETE'                     46634599
                                         TO DP013-PARAGRAPH             46634699
                       MOVE 'SELECT TRANSFER DATA'                      46634799
                                         TO DP013-MESSAGE-TEXT (1)      46634899
                       MOVE SQLCA        TO DP013-SQLCA                 46634999
                       MOVE 'TTFMSTR'    TO DP013-DB2-TABLE-NAME (1)    46635099
                       SET DP013-DB2-ABEND                              46635199
                           DP013-XCTL-DISPLAY-RESTART                   46635299
                                         TO TRUE                        46635399
                       PERFORM DP013-0000-PROCESS-ABEND                 46635499
               END-EVALUATE                                             46635599
           END-PERFORM.                                                 46635699
      *                                                                 46635799
           IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          46635899
               MOVE '7100-PREPARE-COMPLETE'                             46635999
                                         TO DP013-PARAGRAPH             46636099
               MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     46636199
                                         TO DP013-MESSAGE-TEXT (1)      46636299
               MOVE 'TRANSFER DATA'      TO DP013-MESSAGE-TEXT (2)      46636399
               MOVE SQLCA                TO DP013-SQLCA                 46636499
               MOVE 'TTFMSTR'            TO DP013-DB2-TABLE-NAME (1)    46636599
               SET DP013-DB2-ABEND                                      46636699
                   DP013-XCTL-DISPLAY-RESTART                           46636799
                                         TO TRUE                        46636899
               PERFORM DP013-0000-PROCESS-ABEND                         46636999
           END-IF.                                                      46637099
           IF SQLCODE = +100                                            46637199
               MOVE +1                    TO PV-XFER-SEQ-NBR            46637299
           ELSE                                                         46637399
               IF PV-SEQ-NULL-IND < 0                                   46637499
                   MOVE +1                TO PV-XFER-SEQ-NBR            46637599
               ELSE                                                     46637699
                   ADD +1                 TO PV-XFER-SEQ-NBR            46637799
               END-IF                                                   46637899
           END-IF.                                                      46637999
       EJECT                                                            46638099
      *----------------------------------------------------------------*46638199
      *  UPDATE THE TRANSFER MASTER TABLE WITH COMPLETE TRANSFER DATA. *46638299
      *----------------------------------------------------------------*46638399
       7200-COMPLETE-TTFMSTR.                                           46638499
           PERFORM                                                      46638599
             WITH TEST AFTER                                            46638699
               VARYING PV-RETRY-COUNT FROM 1 BY 1                       46638799
                 UNTIL PV-RETRY-COUNT > PC-MAX-RETRIES                  46638899
                    OR SQLCODE = ZERO                                   46638999
                    OR SQLCODE = +100                                   46639099
               EXEC SQL                                                 46639199
                 UPDATE TTFMSTR                                         46639299
                   SET  XFER_SEQ_NBR       = :TFMSTR-XFER-SEQ-NBR       46639399
                       ,CMPT_XFER_END_TMST = :PV-DB2-TIMESTAMP          46639499
                       ,CPLD_XFER_USR_ID   = :TFMSTR-CPLD-XFER-USR-ID   46639599
                   WHERE (XFER_DKEY_ID  = :TFMSTR-XFER-DKEY-ID)         46639699
               END-EXEC                                                 46639799
               EVALUATE TRUE                                            46639899
                   WHEN SQLCODE = ZERO                                  46639999
                   WHEN SQLCODE = -904                                  46640099
                   WHEN SQLCODE = -913                                  46640199
                       CONTINUE                                         46640299
                   WHEN OTHER                                           46640399
                       MOVE '7200-COMPLETE-TTFMSTR'                     46640699
                                           TO DP013-PARAGRAPH           46640799
                       MOVE 'UPDATE A ROW IN TTFMSTR'                   46640899
                                           TO DP013-MESSAGE-TEXT (1)    46640999
                       MOVE SQLCA          TO DP013-SQLCA               46641099
                       MOVE 'TTFMSTR'      TO DP013-DB2-TABLE-NAME (1)  46641199
                       SET DP013-DB2-ABEND TO TRUE                      46641299
                       PERFORM DP013-0000-PROCESS-ABEND                 46641399
               END-EVALUATE                                             46641499
           END-PERFORM.                                                 46641599
                                                                        46641699
           IF PV-RETRY-COUNT > PC-MAX-RETRIES                           46641799
              MOVE '7200-COMPLETE-TTFMSTR'                              46641899
                                           TO DP013-PARAGRAPH           46641999
              MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO UPDATE A ROW'46642099
                                           TO DP013-MESSAGE-TEXT (1)    46642199
              MOVE 'IN THE TRANSFER MASTER TABLE'                       46642299
                                           TO DP013-MESSAGE-TEXT (2)    46642399
              MOVE SQLCA                   TO DP013-SQLCA               46642499
              MOVE 'TTFMSTR'               TO DP013-DB2-TABLE-NAME (1)  46642599
              SET DP013-DB2-ABEND          TO TRUE                      46642699
              PERFORM DP013-0000-PROCESS-ABEND                          46642799
           END-IF.                                                      46642899
       EJECT                                                            46642999
      *----------------------------------------------------------------*46643099
      *  INSERT A ROW IN THE TRANSFER STATUS TABLE FOR COMPLETE XFER.  *46643199
      *----------------------------------------------------------------*46643299
       7400-INSERT-STATUS.                                              46643399
           INITIALIZE DCLTTFSTAT.                                       46644099
           MOVE TFMSTR-XFER-DKEY-ID        TO TFSTAT-XFER-DKEY-ID.      46645099
           MOVE PV-DB2-TIMESTAMP           TO TFSTAT-XFER-STAT-TMST.    46646099
           MOVE PC-COMPLETE-STATUS         TO TFSTAT-XFER-STAT-CDE.     46646199
           PERFORM WITH TEST AFTER                                      46646299
               VARYING PV-RETRY-COUNT FROM 1 BY 1                       46646399
               UNTIL SQLCODE = 0 OR                                     46646499
                     PV-RETRY-COUNT > PC-MAX-RETRIES                    46646599
               EXEC SQL                                                 46646699
                    INSERT                                              46646799
                      INTO TTFSTAT                                      46646899
                          (XFER_DKEY_ID                                 46646999
                         , XFER_STAT_TMST                               46647099
                         , XFER_STAT_CDE)                               46647199
                    VALUES                                              46647299
                          (:TFSTAT-XFER-DKEY-ID                         46647399
                         , :TFSTAT-XFER-STAT-TMST                       46647499
                         , :TFSTAT-XFER-STAT-CDE)                       46647599
               END-EXEC                                                 46647699
                                                                        46647799
               EVALUATE TRUE                                            46647899
                   WHEN SQLCODE = 0                                     46647999
                   WHEN SQLCODE = -904                                  46648099
                   WHEN SQLCODE = -913                                  46648199
                        CONTINUE                                        46648299
                   WHEN OTHER                                           46648399
                        MOVE '7400-INSERT-STATUS'                       46648499
                                          TO DP013-PARAGRAPH            46648599
                        MOVE 'INSERT A ROW INTO THE TTFSTAT TABLE'      46648699
                                          TO DP013-MESSAGE-TEXT(1)      46648799
                        MOVE SQLCA        TO DP013-SQLCA                46648899
                        MOVE 'TTFSTAT'    TO DP013-DB2-TABLE-NAME (1)   46648999
                        SET DP013-DB2-ABEND                             46649099
                            DP013-XCTL-DISPLAY-RESTART TO TRUE          46649199
                        PERFORM DP013-0000-PROCESS-ABEND                46649299
               END-EVALUATE                                             46649399
           END-PERFORM.                                                 46649499
                                                                        46649599
           IF PV-RETRY-COUNT > PC-MAX-RETRIES AND                       46649699
              SQLCODE NOT = 0                                           46649799
               MOVE '7400-INSERT-STATUS' TO DP013-PARAGRAPH             46649899
               MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO INSERT'     46649999
                                          TO DP013-MESSAGE-TEXT (1)     46650099
               MOVE 'A TRANSFER STATUS'   TO DP013-MESSAGE-TEXT (2)     46650199
               MOVE SQLCA                 TO DP013-SQLCA                46650299
               MOVE 'TTFSTAT'             TO DP013-DB2-TABLE-NAME (1)   46650399
               SET DP013-DB2-ABEND                                      46650499
                   DP013-XCTL-DISPLAY-RESTART                           46650599
                                          TO TRUE                       46650699
               PERFORM DP013-0000-PROCESS-ABEND                         46650799
           END-IF.                                                      46650899
       EJECT                                                            46650999
      *----------------------------------------------------------------*46651099
      *  SELECT THE CLEARANCE ITEM FIRST MARKDOWN PRICE.               *46651199
      *----------------------------------------------------------------*46651299
       7750-GET-CLR-ITM-1ST-MKDN-PRIC.                                  46651399
           INITIALIZE DCLTPPCPRC.                                       46651499
           MOVE ASC-ITEM-NBR (PW-ITEM-SUB)  TO DK-ITEM-NBR.             46651599
           MOVE PV-NREGN-LOC-SKU-STAT-CDE-9 TO DK-SKU-STATUS-CODE.      46651699
                                                                        46651799
           PERFORM                                                      46651899
               WITH TEST AFTER                                          46651999
               VARYING PV-RETRY-COUNT                                   46652099
               FROM 1 BY 1                                              46652199
               UNTIL ((PV-RETRY-COUNT > PC-MAX-RETRIES)                 46652299
                   OR (SQLCODE = +0)                                    46652399
                   OR (SQLCODE = +100))                                 46652499
                                                                        46652599
               EXEC SQL                                                 46652699
                   SELECT  MAX(RTL_AMT)                                 46652799
                     INTO  :PPCPRC-RTL-AMT                              46652899
                              :PV-NULL-IND                              46652999
                     FROM  TPPCPRC                                      46653099
                    WHERE  (TSK_ITM_NBR = :DK-ITEM-NBR                  46653199
                      AND   STR_NBR     = :PC-ZERO                      46653399
100404                AND   STATUS_CDE  = :DK-SKU-STATUS-CODE)          46654099
               END-EXEC                                                 46655099
                                                                        46655199
               EVALUATE TRUE                                            46655299
                   WHEN SQLCODE = ZERO                                  46655399
                   WHEN SQLCODE = -904                                  46655499
                   WHEN SQLCODE = -913                                  46655599
                       CONTINUE                                         46655699
                   WHEN SQLCODE = +100                                  46655799
100404                 MOVE XST00008-UNT-RTL-AMT TO PPCPRC-RTL-AMT      46655899
                   WHEN OTHER                                           46655999
                       MOVE '7750-GET-CLR-ITM-1ST-MKDN-PRIC'            46658099
                                             TO DP013-PARAGRAPH         46659099
                       MOVE 'SELECT THE 1ST MARKDOWN PRICE FOR A CLEARAN46660099
      -                 'CE ITEM.  TSK-ITEM-NMBR:'                      46670099
                                             TO DP013-MESSAGE-TEXT (1)  46680099
                       MOVE DK-ITEM-NBR  TO PV-DISPLAY-ITM-NBR          46690099
                       MOVE PV-DISPLAY-ITM-NBR TO DP013-MESSAGE-TEXT (2)46700099
                       MOVE SQLCA            TO DP013-SQLCA             46710099
                       MOVE 'TPPCPRC'        TO DP013-DB2-TABLE-NAME (1)46710199
                       SET DP013-DB2-ABEND                              46710299
                       DP013-XCTL-DISPLAY-RESTART                       46710399
                                            TO TRUE                     46710499
                       PERFORM DP013-0000-PROCESS-ABEND                 46710599
               END-EVALUATE                                             46710699
           END-PERFORM.                                                 46710799
                                                                        46710899
           IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          46710999
                   MOVE '7750-GET-CLR-ITM-1ST-MKDN-PRIC'                46711099
                                             TO DP013-PARAGRAPH         46712099
                   MOVE 'SELECT THE 1ST MARKDOWN PRICE FOR A CLEARANCE I46713099
      -                 'TEM.  TSK-ITEM-NMBR:'                          46714099
                                             TO DP013-MESSAGE-TEXT (1)  46715099
                   MOVE DK-ITEM-NBR     TO PV-DISPLAY-ITM-NBR           46716099
                   MOVE PV-DISPLAY-ITM-NBR   TO DP013-MESSAGE-TEXT (2)  46717099
                   MOVE SQLCA                TO DP013-SQLCA             46718099
                   MOVE 'TPPCPRC'            TO DP013-DB2-TABLE-NAME (1)46718199
                   SET DP013-DB2-ABEND                                  46718299
                       DP013-XCTL-DISPLAY-RESTART                       46718399
                                            TO TRUE                     46718499
                   PERFORM DP013-0000-PROCESS-ABEND                     46718599
           END-IF.                                                      46718699
           IF PV-NULL-IND IS NEGATIVE                                   46718799
100404         MOVE XST00008-UNT-RTL-AMT TO PPCPRC-RTL-AMT              46718899
           END-IF.                                                      46718999
                                                                        46719099
       7800-CHECK-REGN-PRC.                                             46719199
           PERFORM                                                      46719399
               WITH TEST AFTER                                          46719499
               VARYING PV-RETRY-COUNT                                   46719599
               FROM 1 BY 1                                              46719699
               UNTIL ((PV-RETRY-COUNT > PC-MAX-RETRIES)                 46719799
                   OR (SQLCODE = +0)                                    46719899
                   OR (SQLCODE = +100))                                 46719999
               EXEC SQL                                                 46720099
100404             SELECT  LOC_SKU_STAT_CDE                             46720199
100404                    ,UNT_RTL_AMT                                  46720299
100404               INTO :PV-REGN-LOC-SKU-STAT-CDE                     46720399
100404                   ,:XST00008-UNT-RTL-AMT                         46720499
100404               FROM  XST_SKU_LOC A                                46720799
100404              WHERE  A.INTR_UPC_ID  = :XST00008-INTR-UPC-ID       46720899
100404                AND  A.LOC_NBR      = :DK-STORE-NBR               46720999
100404                AND  A.BEG_TMST    <= CURRENT TIMESTAMP           46721099
100404                AND  (A.END_TMST    > CURRENT TIMESTAMP           46721199
100404                 OR  A.END_TMST IS NULL)                          46721299
               END-EXEC                                                 46721899
                                                                        46721999
               EVALUATE TRUE                                            46722099
                   WHEN SQLCODE = ZERO                                  46722199
100404                 IF PV-REGN-LOC-SKU-STAT-CDE =  PC-CLEARANCE      46722299
100404                     MOVE XST00008-UNT-RTL-AMT TO PV-CUR-RTL-AMT  46722399
                           MOVE +1                   TO PV-GP-QTY       46722499
                       END-IF                                           46722599
                   WHEN SQLCODE = +100                                  46722699
                   WHEN SQLCODE = -904                                  46722799
                   WHEN SQLCODE = -913                                  46722899
                       CONTINUE                                         46722999
                   WHEN OTHER                                           46723099
                       MOVE '7800-CHECK-REGN-PRC'                       46723199
                                             TO DP013-PARAGRAPH         46723299
100404                 MOVE 'SELECT DATA FROM XST_SKU_LOC'              46723399
                                             TO DP013-MESSAGE-TEXT (1)  46723499
                       MOVE SQLCA            TO DP013-SQLCA             46723599
100404                 MOVE 'XST_SKU_LOC'    TO DP013-DB2-TABLE-NAME (1)46723699
                       SET DP013-DB2-ABEND                              46723999
                           DP013-XCTL-DISPLAY-RESTART                   46724099
                                         TO TRUE                        46724199
                       PERFORM DP013-0000-PROCESS-ABEND                 46724299
               END-EVALUATE                                             46724399
           END-PERFORM.                                                 46724499
                                                                        46724599
           IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          46724699
               MOVE '7800-CHECK-REGN-PRC'                               46724799
                                     TO DP013-PARAGRAPH                 46724899
100404         MOVE 'SELECT DATA FROM XST_SKU_LOC'                      46724999
                                     TO DP013-MESSAGE-TEXT (1)          46725099
               MOVE SQLCA            TO DP013-SQLCA                     46725199
100404         MOVE 'XST_SKU_LOC'    TO DP013-DB2-TABLE-NAME (1)        46725299
               SET DP013-DB2-ABEND                                      46725599
                   DP013-XCTL-DISPLAY-RESTART                           46725699
                                 TO TRUE                                46725799
               PERFORM DP013-0000-PROCESS-ABEND                         46725899
           END-IF.                                                      46725999
      *                                                                 46726099
       8000-DELETE-XFER-ITEMS.                                          46726199
           MOVE ASC-CONTROL-NBR-N   TO TFITEM-XFER-DKEY-ID.             46726299
           PERFORM WITH TEST AFTER                                      46726399
               VARYING PV-RETRY-COUNT FROM 1 BY 1                       46726499
               UNTIL SQLCODE = 0    OR                                  46726599
                     SQLCODE = +100 OR                                  46726699
                     PV-RETRY-COUNT > PC-MAX-RETRIES                    46726799
               EXEC SQL                                                 46726899
                    DELETE FROM TTFITEM                                 46726999
                    WHERE  (XFER_DKEY_ID   =  :TFITEM-XFER-DKEY-ID)     46727099
               END-EXEC                                                 46727199
                                                                        46727299
               EVALUATE TRUE                                            46727399
                   WHEN SQLCODE = ZERO                                  46727499
                   WHEN SQLCODE = +100                                  46727599
                   WHEN SQLCODE = -904                                  46727699
                   WHEN SQLCODE = -913                                  46727799
                      CONTINUE                                          46727899
                   WHEN OTHER                                           46727999
                      MOVE '8000-DELETE-XFER-ITEMS'                     46728099
                                             TO DP013-PARAGRAPH         46728199
                      MOVE 'DELETE TRANSFER ITEMS'                      46728299
                                             TO DP013-MESSAGE-TEXT (1)  46728399
                      MOVE SQLCA             TO DP013-SQLCA             46728499
                      MOVE 'TTFITEM'         TO DP013-DB2-TABLE-NAME (1)46728599
                      SET DP013-DB2-ABEND    TO TRUE                    46728699
               END-EVALUATE                                             46728799
           END-PERFORM.                                                 46728899
                                                                        46728999
           IF PV-RETRY-COUNT > PC-MAX-RETRIES AND                       46729099
              SQLCODE NOT = 0                                           46729199
               MOVE '8000-DELETE-XFER-ITEMS'       TO DP013-PARAGRAPH   46729299
               MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO DELETE'     46729399
                                          TO DP013-MESSAGE-TEXT (1)     46729499
               MOVE 'TRANSFER ITEMS'      TO DP013-MESSAGE-TEXT (2)     46729599
               MOVE SQLCA                 TO DP013-SQLCA                46729699
               MOVE 'TTFITEM'             TO DP013-DB2-TABLE-NAME (1)   46729799
               SET DP013-DB2-ABEND                                      46729899
                   DP013-XCTL-DISPLAY-RESTART                           46729999
                                          TO TRUE                       46730099
               PERFORM DP013-0000-PROCESS-ABEND                         46730199
           END-IF.                                                      46730299
       9000-CHECK-RETAIL-ITEMS.                                         46730399
           IF ASC-RTL-ITEM-NOT-UPDATED (PW-ITEM-SUB)                    46730499
                 AND ASC-RTL-QTY (PW-ITEM-SUB) > SPACES                 46730599
               MOVE ASC-RTL-QTY-N (PW-ITEM-SUB)                         46730699
                                       TO PV-HOLD-QTY                   46730799
               SET ASC-RTL-ITEM-UPDATED (PW-ITEM-SUB)                   46730899
                                       TO TRUE                          46730999
               PERFORM 9050-COMPLETE-RETAIL-ITEMS                       46731099
                 VARYING PV-ITEM                                        46731199
                   FROM PW-ITEM-SUB BY 1                                46731299
                     UNTIL PV-ITEM >  PC-MAX-RETAIL-ITEMS               46731399
               PERFORM 9100-INSERT-RETAIL-ITEMS                         46731499
           END-IF.                                                      46731599
       9050-COMPLETE-RETAIL-ITEMS.                                      46731699
           IF ASC-RTL-ITEM-NOT-UPDATED (PV-ITEM)                        46731799
               IF ASC-KOHLS-UPC-DIGITS (PV-ITEM) = '0400' AND           46731899
                  ASC-KOHLS-DUMMY-SKU  (PV-ITEM) = '000'                46731999
                   IF (ASC-KOHLS-UPC (PV-ITEM) =                        46732099
                       ASC-KOHLS-UPC (PW-ITEM-SUB)) AND                 46732199
                      (ASC-PRICE (PV-ITEM) =                            46732299
                       ASC-PRICE (PW-ITEM-SUB))                         46732399
                        ADD ASC-RTL-QTY-N (PV-ITEM)                     46733099
                                        TO PV-HOLD-QTY                  46733199
                        SET ASC-RTL-ITEM-UPDATED (PV-ITEM)              46733299
                                        TO TRUE                         46733399
                   END-IF                                               46733499
               ELSE                                                     46733599
                   IF (ASC-ITEM-NBR  (PV-ITEM) =                        46733699
                       ASC-ITEM-NBR  (PW-ITEM-SUB)) AND                 46733799
                      (ASC-PRICE (PV-ITEM) =                            46733899
                       ASC-PRICE (PW-ITEM-SUB))                         46733999
                        ADD ASC-RTL-QTY-N (PV-ITEM)                     46734099
                                        TO PV-HOLD-QTY                  46734199
                        SET ASC-RTL-ITEM-UPDATED (PV-ITEM)              46734299
                                        TO TRUE                         46734399
                   END-IF                                               46734499
               END-IF                                                   46734599
           END-IF.                                                      46734699
       EJECT                                                            46734799
       9100-INSERT-RETAIL-ITEMS.                                        46734899
           INITIALIZE DCLTTFITEM.                                       46734999
           MOVE ASC-CONTROL-NBR-N          TO TFITEM-XFER-DKEY-ID.      46735099
           ADD +1                          TO PV-LINE-NBR.              46735199
           MOVE PV-LINE-NBR                TO TFITEM-XFER-LNE-NBR.      46735299
           MOVE ASC-UPC   (PW-ITEM-SUB)    TO TFITEM-SCN-UPC-NBR.       46735399
           MOVE ASC-KOHLS-UPC (PW-ITEM-SUB)                             46735499
                                           TO TFITEM-KOHLS-UPC-NBR.     46735599
           MOVE ASC-ITEM-NBR  (PW-ITEM-SUB)                             46735699
                                           TO TFITEM-ITM-NBR.           46735799
           MOVE ASC-PRICE-N (PW-ITEM-SUB)                               46735899
                                           TO TFITEM-XFER-PRIC-AMT.     46735999
           MOVE ASC-FILE-PRICE (PW-ITEM-SUB)                            46736099
                                           TO TFITEM-CPLD-RTL-PRIC-AMT. 46736199
           MOVE ASC-GROUP-PRICED-SW (PW-ITEM-SUB)                       46736299
                                           TO TFITEM-ITM-PRIC-MLT-IND.  46736399
           MOVE PV-HOLD-QTY                TO TFITEM-XFER-QTY.          46736499
           PERFORM WITH TEST AFTER                                      46736599
               VARYING PV-RETRY-COUNT FROM 1 BY 1                       46736699
               UNTIL SQLCODE = 0 OR                                     46736799
                     PV-RETRY-COUNT > PC-MAX-RETRIES                    46736899
                                                                        46736999
               EXEC SQL                                                 46737099
                    INSERT                                              46737199
                      INTO TTFITEM                                      46737299
                          (XFER_DKEY_ID                                 46737399
                         , XFER_LNE_NBR                                 46737499
                         , CPLD_RTL_PRIC_AMT                            46737599
                         , SCN_UPC_NBR                                  46737699
                         , KOHLS_UPC_NBR                                46737799
                         , ITM_NBR                                      46737899
                         , XFER_PRIC_AMT                                46737999
                         , ITM_PRIC_MLT_IND                             46738099
                         , XFER_QTY)                                    46738199
                    VALUES                                              46738299
                          (:TFITEM-XFER-DKEY-ID                         46738399
                         , :TFITEM-XFER-LNE-NBR                         46738499
                         , :TFITEM-CPLD-RTL-PRIC-AMT                    46738899
                         , :TFITEM-SCN-UPC-NBR                          46738999
                         , :TFITEM-KOHLS-UPC-NBR                        46739099
                         , :TFITEM-ITM-NBR                              46739199
                         , :TFITEM-XFER-PRIC-AMT                        46739299
                         , :TFITEM-ITM-PRIC-MLT-IND                     46739399
                         , :TFITEM-XFER-QTY)                            46739499
               END-EXEC                                                 46739599
                                                                        46739699
               EVALUATE TRUE                                            46739799
                   WHEN SQLCODE = 0                                     46739899
                   WHEN SQLCODE = -904                                  46739999
                   WHEN SQLCODE = -913                                  46740099
                        CONTINUE                                        46740199
                   WHEN OTHER                                           46740299
                        MOVE '9100-INSERT-RETAIL-ITEMS'                 46740399
                                          TO DP013-PARAGRAPH            46740499
                        MOVE 'INSERT A ROW INTO THE TTFITEM TABLE'      46740599
                                          TO DP013-MESSAGE-TEXT(1)      46740699
                        MOVE SQLCA        TO DP013-SQLCA                46740799
                        MOVE 'TTFITEM'    TO DP013-DB2-TABLE-NAME (1)   46740899
                        SET DP013-DB2-ABEND                             46740999
                            DP013-XCTL-DISPLAY-RESTART TO TRUE          46741099
                        PERFORM DP013-0000-PROCESS-ABEND                46741199
               END-EVALUATE                                             46741299
           END-PERFORM.                                                 46741399
                                                                        46741499
           IF PV-RETRY-COUNT > PC-MAX-RETRIES AND                       46741599
              SQLCODE NOT = 0                                           46741699
               MOVE '9100-INSERT-RETAIL-ITEMS' TO DP013-PARAGRAPH       46741799
               MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO INSERT'     46741899
                                          TO DP013-MESSAGE-TEXT (1)     46741999
               MOVE 'A TRANSFER ITEM'     TO DP013-MESSAGE-TEXT (2)     46742099
               MOVE SQLCA                 TO DP013-SQLCA                46742199
               MOVE 'TTFITEM'             TO DP013-DB2-TABLE-NAME (1)   46742299
               SET DP013-DB2-ABEND                                      46742399
                   DP013-XCTL-DISPLAY-RESTART                           46742499
                                          TO TRUE                       46742599
               PERFORM DP013-0000-PROCESS-ABEND                         46742699
           END-IF.                                                      46742799
       EJECT                                                            46742899
       9200-CHECK-NON-RETAIL-ITEMS.                                     46742999
           IF ASC-NRTL-QTY (PW-ITEM-SUB) > SPACES                       46743099
               PERFORM 9300-INSERT-NON-RETAIL-ITEMS                     46743199
           END-IF.                                                      46743299
       9300-INSERT-NON-RETAIL-ITEMS.                                    46743399
           INITIALIZE DCLTTFITEM.                                       46743499
           MOVE ASC-CONTROL-NBR-N          TO TFITEM-XFER-DKEY-ID.      46743599
           ADD +1                          TO PV-LINE-NBR.              46743699
           MOVE PV-LINE-NBR                TO TFITEM-XFER-LNE-NBR.      46743799
           MOVE ASC-ITEM-DESC1 (PW-ITEM-SUB)                            46743899
                                           TO TFITEM-NRTL-1ST-LNE-DESC. 46743999
           MOVE ASC-ITEM-DESC2 (PW-ITEM-SUB)                            46744099
                                           TO TFITEM-NRTL-2ND-LNE-DESC. 46744199
           MOVE ASC-NRTL-QTY-N (PW-ITEM-SUB)                            46744299
                                           TO TFITEM-XFER-QTY.          46744399
           MOVE ASC-NRTL-DEPT (PW-ITEM-SUB)                             46744499
                                           TO TFITEM-NRTL-DEPT-NBR      46744599
           MOVE ASC-FIXTURE  (PW-ITEM-SUB)                              46744699
                                           TO TFITEM-NRTL-FIXT-ID.      46744799
           PERFORM WITH TEST AFTER                                      46744899
               VARYING PV-RETRY-COUNT FROM 1 BY 1                       46744999
               UNTIL SQLCODE = 0 OR                                     46745099
                     PV-RETRY-COUNT > PC-MAX-RETRIES                    46745199
                                                                        46745299
               EXEC SQL                                                 46745399
                    INSERT                                              46745499
                      INTO TTFITEM                                      46745599
                          (XFER_DKEY_ID                                 46745699
                         , XFER_LNE_NBR                                 46745799
                         , NRTL_1ST_LNE_DESC                            46745899
                         , NRTL_2ND_LNE_DESC                            46745999
                         , NRTL_FIXT_ID                                 46746099
                         , NRTL_DEPT_NBR                                46746199
                         , XFER_QTY)                                    46746299
                    VALUES                                              46746399
                          (:TFITEM-XFER-DKEY-ID                         46746499
                         , :TFITEM-XFER-LNE-NBR                         46746599
                         , :TFITEM-NRTL-1ST-LNE-DESC                    46746699
                         , :TFITEM-NRTL-2ND-LNE-DESC                    46746799
                         , :TFITEM-NRTL-FIXT-ID                         46746899
                         , :TFITEM-NRTL-DEPT-NBR                        46746999
                         , :TFITEM-XFER-QTY)                            46747099
               END-EXEC                                                 46747199
                                                                        46747299
               EVALUATE TRUE                                            46747399
                   WHEN SQLCODE = 0                                     46747499
                   WHEN SQLCODE = -904                                  46747599
                   WHEN SQLCODE = -913                                  46747699
                        CONTINUE                                        46747799
                   WHEN OTHER                                           46747899
                        MOVE '9300-INSERT-NON-RETAIL-ITEMS'             46747999
                                          TO DP013-PARAGRAPH            46748099
                        MOVE 'INSERT A ROW INTO THE TTFITEM TABLE'      46748199
                                          TO DP013-MESSAGE-TEXT(1)      46748299
                        MOVE SQLCA        TO DP013-SQLCA                46748399
                        MOVE 'TTFITEM'    TO DP013-DB2-TABLE-NAME (1)   46748499
                        SET DP013-DB2-ABEND                             46748599
                            DP013-XCTL-DISPLAY-RESTART TO TRUE          46748699
                        PERFORM DP013-0000-PROCESS-ABEND                46748799
               END-EVALUATE                                             46748899
           END-PERFORM.                                                 46748999
                                                                        46749099
           IF PV-RETRY-COUNT > PC-MAX-RETRIES AND                       46749199
              SQLCODE NOT = 0                                           46749299
               MOVE '9300-INSERT-NON-RETAIL-ITEMS' TO DP013-PARAGRAPH   46749399
               MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO INSERT'     46749499
                                          TO DP013-MESSAGE-TEXT (1)     46749599
               MOVE 'A TRANSFER ITEM'     TO DP013-MESSAGE-TEXT (2)     46749699
               MOVE SQLCA                 TO DP013-SQLCA                46749799
               MOVE 'TTFITEM'             TO DP013-DB2-TABLE-NAME (1)   46749899
               SET DP013-DB2-ABEND                                      46749999
                   DP013-XCTL-DISPLAY-RESTART                           46750099
                                          TO TRUE                       46750199
               PERFORM DP013-0000-PROCESS-ABEND                         46750299
           END-IF.                                                      46750399
       EJECT                                                            46750499
      ******************************************************************46750599
      *    ABEND PROCESSOR MODULE                                      *46750699
      ******************************************************************46750799
                                                                        46751099
           COPY DPPD013.                                                46760099
