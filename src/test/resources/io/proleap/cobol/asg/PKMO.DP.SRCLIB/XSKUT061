       IDENTIFICATION DIVISION.                                                 
       PROGRAM-ID.      XSKUT061.                                               
       AUTHOR.          STEVE KRIEG.                                            
       INSTALLATION.    KOHLS DEPARTMENT STORES.                                
       DATE-WRITTEN.    02/07/2003.                                             
       DATE-COMPILED.                                                           
      ******************************************************************        
      *  XS DOMAIN - PRICE DETERMINATION ENGINE - REAL TIME CICS                
      ******************************************************************        
      ******************************************************************        
      *  NOTE: THERE ARE MANY VERSIONS OF THIS PROGRAM THAT MUST BE             
      *        KEPT SYNCHRONIZED.                                               
      ******************************************************************        
      *XSKUT035 - REAL-TIME, BATCH PDE                                          
      *       = INITIAL PROGRAM USED BY MANY AREAS                              
      *XSKUT061 - REAL-TIME, CICS PDE                                           
      *       = EXACT COPY OF 035, EXCEPT DFHEIBLK & XS045-COMMAREA             
      *         HAVE BEEN ADDED TO THE CALL OF THE BUSINESS RULE PGM            
      *         TO MAKE IT COMPATIBLE RUNNING AS A CICS PROGRAM.                
      *XSKUT049 - BATCH PDE                                                     
      *       = COPIED FROM 035, WITH SEVERAL CHANGES. AN INPUT AND             
      *         OUTPUT FILE REPLACE LINKAGE. BASIC LOGIC REMAINS THE            
      *         SAME EXCEPT ALL SKUS ARE PROCESSED INTO TEMP TABLE AND          
      *         THEN PROMO SQL CALLS ARE MADE.                                  
      *XSKUT060 - PERM PDE                                                      
      *       = COPIED FROM 035, WITH HEAVY DELETIONS. ALL PROMO CODING         
      *         HAS BEEN REMOVED. PROGRAM BASICLY RETURNS PERM INFO.            
      ******************************************************************        
      ******************************************************************        
      * NOTE: SOME SECOND PHASE CODE IS IN THIS PROGRAM BUT COMMENTED           
      *       OUT. THOSE LINES ARE IDENTIFIED W/ (P2).                          
      ******************************************************************        
      * 06/18/03  - KARI HAAK   -  WR21770                             *        
      * - MODIFIED STRUCTURE OF PROGRAM AND CORRECTED FUNCTIONALITY.   *        
      * - IN 9000-DISPLAY-ERROR REPLACED GOBACK WITH SETTING PS-ERROR- *        
      *   FOUND TO TRUE.  AFTER AN ERROR ON A FETCH, THE NEXT RECORD   *        
      *   SENT INTO THIS MODULE WAS ABENDING WHEN TRYING TO OPEN THE   *        
      *   SAME CURSOR.  CHECKING ERROR SWITCH ALLOWS CURSORS TO BE     *        
      *   CLOSED.                                                      *        
      ******************************************************************        
      * 07/14/03  - KARI HAAK   -  WR21770                             *        
      * - SEPARATED THE CALL TO THE PDE RULES ENGINE INTO ANOTHER      *        
      *   PROCEDURE DIVISION, XSPD003.                                 *        
      * - MODIFIED LOGIC TO HANDLE THE NEW START AND END TIMESTAMPS    *        
      *   THAT ARE BEING KEPT.                                         *        
      * - BOTH CHANGES WERE REQUESTED BY RF.                           *        
      ******************************************************************        
262294* 10/05/21 - BARB SCHULTZ - CHG0262294                          *         
262294* - ADDED ONE COMMIT STATEMENT BETWEEN THE TWO PROCEDURAL        *        
262294*   COPYBOOKS.  THIS WAS ADDED FOR THE DBAS SO THEY CAN DO       *        
262294*   MAINTENANCE ON THE TABLES. A DB2 CLAIM IS HELD ON ANY        *        
262294*   ACCESSED TABLE IN THE PROGRAM.  A COMMIT RELEASES THIS       *        
262294*   ACCESS.                                                               
262294******************************************************************        
       ENVIRONMENT DIVISION.                                                    
       CONFIGURATION SECTION.                                                   
       SOURCE-COMPUTER.        IBM-3090.                                        
       OBJECT-COMPUTER.        IBM-3090.                                        
                                                                                
       DATA DIVISION.                                                           
                                                                                
       WORKING-STORAGE SECTION.                                                 
                                                                                
      ******************************************************************        
      *  THE WORKING STORAGE SECTION IS SHARED BETWEEN XSKUT035 &      *        
      *  XSKUT061                                                      *        
      ******************************************************************        
           COPY XSWS002.                                                        
                                                                                
       LINKAGE SECTION.                                                         
      ******************************************************************        
      * PRICE DETERMINATION LAYOUT COPYBOOK                                     
      ******************************************************************        
           COPY XSRD047.                                                        
                                                                                
      ******************************************************************        
       PROCEDURE DIVISION USING XS047-PRICE-DETERMINATION.                      
                                                                                
       0000-MAINLINE.                                                           
                                                                                
           PERFORM 1000-INITIALIZATION.                                         
           IF PS-NO-ERROR-FOUND                                                 
               PERFORM 2000-PROCESS-MERCH                                       
           END-IF.                                                              
                                                                                
262294     IF PS-NO-ERROR-FOUND                                                 
262294         PERFORM 2900-COMMIT-PARAGRAPH                                    
262294     END-IF.                                                              
                                                                                
           IF PS-NO-ERROR-FOUND                                                 
               PERFORM 3000-PROCESS-RULES                                       
           END-IF.                                                              
                                                                                
           GOBACK.                                                              
                                                                                
      ******************************************************************        
      ** THE CODE FOR THIS PROGRAM IS SHARED WITH PROGRAM XSKUT035.             
      ** THE ONLY DIFFERENCE IS THE CALL TO THE RULES ENGINE.  THIS             
      ** PROGRAM IS CICS AND XSKUT035 IS BATCH.                                 
      ******************************************************************        
           COPY XSPD002.                                                        
                                                                                
262294******************************************************************        
262294** A COMMIT BETWEEN THE TWO PROCEDURAL COPYBOOKS.                         
262294******************************************************************        
262294 2900-COMMIT-PARAGRAPH.                                                   
262294                                                                          
262294     EXEC SQL                                                             
262294         COMMIT                                                           
262294     END-EXEC.                                                            
262294                                                                          
262294     EVALUATE TRUE                                                        
262294         WHEN SQLCODE = ZERO                                              
262294             CONTINUE                                                     
262294         WHEN OTHER                                                       
262294             DISPLAY '************************************'               
262294             DISPLAY 'COMMIT DID NOT WORK IN BETWEEN THE  '               
262294             DISPLAY '   TWO COPYBOOKS XSPD002 AND XSPD003'               
262294             DISPLAY 'SQLCODE ' SQLCODE                                   
262294             DISPLAY '************************************'               
262294     END-EVALUATE.                                                        
262294                                                                          
           COPY XSPD003.                                                        
                                                                                
      ******************************************************************        
      * CALL BEST PRICE MODULE                                                  
      ******************************************************************        
       8100-CALL-BUS-RULES-MOD.                                                 
                                                                                
           CALL PC-BUS-RULE-ENGINE  USING DFHEIBLK                              
                                          XS045-COMMAREA                        
                                          XS045-BUS-RULE-LINKAGE.               
                                                                                
      ******************************************************************        
      * DISPLAY ERROR VALUES                                                    
      ******************************************************************        
       9000-DISPLAY-ERRORS.                                                     
                                                                                
           SET PS-ERROR-FOUND           TO TRUE.                                
                                                                                
